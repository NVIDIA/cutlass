!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    func.func public @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32) attributes {cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %1 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %3 = cute.static : !copy_ldgsts
      %4 = cute.static : !copy_simt
      %5 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %6 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%6) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %7 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %10 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
      %11 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%11) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %12 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %15 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%15) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %16 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %19 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
      %20 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%20) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %21 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %24 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%24) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %25 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %28 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
      %29 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%29) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %30 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %33 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%33) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %34 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %37 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
      %38 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%38) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %39 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %43 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_65 = cute.get_leaves(%43) : !cute.int_tuple<"0">
      %44 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %45 = cute.get_shape(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%45) : !cute.shape<"((8,16),(64,2))">
      %46 = cute.get_stride(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%46) : !cute.stride<"((64,512),(1,8192))">
      %47 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
      %48 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_74 = cute.get_leaves(%48) : !cute.int_tuple<"0">
      %49 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %50 = cute.get_shape(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%50) : !cute.shape<"((8,8),(64,2))">
      %51 = cute.get_stride(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%51) : !cute.stride<"((64,512),(1,4096))">
      %52 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %53 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,16),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,8192))">
      %57 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_92, %e1_93 = cute.get_leaves(%57) : !cute.tile<"[16:1;64:1]">
      %58 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_94 = cute.get_leaves(%58) : !cute.shape<"16">
      %59 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_95 = cute.get_leaves(%59) : !cute.stride<"1">
      %60 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_96 = cute.get_leaves(%60) : !cute.shape<"64">
      %61 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_97 = cute.get_leaves(%61) : !cute.stride<"1">
      %62 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %63 = cute.get_shape(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%63) : !cute.shape<"((8,16),8)">
      %64 = cute.get_stride(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%64) : !cute.stride<"((128,1),16)">
      %65 = cute.static : !cute.layout<"1:0">
      %66 = cute.get_shape(%65) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_104 = cute.get_leaves(%66) : !cute.shape<"1">
      %67 = cute.get_stride(%65) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_105 = cute.get_leaves(%67) : !cute.stride<"0">
      %68 = cute.static : !cute.layout<"(1,8):(0,1)">
      %69 = cute.get_shape(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_106, %e1_107 = cute.get_leaves(%69) : !cute.shape<"(1,8)">
      %70 = cute.get_stride(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_108, %e1_109 = cute.get_leaves(%70) : !cute.stride<"(0,1)">
      %71 = cute.static : !cute.layout<"(1,8):(0,1)">
      %72 = cute.get_shape(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_110, %e1_111 = cute.get_leaves(%72) : !cute.shape<"(1,8)">
      %73 = cute.get_stride(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_112, %e1_113 = cute.get_leaves(%73) : !cute.stride<"(0,1)">
      %74 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_114, %e1_115 = cute.get_leaves(%74) : !cute.tile<"[16:1;64:1]">
      %75 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_116 = cute.get_leaves(%75) : !cute.shape<"16">
      %76 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_117 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_118 = cute.get_leaves(%77) : !cute.shape<"64">
      %78 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_119 = cute.get_leaves(%78) : !cute.stride<"1">
      %79 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %80 = cute.get_shape(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%80) : !cute.shape<"((8,16),8)">
      %81 = cute.get_stride(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%81) : !cute.stride<"((128,1),16)">
      %82 = cute.static : !cute.layout<"1:0">
      %83 = cute.get_shape(%82) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_126 = cute.get_leaves(%83) : !cute.shape<"1">
      %84 = cute.get_stride(%82) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_127 = cute.get_leaves(%84) : !cute.stride<"0">
      %85 = cute.static : !cute.layout<"(1,8):(0,1)">
      %86 = cute.get_shape(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_128, %e1_129 = cute.get_leaves(%86) : !cute.shape<"(1,8)">
      %87 = cute.get_stride(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_130, %e1_131 = cute.get_leaves(%87) : !cute.stride<"(0,1)">
      %88 = cute.static : !cute.layout<"(1,8):(0,1)">
      %89 = cute.get_shape(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_132, %e1_133 = cute.get_leaves(%89) : !cute.shape<"(1,8)">
      %90 = cute.get_stride(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_134, %e1_135 = cute.get_leaves(%90) : !cute.stride<"(0,1)">
      %91 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %92 = cute.get_shape(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%92) : !cute.shape<"(32,4,1,1)">
      %93 = cute.get_stride(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%93) : !cute.stride<"(1,32,0,0)">
      %94 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%94) : !cute.tile<"[64:1;16:1;16:1]">
      %95 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_147 = cute.get_leaves(%95) : !cute.shape<"64">
      %96 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_148 = cute.get_leaves(%96) : !cute.stride<"1">
      %97 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_149 = cute.get_leaves(%97) : !cute.shape<"16">
      %98 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_150 = cute.get_leaves(%98) : !cute.stride<"1">
      %99 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_151 = cute.get_leaves(%99) : !cute.shape<"16">
      %100 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_152 = cute.get_leaves(%100) : !cute.stride<"1">
      %101 = cute.static : !cute.layout<"32:1">
      %102 = cute.get_shape(%101) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_153 = cute.get_leaves(%102) : !cute.shape<"32">
      %103 = cute.get_stride(%101) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_154 = cute.get_leaves(%103) : !cute.stride<"1">
      %104 = cute.static : !cute.shape<"(16,8,16)">
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%104) : !cute.shape<"(16,8,16)">
      %105 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2,2))">
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8,128))">
      %108 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %109 = cute.get_shape(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%109) : !cute.shape<"((4,8),(2,2))">
      %110 = cute.get_stride(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%110) : !cute.stride<"((16,1),(8,64))">
      %111 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %112 = cute.get_shape(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%112) : !cute.shape<"((4,8),(2,2))">
      %113 = cute.get_stride(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%113) : !cute.stride<"((32,1),(16,8))">
      %114 = nvvm.read.ptx.sreg.tid.x : i32
      %115 = nvvm.read.ptx.sreg.tid.y : i32
      %116 = nvvm.read.ptx.sreg.tid.z : i32
      %117 = nvvm.read.ptx.sreg.ctaid.x : i32
      %118 = nvvm.read.ptx.sreg.ctaid.y : i32
      %119 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %120 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%120) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %121 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %122 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %123 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %124 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %shp = cute.ceil_div(%int_tuple, %tile) : !cute.int_tuple<"?">, !cute.tile<"64:1">
      %e0_192 = cute.get_leaves(%shp) : !cute.int_tuple<"?">
      %125 = cute.get_scalars(%e0_192) : !cute.int_tuple<"?">
      %false = arith.constant false
      %126 = scf.if %false -> (i32) {
        %c1_i32_6239 = arith.constant 1 : i32
        %2344 = arith.addi %117, %c1_i32_6239 : i32
        %c128_i32_6240 = arith.constant 128 : i32
        %2345 = arith.muli %2344, %c128_i32_6240 : i32
        %int_tuple_6241 = cute.make_int_tuple(%2345) : (i32) -> !cute.int_tuple<"?">
        %tile_6242 = cute.make_tile() : () -> !cute.tile<"64:1">
        %shp_6243 = cute.ceil_div(%int_tuple_6241, %tile_6242) : !cute.int_tuple<"?">, !cute.tile<"64:1">
        %e0_6244 = cute.get_leaves(%shp_6243) : !cute.int_tuple<"?">
        %2346 = cute.get_scalars(%e0_6244) : !cute.int_tuple<"?">
        %2347 = arith.minsi %2346, %125 : i32
        scf.yield %2347 : i32
      } else {
        scf.yield %125 : i32
      }
      %c1_i32 = arith.constant 1 : i32
      %127 = arith.subi %126, %c1_i32 : i32
      %coord = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice = cute.slice(%arg0, %coord) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)">
      %iter_193 = cute.get_iter(%slice) : !memref_gmem_bf16_1
      %tile_194 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_195 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %tiled_view = cute.local_tile(%slice, %tile_194, %coord_195) : (!memref_gmem_bf16_1, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !memref_gmem_bf16_2
      %iter_196 = cute.get_iter(%tiled_view) : !memref_gmem_bf16_2
      %coord_197 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_198 = cute.slice(%arg1, %coord_197) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)">
      %iter_199 = cute.get_iter(%slice_198) : !memref_gmem_bf16_1
      %tile_200 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_201 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %tiled_view_202 = cute.local_tile(%slice_198, %tile_200, %coord_201) : (!memref_gmem_bf16_1, !cute.tile<"[64:1;128:1]">, !cute.coord<"(_,0)">) -> !memref_gmem_bf16_3
      %iter_203 = cute.get_iter(%tiled_view_202) : !memref_gmem_bf16_3
      %coord_204 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_205 = cute.slice(%arg2, %coord_204) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)">
      %iter_206 = cute.get_iter(%slice_205) : !memref_gmem_bf16_1
      %tile_207 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_208 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %tiled_view_209 = cute.local_tile(%slice_205, %tile_207, %coord_208) : (!memref_gmem_bf16_1, !cute.tile<"[64:1;128:1]">, !cute.coord<"(_,0)">) -> !memref_gmem_bf16_3
      %iter_210 = cute.get_iter(%tiled_view_209) : !memref_gmem_bf16_3
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_211 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536">
      %ptr = cute.add_offset(%smem_ptr, %int_tuple_211) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c65536_i32 = arith.constant 65536 : i32
      %128 = arith.cmpi sge, %smem_size, %c65536_i32 : i32
      cf.assert %128, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 65536 bytes. Please reduce the allocation or set a larger smem size in kernel launch."
      %int_tuple_212 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_213 = cute.add_offset(%smem_ptr, %int_tuple_212) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_214 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_215 = cute.add_offset(%smem_ptr, %int_tuple_214) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_216 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_217 = cute.add_offset(%smem_ptr, %int_tuple_216) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_218 = cute.recast_iter(%ptr_213) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view = cute.make_view(%iter_218, %0) : !memref_smem_bf16_
      %iter_219 = cute.get_iter(%view) : !memref_smem_bf16_
      %iter_220 = cute.recast_iter(%ptr_215) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_221 = cute.make_view(%iter_220, %1) : !memref_smem_bf16_1
      %iter_222 = cute.get_iter(%view_221) : !memref_smem_bf16_1
      %iter_223 = cute.recast_iter(%ptr_217) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_224 = cute.make_view(%iter_223, %1) : !memref_smem_bf16_1
      %iter_225 = cute.get_iter(%view_224) : !memref_smem_bf16_1
      %shape = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_226 = cute.make_layout(%shape, %stride) : !cute.layout<"(128,64):(64,1)">
      %129 = cute.composition(%view_224, %lay_226) : (!memref_smem_bf16_1, !cute.layout<"(128,64):(64,1)">) -> !memref_smem_bf16_2
      %iter_227 = cute.get_iter(%129) : !memref_smem_bf16_2
      %coord_228 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned = cute.tiled.copy.partition_S(%3, %tiled_view, %coord_228) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_229 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
      %coord_230 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned = cute.tiled.copy.partition_D(%3, %view, %coord_230) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_231 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
      %coord_232 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_233 = cute.tiled.copy.partition_S(%3, %tiled_view_202, %coord_232) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_234 = cute.get_iter(%src_partitioned_233) : !memref_gmem_bf16_5
      %coord_235 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_236 = cute.tiled.copy.partition_D(%3, %view_221, %coord_235) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_237 = cute.get_iter(%dst_partitioned_236) : !memref_smem_bf16_4
      %coord_238 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_239 = cute.tiled.copy.partition_S(%3, %tiled_view_209, %coord_238) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_240 = cute.get_iter(%src_partitioned_239) : !memref_gmem_bf16_5
      %coord_241 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_242 = cute.tiled.copy.partition_D(%3, %view_224, %coord_241) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_243 = cute.get_iter(%dst_partitioned_242) : !memref_smem_bf16_4
      %coord_244 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_A = cute.tiled.mma.partition A (%5, %view, %coord_244) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5
      %iter_245 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5
      %frg_A = cute.mma.make_fragment A (%5, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_
      %iter_246 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %coord_247 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B = cute.tiled.mma.partition B (%5, %view_221, %coord_247) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_6
      %iter_248 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6
      %frg_B = cute.mma.make_fragment B (%5, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1
      %iter_249 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %coord_250 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B_251 = cute.tiled.mma.partition B (%5, %129, %coord_250) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7
      %iter_252 = cute.get_iter(%ptn_B_251) : !memref_smem_bf16_7
      %frg_B_253 = cute.mma.make_fragment B (%5, %ptn_B_251) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2
      %iter_254 = cute.get_iter(%frg_B_253) : !memref_rmem_bf16_2
      %shape_255 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %130 = cute.tiled.mma.partition_shape C (%5, %shape_255) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,128)">) -> !cute.shape<"((2,2),2,16)">
      %e0_256, %e1_257, %e2_258, %e3_259 = cute.get_leaves(%130) : !cute.shape<"((2,2),2,16)">
      %shape_260 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_261 = cute.make_layout(%shape_260) : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem = cute.memref.alloca(%lay_261) : !memref_rmem_f32_
      %iter_262 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_263 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %sz = cute.size(%rmem) : (!memref_rmem_f32_) -> !cute.int_tuple<"128">
      %e0_264 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
      %lay_265 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %131 = cute.get_shape(%lay_265) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_266, %e1_267, %e2_268, %e3_269 = cute.get_leaves(%131) : !cute.shape<"((2,2),2,16)">
      %int_tuple_270 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %res = cute.tuple.product(%int_tuple_270) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_271 = cute.get_leaves(%res) : !cute.int_tuple<"128">
      %cst = arith.constant 0.000000e+00 : f32
      %132 = vector.splat %cst : vector<128xf32>
      %int_tuple_272 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_273 = cute.size(%int_tuple_272) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_274 = cute.get_leaves(%sz_273) : !cute.int_tuple<"128">
      %int_tuple_275 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_276 = cute.size(%int_tuple_275) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_277 = cute.get_leaves(%sz_276) : !cute.int_tuple<"128">
      cute.memref.store_vec %132, %rmem, row_major : !memref_rmem_f32_
      %shape_278 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_279 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_280 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_281 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_282 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %133 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %134 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_283, %e1_284, %e2_285 = cute.get_leaves(%134) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_286 = cute.size(%e0_283) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_287 = cute.get_leaves(%sz_286) : !cute.int_tuple<"64">
      %135 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_288, %e1_289, %e2_290 = cute.get_leaves(%135) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_291 = cute.size(%e2_290) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_292 = cute.get_leaves(%sz_291) : !cute.int_tuple<"16">
      %tile_293 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %136 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %137 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %138 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_294, %e1_295, %e2_296 = cute.get_leaves(%138) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_297 = cute.size(%e1_295) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_298 = cute.get_leaves(%sz_297) : !cute.int_tuple<"16">
      %139 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_299, %e1_300, %e2_301 = cute.get_leaves(%139) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_302 = cute.size(%e2_301) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_303 = cute.get_leaves(%sz_302) : !cute.int_tuple<"16">
      %tile_304 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %140 = cute.make_tiled_copy(%atom_280) : !copy_ldsm_4_1
      %141 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %142 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_305, %e1_306, %e2_307 = cute.get_leaves(%142) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_308 = cute.size(%e1_306) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_309 = cute.get_leaves(%sz_308) : !cute.int_tuple<"16">
      %143 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_310, %e1_311, %e2_312 = cute.get_leaves(%143) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_313 = cute.size(%e2_312) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_314 = cute.get_leaves(%sz_313) : !cute.int_tuple<"16">
      %tile_315 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %144 = cute.make_tiled_copy(%atom_282) : !copy_ldsm_4_2
      %coord_316 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_317 = cute.tiled.copy.partition_S(%136, %view, %coord_316) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8
      %iter_318 = cute.get_iter(%src_partitioned_317) : !memref_smem_bf16_8
      %retiled = cute.tiled.copy.retile(%136, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3
      %iter_319 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %coord_320 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_321 = cute.tiled.copy.partition_S(%140, %view_221, %coord_320) : (!copy_ldsm_4_1, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_9
      %iter_322 = cute.get_iter(%src_partitioned_321) : !memref_smem_bf16_9
      %retiled_323 = cute.tiled.copy.retile(%140, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4
      %iter_324 = cute.get_iter(%retiled_323) : !memref_rmem_bf16_4
      %coord_325 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_326 = cute.tiled.copy.partition_S(%144, %129, %coord_325) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10
      %iter_327 = cute.get_iter(%src_partitioned_326) : !memref_smem_bf16_10
      %retiled_328 = cute.tiled.copy.retile(%144, %frg_B_253) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5
      %iter_329 = cute.get_iter(%retiled_328) : !memref_rmem_bf16_5
      %lay_330 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %145 = cute.get_shape(%lay_330) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_331, %e1_332, %e2_333, %e3_334 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_335 = cute.to_int_tuple(%e0_331) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %146 = cute.get_scalars(%itup_335) : !cute.int_tuple<"?">
      %itup_336 = cute.to_int_tuple(%e1_332) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %147 = cute.get_scalars(%itup_336) : !cute.int_tuple<"?">
      %itup_337 = cute.to_int_tuple(%e2_333) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %148 = cute.get_scalars(%itup_337) : !cute.int_tuple<"?">
      %itup_338 = cute.to_int_tuple(%e3_334) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %149 = cute.get_scalars(%itup_338) : !cute.int_tuple<"?{div=8}">
      %shape_339 = cute.make_shape(%itup_335, %itup_336, %itup_337, %itup_338) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %150 = cute.make_identity_tensor(%shape_339) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_340 = cute.get_iter(%150) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_341, %e1_342, %e2_343, %e3_344 = cute.get_leaves(%iter_340) : !cute.int_tuple<"(0,0,0,0)">
      %lay_345 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %151 = cute.get_shape(%lay_345) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_346, %e1_347, %e2_348, %e3_349 = cute.get_leaves(%151) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_350 = cute.to_int_tuple(%e0_346) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %152 = cute.get_scalars(%itup_350) : !cute.int_tuple<"?">
      %itup_351 = cute.to_int_tuple(%e1_347) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %153 = cute.get_scalars(%itup_351) : !cute.int_tuple<"?">
      %itup_352 = cute.to_int_tuple(%e2_348) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %154 = cute.get_scalars(%itup_352) : !cute.int_tuple<"?">
      %itup_353 = cute.to_int_tuple(%e3_349) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %155 = cute.get_scalars(%itup_353) : !cute.int_tuple<"?{div=8}">
      %shape_354 = cute.make_shape(%itup_350, %itup_351, %itup_352, %itup_353) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %156 = cute.make_identity_tensor(%shape_354) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_355 = cute.get_iter(%156) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_356, %e1_357, %e2_358, %e3_359 = cute.get_leaves(%iter_355) : !cute.int_tuple<"(0,0,0,0)">
      %coord_360 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_361 = cute.slice(%150, %coord_360) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %iter_362 = cute.get_iter(%slice_361) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_363, %e1_364, %e2_365, %e3_366 = cute.get_leaves(%iter_362) : !cute.int_tuple<"(?,0,?,0)">
      %157 = cute.get_scalars(%e0_363) : !cute.int_tuple<"?">
      %158 = cute.get_scalars(%e2_365) : !cute.int_tuple<"?">
      %tile_367 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_368 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %tiled_view_369 = cute.local_tile(%slice_361, %tile_367, %coord_368) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_370 = cute.get_iter(%tiled_view_369) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_371, %e1_372, %e2_373, %e3_374 = cute.get_leaves(%iter_370) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %159 = cute.get_scalars(%e0_371) : !cute.int_tuple<"?">
      %160 = cute.get_scalars(%e1_372) : !cute.int_tuple<"?{div=128}">
      %161 = cute.get_scalars(%e2_373) : !cute.int_tuple<"?">
      %coord_375 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_376 = cute.slice(%156, %coord_375) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %iter_377 = cute.get_iter(%slice_376) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_378, %e1_379, %e2_380, %e3_381 = cute.get_leaves(%iter_377) : !cute.int_tuple<"(?,0,?,0)">
      %162 = cute.get_scalars(%e0_378) : !cute.int_tuple<"?">
      %163 = cute.get_scalars(%e2_380) : !cute.int_tuple<"?">
      %tile_382 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_383 = cute.make_coord(%127) : (i32) -> !cute.coord<"(?,0)">
      %tiled_view_384 = cute.local_tile(%slice_376, %tile_382, %coord_383) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[64:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_385 = cute.get_iter(%tiled_view_384) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_386, %e1_387, %e2_388, %e3_389 = cute.get_leaves(%iter_385) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %164 = cute.get_scalars(%e0_386) : !cute.int_tuple<"?">
      %165 = cute.get_scalars(%e1_387) : !cute.int_tuple<"?{div=64}">
      %166 = cute.get_scalars(%e2_388) : !cute.int_tuple<"?">
      %coord_390 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_391 = cute.tiled.copy.partition_S(%3, %tiled_view_369, %coord_390) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_392 = cute.get_iter(%src_partitioned_391) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_393, %e1_394, %e2_395, %e3_396 = cute.get_leaves(%iter_392) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %167 = cute.get_scalars(%e0_393) : !cute.int_tuple<"?">
      %168 = cute.get_scalars(%e1_394) : !cute.int_tuple<"?">
      %169 = cute.get_scalars(%e2_395) : !cute.int_tuple<"?">
      %170 = cute.get_scalars(%e3_396) : !cute.int_tuple<"?{div=8}">
      %coord_397 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_398 = cute.tiled.copy.partition_S(%3, %tiled_view_384, %coord_397) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_399 = cute.get_iter(%src_partitioned_398) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_400, %e1_401, %e2_402, %e3_403 = cute.get_leaves(%iter_399) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %171 = cute.get_scalars(%e0_400) : !cute.int_tuple<"?">
      %172 = cute.get_scalars(%e1_401) : !cute.int_tuple<"?">
      %173 = cute.get_scalars(%e2_402) : !cute.int_tuple<"?">
      %174 = cute.get_scalars(%e3_403) : !cute.int_tuple<"?{div=8}">
      %lay_404 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %175 = cute.get_shape(%lay_404) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_405, %e1_406, %e2_407, %e3_408 = cute.get_leaves(%175) : !cute.shape<"((8,1),8,2)">
      %sz_409 = cute.size(%dst_partitioned) <{mode = [1]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"8">
      %e0_410 = cute.get_leaves(%sz_409) : !cute.int_tuple<"8">
      %sz_411 = cute.size(%dst_partitioned) <{mode = [2]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"2">
      %e0_412 = cute.get_leaves(%sz_411) : !cute.int_tuple<"2">
      %sz_413 = cute.size(%dst_partitioned) <{mode = [2]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"2">
      %e0_414 = cute.get_leaves(%sz_413) : !cute.int_tuple<"2">
      %shape_415 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_416 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_417 = cute.make_layout(%shape_415, %stride_416) : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_418 = cute.memref.alloca(%lay_417) : !memref_rmem_i8_
      %iter_419 = cute.get_iter(%rmem_418) : !memref_rmem_i8_
      %iter_420 = cute.get_iter(%rmem_418) : !memref_rmem_i8_
      %lay_421 = cute.get_layout(%dst_partitioned_236) : !memref_smem_bf16_4
      %176 = cute.get_shape(%lay_421) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_422, %e1_423, %e2_424, %e3_425 = cute.get_leaves(%176) : !cute.shape<"((8,1),4,2)">
      %sz_426 = cute.size(%dst_partitioned_236) <{mode = [1]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"4">
      %e0_427 = cute.get_leaves(%sz_426) : !cute.int_tuple<"4">
      %sz_428 = cute.size(%dst_partitioned_236) <{mode = [2]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"2">
      %e0_429 = cute.get_leaves(%sz_428) : !cute.int_tuple<"2">
      %sz_430 = cute.size(%dst_partitioned_236) <{mode = [2]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"2">
      %e0_431 = cute.get_leaves(%sz_430) : !cute.int_tuple<"2">
      %shape_432 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_433 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_434 = cute.make_layout(%shape_432, %stride_433) : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_435 = cute.memref.alloca(%lay_434) : !memref_rmem_i8_1
      %iter_436 = cute.get_iter(%rmem_435) : !memref_rmem_i8_1
      %iter_437 = cute.get_iter(%rmem_435) : !memref_rmem_i8_1
      %lay_438 = cute.get_layout(%rmem_418) : !memref_rmem_i8_
      %177 = cute.get_shape(%lay_438) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_439, %e1_440, %e2_441 = cute.get_leaves(%177) : !cute.shape<"(1,8,2)">
      %coord_442 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %slice_443 = cute.slice(%src_partitioned_391, %coord_442) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)">
      %iter_444 = cute.get_iter(%slice_443) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_445, %e1_446, %e2_447, %e3_448 = cute.get_leaves(%iter_444) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %178 = cute.get_scalars(%e0_445) : !cute.int_tuple<"?">
      %179 = cute.get_scalars(%e1_446) : !cute.int_tuple<"?">
      %180 = cute.get_scalars(%e2_447) : !cute.int_tuple<"?">
      %181 = cute.get_scalars(%e3_448) : !cute.int_tuple<"?{div=8}">
      %iter_449 = cute.get_iter(%slice_443) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_450, %e1_451, %e2_452, %e3_453 = cute.get_leaves(%iter_449) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %182 = cute.get_scalars(%e0_450) : !cute.int_tuple<"?">
      %183 = cute.get_scalars(%e1_451) : !cute.int_tuple<"?">
      %184 = cute.get_scalars(%e2_452) : !cute.int_tuple<"?">
      %185 = cute.get_scalars(%e3_453) : !cute.int_tuple<"?{div=8}">
      %iter_454 = cute.get_iter(%slice_443) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_455, %e1_456, %e2_457, %e3_458 = cute.get_leaves(%iter_454) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %186 = cute.get_scalars(%e0_455) : !cute.int_tuple<"?">
      %187 = cute.get_scalars(%e1_456) : !cute.int_tuple<"?">
      %188 = cute.get_scalars(%e2_457) : !cute.int_tuple<"?">
      %189 = cute.get_scalars(%e3_458) : !cute.int_tuple<"?{div=8}">
      %lay_459 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %190 = cute.get_shape(%lay_459) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_460, %e1_461, %e2_462, %e3_463 = cute.get_leaves(%190) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_464 = cute.to_int_tuple(%e0_460) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %191 = cute.get_scalars(%itup_464) : !cute.int_tuple<"?">
      %itup_465 = cute.to_int_tuple(%e1_461) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %192 = cute.get_scalars(%itup_465) : !cute.int_tuple<"?">
      %itup_466 = cute.to_int_tuple(%e2_462) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %193 = cute.get_scalars(%itup_466) : !cute.int_tuple<"?">
      %itup_467 = cute.to_int_tuple(%e3_463) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %194 = cute.get_scalars(%itup_467) : !cute.int_tuple<"?{div=8}">
      %coord_468 = cute.make_coord(%e3_458) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_469 = cute.make_coord(%itup_467) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %195 = cute.elem_less(%coord_468, %coord_469) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %196 = arith.extui %195 : i1 to i8
      %coord_470 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_418, %coord_470, %196) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_471 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %slice_472 = cute.slice(%src_partitioned_391, %coord_471) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)">
      %iter_473 = cute.get_iter(%slice_472) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_474, %e1_475, %e2_476, %e3_477 = cute.get_leaves(%iter_473) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %197 = cute.get_scalars(%e0_474) : !cute.int_tuple<"?">
      %198 = cute.get_scalars(%e1_475) : !cute.int_tuple<"?">
      %199 = cute.get_scalars(%e2_476) : !cute.int_tuple<"?">
      %200 = cute.get_scalars(%e3_477) : !cute.int_tuple<"?{div=8}">
      %iter_478 = cute.get_iter(%slice_472) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_479, %e1_480, %e2_481, %e3_482 = cute.get_leaves(%iter_478) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %201 = cute.get_scalars(%e0_479) : !cute.int_tuple<"?">
      %202 = cute.get_scalars(%e1_480) : !cute.int_tuple<"?">
      %203 = cute.get_scalars(%e2_481) : !cute.int_tuple<"?">
      %204 = cute.get_scalars(%e3_482) : !cute.int_tuple<"?{div=8}">
      %iter_483 = cute.get_iter(%slice_472) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_484, %e1_485, %e2_486, %e3_487 = cute.get_leaves(%iter_483) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %205 = cute.get_scalars(%e0_484) : !cute.int_tuple<"?">
      %206 = cute.get_scalars(%e1_485) : !cute.int_tuple<"?">
      %207 = cute.get_scalars(%e2_486) : !cute.int_tuple<"?">
      %208 = cute.get_scalars(%e3_487) : !cute.int_tuple<"?{div=8}">
      %lay_488 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %209 = cute.get_shape(%lay_488) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_489, %e1_490, %e2_491, %e3_492 = cute.get_leaves(%209) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_493 = cute.to_int_tuple(%e0_489) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %210 = cute.get_scalars(%itup_493) : !cute.int_tuple<"?">
      %itup_494 = cute.to_int_tuple(%e1_490) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %211 = cute.get_scalars(%itup_494) : !cute.int_tuple<"?">
      %itup_495 = cute.to_int_tuple(%e2_491) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %212 = cute.get_scalars(%itup_495) : !cute.int_tuple<"?">
      %itup_496 = cute.to_int_tuple(%e3_492) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %213 = cute.get_scalars(%itup_496) : !cute.int_tuple<"?{div=8}">
      %coord_497 = cute.make_coord(%e3_487) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_498 = cute.make_coord(%itup_496) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %214 = cute.elem_less(%coord_497, %coord_498) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %215 = arith.extui %214 : i1 to i8
      %coord_499 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_418, %coord_499, %215) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_500 = cute.get_layout(%rmem_435) : !memref_rmem_i8_1
      %216 = cute.get_shape(%lay_500) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_501, %e1_502, %e2_503 = cute.get_leaves(%216) : !cute.shape<"(1,4,2)">
      %coord_504 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %slice_505 = cute.slice(%src_partitioned_398, %coord_504) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)">
      %iter_506 = cute.get_iter(%slice_505) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_507, %e1_508, %e2_509, %e3_510 = cute.get_leaves(%iter_506) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %217 = cute.get_scalars(%e0_507) : !cute.int_tuple<"?">
      %218 = cute.get_scalars(%e1_508) : !cute.int_tuple<"?">
      %219 = cute.get_scalars(%e2_509) : !cute.int_tuple<"?">
      %220 = cute.get_scalars(%e3_510) : !cute.int_tuple<"?{div=8}">
      %iter_511 = cute.get_iter(%slice_505) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_512, %e1_513, %e2_514, %e3_515 = cute.get_leaves(%iter_511) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %221 = cute.get_scalars(%e0_512) : !cute.int_tuple<"?">
      %222 = cute.get_scalars(%e1_513) : !cute.int_tuple<"?">
      %223 = cute.get_scalars(%e2_514) : !cute.int_tuple<"?">
      %224 = cute.get_scalars(%e3_515) : !cute.int_tuple<"?{div=8}">
      %iter_516 = cute.get_iter(%slice_505) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_517, %e1_518, %e2_519, %e3_520 = cute.get_leaves(%iter_516) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %225 = cute.get_scalars(%e0_517) : !cute.int_tuple<"?">
      %226 = cute.get_scalars(%e1_518) : !cute.int_tuple<"?">
      %227 = cute.get_scalars(%e2_519) : !cute.int_tuple<"?">
      %228 = cute.get_scalars(%e3_520) : !cute.int_tuple<"?{div=8}">
      %lay_521 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %229 = cute.get_shape(%lay_521) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_522, %e1_523, %e2_524, %e3_525 = cute.get_leaves(%229) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_526 = cute.to_int_tuple(%e0_522) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %230 = cute.get_scalars(%itup_526) : !cute.int_tuple<"?">
      %itup_527 = cute.to_int_tuple(%e1_523) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %231 = cute.get_scalars(%itup_527) : !cute.int_tuple<"?">
      %itup_528 = cute.to_int_tuple(%e2_524) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %232 = cute.get_scalars(%itup_528) : !cute.int_tuple<"?">
      %itup_529 = cute.to_int_tuple(%e3_525) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %233 = cute.get_scalars(%itup_529) : !cute.int_tuple<"?{div=8}">
      %coord_530 = cute.make_coord(%e3_520) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_531 = cute.make_coord(%itup_529) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %234 = cute.elem_less(%coord_530, %coord_531) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %235 = arith.extui %234 : i1 to i8
      %coord_532 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_435, %coord_532, %235) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_533 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %slice_534 = cute.slice(%src_partitioned_398, %coord_533) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)">
      %iter_535 = cute.get_iter(%slice_534) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_536, %e1_537, %e2_538, %e3_539 = cute.get_leaves(%iter_535) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %236 = cute.get_scalars(%e0_536) : !cute.int_tuple<"?">
      %237 = cute.get_scalars(%e1_537) : !cute.int_tuple<"?">
      %238 = cute.get_scalars(%e2_538) : !cute.int_tuple<"?">
      %239 = cute.get_scalars(%e3_539) : !cute.int_tuple<"?{div=8}">
      %iter_540 = cute.get_iter(%slice_534) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_541, %e1_542, %e2_543, %e3_544 = cute.get_leaves(%iter_540) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %240 = cute.get_scalars(%e0_541) : !cute.int_tuple<"?">
      %241 = cute.get_scalars(%e1_542) : !cute.int_tuple<"?">
      %242 = cute.get_scalars(%e2_543) : !cute.int_tuple<"?">
      %243 = cute.get_scalars(%e3_544) : !cute.int_tuple<"?{div=8}">
      %iter_545 = cute.get_iter(%slice_534) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_546, %e1_547, %e2_548, %e3_549 = cute.get_leaves(%iter_545) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %244 = cute.get_scalars(%e0_546) : !cute.int_tuple<"?">
      %245 = cute.get_scalars(%e1_547) : !cute.int_tuple<"?">
      %246 = cute.get_scalars(%e2_548) : !cute.int_tuple<"?">
      %247 = cute.get_scalars(%e3_549) : !cute.int_tuple<"?{div=8}">
      %lay_550 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %248 = cute.get_shape(%lay_550) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_551, %e1_552, %e2_553, %e3_554 = cute.get_leaves(%248) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_555 = cute.to_int_tuple(%e0_551) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %249 = cute.get_scalars(%itup_555) : !cute.int_tuple<"?">
      %itup_556 = cute.to_int_tuple(%e1_552) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %250 = cute.get_scalars(%itup_556) : !cute.int_tuple<"?">
      %itup_557 = cute.to_int_tuple(%e2_553) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %251 = cute.get_scalars(%itup_557) : !cute.int_tuple<"?">
      %itup_558 = cute.to_int_tuple(%e3_554) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %252 = cute.get_scalars(%itup_558) : !cute.int_tuple<"?{div=8}">
      %coord_559 = cute.make_coord(%e3_549) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_560 = cute.make_coord(%itup_558) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %253 = cute.elem_less(%coord_559, %coord_560) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %254 = arith.extui %253 : i1 to i8
      %coord_561 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_435, %coord_561, %254) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_562 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_563 = cute.size(%int_tuple_562) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_564 = cute.get_leaves(%sz_563) : !cute.int_tuple<"8">
      %coord_565 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %slice_566 = cute.slice(%src_partitioned_391, %coord_565) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)">
      %iter_567 = cute.get_iter(%slice_566) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_568, %e1_569, %e2_570, %e3_571 = cute.get_leaves(%iter_567) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %255 = cute.get_scalars(%e0_568) : !cute.int_tuple<"?">
      %256 = cute.get_scalars(%e1_569) : !cute.int_tuple<"?">
      %257 = cute.get_scalars(%e2_570) : !cute.int_tuple<"?">
      %258 = cute.get_scalars(%e3_571) : !cute.int_tuple<"?{div=8}">
      %iter_572 = cute.get_iter(%slice_566) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_573, %e1_574, %e2_575, %e3_576 = cute.get_leaves(%iter_572) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %259 = cute.get_scalars(%e0_573) : !cute.int_tuple<"?">
      %260 = cute.get_scalars(%e1_574) : !cute.int_tuple<"?">
      %261 = cute.get_scalars(%e2_575) : !cute.int_tuple<"?">
      %262 = cute.get_scalars(%e3_576) : !cute.int_tuple<"?{div=8}">
      %iter_577 = cute.get_iter(%slice_566) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_578, %e1_579, %e2_580, %e3_581 = cute.get_leaves(%iter_577) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %263 = cute.get_scalars(%e0_578) : !cute.int_tuple<"?">
      %264 = cute.get_scalars(%e1_579) : !cute.int_tuple<"?">
      %265 = cute.get_scalars(%e2_580) : !cute.int_tuple<"?">
      %266 = cute.get_scalars(%e3_581) : !cute.int_tuple<"?{div=8}">
      %lay_582 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %267 = cute.get_shape(%lay_582) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_583, %e1_584, %e2_585, %e3_586 = cute.get_leaves(%267) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_587 = cute.to_int_tuple(%e0_583) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %268 = cute.get_scalars(%itup_587) : !cute.int_tuple<"?">
      %itup_588 = cute.to_int_tuple(%e1_584) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %269 = cute.get_scalars(%itup_588) : !cute.int_tuple<"?">
      %itup_589 = cute.to_int_tuple(%e2_585) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %270 = cute.get_scalars(%itup_589) : !cute.int_tuple<"?">
      %itup_590 = cute.to_int_tuple(%e3_586) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %271 = cute.get_scalars(%itup_590) : !cute.int_tuple<"?{div=8}">
      %coord_591 = cute.make_coord(%e1_579) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_592 = cute.make_coord(%itup_588) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %272 = cute.elem_less(%coord_591, %coord_592) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %272 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,0,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,0,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,0,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,0,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_593 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %slice_594 = cute.slice(%src_partitioned_391, %coord_593) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)">
      %iter_595 = cute.get_iter(%slice_594) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_596, %e1_597, %e2_598, %e3_599 = cute.get_leaves(%iter_595) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %273 = cute.get_scalars(%e0_596) : !cute.int_tuple<"?">
      %274 = cute.get_scalars(%e1_597) : !cute.int_tuple<"?">
      %275 = cute.get_scalars(%e2_598) : !cute.int_tuple<"?">
      %276 = cute.get_scalars(%e3_599) : !cute.int_tuple<"?{div=8}">
      %iter_600 = cute.get_iter(%slice_594) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_601, %e1_602, %e2_603, %e3_604 = cute.get_leaves(%iter_600) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %277 = cute.get_scalars(%e0_601) : !cute.int_tuple<"?">
      %278 = cute.get_scalars(%e1_602) : !cute.int_tuple<"?">
      %279 = cute.get_scalars(%e2_603) : !cute.int_tuple<"?">
      %280 = cute.get_scalars(%e3_604) : !cute.int_tuple<"?{div=8}">
      %iter_605 = cute.get_iter(%slice_594) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_606, %e1_607, %e2_608, %e3_609 = cute.get_leaves(%iter_605) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %281 = cute.get_scalars(%e0_606) : !cute.int_tuple<"?">
      %282 = cute.get_scalars(%e1_607) : !cute.int_tuple<"?">
      %283 = cute.get_scalars(%e2_608) : !cute.int_tuple<"?">
      %284 = cute.get_scalars(%e3_609) : !cute.int_tuple<"?{div=8}">
      %lay_610 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %285 = cute.get_shape(%lay_610) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_611, %e1_612, %e2_613, %e3_614 = cute.get_leaves(%285) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_615 = cute.to_int_tuple(%e0_611) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %286 = cute.get_scalars(%itup_615) : !cute.int_tuple<"?">
      %itup_616 = cute.to_int_tuple(%e1_612) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %287 = cute.get_scalars(%itup_616) : !cute.int_tuple<"?">
      %itup_617 = cute.to_int_tuple(%e2_613) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %288 = cute.get_scalars(%itup_617) : !cute.int_tuple<"?">
      %itup_618 = cute.to_int_tuple(%e3_614) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %289 = cute.get_scalars(%itup_618) : !cute.int_tuple<"?{div=8}">
      %coord_619 = cute.make_coord(%e1_607) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_620 = cute.make_coord(%itup_616) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %290 = cute.elem_less(%coord_619, %coord_620) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %290 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,1,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,1,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,1,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,1,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_621 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %slice_622 = cute.slice(%src_partitioned_391, %coord_621) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)">
      %iter_623 = cute.get_iter(%slice_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_624, %e1_625, %e2_626, %e3_627 = cute.get_leaves(%iter_623) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %291 = cute.get_scalars(%e0_624) : !cute.int_tuple<"?">
      %292 = cute.get_scalars(%e1_625) : !cute.int_tuple<"?">
      %293 = cute.get_scalars(%e2_626) : !cute.int_tuple<"?">
      %294 = cute.get_scalars(%e3_627) : !cute.int_tuple<"?{div=8}">
      %iter_628 = cute.get_iter(%slice_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_629, %e1_630, %e2_631, %e3_632 = cute.get_leaves(%iter_628) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %295 = cute.get_scalars(%e0_629) : !cute.int_tuple<"?">
      %296 = cute.get_scalars(%e1_630) : !cute.int_tuple<"?">
      %297 = cute.get_scalars(%e2_631) : !cute.int_tuple<"?">
      %298 = cute.get_scalars(%e3_632) : !cute.int_tuple<"?{div=8}">
      %iter_633 = cute.get_iter(%slice_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_634, %e1_635, %e2_636, %e3_637 = cute.get_leaves(%iter_633) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %299 = cute.get_scalars(%e0_634) : !cute.int_tuple<"?">
      %300 = cute.get_scalars(%e1_635) : !cute.int_tuple<"?">
      %301 = cute.get_scalars(%e2_636) : !cute.int_tuple<"?">
      %302 = cute.get_scalars(%e3_637) : !cute.int_tuple<"?{div=8}">
      %lay_638 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %303 = cute.get_shape(%lay_638) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_639, %e1_640, %e2_641, %e3_642 = cute.get_leaves(%303) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_643 = cute.to_int_tuple(%e0_639) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %304 = cute.get_scalars(%itup_643) : !cute.int_tuple<"?">
      %itup_644 = cute.to_int_tuple(%e1_640) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %305 = cute.get_scalars(%itup_644) : !cute.int_tuple<"?">
      %itup_645 = cute.to_int_tuple(%e2_641) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %306 = cute.get_scalars(%itup_645) : !cute.int_tuple<"?">
      %itup_646 = cute.to_int_tuple(%e3_642) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %307 = cute.get_scalars(%itup_646) : !cute.int_tuple<"?{div=8}">
      %coord_647 = cute.make_coord(%e1_635) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_648 = cute.make_coord(%itup_644) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %308 = cute.elem_less(%coord_647, %coord_648) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %308 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,2,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,2,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,2,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,2,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_649 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %slice_650 = cute.slice(%src_partitioned_391, %coord_649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)">
      %iter_651 = cute.get_iter(%slice_650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_652, %e1_653, %e2_654, %e3_655 = cute.get_leaves(%iter_651) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %309 = cute.get_scalars(%e0_652) : !cute.int_tuple<"?">
      %310 = cute.get_scalars(%e1_653) : !cute.int_tuple<"?">
      %311 = cute.get_scalars(%e2_654) : !cute.int_tuple<"?">
      %312 = cute.get_scalars(%e3_655) : !cute.int_tuple<"?{div=8}">
      %iter_656 = cute.get_iter(%slice_650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_657, %e1_658, %e2_659, %e3_660 = cute.get_leaves(%iter_656) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %313 = cute.get_scalars(%e0_657) : !cute.int_tuple<"?">
      %314 = cute.get_scalars(%e1_658) : !cute.int_tuple<"?">
      %315 = cute.get_scalars(%e2_659) : !cute.int_tuple<"?">
      %316 = cute.get_scalars(%e3_660) : !cute.int_tuple<"?{div=8}">
      %iter_661 = cute.get_iter(%slice_650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_662, %e1_663, %e2_664, %e3_665 = cute.get_leaves(%iter_661) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %317 = cute.get_scalars(%e0_662) : !cute.int_tuple<"?">
      %318 = cute.get_scalars(%e1_663) : !cute.int_tuple<"?">
      %319 = cute.get_scalars(%e2_664) : !cute.int_tuple<"?">
      %320 = cute.get_scalars(%e3_665) : !cute.int_tuple<"?{div=8}">
      %lay_666 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %321 = cute.get_shape(%lay_666) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_667, %e1_668, %e2_669, %e3_670 = cute.get_leaves(%321) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_671 = cute.to_int_tuple(%e0_667) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %322 = cute.get_scalars(%itup_671) : !cute.int_tuple<"?">
      %itup_672 = cute.to_int_tuple(%e1_668) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %323 = cute.get_scalars(%itup_672) : !cute.int_tuple<"?">
      %itup_673 = cute.to_int_tuple(%e2_669) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %324 = cute.get_scalars(%itup_673) : !cute.int_tuple<"?">
      %itup_674 = cute.to_int_tuple(%e3_670) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %325 = cute.get_scalars(%itup_674) : !cute.int_tuple<"?{div=8}">
      %coord_675 = cute.make_coord(%e1_663) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_676 = cute.make_coord(%itup_672) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %326 = cute.elem_less(%coord_675, %coord_676) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %326 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,3,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,3,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,3,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,3,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_677 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %slice_678 = cute.slice(%src_partitioned_391, %coord_677) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,4,0)">
      %iter_679 = cute.get_iter(%slice_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_680, %e1_681, %e2_682, %e3_683 = cute.get_leaves(%iter_679) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %327 = cute.get_scalars(%e0_680) : !cute.int_tuple<"?">
      %328 = cute.get_scalars(%e1_681) : !cute.int_tuple<"?">
      %329 = cute.get_scalars(%e2_682) : !cute.int_tuple<"?">
      %330 = cute.get_scalars(%e3_683) : !cute.int_tuple<"?{div=8}">
      %iter_684 = cute.get_iter(%slice_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_685, %e1_686, %e2_687, %e3_688 = cute.get_leaves(%iter_684) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %331 = cute.get_scalars(%e0_685) : !cute.int_tuple<"?">
      %332 = cute.get_scalars(%e1_686) : !cute.int_tuple<"?">
      %333 = cute.get_scalars(%e2_687) : !cute.int_tuple<"?">
      %334 = cute.get_scalars(%e3_688) : !cute.int_tuple<"?{div=8}">
      %iter_689 = cute.get_iter(%slice_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_690, %e1_691, %e2_692, %e3_693 = cute.get_leaves(%iter_689) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %335 = cute.get_scalars(%e0_690) : !cute.int_tuple<"?">
      %336 = cute.get_scalars(%e1_691) : !cute.int_tuple<"?">
      %337 = cute.get_scalars(%e2_692) : !cute.int_tuple<"?">
      %338 = cute.get_scalars(%e3_693) : !cute.int_tuple<"?{div=8}">
      %lay_694 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %339 = cute.get_shape(%lay_694) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_695, %e1_696, %e2_697, %e3_698 = cute.get_leaves(%339) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_699 = cute.to_int_tuple(%e0_695) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %340 = cute.get_scalars(%itup_699) : !cute.int_tuple<"?">
      %itup_700 = cute.to_int_tuple(%e1_696) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %341 = cute.get_scalars(%itup_700) : !cute.int_tuple<"?">
      %itup_701 = cute.to_int_tuple(%e2_697) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %342 = cute.get_scalars(%itup_701) : !cute.int_tuple<"?">
      %itup_702 = cute.to_int_tuple(%e3_698) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %343 = cute.get_scalars(%itup_702) : !cute.int_tuple<"?{div=8}">
      %coord_703 = cute.make_coord(%e1_691) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_704 = cute.make_coord(%itup_700) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %344 = cute.elem_less(%coord_703, %coord_704) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %344 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,4,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,4,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,4,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,4,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_705 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %slice_706 = cute.slice(%src_partitioned_391, %coord_705) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,5,0)">
      %iter_707 = cute.get_iter(%slice_706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_708, %e1_709, %e2_710, %e3_711 = cute.get_leaves(%iter_707) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %345 = cute.get_scalars(%e0_708) : !cute.int_tuple<"?">
      %346 = cute.get_scalars(%e1_709) : !cute.int_tuple<"?">
      %347 = cute.get_scalars(%e2_710) : !cute.int_tuple<"?">
      %348 = cute.get_scalars(%e3_711) : !cute.int_tuple<"?{div=8}">
      %iter_712 = cute.get_iter(%slice_706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_713, %e1_714, %e2_715, %e3_716 = cute.get_leaves(%iter_712) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %349 = cute.get_scalars(%e0_713) : !cute.int_tuple<"?">
      %350 = cute.get_scalars(%e1_714) : !cute.int_tuple<"?">
      %351 = cute.get_scalars(%e2_715) : !cute.int_tuple<"?">
      %352 = cute.get_scalars(%e3_716) : !cute.int_tuple<"?{div=8}">
      %iter_717 = cute.get_iter(%slice_706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_718, %e1_719, %e2_720, %e3_721 = cute.get_leaves(%iter_717) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %353 = cute.get_scalars(%e0_718) : !cute.int_tuple<"?">
      %354 = cute.get_scalars(%e1_719) : !cute.int_tuple<"?">
      %355 = cute.get_scalars(%e2_720) : !cute.int_tuple<"?">
      %356 = cute.get_scalars(%e3_721) : !cute.int_tuple<"?{div=8}">
      %lay_722 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %357 = cute.get_shape(%lay_722) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_723, %e1_724, %e2_725, %e3_726 = cute.get_leaves(%357) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_727 = cute.to_int_tuple(%e0_723) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %358 = cute.get_scalars(%itup_727) : !cute.int_tuple<"?">
      %itup_728 = cute.to_int_tuple(%e1_724) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %359 = cute.get_scalars(%itup_728) : !cute.int_tuple<"?">
      %itup_729 = cute.to_int_tuple(%e2_725) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %360 = cute.get_scalars(%itup_729) : !cute.int_tuple<"?">
      %itup_730 = cute.to_int_tuple(%e3_726) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %361 = cute.get_scalars(%itup_730) : !cute.int_tuple<"?{div=8}">
      %coord_731 = cute.make_coord(%e1_719) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_732 = cute.make_coord(%itup_728) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %362 = cute.elem_less(%coord_731, %coord_732) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %362 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,5,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,5,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,5,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,5,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_733 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %slice_734 = cute.slice(%src_partitioned_391, %coord_733) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,6,0)">
      %iter_735 = cute.get_iter(%slice_734) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_736, %e1_737, %e2_738, %e3_739 = cute.get_leaves(%iter_735) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %363 = cute.get_scalars(%e0_736) : !cute.int_tuple<"?">
      %364 = cute.get_scalars(%e1_737) : !cute.int_tuple<"?">
      %365 = cute.get_scalars(%e2_738) : !cute.int_tuple<"?">
      %366 = cute.get_scalars(%e3_739) : !cute.int_tuple<"?{div=8}">
      %iter_740 = cute.get_iter(%slice_734) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_741, %e1_742, %e2_743, %e3_744 = cute.get_leaves(%iter_740) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %367 = cute.get_scalars(%e0_741) : !cute.int_tuple<"?">
      %368 = cute.get_scalars(%e1_742) : !cute.int_tuple<"?">
      %369 = cute.get_scalars(%e2_743) : !cute.int_tuple<"?">
      %370 = cute.get_scalars(%e3_744) : !cute.int_tuple<"?{div=8}">
      %iter_745 = cute.get_iter(%slice_734) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_746, %e1_747, %e2_748, %e3_749 = cute.get_leaves(%iter_745) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %371 = cute.get_scalars(%e0_746) : !cute.int_tuple<"?">
      %372 = cute.get_scalars(%e1_747) : !cute.int_tuple<"?">
      %373 = cute.get_scalars(%e2_748) : !cute.int_tuple<"?">
      %374 = cute.get_scalars(%e3_749) : !cute.int_tuple<"?{div=8}">
      %lay_750 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %375 = cute.get_shape(%lay_750) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_751, %e1_752, %e2_753, %e3_754 = cute.get_leaves(%375) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_755 = cute.to_int_tuple(%e0_751) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %376 = cute.get_scalars(%itup_755) : !cute.int_tuple<"?">
      %itup_756 = cute.to_int_tuple(%e1_752) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %377 = cute.get_scalars(%itup_756) : !cute.int_tuple<"?">
      %itup_757 = cute.to_int_tuple(%e2_753) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %378 = cute.get_scalars(%itup_757) : !cute.int_tuple<"?">
      %itup_758 = cute.to_int_tuple(%e3_754) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %379 = cute.get_scalars(%itup_758) : !cute.int_tuple<"?{div=8}">
      %coord_759 = cute.make_coord(%e1_747) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_760 = cute.make_coord(%itup_756) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %380 = cute.elem_less(%coord_759, %coord_760) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %380 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,6,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,6,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,6,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,6,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %coord_761 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %slice_762 = cute.slice(%src_partitioned_391, %coord_761) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,7,0)">
      %iter_763 = cute.get_iter(%slice_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_764, %e1_765, %e2_766, %e3_767 = cute.get_leaves(%iter_763) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %381 = cute.get_scalars(%e0_764) : !cute.int_tuple<"?">
      %382 = cute.get_scalars(%e1_765) : !cute.int_tuple<"?">
      %383 = cute.get_scalars(%e2_766) : !cute.int_tuple<"?">
      %384 = cute.get_scalars(%e3_767) : !cute.int_tuple<"?{div=8}">
      %iter_768 = cute.get_iter(%slice_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_769, %e1_770, %e2_771, %e3_772 = cute.get_leaves(%iter_768) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %385 = cute.get_scalars(%e0_769) : !cute.int_tuple<"?">
      %386 = cute.get_scalars(%e1_770) : !cute.int_tuple<"?">
      %387 = cute.get_scalars(%e2_771) : !cute.int_tuple<"?">
      %388 = cute.get_scalars(%e3_772) : !cute.int_tuple<"?{div=8}">
      %iter_773 = cute.get_iter(%slice_762) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_774, %e1_775, %e2_776, %e3_777 = cute.get_leaves(%iter_773) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %389 = cute.get_scalars(%e0_774) : !cute.int_tuple<"?">
      %390 = cute.get_scalars(%e1_775) : !cute.int_tuple<"?">
      %391 = cute.get_scalars(%e2_776) : !cute.int_tuple<"?">
      %392 = cute.get_scalars(%e3_777) : !cute.int_tuple<"?{div=8}">
      %lay_778 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %393 = cute.get_shape(%lay_778) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_779, %e1_780, %e2_781, %e3_782 = cute.get_leaves(%393) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_783 = cute.to_int_tuple(%e0_779) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %394 = cute.get_scalars(%itup_783) : !cute.int_tuple<"?">
      %itup_784 = cute.to_int_tuple(%e1_780) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %395 = cute.get_scalars(%itup_784) : !cute.int_tuple<"?">
      %itup_785 = cute.to_int_tuple(%e2_781) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %396 = cute.get_scalars(%itup_785) : !cute.int_tuple<"?">
      %itup_786 = cute.to_int_tuple(%e3_782) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %397 = cute.get_scalars(%itup_786) : !cute.int_tuple<"?{div=8}">
      %coord_787 = cute.make_coord(%e1_775) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_788 = cute.make_coord(%itup_784) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %398 = cute.elem_less(%coord_787, %coord_788) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %398 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6240 = cute.slice(%src_partitioned, %coord_6239) : !memref_gmem_bf16_4, !cute.coord<"(_,7,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6243 = cute.slice(%dst_partitioned, %coord_6242) : !memref_smem_bf16_3, !cute.coord<"(_,7,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_11
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6246 = cute.slice(%rmem_418, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,7,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_11
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_11
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_11
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_11
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_12
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_12
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6240 = cute.slice(%dst_partitioned, %coord_6239) : !memref_smem_bf16_3, !cute.coord<"(_,7,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_11
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_11
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_11
      }
      %int_tuple_789 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_790 = cute.size(%int_tuple_789) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_791 = cute.get_leaves(%sz_790) : !cute.int_tuple<"4">
      %coord_792 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %slice_793 = cute.slice(%src_partitioned_398, %coord_792) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)">
      %iter_794 = cute.get_iter(%slice_793) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_795, %e1_796, %e2_797, %e3_798 = cute.get_leaves(%iter_794) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %399 = cute.get_scalars(%e0_795) : !cute.int_tuple<"?">
      %400 = cute.get_scalars(%e1_796) : !cute.int_tuple<"?">
      %401 = cute.get_scalars(%e2_797) : !cute.int_tuple<"?">
      %402 = cute.get_scalars(%e3_798) : !cute.int_tuple<"?{div=8}">
      %iter_799 = cute.get_iter(%slice_793) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_800, %e1_801, %e2_802, %e3_803 = cute.get_leaves(%iter_799) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %403 = cute.get_scalars(%e0_800) : !cute.int_tuple<"?">
      %404 = cute.get_scalars(%e1_801) : !cute.int_tuple<"?">
      %405 = cute.get_scalars(%e2_802) : !cute.int_tuple<"?">
      %406 = cute.get_scalars(%e3_803) : !cute.int_tuple<"?{div=8}">
      %iter_804 = cute.get_iter(%slice_793) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_805, %e1_806, %e2_807, %e3_808 = cute.get_leaves(%iter_804) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %407 = cute.get_scalars(%e0_805) : !cute.int_tuple<"?">
      %408 = cute.get_scalars(%e1_806) : !cute.int_tuple<"?">
      %409 = cute.get_scalars(%e2_807) : !cute.int_tuple<"?">
      %410 = cute.get_scalars(%e3_808) : !cute.int_tuple<"?{div=8}">
      %lay_809 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %411 = cute.get_shape(%lay_809) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_810, %e1_811, %e2_812, %e3_813 = cute.get_leaves(%411) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_814 = cute.to_int_tuple(%e0_810) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %412 = cute.get_scalars(%itup_814) : !cute.int_tuple<"?">
      %itup_815 = cute.to_int_tuple(%e1_811) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %413 = cute.get_scalars(%itup_815) : !cute.int_tuple<"?">
      %itup_816 = cute.to_int_tuple(%e2_812) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %414 = cute.get_scalars(%itup_816) : !cute.int_tuple<"?">
      %itup_817 = cute.to_int_tuple(%e3_813) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %415 = cute.get_scalars(%itup_817) : !cute.int_tuple<"?{div=8}">
      %coord_818 = cute.make_coord(%e1_806) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_819 = cute.make_coord(%itup_815) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %416 = cute.elem_less(%coord_818, %coord_819) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %416 {
        %coord_6239 = cute.make_coord(%127) : (i32) -> !cute.coord<"(_,0,_,?)">
        %slice_6240 = cute.slice(%src_partitioned_233, %coord_6239) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6243 = cute.slice(%dst_partitioned_236, %coord_6242) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_13
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6246 = cute.slice(%rmem_435, %coord_6245) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_13
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_13
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_13
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_14
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6240 = cute.slice(%dst_partitioned_236, %coord_6239) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_13
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_13
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_13
      }
      %coord_820 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %slice_821 = cute.slice(%src_partitioned_398, %coord_820) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)">
      %iter_822 = cute.get_iter(%slice_821) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_823, %e1_824, %e2_825, %e3_826 = cute.get_leaves(%iter_822) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %417 = cute.get_scalars(%e0_823) : !cute.int_tuple<"?">
      %418 = cute.get_scalars(%e1_824) : !cute.int_tuple<"?">
      %419 = cute.get_scalars(%e2_825) : !cute.int_tuple<"?">
      %420 = cute.get_scalars(%e3_826) : !cute.int_tuple<"?{div=8}">
      %iter_827 = cute.get_iter(%slice_821) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_828, %e1_829, %e2_830, %e3_831 = cute.get_leaves(%iter_827) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %421 = cute.get_scalars(%e0_828) : !cute.int_tuple<"?">
      %422 = cute.get_scalars(%e1_829) : !cute.int_tuple<"?">
      %423 = cute.get_scalars(%e2_830) : !cute.int_tuple<"?">
      %424 = cute.get_scalars(%e3_831) : !cute.int_tuple<"?{div=8}">
      %iter_832 = cute.get_iter(%slice_821) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_833, %e1_834, %e2_835, %e3_836 = cute.get_leaves(%iter_832) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %425 = cute.get_scalars(%e0_833) : !cute.int_tuple<"?">
      %426 = cute.get_scalars(%e1_834) : !cute.int_tuple<"?">
      %427 = cute.get_scalars(%e2_835) : !cute.int_tuple<"?">
      %428 = cute.get_scalars(%e3_836) : !cute.int_tuple<"?{div=8}">
      %lay_837 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %429 = cute.get_shape(%lay_837) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_838, %e1_839, %e2_840, %e3_841 = cute.get_leaves(%429) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_842 = cute.to_int_tuple(%e0_838) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %430 = cute.get_scalars(%itup_842) : !cute.int_tuple<"?">
      %itup_843 = cute.to_int_tuple(%e1_839) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %431 = cute.get_scalars(%itup_843) : !cute.int_tuple<"?">
      %itup_844 = cute.to_int_tuple(%e2_840) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %432 = cute.get_scalars(%itup_844) : !cute.int_tuple<"?">
      %itup_845 = cute.to_int_tuple(%e3_841) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %433 = cute.get_scalars(%itup_845) : !cute.int_tuple<"?{div=8}">
      %coord_846 = cute.make_coord(%e1_834) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_847 = cute.make_coord(%itup_843) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %434 = cute.elem_less(%coord_846, %coord_847) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %434 {
        %coord_6239 = cute.make_coord(%127) : (i32) -> !cute.coord<"(_,1,_,?)">
        %slice_6240 = cute.slice(%src_partitioned_233, %coord_6239) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6243 = cute.slice(%dst_partitioned_236, %coord_6242) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_13
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6246 = cute.slice(%rmem_435, %coord_6245) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_13
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_13
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_13
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_14
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6240 = cute.slice(%dst_partitioned_236, %coord_6239) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_13
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_13
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_13
      }
      %coord_848 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %slice_849 = cute.slice(%src_partitioned_398, %coord_848) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)">
      %iter_850 = cute.get_iter(%slice_849) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_851, %e1_852, %e2_853, %e3_854 = cute.get_leaves(%iter_850) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %435 = cute.get_scalars(%e0_851) : !cute.int_tuple<"?">
      %436 = cute.get_scalars(%e1_852) : !cute.int_tuple<"?">
      %437 = cute.get_scalars(%e2_853) : !cute.int_tuple<"?">
      %438 = cute.get_scalars(%e3_854) : !cute.int_tuple<"?{div=8}">
      %iter_855 = cute.get_iter(%slice_849) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_856, %e1_857, %e2_858, %e3_859 = cute.get_leaves(%iter_855) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %439 = cute.get_scalars(%e0_856) : !cute.int_tuple<"?">
      %440 = cute.get_scalars(%e1_857) : !cute.int_tuple<"?">
      %441 = cute.get_scalars(%e2_858) : !cute.int_tuple<"?">
      %442 = cute.get_scalars(%e3_859) : !cute.int_tuple<"?{div=8}">
      %iter_860 = cute.get_iter(%slice_849) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_861, %e1_862, %e2_863, %e3_864 = cute.get_leaves(%iter_860) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %443 = cute.get_scalars(%e0_861) : !cute.int_tuple<"?">
      %444 = cute.get_scalars(%e1_862) : !cute.int_tuple<"?">
      %445 = cute.get_scalars(%e2_863) : !cute.int_tuple<"?">
      %446 = cute.get_scalars(%e3_864) : !cute.int_tuple<"?{div=8}">
      %lay_865 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %447 = cute.get_shape(%lay_865) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_866, %e1_867, %e2_868, %e3_869 = cute.get_leaves(%447) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_870 = cute.to_int_tuple(%e0_866) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %448 = cute.get_scalars(%itup_870) : !cute.int_tuple<"?">
      %itup_871 = cute.to_int_tuple(%e1_867) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %449 = cute.get_scalars(%itup_871) : !cute.int_tuple<"?">
      %itup_872 = cute.to_int_tuple(%e2_868) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %450 = cute.get_scalars(%itup_872) : !cute.int_tuple<"?">
      %itup_873 = cute.to_int_tuple(%e3_869) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %451 = cute.get_scalars(%itup_873) : !cute.int_tuple<"?{div=8}">
      %coord_874 = cute.make_coord(%e1_862) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_875 = cute.make_coord(%itup_871) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %452 = cute.elem_less(%coord_874, %coord_875) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %452 {
        %coord_6239 = cute.make_coord(%127) : (i32) -> !cute.coord<"(_,2,_,?)">
        %slice_6240 = cute.slice(%src_partitioned_233, %coord_6239) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6243 = cute.slice(%dst_partitioned_236, %coord_6242) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_13
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6246 = cute.slice(%rmem_435, %coord_6245) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_13
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_13
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_13
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_14
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6240 = cute.slice(%dst_partitioned_236, %coord_6239) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_13
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_13
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_13
      }
      %coord_876 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %slice_877 = cute.slice(%src_partitioned_398, %coord_876) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)">
      %iter_878 = cute.get_iter(%slice_877) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_879, %e1_880, %e2_881, %e3_882 = cute.get_leaves(%iter_878) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %453 = cute.get_scalars(%e0_879) : !cute.int_tuple<"?">
      %454 = cute.get_scalars(%e1_880) : !cute.int_tuple<"?">
      %455 = cute.get_scalars(%e2_881) : !cute.int_tuple<"?">
      %456 = cute.get_scalars(%e3_882) : !cute.int_tuple<"?{div=8}">
      %iter_883 = cute.get_iter(%slice_877) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_884, %e1_885, %e2_886, %e3_887 = cute.get_leaves(%iter_883) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %457 = cute.get_scalars(%e0_884) : !cute.int_tuple<"?">
      %458 = cute.get_scalars(%e1_885) : !cute.int_tuple<"?">
      %459 = cute.get_scalars(%e2_886) : !cute.int_tuple<"?">
      %460 = cute.get_scalars(%e3_887) : !cute.int_tuple<"?{div=8}">
      %iter_888 = cute.get_iter(%slice_877) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_889, %e1_890, %e2_891, %e3_892 = cute.get_leaves(%iter_888) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %461 = cute.get_scalars(%e0_889) : !cute.int_tuple<"?">
      %462 = cute.get_scalars(%e1_890) : !cute.int_tuple<"?">
      %463 = cute.get_scalars(%e2_891) : !cute.int_tuple<"?">
      %464 = cute.get_scalars(%e3_892) : !cute.int_tuple<"?{div=8}">
      %lay_893 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %465 = cute.get_shape(%lay_893) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_894, %e1_895, %e2_896, %e3_897 = cute.get_leaves(%465) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_898 = cute.to_int_tuple(%e0_894) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %466 = cute.get_scalars(%itup_898) : !cute.int_tuple<"?">
      %itup_899 = cute.to_int_tuple(%e1_895) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %467 = cute.get_scalars(%itup_899) : !cute.int_tuple<"?">
      %itup_900 = cute.to_int_tuple(%e2_896) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %468 = cute.get_scalars(%itup_900) : !cute.int_tuple<"?">
      %itup_901 = cute.to_int_tuple(%e3_897) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %469 = cute.get_scalars(%itup_901) : !cute.int_tuple<"?{div=8}">
      %coord_902 = cute.make_coord(%e1_890) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_903 = cute.make_coord(%itup_899) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %470 = cute.elem_less(%coord_902, %coord_903) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %470 {
        %coord_6239 = cute.make_coord(%127) : (i32) -> !cute.coord<"(_,3,_,?)">
        %slice_6240 = cute.slice(%src_partitioned_233, %coord_6239) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_6
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6243 = cute.slice(%dst_partitioned_236, %coord_6242) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_smem_bf16_13
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6246 = cute.slice(%rmem_435, %coord_6245) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_6
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_gmem_bf16_6
        %iter_6261 = cute.get_iter(%view_6260) : !memref_gmem_bf16_6
        %lay_6262 = cute.get_layout(%view_6260) : !memref_gmem_bf16_6
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_gmem_bf16_7
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_smem_bf16_13
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_smem_bf16_13
        %iter_6274 = cute.get_iter(%view_6273) : !memref_smem_bf16_13
        %lay_6275 = cute.get_layout(%view_6273) : !memref_smem_bf16_13
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_smem_bf16_14
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_gmem_bf16_7
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_smem_bf16_14
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%3, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
      } else {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6240 = cute.slice(%dst_partitioned_236, %coord_6239) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_smem_bf16_13
        %sz_6242 = cute.size(%slice_6240) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
        %e0_6243 = cute.get_leaves(%sz_6242) : !cute.int_tuple<"16">
        %lay_6244 = cute.get_layout(%slice_6240) : !memref_smem_bf16_13
        %2344 = cute.get_shape(%lay_6244) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6245, %e1_6246, %e2_6247 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %int_tuple_6248 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_6249 = cute.tuple.product(%int_tuple_6248) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6250 = cute.get_leaves(%res_6249) : !cute.int_tuple<"16">
        %cst_6251 = arith.constant 0.000000e+00 : bf16
        %2345 = vector.splat %cst_6251 : vector<16xbf16>
        %int_tuple_6252 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6253 = cute.size(%int_tuple_6252) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6254 = cute.get_leaves(%sz_6253) : !cute.int_tuple<"16">
        %int_tuple_6255 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_6256 = cute.size(%int_tuple_6255) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_6257 = cute.get_leaves(%sz_6256) : !cute.int_tuple<"16">
        cute.memref.store_vec %2345, %slice_6240, row_major : !memref_smem_bf16_13
      }
      nvvm.cp.async.commit.group
      %shape_904 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_905 = cute.make_layout(%shape_904) : !cute.layout<"4:1">
      %rmem_906 = cute.memref.alloca(%lay_905) : !memref_rmem_f32_1
      %iter_907 = cute.get_iter(%rmem_906) : !memref_rmem_f32_1
      %iter_908 = cute.get_iter(%rmem_906) : !memref_rmem_f32_1
      %shape_909 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_910 = cute.make_layout(%shape_909) : !cute.layout<"4:1">
      %rmem_911 = cute.memref.alloca(%lay_910) : !memref_rmem_f32_1
      %iter_912 = cute.get_iter(%rmem_911) : !memref_rmem_f32_1
      %iter_913 = cute.get_iter(%rmem_911) : !memref_rmem_f32_1
      %sz_914 = cute.size(%rmem_906) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4">
      %e0_915 = cute.get_leaves(%sz_914) : !cute.int_tuple<"4">
      %lay_916 = cute.get_layout(%rmem_906) : !memref_rmem_f32_1
      %471 = cute.get_shape(%lay_916) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_917 = cute.get_leaves(%471) : !cute.shape<"4">
      %cst_918 = arith.constant 0xFF800000 : f32
      %472 = vector.splat %cst_918 : vector<4xf32>
      %int_tuple_919 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_920 = cute.size(%int_tuple_919) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_921 = cute.get_leaves(%sz_920) : !cute.int_tuple<"4">
      %int_tuple_922 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_923 = cute.size(%int_tuple_922) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_924 = cute.get_leaves(%sz_923) : !cute.int_tuple<"4">
      cute.memref.store_vec %472, %rmem_906, row_major : !memref_rmem_f32_1
      %sz_925 = cute.size(%rmem_911) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4">
      %e0_926 = cute.get_leaves(%sz_925) : !cute.int_tuple<"4">
      %lay_927 = cute.get_layout(%rmem_911) : !memref_rmem_f32_1
      %473 = cute.get_shape(%lay_927) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_928 = cute.get_leaves(%473) : !cute.shape<"4">
      %cst_929 = arith.constant 0.000000e+00 : f32
      %474 = vector.splat %cst_929 : vector<4xf32>
      %int_tuple_930 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_931 = cute.size(%int_tuple_930) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_932 = cute.get_leaves(%sz_931) : !cute.int_tuple<"4">
      %int_tuple_933 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_934 = cute.size(%int_tuple_933) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_935 = cute.get_leaves(%sz_934) : !cute.int_tuple<"4">
      cute.memref.store_vec %474, %rmem_911, row_major : !memref_rmem_f32_1
      %c0_i32 = arith.constant 0 : i32
      %475 = arith.subi %126, %c0_i32 : i32
      %476 = arith.subi %475, %c1_i32 : i32
      %shape_936 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %477 = cute.tiled.mma.partition_shape C (%5, %shape_936) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
      %e0_937, %e1_938, %e2_939, %e3_940 = cute.get_leaves(%477) : !cute.shape<"((2,2),2,8)">
      %shape_941 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_942 = cute.make_layout(%shape_941) : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_943 = cute.memref.alloca(%lay_942) : !memref_rmem_f32_2
      %iter_944 = cute.get_iter(%rmem_943) : !memref_rmem_f32_2
      %iter_945 = cute.get_iter(%rmem_943) : !memref_rmem_f32_2
      %sz_946 = cute.size(%rmem_943) : (!memref_rmem_f32_2) -> !cute.int_tuple<"64">
      %e0_947 = cute.get_leaves(%sz_946) : !cute.int_tuple<"64">
      %lay_948 = cute.get_layout(%rmem_943) : !memref_rmem_f32_2
      %478 = cute.get_shape(%lay_948) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_949, %e1_950, %e2_951, %e3_952 = cute.get_leaves(%478) : !cute.shape<"((2,2),2,8)">
      %int_tuple_953 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %res_954 = cute.tuple.product(%int_tuple_953) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_955 = cute.get_leaves(%res_954) : !cute.int_tuple<"64">
      %cst_956 = arith.constant 0.000000e+00 : f32
      %479 = vector.splat %cst_956 : vector<64xf32>
      %int_tuple_957 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_958 = cute.size(%int_tuple_957) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_959 = cute.get_leaves(%sz_958) : !cute.int_tuple<"64">
      %int_tuple_960 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_961 = cute.size(%int_tuple_960) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_962 = cute.get_leaves(%sz_961) : !cute.int_tuple<"64">
      cute.memref.store_vec %479, %rmem_943, row_major : !memref_rmem_f32_2
      nvvm.cp.async.wait.group 0
      %c1_i32_963 = arith.constant 1 : i32
      %c128_i32 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_963 number_of_threads = %c128_i32
      %true = arith.constant true
      scf.if %true {
        %lay_6239 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
        %2344 = cute.get_shape(%lay_6239) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6240, %e1_6241, %e2_6242, %e3_6243 = cute.get_leaves(%2344) : !cute.shape<"((8,1),4,2)">
        %int_tuple_6244 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_6245 = cute.size(%int_tuple_6244) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_6246 = cute.get_leaves(%sz_6245) : !cute.int_tuple<"4">
        %coord_6247 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
        %slice_6248 = cute.slice(%src_partitioned_398, %coord_6247) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)">
        %iter_6249 = cute.get_iter(%slice_6248) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6250, %e1_6251, %e2_6252, %e3_6253 = cute.get_leaves(%iter_6249) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2345 = cute.get_scalars(%e0_6250) : !cute.int_tuple<"?">
        %2346 = cute.get_scalars(%e1_6251) : !cute.int_tuple<"?">
        %2347 = cute.get_scalars(%e2_6252) : !cute.int_tuple<"?">
        %2348 = cute.get_scalars(%e3_6253) : !cute.int_tuple<"?{div=8}">
        %iter_6254 = cute.get_iter(%slice_6248) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6255, %e1_6256, %e2_6257, %e3_6258 = cute.get_leaves(%iter_6254) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2349 = cute.get_scalars(%e0_6255) : !cute.int_tuple<"?">
        %2350 = cute.get_scalars(%e1_6256) : !cute.int_tuple<"?">
        %2351 = cute.get_scalars(%e2_6257) : !cute.int_tuple<"?">
        %2352 = cute.get_scalars(%e3_6258) : !cute.int_tuple<"?{div=8}">
        %iter_6259 = cute.get_iter(%slice_6248) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6260, %e1_6261, %e2_6262, %e3_6263 = cute.get_leaves(%iter_6259) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2353 = cute.get_scalars(%e0_6260) : !cute.int_tuple<"?">
        %2354 = cute.get_scalars(%e1_6261) : !cute.int_tuple<"?">
        %2355 = cute.get_scalars(%e2_6262) : !cute.int_tuple<"?">
        %2356 = cute.get_scalars(%e3_6263) : !cute.int_tuple<"?{div=8}">
        %lay_6264 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2357 = cute.get_shape(%lay_6264) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6265, %e1_6266, %e2_6267, %e3_6268 = cute.get_leaves(%2357) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6269 = cute.to_int_tuple(%e0_6265) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2358 = cute.get_scalars(%itup_6269) : !cute.int_tuple<"?">
        %itup_6270 = cute.to_int_tuple(%e1_6266) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2359 = cute.get_scalars(%itup_6270) : !cute.int_tuple<"?">
        %itup_6271 = cute.to_int_tuple(%e2_6267) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2360 = cute.get_scalars(%itup_6271) : !cute.int_tuple<"?">
        %itup_6272 = cute.to_int_tuple(%e3_6268) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2361 = cute.get_scalars(%itup_6272) : !cute.int_tuple<"?{div=8}">
        %coord_6273 = cute.make_coord(%e1_6261) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_6274 = cute.make_coord(%itup_6270) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2362 = cute.elem_less(%coord_6273, %coord_6274) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2362 {
          %coord_6359 = cute.make_coord(%476) : (i32) -> !cute.coord<"(_,0,_,?)">
          %slice_6360 = cute.slice(%src_partitioned_239, %coord_6359) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_gmem_bf16_6
          %coord_6362 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %slice_6363 = cute.slice(%dst_partitioned_242, %coord_6362) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
          %iter_6364 = cute.get_iter(%slice_6363) : !memref_smem_bf16_13
          %coord_6365 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %slice_6366 = cute.slice(%rmem_435, %coord_6365) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)">
          %iter_6367 = cute.get_iter(%slice_6366) : !memref_rmem_i8_2
          %lay_6368 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %2417 = cute.get_shape(%lay_6368) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6369, %e1_6370, %e2_6371 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %lay_6372 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %2418 = cute.get_shape(%lay_6372) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6373, %e1_6374, %e2_6375 = cute.get_leaves(%2418) : !cute.shape<"((8,1),2)">
          %lay_6376 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %shape_6377 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6378 = cute.make_layout(%shape_6377) : !cute.layout<"1:0">
          %append_6379 = cute.append_to_rank<2> (%lay_6376, %lay_6378) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_6380 = cute.make_view(%iter_6361, %append_6379) : !memref_gmem_bf16_6
          %iter_6381 = cute.get_iter(%view_6380) : !memref_gmem_bf16_6
          %lay_6382 = cute.get_layout(%view_6380) : !memref_gmem_bf16_6
          %2419 = cute.get_shape(%lay_6382) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6383, %e1_6384, %e2_6385 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)">
          %grouped_6386 = cute.group_modes(%view_6380) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
          %iter_6387 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %iter_6388 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %lay_6389 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %shape_6390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6391 = cute.make_layout(%shape_6390) : !cute.layout<"1:0">
          %append_6392 = cute.append_to_rank<2> (%lay_6389, %lay_6391) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_6393 = cute.make_view(%iter_6364, %append_6392) : !memref_smem_bf16_13
          %iter_6394 = cute.get_iter(%view_6393) : !memref_smem_bf16_13
          %lay_6395 = cute.get_layout(%view_6393) : !memref_smem_bf16_13
          %2420 = cute.get_shape(%lay_6395) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6396, %e1_6397, %e2_6398 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)">
          %grouped_6399 = cute.group_modes(%view_6393) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
          %iter_6400 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %iter_6401 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %lay_6402 = cute.get_layout(%slice_6366) : !memref_rmem_i8_2
          %shape_6403 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6404 = cute.make_layout(%shape_6403) : !cute.layout<"1:0">
          %append_6405 = cute.append_to_rank<2> (%lay_6402, %lay_6404) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_6406 = cute.make_view(%iter_6367, %append_6405) : !memref_rmem_i8_2
          %iter_6407 = cute.get_iter(%view_6406) : !memref_rmem_i8_2
          %lay_6408 = cute.get_layout(%view_6406) : !memref_rmem_i8_2
          %2421 = cute.get_shape(%lay_6408) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_6409, %e1_6410 = cute.get_leaves(%2421) : !cute.shape<"(1,2)">
          %grouped_6411 = cute.group_modes(%view_6406) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
          %iter_6412 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %iter_6413 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %lay_6414 = cute.get_layout(%grouped_6386) : !memref_gmem_bf16_7
          %2422 = cute.get_shape(%lay_6414) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_6415, %e1_6416, %e2_6417 = cute.get_leaves(%2422) : !cute.shape<"((8,1),(2))">
          %lay_6418 = cute.get_layout(%grouped_6399) : !memref_smem_bf16_14
          %2423 = cute.get_shape(%lay_6418) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_6419, %e1_6420, %e2_6421 = cute.get_leaves(%2423) : !cute.shape<"((8,1),(2))">
          %sz_6422 = cute.size(%grouped_6386) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
          %e0_6423 = cute.get_leaves(%sz_6422) : !cute.int_tuple<"2">
          %sz_6424 = cute.size(%grouped_6399) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
          %e0_6425 = cute.get_leaves(%sz_6424) : !cute.int_tuple<"2">
          cute.copy(%3, %grouped_6386, %grouped_6399, %grouped_6411) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
        } else {
          %coord_6359 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %slice_6360 = cute.slice(%dst_partitioned_242, %coord_6359) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_smem_bf16_13
          %sz_6362 = cute.size(%slice_6360) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
          %e0_6363 = cute.get_leaves(%sz_6362) : !cute.int_tuple<"16">
          %lay_6364 = cute.get_layout(%slice_6360) : !memref_smem_bf16_13
          %2417 = cute.get_shape(%lay_6364) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6365, %e1_6366, %e2_6367 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %int_tuple_6368 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_6369 = cute.tuple.product(%int_tuple_6368) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6370 = cute.get_leaves(%res_6369) : !cute.int_tuple<"16">
          %cst_6371 = arith.constant 0.000000e+00 : bf16
          %2418 = vector.splat %cst_6371 : vector<16xbf16>
          %int_tuple_6372 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6373 = cute.size(%int_tuple_6372) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6374 = cute.get_leaves(%sz_6373) : !cute.int_tuple<"16">
          %int_tuple_6375 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6376 = cute.size(%int_tuple_6375) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6377 = cute.get_leaves(%sz_6376) : !cute.int_tuple<"16">
          cute.memref.store_vec %2418, %slice_6360, row_major : !memref_smem_bf16_13
        }
        %coord_6275 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
        %slice_6276 = cute.slice(%src_partitioned_398, %coord_6275) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)">
        %iter_6277 = cute.get_iter(%slice_6276) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6278, %e1_6279, %e2_6280, %e3_6281 = cute.get_leaves(%iter_6277) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2363 = cute.get_scalars(%e0_6278) : !cute.int_tuple<"?">
        %2364 = cute.get_scalars(%e1_6279) : !cute.int_tuple<"?">
        %2365 = cute.get_scalars(%e2_6280) : !cute.int_tuple<"?">
        %2366 = cute.get_scalars(%e3_6281) : !cute.int_tuple<"?{div=8}">
        %iter_6282 = cute.get_iter(%slice_6276) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6283, %e1_6284, %e2_6285, %e3_6286 = cute.get_leaves(%iter_6282) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2367 = cute.get_scalars(%e0_6283) : !cute.int_tuple<"?">
        %2368 = cute.get_scalars(%e1_6284) : !cute.int_tuple<"?">
        %2369 = cute.get_scalars(%e2_6285) : !cute.int_tuple<"?">
        %2370 = cute.get_scalars(%e3_6286) : !cute.int_tuple<"?{div=8}">
        %iter_6287 = cute.get_iter(%slice_6276) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6288, %e1_6289, %e2_6290, %e3_6291 = cute.get_leaves(%iter_6287) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2371 = cute.get_scalars(%e0_6288) : !cute.int_tuple<"?">
        %2372 = cute.get_scalars(%e1_6289) : !cute.int_tuple<"?">
        %2373 = cute.get_scalars(%e2_6290) : !cute.int_tuple<"?">
        %2374 = cute.get_scalars(%e3_6291) : !cute.int_tuple<"?{div=8}">
        %lay_6292 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2375 = cute.get_shape(%lay_6292) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6293, %e1_6294, %e2_6295, %e3_6296 = cute.get_leaves(%2375) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6297 = cute.to_int_tuple(%e0_6293) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2376 = cute.get_scalars(%itup_6297) : !cute.int_tuple<"?">
        %itup_6298 = cute.to_int_tuple(%e1_6294) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2377 = cute.get_scalars(%itup_6298) : !cute.int_tuple<"?">
        %itup_6299 = cute.to_int_tuple(%e2_6295) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2378 = cute.get_scalars(%itup_6299) : !cute.int_tuple<"?">
        %itup_6300 = cute.to_int_tuple(%e3_6296) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2379 = cute.get_scalars(%itup_6300) : !cute.int_tuple<"?{div=8}">
        %coord_6301 = cute.make_coord(%e1_6289) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_6302 = cute.make_coord(%itup_6298) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2380 = cute.elem_less(%coord_6301, %coord_6302) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2380 {
          %coord_6359 = cute.make_coord(%476) : (i32) -> !cute.coord<"(_,1,_,?)">
          %slice_6360 = cute.slice(%src_partitioned_239, %coord_6359) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_gmem_bf16_6
          %coord_6362 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %slice_6363 = cute.slice(%dst_partitioned_242, %coord_6362) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
          %iter_6364 = cute.get_iter(%slice_6363) : !memref_smem_bf16_13
          %coord_6365 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %slice_6366 = cute.slice(%rmem_435, %coord_6365) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)">
          %iter_6367 = cute.get_iter(%slice_6366) : !memref_rmem_i8_2
          %lay_6368 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %2417 = cute.get_shape(%lay_6368) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6369, %e1_6370, %e2_6371 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %lay_6372 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %2418 = cute.get_shape(%lay_6372) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6373, %e1_6374, %e2_6375 = cute.get_leaves(%2418) : !cute.shape<"((8,1),2)">
          %lay_6376 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %shape_6377 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6378 = cute.make_layout(%shape_6377) : !cute.layout<"1:0">
          %append_6379 = cute.append_to_rank<2> (%lay_6376, %lay_6378) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_6380 = cute.make_view(%iter_6361, %append_6379) : !memref_gmem_bf16_6
          %iter_6381 = cute.get_iter(%view_6380) : !memref_gmem_bf16_6
          %lay_6382 = cute.get_layout(%view_6380) : !memref_gmem_bf16_6
          %2419 = cute.get_shape(%lay_6382) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6383, %e1_6384, %e2_6385 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)">
          %grouped_6386 = cute.group_modes(%view_6380) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
          %iter_6387 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %iter_6388 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %lay_6389 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %shape_6390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6391 = cute.make_layout(%shape_6390) : !cute.layout<"1:0">
          %append_6392 = cute.append_to_rank<2> (%lay_6389, %lay_6391) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_6393 = cute.make_view(%iter_6364, %append_6392) : !memref_smem_bf16_13
          %iter_6394 = cute.get_iter(%view_6393) : !memref_smem_bf16_13
          %lay_6395 = cute.get_layout(%view_6393) : !memref_smem_bf16_13
          %2420 = cute.get_shape(%lay_6395) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6396, %e1_6397, %e2_6398 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)">
          %grouped_6399 = cute.group_modes(%view_6393) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
          %iter_6400 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %iter_6401 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %lay_6402 = cute.get_layout(%slice_6366) : !memref_rmem_i8_2
          %shape_6403 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6404 = cute.make_layout(%shape_6403) : !cute.layout<"1:0">
          %append_6405 = cute.append_to_rank<2> (%lay_6402, %lay_6404) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_6406 = cute.make_view(%iter_6367, %append_6405) : !memref_rmem_i8_2
          %iter_6407 = cute.get_iter(%view_6406) : !memref_rmem_i8_2
          %lay_6408 = cute.get_layout(%view_6406) : !memref_rmem_i8_2
          %2421 = cute.get_shape(%lay_6408) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_6409, %e1_6410 = cute.get_leaves(%2421) : !cute.shape<"(1,2)">
          %grouped_6411 = cute.group_modes(%view_6406) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
          %iter_6412 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %iter_6413 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %lay_6414 = cute.get_layout(%grouped_6386) : !memref_gmem_bf16_7
          %2422 = cute.get_shape(%lay_6414) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_6415, %e1_6416, %e2_6417 = cute.get_leaves(%2422) : !cute.shape<"((8,1),(2))">
          %lay_6418 = cute.get_layout(%grouped_6399) : !memref_smem_bf16_14
          %2423 = cute.get_shape(%lay_6418) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_6419, %e1_6420, %e2_6421 = cute.get_leaves(%2423) : !cute.shape<"((8,1),(2))">
          %sz_6422 = cute.size(%grouped_6386) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
          %e0_6423 = cute.get_leaves(%sz_6422) : !cute.int_tuple<"2">
          %sz_6424 = cute.size(%grouped_6399) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
          %e0_6425 = cute.get_leaves(%sz_6424) : !cute.int_tuple<"2">
          cute.copy(%3, %grouped_6386, %grouped_6399, %grouped_6411) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
        } else {
          %coord_6359 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %slice_6360 = cute.slice(%dst_partitioned_242, %coord_6359) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_smem_bf16_13
          %sz_6362 = cute.size(%slice_6360) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
          %e0_6363 = cute.get_leaves(%sz_6362) : !cute.int_tuple<"16">
          %lay_6364 = cute.get_layout(%slice_6360) : !memref_smem_bf16_13
          %2417 = cute.get_shape(%lay_6364) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6365, %e1_6366, %e2_6367 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %int_tuple_6368 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_6369 = cute.tuple.product(%int_tuple_6368) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6370 = cute.get_leaves(%res_6369) : !cute.int_tuple<"16">
          %cst_6371 = arith.constant 0.000000e+00 : bf16
          %2418 = vector.splat %cst_6371 : vector<16xbf16>
          %int_tuple_6372 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6373 = cute.size(%int_tuple_6372) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6374 = cute.get_leaves(%sz_6373) : !cute.int_tuple<"16">
          %int_tuple_6375 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6376 = cute.size(%int_tuple_6375) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6377 = cute.get_leaves(%sz_6376) : !cute.int_tuple<"16">
          cute.memref.store_vec %2418, %slice_6360, row_major : !memref_smem_bf16_13
        }
        %coord_6303 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
        %slice_6304 = cute.slice(%src_partitioned_398, %coord_6303) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)">
        %iter_6305 = cute.get_iter(%slice_6304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6306, %e1_6307, %e2_6308, %e3_6309 = cute.get_leaves(%iter_6305) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2381 = cute.get_scalars(%e0_6306) : !cute.int_tuple<"?">
        %2382 = cute.get_scalars(%e1_6307) : !cute.int_tuple<"?">
        %2383 = cute.get_scalars(%e2_6308) : !cute.int_tuple<"?">
        %2384 = cute.get_scalars(%e3_6309) : !cute.int_tuple<"?{div=8}">
        %iter_6310 = cute.get_iter(%slice_6304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6311, %e1_6312, %e2_6313, %e3_6314 = cute.get_leaves(%iter_6310) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2385 = cute.get_scalars(%e0_6311) : !cute.int_tuple<"?">
        %2386 = cute.get_scalars(%e1_6312) : !cute.int_tuple<"?">
        %2387 = cute.get_scalars(%e2_6313) : !cute.int_tuple<"?">
        %2388 = cute.get_scalars(%e3_6314) : !cute.int_tuple<"?{div=8}">
        %iter_6315 = cute.get_iter(%slice_6304) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6316, %e1_6317, %e2_6318, %e3_6319 = cute.get_leaves(%iter_6315) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2389 = cute.get_scalars(%e0_6316) : !cute.int_tuple<"?">
        %2390 = cute.get_scalars(%e1_6317) : !cute.int_tuple<"?">
        %2391 = cute.get_scalars(%e2_6318) : !cute.int_tuple<"?">
        %2392 = cute.get_scalars(%e3_6319) : !cute.int_tuple<"?{div=8}">
        %lay_6320 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2393 = cute.get_shape(%lay_6320) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6321, %e1_6322, %e2_6323, %e3_6324 = cute.get_leaves(%2393) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6325 = cute.to_int_tuple(%e0_6321) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2394 = cute.get_scalars(%itup_6325) : !cute.int_tuple<"?">
        %itup_6326 = cute.to_int_tuple(%e1_6322) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2395 = cute.get_scalars(%itup_6326) : !cute.int_tuple<"?">
        %itup_6327 = cute.to_int_tuple(%e2_6323) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2396 = cute.get_scalars(%itup_6327) : !cute.int_tuple<"?">
        %itup_6328 = cute.to_int_tuple(%e3_6324) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2397 = cute.get_scalars(%itup_6328) : !cute.int_tuple<"?{div=8}">
        %coord_6329 = cute.make_coord(%e1_6317) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_6330 = cute.make_coord(%itup_6326) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2398 = cute.elem_less(%coord_6329, %coord_6330) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2398 {
          %coord_6359 = cute.make_coord(%476) : (i32) -> !cute.coord<"(_,2,_,?)">
          %slice_6360 = cute.slice(%src_partitioned_239, %coord_6359) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_gmem_bf16_6
          %coord_6362 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %slice_6363 = cute.slice(%dst_partitioned_242, %coord_6362) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
          %iter_6364 = cute.get_iter(%slice_6363) : !memref_smem_bf16_13
          %coord_6365 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %slice_6366 = cute.slice(%rmem_435, %coord_6365) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)">
          %iter_6367 = cute.get_iter(%slice_6366) : !memref_rmem_i8_2
          %lay_6368 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %2417 = cute.get_shape(%lay_6368) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6369, %e1_6370, %e2_6371 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %lay_6372 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %2418 = cute.get_shape(%lay_6372) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6373, %e1_6374, %e2_6375 = cute.get_leaves(%2418) : !cute.shape<"((8,1),2)">
          %lay_6376 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %shape_6377 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6378 = cute.make_layout(%shape_6377) : !cute.layout<"1:0">
          %append_6379 = cute.append_to_rank<2> (%lay_6376, %lay_6378) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_6380 = cute.make_view(%iter_6361, %append_6379) : !memref_gmem_bf16_6
          %iter_6381 = cute.get_iter(%view_6380) : !memref_gmem_bf16_6
          %lay_6382 = cute.get_layout(%view_6380) : !memref_gmem_bf16_6
          %2419 = cute.get_shape(%lay_6382) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6383, %e1_6384, %e2_6385 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)">
          %grouped_6386 = cute.group_modes(%view_6380) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
          %iter_6387 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %iter_6388 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %lay_6389 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %shape_6390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6391 = cute.make_layout(%shape_6390) : !cute.layout<"1:0">
          %append_6392 = cute.append_to_rank<2> (%lay_6389, %lay_6391) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_6393 = cute.make_view(%iter_6364, %append_6392) : !memref_smem_bf16_13
          %iter_6394 = cute.get_iter(%view_6393) : !memref_smem_bf16_13
          %lay_6395 = cute.get_layout(%view_6393) : !memref_smem_bf16_13
          %2420 = cute.get_shape(%lay_6395) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6396, %e1_6397, %e2_6398 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)">
          %grouped_6399 = cute.group_modes(%view_6393) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
          %iter_6400 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %iter_6401 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %lay_6402 = cute.get_layout(%slice_6366) : !memref_rmem_i8_2
          %shape_6403 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6404 = cute.make_layout(%shape_6403) : !cute.layout<"1:0">
          %append_6405 = cute.append_to_rank<2> (%lay_6402, %lay_6404) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_6406 = cute.make_view(%iter_6367, %append_6405) : !memref_rmem_i8_2
          %iter_6407 = cute.get_iter(%view_6406) : !memref_rmem_i8_2
          %lay_6408 = cute.get_layout(%view_6406) : !memref_rmem_i8_2
          %2421 = cute.get_shape(%lay_6408) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_6409, %e1_6410 = cute.get_leaves(%2421) : !cute.shape<"(1,2)">
          %grouped_6411 = cute.group_modes(%view_6406) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
          %iter_6412 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %iter_6413 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %lay_6414 = cute.get_layout(%grouped_6386) : !memref_gmem_bf16_7
          %2422 = cute.get_shape(%lay_6414) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_6415, %e1_6416, %e2_6417 = cute.get_leaves(%2422) : !cute.shape<"((8,1),(2))">
          %lay_6418 = cute.get_layout(%grouped_6399) : !memref_smem_bf16_14
          %2423 = cute.get_shape(%lay_6418) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_6419, %e1_6420, %e2_6421 = cute.get_leaves(%2423) : !cute.shape<"((8,1),(2))">
          %sz_6422 = cute.size(%grouped_6386) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
          %e0_6423 = cute.get_leaves(%sz_6422) : !cute.int_tuple<"2">
          %sz_6424 = cute.size(%grouped_6399) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
          %e0_6425 = cute.get_leaves(%sz_6424) : !cute.int_tuple<"2">
          cute.copy(%3, %grouped_6386, %grouped_6399, %grouped_6411) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
        } else {
          %coord_6359 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %slice_6360 = cute.slice(%dst_partitioned_242, %coord_6359) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_smem_bf16_13
          %sz_6362 = cute.size(%slice_6360) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
          %e0_6363 = cute.get_leaves(%sz_6362) : !cute.int_tuple<"16">
          %lay_6364 = cute.get_layout(%slice_6360) : !memref_smem_bf16_13
          %2417 = cute.get_shape(%lay_6364) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6365, %e1_6366, %e2_6367 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %int_tuple_6368 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_6369 = cute.tuple.product(%int_tuple_6368) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6370 = cute.get_leaves(%res_6369) : !cute.int_tuple<"16">
          %cst_6371 = arith.constant 0.000000e+00 : bf16
          %2418 = vector.splat %cst_6371 : vector<16xbf16>
          %int_tuple_6372 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6373 = cute.size(%int_tuple_6372) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6374 = cute.get_leaves(%sz_6373) : !cute.int_tuple<"16">
          %int_tuple_6375 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6376 = cute.size(%int_tuple_6375) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6377 = cute.get_leaves(%sz_6376) : !cute.int_tuple<"16">
          cute.memref.store_vec %2418, %slice_6360, row_major : !memref_smem_bf16_13
        }
        %coord_6331 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
        %slice_6332 = cute.slice(%src_partitioned_398, %coord_6331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)">
        %iter_6333 = cute.get_iter(%slice_6332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6334, %e1_6335, %e2_6336, %e3_6337 = cute.get_leaves(%iter_6333) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2399 = cute.get_scalars(%e0_6334) : !cute.int_tuple<"?">
        %2400 = cute.get_scalars(%e1_6335) : !cute.int_tuple<"?">
        %2401 = cute.get_scalars(%e2_6336) : !cute.int_tuple<"?">
        %2402 = cute.get_scalars(%e3_6337) : !cute.int_tuple<"?{div=8}">
        %iter_6338 = cute.get_iter(%slice_6332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6339, %e1_6340, %e2_6341, %e3_6342 = cute.get_leaves(%iter_6338) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2403 = cute.get_scalars(%e0_6339) : !cute.int_tuple<"?">
        %2404 = cute.get_scalars(%e1_6340) : !cute.int_tuple<"?">
        %2405 = cute.get_scalars(%e2_6341) : !cute.int_tuple<"?">
        %2406 = cute.get_scalars(%e3_6342) : !cute.int_tuple<"?{div=8}">
        %iter_6343 = cute.get_iter(%slice_6332) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_6344, %e1_6345, %e2_6346, %e3_6347 = cute.get_leaves(%iter_6343) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2407 = cute.get_scalars(%e0_6344) : !cute.int_tuple<"?">
        %2408 = cute.get_scalars(%e1_6345) : !cute.int_tuple<"?">
        %2409 = cute.get_scalars(%e2_6346) : !cute.int_tuple<"?">
        %2410 = cute.get_scalars(%e3_6347) : !cute.int_tuple<"?{div=8}">
        %lay_6348 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2411 = cute.get_shape(%lay_6348) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6349, %e1_6350, %e2_6351, %e3_6352 = cute.get_leaves(%2411) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6353 = cute.to_int_tuple(%e0_6349) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2412 = cute.get_scalars(%itup_6353) : !cute.int_tuple<"?">
        %itup_6354 = cute.to_int_tuple(%e1_6350) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2413 = cute.get_scalars(%itup_6354) : !cute.int_tuple<"?">
        %itup_6355 = cute.to_int_tuple(%e2_6351) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2414 = cute.get_scalars(%itup_6355) : !cute.int_tuple<"?">
        %itup_6356 = cute.to_int_tuple(%e3_6352) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2415 = cute.get_scalars(%itup_6356) : !cute.int_tuple<"?{div=8}">
        %coord_6357 = cute.make_coord(%e1_6345) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_6358 = cute.make_coord(%itup_6354) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2416 = cute.elem_less(%coord_6357, %coord_6358) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2416 {
          %coord_6359 = cute.make_coord(%476) : (i32) -> !cute.coord<"(_,3,_,?)">
          %slice_6360 = cute.slice(%src_partitioned_239, %coord_6359) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_gmem_bf16_6
          %coord_6362 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %slice_6363 = cute.slice(%dst_partitioned_242, %coord_6362) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
          %iter_6364 = cute.get_iter(%slice_6363) : !memref_smem_bf16_13
          %coord_6365 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %slice_6366 = cute.slice(%rmem_435, %coord_6365) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)">
          %iter_6367 = cute.get_iter(%slice_6366) : !memref_rmem_i8_2
          %lay_6368 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %2417 = cute.get_shape(%lay_6368) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6369, %e1_6370, %e2_6371 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %lay_6372 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %2418 = cute.get_shape(%lay_6372) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6373, %e1_6374, %e2_6375 = cute.get_leaves(%2418) : !cute.shape<"((8,1),2)">
          %lay_6376 = cute.get_layout(%slice_6360) : !memref_gmem_bf16_6
          %shape_6377 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6378 = cute.make_layout(%shape_6377) : !cute.layout<"1:0">
          %append_6379 = cute.append_to_rank<2> (%lay_6376, %lay_6378) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_6380 = cute.make_view(%iter_6361, %append_6379) : !memref_gmem_bf16_6
          %iter_6381 = cute.get_iter(%view_6380) : !memref_gmem_bf16_6
          %lay_6382 = cute.get_layout(%view_6380) : !memref_gmem_bf16_6
          %2419 = cute.get_shape(%lay_6382) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_6383, %e1_6384, %e2_6385 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)">
          %grouped_6386 = cute.group_modes(%view_6380) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
          %iter_6387 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %iter_6388 = cute.get_iter(%grouped_6386) : !memref_gmem_bf16_7
          %lay_6389 = cute.get_layout(%slice_6363) : !memref_smem_bf16_13
          %shape_6390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6391 = cute.make_layout(%shape_6390) : !cute.layout<"1:0">
          %append_6392 = cute.append_to_rank<2> (%lay_6389, %lay_6391) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_6393 = cute.make_view(%iter_6364, %append_6392) : !memref_smem_bf16_13
          %iter_6394 = cute.get_iter(%view_6393) : !memref_smem_bf16_13
          %lay_6395 = cute.get_layout(%view_6393) : !memref_smem_bf16_13
          %2420 = cute.get_shape(%lay_6395) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6396, %e1_6397, %e2_6398 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)">
          %grouped_6399 = cute.group_modes(%view_6393) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
          %iter_6400 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %iter_6401 = cute.get_iter(%grouped_6399) : !memref_smem_bf16_14
          %lay_6402 = cute.get_layout(%slice_6366) : !memref_rmem_i8_2
          %shape_6403 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_6404 = cute.make_layout(%shape_6403) : !cute.layout<"1:0">
          %append_6405 = cute.append_to_rank<2> (%lay_6402, %lay_6404) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_6406 = cute.make_view(%iter_6367, %append_6405) : !memref_rmem_i8_2
          %iter_6407 = cute.get_iter(%view_6406) : !memref_rmem_i8_2
          %lay_6408 = cute.get_layout(%view_6406) : !memref_rmem_i8_2
          %2421 = cute.get_shape(%lay_6408) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_6409, %e1_6410 = cute.get_leaves(%2421) : !cute.shape<"(1,2)">
          %grouped_6411 = cute.group_modes(%view_6406) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
          %iter_6412 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %iter_6413 = cute.get_iter(%grouped_6411) : !memref_rmem_i8_3
          %lay_6414 = cute.get_layout(%grouped_6386) : !memref_gmem_bf16_7
          %2422 = cute.get_shape(%lay_6414) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_6415, %e1_6416, %e2_6417 = cute.get_leaves(%2422) : !cute.shape<"((8,1),(2))">
          %lay_6418 = cute.get_layout(%grouped_6399) : !memref_smem_bf16_14
          %2423 = cute.get_shape(%lay_6418) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_6419, %e1_6420, %e2_6421 = cute.get_leaves(%2423) : !cute.shape<"((8,1),(2))">
          %sz_6422 = cute.size(%grouped_6386) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
          %e0_6423 = cute.get_leaves(%sz_6422) : !cute.int_tuple<"2">
          %sz_6424 = cute.size(%grouped_6399) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
          %e0_6425 = cute.get_leaves(%sz_6424) : !cute.int_tuple<"2">
          cute.copy(%3, %grouped_6386, %grouped_6399, %grouped_6411) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
        } else {
          %coord_6359 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %slice_6360 = cute.slice(%dst_partitioned_242, %coord_6359) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
          %iter_6361 = cute.get_iter(%slice_6360) : !memref_smem_bf16_13
          %sz_6362 = cute.size(%slice_6360) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
          %e0_6363 = cute.get_leaves(%sz_6362) : !cute.int_tuple<"16">
          %lay_6364 = cute.get_layout(%slice_6360) : !memref_smem_bf16_13
          %2417 = cute.get_shape(%lay_6364) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_6365, %e1_6366, %e2_6367 = cute.get_leaves(%2417) : !cute.shape<"((8,1),2)">
          %int_tuple_6368 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_6369 = cute.tuple.product(%int_tuple_6368) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6370 = cute.get_leaves(%res_6369) : !cute.int_tuple<"16">
          %cst_6371 = arith.constant 0.000000e+00 : bf16
          %2418 = vector.splat %cst_6371 : vector<16xbf16>
          %int_tuple_6372 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6373 = cute.size(%int_tuple_6372) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6374 = cute.get_leaves(%sz_6373) : !cute.int_tuple<"16">
          %int_tuple_6375 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_6376 = cute.size(%int_tuple_6375) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_6377 = cute.get_leaves(%sz_6376) : !cute.int_tuple<"16">
          cute.memref.store_vec %2418, %slice_6360, row_major : !memref_smem_bf16_13
        }
      } else {
        %coord_6239 = cute.make_coord(%476) : (i32) -> !cute.coord<"(_,_,_,?)">
        %slice_6240 = cute.slice(%src_partitioned_239, %coord_6239) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_gmem_bf16_8
        %lay_6242 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_8
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((8,1),4,2)">
        %lay_6247 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
        %2345 = cute.get_shape(%lay_6247) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6248, %e1_6249, %e2_6250, %e3_6251 = cute.get_leaves(%2345) : !cute.shape<"((8,1),4,2)">
        %lay_6252 = cute.get_layout(%slice_6240) : !memref_gmem_bf16_8
        %shape_6253 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6254 = cute.make_layout(%shape_6253) : !cute.layout<"1:0">
        %append_6255 = cute.append_to_rank<2> (%lay_6252, %lay_6254) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_6256 = cute.make_view(%iter_6241, %append_6255) : !memref_gmem_bf16_8
        %iter_6257 = cute.get_iter(%view_6256) : !memref_gmem_bf16_8
        %lay_6258 = cute.get_layout(%view_6256) : !memref_gmem_bf16_8
        %2346 = cute.get_shape(%lay_6258) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6259, %e1_6260, %e2_6261, %e3_6262 = cute.get_leaves(%2346) : !cute.shape<"((8,1),4,2)">
        %grouped_6263 = cute.group_modes(%view_6256) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9
        %iter_6264 = cute.get_iter(%grouped_6263) : !memref_gmem_bf16_9
        %iter_6265 = cute.get_iter(%grouped_6263) : !memref_gmem_bf16_9
        %lay_6266 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
        %shape_6267 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6268 = cute.make_layout(%shape_6267) : !cute.layout<"1:0">
        %append_6269 = cute.append_to_rank<2> (%lay_6266, %lay_6268) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_6270 = cute.make_view(%iter_243, %append_6269) : !memref_smem_bf16_4
        %iter_6271 = cute.get_iter(%view_6270) : !memref_smem_bf16_4
        %lay_6272 = cute.get_layout(%view_6270) : !memref_smem_bf16_4
        %2347 = cute.get_shape(%lay_6272) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6273, %e1_6274, %e2_6275, %e3_6276 = cute.get_leaves(%2347) : !cute.shape<"((8,1),4,2)">
        %grouped_6277 = cute.group_modes(%view_6270) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15
        %iter_6278 = cute.get_iter(%grouped_6277) : !memref_smem_bf16_15
        %iter_6279 = cute.get_iter(%grouped_6277) : !memref_smem_bf16_15
        %lay_6280 = cute.get_layout(%rmem_435) : !memref_rmem_i8_1
        %shape_6281 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6282 = cute.make_layout(%shape_6281) : !cute.layout<"1:0">
        %append_6283 = cute.append_to_rank<2> (%lay_6280, %lay_6282) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_6284 = cute.make_view(%iter_437, %append_6283) : !memref_rmem_i8_1
        %iter_6285 = cute.get_iter(%view_6284) : !memref_rmem_i8_1
        %lay_6286 = cute.get_layout(%view_6284) : !memref_rmem_i8_1
        %2348 = cute.get_shape(%lay_6286) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_6287, %e1_6288, %e2_6289 = cute.get_leaves(%2348) : !cute.shape<"(1,4,2)">
        %grouped_6290 = cute.group_modes(%view_6284) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4
        %iter_6291 = cute.get_iter(%grouped_6290) : !memref_rmem_i8_4
        %iter_6292 = cute.get_iter(%grouped_6290) : !memref_rmem_i8_4
        %lay_6293 = cute.get_layout(%grouped_6263) : !memref_gmem_bf16_9
        %2349 = cute.get_shape(%lay_6293) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_6294, %e1_6295, %e2_6296, %e3_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(4,2))">
        %lay_6298 = cute.get_layout(%grouped_6277) : !memref_smem_bf16_15
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_6299, %e1_6300, %e2_6301, %e3_6302 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(4,2))">
        %sz_6303 = cute.size(%grouped_6263) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8">
        %e0_6304 = cute.get_leaves(%sz_6303) : !cute.int_tuple<"8">
        %sz_6305 = cute.size(%grouped_6277) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8">
        %e0_6306 = cute.get_leaves(%sz_6305) : !cute.int_tuple<"8">
        cute.copy(%3, %grouped_6263, %grouped_6277, %grouped_6290) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4)
      }
      nvvm.cp.async.commit.group
      %coord_964 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_965 = cute.slice(%src_partitioned_317, %coord_964) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)">
      %iter_966 = cute.get_iter(%slice_965) : !memref_smem_bf16_13
      %coord_967 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_968 = cute.slice(%retiled, %coord_967) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)">
      %iter_969 = cute.get_iter(%slice_968) : !memref_rmem_bf16_6
      %lay_970 = cute.get_layout(%slice_965) : !memref_smem_bf16_13
      %480 = cute.get_shape(%lay_970) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_971, %e1_972, %e2_973 = cute.get_leaves(%480) : !cute.shape<"((8,1),2)">
      %lay_974 = cute.get_layout(%slice_968) : !memref_rmem_bf16_6
      %481 = cute.get_shape(%lay_974) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_975, %e1_976, %e2_977 = cute.get_leaves(%481) : !cute.shape<"((8,1),2)">
      %lay_978 = cute.get_layout(%slice_965) : !memref_smem_bf16_13
      %shape_979 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_980 = cute.make_layout(%shape_979) : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_978, %lay_980) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_981 = cute.make_view(%iter_966, %append) : !memref_smem_bf16_13
      %iter_982 = cute.get_iter(%view_981) : !memref_smem_bf16_13
      %lay_983 = cute.get_layout(%view_981) : !memref_smem_bf16_13
      %482 = cute.get_shape(%lay_983) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_984, %e1_985, %e2_986 = cute.get_leaves(%482) : !cute.shape<"((8,1),2)">
      %grouped = cute.group_modes(%view_981) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_987 = cute.get_iter(%grouped) : !memref_smem_bf16_14
      %iter_988 = cute.get_iter(%grouped) : !memref_smem_bf16_14
      %lay_989 = cute.get_layout(%slice_968) : !memref_rmem_bf16_6
      %shape_990 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_991 = cute.make_layout(%shape_990) : !cute.layout<"1:0">
      %append_992 = cute.append_to_rank<2> (%lay_989, %lay_991) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_993 = cute.make_view(%iter_969, %append_992) : !memref_rmem_bf16_6
      %iter_994 = cute.get_iter(%view_993) : !memref_rmem_bf16_6
      %lay_995 = cute.get_layout(%view_993) : !memref_rmem_bf16_6
      %483 = cute.get_shape(%lay_995) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_996, %e1_997, %e2_998 = cute.get_leaves(%483) : !cute.shape<"((8,1),2)">
      %grouped_999 = cute.group_modes(%view_993) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1000 = cute.get_iter(%grouped_999) : !memref_rmem_bf16_7
      %iter_1001 = cute.get_iter(%grouped_999) : !memref_rmem_bf16_7
      %lay_1002 = cute.get_layout(%grouped) : !memref_smem_bf16_14
      %484 = cute.get_shape(%lay_1002) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1003, %e1_1004, %e2_1005 = cute.get_leaves(%484) : !cute.shape<"((8,1),(2))">
      %lay_1006 = cute.get_layout(%grouped_999) : !memref_rmem_bf16_7
      %485 = cute.get_shape(%lay_1006) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1007, %e1_1008, %e2_1009 = cute.get_leaves(%485) : !cute.shape<"((8,1),(2))">
      %sz_1010 = cute.size(%grouped) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1011 = cute.get_leaves(%sz_1010) : !cute.int_tuple<"2">
      %sz_1012 = cute.size(%grouped_999) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1013 = cute.get_leaves(%sz_1012) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped, %grouped_999) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1014 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1015 = cute.slice(%src_partitioned_321, %coord_1014) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)">
      %iter_1016 = cute.get_iter(%slice_1015) : !memref_smem_bf16_16
      %coord_1017 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1018 = cute.slice(%retiled_323, %coord_1017) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)">
      %iter_1019 = cute.get_iter(%slice_1018) : !memref_rmem_bf16_8
      %lay_1020 = cute.get_layout(%slice_1015) : !memref_smem_bf16_16
      %486 = cute.get_shape(%lay_1020) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1021, %e1_1022, %e2_1023 = cute.get_leaves(%486) : !cute.shape<"((8,1),4)">
      %lay_1024 = cute.get_layout(%slice_1018) : !memref_rmem_bf16_8
      %487 = cute.get_shape(%lay_1024) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1025, %e1_1026, %e2_1027 = cute.get_leaves(%487) : !cute.shape<"((8,1),4)">
      %lay_1028 = cute.get_layout(%slice_1015) : !memref_smem_bf16_16
      %shape_1029 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1030 = cute.make_layout(%shape_1029) : !cute.layout<"1:0">
      %append_1031 = cute.append_to_rank<2> (%lay_1028, %lay_1030) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1032 = cute.make_view(%iter_1016, %append_1031) : !memref_smem_bf16_16
      %iter_1033 = cute.get_iter(%view_1032) : !memref_smem_bf16_16
      %lay_1034 = cute.get_layout(%view_1032) : !memref_smem_bf16_16
      %488 = cute.get_shape(%lay_1034) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1035, %e1_1036, %e2_1037 = cute.get_leaves(%488) : !cute.shape<"((8,1),4)">
      %grouped_1038 = cute.group_modes(%view_1032) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1039 = cute.get_iter(%grouped_1038) : !memref_smem_bf16_17
      %iter_1040 = cute.get_iter(%grouped_1038) : !memref_smem_bf16_17
      %lay_1041 = cute.get_layout(%slice_1018) : !memref_rmem_bf16_8
      %shape_1042 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1043 = cute.make_layout(%shape_1042) : !cute.layout<"1:0">
      %append_1044 = cute.append_to_rank<2> (%lay_1041, %lay_1043) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1045 = cute.make_view(%iter_1019, %append_1044) : !memref_rmem_bf16_8
      %iter_1046 = cute.get_iter(%view_1045) : !memref_rmem_bf16_8
      %lay_1047 = cute.get_layout(%view_1045) : !memref_rmem_bf16_8
      %489 = cute.get_shape(%lay_1047) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1048, %e1_1049, %e2_1050 = cute.get_leaves(%489) : !cute.shape<"((8,1),4)">
      %grouped_1051 = cute.group_modes(%view_1045) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1052 = cute.get_iter(%grouped_1051) : !memref_rmem_bf16_9
      %iter_1053 = cute.get_iter(%grouped_1051) : !memref_rmem_bf16_9
      %lay_1054 = cute.get_layout(%grouped_1038) : !memref_smem_bf16_17
      %490 = cute.get_shape(%lay_1054) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1055, %e1_1056, %e2_1057 = cute.get_leaves(%490) : !cute.shape<"((8,1),(4))">
      %lay_1058 = cute.get_layout(%grouped_1051) : !memref_rmem_bf16_9
      %491 = cute.get_shape(%lay_1058) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1059, %e1_1060, %e2_1061 = cute.get_leaves(%491) : !cute.shape<"((8,1),(4))">
      %sz_1062 = cute.size(%grouped_1038) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1063 = cute.get_leaves(%sz_1062) : !cute.int_tuple<"4">
      %sz_1064 = cute.size(%grouped_1051) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1065 = cute.get_leaves(%sz_1064) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1038, %grouped_1051) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %lay_1066 = cute.get_layout(%src_partitioned_317) : !memref_smem_bf16_8
      %492 = cute.get_shape(%lay_1066) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
      %e0_1067, %e1_1068, %e2_1069, %e3_1070, %e4_1071, %e5 = cute.get_leaves(%492) : !cute.shape<"((8,1),2,((2,2),2))">
      %int_tuple_1072 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1073 = cute.size(%int_tuple_1072) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1074 = cute.get_leaves(%sz_1073) : !cute.int_tuple<"8">
      %int_tuple_1075 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1076 = cute.size(%int_tuple_1075) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1077 = cute.get_leaves(%sz_1076) : !cute.int_tuple<"8">
      %coord_1078 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1079 = cute.slice(%src_partitioned_317, %coord_1078) : !memref_smem_bf16_8, !cute.coord<"(_,_,1)">
      %iter_1080 = cute.get_iter(%slice_1079) : !memref_smem_bf16_13
      %coord_1081 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1082 = cute.slice(%retiled, %coord_1081) : !memref_rmem_bf16_3, !cute.coord<"(_,_,1)">
      %iter_1083 = cute.get_iter(%slice_1082) : !memref_rmem_bf16_6
      %lay_1084 = cute.get_layout(%slice_1079) : !memref_smem_bf16_13
      %493 = cute.get_shape(%lay_1084) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1085, %e1_1086, %e2_1087 = cute.get_leaves(%493) : !cute.shape<"((8,1),2)">
      %lay_1088 = cute.get_layout(%slice_1082) : !memref_rmem_bf16_6
      %494 = cute.get_shape(%lay_1088) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1089, %e1_1090, %e2_1091 = cute.get_leaves(%494) : !cute.shape<"((8,1),2)">
      %lay_1092 = cute.get_layout(%slice_1079) : !memref_smem_bf16_13
      %shape_1093 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1094 = cute.make_layout(%shape_1093) : !cute.layout<"1:0">
      %append_1095 = cute.append_to_rank<2> (%lay_1092, %lay_1094) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1096 = cute.make_view(%iter_1080, %append_1095) : !memref_smem_bf16_13
      %iter_1097 = cute.get_iter(%view_1096) : !memref_smem_bf16_13
      %lay_1098 = cute.get_layout(%view_1096) : !memref_smem_bf16_13
      %495 = cute.get_shape(%lay_1098) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1099, %e1_1100, %e2_1101 = cute.get_leaves(%495) : !cute.shape<"((8,1),2)">
      %grouped_1102 = cute.group_modes(%view_1096) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1103 = cute.get_iter(%grouped_1102) : !memref_smem_bf16_14
      %iter_1104 = cute.get_iter(%grouped_1102) : !memref_smem_bf16_14
      %lay_1105 = cute.get_layout(%slice_1082) : !memref_rmem_bf16_6
      %shape_1106 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1107 = cute.make_layout(%shape_1106) : !cute.layout<"1:0">
      %append_1108 = cute.append_to_rank<2> (%lay_1105, %lay_1107) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1109 = cute.make_view(%iter_1083, %append_1108) : !memref_rmem_bf16_6
      %iter_1110 = cute.get_iter(%view_1109) : !memref_rmem_bf16_6
      %lay_1111 = cute.get_layout(%view_1109) : !memref_rmem_bf16_6
      %496 = cute.get_shape(%lay_1111) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1112, %e1_1113, %e2_1114 = cute.get_leaves(%496) : !cute.shape<"((8,1),2)">
      %grouped_1115 = cute.group_modes(%view_1109) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1116 = cute.get_iter(%grouped_1115) : !memref_rmem_bf16_7
      %iter_1117 = cute.get_iter(%grouped_1115) : !memref_rmem_bf16_7
      %lay_1118 = cute.get_layout(%grouped_1102) : !memref_smem_bf16_14
      %497 = cute.get_shape(%lay_1118) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1119, %e1_1120, %e2_1121 = cute.get_leaves(%497) : !cute.shape<"((8,1),(2))">
      %lay_1122 = cute.get_layout(%grouped_1115) : !memref_rmem_bf16_7
      %498 = cute.get_shape(%lay_1122) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1123, %e1_1124, %e2_1125 = cute.get_leaves(%498) : !cute.shape<"((8,1),(2))">
      %sz_1126 = cute.size(%grouped_1102) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1127 = cute.get_leaves(%sz_1126) : !cute.int_tuple<"2">
      %sz_1128 = cute.size(%grouped_1115) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1129 = cute.get_leaves(%sz_1128) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1102, %grouped_1115) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1130 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1131 = cute.slice(%src_partitioned_321, %coord_1130) : !memref_smem_bf16_9, !cute.coord<"(_,_,1)">
      %iter_1132 = cute.get_iter(%slice_1131) : !memref_smem_bf16_16
      %coord_1133 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1134 = cute.slice(%retiled_323, %coord_1133) : !memref_rmem_bf16_4, !cute.coord<"(_,_,1)">
      %iter_1135 = cute.get_iter(%slice_1134) : !memref_rmem_bf16_8
      %lay_1136 = cute.get_layout(%slice_1131) : !memref_smem_bf16_16
      %499 = cute.get_shape(%lay_1136) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1137, %e1_1138, %e2_1139 = cute.get_leaves(%499) : !cute.shape<"((8,1),4)">
      %lay_1140 = cute.get_layout(%slice_1134) : !memref_rmem_bf16_8
      %500 = cute.get_shape(%lay_1140) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1141, %e1_1142, %e2_1143 = cute.get_leaves(%500) : !cute.shape<"((8,1),4)">
      %lay_1144 = cute.get_layout(%slice_1131) : !memref_smem_bf16_16
      %shape_1145 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1146 = cute.make_layout(%shape_1145) : !cute.layout<"1:0">
      %append_1147 = cute.append_to_rank<2> (%lay_1144, %lay_1146) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1148 = cute.make_view(%iter_1132, %append_1147) : !memref_smem_bf16_16
      %iter_1149 = cute.get_iter(%view_1148) : !memref_smem_bf16_16
      %lay_1150 = cute.get_layout(%view_1148) : !memref_smem_bf16_16
      %501 = cute.get_shape(%lay_1150) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1151, %e1_1152, %e2_1153 = cute.get_leaves(%501) : !cute.shape<"((8,1),4)">
      %grouped_1154 = cute.group_modes(%view_1148) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1155 = cute.get_iter(%grouped_1154) : !memref_smem_bf16_17
      %iter_1156 = cute.get_iter(%grouped_1154) : !memref_smem_bf16_17
      %lay_1157 = cute.get_layout(%slice_1134) : !memref_rmem_bf16_8
      %shape_1158 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1159 = cute.make_layout(%shape_1158) : !cute.layout<"1:0">
      %append_1160 = cute.append_to_rank<2> (%lay_1157, %lay_1159) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1161 = cute.make_view(%iter_1135, %append_1160) : !memref_rmem_bf16_8
      %iter_1162 = cute.get_iter(%view_1161) : !memref_rmem_bf16_8
      %lay_1163 = cute.get_layout(%view_1161) : !memref_rmem_bf16_8
      %502 = cute.get_shape(%lay_1163) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1164, %e1_1165, %e2_1166 = cute.get_leaves(%502) : !cute.shape<"((8,1),4)">
      %grouped_1167 = cute.group_modes(%view_1161) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1168 = cute.get_iter(%grouped_1167) : !memref_rmem_bf16_9
      %iter_1169 = cute.get_iter(%grouped_1167) : !memref_rmem_bf16_9
      %lay_1170 = cute.get_layout(%grouped_1154) : !memref_smem_bf16_17
      %503 = cute.get_shape(%lay_1170) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1171, %e1_1172, %e2_1173 = cute.get_leaves(%503) : !cute.shape<"((8,1),(4))">
      %lay_1174 = cute.get_layout(%grouped_1167) : !memref_rmem_bf16_9
      %504 = cute.get_shape(%lay_1174) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1175, %e1_1176, %e2_1177 = cute.get_leaves(%504) : !cute.shape<"((8,1),(4))">
      %sz_1178 = cute.size(%grouped_1154) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1179 = cute.get_leaves(%sz_1178) : !cute.int_tuple<"4">
      %sz_1180 = cute.size(%grouped_1167) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1181 = cute.get_leaves(%sz_1180) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1154, %grouped_1167) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1182 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1183 = cute.slice(%frg_A, %coord_1182) : !memref_rmem_bf16_, !cute.coord<"(_,_,0)">
      %iter_1184 = cute.get_iter(%slice_1183) : !memref_rmem_bf16_10
      %coord_1185 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1186 = cute.slice(%frg_B, %coord_1185) : !memref_rmem_bf16_1, !cute.coord<"(_,_,0)">
      %iter_1187 = cute.get_iter(%slice_1186) : !memref_rmem_bf16_11
      %lay_1188 = cute.get_layout(%slice_1183) : !memref_rmem_bf16_10
      %505 = cute.get_shape(%lay_1188) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1189, %e1_1190, %e2_1191, %e3_1192 = cute.get_leaves(%505) : !cute.shape<"((2,2,2),2)">
      %lay_1193 = cute.get_layout(%slice_1186) : !memref_rmem_bf16_11
      %506 = cute.get_shape(%lay_1193) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1194, %e1_1195, %e2_1196 = cute.get_leaves(%506) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1183, %slice_1186, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1197 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1198 = cute.size(%int_tuple_1197) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1199 = cute.get_leaves(%sz_1198) : !cute.int_tuple<"8">
      %coord_1200 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1201 = cute.slice(%src_partitioned_317, %coord_1200) : !memref_smem_bf16_8, !cute.coord<"(_,_,2)">
      %iter_1202 = cute.get_iter(%slice_1201) : !memref_smem_bf16_13
      %coord_1203 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1204 = cute.slice(%retiled, %coord_1203) : !memref_rmem_bf16_3, !cute.coord<"(_,_,2)">
      %iter_1205 = cute.get_iter(%slice_1204) : !memref_rmem_bf16_6
      %lay_1206 = cute.get_layout(%slice_1201) : !memref_smem_bf16_13
      %507 = cute.get_shape(%lay_1206) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1207, %e1_1208, %e2_1209 = cute.get_leaves(%507) : !cute.shape<"((8,1),2)">
      %lay_1210 = cute.get_layout(%slice_1204) : !memref_rmem_bf16_6
      %508 = cute.get_shape(%lay_1210) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1211, %e1_1212, %e2_1213 = cute.get_leaves(%508) : !cute.shape<"((8,1),2)">
      %lay_1214 = cute.get_layout(%slice_1201) : !memref_smem_bf16_13
      %shape_1215 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1216 = cute.make_layout(%shape_1215) : !cute.layout<"1:0">
      %append_1217 = cute.append_to_rank<2> (%lay_1214, %lay_1216) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1218 = cute.make_view(%iter_1202, %append_1217) : !memref_smem_bf16_13
      %iter_1219 = cute.get_iter(%view_1218) : !memref_smem_bf16_13
      %lay_1220 = cute.get_layout(%view_1218) : !memref_smem_bf16_13
      %509 = cute.get_shape(%lay_1220) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1221, %e1_1222, %e2_1223 = cute.get_leaves(%509) : !cute.shape<"((8,1),2)">
      %grouped_1224 = cute.group_modes(%view_1218) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1225 = cute.get_iter(%grouped_1224) : !memref_smem_bf16_14
      %iter_1226 = cute.get_iter(%grouped_1224) : !memref_smem_bf16_14
      %lay_1227 = cute.get_layout(%slice_1204) : !memref_rmem_bf16_6
      %shape_1228 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1229 = cute.make_layout(%shape_1228) : !cute.layout<"1:0">
      %append_1230 = cute.append_to_rank<2> (%lay_1227, %lay_1229) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1231 = cute.make_view(%iter_1205, %append_1230) : !memref_rmem_bf16_6
      %iter_1232 = cute.get_iter(%view_1231) : !memref_rmem_bf16_6
      %lay_1233 = cute.get_layout(%view_1231) : !memref_rmem_bf16_6
      %510 = cute.get_shape(%lay_1233) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1234, %e1_1235, %e2_1236 = cute.get_leaves(%510) : !cute.shape<"((8,1),2)">
      %grouped_1237 = cute.group_modes(%view_1231) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1238 = cute.get_iter(%grouped_1237) : !memref_rmem_bf16_7
      %iter_1239 = cute.get_iter(%grouped_1237) : !memref_rmem_bf16_7
      %lay_1240 = cute.get_layout(%grouped_1224) : !memref_smem_bf16_14
      %511 = cute.get_shape(%lay_1240) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1241, %e1_1242, %e2_1243 = cute.get_leaves(%511) : !cute.shape<"((8,1),(2))">
      %lay_1244 = cute.get_layout(%grouped_1237) : !memref_rmem_bf16_7
      %512 = cute.get_shape(%lay_1244) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1245, %e1_1246, %e2_1247 = cute.get_leaves(%512) : !cute.shape<"((8,1),(2))">
      %sz_1248 = cute.size(%grouped_1224) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1249 = cute.get_leaves(%sz_1248) : !cute.int_tuple<"2">
      %sz_1250 = cute.size(%grouped_1237) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1251 = cute.get_leaves(%sz_1250) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1224, %grouped_1237) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1252 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1253 = cute.slice(%src_partitioned_321, %coord_1252) : !memref_smem_bf16_9, !cute.coord<"(_,_,2)">
      %iter_1254 = cute.get_iter(%slice_1253) : !memref_smem_bf16_16
      %coord_1255 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1256 = cute.slice(%retiled_323, %coord_1255) : !memref_rmem_bf16_4, !cute.coord<"(_,_,2)">
      %iter_1257 = cute.get_iter(%slice_1256) : !memref_rmem_bf16_8
      %lay_1258 = cute.get_layout(%slice_1253) : !memref_smem_bf16_16
      %513 = cute.get_shape(%lay_1258) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1259, %e1_1260, %e2_1261 = cute.get_leaves(%513) : !cute.shape<"((8,1),4)">
      %lay_1262 = cute.get_layout(%slice_1256) : !memref_rmem_bf16_8
      %514 = cute.get_shape(%lay_1262) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1263, %e1_1264, %e2_1265 = cute.get_leaves(%514) : !cute.shape<"((8,1),4)">
      %lay_1266 = cute.get_layout(%slice_1253) : !memref_smem_bf16_16
      %shape_1267 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1268 = cute.make_layout(%shape_1267) : !cute.layout<"1:0">
      %append_1269 = cute.append_to_rank<2> (%lay_1266, %lay_1268) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1270 = cute.make_view(%iter_1254, %append_1269) : !memref_smem_bf16_16
      %iter_1271 = cute.get_iter(%view_1270) : !memref_smem_bf16_16
      %lay_1272 = cute.get_layout(%view_1270) : !memref_smem_bf16_16
      %515 = cute.get_shape(%lay_1272) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1273, %e1_1274, %e2_1275 = cute.get_leaves(%515) : !cute.shape<"((8,1),4)">
      %grouped_1276 = cute.group_modes(%view_1270) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1277 = cute.get_iter(%grouped_1276) : !memref_smem_bf16_17
      %iter_1278 = cute.get_iter(%grouped_1276) : !memref_smem_bf16_17
      %lay_1279 = cute.get_layout(%slice_1256) : !memref_rmem_bf16_8
      %shape_1280 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1281 = cute.make_layout(%shape_1280) : !cute.layout<"1:0">
      %append_1282 = cute.append_to_rank<2> (%lay_1279, %lay_1281) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1283 = cute.make_view(%iter_1257, %append_1282) : !memref_rmem_bf16_8
      %iter_1284 = cute.get_iter(%view_1283) : !memref_rmem_bf16_8
      %lay_1285 = cute.get_layout(%view_1283) : !memref_rmem_bf16_8
      %516 = cute.get_shape(%lay_1285) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1286, %e1_1287, %e2_1288 = cute.get_leaves(%516) : !cute.shape<"((8,1),4)">
      %grouped_1289 = cute.group_modes(%view_1283) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1290 = cute.get_iter(%grouped_1289) : !memref_rmem_bf16_9
      %iter_1291 = cute.get_iter(%grouped_1289) : !memref_rmem_bf16_9
      %lay_1292 = cute.get_layout(%grouped_1276) : !memref_smem_bf16_17
      %517 = cute.get_shape(%lay_1292) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1293, %e1_1294, %e2_1295 = cute.get_leaves(%517) : !cute.shape<"((8,1),(4))">
      %lay_1296 = cute.get_layout(%grouped_1289) : !memref_rmem_bf16_9
      %518 = cute.get_shape(%lay_1296) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1297, %e1_1298, %e2_1299 = cute.get_leaves(%518) : !cute.shape<"((8,1),(4))">
      %sz_1300 = cute.size(%grouped_1276) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1301 = cute.get_leaves(%sz_1300) : !cute.int_tuple<"4">
      %sz_1302 = cute.size(%grouped_1289) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1303 = cute.get_leaves(%sz_1302) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1276, %grouped_1289) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1304 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1305 = cute.slice(%frg_A, %coord_1304) : !memref_rmem_bf16_, !cute.coord<"(_,_,1)">
      %iter_1306 = cute.get_iter(%slice_1305) : !memref_rmem_bf16_10
      %coord_1307 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_1308 = cute.slice(%frg_B, %coord_1307) : !memref_rmem_bf16_1, !cute.coord<"(_,_,1)">
      %iter_1309 = cute.get_iter(%slice_1308) : !memref_rmem_bf16_11
      %lay_1310 = cute.get_layout(%slice_1305) : !memref_rmem_bf16_10
      %519 = cute.get_shape(%lay_1310) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1311, %e1_1312, %e2_1313, %e3_1314 = cute.get_leaves(%519) : !cute.shape<"((2,2,2),2)">
      %lay_1315 = cute.get_layout(%slice_1308) : !memref_rmem_bf16_11
      %520 = cute.get_shape(%lay_1315) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1316, %e1_1317, %e2_1318 = cute.get_leaves(%520) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1305, %slice_1308, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1319 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1320 = cute.size(%int_tuple_1319) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1321 = cute.get_leaves(%sz_1320) : !cute.int_tuple<"8">
      %coord_1322 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1323 = cute.slice(%src_partitioned_317, %coord_1322) : !memref_smem_bf16_8, !cute.coord<"(_,_,3)">
      %iter_1324 = cute.get_iter(%slice_1323) : !memref_smem_bf16_13
      %coord_1325 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1326 = cute.slice(%retiled, %coord_1325) : !memref_rmem_bf16_3, !cute.coord<"(_,_,3)">
      %iter_1327 = cute.get_iter(%slice_1326) : !memref_rmem_bf16_6
      %lay_1328 = cute.get_layout(%slice_1323) : !memref_smem_bf16_13
      %521 = cute.get_shape(%lay_1328) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1329, %e1_1330, %e2_1331 = cute.get_leaves(%521) : !cute.shape<"((8,1),2)">
      %lay_1332 = cute.get_layout(%slice_1326) : !memref_rmem_bf16_6
      %522 = cute.get_shape(%lay_1332) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1333, %e1_1334, %e2_1335 = cute.get_leaves(%522) : !cute.shape<"((8,1),2)">
      %lay_1336 = cute.get_layout(%slice_1323) : !memref_smem_bf16_13
      %shape_1337 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1338 = cute.make_layout(%shape_1337) : !cute.layout<"1:0">
      %append_1339 = cute.append_to_rank<2> (%lay_1336, %lay_1338) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1340 = cute.make_view(%iter_1324, %append_1339) : !memref_smem_bf16_13
      %iter_1341 = cute.get_iter(%view_1340) : !memref_smem_bf16_13
      %lay_1342 = cute.get_layout(%view_1340) : !memref_smem_bf16_13
      %523 = cute.get_shape(%lay_1342) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1343, %e1_1344, %e2_1345 = cute.get_leaves(%523) : !cute.shape<"((8,1),2)">
      %grouped_1346 = cute.group_modes(%view_1340) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1347 = cute.get_iter(%grouped_1346) : !memref_smem_bf16_14
      %iter_1348 = cute.get_iter(%grouped_1346) : !memref_smem_bf16_14
      %lay_1349 = cute.get_layout(%slice_1326) : !memref_rmem_bf16_6
      %shape_1350 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1351 = cute.make_layout(%shape_1350) : !cute.layout<"1:0">
      %append_1352 = cute.append_to_rank<2> (%lay_1349, %lay_1351) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1353 = cute.make_view(%iter_1327, %append_1352) : !memref_rmem_bf16_6
      %iter_1354 = cute.get_iter(%view_1353) : !memref_rmem_bf16_6
      %lay_1355 = cute.get_layout(%view_1353) : !memref_rmem_bf16_6
      %524 = cute.get_shape(%lay_1355) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1356, %e1_1357, %e2_1358 = cute.get_leaves(%524) : !cute.shape<"((8,1),2)">
      %grouped_1359 = cute.group_modes(%view_1353) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1360 = cute.get_iter(%grouped_1359) : !memref_rmem_bf16_7
      %iter_1361 = cute.get_iter(%grouped_1359) : !memref_rmem_bf16_7
      %lay_1362 = cute.get_layout(%grouped_1346) : !memref_smem_bf16_14
      %525 = cute.get_shape(%lay_1362) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1363, %e1_1364, %e2_1365 = cute.get_leaves(%525) : !cute.shape<"((8,1),(2))">
      %lay_1366 = cute.get_layout(%grouped_1359) : !memref_rmem_bf16_7
      %526 = cute.get_shape(%lay_1366) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1367, %e1_1368, %e2_1369 = cute.get_leaves(%526) : !cute.shape<"((8,1),(2))">
      %sz_1370 = cute.size(%grouped_1346) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1371 = cute.get_leaves(%sz_1370) : !cute.int_tuple<"2">
      %sz_1372 = cute.size(%grouped_1359) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1373 = cute.get_leaves(%sz_1372) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1346, %grouped_1359) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1374 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1375 = cute.slice(%src_partitioned_321, %coord_1374) : !memref_smem_bf16_9, !cute.coord<"(_,_,3)">
      %iter_1376 = cute.get_iter(%slice_1375) : !memref_smem_bf16_16
      %coord_1377 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1378 = cute.slice(%retiled_323, %coord_1377) : !memref_rmem_bf16_4, !cute.coord<"(_,_,3)">
      %iter_1379 = cute.get_iter(%slice_1378) : !memref_rmem_bf16_8
      %lay_1380 = cute.get_layout(%slice_1375) : !memref_smem_bf16_16
      %527 = cute.get_shape(%lay_1380) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1381, %e1_1382, %e2_1383 = cute.get_leaves(%527) : !cute.shape<"((8,1),4)">
      %lay_1384 = cute.get_layout(%slice_1378) : !memref_rmem_bf16_8
      %528 = cute.get_shape(%lay_1384) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1385, %e1_1386, %e2_1387 = cute.get_leaves(%528) : !cute.shape<"((8,1),4)">
      %lay_1388 = cute.get_layout(%slice_1375) : !memref_smem_bf16_16
      %shape_1389 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1390 = cute.make_layout(%shape_1389) : !cute.layout<"1:0">
      %append_1391 = cute.append_to_rank<2> (%lay_1388, %lay_1390) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1392 = cute.make_view(%iter_1376, %append_1391) : !memref_smem_bf16_16
      %iter_1393 = cute.get_iter(%view_1392) : !memref_smem_bf16_16
      %lay_1394 = cute.get_layout(%view_1392) : !memref_smem_bf16_16
      %529 = cute.get_shape(%lay_1394) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1395, %e1_1396, %e2_1397 = cute.get_leaves(%529) : !cute.shape<"((8,1),4)">
      %grouped_1398 = cute.group_modes(%view_1392) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1399 = cute.get_iter(%grouped_1398) : !memref_smem_bf16_17
      %iter_1400 = cute.get_iter(%grouped_1398) : !memref_smem_bf16_17
      %lay_1401 = cute.get_layout(%slice_1378) : !memref_rmem_bf16_8
      %shape_1402 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1403 = cute.make_layout(%shape_1402) : !cute.layout<"1:0">
      %append_1404 = cute.append_to_rank<2> (%lay_1401, %lay_1403) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1405 = cute.make_view(%iter_1379, %append_1404) : !memref_rmem_bf16_8
      %iter_1406 = cute.get_iter(%view_1405) : !memref_rmem_bf16_8
      %lay_1407 = cute.get_layout(%view_1405) : !memref_rmem_bf16_8
      %530 = cute.get_shape(%lay_1407) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1408, %e1_1409, %e2_1410 = cute.get_leaves(%530) : !cute.shape<"((8,1),4)">
      %grouped_1411 = cute.group_modes(%view_1405) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1412 = cute.get_iter(%grouped_1411) : !memref_rmem_bf16_9
      %iter_1413 = cute.get_iter(%grouped_1411) : !memref_rmem_bf16_9
      %lay_1414 = cute.get_layout(%grouped_1398) : !memref_smem_bf16_17
      %531 = cute.get_shape(%lay_1414) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1415, %e1_1416, %e2_1417 = cute.get_leaves(%531) : !cute.shape<"((8,1),(4))">
      %lay_1418 = cute.get_layout(%grouped_1411) : !memref_rmem_bf16_9
      %532 = cute.get_shape(%lay_1418) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1419, %e1_1420, %e2_1421 = cute.get_leaves(%532) : !cute.shape<"((8,1),(4))">
      %sz_1422 = cute.size(%grouped_1398) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1423 = cute.get_leaves(%sz_1422) : !cute.int_tuple<"4">
      %sz_1424 = cute.size(%grouped_1411) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1425 = cute.get_leaves(%sz_1424) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1398, %grouped_1411) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1426 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1427 = cute.slice(%frg_A, %coord_1426) : !memref_rmem_bf16_, !cute.coord<"(_,_,2)">
      %iter_1428 = cute.get_iter(%slice_1427) : !memref_rmem_bf16_10
      %coord_1429 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_1430 = cute.slice(%frg_B, %coord_1429) : !memref_rmem_bf16_1, !cute.coord<"(_,_,2)">
      %iter_1431 = cute.get_iter(%slice_1430) : !memref_rmem_bf16_11
      %lay_1432 = cute.get_layout(%slice_1427) : !memref_rmem_bf16_10
      %533 = cute.get_shape(%lay_1432) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1433, %e1_1434, %e2_1435, %e3_1436 = cute.get_leaves(%533) : !cute.shape<"((2,2,2),2)">
      %lay_1437 = cute.get_layout(%slice_1430) : !memref_rmem_bf16_11
      %534 = cute.get_shape(%lay_1437) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1438, %e1_1439, %e2_1440 = cute.get_leaves(%534) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1427, %slice_1430, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1441 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1442 = cute.size(%int_tuple_1441) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1443 = cute.get_leaves(%sz_1442) : !cute.int_tuple<"8">
      %coord_1444 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1445 = cute.slice(%src_partitioned_317, %coord_1444) : !memref_smem_bf16_8, !cute.coord<"(_,_,4)">
      %iter_1446 = cute.get_iter(%slice_1445) : !memref_smem_bf16_13
      %coord_1447 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1448 = cute.slice(%retiled, %coord_1447) : !memref_rmem_bf16_3, !cute.coord<"(_,_,4)">
      %iter_1449 = cute.get_iter(%slice_1448) : !memref_rmem_bf16_6
      %lay_1450 = cute.get_layout(%slice_1445) : !memref_smem_bf16_13
      %535 = cute.get_shape(%lay_1450) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1451, %e1_1452, %e2_1453 = cute.get_leaves(%535) : !cute.shape<"((8,1),2)">
      %lay_1454 = cute.get_layout(%slice_1448) : !memref_rmem_bf16_6
      %536 = cute.get_shape(%lay_1454) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1455, %e1_1456, %e2_1457 = cute.get_leaves(%536) : !cute.shape<"((8,1),2)">
      %lay_1458 = cute.get_layout(%slice_1445) : !memref_smem_bf16_13
      %shape_1459 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1460 = cute.make_layout(%shape_1459) : !cute.layout<"1:0">
      %append_1461 = cute.append_to_rank<2> (%lay_1458, %lay_1460) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1462 = cute.make_view(%iter_1446, %append_1461) : !memref_smem_bf16_13
      %iter_1463 = cute.get_iter(%view_1462) : !memref_smem_bf16_13
      %lay_1464 = cute.get_layout(%view_1462) : !memref_smem_bf16_13
      %537 = cute.get_shape(%lay_1464) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1465, %e1_1466, %e2_1467 = cute.get_leaves(%537) : !cute.shape<"((8,1),2)">
      %grouped_1468 = cute.group_modes(%view_1462) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1469 = cute.get_iter(%grouped_1468) : !memref_smem_bf16_14
      %iter_1470 = cute.get_iter(%grouped_1468) : !memref_smem_bf16_14
      %lay_1471 = cute.get_layout(%slice_1448) : !memref_rmem_bf16_6
      %shape_1472 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1473 = cute.make_layout(%shape_1472) : !cute.layout<"1:0">
      %append_1474 = cute.append_to_rank<2> (%lay_1471, %lay_1473) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1475 = cute.make_view(%iter_1449, %append_1474) : !memref_rmem_bf16_6
      %iter_1476 = cute.get_iter(%view_1475) : !memref_rmem_bf16_6
      %lay_1477 = cute.get_layout(%view_1475) : !memref_rmem_bf16_6
      %538 = cute.get_shape(%lay_1477) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1478, %e1_1479, %e2_1480 = cute.get_leaves(%538) : !cute.shape<"((8,1),2)">
      %grouped_1481 = cute.group_modes(%view_1475) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1482 = cute.get_iter(%grouped_1481) : !memref_rmem_bf16_7
      %iter_1483 = cute.get_iter(%grouped_1481) : !memref_rmem_bf16_7
      %lay_1484 = cute.get_layout(%grouped_1468) : !memref_smem_bf16_14
      %539 = cute.get_shape(%lay_1484) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1485, %e1_1486, %e2_1487 = cute.get_leaves(%539) : !cute.shape<"((8,1),(2))">
      %lay_1488 = cute.get_layout(%grouped_1481) : !memref_rmem_bf16_7
      %540 = cute.get_shape(%lay_1488) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1489, %e1_1490, %e2_1491 = cute.get_leaves(%540) : !cute.shape<"((8,1),(2))">
      %sz_1492 = cute.size(%grouped_1468) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1493 = cute.get_leaves(%sz_1492) : !cute.int_tuple<"2">
      %sz_1494 = cute.size(%grouped_1481) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1495 = cute.get_leaves(%sz_1494) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1468, %grouped_1481) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1496 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1497 = cute.slice(%src_partitioned_321, %coord_1496) : !memref_smem_bf16_9, !cute.coord<"(_,_,4)">
      %iter_1498 = cute.get_iter(%slice_1497) : !memref_smem_bf16_16
      %coord_1499 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1500 = cute.slice(%retiled_323, %coord_1499) : !memref_rmem_bf16_4, !cute.coord<"(_,_,4)">
      %iter_1501 = cute.get_iter(%slice_1500) : !memref_rmem_bf16_8
      %lay_1502 = cute.get_layout(%slice_1497) : !memref_smem_bf16_16
      %541 = cute.get_shape(%lay_1502) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1503, %e1_1504, %e2_1505 = cute.get_leaves(%541) : !cute.shape<"((8,1),4)">
      %lay_1506 = cute.get_layout(%slice_1500) : !memref_rmem_bf16_8
      %542 = cute.get_shape(%lay_1506) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1507, %e1_1508, %e2_1509 = cute.get_leaves(%542) : !cute.shape<"((8,1),4)">
      %lay_1510 = cute.get_layout(%slice_1497) : !memref_smem_bf16_16
      %shape_1511 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1512 = cute.make_layout(%shape_1511) : !cute.layout<"1:0">
      %append_1513 = cute.append_to_rank<2> (%lay_1510, %lay_1512) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1514 = cute.make_view(%iter_1498, %append_1513) : !memref_smem_bf16_16
      %iter_1515 = cute.get_iter(%view_1514) : !memref_smem_bf16_16
      %lay_1516 = cute.get_layout(%view_1514) : !memref_smem_bf16_16
      %543 = cute.get_shape(%lay_1516) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1517, %e1_1518, %e2_1519 = cute.get_leaves(%543) : !cute.shape<"((8,1),4)">
      %grouped_1520 = cute.group_modes(%view_1514) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1521 = cute.get_iter(%grouped_1520) : !memref_smem_bf16_17
      %iter_1522 = cute.get_iter(%grouped_1520) : !memref_smem_bf16_17
      %lay_1523 = cute.get_layout(%slice_1500) : !memref_rmem_bf16_8
      %shape_1524 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1525 = cute.make_layout(%shape_1524) : !cute.layout<"1:0">
      %append_1526 = cute.append_to_rank<2> (%lay_1523, %lay_1525) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1527 = cute.make_view(%iter_1501, %append_1526) : !memref_rmem_bf16_8
      %iter_1528 = cute.get_iter(%view_1527) : !memref_rmem_bf16_8
      %lay_1529 = cute.get_layout(%view_1527) : !memref_rmem_bf16_8
      %544 = cute.get_shape(%lay_1529) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1530, %e1_1531, %e2_1532 = cute.get_leaves(%544) : !cute.shape<"((8,1),4)">
      %grouped_1533 = cute.group_modes(%view_1527) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1534 = cute.get_iter(%grouped_1533) : !memref_rmem_bf16_9
      %iter_1535 = cute.get_iter(%grouped_1533) : !memref_rmem_bf16_9
      %lay_1536 = cute.get_layout(%grouped_1520) : !memref_smem_bf16_17
      %545 = cute.get_shape(%lay_1536) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1537, %e1_1538, %e2_1539 = cute.get_leaves(%545) : !cute.shape<"((8,1),(4))">
      %lay_1540 = cute.get_layout(%grouped_1533) : !memref_rmem_bf16_9
      %546 = cute.get_shape(%lay_1540) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1541, %e1_1542, %e2_1543 = cute.get_leaves(%546) : !cute.shape<"((8,1),(4))">
      %sz_1544 = cute.size(%grouped_1520) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1545 = cute.get_leaves(%sz_1544) : !cute.int_tuple<"4">
      %sz_1546 = cute.size(%grouped_1533) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1547 = cute.get_leaves(%sz_1546) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1520, %grouped_1533) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1548 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1549 = cute.slice(%frg_A, %coord_1548) : !memref_rmem_bf16_, !cute.coord<"(_,_,3)">
      %iter_1550 = cute.get_iter(%slice_1549) : !memref_rmem_bf16_10
      %coord_1551 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_1552 = cute.slice(%frg_B, %coord_1551) : !memref_rmem_bf16_1, !cute.coord<"(_,_,3)">
      %iter_1553 = cute.get_iter(%slice_1552) : !memref_rmem_bf16_11
      %lay_1554 = cute.get_layout(%slice_1549) : !memref_rmem_bf16_10
      %547 = cute.get_shape(%lay_1554) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1555, %e1_1556, %e2_1557, %e3_1558 = cute.get_leaves(%547) : !cute.shape<"((2,2,2),2)">
      %lay_1559 = cute.get_layout(%slice_1552) : !memref_rmem_bf16_11
      %548 = cute.get_shape(%lay_1559) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1560, %e1_1561, %e2_1562 = cute.get_leaves(%548) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1549, %slice_1552, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1563 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1564 = cute.size(%int_tuple_1563) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1565 = cute.get_leaves(%sz_1564) : !cute.int_tuple<"8">
      %coord_1566 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1567 = cute.slice(%src_partitioned_317, %coord_1566) : !memref_smem_bf16_8, !cute.coord<"(_,_,5)">
      %iter_1568 = cute.get_iter(%slice_1567) : !memref_smem_bf16_13
      %coord_1569 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1570 = cute.slice(%retiled, %coord_1569) : !memref_rmem_bf16_3, !cute.coord<"(_,_,5)">
      %iter_1571 = cute.get_iter(%slice_1570) : !memref_rmem_bf16_6
      %lay_1572 = cute.get_layout(%slice_1567) : !memref_smem_bf16_13
      %549 = cute.get_shape(%lay_1572) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1573, %e1_1574, %e2_1575 = cute.get_leaves(%549) : !cute.shape<"((8,1),2)">
      %lay_1576 = cute.get_layout(%slice_1570) : !memref_rmem_bf16_6
      %550 = cute.get_shape(%lay_1576) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1577, %e1_1578, %e2_1579 = cute.get_leaves(%550) : !cute.shape<"((8,1),2)">
      %lay_1580 = cute.get_layout(%slice_1567) : !memref_smem_bf16_13
      %shape_1581 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1582 = cute.make_layout(%shape_1581) : !cute.layout<"1:0">
      %append_1583 = cute.append_to_rank<2> (%lay_1580, %lay_1582) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1584 = cute.make_view(%iter_1568, %append_1583) : !memref_smem_bf16_13
      %iter_1585 = cute.get_iter(%view_1584) : !memref_smem_bf16_13
      %lay_1586 = cute.get_layout(%view_1584) : !memref_smem_bf16_13
      %551 = cute.get_shape(%lay_1586) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1587, %e1_1588, %e2_1589 = cute.get_leaves(%551) : !cute.shape<"((8,1),2)">
      %grouped_1590 = cute.group_modes(%view_1584) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1591 = cute.get_iter(%grouped_1590) : !memref_smem_bf16_14
      %iter_1592 = cute.get_iter(%grouped_1590) : !memref_smem_bf16_14
      %lay_1593 = cute.get_layout(%slice_1570) : !memref_rmem_bf16_6
      %shape_1594 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1595 = cute.make_layout(%shape_1594) : !cute.layout<"1:0">
      %append_1596 = cute.append_to_rank<2> (%lay_1593, %lay_1595) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1597 = cute.make_view(%iter_1571, %append_1596) : !memref_rmem_bf16_6
      %iter_1598 = cute.get_iter(%view_1597) : !memref_rmem_bf16_6
      %lay_1599 = cute.get_layout(%view_1597) : !memref_rmem_bf16_6
      %552 = cute.get_shape(%lay_1599) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1600, %e1_1601, %e2_1602 = cute.get_leaves(%552) : !cute.shape<"((8,1),2)">
      %grouped_1603 = cute.group_modes(%view_1597) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1604 = cute.get_iter(%grouped_1603) : !memref_rmem_bf16_7
      %iter_1605 = cute.get_iter(%grouped_1603) : !memref_rmem_bf16_7
      %lay_1606 = cute.get_layout(%grouped_1590) : !memref_smem_bf16_14
      %553 = cute.get_shape(%lay_1606) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1607, %e1_1608, %e2_1609 = cute.get_leaves(%553) : !cute.shape<"((8,1),(2))">
      %lay_1610 = cute.get_layout(%grouped_1603) : !memref_rmem_bf16_7
      %554 = cute.get_shape(%lay_1610) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1611, %e1_1612, %e2_1613 = cute.get_leaves(%554) : !cute.shape<"((8,1),(2))">
      %sz_1614 = cute.size(%grouped_1590) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1615 = cute.get_leaves(%sz_1614) : !cute.int_tuple<"2">
      %sz_1616 = cute.size(%grouped_1603) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1617 = cute.get_leaves(%sz_1616) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1590, %grouped_1603) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1618 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1619 = cute.slice(%src_partitioned_321, %coord_1618) : !memref_smem_bf16_9, !cute.coord<"(_,_,5)">
      %iter_1620 = cute.get_iter(%slice_1619) : !memref_smem_bf16_16
      %coord_1621 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1622 = cute.slice(%retiled_323, %coord_1621) : !memref_rmem_bf16_4, !cute.coord<"(_,_,5)">
      %iter_1623 = cute.get_iter(%slice_1622) : !memref_rmem_bf16_8
      %lay_1624 = cute.get_layout(%slice_1619) : !memref_smem_bf16_16
      %555 = cute.get_shape(%lay_1624) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1625, %e1_1626, %e2_1627 = cute.get_leaves(%555) : !cute.shape<"((8,1),4)">
      %lay_1628 = cute.get_layout(%slice_1622) : !memref_rmem_bf16_8
      %556 = cute.get_shape(%lay_1628) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1629, %e1_1630, %e2_1631 = cute.get_leaves(%556) : !cute.shape<"((8,1),4)">
      %lay_1632 = cute.get_layout(%slice_1619) : !memref_smem_bf16_16
      %shape_1633 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1634 = cute.make_layout(%shape_1633) : !cute.layout<"1:0">
      %append_1635 = cute.append_to_rank<2> (%lay_1632, %lay_1634) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1636 = cute.make_view(%iter_1620, %append_1635) : !memref_smem_bf16_16
      %iter_1637 = cute.get_iter(%view_1636) : !memref_smem_bf16_16
      %lay_1638 = cute.get_layout(%view_1636) : !memref_smem_bf16_16
      %557 = cute.get_shape(%lay_1638) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1639, %e1_1640, %e2_1641 = cute.get_leaves(%557) : !cute.shape<"((8,1),4)">
      %grouped_1642 = cute.group_modes(%view_1636) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1643 = cute.get_iter(%grouped_1642) : !memref_smem_bf16_17
      %iter_1644 = cute.get_iter(%grouped_1642) : !memref_smem_bf16_17
      %lay_1645 = cute.get_layout(%slice_1622) : !memref_rmem_bf16_8
      %shape_1646 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1647 = cute.make_layout(%shape_1646) : !cute.layout<"1:0">
      %append_1648 = cute.append_to_rank<2> (%lay_1645, %lay_1647) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1649 = cute.make_view(%iter_1623, %append_1648) : !memref_rmem_bf16_8
      %iter_1650 = cute.get_iter(%view_1649) : !memref_rmem_bf16_8
      %lay_1651 = cute.get_layout(%view_1649) : !memref_rmem_bf16_8
      %558 = cute.get_shape(%lay_1651) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1652, %e1_1653, %e2_1654 = cute.get_leaves(%558) : !cute.shape<"((8,1),4)">
      %grouped_1655 = cute.group_modes(%view_1649) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1656 = cute.get_iter(%grouped_1655) : !memref_rmem_bf16_9
      %iter_1657 = cute.get_iter(%grouped_1655) : !memref_rmem_bf16_9
      %lay_1658 = cute.get_layout(%grouped_1642) : !memref_smem_bf16_17
      %559 = cute.get_shape(%lay_1658) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1659, %e1_1660, %e2_1661 = cute.get_leaves(%559) : !cute.shape<"((8,1),(4))">
      %lay_1662 = cute.get_layout(%grouped_1655) : !memref_rmem_bf16_9
      %560 = cute.get_shape(%lay_1662) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1663, %e1_1664, %e2_1665 = cute.get_leaves(%560) : !cute.shape<"((8,1),(4))">
      %sz_1666 = cute.size(%grouped_1642) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1667 = cute.get_leaves(%sz_1666) : !cute.int_tuple<"4">
      %sz_1668 = cute.size(%grouped_1655) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1669 = cute.get_leaves(%sz_1668) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1642, %grouped_1655) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1670 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1671 = cute.slice(%frg_A, %coord_1670) : !memref_rmem_bf16_, !cute.coord<"(_,_,4)">
      %iter_1672 = cute.get_iter(%slice_1671) : !memref_rmem_bf16_10
      %coord_1673 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %slice_1674 = cute.slice(%frg_B, %coord_1673) : !memref_rmem_bf16_1, !cute.coord<"(_,_,4)">
      %iter_1675 = cute.get_iter(%slice_1674) : !memref_rmem_bf16_11
      %lay_1676 = cute.get_layout(%slice_1671) : !memref_rmem_bf16_10
      %561 = cute.get_shape(%lay_1676) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1677, %e1_1678, %e2_1679, %e3_1680 = cute.get_leaves(%561) : !cute.shape<"((2,2,2),2)">
      %lay_1681 = cute.get_layout(%slice_1674) : !memref_rmem_bf16_11
      %562 = cute.get_shape(%lay_1681) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1682, %e1_1683, %e2_1684 = cute.get_leaves(%562) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1671, %slice_1674, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1685 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1686 = cute.size(%int_tuple_1685) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1687 = cute.get_leaves(%sz_1686) : !cute.int_tuple<"8">
      %coord_1688 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1689 = cute.slice(%src_partitioned_317, %coord_1688) : !memref_smem_bf16_8, !cute.coord<"(_,_,6)">
      %iter_1690 = cute.get_iter(%slice_1689) : !memref_smem_bf16_13
      %coord_1691 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1692 = cute.slice(%retiled, %coord_1691) : !memref_rmem_bf16_3, !cute.coord<"(_,_,6)">
      %iter_1693 = cute.get_iter(%slice_1692) : !memref_rmem_bf16_6
      %lay_1694 = cute.get_layout(%slice_1689) : !memref_smem_bf16_13
      %563 = cute.get_shape(%lay_1694) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1695, %e1_1696, %e2_1697 = cute.get_leaves(%563) : !cute.shape<"((8,1),2)">
      %lay_1698 = cute.get_layout(%slice_1692) : !memref_rmem_bf16_6
      %564 = cute.get_shape(%lay_1698) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1699, %e1_1700, %e2_1701 = cute.get_leaves(%564) : !cute.shape<"((8,1),2)">
      %lay_1702 = cute.get_layout(%slice_1689) : !memref_smem_bf16_13
      %shape_1703 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1704 = cute.make_layout(%shape_1703) : !cute.layout<"1:0">
      %append_1705 = cute.append_to_rank<2> (%lay_1702, %lay_1704) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1706 = cute.make_view(%iter_1690, %append_1705) : !memref_smem_bf16_13
      %iter_1707 = cute.get_iter(%view_1706) : !memref_smem_bf16_13
      %lay_1708 = cute.get_layout(%view_1706) : !memref_smem_bf16_13
      %565 = cute.get_shape(%lay_1708) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1709, %e1_1710, %e2_1711 = cute.get_leaves(%565) : !cute.shape<"((8,1),2)">
      %grouped_1712 = cute.group_modes(%view_1706) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1713 = cute.get_iter(%grouped_1712) : !memref_smem_bf16_14
      %iter_1714 = cute.get_iter(%grouped_1712) : !memref_smem_bf16_14
      %lay_1715 = cute.get_layout(%slice_1692) : !memref_rmem_bf16_6
      %shape_1716 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1717 = cute.make_layout(%shape_1716) : !cute.layout<"1:0">
      %append_1718 = cute.append_to_rank<2> (%lay_1715, %lay_1717) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1719 = cute.make_view(%iter_1693, %append_1718) : !memref_rmem_bf16_6
      %iter_1720 = cute.get_iter(%view_1719) : !memref_rmem_bf16_6
      %lay_1721 = cute.get_layout(%view_1719) : !memref_rmem_bf16_6
      %566 = cute.get_shape(%lay_1721) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1722, %e1_1723, %e2_1724 = cute.get_leaves(%566) : !cute.shape<"((8,1),2)">
      %grouped_1725 = cute.group_modes(%view_1719) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1726 = cute.get_iter(%grouped_1725) : !memref_rmem_bf16_7
      %iter_1727 = cute.get_iter(%grouped_1725) : !memref_rmem_bf16_7
      %lay_1728 = cute.get_layout(%grouped_1712) : !memref_smem_bf16_14
      %567 = cute.get_shape(%lay_1728) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1729, %e1_1730, %e2_1731 = cute.get_leaves(%567) : !cute.shape<"((8,1),(2))">
      %lay_1732 = cute.get_layout(%grouped_1725) : !memref_rmem_bf16_7
      %568 = cute.get_shape(%lay_1732) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1733, %e1_1734, %e2_1735 = cute.get_leaves(%568) : !cute.shape<"((8,1),(2))">
      %sz_1736 = cute.size(%grouped_1712) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1737 = cute.get_leaves(%sz_1736) : !cute.int_tuple<"2">
      %sz_1738 = cute.size(%grouped_1725) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1739 = cute.get_leaves(%sz_1738) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1712, %grouped_1725) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1740 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1741 = cute.slice(%src_partitioned_321, %coord_1740) : !memref_smem_bf16_9, !cute.coord<"(_,_,6)">
      %iter_1742 = cute.get_iter(%slice_1741) : !memref_smem_bf16_16
      %coord_1743 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1744 = cute.slice(%retiled_323, %coord_1743) : !memref_rmem_bf16_4, !cute.coord<"(_,_,6)">
      %iter_1745 = cute.get_iter(%slice_1744) : !memref_rmem_bf16_8
      %lay_1746 = cute.get_layout(%slice_1741) : !memref_smem_bf16_16
      %569 = cute.get_shape(%lay_1746) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1747, %e1_1748, %e2_1749 = cute.get_leaves(%569) : !cute.shape<"((8,1),4)">
      %lay_1750 = cute.get_layout(%slice_1744) : !memref_rmem_bf16_8
      %570 = cute.get_shape(%lay_1750) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1751, %e1_1752, %e2_1753 = cute.get_leaves(%570) : !cute.shape<"((8,1),4)">
      %lay_1754 = cute.get_layout(%slice_1741) : !memref_smem_bf16_16
      %shape_1755 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1756 = cute.make_layout(%shape_1755) : !cute.layout<"1:0">
      %append_1757 = cute.append_to_rank<2> (%lay_1754, %lay_1756) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1758 = cute.make_view(%iter_1742, %append_1757) : !memref_smem_bf16_16
      %iter_1759 = cute.get_iter(%view_1758) : !memref_smem_bf16_16
      %lay_1760 = cute.get_layout(%view_1758) : !memref_smem_bf16_16
      %571 = cute.get_shape(%lay_1760) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1761, %e1_1762, %e2_1763 = cute.get_leaves(%571) : !cute.shape<"((8,1),4)">
      %grouped_1764 = cute.group_modes(%view_1758) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1765 = cute.get_iter(%grouped_1764) : !memref_smem_bf16_17
      %iter_1766 = cute.get_iter(%grouped_1764) : !memref_smem_bf16_17
      %lay_1767 = cute.get_layout(%slice_1744) : !memref_rmem_bf16_8
      %shape_1768 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1769 = cute.make_layout(%shape_1768) : !cute.layout<"1:0">
      %append_1770 = cute.append_to_rank<2> (%lay_1767, %lay_1769) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1771 = cute.make_view(%iter_1745, %append_1770) : !memref_rmem_bf16_8
      %iter_1772 = cute.get_iter(%view_1771) : !memref_rmem_bf16_8
      %lay_1773 = cute.get_layout(%view_1771) : !memref_rmem_bf16_8
      %572 = cute.get_shape(%lay_1773) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1774, %e1_1775, %e2_1776 = cute.get_leaves(%572) : !cute.shape<"((8,1),4)">
      %grouped_1777 = cute.group_modes(%view_1771) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1778 = cute.get_iter(%grouped_1777) : !memref_rmem_bf16_9
      %iter_1779 = cute.get_iter(%grouped_1777) : !memref_rmem_bf16_9
      %lay_1780 = cute.get_layout(%grouped_1764) : !memref_smem_bf16_17
      %573 = cute.get_shape(%lay_1780) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1781, %e1_1782, %e2_1783 = cute.get_leaves(%573) : !cute.shape<"((8,1),(4))">
      %lay_1784 = cute.get_layout(%grouped_1777) : !memref_rmem_bf16_9
      %574 = cute.get_shape(%lay_1784) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1785, %e1_1786, %e2_1787 = cute.get_leaves(%574) : !cute.shape<"((8,1),(4))">
      %sz_1788 = cute.size(%grouped_1764) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1789 = cute.get_leaves(%sz_1788) : !cute.int_tuple<"4">
      %sz_1790 = cute.size(%grouped_1777) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1791 = cute.get_leaves(%sz_1790) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1764, %grouped_1777) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1792 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1793 = cute.slice(%frg_A, %coord_1792) : !memref_rmem_bf16_, !cute.coord<"(_,_,5)">
      %iter_1794 = cute.get_iter(%slice_1793) : !memref_rmem_bf16_10
      %coord_1795 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %slice_1796 = cute.slice(%frg_B, %coord_1795) : !memref_rmem_bf16_1, !cute.coord<"(_,_,5)">
      %iter_1797 = cute.get_iter(%slice_1796) : !memref_rmem_bf16_11
      %lay_1798 = cute.get_layout(%slice_1793) : !memref_rmem_bf16_10
      %575 = cute.get_shape(%lay_1798) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1799, %e1_1800, %e2_1801, %e3_1802 = cute.get_leaves(%575) : !cute.shape<"((2,2,2),2)">
      %lay_1803 = cute.get_layout(%slice_1796) : !memref_rmem_bf16_11
      %576 = cute.get_shape(%lay_1803) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1804, %e1_1805, %e2_1806 = cute.get_leaves(%576) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1793, %slice_1796, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1807 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1808 = cute.size(%int_tuple_1807) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1809 = cute.get_leaves(%sz_1808) : !cute.int_tuple<"8">
      %coord_1810 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_1811 = cute.slice(%src_partitioned_317, %coord_1810) : !memref_smem_bf16_8, !cute.coord<"(_,_,7)">
      %iter_1812 = cute.get_iter(%slice_1811) : !memref_smem_bf16_13
      %coord_1813 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_1814 = cute.slice(%retiled, %coord_1813) : !memref_rmem_bf16_3, !cute.coord<"(_,_,7)">
      %iter_1815 = cute.get_iter(%slice_1814) : !memref_rmem_bf16_6
      %lay_1816 = cute.get_layout(%slice_1811) : !memref_smem_bf16_13
      %577 = cute.get_shape(%lay_1816) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1817, %e1_1818, %e2_1819 = cute.get_leaves(%577) : !cute.shape<"((8,1),2)">
      %lay_1820 = cute.get_layout(%slice_1814) : !memref_rmem_bf16_6
      %578 = cute.get_shape(%lay_1820) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1821, %e1_1822, %e2_1823 = cute.get_leaves(%578) : !cute.shape<"((8,1),2)">
      %lay_1824 = cute.get_layout(%slice_1811) : !memref_smem_bf16_13
      %shape_1825 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1826 = cute.make_layout(%shape_1825) : !cute.layout<"1:0">
      %append_1827 = cute.append_to_rank<2> (%lay_1824, %lay_1826) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1828 = cute.make_view(%iter_1812, %append_1827) : !memref_smem_bf16_13
      %iter_1829 = cute.get_iter(%view_1828) : !memref_smem_bf16_13
      %lay_1830 = cute.get_layout(%view_1828) : !memref_smem_bf16_13
      %579 = cute.get_shape(%lay_1830) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1831, %e1_1832, %e2_1833 = cute.get_leaves(%579) : !cute.shape<"((8,1),2)">
      %grouped_1834 = cute.group_modes(%view_1828) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1835 = cute.get_iter(%grouped_1834) : !memref_smem_bf16_14
      %iter_1836 = cute.get_iter(%grouped_1834) : !memref_smem_bf16_14
      %lay_1837 = cute.get_layout(%slice_1814) : !memref_rmem_bf16_6
      %shape_1838 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1839 = cute.make_layout(%shape_1838) : !cute.layout<"1:0">
      %append_1840 = cute.append_to_rank<2> (%lay_1837, %lay_1839) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1841 = cute.make_view(%iter_1815, %append_1840) : !memref_rmem_bf16_6
      %iter_1842 = cute.get_iter(%view_1841) : !memref_rmem_bf16_6
      %lay_1843 = cute.get_layout(%view_1841) : !memref_rmem_bf16_6
      %580 = cute.get_shape(%lay_1843) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1844, %e1_1845, %e2_1846 = cute.get_leaves(%580) : !cute.shape<"((8,1),2)">
      %grouped_1847 = cute.group_modes(%view_1841) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1848 = cute.get_iter(%grouped_1847) : !memref_rmem_bf16_7
      %iter_1849 = cute.get_iter(%grouped_1847) : !memref_rmem_bf16_7
      %lay_1850 = cute.get_layout(%grouped_1834) : !memref_smem_bf16_14
      %581 = cute.get_shape(%lay_1850) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1851, %e1_1852, %e2_1853 = cute.get_leaves(%581) : !cute.shape<"((8,1),(2))">
      %lay_1854 = cute.get_layout(%grouped_1847) : !memref_rmem_bf16_7
      %582 = cute.get_shape(%lay_1854) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1855, %e1_1856, %e2_1857 = cute.get_leaves(%582) : !cute.shape<"((8,1),(2))">
      %sz_1858 = cute.size(%grouped_1834) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1859 = cute.get_leaves(%sz_1858) : !cute.int_tuple<"2">
      %sz_1860 = cute.size(%grouped_1847) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1861 = cute.get_leaves(%sz_1860) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1834, %grouped_1847) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1862 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_1863 = cute.slice(%src_partitioned_321, %coord_1862) : !memref_smem_bf16_9, !cute.coord<"(_,_,7)">
      %iter_1864 = cute.get_iter(%slice_1863) : !memref_smem_bf16_16
      %coord_1865 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_1866 = cute.slice(%retiled_323, %coord_1865) : !memref_rmem_bf16_4, !cute.coord<"(_,_,7)">
      %iter_1867 = cute.get_iter(%slice_1866) : !memref_rmem_bf16_8
      %lay_1868 = cute.get_layout(%slice_1863) : !memref_smem_bf16_16
      %583 = cute.get_shape(%lay_1868) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1869, %e1_1870, %e2_1871 = cute.get_leaves(%583) : !cute.shape<"((8,1),4)">
      %lay_1872 = cute.get_layout(%slice_1866) : !memref_rmem_bf16_8
      %584 = cute.get_shape(%lay_1872) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1873, %e1_1874, %e2_1875 = cute.get_leaves(%584) : !cute.shape<"((8,1),4)">
      %lay_1876 = cute.get_layout(%slice_1863) : !memref_smem_bf16_16
      %shape_1877 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1878 = cute.make_layout(%shape_1877) : !cute.layout<"1:0">
      %append_1879 = cute.append_to_rank<2> (%lay_1876, %lay_1878) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1880 = cute.make_view(%iter_1864, %append_1879) : !memref_smem_bf16_16
      %iter_1881 = cute.get_iter(%view_1880) : !memref_smem_bf16_16
      %lay_1882 = cute.get_layout(%view_1880) : !memref_smem_bf16_16
      %585 = cute.get_shape(%lay_1882) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1883, %e1_1884, %e2_1885 = cute.get_leaves(%585) : !cute.shape<"((8,1),4)">
      %grouped_1886 = cute.group_modes(%view_1880) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_1887 = cute.get_iter(%grouped_1886) : !memref_smem_bf16_17
      %iter_1888 = cute.get_iter(%grouped_1886) : !memref_smem_bf16_17
      %lay_1889 = cute.get_layout(%slice_1866) : !memref_rmem_bf16_8
      %shape_1890 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1891 = cute.make_layout(%shape_1890) : !cute.layout<"1:0">
      %append_1892 = cute.append_to_rank<2> (%lay_1889, %lay_1891) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1893 = cute.make_view(%iter_1867, %append_1892) : !memref_rmem_bf16_8
      %iter_1894 = cute.get_iter(%view_1893) : !memref_rmem_bf16_8
      %lay_1895 = cute.get_layout(%view_1893) : !memref_rmem_bf16_8
      %586 = cute.get_shape(%lay_1895) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1896, %e1_1897, %e2_1898 = cute.get_leaves(%586) : !cute.shape<"((8,1),4)">
      %grouped_1899 = cute.group_modes(%view_1893) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_1900 = cute.get_iter(%grouped_1899) : !memref_rmem_bf16_9
      %iter_1901 = cute.get_iter(%grouped_1899) : !memref_rmem_bf16_9
      %lay_1902 = cute.get_layout(%grouped_1886) : !memref_smem_bf16_17
      %587 = cute.get_shape(%lay_1902) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1903, %e1_1904, %e2_1905 = cute.get_leaves(%587) : !cute.shape<"((8,1),(4))">
      %lay_1906 = cute.get_layout(%grouped_1899) : !memref_rmem_bf16_9
      %588 = cute.get_shape(%lay_1906) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1907, %e1_1908, %e2_1909 = cute.get_leaves(%588) : !cute.shape<"((8,1),(4))">
      %sz_1910 = cute.size(%grouped_1886) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_1911 = cute.get_leaves(%sz_1910) : !cute.int_tuple<"4">
      %sz_1912 = cute.size(%grouped_1899) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_1913 = cute.get_leaves(%sz_1912) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_1886, %grouped_1899) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_1914 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1915 = cute.slice(%frg_A, %coord_1914) : !memref_rmem_bf16_, !cute.coord<"(_,_,6)">
      %iter_1916 = cute.get_iter(%slice_1915) : !memref_rmem_bf16_10
      %coord_1917 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %slice_1918 = cute.slice(%frg_B, %coord_1917) : !memref_rmem_bf16_1, !cute.coord<"(_,_,6)">
      %iter_1919 = cute.get_iter(%slice_1918) : !memref_rmem_bf16_11
      %lay_1920 = cute.get_layout(%slice_1915) : !memref_rmem_bf16_10
      %589 = cute.get_shape(%lay_1920) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1921, %e1_1922, %e2_1923, %e3_1924 = cute.get_leaves(%589) : !cute.shape<"((2,2,2),2)">
      %lay_1925 = cute.get_layout(%slice_1918) : !memref_rmem_bf16_11
      %590 = cute.get_shape(%lay_1925) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1926, %e1_1927, %e2_1928 = cute.get_leaves(%590) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_1915, %slice_1918, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      %int_tuple_1929 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1930 = cute.size(%int_tuple_1929) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1931 = cute.get_leaves(%sz_1930) : !cute.int_tuple<"8">
      %coord_1932 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1933 = cute.slice(%src_partitioned_317, %coord_1932) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)">
      %iter_1934 = cute.get_iter(%slice_1933) : !memref_smem_bf16_13
      %coord_1935 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1936 = cute.slice(%retiled, %coord_1935) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)">
      %iter_1937 = cute.get_iter(%slice_1936) : !memref_rmem_bf16_6
      %lay_1938 = cute.get_layout(%slice_1933) : !memref_smem_bf16_13
      %591 = cute.get_shape(%lay_1938) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1939, %e1_1940, %e2_1941 = cute.get_leaves(%591) : !cute.shape<"((8,1),2)">
      %lay_1942 = cute.get_layout(%slice_1936) : !memref_rmem_bf16_6
      %592 = cute.get_shape(%lay_1942) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1943, %e1_1944, %e2_1945 = cute.get_leaves(%592) : !cute.shape<"((8,1),2)">
      %lay_1946 = cute.get_layout(%slice_1933) : !memref_smem_bf16_13
      %shape_1947 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1948 = cute.make_layout(%shape_1947) : !cute.layout<"1:0">
      %append_1949 = cute.append_to_rank<2> (%lay_1946, %lay_1948) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1950 = cute.make_view(%iter_1934, %append_1949) : !memref_smem_bf16_13
      %iter_1951 = cute.get_iter(%view_1950) : !memref_smem_bf16_13
      %lay_1952 = cute.get_layout(%view_1950) : !memref_smem_bf16_13
      %593 = cute.get_shape(%lay_1952) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1953, %e1_1954, %e2_1955 = cute.get_leaves(%593) : !cute.shape<"((8,1),2)">
      %grouped_1956 = cute.group_modes(%view_1950) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
      %iter_1957 = cute.get_iter(%grouped_1956) : !memref_smem_bf16_14
      %iter_1958 = cute.get_iter(%grouped_1956) : !memref_smem_bf16_14
      %lay_1959 = cute.get_layout(%slice_1936) : !memref_rmem_bf16_6
      %shape_1960 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1961 = cute.make_layout(%shape_1960) : !cute.layout<"1:0">
      %append_1962 = cute.append_to_rank<2> (%lay_1959, %lay_1961) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1963 = cute.make_view(%iter_1937, %append_1962) : !memref_rmem_bf16_6
      %iter_1964 = cute.get_iter(%view_1963) : !memref_rmem_bf16_6
      %lay_1965 = cute.get_layout(%view_1963) : !memref_rmem_bf16_6
      %594 = cute.get_shape(%lay_1965) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1966, %e1_1967, %e2_1968 = cute.get_leaves(%594) : !cute.shape<"((8,1),2)">
      %grouped_1969 = cute.group_modes(%view_1963) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
      %iter_1970 = cute.get_iter(%grouped_1969) : !memref_rmem_bf16_7
      %iter_1971 = cute.get_iter(%grouped_1969) : !memref_rmem_bf16_7
      %lay_1972 = cute.get_layout(%grouped_1956) : !memref_smem_bf16_14
      %595 = cute.get_shape(%lay_1972) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1973, %e1_1974, %e2_1975 = cute.get_leaves(%595) : !cute.shape<"((8,1),(2))">
      %lay_1976 = cute.get_layout(%grouped_1969) : !memref_rmem_bf16_7
      %596 = cute.get_shape(%lay_1976) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1977, %e1_1978, %e2_1979 = cute.get_leaves(%596) : !cute.shape<"((8,1),(2))">
      %sz_1980 = cute.size(%grouped_1956) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
      %e0_1981 = cute.get_leaves(%sz_1980) : !cute.int_tuple<"2">
      %sz_1982 = cute.size(%grouped_1969) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
      %e0_1983 = cute.get_leaves(%sz_1982) : !cute.int_tuple<"2">
      cute.copy(%136, %grouped_1956, %grouped_1969) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
      %coord_1984 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1985 = cute.slice(%src_partitioned_321, %coord_1984) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)">
      %iter_1986 = cute.get_iter(%slice_1985) : !memref_smem_bf16_16
      %coord_1987 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_1988 = cute.slice(%retiled_323, %coord_1987) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)">
      %iter_1989 = cute.get_iter(%slice_1988) : !memref_rmem_bf16_8
      %lay_1990 = cute.get_layout(%slice_1985) : !memref_smem_bf16_16
      %597 = cute.get_shape(%lay_1990) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1991, %e1_1992, %e2_1993 = cute.get_leaves(%597) : !cute.shape<"((8,1),4)">
      %lay_1994 = cute.get_layout(%slice_1988) : !memref_rmem_bf16_8
      %598 = cute.get_shape(%lay_1994) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1995, %e1_1996, %e2_1997 = cute.get_leaves(%598) : !cute.shape<"((8,1),4)">
      %lay_1998 = cute.get_layout(%slice_1985) : !memref_smem_bf16_16
      %shape_1999 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2000 = cute.make_layout(%shape_1999) : !cute.layout<"1:0">
      %append_2001 = cute.append_to_rank<2> (%lay_1998, %lay_2000) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2002 = cute.make_view(%iter_1986, %append_2001) : !memref_smem_bf16_16
      %iter_2003 = cute.get_iter(%view_2002) : !memref_smem_bf16_16
      %lay_2004 = cute.get_layout(%view_2002) : !memref_smem_bf16_16
      %599 = cute.get_shape(%lay_2004) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2005, %e1_2006, %e2_2007 = cute.get_leaves(%599) : !cute.shape<"((8,1),4)">
      %grouped_2008 = cute.group_modes(%view_2002) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
      %iter_2009 = cute.get_iter(%grouped_2008) : !memref_smem_bf16_17
      %iter_2010 = cute.get_iter(%grouped_2008) : !memref_smem_bf16_17
      %lay_2011 = cute.get_layout(%slice_1988) : !memref_rmem_bf16_8
      %shape_2012 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2013 = cute.make_layout(%shape_2012) : !cute.layout<"1:0">
      %append_2014 = cute.append_to_rank<2> (%lay_2011, %lay_2013) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2015 = cute.make_view(%iter_1989, %append_2014) : !memref_rmem_bf16_8
      %iter_2016 = cute.get_iter(%view_2015) : !memref_rmem_bf16_8
      %lay_2017 = cute.get_layout(%view_2015) : !memref_rmem_bf16_8
      %600 = cute.get_shape(%lay_2017) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2018, %e1_2019, %e2_2020 = cute.get_leaves(%600) : !cute.shape<"((8,1),4)">
      %grouped_2021 = cute.group_modes(%view_2015) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
      %iter_2022 = cute.get_iter(%grouped_2021) : !memref_rmem_bf16_9
      %iter_2023 = cute.get_iter(%grouped_2021) : !memref_rmem_bf16_9
      %lay_2024 = cute.get_layout(%grouped_2008) : !memref_smem_bf16_17
      %601 = cute.get_shape(%lay_2024) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2025, %e1_2026, %e2_2027 = cute.get_leaves(%601) : !cute.shape<"((8,1),(4))">
      %lay_2028 = cute.get_layout(%grouped_2021) : !memref_rmem_bf16_9
      %602 = cute.get_shape(%lay_2028) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2029, %e1_2030, %e2_2031 = cute.get_leaves(%602) : !cute.shape<"((8,1),(4))">
      %sz_2032 = cute.size(%grouped_2008) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
      %e0_2033 = cute.get_leaves(%sz_2032) : !cute.int_tuple<"4">
      %sz_2034 = cute.size(%grouped_2021) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
      %e0_2035 = cute.get_leaves(%sz_2034) : !cute.int_tuple<"4">
      cute.copy(%140, %grouped_2008, %grouped_2021) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
      %coord_2036 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_2037 = cute.slice(%frg_A, %coord_2036) : !memref_rmem_bf16_, !cute.coord<"(_,_,7)">
      %iter_2038 = cute.get_iter(%slice_2037) : !memref_rmem_bf16_10
      %coord_2039 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %slice_2040 = cute.slice(%frg_B, %coord_2039) : !memref_rmem_bf16_1, !cute.coord<"(_,_,7)">
      %iter_2041 = cute.get_iter(%slice_2040) : !memref_rmem_bf16_11
      %lay_2042 = cute.get_layout(%slice_2037) : !memref_rmem_bf16_10
      %603 = cute.get_shape(%lay_2042) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2043, %e1_2044, %e2_2045, %e3_2046 = cute.get_leaves(%603) : !cute.shape<"((2,2,2),2)">
      %lay_2047 = cute.get_layout(%slice_2040) : !memref_rmem_bf16_11
      %604 = cute.get_shape(%lay_2047) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2048, %e1_2049, %e2_2050 = cute.get_leaves(%604) : !cute.shape<"((2,2),8)">
      cute.gemm(%5, %rmem_943, %slice_2037, %slice_2040, %rmem_943) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
      nvvm.cp.async.wait.group 0
      %c1_i32_2051 = arith.constant 1 : i32
      %c128_i32_2052 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_2051 number_of_threads = %c128_i32_2052
      %605 = arith.cmpi sgt, %476, %c0_i32 : i32
      scf.if %605 {
        %c1_i32_6239 = arith.constant 1 : i32
        %2344 = arith.subi %476, %c1_i32_6239 : i32
        %coord_6240 = cute.make_coord(%2344) : (i32) -> !cute.coord<"(_,_,_,?)">
        %slice_6241 = cute.slice(%src_partitioned_233, %coord_6240) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)">
        %iter_6242 = cute.get_iter(%slice_6241) : !memref_gmem_bf16_8
        %lay_6243 = cute.get_layout(%slice_6241) : !memref_gmem_bf16_8
        %2345 = cute.get_shape(%lay_6243) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6244, %e1_6245, %e2_6246, %e3_6247 = cute.get_leaves(%2345) : !cute.shape<"((8,1),4,2)">
        %lay_6248 = cute.get_layout(%dst_partitioned_236) : !memref_smem_bf16_4
        %2346 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6249, %e1_6250, %e2_6251, %e3_6252 = cute.get_leaves(%2346) : !cute.shape<"((8,1),4,2)">
        %lay_6253 = cute.get_layout(%slice_6241) : !memref_gmem_bf16_8
        %shape_6254 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6255 = cute.make_layout(%shape_6254) : !cute.layout<"1:0">
        %append_6256 = cute.append_to_rank<2> (%lay_6253, %lay_6255) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_6257 = cute.make_view(%iter_6242, %append_6256) : !memref_gmem_bf16_8
        %iter_6258 = cute.get_iter(%view_6257) : !memref_gmem_bf16_8
        %lay_6259 = cute.get_layout(%view_6257) : !memref_gmem_bf16_8
        %2347 = cute.get_shape(%lay_6259) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6260, %e1_6261, %e2_6262, %e3_6263 = cute.get_leaves(%2347) : !cute.shape<"((8,1),4,2)">
        %grouped_6264 = cute.group_modes(%view_6257) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9
        %iter_6265 = cute.get_iter(%grouped_6264) : !memref_gmem_bf16_9
        %iter_6266 = cute.get_iter(%grouped_6264) : !memref_gmem_bf16_9
        %lay_6267 = cute.get_layout(%dst_partitioned_236) : !memref_smem_bf16_4
        %shape_6268 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6269 = cute.make_layout(%shape_6268) : !cute.layout<"1:0">
        %append_6270 = cute.append_to_rank<2> (%lay_6267, %lay_6269) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_6271 = cute.make_view(%iter_237, %append_6270) : !memref_smem_bf16_4
        %iter_6272 = cute.get_iter(%view_6271) : !memref_smem_bf16_4
        %lay_6273 = cute.get_layout(%view_6271) : !memref_smem_bf16_4
        %2348 = cute.get_shape(%lay_6273) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_6274, %e1_6275, %e2_6276, %e3_6277 = cute.get_leaves(%2348) : !cute.shape<"((8,1),4,2)">
        %grouped_6278 = cute.group_modes(%view_6271) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15
        %iter_6279 = cute.get_iter(%grouped_6278) : !memref_smem_bf16_15
        %iter_6280 = cute.get_iter(%grouped_6278) : !memref_smem_bf16_15
        %lay_6281 = cute.get_layout(%rmem_435) : !memref_rmem_i8_1
        %shape_6282 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6283 = cute.make_layout(%shape_6282) : !cute.layout<"1:0">
        %append_6284 = cute.append_to_rank<2> (%lay_6281, %lay_6283) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_6285 = cute.make_view(%iter_437, %append_6284) : !memref_rmem_i8_1
        %iter_6286 = cute.get_iter(%view_6285) : !memref_rmem_i8_1
        %lay_6287 = cute.get_layout(%view_6285) : !memref_rmem_i8_1
        %2349 = cute.get_shape(%lay_6287) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_6288, %e1_6289, %e2_6290 = cute.get_leaves(%2349) : !cute.shape<"(1,4,2)">
        %grouped_6291 = cute.group_modes(%view_6285) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_4
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_4
        %lay_6294 = cute.get_layout(%grouped_6264) : !memref_gmem_bf16_9
        %2350 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_6295, %e1_6296, %e2_6297, %e3_6298 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(4,2))">
        %lay_6299 = cute.get_layout(%grouped_6278) : !memref_smem_bf16_15
        %2351 = cute.get_shape(%lay_6299) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_6300, %e1_6301, %e2_6302, %e3_6303 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(4,2))">
        %sz_6304 = cute.size(%grouped_6264) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"8">
        %sz_6306 = cute.size(%grouped_6278) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8">
        %e0_6307 = cute.get_leaves(%sz_6306) : !cute.int_tuple<"8">
        cute.copy(%3, %grouped_6264, %grouped_6278, %grouped_6291) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4)
        nvvm.cp.async.commit.group
      }
      %lay_2053 = cute.get_layout(%rmem_943) : !memref_rmem_f32_2
      %606 = cute.get_shape(%lay_2053) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2054, %e1_2055, %e2_2056, %e3_2057 = cute.get_leaves(%606) : !cute.shape<"((2,2),2,8)">
      %shape_2058 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_2059 = cute.make_layout(%shape_2058) : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %607 = cute.get_shape(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2060, %e1_2061, %e2_2062, %e3_2063 = cute.get_leaves(%607) : !cute.shape<"((2,2),2,8)">
      %608 = cute.get_shape(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2064, %e1_2065, %e2_2066, %e3_2067 = cute.get_leaves(%608) : !cute.shape<"((2,2),2,8)">
      %609 = cute.get_shape(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2068, %e1_2069, %e2_2070, %e3_2071 = cute.get_leaves(%609) : !cute.shape<"((2,2),2,8)">
      %610 = cute.get_shape(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2072, %e1_2073, %e2_2074, %e3_2075 = cute.get_leaves(%610) : !cute.shape<"((2,2),2,8)">
      %611 = cute.get_stride(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2076, %e1_2077, %e2_2078, %e3_2079 = cute.get_leaves(%611) : !cute.stride<"((1,2),4,8)">
      %612 = cute.get_stride(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2080, %e1_2081, %e2_2082, %e3_2083 = cute.get_leaves(%612) : !cute.stride<"((1,2),4,8)">
      %613 = cute.get_stride(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2084, %e1_2085, %e2_2086, %e3_2087 = cute.get_leaves(%613) : !cute.stride<"((1,2),4,8)">
      %614 = cute.get_stride(%lay_2059) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2088, %e1_2089, %e2_2090, %e3_2091 = cute.get_leaves(%614) : !cute.stride<"((1,2),4,8)">
      %shape_2092 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_2093 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2094 = cute.make_layout(%shape_2092, %stride_2093) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_2095 = cute.get_layout(%rmem_943) : !memref_rmem_f32_2
      %615 = cute.composition(%lay_2095, %lay_2094) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %view_2096 = cute.make_view(%iter_945, %615) : !memref_rmem_f32_3
      %iter_2097 = cute.get_iter(%view_2096) : !memref_rmem_f32_3
      %lay_2098 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %616 = cute.get_shape(%lay_2098) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2099, %e1_2100, %e2_2101, %e3_2102 = cute.get_leaves(%616) : !cute.shape<"((2,2),2,16)">
      %shape_2103 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_2104 = cute.make_layout(%shape_2103) : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %617 = cute.get_shape(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2105, %e1_2106, %e2_2107, %e3_2108 = cute.get_leaves(%617) : !cute.shape<"((2,2),2,16)">
      %618 = cute.get_shape(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2109, %e1_2110, %e2_2111, %e3_2112 = cute.get_leaves(%618) : !cute.shape<"((2,2),2,16)">
      %619 = cute.get_shape(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2113, %e1_2114, %e2_2115, %e3_2116 = cute.get_leaves(%619) : !cute.shape<"((2,2),2,16)">
      %620 = cute.get_shape(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2117, %e1_2118, %e2_2119, %e3_2120 = cute.get_leaves(%620) : !cute.shape<"((2,2),2,16)">
      %621 = cute.get_stride(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2121, %e1_2122, %e2_2123, %e3_2124 = cute.get_leaves(%621) : !cute.stride<"((1,2),4,8)">
      %622 = cute.get_stride(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2125, %e1_2126, %e2_2127, %e3_2128 = cute.get_leaves(%622) : !cute.stride<"((1,2),4,8)">
      %623 = cute.get_stride(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2129, %e1_2130, %e2_2131, %e3_2132 = cute.get_leaves(%623) : !cute.stride<"((1,2),4,8)">
      %624 = cute.get_stride(%lay_2104) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2133, %e1_2134, %e2_2135, %e3_2136 = cute.get_leaves(%624) : !cute.stride<"((1,2),4,8)">
      %shape_2137 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_2138 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2139 = cute.make_layout(%shape_2137, %stride_2138) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_2140 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %625 = cute.composition(%lay_2140, %lay_2139) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_2141 = cute.make_view(%iter_263, %625) : !memref_rmem_f32_4
      %iter_2142 = cute.get_iter(%view_2141) : !memref_rmem_f32_4
      %lay_2143 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %626 = cute.get_shape(%lay_2143) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2144, %e1_2145, %e2_2146, %e3_2147 = cute.get_leaves(%626) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2148 = cute.to_int_tuple(%e0_2144) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %627 = cute.get_scalars(%itup_2148) : !cute.int_tuple<"?">
      %itup_2149 = cute.to_int_tuple(%e1_2145) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %628 = cute.get_scalars(%itup_2149) : !cute.int_tuple<"?">
      %itup_2150 = cute.to_int_tuple(%e2_2146) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %629 = cute.get_scalars(%itup_2150) : !cute.int_tuple<"?">
      %itup_2151 = cute.to_int_tuple(%e3_2147) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %630 = cute.get_scalars(%itup_2151) : !cute.int_tuple<"?{div=8}">
      %lay_2152 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %631 = cute.get_shape(%lay_2152) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2153, %e1_2154, %e2_2155, %e3_2156 = cute.get_leaves(%631) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2157 = cute.to_int_tuple(%e0_2153) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %632 = cute.get_scalars(%itup_2157) : !cute.int_tuple<"?">
      %itup_2158 = cute.to_int_tuple(%e1_2154) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %633 = cute.get_scalars(%itup_2158) : !cute.int_tuple<"?">
      %itup_2159 = cute.to_int_tuple(%e2_2155) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %634 = cute.get_scalars(%itup_2159) : !cute.int_tuple<"?">
      %itup_2160 = cute.to_int_tuple(%e3_2156) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %635 = cute.get_scalars(%itup_2160) : !cute.int_tuple<"?{div=8}">
      %shape_2161 = cute.make_shape(%itup_2148, %itup_2149, %itup_2150, %itup_2158) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)">
      %636 = cute.make_identity_tensor(%shape_2161) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %iter_2162 = cute.get_iter(%636) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %e0_2163, %e1_2164, %e2_2165, %e3_2166 = cute.get_leaves(%iter_2162) : !cute.int_tuple<"(0,0,0,0)">
      %coord_2167 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_2168 = cute.slice(%636, %coord_2167) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %iter_2169 = cute.get_iter(%slice_2168) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_2170, %e1_2171, %e2_2172, %e3_2173 = cute.get_leaves(%iter_2169) : !cute.int_tuple<"(?,0,?,0)">
      %637 = cute.get_scalars(%e0_2170) : !cute.int_tuple<"?">
      %638 = cute.get_scalars(%e2_2172) : !cute.int_tuple<"?">
      %tile_2174 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]">
      %coord_2175 = cute.make_coord(%117, %476) : (i32, i32) -> !cute.coord<"(?,?)">
      %tiled_view_2176 = cute.local_tile(%slice_2168, %tile_2174, %coord_2175) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">, !cute.tile<"[128:1;64:1]">, !cute.coord<"(?,?)">) -> !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %iter_2177 = cute.get_iter(%tiled_view_2176) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %e0_2178, %e1_2179, %e2_2180, %e3_2181 = cute.get_leaves(%iter_2177) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %639 = cute.get_scalars(%e0_2178) : !cute.int_tuple<"?">
      %640 = cute.get_scalars(%e1_2179) : !cute.int_tuple<"?{div=128}">
      %641 = cute.get_scalars(%e2_2180) : !cute.int_tuple<"?">
      %642 = cute.get_scalars(%e3_2181) : !cute.int_tuple<"?{div=64}">
      %coord_2182 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_C = cute.tiled.mma.partition C (%5, %tiled_view_2176, %coord_2182) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %iter_2183 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %e0_2184, %e1_2185, %e2_2186, %e3_2187 = cute.get_leaves(%iter_2183) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %643 = cute.get_scalars(%e0_2184) : !cute.int_tuple<"?">
      %644 = cute.get_scalars(%e1_2185) : !cute.int_tuple<"?">
      %645 = cute.get_scalars(%e2_2186) : !cute.int_tuple<"?">
      %646 = cute.get_scalars(%e3_2187) : !cute.int_tuple<"?{div=2}">
      %lay_2188 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %647 = cute.get_shape(%lay_2188) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2189, %e1_2190, %e2_2191, %e3_2192 = cute.get_leaves(%647) : !cute.shape<"((2,2),2,8)">
      %shape_2193 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_2194 = cute.make_layout(%shape_2193) : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %648 = cute.get_shape(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2195, %e1_2196, %e2_2197, %e3_2198 = cute.get_leaves(%648) : !cute.shape<"((2,2),2,8)">
      %649 = cute.get_shape(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2199, %e1_2200, %e2_2201, %e3_2202 = cute.get_leaves(%649) : !cute.shape<"((2,2),2,8)">
      %650 = cute.get_shape(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2203, %e1_2204, %e2_2205, %e3_2206 = cute.get_leaves(%650) : !cute.shape<"((2,2),2,8)">
      %651 = cute.get_shape(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2207, %e1_2208, %e2_2209, %e3_2210 = cute.get_leaves(%651) : !cute.shape<"((2,2),2,8)">
      %652 = cute.get_stride(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2211, %e1_2212, %e2_2213, %e3_2214 = cute.get_leaves(%652) : !cute.stride<"((1,2),4,8)">
      %653 = cute.get_stride(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2215, %e1_2216, %e2_2217, %e3_2218 = cute.get_leaves(%653) : !cute.stride<"((1,2),4,8)">
      %654 = cute.get_stride(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2219, %e1_2220, %e2_2221, %e3_2222 = cute.get_leaves(%654) : !cute.stride<"((1,2),4,8)">
      %655 = cute.get_stride(%lay_2194) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2223, %e1_2224, %e2_2225, %e3_2226 = cute.get_leaves(%655) : !cute.stride<"((1,2),4,8)">
      %shape_2227 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_2228 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2229 = cute.make_layout(%shape_2227, %stride_2228) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_2230 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %656 = cute.composition(%lay_2230, %lay_2229) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %int_tuple_2231 = cute.make_int_tuple(%e0_2184, %e1_2185, %e2_2186, %e3_2187) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_2232 = cute.make_view(%int_tuple_2231, %656) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %iter_2233 = cute.get_iter(%view_2232) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %e0_2234, %e1_2235, %e2_2236, %e3_2237 = cute.get_leaves(%iter_2233) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %657 = cute.get_scalars(%e0_2234) : !cute.int_tuple<"?">
      %658 = cute.get_scalars(%e1_2235) : !cute.int_tuple<"?">
      %659 = cute.get_scalars(%e2_2236) : !cute.int_tuple<"?">
      %660 = cute.get_scalars(%e3_2237) : !cute.int_tuple<"?{div=2}">
      %sz_2238 = cute.size(%rmem_906) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4">
      %e0_2239 = cute.get_leaves(%sz_2238) : !cute.int_tuple<"4">
      %lay_2240 = cute.get_layout(%view_2232) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %661 = cute.get_shape(%lay_2240) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2241, %e1_2242, %e2_2243, %e3_2244 = cute.get_leaves(%661) : !cute.shape<"((2,2),(2,8))">
      %int_tuple_2245 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_2246 = cute.size(%int_tuple_2245) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_2247 = cute.get_leaves(%sz_2246) : !cute.int_tuple<"16">
      %coord_2248 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %slice_2249 = cute.slice(%view_2232, %coord_2248) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)">
      %iter_2250 = cute.get_iter(%slice_2249) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2251, %e1_2252, %e2_2253, %e3_2254 = cute.get_leaves(%iter_2250) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %662 = cute.get_scalars(%e0_2251) : !cute.int_tuple<"?">
      %663 = cute.get_scalars(%e1_2252) : !cute.int_tuple<"?">
      %664 = cute.get_scalars(%e2_2253) : !cute.int_tuple<"?">
      %665 = cute.get_scalars(%e3_2254) : !cute.int_tuple<"?{div=2}">
      %iter_2255 = cute.get_iter(%slice_2249) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2256, %e1_2257, %e2_2258, %e3_2259 = cute.get_leaves(%iter_2255) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %666 = cute.get_scalars(%e0_2256) : !cute.int_tuple<"?">
      %667 = cute.get_scalars(%e1_2257) : !cute.int_tuple<"?">
      %668 = cute.get_scalars(%e2_2258) : !cute.int_tuple<"?">
      %669 = cute.get_scalars(%e3_2259) : !cute.int_tuple<"?{div=2}">
      %iter_2260 = cute.get_iter(%slice_2249) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2261, %e1_2262, %e2_2263, %e3_2264 = cute.get_leaves(%iter_2260) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %670 = cute.get_scalars(%e0_2261) : !cute.int_tuple<"?">
      %671 = cute.get_scalars(%e1_2262) : !cute.int_tuple<"?">
      %672 = cute.get_scalars(%e2_2263) : !cute.int_tuple<"?">
      %673 = cute.get_scalars(%e3_2264) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2265 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup = cute.add_offset(%e3_2264, %int_tuple_2265) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %674 = cute.get_scalars(%tup) : !cute.int_tuple<"?">
      %coord_2266 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2267 = cute.make_coord(%tup) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %675 = cute.elem_less(%coord_2266, %coord_2267) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2268 = cute.get_layout(%view_2096) : !memref_rmem_f32_3
      %676 = cute.get_shape(%lay_2268) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2269, %e1_2270, %e2_2271, %e3_2272 = cute.get_leaves(%676) : !cute.shape<"((2,2),(2,8))">
      %677 = cute.get_stride(%lay_2268) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2273, %e1_2274, %e2_2275, %e3_2276 = cute.get_leaves(%677) : !cute.stride<"((2,4),(1,8))">
      %678 = scf.if %675 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%view_2096) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,0)">
        cute.memref.store(%view_2096, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,0)">, f32) -> ()
        %lay_6242 = cute.get_layout(%view_2096) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2096 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%view_2096) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%view_2096) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2096 : !memref_rmem_f32_3
      }
      %iter_2277 = cute.get_iter(%678) : !memref_rmem_f32_3
      %lay_2278 = cute.get_layout(%678) : !memref_rmem_f32_3
      %679 = cute.get_shape(%lay_2278) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2279, %e1_2280, %e2_2281, %e3_2282 = cute.get_leaves(%679) : !cute.shape<"((2,2),(2,8))">
      %680 = cute.get_stride(%lay_2278) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2283, %e1_2284, %e2_2285, %e3_2286 = cute.get_leaves(%680) : !cute.stride<"((2,4),(1,8))">
      %iter_2287 = cute.get_iter(%678) : !memref_rmem_f32_3
      %iter_2288 = cute.get_iter(%678) : !memref_rmem_f32_3
      %coord_2289 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %slice_2290 = cute.slice(%view_2232, %coord_2289) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)">
      %iter_2291 = cute.get_iter(%slice_2290) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2292, %e1_2293, %e2_2294, %e3_2295 = cute.get_leaves(%iter_2291) : !cute.int_tuple<"(?,?,?,?)">
      %681 = cute.get_scalars(%e0_2292) : !cute.int_tuple<"?">
      %682 = cute.get_scalars(%e1_2293) : !cute.int_tuple<"?">
      %683 = cute.get_scalars(%e2_2294) : !cute.int_tuple<"?">
      %684 = cute.get_scalars(%e3_2295) : !cute.int_tuple<"?">
      %iter_2296 = cute.get_iter(%slice_2290) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2297, %e1_2298, %e2_2299, %e3_2300 = cute.get_leaves(%iter_2296) : !cute.int_tuple<"(?,?,?,?)">
      %685 = cute.get_scalars(%e0_2297) : !cute.int_tuple<"?">
      %686 = cute.get_scalars(%e1_2298) : !cute.int_tuple<"?">
      %687 = cute.get_scalars(%e2_2299) : !cute.int_tuple<"?">
      %688 = cute.get_scalars(%e3_2300) : !cute.int_tuple<"?">
      %iter_2301 = cute.get_iter(%slice_2290) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2302, %e1_2303, %e2_2304, %e3_2305 = cute.get_leaves(%iter_2301) : !cute.int_tuple<"(?,?,?,?)">
      %689 = cute.get_scalars(%e0_2302) : !cute.int_tuple<"?">
      %690 = cute.get_scalars(%e1_2303) : !cute.int_tuple<"?">
      %691 = cute.get_scalars(%e2_2304) : !cute.int_tuple<"?">
      %692 = cute.get_scalars(%e3_2305) : !cute.int_tuple<"?">
      %int_tuple_2306 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2307 = cute.add_offset(%e3_2305, %int_tuple_2306) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %693 = cute.get_scalars(%tup_2307) : !cute.int_tuple<"?">
      %coord_2308 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2309 = cute.make_coord(%tup_2307) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %694 = cute.elem_less(%coord_2308, %coord_2309) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2310 = cute.get_layout(%678) : !memref_rmem_f32_3
      %695 = cute.get_shape(%lay_2310) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2311, %e1_2312, %e2_2313, %e3_2314 = cute.get_leaves(%695) : !cute.shape<"((2,2),(2,8))">
      %696 = cute.get_stride(%lay_2310) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2315, %e1_2316, %e2_2317, %e3_2318 = cute.get_leaves(%696) : !cute.stride<"((2,4),(1,8))">
      %697 = scf.if %694 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%678) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,1)">
        cute.memref.store(%678, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,1)">, f32) -> ()
        %lay_6242 = cute.get_layout(%678) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %678 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%678) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%678) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %678 : !memref_rmem_f32_3
      }
      %iter_2319 = cute.get_iter(%697) : !memref_rmem_f32_3
      %lay_2320 = cute.get_layout(%697) : !memref_rmem_f32_3
      %698 = cute.get_shape(%lay_2320) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2321, %e1_2322, %e2_2323, %e3_2324 = cute.get_leaves(%698) : !cute.shape<"((2,2),(2,8))">
      %699 = cute.get_stride(%lay_2320) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2325, %e1_2326, %e2_2327, %e3_2328 = cute.get_leaves(%699) : !cute.stride<"((2,4),(1,8))">
      %iter_2329 = cute.get_iter(%697) : !memref_rmem_f32_3
      %iter_2330 = cute.get_iter(%697) : !memref_rmem_f32_3
      %coord_2331 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %slice_2332 = cute.slice(%view_2232, %coord_2331) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)">
      %iter_2333 = cute.get_iter(%slice_2332) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2334, %e1_2335, %e2_2336, %e3_2337 = cute.get_leaves(%iter_2333) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %700 = cute.get_scalars(%e0_2334) : !cute.int_tuple<"?">
      %701 = cute.get_scalars(%e1_2335) : !cute.int_tuple<"?">
      %702 = cute.get_scalars(%e2_2336) : !cute.int_tuple<"?">
      %703 = cute.get_scalars(%e3_2337) : !cute.int_tuple<"?{div=2}">
      %iter_2338 = cute.get_iter(%slice_2332) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2339, %e1_2340, %e2_2341, %e3_2342 = cute.get_leaves(%iter_2338) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %704 = cute.get_scalars(%e0_2339) : !cute.int_tuple<"?">
      %705 = cute.get_scalars(%e1_2340) : !cute.int_tuple<"?">
      %706 = cute.get_scalars(%e2_2341) : !cute.int_tuple<"?">
      %707 = cute.get_scalars(%e3_2342) : !cute.int_tuple<"?{div=2}">
      %iter_2343 = cute.get_iter(%slice_2332) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2344, %e1_2345, %e2_2346, %e3_2347 = cute.get_leaves(%iter_2343) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %708 = cute.get_scalars(%e0_2344) : !cute.int_tuple<"?">
      %709 = cute.get_scalars(%e1_2345) : !cute.int_tuple<"?">
      %710 = cute.get_scalars(%e2_2346) : !cute.int_tuple<"?">
      %711 = cute.get_scalars(%e3_2347) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2348 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2349 = cute.add_offset(%e3_2347, %int_tuple_2348) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %712 = cute.get_scalars(%tup_2349) : !cute.int_tuple<"?">
      %coord_2350 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2351 = cute.make_coord(%tup_2349) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %713 = cute.elem_less(%coord_2350, %coord_2351) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2352 = cute.get_layout(%697) : !memref_rmem_f32_3
      %714 = cute.get_shape(%lay_2352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2353, %e1_2354, %e2_2355, %e3_2356 = cute.get_leaves(%714) : !cute.shape<"((2,2),(2,8))">
      %715 = cute.get_stride(%lay_2352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2357, %e1_2358, %e2_2359, %e3_2360 = cute.get_leaves(%715) : !cute.stride<"((2,4),(1,8))">
      %716 = scf.if %713 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%697) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,2)">
        cute.memref.store(%697, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,2)">, f32) -> ()
        %lay_6242 = cute.get_layout(%697) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %697 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%697) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%697) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %697 : !memref_rmem_f32_3
      }
      %iter_2361 = cute.get_iter(%716) : !memref_rmem_f32_3
      %lay_2362 = cute.get_layout(%716) : !memref_rmem_f32_3
      %717 = cute.get_shape(%lay_2362) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2363, %e1_2364, %e2_2365, %e3_2366 = cute.get_leaves(%717) : !cute.shape<"((2,2),(2,8))">
      %718 = cute.get_stride(%lay_2362) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2367, %e1_2368, %e2_2369, %e3_2370 = cute.get_leaves(%718) : !cute.stride<"((2,4),(1,8))">
      %iter_2371 = cute.get_iter(%716) : !memref_rmem_f32_3
      %iter_2372 = cute.get_iter(%716) : !memref_rmem_f32_3
      %coord_2373 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %slice_2374 = cute.slice(%view_2232, %coord_2373) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)">
      %iter_2375 = cute.get_iter(%slice_2374) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2376, %e1_2377, %e2_2378, %e3_2379 = cute.get_leaves(%iter_2375) : !cute.int_tuple<"(?,?,?,?)">
      %719 = cute.get_scalars(%e0_2376) : !cute.int_tuple<"?">
      %720 = cute.get_scalars(%e1_2377) : !cute.int_tuple<"?">
      %721 = cute.get_scalars(%e2_2378) : !cute.int_tuple<"?">
      %722 = cute.get_scalars(%e3_2379) : !cute.int_tuple<"?">
      %iter_2380 = cute.get_iter(%slice_2374) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2381, %e1_2382, %e2_2383, %e3_2384 = cute.get_leaves(%iter_2380) : !cute.int_tuple<"(?,?,?,?)">
      %723 = cute.get_scalars(%e0_2381) : !cute.int_tuple<"?">
      %724 = cute.get_scalars(%e1_2382) : !cute.int_tuple<"?">
      %725 = cute.get_scalars(%e2_2383) : !cute.int_tuple<"?">
      %726 = cute.get_scalars(%e3_2384) : !cute.int_tuple<"?">
      %iter_2385 = cute.get_iter(%slice_2374) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2386, %e1_2387, %e2_2388, %e3_2389 = cute.get_leaves(%iter_2385) : !cute.int_tuple<"(?,?,?,?)">
      %727 = cute.get_scalars(%e0_2386) : !cute.int_tuple<"?">
      %728 = cute.get_scalars(%e1_2387) : !cute.int_tuple<"?">
      %729 = cute.get_scalars(%e2_2388) : !cute.int_tuple<"?">
      %730 = cute.get_scalars(%e3_2389) : !cute.int_tuple<"?">
      %int_tuple_2390 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2391 = cute.add_offset(%e3_2389, %int_tuple_2390) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %731 = cute.get_scalars(%tup_2391) : !cute.int_tuple<"?">
      %coord_2392 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2393 = cute.make_coord(%tup_2391) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %732 = cute.elem_less(%coord_2392, %coord_2393) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2394 = cute.get_layout(%716) : !memref_rmem_f32_3
      %733 = cute.get_shape(%lay_2394) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2395, %e1_2396, %e2_2397, %e3_2398 = cute.get_leaves(%733) : !cute.shape<"((2,2),(2,8))">
      %734 = cute.get_stride(%lay_2394) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2399, %e1_2400, %e2_2401, %e3_2402 = cute.get_leaves(%734) : !cute.stride<"((2,4),(1,8))">
      %735 = scf.if %732 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%716) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,3)">
        cute.memref.store(%716, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,3)">, f32) -> ()
        %lay_6242 = cute.get_layout(%716) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %716 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%716) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%716) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %716 : !memref_rmem_f32_3
      }
      %iter_2403 = cute.get_iter(%735) : !memref_rmem_f32_3
      %lay_2404 = cute.get_layout(%735) : !memref_rmem_f32_3
      %736 = cute.get_shape(%lay_2404) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2405, %e1_2406, %e2_2407, %e3_2408 = cute.get_leaves(%736) : !cute.shape<"((2,2),(2,8))">
      %737 = cute.get_stride(%lay_2404) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2409, %e1_2410, %e2_2411, %e3_2412 = cute.get_leaves(%737) : !cute.stride<"((2,4),(1,8))">
      %iter_2413 = cute.get_iter(%735) : !memref_rmem_f32_3
      %iter_2414 = cute.get_iter(%735) : !memref_rmem_f32_3
      %coord_2415 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %slice_2416 = cute.slice(%view_2232, %coord_2415) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)">
      %iter_2417 = cute.get_iter(%slice_2416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2418, %e1_2419, %e2_2420, %e3_2421 = cute.get_leaves(%iter_2417) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %738 = cute.get_scalars(%e0_2418) : !cute.int_tuple<"?">
      %739 = cute.get_scalars(%e1_2419) : !cute.int_tuple<"?">
      %740 = cute.get_scalars(%e2_2420) : !cute.int_tuple<"?">
      %741 = cute.get_scalars(%e3_2421) : !cute.int_tuple<"?{div=2}">
      %iter_2422 = cute.get_iter(%slice_2416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2423, %e1_2424, %e2_2425, %e3_2426 = cute.get_leaves(%iter_2422) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %742 = cute.get_scalars(%e0_2423) : !cute.int_tuple<"?">
      %743 = cute.get_scalars(%e1_2424) : !cute.int_tuple<"?">
      %744 = cute.get_scalars(%e2_2425) : !cute.int_tuple<"?">
      %745 = cute.get_scalars(%e3_2426) : !cute.int_tuple<"?{div=2}">
      %iter_2427 = cute.get_iter(%slice_2416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2428, %e1_2429, %e2_2430, %e3_2431 = cute.get_leaves(%iter_2427) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %746 = cute.get_scalars(%e0_2428) : !cute.int_tuple<"?">
      %747 = cute.get_scalars(%e1_2429) : !cute.int_tuple<"?">
      %748 = cute.get_scalars(%e2_2430) : !cute.int_tuple<"?">
      %749 = cute.get_scalars(%e3_2431) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2432 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2433 = cute.add_offset(%e3_2431, %int_tuple_2432) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %750 = cute.get_scalars(%tup_2433) : !cute.int_tuple<"?">
      %coord_2434 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2435 = cute.make_coord(%tup_2433) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %751 = cute.elem_less(%coord_2434, %coord_2435) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2436 = cute.get_layout(%735) : !memref_rmem_f32_3
      %752 = cute.get_shape(%lay_2436) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2437, %e1_2438, %e2_2439, %e3_2440 = cute.get_leaves(%752) : !cute.shape<"((2,2),(2,8))">
      %753 = cute.get_stride(%lay_2436) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2441, %e1_2442, %e2_2443, %e3_2444 = cute.get_leaves(%753) : !cute.stride<"((2,4),(1,8))">
      %754 = scf.if %751 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%735) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,4)">
        cute.memref.store(%735, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,4)">, f32) -> ()
        %lay_6242 = cute.get_layout(%735) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %735 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%735) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%735) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %735 : !memref_rmem_f32_3
      }
      %iter_2445 = cute.get_iter(%754) : !memref_rmem_f32_3
      %lay_2446 = cute.get_layout(%754) : !memref_rmem_f32_3
      %755 = cute.get_shape(%lay_2446) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2447, %e1_2448, %e2_2449, %e3_2450 = cute.get_leaves(%755) : !cute.shape<"((2,2),(2,8))">
      %756 = cute.get_stride(%lay_2446) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2451, %e1_2452, %e2_2453, %e3_2454 = cute.get_leaves(%756) : !cute.stride<"((2,4),(1,8))">
      %iter_2455 = cute.get_iter(%754) : !memref_rmem_f32_3
      %iter_2456 = cute.get_iter(%754) : !memref_rmem_f32_3
      %coord_2457 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %slice_2458 = cute.slice(%view_2232, %coord_2457) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)">
      %iter_2459 = cute.get_iter(%slice_2458) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2460, %e1_2461, %e2_2462, %e3_2463 = cute.get_leaves(%iter_2459) : !cute.int_tuple<"(?,?,?,?)">
      %757 = cute.get_scalars(%e0_2460) : !cute.int_tuple<"?">
      %758 = cute.get_scalars(%e1_2461) : !cute.int_tuple<"?">
      %759 = cute.get_scalars(%e2_2462) : !cute.int_tuple<"?">
      %760 = cute.get_scalars(%e3_2463) : !cute.int_tuple<"?">
      %iter_2464 = cute.get_iter(%slice_2458) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2465, %e1_2466, %e2_2467, %e3_2468 = cute.get_leaves(%iter_2464) : !cute.int_tuple<"(?,?,?,?)">
      %761 = cute.get_scalars(%e0_2465) : !cute.int_tuple<"?">
      %762 = cute.get_scalars(%e1_2466) : !cute.int_tuple<"?">
      %763 = cute.get_scalars(%e2_2467) : !cute.int_tuple<"?">
      %764 = cute.get_scalars(%e3_2468) : !cute.int_tuple<"?">
      %iter_2469 = cute.get_iter(%slice_2458) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2470, %e1_2471, %e2_2472, %e3_2473 = cute.get_leaves(%iter_2469) : !cute.int_tuple<"(?,?,?,?)">
      %765 = cute.get_scalars(%e0_2470) : !cute.int_tuple<"?">
      %766 = cute.get_scalars(%e1_2471) : !cute.int_tuple<"?">
      %767 = cute.get_scalars(%e2_2472) : !cute.int_tuple<"?">
      %768 = cute.get_scalars(%e3_2473) : !cute.int_tuple<"?">
      %int_tuple_2474 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2475 = cute.add_offset(%e3_2473, %int_tuple_2474) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %769 = cute.get_scalars(%tup_2475) : !cute.int_tuple<"?">
      %coord_2476 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2477 = cute.make_coord(%tup_2475) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %770 = cute.elem_less(%coord_2476, %coord_2477) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2478 = cute.get_layout(%754) : !memref_rmem_f32_3
      %771 = cute.get_shape(%lay_2478) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2479, %e1_2480, %e2_2481, %e3_2482 = cute.get_leaves(%771) : !cute.shape<"((2,2),(2,8))">
      %772 = cute.get_stride(%lay_2478) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2483, %e1_2484, %e2_2485, %e3_2486 = cute.get_leaves(%772) : !cute.stride<"((2,4),(1,8))">
      %773 = scf.if %770 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%754) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,5)">
        cute.memref.store(%754, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,5)">, f32) -> ()
        %lay_6242 = cute.get_layout(%754) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %754 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%754) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%754) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %754 : !memref_rmem_f32_3
      }
      %iter_2487 = cute.get_iter(%773) : !memref_rmem_f32_3
      %lay_2488 = cute.get_layout(%773) : !memref_rmem_f32_3
      %774 = cute.get_shape(%lay_2488) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2489, %e1_2490, %e2_2491, %e3_2492 = cute.get_leaves(%774) : !cute.shape<"((2,2),(2,8))">
      %775 = cute.get_stride(%lay_2488) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2493, %e1_2494, %e2_2495, %e3_2496 = cute.get_leaves(%775) : !cute.stride<"((2,4),(1,8))">
      %iter_2497 = cute.get_iter(%773) : !memref_rmem_f32_3
      %iter_2498 = cute.get_iter(%773) : !memref_rmem_f32_3
      %coord_2499 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %slice_2500 = cute.slice(%view_2232, %coord_2499) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)">
      %iter_2501 = cute.get_iter(%slice_2500) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2502, %e1_2503, %e2_2504, %e3_2505 = cute.get_leaves(%iter_2501) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %776 = cute.get_scalars(%e0_2502) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e1_2503) : !cute.int_tuple<"?">
      %778 = cute.get_scalars(%e2_2504) : !cute.int_tuple<"?">
      %779 = cute.get_scalars(%e3_2505) : !cute.int_tuple<"?{div=2}">
      %iter_2506 = cute.get_iter(%slice_2500) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2507, %e1_2508, %e2_2509, %e3_2510 = cute.get_leaves(%iter_2506) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %780 = cute.get_scalars(%e0_2507) : !cute.int_tuple<"?">
      %781 = cute.get_scalars(%e1_2508) : !cute.int_tuple<"?">
      %782 = cute.get_scalars(%e2_2509) : !cute.int_tuple<"?">
      %783 = cute.get_scalars(%e3_2510) : !cute.int_tuple<"?{div=2}">
      %iter_2511 = cute.get_iter(%slice_2500) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2512, %e1_2513, %e2_2514, %e3_2515 = cute.get_leaves(%iter_2511) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %784 = cute.get_scalars(%e0_2512) : !cute.int_tuple<"?">
      %785 = cute.get_scalars(%e1_2513) : !cute.int_tuple<"?">
      %786 = cute.get_scalars(%e2_2514) : !cute.int_tuple<"?">
      %787 = cute.get_scalars(%e3_2515) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2516 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2517 = cute.add_offset(%e3_2515, %int_tuple_2516) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %788 = cute.get_scalars(%tup_2517) : !cute.int_tuple<"?">
      %coord_2518 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2519 = cute.make_coord(%tup_2517) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %789 = cute.elem_less(%coord_2518, %coord_2519) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2520 = cute.get_layout(%773) : !memref_rmem_f32_3
      %790 = cute.get_shape(%lay_2520) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2521, %e1_2522, %e2_2523, %e3_2524 = cute.get_leaves(%790) : !cute.shape<"((2,2),(2,8))">
      %791 = cute.get_stride(%lay_2520) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2525, %e1_2526, %e2_2527, %e3_2528 = cute.get_leaves(%791) : !cute.stride<"((2,4),(1,8))">
      %792 = scf.if %789 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%773) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,6)">
        cute.memref.store(%773, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,6)">, f32) -> ()
        %lay_6242 = cute.get_layout(%773) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %773 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%773) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%773) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %773 : !memref_rmem_f32_3
      }
      %iter_2529 = cute.get_iter(%792) : !memref_rmem_f32_3
      %lay_2530 = cute.get_layout(%792) : !memref_rmem_f32_3
      %793 = cute.get_shape(%lay_2530) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2531, %e1_2532, %e2_2533, %e3_2534 = cute.get_leaves(%793) : !cute.shape<"((2,2),(2,8))">
      %794 = cute.get_stride(%lay_2530) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2535, %e1_2536, %e2_2537, %e3_2538 = cute.get_leaves(%794) : !cute.stride<"((2,4),(1,8))">
      %iter_2539 = cute.get_iter(%792) : !memref_rmem_f32_3
      %iter_2540 = cute.get_iter(%792) : !memref_rmem_f32_3
      %coord_2541 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %slice_2542 = cute.slice(%view_2232, %coord_2541) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)">
      %iter_2543 = cute.get_iter(%slice_2542) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2544, %e1_2545, %e2_2546, %e3_2547 = cute.get_leaves(%iter_2543) : !cute.int_tuple<"(?,?,?,?)">
      %795 = cute.get_scalars(%e0_2544) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e1_2545) : !cute.int_tuple<"?">
      %797 = cute.get_scalars(%e2_2546) : !cute.int_tuple<"?">
      %798 = cute.get_scalars(%e3_2547) : !cute.int_tuple<"?">
      %iter_2548 = cute.get_iter(%slice_2542) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2549, %e1_2550, %e2_2551, %e3_2552 = cute.get_leaves(%iter_2548) : !cute.int_tuple<"(?,?,?,?)">
      %799 = cute.get_scalars(%e0_2549) : !cute.int_tuple<"?">
      %800 = cute.get_scalars(%e1_2550) : !cute.int_tuple<"?">
      %801 = cute.get_scalars(%e2_2551) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e3_2552) : !cute.int_tuple<"?">
      %iter_2553 = cute.get_iter(%slice_2542) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2554, %e1_2555, %e2_2556, %e3_2557 = cute.get_leaves(%iter_2553) : !cute.int_tuple<"(?,?,?,?)">
      %803 = cute.get_scalars(%e0_2554) : !cute.int_tuple<"?">
      %804 = cute.get_scalars(%e1_2555) : !cute.int_tuple<"?">
      %805 = cute.get_scalars(%e2_2556) : !cute.int_tuple<"?">
      %806 = cute.get_scalars(%e3_2557) : !cute.int_tuple<"?">
      %int_tuple_2558 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2559 = cute.add_offset(%e3_2557, %int_tuple_2558) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %807 = cute.get_scalars(%tup_2559) : !cute.int_tuple<"?">
      %coord_2560 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2561 = cute.make_coord(%tup_2559) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %808 = cute.elem_less(%coord_2560, %coord_2561) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2562 = cute.get_layout(%792) : !memref_rmem_f32_3
      %809 = cute.get_shape(%lay_2562) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2563, %e1_2564, %e2_2565, %e3_2566 = cute.get_leaves(%809) : !cute.shape<"((2,2),(2,8))">
      %810 = cute.get_stride(%lay_2562) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2567, %e1_2568, %e2_2569, %e3_2570 = cute.get_leaves(%810) : !cute.stride<"((2,4),(1,8))">
      %811 = scf.if %808 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%792) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,7)">
        cute.memref.store(%792, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,7)">, f32) -> ()
        %lay_6242 = cute.get_layout(%792) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %792 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%792) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%792) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %792 : !memref_rmem_f32_3
      }
      %iter_2571 = cute.get_iter(%811) : !memref_rmem_f32_3
      %lay_2572 = cute.get_layout(%811) : !memref_rmem_f32_3
      %812 = cute.get_shape(%lay_2572) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2573, %e1_2574, %e2_2575, %e3_2576 = cute.get_leaves(%812) : !cute.shape<"((2,2),(2,8))">
      %813 = cute.get_stride(%lay_2572) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2577, %e1_2578, %e2_2579, %e3_2580 = cute.get_leaves(%813) : !cute.stride<"((2,4),(1,8))">
      %iter_2581 = cute.get_iter(%811) : !memref_rmem_f32_3
      %iter_2582 = cute.get_iter(%811) : !memref_rmem_f32_3
      %coord_2583 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %slice_2584 = cute.slice(%view_2232, %coord_2583) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)">
      %iter_2585 = cute.get_iter(%slice_2584) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2586, %e1_2587, %e2_2588, %e3_2589 = cute.get_leaves(%iter_2585) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %814 = cute.get_scalars(%e0_2586) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e1_2587) : !cute.int_tuple<"?">
      %816 = cute.get_scalars(%e2_2588) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e3_2589) : !cute.int_tuple<"?{div=2}">
      %iter_2590 = cute.get_iter(%slice_2584) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2591, %e1_2592, %e2_2593, %e3_2594 = cute.get_leaves(%iter_2590) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %818 = cute.get_scalars(%e0_2591) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e1_2592) : !cute.int_tuple<"?">
      %820 = cute.get_scalars(%e2_2593) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e3_2594) : !cute.int_tuple<"?{div=2}">
      %iter_2595 = cute.get_iter(%slice_2584) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2596, %e1_2597, %e2_2598, %e3_2599 = cute.get_leaves(%iter_2595) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %822 = cute.get_scalars(%e0_2596) : !cute.int_tuple<"?">
      %823 = cute.get_scalars(%e1_2597) : !cute.int_tuple<"?">
      %824 = cute.get_scalars(%e2_2598) : !cute.int_tuple<"?">
      %825 = cute.get_scalars(%e3_2599) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2600 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2601 = cute.add_offset(%e3_2599, %int_tuple_2600) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %826 = cute.get_scalars(%tup_2601) : !cute.int_tuple<"?">
      %coord_2602 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2603 = cute.make_coord(%tup_2601) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %827 = cute.elem_less(%coord_2602, %coord_2603) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2604 = cute.get_layout(%811) : !memref_rmem_f32_3
      %828 = cute.get_shape(%lay_2604) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2605, %e1_2606, %e2_2607, %e3_2608 = cute.get_leaves(%828) : !cute.shape<"((2,2),(2,8))">
      %829 = cute.get_stride(%lay_2604) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2609, %e1_2610, %e2_2611, %e3_2612 = cute.get_leaves(%829) : !cute.stride<"((2,4),(1,8))">
      %830 = scf.if %827 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%811) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,8)">
        cute.memref.store(%811, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,8)">, f32) -> ()
        %lay_6242 = cute.get_layout(%811) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %811 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%811) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%811) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %811 : !memref_rmem_f32_3
      }
      %iter_2613 = cute.get_iter(%830) : !memref_rmem_f32_3
      %lay_2614 = cute.get_layout(%830) : !memref_rmem_f32_3
      %831 = cute.get_shape(%lay_2614) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2615, %e1_2616, %e2_2617, %e3_2618 = cute.get_leaves(%831) : !cute.shape<"((2,2),(2,8))">
      %832 = cute.get_stride(%lay_2614) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2619, %e1_2620, %e2_2621, %e3_2622 = cute.get_leaves(%832) : !cute.stride<"((2,4),(1,8))">
      %iter_2623 = cute.get_iter(%830) : !memref_rmem_f32_3
      %iter_2624 = cute.get_iter(%830) : !memref_rmem_f32_3
      %coord_2625 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %slice_2626 = cute.slice(%view_2232, %coord_2625) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)">
      %iter_2627 = cute.get_iter(%slice_2626) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2628, %e1_2629, %e2_2630, %e3_2631 = cute.get_leaves(%iter_2627) : !cute.int_tuple<"(?,?,?,?)">
      %833 = cute.get_scalars(%e0_2628) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e1_2629) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e2_2630) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e3_2631) : !cute.int_tuple<"?">
      %iter_2632 = cute.get_iter(%slice_2626) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2633, %e1_2634, %e2_2635, %e3_2636 = cute.get_leaves(%iter_2632) : !cute.int_tuple<"(?,?,?,?)">
      %837 = cute.get_scalars(%e0_2633) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_2634) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_2635) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_2636) : !cute.int_tuple<"?">
      %iter_2637 = cute.get_iter(%slice_2626) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2638, %e1_2639, %e2_2640, %e3_2641 = cute.get_leaves(%iter_2637) : !cute.int_tuple<"(?,?,?,?)">
      %841 = cute.get_scalars(%e0_2638) : !cute.int_tuple<"?">
      %842 = cute.get_scalars(%e1_2639) : !cute.int_tuple<"?">
      %843 = cute.get_scalars(%e2_2640) : !cute.int_tuple<"?">
      %844 = cute.get_scalars(%e3_2641) : !cute.int_tuple<"?">
      %int_tuple_2642 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2643 = cute.add_offset(%e3_2641, %int_tuple_2642) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %845 = cute.get_scalars(%tup_2643) : !cute.int_tuple<"?">
      %coord_2644 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2645 = cute.make_coord(%tup_2643) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %846 = cute.elem_less(%coord_2644, %coord_2645) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2646 = cute.get_layout(%830) : !memref_rmem_f32_3
      %847 = cute.get_shape(%lay_2646) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2647, %e1_2648, %e2_2649, %e3_2650 = cute.get_leaves(%847) : !cute.shape<"((2,2),(2,8))">
      %848 = cute.get_stride(%lay_2646) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2651, %e1_2652, %e2_2653, %e3_2654 = cute.get_leaves(%848) : !cute.stride<"((2,4),(1,8))">
      %849 = scf.if %846 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%830) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,9)">
        cute.memref.store(%830, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,9)">, f32) -> ()
        %lay_6242 = cute.get_layout(%830) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %830 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%830) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%830) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %830 : !memref_rmem_f32_3
      }
      %iter_2655 = cute.get_iter(%849) : !memref_rmem_f32_3
      %lay_2656 = cute.get_layout(%849) : !memref_rmem_f32_3
      %850 = cute.get_shape(%lay_2656) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2657, %e1_2658, %e2_2659, %e3_2660 = cute.get_leaves(%850) : !cute.shape<"((2,2),(2,8))">
      %851 = cute.get_stride(%lay_2656) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2661, %e1_2662, %e2_2663, %e3_2664 = cute.get_leaves(%851) : !cute.stride<"((2,4),(1,8))">
      %iter_2665 = cute.get_iter(%849) : !memref_rmem_f32_3
      %iter_2666 = cute.get_iter(%849) : !memref_rmem_f32_3
      %coord_2667 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %slice_2668 = cute.slice(%view_2232, %coord_2667) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)">
      %iter_2669 = cute.get_iter(%slice_2668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2670, %e1_2671, %e2_2672, %e3_2673 = cute.get_leaves(%iter_2669) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %852 = cute.get_scalars(%e0_2670) : !cute.int_tuple<"?">
      %853 = cute.get_scalars(%e1_2671) : !cute.int_tuple<"?">
      %854 = cute.get_scalars(%e2_2672) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e3_2673) : !cute.int_tuple<"?{div=2}">
      %iter_2674 = cute.get_iter(%slice_2668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2675, %e1_2676, %e2_2677, %e3_2678 = cute.get_leaves(%iter_2674) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %856 = cute.get_scalars(%e0_2675) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e1_2676) : !cute.int_tuple<"?">
      %858 = cute.get_scalars(%e2_2677) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e3_2678) : !cute.int_tuple<"?{div=2}">
      %iter_2679 = cute.get_iter(%slice_2668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2680, %e1_2681, %e2_2682, %e3_2683 = cute.get_leaves(%iter_2679) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %860 = cute.get_scalars(%e0_2680) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e1_2681) : !cute.int_tuple<"?">
      %862 = cute.get_scalars(%e2_2682) : !cute.int_tuple<"?">
      %863 = cute.get_scalars(%e3_2683) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2684 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2685 = cute.add_offset(%e3_2683, %int_tuple_2684) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %864 = cute.get_scalars(%tup_2685) : !cute.int_tuple<"?">
      %coord_2686 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2687 = cute.make_coord(%tup_2685) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %865 = cute.elem_less(%coord_2686, %coord_2687) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2688 = cute.get_layout(%849) : !memref_rmem_f32_3
      %866 = cute.get_shape(%lay_2688) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2689, %e1_2690, %e2_2691, %e3_2692 = cute.get_leaves(%866) : !cute.shape<"((2,2),(2,8))">
      %867 = cute.get_stride(%lay_2688) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2693, %e1_2694, %e2_2695, %e3_2696 = cute.get_leaves(%867) : !cute.stride<"((2,4),(1,8))">
      %868 = scf.if %865 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%849) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,10)">
        cute.memref.store(%849, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,10)">, f32) -> ()
        %lay_6242 = cute.get_layout(%849) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %849 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%849) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%849) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %849 : !memref_rmem_f32_3
      }
      %iter_2697 = cute.get_iter(%868) : !memref_rmem_f32_3
      %lay_2698 = cute.get_layout(%868) : !memref_rmem_f32_3
      %869 = cute.get_shape(%lay_2698) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2699, %e1_2700, %e2_2701, %e3_2702 = cute.get_leaves(%869) : !cute.shape<"((2,2),(2,8))">
      %870 = cute.get_stride(%lay_2698) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2703, %e1_2704, %e2_2705, %e3_2706 = cute.get_leaves(%870) : !cute.stride<"((2,4),(1,8))">
      %iter_2707 = cute.get_iter(%868) : !memref_rmem_f32_3
      %iter_2708 = cute.get_iter(%868) : !memref_rmem_f32_3
      %coord_2709 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %slice_2710 = cute.slice(%view_2232, %coord_2709) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)">
      %iter_2711 = cute.get_iter(%slice_2710) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2712, %e1_2713, %e2_2714, %e3_2715 = cute.get_leaves(%iter_2711) : !cute.int_tuple<"(?,?,?,?)">
      %871 = cute.get_scalars(%e0_2712) : !cute.int_tuple<"?">
      %872 = cute.get_scalars(%e1_2713) : !cute.int_tuple<"?">
      %873 = cute.get_scalars(%e2_2714) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e3_2715) : !cute.int_tuple<"?">
      %iter_2716 = cute.get_iter(%slice_2710) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2717, %e1_2718, %e2_2719, %e3_2720 = cute.get_leaves(%iter_2716) : !cute.int_tuple<"(?,?,?,?)">
      %875 = cute.get_scalars(%e0_2717) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e1_2718) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e2_2719) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e3_2720) : !cute.int_tuple<"?">
      %iter_2721 = cute.get_iter(%slice_2710) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2722, %e1_2723, %e2_2724, %e3_2725 = cute.get_leaves(%iter_2721) : !cute.int_tuple<"(?,?,?,?)">
      %879 = cute.get_scalars(%e0_2722) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e1_2723) : !cute.int_tuple<"?">
      %881 = cute.get_scalars(%e2_2724) : !cute.int_tuple<"?">
      %882 = cute.get_scalars(%e3_2725) : !cute.int_tuple<"?">
      %int_tuple_2726 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2727 = cute.add_offset(%e3_2725, %int_tuple_2726) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %883 = cute.get_scalars(%tup_2727) : !cute.int_tuple<"?">
      %coord_2728 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2729 = cute.make_coord(%tup_2727) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %884 = cute.elem_less(%coord_2728, %coord_2729) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2730 = cute.get_layout(%868) : !memref_rmem_f32_3
      %885 = cute.get_shape(%lay_2730) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2731, %e1_2732, %e2_2733, %e3_2734 = cute.get_leaves(%885) : !cute.shape<"((2,2),(2,8))">
      %886 = cute.get_stride(%lay_2730) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2735, %e1_2736, %e2_2737, %e3_2738 = cute.get_leaves(%886) : !cute.stride<"((2,4),(1,8))">
      %887 = scf.if %884 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%868) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,11)">
        cute.memref.store(%868, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,11)">, f32) -> ()
        %lay_6242 = cute.get_layout(%868) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %868 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%868) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%868) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %868 : !memref_rmem_f32_3
      }
      %iter_2739 = cute.get_iter(%887) : !memref_rmem_f32_3
      %lay_2740 = cute.get_layout(%887) : !memref_rmem_f32_3
      %888 = cute.get_shape(%lay_2740) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2741, %e1_2742, %e2_2743, %e3_2744 = cute.get_leaves(%888) : !cute.shape<"((2,2),(2,8))">
      %889 = cute.get_stride(%lay_2740) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2745, %e1_2746, %e2_2747, %e3_2748 = cute.get_leaves(%889) : !cute.stride<"((2,4),(1,8))">
      %iter_2749 = cute.get_iter(%887) : !memref_rmem_f32_3
      %iter_2750 = cute.get_iter(%887) : !memref_rmem_f32_3
      %coord_2751 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %slice_2752 = cute.slice(%view_2232, %coord_2751) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)">
      %iter_2753 = cute.get_iter(%slice_2752) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2754, %e1_2755, %e2_2756, %e3_2757 = cute.get_leaves(%iter_2753) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %890 = cute.get_scalars(%e0_2754) : !cute.int_tuple<"?">
      %891 = cute.get_scalars(%e1_2755) : !cute.int_tuple<"?">
      %892 = cute.get_scalars(%e2_2756) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e3_2757) : !cute.int_tuple<"?{div=2}">
      %iter_2758 = cute.get_iter(%slice_2752) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2759, %e1_2760, %e2_2761, %e3_2762 = cute.get_leaves(%iter_2758) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %894 = cute.get_scalars(%e0_2759) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e1_2760) : !cute.int_tuple<"?">
      %896 = cute.get_scalars(%e2_2761) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e3_2762) : !cute.int_tuple<"?{div=2}">
      %iter_2763 = cute.get_iter(%slice_2752) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2764, %e1_2765, %e2_2766, %e3_2767 = cute.get_leaves(%iter_2763) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %898 = cute.get_scalars(%e0_2764) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e1_2765) : !cute.int_tuple<"?">
      %900 = cute.get_scalars(%e2_2766) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e3_2767) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2768 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2769 = cute.add_offset(%e3_2767, %int_tuple_2768) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %902 = cute.get_scalars(%tup_2769) : !cute.int_tuple<"?">
      %coord_2770 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2771 = cute.make_coord(%tup_2769) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %903 = cute.elem_less(%coord_2770, %coord_2771) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2772 = cute.get_layout(%887) : !memref_rmem_f32_3
      %904 = cute.get_shape(%lay_2772) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2773, %e1_2774, %e2_2775, %e3_2776 = cute.get_leaves(%904) : !cute.shape<"((2,2),(2,8))">
      %905 = cute.get_stride(%lay_2772) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2777, %e1_2778, %e2_2779, %e3_2780 = cute.get_leaves(%905) : !cute.stride<"((2,4),(1,8))">
      %906 = scf.if %903 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%887) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,12)">
        cute.memref.store(%887, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,12)">, f32) -> ()
        %lay_6242 = cute.get_layout(%887) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %887 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%887) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%887) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %887 : !memref_rmem_f32_3
      }
      %iter_2781 = cute.get_iter(%906) : !memref_rmem_f32_3
      %lay_2782 = cute.get_layout(%906) : !memref_rmem_f32_3
      %907 = cute.get_shape(%lay_2782) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2783, %e1_2784, %e2_2785, %e3_2786 = cute.get_leaves(%907) : !cute.shape<"((2,2),(2,8))">
      %908 = cute.get_stride(%lay_2782) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2787, %e1_2788, %e2_2789, %e3_2790 = cute.get_leaves(%908) : !cute.stride<"((2,4),(1,8))">
      %iter_2791 = cute.get_iter(%906) : !memref_rmem_f32_3
      %iter_2792 = cute.get_iter(%906) : !memref_rmem_f32_3
      %coord_2793 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %slice_2794 = cute.slice(%view_2232, %coord_2793) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)">
      %iter_2795 = cute.get_iter(%slice_2794) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2796, %e1_2797, %e2_2798, %e3_2799 = cute.get_leaves(%iter_2795) : !cute.int_tuple<"(?,?,?,?)">
      %909 = cute.get_scalars(%e0_2796) : !cute.int_tuple<"?">
      %910 = cute.get_scalars(%e1_2797) : !cute.int_tuple<"?">
      %911 = cute.get_scalars(%e2_2798) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e3_2799) : !cute.int_tuple<"?">
      %iter_2800 = cute.get_iter(%slice_2794) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2801, %e1_2802, %e2_2803, %e3_2804 = cute.get_leaves(%iter_2800) : !cute.int_tuple<"(?,?,?,?)">
      %913 = cute.get_scalars(%e0_2801) : !cute.int_tuple<"?">
      %914 = cute.get_scalars(%e1_2802) : !cute.int_tuple<"?">
      %915 = cute.get_scalars(%e2_2803) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e3_2804) : !cute.int_tuple<"?">
      %iter_2805 = cute.get_iter(%slice_2794) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2806, %e1_2807, %e2_2808, %e3_2809 = cute.get_leaves(%iter_2805) : !cute.int_tuple<"(?,?,?,?)">
      %917 = cute.get_scalars(%e0_2806) : !cute.int_tuple<"?">
      %918 = cute.get_scalars(%e1_2807) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e2_2808) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e3_2809) : !cute.int_tuple<"?">
      %int_tuple_2810 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2811 = cute.add_offset(%e3_2809, %int_tuple_2810) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %921 = cute.get_scalars(%tup_2811) : !cute.int_tuple<"?">
      %coord_2812 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2813 = cute.make_coord(%tup_2811) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %922 = cute.elem_less(%coord_2812, %coord_2813) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2814 = cute.get_layout(%906) : !memref_rmem_f32_3
      %923 = cute.get_shape(%lay_2814) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2815, %e1_2816, %e2_2817, %e3_2818 = cute.get_leaves(%923) : !cute.shape<"((2,2),(2,8))">
      %924 = cute.get_stride(%lay_2814) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2819, %e1_2820, %e2_2821, %e3_2822 = cute.get_leaves(%924) : !cute.stride<"((2,4),(1,8))">
      %925 = scf.if %922 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%906) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,13)">
        cute.memref.store(%906, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,13)">, f32) -> ()
        %lay_6242 = cute.get_layout(%906) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %906 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%906) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%906) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %906 : !memref_rmem_f32_3
      }
      %iter_2823 = cute.get_iter(%925) : !memref_rmem_f32_3
      %lay_2824 = cute.get_layout(%925) : !memref_rmem_f32_3
      %926 = cute.get_shape(%lay_2824) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2825, %e1_2826, %e2_2827, %e3_2828 = cute.get_leaves(%926) : !cute.shape<"((2,2),(2,8))">
      %927 = cute.get_stride(%lay_2824) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2829, %e1_2830, %e2_2831, %e3_2832 = cute.get_leaves(%927) : !cute.stride<"((2,4),(1,8))">
      %iter_2833 = cute.get_iter(%925) : !memref_rmem_f32_3
      %iter_2834 = cute.get_iter(%925) : !memref_rmem_f32_3
      %coord_2835 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %slice_2836 = cute.slice(%view_2232, %coord_2835) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)">
      %iter_2837 = cute.get_iter(%slice_2836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2838, %e1_2839, %e2_2840, %e3_2841 = cute.get_leaves(%iter_2837) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %928 = cute.get_scalars(%e0_2838) : !cute.int_tuple<"?">
      %929 = cute.get_scalars(%e1_2839) : !cute.int_tuple<"?">
      %930 = cute.get_scalars(%e2_2840) : !cute.int_tuple<"?">
      %931 = cute.get_scalars(%e3_2841) : !cute.int_tuple<"?{div=2}">
      %iter_2842 = cute.get_iter(%slice_2836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2843, %e1_2844, %e2_2845, %e3_2846 = cute.get_leaves(%iter_2842) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %932 = cute.get_scalars(%e0_2843) : !cute.int_tuple<"?">
      %933 = cute.get_scalars(%e1_2844) : !cute.int_tuple<"?">
      %934 = cute.get_scalars(%e2_2845) : !cute.int_tuple<"?">
      %935 = cute.get_scalars(%e3_2846) : !cute.int_tuple<"?{div=2}">
      %iter_2847 = cute.get_iter(%slice_2836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2848, %e1_2849, %e2_2850, %e3_2851 = cute.get_leaves(%iter_2847) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %936 = cute.get_scalars(%e0_2848) : !cute.int_tuple<"?">
      %937 = cute.get_scalars(%e1_2849) : !cute.int_tuple<"?">
      %938 = cute.get_scalars(%e2_2850) : !cute.int_tuple<"?">
      %939 = cute.get_scalars(%e3_2851) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2852 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2853 = cute.add_offset(%e3_2851, %int_tuple_2852) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %940 = cute.get_scalars(%tup_2853) : !cute.int_tuple<"?">
      %coord_2854 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2855 = cute.make_coord(%tup_2853) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %941 = cute.elem_less(%coord_2854, %coord_2855) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2856 = cute.get_layout(%925) : !memref_rmem_f32_3
      %942 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2857, %e1_2858, %e2_2859, %e3_2860 = cute.get_leaves(%942) : !cute.shape<"((2,2),(2,8))">
      %943 = cute.get_stride(%lay_2856) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2861, %e1_2862, %e2_2863, %e3_2864 = cute.get_leaves(%943) : !cute.stride<"((2,4),(1,8))">
      %944 = scf.if %941 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%925) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,14)">
        cute.memref.store(%925, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,14)">, f32) -> ()
        %lay_6242 = cute.get_layout(%925) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %925 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%925) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%925) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %925 : !memref_rmem_f32_3
      }
      %iter_2865 = cute.get_iter(%944) : !memref_rmem_f32_3
      %lay_2866 = cute.get_layout(%944) : !memref_rmem_f32_3
      %945 = cute.get_shape(%lay_2866) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2867, %e1_2868, %e2_2869, %e3_2870 = cute.get_leaves(%945) : !cute.shape<"((2,2),(2,8))">
      %946 = cute.get_stride(%lay_2866) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2871, %e1_2872, %e2_2873, %e3_2874 = cute.get_leaves(%946) : !cute.stride<"((2,4),(1,8))">
      %iter_2875 = cute.get_iter(%944) : !memref_rmem_f32_3
      %iter_2876 = cute.get_iter(%944) : !memref_rmem_f32_3
      %coord_2877 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %slice_2878 = cute.slice(%view_2232, %coord_2877) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)">
      %iter_2879 = cute.get_iter(%slice_2878) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2880, %e1_2881, %e2_2882, %e3_2883 = cute.get_leaves(%iter_2879) : !cute.int_tuple<"(?,?,?,?)">
      %947 = cute.get_scalars(%e0_2880) : !cute.int_tuple<"?">
      %948 = cute.get_scalars(%e1_2881) : !cute.int_tuple<"?">
      %949 = cute.get_scalars(%e2_2882) : !cute.int_tuple<"?">
      %950 = cute.get_scalars(%e3_2883) : !cute.int_tuple<"?">
      %iter_2884 = cute.get_iter(%slice_2878) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2885, %e1_2886, %e2_2887, %e3_2888 = cute.get_leaves(%iter_2884) : !cute.int_tuple<"(?,?,?,?)">
      %951 = cute.get_scalars(%e0_2885) : !cute.int_tuple<"?">
      %952 = cute.get_scalars(%e1_2886) : !cute.int_tuple<"?">
      %953 = cute.get_scalars(%e2_2887) : !cute.int_tuple<"?">
      %954 = cute.get_scalars(%e3_2888) : !cute.int_tuple<"?">
      %iter_2889 = cute.get_iter(%slice_2878) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2890, %e1_2891, %e2_2892, %e3_2893 = cute.get_leaves(%iter_2889) : !cute.int_tuple<"(?,?,?,?)">
      %955 = cute.get_scalars(%e0_2890) : !cute.int_tuple<"?">
      %956 = cute.get_scalars(%e1_2891) : !cute.int_tuple<"?">
      %957 = cute.get_scalars(%e2_2892) : !cute.int_tuple<"?">
      %958 = cute.get_scalars(%e3_2893) : !cute.int_tuple<"?">
      %int_tuple_2894 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2895 = cute.add_offset(%e3_2893, %int_tuple_2894) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %959 = cute.get_scalars(%tup_2895) : !cute.int_tuple<"?">
      %coord_2896 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2897 = cute.make_coord(%tup_2895) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %960 = cute.elem_less(%coord_2896, %coord_2897) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2898 = cute.get_layout(%944) : !memref_rmem_f32_3
      %961 = cute.get_shape(%lay_2898) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2899, %e1_2900, %e2_2901, %e3_2902 = cute.get_leaves(%961) : !cute.shape<"((2,2),(2,8))">
      %962 = cute.get_stride(%lay_2898) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2903, %e1_2904, %e2_2905, %e3_2906 = cute.get_leaves(%962) : !cute.stride<"((2,4),(1,8))">
      %963 = scf.if %960 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%944) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(0,15)">
        cute.memref.store(%944, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(0,15)">, f32) -> ()
        %lay_6242 = cute.get_layout(%944) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %944 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%944) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%944) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %944 : !memref_rmem_f32_3
      }
      %iter_2907 = cute.get_iter(%963) : !memref_rmem_f32_3
      %lay_2908 = cute.get_layout(%963) : !memref_rmem_f32_3
      %964 = cute.get_shape(%lay_2908) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2909, %e1_2910, %e2_2911, %e3_2912 = cute.get_leaves(%964) : !cute.shape<"((2,2),(2,8))">
      %965 = cute.get_stride(%lay_2908) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2913, %e1_2914, %e2_2915, %e3_2916 = cute.get_leaves(%965) : !cute.stride<"((2,4),(1,8))">
      %iter_2917 = cute.get_iter(%963) : !memref_rmem_f32_3
      %iter_2918 = cute.get_iter(%963) : !memref_rmem_f32_3
      %coord_2919 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %slice_2920 = cute.slice(%963, %coord_2919) : !memref_rmem_f32_3, !cute.coord<"(0,_)">
      %iter_2921 = cute.get_iter(%slice_2920) : !memref_rmem_f32_5
      %lay_2922 = cute.get_layout(%slice_2920) : !memref_rmem_f32_5
      %966 = cute.get_shape(%lay_2922) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_2923, %e1_2924 = cute.get_leaves(%966) : !cute.shape<"((2,8))">
      %967 = cute.memref.load_vec %slice_2920, row_major : !memref_rmem_f32_5
      %cst_2925 = arith.constant 0xFF800000 : f32
      %968 = vector.reduction <maximumf>, %967, %cst_2925 : vector<16xf32> into f32
      %c-1_i32 = arith.constant -1 : i32
      %c2_i32 = arith.constant 2 : i32
      %c31_i32 = arith.constant 31 : i32
      %969 = nvvm.shfl.sync  bfly %c-1_i32, %968, %c2_i32, %c31_i32 : f32 -> f32
      %970 = nvvm.fmax %968, %969
      %c-1_i32_2926 = arith.constant -1 : i32
      %c1_i32_2927 = arith.constant 1 : i32
      %c31_i32_2928 = arith.constant 31 : i32
      %971 = nvvm.shfl.sync  bfly %c-1_i32_2926, %970, %c1_i32_2927, %c31_i32_2928 : f32 -> f32
      %972 = nvvm.fmax %970, %971
      %973 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %974 = arith.mulf %967, %973 : vector<16xf32>
      %975 = arith.mulf %972, %arg4 : f32
      %976 = vector.broadcast %975 : f32 to vector<16xf32>
      %977 = arith.subf %974, %976 : vector<16xf32>
      %978 = math.exp2 %977 fastmath<fast> : vector<16xf32>
      %cst_2929 = arith.constant 0.000000e+00 : f32
      %979 = vector.reduction <add>, %978, %cst_2929 : vector<16xf32> into f32
      %coord_2930 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_906, %coord_2930, %972) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_2931 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_911, %coord_2931, %979) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_2932 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %slice_2933 = cute.slice(%963, %coord_2932) : !memref_rmem_f32_3, !cute.coord<"(0,_)">
      %iter_2934 = cute.get_iter(%slice_2933) : !memref_rmem_f32_5
      %lay_2935 = cute.get_layout(%slice_2933) : !memref_rmem_f32_5
      %980 = cute.get_shape(%lay_2935) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_2936, %e1_2937 = cute.get_leaves(%980) : !cute.shape<"((2,8))">
      %int_tuple_2938 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_2939 = cute.size(%int_tuple_2938) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_2940 = cute.get_leaves(%sz_2939) : !cute.int_tuple<"16">
      %int_tuple_2941 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_2942 = cute.size(%int_tuple_2941) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_2943 = cute.get_leaves(%sz_2942) : !cute.int_tuple<"16">
      cute.memref.store_vec %978, %slice_2933, row_major : !memref_rmem_f32_5
      %int_tuple_2944 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_2945 = cute.size(%int_tuple_2944) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_2946 = cute.get_leaves(%sz_2945) : !cute.int_tuple<"16">
      %coord_2947 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %slice_2948 = cute.slice(%view_2232, %coord_2947) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)">
      %iter_2949 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2950, %e1_2951, %e2_2952, %e3_2953 = cute.get_leaves(%iter_2949) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %981 = cute.get_scalars(%e0_2950) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e1_2951) : !cute.int_tuple<"?">
      %983 = cute.get_scalars(%e2_2952) : !cute.int_tuple<"?">
      %984 = cute.get_scalars(%e3_2953) : !cute.int_tuple<"?{div=2}">
      %iter_2954 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2955, %e1_2956, %e2_2957, %e3_2958 = cute.get_leaves(%iter_2954) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %985 = cute.get_scalars(%e0_2955) : !cute.int_tuple<"?">
      %986 = cute.get_scalars(%e1_2956) : !cute.int_tuple<"?">
      %987 = cute.get_scalars(%e2_2957) : !cute.int_tuple<"?">
      %988 = cute.get_scalars(%e3_2958) : !cute.int_tuple<"?{div=2}">
      %iter_2959 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_2960, %e1_2961, %e2_2962, %e3_2963 = cute.get_leaves(%iter_2959) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %989 = cute.get_scalars(%e0_2960) : !cute.int_tuple<"?">
      %990 = cute.get_scalars(%e1_2961) : !cute.int_tuple<"?">
      %991 = cute.get_scalars(%e2_2962) : !cute.int_tuple<"?">
      %992 = cute.get_scalars(%e3_2963) : !cute.int_tuple<"?{div=2}">
      %int_tuple_2964 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_2965 = cute.add_offset(%e3_2963, %int_tuple_2964) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %993 = cute.get_scalars(%tup_2965) : !cute.int_tuple<"?">
      %coord_2966 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_2967 = cute.make_coord(%tup_2965) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %994 = cute.elem_less(%coord_2966, %coord_2967) : !cute.coord<"?">, !cute.coord<"?">
      %lay_2968 = cute.get_layout(%963) : !memref_rmem_f32_3
      %995 = cute.get_shape(%lay_2968) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2969, %e1_2970, %e2_2971, %e3_2972 = cute.get_leaves(%995) : !cute.shape<"((2,2),(2,8))">
      %996 = cute.get_stride(%lay_2968) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2973, %e1_2974, %e2_2975, %e3_2976 = cute.get_leaves(%996) : !cute.stride<"((2,4),(1,8))">
      %997 = scf.if %994 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%963) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,0)">
        cute.memref.store(%963, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,0)">, f32) -> ()
        %lay_6242 = cute.get_layout(%963) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %963 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%963) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%963) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %963 : !memref_rmem_f32_3
      }
      %iter_2977 = cute.get_iter(%997) : !memref_rmem_f32_3
      %lay_2978 = cute.get_layout(%997) : !memref_rmem_f32_3
      %998 = cute.get_shape(%lay_2978) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_2979, %e1_2980, %e2_2981, %e3_2982 = cute.get_leaves(%998) : !cute.shape<"((2,2),(2,8))">
      %999 = cute.get_stride(%lay_2978) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_2983, %e1_2984, %e2_2985, %e3_2986 = cute.get_leaves(%999) : !cute.stride<"((2,4),(1,8))">
      %iter_2987 = cute.get_iter(%997) : !memref_rmem_f32_3
      %iter_2988 = cute.get_iter(%997) : !memref_rmem_f32_3
      %coord_2989 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %slice_2990 = cute.slice(%view_2232, %coord_2989) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)">
      %iter_2991 = cute.get_iter(%slice_2990) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2992, %e1_2993, %e2_2994, %e3_2995 = cute.get_leaves(%iter_2991) : !cute.int_tuple<"(?,?,?,?)">
      %1000 = cute.get_scalars(%e0_2992) : !cute.int_tuple<"?">
      %1001 = cute.get_scalars(%e1_2993) : !cute.int_tuple<"?">
      %1002 = cute.get_scalars(%e2_2994) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e3_2995) : !cute.int_tuple<"?">
      %iter_2996 = cute.get_iter(%slice_2990) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_2997, %e1_2998, %e2_2999, %e3_3000 = cute.get_leaves(%iter_2996) : !cute.int_tuple<"(?,?,?,?)">
      %1004 = cute.get_scalars(%e0_2997) : !cute.int_tuple<"?">
      %1005 = cute.get_scalars(%e1_2998) : !cute.int_tuple<"?">
      %1006 = cute.get_scalars(%e2_2999) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e3_3000) : !cute.int_tuple<"?">
      %iter_3001 = cute.get_iter(%slice_2990) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3002, %e1_3003, %e2_3004, %e3_3005 = cute.get_leaves(%iter_3001) : !cute.int_tuple<"(?,?,?,?)">
      %1008 = cute.get_scalars(%e0_3002) : !cute.int_tuple<"?">
      %1009 = cute.get_scalars(%e1_3003) : !cute.int_tuple<"?">
      %1010 = cute.get_scalars(%e2_3004) : !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%e3_3005) : !cute.int_tuple<"?">
      %int_tuple_3006 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3007 = cute.add_offset(%e3_3005, %int_tuple_3006) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1012 = cute.get_scalars(%tup_3007) : !cute.int_tuple<"?">
      %coord_3008 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3009 = cute.make_coord(%tup_3007) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1013 = cute.elem_less(%coord_3008, %coord_3009) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3010 = cute.get_layout(%997) : !memref_rmem_f32_3
      %1014 = cute.get_shape(%lay_3010) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3011, %e1_3012, %e2_3013, %e3_3014 = cute.get_leaves(%1014) : !cute.shape<"((2,2),(2,8))">
      %1015 = cute.get_stride(%lay_3010) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3015, %e1_3016, %e2_3017, %e3_3018 = cute.get_leaves(%1015) : !cute.stride<"((2,4),(1,8))">
      %1016 = scf.if %1013 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%997) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,1)">
        cute.memref.store(%997, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,1)">, f32) -> ()
        %lay_6242 = cute.get_layout(%997) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %997 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%997) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%997) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %997 : !memref_rmem_f32_3
      }
      %iter_3019 = cute.get_iter(%1016) : !memref_rmem_f32_3
      %lay_3020 = cute.get_layout(%1016) : !memref_rmem_f32_3
      %1017 = cute.get_shape(%lay_3020) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3021, %e1_3022, %e2_3023, %e3_3024 = cute.get_leaves(%1017) : !cute.shape<"((2,2),(2,8))">
      %1018 = cute.get_stride(%lay_3020) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3025, %e1_3026, %e2_3027, %e3_3028 = cute.get_leaves(%1018) : !cute.stride<"((2,4),(1,8))">
      %iter_3029 = cute.get_iter(%1016) : !memref_rmem_f32_3
      %iter_3030 = cute.get_iter(%1016) : !memref_rmem_f32_3
      %coord_3031 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %slice_3032 = cute.slice(%view_2232, %coord_3031) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)">
      %iter_3033 = cute.get_iter(%slice_3032) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3034, %e1_3035, %e2_3036, %e3_3037 = cute.get_leaves(%iter_3033) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1019 = cute.get_scalars(%e0_3034) : !cute.int_tuple<"?">
      %1020 = cute.get_scalars(%e1_3035) : !cute.int_tuple<"?">
      %1021 = cute.get_scalars(%e2_3036) : !cute.int_tuple<"?">
      %1022 = cute.get_scalars(%e3_3037) : !cute.int_tuple<"?{div=2}">
      %iter_3038 = cute.get_iter(%slice_3032) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3039, %e1_3040, %e2_3041, %e3_3042 = cute.get_leaves(%iter_3038) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1023 = cute.get_scalars(%e0_3039) : !cute.int_tuple<"?">
      %1024 = cute.get_scalars(%e1_3040) : !cute.int_tuple<"?">
      %1025 = cute.get_scalars(%e2_3041) : !cute.int_tuple<"?">
      %1026 = cute.get_scalars(%e3_3042) : !cute.int_tuple<"?{div=2}">
      %iter_3043 = cute.get_iter(%slice_3032) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3044, %e1_3045, %e2_3046, %e3_3047 = cute.get_leaves(%iter_3043) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1027 = cute.get_scalars(%e0_3044) : !cute.int_tuple<"?">
      %1028 = cute.get_scalars(%e1_3045) : !cute.int_tuple<"?">
      %1029 = cute.get_scalars(%e2_3046) : !cute.int_tuple<"?">
      %1030 = cute.get_scalars(%e3_3047) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3048 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3049 = cute.add_offset(%e3_3047, %int_tuple_3048) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1031 = cute.get_scalars(%tup_3049) : !cute.int_tuple<"?">
      %coord_3050 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3051 = cute.make_coord(%tup_3049) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1032 = cute.elem_less(%coord_3050, %coord_3051) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3052 = cute.get_layout(%1016) : !memref_rmem_f32_3
      %1033 = cute.get_shape(%lay_3052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3053, %e1_3054, %e2_3055, %e3_3056 = cute.get_leaves(%1033) : !cute.shape<"((2,2),(2,8))">
      %1034 = cute.get_stride(%lay_3052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3057, %e1_3058, %e2_3059, %e3_3060 = cute.get_leaves(%1034) : !cute.stride<"((2,4),(1,8))">
      %1035 = scf.if %1032 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1016) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,2)">
        cute.memref.store(%1016, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,2)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1016) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1016 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1016) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1016) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1016 : !memref_rmem_f32_3
      }
      %iter_3061 = cute.get_iter(%1035) : !memref_rmem_f32_3
      %lay_3062 = cute.get_layout(%1035) : !memref_rmem_f32_3
      %1036 = cute.get_shape(%lay_3062) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3063, %e1_3064, %e2_3065, %e3_3066 = cute.get_leaves(%1036) : !cute.shape<"((2,2),(2,8))">
      %1037 = cute.get_stride(%lay_3062) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3067, %e1_3068, %e2_3069, %e3_3070 = cute.get_leaves(%1037) : !cute.stride<"((2,4),(1,8))">
      %iter_3071 = cute.get_iter(%1035) : !memref_rmem_f32_3
      %iter_3072 = cute.get_iter(%1035) : !memref_rmem_f32_3
      %coord_3073 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %slice_3074 = cute.slice(%view_2232, %coord_3073) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)">
      %iter_3075 = cute.get_iter(%slice_3074) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3076, %e1_3077, %e2_3078, %e3_3079 = cute.get_leaves(%iter_3075) : !cute.int_tuple<"(?,?,?,?)">
      %1038 = cute.get_scalars(%e0_3076) : !cute.int_tuple<"?">
      %1039 = cute.get_scalars(%e1_3077) : !cute.int_tuple<"?">
      %1040 = cute.get_scalars(%e2_3078) : !cute.int_tuple<"?">
      %1041 = cute.get_scalars(%e3_3079) : !cute.int_tuple<"?">
      %iter_3080 = cute.get_iter(%slice_3074) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3081, %e1_3082, %e2_3083, %e3_3084 = cute.get_leaves(%iter_3080) : !cute.int_tuple<"(?,?,?,?)">
      %1042 = cute.get_scalars(%e0_3081) : !cute.int_tuple<"?">
      %1043 = cute.get_scalars(%e1_3082) : !cute.int_tuple<"?">
      %1044 = cute.get_scalars(%e2_3083) : !cute.int_tuple<"?">
      %1045 = cute.get_scalars(%e3_3084) : !cute.int_tuple<"?">
      %iter_3085 = cute.get_iter(%slice_3074) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3086, %e1_3087, %e2_3088, %e3_3089 = cute.get_leaves(%iter_3085) : !cute.int_tuple<"(?,?,?,?)">
      %1046 = cute.get_scalars(%e0_3086) : !cute.int_tuple<"?">
      %1047 = cute.get_scalars(%e1_3087) : !cute.int_tuple<"?">
      %1048 = cute.get_scalars(%e2_3088) : !cute.int_tuple<"?">
      %1049 = cute.get_scalars(%e3_3089) : !cute.int_tuple<"?">
      %int_tuple_3090 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3091 = cute.add_offset(%e3_3089, %int_tuple_3090) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1050 = cute.get_scalars(%tup_3091) : !cute.int_tuple<"?">
      %coord_3092 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3093 = cute.make_coord(%tup_3091) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1051 = cute.elem_less(%coord_3092, %coord_3093) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3094 = cute.get_layout(%1035) : !memref_rmem_f32_3
      %1052 = cute.get_shape(%lay_3094) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3095, %e1_3096, %e2_3097, %e3_3098 = cute.get_leaves(%1052) : !cute.shape<"((2,2),(2,8))">
      %1053 = cute.get_stride(%lay_3094) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3099, %e1_3100, %e2_3101, %e3_3102 = cute.get_leaves(%1053) : !cute.stride<"((2,4),(1,8))">
      %1054 = scf.if %1051 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1035) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,3)">
        cute.memref.store(%1035, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,3)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1035) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1035 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1035) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1035) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1035 : !memref_rmem_f32_3
      }
      %iter_3103 = cute.get_iter(%1054) : !memref_rmem_f32_3
      %lay_3104 = cute.get_layout(%1054) : !memref_rmem_f32_3
      %1055 = cute.get_shape(%lay_3104) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3105, %e1_3106, %e2_3107, %e3_3108 = cute.get_leaves(%1055) : !cute.shape<"((2,2),(2,8))">
      %1056 = cute.get_stride(%lay_3104) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3109, %e1_3110, %e2_3111, %e3_3112 = cute.get_leaves(%1056) : !cute.stride<"((2,4),(1,8))">
      %iter_3113 = cute.get_iter(%1054) : !memref_rmem_f32_3
      %iter_3114 = cute.get_iter(%1054) : !memref_rmem_f32_3
      %coord_3115 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %slice_3116 = cute.slice(%view_2232, %coord_3115) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)">
      %iter_3117 = cute.get_iter(%slice_3116) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3118, %e1_3119, %e2_3120, %e3_3121 = cute.get_leaves(%iter_3117) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1057 = cute.get_scalars(%e0_3118) : !cute.int_tuple<"?">
      %1058 = cute.get_scalars(%e1_3119) : !cute.int_tuple<"?">
      %1059 = cute.get_scalars(%e2_3120) : !cute.int_tuple<"?">
      %1060 = cute.get_scalars(%e3_3121) : !cute.int_tuple<"?{div=2}">
      %iter_3122 = cute.get_iter(%slice_3116) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3123, %e1_3124, %e2_3125, %e3_3126 = cute.get_leaves(%iter_3122) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1061 = cute.get_scalars(%e0_3123) : !cute.int_tuple<"?">
      %1062 = cute.get_scalars(%e1_3124) : !cute.int_tuple<"?">
      %1063 = cute.get_scalars(%e2_3125) : !cute.int_tuple<"?">
      %1064 = cute.get_scalars(%e3_3126) : !cute.int_tuple<"?{div=2}">
      %iter_3127 = cute.get_iter(%slice_3116) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3128, %e1_3129, %e2_3130, %e3_3131 = cute.get_leaves(%iter_3127) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1065 = cute.get_scalars(%e0_3128) : !cute.int_tuple<"?">
      %1066 = cute.get_scalars(%e1_3129) : !cute.int_tuple<"?">
      %1067 = cute.get_scalars(%e2_3130) : !cute.int_tuple<"?">
      %1068 = cute.get_scalars(%e3_3131) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3132 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3133 = cute.add_offset(%e3_3131, %int_tuple_3132) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1069 = cute.get_scalars(%tup_3133) : !cute.int_tuple<"?">
      %coord_3134 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3135 = cute.make_coord(%tup_3133) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1070 = cute.elem_less(%coord_3134, %coord_3135) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3136 = cute.get_layout(%1054) : !memref_rmem_f32_3
      %1071 = cute.get_shape(%lay_3136) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3137, %e1_3138, %e2_3139, %e3_3140 = cute.get_leaves(%1071) : !cute.shape<"((2,2),(2,8))">
      %1072 = cute.get_stride(%lay_3136) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3141, %e1_3142, %e2_3143, %e3_3144 = cute.get_leaves(%1072) : !cute.stride<"((2,4),(1,8))">
      %1073 = scf.if %1070 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1054) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,4)">
        cute.memref.store(%1054, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,4)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1054) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1054 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1054) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1054) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1054 : !memref_rmem_f32_3
      }
      %iter_3145 = cute.get_iter(%1073) : !memref_rmem_f32_3
      %lay_3146 = cute.get_layout(%1073) : !memref_rmem_f32_3
      %1074 = cute.get_shape(%lay_3146) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3147, %e1_3148, %e2_3149, %e3_3150 = cute.get_leaves(%1074) : !cute.shape<"((2,2),(2,8))">
      %1075 = cute.get_stride(%lay_3146) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3151, %e1_3152, %e2_3153, %e3_3154 = cute.get_leaves(%1075) : !cute.stride<"((2,4),(1,8))">
      %iter_3155 = cute.get_iter(%1073) : !memref_rmem_f32_3
      %iter_3156 = cute.get_iter(%1073) : !memref_rmem_f32_3
      %coord_3157 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %slice_3158 = cute.slice(%view_2232, %coord_3157) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)">
      %iter_3159 = cute.get_iter(%slice_3158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3160, %e1_3161, %e2_3162, %e3_3163 = cute.get_leaves(%iter_3159) : !cute.int_tuple<"(?,?,?,?)">
      %1076 = cute.get_scalars(%e0_3160) : !cute.int_tuple<"?">
      %1077 = cute.get_scalars(%e1_3161) : !cute.int_tuple<"?">
      %1078 = cute.get_scalars(%e2_3162) : !cute.int_tuple<"?">
      %1079 = cute.get_scalars(%e3_3163) : !cute.int_tuple<"?">
      %iter_3164 = cute.get_iter(%slice_3158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3165, %e1_3166, %e2_3167, %e3_3168 = cute.get_leaves(%iter_3164) : !cute.int_tuple<"(?,?,?,?)">
      %1080 = cute.get_scalars(%e0_3165) : !cute.int_tuple<"?">
      %1081 = cute.get_scalars(%e1_3166) : !cute.int_tuple<"?">
      %1082 = cute.get_scalars(%e2_3167) : !cute.int_tuple<"?">
      %1083 = cute.get_scalars(%e3_3168) : !cute.int_tuple<"?">
      %iter_3169 = cute.get_iter(%slice_3158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3170, %e1_3171, %e2_3172, %e3_3173 = cute.get_leaves(%iter_3169) : !cute.int_tuple<"(?,?,?,?)">
      %1084 = cute.get_scalars(%e0_3170) : !cute.int_tuple<"?">
      %1085 = cute.get_scalars(%e1_3171) : !cute.int_tuple<"?">
      %1086 = cute.get_scalars(%e2_3172) : !cute.int_tuple<"?">
      %1087 = cute.get_scalars(%e3_3173) : !cute.int_tuple<"?">
      %int_tuple_3174 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3175 = cute.add_offset(%e3_3173, %int_tuple_3174) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1088 = cute.get_scalars(%tup_3175) : !cute.int_tuple<"?">
      %coord_3176 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3177 = cute.make_coord(%tup_3175) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1089 = cute.elem_less(%coord_3176, %coord_3177) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3178 = cute.get_layout(%1073) : !memref_rmem_f32_3
      %1090 = cute.get_shape(%lay_3178) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3179, %e1_3180, %e2_3181, %e3_3182 = cute.get_leaves(%1090) : !cute.shape<"((2,2),(2,8))">
      %1091 = cute.get_stride(%lay_3178) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3183, %e1_3184, %e2_3185, %e3_3186 = cute.get_leaves(%1091) : !cute.stride<"((2,4),(1,8))">
      %1092 = scf.if %1089 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1073) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,5)">
        cute.memref.store(%1073, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,5)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1073) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1073 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1073) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1073) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1073 : !memref_rmem_f32_3
      }
      %iter_3187 = cute.get_iter(%1092) : !memref_rmem_f32_3
      %lay_3188 = cute.get_layout(%1092) : !memref_rmem_f32_3
      %1093 = cute.get_shape(%lay_3188) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3189, %e1_3190, %e2_3191, %e3_3192 = cute.get_leaves(%1093) : !cute.shape<"((2,2),(2,8))">
      %1094 = cute.get_stride(%lay_3188) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3193, %e1_3194, %e2_3195, %e3_3196 = cute.get_leaves(%1094) : !cute.stride<"((2,4),(1,8))">
      %iter_3197 = cute.get_iter(%1092) : !memref_rmem_f32_3
      %iter_3198 = cute.get_iter(%1092) : !memref_rmem_f32_3
      %coord_3199 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %slice_3200 = cute.slice(%view_2232, %coord_3199) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)">
      %iter_3201 = cute.get_iter(%slice_3200) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3202, %e1_3203, %e2_3204, %e3_3205 = cute.get_leaves(%iter_3201) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1095 = cute.get_scalars(%e0_3202) : !cute.int_tuple<"?">
      %1096 = cute.get_scalars(%e1_3203) : !cute.int_tuple<"?">
      %1097 = cute.get_scalars(%e2_3204) : !cute.int_tuple<"?">
      %1098 = cute.get_scalars(%e3_3205) : !cute.int_tuple<"?{div=2}">
      %iter_3206 = cute.get_iter(%slice_3200) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3207, %e1_3208, %e2_3209, %e3_3210 = cute.get_leaves(%iter_3206) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1099 = cute.get_scalars(%e0_3207) : !cute.int_tuple<"?">
      %1100 = cute.get_scalars(%e1_3208) : !cute.int_tuple<"?">
      %1101 = cute.get_scalars(%e2_3209) : !cute.int_tuple<"?">
      %1102 = cute.get_scalars(%e3_3210) : !cute.int_tuple<"?{div=2}">
      %iter_3211 = cute.get_iter(%slice_3200) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3212, %e1_3213, %e2_3214, %e3_3215 = cute.get_leaves(%iter_3211) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1103 = cute.get_scalars(%e0_3212) : !cute.int_tuple<"?">
      %1104 = cute.get_scalars(%e1_3213) : !cute.int_tuple<"?">
      %1105 = cute.get_scalars(%e2_3214) : !cute.int_tuple<"?">
      %1106 = cute.get_scalars(%e3_3215) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3216 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3217 = cute.add_offset(%e3_3215, %int_tuple_3216) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1107 = cute.get_scalars(%tup_3217) : !cute.int_tuple<"?">
      %coord_3218 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3219 = cute.make_coord(%tup_3217) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1108 = cute.elem_less(%coord_3218, %coord_3219) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3220 = cute.get_layout(%1092) : !memref_rmem_f32_3
      %1109 = cute.get_shape(%lay_3220) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3221, %e1_3222, %e2_3223, %e3_3224 = cute.get_leaves(%1109) : !cute.shape<"((2,2),(2,8))">
      %1110 = cute.get_stride(%lay_3220) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3225, %e1_3226, %e2_3227, %e3_3228 = cute.get_leaves(%1110) : !cute.stride<"((2,4),(1,8))">
      %1111 = scf.if %1108 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1092) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,6)">
        cute.memref.store(%1092, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,6)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1092) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1092 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1092) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1092) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1092 : !memref_rmem_f32_3
      }
      %iter_3229 = cute.get_iter(%1111) : !memref_rmem_f32_3
      %lay_3230 = cute.get_layout(%1111) : !memref_rmem_f32_3
      %1112 = cute.get_shape(%lay_3230) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3231, %e1_3232, %e2_3233, %e3_3234 = cute.get_leaves(%1112) : !cute.shape<"((2,2),(2,8))">
      %1113 = cute.get_stride(%lay_3230) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3235, %e1_3236, %e2_3237, %e3_3238 = cute.get_leaves(%1113) : !cute.stride<"((2,4),(1,8))">
      %iter_3239 = cute.get_iter(%1111) : !memref_rmem_f32_3
      %iter_3240 = cute.get_iter(%1111) : !memref_rmem_f32_3
      %coord_3241 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %slice_3242 = cute.slice(%view_2232, %coord_3241) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)">
      %iter_3243 = cute.get_iter(%slice_3242) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3244, %e1_3245, %e2_3246, %e3_3247 = cute.get_leaves(%iter_3243) : !cute.int_tuple<"(?,?,?,?)">
      %1114 = cute.get_scalars(%e0_3244) : !cute.int_tuple<"?">
      %1115 = cute.get_scalars(%e1_3245) : !cute.int_tuple<"?">
      %1116 = cute.get_scalars(%e2_3246) : !cute.int_tuple<"?">
      %1117 = cute.get_scalars(%e3_3247) : !cute.int_tuple<"?">
      %iter_3248 = cute.get_iter(%slice_3242) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3249, %e1_3250, %e2_3251, %e3_3252 = cute.get_leaves(%iter_3248) : !cute.int_tuple<"(?,?,?,?)">
      %1118 = cute.get_scalars(%e0_3249) : !cute.int_tuple<"?">
      %1119 = cute.get_scalars(%e1_3250) : !cute.int_tuple<"?">
      %1120 = cute.get_scalars(%e2_3251) : !cute.int_tuple<"?">
      %1121 = cute.get_scalars(%e3_3252) : !cute.int_tuple<"?">
      %iter_3253 = cute.get_iter(%slice_3242) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3254, %e1_3255, %e2_3256, %e3_3257 = cute.get_leaves(%iter_3253) : !cute.int_tuple<"(?,?,?,?)">
      %1122 = cute.get_scalars(%e0_3254) : !cute.int_tuple<"?">
      %1123 = cute.get_scalars(%e1_3255) : !cute.int_tuple<"?">
      %1124 = cute.get_scalars(%e2_3256) : !cute.int_tuple<"?">
      %1125 = cute.get_scalars(%e3_3257) : !cute.int_tuple<"?">
      %int_tuple_3258 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3259 = cute.add_offset(%e3_3257, %int_tuple_3258) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1126 = cute.get_scalars(%tup_3259) : !cute.int_tuple<"?">
      %coord_3260 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3261 = cute.make_coord(%tup_3259) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1127 = cute.elem_less(%coord_3260, %coord_3261) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3262 = cute.get_layout(%1111) : !memref_rmem_f32_3
      %1128 = cute.get_shape(%lay_3262) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3263, %e1_3264, %e2_3265, %e3_3266 = cute.get_leaves(%1128) : !cute.shape<"((2,2),(2,8))">
      %1129 = cute.get_stride(%lay_3262) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3267, %e1_3268, %e2_3269, %e3_3270 = cute.get_leaves(%1129) : !cute.stride<"((2,4),(1,8))">
      %1130 = scf.if %1127 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1111) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,7)">
        cute.memref.store(%1111, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,7)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1111) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1111 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1111) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1111) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1111 : !memref_rmem_f32_3
      }
      %iter_3271 = cute.get_iter(%1130) : !memref_rmem_f32_3
      %lay_3272 = cute.get_layout(%1130) : !memref_rmem_f32_3
      %1131 = cute.get_shape(%lay_3272) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3273, %e1_3274, %e2_3275, %e3_3276 = cute.get_leaves(%1131) : !cute.shape<"((2,2),(2,8))">
      %1132 = cute.get_stride(%lay_3272) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3277, %e1_3278, %e2_3279, %e3_3280 = cute.get_leaves(%1132) : !cute.stride<"((2,4),(1,8))">
      %iter_3281 = cute.get_iter(%1130) : !memref_rmem_f32_3
      %iter_3282 = cute.get_iter(%1130) : !memref_rmem_f32_3
      %coord_3283 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %slice_3284 = cute.slice(%view_2232, %coord_3283) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)">
      %iter_3285 = cute.get_iter(%slice_3284) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3286, %e1_3287, %e2_3288, %e3_3289 = cute.get_leaves(%iter_3285) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1133 = cute.get_scalars(%e0_3286) : !cute.int_tuple<"?">
      %1134 = cute.get_scalars(%e1_3287) : !cute.int_tuple<"?">
      %1135 = cute.get_scalars(%e2_3288) : !cute.int_tuple<"?">
      %1136 = cute.get_scalars(%e3_3289) : !cute.int_tuple<"?{div=2}">
      %iter_3290 = cute.get_iter(%slice_3284) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3291, %e1_3292, %e2_3293, %e3_3294 = cute.get_leaves(%iter_3290) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1137 = cute.get_scalars(%e0_3291) : !cute.int_tuple<"?">
      %1138 = cute.get_scalars(%e1_3292) : !cute.int_tuple<"?">
      %1139 = cute.get_scalars(%e2_3293) : !cute.int_tuple<"?">
      %1140 = cute.get_scalars(%e3_3294) : !cute.int_tuple<"?{div=2}">
      %iter_3295 = cute.get_iter(%slice_3284) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3296, %e1_3297, %e2_3298, %e3_3299 = cute.get_leaves(%iter_3295) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1141 = cute.get_scalars(%e0_3296) : !cute.int_tuple<"?">
      %1142 = cute.get_scalars(%e1_3297) : !cute.int_tuple<"?">
      %1143 = cute.get_scalars(%e2_3298) : !cute.int_tuple<"?">
      %1144 = cute.get_scalars(%e3_3299) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3300 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3301 = cute.add_offset(%e3_3299, %int_tuple_3300) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1145 = cute.get_scalars(%tup_3301) : !cute.int_tuple<"?">
      %coord_3302 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3303 = cute.make_coord(%tup_3301) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1146 = cute.elem_less(%coord_3302, %coord_3303) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3304 = cute.get_layout(%1130) : !memref_rmem_f32_3
      %1147 = cute.get_shape(%lay_3304) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3305, %e1_3306, %e2_3307, %e3_3308 = cute.get_leaves(%1147) : !cute.shape<"((2,2),(2,8))">
      %1148 = cute.get_stride(%lay_3304) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3309, %e1_3310, %e2_3311, %e3_3312 = cute.get_leaves(%1148) : !cute.stride<"((2,4),(1,8))">
      %1149 = scf.if %1146 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1130) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,8)">
        cute.memref.store(%1130, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,8)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1130) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1130 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1130) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1130) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1130 : !memref_rmem_f32_3
      }
      %iter_3313 = cute.get_iter(%1149) : !memref_rmem_f32_3
      %lay_3314 = cute.get_layout(%1149) : !memref_rmem_f32_3
      %1150 = cute.get_shape(%lay_3314) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3315, %e1_3316, %e2_3317, %e3_3318 = cute.get_leaves(%1150) : !cute.shape<"((2,2),(2,8))">
      %1151 = cute.get_stride(%lay_3314) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3319, %e1_3320, %e2_3321, %e3_3322 = cute.get_leaves(%1151) : !cute.stride<"((2,4),(1,8))">
      %iter_3323 = cute.get_iter(%1149) : !memref_rmem_f32_3
      %iter_3324 = cute.get_iter(%1149) : !memref_rmem_f32_3
      %coord_3325 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %slice_3326 = cute.slice(%view_2232, %coord_3325) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)">
      %iter_3327 = cute.get_iter(%slice_3326) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3328, %e1_3329, %e2_3330, %e3_3331 = cute.get_leaves(%iter_3327) : !cute.int_tuple<"(?,?,?,?)">
      %1152 = cute.get_scalars(%e0_3328) : !cute.int_tuple<"?">
      %1153 = cute.get_scalars(%e1_3329) : !cute.int_tuple<"?">
      %1154 = cute.get_scalars(%e2_3330) : !cute.int_tuple<"?">
      %1155 = cute.get_scalars(%e3_3331) : !cute.int_tuple<"?">
      %iter_3332 = cute.get_iter(%slice_3326) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3333, %e1_3334, %e2_3335, %e3_3336 = cute.get_leaves(%iter_3332) : !cute.int_tuple<"(?,?,?,?)">
      %1156 = cute.get_scalars(%e0_3333) : !cute.int_tuple<"?">
      %1157 = cute.get_scalars(%e1_3334) : !cute.int_tuple<"?">
      %1158 = cute.get_scalars(%e2_3335) : !cute.int_tuple<"?">
      %1159 = cute.get_scalars(%e3_3336) : !cute.int_tuple<"?">
      %iter_3337 = cute.get_iter(%slice_3326) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3338, %e1_3339, %e2_3340, %e3_3341 = cute.get_leaves(%iter_3337) : !cute.int_tuple<"(?,?,?,?)">
      %1160 = cute.get_scalars(%e0_3338) : !cute.int_tuple<"?">
      %1161 = cute.get_scalars(%e1_3339) : !cute.int_tuple<"?">
      %1162 = cute.get_scalars(%e2_3340) : !cute.int_tuple<"?">
      %1163 = cute.get_scalars(%e3_3341) : !cute.int_tuple<"?">
      %int_tuple_3342 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3343 = cute.add_offset(%e3_3341, %int_tuple_3342) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1164 = cute.get_scalars(%tup_3343) : !cute.int_tuple<"?">
      %coord_3344 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3345 = cute.make_coord(%tup_3343) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1165 = cute.elem_less(%coord_3344, %coord_3345) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3346 = cute.get_layout(%1149) : !memref_rmem_f32_3
      %1166 = cute.get_shape(%lay_3346) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3347, %e1_3348, %e2_3349, %e3_3350 = cute.get_leaves(%1166) : !cute.shape<"((2,2),(2,8))">
      %1167 = cute.get_stride(%lay_3346) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3351, %e1_3352, %e2_3353, %e3_3354 = cute.get_leaves(%1167) : !cute.stride<"((2,4),(1,8))">
      %1168 = scf.if %1165 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1149) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,9)">
        cute.memref.store(%1149, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,9)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1149) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1149 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1149) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1149) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1149 : !memref_rmem_f32_3
      }
      %iter_3355 = cute.get_iter(%1168) : !memref_rmem_f32_3
      %lay_3356 = cute.get_layout(%1168) : !memref_rmem_f32_3
      %1169 = cute.get_shape(%lay_3356) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3357, %e1_3358, %e2_3359, %e3_3360 = cute.get_leaves(%1169) : !cute.shape<"((2,2),(2,8))">
      %1170 = cute.get_stride(%lay_3356) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3361, %e1_3362, %e2_3363, %e3_3364 = cute.get_leaves(%1170) : !cute.stride<"((2,4),(1,8))">
      %iter_3365 = cute.get_iter(%1168) : !memref_rmem_f32_3
      %iter_3366 = cute.get_iter(%1168) : !memref_rmem_f32_3
      %coord_3367 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %slice_3368 = cute.slice(%view_2232, %coord_3367) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)">
      %iter_3369 = cute.get_iter(%slice_3368) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3370, %e1_3371, %e2_3372, %e3_3373 = cute.get_leaves(%iter_3369) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1171 = cute.get_scalars(%e0_3370) : !cute.int_tuple<"?">
      %1172 = cute.get_scalars(%e1_3371) : !cute.int_tuple<"?">
      %1173 = cute.get_scalars(%e2_3372) : !cute.int_tuple<"?">
      %1174 = cute.get_scalars(%e3_3373) : !cute.int_tuple<"?{div=2}">
      %iter_3374 = cute.get_iter(%slice_3368) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3375, %e1_3376, %e2_3377, %e3_3378 = cute.get_leaves(%iter_3374) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1175 = cute.get_scalars(%e0_3375) : !cute.int_tuple<"?">
      %1176 = cute.get_scalars(%e1_3376) : !cute.int_tuple<"?">
      %1177 = cute.get_scalars(%e2_3377) : !cute.int_tuple<"?">
      %1178 = cute.get_scalars(%e3_3378) : !cute.int_tuple<"?{div=2}">
      %iter_3379 = cute.get_iter(%slice_3368) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3380, %e1_3381, %e2_3382, %e3_3383 = cute.get_leaves(%iter_3379) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1179 = cute.get_scalars(%e0_3380) : !cute.int_tuple<"?">
      %1180 = cute.get_scalars(%e1_3381) : !cute.int_tuple<"?">
      %1181 = cute.get_scalars(%e2_3382) : !cute.int_tuple<"?">
      %1182 = cute.get_scalars(%e3_3383) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3384 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3385 = cute.add_offset(%e3_3383, %int_tuple_3384) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1183 = cute.get_scalars(%tup_3385) : !cute.int_tuple<"?">
      %coord_3386 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3387 = cute.make_coord(%tup_3385) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1184 = cute.elem_less(%coord_3386, %coord_3387) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3388 = cute.get_layout(%1168) : !memref_rmem_f32_3
      %1185 = cute.get_shape(%lay_3388) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3389, %e1_3390, %e2_3391, %e3_3392 = cute.get_leaves(%1185) : !cute.shape<"((2,2),(2,8))">
      %1186 = cute.get_stride(%lay_3388) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3393, %e1_3394, %e2_3395, %e3_3396 = cute.get_leaves(%1186) : !cute.stride<"((2,4),(1,8))">
      %1187 = scf.if %1184 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1168) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,10)">
        cute.memref.store(%1168, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,10)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1168) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1168 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1168) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1168) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1168 : !memref_rmem_f32_3
      }
      %iter_3397 = cute.get_iter(%1187) : !memref_rmem_f32_3
      %lay_3398 = cute.get_layout(%1187) : !memref_rmem_f32_3
      %1188 = cute.get_shape(%lay_3398) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3399, %e1_3400, %e2_3401, %e3_3402 = cute.get_leaves(%1188) : !cute.shape<"((2,2),(2,8))">
      %1189 = cute.get_stride(%lay_3398) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3403, %e1_3404, %e2_3405, %e3_3406 = cute.get_leaves(%1189) : !cute.stride<"((2,4),(1,8))">
      %iter_3407 = cute.get_iter(%1187) : !memref_rmem_f32_3
      %iter_3408 = cute.get_iter(%1187) : !memref_rmem_f32_3
      %coord_3409 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %slice_3410 = cute.slice(%view_2232, %coord_3409) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)">
      %iter_3411 = cute.get_iter(%slice_3410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3412, %e1_3413, %e2_3414, %e3_3415 = cute.get_leaves(%iter_3411) : !cute.int_tuple<"(?,?,?,?)">
      %1190 = cute.get_scalars(%e0_3412) : !cute.int_tuple<"?">
      %1191 = cute.get_scalars(%e1_3413) : !cute.int_tuple<"?">
      %1192 = cute.get_scalars(%e2_3414) : !cute.int_tuple<"?">
      %1193 = cute.get_scalars(%e3_3415) : !cute.int_tuple<"?">
      %iter_3416 = cute.get_iter(%slice_3410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3417, %e1_3418, %e2_3419, %e3_3420 = cute.get_leaves(%iter_3416) : !cute.int_tuple<"(?,?,?,?)">
      %1194 = cute.get_scalars(%e0_3417) : !cute.int_tuple<"?">
      %1195 = cute.get_scalars(%e1_3418) : !cute.int_tuple<"?">
      %1196 = cute.get_scalars(%e2_3419) : !cute.int_tuple<"?">
      %1197 = cute.get_scalars(%e3_3420) : !cute.int_tuple<"?">
      %iter_3421 = cute.get_iter(%slice_3410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3422, %e1_3423, %e2_3424, %e3_3425 = cute.get_leaves(%iter_3421) : !cute.int_tuple<"(?,?,?,?)">
      %1198 = cute.get_scalars(%e0_3422) : !cute.int_tuple<"?">
      %1199 = cute.get_scalars(%e1_3423) : !cute.int_tuple<"?">
      %1200 = cute.get_scalars(%e2_3424) : !cute.int_tuple<"?">
      %1201 = cute.get_scalars(%e3_3425) : !cute.int_tuple<"?">
      %int_tuple_3426 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3427 = cute.add_offset(%e3_3425, %int_tuple_3426) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1202 = cute.get_scalars(%tup_3427) : !cute.int_tuple<"?">
      %coord_3428 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3429 = cute.make_coord(%tup_3427) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1203 = cute.elem_less(%coord_3428, %coord_3429) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3430 = cute.get_layout(%1187) : !memref_rmem_f32_3
      %1204 = cute.get_shape(%lay_3430) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3431, %e1_3432, %e2_3433, %e3_3434 = cute.get_leaves(%1204) : !cute.shape<"((2,2),(2,8))">
      %1205 = cute.get_stride(%lay_3430) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3435, %e1_3436, %e2_3437, %e3_3438 = cute.get_leaves(%1205) : !cute.stride<"((2,4),(1,8))">
      %1206 = scf.if %1203 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1187) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,11)">
        cute.memref.store(%1187, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,11)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1187) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1187 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1187) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1187) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1187 : !memref_rmem_f32_3
      }
      %iter_3439 = cute.get_iter(%1206) : !memref_rmem_f32_3
      %lay_3440 = cute.get_layout(%1206) : !memref_rmem_f32_3
      %1207 = cute.get_shape(%lay_3440) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3441, %e1_3442, %e2_3443, %e3_3444 = cute.get_leaves(%1207) : !cute.shape<"((2,2),(2,8))">
      %1208 = cute.get_stride(%lay_3440) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3445, %e1_3446, %e2_3447, %e3_3448 = cute.get_leaves(%1208) : !cute.stride<"((2,4),(1,8))">
      %iter_3449 = cute.get_iter(%1206) : !memref_rmem_f32_3
      %iter_3450 = cute.get_iter(%1206) : !memref_rmem_f32_3
      %coord_3451 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %slice_3452 = cute.slice(%view_2232, %coord_3451) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)">
      %iter_3453 = cute.get_iter(%slice_3452) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3454, %e1_3455, %e2_3456, %e3_3457 = cute.get_leaves(%iter_3453) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1209 = cute.get_scalars(%e0_3454) : !cute.int_tuple<"?">
      %1210 = cute.get_scalars(%e1_3455) : !cute.int_tuple<"?">
      %1211 = cute.get_scalars(%e2_3456) : !cute.int_tuple<"?">
      %1212 = cute.get_scalars(%e3_3457) : !cute.int_tuple<"?{div=2}">
      %iter_3458 = cute.get_iter(%slice_3452) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3459, %e1_3460, %e2_3461, %e3_3462 = cute.get_leaves(%iter_3458) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1213 = cute.get_scalars(%e0_3459) : !cute.int_tuple<"?">
      %1214 = cute.get_scalars(%e1_3460) : !cute.int_tuple<"?">
      %1215 = cute.get_scalars(%e2_3461) : !cute.int_tuple<"?">
      %1216 = cute.get_scalars(%e3_3462) : !cute.int_tuple<"?{div=2}">
      %iter_3463 = cute.get_iter(%slice_3452) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3464, %e1_3465, %e2_3466, %e3_3467 = cute.get_leaves(%iter_3463) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1217 = cute.get_scalars(%e0_3464) : !cute.int_tuple<"?">
      %1218 = cute.get_scalars(%e1_3465) : !cute.int_tuple<"?">
      %1219 = cute.get_scalars(%e2_3466) : !cute.int_tuple<"?">
      %1220 = cute.get_scalars(%e3_3467) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3468 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3469 = cute.add_offset(%e3_3467, %int_tuple_3468) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1221 = cute.get_scalars(%tup_3469) : !cute.int_tuple<"?">
      %coord_3470 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3471 = cute.make_coord(%tup_3469) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1222 = cute.elem_less(%coord_3470, %coord_3471) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3472 = cute.get_layout(%1206) : !memref_rmem_f32_3
      %1223 = cute.get_shape(%lay_3472) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3473, %e1_3474, %e2_3475, %e3_3476 = cute.get_leaves(%1223) : !cute.shape<"((2,2),(2,8))">
      %1224 = cute.get_stride(%lay_3472) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3477, %e1_3478, %e2_3479, %e3_3480 = cute.get_leaves(%1224) : !cute.stride<"((2,4),(1,8))">
      %1225 = scf.if %1222 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1206) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,12)">
        cute.memref.store(%1206, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,12)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1206) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1206 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1206) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1206) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1206 : !memref_rmem_f32_3
      }
      %iter_3481 = cute.get_iter(%1225) : !memref_rmem_f32_3
      %lay_3482 = cute.get_layout(%1225) : !memref_rmem_f32_3
      %1226 = cute.get_shape(%lay_3482) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3483, %e1_3484, %e2_3485, %e3_3486 = cute.get_leaves(%1226) : !cute.shape<"((2,2),(2,8))">
      %1227 = cute.get_stride(%lay_3482) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3487, %e1_3488, %e2_3489, %e3_3490 = cute.get_leaves(%1227) : !cute.stride<"((2,4),(1,8))">
      %iter_3491 = cute.get_iter(%1225) : !memref_rmem_f32_3
      %iter_3492 = cute.get_iter(%1225) : !memref_rmem_f32_3
      %coord_3493 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %slice_3494 = cute.slice(%view_2232, %coord_3493) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)">
      %iter_3495 = cute.get_iter(%slice_3494) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3496, %e1_3497, %e2_3498, %e3_3499 = cute.get_leaves(%iter_3495) : !cute.int_tuple<"(?,?,?,?)">
      %1228 = cute.get_scalars(%e0_3496) : !cute.int_tuple<"?">
      %1229 = cute.get_scalars(%e1_3497) : !cute.int_tuple<"?">
      %1230 = cute.get_scalars(%e2_3498) : !cute.int_tuple<"?">
      %1231 = cute.get_scalars(%e3_3499) : !cute.int_tuple<"?">
      %iter_3500 = cute.get_iter(%slice_3494) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3501, %e1_3502, %e2_3503, %e3_3504 = cute.get_leaves(%iter_3500) : !cute.int_tuple<"(?,?,?,?)">
      %1232 = cute.get_scalars(%e0_3501) : !cute.int_tuple<"?">
      %1233 = cute.get_scalars(%e1_3502) : !cute.int_tuple<"?">
      %1234 = cute.get_scalars(%e2_3503) : !cute.int_tuple<"?">
      %1235 = cute.get_scalars(%e3_3504) : !cute.int_tuple<"?">
      %iter_3505 = cute.get_iter(%slice_3494) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3506, %e1_3507, %e2_3508, %e3_3509 = cute.get_leaves(%iter_3505) : !cute.int_tuple<"(?,?,?,?)">
      %1236 = cute.get_scalars(%e0_3506) : !cute.int_tuple<"?">
      %1237 = cute.get_scalars(%e1_3507) : !cute.int_tuple<"?">
      %1238 = cute.get_scalars(%e2_3508) : !cute.int_tuple<"?">
      %1239 = cute.get_scalars(%e3_3509) : !cute.int_tuple<"?">
      %int_tuple_3510 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3511 = cute.add_offset(%e3_3509, %int_tuple_3510) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1240 = cute.get_scalars(%tup_3511) : !cute.int_tuple<"?">
      %coord_3512 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3513 = cute.make_coord(%tup_3511) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1241 = cute.elem_less(%coord_3512, %coord_3513) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3514 = cute.get_layout(%1225) : !memref_rmem_f32_3
      %1242 = cute.get_shape(%lay_3514) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3515, %e1_3516, %e2_3517, %e3_3518 = cute.get_leaves(%1242) : !cute.shape<"((2,2),(2,8))">
      %1243 = cute.get_stride(%lay_3514) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3519, %e1_3520, %e2_3521, %e3_3522 = cute.get_leaves(%1243) : !cute.stride<"((2,4),(1,8))">
      %1244 = scf.if %1241 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1225) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,13)">
        cute.memref.store(%1225, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,13)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1225) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1225 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1225) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1225) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1225 : !memref_rmem_f32_3
      }
      %iter_3523 = cute.get_iter(%1244) : !memref_rmem_f32_3
      %lay_3524 = cute.get_layout(%1244) : !memref_rmem_f32_3
      %1245 = cute.get_shape(%lay_3524) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3525, %e1_3526, %e2_3527, %e3_3528 = cute.get_leaves(%1245) : !cute.shape<"((2,2),(2,8))">
      %1246 = cute.get_stride(%lay_3524) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3529, %e1_3530, %e2_3531, %e3_3532 = cute.get_leaves(%1246) : !cute.stride<"((2,4),(1,8))">
      %iter_3533 = cute.get_iter(%1244) : !memref_rmem_f32_3
      %iter_3534 = cute.get_iter(%1244) : !memref_rmem_f32_3
      %coord_3535 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %slice_3536 = cute.slice(%view_2232, %coord_3535) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)">
      %iter_3537 = cute.get_iter(%slice_3536) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3538, %e1_3539, %e2_3540, %e3_3541 = cute.get_leaves(%iter_3537) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1247 = cute.get_scalars(%e0_3538) : !cute.int_tuple<"?">
      %1248 = cute.get_scalars(%e1_3539) : !cute.int_tuple<"?">
      %1249 = cute.get_scalars(%e2_3540) : !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%e3_3541) : !cute.int_tuple<"?{div=2}">
      %iter_3542 = cute.get_iter(%slice_3536) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3543, %e1_3544, %e2_3545, %e3_3546 = cute.get_leaves(%iter_3542) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1251 = cute.get_scalars(%e0_3543) : !cute.int_tuple<"?">
      %1252 = cute.get_scalars(%e1_3544) : !cute.int_tuple<"?">
      %1253 = cute.get_scalars(%e2_3545) : !cute.int_tuple<"?">
      %1254 = cute.get_scalars(%e3_3546) : !cute.int_tuple<"?{div=2}">
      %iter_3547 = cute.get_iter(%slice_3536) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3548, %e1_3549, %e2_3550, %e3_3551 = cute.get_leaves(%iter_3547) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1255 = cute.get_scalars(%e0_3548) : !cute.int_tuple<"?">
      %1256 = cute.get_scalars(%e1_3549) : !cute.int_tuple<"?">
      %1257 = cute.get_scalars(%e2_3550) : !cute.int_tuple<"?">
      %1258 = cute.get_scalars(%e3_3551) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3552 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3553 = cute.add_offset(%e3_3551, %int_tuple_3552) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1259 = cute.get_scalars(%tup_3553) : !cute.int_tuple<"?">
      %coord_3554 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3555 = cute.make_coord(%tup_3553) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1260 = cute.elem_less(%coord_3554, %coord_3555) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3556 = cute.get_layout(%1244) : !memref_rmem_f32_3
      %1261 = cute.get_shape(%lay_3556) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3557, %e1_3558, %e2_3559, %e3_3560 = cute.get_leaves(%1261) : !cute.shape<"((2,2),(2,8))">
      %1262 = cute.get_stride(%lay_3556) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3561, %e1_3562, %e2_3563, %e3_3564 = cute.get_leaves(%1262) : !cute.stride<"((2,4),(1,8))">
      %1263 = scf.if %1260 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1244) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,14)">
        cute.memref.store(%1244, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,14)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1244) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1244 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1244) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1244) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1244 : !memref_rmem_f32_3
      }
      %iter_3565 = cute.get_iter(%1263) : !memref_rmem_f32_3
      %lay_3566 = cute.get_layout(%1263) : !memref_rmem_f32_3
      %1264 = cute.get_shape(%lay_3566) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3567, %e1_3568, %e2_3569, %e3_3570 = cute.get_leaves(%1264) : !cute.shape<"((2,2),(2,8))">
      %1265 = cute.get_stride(%lay_3566) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3571, %e1_3572, %e2_3573, %e3_3574 = cute.get_leaves(%1265) : !cute.stride<"((2,4),(1,8))">
      %iter_3575 = cute.get_iter(%1263) : !memref_rmem_f32_3
      %iter_3576 = cute.get_iter(%1263) : !memref_rmem_f32_3
      %coord_3577 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %slice_3578 = cute.slice(%view_2232, %coord_3577) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)">
      %iter_3579 = cute.get_iter(%slice_3578) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3580, %e1_3581, %e2_3582, %e3_3583 = cute.get_leaves(%iter_3579) : !cute.int_tuple<"(?,?,?,?)">
      %1266 = cute.get_scalars(%e0_3580) : !cute.int_tuple<"?">
      %1267 = cute.get_scalars(%e1_3581) : !cute.int_tuple<"?">
      %1268 = cute.get_scalars(%e2_3582) : !cute.int_tuple<"?">
      %1269 = cute.get_scalars(%e3_3583) : !cute.int_tuple<"?">
      %iter_3584 = cute.get_iter(%slice_3578) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3585, %e1_3586, %e2_3587, %e3_3588 = cute.get_leaves(%iter_3584) : !cute.int_tuple<"(?,?,?,?)">
      %1270 = cute.get_scalars(%e0_3585) : !cute.int_tuple<"?">
      %1271 = cute.get_scalars(%e1_3586) : !cute.int_tuple<"?">
      %1272 = cute.get_scalars(%e2_3587) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e3_3588) : !cute.int_tuple<"?">
      %iter_3589 = cute.get_iter(%slice_3578) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3590, %e1_3591, %e2_3592, %e3_3593 = cute.get_leaves(%iter_3589) : !cute.int_tuple<"(?,?,?,?)">
      %1274 = cute.get_scalars(%e0_3590) : !cute.int_tuple<"?">
      %1275 = cute.get_scalars(%e1_3591) : !cute.int_tuple<"?">
      %1276 = cute.get_scalars(%e2_3592) : !cute.int_tuple<"?">
      %1277 = cute.get_scalars(%e3_3593) : !cute.int_tuple<"?">
      %int_tuple_3594 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3595 = cute.add_offset(%e3_3593, %int_tuple_3594) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1278 = cute.get_scalars(%tup_3595) : !cute.int_tuple<"?">
      %coord_3596 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3597 = cute.make_coord(%tup_3595) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1279 = cute.elem_less(%coord_3596, %coord_3597) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3598 = cute.get_layout(%1263) : !memref_rmem_f32_3
      %1280 = cute.get_shape(%lay_3598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3599, %e1_3600, %e2_3601, %e3_3602 = cute.get_leaves(%1280) : !cute.shape<"((2,2),(2,8))">
      %1281 = cute.get_stride(%lay_3598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3603, %e1_3604, %e2_3605, %e3_3606 = cute.get_leaves(%1281) : !cute.stride<"((2,4),(1,8))">
      %1282 = scf.if %1279 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1263) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(1,15)">
        cute.memref.store(%1263, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(1,15)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1263) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1263 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1263) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1263) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1263 : !memref_rmem_f32_3
      }
      %iter_3607 = cute.get_iter(%1282) : !memref_rmem_f32_3
      %lay_3608 = cute.get_layout(%1282) : !memref_rmem_f32_3
      %1283 = cute.get_shape(%lay_3608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3609, %e1_3610, %e2_3611, %e3_3612 = cute.get_leaves(%1283) : !cute.shape<"((2,2),(2,8))">
      %1284 = cute.get_stride(%lay_3608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3613, %e1_3614, %e2_3615, %e3_3616 = cute.get_leaves(%1284) : !cute.stride<"((2,4),(1,8))">
      %iter_3617 = cute.get_iter(%1282) : !memref_rmem_f32_3
      %iter_3618 = cute.get_iter(%1282) : !memref_rmem_f32_3
      %coord_3619 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %slice_3620 = cute.slice(%1282, %coord_3619) : !memref_rmem_f32_3, !cute.coord<"(1,_)">
      %iter_3621 = cute.get_iter(%slice_3620) : !memref_rmem_f32_6
      %lay_3622 = cute.get_layout(%slice_3620) : !memref_rmem_f32_6
      %1285 = cute.get_shape(%lay_3622) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3623, %e1_3624 = cute.get_leaves(%1285) : !cute.shape<"((2,8))">
      %1286 = cute.memref.load_vec %slice_3620, row_major : !memref_rmem_f32_6
      %cst_3625 = arith.constant 0xFF800000 : f32
      %1287 = vector.reduction <maximumf>, %1286, %cst_3625 : vector<16xf32> into f32
      %c-1_i32_3626 = arith.constant -1 : i32
      %c2_i32_3627 = arith.constant 2 : i32
      %c31_i32_3628 = arith.constant 31 : i32
      %1288 = nvvm.shfl.sync  bfly %c-1_i32_3626, %1287, %c2_i32_3627, %c31_i32_3628 : f32 -> f32
      %1289 = nvvm.fmax %1287, %1288
      %c-1_i32_3629 = arith.constant -1 : i32
      %c1_i32_3630 = arith.constant 1 : i32
      %c31_i32_3631 = arith.constant 31 : i32
      %1290 = nvvm.shfl.sync  bfly %c-1_i32_3629, %1289, %c1_i32_3630, %c31_i32_3631 : f32 -> f32
      %1291 = nvvm.fmax %1289, %1290
      %1292 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1293 = arith.mulf %1286, %1292 : vector<16xf32>
      %1294 = arith.mulf %1291, %arg4 : f32
      %1295 = vector.broadcast %1294 : f32 to vector<16xf32>
      %1296 = arith.subf %1293, %1295 : vector<16xf32>
      %1297 = math.exp2 %1296 fastmath<fast> : vector<16xf32>
      %cst_3632 = arith.constant 0.000000e+00 : f32
      %1298 = vector.reduction <add>, %1297, %cst_3632 : vector<16xf32> into f32
      %coord_3633 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_906, %coord_3633, %1291) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_3634 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_911, %coord_3634, %1298) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_3635 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %slice_3636 = cute.slice(%1282, %coord_3635) : !memref_rmem_f32_3, !cute.coord<"(1,_)">
      %iter_3637 = cute.get_iter(%slice_3636) : !memref_rmem_f32_6
      %lay_3638 = cute.get_layout(%slice_3636) : !memref_rmem_f32_6
      %1299 = cute.get_shape(%lay_3638) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3639, %e1_3640 = cute.get_leaves(%1299) : !cute.shape<"((2,8))">
      %int_tuple_3641 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3642 = cute.size(%int_tuple_3641) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3643 = cute.get_leaves(%sz_3642) : !cute.int_tuple<"16">
      %int_tuple_3644 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3645 = cute.size(%int_tuple_3644) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3646 = cute.get_leaves(%sz_3645) : !cute.int_tuple<"16">
      cute.memref.store_vec %1297, %slice_3636, row_major : !memref_rmem_f32_6
      %int_tuple_3647 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3648 = cute.size(%int_tuple_3647) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3649 = cute.get_leaves(%sz_3648) : !cute.int_tuple<"16">
      %coord_3650 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %slice_3651 = cute.slice(%view_2232, %coord_3650) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)">
      %iter_3652 = cute.get_iter(%slice_3651) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3653, %e1_3654, %e2_3655, %e3_3656 = cute.get_leaves(%iter_3652) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1300 = cute.get_scalars(%e0_3653) : !cute.int_tuple<"?">
      %1301 = cute.get_scalars(%e1_3654) : !cute.int_tuple<"?">
      %1302 = cute.get_scalars(%e2_3655) : !cute.int_tuple<"?">
      %1303 = cute.get_scalars(%e3_3656) : !cute.int_tuple<"?{div=2}">
      %iter_3657 = cute.get_iter(%slice_3651) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3658, %e1_3659, %e2_3660, %e3_3661 = cute.get_leaves(%iter_3657) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1304 = cute.get_scalars(%e0_3658) : !cute.int_tuple<"?">
      %1305 = cute.get_scalars(%e1_3659) : !cute.int_tuple<"?">
      %1306 = cute.get_scalars(%e2_3660) : !cute.int_tuple<"?">
      %1307 = cute.get_scalars(%e3_3661) : !cute.int_tuple<"?{div=2}">
      %iter_3662 = cute.get_iter(%slice_3651) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3663, %e1_3664, %e2_3665, %e3_3666 = cute.get_leaves(%iter_3662) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1308 = cute.get_scalars(%e0_3663) : !cute.int_tuple<"?">
      %1309 = cute.get_scalars(%e1_3664) : !cute.int_tuple<"?">
      %1310 = cute.get_scalars(%e2_3665) : !cute.int_tuple<"?">
      %1311 = cute.get_scalars(%e3_3666) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3667 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3668 = cute.add_offset(%e3_3666, %int_tuple_3667) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1312 = cute.get_scalars(%tup_3668) : !cute.int_tuple<"?">
      %coord_3669 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3670 = cute.make_coord(%tup_3668) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1313 = cute.elem_less(%coord_3669, %coord_3670) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3671 = cute.get_layout(%1282) : !memref_rmem_f32_3
      %1314 = cute.get_shape(%lay_3671) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3672, %e1_3673, %e2_3674, %e3_3675 = cute.get_leaves(%1314) : !cute.shape<"((2,2),(2,8))">
      %1315 = cute.get_stride(%lay_3671) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3676, %e1_3677, %e2_3678, %e3_3679 = cute.get_leaves(%1315) : !cute.stride<"((2,4),(1,8))">
      %1316 = scf.if %1313 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1282) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,0)">
        cute.memref.store(%1282, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,0)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1282) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1282 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1282) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1282) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1282 : !memref_rmem_f32_3
      }
      %iter_3680 = cute.get_iter(%1316) : !memref_rmem_f32_3
      %lay_3681 = cute.get_layout(%1316) : !memref_rmem_f32_3
      %1317 = cute.get_shape(%lay_3681) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3682, %e1_3683, %e2_3684, %e3_3685 = cute.get_leaves(%1317) : !cute.shape<"((2,2),(2,8))">
      %1318 = cute.get_stride(%lay_3681) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3686, %e1_3687, %e2_3688, %e3_3689 = cute.get_leaves(%1318) : !cute.stride<"((2,4),(1,8))">
      %iter_3690 = cute.get_iter(%1316) : !memref_rmem_f32_3
      %iter_3691 = cute.get_iter(%1316) : !memref_rmem_f32_3
      %coord_3692 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %slice_3693 = cute.slice(%view_2232, %coord_3692) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)">
      %iter_3694 = cute.get_iter(%slice_3693) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3695, %e1_3696, %e2_3697, %e3_3698 = cute.get_leaves(%iter_3694) : !cute.int_tuple<"(?,?,?,?)">
      %1319 = cute.get_scalars(%e0_3695) : !cute.int_tuple<"?">
      %1320 = cute.get_scalars(%e1_3696) : !cute.int_tuple<"?">
      %1321 = cute.get_scalars(%e2_3697) : !cute.int_tuple<"?">
      %1322 = cute.get_scalars(%e3_3698) : !cute.int_tuple<"?">
      %iter_3699 = cute.get_iter(%slice_3693) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3700, %e1_3701, %e2_3702, %e3_3703 = cute.get_leaves(%iter_3699) : !cute.int_tuple<"(?,?,?,?)">
      %1323 = cute.get_scalars(%e0_3700) : !cute.int_tuple<"?">
      %1324 = cute.get_scalars(%e1_3701) : !cute.int_tuple<"?">
      %1325 = cute.get_scalars(%e2_3702) : !cute.int_tuple<"?">
      %1326 = cute.get_scalars(%e3_3703) : !cute.int_tuple<"?">
      %iter_3704 = cute.get_iter(%slice_3693) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3705, %e1_3706, %e2_3707, %e3_3708 = cute.get_leaves(%iter_3704) : !cute.int_tuple<"(?,?,?,?)">
      %1327 = cute.get_scalars(%e0_3705) : !cute.int_tuple<"?">
      %1328 = cute.get_scalars(%e1_3706) : !cute.int_tuple<"?">
      %1329 = cute.get_scalars(%e2_3707) : !cute.int_tuple<"?">
      %1330 = cute.get_scalars(%e3_3708) : !cute.int_tuple<"?">
      %int_tuple_3709 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3710 = cute.add_offset(%e3_3708, %int_tuple_3709) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1331 = cute.get_scalars(%tup_3710) : !cute.int_tuple<"?">
      %coord_3711 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3712 = cute.make_coord(%tup_3710) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1332 = cute.elem_less(%coord_3711, %coord_3712) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3713 = cute.get_layout(%1316) : !memref_rmem_f32_3
      %1333 = cute.get_shape(%lay_3713) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3714, %e1_3715, %e2_3716, %e3_3717 = cute.get_leaves(%1333) : !cute.shape<"((2,2),(2,8))">
      %1334 = cute.get_stride(%lay_3713) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3718, %e1_3719, %e2_3720, %e3_3721 = cute.get_leaves(%1334) : !cute.stride<"((2,4),(1,8))">
      %1335 = scf.if %1332 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1316) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,1)">
        cute.memref.store(%1316, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,1)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1316) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1316 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1316) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1316) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1316 : !memref_rmem_f32_3
      }
      %iter_3722 = cute.get_iter(%1335) : !memref_rmem_f32_3
      %lay_3723 = cute.get_layout(%1335) : !memref_rmem_f32_3
      %1336 = cute.get_shape(%lay_3723) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3724, %e1_3725, %e2_3726, %e3_3727 = cute.get_leaves(%1336) : !cute.shape<"((2,2),(2,8))">
      %1337 = cute.get_stride(%lay_3723) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3728, %e1_3729, %e2_3730, %e3_3731 = cute.get_leaves(%1337) : !cute.stride<"((2,4),(1,8))">
      %iter_3732 = cute.get_iter(%1335) : !memref_rmem_f32_3
      %iter_3733 = cute.get_iter(%1335) : !memref_rmem_f32_3
      %coord_3734 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %slice_3735 = cute.slice(%view_2232, %coord_3734) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)">
      %iter_3736 = cute.get_iter(%slice_3735) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3737, %e1_3738, %e2_3739, %e3_3740 = cute.get_leaves(%iter_3736) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1338 = cute.get_scalars(%e0_3737) : !cute.int_tuple<"?">
      %1339 = cute.get_scalars(%e1_3738) : !cute.int_tuple<"?">
      %1340 = cute.get_scalars(%e2_3739) : !cute.int_tuple<"?">
      %1341 = cute.get_scalars(%e3_3740) : !cute.int_tuple<"?{div=2}">
      %iter_3741 = cute.get_iter(%slice_3735) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3742, %e1_3743, %e2_3744, %e3_3745 = cute.get_leaves(%iter_3741) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1342 = cute.get_scalars(%e0_3742) : !cute.int_tuple<"?">
      %1343 = cute.get_scalars(%e1_3743) : !cute.int_tuple<"?">
      %1344 = cute.get_scalars(%e2_3744) : !cute.int_tuple<"?">
      %1345 = cute.get_scalars(%e3_3745) : !cute.int_tuple<"?{div=2}">
      %iter_3746 = cute.get_iter(%slice_3735) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3747, %e1_3748, %e2_3749, %e3_3750 = cute.get_leaves(%iter_3746) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1346 = cute.get_scalars(%e0_3747) : !cute.int_tuple<"?">
      %1347 = cute.get_scalars(%e1_3748) : !cute.int_tuple<"?">
      %1348 = cute.get_scalars(%e2_3749) : !cute.int_tuple<"?">
      %1349 = cute.get_scalars(%e3_3750) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3751 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3752 = cute.add_offset(%e3_3750, %int_tuple_3751) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1350 = cute.get_scalars(%tup_3752) : !cute.int_tuple<"?">
      %coord_3753 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3754 = cute.make_coord(%tup_3752) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1351 = cute.elem_less(%coord_3753, %coord_3754) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3755 = cute.get_layout(%1335) : !memref_rmem_f32_3
      %1352 = cute.get_shape(%lay_3755) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3756, %e1_3757, %e2_3758, %e3_3759 = cute.get_leaves(%1352) : !cute.shape<"((2,2),(2,8))">
      %1353 = cute.get_stride(%lay_3755) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3760, %e1_3761, %e2_3762, %e3_3763 = cute.get_leaves(%1353) : !cute.stride<"((2,4),(1,8))">
      %1354 = scf.if %1351 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1335) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,2)">
        cute.memref.store(%1335, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,2)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1335) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1335 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1335) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1335) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1335 : !memref_rmem_f32_3
      }
      %iter_3764 = cute.get_iter(%1354) : !memref_rmem_f32_3
      %lay_3765 = cute.get_layout(%1354) : !memref_rmem_f32_3
      %1355 = cute.get_shape(%lay_3765) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3766, %e1_3767, %e2_3768, %e3_3769 = cute.get_leaves(%1355) : !cute.shape<"((2,2),(2,8))">
      %1356 = cute.get_stride(%lay_3765) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3770, %e1_3771, %e2_3772, %e3_3773 = cute.get_leaves(%1356) : !cute.stride<"((2,4),(1,8))">
      %iter_3774 = cute.get_iter(%1354) : !memref_rmem_f32_3
      %iter_3775 = cute.get_iter(%1354) : !memref_rmem_f32_3
      %coord_3776 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %slice_3777 = cute.slice(%view_2232, %coord_3776) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)">
      %iter_3778 = cute.get_iter(%slice_3777) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3779, %e1_3780, %e2_3781, %e3_3782 = cute.get_leaves(%iter_3778) : !cute.int_tuple<"(?,?,?,?)">
      %1357 = cute.get_scalars(%e0_3779) : !cute.int_tuple<"?">
      %1358 = cute.get_scalars(%e1_3780) : !cute.int_tuple<"?">
      %1359 = cute.get_scalars(%e2_3781) : !cute.int_tuple<"?">
      %1360 = cute.get_scalars(%e3_3782) : !cute.int_tuple<"?">
      %iter_3783 = cute.get_iter(%slice_3777) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3784, %e1_3785, %e2_3786, %e3_3787 = cute.get_leaves(%iter_3783) : !cute.int_tuple<"(?,?,?,?)">
      %1361 = cute.get_scalars(%e0_3784) : !cute.int_tuple<"?">
      %1362 = cute.get_scalars(%e1_3785) : !cute.int_tuple<"?">
      %1363 = cute.get_scalars(%e2_3786) : !cute.int_tuple<"?">
      %1364 = cute.get_scalars(%e3_3787) : !cute.int_tuple<"?">
      %iter_3788 = cute.get_iter(%slice_3777) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3789, %e1_3790, %e2_3791, %e3_3792 = cute.get_leaves(%iter_3788) : !cute.int_tuple<"(?,?,?,?)">
      %1365 = cute.get_scalars(%e0_3789) : !cute.int_tuple<"?">
      %1366 = cute.get_scalars(%e1_3790) : !cute.int_tuple<"?">
      %1367 = cute.get_scalars(%e2_3791) : !cute.int_tuple<"?">
      %1368 = cute.get_scalars(%e3_3792) : !cute.int_tuple<"?">
      %int_tuple_3793 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3794 = cute.add_offset(%e3_3792, %int_tuple_3793) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1369 = cute.get_scalars(%tup_3794) : !cute.int_tuple<"?">
      %coord_3795 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3796 = cute.make_coord(%tup_3794) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1370 = cute.elem_less(%coord_3795, %coord_3796) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3797 = cute.get_layout(%1354) : !memref_rmem_f32_3
      %1371 = cute.get_shape(%lay_3797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3798, %e1_3799, %e2_3800, %e3_3801 = cute.get_leaves(%1371) : !cute.shape<"((2,2),(2,8))">
      %1372 = cute.get_stride(%lay_3797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3802, %e1_3803, %e2_3804, %e3_3805 = cute.get_leaves(%1372) : !cute.stride<"((2,4),(1,8))">
      %1373 = scf.if %1370 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1354) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,3)">
        cute.memref.store(%1354, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,3)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1354) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1354 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1354) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1354) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1354 : !memref_rmem_f32_3
      }
      %iter_3806 = cute.get_iter(%1373) : !memref_rmem_f32_3
      %lay_3807 = cute.get_layout(%1373) : !memref_rmem_f32_3
      %1374 = cute.get_shape(%lay_3807) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3808, %e1_3809, %e2_3810, %e3_3811 = cute.get_leaves(%1374) : !cute.shape<"((2,2),(2,8))">
      %1375 = cute.get_stride(%lay_3807) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3812, %e1_3813, %e2_3814, %e3_3815 = cute.get_leaves(%1375) : !cute.stride<"((2,4),(1,8))">
      %iter_3816 = cute.get_iter(%1373) : !memref_rmem_f32_3
      %iter_3817 = cute.get_iter(%1373) : !memref_rmem_f32_3
      %coord_3818 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %slice_3819 = cute.slice(%view_2232, %coord_3818) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)">
      %iter_3820 = cute.get_iter(%slice_3819) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3821, %e1_3822, %e2_3823, %e3_3824 = cute.get_leaves(%iter_3820) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1376 = cute.get_scalars(%e0_3821) : !cute.int_tuple<"?">
      %1377 = cute.get_scalars(%e1_3822) : !cute.int_tuple<"?">
      %1378 = cute.get_scalars(%e2_3823) : !cute.int_tuple<"?">
      %1379 = cute.get_scalars(%e3_3824) : !cute.int_tuple<"?{div=2}">
      %iter_3825 = cute.get_iter(%slice_3819) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3826, %e1_3827, %e2_3828, %e3_3829 = cute.get_leaves(%iter_3825) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1380 = cute.get_scalars(%e0_3826) : !cute.int_tuple<"?">
      %1381 = cute.get_scalars(%e1_3827) : !cute.int_tuple<"?">
      %1382 = cute.get_scalars(%e2_3828) : !cute.int_tuple<"?">
      %1383 = cute.get_scalars(%e3_3829) : !cute.int_tuple<"?{div=2}">
      %iter_3830 = cute.get_iter(%slice_3819) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3831, %e1_3832, %e2_3833, %e3_3834 = cute.get_leaves(%iter_3830) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1384 = cute.get_scalars(%e0_3831) : !cute.int_tuple<"?">
      %1385 = cute.get_scalars(%e1_3832) : !cute.int_tuple<"?">
      %1386 = cute.get_scalars(%e2_3833) : !cute.int_tuple<"?">
      %1387 = cute.get_scalars(%e3_3834) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3835 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3836 = cute.add_offset(%e3_3834, %int_tuple_3835) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1388 = cute.get_scalars(%tup_3836) : !cute.int_tuple<"?">
      %coord_3837 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3838 = cute.make_coord(%tup_3836) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1389 = cute.elem_less(%coord_3837, %coord_3838) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3839 = cute.get_layout(%1373) : !memref_rmem_f32_3
      %1390 = cute.get_shape(%lay_3839) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3840, %e1_3841, %e2_3842, %e3_3843 = cute.get_leaves(%1390) : !cute.shape<"((2,2),(2,8))">
      %1391 = cute.get_stride(%lay_3839) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3844, %e1_3845, %e2_3846, %e3_3847 = cute.get_leaves(%1391) : !cute.stride<"((2,4),(1,8))">
      %1392 = scf.if %1389 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1373) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,4)">
        cute.memref.store(%1373, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,4)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1373) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1373 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1373) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1373) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1373 : !memref_rmem_f32_3
      }
      %iter_3848 = cute.get_iter(%1392) : !memref_rmem_f32_3
      %lay_3849 = cute.get_layout(%1392) : !memref_rmem_f32_3
      %1393 = cute.get_shape(%lay_3849) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3850, %e1_3851, %e2_3852, %e3_3853 = cute.get_leaves(%1393) : !cute.shape<"((2,2),(2,8))">
      %1394 = cute.get_stride(%lay_3849) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3854, %e1_3855, %e2_3856, %e3_3857 = cute.get_leaves(%1394) : !cute.stride<"((2,4),(1,8))">
      %iter_3858 = cute.get_iter(%1392) : !memref_rmem_f32_3
      %iter_3859 = cute.get_iter(%1392) : !memref_rmem_f32_3
      %coord_3860 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %slice_3861 = cute.slice(%view_2232, %coord_3860) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)">
      %iter_3862 = cute.get_iter(%slice_3861) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3863, %e1_3864, %e2_3865, %e3_3866 = cute.get_leaves(%iter_3862) : !cute.int_tuple<"(?,?,?,?)">
      %1395 = cute.get_scalars(%e0_3863) : !cute.int_tuple<"?">
      %1396 = cute.get_scalars(%e1_3864) : !cute.int_tuple<"?">
      %1397 = cute.get_scalars(%e2_3865) : !cute.int_tuple<"?">
      %1398 = cute.get_scalars(%e3_3866) : !cute.int_tuple<"?">
      %iter_3867 = cute.get_iter(%slice_3861) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3868, %e1_3869, %e2_3870, %e3_3871 = cute.get_leaves(%iter_3867) : !cute.int_tuple<"(?,?,?,?)">
      %1399 = cute.get_scalars(%e0_3868) : !cute.int_tuple<"?">
      %1400 = cute.get_scalars(%e1_3869) : !cute.int_tuple<"?">
      %1401 = cute.get_scalars(%e2_3870) : !cute.int_tuple<"?">
      %1402 = cute.get_scalars(%e3_3871) : !cute.int_tuple<"?">
      %iter_3872 = cute.get_iter(%slice_3861) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3873, %e1_3874, %e2_3875, %e3_3876 = cute.get_leaves(%iter_3872) : !cute.int_tuple<"(?,?,?,?)">
      %1403 = cute.get_scalars(%e0_3873) : !cute.int_tuple<"?">
      %1404 = cute.get_scalars(%e1_3874) : !cute.int_tuple<"?">
      %1405 = cute.get_scalars(%e2_3875) : !cute.int_tuple<"?">
      %1406 = cute.get_scalars(%e3_3876) : !cute.int_tuple<"?">
      %int_tuple_3877 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3878 = cute.add_offset(%e3_3876, %int_tuple_3877) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1407 = cute.get_scalars(%tup_3878) : !cute.int_tuple<"?">
      %coord_3879 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3880 = cute.make_coord(%tup_3878) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1408 = cute.elem_less(%coord_3879, %coord_3880) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3881 = cute.get_layout(%1392) : !memref_rmem_f32_3
      %1409 = cute.get_shape(%lay_3881) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3882, %e1_3883, %e2_3884, %e3_3885 = cute.get_leaves(%1409) : !cute.shape<"((2,2),(2,8))">
      %1410 = cute.get_stride(%lay_3881) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3886, %e1_3887, %e2_3888, %e3_3889 = cute.get_leaves(%1410) : !cute.stride<"((2,4),(1,8))">
      %1411 = scf.if %1408 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1392) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,5)">
        cute.memref.store(%1392, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,5)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1392) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1392 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1392) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1392) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1392 : !memref_rmem_f32_3
      }
      %iter_3890 = cute.get_iter(%1411) : !memref_rmem_f32_3
      %lay_3891 = cute.get_layout(%1411) : !memref_rmem_f32_3
      %1412 = cute.get_shape(%lay_3891) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3892, %e1_3893, %e2_3894, %e3_3895 = cute.get_leaves(%1412) : !cute.shape<"((2,2),(2,8))">
      %1413 = cute.get_stride(%lay_3891) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3896, %e1_3897, %e2_3898, %e3_3899 = cute.get_leaves(%1413) : !cute.stride<"((2,4),(1,8))">
      %iter_3900 = cute.get_iter(%1411) : !memref_rmem_f32_3
      %iter_3901 = cute.get_iter(%1411) : !memref_rmem_f32_3
      %coord_3902 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %slice_3903 = cute.slice(%view_2232, %coord_3902) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)">
      %iter_3904 = cute.get_iter(%slice_3903) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3905, %e1_3906, %e2_3907, %e3_3908 = cute.get_leaves(%iter_3904) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1414 = cute.get_scalars(%e0_3905) : !cute.int_tuple<"?">
      %1415 = cute.get_scalars(%e1_3906) : !cute.int_tuple<"?">
      %1416 = cute.get_scalars(%e2_3907) : !cute.int_tuple<"?">
      %1417 = cute.get_scalars(%e3_3908) : !cute.int_tuple<"?{div=2}">
      %iter_3909 = cute.get_iter(%slice_3903) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%iter_3909) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1418 = cute.get_scalars(%e0_3910) : !cute.int_tuple<"?">
      %1419 = cute.get_scalars(%e1_3911) : !cute.int_tuple<"?">
      %1420 = cute.get_scalars(%e2_3912) : !cute.int_tuple<"?">
      %1421 = cute.get_scalars(%e3_3913) : !cute.int_tuple<"?{div=2}">
      %iter_3914 = cute.get_iter(%slice_3903) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3915, %e1_3916, %e2_3917, %e3_3918 = cute.get_leaves(%iter_3914) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1422 = cute.get_scalars(%e0_3915) : !cute.int_tuple<"?">
      %1423 = cute.get_scalars(%e1_3916) : !cute.int_tuple<"?">
      %1424 = cute.get_scalars(%e2_3917) : !cute.int_tuple<"?">
      %1425 = cute.get_scalars(%e3_3918) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3919 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3920 = cute.add_offset(%e3_3918, %int_tuple_3919) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1426 = cute.get_scalars(%tup_3920) : !cute.int_tuple<"?">
      %coord_3921 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3922 = cute.make_coord(%tup_3920) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1427 = cute.elem_less(%coord_3921, %coord_3922) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3923 = cute.get_layout(%1411) : !memref_rmem_f32_3
      %1428 = cute.get_shape(%lay_3923) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3924, %e1_3925, %e2_3926, %e3_3927 = cute.get_leaves(%1428) : !cute.shape<"((2,2),(2,8))">
      %1429 = cute.get_stride(%lay_3923) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3928, %e1_3929, %e2_3930, %e3_3931 = cute.get_leaves(%1429) : !cute.stride<"((2,4),(1,8))">
      %1430 = scf.if %1427 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1411) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,6)">
        cute.memref.store(%1411, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,6)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1411) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1411 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1411) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1411) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1411 : !memref_rmem_f32_3
      }
      %iter_3932 = cute.get_iter(%1430) : !memref_rmem_f32_3
      %lay_3933 = cute.get_layout(%1430) : !memref_rmem_f32_3
      %1431 = cute.get_shape(%lay_3933) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3934, %e1_3935, %e2_3936, %e3_3937 = cute.get_leaves(%1431) : !cute.shape<"((2,2),(2,8))">
      %1432 = cute.get_stride(%lay_3933) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3938, %e1_3939, %e2_3940, %e3_3941 = cute.get_leaves(%1432) : !cute.stride<"((2,4),(1,8))">
      %iter_3942 = cute.get_iter(%1430) : !memref_rmem_f32_3
      %iter_3943 = cute.get_iter(%1430) : !memref_rmem_f32_3
      %coord_3944 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %slice_3945 = cute.slice(%view_2232, %coord_3944) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)">
      %iter_3946 = cute.get_iter(%slice_3945) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3947, %e1_3948, %e2_3949, %e3_3950 = cute.get_leaves(%iter_3946) : !cute.int_tuple<"(?,?,?,?)">
      %1433 = cute.get_scalars(%e0_3947) : !cute.int_tuple<"?">
      %1434 = cute.get_scalars(%e1_3948) : !cute.int_tuple<"?">
      %1435 = cute.get_scalars(%e2_3949) : !cute.int_tuple<"?">
      %1436 = cute.get_scalars(%e3_3950) : !cute.int_tuple<"?">
      %iter_3951 = cute.get_iter(%slice_3945) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3952, %e1_3953, %e2_3954, %e3_3955 = cute.get_leaves(%iter_3951) : !cute.int_tuple<"(?,?,?,?)">
      %1437 = cute.get_scalars(%e0_3952) : !cute.int_tuple<"?">
      %1438 = cute.get_scalars(%e1_3953) : !cute.int_tuple<"?">
      %1439 = cute.get_scalars(%e2_3954) : !cute.int_tuple<"?">
      %1440 = cute.get_scalars(%e3_3955) : !cute.int_tuple<"?">
      %iter_3956 = cute.get_iter(%slice_3945) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3957, %e1_3958, %e2_3959, %e3_3960 = cute.get_leaves(%iter_3956) : !cute.int_tuple<"(?,?,?,?)">
      %1441 = cute.get_scalars(%e0_3957) : !cute.int_tuple<"?">
      %1442 = cute.get_scalars(%e1_3958) : !cute.int_tuple<"?">
      %1443 = cute.get_scalars(%e2_3959) : !cute.int_tuple<"?">
      %1444 = cute.get_scalars(%e3_3960) : !cute.int_tuple<"?">
      %int_tuple_3961 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3962 = cute.add_offset(%e3_3960, %int_tuple_3961) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1445 = cute.get_scalars(%tup_3962) : !cute.int_tuple<"?">
      %coord_3963 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3964 = cute.make_coord(%tup_3962) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1446 = cute.elem_less(%coord_3963, %coord_3964) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3965 = cute.get_layout(%1430) : !memref_rmem_f32_3
      %1447 = cute.get_shape(%lay_3965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3966, %e1_3967, %e2_3968, %e3_3969 = cute.get_leaves(%1447) : !cute.shape<"((2,2),(2,8))">
      %1448 = cute.get_stride(%lay_3965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3970, %e1_3971, %e2_3972, %e3_3973 = cute.get_leaves(%1448) : !cute.stride<"((2,4),(1,8))">
      %1449 = scf.if %1446 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1430) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,7)">
        cute.memref.store(%1430, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,7)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1430) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1430 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1430) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1430) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1430 : !memref_rmem_f32_3
      }
      %iter_3974 = cute.get_iter(%1449) : !memref_rmem_f32_3
      %lay_3975 = cute.get_layout(%1449) : !memref_rmem_f32_3
      %1450 = cute.get_shape(%lay_3975) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3976, %e1_3977, %e2_3978, %e3_3979 = cute.get_leaves(%1450) : !cute.shape<"((2,2),(2,8))">
      %1451 = cute.get_stride(%lay_3975) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%1451) : !cute.stride<"((2,4),(1,8))">
      %iter_3984 = cute.get_iter(%1449) : !memref_rmem_f32_3
      %iter_3985 = cute.get_iter(%1449) : !memref_rmem_f32_3
      %coord_3986 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %slice_3987 = cute.slice(%view_2232, %coord_3986) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)">
      %iter_3988 = cute.get_iter(%slice_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3989, %e1_3990, %e2_3991, %e3_3992 = cute.get_leaves(%iter_3988) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1452 = cute.get_scalars(%e0_3989) : !cute.int_tuple<"?">
      %1453 = cute.get_scalars(%e1_3990) : !cute.int_tuple<"?">
      %1454 = cute.get_scalars(%e2_3991) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e3_3992) : !cute.int_tuple<"?{div=2}">
      %iter_3993 = cute.get_iter(%slice_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3994, %e1_3995, %e2_3996, %e3_3997 = cute.get_leaves(%iter_3993) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1456 = cute.get_scalars(%e0_3994) : !cute.int_tuple<"?">
      %1457 = cute.get_scalars(%e1_3995) : !cute.int_tuple<"?">
      %1458 = cute.get_scalars(%e2_3996) : !cute.int_tuple<"?">
      %1459 = cute.get_scalars(%e3_3997) : !cute.int_tuple<"?{div=2}">
      %iter_3998 = cute.get_iter(%slice_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3999, %e1_4000, %e2_4001, %e3_4002 = cute.get_leaves(%iter_3998) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1460 = cute.get_scalars(%e0_3999) : !cute.int_tuple<"?">
      %1461 = cute.get_scalars(%e1_4000) : !cute.int_tuple<"?">
      %1462 = cute.get_scalars(%e2_4001) : !cute.int_tuple<"?">
      %1463 = cute.get_scalars(%e3_4002) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4003 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4004 = cute.add_offset(%e3_4002, %int_tuple_4003) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1464 = cute.get_scalars(%tup_4004) : !cute.int_tuple<"?">
      %coord_4005 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4006 = cute.make_coord(%tup_4004) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1465 = cute.elem_less(%coord_4005, %coord_4006) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4007 = cute.get_layout(%1449) : !memref_rmem_f32_3
      %1466 = cute.get_shape(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4008, %e1_4009, %e2_4010, %e3_4011 = cute.get_leaves(%1466) : !cute.shape<"((2,2),(2,8))">
      %1467 = cute.get_stride(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4012, %e1_4013, %e2_4014, %e3_4015 = cute.get_leaves(%1467) : !cute.stride<"((2,4),(1,8))">
      %1468 = scf.if %1465 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1449) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,8)">
        cute.memref.store(%1449, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,8)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1449) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1449 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1449) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1449) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1449 : !memref_rmem_f32_3
      }
      %iter_4016 = cute.get_iter(%1468) : !memref_rmem_f32_3
      %lay_4017 = cute.get_layout(%1468) : !memref_rmem_f32_3
      %1469 = cute.get_shape(%lay_4017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4018, %e1_4019, %e2_4020, %e3_4021 = cute.get_leaves(%1469) : !cute.shape<"((2,2),(2,8))">
      %1470 = cute.get_stride(%lay_4017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4022, %e1_4023, %e2_4024, %e3_4025 = cute.get_leaves(%1470) : !cute.stride<"((2,4),(1,8))">
      %iter_4026 = cute.get_iter(%1468) : !memref_rmem_f32_3
      %iter_4027 = cute.get_iter(%1468) : !memref_rmem_f32_3
      %coord_4028 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %slice_4029 = cute.slice(%view_2232, %coord_4028) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)">
      %iter_4030 = cute.get_iter(%slice_4029) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4031, %e1_4032, %e2_4033, %e3_4034 = cute.get_leaves(%iter_4030) : !cute.int_tuple<"(?,?,?,?)">
      %1471 = cute.get_scalars(%e0_4031) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e1_4032) : !cute.int_tuple<"?">
      %1473 = cute.get_scalars(%e2_4033) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e3_4034) : !cute.int_tuple<"?">
      %iter_4035 = cute.get_iter(%slice_4029) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4036, %e1_4037, %e2_4038, %e3_4039 = cute.get_leaves(%iter_4035) : !cute.int_tuple<"(?,?,?,?)">
      %1475 = cute.get_scalars(%e0_4036) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e1_4037) : !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%e2_4038) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e3_4039) : !cute.int_tuple<"?">
      %iter_4040 = cute.get_iter(%slice_4029) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4041, %e1_4042, %e2_4043, %e3_4044 = cute.get_leaves(%iter_4040) : !cute.int_tuple<"(?,?,?,?)">
      %1479 = cute.get_scalars(%e0_4041) : !cute.int_tuple<"?">
      %1480 = cute.get_scalars(%e1_4042) : !cute.int_tuple<"?">
      %1481 = cute.get_scalars(%e2_4043) : !cute.int_tuple<"?">
      %1482 = cute.get_scalars(%e3_4044) : !cute.int_tuple<"?">
      %int_tuple_4045 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4046 = cute.add_offset(%e3_4044, %int_tuple_4045) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1483 = cute.get_scalars(%tup_4046) : !cute.int_tuple<"?">
      %coord_4047 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4048 = cute.make_coord(%tup_4046) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1484 = cute.elem_less(%coord_4047, %coord_4048) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4049 = cute.get_layout(%1468) : !memref_rmem_f32_3
      %1485 = cute.get_shape(%lay_4049) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4050, %e1_4051, %e2_4052, %e3_4053 = cute.get_leaves(%1485) : !cute.shape<"((2,2),(2,8))">
      %1486 = cute.get_stride(%lay_4049) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4054, %e1_4055, %e2_4056, %e3_4057 = cute.get_leaves(%1486) : !cute.stride<"((2,4),(1,8))">
      %1487 = scf.if %1484 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1468) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,9)">
        cute.memref.store(%1468, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,9)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1468) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1468 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1468) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1468) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1468 : !memref_rmem_f32_3
      }
      %iter_4058 = cute.get_iter(%1487) : !memref_rmem_f32_3
      %lay_4059 = cute.get_layout(%1487) : !memref_rmem_f32_3
      %1488 = cute.get_shape(%lay_4059) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4060, %e1_4061, %e2_4062, %e3_4063 = cute.get_leaves(%1488) : !cute.shape<"((2,2),(2,8))">
      %1489 = cute.get_stride(%lay_4059) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4064, %e1_4065, %e2_4066, %e3_4067 = cute.get_leaves(%1489) : !cute.stride<"((2,4),(1,8))">
      %iter_4068 = cute.get_iter(%1487) : !memref_rmem_f32_3
      %iter_4069 = cute.get_iter(%1487) : !memref_rmem_f32_3
      %coord_4070 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %slice_4071 = cute.slice(%view_2232, %coord_4070) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)">
      %iter_4072 = cute.get_iter(%slice_4071) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%iter_4072) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1490 = cute.get_scalars(%e0_4073) : !cute.int_tuple<"?">
      %1491 = cute.get_scalars(%e1_4074) : !cute.int_tuple<"?">
      %1492 = cute.get_scalars(%e2_4075) : !cute.int_tuple<"?">
      %1493 = cute.get_scalars(%e3_4076) : !cute.int_tuple<"?{div=2}">
      %iter_4077 = cute.get_iter(%slice_4071) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4078, %e1_4079, %e2_4080, %e3_4081 = cute.get_leaves(%iter_4077) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1494 = cute.get_scalars(%e0_4078) : !cute.int_tuple<"?">
      %1495 = cute.get_scalars(%e1_4079) : !cute.int_tuple<"?">
      %1496 = cute.get_scalars(%e2_4080) : !cute.int_tuple<"?">
      %1497 = cute.get_scalars(%e3_4081) : !cute.int_tuple<"?{div=2}">
      %iter_4082 = cute.get_iter(%slice_4071) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4083, %e1_4084, %e2_4085, %e3_4086 = cute.get_leaves(%iter_4082) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1498 = cute.get_scalars(%e0_4083) : !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%e1_4084) : !cute.int_tuple<"?">
      %1500 = cute.get_scalars(%e2_4085) : !cute.int_tuple<"?">
      %1501 = cute.get_scalars(%e3_4086) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4087 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4088 = cute.add_offset(%e3_4086, %int_tuple_4087) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1502 = cute.get_scalars(%tup_4088) : !cute.int_tuple<"?">
      %coord_4089 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4090 = cute.make_coord(%tup_4088) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1503 = cute.elem_less(%coord_4089, %coord_4090) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4091 = cute.get_layout(%1487) : !memref_rmem_f32_3
      %1504 = cute.get_shape(%lay_4091) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4092, %e1_4093, %e2_4094, %e3_4095 = cute.get_leaves(%1504) : !cute.shape<"((2,2),(2,8))">
      %1505 = cute.get_stride(%lay_4091) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4096, %e1_4097, %e2_4098, %e3_4099 = cute.get_leaves(%1505) : !cute.stride<"((2,4),(1,8))">
      %1506 = scf.if %1503 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1487) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,10)">
        cute.memref.store(%1487, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,10)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1487) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1487 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1487) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1487) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1487 : !memref_rmem_f32_3
      }
      %iter_4100 = cute.get_iter(%1506) : !memref_rmem_f32_3
      %lay_4101 = cute.get_layout(%1506) : !memref_rmem_f32_3
      %1507 = cute.get_shape(%lay_4101) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4102, %e1_4103, %e2_4104, %e3_4105 = cute.get_leaves(%1507) : !cute.shape<"((2,2),(2,8))">
      %1508 = cute.get_stride(%lay_4101) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4106, %e1_4107, %e2_4108, %e3_4109 = cute.get_leaves(%1508) : !cute.stride<"((2,4),(1,8))">
      %iter_4110 = cute.get_iter(%1506) : !memref_rmem_f32_3
      %iter_4111 = cute.get_iter(%1506) : !memref_rmem_f32_3
      %coord_4112 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %slice_4113 = cute.slice(%view_2232, %coord_4112) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)">
      %iter_4114 = cute.get_iter(%slice_4113) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4115, %e1_4116, %e2_4117, %e3_4118 = cute.get_leaves(%iter_4114) : !cute.int_tuple<"(?,?,?,?)">
      %1509 = cute.get_scalars(%e0_4115) : !cute.int_tuple<"?">
      %1510 = cute.get_scalars(%e1_4116) : !cute.int_tuple<"?">
      %1511 = cute.get_scalars(%e2_4117) : !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%e3_4118) : !cute.int_tuple<"?">
      %iter_4119 = cute.get_iter(%slice_4113) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4120, %e1_4121, %e2_4122, %e3_4123 = cute.get_leaves(%iter_4119) : !cute.int_tuple<"(?,?,?,?)">
      %1513 = cute.get_scalars(%e0_4120) : !cute.int_tuple<"?">
      %1514 = cute.get_scalars(%e1_4121) : !cute.int_tuple<"?">
      %1515 = cute.get_scalars(%e2_4122) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e3_4123) : !cute.int_tuple<"?">
      %iter_4124 = cute.get_iter(%slice_4113) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4125, %e1_4126, %e2_4127, %e3_4128 = cute.get_leaves(%iter_4124) : !cute.int_tuple<"(?,?,?,?)">
      %1517 = cute.get_scalars(%e0_4125) : !cute.int_tuple<"?">
      %1518 = cute.get_scalars(%e1_4126) : !cute.int_tuple<"?">
      %1519 = cute.get_scalars(%e2_4127) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e3_4128) : !cute.int_tuple<"?">
      %int_tuple_4129 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4130 = cute.add_offset(%e3_4128, %int_tuple_4129) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%tup_4130) : !cute.int_tuple<"?">
      %coord_4131 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4132 = cute.make_coord(%tup_4130) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1522 = cute.elem_less(%coord_4131, %coord_4132) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4133 = cute.get_layout(%1506) : !memref_rmem_f32_3
      %1523 = cute.get_shape(%lay_4133) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4134, %e1_4135, %e2_4136, %e3_4137 = cute.get_leaves(%1523) : !cute.shape<"((2,2),(2,8))">
      %1524 = cute.get_stride(%lay_4133) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4138, %e1_4139, %e2_4140, %e3_4141 = cute.get_leaves(%1524) : !cute.stride<"((2,4),(1,8))">
      %1525 = scf.if %1522 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1506) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,11)">
        cute.memref.store(%1506, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,11)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1506) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1506 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1506) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1506) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1506 : !memref_rmem_f32_3
      }
      %iter_4142 = cute.get_iter(%1525) : !memref_rmem_f32_3
      %lay_4143 = cute.get_layout(%1525) : !memref_rmem_f32_3
      %1526 = cute.get_shape(%lay_4143) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4144, %e1_4145, %e2_4146, %e3_4147 = cute.get_leaves(%1526) : !cute.shape<"((2,2),(2,8))">
      %1527 = cute.get_stride(%lay_4143) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4148, %e1_4149, %e2_4150, %e3_4151 = cute.get_leaves(%1527) : !cute.stride<"((2,4),(1,8))">
      %iter_4152 = cute.get_iter(%1525) : !memref_rmem_f32_3
      %iter_4153 = cute.get_iter(%1525) : !memref_rmem_f32_3
      %coord_4154 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %slice_4155 = cute.slice(%view_2232, %coord_4154) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)">
      %iter_4156 = cute.get_iter(%slice_4155) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4157, %e1_4158, %e2_4159, %e3_4160 = cute.get_leaves(%iter_4156) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1528 = cute.get_scalars(%e0_4157) : !cute.int_tuple<"?">
      %1529 = cute.get_scalars(%e1_4158) : !cute.int_tuple<"?">
      %1530 = cute.get_scalars(%e2_4159) : !cute.int_tuple<"?">
      %1531 = cute.get_scalars(%e3_4160) : !cute.int_tuple<"?{div=2}">
      %iter_4161 = cute.get_iter(%slice_4155) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4162, %e1_4163, %e2_4164, %e3_4165 = cute.get_leaves(%iter_4161) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1532 = cute.get_scalars(%e0_4162) : !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%e1_4163) : !cute.int_tuple<"?">
      %1534 = cute.get_scalars(%e2_4164) : !cute.int_tuple<"?">
      %1535 = cute.get_scalars(%e3_4165) : !cute.int_tuple<"?{div=2}">
      %iter_4166 = cute.get_iter(%slice_4155) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4167, %e1_4168, %e2_4169, %e3_4170 = cute.get_leaves(%iter_4166) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1536 = cute.get_scalars(%e0_4167) : !cute.int_tuple<"?">
      %1537 = cute.get_scalars(%e1_4168) : !cute.int_tuple<"?">
      %1538 = cute.get_scalars(%e2_4169) : !cute.int_tuple<"?">
      %1539 = cute.get_scalars(%e3_4170) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4171 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4172 = cute.add_offset(%e3_4170, %int_tuple_4171) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1540 = cute.get_scalars(%tup_4172) : !cute.int_tuple<"?">
      %coord_4173 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4174 = cute.make_coord(%tup_4172) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1541 = cute.elem_less(%coord_4173, %coord_4174) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4175 = cute.get_layout(%1525) : !memref_rmem_f32_3
      %1542 = cute.get_shape(%lay_4175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4176, %e1_4177, %e2_4178, %e3_4179 = cute.get_leaves(%1542) : !cute.shape<"((2,2),(2,8))">
      %1543 = cute.get_stride(%lay_4175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4180, %e1_4181, %e2_4182, %e3_4183 = cute.get_leaves(%1543) : !cute.stride<"((2,4),(1,8))">
      %1544 = scf.if %1541 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1525) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,12)">
        cute.memref.store(%1525, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,12)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1525) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1525 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1525) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1525) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1525 : !memref_rmem_f32_3
      }
      %iter_4184 = cute.get_iter(%1544) : !memref_rmem_f32_3
      %lay_4185 = cute.get_layout(%1544) : !memref_rmem_f32_3
      %1545 = cute.get_shape(%lay_4185) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4186, %e1_4187, %e2_4188, %e3_4189 = cute.get_leaves(%1545) : !cute.shape<"((2,2),(2,8))">
      %1546 = cute.get_stride(%lay_4185) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4190, %e1_4191, %e2_4192, %e3_4193 = cute.get_leaves(%1546) : !cute.stride<"((2,4),(1,8))">
      %iter_4194 = cute.get_iter(%1544) : !memref_rmem_f32_3
      %iter_4195 = cute.get_iter(%1544) : !memref_rmem_f32_3
      %coord_4196 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %slice_4197 = cute.slice(%view_2232, %coord_4196) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)">
      %iter_4198 = cute.get_iter(%slice_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4199, %e1_4200, %e2_4201, %e3_4202 = cute.get_leaves(%iter_4198) : !cute.int_tuple<"(?,?,?,?)">
      %1547 = cute.get_scalars(%e0_4199) : !cute.int_tuple<"?">
      %1548 = cute.get_scalars(%e1_4200) : !cute.int_tuple<"?">
      %1549 = cute.get_scalars(%e2_4201) : !cute.int_tuple<"?">
      %1550 = cute.get_scalars(%e3_4202) : !cute.int_tuple<"?">
      %iter_4203 = cute.get_iter(%slice_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4204, %e1_4205, %e2_4206, %e3_4207 = cute.get_leaves(%iter_4203) : !cute.int_tuple<"(?,?,?,?)">
      %1551 = cute.get_scalars(%e0_4204) : !cute.int_tuple<"?">
      %1552 = cute.get_scalars(%e1_4205) : !cute.int_tuple<"?">
      %1553 = cute.get_scalars(%e2_4206) : !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%e3_4207) : !cute.int_tuple<"?">
      %iter_4208 = cute.get_iter(%slice_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4209, %e1_4210, %e2_4211, %e3_4212 = cute.get_leaves(%iter_4208) : !cute.int_tuple<"(?,?,?,?)">
      %1555 = cute.get_scalars(%e0_4209) : !cute.int_tuple<"?">
      %1556 = cute.get_scalars(%e1_4210) : !cute.int_tuple<"?">
      %1557 = cute.get_scalars(%e2_4211) : !cute.int_tuple<"?">
      %1558 = cute.get_scalars(%e3_4212) : !cute.int_tuple<"?">
      %int_tuple_4213 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4214 = cute.add_offset(%e3_4212, %int_tuple_4213) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1559 = cute.get_scalars(%tup_4214) : !cute.int_tuple<"?">
      %coord_4215 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4216 = cute.make_coord(%tup_4214) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1560 = cute.elem_less(%coord_4215, %coord_4216) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4217 = cute.get_layout(%1544) : !memref_rmem_f32_3
      %1561 = cute.get_shape(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4218, %e1_4219, %e2_4220, %e3_4221 = cute.get_leaves(%1561) : !cute.shape<"((2,2),(2,8))">
      %1562 = cute.get_stride(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4222, %e1_4223, %e2_4224, %e3_4225 = cute.get_leaves(%1562) : !cute.stride<"((2,4),(1,8))">
      %1563 = scf.if %1560 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1544) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,13)">
        cute.memref.store(%1544, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,13)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1544) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1544 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1544) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1544) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1544 : !memref_rmem_f32_3
      }
      %iter_4226 = cute.get_iter(%1563) : !memref_rmem_f32_3
      %lay_4227 = cute.get_layout(%1563) : !memref_rmem_f32_3
      %1564 = cute.get_shape(%lay_4227) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4228, %e1_4229, %e2_4230, %e3_4231 = cute.get_leaves(%1564) : !cute.shape<"((2,2),(2,8))">
      %1565 = cute.get_stride(%lay_4227) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4232, %e1_4233, %e2_4234, %e3_4235 = cute.get_leaves(%1565) : !cute.stride<"((2,4),(1,8))">
      %iter_4236 = cute.get_iter(%1563) : !memref_rmem_f32_3
      %iter_4237 = cute.get_iter(%1563) : !memref_rmem_f32_3
      %coord_4238 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %slice_4239 = cute.slice(%view_2232, %coord_4238) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)">
      %iter_4240 = cute.get_iter(%slice_4239) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4241, %e1_4242, %e2_4243, %e3_4244 = cute.get_leaves(%iter_4240) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1566 = cute.get_scalars(%e0_4241) : !cute.int_tuple<"?">
      %1567 = cute.get_scalars(%e1_4242) : !cute.int_tuple<"?">
      %1568 = cute.get_scalars(%e2_4243) : !cute.int_tuple<"?">
      %1569 = cute.get_scalars(%e3_4244) : !cute.int_tuple<"?{div=2}">
      %iter_4245 = cute.get_iter(%slice_4239) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4246, %e1_4247, %e2_4248, %e3_4249 = cute.get_leaves(%iter_4245) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1570 = cute.get_scalars(%e0_4246) : !cute.int_tuple<"?">
      %1571 = cute.get_scalars(%e1_4247) : !cute.int_tuple<"?">
      %1572 = cute.get_scalars(%e2_4248) : !cute.int_tuple<"?">
      %1573 = cute.get_scalars(%e3_4249) : !cute.int_tuple<"?{div=2}">
      %iter_4250 = cute.get_iter(%slice_4239) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4251, %e1_4252, %e2_4253, %e3_4254 = cute.get_leaves(%iter_4250) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1574 = cute.get_scalars(%e0_4251) : !cute.int_tuple<"?">
      %1575 = cute.get_scalars(%e1_4252) : !cute.int_tuple<"?">
      %1576 = cute.get_scalars(%e2_4253) : !cute.int_tuple<"?">
      %1577 = cute.get_scalars(%e3_4254) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4255 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4256 = cute.add_offset(%e3_4254, %int_tuple_4255) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1578 = cute.get_scalars(%tup_4256) : !cute.int_tuple<"?">
      %coord_4257 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4258 = cute.make_coord(%tup_4256) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1579 = cute.elem_less(%coord_4257, %coord_4258) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4259 = cute.get_layout(%1563) : !memref_rmem_f32_3
      %1580 = cute.get_shape(%lay_4259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4260, %e1_4261, %e2_4262, %e3_4263 = cute.get_leaves(%1580) : !cute.shape<"((2,2),(2,8))">
      %1581 = cute.get_stride(%lay_4259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4264, %e1_4265, %e2_4266, %e3_4267 = cute.get_leaves(%1581) : !cute.stride<"((2,4),(1,8))">
      %1582 = scf.if %1579 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1563) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,14)">
        cute.memref.store(%1563, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,14)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1563) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1563 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1563) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1563) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1563 : !memref_rmem_f32_3
      }
      %iter_4268 = cute.get_iter(%1582) : !memref_rmem_f32_3
      %lay_4269 = cute.get_layout(%1582) : !memref_rmem_f32_3
      %1583 = cute.get_shape(%lay_4269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4270, %e1_4271, %e2_4272, %e3_4273 = cute.get_leaves(%1583) : !cute.shape<"((2,2),(2,8))">
      %1584 = cute.get_stride(%lay_4269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4274, %e1_4275, %e2_4276, %e3_4277 = cute.get_leaves(%1584) : !cute.stride<"((2,4),(1,8))">
      %iter_4278 = cute.get_iter(%1582) : !memref_rmem_f32_3
      %iter_4279 = cute.get_iter(%1582) : !memref_rmem_f32_3
      %coord_4280 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %slice_4281 = cute.slice(%view_2232, %coord_4280) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)">
      %iter_4282 = cute.get_iter(%slice_4281) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4283, %e1_4284, %e2_4285, %e3_4286 = cute.get_leaves(%iter_4282) : !cute.int_tuple<"(?,?,?,?)">
      %1585 = cute.get_scalars(%e0_4283) : !cute.int_tuple<"?">
      %1586 = cute.get_scalars(%e1_4284) : !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%e2_4285) : !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%e3_4286) : !cute.int_tuple<"?">
      %iter_4287 = cute.get_iter(%slice_4281) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4288, %e1_4289, %e2_4290, %e3_4291 = cute.get_leaves(%iter_4287) : !cute.int_tuple<"(?,?,?,?)">
      %1589 = cute.get_scalars(%e0_4288) : !cute.int_tuple<"?">
      %1590 = cute.get_scalars(%e1_4289) : !cute.int_tuple<"?">
      %1591 = cute.get_scalars(%e2_4290) : !cute.int_tuple<"?">
      %1592 = cute.get_scalars(%e3_4291) : !cute.int_tuple<"?">
      %iter_4292 = cute.get_iter(%slice_4281) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4293, %e1_4294, %e2_4295, %e3_4296 = cute.get_leaves(%iter_4292) : !cute.int_tuple<"(?,?,?,?)">
      %1593 = cute.get_scalars(%e0_4293) : !cute.int_tuple<"?">
      %1594 = cute.get_scalars(%e1_4294) : !cute.int_tuple<"?">
      %1595 = cute.get_scalars(%e2_4295) : !cute.int_tuple<"?">
      %1596 = cute.get_scalars(%e3_4296) : !cute.int_tuple<"?">
      %int_tuple_4297 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4298 = cute.add_offset(%e3_4296, %int_tuple_4297) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1597 = cute.get_scalars(%tup_4298) : !cute.int_tuple<"?">
      %coord_4299 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4300 = cute.make_coord(%tup_4298) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1598 = cute.elem_less(%coord_4299, %coord_4300) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4301 = cute.get_layout(%1582) : !memref_rmem_f32_3
      %1599 = cute.get_shape(%lay_4301) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4302, %e1_4303, %e2_4304, %e3_4305 = cute.get_leaves(%1599) : !cute.shape<"((2,2),(2,8))">
      %1600 = cute.get_stride(%lay_4301) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4306, %e1_4307, %e2_4308, %e3_4309 = cute.get_leaves(%1600) : !cute.stride<"((2,4),(1,8))">
      %1601 = scf.if %1598 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1582) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(2,15)">
        cute.memref.store(%1582, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(2,15)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1582) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1582 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1582) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1582) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1582 : !memref_rmem_f32_3
      }
      %iter_4310 = cute.get_iter(%1601) : !memref_rmem_f32_3
      %lay_4311 = cute.get_layout(%1601) : !memref_rmem_f32_3
      %1602 = cute.get_shape(%lay_4311) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4312, %e1_4313, %e2_4314, %e3_4315 = cute.get_leaves(%1602) : !cute.shape<"((2,2),(2,8))">
      %1603 = cute.get_stride(%lay_4311) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4316, %e1_4317, %e2_4318, %e3_4319 = cute.get_leaves(%1603) : !cute.stride<"((2,4),(1,8))">
      %iter_4320 = cute.get_iter(%1601) : !memref_rmem_f32_3
      %iter_4321 = cute.get_iter(%1601) : !memref_rmem_f32_3
      %coord_4322 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %slice_4323 = cute.slice(%1601, %coord_4322) : !memref_rmem_f32_3, !cute.coord<"(2,_)">
      %iter_4324 = cute.get_iter(%slice_4323) : !memref_rmem_f32_7
      %lay_4325 = cute.get_layout(%slice_4323) : !memref_rmem_f32_7
      %1604 = cute.get_shape(%lay_4325) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4326, %e1_4327 = cute.get_leaves(%1604) : !cute.shape<"((2,8))">
      %1605 = cute.memref.load_vec %slice_4323, row_major : !memref_rmem_f32_7
      %cst_4328 = arith.constant 0xFF800000 : f32
      %1606 = vector.reduction <maximumf>, %1605, %cst_4328 : vector<16xf32> into f32
      %c-1_i32_4329 = arith.constant -1 : i32
      %c2_i32_4330 = arith.constant 2 : i32
      %c31_i32_4331 = arith.constant 31 : i32
      %1607 = nvvm.shfl.sync  bfly %c-1_i32_4329, %1606, %c2_i32_4330, %c31_i32_4331 : f32 -> f32
      %1608 = nvvm.fmax %1606, %1607
      %c-1_i32_4332 = arith.constant -1 : i32
      %c1_i32_4333 = arith.constant 1 : i32
      %c31_i32_4334 = arith.constant 31 : i32
      %1609 = nvvm.shfl.sync  bfly %c-1_i32_4332, %1608, %c1_i32_4333, %c31_i32_4334 : f32 -> f32
      %1610 = nvvm.fmax %1608, %1609
      %1611 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1612 = arith.mulf %1605, %1611 : vector<16xf32>
      %1613 = arith.mulf %1610, %arg4 : f32
      %1614 = vector.broadcast %1613 : f32 to vector<16xf32>
      %1615 = arith.subf %1612, %1614 : vector<16xf32>
      %1616 = math.exp2 %1615 fastmath<fast> : vector<16xf32>
      %cst_4335 = arith.constant 0.000000e+00 : f32
      %1617 = vector.reduction <add>, %1616, %cst_4335 : vector<16xf32> into f32
      %coord_4336 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_906, %coord_4336, %1610) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_4337 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_911, %coord_4337, %1617) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_4338 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %slice_4339 = cute.slice(%1601, %coord_4338) : !memref_rmem_f32_3, !cute.coord<"(2,_)">
      %iter_4340 = cute.get_iter(%slice_4339) : !memref_rmem_f32_7
      %lay_4341 = cute.get_layout(%slice_4339) : !memref_rmem_f32_7
      %1618 = cute.get_shape(%lay_4341) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4342, %e1_4343 = cute.get_leaves(%1618) : !cute.shape<"((2,8))">
      %int_tuple_4344 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4345 = cute.size(%int_tuple_4344) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4346 = cute.get_leaves(%sz_4345) : !cute.int_tuple<"16">
      %int_tuple_4347 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4348 = cute.size(%int_tuple_4347) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4349 = cute.get_leaves(%sz_4348) : !cute.int_tuple<"16">
      cute.memref.store_vec %1616, %slice_4339, row_major : !memref_rmem_f32_7
      %int_tuple_4350 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_4351 = cute.size(%int_tuple_4350) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_4352 = cute.get_leaves(%sz_4351) : !cute.int_tuple<"16">
      %coord_4353 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %slice_4354 = cute.slice(%view_2232, %coord_4353) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)">
      %iter_4355 = cute.get_iter(%slice_4354) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4356, %e1_4357, %e2_4358, %e3_4359 = cute.get_leaves(%iter_4355) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1619 = cute.get_scalars(%e0_4356) : !cute.int_tuple<"?">
      %1620 = cute.get_scalars(%e1_4357) : !cute.int_tuple<"?">
      %1621 = cute.get_scalars(%e2_4358) : !cute.int_tuple<"?">
      %1622 = cute.get_scalars(%e3_4359) : !cute.int_tuple<"?{div=2}">
      %iter_4360 = cute.get_iter(%slice_4354) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4361, %e1_4362, %e2_4363, %e3_4364 = cute.get_leaves(%iter_4360) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1623 = cute.get_scalars(%e0_4361) : !cute.int_tuple<"?">
      %1624 = cute.get_scalars(%e1_4362) : !cute.int_tuple<"?">
      %1625 = cute.get_scalars(%e2_4363) : !cute.int_tuple<"?">
      %1626 = cute.get_scalars(%e3_4364) : !cute.int_tuple<"?{div=2}">
      %iter_4365 = cute.get_iter(%slice_4354) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4366, %e1_4367, %e2_4368, %e3_4369 = cute.get_leaves(%iter_4365) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1627 = cute.get_scalars(%e0_4366) : !cute.int_tuple<"?">
      %1628 = cute.get_scalars(%e1_4367) : !cute.int_tuple<"?">
      %1629 = cute.get_scalars(%e2_4368) : !cute.int_tuple<"?">
      %1630 = cute.get_scalars(%e3_4369) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4370 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4371 = cute.add_offset(%e3_4369, %int_tuple_4370) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1631 = cute.get_scalars(%tup_4371) : !cute.int_tuple<"?">
      %coord_4372 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4373 = cute.make_coord(%tup_4371) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1632 = cute.elem_less(%coord_4372, %coord_4373) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4374 = cute.get_layout(%1601) : !memref_rmem_f32_3
      %1633 = cute.get_shape(%lay_4374) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4375, %e1_4376, %e2_4377, %e3_4378 = cute.get_leaves(%1633) : !cute.shape<"((2,2),(2,8))">
      %1634 = cute.get_stride(%lay_4374) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4379, %e1_4380, %e2_4381, %e3_4382 = cute.get_leaves(%1634) : !cute.stride<"((2,4),(1,8))">
      %1635 = scf.if %1632 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1601) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,0)">
        cute.memref.store(%1601, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,0)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1601) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1601 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1601) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1601) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1601 : !memref_rmem_f32_3
      }
      %iter_4383 = cute.get_iter(%1635) : !memref_rmem_f32_3
      %lay_4384 = cute.get_layout(%1635) : !memref_rmem_f32_3
      %1636 = cute.get_shape(%lay_4384) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4385, %e1_4386, %e2_4387, %e3_4388 = cute.get_leaves(%1636) : !cute.shape<"((2,2),(2,8))">
      %1637 = cute.get_stride(%lay_4384) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4389, %e1_4390, %e2_4391, %e3_4392 = cute.get_leaves(%1637) : !cute.stride<"((2,4),(1,8))">
      %iter_4393 = cute.get_iter(%1635) : !memref_rmem_f32_3
      %iter_4394 = cute.get_iter(%1635) : !memref_rmem_f32_3
      %coord_4395 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %slice_4396 = cute.slice(%view_2232, %coord_4395) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)">
      %iter_4397 = cute.get_iter(%slice_4396) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4398, %e1_4399, %e2_4400, %e3_4401 = cute.get_leaves(%iter_4397) : !cute.int_tuple<"(?,?,?,?)">
      %1638 = cute.get_scalars(%e0_4398) : !cute.int_tuple<"?">
      %1639 = cute.get_scalars(%e1_4399) : !cute.int_tuple<"?">
      %1640 = cute.get_scalars(%e2_4400) : !cute.int_tuple<"?">
      %1641 = cute.get_scalars(%e3_4401) : !cute.int_tuple<"?">
      %iter_4402 = cute.get_iter(%slice_4396) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4403, %e1_4404, %e2_4405, %e3_4406 = cute.get_leaves(%iter_4402) : !cute.int_tuple<"(?,?,?,?)">
      %1642 = cute.get_scalars(%e0_4403) : !cute.int_tuple<"?">
      %1643 = cute.get_scalars(%e1_4404) : !cute.int_tuple<"?">
      %1644 = cute.get_scalars(%e2_4405) : !cute.int_tuple<"?">
      %1645 = cute.get_scalars(%e3_4406) : !cute.int_tuple<"?">
      %iter_4407 = cute.get_iter(%slice_4396) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4408, %e1_4409, %e2_4410, %e3_4411 = cute.get_leaves(%iter_4407) : !cute.int_tuple<"(?,?,?,?)">
      %1646 = cute.get_scalars(%e0_4408) : !cute.int_tuple<"?">
      %1647 = cute.get_scalars(%e1_4409) : !cute.int_tuple<"?">
      %1648 = cute.get_scalars(%e2_4410) : !cute.int_tuple<"?">
      %1649 = cute.get_scalars(%e3_4411) : !cute.int_tuple<"?">
      %int_tuple_4412 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4413 = cute.add_offset(%e3_4411, %int_tuple_4412) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1650 = cute.get_scalars(%tup_4413) : !cute.int_tuple<"?">
      %coord_4414 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4415 = cute.make_coord(%tup_4413) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1651 = cute.elem_less(%coord_4414, %coord_4415) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4416 = cute.get_layout(%1635) : !memref_rmem_f32_3
      %1652 = cute.get_shape(%lay_4416) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4417, %e1_4418, %e2_4419, %e3_4420 = cute.get_leaves(%1652) : !cute.shape<"((2,2),(2,8))">
      %1653 = cute.get_stride(%lay_4416) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4421, %e1_4422, %e2_4423, %e3_4424 = cute.get_leaves(%1653) : !cute.stride<"((2,4),(1,8))">
      %1654 = scf.if %1651 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1635) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,1)">
        cute.memref.store(%1635, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,1)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1635) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1635 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1635) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1635) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1635 : !memref_rmem_f32_3
      }
      %iter_4425 = cute.get_iter(%1654) : !memref_rmem_f32_3
      %lay_4426 = cute.get_layout(%1654) : !memref_rmem_f32_3
      %1655 = cute.get_shape(%lay_4426) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4427, %e1_4428, %e2_4429, %e3_4430 = cute.get_leaves(%1655) : !cute.shape<"((2,2),(2,8))">
      %1656 = cute.get_stride(%lay_4426) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4431, %e1_4432, %e2_4433, %e3_4434 = cute.get_leaves(%1656) : !cute.stride<"((2,4),(1,8))">
      %iter_4435 = cute.get_iter(%1654) : !memref_rmem_f32_3
      %iter_4436 = cute.get_iter(%1654) : !memref_rmem_f32_3
      %coord_4437 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %slice_4438 = cute.slice(%view_2232, %coord_4437) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)">
      %iter_4439 = cute.get_iter(%slice_4438) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4440, %e1_4441, %e2_4442, %e3_4443 = cute.get_leaves(%iter_4439) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1657 = cute.get_scalars(%e0_4440) : !cute.int_tuple<"?">
      %1658 = cute.get_scalars(%e1_4441) : !cute.int_tuple<"?">
      %1659 = cute.get_scalars(%e2_4442) : !cute.int_tuple<"?">
      %1660 = cute.get_scalars(%e3_4443) : !cute.int_tuple<"?{div=2}">
      %iter_4444 = cute.get_iter(%slice_4438) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4445, %e1_4446, %e2_4447, %e3_4448 = cute.get_leaves(%iter_4444) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1661 = cute.get_scalars(%e0_4445) : !cute.int_tuple<"?">
      %1662 = cute.get_scalars(%e1_4446) : !cute.int_tuple<"?">
      %1663 = cute.get_scalars(%e2_4447) : !cute.int_tuple<"?">
      %1664 = cute.get_scalars(%e3_4448) : !cute.int_tuple<"?{div=2}">
      %iter_4449 = cute.get_iter(%slice_4438) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4450, %e1_4451, %e2_4452, %e3_4453 = cute.get_leaves(%iter_4449) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1665 = cute.get_scalars(%e0_4450) : !cute.int_tuple<"?">
      %1666 = cute.get_scalars(%e1_4451) : !cute.int_tuple<"?">
      %1667 = cute.get_scalars(%e2_4452) : !cute.int_tuple<"?">
      %1668 = cute.get_scalars(%e3_4453) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4454 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4455 = cute.add_offset(%e3_4453, %int_tuple_4454) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1669 = cute.get_scalars(%tup_4455) : !cute.int_tuple<"?">
      %coord_4456 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4457 = cute.make_coord(%tup_4455) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1670 = cute.elem_less(%coord_4456, %coord_4457) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4458 = cute.get_layout(%1654) : !memref_rmem_f32_3
      %1671 = cute.get_shape(%lay_4458) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4459, %e1_4460, %e2_4461, %e3_4462 = cute.get_leaves(%1671) : !cute.shape<"((2,2),(2,8))">
      %1672 = cute.get_stride(%lay_4458) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4463, %e1_4464, %e2_4465, %e3_4466 = cute.get_leaves(%1672) : !cute.stride<"((2,4),(1,8))">
      %1673 = scf.if %1670 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1654) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,2)">
        cute.memref.store(%1654, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,2)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1654) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1654 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1654) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1654) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1654 : !memref_rmem_f32_3
      }
      %iter_4467 = cute.get_iter(%1673) : !memref_rmem_f32_3
      %lay_4468 = cute.get_layout(%1673) : !memref_rmem_f32_3
      %1674 = cute.get_shape(%lay_4468) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4469, %e1_4470, %e2_4471, %e3_4472 = cute.get_leaves(%1674) : !cute.shape<"((2,2),(2,8))">
      %1675 = cute.get_stride(%lay_4468) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4473, %e1_4474, %e2_4475, %e3_4476 = cute.get_leaves(%1675) : !cute.stride<"((2,4),(1,8))">
      %iter_4477 = cute.get_iter(%1673) : !memref_rmem_f32_3
      %iter_4478 = cute.get_iter(%1673) : !memref_rmem_f32_3
      %coord_4479 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %slice_4480 = cute.slice(%view_2232, %coord_4479) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)">
      %iter_4481 = cute.get_iter(%slice_4480) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4482, %e1_4483, %e2_4484, %e3_4485 = cute.get_leaves(%iter_4481) : !cute.int_tuple<"(?,?,?,?)">
      %1676 = cute.get_scalars(%e0_4482) : !cute.int_tuple<"?">
      %1677 = cute.get_scalars(%e1_4483) : !cute.int_tuple<"?">
      %1678 = cute.get_scalars(%e2_4484) : !cute.int_tuple<"?">
      %1679 = cute.get_scalars(%e3_4485) : !cute.int_tuple<"?">
      %iter_4486 = cute.get_iter(%slice_4480) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4487, %e1_4488, %e2_4489, %e3_4490 = cute.get_leaves(%iter_4486) : !cute.int_tuple<"(?,?,?,?)">
      %1680 = cute.get_scalars(%e0_4487) : !cute.int_tuple<"?">
      %1681 = cute.get_scalars(%e1_4488) : !cute.int_tuple<"?">
      %1682 = cute.get_scalars(%e2_4489) : !cute.int_tuple<"?">
      %1683 = cute.get_scalars(%e3_4490) : !cute.int_tuple<"?">
      %iter_4491 = cute.get_iter(%slice_4480) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4492, %e1_4493, %e2_4494, %e3_4495 = cute.get_leaves(%iter_4491) : !cute.int_tuple<"(?,?,?,?)">
      %1684 = cute.get_scalars(%e0_4492) : !cute.int_tuple<"?">
      %1685 = cute.get_scalars(%e1_4493) : !cute.int_tuple<"?">
      %1686 = cute.get_scalars(%e2_4494) : !cute.int_tuple<"?">
      %1687 = cute.get_scalars(%e3_4495) : !cute.int_tuple<"?">
      %int_tuple_4496 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4497 = cute.add_offset(%e3_4495, %int_tuple_4496) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1688 = cute.get_scalars(%tup_4497) : !cute.int_tuple<"?">
      %coord_4498 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4499 = cute.make_coord(%tup_4497) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1689 = cute.elem_less(%coord_4498, %coord_4499) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4500 = cute.get_layout(%1673) : !memref_rmem_f32_3
      %1690 = cute.get_shape(%lay_4500) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4501, %e1_4502, %e2_4503, %e3_4504 = cute.get_leaves(%1690) : !cute.shape<"((2,2),(2,8))">
      %1691 = cute.get_stride(%lay_4500) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4505, %e1_4506, %e2_4507, %e3_4508 = cute.get_leaves(%1691) : !cute.stride<"((2,4),(1,8))">
      %1692 = scf.if %1689 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1673) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,3)">
        cute.memref.store(%1673, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,3)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1673) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1673 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1673) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1673) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1673 : !memref_rmem_f32_3
      }
      %iter_4509 = cute.get_iter(%1692) : !memref_rmem_f32_3
      %lay_4510 = cute.get_layout(%1692) : !memref_rmem_f32_3
      %1693 = cute.get_shape(%lay_4510) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4511, %e1_4512, %e2_4513, %e3_4514 = cute.get_leaves(%1693) : !cute.shape<"((2,2),(2,8))">
      %1694 = cute.get_stride(%lay_4510) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4515, %e1_4516, %e2_4517, %e3_4518 = cute.get_leaves(%1694) : !cute.stride<"((2,4),(1,8))">
      %iter_4519 = cute.get_iter(%1692) : !memref_rmem_f32_3
      %iter_4520 = cute.get_iter(%1692) : !memref_rmem_f32_3
      %coord_4521 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %slice_4522 = cute.slice(%view_2232, %coord_4521) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)">
      %iter_4523 = cute.get_iter(%slice_4522) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4524, %e1_4525, %e2_4526, %e3_4527 = cute.get_leaves(%iter_4523) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1695 = cute.get_scalars(%e0_4524) : !cute.int_tuple<"?">
      %1696 = cute.get_scalars(%e1_4525) : !cute.int_tuple<"?">
      %1697 = cute.get_scalars(%e2_4526) : !cute.int_tuple<"?">
      %1698 = cute.get_scalars(%e3_4527) : !cute.int_tuple<"?{div=2}">
      %iter_4528 = cute.get_iter(%slice_4522) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4529, %e1_4530, %e2_4531, %e3_4532 = cute.get_leaves(%iter_4528) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1699 = cute.get_scalars(%e0_4529) : !cute.int_tuple<"?">
      %1700 = cute.get_scalars(%e1_4530) : !cute.int_tuple<"?">
      %1701 = cute.get_scalars(%e2_4531) : !cute.int_tuple<"?">
      %1702 = cute.get_scalars(%e3_4532) : !cute.int_tuple<"?{div=2}">
      %iter_4533 = cute.get_iter(%slice_4522) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4534, %e1_4535, %e2_4536, %e3_4537 = cute.get_leaves(%iter_4533) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1703 = cute.get_scalars(%e0_4534) : !cute.int_tuple<"?">
      %1704 = cute.get_scalars(%e1_4535) : !cute.int_tuple<"?">
      %1705 = cute.get_scalars(%e2_4536) : !cute.int_tuple<"?">
      %1706 = cute.get_scalars(%e3_4537) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4538 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4539 = cute.add_offset(%e3_4537, %int_tuple_4538) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1707 = cute.get_scalars(%tup_4539) : !cute.int_tuple<"?">
      %coord_4540 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4541 = cute.make_coord(%tup_4539) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1708 = cute.elem_less(%coord_4540, %coord_4541) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4542 = cute.get_layout(%1692) : !memref_rmem_f32_3
      %1709 = cute.get_shape(%lay_4542) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4543, %e1_4544, %e2_4545, %e3_4546 = cute.get_leaves(%1709) : !cute.shape<"((2,2),(2,8))">
      %1710 = cute.get_stride(%lay_4542) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4547, %e1_4548, %e2_4549, %e3_4550 = cute.get_leaves(%1710) : !cute.stride<"((2,4),(1,8))">
      %1711 = scf.if %1708 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1692) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,4)">
        cute.memref.store(%1692, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,4)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1692) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1692 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1692) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1692) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1692 : !memref_rmem_f32_3
      }
      %iter_4551 = cute.get_iter(%1711) : !memref_rmem_f32_3
      %lay_4552 = cute.get_layout(%1711) : !memref_rmem_f32_3
      %1712 = cute.get_shape(%lay_4552) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4553, %e1_4554, %e2_4555, %e3_4556 = cute.get_leaves(%1712) : !cute.shape<"((2,2),(2,8))">
      %1713 = cute.get_stride(%lay_4552) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4557, %e1_4558, %e2_4559, %e3_4560 = cute.get_leaves(%1713) : !cute.stride<"((2,4),(1,8))">
      %iter_4561 = cute.get_iter(%1711) : !memref_rmem_f32_3
      %iter_4562 = cute.get_iter(%1711) : !memref_rmem_f32_3
      %coord_4563 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %slice_4564 = cute.slice(%view_2232, %coord_4563) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)">
      %iter_4565 = cute.get_iter(%slice_4564) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4566, %e1_4567, %e2_4568, %e3_4569 = cute.get_leaves(%iter_4565) : !cute.int_tuple<"(?,?,?,?)">
      %1714 = cute.get_scalars(%e0_4566) : !cute.int_tuple<"?">
      %1715 = cute.get_scalars(%e1_4567) : !cute.int_tuple<"?">
      %1716 = cute.get_scalars(%e2_4568) : !cute.int_tuple<"?">
      %1717 = cute.get_scalars(%e3_4569) : !cute.int_tuple<"?">
      %iter_4570 = cute.get_iter(%slice_4564) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4571, %e1_4572, %e2_4573, %e3_4574 = cute.get_leaves(%iter_4570) : !cute.int_tuple<"(?,?,?,?)">
      %1718 = cute.get_scalars(%e0_4571) : !cute.int_tuple<"?">
      %1719 = cute.get_scalars(%e1_4572) : !cute.int_tuple<"?">
      %1720 = cute.get_scalars(%e2_4573) : !cute.int_tuple<"?">
      %1721 = cute.get_scalars(%e3_4574) : !cute.int_tuple<"?">
      %iter_4575 = cute.get_iter(%slice_4564) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4576, %e1_4577, %e2_4578, %e3_4579 = cute.get_leaves(%iter_4575) : !cute.int_tuple<"(?,?,?,?)">
      %1722 = cute.get_scalars(%e0_4576) : !cute.int_tuple<"?">
      %1723 = cute.get_scalars(%e1_4577) : !cute.int_tuple<"?">
      %1724 = cute.get_scalars(%e2_4578) : !cute.int_tuple<"?">
      %1725 = cute.get_scalars(%e3_4579) : !cute.int_tuple<"?">
      %int_tuple_4580 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4581 = cute.add_offset(%e3_4579, %int_tuple_4580) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1726 = cute.get_scalars(%tup_4581) : !cute.int_tuple<"?">
      %coord_4582 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4583 = cute.make_coord(%tup_4581) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1727 = cute.elem_less(%coord_4582, %coord_4583) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4584 = cute.get_layout(%1711) : !memref_rmem_f32_3
      %1728 = cute.get_shape(%lay_4584) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4585, %e1_4586, %e2_4587, %e3_4588 = cute.get_leaves(%1728) : !cute.shape<"((2,2),(2,8))">
      %1729 = cute.get_stride(%lay_4584) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4589, %e1_4590, %e2_4591, %e3_4592 = cute.get_leaves(%1729) : !cute.stride<"((2,4),(1,8))">
      %1730 = scf.if %1727 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1711) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,5)">
        cute.memref.store(%1711, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,5)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1711) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1711 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1711) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1711) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1711 : !memref_rmem_f32_3
      }
      %iter_4593 = cute.get_iter(%1730) : !memref_rmem_f32_3
      %lay_4594 = cute.get_layout(%1730) : !memref_rmem_f32_3
      %1731 = cute.get_shape(%lay_4594) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4595, %e1_4596, %e2_4597, %e3_4598 = cute.get_leaves(%1731) : !cute.shape<"((2,2),(2,8))">
      %1732 = cute.get_stride(%lay_4594) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4599, %e1_4600, %e2_4601, %e3_4602 = cute.get_leaves(%1732) : !cute.stride<"((2,4),(1,8))">
      %iter_4603 = cute.get_iter(%1730) : !memref_rmem_f32_3
      %iter_4604 = cute.get_iter(%1730) : !memref_rmem_f32_3
      %coord_4605 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %slice_4606 = cute.slice(%view_2232, %coord_4605) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)">
      %iter_4607 = cute.get_iter(%slice_4606) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4608, %e1_4609, %e2_4610, %e3_4611 = cute.get_leaves(%iter_4607) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1733 = cute.get_scalars(%e0_4608) : !cute.int_tuple<"?">
      %1734 = cute.get_scalars(%e1_4609) : !cute.int_tuple<"?">
      %1735 = cute.get_scalars(%e2_4610) : !cute.int_tuple<"?">
      %1736 = cute.get_scalars(%e3_4611) : !cute.int_tuple<"?{div=2}">
      %iter_4612 = cute.get_iter(%slice_4606) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4613, %e1_4614, %e2_4615, %e3_4616 = cute.get_leaves(%iter_4612) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1737 = cute.get_scalars(%e0_4613) : !cute.int_tuple<"?">
      %1738 = cute.get_scalars(%e1_4614) : !cute.int_tuple<"?">
      %1739 = cute.get_scalars(%e2_4615) : !cute.int_tuple<"?">
      %1740 = cute.get_scalars(%e3_4616) : !cute.int_tuple<"?{div=2}">
      %iter_4617 = cute.get_iter(%slice_4606) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4618, %e1_4619, %e2_4620, %e3_4621 = cute.get_leaves(%iter_4617) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1741 = cute.get_scalars(%e0_4618) : !cute.int_tuple<"?">
      %1742 = cute.get_scalars(%e1_4619) : !cute.int_tuple<"?">
      %1743 = cute.get_scalars(%e2_4620) : !cute.int_tuple<"?">
      %1744 = cute.get_scalars(%e3_4621) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4622 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4623 = cute.add_offset(%e3_4621, %int_tuple_4622) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1745 = cute.get_scalars(%tup_4623) : !cute.int_tuple<"?">
      %coord_4624 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4625 = cute.make_coord(%tup_4623) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1746 = cute.elem_less(%coord_4624, %coord_4625) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4626 = cute.get_layout(%1730) : !memref_rmem_f32_3
      %1747 = cute.get_shape(%lay_4626) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4627, %e1_4628, %e2_4629, %e3_4630 = cute.get_leaves(%1747) : !cute.shape<"((2,2),(2,8))">
      %1748 = cute.get_stride(%lay_4626) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4631, %e1_4632, %e2_4633, %e3_4634 = cute.get_leaves(%1748) : !cute.stride<"((2,4),(1,8))">
      %1749 = scf.if %1746 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1730) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,6)">
        cute.memref.store(%1730, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,6)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1730) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1730 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1730) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1730) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1730 : !memref_rmem_f32_3
      }
      %iter_4635 = cute.get_iter(%1749) : !memref_rmem_f32_3
      %lay_4636 = cute.get_layout(%1749) : !memref_rmem_f32_3
      %1750 = cute.get_shape(%lay_4636) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4637, %e1_4638, %e2_4639, %e3_4640 = cute.get_leaves(%1750) : !cute.shape<"((2,2),(2,8))">
      %1751 = cute.get_stride(%lay_4636) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4641, %e1_4642, %e2_4643, %e3_4644 = cute.get_leaves(%1751) : !cute.stride<"((2,4),(1,8))">
      %iter_4645 = cute.get_iter(%1749) : !memref_rmem_f32_3
      %iter_4646 = cute.get_iter(%1749) : !memref_rmem_f32_3
      %coord_4647 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %slice_4648 = cute.slice(%view_2232, %coord_4647) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)">
      %iter_4649 = cute.get_iter(%slice_4648) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4650, %e1_4651, %e2_4652, %e3_4653 = cute.get_leaves(%iter_4649) : !cute.int_tuple<"(?,?,?,?)">
      %1752 = cute.get_scalars(%e0_4650) : !cute.int_tuple<"?">
      %1753 = cute.get_scalars(%e1_4651) : !cute.int_tuple<"?">
      %1754 = cute.get_scalars(%e2_4652) : !cute.int_tuple<"?">
      %1755 = cute.get_scalars(%e3_4653) : !cute.int_tuple<"?">
      %iter_4654 = cute.get_iter(%slice_4648) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4655, %e1_4656, %e2_4657, %e3_4658 = cute.get_leaves(%iter_4654) : !cute.int_tuple<"(?,?,?,?)">
      %1756 = cute.get_scalars(%e0_4655) : !cute.int_tuple<"?">
      %1757 = cute.get_scalars(%e1_4656) : !cute.int_tuple<"?">
      %1758 = cute.get_scalars(%e2_4657) : !cute.int_tuple<"?">
      %1759 = cute.get_scalars(%e3_4658) : !cute.int_tuple<"?">
      %iter_4659 = cute.get_iter(%slice_4648) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4660, %e1_4661, %e2_4662, %e3_4663 = cute.get_leaves(%iter_4659) : !cute.int_tuple<"(?,?,?,?)">
      %1760 = cute.get_scalars(%e0_4660) : !cute.int_tuple<"?">
      %1761 = cute.get_scalars(%e1_4661) : !cute.int_tuple<"?">
      %1762 = cute.get_scalars(%e2_4662) : !cute.int_tuple<"?">
      %1763 = cute.get_scalars(%e3_4663) : !cute.int_tuple<"?">
      %int_tuple_4664 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4665 = cute.add_offset(%e3_4663, %int_tuple_4664) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1764 = cute.get_scalars(%tup_4665) : !cute.int_tuple<"?">
      %coord_4666 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4667 = cute.make_coord(%tup_4665) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1765 = cute.elem_less(%coord_4666, %coord_4667) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4668 = cute.get_layout(%1749) : !memref_rmem_f32_3
      %1766 = cute.get_shape(%lay_4668) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4669, %e1_4670, %e2_4671, %e3_4672 = cute.get_leaves(%1766) : !cute.shape<"((2,2),(2,8))">
      %1767 = cute.get_stride(%lay_4668) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4673, %e1_4674, %e2_4675, %e3_4676 = cute.get_leaves(%1767) : !cute.stride<"((2,4),(1,8))">
      %1768 = scf.if %1765 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1749) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,7)">
        cute.memref.store(%1749, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,7)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1749) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1749 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1749) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1749) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1749 : !memref_rmem_f32_3
      }
      %iter_4677 = cute.get_iter(%1768) : !memref_rmem_f32_3
      %lay_4678 = cute.get_layout(%1768) : !memref_rmem_f32_3
      %1769 = cute.get_shape(%lay_4678) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4679, %e1_4680, %e2_4681, %e3_4682 = cute.get_leaves(%1769) : !cute.shape<"((2,2),(2,8))">
      %1770 = cute.get_stride(%lay_4678) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4683, %e1_4684, %e2_4685, %e3_4686 = cute.get_leaves(%1770) : !cute.stride<"((2,4),(1,8))">
      %iter_4687 = cute.get_iter(%1768) : !memref_rmem_f32_3
      %iter_4688 = cute.get_iter(%1768) : !memref_rmem_f32_3
      %coord_4689 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %slice_4690 = cute.slice(%view_2232, %coord_4689) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)">
      %iter_4691 = cute.get_iter(%slice_4690) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4692, %e1_4693, %e2_4694, %e3_4695 = cute.get_leaves(%iter_4691) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1771 = cute.get_scalars(%e0_4692) : !cute.int_tuple<"?">
      %1772 = cute.get_scalars(%e1_4693) : !cute.int_tuple<"?">
      %1773 = cute.get_scalars(%e2_4694) : !cute.int_tuple<"?">
      %1774 = cute.get_scalars(%e3_4695) : !cute.int_tuple<"?{div=2}">
      %iter_4696 = cute.get_iter(%slice_4690) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4697, %e1_4698, %e2_4699, %e3_4700 = cute.get_leaves(%iter_4696) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1775 = cute.get_scalars(%e0_4697) : !cute.int_tuple<"?">
      %1776 = cute.get_scalars(%e1_4698) : !cute.int_tuple<"?">
      %1777 = cute.get_scalars(%e2_4699) : !cute.int_tuple<"?">
      %1778 = cute.get_scalars(%e3_4700) : !cute.int_tuple<"?{div=2}">
      %iter_4701 = cute.get_iter(%slice_4690) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4702, %e1_4703, %e2_4704, %e3_4705 = cute.get_leaves(%iter_4701) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1779 = cute.get_scalars(%e0_4702) : !cute.int_tuple<"?">
      %1780 = cute.get_scalars(%e1_4703) : !cute.int_tuple<"?">
      %1781 = cute.get_scalars(%e2_4704) : !cute.int_tuple<"?">
      %1782 = cute.get_scalars(%e3_4705) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4706 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4707 = cute.add_offset(%e3_4705, %int_tuple_4706) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1783 = cute.get_scalars(%tup_4707) : !cute.int_tuple<"?">
      %coord_4708 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4709 = cute.make_coord(%tup_4707) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1784 = cute.elem_less(%coord_4708, %coord_4709) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4710 = cute.get_layout(%1768) : !memref_rmem_f32_3
      %1785 = cute.get_shape(%lay_4710) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4711, %e1_4712, %e2_4713, %e3_4714 = cute.get_leaves(%1785) : !cute.shape<"((2,2),(2,8))">
      %1786 = cute.get_stride(%lay_4710) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4715, %e1_4716, %e2_4717, %e3_4718 = cute.get_leaves(%1786) : !cute.stride<"((2,4),(1,8))">
      %1787 = scf.if %1784 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1768) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,8)">
        cute.memref.store(%1768, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,8)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1768) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1768 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1768) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1768) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1768 : !memref_rmem_f32_3
      }
      %iter_4719 = cute.get_iter(%1787) : !memref_rmem_f32_3
      %lay_4720 = cute.get_layout(%1787) : !memref_rmem_f32_3
      %1788 = cute.get_shape(%lay_4720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4721, %e1_4722, %e2_4723, %e3_4724 = cute.get_leaves(%1788) : !cute.shape<"((2,2),(2,8))">
      %1789 = cute.get_stride(%lay_4720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4725, %e1_4726, %e2_4727, %e3_4728 = cute.get_leaves(%1789) : !cute.stride<"((2,4),(1,8))">
      %iter_4729 = cute.get_iter(%1787) : !memref_rmem_f32_3
      %iter_4730 = cute.get_iter(%1787) : !memref_rmem_f32_3
      %coord_4731 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %slice_4732 = cute.slice(%view_2232, %coord_4731) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)">
      %iter_4733 = cute.get_iter(%slice_4732) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4734, %e1_4735, %e2_4736, %e3_4737 = cute.get_leaves(%iter_4733) : !cute.int_tuple<"(?,?,?,?)">
      %1790 = cute.get_scalars(%e0_4734) : !cute.int_tuple<"?">
      %1791 = cute.get_scalars(%e1_4735) : !cute.int_tuple<"?">
      %1792 = cute.get_scalars(%e2_4736) : !cute.int_tuple<"?">
      %1793 = cute.get_scalars(%e3_4737) : !cute.int_tuple<"?">
      %iter_4738 = cute.get_iter(%slice_4732) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4739, %e1_4740, %e2_4741, %e3_4742 = cute.get_leaves(%iter_4738) : !cute.int_tuple<"(?,?,?,?)">
      %1794 = cute.get_scalars(%e0_4739) : !cute.int_tuple<"?">
      %1795 = cute.get_scalars(%e1_4740) : !cute.int_tuple<"?">
      %1796 = cute.get_scalars(%e2_4741) : !cute.int_tuple<"?">
      %1797 = cute.get_scalars(%e3_4742) : !cute.int_tuple<"?">
      %iter_4743 = cute.get_iter(%slice_4732) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4744, %e1_4745, %e2_4746, %e3_4747 = cute.get_leaves(%iter_4743) : !cute.int_tuple<"(?,?,?,?)">
      %1798 = cute.get_scalars(%e0_4744) : !cute.int_tuple<"?">
      %1799 = cute.get_scalars(%e1_4745) : !cute.int_tuple<"?">
      %1800 = cute.get_scalars(%e2_4746) : !cute.int_tuple<"?">
      %1801 = cute.get_scalars(%e3_4747) : !cute.int_tuple<"?">
      %int_tuple_4748 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4749 = cute.add_offset(%e3_4747, %int_tuple_4748) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1802 = cute.get_scalars(%tup_4749) : !cute.int_tuple<"?">
      %coord_4750 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4751 = cute.make_coord(%tup_4749) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1803 = cute.elem_less(%coord_4750, %coord_4751) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4752 = cute.get_layout(%1787) : !memref_rmem_f32_3
      %1804 = cute.get_shape(%lay_4752) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4753, %e1_4754, %e2_4755, %e3_4756 = cute.get_leaves(%1804) : !cute.shape<"((2,2),(2,8))">
      %1805 = cute.get_stride(%lay_4752) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4757, %e1_4758, %e2_4759, %e3_4760 = cute.get_leaves(%1805) : !cute.stride<"((2,4),(1,8))">
      %1806 = scf.if %1803 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1787) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,9)">
        cute.memref.store(%1787, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,9)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1787) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1787 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1787) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1787) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1787 : !memref_rmem_f32_3
      }
      %iter_4761 = cute.get_iter(%1806) : !memref_rmem_f32_3
      %lay_4762 = cute.get_layout(%1806) : !memref_rmem_f32_3
      %1807 = cute.get_shape(%lay_4762) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4763, %e1_4764, %e2_4765, %e3_4766 = cute.get_leaves(%1807) : !cute.shape<"((2,2),(2,8))">
      %1808 = cute.get_stride(%lay_4762) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4767, %e1_4768, %e2_4769, %e3_4770 = cute.get_leaves(%1808) : !cute.stride<"((2,4),(1,8))">
      %iter_4771 = cute.get_iter(%1806) : !memref_rmem_f32_3
      %iter_4772 = cute.get_iter(%1806) : !memref_rmem_f32_3
      %coord_4773 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %slice_4774 = cute.slice(%view_2232, %coord_4773) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)">
      %iter_4775 = cute.get_iter(%slice_4774) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4776, %e1_4777, %e2_4778, %e3_4779 = cute.get_leaves(%iter_4775) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1809 = cute.get_scalars(%e0_4776) : !cute.int_tuple<"?">
      %1810 = cute.get_scalars(%e1_4777) : !cute.int_tuple<"?">
      %1811 = cute.get_scalars(%e2_4778) : !cute.int_tuple<"?">
      %1812 = cute.get_scalars(%e3_4779) : !cute.int_tuple<"?{div=2}">
      %iter_4780 = cute.get_iter(%slice_4774) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4781, %e1_4782, %e2_4783, %e3_4784 = cute.get_leaves(%iter_4780) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1813 = cute.get_scalars(%e0_4781) : !cute.int_tuple<"?">
      %1814 = cute.get_scalars(%e1_4782) : !cute.int_tuple<"?">
      %1815 = cute.get_scalars(%e2_4783) : !cute.int_tuple<"?">
      %1816 = cute.get_scalars(%e3_4784) : !cute.int_tuple<"?{div=2}">
      %iter_4785 = cute.get_iter(%slice_4774) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4786, %e1_4787, %e2_4788, %e3_4789 = cute.get_leaves(%iter_4785) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1817 = cute.get_scalars(%e0_4786) : !cute.int_tuple<"?">
      %1818 = cute.get_scalars(%e1_4787) : !cute.int_tuple<"?">
      %1819 = cute.get_scalars(%e2_4788) : !cute.int_tuple<"?">
      %1820 = cute.get_scalars(%e3_4789) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4790 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4791 = cute.add_offset(%e3_4789, %int_tuple_4790) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1821 = cute.get_scalars(%tup_4791) : !cute.int_tuple<"?">
      %coord_4792 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4793 = cute.make_coord(%tup_4791) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1822 = cute.elem_less(%coord_4792, %coord_4793) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4794 = cute.get_layout(%1806) : !memref_rmem_f32_3
      %1823 = cute.get_shape(%lay_4794) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4795, %e1_4796, %e2_4797, %e3_4798 = cute.get_leaves(%1823) : !cute.shape<"((2,2),(2,8))">
      %1824 = cute.get_stride(%lay_4794) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4799, %e1_4800, %e2_4801, %e3_4802 = cute.get_leaves(%1824) : !cute.stride<"((2,4),(1,8))">
      %1825 = scf.if %1822 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1806) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,10)">
        cute.memref.store(%1806, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,10)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1806) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1806 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1806) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1806) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1806 : !memref_rmem_f32_3
      }
      %iter_4803 = cute.get_iter(%1825) : !memref_rmem_f32_3
      %lay_4804 = cute.get_layout(%1825) : !memref_rmem_f32_3
      %1826 = cute.get_shape(%lay_4804) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4805, %e1_4806, %e2_4807, %e3_4808 = cute.get_leaves(%1826) : !cute.shape<"((2,2),(2,8))">
      %1827 = cute.get_stride(%lay_4804) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4809, %e1_4810, %e2_4811, %e3_4812 = cute.get_leaves(%1827) : !cute.stride<"((2,4),(1,8))">
      %iter_4813 = cute.get_iter(%1825) : !memref_rmem_f32_3
      %iter_4814 = cute.get_iter(%1825) : !memref_rmem_f32_3
      %coord_4815 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %slice_4816 = cute.slice(%view_2232, %coord_4815) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)">
      %iter_4817 = cute.get_iter(%slice_4816) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4818, %e1_4819, %e2_4820, %e3_4821 = cute.get_leaves(%iter_4817) : !cute.int_tuple<"(?,?,?,?)">
      %1828 = cute.get_scalars(%e0_4818) : !cute.int_tuple<"?">
      %1829 = cute.get_scalars(%e1_4819) : !cute.int_tuple<"?">
      %1830 = cute.get_scalars(%e2_4820) : !cute.int_tuple<"?">
      %1831 = cute.get_scalars(%e3_4821) : !cute.int_tuple<"?">
      %iter_4822 = cute.get_iter(%slice_4816) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4823, %e1_4824, %e2_4825, %e3_4826 = cute.get_leaves(%iter_4822) : !cute.int_tuple<"(?,?,?,?)">
      %1832 = cute.get_scalars(%e0_4823) : !cute.int_tuple<"?">
      %1833 = cute.get_scalars(%e1_4824) : !cute.int_tuple<"?">
      %1834 = cute.get_scalars(%e2_4825) : !cute.int_tuple<"?">
      %1835 = cute.get_scalars(%e3_4826) : !cute.int_tuple<"?">
      %iter_4827 = cute.get_iter(%slice_4816) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4828, %e1_4829, %e2_4830, %e3_4831 = cute.get_leaves(%iter_4827) : !cute.int_tuple<"(?,?,?,?)">
      %1836 = cute.get_scalars(%e0_4828) : !cute.int_tuple<"?">
      %1837 = cute.get_scalars(%e1_4829) : !cute.int_tuple<"?">
      %1838 = cute.get_scalars(%e2_4830) : !cute.int_tuple<"?">
      %1839 = cute.get_scalars(%e3_4831) : !cute.int_tuple<"?">
      %int_tuple_4832 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4833 = cute.add_offset(%e3_4831, %int_tuple_4832) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1840 = cute.get_scalars(%tup_4833) : !cute.int_tuple<"?">
      %coord_4834 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4835 = cute.make_coord(%tup_4833) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1841 = cute.elem_less(%coord_4834, %coord_4835) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4836 = cute.get_layout(%1825) : !memref_rmem_f32_3
      %1842 = cute.get_shape(%lay_4836) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4837, %e1_4838, %e2_4839, %e3_4840 = cute.get_leaves(%1842) : !cute.shape<"((2,2),(2,8))">
      %1843 = cute.get_stride(%lay_4836) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4841, %e1_4842, %e2_4843, %e3_4844 = cute.get_leaves(%1843) : !cute.stride<"((2,4),(1,8))">
      %1844 = scf.if %1841 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1825) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,11)">
        cute.memref.store(%1825, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,11)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1825) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1825 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1825) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1825) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1825 : !memref_rmem_f32_3
      }
      %iter_4845 = cute.get_iter(%1844) : !memref_rmem_f32_3
      %lay_4846 = cute.get_layout(%1844) : !memref_rmem_f32_3
      %1845 = cute.get_shape(%lay_4846) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4847, %e1_4848, %e2_4849, %e3_4850 = cute.get_leaves(%1845) : !cute.shape<"((2,2),(2,8))">
      %1846 = cute.get_stride(%lay_4846) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4851, %e1_4852, %e2_4853, %e3_4854 = cute.get_leaves(%1846) : !cute.stride<"((2,4),(1,8))">
      %iter_4855 = cute.get_iter(%1844) : !memref_rmem_f32_3
      %iter_4856 = cute.get_iter(%1844) : !memref_rmem_f32_3
      %coord_4857 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %slice_4858 = cute.slice(%view_2232, %coord_4857) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)">
      %iter_4859 = cute.get_iter(%slice_4858) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4860, %e1_4861, %e2_4862, %e3_4863 = cute.get_leaves(%iter_4859) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1847 = cute.get_scalars(%e0_4860) : !cute.int_tuple<"?">
      %1848 = cute.get_scalars(%e1_4861) : !cute.int_tuple<"?">
      %1849 = cute.get_scalars(%e2_4862) : !cute.int_tuple<"?">
      %1850 = cute.get_scalars(%e3_4863) : !cute.int_tuple<"?{div=2}">
      %iter_4864 = cute.get_iter(%slice_4858) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4865, %e1_4866, %e2_4867, %e3_4868 = cute.get_leaves(%iter_4864) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1851 = cute.get_scalars(%e0_4865) : !cute.int_tuple<"?">
      %1852 = cute.get_scalars(%e1_4866) : !cute.int_tuple<"?">
      %1853 = cute.get_scalars(%e2_4867) : !cute.int_tuple<"?">
      %1854 = cute.get_scalars(%e3_4868) : !cute.int_tuple<"?{div=2}">
      %iter_4869 = cute.get_iter(%slice_4858) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4870, %e1_4871, %e2_4872, %e3_4873 = cute.get_leaves(%iter_4869) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1855 = cute.get_scalars(%e0_4870) : !cute.int_tuple<"?">
      %1856 = cute.get_scalars(%e1_4871) : !cute.int_tuple<"?">
      %1857 = cute.get_scalars(%e2_4872) : !cute.int_tuple<"?">
      %1858 = cute.get_scalars(%e3_4873) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4874 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4875 = cute.add_offset(%e3_4873, %int_tuple_4874) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1859 = cute.get_scalars(%tup_4875) : !cute.int_tuple<"?">
      %coord_4876 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4877 = cute.make_coord(%tup_4875) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1860 = cute.elem_less(%coord_4876, %coord_4877) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4878 = cute.get_layout(%1844) : !memref_rmem_f32_3
      %1861 = cute.get_shape(%lay_4878) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4879, %e1_4880, %e2_4881, %e3_4882 = cute.get_leaves(%1861) : !cute.shape<"((2,2),(2,8))">
      %1862 = cute.get_stride(%lay_4878) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4883, %e1_4884, %e2_4885, %e3_4886 = cute.get_leaves(%1862) : !cute.stride<"((2,4),(1,8))">
      %1863 = scf.if %1860 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1844) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,12)">
        cute.memref.store(%1844, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,12)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1844) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1844 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1844) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1844) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1844 : !memref_rmem_f32_3
      }
      %iter_4887 = cute.get_iter(%1863) : !memref_rmem_f32_3
      %lay_4888 = cute.get_layout(%1863) : !memref_rmem_f32_3
      %1864 = cute.get_shape(%lay_4888) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4889, %e1_4890, %e2_4891, %e3_4892 = cute.get_leaves(%1864) : !cute.shape<"((2,2),(2,8))">
      %1865 = cute.get_stride(%lay_4888) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4893, %e1_4894, %e2_4895, %e3_4896 = cute.get_leaves(%1865) : !cute.stride<"((2,4),(1,8))">
      %iter_4897 = cute.get_iter(%1863) : !memref_rmem_f32_3
      %iter_4898 = cute.get_iter(%1863) : !memref_rmem_f32_3
      %coord_4899 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %slice_4900 = cute.slice(%view_2232, %coord_4899) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)">
      %iter_4901 = cute.get_iter(%slice_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4902, %e1_4903, %e2_4904, %e3_4905 = cute.get_leaves(%iter_4901) : !cute.int_tuple<"(?,?,?,?)">
      %1866 = cute.get_scalars(%e0_4902) : !cute.int_tuple<"?">
      %1867 = cute.get_scalars(%e1_4903) : !cute.int_tuple<"?">
      %1868 = cute.get_scalars(%e2_4904) : !cute.int_tuple<"?">
      %1869 = cute.get_scalars(%e3_4905) : !cute.int_tuple<"?">
      %iter_4906 = cute.get_iter(%slice_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%iter_4906) : !cute.int_tuple<"(?,?,?,?)">
      %1870 = cute.get_scalars(%e0_4907) : !cute.int_tuple<"?">
      %1871 = cute.get_scalars(%e1_4908) : !cute.int_tuple<"?">
      %1872 = cute.get_scalars(%e2_4909) : !cute.int_tuple<"?">
      %1873 = cute.get_scalars(%e3_4910) : !cute.int_tuple<"?">
      %iter_4911 = cute.get_iter(%slice_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4912, %e1_4913, %e2_4914, %e3_4915 = cute.get_leaves(%iter_4911) : !cute.int_tuple<"(?,?,?,?)">
      %1874 = cute.get_scalars(%e0_4912) : !cute.int_tuple<"?">
      %1875 = cute.get_scalars(%e1_4913) : !cute.int_tuple<"?">
      %1876 = cute.get_scalars(%e2_4914) : !cute.int_tuple<"?">
      %1877 = cute.get_scalars(%e3_4915) : !cute.int_tuple<"?">
      %int_tuple_4916 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4917 = cute.add_offset(%e3_4915, %int_tuple_4916) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1878 = cute.get_scalars(%tup_4917) : !cute.int_tuple<"?">
      %coord_4918 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4919 = cute.make_coord(%tup_4917) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1879 = cute.elem_less(%coord_4918, %coord_4919) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4920 = cute.get_layout(%1863) : !memref_rmem_f32_3
      %1880 = cute.get_shape(%lay_4920) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4921, %e1_4922, %e2_4923, %e3_4924 = cute.get_leaves(%1880) : !cute.shape<"((2,2),(2,8))">
      %1881 = cute.get_stride(%lay_4920) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4925, %e1_4926, %e2_4927, %e3_4928 = cute.get_leaves(%1881) : !cute.stride<"((2,4),(1,8))">
      %1882 = scf.if %1879 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1863) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,13)">
        cute.memref.store(%1863, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,13)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1863) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1863 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1863) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1863) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1863 : !memref_rmem_f32_3
      }
      %iter_4929 = cute.get_iter(%1882) : !memref_rmem_f32_3
      %lay_4930 = cute.get_layout(%1882) : !memref_rmem_f32_3
      %1883 = cute.get_shape(%lay_4930) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4931, %e1_4932, %e2_4933, %e3_4934 = cute.get_leaves(%1883) : !cute.shape<"((2,2),(2,8))">
      %1884 = cute.get_stride(%lay_4930) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4935, %e1_4936, %e2_4937, %e3_4938 = cute.get_leaves(%1884) : !cute.stride<"((2,4),(1,8))">
      %iter_4939 = cute.get_iter(%1882) : !memref_rmem_f32_3
      %iter_4940 = cute.get_iter(%1882) : !memref_rmem_f32_3
      %coord_4941 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %slice_4942 = cute.slice(%view_2232, %coord_4941) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)">
      %iter_4943 = cute.get_iter(%slice_4942) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4944, %e1_4945, %e2_4946, %e3_4947 = cute.get_leaves(%iter_4943) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1885 = cute.get_scalars(%e0_4944) : !cute.int_tuple<"?">
      %1886 = cute.get_scalars(%e1_4945) : !cute.int_tuple<"?">
      %1887 = cute.get_scalars(%e2_4946) : !cute.int_tuple<"?">
      %1888 = cute.get_scalars(%e3_4947) : !cute.int_tuple<"?{div=2}">
      %iter_4948 = cute.get_iter(%slice_4942) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4949, %e1_4950, %e2_4951, %e3_4952 = cute.get_leaves(%iter_4948) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1889 = cute.get_scalars(%e0_4949) : !cute.int_tuple<"?">
      %1890 = cute.get_scalars(%e1_4950) : !cute.int_tuple<"?">
      %1891 = cute.get_scalars(%e2_4951) : !cute.int_tuple<"?">
      %1892 = cute.get_scalars(%e3_4952) : !cute.int_tuple<"?{div=2}">
      %iter_4953 = cute.get_iter(%slice_4942) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4954, %e1_4955, %e2_4956, %e3_4957 = cute.get_leaves(%iter_4953) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1893 = cute.get_scalars(%e0_4954) : !cute.int_tuple<"?">
      %1894 = cute.get_scalars(%e1_4955) : !cute.int_tuple<"?">
      %1895 = cute.get_scalars(%e2_4956) : !cute.int_tuple<"?">
      %1896 = cute.get_scalars(%e3_4957) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4958 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4959 = cute.add_offset(%e3_4957, %int_tuple_4958) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1897 = cute.get_scalars(%tup_4959) : !cute.int_tuple<"?">
      %coord_4960 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4961 = cute.make_coord(%tup_4959) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1898 = cute.elem_less(%coord_4960, %coord_4961) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4962 = cute.get_layout(%1882) : !memref_rmem_f32_3
      %1899 = cute.get_shape(%lay_4962) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4963, %e1_4964, %e2_4965, %e3_4966 = cute.get_leaves(%1899) : !cute.shape<"((2,2),(2,8))">
      %1900 = cute.get_stride(%lay_4962) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4967, %e1_4968, %e2_4969, %e3_4970 = cute.get_leaves(%1900) : !cute.stride<"((2,4),(1,8))">
      %1901 = scf.if %1898 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1882) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,14)">
        cute.memref.store(%1882, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,14)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1882) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1882 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1882) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1882) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1882 : !memref_rmem_f32_3
      }
      %iter_4971 = cute.get_iter(%1901) : !memref_rmem_f32_3
      %lay_4972 = cute.get_layout(%1901) : !memref_rmem_f32_3
      %1902 = cute.get_shape(%lay_4972) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4973, %e1_4974, %e2_4975, %e3_4976 = cute.get_leaves(%1902) : !cute.shape<"((2,2),(2,8))">
      %1903 = cute.get_stride(%lay_4972) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4977, %e1_4978, %e2_4979, %e3_4980 = cute.get_leaves(%1903) : !cute.stride<"((2,4),(1,8))">
      %iter_4981 = cute.get_iter(%1901) : !memref_rmem_f32_3
      %iter_4982 = cute.get_iter(%1901) : !memref_rmem_f32_3
      %coord_4983 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %slice_4984 = cute.slice(%view_2232, %coord_4983) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)">
      %iter_4985 = cute.get_iter(%slice_4984) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4986, %e1_4987, %e2_4988, %e3_4989 = cute.get_leaves(%iter_4985) : !cute.int_tuple<"(?,?,?,?)">
      %1904 = cute.get_scalars(%e0_4986) : !cute.int_tuple<"?">
      %1905 = cute.get_scalars(%e1_4987) : !cute.int_tuple<"?">
      %1906 = cute.get_scalars(%e2_4988) : !cute.int_tuple<"?">
      %1907 = cute.get_scalars(%e3_4989) : !cute.int_tuple<"?">
      %iter_4990 = cute.get_iter(%slice_4984) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4991, %e1_4992, %e2_4993, %e3_4994 = cute.get_leaves(%iter_4990) : !cute.int_tuple<"(?,?,?,?)">
      %1908 = cute.get_scalars(%e0_4991) : !cute.int_tuple<"?">
      %1909 = cute.get_scalars(%e1_4992) : !cute.int_tuple<"?">
      %1910 = cute.get_scalars(%e2_4993) : !cute.int_tuple<"?">
      %1911 = cute.get_scalars(%e3_4994) : !cute.int_tuple<"?">
      %iter_4995 = cute.get_iter(%slice_4984) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4996, %e1_4997, %e2_4998, %e3_4999 = cute.get_leaves(%iter_4995) : !cute.int_tuple<"(?,?,?,?)">
      %1912 = cute.get_scalars(%e0_4996) : !cute.int_tuple<"?">
      %1913 = cute.get_scalars(%e1_4997) : !cute.int_tuple<"?">
      %1914 = cute.get_scalars(%e2_4998) : !cute.int_tuple<"?">
      %1915 = cute.get_scalars(%e3_4999) : !cute.int_tuple<"?">
      %int_tuple_5000 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5001 = cute.add_offset(%e3_4999, %int_tuple_5000) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1916 = cute.get_scalars(%tup_5001) : !cute.int_tuple<"?">
      %coord_5002 = cute.make_coord(%itup_2158) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5003 = cute.make_coord(%tup_5001) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1917 = cute.elem_less(%coord_5002, %coord_5003) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5004 = cute.get_layout(%1901) : !memref_rmem_f32_3
      %1918 = cute.get_shape(%lay_5004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5005, %e1_5006, %e2_5007, %e3_5008 = cute.get_leaves(%1918) : !cute.shape<"((2,2),(2,8))">
      %1919 = cute.get_stride(%lay_5004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5009, %e1_5010, %e2_5011, %e3_5012 = cute.get_leaves(%1919) : !cute.stride<"((2,4),(1,8))">
      %1920 = scf.if %1917 -> (!memref_rmem_f32_3) {
        %iter_6239 = cute.get_iter(%1901) : !memref_rmem_f32_3
        %cst_6240 = arith.constant 0xFF800000 : f32
        %coord_6241 = cute.make_coord() : () -> !cute.coord<"(3,15)">
        cute.memref.store(%1901, %coord_6241, %cst_6240) : (!memref_rmem_f32_3, !cute.coord<"(3,15)">, f32) -> ()
        %lay_6242 = cute.get_layout(%1901) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6243, %e1_6244, %e2_6245, %e3_6246 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6247, %e1_6248, %e2_6249, %e3_6250 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1901 : !memref_rmem_f32_3
      } else {
        %iter_6239 = cute.get_iter(%1901) : !memref_rmem_f32_3
        %lay_6240 = cute.get_layout(%1901) : !memref_rmem_f32_3
        %2344 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2344) : !cute.shape<"((2,2),(2,8))">
        %2345 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2345) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1901 : !memref_rmem_f32_3
      }
      %iter_5013 = cute.get_iter(%1920) : !memref_rmem_f32_3
      %lay_5014 = cute.get_layout(%1920) : !memref_rmem_f32_3
      %1921 = cute.get_shape(%lay_5014) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5015, %e1_5016, %e2_5017, %e3_5018 = cute.get_leaves(%1921) : !cute.shape<"((2,2),(2,8))">
      %1922 = cute.get_stride(%lay_5014) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5019, %e1_5020, %e2_5021, %e3_5022 = cute.get_leaves(%1922) : !cute.stride<"((2,4),(1,8))">
      %iter_5023 = cute.get_iter(%1920) : !memref_rmem_f32_3
      %iter_5024 = cute.get_iter(%1920) : !memref_rmem_f32_3
      %coord_5025 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %slice_5026 = cute.slice(%1920, %coord_5025) : !memref_rmem_f32_3, !cute.coord<"(3,_)">
      %iter_5027 = cute.get_iter(%slice_5026) : !memref_rmem_f32_6
      %lay_5028 = cute.get_layout(%slice_5026) : !memref_rmem_f32_6
      %1923 = cute.get_shape(%lay_5028) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5029, %e1_5030 = cute.get_leaves(%1923) : !cute.shape<"((2,8))">
      %1924 = cute.memref.load_vec %slice_5026, row_major : !memref_rmem_f32_6
      %cst_5031 = arith.constant 0xFF800000 : f32
      %1925 = vector.reduction <maximumf>, %1924, %cst_5031 : vector<16xf32> into f32
      %c-1_i32_5032 = arith.constant -1 : i32
      %c2_i32_5033 = arith.constant 2 : i32
      %c31_i32_5034 = arith.constant 31 : i32
      %1926 = nvvm.shfl.sync  bfly %c-1_i32_5032, %1925, %c2_i32_5033, %c31_i32_5034 : f32 -> f32
      %1927 = nvvm.fmax %1925, %1926
      %c-1_i32_5035 = arith.constant -1 : i32
      %c1_i32_5036 = arith.constant 1 : i32
      %c31_i32_5037 = arith.constant 31 : i32
      %1928 = nvvm.shfl.sync  bfly %c-1_i32_5035, %1927, %c1_i32_5036, %c31_i32_5037 : f32 -> f32
      %1929 = nvvm.fmax %1927, %1928
      %1930 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1931 = arith.mulf %1924, %1930 : vector<16xf32>
      %1932 = arith.mulf %1929, %arg4 : f32
      %1933 = vector.broadcast %1932 : f32 to vector<16xf32>
      %1934 = arith.subf %1931, %1933 : vector<16xf32>
      %1935 = math.exp2 %1934 fastmath<fast> : vector<16xf32>
      %cst_5038 = arith.constant 0.000000e+00 : f32
      %1936 = vector.reduction <add>, %1935, %cst_5038 : vector<16xf32> into f32
      %coord_5039 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_906, %coord_5039, %1929) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_5040 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_911, %coord_5040, %1936) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_5041 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %slice_5042 = cute.slice(%1920, %coord_5041) : !memref_rmem_f32_3, !cute.coord<"(3,_)">
      %iter_5043 = cute.get_iter(%slice_5042) : !memref_rmem_f32_6
      %lay_5044 = cute.get_layout(%slice_5042) : !memref_rmem_f32_6
      %1937 = cute.get_shape(%lay_5044) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5045, %e1_5046 = cute.get_leaves(%1937) : !cute.shape<"((2,8))">
      %int_tuple_5047 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5048 = cute.size(%int_tuple_5047) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5049 = cute.get_leaves(%sz_5048) : !cute.int_tuple<"16">
      %int_tuple_5050 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5051 = cute.size(%int_tuple_5050) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5052 = cute.get_leaves(%sz_5051) : !cute.int_tuple<"16">
      cute.memref.store_vec %1935, %slice_5042, row_major : !memref_rmem_f32_6
      %lay_5053 = cute.get_layout(%rmem_943) : !memref_rmem_f32_2
      %1938 = cute.make_layout_like(%lay_5053) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_5054 = cute.memref.alloca(%1938) : !memref_rmem_bf16_12
      %iter_5055 = cute.get_iter(%rmem_5054) : !memref_rmem_bf16_12
      %iter_5056 = cute.get_iter(%rmem_5054) : !memref_rmem_bf16_12
      %1939 = cute.memref.load_vec %rmem_943, row_major : !memref_rmem_f32_2
      %1940 = arith.truncf %1939 : vector<64xf32> to vector<64xbf16>
      %lay_5057 = cute.get_layout(%rmem_5054) : !memref_rmem_bf16_12
      %1941 = cute.get_shape(%lay_5057) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_5058, %e1_5059, %e2_5060, %e3_5061 = cute.get_leaves(%1941) : !cute.shape<"((2,2),2,8)">
      %int_tuple_5062 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_5063 = cute.size(%int_tuple_5062) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_5064 = cute.get_leaves(%sz_5063) : !cute.int_tuple<"64">
      %int_tuple_5065 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_5066 = cute.size(%int_tuple_5065) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_5067 = cute.get_leaves(%sz_5066) : !cute.int_tuple<"64">
      cute.memref.store_vec %1940, %rmem_5054, row_major : !memref_rmem_bf16_12
      %lay_5068 = cute.get_layout(%rmem_5054) : !memref_rmem_bf16_12
      %tile_5069 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
      %div = cute.logical_divide(%lay_5068, %tile_5069) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.tile<"[_;_;2:1]">
      %1942 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_5070, %e1_5071, %e2_5072, %e3_5073, %e4_5074 = cute.get_leaves(%1942) : !cute.shape<"((2,2),2,(2,4))">
      %1943 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_5075, %e1_5076, %e2_5077, %e3_5078, %e4_5079 = cute.get_leaves(%1943) : !cute.shape<"((2,2),2,(2,4))">
      %1944 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_5080, %e1_5081, %e2_5082, %e3_5083, %e4_5084 = cute.get_leaves(%1944) : !cute.shape<"((2,2),2,(2,4))">
      %1945 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_5085, %e1_5086, %e2_5087, %e3_5088, %e4_5089 = cute.get_leaves(%1945) : !cute.shape<"((2,2),2,(2,4))">
      %1946 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_5090, %e1_5091, %e2_5092, %e3_5093, %e4_5094 = cute.get_leaves(%1946) : !cute.stride<"((1,2),4,(8,16))">
      %1947 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_5095, %e1_5096, %e2_5097, %e3_5098, %e4_5099 = cute.get_leaves(%1947) : !cute.stride<"((1,2),4,(8,16))">
      %1948 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_5100, %e1_5101, %e2_5102, %e3_5103, %e4_5104 = cute.get_leaves(%1948) : !cute.stride<"((1,2),4,(8,16))">
      %1949 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_5105, %e1_5106, %e2_5107, %e3_5108, %e4_5109 = cute.get_leaves(%1949) : !cute.stride<"((1,2),4,(8,16))">
      %shape_5110 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
      %stride_5111 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
      %lay_5112 = cute.make_layout(%shape_5110, %stride_5111) : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
      %view_5113 = cute.make_view(%iter_5056, %lay_5112) : !memref_rmem_bf16_13
      %iter_5114 = cute.get_iter(%view_5113) : !memref_rmem_bf16_13
      %coord_5115 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5116 = cute.slice(%src_partitioned_326, %coord_5115) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)">
      %iter_5117 = cute.get_iter(%slice_5116) : !memref_smem_bf16_18
      %coord_5118 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5119 = cute.slice(%retiled_328, %coord_5118) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)">
      %iter_5120 = cute.get_iter(%slice_5119) : !memref_rmem_bf16_14
      %lay_5121 = cute.get_layout(%slice_5116) : !memref_smem_bf16_18
      %1950 = cute.get_shape(%lay_5121) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5122, %e1_5123, %e2_5124, %e3_5125, %e4_5126 = cute.get_leaves(%1950) : !cute.shape<"((8,1),((2,2),2))">
      %lay_5127 = cute.get_layout(%slice_5119) : !memref_rmem_bf16_14
      %1951 = cute.get_shape(%lay_5127) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5128, %e1_5129, %e2_5130, %e3_5131 = cute.get_leaves(%1951) : !cute.shape<"((8,1),(4,2))">
      %lay_5132 = cute.get_layout(%slice_5116) : !memref_smem_bf16_18
      %shape_5133 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5134 = cute.make_layout(%shape_5133) : !cute.layout<"1:0">
      %append_5135 = cute.append_to_rank<2> (%lay_5132, %lay_5134) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_5136 = cute.make_view(%iter_5117, %append_5135) : !memref_smem_bf16_18
      %iter_5137 = cute.get_iter(%view_5136) : !memref_smem_bf16_18
      %lay_5138 = cute.get_layout(%view_5136) : !memref_smem_bf16_18
      %1952 = cute.get_shape(%lay_5138) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5139, %e1_5140, %e2_5141, %e3_5142, %e4_5143 = cute.get_leaves(%1952) : !cute.shape<"((8,1),((2,2),2))">
      %grouped_5144 = cute.group_modes(%view_5136) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
      %iter_5145 = cute.get_iter(%grouped_5144) : !memref_smem_bf16_19
      %iter_5146 = cute.get_iter(%grouped_5144) : !memref_smem_bf16_19
      %lay_5147 = cute.get_layout(%slice_5119) : !memref_rmem_bf16_14
      %shape_5148 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5149 = cute.make_layout(%shape_5148) : !cute.layout<"1:0">
      %append_5150 = cute.append_to_rank<2> (%lay_5147, %lay_5149) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_5151 = cute.make_view(%iter_5120, %append_5150) : !memref_rmem_bf16_14
      %iter_5152 = cute.get_iter(%view_5151) : !memref_rmem_bf16_14
      %lay_5153 = cute.get_layout(%view_5151) : !memref_rmem_bf16_14
      %1953 = cute.get_shape(%lay_5153) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5154, %e1_5155, %e2_5156, %e3_5157 = cute.get_leaves(%1953) : !cute.shape<"((8,1),(4,2))">
      %grouped_5158 = cute.group_modes(%view_5151) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
      %iter_5159 = cute.get_iter(%grouped_5158) : !memref_rmem_bf16_15
      %iter_5160 = cute.get_iter(%grouped_5158) : !memref_rmem_bf16_15
      %lay_5161 = cute.get_layout(%grouped_5144) : !memref_smem_bf16_19
      %1954 = cute.get_shape(%lay_5161) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_5162, %e1_5163, %e2_5164, %e3_5165, %e4_5166 = cute.get_leaves(%1954) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_5167 = cute.get_layout(%grouped_5158) : !memref_rmem_bf16_15
      %1955 = cute.get_shape(%lay_5167) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_5168, %e1_5169, %e2_5170, %e3_5171 = cute.get_leaves(%1955) : !cute.shape<"((8,1),((4,2)))">
      %sz_5172 = cute.size(%grouped_5144) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
      %e0_5173 = cute.get_leaves(%sz_5172) : !cute.int_tuple<"8">
      %sz_5174 = cute.size(%grouped_5158) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
      %e0_5175 = cute.get_leaves(%sz_5174) : !cute.int_tuple<"8">
      cute.copy(%144, %grouped_5144, %grouped_5158) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
      %lay_5176 = cute.get_layout(%view_5113) : !memref_rmem_bf16_13
      %1956 = cute.get_shape(%lay_5176) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
      %e0_5177, %e1_5178, %e2_5179, %e3_5180, %e4_5181 = cute.get_leaves(%1956) : !cute.shape<"(((2,2),2),2,4)">
      %int_tuple_5182 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_5183 = cute.size(%int_tuple_5182) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_5184 = cute.get_leaves(%sz_5183) : !cute.int_tuple<"4">
      %int_tuple_5185 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_5186 = cute.size(%int_tuple_5185) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_5187 = cute.get_leaves(%sz_5186) : !cute.int_tuple<"4">
      %coord_5188 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_5189 = cute.slice(%src_partitioned_326, %coord_5188) : !memref_smem_bf16_10, !cute.coord<"(_,_,1)">
      %iter_5190 = cute.get_iter(%slice_5189) : !memref_smem_bf16_18
      %coord_5191 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_5192 = cute.slice(%retiled_328, %coord_5191) : !memref_rmem_bf16_5, !cute.coord<"(_,_,1)">
      %iter_5193 = cute.get_iter(%slice_5192) : !memref_rmem_bf16_14
      %lay_5194 = cute.get_layout(%slice_5189) : !memref_smem_bf16_18
      %1957 = cute.get_shape(%lay_5194) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5195, %e1_5196, %e2_5197, %e3_5198, %e4_5199 = cute.get_leaves(%1957) : !cute.shape<"((8,1),((2,2),2))">
      %lay_5200 = cute.get_layout(%slice_5192) : !memref_rmem_bf16_14
      %1958 = cute.get_shape(%lay_5200) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5201, %e1_5202, %e2_5203, %e3_5204 = cute.get_leaves(%1958) : !cute.shape<"((8,1),(4,2))">
      %lay_5205 = cute.get_layout(%slice_5189) : !memref_smem_bf16_18
      %shape_5206 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5207 = cute.make_layout(%shape_5206) : !cute.layout<"1:0">
      %append_5208 = cute.append_to_rank<2> (%lay_5205, %lay_5207) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_5209 = cute.make_view(%iter_5190, %append_5208) : !memref_smem_bf16_18
      %iter_5210 = cute.get_iter(%view_5209) : !memref_smem_bf16_18
      %lay_5211 = cute.get_layout(%view_5209) : !memref_smem_bf16_18
      %1959 = cute.get_shape(%lay_5211) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5212, %e1_5213, %e2_5214, %e3_5215, %e4_5216 = cute.get_leaves(%1959) : !cute.shape<"((8,1),((2,2),2))">
      %grouped_5217 = cute.group_modes(%view_5209) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
      %iter_5218 = cute.get_iter(%grouped_5217) : !memref_smem_bf16_19
      %iter_5219 = cute.get_iter(%grouped_5217) : !memref_smem_bf16_19
      %lay_5220 = cute.get_layout(%slice_5192) : !memref_rmem_bf16_14
      %shape_5221 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5222 = cute.make_layout(%shape_5221) : !cute.layout<"1:0">
      %append_5223 = cute.append_to_rank<2> (%lay_5220, %lay_5222) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_5224 = cute.make_view(%iter_5193, %append_5223) : !memref_rmem_bf16_14
      %iter_5225 = cute.get_iter(%view_5224) : !memref_rmem_bf16_14
      %lay_5226 = cute.get_layout(%view_5224) : !memref_rmem_bf16_14
      %1960 = cute.get_shape(%lay_5226) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5227, %e1_5228, %e2_5229, %e3_5230 = cute.get_leaves(%1960) : !cute.shape<"((8,1),(4,2))">
      %grouped_5231 = cute.group_modes(%view_5224) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
      %iter_5232 = cute.get_iter(%grouped_5231) : !memref_rmem_bf16_15
      %iter_5233 = cute.get_iter(%grouped_5231) : !memref_rmem_bf16_15
      %lay_5234 = cute.get_layout(%grouped_5217) : !memref_smem_bf16_19
      %1961 = cute.get_shape(%lay_5234) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_5235, %e1_5236, %e2_5237, %e3_5238, %e4_5239 = cute.get_leaves(%1961) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_5240 = cute.get_layout(%grouped_5231) : !memref_rmem_bf16_15
      %1962 = cute.get_shape(%lay_5240) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_5241, %e1_5242, %e2_5243, %e3_5244 = cute.get_leaves(%1962) : !cute.shape<"((8,1),((4,2)))">
      %sz_5245 = cute.size(%grouped_5217) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
      %e0_5246 = cute.get_leaves(%sz_5245) : !cute.int_tuple<"8">
      %sz_5247 = cute.size(%grouped_5231) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
      %e0_5248 = cute.get_leaves(%sz_5247) : !cute.int_tuple<"8">
      cute.copy(%144, %grouped_5217, %grouped_5231) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
      %coord_5249 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5250 = cute.slice(%view_5113, %coord_5249) : !memref_rmem_bf16_13, !cute.coord<"(_,_,0)">
      %iter_5251 = cute.get_iter(%slice_5250) : !memref_rmem_bf16_16
      %coord_5252 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5253 = cute.slice(%frg_B_253, %coord_5252) : !memref_rmem_bf16_2, !cute.coord<"(_,_,0)">
      %iter_5254 = cute.get_iter(%slice_5253) : !memref_rmem_bf16_17
      %lay_5255 = cute.get_layout(%slice_5250) : !memref_rmem_bf16_16
      %1963 = cute.get_shape(%lay_5255) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_5256, %e1_5257, %e2_5258, %e3_5259 = cute.get_leaves(%1963) : !cute.shape<"(((2,2),2),2)">
      %lay_5260 = cute.get_layout(%slice_5253) : !memref_rmem_bf16_17
      %1964 = cute.get_shape(%lay_5260) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_5261, %e1_5262, %e2_5263, %e3_5264 = cute.get_leaves(%1964) : !cute.shape<"((2,2),(8,2))">
      %lay_5265 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %1965 = cute.get_shape(%lay_5265) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5266, %e1_5267, %e2_5268, %e3_5269 = cute.get_leaves(%1965) : !cute.shape<"((2,2),2,16)">
      cute.gemm(%5, %rmem, %slice_5250, %slice_5253, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
      %int_tuple_5270 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_5271 = cute.size(%int_tuple_5270) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_5272 = cute.get_leaves(%sz_5271) : !cute.int_tuple<"4">
      %coord_5273 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_5274 = cute.slice(%src_partitioned_326, %coord_5273) : !memref_smem_bf16_10, !cute.coord<"(_,_,2)">
      %iter_5275 = cute.get_iter(%slice_5274) : !memref_smem_bf16_18
      %coord_5276 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_5277 = cute.slice(%retiled_328, %coord_5276) : !memref_rmem_bf16_5, !cute.coord<"(_,_,2)">
      %iter_5278 = cute.get_iter(%slice_5277) : !memref_rmem_bf16_14
      %lay_5279 = cute.get_layout(%slice_5274) : !memref_smem_bf16_18
      %1966 = cute.get_shape(%lay_5279) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5280, %e1_5281, %e2_5282, %e3_5283, %e4_5284 = cute.get_leaves(%1966) : !cute.shape<"((8,1),((2,2),2))">
      %lay_5285 = cute.get_layout(%slice_5277) : !memref_rmem_bf16_14
      %1967 = cute.get_shape(%lay_5285) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5286, %e1_5287, %e2_5288, %e3_5289 = cute.get_leaves(%1967) : !cute.shape<"((8,1),(4,2))">
      %lay_5290 = cute.get_layout(%slice_5274) : !memref_smem_bf16_18
      %shape_5291 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5292 = cute.make_layout(%shape_5291) : !cute.layout<"1:0">
      %append_5293 = cute.append_to_rank<2> (%lay_5290, %lay_5292) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_5294 = cute.make_view(%iter_5275, %append_5293) : !memref_smem_bf16_18
      %iter_5295 = cute.get_iter(%view_5294) : !memref_smem_bf16_18
      %lay_5296 = cute.get_layout(%view_5294) : !memref_smem_bf16_18
      %1968 = cute.get_shape(%lay_5296) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5297, %e1_5298, %e2_5299, %e3_5300, %e4_5301 = cute.get_leaves(%1968) : !cute.shape<"((8,1),((2,2),2))">
      %grouped_5302 = cute.group_modes(%view_5294) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
      %iter_5303 = cute.get_iter(%grouped_5302) : !memref_smem_bf16_19
      %iter_5304 = cute.get_iter(%grouped_5302) : !memref_smem_bf16_19
      %lay_5305 = cute.get_layout(%slice_5277) : !memref_rmem_bf16_14
      %shape_5306 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5307 = cute.make_layout(%shape_5306) : !cute.layout<"1:0">
      %append_5308 = cute.append_to_rank<2> (%lay_5305, %lay_5307) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_5309 = cute.make_view(%iter_5278, %append_5308) : !memref_rmem_bf16_14
      %iter_5310 = cute.get_iter(%view_5309) : !memref_rmem_bf16_14
      %lay_5311 = cute.get_layout(%view_5309) : !memref_rmem_bf16_14
      %1969 = cute.get_shape(%lay_5311) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5312, %e1_5313, %e2_5314, %e3_5315 = cute.get_leaves(%1969) : !cute.shape<"((8,1),(4,2))">
      %grouped_5316 = cute.group_modes(%view_5309) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
      %iter_5317 = cute.get_iter(%grouped_5316) : !memref_rmem_bf16_15
      %iter_5318 = cute.get_iter(%grouped_5316) : !memref_rmem_bf16_15
      %lay_5319 = cute.get_layout(%grouped_5302) : !memref_smem_bf16_19
      %1970 = cute.get_shape(%lay_5319) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_5320, %e1_5321, %e2_5322, %e3_5323, %e4_5324 = cute.get_leaves(%1970) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_5325 = cute.get_layout(%grouped_5316) : !memref_rmem_bf16_15
      %1971 = cute.get_shape(%lay_5325) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_5326, %e1_5327, %e2_5328, %e3_5329 = cute.get_leaves(%1971) : !cute.shape<"((8,1),((4,2)))">
      %sz_5330 = cute.size(%grouped_5302) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
      %e0_5331 = cute.get_leaves(%sz_5330) : !cute.int_tuple<"8">
      %sz_5332 = cute.size(%grouped_5316) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
      %e0_5333 = cute.get_leaves(%sz_5332) : !cute.int_tuple<"8">
      cute.copy(%144, %grouped_5302, %grouped_5316) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
      %coord_5334 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_5335 = cute.slice(%view_5113, %coord_5334) : !memref_rmem_bf16_13, !cute.coord<"(_,_,1)">
      %iter_5336 = cute.get_iter(%slice_5335) : !memref_rmem_bf16_16
      %coord_5337 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %slice_5338 = cute.slice(%frg_B_253, %coord_5337) : !memref_rmem_bf16_2, !cute.coord<"(_,_,1)">
      %iter_5339 = cute.get_iter(%slice_5338) : !memref_rmem_bf16_17
      %lay_5340 = cute.get_layout(%slice_5335) : !memref_rmem_bf16_16
      %1972 = cute.get_shape(%lay_5340) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_5341, %e1_5342, %e2_5343, %e3_5344 = cute.get_leaves(%1972) : !cute.shape<"(((2,2),2),2)">
      %lay_5345 = cute.get_layout(%slice_5338) : !memref_rmem_bf16_17
      %1973 = cute.get_shape(%lay_5345) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_5346, %e1_5347, %e2_5348, %e3_5349 = cute.get_leaves(%1973) : !cute.shape<"((2,2),(8,2))">
      cute.gemm(%5, %rmem, %slice_5335, %slice_5338, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
      %int_tuple_5350 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_5351 = cute.size(%int_tuple_5350) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_5352 = cute.get_leaves(%sz_5351) : !cute.int_tuple<"4">
      %coord_5353 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_5354 = cute.slice(%src_partitioned_326, %coord_5353) : !memref_smem_bf16_10, !cute.coord<"(_,_,3)">
      %iter_5355 = cute.get_iter(%slice_5354) : !memref_smem_bf16_18
      %coord_5356 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_5357 = cute.slice(%retiled_328, %coord_5356) : !memref_rmem_bf16_5, !cute.coord<"(_,_,3)">
      %iter_5358 = cute.get_iter(%slice_5357) : !memref_rmem_bf16_14
      %lay_5359 = cute.get_layout(%slice_5354) : !memref_smem_bf16_18
      %1974 = cute.get_shape(%lay_5359) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5360, %e1_5361, %e2_5362, %e3_5363, %e4_5364 = cute.get_leaves(%1974) : !cute.shape<"((8,1),((2,2),2))">
      %lay_5365 = cute.get_layout(%slice_5357) : !memref_rmem_bf16_14
      %1975 = cute.get_shape(%lay_5365) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5366, %e1_5367, %e2_5368, %e3_5369 = cute.get_leaves(%1975) : !cute.shape<"((8,1),(4,2))">
      %lay_5370 = cute.get_layout(%slice_5354) : !memref_smem_bf16_18
      %shape_5371 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5372 = cute.make_layout(%shape_5371) : !cute.layout<"1:0">
      %append_5373 = cute.append_to_rank<2> (%lay_5370, %lay_5372) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_5374 = cute.make_view(%iter_5355, %append_5373) : !memref_smem_bf16_18
      %iter_5375 = cute.get_iter(%view_5374) : !memref_smem_bf16_18
      %lay_5376 = cute.get_layout(%view_5374) : !memref_smem_bf16_18
      %1976 = cute.get_shape(%lay_5376) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5377, %e1_5378, %e2_5379, %e3_5380, %e4_5381 = cute.get_leaves(%1976) : !cute.shape<"((8,1),((2,2),2))">
      %grouped_5382 = cute.group_modes(%view_5374) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
      %iter_5383 = cute.get_iter(%grouped_5382) : !memref_smem_bf16_19
      %iter_5384 = cute.get_iter(%grouped_5382) : !memref_smem_bf16_19
      %lay_5385 = cute.get_layout(%slice_5357) : !memref_rmem_bf16_14
      %shape_5386 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5387 = cute.make_layout(%shape_5386) : !cute.layout<"1:0">
      %append_5388 = cute.append_to_rank<2> (%lay_5385, %lay_5387) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_5389 = cute.make_view(%iter_5358, %append_5388) : !memref_rmem_bf16_14
      %iter_5390 = cute.get_iter(%view_5389) : !memref_rmem_bf16_14
      %lay_5391 = cute.get_layout(%view_5389) : !memref_rmem_bf16_14
      %1977 = cute.get_shape(%lay_5391) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5392, %e1_5393, %e2_5394, %e3_5395 = cute.get_leaves(%1977) : !cute.shape<"((8,1),(4,2))">
      %grouped_5396 = cute.group_modes(%view_5389) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
      %iter_5397 = cute.get_iter(%grouped_5396) : !memref_rmem_bf16_15
      %iter_5398 = cute.get_iter(%grouped_5396) : !memref_rmem_bf16_15
      %lay_5399 = cute.get_layout(%grouped_5382) : !memref_smem_bf16_19
      %1978 = cute.get_shape(%lay_5399) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_5400, %e1_5401, %e2_5402, %e3_5403, %e4_5404 = cute.get_leaves(%1978) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_5405 = cute.get_layout(%grouped_5396) : !memref_rmem_bf16_15
      %1979 = cute.get_shape(%lay_5405) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_5406, %e1_5407, %e2_5408, %e3_5409 = cute.get_leaves(%1979) : !cute.shape<"((8,1),((4,2)))">
      %sz_5410 = cute.size(%grouped_5382) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
      %e0_5411 = cute.get_leaves(%sz_5410) : !cute.int_tuple<"8">
      %sz_5412 = cute.size(%grouped_5396) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
      %e0_5413 = cute.get_leaves(%sz_5412) : !cute.int_tuple<"8">
      cute.copy(%144, %grouped_5382, %grouped_5396) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
      %coord_5414 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_5415 = cute.slice(%view_5113, %coord_5414) : !memref_rmem_bf16_13, !cute.coord<"(_,_,2)">
      %iter_5416 = cute.get_iter(%slice_5415) : !memref_rmem_bf16_16
      %coord_5417 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %slice_5418 = cute.slice(%frg_B_253, %coord_5417) : !memref_rmem_bf16_2, !cute.coord<"(_,_,2)">
      %iter_5419 = cute.get_iter(%slice_5418) : !memref_rmem_bf16_17
      %lay_5420 = cute.get_layout(%slice_5415) : !memref_rmem_bf16_16
      %1980 = cute.get_shape(%lay_5420) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_5421, %e1_5422, %e2_5423, %e3_5424 = cute.get_leaves(%1980) : !cute.shape<"(((2,2),2),2)">
      %lay_5425 = cute.get_layout(%slice_5418) : !memref_rmem_bf16_17
      %1981 = cute.get_shape(%lay_5425) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_5426, %e1_5427, %e2_5428, %e3_5429 = cute.get_leaves(%1981) : !cute.shape<"((2,2),(8,2))">
      cute.gemm(%5, %rmem, %slice_5415, %slice_5418, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
      %int_tuple_5430 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_5431 = cute.size(%int_tuple_5430) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_5432 = cute.get_leaves(%sz_5431) : !cute.int_tuple<"4">
      %coord_5433 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5434 = cute.slice(%src_partitioned_326, %coord_5433) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)">
      %iter_5435 = cute.get_iter(%slice_5434) : !memref_smem_bf16_18
      %coord_5436 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %slice_5437 = cute.slice(%retiled_328, %coord_5436) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)">
      %iter_5438 = cute.get_iter(%slice_5437) : !memref_rmem_bf16_14
      %lay_5439 = cute.get_layout(%slice_5434) : !memref_smem_bf16_18
      %1982 = cute.get_shape(%lay_5439) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5440, %e1_5441, %e2_5442, %e3_5443, %e4_5444 = cute.get_leaves(%1982) : !cute.shape<"((8,1),((2,2),2))">
      %lay_5445 = cute.get_layout(%slice_5437) : !memref_rmem_bf16_14
      %1983 = cute.get_shape(%lay_5445) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5446, %e1_5447, %e2_5448, %e3_5449 = cute.get_leaves(%1983) : !cute.shape<"((8,1),(4,2))">
      %lay_5450 = cute.get_layout(%slice_5434) : !memref_smem_bf16_18
      %shape_5451 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5452 = cute.make_layout(%shape_5451) : !cute.layout<"1:0">
      %append_5453 = cute.append_to_rank<2> (%lay_5450, %lay_5452) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_5454 = cute.make_view(%iter_5435, %append_5453) : !memref_smem_bf16_18
      %iter_5455 = cute.get_iter(%view_5454) : !memref_smem_bf16_18
      %lay_5456 = cute.get_layout(%view_5454) : !memref_smem_bf16_18
      %1984 = cute.get_shape(%lay_5456) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_5457, %e1_5458, %e2_5459, %e3_5460, %e4_5461 = cute.get_leaves(%1984) : !cute.shape<"((8,1),((2,2),2))">
      %grouped_5462 = cute.group_modes(%view_5454) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
      %iter_5463 = cute.get_iter(%grouped_5462) : !memref_smem_bf16_19
      %iter_5464 = cute.get_iter(%grouped_5462) : !memref_smem_bf16_19
      %lay_5465 = cute.get_layout(%slice_5437) : !memref_rmem_bf16_14
      %shape_5466 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5467 = cute.make_layout(%shape_5466) : !cute.layout<"1:0">
      %append_5468 = cute.append_to_rank<2> (%lay_5465, %lay_5467) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_5469 = cute.make_view(%iter_5438, %append_5468) : !memref_rmem_bf16_14
      %iter_5470 = cute.get_iter(%view_5469) : !memref_rmem_bf16_14
      %lay_5471 = cute.get_layout(%view_5469) : !memref_rmem_bf16_14
      %1985 = cute.get_shape(%lay_5471) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_5472, %e1_5473, %e2_5474, %e3_5475 = cute.get_leaves(%1985) : !cute.shape<"((8,1),(4,2))">
      %grouped_5476 = cute.group_modes(%view_5469) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
      %iter_5477 = cute.get_iter(%grouped_5476) : !memref_rmem_bf16_15
      %iter_5478 = cute.get_iter(%grouped_5476) : !memref_rmem_bf16_15
      %lay_5479 = cute.get_layout(%grouped_5462) : !memref_smem_bf16_19
      %1986 = cute.get_shape(%lay_5479) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_5480, %e1_5481, %e2_5482, %e3_5483, %e4_5484 = cute.get_leaves(%1986) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_5485 = cute.get_layout(%grouped_5476) : !memref_rmem_bf16_15
      %1987 = cute.get_shape(%lay_5485) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_5486, %e1_5487, %e2_5488, %e3_5489 = cute.get_leaves(%1987) : !cute.shape<"((8,1),((4,2)))">
      %sz_5490 = cute.size(%grouped_5462) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
      %e0_5491 = cute.get_leaves(%sz_5490) : !cute.int_tuple<"8">
      %sz_5492 = cute.size(%grouped_5476) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
      %e0_5493 = cute.get_leaves(%sz_5492) : !cute.int_tuple<"8">
      cute.copy(%144, %grouped_5462, %grouped_5476) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
      %coord_5494 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_5495 = cute.slice(%view_5113, %coord_5494) : !memref_rmem_bf16_13, !cute.coord<"(_,_,3)">
      %iter_5496 = cute.get_iter(%slice_5495) : !memref_rmem_bf16_16
      %coord_5497 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %slice_5498 = cute.slice(%frg_B_253, %coord_5497) : !memref_rmem_bf16_2, !cute.coord<"(_,_,3)">
      %iter_5499 = cute.get_iter(%slice_5498) : !memref_rmem_bf16_17
      %lay_5500 = cute.get_layout(%slice_5495) : !memref_rmem_bf16_16
      %1988 = cute.get_shape(%lay_5500) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_5501, %e1_5502, %e2_5503, %e3_5504 = cute.get_leaves(%1988) : !cute.shape<"(((2,2),2),2)">
      %lay_5505 = cute.get_layout(%slice_5498) : !memref_rmem_bf16_17
      %1989 = cute.get_shape(%lay_5505) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_5506, %e1_5507, %e2_5508, %e3_5509 = cute.get_leaves(%1989) : !cute.shape<"((2,2),(8,2))">
      cute.gemm(%5, %rmem, %slice_5495, %slice_5498, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
      %c1_i32_5510 = arith.constant 1 : i32
      %1990:7 = scf.for %arg5 = %c1_i32_5510 to %126 step %c1_i32_5510 iter_args(%arg6 = %476, %arg7 = %117, %arg8 = %476, %arg9 = %arg0, %arg10 = %arg1, %arg11 = %118, %arg12 = %119) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_6239 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_6240 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %lay_6241 = cute.get_layout(%arg9) : !memref_gmem_bf16_
        %2344 = cute.get_shape(%lay_6241) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6242, %e1_6243, %e2_6244, %e3_6245 = cute.get_leaves(%2344) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6246 = cute.to_int_tuple(%e0_6242) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2345 = cute.get_scalars(%itup_6246) : !cute.int_tuple<"?">
        %itup_6247 = cute.to_int_tuple(%e1_6243) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2346 = cute.get_scalars(%itup_6247) : !cute.int_tuple<"?">
        %itup_6248 = cute.to_int_tuple(%e2_6244) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2347 = cute.get_scalars(%itup_6248) : !cute.int_tuple<"?">
        %itup_6249 = cute.to_int_tuple(%e3_6245) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2348 = cute.get_scalars(%itup_6249) : !cute.int_tuple<"?{div=8}">
        %2349 = cute.get_stride(%lay_6241) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_6250, %e1_6251, %e2_6252, %e3_6253 = cute.get_leaves(%2349) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_6254 = cute.to_int_tuple(%e0_6250) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2350 = cute.get_scalars(%itup_6254) : !cute.int_tuple<"?{i64 div=8}">
        %itup_6255 = cute.to_int_tuple(%e1_6251) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2351 = cute.get_scalars(%itup_6255) : !cute.int_tuple<"?{i64 div=8}">
        %itup_6256 = cute.to_int_tuple(%e2_6252) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2352 = cute.get_scalars(%itup_6256) : !cute.int_tuple<"?{i64 div=8}">
        %lay_6257 = cute.get_layout(%arg10) : !memref_gmem_bf16_
        %2353 = cute.get_shape(%lay_6257) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_6258, %e1_6259, %e2_6260, %e3_6261 = cute.get_leaves(%2353) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_6262 = cute.to_int_tuple(%e0_6258) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2354 = cute.get_scalars(%itup_6262) : !cute.int_tuple<"?">
        %itup_6263 = cute.to_int_tuple(%e1_6259) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2355 = cute.get_scalars(%itup_6263) : !cute.int_tuple<"?">
        %itup_6264 = cute.to_int_tuple(%e2_6260) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2356 = cute.get_scalars(%itup_6264) : !cute.int_tuple<"?">
        %itup_6265 = cute.to_int_tuple(%e3_6261) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2357 = cute.get_scalars(%itup_6265) : !cute.int_tuple<"?{div=8}">
        %2358 = cute.get_stride(%lay_6257) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_6266, %e1_6267, %e2_6268, %e3_6269 = cute.get_leaves(%2358) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_6270 = cute.to_int_tuple(%e0_6266) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2359 = cute.get_scalars(%itup_6270) : !cute.int_tuple<"?{i64 div=8}">
        %itup_6271 = cute.to_int_tuple(%e1_6267) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2360 = cute.get_scalars(%itup_6271) : !cute.int_tuple<"?{i64 div=8}">
        %itup_6272 = cute.to_int_tuple(%e2_6268) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2361 = cute.get_scalars(%itup_6272) : !cute.int_tuple<"?{i64 div=8}">
        %iter_6273 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_6274 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %2362 = arith.subi %126, %arg5 : i32
        %c1_i32_6275 = arith.constant 1 : i32
        %2363 = arith.subi %2362, %c1_i32_6275 : i32
        %shape_6276 = cute.make_shape() : () -> !cute.shape<"(128,64)">
        %2364 = cute.tiled.mma.partition_shape C (%5, %shape_6276) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
        %e0_6277, %e1_6278, %e2_6279, %e3_6280 = cute.get_leaves(%2364) : !cute.shape<"((2,2),2,8)">
        %shape_6281 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_6282 = cute.make_layout(%shape_6281) : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_6283 = cute.memref.alloca(%lay_6282) : !memref_rmem_f32_2
        %iter_6284 = cute.get_iter(%rmem_6283) : !memref_rmem_f32_2
        %iter_6285 = cute.get_iter(%rmem_6283) : !memref_rmem_f32_2
        %sz_6286 = cute.size(%rmem_6283) : (!memref_rmem_f32_2) -> !cute.int_tuple<"64">
        %e0_6287 = cute.get_leaves(%sz_6286) : !cute.int_tuple<"64">
        %lay_6288 = cute.get_layout(%rmem_6283) : !memref_rmem_f32_2
        %2365 = cute.get_shape(%lay_6288) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_6289, %e1_6290, %e2_6291, %e3_6292 = cute.get_leaves(%2365) : !cute.shape<"((2,2),2,8)">
        %int_tuple_6293 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %res_6294 = cute.tuple.product(%int_tuple_6293) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_6295 = cute.get_leaves(%res_6294) : !cute.int_tuple<"64">
        %cst_6296 = arith.constant 0.000000e+00 : f32
        %2366 = vector.splat %cst_6296 : vector<64xf32>
        %int_tuple_6297 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_6298 = cute.size(%int_tuple_6297) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_6299 = cute.get_leaves(%sz_6298) : !cute.int_tuple<"64">
        %int_tuple_6300 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_6301 = cute.size(%int_tuple_6300) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_6302 = cute.get_leaves(%sz_6301) : !cute.int_tuple<"64">
        cute.memref.store_vec %2366, %rmem_6283, row_major : !memref_rmem_f32_2
        nvvm.cp.async.wait.group 0
        %c1_i32_6303 = arith.constant 1 : i32
        %c128_i32_6304 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_6303 number_of_threads = %c128_i32_6304
        %false_6305 = arith.constant false
        scf.if %false_6305 {
          %lay_8150 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
          %2684 = cute.get_shape(%lay_8150) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8151, %e1_8152, %e2_8153, %e3_8154 = cute.get_leaves(%2684) : !cute.shape<"((8,1),4,2)">
          %int_tuple_8155 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_8156 = cute.size(%int_tuple_8155) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_8157 = cute.get_leaves(%sz_8156) : !cute.int_tuple<"4">
          %coord_8158 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %slice_8159 = cute.slice(%src_partitioned_398, %coord_8158) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)">
          %iter_8160 = cute.get_iter(%slice_8159) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8161, %e1_8162, %e2_8163, %e3_8164 = cute.get_leaves(%iter_8160) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2685 = cute.get_scalars(%e0_8161) : !cute.int_tuple<"?">
          %2686 = cute.get_scalars(%e1_8162) : !cute.int_tuple<"?">
          %2687 = cute.get_scalars(%e2_8163) : !cute.int_tuple<"?">
          %2688 = cute.get_scalars(%e3_8164) : !cute.int_tuple<"?{div=8}">
          %iter_8165 = cute.get_iter(%slice_8159) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8166, %e1_8167, %e2_8168, %e3_8169 = cute.get_leaves(%iter_8165) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2689 = cute.get_scalars(%e0_8166) : !cute.int_tuple<"?">
          %2690 = cute.get_scalars(%e1_8167) : !cute.int_tuple<"?">
          %2691 = cute.get_scalars(%e2_8168) : !cute.int_tuple<"?">
          %2692 = cute.get_scalars(%e3_8169) : !cute.int_tuple<"?{div=8}">
          %iter_8170 = cute.get_iter(%slice_8159) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8171, %e1_8172, %e2_8173, %e3_8174 = cute.get_leaves(%iter_8170) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2693 = cute.get_scalars(%e0_8171) : !cute.int_tuple<"?">
          %2694 = cute.get_scalars(%e1_8172) : !cute.int_tuple<"?">
          %2695 = cute.get_scalars(%e2_8173) : !cute.int_tuple<"?">
          %2696 = cute.get_scalars(%e3_8174) : !cute.int_tuple<"?{div=8}">
          %lay_8175 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2697 = cute.get_shape(%lay_8175) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_8176, %e1_8177, %e2_8178, %e3_8179 = cute.get_leaves(%2697) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_8180 = cute.to_int_tuple(%e0_8176) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2698 = cute.get_scalars(%itup_8180) : !cute.int_tuple<"?">
          %itup_8181 = cute.to_int_tuple(%e1_8177) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2699 = cute.get_scalars(%itup_8181) : !cute.int_tuple<"?">
          %itup_8182 = cute.to_int_tuple(%e2_8178) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2700 = cute.get_scalars(%itup_8182) : !cute.int_tuple<"?">
          %itup_8183 = cute.to_int_tuple(%e3_8179) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2701 = cute.get_scalars(%itup_8183) : !cute.int_tuple<"?{div=8}">
          %coord_8184 = cute.make_coord(%e1_8172) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_8185 = cute.make_coord(%itup_8181) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2702 = cute.elem_less(%coord_8184, %coord_8185) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2702 {
            %coord_8270 = cute.make_coord(%2363) : (i32) -> !cute.coord<"(_,0,_,?)">
            %slice_8271 = cute.slice(%src_partitioned_239, %coord_8270) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_gmem_bf16_6
            %coord_8273 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %slice_8274 = cute.slice(%dst_partitioned_242, %coord_8273) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
            %iter_8275 = cute.get_iter(%slice_8274) : !memref_smem_bf16_13
            %coord_8276 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %slice_8277 = cute.slice(%rmem_435, %coord_8276) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)">
            %iter_8278 = cute.get_iter(%slice_8277) : !memref_rmem_i8_2
            %lay_8279 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %2757 = cute.get_shape(%lay_8279) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8280, %e1_8281, %e2_8282 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %lay_8283 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %2758 = cute.get_shape(%lay_8283) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8284, %e1_8285, %e2_8286 = cute.get_leaves(%2758) : !cute.shape<"((8,1),2)">
            %lay_8287 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %shape_8288 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8289 = cute.make_layout(%shape_8288) : !cute.layout<"1:0">
            %append_8290 = cute.append_to_rank<2> (%lay_8287, %lay_8289) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_8291 = cute.make_view(%iter_8272, %append_8290) : !memref_gmem_bf16_6
            %iter_8292 = cute.get_iter(%view_8291) : !memref_gmem_bf16_6
            %lay_8293 = cute.get_layout(%view_8291) : !memref_gmem_bf16_6
            %2759 = cute.get_shape(%lay_8293) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8294, %e1_8295, %e2_8296 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)">
            %grouped_8297 = cute.group_modes(%view_8291) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
            %iter_8298 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %iter_8299 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %lay_8300 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %shape_8301 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8302 = cute.make_layout(%shape_8301) : !cute.layout<"1:0">
            %append_8303 = cute.append_to_rank<2> (%lay_8300, %lay_8302) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_8304 = cute.make_view(%iter_8275, %append_8303) : !memref_smem_bf16_13
            %iter_8305 = cute.get_iter(%view_8304) : !memref_smem_bf16_13
            %lay_8306 = cute.get_layout(%view_8304) : !memref_smem_bf16_13
            %2760 = cute.get_shape(%lay_8306) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8307, %e1_8308, %e2_8309 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)">
            %grouped_8310 = cute.group_modes(%view_8304) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
            %iter_8311 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %iter_8312 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %lay_8313 = cute.get_layout(%slice_8277) : !memref_rmem_i8_2
            %shape_8314 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8315 = cute.make_layout(%shape_8314) : !cute.layout<"1:0">
            %append_8316 = cute.append_to_rank<2> (%lay_8313, %lay_8315) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_8317 = cute.make_view(%iter_8278, %append_8316) : !memref_rmem_i8_2
            %iter_8318 = cute.get_iter(%view_8317) : !memref_rmem_i8_2
            %lay_8319 = cute.get_layout(%view_8317) : !memref_rmem_i8_2
            %2761 = cute.get_shape(%lay_8319) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_8320, %e1_8321 = cute.get_leaves(%2761) : !cute.shape<"(1,2)">
            %grouped_8322 = cute.group_modes(%view_8317) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
            %iter_8323 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %iter_8324 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %lay_8325 = cute.get_layout(%grouped_8297) : !memref_gmem_bf16_7
            %2762 = cute.get_shape(%lay_8325) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_8326, %e1_8327, %e2_8328 = cute.get_leaves(%2762) : !cute.shape<"((8,1),(2))">
            %lay_8329 = cute.get_layout(%grouped_8310) : !memref_smem_bf16_14
            %2763 = cute.get_shape(%lay_8329) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_8330, %e1_8331, %e2_8332 = cute.get_leaves(%2763) : !cute.shape<"((8,1),(2))">
            %sz_8333 = cute.size(%grouped_8297) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
            %e0_8334 = cute.get_leaves(%sz_8333) : !cute.int_tuple<"2">
            %sz_8335 = cute.size(%grouped_8310) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
            %e0_8336 = cute.get_leaves(%sz_8335) : !cute.int_tuple<"2">
            cute.copy(%3, %grouped_8297, %grouped_8310, %grouped_8322) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
          } else {
            %coord_8270 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %slice_8271 = cute.slice(%dst_partitioned_242, %coord_8270) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_smem_bf16_13
            %sz_8273 = cute.size(%slice_8271) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
            %e0_8274 = cute.get_leaves(%sz_8273) : !cute.int_tuple<"16">
            %lay_8275 = cute.get_layout(%slice_8271) : !memref_smem_bf16_13
            %2757 = cute.get_shape(%lay_8275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8276, %e1_8277, %e2_8278 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %int_tuple_8279 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_8280 = cute.tuple.product(%int_tuple_8279) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8281 = cute.get_leaves(%res_8280) : !cute.int_tuple<"16">
            %cst_8282 = arith.constant 0.000000e+00 : bf16
            %2758 = vector.splat %cst_8282 : vector<16xbf16>
            %int_tuple_8283 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8284 = cute.size(%int_tuple_8283) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8285 = cute.get_leaves(%sz_8284) : !cute.int_tuple<"16">
            %int_tuple_8286 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8287 = cute.size(%int_tuple_8286) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8288 = cute.get_leaves(%sz_8287) : !cute.int_tuple<"16">
            cute.memref.store_vec %2758, %slice_8271, row_major : !memref_smem_bf16_13
          }
          %coord_8186 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %slice_8187 = cute.slice(%src_partitioned_398, %coord_8186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)">
          %iter_8188 = cute.get_iter(%slice_8187) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8189, %e1_8190, %e2_8191, %e3_8192 = cute.get_leaves(%iter_8188) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2703 = cute.get_scalars(%e0_8189) : !cute.int_tuple<"?">
          %2704 = cute.get_scalars(%e1_8190) : !cute.int_tuple<"?">
          %2705 = cute.get_scalars(%e2_8191) : !cute.int_tuple<"?">
          %2706 = cute.get_scalars(%e3_8192) : !cute.int_tuple<"?{div=8}">
          %iter_8193 = cute.get_iter(%slice_8187) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8194, %e1_8195, %e2_8196, %e3_8197 = cute.get_leaves(%iter_8193) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2707 = cute.get_scalars(%e0_8194) : !cute.int_tuple<"?">
          %2708 = cute.get_scalars(%e1_8195) : !cute.int_tuple<"?">
          %2709 = cute.get_scalars(%e2_8196) : !cute.int_tuple<"?">
          %2710 = cute.get_scalars(%e3_8197) : !cute.int_tuple<"?{div=8}">
          %iter_8198 = cute.get_iter(%slice_8187) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8199, %e1_8200, %e2_8201, %e3_8202 = cute.get_leaves(%iter_8198) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2711 = cute.get_scalars(%e0_8199) : !cute.int_tuple<"?">
          %2712 = cute.get_scalars(%e1_8200) : !cute.int_tuple<"?">
          %2713 = cute.get_scalars(%e2_8201) : !cute.int_tuple<"?">
          %2714 = cute.get_scalars(%e3_8202) : !cute.int_tuple<"?{div=8}">
          %lay_8203 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2715 = cute.get_shape(%lay_8203) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_8204, %e1_8205, %e2_8206, %e3_8207 = cute.get_leaves(%2715) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_8208 = cute.to_int_tuple(%e0_8204) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2716 = cute.get_scalars(%itup_8208) : !cute.int_tuple<"?">
          %itup_8209 = cute.to_int_tuple(%e1_8205) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2717 = cute.get_scalars(%itup_8209) : !cute.int_tuple<"?">
          %itup_8210 = cute.to_int_tuple(%e2_8206) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2718 = cute.get_scalars(%itup_8210) : !cute.int_tuple<"?">
          %itup_8211 = cute.to_int_tuple(%e3_8207) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2719 = cute.get_scalars(%itup_8211) : !cute.int_tuple<"?{div=8}">
          %coord_8212 = cute.make_coord(%e1_8200) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_8213 = cute.make_coord(%itup_8209) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2720 = cute.elem_less(%coord_8212, %coord_8213) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2720 {
            %coord_8270 = cute.make_coord(%2363) : (i32) -> !cute.coord<"(_,1,_,?)">
            %slice_8271 = cute.slice(%src_partitioned_239, %coord_8270) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_gmem_bf16_6
            %coord_8273 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %slice_8274 = cute.slice(%dst_partitioned_242, %coord_8273) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
            %iter_8275 = cute.get_iter(%slice_8274) : !memref_smem_bf16_13
            %coord_8276 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %slice_8277 = cute.slice(%rmem_435, %coord_8276) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)">
            %iter_8278 = cute.get_iter(%slice_8277) : !memref_rmem_i8_2
            %lay_8279 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %2757 = cute.get_shape(%lay_8279) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8280, %e1_8281, %e2_8282 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %lay_8283 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %2758 = cute.get_shape(%lay_8283) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8284, %e1_8285, %e2_8286 = cute.get_leaves(%2758) : !cute.shape<"((8,1),2)">
            %lay_8287 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %shape_8288 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8289 = cute.make_layout(%shape_8288) : !cute.layout<"1:0">
            %append_8290 = cute.append_to_rank<2> (%lay_8287, %lay_8289) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_8291 = cute.make_view(%iter_8272, %append_8290) : !memref_gmem_bf16_6
            %iter_8292 = cute.get_iter(%view_8291) : !memref_gmem_bf16_6
            %lay_8293 = cute.get_layout(%view_8291) : !memref_gmem_bf16_6
            %2759 = cute.get_shape(%lay_8293) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8294, %e1_8295, %e2_8296 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)">
            %grouped_8297 = cute.group_modes(%view_8291) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
            %iter_8298 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %iter_8299 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %lay_8300 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %shape_8301 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8302 = cute.make_layout(%shape_8301) : !cute.layout<"1:0">
            %append_8303 = cute.append_to_rank<2> (%lay_8300, %lay_8302) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_8304 = cute.make_view(%iter_8275, %append_8303) : !memref_smem_bf16_13
            %iter_8305 = cute.get_iter(%view_8304) : !memref_smem_bf16_13
            %lay_8306 = cute.get_layout(%view_8304) : !memref_smem_bf16_13
            %2760 = cute.get_shape(%lay_8306) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8307, %e1_8308, %e2_8309 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)">
            %grouped_8310 = cute.group_modes(%view_8304) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
            %iter_8311 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %iter_8312 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %lay_8313 = cute.get_layout(%slice_8277) : !memref_rmem_i8_2
            %shape_8314 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8315 = cute.make_layout(%shape_8314) : !cute.layout<"1:0">
            %append_8316 = cute.append_to_rank<2> (%lay_8313, %lay_8315) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_8317 = cute.make_view(%iter_8278, %append_8316) : !memref_rmem_i8_2
            %iter_8318 = cute.get_iter(%view_8317) : !memref_rmem_i8_2
            %lay_8319 = cute.get_layout(%view_8317) : !memref_rmem_i8_2
            %2761 = cute.get_shape(%lay_8319) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_8320, %e1_8321 = cute.get_leaves(%2761) : !cute.shape<"(1,2)">
            %grouped_8322 = cute.group_modes(%view_8317) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
            %iter_8323 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %iter_8324 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %lay_8325 = cute.get_layout(%grouped_8297) : !memref_gmem_bf16_7
            %2762 = cute.get_shape(%lay_8325) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_8326, %e1_8327, %e2_8328 = cute.get_leaves(%2762) : !cute.shape<"((8,1),(2))">
            %lay_8329 = cute.get_layout(%grouped_8310) : !memref_smem_bf16_14
            %2763 = cute.get_shape(%lay_8329) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_8330, %e1_8331, %e2_8332 = cute.get_leaves(%2763) : !cute.shape<"((8,1),(2))">
            %sz_8333 = cute.size(%grouped_8297) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
            %e0_8334 = cute.get_leaves(%sz_8333) : !cute.int_tuple<"2">
            %sz_8335 = cute.size(%grouped_8310) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
            %e0_8336 = cute.get_leaves(%sz_8335) : !cute.int_tuple<"2">
            cute.copy(%3, %grouped_8297, %grouped_8310, %grouped_8322) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
          } else {
            %coord_8270 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %slice_8271 = cute.slice(%dst_partitioned_242, %coord_8270) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_smem_bf16_13
            %sz_8273 = cute.size(%slice_8271) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
            %e0_8274 = cute.get_leaves(%sz_8273) : !cute.int_tuple<"16">
            %lay_8275 = cute.get_layout(%slice_8271) : !memref_smem_bf16_13
            %2757 = cute.get_shape(%lay_8275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8276, %e1_8277, %e2_8278 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %int_tuple_8279 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_8280 = cute.tuple.product(%int_tuple_8279) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8281 = cute.get_leaves(%res_8280) : !cute.int_tuple<"16">
            %cst_8282 = arith.constant 0.000000e+00 : bf16
            %2758 = vector.splat %cst_8282 : vector<16xbf16>
            %int_tuple_8283 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8284 = cute.size(%int_tuple_8283) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8285 = cute.get_leaves(%sz_8284) : !cute.int_tuple<"16">
            %int_tuple_8286 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8287 = cute.size(%int_tuple_8286) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8288 = cute.get_leaves(%sz_8287) : !cute.int_tuple<"16">
            cute.memref.store_vec %2758, %slice_8271, row_major : !memref_smem_bf16_13
          }
          %coord_8214 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %slice_8215 = cute.slice(%src_partitioned_398, %coord_8214) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)">
          %iter_8216 = cute.get_iter(%slice_8215) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8217, %e1_8218, %e2_8219, %e3_8220 = cute.get_leaves(%iter_8216) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2721 = cute.get_scalars(%e0_8217) : !cute.int_tuple<"?">
          %2722 = cute.get_scalars(%e1_8218) : !cute.int_tuple<"?">
          %2723 = cute.get_scalars(%e2_8219) : !cute.int_tuple<"?">
          %2724 = cute.get_scalars(%e3_8220) : !cute.int_tuple<"?{div=8}">
          %iter_8221 = cute.get_iter(%slice_8215) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8222, %e1_8223, %e2_8224, %e3_8225 = cute.get_leaves(%iter_8221) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2725 = cute.get_scalars(%e0_8222) : !cute.int_tuple<"?">
          %2726 = cute.get_scalars(%e1_8223) : !cute.int_tuple<"?">
          %2727 = cute.get_scalars(%e2_8224) : !cute.int_tuple<"?">
          %2728 = cute.get_scalars(%e3_8225) : !cute.int_tuple<"?{div=8}">
          %iter_8226 = cute.get_iter(%slice_8215) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8227, %e1_8228, %e2_8229, %e3_8230 = cute.get_leaves(%iter_8226) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2729 = cute.get_scalars(%e0_8227) : !cute.int_tuple<"?">
          %2730 = cute.get_scalars(%e1_8228) : !cute.int_tuple<"?">
          %2731 = cute.get_scalars(%e2_8229) : !cute.int_tuple<"?">
          %2732 = cute.get_scalars(%e3_8230) : !cute.int_tuple<"?{div=8}">
          %lay_8231 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2733 = cute.get_shape(%lay_8231) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_8232, %e1_8233, %e2_8234, %e3_8235 = cute.get_leaves(%2733) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_8236 = cute.to_int_tuple(%e0_8232) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2734 = cute.get_scalars(%itup_8236) : !cute.int_tuple<"?">
          %itup_8237 = cute.to_int_tuple(%e1_8233) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2735 = cute.get_scalars(%itup_8237) : !cute.int_tuple<"?">
          %itup_8238 = cute.to_int_tuple(%e2_8234) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2736 = cute.get_scalars(%itup_8238) : !cute.int_tuple<"?">
          %itup_8239 = cute.to_int_tuple(%e3_8235) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2737 = cute.get_scalars(%itup_8239) : !cute.int_tuple<"?{div=8}">
          %coord_8240 = cute.make_coord(%e1_8228) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_8241 = cute.make_coord(%itup_8237) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2738 = cute.elem_less(%coord_8240, %coord_8241) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2738 {
            %coord_8270 = cute.make_coord(%2363) : (i32) -> !cute.coord<"(_,2,_,?)">
            %slice_8271 = cute.slice(%src_partitioned_239, %coord_8270) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_gmem_bf16_6
            %coord_8273 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %slice_8274 = cute.slice(%dst_partitioned_242, %coord_8273) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
            %iter_8275 = cute.get_iter(%slice_8274) : !memref_smem_bf16_13
            %coord_8276 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %slice_8277 = cute.slice(%rmem_435, %coord_8276) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)">
            %iter_8278 = cute.get_iter(%slice_8277) : !memref_rmem_i8_2
            %lay_8279 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %2757 = cute.get_shape(%lay_8279) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8280, %e1_8281, %e2_8282 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %lay_8283 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %2758 = cute.get_shape(%lay_8283) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8284, %e1_8285, %e2_8286 = cute.get_leaves(%2758) : !cute.shape<"((8,1),2)">
            %lay_8287 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %shape_8288 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8289 = cute.make_layout(%shape_8288) : !cute.layout<"1:0">
            %append_8290 = cute.append_to_rank<2> (%lay_8287, %lay_8289) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_8291 = cute.make_view(%iter_8272, %append_8290) : !memref_gmem_bf16_6
            %iter_8292 = cute.get_iter(%view_8291) : !memref_gmem_bf16_6
            %lay_8293 = cute.get_layout(%view_8291) : !memref_gmem_bf16_6
            %2759 = cute.get_shape(%lay_8293) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8294, %e1_8295, %e2_8296 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)">
            %grouped_8297 = cute.group_modes(%view_8291) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
            %iter_8298 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %iter_8299 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %lay_8300 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %shape_8301 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8302 = cute.make_layout(%shape_8301) : !cute.layout<"1:0">
            %append_8303 = cute.append_to_rank<2> (%lay_8300, %lay_8302) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_8304 = cute.make_view(%iter_8275, %append_8303) : !memref_smem_bf16_13
            %iter_8305 = cute.get_iter(%view_8304) : !memref_smem_bf16_13
            %lay_8306 = cute.get_layout(%view_8304) : !memref_smem_bf16_13
            %2760 = cute.get_shape(%lay_8306) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8307, %e1_8308, %e2_8309 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)">
            %grouped_8310 = cute.group_modes(%view_8304) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
            %iter_8311 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %iter_8312 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %lay_8313 = cute.get_layout(%slice_8277) : !memref_rmem_i8_2
            %shape_8314 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8315 = cute.make_layout(%shape_8314) : !cute.layout<"1:0">
            %append_8316 = cute.append_to_rank<2> (%lay_8313, %lay_8315) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_8317 = cute.make_view(%iter_8278, %append_8316) : !memref_rmem_i8_2
            %iter_8318 = cute.get_iter(%view_8317) : !memref_rmem_i8_2
            %lay_8319 = cute.get_layout(%view_8317) : !memref_rmem_i8_2
            %2761 = cute.get_shape(%lay_8319) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_8320, %e1_8321 = cute.get_leaves(%2761) : !cute.shape<"(1,2)">
            %grouped_8322 = cute.group_modes(%view_8317) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
            %iter_8323 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %iter_8324 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %lay_8325 = cute.get_layout(%grouped_8297) : !memref_gmem_bf16_7
            %2762 = cute.get_shape(%lay_8325) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_8326, %e1_8327, %e2_8328 = cute.get_leaves(%2762) : !cute.shape<"((8,1),(2))">
            %lay_8329 = cute.get_layout(%grouped_8310) : !memref_smem_bf16_14
            %2763 = cute.get_shape(%lay_8329) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_8330, %e1_8331, %e2_8332 = cute.get_leaves(%2763) : !cute.shape<"((8,1),(2))">
            %sz_8333 = cute.size(%grouped_8297) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
            %e0_8334 = cute.get_leaves(%sz_8333) : !cute.int_tuple<"2">
            %sz_8335 = cute.size(%grouped_8310) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
            %e0_8336 = cute.get_leaves(%sz_8335) : !cute.int_tuple<"2">
            cute.copy(%3, %grouped_8297, %grouped_8310, %grouped_8322) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
          } else {
            %coord_8270 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %slice_8271 = cute.slice(%dst_partitioned_242, %coord_8270) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_smem_bf16_13
            %sz_8273 = cute.size(%slice_8271) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
            %e0_8274 = cute.get_leaves(%sz_8273) : !cute.int_tuple<"16">
            %lay_8275 = cute.get_layout(%slice_8271) : !memref_smem_bf16_13
            %2757 = cute.get_shape(%lay_8275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8276, %e1_8277, %e2_8278 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %int_tuple_8279 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_8280 = cute.tuple.product(%int_tuple_8279) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8281 = cute.get_leaves(%res_8280) : !cute.int_tuple<"16">
            %cst_8282 = arith.constant 0.000000e+00 : bf16
            %2758 = vector.splat %cst_8282 : vector<16xbf16>
            %int_tuple_8283 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8284 = cute.size(%int_tuple_8283) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8285 = cute.get_leaves(%sz_8284) : !cute.int_tuple<"16">
            %int_tuple_8286 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8287 = cute.size(%int_tuple_8286) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8288 = cute.get_leaves(%sz_8287) : !cute.int_tuple<"16">
            cute.memref.store_vec %2758, %slice_8271, row_major : !memref_smem_bf16_13
          }
          %coord_8242 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %slice_8243 = cute.slice(%src_partitioned_398, %coord_8242) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)">
          %iter_8244 = cute.get_iter(%slice_8243) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8245, %e1_8246, %e2_8247, %e3_8248 = cute.get_leaves(%iter_8244) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2739 = cute.get_scalars(%e0_8245) : !cute.int_tuple<"?">
          %2740 = cute.get_scalars(%e1_8246) : !cute.int_tuple<"?">
          %2741 = cute.get_scalars(%e2_8247) : !cute.int_tuple<"?">
          %2742 = cute.get_scalars(%e3_8248) : !cute.int_tuple<"?{div=8}">
          %iter_8249 = cute.get_iter(%slice_8243) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8250, %e1_8251, %e2_8252, %e3_8253 = cute.get_leaves(%iter_8249) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2743 = cute.get_scalars(%e0_8250) : !cute.int_tuple<"?">
          %2744 = cute.get_scalars(%e1_8251) : !cute.int_tuple<"?">
          %2745 = cute.get_scalars(%e2_8252) : !cute.int_tuple<"?">
          %2746 = cute.get_scalars(%e3_8253) : !cute.int_tuple<"?{div=8}">
          %iter_8254 = cute.get_iter(%slice_8243) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_8255, %e1_8256, %e2_8257, %e3_8258 = cute.get_leaves(%iter_8254) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2747 = cute.get_scalars(%e0_8255) : !cute.int_tuple<"?">
          %2748 = cute.get_scalars(%e1_8256) : !cute.int_tuple<"?">
          %2749 = cute.get_scalars(%e2_8257) : !cute.int_tuple<"?">
          %2750 = cute.get_scalars(%e3_8258) : !cute.int_tuple<"?{div=8}">
          %lay_8259 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2751 = cute.get_shape(%lay_8259) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_8260, %e1_8261, %e2_8262, %e3_8263 = cute.get_leaves(%2751) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_8264 = cute.to_int_tuple(%e0_8260) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2752 = cute.get_scalars(%itup_8264) : !cute.int_tuple<"?">
          %itup_8265 = cute.to_int_tuple(%e1_8261) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2753 = cute.get_scalars(%itup_8265) : !cute.int_tuple<"?">
          %itup_8266 = cute.to_int_tuple(%e2_8262) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2754 = cute.get_scalars(%itup_8266) : !cute.int_tuple<"?">
          %itup_8267 = cute.to_int_tuple(%e3_8263) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2755 = cute.get_scalars(%itup_8267) : !cute.int_tuple<"?{div=8}">
          %coord_8268 = cute.make_coord(%e1_8256) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_8269 = cute.make_coord(%itup_8265) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2756 = cute.elem_less(%coord_8268, %coord_8269) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2756 {
            %coord_8270 = cute.make_coord(%2363) : (i32) -> !cute.coord<"(_,3,_,?)">
            %slice_8271 = cute.slice(%src_partitioned_239, %coord_8270) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_gmem_bf16_6
            %coord_8273 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %slice_8274 = cute.slice(%dst_partitioned_242, %coord_8273) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
            %iter_8275 = cute.get_iter(%slice_8274) : !memref_smem_bf16_13
            %coord_8276 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %slice_8277 = cute.slice(%rmem_435, %coord_8276) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)">
            %iter_8278 = cute.get_iter(%slice_8277) : !memref_rmem_i8_2
            %lay_8279 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %2757 = cute.get_shape(%lay_8279) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8280, %e1_8281, %e2_8282 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %lay_8283 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %2758 = cute.get_shape(%lay_8283) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8284, %e1_8285, %e2_8286 = cute.get_leaves(%2758) : !cute.shape<"((8,1),2)">
            %lay_8287 = cute.get_layout(%slice_8271) : !memref_gmem_bf16_6
            %shape_8288 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8289 = cute.make_layout(%shape_8288) : !cute.layout<"1:0">
            %append_8290 = cute.append_to_rank<2> (%lay_8287, %lay_8289) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_8291 = cute.make_view(%iter_8272, %append_8290) : !memref_gmem_bf16_6
            %iter_8292 = cute.get_iter(%view_8291) : !memref_gmem_bf16_6
            %lay_8293 = cute.get_layout(%view_8291) : !memref_gmem_bf16_6
            %2759 = cute.get_shape(%lay_8293) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_8294, %e1_8295, %e2_8296 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)">
            %grouped_8297 = cute.group_modes(%view_8291) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
            %iter_8298 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %iter_8299 = cute.get_iter(%grouped_8297) : !memref_gmem_bf16_7
            %lay_8300 = cute.get_layout(%slice_8274) : !memref_smem_bf16_13
            %shape_8301 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8302 = cute.make_layout(%shape_8301) : !cute.layout<"1:0">
            %append_8303 = cute.append_to_rank<2> (%lay_8300, %lay_8302) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_8304 = cute.make_view(%iter_8275, %append_8303) : !memref_smem_bf16_13
            %iter_8305 = cute.get_iter(%view_8304) : !memref_smem_bf16_13
            %lay_8306 = cute.get_layout(%view_8304) : !memref_smem_bf16_13
            %2760 = cute.get_shape(%lay_8306) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8307, %e1_8308, %e2_8309 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)">
            %grouped_8310 = cute.group_modes(%view_8304) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
            %iter_8311 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %iter_8312 = cute.get_iter(%grouped_8310) : !memref_smem_bf16_14
            %lay_8313 = cute.get_layout(%slice_8277) : !memref_rmem_i8_2
            %shape_8314 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_8315 = cute.make_layout(%shape_8314) : !cute.layout<"1:0">
            %append_8316 = cute.append_to_rank<2> (%lay_8313, %lay_8315) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_8317 = cute.make_view(%iter_8278, %append_8316) : !memref_rmem_i8_2
            %iter_8318 = cute.get_iter(%view_8317) : !memref_rmem_i8_2
            %lay_8319 = cute.get_layout(%view_8317) : !memref_rmem_i8_2
            %2761 = cute.get_shape(%lay_8319) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_8320, %e1_8321 = cute.get_leaves(%2761) : !cute.shape<"(1,2)">
            %grouped_8322 = cute.group_modes(%view_8317) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
            %iter_8323 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %iter_8324 = cute.get_iter(%grouped_8322) : !memref_rmem_i8_3
            %lay_8325 = cute.get_layout(%grouped_8297) : !memref_gmem_bf16_7
            %2762 = cute.get_shape(%lay_8325) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_8326, %e1_8327, %e2_8328 = cute.get_leaves(%2762) : !cute.shape<"((8,1),(2))">
            %lay_8329 = cute.get_layout(%grouped_8310) : !memref_smem_bf16_14
            %2763 = cute.get_shape(%lay_8329) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_8330, %e1_8331, %e2_8332 = cute.get_leaves(%2763) : !cute.shape<"((8,1),(2))">
            %sz_8333 = cute.size(%grouped_8297) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
            %e0_8334 = cute.get_leaves(%sz_8333) : !cute.int_tuple<"2">
            %sz_8335 = cute.size(%grouped_8310) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
            %e0_8336 = cute.get_leaves(%sz_8335) : !cute.int_tuple<"2">
            cute.copy(%3, %grouped_8297, %grouped_8310, %grouped_8322) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3)
          } else {
            %coord_8270 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %slice_8271 = cute.slice(%dst_partitioned_242, %coord_8270) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)">
            %iter_8272 = cute.get_iter(%slice_8271) : !memref_smem_bf16_13
            %sz_8273 = cute.size(%slice_8271) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16">
            %e0_8274 = cute.get_leaves(%sz_8273) : !cute.int_tuple<"16">
            %lay_8275 = cute.get_layout(%slice_8271) : !memref_smem_bf16_13
            %2757 = cute.get_shape(%lay_8275) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_8276, %e1_8277, %e2_8278 = cute.get_leaves(%2757) : !cute.shape<"((8,1),2)">
            %int_tuple_8279 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_8280 = cute.tuple.product(%int_tuple_8279) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8281 = cute.get_leaves(%res_8280) : !cute.int_tuple<"16">
            %cst_8282 = arith.constant 0.000000e+00 : bf16
            %2758 = vector.splat %cst_8282 : vector<16xbf16>
            %int_tuple_8283 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8284 = cute.size(%int_tuple_8283) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8285 = cute.get_leaves(%sz_8284) : !cute.int_tuple<"16">
            %int_tuple_8286 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_8287 = cute.size(%int_tuple_8286) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_8288 = cute.get_leaves(%sz_8287) : !cute.int_tuple<"16">
            cute.memref.store_vec %2758, %slice_8271, row_major : !memref_smem_bf16_13
          }
        } else {
          %coord_8150 = cute.make_coord(%2363) : (i32) -> !cute.coord<"(_,_,_,?)">
          %slice_8151 = cute.slice(%src_partitioned_239, %coord_8150) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)">
          %iter_8152 = cute.get_iter(%slice_8151) : !memref_gmem_bf16_8
          %lay_8153 = cute.get_layout(%slice_8151) : !memref_gmem_bf16_8
          %2684 = cute.get_shape(%lay_8153) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8154, %e1_8155, %e2_8156, %e3_8157 = cute.get_leaves(%2684) : !cute.shape<"((8,1),4,2)">
          %lay_8158 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
          %2685 = cute.get_shape(%lay_8158) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8159, %e1_8160, %e2_8161, %e3_8162 = cute.get_leaves(%2685) : !cute.shape<"((8,1),4,2)">
          %lay_8163 = cute.get_layout(%slice_8151) : !memref_gmem_bf16_8
          %shape_8164 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8165 = cute.make_layout(%shape_8164) : !cute.layout<"1:0">
          %append_8166 = cute.append_to_rank<2> (%lay_8163, %lay_8165) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_8167 = cute.make_view(%iter_8152, %append_8166) : !memref_gmem_bf16_8
          %iter_8168 = cute.get_iter(%view_8167) : !memref_gmem_bf16_8
          %lay_8169 = cute.get_layout(%view_8167) : !memref_gmem_bf16_8
          %2686 = cute.get_shape(%lay_8169) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8170, %e1_8171, %e2_8172, %e3_8173 = cute.get_leaves(%2686) : !cute.shape<"((8,1),4,2)">
          %grouped_8174 = cute.group_modes(%view_8167) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9
          %iter_8175 = cute.get_iter(%grouped_8174) : !memref_gmem_bf16_9
          %iter_8176 = cute.get_iter(%grouped_8174) : !memref_gmem_bf16_9
          %lay_8177 = cute.get_layout(%dst_partitioned_242) : !memref_smem_bf16_4
          %shape_8178 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8179 = cute.make_layout(%shape_8178) : !cute.layout<"1:0">
          %append_8180 = cute.append_to_rank<2> (%lay_8177, %lay_8179) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_8181 = cute.make_view(%iter_243, %append_8180) : !memref_smem_bf16_4
          %iter_8182 = cute.get_iter(%view_8181) : !memref_smem_bf16_4
          %lay_8183 = cute.get_layout(%view_8181) : !memref_smem_bf16_4
          %2687 = cute.get_shape(%lay_8183) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8184, %e1_8185, %e2_8186, %e3_8187 = cute.get_leaves(%2687) : !cute.shape<"((8,1),4,2)">
          %grouped_8188 = cute.group_modes(%view_8181) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15
          %iter_8189 = cute.get_iter(%grouped_8188) : !memref_smem_bf16_15
          %iter_8190 = cute.get_iter(%grouped_8188) : !memref_smem_bf16_15
          %lay_8191 = cute.get_layout(%rmem_435) : !memref_rmem_i8_1
          %shape_8192 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8193 = cute.make_layout(%shape_8192) : !cute.layout<"1:0">
          %append_8194 = cute.append_to_rank<2> (%lay_8191, %lay_8193) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_8195 = cute.make_view(%iter_437, %append_8194) : !memref_rmem_i8_1
          %iter_8196 = cute.get_iter(%view_8195) : !memref_rmem_i8_1
          %lay_8197 = cute.get_layout(%view_8195) : !memref_rmem_i8_1
          %2688 = cute.get_shape(%lay_8197) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_8198, %e1_8199, %e2_8200 = cute.get_leaves(%2688) : !cute.shape<"(1,4,2)">
          %grouped_8201 = cute.group_modes(%view_8195) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4
          %iter_8202 = cute.get_iter(%grouped_8201) : !memref_rmem_i8_4
          %iter_8203 = cute.get_iter(%grouped_8201) : !memref_rmem_i8_4
          %lay_8204 = cute.get_layout(%grouped_8174) : !memref_gmem_bf16_9
          %2689 = cute.get_shape(%lay_8204) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_8205, %e1_8206, %e2_8207, %e3_8208 = cute.get_leaves(%2689) : !cute.shape<"((8,1),(4,2))">
          %lay_8209 = cute.get_layout(%grouped_8188) : !memref_smem_bf16_15
          %2690 = cute.get_shape(%lay_8209) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_8210, %e1_8211, %e2_8212, %e3_8213 = cute.get_leaves(%2690) : !cute.shape<"((8,1),(4,2))">
          %sz_8214 = cute.size(%grouped_8174) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8">
          %e0_8215 = cute.get_leaves(%sz_8214) : !cute.int_tuple<"8">
          %sz_8216 = cute.size(%grouped_8188) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8">
          %e0_8217 = cute.get_leaves(%sz_8216) : !cute.int_tuple<"8">
          cute.copy(%3, %grouped_8174, %grouped_8188, %grouped_8201) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4)
        }
        nvvm.cp.async.commit.group
        %coord_6306 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6307 = cute.slice(%src_partitioned_317, %coord_6306) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)">
        %iter_6308 = cute.get_iter(%slice_6307) : !memref_smem_bf16_13
        %coord_6309 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6310 = cute.slice(%retiled, %coord_6309) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)">
        %iter_6311 = cute.get_iter(%slice_6310) : !memref_rmem_bf16_6
        %lay_6312 = cute.get_layout(%slice_6307) : !memref_smem_bf16_13
        %2367 = cute.get_shape(%lay_6312) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6313, %e1_6314, %e2_6315 = cute.get_leaves(%2367) : !cute.shape<"((8,1),2)">
        %lay_6316 = cute.get_layout(%slice_6310) : !memref_rmem_bf16_6
        %2368 = cute.get_shape(%lay_6316) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6317, %e1_6318, %e2_6319 = cute.get_leaves(%2368) : !cute.shape<"((8,1),2)">
        %lay_6320 = cute.get_layout(%slice_6307) : !memref_smem_bf16_13
        %shape_6321 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6322 = cute.make_layout(%shape_6321) : !cute.layout<"1:0">
        %append_6323 = cute.append_to_rank<2> (%lay_6320, %lay_6322) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6324 = cute.make_view(%iter_6308, %append_6323) : !memref_smem_bf16_13
        %iter_6325 = cute.get_iter(%view_6324) : !memref_smem_bf16_13
        %lay_6326 = cute.get_layout(%view_6324) : !memref_smem_bf16_13
        %2369 = cute.get_shape(%lay_6326) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6327, %e1_6328, %e2_6329 = cute.get_leaves(%2369) : !cute.shape<"((8,1),2)">
        %grouped_6330 = cute.group_modes(%view_6324) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6331 = cute.get_iter(%grouped_6330) : !memref_smem_bf16_14
        %iter_6332 = cute.get_iter(%grouped_6330) : !memref_smem_bf16_14
        %lay_6333 = cute.get_layout(%slice_6310) : !memref_rmem_bf16_6
        %shape_6334 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6335 = cute.make_layout(%shape_6334) : !cute.layout<"1:0">
        %append_6336 = cute.append_to_rank<2> (%lay_6333, %lay_6335) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6337 = cute.make_view(%iter_6311, %append_6336) : !memref_rmem_bf16_6
        %iter_6338 = cute.get_iter(%view_6337) : !memref_rmem_bf16_6
        %lay_6339 = cute.get_layout(%view_6337) : !memref_rmem_bf16_6
        %2370 = cute.get_shape(%lay_6339) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6340, %e1_6341, %e2_6342 = cute.get_leaves(%2370) : !cute.shape<"((8,1),2)">
        %grouped_6343 = cute.group_modes(%view_6337) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6344 = cute.get_iter(%grouped_6343) : !memref_rmem_bf16_7
        %iter_6345 = cute.get_iter(%grouped_6343) : !memref_rmem_bf16_7
        %lay_6346 = cute.get_layout(%grouped_6330) : !memref_smem_bf16_14
        %2371 = cute.get_shape(%lay_6346) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6347, %e1_6348, %e2_6349 = cute.get_leaves(%2371) : !cute.shape<"((8,1),(2))">
        %lay_6350 = cute.get_layout(%grouped_6343) : !memref_rmem_bf16_7
        %2372 = cute.get_shape(%lay_6350) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6351, %e1_6352, %e2_6353 = cute.get_leaves(%2372) : !cute.shape<"((8,1),(2))">
        %sz_6354 = cute.size(%grouped_6330) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6355 = cute.get_leaves(%sz_6354) : !cute.int_tuple<"2">
        %sz_6356 = cute.size(%grouped_6343) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6357 = cute.get_leaves(%sz_6356) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6330, %grouped_6343) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6358 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6359 = cute.slice(%src_partitioned_321, %coord_6358) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)">
        %iter_6360 = cute.get_iter(%slice_6359) : !memref_smem_bf16_16
        %coord_6361 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6362 = cute.slice(%retiled_323, %coord_6361) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)">
        %iter_6363 = cute.get_iter(%slice_6362) : !memref_rmem_bf16_8
        %lay_6364 = cute.get_layout(%slice_6359) : !memref_smem_bf16_16
        %2373 = cute.get_shape(%lay_6364) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6365, %e1_6366, %e2_6367 = cute.get_leaves(%2373) : !cute.shape<"((8,1),4)">
        %lay_6368 = cute.get_layout(%slice_6362) : !memref_rmem_bf16_8
        %2374 = cute.get_shape(%lay_6368) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6369, %e1_6370, %e2_6371 = cute.get_leaves(%2374) : !cute.shape<"((8,1),4)">
        %lay_6372 = cute.get_layout(%slice_6359) : !memref_smem_bf16_16
        %shape_6373 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6374 = cute.make_layout(%shape_6373) : !cute.layout<"1:0">
        %append_6375 = cute.append_to_rank<2> (%lay_6372, %lay_6374) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6376 = cute.make_view(%iter_6360, %append_6375) : !memref_smem_bf16_16
        %iter_6377 = cute.get_iter(%view_6376) : !memref_smem_bf16_16
        %lay_6378 = cute.get_layout(%view_6376) : !memref_smem_bf16_16
        %2375 = cute.get_shape(%lay_6378) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6379, %e1_6380, %e2_6381 = cute.get_leaves(%2375) : !cute.shape<"((8,1),4)">
        %grouped_6382 = cute.group_modes(%view_6376) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6383 = cute.get_iter(%grouped_6382) : !memref_smem_bf16_17
        %iter_6384 = cute.get_iter(%grouped_6382) : !memref_smem_bf16_17
        %lay_6385 = cute.get_layout(%slice_6362) : !memref_rmem_bf16_8
        %shape_6386 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6387 = cute.make_layout(%shape_6386) : !cute.layout<"1:0">
        %append_6388 = cute.append_to_rank<2> (%lay_6385, %lay_6387) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6389 = cute.make_view(%iter_6363, %append_6388) : !memref_rmem_bf16_8
        %iter_6390 = cute.get_iter(%view_6389) : !memref_rmem_bf16_8
        %lay_6391 = cute.get_layout(%view_6389) : !memref_rmem_bf16_8
        %2376 = cute.get_shape(%lay_6391) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6392, %e1_6393, %e2_6394 = cute.get_leaves(%2376) : !cute.shape<"((8,1),4)">
        %grouped_6395 = cute.group_modes(%view_6389) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_6396 = cute.get_iter(%grouped_6395) : !memref_rmem_bf16_9
        %iter_6397 = cute.get_iter(%grouped_6395) : !memref_rmem_bf16_9
        %lay_6398 = cute.get_layout(%grouped_6382) : !memref_smem_bf16_17
        %2377 = cute.get_shape(%lay_6398) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_6399, %e1_6400, %e2_6401 = cute.get_leaves(%2377) : !cute.shape<"((8,1),(4))">
        %lay_6402 = cute.get_layout(%grouped_6395) : !memref_rmem_bf16_9
        %2378 = cute.get_shape(%lay_6402) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_6403, %e1_6404, %e2_6405 = cute.get_leaves(%2378) : !cute.shape<"((8,1),(4))">
        %sz_6406 = cute.size(%grouped_6382) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_6407 = cute.get_leaves(%sz_6406) : !cute.int_tuple<"4">
        %sz_6408 = cute.size(%grouped_6395) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_6409 = cute.get_leaves(%sz_6408) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6382, %grouped_6395) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %lay_6410 = cute.get_layout(%src_partitioned_317) : !memref_smem_bf16_8
        %2379 = cute.get_shape(%lay_6410) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
        %e0_6411, %e1_6412, %e2_6413, %e3_6414, %e4_6415, %e5_6416 = cute.get_leaves(%2379) : !cute.shape<"((8,1),2,((2,2),2))">
        %int_tuple_6417 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6418 = cute.size(%int_tuple_6417) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6419 = cute.get_leaves(%sz_6418) : !cute.int_tuple<"8">
        %int_tuple_6420 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6421 = cute.size(%int_tuple_6420) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6422 = cute.get_leaves(%sz_6421) : !cute.int_tuple<"8">
        %coord_6423 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6424 = cute.slice(%src_partitioned_317, %coord_6423) : !memref_smem_bf16_8, !cute.coord<"(_,_,1)">
        %iter_6425 = cute.get_iter(%slice_6424) : !memref_smem_bf16_13
        %coord_6426 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6427 = cute.slice(%retiled, %coord_6426) : !memref_rmem_bf16_3, !cute.coord<"(_,_,1)">
        %iter_6428 = cute.get_iter(%slice_6427) : !memref_rmem_bf16_6
        %lay_6429 = cute.get_layout(%slice_6424) : !memref_smem_bf16_13
        %2380 = cute.get_shape(%lay_6429) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6430, %e1_6431, %e2_6432 = cute.get_leaves(%2380) : !cute.shape<"((8,1),2)">
        %lay_6433 = cute.get_layout(%slice_6427) : !memref_rmem_bf16_6
        %2381 = cute.get_shape(%lay_6433) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6434, %e1_6435, %e2_6436 = cute.get_leaves(%2381) : !cute.shape<"((8,1),2)">
        %lay_6437 = cute.get_layout(%slice_6424) : !memref_smem_bf16_13
        %shape_6438 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6439 = cute.make_layout(%shape_6438) : !cute.layout<"1:0">
        %append_6440 = cute.append_to_rank<2> (%lay_6437, %lay_6439) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6441 = cute.make_view(%iter_6425, %append_6440) : !memref_smem_bf16_13
        %iter_6442 = cute.get_iter(%view_6441) : !memref_smem_bf16_13
        %lay_6443 = cute.get_layout(%view_6441) : !memref_smem_bf16_13
        %2382 = cute.get_shape(%lay_6443) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6444, %e1_6445, %e2_6446 = cute.get_leaves(%2382) : !cute.shape<"((8,1),2)">
        %grouped_6447 = cute.group_modes(%view_6441) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6448 = cute.get_iter(%grouped_6447) : !memref_smem_bf16_14
        %iter_6449 = cute.get_iter(%grouped_6447) : !memref_smem_bf16_14
        %lay_6450 = cute.get_layout(%slice_6427) : !memref_rmem_bf16_6
        %shape_6451 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6452 = cute.make_layout(%shape_6451) : !cute.layout<"1:0">
        %append_6453 = cute.append_to_rank<2> (%lay_6450, %lay_6452) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6454 = cute.make_view(%iter_6428, %append_6453) : !memref_rmem_bf16_6
        %iter_6455 = cute.get_iter(%view_6454) : !memref_rmem_bf16_6
        %lay_6456 = cute.get_layout(%view_6454) : !memref_rmem_bf16_6
        %2383 = cute.get_shape(%lay_6456) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6457, %e1_6458, %e2_6459 = cute.get_leaves(%2383) : !cute.shape<"((8,1),2)">
        %grouped_6460 = cute.group_modes(%view_6454) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6461 = cute.get_iter(%grouped_6460) : !memref_rmem_bf16_7
        %iter_6462 = cute.get_iter(%grouped_6460) : !memref_rmem_bf16_7
        %lay_6463 = cute.get_layout(%grouped_6447) : !memref_smem_bf16_14
        %2384 = cute.get_shape(%lay_6463) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6464, %e1_6465, %e2_6466 = cute.get_leaves(%2384) : !cute.shape<"((8,1),(2))">
        %lay_6467 = cute.get_layout(%grouped_6460) : !memref_rmem_bf16_7
        %2385 = cute.get_shape(%lay_6467) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6468, %e1_6469, %e2_6470 = cute.get_leaves(%2385) : !cute.shape<"((8,1),(2))">
        %sz_6471 = cute.size(%grouped_6447) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6472 = cute.get_leaves(%sz_6471) : !cute.int_tuple<"2">
        %sz_6473 = cute.size(%grouped_6460) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6474 = cute.get_leaves(%sz_6473) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6447, %grouped_6460) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6475 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6476 = cute.slice(%src_partitioned_321, %coord_6475) : !memref_smem_bf16_9, !cute.coord<"(_,_,1)">
        %iter_6477 = cute.get_iter(%slice_6476) : !memref_smem_bf16_16
        %coord_6478 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6479 = cute.slice(%retiled_323, %coord_6478) : !memref_rmem_bf16_4, !cute.coord<"(_,_,1)">
        %iter_6480 = cute.get_iter(%slice_6479) : !memref_rmem_bf16_8
        %lay_6481 = cute.get_layout(%slice_6476) : !memref_smem_bf16_16
        %2386 = cute.get_shape(%lay_6481) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6482, %e1_6483, %e2_6484 = cute.get_leaves(%2386) : !cute.shape<"((8,1),4)">
        %lay_6485 = cute.get_layout(%slice_6479) : !memref_rmem_bf16_8
        %2387 = cute.get_shape(%lay_6485) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6486, %e1_6487, %e2_6488 = cute.get_leaves(%2387) : !cute.shape<"((8,1),4)">
        %lay_6489 = cute.get_layout(%slice_6476) : !memref_smem_bf16_16
        %shape_6490 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6491 = cute.make_layout(%shape_6490) : !cute.layout<"1:0">
        %append_6492 = cute.append_to_rank<2> (%lay_6489, %lay_6491) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6493 = cute.make_view(%iter_6477, %append_6492) : !memref_smem_bf16_16
        %iter_6494 = cute.get_iter(%view_6493) : !memref_smem_bf16_16
        %lay_6495 = cute.get_layout(%view_6493) : !memref_smem_bf16_16
        %2388 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6496, %e1_6497, %e2_6498 = cute.get_leaves(%2388) : !cute.shape<"((8,1),4)">
        %grouped_6499 = cute.group_modes(%view_6493) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6500 = cute.get_iter(%grouped_6499) : !memref_smem_bf16_17
        %iter_6501 = cute.get_iter(%grouped_6499) : !memref_smem_bf16_17
        %lay_6502 = cute.get_layout(%slice_6479) : !memref_rmem_bf16_8
        %shape_6503 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6504 = cute.make_layout(%shape_6503) : !cute.layout<"1:0">
        %append_6505 = cute.append_to_rank<2> (%lay_6502, %lay_6504) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6506 = cute.make_view(%iter_6480, %append_6505) : !memref_rmem_bf16_8
        %iter_6507 = cute.get_iter(%view_6506) : !memref_rmem_bf16_8
        %lay_6508 = cute.get_layout(%view_6506) : !memref_rmem_bf16_8
        %2389 = cute.get_shape(%lay_6508) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6509, %e1_6510, %e2_6511 = cute.get_leaves(%2389) : !cute.shape<"((8,1),4)">
        %grouped_6512 = cute.group_modes(%view_6506) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_6513 = cute.get_iter(%grouped_6512) : !memref_rmem_bf16_9
        %iter_6514 = cute.get_iter(%grouped_6512) : !memref_rmem_bf16_9
        %lay_6515 = cute.get_layout(%grouped_6499) : !memref_smem_bf16_17
        %2390 = cute.get_shape(%lay_6515) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_6516, %e1_6517, %e2_6518 = cute.get_leaves(%2390) : !cute.shape<"((8,1),(4))">
        %lay_6519 = cute.get_layout(%grouped_6512) : !memref_rmem_bf16_9
        %2391 = cute.get_shape(%lay_6519) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_6520, %e1_6521, %e2_6522 = cute.get_leaves(%2391) : !cute.shape<"((8,1),(4))">
        %sz_6523 = cute.size(%grouped_6499) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_6524 = cute.get_leaves(%sz_6523) : !cute.int_tuple<"4">
        %sz_6525 = cute.size(%grouped_6512) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_6526 = cute.get_leaves(%sz_6525) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6499, %grouped_6512) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_6527 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6528 = cute.slice(%frg_A, %coord_6527) : !memref_rmem_bf16_, !cute.coord<"(_,_,0)">
        %iter_6529 = cute.get_iter(%slice_6528) : !memref_rmem_bf16_10
        %coord_6530 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_6531 = cute.slice(%frg_B, %coord_6530) : !memref_rmem_bf16_1, !cute.coord<"(_,_,0)">
        %iter_6532 = cute.get_iter(%slice_6531) : !memref_rmem_bf16_11
        %lay_6533 = cute.get_layout(%slice_6528) : !memref_rmem_bf16_10
        %2392 = cute.get_shape(%lay_6533) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_6534, %e1_6535, %e2_6536, %e3_6537 = cute.get_leaves(%2392) : !cute.shape<"((2,2,2),2)">
        %lay_6538 = cute.get_layout(%slice_6531) : !memref_rmem_bf16_11
        %2393 = cute.get_shape(%lay_6538) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_6539, %e1_6540, %e2_6541 = cute.get_leaves(%2393) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_6528, %slice_6531, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_6542 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6543 = cute.size(%int_tuple_6542) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6544 = cute.get_leaves(%sz_6543) : !cute.int_tuple<"8">
        %coord_6545 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6546 = cute.slice(%src_partitioned_317, %coord_6545) : !memref_smem_bf16_8, !cute.coord<"(_,_,2)">
        %iter_6547 = cute.get_iter(%slice_6546) : !memref_smem_bf16_13
        %coord_6548 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6549 = cute.slice(%retiled, %coord_6548) : !memref_rmem_bf16_3, !cute.coord<"(_,_,2)">
        %iter_6550 = cute.get_iter(%slice_6549) : !memref_rmem_bf16_6
        %lay_6551 = cute.get_layout(%slice_6546) : !memref_smem_bf16_13
        %2394 = cute.get_shape(%lay_6551) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6552, %e1_6553, %e2_6554 = cute.get_leaves(%2394) : !cute.shape<"((8,1),2)">
        %lay_6555 = cute.get_layout(%slice_6549) : !memref_rmem_bf16_6
        %2395 = cute.get_shape(%lay_6555) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6556, %e1_6557, %e2_6558 = cute.get_leaves(%2395) : !cute.shape<"((8,1),2)">
        %lay_6559 = cute.get_layout(%slice_6546) : !memref_smem_bf16_13
        %shape_6560 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6561 = cute.make_layout(%shape_6560) : !cute.layout<"1:0">
        %append_6562 = cute.append_to_rank<2> (%lay_6559, %lay_6561) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6563 = cute.make_view(%iter_6547, %append_6562) : !memref_smem_bf16_13
        %iter_6564 = cute.get_iter(%view_6563) : !memref_smem_bf16_13
        %lay_6565 = cute.get_layout(%view_6563) : !memref_smem_bf16_13
        %2396 = cute.get_shape(%lay_6565) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6566, %e1_6567, %e2_6568 = cute.get_leaves(%2396) : !cute.shape<"((8,1),2)">
        %grouped_6569 = cute.group_modes(%view_6563) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6570 = cute.get_iter(%grouped_6569) : !memref_smem_bf16_14
        %iter_6571 = cute.get_iter(%grouped_6569) : !memref_smem_bf16_14
        %lay_6572 = cute.get_layout(%slice_6549) : !memref_rmem_bf16_6
        %shape_6573 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6574 = cute.make_layout(%shape_6573) : !cute.layout<"1:0">
        %append_6575 = cute.append_to_rank<2> (%lay_6572, %lay_6574) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6576 = cute.make_view(%iter_6550, %append_6575) : !memref_rmem_bf16_6
        %iter_6577 = cute.get_iter(%view_6576) : !memref_rmem_bf16_6
        %lay_6578 = cute.get_layout(%view_6576) : !memref_rmem_bf16_6
        %2397 = cute.get_shape(%lay_6578) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6579, %e1_6580, %e2_6581 = cute.get_leaves(%2397) : !cute.shape<"((8,1),2)">
        %grouped_6582 = cute.group_modes(%view_6576) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6583 = cute.get_iter(%grouped_6582) : !memref_rmem_bf16_7
        %iter_6584 = cute.get_iter(%grouped_6582) : !memref_rmem_bf16_7
        %lay_6585 = cute.get_layout(%grouped_6569) : !memref_smem_bf16_14
        %2398 = cute.get_shape(%lay_6585) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6586, %e1_6587, %e2_6588 = cute.get_leaves(%2398) : !cute.shape<"((8,1),(2))">
        %lay_6589 = cute.get_layout(%grouped_6582) : !memref_rmem_bf16_7
        %2399 = cute.get_shape(%lay_6589) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6590, %e1_6591, %e2_6592 = cute.get_leaves(%2399) : !cute.shape<"((8,1),(2))">
        %sz_6593 = cute.size(%grouped_6569) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6594 = cute.get_leaves(%sz_6593) : !cute.int_tuple<"2">
        %sz_6595 = cute.size(%grouped_6582) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6596 = cute.get_leaves(%sz_6595) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6569, %grouped_6582) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6597 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6598 = cute.slice(%src_partitioned_321, %coord_6597) : !memref_smem_bf16_9, !cute.coord<"(_,_,2)">
        %iter_6599 = cute.get_iter(%slice_6598) : !memref_smem_bf16_16
        %coord_6600 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6601 = cute.slice(%retiled_323, %coord_6600) : !memref_rmem_bf16_4, !cute.coord<"(_,_,2)">
        %iter_6602 = cute.get_iter(%slice_6601) : !memref_rmem_bf16_8
        %lay_6603 = cute.get_layout(%slice_6598) : !memref_smem_bf16_16
        %2400 = cute.get_shape(%lay_6603) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6604, %e1_6605, %e2_6606 = cute.get_leaves(%2400) : !cute.shape<"((8,1),4)">
        %lay_6607 = cute.get_layout(%slice_6601) : !memref_rmem_bf16_8
        %2401 = cute.get_shape(%lay_6607) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6608, %e1_6609, %e2_6610 = cute.get_leaves(%2401) : !cute.shape<"((8,1),4)">
        %lay_6611 = cute.get_layout(%slice_6598) : !memref_smem_bf16_16
        %shape_6612 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6613 = cute.make_layout(%shape_6612) : !cute.layout<"1:0">
        %append_6614 = cute.append_to_rank<2> (%lay_6611, %lay_6613) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6615 = cute.make_view(%iter_6599, %append_6614) : !memref_smem_bf16_16
        %iter_6616 = cute.get_iter(%view_6615) : !memref_smem_bf16_16
        %lay_6617 = cute.get_layout(%view_6615) : !memref_smem_bf16_16
        %2402 = cute.get_shape(%lay_6617) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6618, %e1_6619, %e2_6620 = cute.get_leaves(%2402) : !cute.shape<"((8,1),4)">
        %grouped_6621 = cute.group_modes(%view_6615) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6622 = cute.get_iter(%grouped_6621) : !memref_smem_bf16_17
        %iter_6623 = cute.get_iter(%grouped_6621) : !memref_smem_bf16_17
        %lay_6624 = cute.get_layout(%slice_6601) : !memref_rmem_bf16_8
        %shape_6625 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6626 = cute.make_layout(%shape_6625) : !cute.layout<"1:0">
        %append_6627 = cute.append_to_rank<2> (%lay_6624, %lay_6626) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6628 = cute.make_view(%iter_6602, %append_6627) : !memref_rmem_bf16_8
        %iter_6629 = cute.get_iter(%view_6628) : !memref_rmem_bf16_8
        %lay_6630 = cute.get_layout(%view_6628) : !memref_rmem_bf16_8
        %2403 = cute.get_shape(%lay_6630) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6631, %e1_6632, %e2_6633 = cute.get_leaves(%2403) : !cute.shape<"((8,1),4)">
        %grouped_6634 = cute.group_modes(%view_6628) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_6635 = cute.get_iter(%grouped_6634) : !memref_rmem_bf16_9
        %iter_6636 = cute.get_iter(%grouped_6634) : !memref_rmem_bf16_9
        %lay_6637 = cute.get_layout(%grouped_6621) : !memref_smem_bf16_17
        %2404 = cute.get_shape(%lay_6637) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_6638, %e1_6639, %e2_6640 = cute.get_leaves(%2404) : !cute.shape<"((8,1),(4))">
        %lay_6641 = cute.get_layout(%grouped_6634) : !memref_rmem_bf16_9
        %2405 = cute.get_shape(%lay_6641) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_6642, %e1_6643, %e2_6644 = cute.get_leaves(%2405) : !cute.shape<"((8,1),(4))">
        %sz_6645 = cute.size(%grouped_6621) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_6646 = cute.get_leaves(%sz_6645) : !cute.int_tuple<"4">
        %sz_6647 = cute.size(%grouped_6634) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_6648 = cute.get_leaves(%sz_6647) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6621, %grouped_6634) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_6649 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6650 = cute.slice(%frg_A, %coord_6649) : !memref_rmem_bf16_, !cute.coord<"(_,_,1)">
        %iter_6651 = cute.get_iter(%slice_6650) : !memref_rmem_bf16_10
        %coord_6652 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_6653 = cute.slice(%frg_B, %coord_6652) : !memref_rmem_bf16_1, !cute.coord<"(_,_,1)">
        %iter_6654 = cute.get_iter(%slice_6653) : !memref_rmem_bf16_11
        %lay_6655 = cute.get_layout(%slice_6650) : !memref_rmem_bf16_10
        %2406 = cute.get_shape(%lay_6655) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_6656, %e1_6657, %e2_6658, %e3_6659 = cute.get_leaves(%2406) : !cute.shape<"((2,2,2),2)">
        %lay_6660 = cute.get_layout(%slice_6653) : !memref_rmem_bf16_11
        %2407 = cute.get_shape(%lay_6660) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_6661, %e1_6662, %e2_6663 = cute.get_leaves(%2407) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_6650, %slice_6653, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_6664 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6665 = cute.size(%int_tuple_6664) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6666 = cute.get_leaves(%sz_6665) : !cute.int_tuple<"8">
        %coord_6667 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6668 = cute.slice(%src_partitioned_317, %coord_6667) : !memref_smem_bf16_8, !cute.coord<"(_,_,3)">
        %iter_6669 = cute.get_iter(%slice_6668) : !memref_smem_bf16_13
        %coord_6670 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6671 = cute.slice(%retiled, %coord_6670) : !memref_rmem_bf16_3, !cute.coord<"(_,_,3)">
        %iter_6672 = cute.get_iter(%slice_6671) : !memref_rmem_bf16_6
        %lay_6673 = cute.get_layout(%slice_6668) : !memref_smem_bf16_13
        %2408 = cute.get_shape(%lay_6673) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6674, %e1_6675, %e2_6676 = cute.get_leaves(%2408) : !cute.shape<"((8,1),2)">
        %lay_6677 = cute.get_layout(%slice_6671) : !memref_rmem_bf16_6
        %2409 = cute.get_shape(%lay_6677) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6678, %e1_6679, %e2_6680 = cute.get_leaves(%2409) : !cute.shape<"((8,1),2)">
        %lay_6681 = cute.get_layout(%slice_6668) : !memref_smem_bf16_13
        %shape_6682 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6683 = cute.make_layout(%shape_6682) : !cute.layout<"1:0">
        %append_6684 = cute.append_to_rank<2> (%lay_6681, %lay_6683) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6685 = cute.make_view(%iter_6669, %append_6684) : !memref_smem_bf16_13
        %iter_6686 = cute.get_iter(%view_6685) : !memref_smem_bf16_13
        %lay_6687 = cute.get_layout(%view_6685) : !memref_smem_bf16_13
        %2410 = cute.get_shape(%lay_6687) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6688, %e1_6689, %e2_6690 = cute.get_leaves(%2410) : !cute.shape<"((8,1),2)">
        %grouped_6691 = cute.group_modes(%view_6685) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6692 = cute.get_iter(%grouped_6691) : !memref_smem_bf16_14
        %iter_6693 = cute.get_iter(%grouped_6691) : !memref_smem_bf16_14
        %lay_6694 = cute.get_layout(%slice_6671) : !memref_rmem_bf16_6
        %shape_6695 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6696 = cute.make_layout(%shape_6695) : !cute.layout<"1:0">
        %append_6697 = cute.append_to_rank<2> (%lay_6694, %lay_6696) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6698 = cute.make_view(%iter_6672, %append_6697) : !memref_rmem_bf16_6
        %iter_6699 = cute.get_iter(%view_6698) : !memref_rmem_bf16_6
        %lay_6700 = cute.get_layout(%view_6698) : !memref_rmem_bf16_6
        %2411 = cute.get_shape(%lay_6700) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6701, %e1_6702, %e2_6703 = cute.get_leaves(%2411) : !cute.shape<"((8,1),2)">
        %grouped_6704 = cute.group_modes(%view_6698) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6705 = cute.get_iter(%grouped_6704) : !memref_rmem_bf16_7
        %iter_6706 = cute.get_iter(%grouped_6704) : !memref_rmem_bf16_7
        %lay_6707 = cute.get_layout(%grouped_6691) : !memref_smem_bf16_14
        %2412 = cute.get_shape(%lay_6707) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6708, %e1_6709, %e2_6710 = cute.get_leaves(%2412) : !cute.shape<"((8,1),(2))">
        %lay_6711 = cute.get_layout(%grouped_6704) : !memref_rmem_bf16_7
        %2413 = cute.get_shape(%lay_6711) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6712, %e1_6713, %e2_6714 = cute.get_leaves(%2413) : !cute.shape<"((8,1),(2))">
        %sz_6715 = cute.size(%grouped_6691) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6716 = cute.get_leaves(%sz_6715) : !cute.int_tuple<"2">
        %sz_6717 = cute.size(%grouped_6704) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6718 = cute.get_leaves(%sz_6717) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6691, %grouped_6704) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6719 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6720 = cute.slice(%src_partitioned_321, %coord_6719) : !memref_smem_bf16_9, !cute.coord<"(_,_,3)">
        %iter_6721 = cute.get_iter(%slice_6720) : !memref_smem_bf16_16
        %coord_6722 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6723 = cute.slice(%retiled_323, %coord_6722) : !memref_rmem_bf16_4, !cute.coord<"(_,_,3)">
        %iter_6724 = cute.get_iter(%slice_6723) : !memref_rmem_bf16_8
        %lay_6725 = cute.get_layout(%slice_6720) : !memref_smem_bf16_16
        %2414 = cute.get_shape(%lay_6725) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6726, %e1_6727, %e2_6728 = cute.get_leaves(%2414) : !cute.shape<"((8,1),4)">
        %lay_6729 = cute.get_layout(%slice_6723) : !memref_rmem_bf16_8
        %2415 = cute.get_shape(%lay_6729) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6730, %e1_6731, %e2_6732 = cute.get_leaves(%2415) : !cute.shape<"((8,1),4)">
        %lay_6733 = cute.get_layout(%slice_6720) : !memref_smem_bf16_16
        %shape_6734 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6735 = cute.make_layout(%shape_6734) : !cute.layout<"1:0">
        %append_6736 = cute.append_to_rank<2> (%lay_6733, %lay_6735) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6737 = cute.make_view(%iter_6721, %append_6736) : !memref_smem_bf16_16
        %iter_6738 = cute.get_iter(%view_6737) : !memref_smem_bf16_16
        %lay_6739 = cute.get_layout(%view_6737) : !memref_smem_bf16_16
        %2416 = cute.get_shape(%lay_6739) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6740, %e1_6741, %e2_6742 = cute.get_leaves(%2416) : !cute.shape<"((8,1),4)">
        %grouped_6743 = cute.group_modes(%view_6737) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6744 = cute.get_iter(%grouped_6743) : !memref_smem_bf16_17
        %iter_6745 = cute.get_iter(%grouped_6743) : !memref_smem_bf16_17
        %lay_6746 = cute.get_layout(%slice_6723) : !memref_rmem_bf16_8
        %shape_6747 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6748 = cute.make_layout(%shape_6747) : !cute.layout<"1:0">
        %append_6749 = cute.append_to_rank<2> (%lay_6746, %lay_6748) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6750 = cute.make_view(%iter_6724, %append_6749) : !memref_rmem_bf16_8
        %iter_6751 = cute.get_iter(%view_6750) : !memref_rmem_bf16_8
        %lay_6752 = cute.get_layout(%view_6750) : !memref_rmem_bf16_8
        %2417 = cute.get_shape(%lay_6752) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6753, %e1_6754, %e2_6755 = cute.get_leaves(%2417) : !cute.shape<"((8,1),4)">
        %grouped_6756 = cute.group_modes(%view_6750) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_6757 = cute.get_iter(%grouped_6756) : !memref_rmem_bf16_9
        %iter_6758 = cute.get_iter(%grouped_6756) : !memref_rmem_bf16_9
        %lay_6759 = cute.get_layout(%grouped_6743) : !memref_smem_bf16_17
        %2418 = cute.get_shape(%lay_6759) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_6760, %e1_6761, %e2_6762 = cute.get_leaves(%2418) : !cute.shape<"((8,1),(4))">
        %lay_6763 = cute.get_layout(%grouped_6756) : !memref_rmem_bf16_9
        %2419 = cute.get_shape(%lay_6763) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_6764, %e1_6765, %e2_6766 = cute.get_leaves(%2419) : !cute.shape<"((8,1),(4))">
        %sz_6767 = cute.size(%grouped_6743) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_6768 = cute.get_leaves(%sz_6767) : !cute.int_tuple<"4">
        %sz_6769 = cute.size(%grouped_6756) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_6770 = cute.get_leaves(%sz_6769) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6743, %grouped_6756) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_6771 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6772 = cute.slice(%frg_A, %coord_6771) : !memref_rmem_bf16_, !cute.coord<"(_,_,2)">
        %iter_6773 = cute.get_iter(%slice_6772) : !memref_rmem_bf16_10
        %coord_6774 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_6775 = cute.slice(%frg_B, %coord_6774) : !memref_rmem_bf16_1, !cute.coord<"(_,_,2)">
        %iter_6776 = cute.get_iter(%slice_6775) : !memref_rmem_bf16_11
        %lay_6777 = cute.get_layout(%slice_6772) : !memref_rmem_bf16_10
        %2420 = cute.get_shape(%lay_6777) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_6778, %e1_6779, %e2_6780, %e3_6781 = cute.get_leaves(%2420) : !cute.shape<"((2,2,2),2)">
        %lay_6782 = cute.get_layout(%slice_6775) : !memref_rmem_bf16_11
        %2421 = cute.get_shape(%lay_6782) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_6783, %e1_6784, %e2_6785 = cute.get_leaves(%2421) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_6772, %slice_6775, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_6786 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6787 = cute.size(%int_tuple_6786) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6788 = cute.get_leaves(%sz_6787) : !cute.int_tuple<"8">
        %coord_6789 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_6790 = cute.slice(%src_partitioned_317, %coord_6789) : !memref_smem_bf16_8, !cute.coord<"(_,_,4)">
        %iter_6791 = cute.get_iter(%slice_6790) : !memref_smem_bf16_13
        %coord_6792 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_6793 = cute.slice(%retiled, %coord_6792) : !memref_rmem_bf16_3, !cute.coord<"(_,_,4)">
        %iter_6794 = cute.get_iter(%slice_6793) : !memref_rmem_bf16_6
        %lay_6795 = cute.get_layout(%slice_6790) : !memref_smem_bf16_13
        %2422 = cute.get_shape(%lay_6795) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6796, %e1_6797, %e2_6798 = cute.get_leaves(%2422) : !cute.shape<"((8,1),2)">
        %lay_6799 = cute.get_layout(%slice_6793) : !memref_rmem_bf16_6
        %2423 = cute.get_shape(%lay_6799) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6800, %e1_6801, %e2_6802 = cute.get_leaves(%2423) : !cute.shape<"((8,1),2)">
        %lay_6803 = cute.get_layout(%slice_6790) : !memref_smem_bf16_13
        %shape_6804 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6805 = cute.make_layout(%shape_6804) : !cute.layout<"1:0">
        %append_6806 = cute.append_to_rank<2> (%lay_6803, %lay_6805) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6807 = cute.make_view(%iter_6791, %append_6806) : !memref_smem_bf16_13
        %iter_6808 = cute.get_iter(%view_6807) : !memref_smem_bf16_13
        %lay_6809 = cute.get_layout(%view_6807) : !memref_smem_bf16_13
        %2424 = cute.get_shape(%lay_6809) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6810, %e1_6811, %e2_6812 = cute.get_leaves(%2424) : !cute.shape<"((8,1),2)">
        %grouped_6813 = cute.group_modes(%view_6807) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6814 = cute.get_iter(%grouped_6813) : !memref_smem_bf16_14
        %iter_6815 = cute.get_iter(%grouped_6813) : !memref_smem_bf16_14
        %lay_6816 = cute.get_layout(%slice_6793) : !memref_rmem_bf16_6
        %shape_6817 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6818 = cute.make_layout(%shape_6817) : !cute.layout<"1:0">
        %append_6819 = cute.append_to_rank<2> (%lay_6816, %lay_6818) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6820 = cute.make_view(%iter_6794, %append_6819) : !memref_rmem_bf16_6
        %iter_6821 = cute.get_iter(%view_6820) : !memref_rmem_bf16_6
        %lay_6822 = cute.get_layout(%view_6820) : !memref_rmem_bf16_6
        %2425 = cute.get_shape(%lay_6822) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6823, %e1_6824, %e2_6825 = cute.get_leaves(%2425) : !cute.shape<"((8,1),2)">
        %grouped_6826 = cute.group_modes(%view_6820) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6827 = cute.get_iter(%grouped_6826) : !memref_rmem_bf16_7
        %iter_6828 = cute.get_iter(%grouped_6826) : !memref_rmem_bf16_7
        %lay_6829 = cute.get_layout(%grouped_6813) : !memref_smem_bf16_14
        %2426 = cute.get_shape(%lay_6829) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6830, %e1_6831, %e2_6832 = cute.get_leaves(%2426) : !cute.shape<"((8,1),(2))">
        %lay_6833 = cute.get_layout(%grouped_6826) : !memref_rmem_bf16_7
        %2427 = cute.get_shape(%lay_6833) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6834, %e1_6835, %e2_6836 = cute.get_leaves(%2427) : !cute.shape<"((8,1),(2))">
        %sz_6837 = cute.size(%grouped_6813) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6838 = cute.get_leaves(%sz_6837) : !cute.int_tuple<"2">
        %sz_6839 = cute.size(%grouped_6826) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6840 = cute.get_leaves(%sz_6839) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6813, %grouped_6826) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6841 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_6842 = cute.slice(%src_partitioned_321, %coord_6841) : !memref_smem_bf16_9, !cute.coord<"(_,_,4)">
        %iter_6843 = cute.get_iter(%slice_6842) : !memref_smem_bf16_16
        %coord_6844 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_6845 = cute.slice(%retiled_323, %coord_6844) : !memref_rmem_bf16_4, !cute.coord<"(_,_,4)">
        %iter_6846 = cute.get_iter(%slice_6845) : !memref_rmem_bf16_8
        %lay_6847 = cute.get_layout(%slice_6842) : !memref_smem_bf16_16
        %2428 = cute.get_shape(%lay_6847) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6848, %e1_6849, %e2_6850 = cute.get_leaves(%2428) : !cute.shape<"((8,1),4)">
        %lay_6851 = cute.get_layout(%slice_6845) : !memref_rmem_bf16_8
        %2429 = cute.get_shape(%lay_6851) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6852, %e1_6853, %e2_6854 = cute.get_leaves(%2429) : !cute.shape<"((8,1),4)">
        %lay_6855 = cute.get_layout(%slice_6842) : !memref_smem_bf16_16
        %shape_6856 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6857 = cute.make_layout(%shape_6856) : !cute.layout<"1:0">
        %append_6858 = cute.append_to_rank<2> (%lay_6855, %lay_6857) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6859 = cute.make_view(%iter_6843, %append_6858) : !memref_smem_bf16_16
        %iter_6860 = cute.get_iter(%view_6859) : !memref_smem_bf16_16
        %lay_6861 = cute.get_layout(%view_6859) : !memref_smem_bf16_16
        %2430 = cute.get_shape(%lay_6861) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6862, %e1_6863, %e2_6864 = cute.get_leaves(%2430) : !cute.shape<"((8,1),4)">
        %grouped_6865 = cute.group_modes(%view_6859) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6866 = cute.get_iter(%grouped_6865) : !memref_smem_bf16_17
        %iter_6867 = cute.get_iter(%grouped_6865) : !memref_smem_bf16_17
        %lay_6868 = cute.get_layout(%slice_6845) : !memref_rmem_bf16_8
        %shape_6869 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6870 = cute.make_layout(%shape_6869) : !cute.layout<"1:0">
        %append_6871 = cute.append_to_rank<2> (%lay_6868, %lay_6870) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6872 = cute.make_view(%iter_6846, %append_6871) : !memref_rmem_bf16_8
        %iter_6873 = cute.get_iter(%view_6872) : !memref_rmem_bf16_8
        %lay_6874 = cute.get_layout(%view_6872) : !memref_rmem_bf16_8
        %2431 = cute.get_shape(%lay_6874) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6875, %e1_6876, %e2_6877 = cute.get_leaves(%2431) : !cute.shape<"((8,1),4)">
        %grouped_6878 = cute.group_modes(%view_6872) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_6879 = cute.get_iter(%grouped_6878) : !memref_rmem_bf16_9
        %iter_6880 = cute.get_iter(%grouped_6878) : !memref_rmem_bf16_9
        %lay_6881 = cute.get_layout(%grouped_6865) : !memref_smem_bf16_17
        %2432 = cute.get_shape(%lay_6881) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_6882, %e1_6883, %e2_6884 = cute.get_leaves(%2432) : !cute.shape<"((8,1),(4))">
        %lay_6885 = cute.get_layout(%grouped_6878) : !memref_rmem_bf16_9
        %2433 = cute.get_shape(%lay_6885) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_6886, %e1_6887, %e2_6888 = cute.get_leaves(%2433) : !cute.shape<"((8,1),(4))">
        %sz_6889 = cute.size(%grouped_6865) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_6890 = cute.get_leaves(%sz_6889) : !cute.int_tuple<"4">
        %sz_6891 = cute.size(%grouped_6878) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_6892 = cute.get_leaves(%sz_6891) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6865, %grouped_6878) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_6893 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6894 = cute.slice(%frg_A, %coord_6893) : !memref_rmem_bf16_, !cute.coord<"(_,_,3)">
        %iter_6895 = cute.get_iter(%slice_6894) : !memref_rmem_bf16_10
        %coord_6896 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_6897 = cute.slice(%frg_B, %coord_6896) : !memref_rmem_bf16_1, !cute.coord<"(_,_,3)">
        %iter_6898 = cute.get_iter(%slice_6897) : !memref_rmem_bf16_11
        %lay_6899 = cute.get_layout(%slice_6894) : !memref_rmem_bf16_10
        %2434 = cute.get_shape(%lay_6899) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_6900, %e1_6901, %e2_6902, %e3_6903 = cute.get_leaves(%2434) : !cute.shape<"((2,2,2),2)">
        %lay_6904 = cute.get_layout(%slice_6897) : !memref_rmem_bf16_11
        %2435 = cute.get_shape(%lay_6904) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_6905, %e1_6906, %e2_6907 = cute.get_leaves(%2435) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_6894, %slice_6897, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_6908 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_6909 = cute.size(%int_tuple_6908) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_6910 = cute.get_leaves(%sz_6909) : !cute.int_tuple<"8">
        %coord_6911 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_6912 = cute.slice(%src_partitioned_317, %coord_6911) : !memref_smem_bf16_8, !cute.coord<"(_,_,5)">
        %iter_6913 = cute.get_iter(%slice_6912) : !memref_smem_bf16_13
        %coord_6914 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_6915 = cute.slice(%retiled, %coord_6914) : !memref_rmem_bf16_3, !cute.coord<"(_,_,5)">
        %iter_6916 = cute.get_iter(%slice_6915) : !memref_rmem_bf16_6
        %lay_6917 = cute.get_layout(%slice_6912) : !memref_smem_bf16_13
        %2436 = cute.get_shape(%lay_6917) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6918, %e1_6919, %e2_6920 = cute.get_leaves(%2436) : !cute.shape<"((8,1),2)">
        %lay_6921 = cute.get_layout(%slice_6915) : !memref_rmem_bf16_6
        %2437 = cute.get_shape(%lay_6921) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6922, %e1_6923, %e2_6924 = cute.get_leaves(%2437) : !cute.shape<"((8,1),2)">
        %lay_6925 = cute.get_layout(%slice_6912) : !memref_smem_bf16_13
        %shape_6926 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6927 = cute.make_layout(%shape_6926) : !cute.layout<"1:0">
        %append_6928 = cute.append_to_rank<2> (%lay_6925, %lay_6927) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_6929 = cute.make_view(%iter_6913, %append_6928) : !memref_smem_bf16_13
        %iter_6930 = cute.get_iter(%view_6929) : !memref_smem_bf16_13
        %lay_6931 = cute.get_layout(%view_6929) : !memref_smem_bf16_13
        %2438 = cute.get_shape(%lay_6931) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_6932, %e1_6933, %e2_6934 = cute.get_leaves(%2438) : !cute.shape<"((8,1),2)">
        %grouped_6935 = cute.group_modes(%view_6929) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_6936 = cute.get_iter(%grouped_6935) : !memref_smem_bf16_14
        %iter_6937 = cute.get_iter(%grouped_6935) : !memref_smem_bf16_14
        %lay_6938 = cute.get_layout(%slice_6915) : !memref_rmem_bf16_6
        %shape_6939 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6940 = cute.make_layout(%shape_6939) : !cute.layout<"1:0">
        %append_6941 = cute.append_to_rank<2> (%lay_6938, %lay_6940) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6942 = cute.make_view(%iter_6916, %append_6941) : !memref_rmem_bf16_6
        %iter_6943 = cute.get_iter(%view_6942) : !memref_rmem_bf16_6
        %lay_6944 = cute.get_layout(%view_6942) : !memref_rmem_bf16_6
        %2439 = cute.get_shape(%lay_6944) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6945, %e1_6946, %e2_6947 = cute.get_leaves(%2439) : !cute.shape<"((8,1),2)">
        %grouped_6948 = cute.group_modes(%view_6942) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_6949 = cute.get_iter(%grouped_6948) : !memref_rmem_bf16_7
        %iter_6950 = cute.get_iter(%grouped_6948) : !memref_rmem_bf16_7
        %lay_6951 = cute.get_layout(%grouped_6935) : !memref_smem_bf16_14
        %2440 = cute.get_shape(%lay_6951) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_6952, %e1_6953, %e2_6954 = cute.get_leaves(%2440) : !cute.shape<"((8,1),(2))">
        %lay_6955 = cute.get_layout(%grouped_6948) : !memref_rmem_bf16_7
        %2441 = cute.get_shape(%lay_6955) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6956, %e1_6957, %e2_6958 = cute.get_leaves(%2441) : !cute.shape<"((8,1),(2))">
        %sz_6959 = cute.size(%grouped_6935) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_6960 = cute.get_leaves(%sz_6959) : !cute.int_tuple<"2">
        %sz_6961 = cute.size(%grouped_6948) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6962 = cute.get_leaves(%sz_6961) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_6935, %grouped_6948) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_6963 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_6964 = cute.slice(%src_partitioned_321, %coord_6963) : !memref_smem_bf16_9, !cute.coord<"(_,_,5)">
        %iter_6965 = cute.get_iter(%slice_6964) : !memref_smem_bf16_16
        %coord_6966 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_6967 = cute.slice(%retiled_323, %coord_6966) : !memref_rmem_bf16_4, !cute.coord<"(_,_,5)">
        %iter_6968 = cute.get_iter(%slice_6967) : !memref_rmem_bf16_8
        %lay_6969 = cute.get_layout(%slice_6964) : !memref_smem_bf16_16
        %2442 = cute.get_shape(%lay_6969) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6970, %e1_6971, %e2_6972 = cute.get_leaves(%2442) : !cute.shape<"((8,1),4)">
        %lay_6973 = cute.get_layout(%slice_6967) : !memref_rmem_bf16_8
        %2443 = cute.get_shape(%lay_6973) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6974, %e1_6975, %e2_6976 = cute.get_leaves(%2443) : !cute.shape<"((8,1),4)">
        %lay_6977 = cute.get_layout(%slice_6964) : !memref_smem_bf16_16
        %shape_6978 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6979 = cute.make_layout(%shape_6978) : !cute.layout<"1:0">
        %append_6980 = cute.append_to_rank<2> (%lay_6977, %lay_6979) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_6981 = cute.make_view(%iter_6965, %append_6980) : !memref_smem_bf16_16
        %iter_6982 = cute.get_iter(%view_6981) : !memref_smem_bf16_16
        %lay_6983 = cute.get_layout(%view_6981) : !memref_smem_bf16_16
        %2444 = cute.get_shape(%lay_6983) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_6984, %e1_6985, %e2_6986 = cute.get_leaves(%2444) : !cute.shape<"((8,1),4)">
        %grouped_6987 = cute.group_modes(%view_6981) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_6988 = cute.get_iter(%grouped_6987) : !memref_smem_bf16_17
        %iter_6989 = cute.get_iter(%grouped_6987) : !memref_smem_bf16_17
        %lay_6990 = cute.get_layout(%slice_6967) : !memref_rmem_bf16_8
        %shape_6991 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6992 = cute.make_layout(%shape_6991) : !cute.layout<"1:0">
        %append_6993 = cute.append_to_rank<2> (%lay_6990, %lay_6992) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_6994 = cute.make_view(%iter_6968, %append_6993) : !memref_rmem_bf16_8
        %iter_6995 = cute.get_iter(%view_6994) : !memref_rmem_bf16_8
        %lay_6996 = cute.get_layout(%view_6994) : !memref_rmem_bf16_8
        %2445 = cute.get_shape(%lay_6996) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_6997, %e1_6998, %e2_6999 = cute.get_leaves(%2445) : !cute.shape<"((8,1),4)">
        %grouped_7000 = cute.group_modes(%view_6994) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_7001 = cute.get_iter(%grouped_7000) : !memref_rmem_bf16_9
        %iter_7002 = cute.get_iter(%grouped_7000) : !memref_rmem_bf16_9
        %lay_7003 = cute.get_layout(%grouped_6987) : !memref_smem_bf16_17
        %2446 = cute.get_shape(%lay_7003) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_7004, %e1_7005, %e2_7006 = cute.get_leaves(%2446) : !cute.shape<"((8,1),(4))">
        %lay_7007 = cute.get_layout(%grouped_7000) : !memref_rmem_bf16_9
        %2447 = cute.get_shape(%lay_7007) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_7008, %e1_7009, %e2_7010 = cute.get_leaves(%2447) : !cute.shape<"((8,1),(4))">
        %sz_7011 = cute.size(%grouped_6987) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_7012 = cute.get_leaves(%sz_7011) : !cute.int_tuple<"4">
        %sz_7013 = cute.size(%grouped_7000) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_7014 = cute.get_leaves(%sz_7013) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_6987, %grouped_7000) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_7015 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_7016 = cute.slice(%frg_A, %coord_7015) : !memref_rmem_bf16_, !cute.coord<"(_,_,4)">
        %iter_7017 = cute.get_iter(%slice_7016) : !memref_rmem_bf16_10
        %coord_7018 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %slice_7019 = cute.slice(%frg_B, %coord_7018) : !memref_rmem_bf16_1, !cute.coord<"(_,_,4)">
        %iter_7020 = cute.get_iter(%slice_7019) : !memref_rmem_bf16_11
        %lay_7021 = cute.get_layout(%slice_7016) : !memref_rmem_bf16_10
        %2448 = cute.get_shape(%lay_7021) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_7022, %e1_7023, %e2_7024, %e3_7025 = cute.get_leaves(%2448) : !cute.shape<"((2,2,2),2)">
        %lay_7026 = cute.get_layout(%slice_7019) : !memref_rmem_bf16_11
        %2449 = cute.get_shape(%lay_7026) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_7027, %e1_7028, %e2_7029 = cute.get_leaves(%2449) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_7016, %slice_7019, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_7030 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_7031 = cute.size(%int_tuple_7030) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_7032 = cute.get_leaves(%sz_7031) : !cute.int_tuple<"8">
        %coord_7033 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7034 = cute.slice(%src_partitioned_317, %coord_7033) : !memref_smem_bf16_8, !cute.coord<"(_,_,6)">
        %iter_7035 = cute.get_iter(%slice_7034) : !memref_smem_bf16_13
        %coord_7036 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7037 = cute.slice(%retiled, %coord_7036) : !memref_rmem_bf16_3, !cute.coord<"(_,_,6)">
        %iter_7038 = cute.get_iter(%slice_7037) : !memref_rmem_bf16_6
        %lay_7039 = cute.get_layout(%slice_7034) : !memref_smem_bf16_13
        %2450 = cute.get_shape(%lay_7039) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7040, %e1_7041, %e2_7042 = cute.get_leaves(%2450) : !cute.shape<"((8,1),2)">
        %lay_7043 = cute.get_layout(%slice_7037) : !memref_rmem_bf16_6
        %2451 = cute.get_shape(%lay_7043) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7044, %e1_7045, %e2_7046 = cute.get_leaves(%2451) : !cute.shape<"((8,1),2)">
        %lay_7047 = cute.get_layout(%slice_7034) : !memref_smem_bf16_13
        %shape_7048 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7049 = cute.make_layout(%shape_7048) : !cute.layout<"1:0">
        %append_7050 = cute.append_to_rank<2> (%lay_7047, %lay_7049) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7051 = cute.make_view(%iter_7035, %append_7050) : !memref_smem_bf16_13
        %iter_7052 = cute.get_iter(%view_7051) : !memref_smem_bf16_13
        %lay_7053 = cute.get_layout(%view_7051) : !memref_smem_bf16_13
        %2452 = cute.get_shape(%lay_7053) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7054, %e1_7055, %e2_7056 = cute.get_leaves(%2452) : !cute.shape<"((8,1),2)">
        %grouped_7057 = cute.group_modes(%view_7051) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_7058 = cute.get_iter(%grouped_7057) : !memref_smem_bf16_14
        %iter_7059 = cute.get_iter(%grouped_7057) : !memref_smem_bf16_14
        %lay_7060 = cute.get_layout(%slice_7037) : !memref_rmem_bf16_6
        %shape_7061 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7062 = cute.make_layout(%shape_7061) : !cute.layout<"1:0">
        %append_7063 = cute.append_to_rank<2> (%lay_7060, %lay_7062) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7064 = cute.make_view(%iter_7038, %append_7063) : !memref_rmem_bf16_6
        %iter_7065 = cute.get_iter(%view_7064) : !memref_rmem_bf16_6
        %lay_7066 = cute.get_layout(%view_7064) : !memref_rmem_bf16_6
        %2453 = cute.get_shape(%lay_7066) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7067, %e1_7068, %e2_7069 = cute.get_leaves(%2453) : !cute.shape<"((8,1),2)">
        %grouped_7070 = cute.group_modes(%view_7064) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_7071 = cute.get_iter(%grouped_7070) : !memref_rmem_bf16_7
        %iter_7072 = cute.get_iter(%grouped_7070) : !memref_rmem_bf16_7
        %lay_7073 = cute.get_layout(%grouped_7057) : !memref_smem_bf16_14
        %2454 = cute.get_shape(%lay_7073) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7074, %e1_7075, %e2_7076 = cute.get_leaves(%2454) : !cute.shape<"((8,1),(2))">
        %lay_7077 = cute.get_layout(%grouped_7070) : !memref_rmem_bf16_7
        %2455 = cute.get_shape(%lay_7077) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7078, %e1_7079, %e2_7080 = cute.get_leaves(%2455) : !cute.shape<"((8,1),(2))">
        %sz_7081 = cute.size(%grouped_7057) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_7082 = cute.get_leaves(%sz_7081) : !cute.int_tuple<"2">
        %sz_7083 = cute.size(%grouped_7070) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_7084 = cute.get_leaves(%sz_7083) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_7057, %grouped_7070) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_7085 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7086 = cute.slice(%src_partitioned_321, %coord_7085) : !memref_smem_bf16_9, !cute.coord<"(_,_,6)">
        %iter_7087 = cute.get_iter(%slice_7086) : !memref_smem_bf16_16
        %coord_7088 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7089 = cute.slice(%retiled_323, %coord_7088) : !memref_rmem_bf16_4, !cute.coord<"(_,_,6)">
        %iter_7090 = cute.get_iter(%slice_7089) : !memref_rmem_bf16_8
        %lay_7091 = cute.get_layout(%slice_7086) : !memref_smem_bf16_16
        %2456 = cute.get_shape(%lay_7091) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7092, %e1_7093, %e2_7094 = cute.get_leaves(%2456) : !cute.shape<"((8,1),4)">
        %lay_7095 = cute.get_layout(%slice_7089) : !memref_rmem_bf16_8
        %2457 = cute.get_shape(%lay_7095) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7096, %e1_7097, %e2_7098 = cute.get_leaves(%2457) : !cute.shape<"((8,1),4)">
        %lay_7099 = cute.get_layout(%slice_7086) : !memref_smem_bf16_16
        %shape_7100 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7101 = cute.make_layout(%shape_7100) : !cute.layout<"1:0">
        %append_7102 = cute.append_to_rank<2> (%lay_7099, %lay_7101) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_7103 = cute.make_view(%iter_7087, %append_7102) : !memref_smem_bf16_16
        %iter_7104 = cute.get_iter(%view_7103) : !memref_smem_bf16_16
        %lay_7105 = cute.get_layout(%view_7103) : !memref_smem_bf16_16
        %2458 = cute.get_shape(%lay_7105) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7106, %e1_7107, %e2_7108 = cute.get_leaves(%2458) : !cute.shape<"((8,1),4)">
        %grouped_7109 = cute.group_modes(%view_7103) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_7110 = cute.get_iter(%grouped_7109) : !memref_smem_bf16_17
        %iter_7111 = cute.get_iter(%grouped_7109) : !memref_smem_bf16_17
        %lay_7112 = cute.get_layout(%slice_7089) : !memref_rmem_bf16_8
        %shape_7113 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7114 = cute.make_layout(%shape_7113) : !cute.layout<"1:0">
        %append_7115 = cute.append_to_rank<2> (%lay_7112, %lay_7114) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_7116 = cute.make_view(%iter_7090, %append_7115) : !memref_rmem_bf16_8
        %iter_7117 = cute.get_iter(%view_7116) : !memref_rmem_bf16_8
        %lay_7118 = cute.get_layout(%view_7116) : !memref_rmem_bf16_8
        %2459 = cute.get_shape(%lay_7118) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7119, %e1_7120, %e2_7121 = cute.get_leaves(%2459) : !cute.shape<"((8,1),4)">
        %grouped_7122 = cute.group_modes(%view_7116) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_7123 = cute.get_iter(%grouped_7122) : !memref_rmem_bf16_9
        %iter_7124 = cute.get_iter(%grouped_7122) : !memref_rmem_bf16_9
        %lay_7125 = cute.get_layout(%grouped_7109) : !memref_smem_bf16_17
        %2460 = cute.get_shape(%lay_7125) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_7126, %e1_7127, %e2_7128 = cute.get_leaves(%2460) : !cute.shape<"((8,1),(4))">
        %lay_7129 = cute.get_layout(%grouped_7122) : !memref_rmem_bf16_9
        %2461 = cute.get_shape(%lay_7129) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_7130, %e1_7131, %e2_7132 = cute.get_leaves(%2461) : !cute.shape<"((8,1),(4))">
        %sz_7133 = cute.size(%grouped_7109) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_7134 = cute.get_leaves(%sz_7133) : !cute.int_tuple<"4">
        %sz_7135 = cute.size(%grouped_7122) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_7136 = cute.get_leaves(%sz_7135) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_7109, %grouped_7122) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_7137 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_7138 = cute.slice(%frg_A, %coord_7137) : !memref_rmem_bf16_, !cute.coord<"(_,_,5)">
        %iter_7139 = cute.get_iter(%slice_7138) : !memref_rmem_bf16_10
        %coord_7140 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %slice_7141 = cute.slice(%frg_B, %coord_7140) : !memref_rmem_bf16_1, !cute.coord<"(_,_,5)">
        %iter_7142 = cute.get_iter(%slice_7141) : !memref_rmem_bf16_11
        %lay_7143 = cute.get_layout(%slice_7138) : !memref_rmem_bf16_10
        %2462 = cute.get_shape(%lay_7143) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_7144, %e1_7145, %e2_7146, %e3_7147 = cute.get_leaves(%2462) : !cute.shape<"((2,2,2),2)">
        %lay_7148 = cute.get_layout(%slice_7141) : !memref_rmem_bf16_11
        %2463 = cute.get_shape(%lay_7148) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_7149, %e1_7150, %e2_7151 = cute.get_leaves(%2463) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_7138, %slice_7141, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_7152 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_7153 = cute.size(%int_tuple_7152) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_7154 = cute.get_leaves(%sz_7153) : !cute.int_tuple<"8">
        %coord_7155 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7156 = cute.slice(%src_partitioned_317, %coord_7155) : !memref_smem_bf16_8, !cute.coord<"(_,_,7)">
        %iter_7157 = cute.get_iter(%slice_7156) : !memref_smem_bf16_13
        %coord_7158 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7159 = cute.slice(%retiled, %coord_7158) : !memref_rmem_bf16_3, !cute.coord<"(_,_,7)">
        %iter_7160 = cute.get_iter(%slice_7159) : !memref_rmem_bf16_6
        %lay_7161 = cute.get_layout(%slice_7156) : !memref_smem_bf16_13
        %2464 = cute.get_shape(%lay_7161) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7162, %e1_7163, %e2_7164 = cute.get_leaves(%2464) : !cute.shape<"((8,1),2)">
        %lay_7165 = cute.get_layout(%slice_7159) : !memref_rmem_bf16_6
        %2465 = cute.get_shape(%lay_7165) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7166, %e1_7167, %e2_7168 = cute.get_leaves(%2465) : !cute.shape<"((8,1),2)">
        %lay_7169 = cute.get_layout(%slice_7156) : !memref_smem_bf16_13
        %shape_7170 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7171 = cute.make_layout(%shape_7170) : !cute.layout<"1:0">
        %append_7172 = cute.append_to_rank<2> (%lay_7169, %lay_7171) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7173 = cute.make_view(%iter_7157, %append_7172) : !memref_smem_bf16_13
        %iter_7174 = cute.get_iter(%view_7173) : !memref_smem_bf16_13
        %lay_7175 = cute.get_layout(%view_7173) : !memref_smem_bf16_13
        %2466 = cute.get_shape(%lay_7175) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7176, %e1_7177, %e2_7178 = cute.get_leaves(%2466) : !cute.shape<"((8,1),2)">
        %grouped_7179 = cute.group_modes(%view_7173) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_7180 = cute.get_iter(%grouped_7179) : !memref_smem_bf16_14
        %iter_7181 = cute.get_iter(%grouped_7179) : !memref_smem_bf16_14
        %lay_7182 = cute.get_layout(%slice_7159) : !memref_rmem_bf16_6
        %shape_7183 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7184 = cute.make_layout(%shape_7183) : !cute.layout<"1:0">
        %append_7185 = cute.append_to_rank<2> (%lay_7182, %lay_7184) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7186 = cute.make_view(%iter_7160, %append_7185) : !memref_rmem_bf16_6
        %iter_7187 = cute.get_iter(%view_7186) : !memref_rmem_bf16_6
        %lay_7188 = cute.get_layout(%view_7186) : !memref_rmem_bf16_6
        %2467 = cute.get_shape(%lay_7188) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7189, %e1_7190, %e2_7191 = cute.get_leaves(%2467) : !cute.shape<"((8,1),2)">
        %grouped_7192 = cute.group_modes(%view_7186) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_7193 = cute.get_iter(%grouped_7192) : !memref_rmem_bf16_7
        %iter_7194 = cute.get_iter(%grouped_7192) : !memref_rmem_bf16_7
        %lay_7195 = cute.get_layout(%grouped_7179) : !memref_smem_bf16_14
        %2468 = cute.get_shape(%lay_7195) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7196, %e1_7197, %e2_7198 = cute.get_leaves(%2468) : !cute.shape<"((8,1),(2))">
        %lay_7199 = cute.get_layout(%grouped_7192) : !memref_rmem_bf16_7
        %2469 = cute.get_shape(%lay_7199) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7200, %e1_7201, %e2_7202 = cute.get_leaves(%2469) : !cute.shape<"((8,1),(2))">
        %sz_7203 = cute.size(%grouped_7179) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_7204 = cute.get_leaves(%sz_7203) : !cute.int_tuple<"2">
        %sz_7205 = cute.size(%grouped_7192) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_7206 = cute.get_leaves(%sz_7205) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_7179, %grouped_7192) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_7207 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7208 = cute.slice(%src_partitioned_321, %coord_7207) : !memref_smem_bf16_9, !cute.coord<"(_,_,7)">
        %iter_7209 = cute.get_iter(%slice_7208) : !memref_smem_bf16_16
        %coord_7210 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7211 = cute.slice(%retiled_323, %coord_7210) : !memref_rmem_bf16_4, !cute.coord<"(_,_,7)">
        %iter_7212 = cute.get_iter(%slice_7211) : !memref_rmem_bf16_8
        %lay_7213 = cute.get_layout(%slice_7208) : !memref_smem_bf16_16
        %2470 = cute.get_shape(%lay_7213) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7214, %e1_7215, %e2_7216 = cute.get_leaves(%2470) : !cute.shape<"((8,1),4)">
        %lay_7217 = cute.get_layout(%slice_7211) : !memref_rmem_bf16_8
        %2471 = cute.get_shape(%lay_7217) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7218, %e1_7219, %e2_7220 = cute.get_leaves(%2471) : !cute.shape<"((8,1),4)">
        %lay_7221 = cute.get_layout(%slice_7208) : !memref_smem_bf16_16
        %shape_7222 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7223 = cute.make_layout(%shape_7222) : !cute.layout<"1:0">
        %append_7224 = cute.append_to_rank<2> (%lay_7221, %lay_7223) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_7225 = cute.make_view(%iter_7209, %append_7224) : !memref_smem_bf16_16
        %iter_7226 = cute.get_iter(%view_7225) : !memref_smem_bf16_16
        %lay_7227 = cute.get_layout(%view_7225) : !memref_smem_bf16_16
        %2472 = cute.get_shape(%lay_7227) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7228, %e1_7229, %e2_7230 = cute.get_leaves(%2472) : !cute.shape<"((8,1),4)">
        %grouped_7231 = cute.group_modes(%view_7225) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_7232 = cute.get_iter(%grouped_7231) : !memref_smem_bf16_17
        %iter_7233 = cute.get_iter(%grouped_7231) : !memref_smem_bf16_17
        %lay_7234 = cute.get_layout(%slice_7211) : !memref_rmem_bf16_8
        %shape_7235 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7236 = cute.make_layout(%shape_7235) : !cute.layout<"1:0">
        %append_7237 = cute.append_to_rank<2> (%lay_7234, %lay_7236) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_7238 = cute.make_view(%iter_7212, %append_7237) : !memref_rmem_bf16_8
        %iter_7239 = cute.get_iter(%view_7238) : !memref_rmem_bf16_8
        %lay_7240 = cute.get_layout(%view_7238) : !memref_rmem_bf16_8
        %2473 = cute.get_shape(%lay_7240) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7241, %e1_7242, %e2_7243 = cute.get_leaves(%2473) : !cute.shape<"((8,1),4)">
        %grouped_7244 = cute.group_modes(%view_7238) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_7245 = cute.get_iter(%grouped_7244) : !memref_rmem_bf16_9
        %iter_7246 = cute.get_iter(%grouped_7244) : !memref_rmem_bf16_9
        %lay_7247 = cute.get_layout(%grouped_7231) : !memref_smem_bf16_17
        %2474 = cute.get_shape(%lay_7247) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_7248, %e1_7249, %e2_7250 = cute.get_leaves(%2474) : !cute.shape<"((8,1),(4))">
        %lay_7251 = cute.get_layout(%grouped_7244) : !memref_rmem_bf16_9
        %2475 = cute.get_shape(%lay_7251) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_7252, %e1_7253, %e2_7254 = cute.get_leaves(%2475) : !cute.shape<"((8,1),(4))">
        %sz_7255 = cute.size(%grouped_7231) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_7256 = cute.get_leaves(%sz_7255) : !cute.int_tuple<"4">
        %sz_7257 = cute.size(%grouped_7244) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_7258 = cute.get_leaves(%sz_7257) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_7231, %grouped_7244) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_7259 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7260 = cute.slice(%frg_A, %coord_7259) : !memref_rmem_bf16_, !cute.coord<"(_,_,6)">
        %iter_7261 = cute.get_iter(%slice_7260) : !memref_rmem_bf16_10
        %coord_7262 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %slice_7263 = cute.slice(%frg_B, %coord_7262) : !memref_rmem_bf16_1, !cute.coord<"(_,_,6)">
        %iter_7264 = cute.get_iter(%slice_7263) : !memref_rmem_bf16_11
        %lay_7265 = cute.get_layout(%slice_7260) : !memref_rmem_bf16_10
        %2476 = cute.get_shape(%lay_7265) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_7266, %e1_7267, %e2_7268, %e3_7269 = cute.get_leaves(%2476) : !cute.shape<"((2,2,2),2)">
        %lay_7270 = cute.get_layout(%slice_7263) : !memref_rmem_bf16_11
        %2477 = cute.get_shape(%lay_7270) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_7271, %e1_7272, %e2_7273 = cute.get_leaves(%2477) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_7260, %slice_7263, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        %int_tuple_7274 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_7275 = cute.size(%int_tuple_7274) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_7276 = cute.get_leaves(%sz_7275) : !cute.int_tuple<"8">
        %coord_7277 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7278 = cute.slice(%src_partitioned_317, %coord_7277) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)">
        %iter_7279 = cute.get_iter(%slice_7278) : !memref_smem_bf16_13
        %coord_7280 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7281 = cute.slice(%retiled, %coord_7280) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)">
        %iter_7282 = cute.get_iter(%slice_7281) : !memref_rmem_bf16_6
        %lay_7283 = cute.get_layout(%slice_7278) : !memref_smem_bf16_13
        %2478 = cute.get_shape(%lay_7283) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7284, %e1_7285, %e2_7286 = cute.get_leaves(%2478) : !cute.shape<"((8,1),2)">
        %lay_7287 = cute.get_layout(%slice_7281) : !memref_rmem_bf16_6
        %2479 = cute.get_shape(%lay_7287) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7288, %e1_7289, %e2_7290 = cute.get_leaves(%2479) : !cute.shape<"((8,1),2)">
        %lay_7291 = cute.get_layout(%slice_7278) : !memref_smem_bf16_13
        %shape_7292 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7293 = cute.make_layout(%shape_7292) : !cute.layout<"1:0">
        %append_7294 = cute.append_to_rank<2> (%lay_7291, %lay_7293) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7295 = cute.make_view(%iter_7279, %append_7294) : !memref_smem_bf16_13
        %iter_7296 = cute.get_iter(%view_7295) : !memref_smem_bf16_13
        %lay_7297 = cute.get_layout(%view_7295) : !memref_smem_bf16_13
        %2480 = cute.get_shape(%lay_7297) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7298, %e1_7299, %e2_7300 = cute.get_leaves(%2480) : !cute.shape<"((8,1),2)">
        %grouped_7301 = cute.group_modes(%view_7295) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14
        %iter_7302 = cute.get_iter(%grouped_7301) : !memref_smem_bf16_14
        %iter_7303 = cute.get_iter(%grouped_7301) : !memref_smem_bf16_14
        %lay_7304 = cute.get_layout(%slice_7281) : !memref_rmem_bf16_6
        %shape_7305 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7306 = cute.make_layout(%shape_7305) : !cute.layout<"1:0">
        %append_7307 = cute.append_to_rank<2> (%lay_7304, %lay_7306) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7308 = cute.make_view(%iter_7282, %append_7307) : !memref_rmem_bf16_6
        %iter_7309 = cute.get_iter(%view_7308) : !memref_rmem_bf16_6
        %lay_7310 = cute.get_layout(%view_7308) : !memref_rmem_bf16_6
        %2481 = cute.get_shape(%lay_7310) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7311, %e1_7312, %e2_7313 = cute.get_leaves(%2481) : !cute.shape<"((8,1),2)">
        %grouped_7314 = cute.group_modes(%view_7308) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7
        %iter_7315 = cute.get_iter(%grouped_7314) : !memref_rmem_bf16_7
        %iter_7316 = cute.get_iter(%grouped_7314) : !memref_rmem_bf16_7
        %lay_7317 = cute.get_layout(%grouped_7301) : !memref_smem_bf16_14
        %2482 = cute.get_shape(%lay_7317) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7318, %e1_7319, %e2_7320 = cute.get_leaves(%2482) : !cute.shape<"((8,1),(2))">
        %lay_7321 = cute.get_layout(%grouped_7314) : !memref_rmem_bf16_7
        %2483 = cute.get_shape(%lay_7321) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7322, %e1_7323, %e2_7324 = cute.get_leaves(%2483) : !cute.shape<"((8,1),(2))">
        %sz_7325 = cute.size(%grouped_7301) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2">
        %e0_7326 = cute.get_leaves(%sz_7325) : !cute.int_tuple<"2">
        %sz_7327 = cute.size(%grouped_7314) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_7328 = cute.get_leaves(%sz_7327) : !cute.int_tuple<"2">
        cute.copy(%136, %grouped_7301, %grouped_7314) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7)
        %coord_7329 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7330 = cute.slice(%src_partitioned_321, %coord_7329) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)">
        %iter_7331 = cute.get_iter(%slice_7330) : !memref_smem_bf16_16
        %coord_7332 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7333 = cute.slice(%retiled_323, %coord_7332) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)">
        %iter_7334 = cute.get_iter(%slice_7333) : !memref_rmem_bf16_8
        %lay_7335 = cute.get_layout(%slice_7330) : !memref_smem_bf16_16
        %2484 = cute.get_shape(%lay_7335) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7336, %e1_7337, %e2_7338 = cute.get_leaves(%2484) : !cute.shape<"((8,1),4)">
        %lay_7339 = cute.get_layout(%slice_7333) : !memref_rmem_bf16_8
        %2485 = cute.get_shape(%lay_7339) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7340, %e1_7341, %e2_7342 = cute.get_leaves(%2485) : !cute.shape<"((8,1),4)">
        %lay_7343 = cute.get_layout(%slice_7330) : !memref_smem_bf16_16
        %shape_7344 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7345 = cute.make_layout(%shape_7344) : !cute.layout<"1:0">
        %append_7346 = cute.append_to_rank<2> (%lay_7343, %lay_7345) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_7347 = cute.make_view(%iter_7331, %append_7346) : !memref_smem_bf16_16
        %iter_7348 = cute.get_iter(%view_7347) : !memref_smem_bf16_16
        %lay_7349 = cute.get_layout(%view_7347) : !memref_smem_bf16_16
        %2486 = cute.get_shape(%lay_7349) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7350, %e1_7351, %e2_7352 = cute.get_leaves(%2486) : !cute.shape<"((8,1),4)">
        %grouped_7353 = cute.group_modes(%view_7347) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17
        %iter_7354 = cute.get_iter(%grouped_7353) : !memref_smem_bf16_17
        %iter_7355 = cute.get_iter(%grouped_7353) : !memref_smem_bf16_17
        %lay_7356 = cute.get_layout(%slice_7333) : !memref_rmem_bf16_8
        %shape_7357 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7358 = cute.make_layout(%shape_7357) : !cute.layout<"1:0">
        %append_7359 = cute.append_to_rank<2> (%lay_7356, %lay_7358) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_7360 = cute.make_view(%iter_7334, %append_7359) : !memref_rmem_bf16_8
        %iter_7361 = cute.get_iter(%view_7360) : !memref_rmem_bf16_8
        %lay_7362 = cute.get_layout(%view_7360) : !memref_rmem_bf16_8
        %2487 = cute.get_shape(%lay_7362) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7363, %e1_7364, %e2_7365 = cute.get_leaves(%2487) : !cute.shape<"((8,1),4)">
        %grouped_7366 = cute.group_modes(%view_7360) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9
        %iter_7367 = cute.get_iter(%grouped_7366) : !memref_rmem_bf16_9
        %iter_7368 = cute.get_iter(%grouped_7366) : !memref_rmem_bf16_9
        %lay_7369 = cute.get_layout(%grouped_7353) : !memref_smem_bf16_17
        %2488 = cute.get_shape(%lay_7369) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_7370, %e1_7371, %e2_7372 = cute.get_leaves(%2488) : !cute.shape<"((8,1),(4))">
        %lay_7373 = cute.get_layout(%grouped_7366) : !memref_rmem_bf16_9
        %2489 = cute.get_shape(%lay_7373) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_7374, %e1_7375, %e2_7376 = cute.get_leaves(%2489) : !cute.shape<"((8,1),(4))">
        %sz_7377 = cute.size(%grouped_7353) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4">
        %e0_7378 = cute.get_leaves(%sz_7377) : !cute.int_tuple<"4">
        %sz_7379 = cute.size(%grouped_7366) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4">
        %e0_7380 = cute.get_leaves(%sz_7379) : !cute.int_tuple<"4">
        cute.copy(%140, %grouped_7353, %grouped_7366) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9)
        %coord_7381 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7382 = cute.slice(%frg_A, %coord_7381) : !memref_rmem_bf16_, !cute.coord<"(_,_,7)">
        %iter_7383 = cute.get_iter(%slice_7382) : !memref_rmem_bf16_10
        %coord_7384 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %slice_7385 = cute.slice(%frg_B, %coord_7384) : !memref_rmem_bf16_1, !cute.coord<"(_,_,7)">
        %iter_7386 = cute.get_iter(%slice_7385) : !memref_rmem_bf16_11
        %lay_7387 = cute.get_layout(%slice_7382) : !memref_rmem_bf16_10
        %2490 = cute.get_shape(%lay_7387) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_7388, %e1_7389, %e2_7390, %e3_7391 = cute.get_leaves(%2490) : !cute.shape<"((2,2,2),2)">
        %lay_7392 = cute.get_layout(%slice_7385) : !memref_rmem_bf16_11
        %2491 = cute.get_shape(%lay_7392) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_7393, %e1_7394, %e2_7395 = cute.get_leaves(%2491) : !cute.shape<"((2,2),8)">
        cute.gemm(%5, %rmem_6283, %slice_7382, %slice_7385, %rmem_6283) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2)
        nvvm.cp.async.wait.group 0
        %c1_i32_7396 = arith.constant 1 : i32
        %c128_i32_7397 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_7396 number_of_threads = %c128_i32_7397
        %c0_i32_7398 = arith.constant 0 : i32
        %2492 = arith.cmpi sgt, %2363, %c0_i32_7398 : i32
        scf.if %2492 {
          %c1_i32_8150 = arith.constant 1 : i32
          %2684 = arith.subi %2363, %c1_i32_8150 : i32
          %coord_8151 = cute.make_coord(%2684) : (i32) -> !cute.coord<"(_,_,_,?)">
          %slice_8152 = cute.slice(%src_partitioned_233, %coord_8151) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)">
          %iter_8153 = cute.get_iter(%slice_8152) : !memref_gmem_bf16_8
          %lay_8154 = cute.get_layout(%slice_8152) : !memref_gmem_bf16_8
          %2685 = cute.get_shape(%lay_8154) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8155, %e1_8156, %e2_8157, %e3_8158 = cute.get_leaves(%2685) : !cute.shape<"((8,1),4,2)">
          %lay_8159 = cute.get_layout(%dst_partitioned_236) : !memref_smem_bf16_4
          %2686 = cute.get_shape(%lay_8159) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8160, %e1_8161, %e2_8162, %e3_8163 = cute.get_leaves(%2686) : !cute.shape<"((8,1),4,2)">
          %lay_8164 = cute.get_layout(%slice_8152) : !memref_gmem_bf16_8
          %shape_8165 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8166 = cute.make_layout(%shape_8165) : !cute.layout<"1:0">
          %append_8167 = cute.append_to_rank<2> (%lay_8164, %lay_8166) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_8168 = cute.make_view(%iter_8153, %append_8167) : !memref_gmem_bf16_8
          %iter_8169 = cute.get_iter(%view_8168) : !memref_gmem_bf16_8
          %lay_8170 = cute.get_layout(%view_8168) : !memref_gmem_bf16_8
          %2687 = cute.get_shape(%lay_8170) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8171, %e1_8172, %e2_8173, %e3_8174 = cute.get_leaves(%2687) : !cute.shape<"((8,1),4,2)">
          %grouped_8175 = cute.group_modes(%view_8168) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9
          %iter_8176 = cute.get_iter(%grouped_8175) : !memref_gmem_bf16_9
          %iter_8177 = cute.get_iter(%grouped_8175) : !memref_gmem_bf16_9
          %lay_8178 = cute.get_layout(%dst_partitioned_236) : !memref_smem_bf16_4
          %shape_8179 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8180 = cute.make_layout(%shape_8179) : !cute.layout<"1:0">
          %append_8181 = cute.append_to_rank<2> (%lay_8178, %lay_8180) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_8182 = cute.make_view(%iter_237, %append_8181) : !memref_smem_bf16_4
          %iter_8183 = cute.get_iter(%view_8182) : !memref_smem_bf16_4
          %lay_8184 = cute.get_layout(%view_8182) : !memref_smem_bf16_4
          %2688 = cute.get_shape(%lay_8184) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_8185, %e1_8186, %e2_8187, %e3_8188 = cute.get_leaves(%2688) : !cute.shape<"((8,1),4,2)">
          %grouped_8189 = cute.group_modes(%view_8182) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15
          %iter_8190 = cute.get_iter(%grouped_8189) : !memref_smem_bf16_15
          %iter_8191 = cute.get_iter(%grouped_8189) : !memref_smem_bf16_15
          %lay_8192 = cute.get_layout(%rmem_435) : !memref_rmem_i8_1
          %shape_8193 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8194 = cute.make_layout(%shape_8193) : !cute.layout<"1:0">
          %append_8195 = cute.append_to_rank<2> (%lay_8192, %lay_8194) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_8196 = cute.make_view(%iter_437, %append_8195) : !memref_rmem_i8_1
          %iter_8197 = cute.get_iter(%view_8196) : !memref_rmem_i8_1
          %lay_8198 = cute.get_layout(%view_8196) : !memref_rmem_i8_1
          %2689 = cute.get_shape(%lay_8198) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_8199, %e1_8200, %e2_8201 = cute.get_leaves(%2689) : !cute.shape<"(1,4,2)">
          %grouped_8202 = cute.group_modes(%view_8196) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4
          %iter_8203 = cute.get_iter(%grouped_8202) : !memref_rmem_i8_4
          %iter_8204 = cute.get_iter(%grouped_8202) : !memref_rmem_i8_4
          %lay_8205 = cute.get_layout(%grouped_8175) : !memref_gmem_bf16_9
          %2690 = cute.get_shape(%lay_8205) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_8206, %e1_8207, %e2_8208, %e3_8209 = cute.get_leaves(%2690) : !cute.shape<"((8,1),(4,2))">
          %lay_8210 = cute.get_layout(%grouped_8189) : !memref_smem_bf16_15
          %2691 = cute.get_shape(%lay_8210) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_8211, %e1_8212, %e2_8213, %e3_8214 = cute.get_leaves(%2691) : !cute.shape<"((8,1),(4,2))">
          %sz_8215 = cute.size(%grouped_8175) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8">
          %e0_8216 = cute.get_leaves(%sz_8215) : !cute.int_tuple<"8">
          %sz_8217 = cute.size(%grouped_8189) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8">
          %e0_8218 = cute.get_leaves(%sz_8217) : !cute.int_tuple<"8">
          cute.copy(%3, %grouped_8175, %grouped_8189, %grouped_8202) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4)
          nvvm.cp.async.commit.group
        }
        %lay_7399 = cute.get_layout(%rmem_6283) : !memref_rmem_f32_2
        %2493 = cute.get_shape(%lay_7399) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7400, %e1_7401, %e2_7402, %e3_7403 = cute.get_leaves(%2493) : !cute.shape<"((2,2),2,8)">
        %shape_7404 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_7405 = cute.make_layout(%shape_7404) : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %2494 = cute.get_shape(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7406, %e1_7407, %e2_7408, %e3_7409 = cute.get_leaves(%2494) : !cute.shape<"((2,2),2,8)">
        %2495 = cute.get_shape(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7410, %e1_7411, %e2_7412, %e3_7413 = cute.get_leaves(%2495) : !cute.shape<"((2,2),2,8)">
        %2496 = cute.get_shape(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7414, %e1_7415, %e2_7416, %e3_7417 = cute.get_leaves(%2496) : !cute.shape<"((2,2),2,8)">
        %2497 = cute.get_shape(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7418, %e1_7419, %e2_7420, %e3_7421 = cute.get_leaves(%2497) : !cute.shape<"((2,2),2,8)">
        %2498 = cute.get_stride(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7422, %e1_7423, %e2_7424, %e3_7425 = cute.get_leaves(%2498) : !cute.stride<"((1,2),4,8)">
        %2499 = cute.get_stride(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7426, %e1_7427, %e2_7428, %e3_7429 = cute.get_leaves(%2499) : !cute.stride<"((1,2),4,8)">
        %2500 = cute.get_stride(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7430, %e1_7431, %e2_7432, %e3_7433 = cute.get_leaves(%2500) : !cute.stride<"((1,2),4,8)">
        %2501 = cute.get_stride(%lay_7405) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7434, %e1_7435, %e2_7436, %e3_7437 = cute.get_leaves(%2501) : !cute.stride<"((1,2),4,8)">
        %shape_7438 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
        %stride_7439 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_7440 = cute.make_layout(%shape_7438, %stride_7439) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %lay_7441 = cute.get_layout(%rmem_6283) : !memref_rmem_f32_2
        %2502 = cute.composition(%lay_7441, %lay_7440) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %view_7442 = cute.make_view(%iter_6285, %2502) : !memref_rmem_f32_3
        %iter_7443 = cute.get_iter(%view_7442) : !memref_rmem_f32_3
        %lay_7444 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2503 = cute.get_shape(%lay_7444) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7445, %e1_7446, %e2_7447, %e3_7448 = cute.get_leaves(%2503) : !cute.shape<"((2,2),2,16)">
        %shape_7449 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
        %lay_7450 = cute.make_layout(%shape_7449) : !cute.layout<"((2,2),2,16):((1,2),4,8)">
        %2504 = cute.get_shape(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7451, %e1_7452, %e2_7453, %e3_7454 = cute.get_leaves(%2504) : !cute.shape<"((2,2),2,16)">
        %2505 = cute.get_shape(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7455, %e1_7456, %e2_7457, %e3_7458 = cute.get_leaves(%2505) : !cute.shape<"((2,2),2,16)">
        %2506 = cute.get_shape(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7459, %e1_7460, %e2_7461, %e3_7462 = cute.get_leaves(%2506) : !cute.shape<"((2,2),2,16)">
        %2507 = cute.get_shape(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7463, %e1_7464, %e2_7465, %e3_7466 = cute.get_leaves(%2507) : !cute.shape<"((2,2),2,16)">
        %2508 = cute.get_stride(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7467, %e1_7468, %e2_7469, %e3_7470 = cute.get_leaves(%2508) : !cute.stride<"((1,2),4,8)">
        %2509 = cute.get_stride(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7471, %e1_7472, %e2_7473, %e3_7474 = cute.get_leaves(%2509) : !cute.stride<"((1,2),4,8)">
        %2510 = cute.get_stride(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7475, %e1_7476, %e2_7477, %e3_7478 = cute.get_leaves(%2510) : !cute.stride<"((1,2),4,8)">
        %2511 = cute.get_stride(%lay_7450) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_7479, %e1_7480, %e2_7481, %e3_7482 = cute.get_leaves(%2511) : !cute.stride<"((1,2),4,8)">
        %shape_7483 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
        %stride_7484 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_7485 = cute.make_layout(%shape_7483, %stride_7484) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %lay_7486 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2512 = cute.composition(%lay_7486, %lay_7485) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %view_7487 = cute.make_view(%iter_263, %2512) : !memref_rmem_f32_4
        %iter_7488 = cute.get_iter(%view_7487) : !memref_rmem_f32_4
        %lay_7489 = cute.get_layout(%rmem_906) : !memref_rmem_f32_1
        %2513 = cute.make_layout_like(%lay_7489) : !cute.layout<"4:1"> to !cute.layout<"4:1">
        %rmem_7490 = cute.memref.alloca(%2513) : !memref_rmem_f32_1
        %iter_7491 = cute.get_iter(%rmem_7490) : !memref_rmem_f32_1
        %iter_7492 = cute.get_iter(%rmem_7490) : !memref_rmem_f32_1
        %lay_7493 = cute.get_layout(%rmem_906) : !memref_rmem_f32_1
        %2514 = cute.get_shape(%lay_7493) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_7494 = cute.get_leaves(%2514) : !cute.shape<"4">
        %lay_7495 = cute.get_layout(%rmem_7490) : !memref_rmem_f32_1
        %2515 = cute.get_shape(%lay_7495) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_7496 = cute.get_leaves(%2515) : !cute.shape<"4">
        %atom_7497 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b>
        cute.copy(%atom_7497, %rmem_906, %rmem_7490) : (!cute_nvgpu.atom.universal_copy<f32, 32 b>, !memref_rmem_f32_1, !memref_rmem_f32_1)
        %sz_7498 = cute.size(%rmem_906) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4">
        %e0_7499 = cute.get_leaves(%sz_7498) : !cute.int_tuple<"4">
        %coord_7500 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %slice_7501 = cute.slice(%view_7442, %coord_7500) : !memref_rmem_f32_3, !cute.coord<"(0,_)">
        %iter_7502 = cute.get_iter(%slice_7501) : !memref_rmem_f32_5
        %lay_7503 = cute.get_layout(%slice_7501) : !memref_rmem_f32_5
        %2516 = cute.get_shape(%lay_7503) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7504, %e1_7505 = cute.get_leaves(%2516) : !cute.shape<"((2,8))">
        %2517 = cute.memref.load_vec %slice_7501, row_major : !memref_rmem_f32_5
        %cst_7506 = arith.constant 0xFF800000 : f32
        %2518 = vector.reduction <maximumf>, %2517, %cst_7506 : vector<16xf32> into f32
        %c-1_i32_7507 = arith.constant -1 : i32
        %c2_i32_7508 = arith.constant 2 : i32
        %c31_i32_7509 = arith.constant 31 : i32
        %2519 = nvvm.shfl.sync  bfly %c-1_i32_7507, %2518, %c2_i32_7508, %c31_i32_7509 : f32 -> f32
        %2520 = nvvm.fmax %2518, %2519
        %c-1_i32_7510 = arith.constant -1 : i32
        %c1_i32_7511 = arith.constant 1 : i32
        %c31_i32_7512 = arith.constant 31 : i32
        %2521 = nvvm.shfl.sync  bfly %c-1_i32_7510, %2520, %c1_i32_7511, %c31_i32_7512 : f32 -> f32
        %2522 = nvvm.fmax %2520, %2521
        %coord_7513 = cute.make_coord() : () -> !cute.coord<"0">
        %2523 = cute.memref.load(%rmem_7490, %coord_7513) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2524 = nvvm.fmax %2523, %2522
        %2525 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2526 = arith.mulf %2517, %2525 : vector<16xf32>
        %2527 = arith.mulf %2524, %arg4 : f32
        %2528 = vector.broadcast %2527 : f32 to vector<16xf32>
        %2529 = arith.subf %2526, %2528 : vector<16xf32>
        %2530 = math.exp2 %2529 fastmath<fast> : vector<16xf32>
        %cst_7514 = arith.constant 0.000000e+00 : f32
        %2531 = vector.reduction <add>, %2530, %cst_7514 : vector<16xf32> into f32
        %2532 = arith.mulf %2523, %arg4 : f32
        %2533 = arith.mulf %2524, %arg4 : f32
        %2534 = arith.subf %2532, %2533 : f32
        %2535 = math.exp2 %2534 fastmath<fast> : f32
        %coord_7515 = cute.make_coord() : () -> !cute.coord<"0">
        %2536 = cute.memref.load(%rmem_911, %coord_7515) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2537 = arith.mulf %2536, %2535 : f32
        %2538 = arith.addf %2537, %2531 : f32
        %coord_7516 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %slice_7517 = cute.slice(%view_7487, %coord_7516) : !memref_rmem_f32_4, !cute.coord<"(0,_)">
        %iter_7518 = cute.get_iter(%slice_7517) : !memref_rmem_f32_8
        %lay_7519 = cute.get_layout(%slice_7517) : !memref_rmem_f32_8
        %2539 = cute.get_shape(%lay_7519) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7520, %e1_7521 = cute.get_leaves(%2539) : !cute.shape<"((2,16))">
        %2540 = cute.memref.load_vec %slice_7517, row_major : !memref_rmem_f32_8
        %2541 = vector.broadcast %2535 : f32 to vector<32xf32>
        %2542 = arith.mulf %2540, %2541 : vector<32xf32>
        %coord_7522 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %slice_7523 = cute.slice(%view_7487, %coord_7522) : !memref_rmem_f32_4, !cute.coord<"(0,_)">
        %iter_7524 = cute.get_iter(%slice_7523) : !memref_rmem_f32_8
        %lay_7525 = cute.get_layout(%slice_7523) : !memref_rmem_f32_8
        %2543 = cute.get_shape(%lay_7525) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7526, %e1_7527 = cute.get_leaves(%2543) : !cute.shape<"((2,16))">
        %int_tuple_7528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7529 = cute.size(%int_tuple_7528) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7530 = cute.get_leaves(%sz_7529) : !cute.int_tuple<"32">
        %int_tuple_7531 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7532 = cute.size(%int_tuple_7531) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7533 = cute.get_leaves(%sz_7532) : !cute.int_tuple<"32">
        cute.memref.store_vec %2542, %slice_7523, row_major : !memref_rmem_f32_8
        %coord_7534 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_906, %coord_7534, %2524) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_7535 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_911, %coord_7535, %2538) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_7536 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %slice_7537 = cute.slice(%view_7442, %coord_7536) : !memref_rmem_f32_3, !cute.coord<"(0,_)">
        %iter_7538 = cute.get_iter(%slice_7537) : !memref_rmem_f32_5
        %lay_7539 = cute.get_layout(%slice_7537) : !memref_rmem_f32_5
        %2544 = cute.get_shape(%lay_7539) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7540, %e1_7541 = cute.get_leaves(%2544) : !cute.shape<"((2,8))">
        %int_tuple_7542 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7543 = cute.size(%int_tuple_7542) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7544 = cute.get_leaves(%sz_7543) : !cute.int_tuple<"16">
        %int_tuple_7545 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7546 = cute.size(%int_tuple_7545) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7547 = cute.get_leaves(%sz_7546) : !cute.int_tuple<"16">
        cute.memref.store_vec %2530, %slice_7537, row_major : !memref_rmem_f32_5
        %coord_7548 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %slice_7549 = cute.slice(%view_7442, %coord_7548) : !memref_rmem_f32_3, !cute.coord<"(1,_)">
        %iter_7550 = cute.get_iter(%slice_7549) : !memref_rmem_f32_6
        %lay_7551 = cute.get_layout(%slice_7549) : !memref_rmem_f32_6
        %2545 = cute.get_shape(%lay_7551) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7552, %e1_7553 = cute.get_leaves(%2545) : !cute.shape<"((2,8))">
        %2546 = cute.memref.load_vec %slice_7549, row_major : !memref_rmem_f32_6
        %cst_7554 = arith.constant 0xFF800000 : f32
        %2547 = vector.reduction <maximumf>, %2546, %cst_7554 : vector<16xf32> into f32
        %c-1_i32_7555 = arith.constant -1 : i32
        %c2_i32_7556 = arith.constant 2 : i32
        %c31_i32_7557 = arith.constant 31 : i32
        %2548 = nvvm.shfl.sync  bfly %c-1_i32_7555, %2547, %c2_i32_7556, %c31_i32_7557 : f32 -> f32
        %2549 = nvvm.fmax %2547, %2548
        %c-1_i32_7558 = arith.constant -1 : i32
        %c1_i32_7559 = arith.constant 1 : i32
        %c31_i32_7560 = arith.constant 31 : i32
        %2550 = nvvm.shfl.sync  bfly %c-1_i32_7558, %2549, %c1_i32_7559, %c31_i32_7560 : f32 -> f32
        %2551 = nvvm.fmax %2549, %2550
        %coord_7561 = cute.make_coord() : () -> !cute.coord<"1">
        %2552 = cute.memref.load(%rmem_7490, %coord_7561) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2553 = nvvm.fmax %2552, %2551
        %2554 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2555 = arith.mulf %2546, %2554 : vector<16xf32>
        %2556 = arith.mulf %2553, %arg4 : f32
        %2557 = vector.broadcast %2556 : f32 to vector<16xf32>
        %2558 = arith.subf %2555, %2557 : vector<16xf32>
        %2559 = math.exp2 %2558 fastmath<fast> : vector<16xf32>
        %cst_7562 = arith.constant 0.000000e+00 : f32
        %2560 = vector.reduction <add>, %2559, %cst_7562 : vector<16xf32> into f32
        %2561 = arith.mulf %2552, %arg4 : f32
        %2562 = arith.mulf %2553, %arg4 : f32
        %2563 = arith.subf %2561, %2562 : f32
        %2564 = math.exp2 %2563 fastmath<fast> : f32
        %coord_7563 = cute.make_coord() : () -> !cute.coord<"1">
        %2565 = cute.memref.load(%rmem_911, %coord_7563) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2566 = arith.mulf %2565, %2564 : f32
        %2567 = arith.addf %2566, %2560 : f32
        %coord_7564 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %slice_7565 = cute.slice(%view_7487, %coord_7564) : !memref_rmem_f32_4, !cute.coord<"(1,_)">
        %iter_7566 = cute.get_iter(%slice_7565) : !memref_rmem_f32_9
        %lay_7567 = cute.get_layout(%slice_7565) : !memref_rmem_f32_9
        %2568 = cute.get_shape(%lay_7567) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7568, %e1_7569 = cute.get_leaves(%2568) : !cute.shape<"((2,16))">
        %2569 = cute.memref.load_vec %slice_7565, row_major : !memref_rmem_f32_9
        %2570 = vector.broadcast %2564 : f32 to vector<32xf32>
        %2571 = arith.mulf %2569, %2570 : vector<32xf32>
        %coord_7570 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %slice_7571 = cute.slice(%view_7487, %coord_7570) : !memref_rmem_f32_4, !cute.coord<"(1,_)">
        %iter_7572 = cute.get_iter(%slice_7571) : !memref_rmem_f32_9
        %lay_7573 = cute.get_layout(%slice_7571) : !memref_rmem_f32_9
        %2572 = cute.get_shape(%lay_7573) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7574, %e1_7575 = cute.get_leaves(%2572) : !cute.shape<"((2,16))">
        %int_tuple_7576 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7577 = cute.size(%int_tuple_7576) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7578 = cute.get_leaves(%sz_7577) : !cute.int_tuple<"32">
        %int_tuple_7579 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7580 = cute.size(%int_tuple_7579) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7581 = cute.get_leaves(%sz_7580) : !cute.int_tuple<"32">
        cute.memref.store_vec %2571, %slice_7571, row_major : !memref_rmem_f32_9
        %coord_7582 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_906, %coord_7582, %2553) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_7583 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_911, %coord_7583, %2567) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_7584 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %slice_7585 = cute.slice(%view_7442, %coord_7584) : !memref_rmem_f32_3, !cute.coord<"(1,_)">
        %iter_7586 = cute.get_iter(%slice_7585) : !memref_rmem_f32_6
        %lay_7587 = cute.get_layout(%slice_7585) : !memref_rmem_f32_6
        %2573 = cute.get_shape(%lay_7587) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7588, %e1_7589 = cute.get_leaves(%2573) : !cute.shape<"((2,8))">
        %int_tuple_7590 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7591 = cute.size(%int_tuple_7590) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7592 = cute.get_leaves(%sz_7591) : !cute.int_tuple<"16">
        %int_tuple_7593 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7594 = cute.size(%int_tuple_7593) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7595 = cute.get_leaves(%sz_7594) : !cute.int_tuple<"16">
        cute.memref.store_vec %2559, %slice_7585, row_major : !memref_rmem_f32_6
        %coord_7596 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %slice_7597 = cute.slice(%view_7442, %coord_7596) : !memref_rmem_f32_3, !cute.coord<"(2,_)">
        %iter_7598 = cute.get_iter(%slice_7597) : !memref_rmem_f32_7
        %lay_7599 = cute.get_layout(%slice_7597) : !memref_rmem_f32_7
        %2574 = cute.get_shape(%lay_7599) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7600, %e1_7601 = cute.get_leaves(%2574) : !cute.shape<"((2,8))">
        %2575 = cute.memref.load_vec %slice_7597, row_major : !memref_rmem_f32_7
        %cst_7602 = arith.constant 0xFF800000 : f32
        %2576 = vector.reduction <maximumf>, %2575, %cst_7602 : vector<16xf32> into f32
        %c-1_i32_7603 = arith.constant -1 : i32
        %c2_i32_7604 = arith.constant 2 : i32
        %c31_i32_7605 = arith.constant 31 : i32
        %2577 = nvvm.shfl.sync  bfly %c-1_i32_7603, %2576, %c2_i32_7604, %c31_i32_7605 : f32 -> f32
        %2578 = nvvm.fmax %2576, %2577
        %c-1_i32_7606 = arith.constant -1 : i32
        %c1_i32_7607 = arith.constant 1 : i32
        %c31_i32_7608 = arith.constant 31 : i32
        %2579 = nvvm.shfl.sync  bfly %c-1_i32_7606, %2578, %c1_i32_7607, %c31_i32_7608 : f32 -> f32
        %2580 = nvvm.fmax %2578, %2579
        %coord_7609 = cute.make_coord() : () -> !cute.coord<"2">
        %2581 = cute.memref.load(%rmem_7490, %coord_7609) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2582 = nvvm.fmax %2581, %2580
        %2583 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2584 = arith.mulf %2575, %2583 : vector<16xf32>
        %2585 = arith.mulf %2582, %arg4 : f32
        %2586 = vector.broadcast %2585 : f32 to vector<16xf32>
        %2587 = arith.subf %2584, %2586 : vector<16xf32>
        %2588 = math.exp2 %2587 fastmath<fast> : vector<16xf32>
        %cst_7610 = arith.constant 0.000000e+00 : f32
        %2589 = vector.reduction <add>, %2588, %cst_7610 : vector<16xf32> into f32
        %2590 = arith.mulf %2581, %arg4 : f32
        %2591 = arith.mulf %2582, %arg4 : f32
        %2592 = arith.subf %2590, %2591 : f32
        %2593 = math.exp2 %2592 fastmath<fast> : f32
        %coord_7611 = cute.make_coord() : () -> !cute.coord<"2">
        %2594 = cute.memref.load(%rmem_911, %coord_7611) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2595 = arith.mulf %2594, %2593 : f32
        %2596 = arith.addf %2595, %2589 : f32
        %coord_7612 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %slice_7613 = cute.slice(%view_7487, %coord_7612) : !memref_rmem_f32_4, !cute.coord<"(2,_)">
        %iter_7614 = cute.get_iter(%slice_7613) : !memref_rmem_f32_10
        %lay_7615 = cute.get_layout(%slice_7613) : !memref_rmem_f32_10
        %2597 = cute.get_shape(%lay_7615) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7616, %e1_7617 = cute.get_leaves(%2597) : !cute.shape<"((2,16))">
        %2598 = cute.memref.load_vec %slice_7613, row_major : !memref_rmem_f32_10
        %2599 = vector.broadcast %2593 : f32 to vector<32xf32>
        %2600 = arith.mulf %2598, %2599 : vector<32xf32>
        %coord_7618 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %slice_7619 = cute.slice(%view_7487, %coord_7618) : !memref_rmem_f32_4, !cute.coord<"(2,_)">
        %iter_7620 = cute.get_iter(%slice_7619) : !memref_rmem_f32_10
        %lay_7621 = cute.get_layout(%slice_7619) : !memref_rmem_f32_10
        %2601 = cute.get_shape(%lay_7621) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7622, %e1_7623 = cute.get_leaves(%2601) : !cute.shape<"((2,16))">
        %int_tuple_7624 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7625 = cute.size(%int_tuple_7624) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7626 = cute.get_leaves(%sz_7625) : !cute.int_tuple<"32">
        %int_tuple_7627 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7628 = cute.size(%int_tuple_7627) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7629 = cute.get_leaves(%sz_7628) : !cute.int_tuple<"32">
        cute.memref.store_vec %2600, %slice_7619, row_major : !memref_rmem_f32_10
        %coord_7630 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_906, %coord_7630, %2582) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_7631 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_911, %coord_7631, %2596) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_7632 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %slice_7633 = cute.slice(%view_7442, %coord_7632) : !memref_rmem_f32_3, !cute.coord<"(2,_)">
        %iter_7634 = cute.get_iter(%slice_7633) : !memref_rmem_f32_7
        %lay_7635 = cute.get_layout(%slice_7633) : !memref_rmem_f32_7
        %2602 = cute.get_shape(%lay_7635) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7636, %e1_7637 = cute.get_leaves(%2602) : !cute.shape<"((2,8))">
        %int_tuple_7638 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7639 = cute.size(%int_tuple_7638) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7640 = cute.get_leaves(%sz_7639) : !cute.int_tuple<"16">
        %int_tuple_7641 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7642 = cute.size(%int_tuple_7641) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7643 = cute.get_leaves(%sz_7642) : !cute.int_tuple<"16">
        cute.memref.store_vec %2588, %slice_7633, row_major : !memref_rmem_f32_7
        %coord_7644 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %slice_7645 = cute.slice(%view_7442, %coord_7644) : !memref_rmem_f32_3, !cute.coord<"(3,_)">
        %iter_7646 = cute.get_iter(%slice_7645) : !memref_rmem_f32_6
        %lay_7647 = cute.get_layout(%slice_7645) : !memref_rmem_f32_6
        %2603 = cute.get_shape(%lay_7647) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7648, %e1_7649 = cute.get_leaves(%2603) : !cute.shape<"((2,8))">
        %2604 = cute.memref.load_vec %slice_7645, row_major : !memref_rmem_f32_6
        %cst_7650 = arith.constant 0xFF800000 : f32
        %2605 = vector.reduction <maximumf>, %2604, %cst_7650 : vector<16xf32> into f32
        %c-1_i32_7651 = arith.constant -1 : i32
        %c2_i32_7652 = arith.constant 2 : i32
        %c31_i32_7653 = arith.constant 31 : i32
        %2606 = nvvm.shfl.sync  bfly %c-1_i32_7651, %2605, %c2_i32_7652, %c31_i32_7653 : f32 -> f32
        %2607 = nvvm.fmax %2605, %2606
        %c-1_i32_7654 = arith.constant -1 : i32
        %c1_i32_7655 = arith.constant 1 : i32
        %c31_i32_7656 = arith.constant 31 : i32
        %2608 = nvvm.shfl.sync  bfly %c-1_i32_7654, %2607, %c1_i32_7655, %c31_i32_7656 : f32 -> f32
        %2609 = nvvm.fmax %2607, %2608
        %coord_7657 = cute.make_coord() : () -> !cute.coord<"3">
        %2610 = cute.memref.load(%rmem_7490, %coord_7657) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2611 = nvvm.fmax %2610, %2609
        %2612 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2613 = arith.mulf %2604, %2612 : vector<16xf32>
        %2614 = arith.mulf %2611, %arg4 : f32
        %2615 = vector.broadcast %2614 : f32 to vector<16xf32>
        %2616 = arith.subf %2613, %2615 : vector<16xf32>
        %2617 = math.exp2 %2616 fastmath<fast> : vector<16xf32>
        %cst_7658 = arith.constant 0.000000e+00 : f32
        %2618 = vector.reduction <add>, %2617, %cst_7658 : vector<16xf32> into f32
        %2619 = arith.mulf %2610, %arg4 : f32
        %2620 = arith.mulf %2611, %arg4 : f32
        %2621 = arith.subf %2619, %2620 : f32
        %2622 = math.exp2 %2621 fastmath<fast> : f32
        %coord_7659 = cute.make_coord() : () -> !cute.coord<"3">
        %2623 = cute.memref.load(%rmem_911, %coord_7659) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2624 = arith.mulf %2623, %2622 : f32
        %2625 = arith.addf %2624, %2618 : f32
        %coord_7660 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %slice_7661 = cute.slice(%view_7487, %coord_7660) : !memref_rmem_f32_4, !cute.coord<"(3,_)">
        %iter_7662 = cute.get_iter(%slice_7661) : !memref_rmem_f32_9
        %lay_7663 = cute.get_layout(%slice_7661) : !memref_rmem_f32_9
        %2626 = cute.get_shape(%lay_7663) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7664, %e1_7665 = cute.get_leaves(%2626) : !cute.shape<"((2,16))">
        %2627 = cute.memref.load_vec %slice_7661, row_major : !memref_rmem_f32_9
        %2628 = vector.broadcast %2622 : f32 to vector<32xf32>
        %2629 = arith.mulf %2627, %2628 : vector<32xf32>
        %coord_7666 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %slice_7667 = cute.slice(%view_7487, %coord_7666) : !memref_rmem_f32_4, !cute.coord<"(3,_)">
        %iter_7668 = cute.get_iter(%slice_7667) : !memref_rmem_f32_9
        %lay_7669 = cute.get_layout(%slice_7667) : !memref_rmem_f32_9
        %2630 = cute.get_shape(%lay_7669) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_7670, %e1_7671 = cute.get_leaves(%2630) : !cute.shape<"((2,16))">
        %int_tuple_7672 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7673 = cute.size(%int_tuple_7672) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7674 = cute.get_leaves(%sz_7673) : !cute.int_tuple<"32">
        %int_tuple_7675 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_7676 = cute.size(%int_tuple_7675) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_7677 = cute.get_leaves(%sz_7676) : !cute.int_tuple<"32">
        cute.memref.store_vec %2629, %slice_7667, row_major : !memref_rmem_f32_9
        %coord_7678 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_906, %coord_7678, %2611) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_7679 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_911, %coord_7679, %2625) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_7680 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %slice_7681 = cute.slice(%view_7442, %coord_7680) : !memref_rmem_f32_3, !cute.coord<"(3,_)">
        %iter_7682 = cute.get_iter(%slice_7681) : !memref_rmem_f32_6
        %lay_7683 = cute.get_layout(%slice_7681) : !memref_rmem_f32_6
        %2631 = cute.get_shape(%lay_7683) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_7684, %e1_7685 = cute.get_leaves(%2631) : !cute.shape<"((2,8))">
        %int_tuple_7686 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7687 = cute.size(%int_tuple_7686) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7688 = cute.get_leaves(%sz_7687) : !cute.int_tuple<"16">
        %int_tuple_7689 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_7690 = cute.size(%int_tuple_7689) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_7691 = cute.get_leaves(%sz_7690) : !cute.int_tuple<"16">
        cute.memref.store_vec %2617, %slice_7681, row_major : !memref_rmem_f32_6
        %lay_7692 = cute.get_layout(%rmem_6283) : !memref_rmem_f32_2
        %2632 = cute.make_layout_like(%lay_7692) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_7693 = cute.memref.alloca(%2632) : !memref_rmem_bf16_12
        %iter_7694 = cute.get_iter(%rmem_7693) : !memref_rmem_bf16_12
        %iter_7695 = cute.get_iter(%rmem_7693) : !memref_rmem_bf16_12
        %2633 = cute.memref.load_vec %rmem_6283, row_major : !memref_rmem_f32_2
        %2634 = arith.truncf %2633 : vector<64xf32> to vector<64xbf16>
        %lay_7696 = cute.get_layout(%rmem_7693) : !memref_rmem_bf16_12
        %2635 = cute.get_shape(%lay_7696) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7697, %e1_7698, %e2_7699, %e3_7700 = cute.get_leaves(%2635) : !cute.shape<"((2,2),2,8)">
        %int_tuple_7701 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7702 = cute.size(%int_tuple_7701) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7703 = cute.get_leaves(%sz_7702) : !cute.int_tuple<"64">
        %int_tuple_7704 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7705 = cute.size(%int_tuple_7704) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7706 = cute.get_leaves(%sz_7705) : !cute.int_tuple<"64">
        cute.memref.store_vec %2634, %rmem_7693, row_major : !memref_rmem_bf16_12
        %lay_7707 = cute.get_layout(%rmem_7693) : !memref_rmem_bf16_12
        %tile_7708 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %div_7709 = cute.logical_divide(%lay_7707, %tile_7708) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.tile<"[_;_;2:1]">
        %2636 = cute.get_shape(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_7710, %e1_7711, %e2_7712, %e3_7713, %e4_7714 = cute.get_leaves(%2636) : !cute.shape<"((2,2),2,(2,4))">
        %2637 = cute.get_shape(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_7715, %e1_7716, %e2_7717, %e3_7718, %e4_7719 = cute.get_leaves(%2637) : !cute.shape<"((2,2),2,(2,4))">
        %2638 = cute.get_shape(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_7720, %e1_7721, %e2_7722, %e3_7723, %e4_7724 = cute.get_leaves(%2638) : !cute.shape<"((2,2),2,(2,4))">
        %2639 = cute.get_shape(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728, %e4_7729 = cute.get_leaves(%2639) : !cute.shape<"((2,2),2,(2,4))">
        %2640 = cute.get_stride(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_7730, %e1_7731, %e2_7732, %e3_7733, %e4_7734 = cute.get_leaves(%2640) : !cute.stride<"((1,2),4,(8,16))">
        %2641 = cute.get_stride(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_7735, %e1_7736, %e2_7737, %e3_7738, %e4_7739 = cute.get_leaves(%2641) : !cute.stride<"((1,2),4,(8,16))">
        %2642 = cute.get_stride(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_7740, %e1_7741, %e2_7742, %e3_7743, %e4_7744 = cute.get_leaves(%2642) : !cute.stride<"((1,2),4,(8,16))">
        %2643 = cute.get_stride(%div_7709) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_7745, %e1_7746, %e2_7747, %e3_7748, %e4_7749 = cute.get_leaves(%2643) : !cute.stride<"((1,2),4,(8,16))">
        %shape_7750 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
        %stride_7751 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
        %lay_7752 = cute.make_layout(%shape_7750, %stride_7751) : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
        %view_7753 = cute.make_view(%iter_7695, %lay_7752) : !memref_rmem_bf16_13
        %iter_7754 = cute.get_iter(%view_7753) : !memref_rmem_bf16_13
        %coord_7755 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7756 = cute.slice(%src_partitioned_326, %coord_7755) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)">
        %iter_7757 = cute.get_iter(%slice_7756) : !memref_smem_bf16_18
        %coord_7758 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7759 = cute.slice(%retiled_328, %coord_7758) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)">
        %iter_7760 = cute.get_iter(%slice_7759) : !memref_rmem_bf16_14
        %lay_7761 = cute.get_layout(%slice_7756) : !memref_smem_bf16_18
        %2644 = cute.get_shape(%lay_7761) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7762, %e1_7763, %e2_7764, %e3_7765, %e4_7766 = cute.get_leaves(%2644) : !cute.shape<"((8,1),((2,2),2))">
        %lay_7767 = cute.get_layout(%slice_7759) : !memref_rmem_bf16_14
        %2645 = cute.get_shape(%lay_7767) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7768, %e1_7769, %e2_7770, %e3_7771 = cute.get_leaves(%2645) : !cute.shape<"((8,1),(4,2))">
        %lay_7772 = cute.get_layout(%slice_7756) : !memref_smem_bf16_18
        %shape_7773 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7774 = cute.make_layout(%shape_7773) : !cute.layout<"1:0">
        %append_7775 = cute.append_to_rank<2> (%lay_7772, %lay_7774) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_7776 = cute.make_view(%iter_7757, %append_7775) : !memref_smem_bf16_18
        %iter_7777 = cute.get_iter(%view_7776) : !memref_smem_bf16_18
        %lay_7778 = cute.get_layout(%view_7776) : !memref_smem_bf16_18
        %2646 = cute.get_shape(%lay_7778) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7779, %e1_7780, %e2_7781, %e3_7782, %e4_7783 = cute.get_leaves(%2646) : !cute.shape<"((8,1),((2,2),2))">
        %grouped_7784 = cute.group_modes(%view_7776) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
        %iter_7785 = cute.get_iter(%grouped_7784) : !memref_smem_bf16_19
        %iter_7786 = cute.get_iter(%grouped_7784) : !memref_smem_bf16_19
        %lay_7787 = cute.get_layout(%slice_7759) : !memref_rmem_bf16_14
        %shape_7788 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7789 = cute.make_layout(%shape_7788) : !cute.layout<"1:0">
        %append_7790 = cute.append_to_rank<2> (%lay_7787, %lay_7789) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_7791 = cute.make_view(%iter_7760, %append_7790) : !memref_rmem_bf16_14
        %iter_7792 = cute.get_iter(%view_7791) : !memref_rmem_bf16_14
        %lay_7793 = cute.get_layout(%view_7791) : !memref_rmem_bf16_14
        %2647 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7794, %e1_7795, %e2_7796, %e3_7797 = cute.get_leaves(%2647) : !cute.shape<"((8,1),(4,2))">
        %grouped_7798 = cute.group_modes(%view_7791) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
        %iter_7799 = cute.get_iter(%grouped_7798) : !memref_rmem_bf16_15
        %iter_7800 = cute.get_iter(%grouped_7798) : !memref_rmem_bf16_15
        %lay_7801 = cute.get_layout(%grouped_7784) : !memref_smem_bf16_19
        %2648 = cute.get_shape(%lay_7801) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_7802, %e1_7803, %e2_7804, %e3_7805, %e4_7806 = cute.get_leaves(%2648) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_7807 = cute.get_layout(%grouped_7798) : !memref_rmem_bf16_15
        %2649 = cute.get_shape(%lay_7807) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_7808, %e1_7809, %e2_7810, %e3_7811 = cute.get_leaves(%2649) : !cute.shape<"((8,1),((4,2)))">
        %sz_7812 = cute.size(%grouped_7784) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
        %e0_7813 = cute.get_leaves(%sz_7812) : !cute.int_tuple<"8">
        %sz_7814 = cute.size(%grouped_7798) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
        %e0_7815 = cute.get_leaves(%sz_7814) : !cute.int_tuple<"8">
        cute.copy(%144, %grouped_7784, %grouped_7798) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
        %lay_7816 = cute.get_layout(%view_7753) : !memref_rmem_bf16_13
        %2650 = cute.get_shape(%lay_7816) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
        %e0_7817, %e1_7818, %e2_7819, %e3_7820, %e4_7821 = cute.get_leaves(%2650) : !cute.shape<"(((2,2),2),2,4)">
        %int_tuple_7822 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7823 = cute.size(%int_tuple_7822) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7824 = cute.get_leaves(%sz_7823) : !cute.int_tuple<"4">
        %int_tuple_7825 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7826 = cute.size(%int_tuple_7825) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7827 = cute.get_leaves(%sz_7826) : !cute.int_tuple<"4">
        %coord_7828 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_7829 = cute.slice(%src_partitioned_326, %coord_7828) : !memref_smem_bf16_10, !cute.coord<"(_,_,1)">
        %iter_7830 = cute.get_iter(%slice_7829) : !memref_smem_bf16_18
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_7832 = cute.slice(%retiled_328, %coord_7831) : !memref_rmem_bf16_5, !cute.coord<"(_,_,1)">
        %iter_7833 = cute.get_iter(%slice_7832) : !memref_rmem_bf16_14
        %lay_7834 = cute.get_layout(%slice_7829) : !memref_smem_bf16_18
        %2651 = cute.get_shape(%lay_7834) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838, %e4_7839 = cute.get_leaves(%2651) : !cute.shape<"((8,1),((2,2),2))">
        %lay_7840 = cute.get_layout(%slice_7832) : !memref_rmem_bf16_14
        %2652 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7841, %e1_7842, %e2_7843, %e3_7844 = cute.get_leaves(%2652) : !cute.shape<"((8,1),(4,2))">
        %lay_7845 = cute.get_layout(%slice_7829) : !memref_smem_bf16_18
        %shape_7846 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7847 = cute.make_layout(%shape_7846) : !cute.layout<"1:0">
        %append_7848 = cute.append_to_rank<2> (%lay_7845, %lay_7847) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_7849 = cute.make_view(%iter_7830, %append_7848) : !memref_smem_bf16_18
        %iter_7850 = cute.get_iter(%view_7849) : !memref_smem_bf16_18
        %lay_7851 = cute.get_layout(%view_7849) : !memref_smem_bf16_18
        %2653 = cute.get_shape(%lay_7851) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7852, %e1_7853, %e2_7854, %e3_7855, %e4_7856 = cute.get_leaves(%2653) : !cute.shape<"((8,1),((2,2),2))">
        %grouped_7857 = cute.group_modes(%view_7849) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
        %iter_7858 = cute.get_iter(%grouped_7857) : !memref_smem_bf16_19
        %iter_7859 = cute.get_iter(%grouped_7857) : !memref_smem_bf16_19
        %lay_7860 = cute.get_layout(%slice_7832) : !memref_rmem_bf16_14
        %shape_7861 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7862 = cute.make_layout(%shape_7861) : !cute.layout<"1:0">
        %append_7863 = cute.append_to_rank<2> (%lay_7860, %lay_7862) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_7864 = cute.make_view(%iter_7833, %append_7863) : !memref_rmem_bf16_14
        %iter_7865 = cute.get_iter(%view_7864) : !memref_rmem_bf16_14
        %lay_7866 = cute.get_layout(%view_7864) : !memref_rmem_bf16_14
        %2654 = cute.get_shape(%lay_7866) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7867, %e1_7868, %e2_7869, %e3_7870 = cute.get_leaves(%2654) : !cute.shape<"((8,1),(4,2))">
        %grouped_7871 = cute.group_modes(%view_7864) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
        %iter_7872 = cute.get_iter(%grouped_7871) : !memref_rmem_bf16_15
        %iter_7873 = cute.get_iter(%grouped_7871) : !memref_rmem_bf16_15
        %lay_7874 = cute.get_layout(%grouped_7857) : !memref_smem_bf16_19
        %2655 = cute.get_shape(%lay_7874) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_7875, %e1_7876, %e2_7877, %e3_7878, %e4_7879 = cute.get_leaves(%2655) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_7880 = cute.get_layout(%grouped_7871) : !memref_rmem_bf16_15
        %2656 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_7881, %e1_7882, %e2_7883, %e3_7884 = cute.get_leaves(%2656) : !cute.shape<"((8,1),((4,2)))">
        %sz_7885 = cute.size(%grouped_7857) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
        %e0_7886 = cute.get_leaves(%sz_7885) : !cute.int_tuple<"8">
        %sz_7887 = cute.size(%grouped_7871) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
        %e0_7888 = cute.get_leaves(%sz_7887) : !cute.int_tuple<"8">
        cute.copy(%144, %grouped_7857, %grouped_7871) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
        %coord_7889 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7890 = cute.slice(%view_7753, %coord_7889) : !memref_rmem_bf16_13, !cute.coord<"(_,_,0)">
        %iter_7891 = cute.get_iter(%slice_7890) : !memref_rmem_bf16_16
        %coord_7892 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_7893 = cute.slice(%frg_B_253, %coord_7892) : !memref_rmem_bf16_2, !cute.coord<"(_,_,0)">
        %iter_7894 = cute.get_iter(%slice_7893) : !memref_rmem_bf16_17
        %lay_7895 = cute.get_layout(%slice_7890) : !memref_rmem_bf16_16
        %2657 = cute.get_shape(%lay_7895) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_7896, %e1_7897, %e2_7898, %e3_7899 = cute.get_leaves(%2657) : !cute.shape<"(((2,2),2),2)">
        %lay_7900 = cute.get_layout(%slice_7893) : !memref_rmem_bf16_17
        %2658 = cute.get_shape(%lay_7900) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_7901, %e1_7902, %e2_7903, %e3_7904 = cute.get_leaves(%2658) : !cute.shape<"((2,2),(8,2))">
        %lay_7905 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2659 = cute.get_shape(%lay_7905) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_7906, %e1_7907, %e2_7908, %e3_7909 = cute.get_leaves(%2659) : !cute.shape<"((2,2),2,16)">
        cute.gemm(%5, %rmem, %slice_7890, %slice_7893, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
        %int_tuple_7910 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7911 = cute.size(%int_tuple_7910) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"4">
        %coord_7913 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_7914 = cute.slice(%src_partitioned_326, %coord_7913) : !memref_smem_bf16_10, !cute.coord<"(_,_,2)">
        %iter_7915 = cute.get_iter(%slice_7914) : !memref_smem_bf16_18
        %coord_7916 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_7917 = cute.slice(%retiled_328, %coord_7916) : !memref_rmem_bf16_5, !cute.coord<"(_,_,2)">
        %iter_7918 = cute.get_iter(%slice_7917) : !memref_rmem_bf16_14
        %lay_7919 = cute.get_layout(%slice_7914) : !memref_smem_bf16_18
        %2660 = cute.get_shape(%lay_7919) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7920, %e1_7921, %e2_7922, %e3_7923, %e4_7924 = cute.get_leaves(%2660) : !cute.shape<"((8,1),((2,2),2))">
        %lay_7925 = cute.get_layout(%slice_7917) : !memref_rmem_bf16_14
        %2661 = cute.get_shape(%lay_7925) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7926, %e1_7927, %e2_7928, %e3_7929 = cute.get_leaves(%2661) : !cute.shape<"((8,1),(4,2))">
        %lay_7930 = cute.get_layout(%slice_7914) : !memref_smem_bf16_18
        %shape_7931 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7932 = cute.make_layout(%shape_7931) : !cute.layout<"1:0">
        %append_7933 = cute.append_to_rank<2> (%lay_7930, %lay_7932) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_7934 = cute.make_view(%iter_7915, %append_7933) : !memref_smem_bf16_18
        %iter_7935 = cute.get_iter(%view_7934) : !memref_smem_bf16_18
        %lay_7936 = cute.get_layout(%view_7934) : !memref_smem_bf16_18
        %2662 = cute.get_shape(%lay_7936) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_7937, %e1_7938, %e2_7939, %e3_7940, %e4_7941 = cute.get_leaves(%2662) : !cute.shape<"((8,1),((2,2),2))">
        %grouped_7942 = cute.group_modes(%view_7934) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
        %iter_7943 = cute.get_iter(%grouped_7942) : !memref_smem_bf16_19
        %iter_7944 = cute.get_iter(%grouped_7942) : !memref_smem_bf16_19
        %lay_7945 = cute.get_layout(%slice_7917) : !memref_rmem_bf16_14
        %shape_7946 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7947 = cute.make_layout(%shape_7946) : !cute.layout<"1:0">
        %append_7948 = cute.append_to_rank<2> (%lay_7945, %lay_7947) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_7949 = cute.make_view(%iter_7918, %append_7948) : !memref_rmem_bf16_14
        %iter_7950 = cute.get_iter(%view_7949) : !memref_rmem_bf16_14
        %lay_7951 = cute.get_layout(%view_7949) : !memref_rmem_bf16_14
        %2663 = cute.get_shape(%lay_7951) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7952, %e1_7953, %e2_7954, %e3_7955 = cute.get_leaves(%2663) : !cute.shape<"((8,1),(4,2))">
        %grouped_7956 = cute.group_modes(%view_7949) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
        %iter_7957 = cute.get_iter(%grouped_7956) : !memref_rmem_bf16_15
        %iter_7958 = cute.get_iter(%grouped_7956) : !memref_rmem_bf16_15
        %lay_7959 = cute.get_layout(%grouped_7942) : !memref_smem_bf16_19
        %2664 = cute.get_shape(%lay_7959) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_7960, %e1_7961, %e2_7962, %e3_7963, %e4_7964 = cute.get_leaves(%2664) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_7965 = cute.get_layout(%grouped_7956) : !memref_rmem_bf16_15
        %2665 = cute.get_shape(%lay_7965) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_7966, %e1_7967, %e2_7968, %e3_7969 = cute.get_leaves(%2665) : !cute.shape<"((8,1),((4,2)))">
        %sz_7970 = cute.size(%grouped_7942) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
        %e0_7971 = cute.get_leaves(%sz_7970) : !cute.int_tuple<"8">
        %sz_7972 = cute.size(%grouped_7956) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
        %e0_7973 = cute.get_leaves(%sz_7972) : !cute.int_tuple<"8">
        cute.copy(%144, %grouped_7942, %grouped_7956) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
        %coord_7974 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_7975 = cute.slice(%view_7753, %coord_7974) : !memref_rmem_bf16_13, !cute.coord<"(_,_,1)">
        %iter_7976 = cute.get_iter(%slice_7975) : !memref_rmem_bf16_16
        %coord_7977 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %slice_7978 = cute.slice(%frg_B_253, %coord_7977) : !memref_rmem_bf16_2, !cute.coord<"(_,_,1)">
        %iter_7979 = cute.get_iter(%slice_7978) : !memref_rmem_bf16_17
        %lay_7980 = cute.get_layout(%slice_7975) : !memref_rmem_bf16_16
        %2666 = cute.get_shape(%lay_7980) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_7981, %e1_7982, %e2_7983, %e3_7984 = cute.get_leaves(%2666) : !cute.shape<"(((2,2),2),2)">
        %lay_7985 = cute.get_layout(%slice_7978) : !memref_rmem_bf16_17
        %2667 = cute.get_shape(%lay_7985) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_7986, %e1_7987, %e2_7988, %e3_7989 = cute.get_leaves(%2667) : !cute.shape<"((2,2),(8,2))">
        cute.gemm(%5, %rmem, %slice_7975, %slice_7978, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
        %int_tuple_7990 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7991 = cute.size(%int_tuple_7990) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7992 = cute.get_leaves(%sz_7991) : !cute.int_tuple<"4">
        %coord_7993 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_7994 = cute.slice(%src_partitioned_326, %coord_7993) : !memref_smem_bf16_10, !cute.coord<"(_,_,3)">
        %iter_7995 = cute.get_iter(%slice_7994) : !memref_smem_bf16_18
        %coord_7996 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_7997 = cute.slice(%retiled_328, %coord_7996) : !memref_rmem_bf16_5, !cute.coord<"(_,_,3)">
        %iter_7998 = cute.get_iter(%slice_7997) : !memref_rmem_bf16_14
        %lay_7999 = cute.get_layout(%slice_7994) : !memref_smem_bf16_18
        %2668 = cute.get_shape(%lay_7999) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_8000, %e1_8001, %e2_8002, %e3_8003, %e4_8004 = cute.get_leaves(%2668) : !cute.shape<"((8,1),((2,2),2))">
        %lay_8005 = cute.get_layout(%slice_7997) : !memref_rmem_bf16_14
        %2669 = cute.get_shape(%lay_8005) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8006, %e1_8007, %e2_8008, %e3_8009 = cute.get_leaves(%2669) : !cute.shape<"((8,1),(4,2))">
        %lay_8010 = cute.get_layout(%slice_7994) : !memref_smem_bf16_18
        %shape_8011 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8012 = cute.make_layout(%shape_8011) : !cute.layout<"1:0">
        %append_8013 = cute.append_to_rank<2> (%lay_8010, %lay_8012) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_8014 = cute.make_view(%iter_7995, %append_8013) : !memref_smem_bf16_18
        %iter_8015 = cute.get_iter(%view_8014) : !memref_smem_bf16_18
        %lay_8016 = cute.get_layout(%view_8014) : !memref_smem_bf16_18
        %2670 = cute.get_shape(%lay_8016) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_8017, %e1_8018, %e2_8019, %e3_8020, %e4_8021 = cute.get_leaves(%2670) : !cute.shape<"((8,1),((2,2),2))">
        %grouped_8022 = cute.group_modes(%view_8014) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
        %iter_8023 = cute.get_iter(%grouped_8022) : !memref_smem_bf16_19
        %iter_8024 = cute.get_iter(%grouped_8022) : !memref_smem_bf16_19
        %lay_8025 = cute.get_layout(%slice_7997) : !memref_rmem_bf16_14
        %shape_8026 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8027 = cute.make_layout(%shape_8026) : !cute.layout<"1:0">
        %append_8028 = cute.append_to_rank<2> (%lay_8025, %lay_8027) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_8029 = cute.make_view(%iter_7998, %append_8028) : !memref_rmem_bf16_14
        %iter_8030 = cute.get_iter(%view_8029) : !memref_rmem_bf16_14
        %lay_8031 = cute.get_layout(%view_8029) : !memref_rmem_bf16_14
        %2671 = cute.get_shape(%lay_8031) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8032, %e1_8033, %e2_8034, %e3_8035 = cute.get_leaves(%2671) : !cute.shape<"((8,1),(4,2))">
        %grouped_8036 = cute.group_modes(%view_8029) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
        %iter_8037 = cute.get_iter(%grouped_8036) : !memref_rmem_bf16_15
        %iter_8038 = cute.get_iter(%grouped_8036) : !memref_rmem_bf16_15
        %lay_8039 = cute.get_layout(%grouped_8022) : !memref_smem_bf16_19
        %2672 = cute.get_shape(%lay_8039) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_8040, %e1_8041, %e2_8042, %e3_8043, %e4_8044 = cute.get_leaves(%2672) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_8045 = cute.get_layout(%grouped_8036) : !memref_rmem_bf16_15
        %2673 = cute.get_shape(%lay_8045) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_8046, %e1_8047, %e2_8048, %e3_8049 = cute.get_leaves(%2673) : !cute.shape<"((8,1),((4,2)))">
        %sz_8050 = cute.size(%grouped_8022) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
        %e0_8051 = cute.get_leaves(%sz_8050) : !cute.int_tuple<"8">
        %sz_8052 = cute.size(%grouped_8036) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
        %e0_8053 = cute.get_leaves(%sz_8052) : !cute.int_tuple<"8">
        cute.copy(%144, %grouped_8022, %grouped_8036) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
        %coord_8054 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_8055 = cute.slice(%view_7753, %coord_8054) : !memref_rmem_bf16_13, !cute.coord<"(_,_,2)">
        %iter_8056 = cute.get_iter(%slice_8055) : !memref_rmem_bf16_16
        %coord_8057 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %slice_8058 = cute.slice(%frg_B_253, %coord_8057) : !memref_rmem_bf16_2, !cute.coord<"(_,_,2)">
        %iter_8059 = cute.get_iter(%slice_8058) : !memref_rmem_bf16_17
        %lay_8060 = cute.get_layout(%slice_8055) : !memref_rmem_bf16_16
        %2674 = cute.get_shape(%lay_8060) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_8061, %e1_8062, %e2_8063, %e3_8064 = cute.get_leaves(%2674) : !cute.shape<"(((2,2),2),2)">
        %lay_8065 = cute.get_layout(%slice_8058) : !memref_rmem_bf16_17
        %2675 = cute.get_shape(%lay_8065) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_8066, %e1_8067, %e2_8068, %e3_8069 = cute.get_leaves(%2675) : !cute.shape<"((2,2),(8,2))">
        cute.gemm(%5, %rmem, %slice_8055, %slice_8058, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
        %int_tuple_8070 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_8071 = cute.size(%int_tuple_8070) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_8072 = cute.get_leaves(%sz_8071) : !cute.int_tuple<"4">
        %coord_8073 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_8074 = cute.slice(%src_partitioned_326, %coord_8073) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)">
        %iter_8075 = cute.get_iter(%slice_8074) : !memref_smem_bf16_18
        %coord_8076 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %slice_8077 = cute.slice(%retiled_328, %coord_8076) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)">
        %iter_8078 = cute.get_iter(%slice_8077) : !memref_rmem_bf16_14
        %lay_8079 = cute.get_layout(%slice_8074) : !memref_smem_bf16_18
        %2676 = cute.get_shape(%lay_8079) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_8080, %e1_8081, %e2_8082, %e3_8083, %e4_8084 = cute.get_leaves(%2676) : !cute.shape<"((8,1),((2,2),2))">
        %lay_8085 = cute.get_layout(%slice_8077) : !memref_rmem_bf16_14
        %2677 = cute.get_shape(%lay_8085) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8086, %e1_8087, %e2_8088, %e3_8089 = cute.get_leaves(%2677) : !cute.shape<"((8,1),(4,2))">
        %lay_8090 = cute.get_layout(%slice_8074) : !memref_smem_bf16_18
        %shape_8091 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8092 = cute.make_layout(%shape_8091) : !cute.layout<"1:0">
        %append_8093 = cute.append_to_rank<2> (%lay_8090, %lay_8092) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_8094 = cute.make_view(%iter_8075, %append_8093) : !memref_smem_bf16_18
        %iter_8095 = cute.get_iter(%view_8094) : !memref_smem_bf16_18
        %lay_8096 = cute.get_layout(%view_8094) : !memref_smem_bf16_18
        %2678 = cute.get_shape(%lay_8096) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_8097, %e1_8098, %e2_8099, %e3_8100, %e4_8101 = cute.get_leaves(%2678) : !cute.shape<"((8,1),((2,2),2))">
        %grouped_8102 = cute.group_modes(%view_8094) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19
        %iter_8103 = cute.get_iter(%grouped_8102) : !memref_smem_bf16_19
        %iter_8104 = cute.get_iter(%grouped_8102) : !memref_smem_bf16_19
        %lay_8105 = cute.get_layout(%slice_8077) : !memref_rmem_bf16_14
        %shape_8106 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8107 = cute.make_layout(%shape_8106) : !cute.layout<"1:0">
        %append_8108 = cute.append_to_rank<2> (%lay_8105, %lay_8107) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_8109 = cute.make_view(%iter_8078, %append_8108) : !memref_rmem_bf16_14
        %iter_8110 = cute.get_iter(%view_8109) : !memref_rmem_bf16_14
        %lay_8111 = cute.get_layout(%view_8109) : !memref_rmem_bf16_14
        %2679 = cute.get_shape(%lay_8111) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8112, %e1_8113, %e2_8114, %e3_8115 = cute.get_leaves(%2679) : !cute.shape<"((8,1),(4,2))">
        %grouped_8116 = cute.group_modes(%view_8109) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15
        %iter_8117 = cute.get_iter(%grouped_8116) : !memref_rmem_bf16_15
        %iter_8118 = cute.get_iter(%grouped_8116) : !memref_rmem_bf16_15
        %lay_8119 = cute.get_layout(%grouped_8102) : !memref_smem_bf16_19
        %2680 = cute.get_shape(%lay_8119) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_8120, %e1_8121, %e2_8122, %e3_8123, %e4_8124 = cute.get_leaves(%2680) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_8125 = cute.get_layout(%grouped_8116) : !memref_rmem_bf16_15
        %2681 = cute.get_shape(%lay_8125) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_8126, %e1_8127, %e2_8128, %e3_8129 = cute.get_leaves(%2681) : !cute.shape<"((8,1),((4,2)))">
        %sz_8130 = cute.size(%grouped_8102) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8">
        %e0_8131 = cute.get_leaves(%sz_8130) : !cute.int_tuple<"8">
        %sz_8132 = cute.size(%grouped_8116) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8">
        %e0_8133 = cute.get_leaves(%sz_8132) : !cute.int_tuple<"8">
        cute.copy(%144, %grouped_8102, %grouped_8116) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15)
        %coord_8134 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_8135 = cute.slice(%view_7753, %coord_8134) : !memref_rmem_bf16_13, !cute.coord<"(_,_,3)">
        %iter_8136 = cute.get_iter(%slice_8135) : !memref_rmem_bf16_16
        %coord_8137 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %slice_8138 = cute.slice(%frg_B_253, %coord_8137) : !memref_rmem_bf16_2, !cute.coord<"(_,_,3)">
        %iter_8139 = cute.get_iter(%slice_8138) : !memref_rmem_bf16_17
        %lay_8140 = cute.get_layout(%slice_8135) : !memref_rmem_bf16_16
        %2682 = cute.get_shape(%lay_8140) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_8141, %e1_8142, %e2_8143, %e3_8144 = cute.get_leaves(%2682) : !cute.shape<"(((2,2),2),2)">
        %lay_8145 = cute.get_layout(%slice_8138) : !memref_rmem_bf16_17
        %2683 = cute.get_shape(%lay_8145) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_8146, %e1_8147, %e2_8148, %e3_8149 = cute.get_leaves(%2683) : !cute.shape<"((2,2),(8,2))">
        cute.gemm(%5, %rmem, %slice_8135, %slice_8138, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_)
        scf.yield %2363, %arg7, %2363, %arg9, %arg10, %arg11, %arg12 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32
      }
      %iter_5511 = cute.get_iter(%1990#3) : !memref_gmem_bf16_
      %lay_5512 = cute.get_layout(%1990#3) : !memref_gmem_bf16_
      %1991 = cute.get_shape(%lay_5512) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_5513, %e1_5514, %e2_5515, %e3_5516 = cute.get_leaves(%1991) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_5517 = cute.to_int_tuple(%e0_5513) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1992 = cute.get_scalars(%itup_5517) : !cute.int_tuple<"?">
      %itup_5518 = cute.to_int_tuple(%e1_5514) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1993 = cute.get_scalars(%itup_5518) : !cute.int_tuple<"?">
      %itup_5519 = cute.to_int_tuple(%e2_5515) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1994 = cute.get_scalars(%itup_5519) : !cute.int_tuple<"?">
      %itup_5520 = cute.to_int_tuple(%e3_5516) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1995 = cute.get_scalars(%itup_5520) : !cute.int_tuple<"?{div=8}">
      %1996 = cute.get_stride(%lay_5512) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_5521, %e1_5522, %e2_5523, %e3_5524 = cute.get_leaves(%1996) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_5525 = cute.to_int_tuple(%e0_5521) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %1997 = cute.get_scalars(%itup_5525) : !cute.int_tuple<"?{i64 div=8}">
      %itup_5526 = cute.to_int_tuple(%e1_5522) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %1998 = cute.get_scalars(%itup_5526) : !cute.int_tuple<"?{i64 div=8}">
      %itup_5527 = cute.to_int_tuple(%e2_5523) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %1999 = cute.get_scalars(%itup_5527) : !cute.int_tuple<"?{i64 div=8}">
      %iter_5528 = cute.get_iter(%1990#4) : !memref_gmem_bf16_
      %lay_5529 = cute.get_layout(%1990#4) : !memref_gmem_bf16_
      %2000 = cute.get_shape(%lay_5529) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_5530, %e1_5531, %e2_5532, %e3_5533 = cute.get_leaves(%2000) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_5534 = cute.to_int_tuple(%e0_5530) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2001 = cute.get_scalars(%itup_5534) : !cute.int_tuple<"?">
      %itup_5535 = cute.to_int_tuple(%e1_5531) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2002 = cute.get_scalars(%itup_5535) : !cute.int_tuple<"?">
      %itup_5536 = cute.to_int_tuple(%e2_5532) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2003 = cute.get_scalars(%itup_5536) : !cute.int_tuple<"?">
      %itup_5537 = cute.to_int_tuple(%e3_5533) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2004 = cute.get_scalars(%itup_5537) : !cute.int_tuple<"?{div=8}">
      %2005 = cute.get_stride(%lay_5529) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_5538, %e1_5539, %e2_5540, %e3_5541 = cute.get_leaves(%2005) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_5542 = cute.to_int_tuple(%e0_5538) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2006 = cute.get_scalars(%itup_5542) : !cute.int_tuple<"?{i64 div=8}">
      %itup_5543 = cute.to_int_tuple(%e1_5539) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2007 = cute.get_scalars(%itup_5543) : !cute.int_tuple<"?{i64 div=8}">
      %itup_5544 = cute.to_int_tuple(%e2_5540) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2008 = cute.get_scalars(%itup_5544) : !cute.int_tuple<"?{i64 div=8}">
      %iter_5545 = cute.get_iter(%1990#3) : !memref_gmem_bf16_
      %iter_5546 = cute.get_iter(%1990#3) : !memref_gmem_bf16_
      %iter_5547 = cute.get_iter(%1990#4) : !memref_gmem_bf16_
      %iter_5548 = cute.get_iter(%1990#4) : !memref_gmem_bf16_
      %lay_5549 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2009 = cute.get_shape(%lay_5549) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5550, %e1_5551, %e2_5552, %e3_5553 = cute.get_leaves(%2009) : !cute.shape<"((2,2),2,16)">
      %shape_5554 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_5555 = cute.make_layout(%shape_5554) : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %2010 = cute.get_shape(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5556, %e1_5557, %e2_5558, %e3_5559 = cute.get_leaves(%2010) : !cute.shape<"((2,2),2,16)">
      %2011 = cute.get_shape(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5560, %e1_5561, %e2_5562, %e3_5563 = cute.get_leaves(%2011) : !cute.shape<"((2,2),2,16)">
      %2012 = cute.get_shape(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5564, %e1_5565, %e2_5566, %e3_5567 = cute.get_leaves(%2012) : !cute.shape<"((2,2),2,16)">
      %2013 = cute.get_shape(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5568, %e1_5569, %e2_5570, %e3_5571 = cute.get_leaves(%2013) : !cute.shape<"((2,2),2,16)">
      %2014 = cute.get_stride(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_5572, %e1_5573, %e2_5574, %e3_5575 = cute.get_leaves(%2014) : !cute.stride<"((1,2),4,8)">
      %2015 = cute.get_stride(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_5576, %e1_5577, %e2_5578, %e3_5579 = cute.get_leaves(%2015) : !cute.stride<"((1,2),4,8)">
      %2016 = cute.get_stride(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_5580, %e1_5581, %e2_5582, %e3_5583 = cute.get_leaves(%2016) : !cute.stride<"((1,2),4,8)">
      %2017 = cute.get_stride(%lay_5555) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_5584, %e1_5585, %e2_5586, %e3_5587 = cute.get_leaves(%2017) : !cute.stride<"((1,2),4,8)">
      %shape_5588 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_5589 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_5590 = cute.make_layout(%shape_5588, %stride_5589) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_5591 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2018 = cute.composition(%lay_5591, %lay_5590) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_5592 = cute.make_view(%iter_263, %2018) : !memref_rmem_f32_4
      %iter_5593 = cute.get_iter(%view_5592) : !memref_rmem_f32_4
      %sz_5594 = cute.size(%rmem_911) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4">
      %e0_5595 = cute.get_leaves(%sz_5594) : !cute.int_tuple<"4">
      %coord_5596 = cute.make_coord() : () -> !cute.coord<"0">
      %2019 = cute.memref.load(%rmem_911, %coord_5596) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %c-1_i32_5597 = arith.constant -1 : i32
      %c2_i32_5598 = arith.constant 2 : i32
      %c31_i32_5599 = arith.constant 31 : i32
      %2020 = nvvm.shfl.sync  bfly %c-1_i32_5597, %2019, %c2_i32_5598, %c31_i32_5599 : f32 -> f32
      %2021 = arith.addf %2019, %2020 : f32
      %c-1_i32_5600 = arith.constant -1 : i32
      %c1_i32_5601 = arith.constant 1 : i32
      %c31_i32_5602 = arith.constant 31 : i32
      %2022 = nvvm.shfl.sync  bfly %c-1_i32_5600, %2021, %c1_i32_5601, %c31_i32_5602 : f32 -> f32
      %2023 = arith.addf %2021, %2022 : f32
      %coord_5603 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_911, %coord_5603, %2023) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_5604 = cute.make_coord() : () -> !cute.coord<"0">
      %2024 = cute.memref.load(%rmem_911, %coord_5604) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %cst_5605 = arith.constant 0.000000e+00 : f32
      %2025 = arith.cmpf oeq, %2024, %cst_5605 : f32
      %coord_5606 = cute.make_coord() : () -> !cute.coord<"0">
      %2026 = cute.memref.load(%rmem_911, %coord_5606) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2027 = arith.cmpf oeq, %2026, %cst_5605 : f32
      %coord_5607 = cute.make_coord() : () -> !cute.coord<"0">
      %2028 = cute.memref.load(%rmem_911, %coord_5607) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %coord_5608 = cute.make_coord() : () -> !cute.coord<"0">
      %2029 = cute.memref.load(%rmem_911, %coord_5608) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2030 = arith.cmpf une, %2028, %2029 : f32
      %2031 = arith.extui %2027 : i1 to i32
      %c0_i32_5609 = arith.constant 0 : i32
      %2032 = arith.cmpi ne, %2031, %c0_i32_5609 : i32
      %2033 = arith.extui %2027 : i1 to i32
      %2034 = arith.extui %2030 : i1 to i32
      %2035 = arith.select %2032, %2033, %2034 : i32
      %c0_i32_5610 = arith.constant 0 : i32
      %2036 = arith.cmpi ne, %2035, %c0_i32_5610 : i32
      %coord_5611 = cute.make_coord() : () -> !cute.coord<"0">
      %2037 = cute.memref.load(%rmem_911, %coord_5611) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2038 = nvvm.rcp.approx.ftz.f %2037 : f32
      %cst_5612 = arith.constant 1.000000e+00 : f32
      %2039 = arith.select %2036, %cst_5612, %2038 : f32
      %coord_5613 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %slice_5614 = cute.slice(%view_5592, %coord_5613) : !memref_rmem_f32_4, !cute.coord<"(0,_)">
      %iter_5615 = cute.get_iter(%slice_5614) : !memref_rmem_f32_8
      %lay_5616 = cute.get_layout(%slice_5614) : !memref_rmem_f32_8
      %2040 = cute.get_shape(%lay_5616) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5617, %e1_5618 = cute.get_leaves(%2040) : !cute.shape<"((2,16))">
      %2041 = cute.memref.load_vec %slice_5614, row_major : !memref_rmem_f32_8
      %2042 = vector.broadcast %2039 : f32 to vector<32xf32>
      %2043 = arith.mulf %2041, %2042 : vector<32xf32>
      %coord_5619 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %slice_5620 = cute.slice(%view_5592, %coord_5619) : !memref_rmem_f32_4, !cute.coord<"(0,_)">
      %iter_5621 = cute.get_iter(%slice_5620) : !memref_rmem_f32_8
      %lay_5622 = cute.get_layout(%slice_5620) : !memref_rmem_f32_8
      %2044 = cute.get_shape(%lay_5622) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5623, %e1_5624 = cute.get_leaves(%2044) : !cute.shape<"((2,16))">
      %int_tuple_5625 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5626 = cute.size(%int_tuple_5625) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5627 = cute.get_leaves(%sz_5626) : !cute.int_tuple<"32">
      %int_tuple_5628 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5629 = cute.size(%int_tuple_5628) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5630 = cute.get_leaves(%sz_5629) : !cute.int_tuple<"32">
      cute.memref.store_vec %2043, %slice_5620, row_major : !memref_rmem_f32_8
      %coord_5631 = cute.make_coord() : () -> !cute.coord<"1">
      %2045 = cute.memref.load(%rmem_911, %coord_5631) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %c-1_i32_5632 = arith.constant -1 : i32
      %c2_i32_5633 = arith.constant 2 : i32
      %c31_i32_5634 = arith.constant 31 : i32
      %2046 = nvvm.shfl.sync  bfly %c-1_i32_5632, %2045, %c2_i32_5633, %c31_i32_5634 : f32 -> f32
      %2047 = arith.addf %2045, %2046 : f32
      %c-1_i32_5635 = arith.constant -1 : i32
      %c1_i32_5636 = arith.constant 1 : i32
      %c31_i32_5637 = arith.constant 31 : i32
      %2048 = nvvm.shfl.sync  bfly %c-1_i32_5635, %2047, %c1_i32_5636, %c31_i32_5637 : f32 -> f32
      %2049 = arith.addf %2047, %2048 : f32
      %coord_5638 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_911, %coord_5638, %2049) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_5639 = cute.make_coord() : () -> !cute.coord<"1">
      %2050 = cute.memref.load(%rmem_911, %coord_5639) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2051 = arith.cmpf oeq, %2050, %cst_5605 : f32
      %coord_5640 = cute.make_coord() : () -> !cute.coord<"1">
      %2052 = cute.memref.load(%rmem_911, %coord_5640) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2053 = arith.cmpf oeq, %2052, %cst_5605 : f32
      %coord_5641 = cute.make_coord() : () -> !cute.coord<"1">
      %2054 = cute.memref.load(%rmem_911, %coord_5641) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %coord_5642 = cute.make_coord() : () -> !cute.coord<"1">
      %2055 = cute.memref.load(%rmem_911, %coord_5642) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2056 = arith.cmpf une, %2054, %2055 : f32
      %2057 = arith.extui %2053 : i1 to i32
      %2058 = arith.cmpi ne, %2057, %c0_i32_5609 : i32
      %2059 = arith.extui %2053 : i1 to i32
      %2060 = arith.extui %2056 : i1 to i32
      %2061 = arith.select %2058, %2059, %2060 : i32
      %2062 = arith.cmpi ne, %2061, %c0_i32_5610 : i32
      %coord_5643 = cute.make_coord() : () -> !cute.coord<"1">
      %2063 = cute.memref.load(%rmem_911, %coord_5643) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2064 = nvvm.rcp.approx.ftz.f %2063 : f32
      %2065 = arith.select %2062, %cst_5612, %2064 : f32
      %coord_5644 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %slice_5645 = cute.slice(%view_5592, %coord_5644) : !memref_rmem_f32_4, !cute.coord<"(1,_)">
      %iter_5646 = cute.get_iter(%slice_5645) : !memref_rmem_f32_9
      %lay_5647 = cute.get_layout(%slice_5645) : !memref_rmem_f32_9
      %2066 = cute.get_shape(%lay_5647) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5648, %e1_5649 = cute.get_leaves(%2066) : !cute.shape<"((2,16))">
      %2067 = cute.memref.load_vec %slice_5645, row_major : !memref_rmem_f32_9
      %2068 = vector.broadcast %2065 : f32 to vector<32xf32>
      %2069 = arith.mulf %2067, %2068 : vector<32xf32>
      %coord_5650 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %slice_5651 = cute.slice(%view_5592, %coord_5650) : !memref_rmem_f32_4, !cute.coord<"(1,_)">
      %iter_5652 = cute.get_iter(%slice_5651) : !memref_rmem_f32_9
      %lay_5653 = cute.get_layout(%slice_5651) : !memref_rmem_f32_9
      %2070 = cute.get_shape(%lay_5653) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5654, %e1_5655 = cute.get_leaves(%2070) : !cute.shape<"((2,16))">
      %int_tuple_5656 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5657 = cute.size(%int_tuple_5656) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5658 = cute.get_leaves(%sz_5657) : !cute.int_tuple<"32">
      %int_tuple_5659 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5660 = cute.size(%int_tuple_5659) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5661 = cute.get_leaves(%sz_5660) : !cute.int_tuple<"32">
      cute.memref.store_vec %2069, %slice_5651, row_major : !memref_rmem_f32_9
      %coord_5662 = cute.make_coord() : () -> !cute.coord<"2">
      %2071 = cute.memref.load(%rmem_911, %coord_5662) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %c-1_i32_5663 = arith.constant -1 : i32
      %c2_i32_5664 = arith.constant 2 : i32
      %c31_i32_5665 = arith.constant 31 : i32
      %2072 = nvvm.shfl.sync  bfly %c-1_i32_5663, %2071, %c2_i32_5664, %c31_i32_5665 : f32 -> f32
      %2073 = arith.addf %2071, %2072 : f32
      %c-1_i32_5666 = arith.constant -1 : i32
      %c1_i32_5667 = arith.constant 1 : i32
      %c31_i32_5668 = arith.constant 31 : i32
      %2074 = nvvm.shfl.sync  bfly %c-1_i32_5666, %2073, %c1_i32_5667, %c31_i32_5668 : f32 -> f32
      %2075 = arith.addf %2073, %2074 : f32
      %coord_5669 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_911, %coord_5669, %2075) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5670 = cute.make_coord() : () -> !cute.coord<"2">
      %2076 = cute.memref.load(%rmem_911, %coord_5670) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2077 = arith.cmpf oeq, %2076, %cst_5605 : f32
      %coord_5671 = cute.make_coord() : () -> !cute.coord<"2">
      %2078 = cute.memref.load(%rmem_911, %coord_5671) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2079 = arith.cmpf oeq, %2078, %cst_5605 : f32
      %coord_5672 = cute.make_coord() : () -> !cute.coord<"2">
      %2080 = cute.memref.load(%rmem_911, %coord_5672) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %coord_5673 = cute.make_coord() : () -> !cute.coord<"2">
      %2081 = cute.memref.load(%rmem_911, %coord_5673) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2082 = arith.cmpf une, %2080, %2081 : f32
      %2083 = arith.extui %2079 : i1 to i32
      %2084 = arith.cmpi ne, %2083, %c0_i32_5609 : i32
      %2085 = arith.extui %2079 : i1 to i32
      %2086 = arith.extui %2082 : i1 to i32
      %2087 = arith.select %2084, %2085, %2086 : i32
      %2088 = arith.cmpi ne, %2087, %c0_i32_5610 : i32
      %coord_5674 = cute.make_coord() : () -> !cute.coord<"2">
      %2089 = cute.memref.load(%rmem_911, %coord_5674) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2090 = nvvm.rcp.approx.ftz.f %2089 : f32
      %2091 = arith.select %2088, %cst_5612, %2090 : f32
      %coord_5675 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %slice_5676 = cute.slice(%view_5592, %coord_5675) : !memref_rmem_f32_4, !cute.coord<"(2,_)">
      %iter_5677 = cute.get_iter(%slice_5676) : !memref_rmem_f32_10
      %lay_5678 = cute.get_layout(%slice_5676) : !memref_rmem_f32_10
      %2092 = cute.get_shape(%lay_5678) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5679, %e1_5680 = cute.get_leaves(%2092) : !cute.shape<"((2,16))">
      %2093 = cute.memref.load_vec %slice_5676, row_major : !memref_rmem_f32_10
      %2094 = vector.broadcast %2091 : f32 to vector<32xf32>
      %2095 = arith.mulf %2093, %2094 : vector<32xf32>
      %coord_5681 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %slice_5682 = cute.slice(%view_5592, %coord_5681) : !memref_rmem_f32_4, !cute.coord<"(2,_)">
      %iter_5683 = cute.get_iter(%slice_5682) : !memref_rmem_f32_10
      %lay_5684 = cute.get_layout(%slice_5682) : !memref_rmem_f32_10
      %2096 = cute.get_shape(%lay_5684) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5685, %e1_5686 = cute.get_leaves(%2096) : !cute.shape<"((2,16))">
      %int_tuple_5687 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5688 = cute.size(%int_tuple_5687) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5689 = cute.get_leaves(%sz_5688) : !cute.int_tuple<"32">
      %int_tuple_5690 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5691 = cute.size(%int_tuple_5690) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5692 = cute.get_leaves(%sz_5691) : !cute.int_tuple<"32">
      cute.memref.store_vec %2095, %slice_5682, row_major : !memref_rmem_f32_10
      %coord_5693 = cute.make_coord() : () -> !cute.coord<"3">
      %2097 = cute.memref.load(%rmem_911, %coord_5693) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %c-1_i32_5694 = arith.constant -1 : i32
      %c2_i32_5695 = arith.constant 2 : i32
      %c31_i32_5696 = arith.constant 31 : i32
      %2098 = nvvm.shfl.sync  bfly %c-1_i32_5694, %2097, %c2_i32_5695, %c31_i32_5696 : f32 -> f32
      %2099 = arith.addf %2097, %2098 : f32
      %c-1_i32_5697 = arith.constant -1 : i32
      %c1_i32_5698 = arith.constant 1 : i32
      %c31_i32_5699 = arith.constant 31 : i32
      %2100 = nvvm.shfl.sync  bfly %c-1_i32_5697, %2099, %c1_i32_5698, %c31_i32_5699 : f32 -> f32
      %2101 = arith.addf %2099, %2100 : f32
      %coord_5700 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_911, %coord_5700, %2101) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_5701 = cute.make_coord() : () -> !cute.coord<"3">
      %2102 = cute.memref.load(%rmem_911, %coord_5701) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2103 = arith.cmpf oeq, %2102, %cst_5605 : f32
      %coord_5702 = cute.make_coord() : () -> !cute.coord<"3">
      %2104 = cute.memref.load(%rmem_911, %coord_5702) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2105 = arith.cmpf oeq, %2104, %cst_5605 : f32
      %coord_5703 = cute.make_coord() : () -> !cute.coord<"3">
      %2106 = cute.memref.load(%rmem_911, %coord_5703) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %coord_5704 = cute.make_coord() : () -> !cute.coord<"3">
      %2107 = cute.memref.load(%rmem_911, %coord_5704) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2108 = arith.cmpf une, %2106, %2107 : f32
      %2109 = arith.extui %2105 : i1 to i32
      %2110 = arith.cmpi ne, %2109, %c0_i32_5609 : i32
      %2111 = arith.extui %2105 : i1 to i32
      %2112 = arith.extui %2108 : i1 to i32
      %2113 = arith.select %2110, %2111, %2112 : i32
      %2114 = arith.cmpi ne, %2113, %c0_i32_5610 : i32
      %coord_5705 = cute.make_coord() : () -> !cute.coord<"3">
      %2115 = cute.memref.load(%rmem_911, %coord_5705) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2116 = nvvm.rcp.approx.ftz.f %2115 : f32
      %2117 = arith.select %2114, %cst_5612, %2116 : f32
      %coord_5706 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %slice_5707 = cute.slice(%view_5592, %coord_5706) : !memref_rmem_f32_4, !cute.coord<"(3,_)">
      %iter_5708 = cute.get_iter(%slice_5707) : !memref_rmem_f32_9
      %lay_5709 = cute.get_layout(%slice_5707) : !memref_rmem_f32_9
      %2118 = cute.get_shape(%lay_5709) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5710, %e1_5711 = cute.get_leaves(%2118) : !cute.shape<"((2,16))">
      %2119 = cute.memref.load_vec %slice_5707, row_major : !memref_rmem_f32_9
      %2120 = vector.broadcast %2117 : f32 to vector<32xf32>
      %2121 = arith.mulf %2119, %2120 : vector<32xf32>
      %coord_5712 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %slice_5713 = cute.slice(%view_5592, %coord_5712) : !memref_rmem_f32_4, !cute.coord<"(3,_)">
      %iter_5714 = cute.get_iter(%slice_5713) : !memref_rmem_f32_9
      %lay_5715 = cute.get_layout(%slice_5713) : !memref_rmem_f32_9
      %2122 = cute.get_shape(%lay_5715) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_5716, %e1_5717 = cute.get_leaves(%2122) : !cute.shape<"((2,16))">
      %int_tuple_5718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5719 = cute.size(%int_tuple_5718) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5720 = cute.get_leaves(%sz_5719) : !cute.int_tuple<"32">
      %int_tuple_5721 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_5722 = cute.size(%int_tuple_5721) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_5723 = cute.get_leaves(%sz_5722) : !cute.int_tuple<"32">
      cute.memref.store_vec %2121, %slice_5713, row_major : !memref_rmem_f32_9
      %lay_5724 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2123 = cute.make_layout_like(%lay_5724) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> to !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_5725 = cute.memref.alloca(%2123) : !memref_rmem_bf16_18
      %iter_5726 = cute.get_iter(%rmem_5725) : !memref_rmem_bf16_18
      %iter_5727 = cute.get_iter(%rmem_5725) : !memref_rmem_bf16_18
      %lay_5728 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2124 = cute.get_shape(%lay_5728) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5729, %e1_5730, %e2_5731, %e3_5732 = cute.get_leaves(%2124) : !cute.shape<"((2,2),2,16)">
      %2125 = cute.memref.load_vec %rmem, row_major : !memref_rmem_f32_
      %2126 = arith.truncf %2125 : vector<128xf32> to vector<128xbf16>
      %lay_5733 = cute.get_layout(%rmem_5725) : !memref_rmem_bf16_18
      %2127 = cute.get_shape(%lay_5733) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_5734, %e1_5735, %e2_5736, %e3_5737 = cute.get_leaves(%2127) : !cute.shape<"((2,2),2,16)">
      %int_tuple_5738 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_5739 = cute.size(%int_tuple_5738) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_5740 = cute.get_leaves(%sz_5739) : !cute.int_tuple<"128">
      %int_tuple_5741 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_5742 = cute.size(%int_tuple_5741) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_5743 = cute.get_leaves(%sz_5742) : !cute.int_tuple<"128">
      cute.memref.store_vec %2126, %rmem_5725, row_major : !memref_rmem_bf16_18
      %view_5744 = cute.make_view(%iter_219, %2) : !memref_smem_bf16_
      %iter_5745 = cute.get_iter(%view_5744) : !memref_smem_bf16_
      %atom_5746 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %2128 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %2129 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_5747, %e1_5748, %e2_5749 = cute.get_leaves(%2129) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_5750 = cute.size(%e0_5747) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_5751 = cute.get_leaves(%sz_5750) : !cute.int_tuple<"64">
      %2130 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_5752, %e1_5753, %e2_5754 = cute.get_leaves(%2130) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_5755 = cute.size(%e1_5753) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_5756 = cute.get_leaves(%sz_5755) : !cute.int_tuple<"16">
      %tile_5757 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %2131 = cute.make_tiled_copy(%atom_5746) : !copy_simt1
      %retiled_5758 = cute.tiled.copy.retile(%2131, %rmem_5725) : (!copy_simt1, !memref_rmem_bf16_18) -> !memref_rmem_bf16_19
      %iter_5759 = cute.get_iter(%retiled_5758) : !memref_rmem_bf16_19
      %coord_5760 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_5761 = cute.tiled.copy.partition_D(%2131, %view_5744, %coord_5760) : (!copy_simt1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_20
      %iter_5762 = cute.get_iter(%dst_partitioned_5761) : !memref_smem_bf16_20
      %lay_5763 = cute.get_layout(%retiled_5758) : !memref_rmem_bf16_19
      %2132 = cute.get_shape(%lay_5763) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_5764, %e1_5765, %e2_5766, %e3_5767, %e4_5768 = cute.get_leaves(%2132) : !cute.shape<"((1,(4,2)),2,8)">
      %lay_5769 = cute.get_layout(%dst_partitioned_5761) : !memref_smem_bf16_20
      %2133 = cute.get_shape(%lay_5769) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_5770, %e1_5771, %e2_5772, %e3_5773, %e4_5774, %e5_5775, %e6, %e7 = cute.get_leaves(%2133) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %lay_5776 = cute.get_layout(%retiled_5758) : !memref_rmem_bf16_19
      %shape_5777 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5778 = cute.make_layout(%shape_5777) : !cute.layout<"1:0">
      %append_5779 = cute.append_to_rank<2> (%lay_5776, %lay_5778) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0">
      %view_5780 = cute.make_view(%iter_5759, %append_5779) : !memref_rmem_bf16_19
      %iter_5781 = cute.get_iter(%view_5780) : !memref_rmem_bf16_19
      %lay_5782 = cute.get_layout(%view_5780) : !memref_rmem_bf16_19
      %2134 = cute.get_shape(%lay_5782) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_5783, %e1_5784, %e2_5785, %e3_5786, %e4_5787 = cute.get_leaves(%2134) : !cute.shape<"((1,(4,2)),2,8)">
      %grouped_5788 = cute.group_modes(%view_5780) <1, 3> : (!memref_rmem_bf16_19) -> !memref_rmem_bf16_20
      %iter_5789 = cute.get_iter(%grouped_5788) : !memref_rmem_bf16_20
      %iter_5790 = cute.get_iter(%grouped_5788) : !memref_rmem_bf16_20
      %lay_5791 = cute.get_layout(%dst_partitioned_5761) : !memref_smem_bf16_20
      %shape_5792 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5793 = cute.make_layout(%shape_5792) : !cute.layout<"1:0">
      %append_5794 = cute.append_to_rank<2> (%lay_5791, %lay_5793) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0">
      %view_5795 = cute.make_view(%iter_5762, %append_5794) : !memref_smem_bf16_20
      %iter_5796 = cute.get_iter(%view_5795) : !memref_smem_bf16_20
      %lay_5797 = cute.get_layout(%view_5795) : !memref_smem_bf16_20
      %2135 = cute.get_shape(%lay_5797) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_5798, %e1_5799, %e2_5800, %e3_5801, %e4_5802, %e5_5803, %e6_5804, %e7_5805 = cute.get_leaves(%2135) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %grouped_5806 = cute.group_modes(%view_5795) <1, 3> : (!memref_smem_bf16_20) -> !memref_smem_bf16_21
      %iter_5807 = cute.get_iter(%grouped_5806) : !memref_smem_bf16_21
      %iter_5808 = cute.get_iter(%grouped_5806) : !memref_smem_bf16_21
      %lay_5809 = cute.get_layout(%grouped_5788) : !memref_rmem_bf16_20
      %2136 = cute.get_shape(%lay_5809) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))">
      %e0_5810, %e1_5811, %e2_5812, %e3_5813, %e4_5814 = cute.get_leaves(%2136) : !cute.shape<"((1,(4,2)),(2,8))">
      %lay_5815 = cute.get_layout(%grouped_5806) : !memref_smem_bf16_21
      %2137 = cute.get_shape(%lay_5815) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %e0_5816, %e1_5817, %e2_5818, %e3_5819, %e4_5820, %e5_5821, %e6_5822, %e7_5823 = cute.get_leaves(%2137) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %sz_5824 = cute.size(%grouped_5788) <{mode = [1]}> : (!memref_rmem_bf16_20) -> !cute.int_tuple<"16">
      %e0_5825 = cute.get_leaves(%sz_5824) : !cute.int_tuple<"16">
      %sz_5826 = cute.size(%grouped_5806) <{mode = [1]}> : (!memref_smem_bf16_21) -> !cute.int_tuple<"16">
      %e0_5827 = cute.get_leaves(%sz_5826) : !cute.int_tuple<"16">
      cute.copy(%atom_5746, %grouped_5788, %grouped_5806) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_20, !memref_smem_bf16_21)
      %coord_5828 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_5829 = cute.slice(%arg3, %coord_5828) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)">
      %iter_5830 = cute.get_iter(%slice_5829) : !memref_gmem_bf16_1
      %tile_5831 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_5832 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %tiled_view_5833 = cute.local_tile(%slice_5829, %tile_5831, %coord_5832) : (!memref_gmem_bf16_1, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !memref_gmem_bf16_2
      %iter_5834 = cute.get_iter(%tiled_view_5833) : !memref_gmem_bf16_2
      %coord_5835 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_5836 = cute.tiled.copy.partition_S(%4, %view_5744, %coord_5835) : (!copy_simt, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_5837 = cute.get_iter(%src_partitioned_5836) : !memref_smem_bf16_3
      %coord_5838 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_5839 = cute.tiled.copy.partition_D(%4, %tiled_view_5833, %coord_5838) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_5840 = cute.get_iter(%dst_partitioned_5839) : !memref_gmem_bf16_4
      %lay_5841 = cute.get_layout(%dst_partitioned_5839) : !memref_gmem_bf16_4
      %2138 = cute.make_layout_like(%lay_5841) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),8,2):((1,0),16,8)">
      %rmem_5842 = cute.memref.alloca(%2138) : !memref_rmem_bf16_21
      %iter_5843 = cute.get_iter(%rmem_5842) : !memref_rmem_bf16_21
      %iter_5844 = cute.get_iter(%rmem_5842) : !memref_rmem_bf16_21
      %c1_i32_5845 = arith.constant 1 : i32
      %c128_i32_5846 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_5845 number_of_threads = %c128_i32_5846
      %lay_5847 = cute.get_layout(%src_partitioned_5836) : !memref_smem_bf16_3
      %2139 = cute.get_shape(%lay_5847) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_5848, %e1_5849, %e2_5850, %e3_5851 = cute.get_leaves(%2139) : !cute.shape<"((8,1),8,2)">
      %lay_5852 = cute.get_layout(%rmem_5842) : !memref_rmem_bf16_21
      %2140 = cute.get_shape(%lay_5852) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_5853, %e1_5854, %e2_5855, %e3_5856 = cute.get_leaves(%2140) : !cute.shape<"((8,1),8,2)">
      %lay_5857 = cute.get_layout(%src_partitioned_5836) : !memref_smem_bf16_3
      %shape_5858 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5859 = cute.make_layout(%shape_5858) : !cute.layout<"1:0">
      %append_5860 = cute.append_to_rank<2> (%lay_5857, %lay_5859) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0">
      %view_5861 = cute.make_view(%iter_5837, %append_5860) : !memref_smem_bf16_3
      %iter_5862 = cute.get_iter(%view_5861) : !memref_smem_bf16_3
      %lay_5863 = cute.get_layout(%view_5861) : !memref_smem_bf16_3
      %2141 = cute.get_shape(%lay_5863) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_5864, %e1_5865, %e2_5866, %e3_5867 = cute.get_leaves(%2141) : !cute.shape<"((8,1),8,2)">
      %grouped_5868 = cute.group_modes(%view_5861) <1, 3> : (!memref_smem_bf16_3) -> !memref_smem_bf16_22
      %iter_5869 = cute.get_iter(%grouped_5868) : !memref_smem_bf16_22
      %iter_5870 = cute.get_iter(%grouped_5868) : !memref_smem_bf16_22
      %lay_5871 = cute.get_layout(%rmem_5842) : !memref_rmem_bf16_21
      %shape_5872 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_5873 = cute.make_layout(%shape_5872) : !cute.layout<"1:0">
      %append_5874 = cute.append_to_rank<2> (%lay_5871, %lay_5873) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_5875 = cute.make_view(%iter_5844, %append_5874) : !memref_rmem_bf16_21
      %iter_5876 = cute.get_iter(%view_5875) : !memref_rmem_bf16_21
      %lay_5877 = cute.get_layout(%view_5875) : !memref_rmem_bf16_21
      %2142 = cute.get_shape(%lay_5877) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_5878, %e1_5879, %e2_5880, %e3_5881 = cute.get_leaves(%2142) : !cute.shape<"((8,1),8,2)">
      %grouped_5882 = cute.group_modes(%view_5875) <1, 3> : (!memref_rmem_bf16_21) -> !memref_rmem_bf16_22
      %iter_5883 = cute.get_iter(%grouped_5882) : !memref_rmem_bf16_22
      %iter_5884 = cute.get_iter(%grouped_5882) : !memref_rmem_bf16_22
      %lay_5885 = cute.get_layout(%grouped_5868) : !memref_smem_bf16_22
      %2143 = cute.get_shape(%lay_5885) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_5886, %e1_5887, %e2_5888, %e3_5889 = cute.get_leaves(%2143) : !cute.shape<"((8,1),(8,2))">
      %lay_5890 = cute.get_layout(%grouped_5882) : !memref_rmem_bf16_22
      %2144 = cute.get_shape(%lay_5890) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_5891, %e1_5892, %e2_5893, %e3_5894 = cute.get_leaves(%2144) : !cute.shape<"((8,1),(8,2))">
      %sz_5895 = cute.size(%grouped_5868) <{mode = [1]}> : (!memref_smem_bf16_22) -> !cute.int_tuple<"16">
      %e0_5896 = cute.get_leaves(%sz_5895) : !cute.int_tuple<"16">
      %sz_5897 = cute.size(%grouped_5882) <{mode = [1]}> : (!memref_rmem_bf16_22) -> !cute.int_tuple<"16">
      %e0_5898 = cute.get_leaves(%sz_5897) : !cute.int_tuple<"16">
      cute.copy(%4, %grouped_5868, %grouped_5882) : (!copy_simt, !memref_smem_bf16_22, !memref_rmem_bf16_22)
      %lay_5899 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2145 = cute.get_shape(%lay_5899) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_5900, %e1_5901, %e2_5902, %e3_5903 = cute.get_leaves(%2145) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_5904 = cute.to_int_tuple(%e0_5900) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2146 = cute.get_scalars(%itup_5904) : !cute.int_tuple<"?">
      %itup_5905 = cute.to_int_tuple(%e1_5901) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2147 = cute.get_scalars(%itup_5905) : !cute.int_tuple<"?">
      %itup_5906 = cute.to_int_tuple(%e2_5902) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2148 = cute.get_scalars(%itup_5906) : !cute.int_tuple<"?">
      %itup_5907 = cute.to_int_tuple(%e3_5903) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2149 = cute.get_scalars(%itup_5907) : !cute.int_tuple<"?{div=8}">
      %shape_5908 = cute.make_shape(%itup_5904, %itup_5905, %itup_5906, %itup_5907) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %2150 = cute.make_identity_tensor(%shape_5908) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_5909 = cute.get_iter(%2150) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_5910, %e1_5911, %e2_5912, %e3_5913 = cute.get_leaves(%iter_5909) : !cute.int_tuple<"(0,0,0,0)">
      %coord_5914 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %slice_5915 = cute.slice(%2150, %coord_5914) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %iter_5916 = cute.get_iter(%slice_5915) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_5917, %e1_5918, %e2_5919, %e3_5920 = cute.get_leaves(%iter_5916) : !cute.int_tuple<"(?,0,?,0)">
      %2151 = cute.get_scalars(%e0_5917) : !cute.int_tuple<"?">
      %2152 = cute.get_scalars(%e2_5919) : !cute.int_tuple<"?">
      %tile_5921 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_5922 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %tiled_view_5923 = cute.local_tile(%slice_5915, %tile_5921, %coord_5922) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_5924 = cute.get_iter(%tiled_view_5923) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_5925, %e1_5926, %e2_5927, %e3_5928 = cute.get_leaves(%iter_5924) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %2153 = cute.get_scalars(%e0_5925) : !cute.int_tuple<"?">
      %2154 = cute.get_scalars(%e1_5926) : !cute.int_tuple<"?{div=128}">
      %2155 = cute.get_scalars(%e2_5927) : !cute.int_tuple<"?">
      %coord_5929 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_5930 = cute.tiled.copy.partition_D(%4, %tiled_view_5923, %coord_5929) : (!copy_simt, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_5931 = cute.get_iter(%dst_partitioned_5930) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_5932, %e1_5933, %e2_5934, %e3_5935 = cute.get_leaves(%iter_5931) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2156 = cute.get_scalars(%e0_5932) : !cute.int_tuple<"?">
      %2157 = cute.get_scalars(%e1_5933) : !cute.int_tuple<"?">
      %2158 = cute.get_scalars(%e2_5934) : !cute.int_tuple<"?">
      %2159 = cute.get_scalars(%e3_5935) : !cute.int_tuple<"?{div=8}">
      %lay_5936 = cute.get_layout(%dst_partitioned_5839) : !memref_gmem_bf16_4
      %2160 = cute.get_shape(%lay_5936) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)">
      %e0_5937, %e1_5938, %e2_5939, %e3_5940 = cute.get_leaves(%2160) : !cute.shape<"((8,1),8,2)">
      %shape_5941 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_5942 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_5943 = cute.make_layout(%shape_5941, %stride_5942) : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_5944 = cute.memref.alloca(%lay_5943) : !memref_rmem_i8_
      %iter_5945 = cute.get_iter(%rmem_5944) : !memref_rmem_i8_
      %iter_5946 = cute.get_iter(%rmem_5944) : !memref_rmem_i8_
      %lay_5947 = cute.get_layout(%rmem_5944) : !memref_rmem_i8_
      %2161 = cute.get_shape(%lay_5947) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_5948, %e1_5949, %e2_5950 = cute.get_leaves(%2161) : !cute.shape<"(1,8,2)">
      %int_tuple_5951 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_5952 = cute.size(%int_tuple_5951) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_5953 = cute.get_leaves(%sz_5952) : !cute.int_tuple<"2">
      %coord_5954 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %slice_5955 = cute.slice(%dst_partitioned_5930, %coord_5954) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)">
      %iter_5956 = cute.get_iter(%slice_5955) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5957, %e1_5958, %e2_5959, %e3_5960 = cute.get_leaves(%iter_5956) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2162 = cute.get_scalars(%e0_5957) : !cute.int_tuple<"?">
      %2163 = cute.get_scalars(%e1_5958) : !cute.int_tuple<"?">
      %2164 = cute.get_scalars(%e2_5959) : !cute.int_tuple<"?">
      %2165 = cute.get_scalars(%e3_5960) : !cute.int_tuple<"?{div=8}">
      %iter_5961 = cute.get_iter(%slice_5955) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5962, %e1_5963, %e2_5964, %e3_5965 = cute.get_leaves(%iter_5961) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2166 = cute.get_scalars(%e0_5962) : !cute.int_tuple<"?">
      %2167 = cute.get_scalars(%e1_5963) : !cute.int_tuple<"?">
      %2168 = cute.get_scalars(%e2_5964) : !cute.int_tuple<"?">
      %2169 = cute.get_scalars(%e3_5965) : !cute.int_tuple<"?{div=8}">
      %iter_5966 = cute.get_iter(%slice_5955) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5967, %e1_5968, %e2_5969, %e3_5970 = cute.get_leaves(%iter_5966) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2170 = cute.get_scalars(%e0_5967) : !cute.int_tuple<"?">
      %2171 = cute.get_scalars(%e1_5968) : !cute.int_tuple<"?">
      %2172 = cute.get_scalars(%e2_5969) : !cute.int_tuple<"?">
      %2173 = cute.get_scalars(%e3_5970) : !cute.int_tuple<"?{div=8}">
      %lay_5971 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2174 = cute.get_shape(%lay_5971) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_5972, %e1_5973, %e2_5974, %e3_5975 = cute.get_leaves(%2174) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_5976 = cute.to_int_tuple(%e0_5972) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2175 = cute.get_scalars(%itup_5976) : !cute.int_tuple<"?">
      %itup_5977 = cute.to_int_tuple(%e1_5973) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2176 = cute.get_scalars(%itup_5977) : !cute.int_tuple<"?">
      %itup_5978 = cute.to_int_tuple(%e2_5974) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2177 = cute.get_scalars(%itup_5978) : !cute.int_tuple<"?">
      %itup_5979 = cute.to_int_tuple(%e3_5975) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2178 = cute.get_scalars(%itup_5979) : !cute.int_tuple<"?{div=8}">
      %coord_5980 = cute.make_coord(%e3_5970) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_5981 = cute.make_coord(%itup_5979) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2179 = cute.elem_less(%coord_5980, %coord_5981) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2180 = arith.extui %2179 : i1 to i8
      %coord_5982 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_5944, %coord_5982, %2180) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_5983 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %slice_5984 = cute.slice(%dst_partitioned_5930, %coord_5983) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)">
      %iter_5985 = cute.get_iter(%slice_5984) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5986, %e1_5987, %e2_5988, %e3_5989 = cute.get_leaves(%iter_5985) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2181 = cute.get_scalars(%e0_5986) : !cute.int_tuple<"?">
      %2182 = cute.get_scalars(%e1_5987) : !cute.int_tuple<"?">
      %2183 = cute.get_scalars(%e2_5988) : !cute.int_tuple<"?">
      %2184 = cute.get_scalars(%e3_5989) : !cute.int_tuple<"?{div=8}">
      %iter_5990 = cute.get_iter(%slice_5984) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5991, %e1_5992, %e2_5993, %e3_5994 = cute.get_leaves(%iter_5990) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2185 = cute.get_scalars(%e0_5991) : !cute.int_tuple<"?">
      %2186 = cute.get_scalars(%e1_5992) : !cute.int_tuple<"?">
      %2187 = cute.get_scalars(%e2_5993) : !cute.int_tuple<"?">
      %2188 = cute.get_scalars(%e3_5994) : !cute.int_tuple<"?{div=8}">
      %iter_5995 = cute.get_iter(%slice_5984) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_5996, %e1_5997, %e2_5998, %e3_5999 = cute.get_leaves(%iter_5995) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2189 = cute.get_scalars(%e0_5996) : !cute.int_tuple<"?">
      %2190 = cute.get_scalars(%e1_5997) : !cute.int_tuple<"?">
      %2191 = cute.get_scalars(%e2_5998) : !cute.int_tuple<"?">
      %2192 = cute.get_scalars(%e3_5999) : !cute.int_tuple<"?{div=8}">
      %lay_6000 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2193 = cute.get_shape(%lay_6000) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6001, %e1_6002, %e2_6003, %e3_6004 = cute.get_leaves(%2193) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6005 = cute.to_int_tuple(%e0_6001) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2194 = cute.get_scalars(%itup_6005) : !cute.int_tuple<"?">
      %itup_6006 = cute.to_int_tuple(%e1_6002) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2195 = cute.get_scalars(%itup_6006) : !cute.int_tuple<"?">
      %itup_6007 = cute.to_int_tuple(%e2_6003) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2196 = cute.get_scalars(%itup_6007) : !cute.int_tuple<"?">
      %itup_6008 = cute.to_int_tuple(%e3_6004) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2197 = cute.get_scalars(%itup_6008) : !cute.int_tuple<"?{div=8}">
      %coord_6009 = cute.make_coord(%e3_5999) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_6010 = cute.make_coord(%itup_6008) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2198 = cute.elem_less(%coord_6009, %coord_6010) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2199 = arith.extui %2198 : i1 to i8
      %coord_6011 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_5944, %coord_6011, %2199) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_6012 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_6013 = cute.size(%int_tuple_6012) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_6014 = cute.get_leaves(%sz_6013) : !cute.int_tuple<"8">
      %coord_6015 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %slice_6016 = cute.slice(%dst_partitioned_5930, %coord_6015) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)">
      %iter_6017 = cute.get_iter(%slice_6016) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6018, %e1_6019, %e2_6020, %e3_6021 = cute.get_leaves(%iter_6017) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2200 = cute.get_scalars(%e0_6018) : !cute.int_tuple<"?">
      %2201 = cute.get_scalars(%e1_6019) : !cute.int_tuple<"?">
      %2202 = cute.get_scalars(%e2_6020) : !cute.int_tuple<"?">
      %2203 = cute.get_scalars(%e3_6021) : !cute.int_tuple<"?{div=8}">
      %iter_6022 = cute.get_iter(%slice_6016) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6023, %e1_6024, %e2_6025, %e3_6026 = cute.get_leaves(%iter_6022) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2204 = cute.get_scalars(%e0_6023) : !cute.int_tuple<"?">
      %2205 = cute.get_scalars(%e1_6024) : !cute.int_tuple<"?">
      %2206 = cute.get_scalars(%e2_6025) : !cute.int_tuple<"?">
      %2207 = cute.get_scalars(%e3_6026) : !cute.int_tuple<"?{div=8}">
      %iter_6027 = cute.get_iter(%slice_6016) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6028, %e1_6029, %e2_6030, %e3_6031 = cute.get_leaves(%iter_6027) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2208 = cute.get_scalars(%e0_6028) : !cute.int_tuple<"?">
      %2209 = cute.get_scalars(%e1_6029) : !cute.int_tuple<"?">
      %2210 = cute.get_scalars(%e2_6030) : !cute.int_tuple<"?">
      %2211 = cute.get_scalars(%e3_6031) : !cute.int_tuple<"?{div=8}">
      %lay_6032 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2212 = cute.get_shape(%lay_6032) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6033, %e1_6034, %e2_6035, %e3_6036 = cute.get_leaves(%2212) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6037 = cute.to_int_tuple(%e0_6033) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2213 = cute.get_scalars(%itup_6037) : !cute.int_tuple<"?">
      %itup_6038 = cute.to_int_tuple(%e1_6034) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2214 = cute.get_scalars(%itup_6038) : !cute.int_tuple<"?">
      %itup_6039 = cute.to_int_tuple(%e2_6035) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2215 = cute.get_scalars(%itup_6039) : !cute.int_tuple<"?">
      %itup_6040 = cute.to_int_tuple(%e3_6036) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2216 = cute.get_scalars(%itup_6040) : !cute.int_tuple<"?{div=8}">
      %coord_6041 = cute.make_coord(%e1_6029) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6042 = cute.make_coord(%itup_6038) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2217 = cute.elem_less(%coord_6041, %coord_6042) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2217 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,0,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,0,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,0,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6043 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %slice_6044 = cute.slice(%dst_partitioned_5930, %coord_6043) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)">
      %iter_6045 = cute.get_iter(%slice_6044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6046, %e1_6047, %e2_6048, %e3_6049 = cute.get_leaves(%iter_6045) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2218 = cute.get_scalars(%e0_6046) : !cute.int_tuple<"?">
      %2219 = cute.get_scalars(%e1_6047) : !cute.int_tuple<"?">
      %2220 = cute.get_scalars(%e2_6048) : !cute.int_tuple<"?">
      %2221 = cute.get_scalars(%e3_6049) : !cute.int_tuple<"?{div=8}">
      %iter_6050 = cute.get_iter(%slice_6044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6051, %e1_6052, %e2_6053, %e3_6054 = cute.get_leaves(%iter_6050) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2222 = cute.get_scalars(%e0_6051) : !cute.int_tuple<"?">
      %2223 = cute.get_scalars(%e1_6052) : !cute.int_tuple<"?">
      %2224 = cute.get_scalars(%e2_6053) : !cute.int_tuple<"?">
      %2225 = cute.get_scalars(%e3_6054) : !cute.int_tuple<"?{div=8}">
      %iter_6055 = cute.get_iter(%slice_6044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6056, %e1_6057, %e2_6058, %e3_6059 = cute.get_leaves(%iter_6055) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2226 = cute.get_scalars(%e0_6056) : !cute.int_tuple<"?">
      %2227 = cute.get_scalars(%e1_6057) : !cute.int_tuple<"?">
      %2228 = cute.get_scalars(%e2_6058) : !cute.int_tuple<"?">
      %2229 = cute.get_scalars(%e3_6059) : !cute.int_tuple<"?{div=8}">
      %lay_6060 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2230 = cute.get_shape(%lay_6060) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6061, %e1_6062, %e2_6063, %e3_6064 = cute.get_leaves(%2230) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6065 = cute.to_int_tuple(%e0_6061) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2231 = cute.get_scalars(%itup_6065) : !cute.int_tuple<"?">
      %itup_6066 = cute.to_int_tuple(%e1_6062) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2232 = cute.get_scalars(%itup_6066) : !cute.int_tuple<"?">
      %itup_6067 = cute.to_int_tuple(%e2_6063) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2233 = cute.get_scalars(%itup_6067) : !cute.int_tuple<"?">
      %itup_6068 = cute.to_int_tuple(%e3_6064) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2234 = cute.get_scalars(%itup_6068) : !cute.int_tuple<"?{div=8}">
      %coord_6069 = cute.make_coord(%e1_6057) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6070 = cute.make_coord(%itup_6066) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2235 = cute.elem_less(%coord_6069, %coord_6070) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2235 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,1,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,1,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,1,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6071 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %slice_6072 = cute.slice(%dst_partitioned_5930, %coord_6071) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)">
      %iter_6073 = cute.get_iter(%slice_6072) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6074, %e1_6075, %e2_6076, %e3_6077 = cute.get_leaves(%iter_6073) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2236 = cute.get_scalars(%e0_6074) : !cute.int_tuple<"?">
      %2237 = cute.get_scalars(%e1_6075) : !cute.int_tuple<"?">
      %2238 = cute.get_scalars(%e2_6076) : !cute.int_tuple<"?">
      %2239 = cute.get_scalars(%e3_6077) : !cute.int_tuple<"?{div=8}">
      %iter_6078 = cute.get_iter(%slice_6072) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6079, %e1_6080, %e2_6081, %e3_6082 = cute.get_leaves(%iter_6078) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2240 = cute.get_scalars(%e0_6079) : !cute.int_tuple<"?">
      %2241 = cute.get_scalars(%e1_6080) : !cute.int_tuple<"?">
      %2242 = cute.get_scalars(%e2_6081) : !cute.int_tuple<"?">
      %2243 = cute.get_scalars(%e3_6082) : !cute.int_tuple<"?{div=8}">
      %iter_6083 = cute.get_iter(%slice_6072) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6084, %e1_6085, %e2_6086, %e3_6087 = cute.get_leaves(%iter_6083) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2244 = cute.get_scalars(%e0_6084) : !cute.int_tuple<"?">
      %2245 = cute.get_scalars(%e1_6085) : !cute.int_tuple<"?">
      %2246 = cute.get_scalars(%e2_6086) : !cute.int_tuple<"?">
      %2247 = cute.get_scalars(%e3_6087) : !cute.int_tuple<"?{div=8}">
      %lay_6088 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2248 = cute.get_shape(%lay_6088) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6089, %e1_6090, %e2_6091, %e3_6092 = cute.get_leaves(%2248) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6093 = cute.to_int_tuple(%e0_6089) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2249 = cute.get_scalars(%itup_6093) : !cute.int_tuple<"?">
      %itup_6094 = cute.to_int_tuple(%e1_6090) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2250 = cute.get_scalars(%itup_6094) : !cute.int_tuple<"?">
      %itup_6095 = cute.to_int_tuple(%e2_6091) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2251 = cute.get_scalars(%itup_6095) : !cute.int_tuple<"?">
      %itup_6096 = cute.to_int_tuple(%e3_6092) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2252 = cute.get_scalars(%itup_6096) : !cute.int_tuple<"?{div=8}">
      %coord_6097 = cute.make_coord(%e1_6085) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6098 = cute.make_coord(%itup_6094) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2253 = cute.elem_less(%coord_6097, %coord_6098) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2253 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,2,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,2,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,2,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6099 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %slice_6100 = cute.slice(%dst_partitioned_5930, %coord_6099) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)">
      %iter_6101 = cute.get_iter(%slice_6100) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6102, %e1_6103, %e2_6104, %e3_6105 = cute.get_leaves(%iter_6101) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2254 = cute.get_scalars(%e0_6102) : !cute.int_tuple<"?">
      %2255 = cute.get_scalars(%e1_6103) : !cute.int_tuple<"?">
      %2256 = cute.get_scalars(%e2_6104) : !cute.int_tuple<"?">
      %2257 = cute.get_scalars(%e3_6105) : !cute.int_tuple<"?{div=8}">
      %iter_6106 = cute.get_iter(%slice_6100) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6107, %e1_6108, %e2_6109, %e3_6110 = cute.get_leaves(%iter_6106) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2258 = cute.get_scalars(%e0_6107) : !cute.int_tuple<"?">
      %2259 = cute.get_scalars(%e1_6108) : !cute.int_tuple<"?">
      %2260 = cute.get_scalars(%e2_6109) : !cute.int_tuple<"?">
      %2261 = cute.get_scalars(%e3_6110) : !cute.int_tuple<"?{div=8}">
      %iter_6111 = cute.get_iter(%slice_6100) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6112, %e1_6113, %e2_6114, %e3_6115 = cute.get_leaves(%iter_6111) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2262 = cute.get_scalars(%e0_6112) : !cute.int_tuple<"?">
      %2263 = cute.get_scalars(%e1_6113) : !cute.int_tuple<"?">
      %2264 = cute.get_scalars(%e2_6114) : !cute.int_tuple<"?">
      %2265 = cute.get_scalars(%e3_6115) : !cute.int_tuple<"?{div=8}">
      %lay_6116 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2266 = cute.get_shape(%lay_6116) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6117, %e1_6118, %e2_6119, %e3_6120 = cute.get_leaves(%2266) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6121 = cute.to_int_tuple(%e0_6117) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2267 = cute.get_scalars(%itup_6121) : !cute.int_tuple<"?">
      %itup_6122 = cute.to_int_tuple(%e1_6118) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2268 = cute.get_scalars(%itup_6122) : !cute.int_tuple<"?">
      %itup_6123 = cute.to_int_tuple(%e2_6119) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2269 = cute.get_scalars(%itup_6123) : !cute.int_tuple<"?">
      %itup_6124 = cute.to_int_tuple(%e3_6120) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2270 = cute.get_scalars(%itup_6124) : !cute.int_tuple<"?{div=8}">
      %coord_6125 = cute.make_coord(%e1_6113) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6126 = cute.make_coord(%itup_6122) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2271 = cute.elem_less(%coord_6125, %coord_6126) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2271 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,3,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,3,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,3,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6127 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %slice_6128 = cute.slice(%dst_partitioned_5930, %coord_6127) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,4,0)">
      %iter_6129 = cute.get_iter(%slice_6128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6130, %e1_6131, %e2_6132, %e3_6133 = cute.get_leaves(%iter_6129) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2272 = cute.get_scalars(%e0_6130) : !cute.int_tuple<"?">
      %2273 = cute.get_scalars(%e1_6131) : !cute.int_tuple<"?">
      %2274 = cute.get_scalars(%e2_6132) : !cute.int_tuple<"?">
      %2275 = cute.get_scalars(%e3_6133) : !cute.int_tuple<"?{div=8}">
      %iter_6134 = cute.get_iter(%slice_6128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6135, %e1_6136, %e2_6137, %e3_6138 = cute.get_leaves(%iter_6134) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2276 = cute.get_scalars(%e0_6135) : !cute.int_tuple<"?">
      %2277 = cute.get_scalars(%e1_6136) : !cute.int_tuple<"?">
      %2278 = cute.get_scalars(%e2_6137) : !cute.int_tuple<"?">
      %2279 = cute.get_scalars(%e3_6138) : !cute.int_tuple<"?{div=8}">
      %iter_6139 = cute.get_iter(%slice_6128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6140, %e1_6141, %e2_6142, %e3_6143 = cute.get_leaves(%iter_6139) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2280 = cute.get_scalars(%e0_6140) : !cute.int_tuple<"?">
      %2281 = cute.get_scalars(%e1_6141) : !cute.int_tuple<"?">
      %2282 = cute.get_scalars(%e2_6142) : !cute.int_tuple<"?">
      %2283 = cute.get_scalars(%e3_6143) : !cute.int_tuple<"?{div=8}">
      %lay_6144 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2284 = cute.get_shape(%lay_6144) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6145, %e1_6146, %e2_6147, %e3_6148 = cute.get_leaves(%2284) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6149 = cute.to_int_tuple(%e0_6145) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2285 = cute.get_scalars(%itup_6149) : !cute.int_tuple<"?">
      %itup_6150 = cute.to_int_tuple(%e1_6146) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2286 = cute.get_scalars(%itup_6150) : !cute.int_tuple<"?">
      %itup_6151 = cute.to_int_tuple(%e2_6147) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2287 = cute.get_scalars(%itup_6151) : !cute.int_tuple<"?">
      %itup_6152 = cute.to_int_tuple(%e3_6148) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2288 = cute.get_scalars(%itup_6152) : !cute.int_tuple<"?{div=8}">
      %coord_6153 = cute.make_coord(%e1_6141) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6154 = cute.make_coord(%itup_6150) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2289 = cute.elem_less(%coord_6153, %coord_6154) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2289 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,4,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,4,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,4,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6155 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %slice_6156 = cute.slice(%dst_partitioned_5930, %coord_6155) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,5,0)">
      %iter_6157 = cute.get_iter(%slice_6156) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6158, %e1_6159, %e2_6160, %e3_6161 = cute.get_leaves(%iter_6157) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2290 = cute.get_scalars(%e0_6158) : !cute.int_tuple<"?">
      %2291 = cute.get_scalars(%e1_6159) : !cute.int_tuple<"?">
      %2292 = cute.get_scalars(%e2_6160) : !cute.int_tuple<"?">
      %2293 = cute.get_scalars(%e3_6161) : !cute.int_tuple<"?{div=8}">
      %iter_6162 = cute.get_iter(%slice_6156) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6163, %e1_6164, %e2_6165, %e3_6166 = cute.get_leaves(%iter_6162) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2294 = cute.get_scalars(%e0_6163) : !cute.int_tuple<"?">
      %2295 = cute.get_scalars(%e1_6164) : !cute.int_tuple<"?">
      %2296 = cute.get_scalars(%e2_6165) : !cute.int_tuple<"?">
      %2297 = cute.get_scalars(%e3_6166) : !cute.int_tuple<"?{div=8}">
      %iter_6167 = cute.get_iter(%slice_6156) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6168, %e1_6169, %e2_6170, %e3_6171 = cute.get_leaves(%iter_6167) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2298 = cute.get_scalars(%e0_6168) : !cute.int_tuple<"?">
      %2299 = cute.get_scalars(%e1_6169) : !cute.int_tuple<"?">
      %2300 = cute.get_scalars(%e2_6170) : !cute.int_tuple<"?">
      %2301 = cute.get_scalars(%e3_6171) : !cute.int_tuple<"?{div=8}">
      %lay_6172 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2302 = cute.get_shape(%lay_6172) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6173, %e1_6174, %e2_6175, %e3_6176 = cute.get_leaves(%2302) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6177 = cute.to_int_tuple(%e0_6173) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2303 = cute.get_scalars(%itup_6177) : !cute.int_tuple<"?">
      %itup_6178 = cute.to_int_tuple(%e1_6174) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2304 = cute.get_scalars(%itup_6178) : !cute.int_tuple<"?">
      %itup_6179 = cute.to_int_tuple(%e2_6175) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2305 = cute.get_scalars(%itup_6179) : !cute.int_tuple<"?">
      %itup_6180 = cute.to_int_tuple(%e3_6176) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2306 = cute.get_scalars(%itup_6180) : !cute.int_tuple<"?{div=8}">
      %coord_6181 = cute.make_coord(%e1_6169) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6182 = cute.make_coord(%itup_6178) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2307 = cute.elem_less(%coord_6181, %coord_6182) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2307 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,5,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,5,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,5,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6183 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %slice_6184 = cute.slice(%dst_partitioned_5930, %coord_6183) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,6,0)">
      %iter_6185 = cute.get_iter(%slice_6184) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6186, %e1_6187, %e2_6188, %e3_6189 = cute.get_leaves(%iter_6185) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2308 = cute.get_scalars(%e0_6186) : !cute.int_tuple<"?">
      %2309 = cute.get_scalars(%e1_6187) : !cute.int_tuple<"?">
      %2310 = cute.get_scalars(%e2_6188) : !cute.int_tuple<"?">
      %2311 = cute.get_scalars(%e3_6189) : !cute.int_tuple<"?{div=8}">
      %iter_6190 = cute.get_iter(%slice_6184) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6191, %e1_6192, %e2_6193, %e3_6194 = cute.get_leaves(%iter_6190) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2312 = cute.get_scalars(%e0_6191) : !cute.int_tuple<"?">
      %2313 = cute.get_scalars(%e1_6192) : !cute.int_tuple<"?">
      %2314 = cute.get_scalars(%e2_6193) : !cute.int_tuple<"?">
      %2315 = cute.get_scalars(%e3_6194) : !cute.int_tuple<"?{div=8}">
      %iter_6195 = cute.get_iter(%slice_6184) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6196, %e1_6197, %e2_6198, %e3_6199 = cute.get_leaves(%iter_6195) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2316 = cute.get_scalars(%e0_6196) : !cute.int_tuple<"?">
      %2317 = cute.get_scalars(%e1_6197) : !cute.int_tuple<"?">
      %2318 = cute.get_scalars(%e2_6198) : !cute.int_tuple<"?">
      %2319 = cute.get_scalars(%e3_6199) : !cute.int_tuple<"?{div=8}">
      %lay_6200 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2320 = cute.get_shape(%lay_6200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6201, %e1_6202, %e2_6203, %e3_6204 = cute.get_leaves(%2320) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6205 = cute.to_int_tuple(%e0_6201) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2321 = cute.get_scalars(%itup_6205) : !cute.int_tuple<"?">
      %itup_6206 = cute.to_int_tuple(%e1_6202) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2322 = cute.get_scalars(%itup_6206) : !cute.int_tuple<"?">
      %itup_6207 = cute.to_int_tuple(%e2_6203) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2323 = cute.get_scalars(%itup_6207) : !cute.int_tuple<"?">
      %itup_6208 = cute.to_int_tuple(%e3_6204) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2324 = cute.get_scalars(%itup_6208) : !cute.int_tuple<"?{div=8}">
      %coord_6209 = cute.make_coord(%e1_6197) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6210 = cute.make_coord(%itup_6206) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2325 = cute.elem_less(%coord_6209, %coord_6210) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2325 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,6,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,6,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,6,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      %coord_6211 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %slice_6212 = cute.slice(%dst_partitioned_5930, %coord_6211) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,7,0)">
      %iter_6213 = cute.get_iter(%slice_6212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6214, %e1_6215, %e2_6216, %e3_6217 = cute.get_leaves(%iter_6213) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2326 = cute.get_scalars(%e0_6214) : !cute.int_tuple<"?">
      %2327 = cute.get_scalars(%e1_6215) : !cute.int_tuple<"?">
      %2328 = cute.get_scalars(%e2_6216) : !cute.int_tuple<"?">
      %2329 = cute.get_scalars(%e3_6217) : !cute.int_tuple<"?{div=8}">
      %iter_6218 = cute.get_iter(%slice_6212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6219, %e1_6220, %e2_6221, %e3_6222 = cute.get_leaves(%iter_6218) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2330 = cute.get_scalars(%e0_6219) : !cute.int_tuple<"?">
      %2331 = cute.get_scalars(%e1_6220) : !cute.int_tuple<"?">
      %2332 = cute.get_scalars(%e2_6221) : !cute.int_tuple<"?">
      %2333 = cute.get_scalars(%e3_6222) : !cute.int_tuple<"?{div=8}">
      %iter_6223 = cute.get_iter(%slice_6212) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_6224, %e1_6225, %e2_6226, %e3_6227 = cute.get_leaves(%iter_6223) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2334 = cute.get_scalars(%e0_6224) : !cute.int_tuple<"?">
      %2335 = cute.get_scalars(%e1_6225) : !cute.int_tuple<"?">
      %2336 = cute.get_scalars(%e2_6226) : !cute.int_tuple<"?">
      %2337 = cute.get_scalars(%e3_6227) : !cute.int_tuple<"?{div=8}">
      %lay_6228 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2338 = cute.get_shape(%lay_6228) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6229, %e1_6230, %e2_6231, %e3_6232 = cute.get_leaves(%2338) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6233 = cute.to_int_tuple(%e0_6229) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2339 = cute.get_scalars(%itup_6233) : !cute.int_tuple<"?">
      %itup_6234 = cute.to_int_tuple(%e1_6230) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2340 = cute.get_scalars(%itup_6234) : !cute.int_tuple<"?">
      %itup_6235 = cute.to_int_tuple(%e2_6231) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2341 = cute.get_scalars(%itup_6235) : !cute.int_tuple<"?">
      %itup_6236 = cute.to_int_tuple(%e3_6232) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2342 = cute.get_scalars(%itup_6236) : !cute.int_tuple<"?{div=8}">
      %coord_6237 = cute.make_coord(%e1_6225) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6238 = cute.make_coord(%itup_6234) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2343 = cute.elem_less(%coord_6237, %coord_6238) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2343 {
        %coord_6239 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6240 = cute.slice(%rmem_5842, %coord_6239) : !memref_rmem_bf16_21, !cute.coord<"(_,7,_)">
        %iter_6241 = cute.get_iter(%slice_6240) : !memref_rmem_bf16_23
        %coord_6242 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6243 = cute.slice(%dst_partitioned_5839, %coord_6242) : !memref_gmem_bf16_4, !cute.coord<"(_,7,_)">
        %iter_6244 = cute.get_iter(%slice_6243) : !memref_gmem_bf16_6
        %coord_6245 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %slice_6246 = cute.slice(%rmem_5944, %coord_6245) : !memref_rmem_i8_, !cute.coord<"(_,7,_)">
        %iter_6247 = cute.get_iter(%slice_6246) : !memref_rmem_i8_2
        %lay_6248 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %2344 = cute.get_shape(%lay_6248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6249, %e1_6250, %e2_6251 = cute.get_leaves(%2344) : !cute.shape<"((8,1),2)">
        %lay_6252 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %2345 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6253, %e1_6254, %e2_6255 = cute.get_leaves(%2345) : !cute.shape<"((8,1),2)">
        %lay_6256 = cute.get_layout(%slice_6240) : !memref_rmem_bf16_23
        %shape_6257 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6258 = cute.make_layout(%shape_6257) : !cute.layout<"1:0">
        %append_6259 = cute.append_to_rank<2> (%lay_6256, %lay_6258) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_6260 = cute.make_view(%iter_6241, %append_6259) : !memref_rmem_bf16_23
        %iter_6261 = cute.get_iter(%view_6260) : !memref_rmem_bf16_23
        %lay_6262 = cute.get_layout(%view_6260) : !memref_rmem_bf16_23
        %2346 = cute.get_shape(%lay_6262) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_6263, %e1_6264, %e2_6265 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)">
        %grouped_6266 = cute.group_modes(%view_6260) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24
        %iter_6267 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %iter_6268 = cute.get_iter(%grouped_6266) : !memref_rmem_bf16_24
        %lay_6269 = cute.get_layout(%slice_6243) : !memref_gmem_bf16_6
        %shape_6270 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6271 = cute.make_layout(%shape_6270) : !cute.layout<"1:0">
        %append_6272 = cute.append_to_rank<2> (%lay_6269, %lay_6271) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_6273 = cute.make_view(%iter_6244, %append_6272) : !memref_gmem_bf16_6
        %iter_6274 = cute.get_iter(%view_6273) : !memref_gmem_bf16_6
        %lay_6275 = cute.get_layout(%view_6273) : !memref_gmem_bf16_6
        %2347 = cute.get_shape(%lay_6275) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_6276, %e1_6277, %e2_6278 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)">
        %grouped_6279 = cute.group_modes(%view_6273) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7
        %iter_6280 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %iter_6281 = cute.get_iter(%grouped_6279) : !memref_gmem_bf16_7
        %lay_6282 = cute.get_layout(%slice_6246) : !memref_rmem_i8_2
        %shape_6283 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_6284 = cute.make_layout(%shape_6283) : !cute.layout<"1:0">
        %append_6285 = cute.append_to_rank<2> (%lay_6282, %lay_6284) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_6286 = cute.make_view(%iter_6247, %append_6285) : !memref_rmem_i8_2
        %iter_6287 = cute.get_iter(%view_6286) : !memref_rmem_i8_2
        %lay_6288 = cute.get_layout(%view_6286) : !memref_rmem_i8_2
        %2348 = cute.get_shape(%lay_6288) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_6289, %e1_6290 = cute.get_leaves(%2348) : !cute.shape<"(1,2)">
        %grouped_6291 = cute.group_modes(%view_6286) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3
        %iter_6292 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %iter_6293 = cute.get_iter(%grouped_6291) : !memref_rmem_i8_3
        %lay_6294 = cute.get_layout(%grouped_6266) : !memref_rmem_bf16_24
        %2349 = cute.get_shape(%lay_6294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_6295, %e1_6296, %e2_6297 = cute.get_leaves(%2349) : !cute.shape<"((8,1),(2))">
        %lay_6298 = cute.get_layout(%grouped_6279) : !memref_gmem_bf16_7
        %2350 = cute.get_shape(%lay_6298) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_6299, %e1_6300, %e2_6301 = cute.get_leaves(%2350) : !cute.shape<"((8,1),(2))">
        %sz_6302 = cute.size(%grouped_6266) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2">
        %e0_6303 = cute.get_leaves(%sz_6302) : !cute.int_tuple<"2">
        %sz_6304 = cute.size(%grouped_6279) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2">
        %e0_6305 = cute.get_leaves(%sz_6304) : !cute.int_tuple<"2">
        cute.copy(%4, %grouped_6266, %grouped_6279, %grouped_6291) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3)
      }
      return
    }
  }
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32, %arg5: !gpu.async.token) attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %36 = cute.static : !cute.swizzle<"S<3,3,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_65 = cute.make_layout(%shape, %stride) : !cute.layout<"(8,64):(64,1)">
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)">
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %tile_to_shape = cute.tile_to_shape(%lay_68, %shape_69, %int_tuple_70) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">, !cute.shape<"(128,128)">, !cute.int_tuple<"(0,1)">) -> !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %tile_to_shape_73 = cute.tile_to_shape(%lay_68, %shape_71, %int_tuple_72) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">, !cute.shape<"(64,128)">, !cute.int_tuple<"(0,1)">) -> !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %cosz = cute.cosize(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384">
    %e0_74 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384">
    %cosz_75 = cute.cosize(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_76 = cute.get_leaves(%cosz_75) : !cute.int_tuple<"8192">
    %cosz_77 = cute.cosize(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_78 = cute.get_leaves(%cosz_77) : !cute.int_tuple<"8192">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>
    %atom_79 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %38 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %39 = cute.get_shape(%38) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_80, %e1_81 = cute.get_leaves(%39) : !cute.shape<"(8,64)">
    %shape_82 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_83 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_84 = cute.make_layout(%shape_82, %stride_83) : !cute.layout<"(16,8):(8,1)">
    %shape_85 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_86 = cute.make_layout(%shape_85) : !cute.layout<"(1,8):(0,1)">
    %prod = cute.raked_product(%lay_84, %lay_86) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_84) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_87 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_88 = cute.size(%lay_86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_89 = cute.get_leaves(%sz_88) : !cute.int_tuple<"8">
    %shape_90 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_91 = cute.make_layout(%shape_90) : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %40 = cute.composition(%rinv, %lay_91) : (!cute.layout<"(8,128):(128,1)">, !cute.layout<"(128,8):(1,128)">) -> !cute.layout<"((8,16),8):((128,1),16)">
    %41 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_92, %e1_93, %e2_94 = cute.get_leaves(%41) : !cute.shape<"(16,(8,8))">
    %int_tuple_95 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res = cute.tuple.product_each(%int_tuple_95) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_96, %e1_97 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)">
    %int_tuple_98 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_99 = cute.tuple.product_each(%int_tuple_98) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_100, %e1_101 = cute.get_leaves(%res_99) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %42 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %prod_102 = cute.raked_product(%lay_84, %lay_86) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_103 = cute.size(%lay_84) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_104 = cute.get_leaves(%sz_103) : !cute.int_tuple<"128">
    %sz_105 = cute.size(%lay_86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"8">
    %shape_107 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_108 = cute.make_layout(%shape_107) : !cute.layout<"(128,8):(1,128)">
    %rinv_109 = cute.right_inverse(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %43 = cute.composition(%rinv_109, %lay_108) : (!cute.layout<"(8,128):(128,1)">, !cute.layout<"(128,8):(1,128)">) -> !cute.layout<"((8,16),8):((128,1),16)">
    %44 = cute.get_shape(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_110, %e1_111, %e2_112 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))">
    %int_tuple_113 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res_114 = cute.tuple.product_each(%int_tuple_113) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_115, %e1_116 = cute.get_leaves(%res_114) : !cute.int_tuple<"(16,64)">
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_118 = cute.tuple.product_each(%int_tuple_117) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_119, %e1_120 = cute.get_leaves(%res_118) : !cute.int_tuple<"(16,64)">
    %tile_121 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %45 = cute.make_tiled_copy(%atom_79) : !copy_simt
    %shape_122 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_123 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_124 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_125 = cute.make_layout(%shape_124) : !cute.layout<"(4,1,1):(1,0,0)">
    %46 = cute.get_shape(%lay_125) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_126, %e1_127, %e2_128 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)">
    %tile_129 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %47 = cute.make_tiled_mma(%atom_123) : !mma_bf16_bf16_f32_16x8x16_
    %lay_130 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %48 = cute.get_shape(%lay_130) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_131, %e1_132, %e2_133, %e3_134 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_135 = cute.to_int_tuple(%e0_131) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %49 = cute.get_scalars(%itup_135) : !cute.int_tuple<"?">
    %itup_136 = cute.to_int_tuple(%e1_132) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %50 = cute.get_scalars(%itup_136) : !cute.int_tuple<"?">
    %itup_137 = cute.to_int_tuple(%e2_133) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %51 = cute.get_scalars(%itup_137) : !cute.int_tuple<"?">
    %itup_138 = cute.to_int_tuple(%e3_134) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %52 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?{div=8}">
    %int_tuple_139 = cute.make_int_tuple(%itup_136) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_140 = cute.make_tile() : () -> !cute.tile<"128:1">
    %shp = cute.ceil_div(%int_tuple_139, %tile_140) : !cute.int_tuple<"?">, !cute.tile<"128:1">
    %e0_141 = cute.get_leaves(%shp) : !cute.int_tuple<"?">
    %53 = cute.get_scalars(%e0_141) : !cute.int_tuple<"?">
    %int_tuple_142 = cute.make_int_tuple(%itup_135) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_143 = cute.size(%int_tuple_142) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_144 = cute.get_leaves(%sz_143) : !cute.int_tuple<"?">
    %54 = cute.get_scalars(%e0_144) : !cute.int_tuple<"?">
    %int_tuple_145 = cute.make_int_tuple(%itup_137) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_146 = cute.size(%int_tuple_145) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_147 = cute.get_leaves(%sz_146) : !cute.int_tuple<"?">
    %55 = cute.get_scalars(%e0_147) : !cute.int_tuple<"?">
    %cst = arith.constant 1.44269502 : f32
    %56 = arith.mulf %arg4, %cst : f32
    %lay_148 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %57 = cute.get_shape(%lay_148) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_149, %e1_150, %e2_151, %e3_152 = cute.get_leaves(%57) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_153 = cute.to_int_tuple(%e0_149) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %58 = cute.get_scalars(%itup_153) : !cute.int_tuple<"?">
    %itup_154 = cute.to_int_tuple(%e1_150) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %59 = cute.get_scalars(%itup_154) : !cute.int_tuple<"?">
    %itup_155 = cute.to_int_tuple(%e2_151) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_155) : !cute.int_tuple<"?">
    %itup_156 = cute.to_int_tuple(%e3_152) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %61 = cute.get_scalars(%itup_156) : !cute.int_tuple<"?{div=8}">
    %62 = cute.get_stride(%lay_148) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_157, %e1_158, %e2_159, %e3_160 = cute.get_leaves(%62) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_161 = cute.to_int_tuple(%e0_157) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %63 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?{i64 div=8}">
    %itup_162 = cute.to_int_tuple(%e1_158) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %64 = cute.get_scalars(%itup_162) : !cute.int_tuple<"?{i64 div=8}">
    %itup_163 = cute.to_int_tuple(%e2_159) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %65 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{i64 div=8}">
    %lay_164 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %66 = cute.get_shape(%lay_164) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_165, %e1_166, %e2_167, %e3_168 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_169 = cute.to_int_tuple(%e0_165) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %67 = cute.get_scalars(%itup_169) : !cute.int_tuple<"?">
    %itup_170 = cute.to_int_tuple(%e1_166) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %68 = cute.get_scalars(%itup_170) : !cute.int_tuple<"?">
    %itup_171 = cute.to_int_tuple(%e2_167) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?">
    %itup_172 = cute.to_int_tuple(%e3_168) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %70 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?{div=8}">
    %71 = cute.get_stride(%lay_164) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_173, %e1_174, %e2_175, %e3_176 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_177 = cute.to_int_tuple(%e0_173) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %72 = cute.get_scalars(%itup_177) : !cute.int_tuple<"?{i64 div=8}">
    %itup_178 = cute.to_int_tuple(%e1_174) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %73 = cute.get_scalars(%itup_178) : !cute.int_tuple<"?{i64 div=8}">
    %itup_179 = cute.to_int_tuple(%e2_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}">
    %lay_180 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %75 = cute.get_shape(%lay_180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_181, %e1_182, %e2_183, %e3_184 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_185 = cute.to_int_tuple(%e0_181) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %76 = cute.get_scalars(%itup_185) : !cute.int_tuple<"?">
    %itup_186 = cute.to_int_tuple(%e1_182) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %77 = cute.get_scalars(%itup_186) : !cute.int_tuple<"?">
    %itup_187 = cute.to_int_tuple(%e2_183) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?">
    %itup_188 = cute.to_int_tuple(%e3_184) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %79 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?{div=8}">
    %80 = cute.get_stride(%lay_180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_189, %e1_190, %e2_191, %e3_192 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_193 = cute.to_int_tuple(%e0_189) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %81 = cute.get_scalars(%itup_193) : !cute.int_tuple<"?{i64 div=8}">
    %itup_194 = cute.to_int_tuple(%e1_190) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %82 = cute.get_scalars(%itup_194) : !cute.int_tuple<"?{i64 div=8}">
    %itup_195 = cute.to_int_tuple(%e2_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}">
    %lay_196 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %84 = cute.get_shape(%lay_196) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_197, %e1_198, %e2_199, %e3_200 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_201 = cute.to_int_tuple(%e0_197) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %85 = cute.get_scalars(%itup_201) : !cute.int_tuple<"?">
    %itup_202 = cute.to_int_tuple(%e1_198) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %86 = cute.get_scalars(%itup_202) : !cute.int_tuple<"?">
    %itup_203 = cute.to_int_tuple(%e2_199) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?">
    %itup_204 = cute.to_int_tuple(%e3_200) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %88 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?{div=8}">
    %89 = cute.get_stride(%lay_196) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_205, %e1_206, %e2_207, %e3_208 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_209 = cute.to_int_tuple(%e0_205) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %90 = cute.get_scalars(%itup_209) : !cute.int_tuple<"?{i64 div=8}">
    %itup_210 = cute.to_int_tuple(%e1_206) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %91 = cute.get_scalars(%itup_210) : !cute.int_tuple<"?{i64 div=8}">
    %itup_211 = cute.to_int_tuple(%e2_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}">
    %93 = cute.composed_get_inner(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %94 = cute.composed_get_offset(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_212 = cute.get_leaves(%94) : !cute.int_tuple<"0">
    %95 = cute.composed_get_outer(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %96 = cute.get_shape(%95) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_213, %e1_214, %e2_215, %e3_216 = cute.get_leaves(%96) : !cute.shape<"((8,16),(64,2))">
    %97 = cute.get_stride(%95) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%97) : !cute.stride<"((64,512),(1,8192))">
    %98 = cute.composed_get_inner(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
    %99 = cute.composed_get_offset(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_221 = cute.get_leaves(%99) : !cute.int_tuple<"0">
    %100 = cute.composed_get_outer(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %101 = cute.get_shape(%100) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_222, %e1_223, %e2_224, %e3_225 = cute.get_leaves(%101) : !cute.shape<"((8,8),(64,2))">
    %102 = cute.get_stride(%100) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_226, %e1_227, %e2_228, %e3_229 = cute.get_leaves(%102) : !cute.stride<"((64,512),(1,4096))">
    %103 = cute.composed_get_inner(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %104 = cute.composed_get_offset(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_230 = cute.get_leaves(%104) : !cute.int_tuple<"0">
    %105 = cute.composed_get_outer(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %106 = cute.get_shape(%105) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_231, %e1_232, %e2_233, %e3_234 = cute.get_leaves(%106) : !cute.shape<"((8,16),(64,2))">
    %107 = cute.get_stride(%105) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_235, %e1_236, %e2_237, %e3_238 = cute.get_leaves(%107) : !cute.stride<"((64,512),(1,8192))">
    %108 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_239, %e1_240 = cute.get_leaves(%108) : !cute.tile<"[16:1;64:1]">
    %109 = cute.get_shape(%e0_239) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_241 = cute.get_leaves(%109) : !cute.shape<"16">
    %110 = cute.get_stride(%e0_239) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_242 = cute.get_leaves(%110) : !cute.stride<"1">
    %111 = cute.get_shape(%e1_240) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_243 = cute.get_leaves(%111) : !cute.shape<"64">
    %112 = cute.get_stride(%e1_240) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_244 = cute.get_leaves(%112) : !cute.stride<"1">
    %113 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_245, %e1_246, %e2_247 = cute.get_leaves(%114) : !cute.shape<"((8,16),8)">
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_248, %e1_249, %e2_250 = cute.get_leaves(%115) : !cute.stride<"((128,1),16)">
    %116 = cute.static : !cute.layout<"1:0">
    %117 = cute.get_shape(%116) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_251 = cute.get_leaves(%117) : !cute.shape<"1">
    %118 = cute.get_stride(%116) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_252 = cute.get_leaves(%118) : !cute.stride<"0">
    %119 = cute.static : !cute.layout<"(1,8):(0,1)">
    %120 = cute.get_shape(%119) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_253, %e1_254 = cute.get_leaves(%120) : !cute.shape<"(1,8)">
    %121 = cute.get_stride(%119) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_255, %e1_256 = cute.get_leaves(%121) : !cute.stride<"(0,1)">
    %122 = cute.static : !cute.layout<"(1,8):(0,1)">
    %123 = cute.get_shape(%122) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_257, %e1_258 = cute.get_leaves(%123) : !cute.shape<"(1,8)">
    %124 = cute.get_stride(%122) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_259, %e1_260 = cute.get_leaves(%124) : !cute.stride<"(0,1)">
    %125 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_261, %e1_262 = cute.get_leaves(%125) : !cute.tile<"[16:1;64:1]">
    %126 = cute.get_shape(%e0_261) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_263 = cute.get_leaves(%126) : !cute.shape<"16">
    %127 = cute.get_stride(%e0_261) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_264 = cute.get_leaves(%127) : !cute.stride<"1">
    %128 = cute.get_shape(%e1_262) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_265 = cute.get_leaves(%128) : !cute.shape<"64">
    %129 = cute.get_stride(%e1_262) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_266 = cute.get_leaves(%129) : !cute.stride<"1">
    %130 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %131 = cute.get_shape(%130) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_267, %e1_268, %e2_269 = cute.get_leaves(%131) : !cute.shape<"((8,16),8)">
    %132 = cute.get_stride(%130) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_270, %e1_271, %e2_272 = cute.get_leaves(%132) : !cute.stride<"((128,1),16)">
    %133 = cute.static : !cute.layout<"1:0">
    %134 = cute.get_shape(%133) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_273 = cute.get_leaves(%134) : !cute.shape<"1">
    %135 = cute.get_stride(%133) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_274 = cute.get_leaves(%135) : !cute.stride<"0">
    %136 = cute.static : !cute.layout<"(1,8):(0,1)">
    %137 = cute.get_shape(%136) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_275, %e1_276 = cute.get_leaves(%137) : !cute.shape<"(1,8)">
    %138 = cute.get_stride(%136) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_277, %e1_278 = cute.get_leaves(%138) : !cute.stride<"(0,1)">
    %139 = cute.static : !cute.layout<"(1,8):(0,1)">
    %140 = cute.get_shape(%139) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_279, %e1_280 = cute.get_leaves(%140) : !cute.shape<"(1,8)">
    %141 = cute.get_stride(%139) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_281, %e1_282 = cute.get_leaves(%141) : !cute.stride<"(0,1)">
    %142 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %143 = cute.get_shape(%142) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_283, %e1_284, %e2_285, %e3_286 = cute.get_leaves(%143) : !cute.shape<"(32,4,1,1)">
    %144 = cute.get_stride(%142) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_287, %e1_288, %e2_289, %e3_290 = cute.get_leaves(%144) : !cute.stride<"(1,32,0,0)">
    %145 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_291, %e1_292, %e2_293 = cute.get_leaves(%145) : !cute.tile<"[64:1;16:1;16:1]">
    %146 = cute.get_shape(%e0_291) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_294 = cute.get_leaves(%146) : !cute.shape<"64">
    %147 = cute.get_stride(%e0_291) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_295 = cute.get_leaves(%147) : !cute.stride<"1">
    %148 = cute.get_shape(%e1_292) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_296 = cute.get_leaves(%148) : !cute.shape<"16">
    %149 = cute.get_stride(%e1_292) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_297 = cute.get_leaves(%149) : !cute.stride<"1">
    %150 = cute.get_shape(%e2_293) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_298 = cute.get_leaves(%150) : !cute.shape<"16">
    %151 = cute.get_stride(%e2_293) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_299 = cute.get_leaves(%151) : !cute.stride<"1">
    %152 = cute.static : !cute.layout<"32:1">
    %153 = cute.get_shape(%152) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_300 = cute.get_leaves(%153) : !cute.shape<"32">
    %154 = cute.get_stride(%152) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_301 = cute.get_leaves(%154) : !cute.stride<"1">
    %155 = cute.static : !cute.shape<"(16,8,16)">
    %e0_302, %e1_303, %e2_304 = cute.get_leaves(%155) : !cute.shape<"(16,8,16)">
    %156 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %157 = cute.get_shape(%156) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_305, %e1_306, %e2_307, %e3_308, %e4 = cute.get_leaves(%157) : !cute.shape<"((4,8),(2,2,2))">
    %158 = cute.get_stride(%156) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_309, %e1_310, %e2_311, %e3_312, %e4_313 = cute.get_leaves(%158) : !cute.stride<"((32,1),(16,8,128))">
    %159 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %160 = cute.get_shape(%159) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_314, %e1_315, %e2_316, %e3_317 = cute.get_leaves(%160) : !cute.shape<"((4,8),(2,2))">
    %161 = cute.get_stride(%159) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_318, %e1_319, %e2_320, %e3_321 = cute.get_leaves(%161) : !cute.stride<"((16,1),(8,64))">
    %162 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %163 = cute.get_shape(%162) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_322, %e1_323, %e2_324, %e3_325 = cute.get_leaves(%163) : !cute.shape<"((4,8),(2,2))">
    %164 = cute.get_stride(%162) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%164) : !cute.stride<"((32,1),(16,8))">
    %165 = arith.index_cast %53 : i32 to index
    %166 = arith.index_cast %54 : i32 to index
    %167 = arith.index_cast %55 : i32 to index
    %c128 = arith.constant 128 : index
    %c1 = arith.constant 1 : index
    %c65536_i32 = arith.constant 65536 : i32
    %168 = gpu.launch_func async [%arg5] @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0 blocks in (%165, %166, %167) threads in (%c128, %c1, %c1)  dynamic_shared_memory_size %c65536_i32 args(%arg0 : !memref_gmem_bf16_, %arg1 : !memref_gmem_bf16_, %arg2 : !memref_gmem_bf16_, %arg3 : !memref_gmem_bf16_, %56 : f32) {use_pdl = false}
    return
  }
}
