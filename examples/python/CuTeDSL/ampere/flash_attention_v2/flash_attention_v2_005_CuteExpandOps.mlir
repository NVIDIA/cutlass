!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "(((2,2),2)):(((1,2),8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<8>, "((1,(4,2))):((0,(1,8)))">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<32>, "(4):(1)">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_11 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_12 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_5 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2))):((0,(1,512,?{div=8})))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    func.func public @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32) attributes {cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %1 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %3 = cute.static : !copy_ldgsts
      %4 = cute.static : !copy_simt
      %5 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %6 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%6) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %7 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %10 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
      %11 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%11) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %12 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %15 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%15) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %16 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %19 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
      %20 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%20) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %21 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %24 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%24) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %25 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %28 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
      %29 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%29) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %30 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %33 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%33) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %34 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %37 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
      %38 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%38) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %39 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %43 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_65 = cute.get_leaves(%43) : !cute.int_tuple<"0">
      %44 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %45 = cute.get_shape(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%45) : !cute.shape<"((8,16),(64,2))">
      %46 = cute.get_stride(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%46) : !cute.stride<"((64,512),(1,8192))">
      %47 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
      %48 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_74 = cute.get_leaves(%48) : !cute.int_tuple<"0">
      %49 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %50 = cute.get_shape(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%50) : !cute.shape<"((8,8),(64,2))">
      %51 = cute.get_stride(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%51) : !cute.stride<"((64,512),(1,4096))">
      %52 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %53 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,16),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,8192))">
      %57 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_92, %e1_93 = cute.get_leaves(%57) : !cute.tile<"[16:1;64:1]">
      %58 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_94 = cute.get_leaves(%58) : !cute.shape<"16">
      %59 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_95 = cute.get_leaves(%59) : !cute.stride<"1">
      %60 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_96 = cute.get_leaves(%60) : !cute.shape<"64">
      %61 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_97 = cute.get_leaves(%61) : !cute.stride<"1">
      %62 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %63 = cute.get_shape(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%63) : !cute.shape<"((8,16),8)">
      %64 = cute.get_stride(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%64) : !cute.stride<"((128,1),16)">
      %65 = cute.static : !cute.layout<"1:0">
      %66 = cute.get_shape(%65) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_104 = cute.get_leaves(%66) : !cute.shape<"1">
      %67 = cute.get_stride(%65) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_105 = cute.get_leaves(%67) : !cute.stride<"0">
      %68 = cute.static : !cute.layout<"(1,8):(0,1)">
      %69 = cute.get_shape(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_106, %e1_107 = cute.get_leaves(%69) : !cute.shape<"(1,8)">
      %70 = cute.get_stride(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_108, %e1_109 = cute.get_leaves(%70) : !cute.stride<"(0,1)">
      %71 = cute.static : !cute.layout<"(1,8):(0,1)">
      %72 = cute.get_shape(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_110, %e1_111 = cute.get_leaves(%72) : !cute.shape<"(1,8)">
      %73 = cute.get_stride(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_112, %e1_113 = cute.get_leaves(%73) : !cute.stride<"(0,1)">
      %74 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_114, %e1_115 = cute.get_leaves(%74) : !cute.tile<"[16:1;64:1]">
      %75 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_116 = cute.get_leaves(%75) : !cute.shape<"16">
      %76 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_117 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_118 = cute.get_leaves(%77) : !cute.shape<"64">
      %78 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_119 = cute.get_leaves(%78) : !cute.stride<"1">
      %79 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %80 = cute.get_shape(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%80) : !cute.shape<"((8,16),8)">
      %81 = cute.get_stride(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%81) : !cute.stride<"((128,1),16)">
      %82 = cute.static : !cute.layout<"1:0">
      %83 = cute.get_shape(%82) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_126 = cute.get_leaves(%83) : !cute.shape<"1">
      %84 = cute.get_stride(%82) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_127 = cute.get_leaves(%84) : !cute.stride<"0">
      %85 = cute.static : !cute.layout<"(1,8):(0,1)">
      %86 = cute.get_shape(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_128, %e1_129 = cute.get_leaves(%86) : !cute.shape<"(1,8)">
      %87 = cute.get_stride(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_130, %e1_131 = cute.get_leaves(%87) : !cute.stride<"(0,1)">
      %88 = cute.static : !cute.layout<"(1,8):(0,1)">
      %89 = cute.get_shape(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_132, %e1_133 = cute.get_leaves(%89) : !cute.shape<"(1,8)">
      %90 = cute.get_stride(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_134, %e1_135 = cute.get_leaves(%90) : !cute.stride<"(0,1)">
      %91 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %92 = cute.get_shape(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%92) : !cute.shape<"(32,4,1,1)">
      %93 = cute.get_stride(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%93) : !cute.stride<"(1,32,0,0)">
      %94 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%94) : !cute.tile<"[64:1;16:1;16:1]">
      %95 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_147 = cute.get_leaves(%95) : !cute.shape<"64">
      %96 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_148 = cute.get_leaves(%96) : !cute.stride<"1">
      %97 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_149 = cute.get_leaves(%97) : !cute.shape<"16">
      %98 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_150 = cute.get_leaves(%98) : !cute.stride<"1">
      %99 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_151 = cute.get_leaves(%99) : !cute.shape<"16">
      %100 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_152 = cute.get_leaves(%100) : !cute.stride<"1">
      %101 = cute.static : !cute.layout<"32:1">
      %102 = cute.get_shape(%101) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_153 = cute.get_leaves(%102) : !cute.shape<"32">
      %103 = cute.get_stride(%101) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_154 = cute.get_leaves(%103) : !cute.stride<"1">
      %104 = cute.static : !cute.shape<"(16,8,16)">
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%104) : !cute.shape<"(16,8,16)">
      %105 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2,2))">
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8,128))">
      %108 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %109 = cute.get_shape(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%109) : !cute.shape<"((4,8),(2,2))">
      %110 = cute.get_stride(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%110) : !cute.stride<"((16,1),(8,64))">
      %111 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %112 = cute.get_shape(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%112) : !cute.shape<"((4,8),(2,2))">
      %113 = cute.get_stride(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%113) : !cute.stride<"((32,1),(16,8))">
      %114 = nvvm.read.ptx.sreg.tid.x : i32
      %115 = nvvm.read.ptx.sreg.tid.y : i32
      %116 = nvvm.read.ptx.sreg.tid.z : i32
      %117 = nvvm.read.ptx.sreg.ctaid.x : i32
      %118 = nvvm.read.ptx.sreg.ctaid.y : i32
      %119 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %120 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%120) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %121 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %122 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %123 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %124 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %125 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %126 = arith.ceildivsi %125, %c64_i32 : i32
      %int_tuple_192 = cute.make_int_tuple(%126) : (i32) -> !cute.int_tuple<"?">
      %e0_193 = cute.get_leaves(%int_tuple_192) : !cute.int_tuple<"?">
      %127 = cute.get_scalars(%e0_193) : !cute.int_tuple<"?">
      %false = arith.constant false
      %128 = scf.if %false -> (i32) {
        %c1_i32_8494 = arith.constant 1 : i32
        %3370 = arith.addi %117, %c1_i32_8494 : i32
        %c128_i32_8495 = arith.constant 128 : i32
        %3371 = arith.muli %3370, %c128_i32_8495 : i32
        %int_tuple_8496 = cute.make_int_tuple(%3371) : (i32) -> !cute.int_tuple<"?">
        %tile_8497 = cute.make_tile() : () -> !cute.tile<"64:1">
        %3372 = cute.get_scalars(%int_tuple_8496) <{only_dynamic}> : !cute.int_tuple<"?">
        %c64_i32_8498 = arith.constant 64 : i32
        %3373 = arith.ceildivsi %3372, %c64_i32_8498 : i32
        %int_tuple_8499 = cute.make_int_tuple(%3373) : (i32) -> !cute.int_tuple<"?">
        %e0_8500 = cute.get_leaves(%int_tuple_8499) : !cute.int_tuple<"?">
        %3374 = cute.get_scalars(%e0_8500) : !cute.int_tuple<"?">
        %3375 = arith.minsi %3374, %127 : i32
        scf.yield %3375 : i32
      } else {
        scf.yield %127 : i32
      }
      %c1_i32 = arith.constant 1 : i32
      %129 = arith.subi %128, %c1_i32 : i32
      %coord = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_194 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %130:7 = cute.get_scalars(%lay_194) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %131:2 = cute.get_scalars(%coord) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv = cute.assume(%130#3) : (i32) -> !cute.i32<divby 8>
      %shape = cute.make_shape(%130#1, %iv) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_195 = cute.assume(%130#5) : (i64) -> !cute.i64<divby 8>
      %stride = cute.make_stride(%iv_195) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_196 = cute.make_layout(%shape, %stride) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx = cute.crd2idx(%coord, %lay_194) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_197 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_197, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %lay_196) : !memref_gmem_bf16_1
      %iter_198 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_199 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_200 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %132 = cute.get_scalars(%coord_200) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_201 = cute.make_coord(%132) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_202 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %133:3 = cute.get_scalars(%lay_202) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32 = arith.constant 128 : i32
      %134 = arith.ceildivsi %133#0, %c128_i32 : i32
      %c128_i64 = arith.constant 128 : i64
      %135 = arith.muli %133#2, %c128_i64 : i64
      %c128_i32_203 = arith.constant 128 : i32
      %136 = arith.ceildivsi %133#1, %c128_i32_203 : i32
      %shape_204 = cute.make_shape(%134, %136) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_205 = cute.assume(%133#2) : (i64) -> !cute.i64<divby 8>
      %iv_206 = cute.assume(%135) : (i64) -> !cute.i64<divby 1024>
      %stride_207 = cute.make_stride(%iv_205, %iv_206) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_208 = cute.make_layout(%shape_204, %stride_207) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %137:4 = cute.get_scalars(%lay_208) <{only_dynamic}> : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %138 = cute.get_scalars(%coord_201) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_209 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %iv_210 = cute.assume(%137#2) : (i64) -> !cute.i64<divby 8>
      %stride_211 = cute.make_stride(%iv_210) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_212 = cute.make_layout(%shape_209, %stride_211) : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %idx_213 = cute.crd2idx(%coord_201, %lay_208) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_214 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_215 = cute.add_offset(%iter_214, %idx_213) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_216 = cute.make_view(%ptr_215, %lay_212) : !memref_gmem_bf16_2
      %iter_217 = cute.get_iter(%view_216) : !memref_gmem_bf16_2
      %coord_218 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_219 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %139:7 = cute.get_scalars(%lay_219) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %140:2 = cute.get_scalars(%coord_218) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_220 = cute.assume(%139#3) : (i32) -> !cute.i32<divby 8>
      %shape_221 = cute.make_shape(%139#1, %iv_220) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_222 = cute.assume(%139#5) : (i64) -> !cute.i64<divby 8>
      %stride_223 = cute.make_stride(%iv_222) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_224 = cute.make_layout(%shape_221, %stride_223) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_225 = cute.crd2idx(%coord_218, %lay_219) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_226 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_227 = cute.add_offset(%iter_226, %idx_225) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_228 = cute.make_view(%ptr_227, %lay_224) : !memref_gmem_bf16_1
      %iter_229 = cute.get_iter(%view_228) : !memref_gmem_bf16_1
      %tile_230 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_231 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_232 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_233 = cute.get_layout(%view_228) : !memref_gmem_bf16_1
      %141:3 = cute.get_scalars(%lay_233) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_234 = arith.constant 64 : i32
      %142 = arith.ceildivsi %141#0, %c64_i32_234 : i32
      %c64_i64 = arith.constant 64 : i64
      %143 = arith.muli %141#2, %c64_i64 : i64
      %c128_i32_235 = arith.constant 128 : i32
      %144 = arith.ceildivsi %141#1, %c128_i32_235 : i32
      %shape_236 = cute.make_shape(%142, %144) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_237 = cute.assume(%141#2) : (i64) -> !cute.i64<divby 8>
      %iv_238 = cute.assume(%143) : (i64) -> !cute.i64<divby 512>
      %stride_239 = cute.make_stride(%iv_237, %iv_238) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_240 = cute.make_layout(%shape_236, %stride_239) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %145:4 = cute.get_scalars(%lay_240) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_241 = cute.make_shape(%145#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_242 = cute.assume(%145#2) : (i64) -> !cute.i64<divby 8>
      %iv_243 = cute.assume(%145#3) : (i64) -> !cute.i64<divby 512>
      %stride_244 = cute.make_stride(%iv_242, %iv_243) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_245 = cute.make_layout(%shape_241, %stride_244) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_246 = cute.crd2idx(%coord_232, %lay_240) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_247 = cute.get_iter(%view_228) : !memref_gmem_bf16_1
      %ptr_248 = cute.add_offset(%iter_247, %idx_246) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_249 = cute.make_view(%ptr_248, %lay_245) : !memref_gmem_bf16_3
      %iter_250 = cute.get_iter(%view_249) : !memref_gmem_bf16_3
      %coord_251 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_252 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %146:7 = cute.get_scalars(%lay_252) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %147:2 = cute.get_scalars(%coord_251) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_253 = cute.assume(%146#3) : (i32) -> !cute.i32<divby 8>
      %shape_254 = cute.make_shape(%146#1, %iv_253) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_255 = cute.assume(%146#5) : (i64) -> !cute.i64<divby 8>
      %stride_256 = cute.make_stride(%iv_255) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_257 = cute.make_layout(%shape_254, %stride_256) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_258 = cute.crd2idx(%coord_251, %lay_252) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_259 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_260 = cute.add_offset(%iter_259, %idx_258) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_261 = cute.make_view(%ptr_260, %lay_257) : !memref_gmem_bf16_1
      %iter_262 = cute.get_iter(%view_261) : !memref_gmem_bf16_1
      %tile_263 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_264 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_265 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_266 = cute.get_layout(%view_261) : !memref_gmem_bf16_1
      %148:3 = cute.get_scalars(%lay_266) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_267 = arith.constant 64 : i32
      %149 = arith.ceildivsi %148#0, %c64_i32_267 : i32
      %c64_i64_268 = arith.constant 64 : i64
      %150 = arith.muli %148#2, %c64_i64_268 : i64
      %c128_i32_269 = arith.constant 128 : i32
      %151 = arith.ceildivsi %148#1, %c128_i32_269 : i32
      %shape_270 = cute.make_shape(%149, %151) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_271 = cute.assume(%148#2) : (i64) -> !cute.i64<divby 8>
      %iv_272 = cute.assume(%150) : (i64) -> !cute.i64<divby 512>
      %stride_273 = cute.make_stride(%iv_271, %iv_272) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_274 = cute.make_layout(%shape_270, %stride_273) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %152:4 = cute.get_scalars(%lay_274) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_275 = cute.make_shape(%152#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_276 = cute.assume(%152#2) : (i64) -> !cute.i64<divby 8>
      %iv_277 = cute.assume(%152#3) : (i64) -> !cute.i64<divby 512>
      %stride_278 = cute.make_stride(%iv_276, %iv_277) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_279 = cute.make_layout(%shape_275, %stride_278) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_280 = cute.crd2idx(%coord_265, %lay_274) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_281 = cute.get_iter(%view_261) : !memref_gmem_bf16_1
      %ptr_282 = cute.add_offset(%iter_281, %idx_280) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_283 = cute.make_view(%ptr_282, %lay_279) : !memref_gmem_bf16_3
      %iter_284 = cute.get_iter(%view_283) : !memref_gmem_bf16_3
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_285 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536">
      %ptr_286 = cute.add_offset(%smem_ptr, %int_tuple_285) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c65536_i32 = arith.constant 65536 : i32
      %153 = arith.cmpi sge, %smem_size, %c65536_i32 : i32
      %int_tuple_287 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_288 = cute.add_offset(%smem_ptr, %int_tuple_287) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_289 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_290 = cute.add_offset(%smem_ptr, %int_tuple_289) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_291 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_292 = cute.add_offset(%smem_ptr, %int_tuple_291) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_293 = cute.recast_iter(%ptr_288) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_294 = cute.make_view(%iter_293, %0) : !memref_smem_bf16_
      %iter_295 = cute.get_iter(%view_294) : !memref_smem_bf16_
      %iter_296 = cute.recast_iter(%ptr_290) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_297 = cute.make_view(%iter_296, %1) : !memref_smem_bf16_1
      %iter_298 = cute.get_iter(%view_297) : !memref_smem_bf16_1
      %iter_299 = cute.recast_iter(%ptr_292) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_300 = cute.make_view(%iter_299, %1) : !memref_smem_bf16_1
      %iter_301 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %shape_302 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_303 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_304 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_305 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %view_306 = cute.make_view(%iter_305) : !memref_smem_bf16_2
      %iter_307 = cute.get_iter(%view_306) : !memref_smem_bf16_2
      %coord_308 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_309 = cute.get_iter(%view_216) : !memref_gmem_bf16_2
      %lay_310 = cute.get_layout(%view_216) : !memref_gmem_bf16_2
      %154 = cute.get_scalars(%lay_310) <{only_dynamic}> : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %155 = cute.get_scalars(%coord_308) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64 = arith.constant 16 : i64
      %156 = arith.muli %154, %c16_i64 : i64
      %c128_i64_311 = arith.constant 128 : i64
      %157 = arith.muli %154, %c128_i64_311 : i64
      %c16_i64_312 = arith.constant 16 : i64
      %158 = arith.muli %154, %c16_i64_312 : i64
      %c8_i32 = arith.constant 8 : i32
      %159 = arith.divsi %155, %c8_i32 : i32
      %c8_i32_313 = arith.constant 8 : i32
      %160 = arith.remsi %155, %c8_i32_313 : i32
      %c8_i32_314 = arith.constant 8 : i32
      %161 = arith.muli %160, %c8_i32_314 : i32
      %162 = arith.extsi %159 : i32 to i64
      %163 = arith.muli %162, %154 : i64
      %164 = arith.extsi %161 : i32 to i64
      %165 = arith.addi %164, %163 : i64
      %iv_315 = cute.assume(%165) : (i64) -> !cute.i64<divby 8>
      %int_tuple_316 = cute.make_int_tuple(%iv_315) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_317 = cute.add_offset(%iter_309, %int_tuple_316) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_318 = cute.make_shape() : () -> !cute.shape<"((8,1),8,2)">
      %iv_319 = cute.assume(%156) : (i64) -> !cute.i64<divby 128>
      %stride_320 = cute.make_stride(%iv_319) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_321 = cute.make_layout(%shape_318, %stride_320) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %view_322 = cute.make_view(%ptr_317, %lay_321) : !memref_gmem_bf16_4
      %iter_323 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
      %coord_324 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_325 = cute.get_iter(%view_294) : !memref_smem_bf16_
      %166 = cute.get_scalars(%coord_324) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_326 = arith.constant 8 : i32
      %167 = arith.divsi %166, %c8_i32_326 : i32
      %c8_i32_327 = arith.constant 8 : i32
      %168 = arith.remsi %166, %c8_i32_327 : i32
      %c8_i32_328 = arith.constant 8 : i32
      %169 = arith.muli %168, %c8_i32_328 : i32
      %c8_i32_329 = arith.constant 8 : i32
      %170 = arith.divsi %167, %c8_i32_329 : i32
      %c8_i32_330 = arith.constant 8 : i32
      %171 = arith.remsi %167, %c8_i32_330 : i32
      %c64_i32_331 = arith.constant 64 : i32
      %172 = arith.muli %171, %c64_i32_331 : i32
      %173 = arith.addi %169, %172 : i32
      %c0_i32 = arith.constant 0 : i32
      %174 = arith.xori %173, %c0_i32 : i32
      %c8_i32_332 = arith.constant 8 : i32
      %175 = arith.divsi %166, %c8_i32_332 : i32
      %c8_i32_333 = arith.constant 8 : i32
      %176 = arith.remsi %166, %c8_i32_333 : i32
      %c8_i32_334 = arith.constant 8 : i32
      %177 = arith.divsi %175, %c8_i32_334 : i32
      %c8_i32_335 = arith.constant 8 : i32
      %178 = arith.remsi %175, %c8_i32_335 : i32
      %c512_i32 = arith.constant 512 : i32
      %179 = arith.muli %177, %c512_i32 : i32
      %c64_i32_336 = arith.constant 64 : i32
      %180 = arith.andi %174, %c64_i32_336 : i32
      %c0_i32_337 = arith.constant 0 : i32
      %181 = arith.cmpi eq, %180, %c0_i32_337 : i32
      %182 = scf.if %181 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_338 = arith.constant 128 : i32
      %183 = arith.andi %174, %c128_i32_338 : i32
      %c0_i32_339 = arith.constant 0 : i32
      %184 = arith.cmpi eq, %183, %c0_i32_339 : i32
      %185 = scf.if %184 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32 = arith.constant 256 : i32
      %186 = arith.andi %174, %c256_i32 : i32
      %c0_i32_340 = arith.constant 0 : i32
      %187 = arith.cmpi eq, %186, %c0_i32_340 : i32
      %188 = scf.if %187 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_341 = arith.constant 8 : i32
      %189 = arith.andi %174, %c8_i32_341 : i32
      %c0_i32_342 = arith.constant 0 : i32
      %190 = arith.cmpi eq, %189, %c0_i32_342 : i32
      %191 = scf.if %190 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32 = arith.constant 16 : i32
      %192 = arith.andi %174, %c16_i32 : i32
      %c0_i32_343 = arith.constant 0 : i32
      %193 = arith.cmpi eq, %192, %c0_i32_343 : i32
      %194 = scf.if %193 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32 = arith.constant 32 : i32
      %195 = arith.andi %174, %c32_i32 : i32
      %c0_i32_344 = arith.constant 0 : i32
      %196 = arith.cmpi eq, %195, %c0_i32_344 : i32
      %197 = scf.if %196 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32 = arith.constant 448 : i32
      %198 = arith.andi %174, %c448_i32 : i32
      %c3_i32 = arith.constant 3 : i32
      %199 = arith.shrsi %198, %c3_i32 : i32
      %200 = arith.xori %174, %199 : i32
      %201 = arith.addi %200, %179 : i32
      %c128_i32_345 = arith.constant 128 : i32
      %202 = arith.muli %182, %c128_i32_345 : i32
      %c64_i32_346 = arith.constant 64 : i32
      %203 = arith.muli %185, %c64_i32_346 : i32
      %c32_i32_347 = arith.constant 32 : i32
      %204 = arith.muli %188, %c32_i32_347 : i32
      %c16_i32_348 = arith.constant 16 : i32
      %205 = arith.muli %191, %c16_i32_348 : i32
      %c8_i32_349 = arith.constant 8 : i32
      %206 = arith.muli %194, %c8_i32_349 : i32
      %c4_i32 = arith.constant 4 : i32
      %207 = arith.muli %197, %c4_i32 : i32
      %c1024_i32 = arith.constant 1024 : i32
      %208 = arith.muli %182, %c1024_i32 : i32
      %c512_i32_350 = arith.constant 512 : i32
      %209 = arith.muli %185, %c512_i32_350 : i32
      %c256_i32_351 = arith.constant 256 : i32
      %210 = arith.muli %188, %c256_i32_351 : i32
      %c128_i32_352 = arith.constant 128 : i32
      %211 = arith.muli %191, %c128_i32_352 : i32
      %c64_i32_353 = arith.constant 64 : i32
      %212 = arith.muli %194, %c64_i32_353 : i32
      %c32_i32_354 = arith.constant 32 : i32
      %213 = arith.muli %197, %c32_i32_354 : i32
      %iv_355 = cute.assume(%201) : (i32) -> !cute.i32<divby 8>
      %int_tuple_356 = cute.make_int_tuple(%iv_355) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_357 = cute.add_offset(%iter_325, %int_tuple_356) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_358 = cute.make_view(%ptr_357) : !memref_smem_bf16_3
      %iter_359 = cute.get_iter(%view_358) : !memref_smem_bf16_3
      %coord_360 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_361 = cute.get_iter(%view_249) : !memref_gmem_bf16_3
      %lay_362 = cute.get_layout(%view_249) : !memref_gmem_bf16_3
      %214:3 = cute.get_scalars(%lay_362) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %215 = cute.get_scalars(%coord_360) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_363 = arith.constant 16 : i64
      %216 = arith.muli %214#1, %c16_i64_363 : i64
      %c128_i64_364 = arith.constant 128 : i64
      %217 = arith.muli %214#1, %c128_i64_364 : i64
      %c16_i64_365 = arith.constant 16 : i64
      %218 = arith.muli %214#1, %c16_i64_365 : i64
      %c8_i32_366 = arith.constant 8 : i32
      %219 = arith.divsi %215, %c8_i32_366 : i32
      %c8_i32_367 = arith.constant 8 : i32
      %220 = arith.remsi %215, %c8_i32_367 : i32
      %c8_i32_368 = arith.constant 8 : i32
      %221 = arith.muli %220, %c8_i32_368 : i32
      %222 = arith.extsi %219 : i32 to i64
      %223 = arith.muli %222, %214#1 : i64
      %224 = arith.extsi %221 : i32 to i64
      %225 = arith.addi %224, %223 : i64
      %iv_369 = cute.assume(%225) : (i64) -> !cute.i64<divby 8>
      %int_tuple_370 = cute.make_int_tuple(%iv_369) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_371 = cute.add_offset(%iter_361, %int_tuple_370) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_372 = cute.make_shape(%214#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_373 = cute.assume(%216) : (i64) -> !cute.i64<divby 128>
      %iv_374 = cute.assume(%214#2) : (i64) -> !cute.i64<divby 512>
      %stride_375 = cute.make_stride(%iv_373, %iv_374) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_376 = cute.make_layout(%shape_372, %stride_375) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_377 = cute.make_view(%ptr_371, %lay_376) : !memref_gmem_bf16_5
      %iter_378 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
      %coord_379 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_380 = cute.get_iter(%view_297) : !memref_smem_bf16_1
      %226 = cute.get_scalars(%coord_379) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_381 = arith.constant 8 : i32
      %227 = arith.divsi %226, %c8_i32_381 : i32
      %c8_i32_382 = arith.constant 8 : i32
      %228 = arith.remsi %226, %c8_i32_382 : i32
      %c8_i32_383 = arith.constant 8 : i32
      %229 = arith.muli %228, %c8_i32_383 : i32
      %c8_i32_384 = arith.constant 8 : i32
      %230 = arith.divsi %227, %c8_i32_384 : i32
      %c8_i32_385 = arith.constant 8 : i32
      %231 = arith.remsi %227, %c8_i32_385 : i32
      %c64_i32_386 = arith.constant 64 : i32
      %232 = arith.muli %231, %c64_i32_386 : i32
      %233 = arith.addi %229, %232 : i32
      %c0_i32_387 = arith.constant 0 : i32
      %234 = arith.xori %233, %c0_i32_387 : i32
      %c8_i32_388 = arith.constant 8 : i32
      %235 = arith.divsi %226, %c8_i32_388 : i32
      %c8_i32_389 = arith.constant 8 : i32
      %236 = arith.remsi %226, %c8_i32_389 : i32
      %c8_i32_390 = arith.constant 8 : i32
      %237 = arith.divsi %235, %c8_i32_390 : i32
      %c8_i32_391 = arith.constant 8 : i32
      %238 = arith.remsi %235, %c8_i32_391 : i32
      %c512_i32_392 = arith.constant 512 : i32
      %239 = arith.muli %237, %c512_i32_392 : i32
      %c64_i32_393 = arith.constant 64 : i32
      %240 = arith.andi %234, %c64_i32_393 : i32
      %c0_i32_394 = arith.constant 0 : i32
      %241 = arith.cmpi eq, %240, %c0_i32_394 : i32
      %242 = scf.if %241 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_395 = arith.constant 128 : i32
      %243 = arith.andi %234, %c128_i32_395 : i32
      %c0_i32_396 = arith.constant 0 : i32
      %244 = arith.cmpi eq, %243, %c0_i32_396 : i32
      %245 = scf.if %244 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_397 = arith.constant 256 : i32
      %246 = arith.andi %234, %c256_i32_397 : i32
      %c0_i32_398 = arith.constant 0 : i32
      %247 = arith.cmpi eq, %246, %c0_i32_398 : i32
      %248 = scf.if %247 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_399 = arith.constant 8 : i32
      %249 = arith.andi %234, %c8_i32_399 : i32
      %c0_i32_400 = arith.constant 0 : i32
      %250 = arith.cmpi eq, %249, %c0_i32_400 : i32
      %251 = scf.if %250 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_401 = arith.constant 16 : i32
      %252 = arith.andi %234, %c16_i32_401 : i32
      %c0_i32_402 = arith.constant 0 : i32
      %253 = arith.cmpi eq, %252, %c0_i32_402 : i32
      %254 = scf.if %253 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_403 = arith.constant 32 : i32
      %255 = arith.andi %234, %c32_i32_403 : i32
      %c0_i32_404 = arith.constant 0 : i32
      %256 = arith.cmpi eq, %255, %c0_i32_404 : i32
      %257 = scf.if %256 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_405 = arith.constant 448 : i32
      %258 = arith.andi %234, %c448_i32_405 : i32
      %c3_i32_406 = arith.constant 3 : i32
      %259 = arith.shrsi %258, %c3_i32_406 : i32
      %260 = arith.xori %234, %259 : i32
      %261 = arith.addi %260, %239 : i32
      %c128_i32_407 = arith.constant 128 : i32
      %262 = arith.muli %242, %c128_i32_407 : i32
      %c64_i32_408 = arith.constant 64 : i32
      %263 = arith.muli %245, %c64_i32_408 : i32
      %c32_i32_409 = arith.constant 32 : i32
      %264 = arith.muli %248, %c32_i32_409 : i32
      %c16_i32_410 = arith.constant 16 : i32
      %265 = arith.muli %251, %c16_i32_410 : i32
      %c8_i32_411 = arith.constant 8 : i32
      %266 = arith.muli %254, %c8_i32_411 : i32
      %c4_i32_412 = arith.constant 4 : i32
      %267 = arith.muli %257, %c4_i32_412 : i32
      %c512_i32_413 = arith.constant 512 : i32
      %268 = arith.muli %242, %c512_i32_413 : i32
      %c256_i32_414 = arith.constant 256 : i32
      %269 = arith.muli %245, %c256_i32_414 : i32
      %c128_i32_415 = arith.constant 128 : i32
      %270 = arith.muli %248, %c128_i32_415 : i32
      %c64_i32_416 = arith.constant 64 : i32
      %271 = arith.muli %251, %c64_i32_416 : i32
      %c32_i32_417 = arith.constant 32 : i32
      %272 = arith.muli %254, %c32_i32_417 : i32
      %c16_i32_418 = arith.constant 16 : i32
      %273 = arith.muli %257, %c16_i32_418 : i32
      %iv_419 = cute.assume(%261) : (i32) -> !cute.i32<divby 8>
      %int_tuple_420 = cute.make_int_tuple(%iv_419) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_421 = cute.add_offset(%iter_380, %int_tuple_420) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_422 = cute.make_view(%ptr_421) : !memref_smem_bf16_4
      %iter_423 = cute.get_iter(%view_422) : !memref_smem_bf16_4
      %coord_424 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_425 = cute.get_iter(%view_283) : !memref_gmem_bf16_3
      %lay_426 = cute.get_layout(%view_283) : !memref_gmem_bf16_3
      %274:3 = cute.get_scalars(%lay_426) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %275 = cute.get_scalars(%coord_424) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_427 = arith.constant 16 : i64
      %276 = arith.muli %274#1, %c16_i64_427 : i64
      %c128_i64_428 = arith.constant 128 : i64
      %277 = arith.muli %274#1, %c128_i64_428 : i64
      %c16_i64_429 = arith.constant 16 : i64
      %278 = arith.muli %274#1, %c16_i64_429 : i64
      %c8_i32_430 = arith.constant 8 : i32
      %279 = arith.divsi %275, %c8_i32_430 : i32
      %c8_i32_431 = arith.constant 8 : i32
      %280 = arith.remsi %275, %c8_i32_431 : i32
      %c8_i32_432 = arith.constant 8 : i32
      %281 = arith.muli %280, %c8_i32_432 : i32
      %282 = arith.extsi %279 : i32 to i64
      %283 = arith.muli %282, %274#1 : i64
      %284 = arith.extsi %281 : i32 to i64
      %285 = arith.addi %284, %283 : i64
      %iv_433 = cute.assume(%285) : (i64) -> !cute.i64<divby 8>
      %int_tuple_434 = cute.make_int_tuple(%iv_433) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_435 = cute.add_offset(%iter_425, %int_tuple_434) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_436 = cute.make_shape(%274#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_437 = cute.assume(%276) : (i64) -> !cute.i64<divby 128>
      %iv_438 = cute.assume(%274#2) : (i64) -> !cute.i64<divby 512>
      %stride_439 = cute.make_stride(%iv_437, %iv_438) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_440 = cute.make_layout(%shape_436, %stride_439) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_441 = cute.make_view(%ptr_435, %lay_440) : !memref_gmem_bf16_5
      %iter_442 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
      %coord_443 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_444 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %286 = cute.get_scalars(%coord_443) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_445 = arith.constant 8 : i32
      %287 = arith.divsi %286, %c8_i32_445 : i32
      %c8_i32_446 = arith.constant 8 : i32
      %288 = arith.remsi %286, %c8_i32_446 : i32
      %c8_i32_447 = arith.constant 8 : i32
      %289 = arith.muli %288, %c8_i32_447 : i32
      %c8_i32_448 = arith.constant 8 : i32
      %290 = arith.divsi %287, %c8_i32_448 : i32
      %c8_i32_449 = arith.constant 8 : i32
      %291 = arith.remsi %287, %c8_i32_449 : i32
      %c64_i32_450 = arith.constant 64 : i32
      %292 = arith.muli %291, %c64_i32_450 : i32
      %293 = arith.addi %289, %292 : i32
      %c0_i32_451 = arith.constant 0 : i32
      %294 = arith.xori %293, %c0_i32_451 : i32
      %c8_i32_452 = arith.constant 8 : i32
      %295 = arith.divsi %286, %c8_i32_452 : i32
      %c8_i32_453 = arith.constant 8 : i32
      %296 = arith.remsi %286, %c8_i32_453 : i32
      %c8_i32_454 = arith.constant 8 : i32
      %297 = arith.divsi %295, %c8_i32_454 : i32
      %c8_i32_455 = arith.constant 8 : i32
      %298 = arith.remsi %295, %c8_i32_455 : i32
      %c512_i32_456 = arith.constant 512 : i32
      %299 = arith.muli %297, %c512_i32_456 : i32
      %c64_i32_457 = arith.constant 64 : i32
      %300 = arith.andi %294, %c64_i32_457 : i32
      %c0_i32_458 = arith.constant 0 : i32
      %301 = arith.cmpi eq, %300, %c0_i32_458 : i32
      %302 = scf.if %301 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_459 = arith.constant 128 : i32
      %303 = arith.andi %294, %c128_i32_459 : i32
      %c0_i32_460 = arith.constant 0 : i32
      %304 = arith.cmpi eq, %303, %c0_i32_460 : i32
      %305 = scf.if %304 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_461 = arith.constant 256 : i32
      %306 = arith.andi %294, %c256_i32_461 : i32
      %c0_i32_462 = arith.constant 0 : i32
      %307 = arith.cmpi eq, %306, %c0_i32_462 : i32
      %308 = scf.if %307 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_463 = arith.constant 8 : i32
      %309 = arith.andi %294, %c8_i32_463 : i32
      %c0_i32_464 = arith.constant 0 : i32
      %310 = arith.cmpi eq, %309, %c0_i32_464 : i32
      %311 = scf.if %310 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_465 = arith.constant 16 : i32
      %312 = arith.andi %294, %c16_i32_465 : i32
      %c0_i32_466 = arith.constant 0 : i32
      %313 = arith.cmpi eq, %312, %c0_i32_466 : i32
      %314 = scf.if %313 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_467 = arith.constant 32 : i32
      %315 = arith.andi %294, %c32_i32_467 : i32
      %c0_i32_468 = arith.constant 0 : i32
      %316 = arith.cmpi eq, %315, %c0_i32_468 : i32
      %317 = scf.if %316 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_469 = arith.constant 448 : i32
      %318 = arith.andi %294, %c448_i32_469 : i32
      %c3_i32_470 = arith.constant 3 : i32
      %319 = arith.shrsi %318, %c3_i32_470 : i32
      %320 = arith.xori %294, %319 : i32
      %321 = arith.addi %320, %299 : i32
      %c128_i32_471 = arith.constant 128 : i32
      %322 = arith.muli %302, %c128_i32_471 : i32
      %c64_i32_472 = arith.constant 64 : i32
      %323 = arith.muli %305, %c64_i32_472 : i32
      %c32_i32_473 = arith.constant 32 : i32
      %324 = arith.muli %308, %c32_i32_473 : i32
      %c16_i32_474 = arith.constant 16 : i32
      %325 = arith.muli %311, %c16_i32_474 : i32
      %c8_i32_475 = arith.constant 8 : i32
      %326 = arith.muli %314, %c8_i32_475 : i32
      %c4_i32_476 = arith.constant 4 : i32
      %327 = arith.muli %317, %c4_i32_476 : i32
      %c512_i32_477 = arith.constant 512 : i32
      %328 = arith.muli %302, %c512_i32_477 : i32
      %c256_i32_478 = arith.constant 256 : i32
      %329 = arith.muli %305, %c256_i32_478 : i32
      %c128_i32_479 = arith.constant 128 : i32
      %330 = arith.muli %308, %c128_i32_479 : i32
      %c64_i32_480 = arith.constant 64 : i32
      %331 = arith.muli %311, %c64_i32_480 : i32
      %c32_i32_481 = arith.constant 32 : i32
      %332 = arith.muli %314, %c32_i32_481 : i32
      %c16_i32_482 = arith.constant 16 : i32
      %333 = arith.muli %317, %c16_i32_482 : i32
      %iv_483 = cute.assume(%321) : (i32) -> !cute.i32<divby 8>
      %int_tuple_484 = cute.make_int_tuple(%iv_483) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_485 = cute.add_offset(%iter_444, %int_tuple_484) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_486 = cute.make_view(%ptr_485) : !memref_smem_bf16_4
      %iter_487 = cute.get_iter(%view_486) : !memref_smem_bf16_4
      %coord_488 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_489 = cute.get_iter(%view_294) : !memref_smem_bf16_
      %334 = cute.get_scalars(%coord_488) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_490 = arith.constant 32 : i32
      %335 = arith.remsi %334, %c32_i32_490 : i32
      %c32_i32_491 = arith.constant 32 : i32
      %336 = arith.divsi %334, %c32_i32_491 : i32
      %c4_i32_492 = arith.constant 4 : i32
      %337 = arith.remsi %336, %c4_i32_492 : i32
      %c32_i32_493 = arith.constant 32 : i32
      %338 = arith.remsi %335, %c32_i32_493 : i32
      %c4_i32_494 = arith.constant 4 : i32
      %339 = arith.remsi %337, %c4_i32_494 : i32
      %c4_i32_495 = arith.constant 4 : i32
      %340 = arith.divsi %338, %c4_i32_495 : i32
      %c4_i32_496 = arith.constant 4 : i32
      %341 = arith.remsi %338, %c4_i32_496 : i32
      %c64_i32_497 = arith.constant 64 : i32
      %342 = arith.muli %340, %c64_i32_497 : i32
      %c0_i32_498 = arith.constant 0 : i32
      %343 = arith.xori %342, %c0_i32_498 : i32
      %c4_i32_499 = arith.constant 4 : i32
      %344 = arith.divsi %338, %c4_i32_499 : i32
      %c4_i32_500 = arith.constant 4 : i32
      %345 = arith.remsi %338, %c4_i32_500 : i32
      %c2_i32 = arith.constant 2 : i32
      %346 = arith.muli %345, %c2_i32 : i32
      %c1024_i32_501 = arith.constant 1024 : i32
      %347 = arith.muli %339, %c1024_i32_501 : i32
      %348 = arith.addi %346, %347 : i32
      %c64_i32_502 = arith.constant 64 : i32
      %349 = arith.andi %343, %c64_i32_502 : i32
      %c0_i32_503 = arith.constant 0 : i32
      %350 = arith.cmpi eq, %349, %c0_i32_503 : i32
      %351 = scf.if %350 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_504 = arith.constant 128 : i32
      %352 = arith.andi %343, %c128_i32_504 : i32
      %c0_i32_505 = arith.constant 0 : i32
      %353 = arith.cmpi eq, %352, %c0_i32_505 : i32
      %354 = scf.if %353 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_506 = arith.constant 256 : i32
      %355 = arith.andi %343, %c256_i32_506 : i32
      %c0_i32_507 = arith.constant 0 : i32
      %356 = arith.cmpi eq, %355, %c0_i32_507 : i32
      %357 = scf.if %356 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_508 = arith.constant 8 : i32
      %358 = arith.andi %343, %c8_i32_508 : i32
      %c0_i32_509 = arith.constant 0 : i32
      %359 = arith.cmpi eq, %358, %c0_i32_509 : i32
      %360 = scf.if %359 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_510 = arith.constant 16 : i32
      %361 = arith.andi %343, %c16_i32_510 : i32
      %c0_i32_511 = arith.constant 0 : i32
      %362 = arith.cmpi eq, %361, %c0_i32_511 : i32
      %363 = scf.if %362 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_512 = arith.constant 32 : i32
      %364 = arith.andi %343, %c32_i32_512 : i32
      %c0_i32_513 = arith.constant 0 : i32
      %365 = arith.cmpi eq, %364, %c0_i32_513 : i32
      %366 = scf.if %365 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_514 = arith.constant 448 : i32
      %367 = arith.andi %343, %c448_i32_514 : i32
      %c3_i32_515 = arith.constant 3 : i32
      %368 = arith.shrsi %367, %c3_i32_515 : i32
      %369 = arith.xori %343, %368 : i32
      %370 = arith.addi %369, %348 : i32
      %c64_i32_516 = arith.constant 64 : i32
      %371 = arith.muli %351, %c64_i32_516 : i32
      %c32_i32_517 = arith.constant 32 : i32
      %372 = arith.muli %354, %c32_i32_517 : i32
      %c16_i32_518 = arith.constant 16 : i32
      %373 = arith.muli %357, %c16_i32_518 : i32
      %c8_i32_519 = arith.constant 8 : i32
      %374 = arith.muli %360, %c8_i32_519 : i32
      %c4_i32_520 = arith.constant 4 : i32
      %375 = arith.muli %363, %c4_i32_520 : i32
      %c2_i32_521 = arith.constant 2 : i32
      %376 = arith.muli %366, %c2_i32_521 : i32
      %c512_i32_522 = arith.constant 512 : i32
      %377 = arith.muli %351, %c512_i32_522 : i32
      %c256_i32_523 = arith.constant 256 : i32
      %378 = arith.muli %354, %c256_i32_523 : i32
      %c128_i32_524 = arith.constant 128 : i32
      %379 = arith.muli %357, %c128_i32_524 : i32
      %c64_i32_525 = arith.constant 64 : i32
      %380 = arith.muli %360, %c64_i32_525 : i32
      %c32_i32_526 = arith.constant 32 : i32
      %381 = arith.muli %363, %c32_i32_526 : i32
      %c16_i32_527 = arith.constant 16 : i32
      %382 = arith.muli %366, %c16_i32_527 : i32
      %c2_i32_528 = arith.constant 2 : i32
      %383 = arith.muli %351, %c2_i32_528 : i32
      %c1024_i32_529 = arith.constant 1024 : i32
      %384 = arith.muli %351, %c1024_i32_529 : i32
      %c512_i32_530 = arith.constant 512 : i32
      %385 = arith.muli %354, %c512_i32_530 : i32
      %c256_i32_531 = arith.constant 256 : i32
      %386 = arith.muli %357, %c256_i32_531 : i32
      %c128_i32_532 = arith.constant 128 : i32
      %387 = arith.muli %360, %c128_i32_532 : i32
      %c64_i32_533 = arith.constant 64 : i32
      %388 = arith.muli %363, %c64_i32_533 : i32
      %c32_i32_534 = arith.constant 32 : i32
      %389 = arith.muli %366, %c32_i32_534 : i32
      %iv_535 = cute.assume(%370) : (i32) -> !cute.i32<divby 2>
      %int_tuple_536 = cute.make_int_tuple(%iv_535) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_537 = cute.add_offset(%iter_489, %int_tuple_536) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_538 = cute.make_shape() : () -> !cute.shape<"((2,2,2),2,((2,2),2))">
      %iv_539 = cute.assume(%351) : (i32) -> !cute.i32<divby 8>
      %iv_540 = cute.assume(%354) : (i32) -> !cute.i32<divby 16>
      %iv_541 = cute.assume(%357) : (i32) -> !cute.i32<divby 32>
      %stride_542 = cute.make_stride(%iv_539, %iv_540, %iv_541) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
      %lay_543 = cute.make_layout(%shape_538, %stride_542) : !cute.layout<"((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
      %view_544 = cute.make_view(%ptr_537, %lay_543) : !memref_smem_bf16_5
      %iter_545 = cute.get_iter(%view_544) : !memref_smem_bf16_5
      %rmem = cute.memref.alloca() : !memref_rmem_bf16_
      %iter_546 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %coord_547 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_548 = cute.get_iter(%view_297) : !memref_smem_bf16_1
      %390 = cute.get_scalars(%coord_547) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_549 = arith.constant 32 : i32
      %391 = arith.remsi %390, %c32_i32_549 : i32
      %c32_i32_550 = arith.constant 32 : i32
      %392 = arith.divsi %390, %c32_i32_550 : i32
      %c4_i32_551 = arith.constant 4 : i32
      %393 = arith.remsi %392, %c4_i32_551 : i32
      %c32_i32_552 = arith.constant 32 : i32
      %394 = arith.remsi %391, %c32_i32_552 : i32
      %c4_i32_553 = arith.constant 4 : i32
      %395 = arith.remsi %393, %c4_i32_553 : i32
      %c4_i32_554 = arith.constant 4 : i32
      %396 = arith.divsi %394, %c4_i32_554 : i32
      %c4_i32_555 = arith.constant 4 : i32
      %397 = arith.remsi %394, %c4_i32_555 : i32
      %c64_i32_556 = arith.constant 64 : i32
      %398 = arith.muli %396, %c64_i32_556 : i32
      %c0_i32_557 = arith.constant 0 : i32
      %399 = arith.xori %398, %c0_i32_557 : i32
      %c4_i32_558 = arith.constant 4 : i32
      %400 = arith.divsi %394, %c4_i32_558 : i32
      %c4_i32_559 = arith.constant 4 : i32
      %401 = arith.remsi %394, %c4_i32_559 : i32
      %c2_i32_560 = arith.constant 2 : i32
      %402 = arith.muli %401, %c2_i32_560 : i32
      %c64_i32_561 = arith.constant 64 : i32
      %403 = arith.andi %399, %c64_i32_561 : i32
      %c0_i32_562 = arith.constant 0 : i32
      %404 = arith.cmpi eq, %403, %c0_i32_562 : i32
      %405 = scf.if %404 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_563 = arith.constant 128 : i32
      %406 = arith.andi %399, %c128_i32_563 : i32
      %c0_i32_564 = arith.constant 0 : i32
      %407 = arith.cmpi eq, %406, %c0_i32_564 : i32
      %408 = scf.if %407 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_565 = arith.constant 256 : i32
      %409 = arith.andi %399, %c256_i32_565 : i32
      %c0_i32_566 = arith.constant 0 : i32
      %410 = arith.cmpi eq, %409, %c0_i32_566 : i32
      %411 = scf.if %410 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_567 = arith.constant 8 : i32
      %412 = arith.andi %399, %c8_i32_567 : i32
      %c0_i32_568 = arith.constant 0 : i32
      %413 = arith.cmpi eq, %412, %c0_i32_568 : i32
      %414 = scf.if %413 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_569 = arith.constant 16 : i32
      %415 = arith.andi %399, %c16_i32_569 : i32
      %c0_i32_570 = arith.constant 0 : i32
      %416 = arith.cmpi eq, %415, %c0_i32_570 : i32
      %417 = scf.if %416 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_571 = arith.constant 32 : i32
      %418 = arith.andi %399, %c32_i32_571 : i32
      %c0_i32_572 = arith.constant 0 : i32
      %419 = arith.cmpi eq, %418, %c0_i32_572 : i32
      %420 = scf.if %419 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_573 = arith.constant 448 : i32
      %421 = arith.andi %399, %c448_i32_573 : i32
      %c3_i32_574 = arith.constant 3 : i32
      %422 = arith.shrsi %421, %c3_i32_574 : i32
      %423 = arith.xori %399, %422 : i32
      %424 = arith.addi %423, %402 : i32
      %c64_i32_575 = arith.constant 64 : i32
      %425 = arith.muli %405, %c64_i32_575 : i32
      %c32_i32_576 = arith.constant 32 : i32
      %426 = arith.muli %408, %c32_i32_576 : i32
      %c16_i32_577 = arith.constant 16 : i32
      %427 = arith.muli %411, %c16_i32_577 : i32
      %c8_i32_578 = arith.constant 8 : i32
      %428 = arith.muli %414, %c8_i32_578 : i32
      %c4_i32_579 = arith.constant 4 : i32
      %429 = arith.muli %417, %c4_i32_579 : i32
      %c2_i32_580 = arith.constant 2 : i32
      %430 = arith.muli %420, %c2_i32_580 : i32
      %c2_i32_581 = arith.constant 2 : i32
      %431 = arith.muli %405, %c2_i32_581 : i32
      %c512_i32_582 = arith.constant 512 : i32
      %432 = arith.muli %405, %c512_i32_582 : i32
      %c256_i32_583 = arith.constant 256 : i32
      %433 = arith.muli %408, %c256_i32_583 : i32
      %c128_i32_584 = arith.constant 128 : i32
      %434 = arith.muli %411, %c128_i32_584 : i32
      %c64_i32_585 = arith.constant 64 : i32
      %435 = arith.muli %414, %c64_i32_585 : i32
      %c32_i32_586 = arith.constant 32 : i32
      %436 = arith.muli %417, %c32_i32_586 : i32
      %c16_i32_587 = arith.constant 16 : i32
      %437 = arith.muli %420, %c16_i32_587 : i32
      %iv_588 = cute.assume(%424) : (i32) -> !cute.i32<divby 2>
      %int_tuple_589 = cute.make_int_tuple(%iv_588) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_590 = cute.add_offset(%iter_548, %int_tuple_589) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_591 = cute.make_shape() : () -> !cute.shape<"((2,2),8,((2,2),2))">
      %iv_592 = cute.assume(%405) : (i32) -> !cute.i32<divby 8>
      %iv_593 = cute.assume(%408) : (i32) -> !cute.i32<divby 16>
      %iv_594 = cute.assume(%411) : (i32) -> !cute.i32<divby 32>
      %stride_595 = cute.make_stride(%iv_592, %iv_593, %iv_594) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
      %lay_596 = cute.make_layout(%shape_591, %stride_595) : !cute.layout<"((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
      %view_597 = cute.make_view(%ptr_590, %lay_596) : !memref_smem_bf16_6
      %iter_598 = cute.get_iter(%view_597) : !memref_smem_bf16_6
      %rmem_599 = cute.memref.alloca() : !memref_rmem_bf16_1
      %iter_600 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %coord_601 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_602 = cute.get_iter(%view_306) : !memref_smem_bf16_2
      %438 = cute.get_scalars(%coord_601) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_603 = arith.constant 32 : i32
      %439 = arith.remsi %438, %c32_i32_603 : i32
      %c32_i32_604 = arith.constant 32 : i32
      %440 = arith.divsi %438, %c32_i32_604 : i32
      %c4_i32_605 = arith.constant 4 : i32
      %441 = arith.remsi %440, %c4_i32_605 : i32
      %c32_i32_606 = arith.constant 32 : i32
      %442 = arith.remsi %439, %c32_i32_606 : i32
      %c4_i32_607 = arith.constant 4 : i32
      %443 = arith.remsi %441, %c4_i32_607 : i32
      %c4_i32_608 = arith.constant 4 : i32
      %444 = arith.divsi %442, %c4_i32_608 : i32
      %c4_i32_609 = arith.constant 4 : i32
      %445 = arith.remsi %442, %c4_i32_609 : i32
      %c128_i32_610 = arith.constant 128 : i32
      %446 = arith.muli %445, %c128_i32_610 : i32
      %c0_i32_611 = arith.constant 0 : i32
      %447 = arith.xori %446, %c0_i32_611 : i32
      %c4_i32_612 = arith.constant 4 : i32
      %448 = arith.divsi %442, %c4_i32_612 : i32
      %c4_i32_613 = arith.constant 4 : i32
      %449 = arith.remsi %442, %c4_i32_613 : i32
      %int_tuple_614 = cute.make_int_tuple(%448) : (i32) -> !cute.int_tuple<"?">
      %ptr_615 = cute.add_offset(%iter_602, %int_tuple_614) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?">) -> !cute.ptr<bf16, smem>
      %lay_616 = cute.make_layout() : !cute.layout<"((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %iv_617 = cute.assume(%447) : (i32) -> !cute.i32<divby 128>
      %int_tuple_618 = cute.make_int_tuple(%iv_617) : (!cute.i32<divby 128>) -> !cute.int_tuple<"?{div=128}">
      %450 = cute.static : !cute.swizzle<"S<3,3,3>">
      %lay_619 = cute.make_composed_layout(%450, %int_tuple_618, %lay_616) : !cute.composed_layout<"S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %view_620 = cute.make_view(%ptr_615, %lay_619) : !memref_smem_bf16_7
      %iter_621 = cute.get_iter(%view_620) : !memref_smem_bf16_7
      %rmem_622 = cute.memref.alloca() : !memref_rmem_bf16_2
      %iter_623 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %shape_624 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %shape_625 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %e0_626, %e1_627, %e2_628, %e3_629 = cute.get_leaves(%shape_625) : !cute.shape<"((2,2),2,16)">
      %shape_630 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_631 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_632 = cute.memref.alloca(%lay_631) : !memref_rmem_f32_
      %iter_633 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %iter_634 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %lay_635 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %sz = cute.size(%lay_635) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"128">
      %e0_636 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
      %lay_637 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %451 = cute.get_shape(%lay_637) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_638, %e1_639, %e2_640, %e3_641 = cute.get_leaves(%451) : !cute.shape<"((2,2),2,16)">
      %int_tuple_642 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %int_tuple_643 = cute.make_int_tuple() : () -> !cute.int_tuple<"128">
      %e0_644 = cute.get_leaves(%int_tuple_643) : !cute.int_tuple<"128">
      %cst = arith.constant 0.000000e+00 : f32
      %452 = vector.splat %cst : vector<128xf32>
      %int_tuple_645 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_646 = cute.size(%int_tuple_645) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_647 = cute.get_leaves(%sz_646) : !cute.int_tuple<"128">
      %int_tuple_648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_649 = cute.size(%int_tuple_648) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_650 = cute.get_leaves(%sz_649) : !cute.int_tuple<"128">
      cute.memref.store_vec %452, %rmem_632, row_major : !memref_rmem_f32_
      %shape_651 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_652 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_653 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_654 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_655 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %453 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %454 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_656, %e1_657, %e2_658 = cute.get_leaves(%454) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_659 = cute.size(%e0_656) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_660 = cute.get_leaves(%sz_659) : !cute.int_tuple<"64">
      %455 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_661, %e1_662, %e2_663 = cute.get_leaves(%455) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_664 = cute.size(%e2_663) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_665 = cute.get_leaves(%sz_664) : !cute.int_tuple<"16">
      %tile_666 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %456 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %457 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %458 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_667, %e1_668, %e2_669 = cute.get_leaves(%458) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_670 = cute.size(%e1_668) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_671 = cute.get_leaves(%sz_670) : !cute.int_tuple<"16">
      %459 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_672, %e1_673, %e2_674 = cute.get_leaves(%459) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_675 = cute.size(%e2_674) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_676 = cute.get_leaves(%sz_675) : !cute.int_tuple<"16">
      %tile_677 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %460 = cute.make_tiled_copy(%atom_653) : !copy_ldsm_4_1
      %461 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %462 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_678, %e1_679, %e2_680 = cute.get_leaves(%462) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_681 = cute.size(%e1_679) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_682 = cute.get_leaves(%sz_681) : !cute.int_tuple<"16">
      %463 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_683, %e1_684, %e2_685 = cute.get_leaves(%463) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_686 = cute.size(%e2_685) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_687 = cute.get_leaves(%sz_686) : !cute.int_tuple<"16">
      %tile_688 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %464 = cute.make_tiled_copy(%atom_655) : !copy_ldsm_4_2
      %coord_689 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_690 = cute.get_iter(%view_294) : !memref_smem_bf16_
      %465 = cute.get_scalars(%coord_689) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_691 = arith.constant 16 : i32
      %466 = arith.divsi %465, %c16_i32_691 : i32
      %c16_i32_692 = arith.constant 16 : i32
      %467 = arith.remsi %465, %c16_i32_692 : i32
      %c8_i32_693 = arith.constant 8 : i32
      %468 = arith.divsi %467, %c8_i32_693 : i32
      %c8_i32_694 = arith.constant 8 : i32
      %469 = arith.remsi %467, %c8_i32_694 : i32
      %c64_i32_695 = arith.constant 64 : i32
      %470 = arith.muli %469, %c64_i32_695 : i32
      %c2_i32_696 = arith.constant 2 : i32
      %471 = arith.divsi %466, %c2_i32_696 : i32
      %c2_i32_697 = arith.constant 2 : i32
      %472 = arith.remsi %466, %c2_i32_697 : i32
      %c8_i32_698 = arith.constant 8 : i32
      %473 = arith.muli %472, %c8_i32_698 : i32
      %474 = arith.addi %470, %473 : i32
      %c0_i32_699 = arith.constant 0 : i32
      %475 = arith.xori %474, %c0_i32_699 : i32
      %c16_i32_700 = arith.constant 16 : i32
      %476 = arith.divsi %465, %c16_i32_700 : i32
      %c16_i32_701 = arith.constant 16 : i32
      %477 = arith.remsi %465, %c16_i32_701 : i32
      %c8_i32_702 = arith.constant 8 : i32
      %478 = arith.divsi %477, %c8_i32_702 : i32
      %c8_i32_703 = arith.constant 8 : i32
      %479 = arith.remsi %477, %c8_i32_703 : i32
      %c512_i32_704 = arith.constant 512 : i32
      %480 = arith.muli %478, %c512_i32_704 : i32
      %c2_i32_705 = arith.constant 2 : i32
      %481 = arith.divsi %476, %c2_i32_705 : i32
      %c2_i32_706 = arith.constant 2 : i32
      %482 = arith.remsi %476, %c2_i32_706 : i32
      %c1024_i32_707 = arith.constant 1024 : i32
      %483 = arith.muli %481, %c1024_i32_707 : i32
      %484 = arith.addi %480, %483 : i32
      %c64_i32_708 = arith.constant 64 : i32
      %485 = arith.andi %475, %c64_i32_708 : i32
      %c0_i32_709 = arith.constant 0 : i32
      %486 = arith.cmpi eq, %485, %c0_i32_709 : i32
      %487 = scf.if %486 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_710 = arith.constant 128 : i32
      %488 = arith.andi %475, %c128_i32_710 : i32
      %c0_i32_711 = arith.constant 0 : i32
      %489 = arith.cmpi eq, %488, %c0_i32_711 : i32
      %490 = scf.if %489 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_712 = arith.constant 256 : i32
      %491 = arith.andi %475, %c256_i32_712 : i32
      %c0_i32_713 = arith.constant 0 : i32
      %492 = arith.cmpi eq, %491, %c0_i32_713 : i32
      %493 = scf.if %492 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_714 = arith.constant 8 : i32
      %494 = arith.andi %475, %c8_i32_714 : i32
      %c0_i32_715 = arith.constant 0 : i32
      %495 = arith.cmpi eq, %494, %c0_i32_715 : i32
      %496 = scf.if %495 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_716 = arith.constant 16 : i32
      %497 = arith.andi %475, %c16_i32_716 : i32
      %c0_i32_717 = arith.constant 0 : i32
      %498 = arith.cmpi eq, %497, %c0_i32_717 : i32
      %499 = scf.if %498 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_718 = arith.constant 32 : i32
      %500 = arith.andi %475, %c32_i32_718 : i32
      %c0_i32_719 = arith.constant 0 : i32
      %501 = arith.cmpi eq, %500, %c0_i32_719 : i32
      %502 = scf.if %501 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_720 = arith.constant 448 : i32
      %503 = arith.andi %475, %c448_i32_720 : i32
      %c3_i32_721 = arith.constant 3 : i32
      %504 = arith.shrsi %503, %c3_i32_721 : i32
      %505 = arith.xori %475, %504 : i32
      %506 = arith.addi %505, %484 : i32
      %c512_i32_722 = arith.constant 512 : i32
      %507 = arith.muli %487, %c512_i32_722 : i32
      %c256_i32_723 = arith.constant 256 : i32
      %508 = arith.muli %490, %c256_i32_723 : i32
      %c128_i32_724 = arith.constant 128 : i32
      %509 = arith.muli %493, %c128_i32_724 : i32
      %c64_i32_725 = arith.constant 64 : i32
      %510 = arith.muli %496, %c64_i32_725 : i32
      %c32_i32_726 = arith.constant 32 : i32
      %511 = arith.muli %499, %c32_i32_726 : i32
      %c16_i32_727 = arith.constant 16 : i32
      %512 = arith.muli %502, %c16_i32_727 : i32
      %c2_i32_728 = arith.constant 2 : i32
      %513 = arith.muli %487, %c2_i32_728 : i32
      %c1024_i32_729 = arith.constant 1024 : i32
      %514 = arith.muli %487, %c1024_i32_729 : i32
      %c512_i32_730 = arith.constant 512 : i32
      %515 = arith.muli %490, %c512_i32_730 : i32
      %c256_i32_731 = arith.constant 256 : i32
      %516 = arith.muli %493, %c256_i32_731 : i32
      %c128_i32_732 = arith.constant 128 : i32
      %517 = arith.muli %496, %c128_i32_732 : i32
      %c64_i32_733 = arith.constant 64 : i32
      %518 = arith.muli %499, %c64_i32_733 : i32
      %c32_i32_734 = arith.constant 32 : i32
      %519 = arith.muli %502, %c32_i32_734 : i32
      %iv_735 = cute.assume(%506) : (i32) -> !cute.i32<divby 8>
      %int_tuple_736 = cute.make_int_tuple(%iv_735) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_737 = cute.add_offset(%iter_690, %int_tuple_736) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_738 = cute.make_shape() : () -> !cute.shape<"((8,1),2,((2,2),2))">
      %iv_739 = cute.assume(%490) : (i32) -> !cute.i32<divby 16>
      %iv_740 = cute.assume(%493) : (i32) -> !cute.i32<divby 32>
      %stride_741 = cute.make_stride(%iv_739, %iv_740) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),4096,((?{div=16},?{div=32}),8192))">
      %lay_742 = cute.make_layout(%shape_738, %stride_741) : !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
      %view_743 = cute.make_view(%ptr_737, %lay_742) : !memref_smem_bf16_8
      %iter_744 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %iter_745 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %view_746 = cute.make_view(%iter_745) : !memref_rmem_bf16_3
      %iter_747 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %coord_748 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_749 = cute.get_iter(%view_297) : !memref_smem_bf16_1
      %520 = cute.get_scalars(%coord_748) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_750 = arith.constant 8 : i32
      %521 = arith.divsi %520, %c8_i32_750 : i32
      %c8_i32_751 = arith.constant 8 : i32
      %522 = arith.remsi %520, %c8_i32_751 : i32
      %c64_i32_752 = arith.constant 64 : i32
      %523 = arith.muli %522, %c64_i32_752 : i32
      %c2_i32_753 = arith.constant 2 : i32
      %524 = arith.divsi %521, %c2_i32_753 : i32
      %c2_i32_754 = arith.constant 2 : i32
      %525 = arith.remsi %521, %c2_i32_754 : i32
      %c8_i32_755 = arith.constant 8 : i32
      %526 = arith.muli %525, %c8_i32_755 : i32
      %527 = arith.addi %523, %526 : i32
      %c2_i32_756 = arith.constant 2 : i32
      %528 = arith.divsi %524, %c2_i32_756 : i32
      %c2_i32_757 = arith.constant 2 : i32
      %529 = arith.remsi %524, %c2_i32_757 : i32
      %c0_i32_758 = arith.constant 0 : i32
      %530 = arith.xori %527, %c0_i32_758 : i32
      %c8_i32_759 = arith.constant 8 : i32
      %531 = arith.divsi %520, %c8_i32_759 : i32
      %c8_i32_760 = arith.constant 8 : i32
      %532 = arith.remsi %520, %c8_i32_760 : i32
      %c2_i32_761 = arith.constant 2 : i32
      %533 = arith.divsi %531, %c2_i32_761 : i32
      %c2_i32_762 = arith.constant 2 : i32
      %534 = arith.remsi %531, %c2_i32_762 : i32
      %c2_i32_763 = arith.constant 2 : i32
      %535 = arith.divsi %533, %c2_i32_763 : i32
      %c2_i32_764 = arith.constant 2 : i32
      %536 = arith.remsi %533, %c2_i32_764 : i32
      %c512_i32_765 = arith.constant 512 : i32
      %537 = arith.muli %536, %c512_i32_765 : i32
      %c64_i32_766 = arith.constant 64 : i32
      %538 = arith.andi %530, %c64_i32_766 : i32
      %c0_i32_767 = arith.constant 0 : i32
      %539 = arith.cmpi eq, %538, %c0_i32_767 : i32
      %540 = scf.if %539 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_768 = arith.constant 128 : i32
      %541 = arith.andi %530, %c128_i32_768 : i32
      %c0_i32_769 = arith.constant 0 : i32
      %542 = arith.cmpi eq, %541, %c0_i32_769 : i32
      %543 = scf.if %542 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_770 = arith.constant 256 : i32
      %544 = arith.andi %530, %c256_i32_770 : i32
      %c0_i32_771 = arith.constant 0 : i32
      %545 = arith.cmpi eq, %544, %c0_i32_771 : i32
      %546 = scf.if %545 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_772 = arith.constant 8 : i32
      %547 = arith.andi %530, %c8_i32_772 : i32
      %c0_i32_773 = arith.constant 0 : i32
      %548 = arith.cmpi eq, %547, %c0_i32_773 : i32
      %549 = scf.if %548 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_774 = arith.constant 16 : i32
      %550 = arith.andi %530, %c16_i32_774 : i32
      %c0_i32_775 = arith.constant 0 : i32
      %551 = arith.cmpi eq, %550, %c0_i32_775 : i32
      %552 = scf.if %551 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_776 = arith.constant 32 : i32
      %553 = arith.andi %530, %c32_i32_776 : i32
      %c0_i32_777 = arith.constant 0 : i32
      %554 = arith.cmpi eq, %553, %c0_i32_777 : i32
      %555 = scf.if %554 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_778 = arith.constant 448 : i32
      %556 = arith.andi %530, %c448_i32_778 : i32
      %c3_i32_779 = arith.constant 3 : i32
      %557 = arith.shrsi %556, %c3_i32_779 : i32
      %558 = arith.xori %530, %557 : i32
      %559 = arith.addi %558, %537 : i32
      %c128_i32_780 = arith.constant 128 : i32
      %560 = arith.muli %540, %c128_i32_780 : i32
      %c64_i32_781 = arith.constant 64 : i32
      %561 = arith.muli %543, %c64_i32_781 : i32
      %c32_i32_782 = arith.constant 32 : i32
      %562 = arith.muli %546, %c32_i32_782 : i32
      %c16_i32_783 = arith.constant 16 : i32
      %563 = arith.muli %549, %c16_i32_783 : i32
      %c8_i32_784 = arith.constant 8 : i32
      %564 = arith.muli %552, %c8_i32_784 : i32
      %c4_i32_785 = arith.constant 4 : i32
      %565 = arith.muli %555, %c4_i32_785 : i32
      %c2_i32_786 = arith.constant 2 : i32
      %566 = arith.muli %540, %c2_i32_786 : i32
      %c512_i32_787 = arith.constant 512 : i32
      %567 = arith.muli %540, %c512_i32_787 : i32
      %c256_i32_788 = arith.constant 256 : i32
      %568 = arith.muli %543, %c256_i32_788 : i32
      %c128_i32_789 = arith.constant 128 : i32
      %569 = arith.muli %546, %c128_i32_789 : i32
      %c64_i32_790 = arith.constant 64 : i32
      %570 = arith.muli %549, %c64_i32_790 : i32
      %c32_i32_791 = arith.constant 32 : i32
      %571 = arith.muli %552, %c32_i32_791 : i32
      %c16_i32_792 = arith.constant 16 : i32
      %572 = arith.muli %555, %c16_i32_792 : i32
      %iv_793 = cute.assume(%559) : (i32) -> !cute.i32<divby 8>
      %int_tuple_794 = cute.make_int_tuple(%iv_793) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_795 = cute.add_offset(%iter_749, %int_tuple_794) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_796 = cute.make_shape() : () -> !cute.shape<"((8,1),4,((2,2),2))">
      %iv_797 = cute.assume(%543) : (i32) -> !cute.i32<divby 16>
      %iv_798 = cute.assume(%546) : (i32) -> !cute.i32<divby 32>
      %stride_799 = cute.make_stride(%iv_797, %iv_798) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),1024,((?{div=16},?{div=32}),4096))">
      %lay_800 = cute.make_layout(%shape_796, %stride_799) : !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
      %view_801 = cute.make_view(%ptr_795, %lay_800) : !memref_smem_bf16_9
      %iter_802 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %iter_803 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %view_804 = cute.make_view(%iter_803) : !memref_rmem_bf16_4
      %iter_805 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %coord_806 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_807 = cute.get_iter(%view_306) : !memref_smem_bf16_2
      %573 = cute.get_scalars(%coord_806) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_808 = arith.constant 16 : i32
      %574 = arith.divsi %573, %c16_i32_808 : i32
      %c16_i32_809 = arith.constant 16 : i32
      %575 = arith.remsi %573, %c16_i32_809 : i32
      %c8_i32_810 = arith.constant 8 : i32
      %576 = arith.divsi %575, %c8_i32_810 : i32
      %c8_i32_811 = arith.constant 8 : i32
      %577 = arith.remsi %575, %c8_i32_811 : i32
      %c64_i32_812 = arith.constant 64 : i32
      %578 = arith.muli %577, %c64_i32_812 : i32
      %c2_i32_813 = arith.constant 2 : i32
      %579 = arith.divsi %574, %c2_i32_813 : i32
      %c2_i32_814 = arith.constant 2 : i32
      %580 = arith.remsi %574, %c2_i32_814 : i32
      %c8_i32_815 = arith.constant 8 : i32
      %581 = arith.muli %580, %c8_i32_815 : i32
      %582 = arith.addi %578, %581 : i32
      %c0_i32_816 = arith.constant 0 : i32
      %583 = arith.xori %582, %c0_i32_816 : i32
      %c16_i32_817 = arith.constant 16 : i32
      %584 = arith.divsi %573, %c16_i32_817 : i32
      %c16_i32_818 = arith.constant 16 : i32
      %585 = arith.remsi %573, %c16_i32_818 : i32
      %c8_i32_819 = arith.constant 8 : i32
      %586 = arith.divsi %585, %c8_i32_819 : i32
      %c8_i32_820 = arith.constant 8 : i32
      %587 = arith.remsi %585, %c8_i32_820 : i32
      %c512_i32_821 = arith.constant 512 : i32
      %588 = arith.muli %586, %c512_i32_821 : i32
      %c2_i32_822 = arith.constant 2 : i32
      %589 = arith.divsi %584, %c2_i32_822 : i32
      %c2_i32_823 = arith.constant 2 : i32
      %590 = arith.remsi %584, %c2_i32_823 : i32
      %c64_i32_824 = arith.constant 64 : i32
      %591 = arith.andi %583, %c64_i32_824 : i32
      %c0_i32_825 = arith.constant 0 : i32
      %592 = arith.cmpi eq, %591, %c0_i32_825 : i32
      %593 = scf.if %592 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_826 = arith.constant 128 : i32
      %594 = arith.andi %583, %c128_i32_826 : i32
      %c0_i32_827 = arith.constant 0 : i32
      %595 = arith.cmpi eq, %594, %c0_i32_827 : i32
      %596 = scf.if %595 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_828 = arith.constant 256 : i32
      %597 = arith.andi %583, %c256_i32_828 : i32
      %c0_i32_829 = arith.constant 0 : i32
      %598 = arith.cmpi eq, %597, %c0_i32_829 : i32
      %599 = scf.if %598 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_830 = arith.constant 8 : i32
      %600 = arith.andi %583, %c8_i32_830 : i32
      %c0_i32_831 = arith.constant 0 : i32
      %601 = arith.cmpi eq, %600, %c0_i32_831 : i32
      %602 = scf.if %601 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_832 = arith.constant 16 : i32
      %603 = arith.andi %583, %c16_i32_832 : i32
      %c0_i32_833 = arith.constant 0 : i32
      %604 = arith.cmpi eq, %603, %c0_i32_833 : i32
      %605 = scf.if %604 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_834 = arith.constant 32 : i32
      %606 = arith.andi %583, %c32_i32_834 : i32
      %c0_i32_835 = arith.constant 0 : i32
      %607 = arith.cmpi eq, %606, %c0_i32_835 : i32
      %608 = scf.if %607 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_836 = arith.constant 448 : i32
      %609 = arith.andi %583, %c448_i32_836 : i32
      %c3_i32_837 = arith.constant 3 : i32
      %610 = arith.shrsi %609, %c3_i32_837 : i32
      %611 = arith.xori %583, %610 : i32
      %612 = arith.addi %611, %588 : i32
      %c2_i32_838 = arith.constant 2 : i32
      %613 = arith.muli %593, %c2_i32_838 : i32
      %c512_i32_839 = arith.constant 512 : i32
      %614 = arith.muli %593, %c512_i32_839 : i32
      %c256_i32_840 = arith.constant 256 : i32
      %615 = arith.muli %596, %c256_i32_840 : i32
      %c128_i32_841 = arith.constant 128 : i32
      %616 = arith.muli %599, %c128_i32_841 : i32
      %c64_i32_842 = arith.constant 64 : i32
      %617 = arith.muli %602, %c64_i32_842 : i32
      %c32_i32_843 = arith.constant 32 : i32
      %618 = arith.muli %605, %c32_i32_843 : i32
      %c16_i32_844 = arith.constant 16 : i32
      %619 = arith.muli %608, %c16_i32_844 : i32
      %c128_i32_845 = arith.constant 128 : i32
      %620 = arith.muli %593, %c128_i32_845 : i32
      %c64_i32_846 = arith.constant 64 : i32
      %621 = arith.muli %596, %c64_i32_846 : i32
      %c32_i32_847 = arith.constant 32 : i32
      %622 = arith.muli %599, %c32_i32_847 : i32
      %c16_i32_848 = arith.constant 16 : i32
      %623 = arith.muli %602, %c16_i32_848 : i32
      %c8_i32_849 = arith.constant 8 : i32
      %624 = arith.muli %605, %c8_i32_849 : i32
      %c4_i32_850 = arith.constant 4 : i32
      %625 = arith.muli %608, %c4_i32_850 : i32
      %iv_851 = cute.assume(%612) : (i32) -> !cute.i32<divby 8>
      %int_tuple_852 = cute.make_int_tuple(%iv_851) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_853 = cute.add_offset(%iter_807, %int_tuple_852) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_854 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2),4)">
      %iv_855 = cute.assume(%596) : (i32) -> !cute.i32<divby 16>
      %iv_856 = cute.assume(%599) : (i32) -> !cute.i32<divby 32>
      %stride_857 = cute.make_stride(%iv_855, %iv_856) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096),1024)">
      %lay_858 = cute.make_layout(%shape_854, %stride_857) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %view_859 = cute.make_view(%ptr_853, %lay_858) : !memref_smem_bf16_10
      %iter_860 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %iter_861 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %view_862 = cute.make_view(%iter_861) : !memref_rmem_bf16_5
      %iter_863 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %lay_864 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %626 = cute.get_shape(%lay_864) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_865, %e1_866, %e2_867, %e3_868 = cute.get_leaves(%626) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_869 = cute.to_int_tuple(%e0_865) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %627 = cute.get_scalars(%itup_869) : !cute.int_tuple<"?">
      %itup_870 = cute.to_int_tuple(%e1_866) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %628 = cute.get_scalars(%itup_870) : !cute.int_tuple<"?">
      %itup_871 = cute.to_int_tuple(%e2_867) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %629 = cute.get_scalars(%itup_871) : !cute.int_tuple<"?">
      %itup_872 = cute.to_int_tuple(%e3_868) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %630 = cute.get_scalars(%itup_872) : !cute.int_tuple<"?{div=8}">
      %shape_873 = cute.make_shape(%itup_869, %itup_870, %itup_871, %itup_872) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_874 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_875 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_876 = cute.make_layout(%shape_873, %stride_875) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_877 = cute.make_view(%int_tuple_874, %lay_876) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_878 = cute.get_iter(%view_877) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_879, %e1_880, %e2_881, %e3_882 = cute.get_leaves(%iter_878) : !cute.int_tuple<"(0,0,0,0)">
      %lay_883 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %631 = cute.get_shape(%lay_883) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_884, %e1_885, %e2_886, %e3_887 = cute.get_leaves(%631) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_888 = cute.to_int_tuple(%e0_884) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %632 = cute.get_scalars(%itup_888) : !cute.int_tuple<"?">
      %itup_889 = cute.to_int_tuple(%e1_885) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %633 = cute.get_scalars(%itup_889) : !cute.int_tuple<"?">
      %itup_890 = cute.to_int_tuple(%e2_886) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %634 = cute.get_scalars(%itup_890) : !cute.int_tuple<"?">
      %itup_891 = cute.to_int_tuple(%e3_887) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %635 = cute.get_scalars(%itup_891) : !cute.int_tuple<"?{div=8}">
      %shape_892 = cute.make_shape(%itup_888, %itup_889, %itup_890, %itup_891) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_893 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_894 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_895 = cute.make_layout(%shape_892, %stride_894) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_896 = cute.make_view(%int_tuple_893, %lay_895) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_897 = cute.get_iter(%view_896) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_898, %e1_899, %e2_900, %e3_901 = cute.get_leaves(%iter_897) : !cute.int_tuple<"(0,0,0,0)">
      %coord_902 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_903 = cute.get_layout(%view_877) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %636:4 = cute.get_scalars(%lay_903) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %637:2 = cute.get_scalars(%coord_902) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_904 = cute.assume(%636#3) : (i32) -> !cute.i32<divby 8>
      %shape_905 = cute.make_shape(%636#1, %iv_904) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_906 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_907 = cute.make_layout(%shape_905, %stride_906) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_908 = cute.crd2idx(%coord_902, %lay_903) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_909 = cute.get_iter(%view_877) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_909, %idx_908) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_910 = cute.make_view(%tup, %lay_907) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_911 = cute.get_iter(%view_910) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_912, %e1_913, %e2_914, %e3_915 = cute.get_leaves(%iter_911) : !cute.int_tuple<"(?,0,?,0)">
      %638 = cute.get_scalars(%e0_912) : !cute.int_tuple<"?">
      %639 = cute.get_scalars(%e2_914) : !cute.int_tuple<"?">
      %tile_916 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_917 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %640 = cute.get_scalars(%coord_917) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_918 = cute.make_coord(%640) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_919 = cute.get_layout(%view_910) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %641:2 = cute.get_scalars(%lay_919) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_920 = arith.constant 128 : i32
      %642 = arith.ceildivsi %641#0, %c128_i32_920 : i32
      %c128_i32_921 = arith.constant 128 : i32
      %643 = arith.ceildivsi %641#1, %c128_i32_921 : i32
      %shape_922 = cute.make_shape(%642, %643) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_923 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_924 = cute.make_layout(%shape_922, %stride_923) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_925 = cute.crd2idx(%coord_918, %lay_924) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_926 = cute.get_iter(%view_910) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_927 = cute.add_offset(%iter_926, %idx_925) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_928 = cute.make_view(%tup_927) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_929 = cute.get_iter(%view_928) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_930, %e1_931, %e2_932, %e3_933 = cute.get_leaves(%iter_929) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %644 = cute.get_scalars(%e0_930) : !cute.int_tuple<"?">
      %645 = cute.get_scalars(%e1_931) : !cute.int_tuple<"?{div=128}">
      %646 = cute.get_scalars(%e2_932) : !cute.int_tuple<"?">
      %coord_934 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_935 = cute.get_layout(%view_896) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %647:4 = cute.get_scalars(%lay_935) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %648:2 = cute.get_scalars(%coord_934) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_936 = cute.assume(%647#3) : (i32) -> !cute.i32<divby 8>
      %shape_937 = cute.make_shape(%647#1, %iv_936) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_938 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_939 = cute.make_layout(%shape_937, %stride_938) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_940 = cute.crd2idx(%coord_934, %lay_935) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_941 = cute.get_iter(%view_896) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_942 = cute.add_offset(%iter_941, %idx_940) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_943 = cute.make_view(%tup_942, %lay_939) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_944 = cute.get_iter(%view_943) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_945, %e1_946, %e2_947, %e3_948 = cute.get_leaves(%iter_944) : !cute.int_tuple<"(?,0,?,0)">
      %649 = cute.get_scalars(%e0_945) : !cute.int_tuple<"?">
      %650 = cute.get_scalars(%e2_947) : !cute.int_tuple<"?">
      %tile_949 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_950 = cute.make_coord(%129) : (i32) -> !cute.coord<"(?,0)">
      %651 = cute.get_scalars(%coord_950) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_951 = cute.make_coord(%651) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_952 = cute.get_layout(%view_943) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %652:2 = cute.get_scalars(%lay_952) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_953 = arith.constant 64 : i32
      %653 = arith.ceildivsi %652#0, %c64_i32_953 : i32
      %c128_i32_954 = arith.constant 128 : i32
      %654 = arith.ceildivsi %652#1, %c128_i32_954 : i32
      %shape_955 = cute.make_shape(%653, %654) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_956 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_957 = cute.make_layout(%shape_955, %stride_956) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_958 = cute.crd2idx(%coord_951, %lay_957) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_959 = cute.get_iter(%view_943) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_960 = cute.add_offset(%iter_959, %idx_958) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_961 = cute.make_view(%tup_960) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_962 = cute.get_iter(%view_961) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_963, %e1_964, %e2_965, %e3_966 = cute.get_leaves(%iter_962) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %655 = cute.get_scalars(%e0_963) : !cute.int_tuple<"?">
      %656 = cute.get_scalars(%e1_964) : !cute.int_tuple<"?{div=64}">
      %657 = cute.get_scalars(%e2_965) : !cute.int_tuple<"?">
      %coord_967 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_968 = cute.get_iter(%view_928) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %658 = cute.get_scalars(%coord_967) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_969 = arith.constant 8 : i32
      %659 = arith.divsi %658, %c8_i32_969 : i32
      %c8_i32_970 = arith.constant 8 : i32
      %660 = arith.remsi %658, %c8_i32_970 : i32
      %c8_i32_971 = arith.constant 8 : i32
      %661 = arith.muli %660, %c8_i32_971 : i32
      %iv_972 = cute.assume(%661) : (i32) -> !cute.i32<divby 8>
      %int_tuple_973 = cute.make_int_tuple(%659, %iv_972) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_974 = cute.add_offset(%iter_968, %int_tuple_973) : (!cute.int_tuple<"(?,?{div=128},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_975 = cute.make_view(%tup_974) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_976 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_977, %e1_978, %e2_979, %e3_980 = cute.get_leaves(%iter_976) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %662 = cute.get_scalars(%e0_977) : !cute.int_tuple<"?">
      %663 = cute.get_scalars(%e1_978) : !cute.int_tuple<"?">
      %664 = cute.get_scalars(%e2_979) : !cute.int_tuple<"?">
      %665 = cute.get_scalars(%e3_980) : !cute.int_tuple<"?{div=8}">
      %coord_981 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_982 = cute.get_iter(%view_961) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %666 = cute.get_scalars(%coord_981) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_983 = arith.constant 8 : i32
      %667 = arith.divsi %666, %c8_i32_983 : i32
      %c8_i32_984 = arith.constant 8 : i32
      %668 = arith.remsi %666, %c8_i32_984 : i32
      %c8_i32_985 = arith.constant 8 : i32
      %669 = arith.muli %668, %c8_i32_985 : i32
      %iv_986 = cute.assume(%669) : (i32) -> !cute.i32<divby 8>
      %int_tuple_987 = cute.make_int_tuple(%667, %iv_986) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_988 = cute.add_offset(%iter_982, %int_tuple_987) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_989 = cute.make_view(%tup_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_990 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_991, %e1_992, %e2_993, %e3_994 = cute.get_leaves(%iter_990) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %670 = cute.get_scalars(%e0_991) : !cute.int_tuple<"?">
      %671 = cute.get_scalars(%e1_992) : !cute.int_tuple<"?">
      %672 = cute.get_scalars(%e2_993) : !cute.int_tuple<"?">
      %673 = cute.get_scalars(%e3_994) : !cute.int_tuple<"?{div=8}">
      %lay_995 = cute.get_layout(%view_358) : !memref_smem_bf16_3
      %674 = cute.get_shape(%lay_995) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_996, %e1_997, %e2_998, %e3_999 = cute.get_leaves(%674) : !cute.shape<"((8,1),8,2)">
      %lay_1000 = cute.get_layout(%view_358) : !memref_smem_bf16_3
      %sz_1001 = cute.size(%lay_1000) <{mode = [1]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"8">
      %e0_1002 = cute.get_leaves(%sz_1001) : !cute.int_tuple<"8">
      %lay_1003 = cute.get_layout(%view_358) : !memref_smem_bf16_3
      %sz_1004 = cute.size(%lay_1003) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_1005 = cute.get_leaves(%sz_1004) : !cute.int_tuple<"2">
      %lay_1006 = cute.get_layout(%view_358) : !memref_smem_bf16_3
      %sz_1007 = cute.size(%lay_1006) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_1008 = cute.get_leaves(%sz_1007) : !cute.int_tuple<"2">
      %shape_1009 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_1010 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1011 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_1012 = cute.memref.alloca(%lay_1011) : !memref_rmem_i8_
      %iter_1013 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
      %iter_1014 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
      %lay_1015 = cute.get_layout(%view_422) : !memref_smem_bf16_4
      %675 = cute.get_shape(%lay_1015) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1016, %e1_1017, %e2_1018, %e3_1019 = cute.get_leaves(%675) : !cute.shape<"((8,1),4,2)">
      %lay_1020 = cute.get_layout(%view_422) : !memref_smem_bf16_4
      %sz_1021 = cute.size(%lay_1020) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1022 = cute.get_leaves(%sz_1021) : !cute.int_tuple<"4">
      %lay_1023 = cute.get_layout(%view_422) : !memref_smem_bf16_4
      %sz_1024 = cute.size(%lay_1023) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1025 = cute.get_leaves(%sz_1024) : !cute.int_tuple<"2">
      %lay_1026 = cute.get_layout(%view_422) : !memref_smem_bf16_4
      %sz_1027 = cute.size(%lay_1026) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1028 = cute.get_leaves(%sz_1027) : !cute.int_tuple<"2">
      %shape_1029 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1030 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1031 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1032 = cute.memref.alloca(%lay_1031) : !memref_rmem_i8_1
      %iter_1033 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
      %iter_1034 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
      %lay_1035 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
      %676 = cute.get_shape(%lay_1035) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_1036, %e1_1037, %e2_1038 = cute.get_leaves(%676) : !cute.shape<"(1,8,2)">
      %coord_1039 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1040 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1041 = cute.crd2idx(%coord_1039, %lay_1040) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1042 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1043 = cute.add_offset(%iter_1042, %idx_1041) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1044 = cute.make_view(%tup_1043) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1045 = cute.get_iter(%view_1044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1046, %e1_1047, %e2_1048, %e3_1049 = cute.get_leaves(%iter_1045) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %677 = cute.get_scalars(%e0_1046) : !cute.int_tuple<"?">
      %678 = cute.get_scalars(%e1_1047) : !cute.int_tuple<"?">
      %679 = cute.get_scalars(%e2_1048) : !cute.int_tuple<"?">
      %680 = cute.get_scalars(%e3_1049) : !cute.int_tuple<"?{div=8}">
      %iter_1050 = cute.get_iter(%view_1044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1051, %e1_1052, %e2_1053, %e3_1054 = cute.get_leaves(%iter_1050) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %681 = cute.get_scalars(%e0_1051) : !cute.int_tuple<"?">
      %682 = cute.get_scalars(%e1_1052) : !cute.int_tuple<"?">
      %683 = cute.get_scalars(%e2_1053) : !cute.int_tuple<"?">
      %684 = cute.get_scalars(%e3_1054) : !cute.int_tuple<"?{div=8}">
      %iter_1055 = cute.get_iter(%view_1044) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1056, %e1_1057, %e2_1058, %e3_1059 = cute.get_leaves(%iter_1055) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %685 = cute.get_scalars(%e0_1056) : !cute.int_tuple<"?">
      %686 = cute.get_scalars(%e1_1057) : !cute.int_tuple<"?">
      %687 = cute.get_scalars(%e2_1058) : !cute.int_tuple<"?">
      %688 = cute.get_scalars(%e3_1059) : !cute.int_tuple<"?{div=8}">
      %lay_1060 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %689 = cute.get_shape(%lay_1060) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1061, %e1_1062, %e2_1063, %e3_1064 = cute.get_leaves(%689) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1065 = cute.to_int_tuple(%e0_1061) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %690 = cute.get_scalars(%itup_1065) : !cute.int_tuple<"?">
      %itup_1066 = cute.to_int_tuple(%e1_1062) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %691 = cute.get_scalars(%itup_1066) : !cute.int_tuple<"?">
      %itup_1067 = cute.to_int_tuple(%e2_1063) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %692 = cute.get_scalars(%itup_1067) : !cute.int_tuple<"?">
      %itup_1068 = cute.to_int_tuple(%e3_1064) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %693 = cute.get_scalars(%itup_1068) : !cute.int_tuple<"?{div=8}">
      %coord_1069 = cute.make_coord(%e3_1059) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1070 = cute.make_coord(%itup_1068) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %694 = cute.get_scalars(%coord_1069) : !cute.coord<"?{div=8}">
      %695 = cute.get_scalars(%coord_1070) : !cute.coord<"?{div=8}">
      %true = arith.constant true
      %696 = arith.cmpi slt, %694, %695 : i32
      %697 = arith.andi %true, %696 : i1
      %698 = arith.extui %697 : i1 to i8
      %coord_1071 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1012, %coord_1071, %698) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1072 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1073 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1074 = cute.crd2idx(%coord_1072, %lay_1073) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1075 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1076 = cute.add_offset(%iter_1075, %idx_1074) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1077 = cute.make_view(%tup_1076) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1078 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1079, %e1_1080, %e2_1081, %e3_1082 = cute.get_leaves(%iter_1078) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %699 = cute.get_scalars(%e0_1079) : !cute.int_tuple<"?">
      %700 = cute.get_scalars(%e1_1080) : !cute.int_tuple<"?">
      %701 = cute.get_scalars(%e2_1081) : !cute.int_tuple<"?">
      %702 = cute.get_scalars(%e3_1082) : !cute.int_tuple<"?{div=8}">
      %iter_1083 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1084, %e1_1085, %e2_1086, %e3_1087 = cute.get_leaves(%iter_1083) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %703 = cute.get_scalars(%e0_1084) : !cute.int_tuple<"?">
      %704 = cute.get_scalars(%e1_1085) : !cute.int_tuple<"?">
      %705 = cute.get_scalars(%e2_1086) : !cute.int_tuple<"?">
      %706 = cute.get_scalars(%e3_1087) : !cute.int_tuple<"?{div=8}">
      %iter_1088 = cute.get_iter(%view_1077) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1089, %e1_1090, %e2_1091, %e3_1092 = cute.get_leaves(%iter_1088) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %707 = cute.get_scalars(%e0_1089) : !cute.int_tuple<"?">
      %708 = cute.get_scalars(%e1_1090) : !cute.int_tuple<"?">
      %709 = cute.get_scalars(%e2_1091) : !cute.int_tuple<"?">
      %710 = cute.get_scalars(%e3_1092) : !cute.int_tuple<"?{div=8}">
      %lay_1093 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %711 = cute.get_shape(%lay_1093) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1094, %e1_1095, %e2_1096, %e3_1097 = cute.get_leaves(%711) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1098 = cute.to_int_tuple(%e0_1094) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %712 = cute.get_scalars(%itup_1098) : !cute.int_tuple<"?">
      %itup_1099 = cute.to_int_tuple(%e1_1095) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %713 = cute.get_scalars(%itup_1099) : !cute.int_tuple<"?">
      %itup_1100 = cute.to_int_tuple(%e2_1096) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %714 = cute.get_scalars(%itup_1100) : !cute.int_tuple<"?">
      %itup_1101 = cute.to_int_tuple(%e3_1097) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %715 = cute.get_scalars(%itup_1101) : !cute.int_tuple<"?{div=8}">
      %coord_1102 = cute.make_coord(%e3_1092) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1103 = cute.make_coord(%itup_1101) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %716 = cute.get_scalars(%coord_1102) : !cute.coord<"?{div=8}">
      %717 = cute.get_scalars(%coord_1103) : !cute.coord<"?{div=8}">
      %true_1104 = arith.constant true
      %718 = arith.cmpi slt, %716, %717 : i32
      %719 = arith.andi %true_1104, %718 : i1
      %720 = arith.extui %719 : i1 to i8
      %coord_1105 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1012, %coord_1105, %720) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_1106 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
      %721 = cute.get_shape(%lay_1106) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1107, %e1_1108, %e2_1109 = cute.get_leaves(%721) : !cute.shape<"(1,4,2)">
      %coord_1110 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1111 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1112 = cute.crd2idx(%coord_1110, %lay_1111) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1113 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1114 = cute.add_offset(%iter_1113, %idx_1112) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1115 = cute.make_view(%tup_1114) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1116 = cute.get_iter(%view_1115) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1117, %e1_1118, %e2_1119, %e3_1120 = cute.get_leaves(%iter_1116) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %722 = cute.get_scalars(%e0_1117) : !cute.int_tuple<"?">
      %723 = cute.get_scalars(%e1_1118) : !cute.int_tuple<"?">
      %724 = cute.get_scalars(%e2_1119) : !cute.int_tuple<"?">
      %725 = cute.get_scalars(%e3_1120) : !cute.int_tuple<"?{div=8}">
      %iter_1121 = cute.get_iter(%view_1115) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1122, %e1_1123, %e2_1124, %e3_1125 = cute.get_leaves(%iter_1121) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %726 = cute.get_scalars(%e0_1122) : !cute.int_tuple<"?">
      %727 = cute.get_scalars(%e1_1123) : !cute.int_tuple<"?">
      %728 = cute.get_scalars(%e2_1124) : !cute.int_tuple<"?">
      %729 = cute.get_scalars(%e3_1125) : !cute.int_tuple<"?{div=8}">
      %iter_1126 = cute.get_iter(%view_1115) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1127, %e1_1128, %e2_1129, %e3_1130 = cute.get_leaves(%iter_1126) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %730 = cute.get_scalars(%e0_1127) : !cute.int_tuple<"?">
      %731 = cute.get_scalars(%e1_1128) : !cute.int_tuple<"?">
      %732 = cute.get_scalars(%e2_1129) : !cute.int_tuple<"?">
      %733 = cute.get_scalars(%e3_1130) : !cute.int_tuple<"?{div=8}">
      %lay_1131 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %734 = cute.get_shape(%lay_1131) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1132, %e1_1133, %e2_1134, %e3_1135 = cute.get_leaves(%734) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1136 = cute.to_int_tuple(%e0_1132) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %735 = cute.get_scalars(%itup_1136) : !cute.int_tuple<"?">
      %itup_1137 = cute.to_int_tuple(%e1_1133) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %736 = cute.get_scalars(%itup_1137) : !cute.int_tuple<"?">
      %itup_1138 = cute.to_int_tuple(%e2_1134) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %737 = cute.get_scalars(%itup_1138) : !cute.int_tuple<"?">
      %itup_1139 = cute.to_int_tuple(%e3_1135) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %738 = cute.get_scalars(%itup_1139) : !cute.int_tuple<"?{div=8}">
      %coord_1140 = cute.make_coord(%e3_1130) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1141 = cute.make_coord(%itup_1139) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %739 = cute.get_scalars(%coord_1140) : !cute.coord<"?{div=8}">
      %740 = cute.get_scalars(%coord_1141) : !cute.coord<"?{div=8}">
      %true_1142 = arith.constant true
      %741 = arith.cmpi slt, %739, %740 : i32
      %742 = arith.andi %true_1142, %741 : i1
      %743 = arith.extui %742 : i1 to i8
      %coord_1143 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1032, %coord_1143, %743) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1144 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1145 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1146 = cute.crd2idx(%coord_1144, %lay_1145) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1147 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1148 = cute.add_offset(%iter_1147, %idx_1146) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1149 = cute.make_view(%tup_1148) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1150 = cute.get_iter(%view_1149) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1151, %e1_1152, %e2_1153, %e3_1154 = cute.get_leaves(%iter_1150) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %744 = cute.get_scalars(%e0_1151) : !cute.int_tuple<"?">
      %745 = cute.get_scalars(%e1_1152) : !cute.int_tuple<"?">
      %746 = cute.get_scalars(%e2_1153) : !cute.int_tuple<"?">
      %747 = cute.get_scalars(%e3_1154) : !cute.int_tuple<"?{div=8}">
      %iter_1155 = cute.get_iter(%view_1149) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1156, %e1_1157, %e2_1158, %e3_1159 = cute.get_leaves(%iter_1155) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %748 = cute.get_scalars(%e0_1156) : !cute.int_tuple<"?">
      %749 = cute.get_scalars(%e1_1157) : !cute.int_tuple<"?">
      %750 = cute.get_scalars(%e2_1158) : !cute.int_tuple<"?">
      %751 = cute.get_scalars(%e3_1159) : !cute.int_tuple<"?{div=8}">
      %iter_1160 = cute.get_iter(%view_1149) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1161, %e1_1162, %e2_1163, %e3_1164 = cute.get_leaves(%iter_1160) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %752 = cute.get_scalars(%e0_1161) : !cute.int_tuple<"?">
      %753 = cute.get_scalars(%e1_1162) : !cute.int_tuple<"?">
      %754 = cute.get_scalars(%e2_1163) : !cute.int_tuple<"?">
      %755 = cute.get_scalars(%e3_1164) : !cute.int_tuple<"?{div=8}">
      %lay_1165 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %756 = cute.get_shape(%lay_1165) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1166, %e1_1167, %e2_1168, %e3_1169 = cute.get_leaves(%756) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1170 = cute.to_int_tuple(%e0_1166) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %757 = cute.get_scalars(%itup_1170) : !cute.int_tuple<"?">
      %itup_1171 = cute.to_int_tuple(%e1_1167) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %758 = cute.get_scalars(%itup_1171) : !cute.int_tuple<"?">
      %itup_1172 = cute.to_int_tuple(%e2_1168) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %759 = cute.get_scalars(%itup_1172) : !cute.int_tuple<"?">
      %itup_1173 = cute.to_int_tuple(%e3_1169) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %760 = cute.get_scalars(%itup_1173) : !cute.int_tuple<"?{div=8}">
      %coord_1174 = cute.make_coord(%e3_1164) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1175 = cute.make_coord(%itup_1173) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %761 = cute.get_scalars(%coord_1174) : !cute.coord<"?{div=8}">
      %762 = cute.get_scalars(%coord_1175) : !cute.coord<"?{div=8}">
      %true_1176 = arith.constant true
      %763 = arith.cmpi slt, %761, %762 : i32
      %764 = arith.andi %true_1176, %763 : i1
      %765 = arith.extui %764 : i1 to i8
      %coord_1177 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1032, %coord_1177, %765) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1178 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_1179 = cute.size(%int_tuple_1178) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_1180 = cute.get_leaves(%sz_1179) : !cute.int_tuple<"8">
      %coord_1181 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1182 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1183 = cute.crd2idx(%coord_1181, %lay_1182) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1184 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1185 = cute.add_offset(%iter_1184, %idx_1183) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1186 = cute.make_view(%tup_1185) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1187 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1188, %e1_1189, %e2_1190, %e3_1191 = cute.get_leaves(%iter_1187) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %766 = cute.get_scalars(%e0_1188) : !cute.int_tuple<"?">
      %767 = cute.get_scalars(%e1_1189) : !cute.int_tuple<"?">
      %768 = cute.get_scalars(%e2_1190) : !cute.int_tuple<"?">
      %769 = cute.get_scalars(%e3_1191) : !cute.int_tuple<"?{div=8}">
      %iter_1192 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1193, %e1_1194, %e2_1195, %e3_1196 = cute.get_leaves(%iter_1192) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %770 = cute.get_scalars(%e0_1193) : !cute.int_tuple<"?">
      %771 = cute.get_scalars(%e1_1194) : !cute.int_tuple<"?">
      %772 = cute.get_scalars(%e2_1195) : !cute.int_tuple<"?">
      %773 = cute.get_scalars(%e3_1196) : !cute.int_tuple<"?{div=8}">
      %iter_1197 = cute.get_iter(%view_1186) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1198, %e1_1199, %e2_1200, %e3_1201 = cute.get_leaves(%iter_1197) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %774 = cute.get_scalars(%e0_1198) : !cute.int_tuple<"?">
      %775 = cute.get_scalars(%e1_1199) : !cute.int_tuple<"?">
      %776 = cute.get_scalars(%e2_1200) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e3_1201) : !cute.int_tuple<"?{div=8}">
      %lay_1202 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %778 = cute.get_shape(%lay_1202) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1203, %e1_1204, %e2_1205, %e3_1206 = cute.get_leaves(%778) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1207 = cute.to_int_tuple(%e0_1203) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %779 = cute.get_scalars(%itup_1207) : !cute.int_tuple<"?">
      %itup_1208 = cute.to_int_tuple(%e1_1204) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %780 = cute.get_scalars(%itup_1208) : !cute.int_tuple<"?">
      %itup_1209 = cute.to_int_tuple(%e2_1205) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %781 = cute.get_scalars(%itup_1209) : !cute.int_tuple<"?">
      %itup_1210 = cute.to_int_tuple(%e3_1206) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %782 = cute.get_scalars(%itup_1210) : !cute.int_tuple<"?{div=8}">
      %coord_1211 = cute.make_coord(%e1_1199) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1212 = cute.make_coord(%itup_1208) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %783 = cute.get_scalars(%coord_1211) : !cute.coord<"?">
      %784 = cute.get_scalars(%coord_1212) : !cute.coord<"?">
      %true_1213 = arith.constant true
      %785 = arith.cmpi slt, %783, %784 : i32
      %786 = arith.andi %true_1213, %785 : i1
      scf.if %786 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1214 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1215 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1216 = cute.crd2idx(%coord_1214, %lay_1215) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1217 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1218 = cute.add_offset(%iter_1217, %idx_1216) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1219 = cute.make_view(%tup_1218) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1220 = cute.get_iter(%view_1219) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1221, %e1_1222, %e2_1223, %e3_1224 = cute.get_leaves(%iter_1220) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %787 = cute.get_scalars(%e0_1221) : !cute.int_tuple<"?">
      %788 = cute.get_scalars(%e1_1222) : !cute.int_tuple<"?">
      %789 = cute.get_scalars(%e2_1223) : !cute.int_tuple<"?">
      %790 = cute.get_scalars(%e3_1224) : !cute.int_tuple<"?{div=8}">
      %iter_1225 = cute.get_iter(%view_1219) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1226, %e1_1227, %e2_1228, %e3_1229 = cute.get_leaves(%iter_1225) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %791 = cute.get_scalars(%e0_1226) : !cute.int_tuple<"?">
      %792 = cute.get_scalars(%e1_1227) : !cute.int_tuple<"?">
      %793 = cute.get_scalars(%e2_1228) : !cute.int_tuple<"?">
      %794 = cute.get_scalars(%e3_1229) : !cute.int_tuple<"?{div=8}">
      %iter_1230 = cute.get_iter(%view_1219) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1231, %e1_1232, %e2_1233, %e3_1234 = cute.get_leaves(%iter_1230) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %795 = cute.get_scalars(%e0_1231) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e1_1232) : !cute.int_tuple<"?">
      %797 = cute.get_scalars(%e2_1233) : !cute.int_tuple<"?">
      %798 = cute.get_scalars(%e3_1234) : !cute.int_tuple<"?{div=8}">
      %lay_1235 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %799 = cute.get_shape(%lay_1235) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1236, %e1_1237, %e2_1238, %e3_1239 = cute.get_leaves(%799) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1240 = cute.to_int_tuple(%e0_1236) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %800 = cute.get_scalars(%itup_1240) : !cute.int_tuple<"?">
      %itup_1241 = cute.to_int_tuple(%e1_1237) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %801 = cute.get_scalars(%itup_1241) : !cute.int_tuple<"?">
      %itup_1242 = cute.to_int_tuple(%e2_1238) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %802 = cute.get_scalars(%itup_1242) : !cute.int_tuple<"?">
      %itup_1243 = cute.to_int_tuple(%e3_1239) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %803 = cute.get_scalars(%itup_1243) : !cute.int_tuple<"?{div=8}">
      %coord_1244 = cute.make_coord(%e1_1232) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1245 = cute.make_coord(%itup_1241) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %804 = cute.get_scalars(%coord_1244) : !cute.coord<"?">
      %805 = cute.get_scalars(%coord_1245) : !cute.coord<"?">
      %true_1246 = arith.constant true
      %806 = arith.cmpi slt, %804, %805 : i32
      %807 = arith.andi %true_1246, %806 : i1
      scf.if %807 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1247 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1248 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1249 = cute.crd2idx(%coord_1247, %lay_1248) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1250 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1251 = cute.add_offset(%iter_1250, %idx_1249) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1252 = cute.make_view(%tup_1251) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1253 = cute.get_iter(%view_1252) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1254, %e1_1255, %e2_1256, %e3_1257 = cute.get_leaves(%iter_1253) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %808 = cute.get_scalars(%e0_1254) : !cute.int_tuple<"?">
      %809 = cute.get_scalars(%e1_1255) : !cute.int_tuple<"?">
      %810 = cute.get_scalars(%e2_1256) : !cute.int_tuple<"?">
      %811 = cute.get_scalars(%e3_1257) : !cute.int_tuple<"?{div=8}">
      %iter_1258 = cute.get_iter(%view_1252) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1259, %e1_1260, %e2_1261, %e3_1262 = cute.get_leaves(%iter_1258) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %812 = cute.get_scalars(%e0_1259) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e1_1260) : !cute.int_tuple<"?">
      %814 = cute.get_scalars(%e2_1261) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e3_1262) : !cute.int_tuple<"?{div=8}">
      %iter_1263 = cute.get_iter(%view_1252) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1264, %e1_1265, %e2_1266, %e3_1267 = cute.get_leaves(%iter_1263) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %816 = cute.get_scalars(%e0_1264) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e1_1265) : !cute.int_tuple<"?">
      %818 = cute.get_scalars(%e2_1266) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e3_1267) : !cute.int_tuple<"?{div=8}">
      %lay_1268 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %820 = cute.get_shape(%lay_1268) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1269, %e1_1270, %e2_1271, %e3_1272 = cute.get_leaves(%820) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1273 = cute.to_int_tuple(%e0_1269) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %821 = cute.get_scalars(%itup_1273) : !cute.int_tuple<"?">
      %itup_1274 = cute.to_int_tuple(%e1_1270) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %822 = cute.get_scalars(%itup_1274) : !cute.int_tuple<"?">
      %itup_1275 = cute.to_int_tuple(%e2_1271) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %823 = cute.get_scalars(%itup_1275) : !cute.int_tuple<"?">
      %itup_1276 = cute.to_int_tuple(%e3_1272) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %824 = cute.get_scalars(%itup_1276) : !cute.int_tuple<"?{div=8}">
      %coord_1277 = cute.make_coord(%e1_1265) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1278 = cute.make_coord(%itup_1274) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %825 = cute.get_scalars(%coord_1277) : !cute.coord<"?">
      %826 = cute.get_scalars(%coord_1278) : !cute.coord<"?">
      %true_1279 = arith.constant true
      %827 = arith.cmpi slt, %825, %826 : i32
      %828 = arith.andi %true_1279, %827 : i1
      scf.if %828 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1280 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1281 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1282 = cute.crd2idx(%coord_1280, %lay_1281) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1283 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1284 = cute.add_offset(%iter_1283, %idx_1282) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1285 = cute.make_view(%tup_1284) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1286 = cute.get_iter(%view_1285) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1287, %e1_1288, %e2_1289, %e3_1290 = cute.get_leaves(%iter_1286) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %829 = cute.get_scalars(%e0_1287) : !cute.int_tuple<"?">
      %830 = cute.get_scalars(%e1_1288) : !cute.int_tuple<"?">
      %831 = cute.get_scalars(%e2_1289) : !cute.int_tuple<"?">
      %832 = cute.get_scalars(%e3_1290) : !cute.int_tuple<"?{div=8}">
      %iter_1291 = cute.get_iter(%view_1285) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1292, %e1_1293, %e2_1294, %e3_1295 = cute.get_leaves(%iter_1291) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %833 = cute.get_scalars(%e0_1292) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e1_1293) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e2_1294) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e3_1295) : !cute.int_tuple<"?{div=8}">
      %iter_1296 = cute.get_iter(%view_1285) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1297, %e1_1298, %e2_1299, %e3_1300 = cute.get_leaves(%iter_1296) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %837 = cute.get_scalars(%e0_1297) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_1298) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_1299) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_1300) : !cute.int_tuple<"?{div=8}">
      %lay_1301 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %841 = cute.get_shape(%lay_1301) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1302, %e1_1303, %e2_1304, %e3_1305 = cute.get_leaves(%841) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1306 = cute.to_int_tuple(%e0_1302) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %842 = cute.get_scalars(%itup_1306) : !cute.int_tuple<"?">
      %itup_1307 = cute.to_int_tuple(%e1_1303) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %843 = cute.get_scalars(%itup_1307) : !cute.int_tuple<"?">
      %itup_1308 = cute.to_int_tuple(%e2_1304) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %844 = cute.get_scalars(%itup_1308) : !cute.int_tuple<"?">
      %itup_1309 = cute.to_int_tuple(%e3_1305) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %845 = cute.get_scalars(%itup_1309) : !cute.int_tuple<"?{div=8}">
      %coord_1310 = cute.make_coord(%e1_1298) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1311 = cute.make_coord(%itup_1307) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %846 = cute.get_scalars(%coord_1310) : !cute.coord<"?">
      %847 = cute.get_scalars(%coord_1311) : !cute.coord<"?">
      %true_1312 = arith.constant true
      %848 = arith.cmpi slt, %846, %847 : i32
      %849 = arith.andi %true_1312, %848 : i1
      scf.if %849 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1313 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_1314 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1315 = cute.crd2idx(%coord_1313, %lay_1314) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_1316 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1317 = cute.add_offset(%iter_1316, %idx_1315) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1318 = cute.make_view(%tup_1317) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1319 = cute.get_iter(%view_1318) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1320, %e1_1321, %e2_1322, %e3_1323 = cute.get_leaves(%iter_1319) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %850 = cute.get_scalars(%e0_1320) : !cute.int_tuple<"?">
      %851 = cute.get_scalars(%e1_1321) : !cute.int_tuple<"?">
      %852 = cute.get_scalars(%e2_1322) : !cute.int_tuple<"?">
      %853 = cute.get_scalars(%e3_1323) : !cute.int_tuple<"?{div=8}">
      %iter_1324 = cute.get_iter(%view_1318) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1325, %e1_1326, %e2_1327, %e3_1328 = cute.get_leaves(%iter_1324) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %854 = cute.get_scalars(%e0_1325) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e1_1326) : !cute.int_tuple<"?">
      %856 = cute.get_scalars(%e2_1327) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e3_1328) : !cute.int_tuple<"?{div=8}">
      %iter_1329 = cute.get_iter(%view_1318) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1330, %e1_1331, %e2_1332, %e3_1333 = cute.get_leaves(%iter_1329) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %858 = cute.get_scalars(%e0_1330) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e1_1331) : !cute.int_tuple<"?">
      %860 = cute.get_scalars(%e2_1332) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e3_1333) : !cute.int_tuple<"?{div=8}">
      %lay_1334 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %862 = cute.get_shape(%lay_1334) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1335, %e1_1336, %e2_1337, %e3_1338 = cute.get_leaves(%862) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1339 = cute.to_int_tuple(%e0_1335) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %863 = cute.get_scalars(%itup_1339) : !cute.int_tuple<"?">
      %itup_1340 = cute.to_int_tuple(%e1_1336) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %864 = cute.get_scalars(%itup_1340) : !cute.int_tuple<"?">
      %itup_1341 = cute.to_int_tuple(%e2_1337) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %865 = cute.get_scalars(%itup_1341) : !cute.int_tuple<"?">
      %itup_1342 = cute.to_int_tuple(%e3_1338) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %866 = cute.get_scalars(%itup_1342) : !cute.int_tuple<"?{div=8}">
      %coord_1343 = cute.make_coord(%e1_1331) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1344 = cute.make_coord(%itup_1340) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %867 = cute.get_scalars(%coord_1343) : !cute.coord<"?">
      %868 = cute.get_scalars(%coord_1344) : !cute.coord<"?">
      %true_1345 = arith.constant true
      %869 = arith.cmpi slt, %867, %868 : i32
      %870 = arith.andi %true_1345, %869 : i1
      scf.if %870 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1346 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_1347 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1348 = cute.crd2idx(%coord_1346, %lay_1347) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_1349 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1350 = cute.add_offset(%iter_1349, %idx_1348) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1351 = cute.make_view(%tup_1350) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1352 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1353, %e1_1354, %e2_1355, %e3_1356 = cute.get_leaves(%iter_1352) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %871 = cute.get_scalars(%e0_1353) : !cute.int_tuple<"?">
      %872 = cute.get_scalars(%e1_1354) : !cute.int_tuple<"?">
      %873 = cute.get_scalars(%e2_1355) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e3_1356) : !cute.int_tuple<"?{div=8}">
      %iter_1357 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1358, %e1_1359, %e2_1360, %e3_1361 = cute.get_leaves(%iter_1357) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %875 = cute.get_scalars(%e0_1358) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e1_1359) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e2_1360) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e3_1361) : !cute.int_tuple<"?{div=8}">
      %iter_1362 = cute.get_iter(%view_1351) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1363, %e1_1364, %e2_1365, %e3_1366 = cute.get_leaves(%iter_1362) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %879 = cute.get_scalars(%e0_1363) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e1_1364) : !cute.int_tuple<"?">
      %881 = cute.get_scalars(%e2_1365) : !cute.int_tuple<"?">
      %882 = cute.get_scalars(%e3_1366) : !cute.int_tuple<"?{div=8}">
      %lay_1367 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %883 = cute.get_shape(%lay_1367) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1368, %e1_1369, %e2_1370, %e3_1371 = cute.get_leaves(%883) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1372 = cute.to_int_tuple(%e0_1368) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %884 = cute.get_scalars(%itup_1372) : !cute.int_tuple<"?">
      %itup_1373 = cute.to_int_tuple(%e1_1369) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %885 = cute.get_scalars(%itup_1373) : !cute.int_tuple<"?">
      %itup_1374 = cute.to_int_tuple(%e2_1370) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %886 = cute.get_scalars(%itup_1374) : !cute.int_tuple<"?">
      %itup_1375 = cute.to_int_tuple(%e3_1371) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %887 = cute.get_scalars(%itup_1375) : !cute.int_tuple<"?{div=8}">
      %coord_1376 = cute.make_coord(%e1_1364) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1377 = cute.make_coord(%itup_1373) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %888 = cute.get_scalars(%coord_1376) : !cute.coord<"?">
      %889 = cute.get_scalars(%coord_1377) : !cute.coord<"?">
      %true_1378 = arith.constant true
      %890 = arith.cmpi slt, %888, %889 : i32
      %891 = arith.andi %true_1378, %890 : i1
      scf.if %891 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1379 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_1380 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1381 = cute.crd2idx(%coord_1379, %lay_1380) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_1382 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1383 = cute.add_offset(%iter_1382, %idx_1381) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1384 = cute.make_view(%tup_1383) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1385 = cute.get_iter(%view_1384) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1386, %e1_1387, %e2_1388, %e3_1389 = cute.get_leaves(%iter_1385) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %892 = cute.get_scalars(%e0_1386) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e1_1387) : !cute.int_tuple<"?">
      %894 = cute.get_scalars(%e2_1388) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e3_1389) : !cute.int_tuple<"?{div=8}">
      %iter_1390 = cute.get_iter(%view_1384) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1391, %e1_1392, %e2_1393, %e3_1394 = cute.get_leaves(%iter_1390) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %896 = cute.get_scalars(%e0_1391) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e1_1392) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e2_1393) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e3_1394) : !cute.int_tuple<"?{div=8}">
      %iter_1395 = cute.get_iter(%view_1384) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1396, %e1_1397, %e2_1398, %e3_1399 = cute.get_leaves(%iter_1395) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %900 = cute.get_scalars(%e0_1396) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e1_1397) : !cute.int_tuple<"?">
      %902 = cute.get_scalars(%e2_1398) : !cute.int_tuple<"?">
      %903 = cute.get_scalars(%e3_1399) : !cute.int_tuple<"?{div=8}">
      %lay_1400 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %904 = cute.get_shape(%lay_1400) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1401, %e1_1402, %e2_1403, %e3_1404 = cute.get_leaves(%904) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1405 = cute.to_int_tuple(%e0_1401) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %905 = cute.get_scalars(%itup_1405) : !cute.int_tuple<"?">
      %itup_1406 = cute.to_int_tuple(%e1_1402) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %906 = cute.get_scalars(%itup_1406) : !cute.int_tuple<"?">
      %itup_1407 = cute.to_int_tuple(%e2_1403) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %907 = cute.get_scalars(%itup_1407) : !cute.int_tuple<"?">
      %itup_1408 = cute.to_int_tuple(%e3_1404) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %908 = cute.get_scalars(%itup_1408) : !cute.int_tuple<"?{div=8}">
      %coord_1409 = cute.make_coord(%e1_1397) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1410 = cute.make_coord(%itup_1406) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %909 = cute.get_scalars(%coord_1409) : !cute.coord<"?">
      %910 = cute.get_scalars(%coord_1410) : !cute.coord<"?">
      %true_1411 = arith.constant true
      %911 = arith.cmpi slt, %909, %910 : i32
      %912 = arith.andi %true_1411, %911 : i1
      scf.if %912 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %coord_1412 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_1413 = cute.get_layout(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1414 = cute.crd2idx(%coord_1412, %lay_1413) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_1415 = cute.get_iter(%view_975) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1416 = cute.add_offset(%iter_1415, %idx_1414) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1417 = cute.make_view(%tup_1416) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1418 = cute.get_iter(%view_1417) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1419, %e1_1420, %e2_1421, %e3_1422 = cute.get_leaves(%iter_1418) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %913 = cute.get_scalars(%e0_1419) : !cute.int_tuple<"?">
      %914 = cute.get_scalars(%e1_1420) : !cute.int_tuple<"?">
      %915 = cute.get_scalars(%e2_1421) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e3_1422) : !cute.int_tuple<"?{div=8}">
      %iter_1423 = cute.get_iter(%view_1417) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1424, %e1_1425, %e2_1426, %e3_1427 = cute.get_leaves(%iter_1423) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %917 = cute.get_scalars(%e0_1424) : !cute.int_tuple<"?">
      %918 = cute.get_scalars(%e1_1425) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e2_1426) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e3_1427) : !cute.int_tuple<"?{div=8}">
      %iter_1428 = cute.get_iter(%view_1417) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1429, %e1_1430, %e2_1431, %e3_1432 = cute.get_leaves(%iter_1428) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %921 = cute.get_scalars(%e0_1429) : !cute.int_tuple<"?">
      %922 = cute.get_scalars(%e1_1430) : !cute.int_tuple<"?">
      %923 = cute.get_scalars(%e2_1431) : !cute.int_tuple<"?">
      %924 = cute.get_scalars(%e3_1432) : !cute.int_tuple<"?{div=8}">
      %lay_1433 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %925 = cute.get_shape(%lay_1433) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1434, %e1_1435, %e2_1436, %e3_1437 = cute.get_leaves(%925) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1438 = cute.to_int_tuple(%e0_1434) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %926 = cute.get_scalars(%itup_1438) : !cute.int_tuple<"?">
      %itup_1439 = cute.to_int_tuple(%e1_1435) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %927 = cute.get_scalars(%itup_1439) : !cute.int_tuple<"?">
      %itup_1440 = cute.to_int_tuple(%e2_1436) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %928 = cute.get_scalars(%itup_1440) : !cute.int_tuple<"?">
      %itup_1441 = cute.to_int_tuple(%e3_1437) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %929 = cute.get_scalars(%itup_1441) : !cute.int_tuple<"?{div=8}">
      %coord_1442 = cute.make_coord(%e1_1430) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1443 = cute.make_coord(%itup_1439) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %930 = cute.get_scalars(%coord_1442) : !cute.coord<"?">
      %931 = cute.get_scalars(%coord_1443) : !cute.coord<"?">
      %true_1444 = arith.constant true
      %932 = arith.cmpi slt, %930, %931 : i32
      %933 = arith.andi %true_1444, %932 : i1
      scf.if %933 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8495 = cute.get_layout(%view_322) : !memref_gmem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_8497 = cute.get_iter(%view_322) : !memref_gmem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8502 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_8504 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_11
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_11
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8509 = cute.get_layout(%rmem_1012) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1012) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_11
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_11
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_11
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_11
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_12
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_12
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_12
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8495 = cute.get_layout(%view_358) : !memref_smem_bf16_3
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_8497 = cute.get_iter(%view_358) : !memref_smem_bf16_3
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_11
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_11
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_11
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_11
      }
      %int_tuple_1445 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1446 = cute.size(%int_tuple_1445) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1447 = cute.get_leaves(%sz_1446) : !cute.int_tuple<"4">
      %coord_1448 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1449 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1450 = cute.crd2idx(%coord_1448, %lay_1449) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1451 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1452 = cute.add_offset(%iter_1451, %idx_1450) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1453 = cute.make_view(%tup_1452) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1454 = cute.get_iter(%view_1453) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1455, %e1_1456, %e2_1457, %e3_1458 = cute.get_leaves(%iter_1454) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %934 = cute.get_scalars(%e0_1455) : !cute.int_tuple<"?">
      %935 = cute.get_scalars(%e1_1456) : !cute.int_tuple<"?">
      %936 = cute.get_scalars(%e2_1457) : !cute.int_tuple<"?">
      %937 = cute.get_scalars(%e3_1458) : !cute.int_tuple<"?{div=8}">
      %iter_1459 = cute.get_iter(%view_1453) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1460, %e1_1461, %e2_1462, %e3_1463 = cute.get_leaves(%iter_1459) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %938 = cute.get_scalars(%e0_1460) : !cute.int_tuple<"?">
      %939 = cute.get_scalars(%e1_1461) : !cute.int_tuple<"?">
      %940 = cute.get_scalars(%e2_1462) : !cute.int_tuple<"?">
      %941 = cute.get_scalars(%e3_1463) : !cute.int_tuple<"?{div=8}">
      %iter_1464 = cute.get_iter(%view_1453) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1465, %e1_1466, %e2_1467, %e3_1468 = cute.get_leaves(%iter_1464) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %942 = cute.get_scalars(%e0_1465) : !cute.int_tuple<"?">
      %943 = cute.get_scalars(%e1_1466) : !cute.int_tuple<"?">
      %944 = cute.get_scalars(%e2_1467) : !cute.int_tuple<"?">
      %945 = cute.get_scalars(%e3_1468) : !cute.int_tuple<"?{div=8}">
      %lay_1469 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %946 = cute.get_shape(%lay_1469) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1470, %e1_1471, %e2_1472, %e3_1473 = cute.get_leaves(%946) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1474 = cute.to_int_tuple(%e0_1470) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %947 = cute.get_scalars(%itup_1474) : !cute.int_tuple<"?">
      %itup_1475 = cute.to_int_tuple(%e1_1471) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %948 = cute.get_scalars(%itup_1475) : !cute.int_tuple<"?">
      %itup_1476 = cute.to_int_tuple(%e2_1472) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %949 = cute.get_scalars(%itup_1476) : !cute.int_tuple<"?">
      %itup_1477 = cute.to_int_tuple(%e3_1473) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %950 = cute.get_scalars(%itup_1477) : !cute.int_tuple<"?{div=8}">
      %coord_1478 = cute.make_coord(%e1_1466) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1479 = cute.make_coord(%itup_1475) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %951 = cute.get_scalars(%coord_1478) : !cute.coord<"?">
      %952 = cute.get_scalars(%coord_1479) : !cute.coord<"?">
      %true_1480 = arith.constant true
      %953 = arith.cmpi slt, %951, %952 : i32
      %954 = arith.andi %true_1480, %953 : i1
      scf.if %954 {
        %coord_8494 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,0,_,?)">
        %lay_8495 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8497 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8502 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_8504 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_14
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_14
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8509 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_14
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_14
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_15
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8495 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_8497 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_14
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_14
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_14
      }
      %coord_1481 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1482 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1483 = cute.crd2idx(%coord_1481, %lay_1482) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1484 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1485 = cute.add_offset(%iter_1484, %idx_1483) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1486 = cute.make_view(%tup_1485) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1487 = cute.get_iter(%view_1486) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1488, %e1_1489, %e2_1490, %e3_1491 = cute.get_leaves(%iter_1487) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %955 = cute.get_scalars(%e0_1488) : !cute.int_tuple<"?">
      %956 = cute.get_scalars(%e1_1489) : !cute.int_tuple<"?">
      %957 = cute.get_scalars(%e2_1490) : !cute.int_tuple<"?">
      %958 = cute.get_scalars(%e3_1491) : !cute.int_tuple<"?{div=8}">
      %iter_1492 = cute.get_iter(%view_1486) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1493, %e1_1494, %e2_1495, %e3_1496 = cute.get_leaves(%iter_1492) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %959 = cute.get_scalars(%e0_1493) : !cute.int_tuple<"?">
      %960 = cute.get_scalars(%e1_1494) : !cute.int_tuple<"?">
      %961 = cute.get_scalars(%e2_1495) : !cute.int_tuple<"?">
      %962 = cute.get_scalars(%e3_1496) : !cute.int_tuple<"?{div=8}">
      %iter_1497 = cute.get_iter(%view_1486) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1498, %e1_1499, %e2_1500, %e3_1501 = cute.get_leaves(%iter_1497) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %963 = cute.get_scalars(%e0_1498) : !cute.int_tuple<"?">
      %964 = cute.get_scalars(%e1_1499) : !cute.int_tuple<"?">
      %965 = cute.get_scalars(%e2_1500) : !cute.int_tuple<"?">
      %966 = cute.get_scalars(%e3_1501) : !cute.int_tuple<"?{div=8}">
      %lay_1502 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %967 = cute.get_shape(%lay_1502) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1503, %e1_1504, %e2_1505, %e3_1506 = cute.get_leaves(%967) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1507 = cute.to_int_tuple(%e0_1503) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %968 = cute.get_scalars(%itup_1507) : !cute.int_tuple<"?">
      %itup_1508 = cute.to_int_tuple(%e1_1504) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %969 = cute.get_scalars(%itup_1508) : !cute.int_tuple<"?">
      %itup_1509 = cute.to_int_tuple(%e2_1505) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %970 = cute.get_scalars(%itup_1509) : !cute.int_tuple<"?">
      %itup_1510 = cute.to_int_tuple(%e3_1506) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %971 = cute.get_scalars(%itup_1510) : !cute.int_tuple<"?{div=8}">
      %coord_1511 = cute.make_coord(%e1_1499) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1512 = cute.make_coord(%itup_1508) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %972 = cute.get_scalars(%coord_1511) : !cute.coord<"?">
      %973 = cute.get_scalars(%coord_1512) : !cute.coord<"?">
      %true_1513 = arith.constant true
      %974 = arith.cmpi slt, %972, %973 : i32
      %975 = arith.andi %true_1513, %974 : i1
      scf.if %975 {
        %coord_8494 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,1,_,?)">
        %lay_8495 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8497 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8502 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_8504 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_14
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_14
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8509 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_14
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_14
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_15
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8495 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_8497 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_14
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_14
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_14
      }
      %coord_1514 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1515 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1516 = cute.crd2idx(%coord_1514, %lay_1515) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1517 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1518 = cute.add_offset(%iter_1517, %idx_1516) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1519 = cute.make_view(%tup_1518) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1520 = cute.get_iter(%view_1519) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1521, %e1_1522, %e2_1523, %e3_1524 = cute.get_leaves(%iter_1520) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %976 = cute.get_scalars(%e0_1521) : !cute.int_tuple<"?">
      %977 = cute.get_scalars(%e1_1522) : !cute.int_tuple<"?">
      %978 = cute.get_scalars(%e2_1523) : !cute.int_tuple<"?">
      %979 = cute.get_scalars(%e3_1524) : !cute.int_tuple<"?{div=8}">
      %iter_1525 = cute.get_iter(%view_1519) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1526, %e1_1527, %e2_1528, %e3_1529 = cute.get_leaves(%iter_1525) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %980 = cute.get_scalars(%e0_1526) : !cute.int_tuple<"?">
      %981 = cute.get_scalars(%e1_1527) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e2_1528) : !cute.int_tuple<"?">
      %983 = cute.get_scalars(%e3_1529) : !cute.int_tuple<"?{div=8}">
      %iter_1530 = cute.get_iter(%view_1519) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1531, %e1_1532, %e2_1533, %e3_1534 = cute.get_leaves(%iter_1530) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %984 = cute.get_scalars(%e0_1531) : !cute.int_tuple<"?">
      %985 = cute.get_scalars(%e1_1532) : !cute.int_tuple<"?">
      %986 = cute.get_scalars(%e2_1533) : !cute.int_tuple<"?">
      %987 = cute.get_scalars(%e3_1534) : !cute.int_tuple<"?{div=8}">
      %lay_1535 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %988 = cute.get_shape(%lay_1535) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1536, %e1_1537, %e2_1538, %e3_1539 = cute.get_leaves(%988) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1540 = cute.to_int_tuple(%e0_1536) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %989 = cute.get_scalars(%itup_1540) : !cute.int_tuple<"?">
      %itup_1541 = cute.to_int_tuple(%e1_1537) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %990 = cute.get_scalars(%itup_1541) : !cute.int_tuple<"?">
      %itup_1542 = cute.to_int_tuple(%e2_1538) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %991 = cute.get_scalars(%itup_1542) : !cute.int_tuple<"?">
      %itup_1543 = cute.to_int_tuple(%e3_1539) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %992 = cute.get_scalars(%itup_1543) : !cute.int_tuple<"?{div=8}">
      %coord_1544 = cute.make_coord(%e1_1532) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1545 = cute.make_coord(%itup_1541) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %993 = cute.get_scalars(%coord_1544) : !cute.coord<"?">
      %994 = cute.get_scalars(%coord_1545) : !cute.coord<"?">
      %true_1546 = arith.constant true
      %995 = arith.cmpi slt, %993, %994 : i32
      %996 = arith.andi %true_1546, %995 : i1
      scf.if %996 {
        %coord_8494 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,2,_,?)">
        %lay_8495 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8497 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8502 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_8504 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_14
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_14
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8509 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_14
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_14
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_15
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8495 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_8497 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_14
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_14
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_14
      }
      %coord_1547 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1548 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1549 = cute.crd2idx(%coord_1547, %lay_1548) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1550 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1551 = cute.add_offset(%iter_1550, %idx_1549) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1552 = cute.make_view(%tup_1551) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1553 = cute.get_iter(%view_1552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1554, %e1_1555, %e2_1556, %e3_1557 = cute.get_leaves(%iter_1553) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %997 = cute.get_scalars(%e0_1554) : !cute.int_tuple<"?">
      %998 = cute.get_scalars(%e1_1555) : !cute.int_tuple<"?">
      %999 = cute.get_scalars(%e2_1556) : !cute.int_tuple<"?">
      %1000 = cute.get_scalars(%e3_1557) : !cute.int_tuple<"?{div=8}">
      %iter_1558 = cute.get_iter(%view_1552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1559, %e1_1560, %e2_1561, %e3_1562 = cute.get_leaves(%iter_1558) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1001 = cute.get_scalars(%e0_1559) : !cute.int_tuple<"?">
      %1002 = cute.get_scalars(%e1_1560) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e2_1561) : !cute.int_tuple<"?">
      %1004 = cute.get_scalars(%e3_1562) : !cute.int_tuple<"?{div=8}">
      %iter_1563 = cute.get_iter(%view_1552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1564, %e1_1565, %e2_1566, %e3_1567 = cute.get_leaves(%iter_1563) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1005 = cute.get_scalars(%e0_1564) : !cute.int_tuple<"?">
      %1006 = cute.get_scalars(%e1_1565) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e2_1566) : !cute.int_tuple<"?">
      %1008 = cute.get_scalars(%e3_1567) : !cute.int_tuple<"?{div=8}">
      %lay_1568 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1009 = cute.get_shape(%lay_1568) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1569, %e1_1570, %e2_1571, %e3_1572 = cute.get_leaves(%1009) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1573 = cute.to_int_tuple(%e0_1569) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1010 = cute.get_scalars(%itup_1573) : !cute.int_tuple<"?">
      %itup_1574 = cute.to_int_tuple(%e1_1570) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%itup_1574) : !cute.int_tuple<"?">
      %itup_1575 = cute.to_int_tuple(%e2_1571) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1012 = cute.get_scalars(%itup_1575) : !cute.int_tuple<"?">
      %itup_1576 = cute.to_int_tuple(%e3_1572) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1013 = cute.get_scalars(%itup_1576) : !cute.int_tuple<"?{div=8}">
      %coord_1577 = cute.make_coord(%e1_1565) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1578 = cute.make_coord(%itup_1574) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1014 = cute.get_scalars(%coord_1577) : !cute.coord<"?">
      %1015 = cute.get_scalars(%coord_1578) : !cute.coord<"?">
      %true_1579 = arith.constant true
      %1016 = arith.cmpi slt, %1014, %1015 : i32
      %1017 = arith.andi %true_1579, %1016 : i1
      scf.if %1017 {
        %coord_8494 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,3,_,?)">
        %lay_8495 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8497 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_gmem_bf16_6
        %iter_8500 = cute.get_iter(%view_8499) : !memref_gmem_bf16_6
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8502 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_8504 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_smem_bf16_14
        %iter_8507 = cute.get_iter(%view_8506) : !memref_smem_bf16_14
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8509 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_gmem_bf16_6
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_gmem_bf16_6
        %iter_8528 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %lay_8529 = cute.get_layout(%view_8527) : !memref_gmem_bf16_6
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_gmem_bf16_6
        %view_8534 = cute.make_view(%iter_8533) : !memref_gmem_bf16_7
        %iter_8535 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8536 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %lay_8537 = cute.get_layout(%view_8506) : !memref_smem_bf16_14
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_smem_bf16_14
        %iter_8542 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %lay_8543 = cute.get_layout(%view_8541) : !memref_smem_bf16_14
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_smem_bf16_14
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_15
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_gmem_bf16_7
        %iter_8579 = cute.get_iter(%view_8548) : !memref_smem_bf16_15
        %lay_8580 = cute.get_layout(%view_8534) : !memref_gmem_bf16_7
        %lay_8581 = cute.get_layout(%view_8548) : !memref_smem_bf16_15
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_gmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_smem_bf16_13
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_gmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_smem_bf16_13
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.trunc %3383 : i8 to i1
          %iter_8609 = cute.recast_iter(%iter_8606) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8610 = cute.recast_iter(%iter_8607) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8610 : !cute.ptr<i128, smem>, %iter_8609 : !cute.ptr<i128, gmem>, %3384 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8495 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_8497 = cute.get_iter(%view_422) : !memref_smem_bf16_4
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_smem_bf16_14
        %iter_8500 = cute.get_iter(%view_8499) : !memref_smem_bf16_14
        %lay_8501 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %sz_8502 = cute.size(%lay_8501) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8503 = cute.get_leaves(%sz_8502) : !cute.int_tuple<"16">
        %lay_8504 = cute.get_layout(%view_8499) : !memref_smem_bf16_14
        %3370 = cute.get_shape(%lay_8504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8505, %e1_8506, %e2_8507 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %int_tuple_8508 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8510 = cute.get_leaves(%int_tuple_8509) : !cute.int_tuple<"16">
        %cst_8511 = arith.constant 0.000000e+00 : bf16
        %3371 = vector.splat %cst_8511 : vector<16xbf16>
        %int_tuple_8512 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8513 = cute.size(%int_tuple_8512) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8514 = cute.get_leaves(%sz_8513) : !cute.int_tuple<"16">
        %int_tuple_8515 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8516 = cute.size(%int_tuple_8515) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8517 = cute.get_leaves(%sz_8516) : !cute.int_tuple<"16">
        cute.memref.store_vec %3371, %view_8499, row_major : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %shape_1580 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1581 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1582 = cute.memref.alloca(%lay_1581) : !memref_rmem_f32_1
      %iter_1583 = cute.get_iter(%rmem_1582) : !memref_rmem_f32_1
      %iter_1584 = cute.get_iter(%rmem_1582) : !memref_rmem_f32_1
      %shape_1585 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1586 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1587 = cute.memref.alloca(%lay_1586) : !memref_rmem_f32_1
      %iter_1588 = cute.get_iter(%rmem_1587) : !memref_rmem_f32_1
      %iter_1589 = cute.get_iter(%rmem_1587) : !memref_rmem_f32_1
      %lay_1590 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
      %sz_1591 = cute.size(%lay_1590) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1592 = cute.get_leaves(%sz_1591) : !cute.int_tuple<"4">
      %lay_1593 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
      %1018 = cute.get_shape(%lay_1593) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1594 = cute.get_leaves(%1018) : !cute.shape<"4">
      %cst_1595 = arith.constant 0xFF800000 : f32
      %1019 = vector.splat %cst_1595 : vector<4xf32>
      %int_tuple_1596 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1597 = cute.size(%int_tuple_1596) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1598 = cute.get_leaves(%sz_1597) : !cute.int_tuple<"4">
      %int_tuple_1599 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1600 = cute.size(%int_tuple_1599) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1601 = cute.get_leaves(%sz_1600) : !cute.int_tuple<"4">
      cute.memref.store_vec %1019, %rmem_1582, row_major : !memref_rmem_f32_1
      %lay_1602 = cute.get_layout(%rmem_1587) : !memref_rmem_f32_1
      %sz_1603 = cute.size(%lay_1602) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1604 = cute.get_leaves(%sz_1603) : !cute.int_tuple<"4">
      %lay_1605 = cute.get_layout(%rmem_1587) : !memref_rmem_f32_1
      %1020 = cute.get_shape(%lay_1605) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1606 = cute.get_leaves(%1020) : !cute.shape<"4">
      %cst_1607 = arith.constant 0.000000e+00 : f32
      %1021 = vector.splat %cst_1607 : vector<4xf32>
      %int_tuple_1608 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1609 = cute.size(%int_tuple_1608) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1610 = cute.get_leaves(%sz_1609) : !cute.int_tuple<"4">
      %int_tuple_1611 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1612 = cute.size(%int_tuple_1611) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1613 = cute.get_leaves(%sz_1612) : !cute.int_tuple<"4">
      cute.memref.store_vec %1021, %rmem_1587, row_major : !memref_rmem_f32_1
      %c0_i32_1614 = arith.constant 0 : i32
      %1022 = arith.subi %128, %c0_i32_1614 : i32
      %1023 = arith.subi %1022, %c1_i32 : i32
      %shape_1615 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %shape_1616 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %e0_1617, %e1_1618, %e2_1619, %e3_1620 = cute.get_leaves(%shape_1616) : !cute.shape<"((2,2),2,8)">
      %shape_1621 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_1622 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_1623 = cute.memref.alloca(%lay_1622) : !memref_rmem_f32_2
      %iter_1624 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_1625 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_1626 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %sz_1627 = cute.size(%lay_1626) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
      %e0_1628 = cute.get_leaves(%sz_1627) : !cute.int_tuple<"64">
      %lay_1629 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1024 = cute.get_shape(%lay_1629) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1630, %e1_1631, %e2_1632, %e3_1633 = cute.get_leaves(%1024) : !cute.shape<"((2,2),2,8)">
      %int_tuple_1634 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %int_tuple_1635 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
      %e0_1636 = cute.get_leaves(%int_tuple_1635) : !cute.int_tuple<"64">
      %cst_1637 = arith.constant 0.000000e+00 : f32
      %1025 = vector.splat %cst_1637 : vector<64xf32>
      %int_tuple_1638 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1639 = cute.size(%int_tuple_1638) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1640 = cute.get_leaves(%sz_1639) : !cute.int_tuple<"64">
      %int_tuple_1641 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1642 = cute.size(%int_tuple_1641) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1643 = cute.get_leaves(%sz_1642) : !cute.int_tuple<"64">
      cute.memref.store_vec %1025, %rmem_1623, row_major : !memref_rmem_f32_2
      nvvm.cp.async.wait.group 0
      %c1_i32_1644 = arith.constant 1 : i32
      %c128_i32_1645 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1644 number_of_threads = %c128_i32_1645
      %true_1646 = arith.constant true
      scf.if %true_1646 {
        %lay_8494 = cute.get_layout(%view_486) : !memref_smem_bf16_4
        %3370 = cute.get_shape(%lay_8494) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8495, %e1_8496, %e2_8497, %e3_8498 = cute.get_leaves(%3370) : !cute.shape<"((8,1),4,2)">
        %int_tuple_8499 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_8500 = cute.size(%int_tuple_8499) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_8501 = cute.get_leaves(%sz_8500) : !cute.int_tuple<"4">
        %coord_8502 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
        %lay_8503 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8504 = cute.crd2idx(%coord_8502, %lay_8503) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
        %iter_8505 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8506 = cute.add_offset(%iter_8505, %idx_8504) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8507 = cute.make_view(%tup_8506) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8508 = cute.get_iter(%view_8507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8509, %e1_8510, %e2_8511, %e3_8512 = cute.get_leaves(%iter_8508) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3371 = cute.get_scalars(%e0_8509) : !cute.int_tuple<"?">
        %3372 = cute.get_scalars(%e1_8510) : !cute.int_tuple<"?">
        %3373 = cute.get_scalars(%e2_8511) : !cute.int_tuple<"?">
        %3374 = cute.get_scalars(%e3_8512) : !cute.int_tuple<"?{div=8}">
        %iter_8513 = cute.get_iter(%view_8507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8514, %e1_8515, %e2_8516, %e3_8517 = cute.get_leaves(%iter_8513) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3375 = cute.get_scalars(%e0_8514) : !cute.int_tuple<"?">
        %3376 = cute.get_scalars(%e1_8515) : !cute.int_tuple<"?">
        %3377 = cute.get_scalars(%e2_8516) : !cute.int_tuple<"?">
        %3378 = cute.get_scalars(%e3_8517) : !cute.int_tuple<"?{div=8}">
        %iter_8518 = cute.get_iter(%view_8507) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8519, %e1_8520, %e2_8521, %e3_8522 = cute.get_leaves(%iter_8518) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3379 = cute.get_scalars(%e0_8519) : !cute.int_tuple<"?">
        %3380 = cute.get_scalars(%e1_8520) : !cute.int_tuple<"?">
        %3381 = cute.get_scalars(%e2_8521) : !cute.int_tuple<"?">
        %3382 = cute.get_scalars(%e3_8522) : !cute.int_tuple<"?{div=8}">
        %lay_8523 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3383 = cute.get_shape(%lay_8523) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8524, %e1_8525, %e2_8526, %e3_8527 = cute.get_leaves(%3383) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8528 = cute.to_int_tuple(%e0_8524) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3384 = cute.get_scalars(%itup_8528) : !cute.int_tuple<"?">
        %itup_8529 = cute.to_int_tuple(%e1_8525) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3385 = cute.get_scalars(%itup_8529) : !cute.int_tuple<"?">
        %itup_8530 = cute.to_int_tuple(%e2_8526) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3386 = cute.get_scalars(%itup_8530) : !cute.int_tuple<"?">
        %itup_8531 = cute.to_int_tuple(%e3_8527) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3387 = cute.get_scalars(%itup_8531) : !cute.int_tuple<"?{div=8}">
        %coord_8532 = cute.make_coord(%e1_8520) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8533 = cute.make_coord(%itup_8529) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3388 = cute.get_scalars(%coord_8532) : !cute.coord<"?">
        %3389 = cute.get_scalars(%coord_8533) : !cute.coord<"?">
        %true_8534 = arith.constant true
        %3390 = arith.cmpi slt, %3388, %3389 : i32
        %3391 = arith.andi %true_8534, %3390 : i1
        scf.if %3391 {
          %coord_8634 = cute.make_coord(%1023) : (i32) -> !cute.coord<"(_,0,_,?)">
          %lay_8635 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_8637 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_gmem_bf16_6
          %iter_8640 = cute.get_iter(%view_8639) : !memref_gmem_bf16_6
          %coord_8641 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8642 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8643 = cute.crd2idx(%coord_8641, %lay_8642) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_8644 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8645 = cute.add_offset(%iter_8644, %idx_8643) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8646 = cute.make_view(%ptr_8645) : !memref_smem_bf16_14
          %iter_8647 = cute.get_iter(%view_8646) : !memref_smem_bf16_14
          %coord_8648 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8649 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %idx_8650 = cute.crd2idx(%coord_8648, %lay_8649) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8651 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
          %ptr_8652 = cute.add_offset(%iter_8651, %idx_8650) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8653 = cute.make_view(%ptr_8652) : !memref_rmem_i8_2
          %iter_8654 = cute.get_iter(%view_8653) : !memref_rmem_i8_2
          %lay_8655 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %3455 = cute.get_shape(%lay_8655) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8656, %e1_8657, %e2_8658 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %lay_8659 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %3456 = cute.get_shape(%lay_8659) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8660, %e1_8661, %e2_8662 = cute.get_leaves(%3456) : !cute.shape<"((8,1),2)">
          %lay_8663 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %shape_8664 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8665 = cute.make_layout() : !cute.layout<"1:0">
          %append_8666 = cute.append_to_rank<2> (%lay_8663, %lay_8665) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8667 = cute.make_view(%iter_8640, %append_8666) : !memref_gmem_bf16_6
          %iter_8668 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %lay_8669 = cute.get_layout(%view_8667) : !memref_gmem_bf16_6
          %3457 = cute.get_shape(%lay_8669) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8670, %e1_8671, %e2_8672 = cute.get_leaves(%3457) : !cute.shape<"((8,1),2)">
          %iter_8673 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %view_8674 = cute.make_view(%iter_8673) : !memref_gmem_bf16_7
          %iter_8675 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8676 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %lay_8677 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %shape_8678 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8679 = cute.make_layout() : !cute.layout<"1:0">
          %append_8680 = cute.append_to_rank<2> (%lay_8677, %lay_8679) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8681 = cute.make_view(%iter_8647, %append_8680) : !memref_smem_bf16_14
          %iter_8682 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %lay_8683 = cute.get_layout(%view_8681) : !memref_smem_bf16_14
          %3458 = cute.get_shape(%lay_8683) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8684, %e1_8685, %e2_8686 = cute.get_leaves(%3458) : !cute.shape<"((8,1),2)">
          %iter_8687 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %view_8688 = cute.make_view(%iter_8687) : !memref_smem_bf16_15
          %iter_8689 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %iter_8690 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8691 = cute.get_layout(%view_8653) : !memref_rmem_i8_2
          %shape_8692 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8693 = cute.make_layout() : !cute.layout<"1:0">
          %append_8694 = cute.append_to_rank<2> (%lay_8691, %lay_8693) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8695 = cute.make_view(%iter_8654, %append_8694) : !memref_rmem_i8_2
          %iter_8696 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %lay_8697 = cute.get_layout(%view_8695) : !memref_rmem_i8_2
          %3459 = cute.get_shape(%lay_8697) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8698, %e1_8699 = cute.get_leaves(%3459) : !cute.shape<"(1,2)">
          %iter_8700 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %view_8701 = cute.make_view(%iter_8700) : !memref_rmem_i8_3
          %iter_8702 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %iter_8703 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8704 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %3460 = cute.get_shape(%lay_8704) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8705, %e1_8706, %e2_8707 = cute.get_leaves(%3460) : !cute.shape<"((8,1),(2))">
          %lay_8708 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %3461 = cute.get_shape(%lay_8708) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8709, %e1_8710, %e2_8711 = cute.get_leaves(%3461) : !cute.shape<"((8,1),(2))">
          %lay_8712 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %sz_8713 = cute.size(%lay_8712) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8714 = cute.get_leaves(%sz_8713) : !cute.int_tuple<"2">
          %lay_8715 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %sz_8716 = cute.size(%lay_8715) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8717 = cute.get_leaves(%sz_8716) : !cute.int_tuple<"2">
          %3462 = cute.static : !cute.layout<"1:0">
          %iter_8718 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8719 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8720 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %lay_8721 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %append_8722 = cute.append_to_rank<2> (%lay_8720, %3462) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8723 = cute.append_to_rank<2> (%lay_8721, %3462) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8724 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8725 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8726 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8727 = cute.get_layout(%view_8701) : !memref_rmem_i8_3
          %append_8728 = cute.append_to_rank<2> (%lay_8727, %3462) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8729 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8730 = cute.size(%lay_8724) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3463 = cute.get_scalars(%sz_8730) : !cute.int_tuple<"2">
          %c0_i32_8731 = arith.constant 0 : i32
          %c1_i32_8732 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8731 to %3463 step %c1_i32_8732  : i32 {
            %coord_8733 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3464 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8734 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8735 = cute.crd2idx(%coord_8733, %lay_8724) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8736 = cute.add_offset(%iter_8718, %idx_8735) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8737 = cute.make_view(%ptr_8736, %lay_8734) : !memref_gmem_bf16_8
            %3465 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8738 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8739 = cute.crd2idx(%coord_8733, %lay_8725) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8740 = cute.add_offset(%iter_8719, %idx_8739) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8741 = cute.make_view(%ptr_8740, %lay_8738) : !memref_smem_bf16_13
            %3466 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8742 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8743 = cute.crd2idx(%coord_8733, %lay_8729) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8744 = cute.add_offset(%iter_8726, %idx_8743) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8745 = cute.make_view(%ptr_8744, %lay_8742) : !memref_rmem_i8_4
            %iter_8746 = cute.get_iter(%view_8737) : !memref_gmem_bf16_8
            %iter_8747 = cute.get_iter(%view_8741) : !memref_smem_bf16_13
            %iter_8748 = cute.get_iter(%view_8745) : !memref_rmem_i8_4
            %3467 = builtin.unrealized_conversion_cast %iter_8748 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3468 = llvm.load %3467 : !llvm.ptr -> i8
            %3469 = llvm.trunc %3468 : i8 to i1
            %iter_8749 = cute.recast_iter(%iter_8746) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8750 = cute.recast_iter(%iter_8747) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8750 : !cute.ptr<i128, smem>, %iter_8749 : !cute.ptr<i128, gmem>, %3469 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8634 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8635 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_8637 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_smem_bf16_14
          %iter_8640 = cute.get_iter(%view_8639) : !memref_smem_bf16_14
          %lay_8641 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %sz_8642 = cute.size(%lay_8641) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8643 = cute.get_leaves(%sz_8642) : !cute.int_tuple<"16">
          %lay_8644 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %3455 = cute.get_shape(%lay_8644) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8645, %e1_8646, %e2_8647 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %int_tuple_8648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8649 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8650 = cute.get_leaves(%int_tuple_8649) : !cute.int_tuple<"16">
          %cst_8651 = arith.constant 0.000000e+00 : bf16
          %3456 = vector.splat %cst_8651 : vector<16xbf16>
          %int_tuple_8652 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8653 = cute.size(%int_tuple_8652) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"16">
          %int_tuple_8655 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8656 = cute.size(%int_tuple_8655) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8657 = cute.get_leaves(%sz_8656) : !cute.int_tuple<"16">
          cute.memref.store_vec %3456, %view_8639, row_major : !memref_smem_bf16_14
        }
        %coord_8535 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
        %lay_8536 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8537 = cute.crd2idx(%coord_8535, %lay_8536) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
        %iter_8538 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8539 = cute.add_offset(%iter_8538, %idx_8537) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8540 = cute.make_view(%tup_8539) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8541 = cute.get_iter(%view_8540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8542, %e1_8543, %e2_8544, %e3_8545 = cute.get_leaves(%iter_8541) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3392 = cute.get_scalars(%e0_8542) : !cute.int_tuple<"?">
        %3393 = cute.get_scalars(%e1_8543) : !cute.int_tuple<"?">
        %3394 = cute.get_scalars(%e2_8544) : !cute.int_tuple<"?">
        %3395 = cute.get_scalars(%e3_8545) : !cute.int_tuple<"?{div=8}">
        %iter_8546 = cute.get_iter(%view_8540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8547, %e1_8548, %e2_8549, %e3_8550 = cute.get_leaves(%iter_8546) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3396 = cute.get_scalars(%e0_8547) : !cute.int_tuple<"?">
        %3397 = cute.get_scalars(%e1_8548) : !cute.int_tuple<"?">
        %3398 = cute.get_scalars(%e2_8549) : !cute.int_tuple<"?">
        %3399 = cute.get_scalars(%e3_8550) : !cute.int_tuple<"?{div=8}">
        %iter_8551 = cute.get_iter(%view_8540) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8552, %e1_8553, %e2_8554, %e3_8555 = cute.get_leaves(%iter_8551) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3400 = cute.get_scalars(%e0_8552) : !cute.int_tuple<"?">
        %3401 = cute.get_scalars(%e1_8553) : !cute.int_tuple<"?">
        %3402 = cute.get_scalars(%e2_8554) : !cute.int_tuple<"?">
        %3403 = cute.get_scalars(%e3_8555) : !cute.int_tuple<"?{div=8}">
        %lay_8556 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3404 = cute.get_shape(%lay_8556) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8557, %e1_8558, %e2_8559, %e3_8560 = cute.get_leaves(%3404) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8561 = cute.to_int_tuple(%e0_8557) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3405 = cute.get_scalars(%itup_8561) : !cute.int_tuple<"?">
        %itup_8562 = cute.to_int_tuple(%e1_8558) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3406 = cute.get_scalars(%itup_8562) : !cute.int_tuple<"?">
        %itup_8563 = cute.to_int_tuple(%e2_8559) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3407 = cute.get_scalars(%itup_8563) : !cute.int_tuple<"?">
        %itup_8564 = cute.to_int_tuple(%e3_8560) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3408 = cute.get_scalars(%itup_8564) : !cute.int_tuple<"?{div=8}">
        %coord_8565 = cute.make_coord(%e1_8553) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8566 = cute.make_coord(%itup_8562) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3409 = cute.get_scalars(%coord_8565) : !cute.coord<"?">
        %3410 = cute.get_scalars(%coord_8566) : !cute.coord<"?">
        %true_8567 = arith.constant true
        %3411 = arith.cmpi slt, %3409, %3410 : i32
        %3412 = arith.andi %true_8567, %3411 : i1
        scf.if %3412 {
          %coord_8634 = cute.make_coord(%1023) : (i32) -> !cute.coord<"(_,1,_,?)">
          %lay_8635 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_8637 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_gmem_bf16_6
          %iter_8640 = cute.get_iter(%view_8639) : !memref_gmem_bf16_6
          %coord_8641 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8642 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8643 = cute.crd2idx(%coord_8641, %lay_8642) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_8644 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8645 = cute.add_offset(%iter_8644, %idx_8643) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8646 = cute.make_view(%ptr_8645) : !memref_smem_bf16_14
          %iter_8647 = cute.get_iter(%view_8646) : !memref_smem_bf16_14
          %coord_8648 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8649 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %idx_8650 = cute.crd2idx(%coord_8648, %lay_8649) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8651 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
          %ptr_8652 = cute.add_offset(%iter_8651, %idx_8650) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8653 = cute.make_view(%ptr_8652) : !memref_rmem_i8_2
          %iter_8654 = cute.get_iter(%view_8653) : !memref_rmem_i8_2
          %lay_8655 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %3455 = cute.get_shape(%lay_8655) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8656, %e1_8657, %e2_8658 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %lay_8659 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %3456 = cute.get_shape(%lay_8659) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8660, %e1_8661, %e2_8662 = cute.get_leaves(%3456) : !cute.shape<"((8,1),2)">
          %lay_8663 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %shape_8664 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8665 = cute.make_layout() : !cute.layout<"1:0">
          %append_8666 = cute.append_to_rank<2> (%lay_8663, %lay_8665) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8667 = cute.make_view(%iter_8640, %append_8666) : !memref_gmem_bf16_6
          %iter_8668 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %lay_8669 = cute.get_layout(%view_8667) : !memref_gmem_bf16_6
          %3457 = cute.get_shape(%lay_8669) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8670, %e1_8671, %e2_8672 = cute.get_leaves(%3457) : !cute.shape<"((8,1),2)">
          %iter_8673 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %view_8674 = cute.make_view(%iter_8673) : !memref_gmem_bf16_7
          %iter_8675 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8676 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %lay_8677 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %shape_8678 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8679 = cute.make_layout() : !cute.layout<"1:0">
          %append_8680 = cute.append_to_rank<2> (%lay_8677, %lay_8679) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8681 = cute.make_view(%iter_8647, %append_8680) : !memref_smem_bf16_14
          %iter_8682 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %lay_8683 = cute.get_layout(%view_8681) : !memref_smem_bf16_14
          %3458 = cute.get_shape(%lay_8683) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8684, %e1_8685, %e2_8686 = cute.get_leaves(%3458) : !cute.shape<"((8,1),2)">
          %iter_8687 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %view_8688 = cute.make_view(%iter_8687) : !memref_smem_bf16_15
          %iter_8689 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %iter_8690 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8691 = cute.get_layout(%view_8653) : !memref_rmem_i8_2
          %shape_8692 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8693 = cute.make_layout() : !cute.layout<"1:0">
          %append_8694 = cute.append_to_rank<2> (%lay_8691, %lay_8693) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8695 = cute.make_view(%iter_8654, %append_8694) : !memref_rmem_i8_2
          %iter_8696 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %lay_8697 = cute.get_layout(%view_8695) : !memref_rmem_i8_2
          %3459 = cute.get_shape(%lay_8697) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8698, %e1_8699 = cute.get_leaves(%3459) : !cute.shape<"(1,2)">
          %iter_8700 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %view_8701 = cute.make_view(%iter_8700) : !memref_rmem_i8_3
          %iter_8702 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %iter_8703 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8704 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %3460 = cute.get_shape(%lay_8704) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8705, %e1_8706, %e2_8707 = cute.get_leaves(%3460) : !cute.shape<"((8,1),(2))">
          %lay_8708 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %3461 = cute.get_shape(%lay_8708) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8709, %e1_8710, %e2_8711 = cute.get_leaves(%3461) : !cute.shape<"((8,1),(2))">
          %lay_8712 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %sz_8713 = cute.size(%lay_8712) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8714 = cute.get_leaves(%sz_8713) : !cute.int_tuple<"2">
          %lay_8715 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %sz_8716 = cute.size(%lay_8715) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8717 = cute.get_leaves(%sz_8716) : !cute.int_tuple<"2">
          %3462 = cute.static : !cute.layout<"1:0">
          %iter_8718 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8719 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8720 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %lay_8721 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %append_8722 = cute.append_to_rank<2> (%lay_8720, %3462) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8723 = cute.append_to_rank<2> (%lay_8721, %3462) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8724 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8725 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8726 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8727 = cute.get_layout(%view_8701) : !memref_rmem_i8_3
          %append_8728 = cute.append_to_rank<2> (%lay_8727, %3462) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8729 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8730 = cute.size(%lay_8724) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3463 = cute.get_scalars(%sz_8730) : !cute.int_tuple<"2">
          %c0_i32_8731 = arith.constant 0 : i32
          %c1_i32_8732 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8731 to %3463 step %c1_i32_8732  : i32 {
            %coord_8733 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3464 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8734 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8735 = cute.crd2idx(%coord_8733, %lay_8724) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8736 = cute.add_offset(%iter_8718, %idx_8735) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8737 = cute.make_view(%ptr_8736, %lay_8734) : !memref_gmem_bf16_8
            %3465 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8738 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8739 = cute.crd2idx(%coord_8733, %lay_8725) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8740 = cute.add_offset(%iter_8719, %idx_8739) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8741 = cute.make_view(%ptr_8740, %lay_8738) : !memref_smem_bf16_13
            %3466 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8742 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8743 = cute.crd2idx(%coord_8733, %lay_8729) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8744 = cute.add_offset(%iter_8726, %idx_8743) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8745 = cute.make_view(%ptr_8744, %lay_8742) : !memref_rmem_i8_4
            %iter_8746 = cute.get_iter(%view_8737) : !memref_gmem_bf16_8
            %iter_8747 = cute.get_iter(%view_8741) : !memref_smem_bf16_13
            %iter_8748 = cute.get_iter(%view_8745) : !memref_rmem_i8_4
            %3467 = builtin.unrealized_conversion_cast %iter_8748 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3468 = llvm.load %3467 : !llvm.ptr -> i8
            %3469 = llvm.trunc %3468 : i8 to i1
            %iter_8749 = cute.recast_iter(%iter_8746) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8750 = cute.recast_iter(%iter_8747) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8750 : !cute.ptr<i128, smem>, %iter_8749 : !cute.ptr<i128, gmem>, %3469 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8634 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8635 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_8637 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_smem_bf16_14
          %iter_8640 = cute.get_iter(%view_8639) : !memref_smem_bf16_14
          %lay_8641 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %sz_8642 = cute.size(%lay_8641) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8643 = cute.get_leaves(%sz_8642) : !cute.int_tuple<"16">
          %lay_8644 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %3455 = cute.get_shape(%lay_8644) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8645, %e1_8646, %e2_8647 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %int_tuple_8648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8649 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8650 = cute.get_leaves(%int_tuple_8649) : !cute.int_tuple<"16">
          %cst_8651 = arith.constant 0.000000e+00 : bf16
          %3456 = vector.splat %cst_8651 : vector<16xbf16>
          %int_tuple_8652 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8653 = cute.size(%int_tuple_8652) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"16">
          %int_tuple_8655 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8656 = cute.size(%int_tuple_8655) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8657 = cute.get_leaves(%sz_8656) : !cute.int_tuple<"16">
          cute.memref.store_vec %3456, %view_8639, row_major : !memref_smem_bf16_14
        }
        %coord_8568 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
        %lay_8569 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8570 = cute.crd2idx(%coord_8568, %lay_8569) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
        %iter_8571 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8572 = cute.add_offset(%iter_8571, %idx_8570) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8573 = cute.make_view(%tup_8572) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8574 = cute.get_iter(%view_8573) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8575, %e1_8576, %e2_8577, %e3_8578 = cute.get_leaves(%iter_8574) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3413 = cute.get_scalars(%e0_8575) : !cute.int_tuple<"?">
        %3414 = cute.get_scalars(%e1_8576) : !cute.int_tuple<"?">
        %3415 = cute.get_scalars(%e2_8577) : !cute.int_tuple<"?">
        %3416 = cute.get_scalars(%e3_8578) : !cute.int_tuple<"?{div=8}">
        %iter_8579 = cute.get_iter(%view_8573) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8580, %e1_8581, %e2_8582, %e3_8583 = cute.get_leaves(%iter_8579) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3417 = cute.get_scalars(%e0_8580) : !cute.int_tuple<"?">
        %3418 = cute.get_scalars(%e1_8581) : !cute.int_tuple<"?">
        %3419 = cute.get_scalars(%e2_8582) : !cute.int_tuple<"?">
        %3420 = cute.get_scalars(%e3_8583) : !cute.int_tuple<"?{div=8}">
        %iter_8584 = cute.get_iter(%view_8573) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8585, %e1_8586, %e2_8587, %e3_8588 = cute.get_leaves(%iter_8584) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3421 = cute.get_scalars(%e0_8585) : !cute.int_tuple<"?">
        %3422 = cute.get_scalars(%e1_8586) : !cute.int_tuple<"?">
        %3423 = cute.get_scalars(%e2_8587) : !cute.int_tuple<"?">
        %3424 = cute.get_scalars(%e3_8588) : !cute.int_tuple<"?{div=8}">
        %lay_8589 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3425 = cute.get_shape(%lay_8589) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8590, %e1_8591, %e2_8592, %e3_8593 = cute.get_leaves(%3425) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8594 = cute.to_int_tuple(%e0_8590) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3426 = cute.get_scalars(%itup_8594) : !cute.int_tuple<"?">
        %itup_8595 = cute.to_int_tuple(%e1_8591) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3427 = cute.get_scalars(%itup_8595) : !cute.int_tuple<"?">
        %itup_8596 = cute.to_int_tuple(%e2_8592) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3428 = cute.get_scalars(%itup_8596) : !cute.int_tuple<"?">
        %itup_8597 = cute.to_int_tuple(%e3_8593) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3429 = cute.get_scalars(%itup_8597) : !cute.int_tuple<"?{div=8}">
        %coord_8598 = cute.make_coord(%e1_8586) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8599 = cute.make_coord(%itup_8595) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3430 = cute.get_scalars(%coord_8598) : !cute.coord<"?">
        %3431 = cute.get_scalars(%coord_8599) : !cute.coord<"?">
        %true_8600 = arith.constant true
        %3432 = arith.cmpi slt, %3430, %3431 : i32
        %3433 = arith.andi %true_8600, %3432 : i1
        scf.if %3433 {
          %coord_8634 = cute.make_coord(%1023) : (i32) -> !cute.coord<"(_,2,_,?)">
          %lay_8635 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
          %iter_8637 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_gmem_bf16_6
          %iter_8640 = cute.get_iter(%view_8639) : !memref_gmem_bf16_6
          %coord_8641 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8642 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8643 = cute.crd2idx(%coord_8641, %lay_8642) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_8644 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8645 = cute.add_offset(%iter_8644, %idx_8643) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8646 = cute.make_view(%ptr_8645) : !memref_smem_bf16_14
          %iter_8647 = cute.get_iter(%view_8646) : !memref_smem_bf16_14
          %coord_8648 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8649 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %idx_8650 = cute.crd2idx(%coord_8648, %lay_8649) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8651 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
          %ptr_8652 = cute.add_offset(%iter_8651, %idx_8650) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8653 = cute.make_view(%ptr_8652) : !memref_rmem_i8_2
          %iter_8654 = cute.get_iter(%view_8653) : !memref_rmem_i8_2
          %lay_8655 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %3455 = cute.get_shape(%lay_8655) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8656, %e1_8657, %e2_8658 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %lay_8659 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %3456 = cute.get_shape(%lay_8659) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8660, %e1_8661, %e2_8662 = cute.get_leaves(%3456) : !cute.shape<"((8,1),2)">
          %lay_8663 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %shape_8664 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8665 = cute.make_layout() : !cute.layout<"1:0">
          %append_8666 = cute.append_to_rank<2> (%lay_8663, %lay_8665) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8667 = cute.make_view(%iter_8640, %append_8666) : !memref_gmem_bf16_6
          %iter_8668 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %lay_8669 = cute.get_layout(%view_8667) : !memref_gmem_bf16_6
          %3457 = cute.get_shape(%lay_8669) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8670, %e1_8671, %e2_8672 = cute.get_leaves(%3457) : !cute.shape<"((8,1),2)">
          %iter_8673 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %view_8674 = cute.make_view(%iter_8673) : !memref_gmem_bf16_7
          %iter_8675 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8676 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %lay_8677 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %shape_8678 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8679 = cute.make_layout() : !cute.layout<"1:0">
          %append_8680 = cute.append_to_rank<2> (%lay_8677, %lay_8679) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8681 = cute.make_view(%iter_8647, %append_8680) : !memref_smem_bf16_14
          %iter_8682 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %lay_8683 = cute.get_layout(%view_8681) : !memref_smem_bf16_14
          %3458 = cute.get_shape(%lay_8683) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8684, %e1_8685, %e2_8686 = cute.get_leaves(%3458) : !cute.shape<"((8,1),2)">
          %iter_8687 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %view_8688 = cute.make_view(%iter_8687) : !memref_smem_bf16_15
          %iter_8689 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %iter_8690 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8691 = cute.get_layout(%view_8653) : !memref_rmem_i8_2
          %shape_8692 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8693 = cute.make_layout() : !cute.layout<"1:0">
          %append_8694 = cute.append_to_rank<2> (%lay_8691, %lay_8693) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8695 = cute.make_view(%iter_8654, %append_8694) : !memref_rmem_i8_2
          %iter_8696 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %lay_8697 = cute.get_layout(%view_8695) : !memref_rmem_i8_2
          %3459 = cute.get_shape(%lay_8697) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8698, %e1_8699 = cute.get_leaves(%3459) : !cute.shape<"(1,2)">
          %iter_8700 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %view_8701 = cute.make_view(%iter_8700) : !memref_rmem_i8_3
          %iter_8702 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %iter_8703 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8704 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %3460 = cute.get_shape(%lay_8704) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8705, %e1_8706, %e2_8707 = cute.get_leaves(%3460) : !cute.shape<"((8,1),(2))">
          %lay_8708 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %3461 = cute.get_shape(%lay_8708) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8709, %e1_8710, %e2_8711 = cute.get_leaves(%3461) : !cute.shape<"((8,1),(2))">
          %lay_8712 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %sz_8713 = cute.size(%lay_8712) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8714 = cute.get_leaves(%sz_8713) : !cute.int_tuple<"2">
          %lay_8715 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %sz_8716 = cute.size(%lay_8715) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8717 = cute.get_leaves(%sz_8716) : !cute.int_tuple<"2">
          %3462 = cute.static : !cute.layout<"1:0">
          %iter_8718 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8719 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8720 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %lay_8721 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %append_8722 = cute.append_to_rank<2> (%lay_8720, %3462) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8723 = cute.append_to_rank<2> (%lay_8721, %3462) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8724 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8725 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8726 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8727 = cute.get_layout(%view_8701) : !memref_rmem_i8_3
          %append_8728 = cute.append_to_rank<2> (%lay_8727, %3462) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8729 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8730 = cute.size(%lay_8724) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3463 = cute.get_scalars(%sz_8730) : !cute.int_tuple<"2">
          %c0_i32_8731 = arith.constant 0 : i32
          %c1_i32_8732 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8731 to %3463 step %c1_i32_8732  : i32 {
            %coord_8733 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3464 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8734 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8735 = cute.crd2idx(%coord_8733, %lay_8724) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8736 = cute.add_offset(%iter_8718, %idx_8735) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8737 = cute.make_view(%ptr_8736, %lay_8734) : !memref_gmem_bf16_8
            %3465 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8738 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8739 = cute.crd2idx(%coord_8733, %lay_8725) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8740 = cute.add_offset(%iter_8719, %idx_8739) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8741 = cute.make_view(%ptr_8740, %lay_8738) : !memref_smem_bf16_13
            %3466 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8742 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8743 = cute.crd2idx(%coord_8733, %lay_8729) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8744 = cute.add_offset(%iter_8726, %idx_8743) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8745 = cute.make_view(%ptr_8744, %lay_8742) : !memref_rmem_i8_4
            %iter_8746 = cute.get_iter(%view_8737) : !memref_gmem_bf16_8
            %iter_8747 = cute.get_iter(%view_8741) : !memref_smem_bf16_13
            %iter_8748 = cute.get_iter(%view_8745) : !memref_rmem_i8_4
            %3467 = builtin.unrealized_conversion_cast %iter_8748 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3468 = llvm.load %3467 : !llvm.ptr -> i8
            %3469 = llvm.trunc %3468 : i8 to i1
            %iter_8749 = cute.recast_iter(%iter_8746) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8750 = cute.recast_iter(%iter_8747) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8750 : !cute.ptr<i128, smem>, %iter_8749 : !cute.ptr<i128, gmem>, %3469 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8634 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8635 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_8637 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_smem_bf16_14
          %iter_8640 = cute.get_iter(%view_8639) : !memref_smem_bf16_14
          %lay_8641 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %sz_8642 = cute.size(%lay_8641) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8643 = cute.get_leaves(%sz_8642) : !cute.int_tuple<"16">
          %lay_8644 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %3455 = cute.get_shape(%lay_8644) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8645, %e1_8646, %e2_8647 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %int_tuple_8648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8649 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8650 = cute.get_leaves(%int_tuple_8649) : !cute.int_tuple<"16">
          %cst_8651 = arith.constant 0.000000e+00 : bf16
          %3456 = vector.splat %cst_8651 : vector<16xbf16>
          %int_tuple_8652 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8653 = cute.size(%int_tuple_8652) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"16">
          %int_tuple_8655 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8656 = cute.size(%int_tuple_8655) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8657 = cute.get_leaves(%sz_8656) : !cute.int_tuple<"16">
          cute.memref.store_vec %3456, %view_8639, row_major : !memref_smem_bf16_14
        }
        %coord_8601 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
        %lay_8602 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8603 = cute.crd2idx(%coord_8601, %lay_8602) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
        %iter_8604 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8605 = cute.add_offset(%iter_8604, %idx_8603) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8606 = cute.make_view(%tup_8605) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8607 = cute.get_iter(%view_8606) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%iter_8607) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3434 = cute.get_scalars(%e0_8608) : !cute.int_tuple<"?">
        %3435 = cute.get_scalars(%e1_8609) : !cute.int_tuple<"?">
        %3436 = cute.get_scalars(%e2_8610) : !cute.int_tuple<"?">
        %3437 = cute.get_scalars(%e3_8611) : !cute.int_tuple<"?{div=8}">
        %iter_8612 = cute.get_iter(%view_8606) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8613, %e1_8614, %e2_8615, %e3_8616 = cute.get_leaves(%iter_8612) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3438 = cute.get_scalars(%e0_8613) : !cute.int_tuple<"?">
        %3439 = cute.get_scalars(%e1_8614) : !cute.int_tuple<"?">
        %3440 = cute.get_scalars(%e2_8615) : !cute.int_tuple<"?">
        %3441 = cute.get_scalars(%e3_8616) : !cute.int_tuple<"?{div=8}">
        %iter_8617 = cute.get_iter(%view_8606) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8618, %e1_8619, %e2_8620, %e3_8621 = cute.get_leaves(%iter_8617) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3442 = cute.get_scalars(%e0_8618) : !cute.int_tuple<"?">
        %3443 = cute.get_scalars(%e1_8619) : !cute.int_tuple<"?">
        %3444 = cute.get_scalars(%e2_8620) : !cute.int_tuple<"?">
        %3445 = cute.get_scalars(%e3_8621) : !cute.int_tuple<"?{div=8}">
        %lay_8622 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3446 = cute.get_shape(%lay_8622) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8623, %e1_8624, %e2_8625, %e3_8626 = cute.get_leaves(%3446) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8627 = cute.to_int_tuple(%e0_8623) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3447 = cute.get_scalars(%itup_8627) : !cute.int_tuple<"?">
        %itup_8628 = cute.to_int_tuple(%e1_8624) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3448 = cute.get_scalars(%itup_8628) : !cute.int_tuple<"?">
        %itup_8629 = cute.to_int_tuple(%e2_8625) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3449 = cute.get_scalars(%itup_8629) : !cute.int_tuple<"?">
        %itup_8630 = cute.to_int_tuple(%e3_8626) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3450 = cute.get_scalars(%itup_8630) : !cute.int_tuple<"?{div=8}">
        %coord_8631 = cute.make_coord(%e1_8619) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8632 = cute.make_coord(%itup_8628) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3451 = cute.get_scalars(%coord_8631) : !cute.coord<"?">
        %3452 = cute.get_scalars(%coord_8632) : !cute.coord<"?">
        %true_8633 = arith.constant true
        %3453 = arith.cmpi slt, %3451, %3452 : i32
        %3454 = arith.andi %true_8633, %3453 : i1
        scf.if %3454 {
          %coord_8634 = cute.make_coord(%1023) : (i32) -> !cute.coord<"(_,3,_,?)">
          %lay_8635 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_8637 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_gmem_bf16_6
          %iter_8640 = cute.get_iter(%view_8639) : !memref_gmem_bf16_6
          %coord_8641 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8642 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8643 = cute.crd2idx(%coord_8641, %lay_8642) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_8644 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8645 = cute.add_offset(%iter_8644, %idx_8643) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8646 = cute.make_view(%ptr_8645) : !memref_smem_bf16_14
          %iter_8647 = cute.get_iter(%view_8646) : !memref_smem_bf16_14
          %coord_8648 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8649 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %idx_8650 = cute.crd2idx(%coord_8648, %lay_8649) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8651 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
          %ptr_8652 = cute.add_offset(%iter_8651, %idx_8650) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8653 = cute.make_view(%ptr_8652) : !memref_rmem_i8_2
          %iter_8654 = cute.get_iter(%view_8653) : !memref_rmem_i8_2
          %lay_8655 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %3455 = cute.get_shape(%lay_8655) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8656, %e1_8657, %e2_8658 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %lay_8659 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %3456 = cute.get_shape(%lay_8659) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8660, %e1_8661, %e2_8662 = cute.get_leaves(%3456) : !cute.shape<"((8,1),2)">
          %lay_8663 = cute.get_layout(%view_8639) : !memref_gmem_bf16_6
          %shape_8664 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8665 = cute.make_layout() : !cute.layout<"1:0">
          %append_8666 = cute.append_to_rank<2> (%lay_8663, %lay_8665) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8667 = cute.make_view(%iter_8640, %append_8666) : !memref_gmem_bf16_6
          %iter_8668 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %lay_8669 = cute.get_layout(%view_8667) : !memref_gmem_bf16_6
          %3457 = cute.get_shape(%lay_8669) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8670, %e1_8671, %e2_8672 = cute.get_leaves(%3457) : !cute.shape<"((8,1),2)">
          %iter_8673 = cute.get_iter(%view_8667) : !memref_gmem_bf16_6
          %view_8674 = cute.make_view(%iter_8673) : !memref_gmem_bf16_7
          %iter_8675 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8676 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %lay_8677 = cute.get_layout(%view_8646) : !memref_smem_bf16_14
          %shape_8678 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8679 = cute.make_layout() : !cute.layout<"1:0">
          %append_8680 = cute.append_to_rank<2> (%lay_8677, %lay_8679) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8681 = cute.make_view(%iter_8647, %append_8680) : !memref_smem_bf16_14
          %iter_8682 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %lay_8683 = cute.get_layout(%view_8681) : !memref_smem_bf16_14
          %3458 = cute.get_shape(%lay_8683) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8684, %e1_8685, %e2_8686 = cute.get_leaves(%3458) : !cute.shape<"((8,1),2)">
          %iter_8687 = cute.get_iter(%view_8681) : !memref_smem_bf16_14
          %view_8688 = cute.make_view(%iter_8687) : !memref_smem_bf16_15
          %iter_8689 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %iter_8690 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8691 = cute.get_layout(%view_8653) : !memref_rmem_i8_2
          %shape_8692 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8693 = cute.make_layout() : !cute.layout<"1:0">
          %append_8694 = cute.append_to_rank<2> (%lay_8691, %lay_8693) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8695 = cute.make_view(%iter_8654, %append_8694) : !memref_rmem_i8_2
          %iter_8696 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %lay_8697 = cute.get_layout(%view_8695) : !memref_rmem_i8_2
          %3459 = cute.get_shape(%lay_8697) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8698, %e1_8699 = cute.get_leaves(%3459) : !cute.shape<"(1,2)">
          %iter_8700 = cute.get_iter(%view_8695) : !memref_rmem_i8_2
          %view_8701 = cute.make_view(%iter_8700) : !memref_rmem_i8_3
          %iter_8702 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %iter_8703 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8704 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %3460 = cute.get_shape(%lay_8704) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8705, %e1_8706, %e2_8707 = cute.get_leaves(%3460) : !cute.shape<"((8,1),(2))">
          %lay_8708 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %3461 = cute.get_shape(%lay_8708) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8709, %e1_8710, %e2_8711 = cute.get_leaves(%3461) : !cute.shape<"((8,1),(2))">
          %lay_8712 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %sz_8713 = cute.size(%lay_8712) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8714 = cute.get_leaves(%sz_8713) : !cute.int_tuple<"2">
          %lay_8715 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %sz_8716 = cute.size(%lay_8715) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8717 = cute.get_leaves(%sz_8716) : !cute.int_tuple<"2">
          %3462 = cute.static : !cute.layout<"1:0">
          %iter_8718 = cute.get_iter(%view_8674) : !memref_gmem_bf16_7
          %iter_8719 = cute.get_iter(%view_8688) : !memref_smem_bf16_15
          %lay_8720 = cute.get_layout(%view_8674) : !memref_gmem_bf16_7
          %lay_8721 = cute.get_layout(%view_8688) : !memref_smem_bf16_15
          %append_8722 = cute.append_to_rank<2> (%lay_8720, %3462) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8723 = cute.append_to_rank<2> (%lay_8721, %3462) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8724 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8725 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8726 = cute.get_iter(%view_8701) : !memref_rmem_i8_3
          %lay_8727 = cute.get_layout(%view_8701) : !memref_rmem_i8_3
          %append_8728 = cute.append_to_rank<2> (%lay_8727, %3462) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8729 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8730 = cute.size(%lay_8724) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3463 = cute.get_scalars(%sz_8730) : !cute.int_tuple<"2">
          %c0_i32_8731 = arith.constant 0 : i32
          %c1_i32_8732 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8731 to %3463 step %c1_i32_8732  : i32 {
            %coord_8733 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3464 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8734 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8735 = cute.crd2idx(%coord_8733, %lay_8724) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8736 = cute.add_offset(%iter_8718, %idx_8735) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8737 = cute.make_view(%ptr_8736, %lay_8734) : !memref_gmem_bf16_8
            %3465 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8738 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8739 = cute.crd2idx(%coord_8733, %lay_8725) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8740 = cute.add_offset(%iter_8719, %idx_8739) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8741 = cute.make_view(%ptr_8740, %lay_8738) : !memref_smem_bf16_13
            %3466 = cute.get_scalars(%coord_8733) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8742 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8743 = cute.crd2idx(%coord_8733, %lay_8729) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8744 = cute.add_offset(%iter_8726, %idx_8743) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8745 = cute.make_view(%ptr_8744, %lay_8742) : !memref_rmem_i8_4
            %iter_8746 = cute.get_iter(%view_8737) : !memref_gmem_bf16_8
            %iter_8747 = cute.get_iter(%view_8741) : !memref_smem_bf16_13
            %iter_8748 = cute.get_iter(%view_8745) : !memref_rmem_i8_4
            %3467 = builtin.unrealized_conversion_cast %iter_8748 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3468 = llvm.load %3467 : !llvm.ptr -> i8
            %3469 = llvm.trunc %3468 : i8 to i1
            %iter_8749 = cute.recast_iter(%iter_8746) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8750 = cute.recast_iter(%iter_8747) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8750 : !cute.ptr<i128, smem>, %iter_8749 : !cute.ptr<i128, gmem>, %3469 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8634 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8635 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %idx_8636 = cute.crd2idx(%coord_8634, %lay_8635) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_8637 = cute.get_iter(%view_486) : !memref_smem_bf16_4
          %ptr_8638 = cute.add_offset(%iter_8637, %idx_8636) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8639 = cute.make_view(%ptr_8638) : !memref_smem_bf16_14
          %iter_8640 = cute.get_iter(%view_8639) : !memref_smem_bf16_14
          %lay_8641 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %sz_8642 = cute.size(%lay_8641) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8643 = cute.get_leaves(%sz_8642) : !cute.int_tuple<"16">
          %lay_8644 = cute.get_layout(%view_8639) : !memref_smem_bf16_14
          %3455 = cute.get_shape(%lay_8644) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8645, %e1_8646, %e2_8647 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
          %int_tuple_8648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8649 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8650 = cute.get_leaves(%int_tuple_8649) : !cute.int_tuple<"16">
          %cst_8651 = arith.constant 0.000000e+00 : bf16
          %3456 = vector.splat %cst_8651 : vector<16xbf16>
          %int_tuple_8652 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8653 = cute.size(%int_tuple_8652) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"16">
          %int_tuple_8655 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8656 = cute.size(%int_tuple_8655) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8657 = cute.get_leaves(%sz_8656) : !cute.int_tuple<"16">
          cute.memref.store_vec %3456, %view_8639, row_major : !memref_smem_bf16_14
        }
      } else {
        %coord_8494 = cute.make_coord(%1023) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_8495 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
        %3370:3 = cute.get_scalars(%lay_8495) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
        %shape_8496 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
        %iv_8497 = cute.assume(%3370#1) : (i64) -> !cute.i64<divby 128>
        %stride_8498 = cute.make_stride(%iv_8497) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
        %lay_8499 = cute.make_layout(%shape_8496, %stride_8498) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8501 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
        %ptr_8502 = cute.add_offset(%iter_8501, %idx_8500) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8503 = cute.make_view(%ptr_8502, %lay_8499) : !memref_gmem_bf16_9
        %iter_8504 = cute.get_iter(%view_8503) : !memref_gmem_bf16_9
        %lay_8505 = cute.get_layout(%view_8503) : !memref_gmem_bf16_9
        %3372 = cute.get_shape(%lay_8505) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8506, %e1_8507, %e2_8508, %e3_8509 = cute.get_leaves(%3372) : !cute.shape<"((8,1),4,2)">
        %lay_8510 = cute.get_layout(%view_486) : !memref_smem_bf16_4
        %3373 = cute.get_shape(%lay_8510) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8511, %e1_8512, %e2_8513, %e3_8514 = cute.get_leaves(%3373) : !cute.shape<"((8,1),4,2)">
        %lay_8515 = cute.get_layout(%view_8503) : !memref_gmem_bf16_9
        %shape_8516 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8517 = cute.make_layout() : !cute.layout<"1:0">
        %append_8518 = cute.append_to_rank<2> (%lay_8515, %lay_8517) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_8519 = cute.make_view(%iter_8504, %append_8518) : !memref_gmem_bf16_9
        %iter_8520 = cute.get_iter(%view_8519) : !memref_gmem_bf16_9
        %lay_8521 = cute.get_layout(%view_8519) : !memref_gmem_bf16_9
        %3374 = cute.get_shape(%lay_8521) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8522, %e1_8523, %e2_8524, %e3_8525 = cute.get_leaves(%3374) : !cute.shape<"((8,1),4,2)">
        %iter_8526 = cute.get_iter(%view_8519) : !memref_gmem_bf16_9
        %lay_8527 = cute.get_layout(%view_8519) : !memref_gmem_bf16_9
        %3375 = cute.get_scalars(%lay_8527) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_8528 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_8529 = cute.assume(%3375) : (i64) -> !cute.i64<divby 128>
        %stride_8530 = cute.make_stride(%iv_8529) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_8531 = cute.make_layout(%shape_8528, %stride_8530) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_8532 = cute.make_view(%iter_8526, %lay_8531) : !memref_gmem_bf16_10
        %iter_8533 = cute.get_iter(%view_8532) : !memref_gmem_bf16_10
        %iter_8534 = cute.get_iter(%view_8532) : !memref_gmem_bf16_10
        %lay_8535 = cute.get_layout(%view_486) : !memref_smem_bf16_4
        %shape_8536 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8537 = cute.make_layout() : !cute.layout<"1:0">
        %append_8538 = cute.append_to_rank<2> (%lay_8535, %lay_8537) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_8539 = cute.make_view(%iter_487, %append_8538) : !memref_smem_bf16_4
        %iter_8540 = cute.get_iter(%view_8539) : !memref_smem_bf16_4
        %lay_8541 = cute.get_layout(%view_8539) : !memref_smem_bf16_4
        %3376 = cute.get_shape(%lay_8541) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8542, %e1_8543, %e2_8544, %e3_8545 = cute.get_leaves(%3376) : !cute.shape<"((8,1),4,2)">
        %iter_8546 = cute.get_iter(%view_8539) : !memref_smem_bf16_4
        %view_8547 = cute.make_view(%iter_8546) : !memref_smem_bf16_16
        %iter_8548 = cute.get_iter(%view_8547) : !memref_smem_bf16_16
        %iter_8549 = cute.get_iter(%view_8547) : !memref_smem_bf16_16
        %lay_8550 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %shape_8551 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8552 = cute.make_layout() : !cute.layout<"1:0">
        %append_8553 = cute.append_to_rank<2> (%lay_8550, %lay_8552) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_8554 = cute.make_view(%iter_1034, %append_8553) : !memref_rmem_i8_1
        %iter_8555 = cute.get_iter(%view_8554) : !memref_rmem_i8_1
        %lay_8556 = cute.get_layout(%view_8554) : !memref_rmem_i8_1
        %3377 = cute.get_shape(%lay_8556) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_8557, %e1_8558, %e2_8559 = cute.get_leaves(%3377) : !cute.shape<"(1,4,2)">
        %iter_8560 = cute.get_iter(%view_8554) : !memref_rmem_i8_1
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_5
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_5
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_5
        %lay_8564 = cute.get_layout(%view_8532) : !memref_gmem_bf16_10
        %3378 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8565, %e1_8566, %e2_8567, %e3_8568 = cute.get_leaves(%3378) : !cute.shape<"((8,1),(4,2))">
        %lay_8569 = cute.get_layout(%view_8547) : !memref_smem_bf16_16
        %3379 = cute.get_shape(%lay_8569) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8570, %e1_8571, %e2_8572, %e3_8573 = cute.get_leaves(%3379) : !cute.shape<"((8,1),(4,2))">
        %lay_8574 = cute.get_layout(%view_8532) : !memref_gmem_bf16_10
        %sz_8575 = cute.size(%lay_8574) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_8576 = cute.get_leaves(%sz_8575) : !cute.int_tuple<"8">
        %lay_8577 = cute.get_layout(%view_8547) : !memref_smem_bf16_16
        %sz_8578 = cute.size(%lay_8577) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_8579 = cute.get_leaves(%sz_8578) : !cute.int_tuple<"8">
        %3380 = cute.static : !cute.layout<"1:0">
        %iter_8580 = cute.get_iter(%view_8532) : !memref_gmem_bf16_10
        %iter_8581 = cute.get_iter(%view_8547) : !memref_smem_bf16_16
        %lay_8582 = cute.get_layout(%view_8532) : !memref_gmem_bf16_10
        %lay_8583 = cute.get_layout(%view_8547) : !memref_smem_bf16_16
        %append_8584 = cute.append_to_rank<2> (%lay_8582, %3380) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_8585 = cute.append_to_rank<2> (%lay_8583, %3380) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %3381 = cute.get_scalars(%append_8584) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_8586 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_8587 = cute.assume(%3381) : (i64) -> !cute.i64<divby 128>
        %stride_8588 = cute.make_stride(%iv_8587) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_8589 = cute.make_layout(%shape_8586, %stride_8588) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_8590 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_8591 = cute.get_iter(%view_8561) : !memref_rmem_i8_5
        %lay_8592 = cute.get_layout(%view_8561) : !memref_rmem_i8_5
        %append_8593 = cute.append_to_rank<2> (%lay_8592, %3380) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_8594 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_8595 = cute.size(%lay_8589) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %3382 = cute.get_scalars(%sz_8595) : !cute.int_tuple<"8">
        %c0_i32_8596 = arith.constant 0 : i32
        %c1_i32_8597 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8596 to %3382 step %c1_i32_8597  : i32 {
          %coord_8598 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3383 = cute.get_scalars(%lay_8589) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %3384 = cute.get_scalars(%coord_8598) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8599 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8600 = cute.crd2idx(%coord_8598, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_8601 = cute.add_offset(%iter_8580, %idx_8600) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8602 = cute.make_view(%ptr_8601, %lay_8599) : !memref_gmem_bf16_8
          %3385 = cute.get_scalars(%coord_8598) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8603 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8604 = cute.crd2idx(%coord_8598, %lay_8590) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_8605 = cute.add_offset(%iter_8581, %idx_8604) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8606 = cute.make_view(%ptr_8605, %lay_8603) : !memref_smem_bf16_13
          %3386 = cute.get_scalars(%coord_8598) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8607 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8608 = cute.crd2idx(%coord_8598, %lay_8594) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_8609 = cute.add_offset(%iter_8591, %idx_8608) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_i8_4
          %iter_8611 = cute.get_iter(%view_8602) : !memref_gmem_bf16_8
          %iter_8612 = cute.get_iter(%view_8606) : !memref_smem_bf16_13
          %iter_8613 = cute.get_iter(%view_8610) : !memref_rmem_i8_4
          %3387 = builtin.unrealized_conversion_cast %iter_8613 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3388 = llvm.load %3387 : !llvm.ptr -> i8
          %3389 = llvm.trunc %3388 : i8 to i1
          %iter_8614 = cute.recast_iter(%iter_8611) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8615 = cute.recast_iter(%iter_8612) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8615 : !cute.ptr<i128, smem>, %iter_8614 : !cute.ptr<i128, gmem>, %3389 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      }
      nvvm.cp.async.commit.group
      %coord_1647 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1648 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_1649 = cute.crd2idx(%coord_1647, %lay_1648) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_1650 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_1651 = cute.add_offset(%iter_1650, %idx_1649) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1652 = cute.make_view(%ptr_1651) : !memref_smem_bf16_14
      %iter_1653 = cute.get_iter(%view_1652) : !memref_smem_bf16_14
      %coord_1654 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1655 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_1656 = cute.crd2idx(%coord_1654, %lay_1655) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_1657 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_1658 = cute.add_offset(%iter_1657, %idx_1656) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1659 = cute.make_view(%ptr_1658) : !memref_rmem_bf16_6
      %iter_1660 = cute.get_iter(%view_1659) : !memref_rmem_bf16_6
      %lay_1661 = cute.get_layout(%view_1652) : !memref_smem_bf16_14
      %1026 = cute.get_shape(%lay_1661) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1662, %e1_1663, %e2_1664 = cute.get_leaves(%1026) : !cute.shape<"((8,1),2)">
      %lay_1665 = cute.get_layout(%view_1659) : !memref_rmem_bf16_6
      %1027 = cute.get_shape(%lay_1665) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1666, %e1_1667, %e2_1668 = cute.get_leaves(%1027) : !cute.shape<"((8,1),2)">
      %lay_1669 = cute.get_layout(%view_1652) : !memref_smem_bf16_14
      %shape_1670 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1671 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1669, %lay_1671) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1672 = cute.make_view(%iter_1653, %append) : !memref_smem_bf16_14
      %iter_1673 = cute.get_iter(%view_1672) : !memref_smem_bf16_14
      %lay_1674 = cute.get_layout(%view_1672) : !memref_smem_bf16_14
      %1028 = cute.get_shape(%lay_1674) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1675, %e1_1676, %e2_1677 = cute.get_leaves(%1028) : !cute.shape<"((8,1),2)">
      %iter_1678 = cute.get_iter(%view_1672) : !memref_smem_bf16_14
      %view_1679 = cute.make_view(%iter_1678) : !memref_smem_bf16_15
      %iter_1680 = cute.get_iter(%view_1679) : !memref_smem_bf16_15
      %iter_1681 = cute.get_iter(%view_1679) : !memref_smem_bf16_15
      %lay_1682 = cute.get_layout(%view_1659) : !memref_rmem_bf16_6
      %shape_1683 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1684 = cute.make_layout() : !cute.layout<"1:0">
      %append_1685 = cute.append_to_rank<2> (%lay_1682, %lay_1684) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1686 = cute.make_view(%iter_1660, %append_1685) : !memref_rmem_bf16_6
      %iter_1687 = cute.get_iter(%view_1686) : !memref_rmem_bf16_6
      %lay_1688 = cute.get_layout(%view_1686) : !memref_rmem_bf16_6
      %1029 = cute.get_shape(%lay_1688) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1689, %e1_1690, %e2_1691 = cute.get_leaves(%1029) : !cute.shape<"((8,1),2)">
      %iter_1692 = cute.get_iter(%view_1686) : !memref_rmem_bf16_6
      %view_1693 = cute.make_view(%iter_1692) : !memref_rmem_bf16_7
      %iter_1694 = cute.get_iter(%view_1693) : !memref_rmem_bf16_7
      %iter_1695 = cute.get_iter(%view_1693) : !memref_rmem_bf16_7
      %lay_1696 = cute.get_layout(%view_1679) : !memref_smem_bf16_15
      %1030 = cute.get_shape(%lay_1696) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1697, %e1_1698, %e2_1699 = cute.get_leaves(%1030) : !cute.shape<"((8,1),(2))">
      %lay_1700 = cute.get_layout(%view_1693) : !memref_rmem_bf16_7
      %1031 = cute.get_shape(%lay_1700) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1701, %e1_1702, %e2_1703 = cute.get_leaves(%1031) : !cute.shape<"((8,1),(2))">
      %lay_1704 = cute.get_layout(%view_1679) : !memref_smem_bf16_15
      %sz_1705 = cute.size(%lay_1704) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1706 = cute.get_leaves(%sz_1705) : !cute.int_tuple<"2">
      %lay_1707 = cute.get_layout(%view_1693) : !memref_rmem_bf16_7
      %sz_1708 = cute.size(%lay_1707) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1709 = cute.get_leaves(%sz_1708) : !cute.int_tuple<"2">
      %1032 = cute.static : !cute.layout<"1:0">
      %iter_1710 = cute.get_iter(%view_1679) : !memref_smem_bf16_15
      %iter_1711 = cute.get_iter(%view_1693) : !memref_rmem_bf16_7
      %lay_1712 = cute.get_layout(%view_1679) : !memref_smem_bf16_15
      %lay_1713 = cute.get_layout(%view_1693) : !memref_rmem_bf16_7
      %append_1714 = cute.append_to_rank<2> (%lay_1712, %1032) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1715 = cute.append_to_rank<2> (%lay_1713, %1032) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1716 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1717 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1718 = cute.size(%lay_1716) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1033 = cute.get_scalars(%sz_1718) : !cute.int_tuple<"2">
      %c0_i32_1719 = arith.constant 0 : i32
      %c1_i32_1720 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1719 to %1033 step %c1_i32_1720  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_1716) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_1710, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_1717) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_1711, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1721 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1722 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_1723 = cute.crd2idx(%coord_1721, %lay_1722) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_1724 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_1725 = cute.add_offset(%iter_1724, %idx_1723) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1726 = cute.make_view(%ptr_1725) : !memref_smem_bf16_17
      %iter_1727 = cute.get_iter(%view_1726) : !memref_smem_bf16_17
      %coord_1728 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1729 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_1730 = cute.crd2idx(%coord_1728, %lay_1729) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_1731 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_1732 = cute.add_offset(%iter_1731, %idx_1730) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1733 = cute.make_view(%ptr_1732) : !memref_rmem_bf16_9
      %iter_1734 = cute.get_iter(%view_1733) : !memref_rmem_bf16_9
      %lay_1735 = cute.get_layout(%view_1726) : !memref_smem_bf16_17
      %1034 = cute.get_shape(%lay_1735) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1736, %e1_1737, %e2_1738 = cute.get_leaves(%1034) : !cute.shape<"((8,1),4)">
      %lay_1739 = cute.get_layout(%view_1733) : !memref_rmem_bf16_9
      %1035 = cute.get_shape(%lay_1739) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1740, %e1_1741, %e2_1742 = cute.get_leaves(%1035) : !cute.shape<"((8,1),4)">
      %lay_1743 = cute.get_layout(%view_1726) : !memref_smem_bf16_17
      %shape_1744 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1745 = cute.make_layout() : !cute.layout<"1:0">
      %append_1746 = cute.append_to_rank<2> (%lay_1743, %lay_1745) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1747 = cute.make_view(%iter_1727, %append_1746) : !memref_smem_bf16_17
      %iter_1748 = cute.get_iter(%view_1747) : !memref_smem_bf16_17
      %lay_1749 = cute.get_layout(%view_1747) : !memref_smem_bf16_17
      %1036 = cute.get_shape(%lay_1749) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1750, %e1_1751, %e2_1752 = cute.get_leaves(%1036) : !cute.shape<"((8,1),4)">
      %iter_1753 = cute.get_iter(%view_1747) : !memref_smem_bf16_17
      %view_1754 = cute.make_view(%iter_1753) : !memref_smem_bf16_18
      %iter_1755 = cute.get_iter(%view_1754) : !memref_smem_bf16_18
      %iter_1756 = cute.get_iter(%view_1754) : !memref_smem_bf16_18
      %lay_1757 = cute.get_layout(%view_1733) : !memref_rmem_bf16_9
      %shape_1758 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1759 = cute.make_layout() : !cute.layout<"1:0">
      %append_1760 = cute.append_to_rank<2> (%lay_1757, %lay_1759) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1761 = cute.make_view(%iter_1734, %append_1760) : !memref_rmem_bf16_9
      %iter_1762 = cute.get_iter(%view_1761) : !memref_rmem_bf16_9
      %lay_1763 = cute.get_layout(%view_1761) : !memref_rmem_bf16_9
      %1037 = cute.get_shape(%lay_1763) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1764, %e1_1765, %e2_1766 = cute.get_leaves(%1037) : !cute.shape<"((8,1),4)">
      %iter_1767 = cute.get_iter(%view_1761) : !memref_rmem_bf16_9
      %view_1768 = cute.make_view(%iter_1767) : !memref_rmem_bf16_10
      %iter_1769 = cute.get_iter(%view_1768) : !memref_rmem_bf16_10
      %iter_1770 = cute.get_iter(%view_1768) : !memref_rmem_bf16_10
      %lay_1771 = cute.get_layout(%view_1754) : !memref_smem_bf16_18
      %1038 = cute.get_shape(%lay_1771) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1772, %e1_1773, %e2_1774 = cute.get_leaves(%1038) : !cute.shape<"((8,1),(4))">
      %lay_1775 = cute.get_layout(%view_1768) : !memref_rmem_bf16_10
      %1039 = cute.get_shape(%lay_1775) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1776, %e1_1777, %e2_1778 = cute.get_leaves(%1039) : !cute.shape<"((8,1),(4))">
      %lay_1779 = cute.get_layout(%view_1754) : !memref_smem_bf16_18
      %sz_1780 = cute.size(%lay_1779) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1781 = cute.get_leaves(%sz_1780) : !cute.int_tuple<"4">
      %lay_1782 = cute.get_layout(%view_1768) : !memref_rmem_bf16_10
      %sz_1783 = cute.size(%lay_1782) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1784 = cute.get_leaves(%sz_1783) : !cute.int_tuple<"4">
      %1040 = cute.static : !cute.layout<"1:0">
      %iter_1785 = cute.get_iter(%view_1754) : !memref_smem_bf16_18
      %iter_1786 = cute.get_iter(%view_1768) : !memref_rmem_bf16_10
      %lay_1787 = cute.get_layout(%view_1754) : !memref_smem_bf16_18
      %lay_1788 = cute.get_layout(%view_1768) : !memref_rmem_bf16_10
      %append_1789 = cute.append_to_rank<2> (%lay_1787, %1040) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1790 = cute.append_to_rank<2> (%lay_1788, %1040) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1791 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1792 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1793 = cute.size(%lay_1791) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1041 = cute.get_scalars(%sz_1793) : !cute.int_tuple<"4">
      %c0_i32_1794 = arith.constant 0 : i32
      %c1_i32_1795 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1794 to %1041 step %c1_i32_1795  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_1791) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_1785, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_1792) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_1786, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1796 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %1042 = cute.get_shape(%lay_1796) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
      %e0_1797, %e1_1798, %e2_1799, %e3_1800, %e4_1801, %e5 = cute.get_leaves(%1042) : !cute.shape<"((8,1),2,((2,2),2))">
      %int_tuple_1802 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1803 = cute.size(%int_tuple_1802) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1804 = cute.get_leaves(%sz_1803) : !cute.int_tuple<"8">
      %int_tuple_1805 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1806 = cute.size(%int_tuple_1805) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1807 = cute.get_leaves(%sz_1806) : !cute.int_tuple<"8">
      %coord_1808 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1809 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_1810 = cute.crd2idx(%coord_1808, %lay_1809) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1811 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_1812 = cute.add_offset(%iter_1811, %idx_1810) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1813 = cute.make_view(%ptr_1812) : !memref_smem_bf16_14
      %iter_1814 = cute.get_iter(%view_1813) : !memref_smem_bf16_14
      %coord_1815 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1816 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_1817 = cute.crd2idx(%coord_1815, %lay_1816) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
      %iter_1818 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_1819 = cute.add_offset(%iter_1818, %idx_1817) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1820 = cute.make_view(%ptr_1819) : !memref_rmem_bf16_6
      %iter_1821 = cute.get_iter(%view_1820) : !memref_rmem_bf16_6
      %lay_1822 = cute.get_layout(%view_1813) : !memref_smem_bf16_14
      %1043 = cute.get_shape(%lay_1822) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1823, %e1_1824, %e2_1825 = cute.get_leaves(%1043) : !cute.shape<"((8,1),2)">
      %lay_1826 = cute.get_layout(%view_1820) : !memref_rmem_bf16_6
      %1044 = cute.get_shape(%lay_1826) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1827, %e1_1828, %e2_1829 = cute.get_leaves(%1044) : !cute.shape<"((8,1),2)">
      %lay_1830 = cute.get_layout(%view_1813) : !memref_smem_bf16_14
      %shape_1831 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1832 = cute.make_layout() : !cute.layout<"1:0">
      %append_1833 = cute.append_to_rank<2> (%lay_1830, %lay_1832) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1834 = cute.make_view(%iter_1814, %append_1833) : !memref_smem_bf16_14
      %iter_1835 = cute.get_iter(%view_1834) : !memref_smem_bf16_14
      %lay_1836 = cute.get_layout(%view_1834) : !memref_smem_bf16_14
      %1045 = cute.get_shape(%lay_1836) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1837, %e1_1838, %e2_1839 = cute.get_leaves(%1045) : !cute.shape<"((8,1),2)">
      %iter_1840 = cute.get_iter(%view_1834) : !memref_smem_bf16_14
      %view_1841 = cute.make_view(%iter_1840) : !memref_smem_bf16_15
      %iter_1842 = cute.get_iter(%view_1841) : !memref_smem_bf16_15
      %iter_1843 = cute.get_iter(%view_1841) : !memref_smem_bf16_15
      %lay_1844 = cute.get_layout(%view_1820) : !memref_rmem_bf16_6
      %shape_1845 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1846 = cute.make_layout() : !cute.layout<"1:0">
      %append_1847 = cute.append_to_rank<2> (%lay_1844, %lay_1846) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1848 = cute.make_view(%iter_1821, %append_1847) : !memref_rmem_bf16_6
      %iter_1849 = cute.get_iter(%view_1848) : !memref_rmem_bf16_6
      %lay_1850 = cute.get_layout(%view_1848) : !memref_rmem_bf16_6
      %1046 = cute.get_shape(%lay_1850) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1851, %e1_1852, %e2_1853 = cute.get_leaves(%1046) : !cute.shape<"((8,1),2)">
      %iter_1854 = cute.get_iter(%view_1848) : !memref_rmem_bf16_6
      %view_1855 = cute.make_view(%iter_1854) : !memref_rmem_bf16_7
      %iter_1856 = cute.get_iter(%view_1855) : !memref_rmem_bf16_7
      %iter_1857 = cute.get_iter(%view_1855) : !memref_rmem_bf16_7
      %lay_1858 = cute.get_layout(%view_1841) : !memref_smem_bf16_15
      %1047 = cute.get_shape(%lay_1858) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1859, %e1_1860, %e2_1861 = cute.get_leaves(%1047) : !cute.shape<"((8,1),(2))">
      %lay_1862 = cute.get_layout(%view_1855) : !memref_rmem_bf16_7
      %1048 = cute.get_shape(%lay_1862) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1863, %e1_1864, %e2_1865 = cute.get_leaves(%1048) : !cute.shape<"((8,1),(2))">
      %lay_1866 = cute.get_layout(%view_1841) : !memref_smem_bf16_15
      %sz_1867 = cute.size(%lay_1866) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1868 = cute.get_leaves(%sz_1867) : !cute.int_tuple<"2">
      %lay_1869 = cute.get_layout(%view_1855) : !memref_rmem_bf16_7
      %sz_1870 = cute.size(%lay_1869) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1871 = cute.get_leaves(%sz_1870) : !cute.int_tuple<"2">
      %1049 = cute.static : !cute.layout<"1:0">
      %iter_1872 = cute.get_iter(%view_1841) : !memref_smem_bf16_15
      %iter_1873 = cute.get_iter(%view_1855) : !memref_rmem_bf16_7
      %lay_1874 = cute.get_layout(%view_1841) : !memref_smem_bf16_15
      %lay_1875 = cute.get_layout(%view_1855) : !memref_rmem_bf16_7
      %append_1876 = cute.append_to_rank<2> (%lay_1874, %1049) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1877 = cute.append_to_rank<2> (%lay_1875, %1049) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1878 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1879 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1880 = cute.size(%lay_1878) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1050 = cute.get_scalars(%sz_1880) : !cute.int_tuple<"2">
      %c0_i32_1881 = arith.constant 0 : i32
      %c1_i32_1882 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1881 to %1050 step %c1_i32_1882  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_1878) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_1872, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_1879) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_1873, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1883 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1884 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_1885 = cute.crd2idx(%coord_1883, %lay_1884) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1886 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_1887 = cute.add_offset(%iter_1886, %idx_1885) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1888 = cute.make_view(%ptr_1887) : !memref_smem_bf16_17
      %iter_1889 = cute.get_iter(%view_1888) : !memref_smem_bf16_17
      %coord_1890 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1891 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_1892 = cute.crd2idx(%coord_1890, %lay_1891) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
      %iter_1893 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_1894 = cute.add_offset(%iter_1893, %idx_1892) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1895 = cute.make_view(%ptr_1894) : !memref_rmem_bf16_9
      %iter_1896 = cute.get_iter(%view_1895) : !memref_rmem_bf16_9
      %lay_1897 = cute.get_layout(%view_1888) : !memref_smem_bf16_17
      %1051 = cute.get_shape(%lay_1897) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1898, %e1_1899, %e2_1900 = cute.get_leaves(%1051) : !cute.shape<"((8,1),4)">
      %lay_1901 = cute.get_layout(%view_1895) : !memref_rmem_bf16_9
      %1052 = cute.get_shape(%lay_1901) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1902, %e1_1903, %e2_1904 = cute.get_leaves(%1052) : !cute.shape<"((8,1),4)">
      %lay_1905 = cute.get_layout(%view_1888) : !memref_smem_bf16_17
      %shape_1906 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1907 = cute.make_layout() : !cute.layout<"1:0">
      %append_1908 = cute.append_to_rank<2> (%lay_1905, %lay_1907) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1909 = cute.make_view(%iter_1889, %append_1908) : !memref_smem_bf16_17
      %iter_1910 = cute.get_iter(%view_1909) : !memref_smem_bf16_17
      %lay_1911 = cute.get_layout(%view_1909) : !memref_smem_bf16_17
      %1053 = cute.get_shape(%lay_1911) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1912, %e1_1913, %e2_1914 = cute.get_leaves(%1053) : !cute.shape<"((8,1),4)">
      %iter_1915 = cute.get_iter(%view_1909) : !memref_smem_bf16_17
      %view_1916 = cute.make_view(%iter_1915) : !memref_smem_bf16_18
      %iter_1917 = cute.get_iter(%view_1916) : !memref_smem_bf16_18
      %iter_1918 = cute.get_iter(%view_1916) : !memref_smem_bf16_18
      %lay_1919 = cute.get_layout(%view_1895) : !memref_rmem_bf16_9
      %shape_1920 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1921 = cute.make_layout() : !cute.layout<"1:0">
      %append_1922 = cute.append_to_rank<2> (%lay_1919, %lay_1921) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1923 = cute.make_view(%iter_1896, %append_1922) : !memref_rmem_bf16_9
      %iter_1924 = cute.get_iter(%view_1923) : !memref_rmem_bf16_9
      %lay_1925 = cute.get_layout(%view_1923) : !memref_rmem_bf16_9
      %1054 = cute.get_shape(%lay_1925) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1926, %e1_1927, %e2_1928 = cute.get_leaves(%1054) : !cute.shape<"((8,1),4)">
      %iter_1929 = cute.get_iter(%view_1923) : !memref_rmem_bf16_9
      %view_1930 = cute.make_view(%iter_1929) : !memref_rmem_bf16_10
      %iter_1931 = cute.get_iter(%view_1930) : !memref_rmem_bf16_10
      %iter_1932 = cute.get_iter(%view_1930) : !memref_rmem_bf16_10
      %lay_1933 = cute.get_layout(%view_1916) : !memref_smem_bf16_18
      %1055 = cute.get_shape(%lay_1933) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1934, %e1_1935, %e2_1936 = cute.get_leaves(%1055) : !cute.shape<"((8,1),(4))">
      %lay_1937 = cute.get_layout(%view_1930) : !memref_rmem_bf16_10
      %1056 = cute.get_shape(%lay_1937) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1938, %e1_1939, %e2_1940 = cute.get_leaves(%1056) : !cute.shape<"((8,1),(4))">
      %lay_1941 = cute.get_layout(%view_1916) : !memref_smem_bf16_18
      %sz_1942 = cute.size(%lay_1941) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1943 = cute.get_leaves(%sz_1942) : !cute.int_tuple<"4">
      %lay_1944 = cute.get_layout(%view_1930) : !memref_rmem_bf16_10
      %sz_1945 = cute.size(%lay_1944) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1946 = cute.get_leaves(%sz_1945) : !cute.int_tuple<"4">
      %1057 = cute.static : !cute.layout<"1:0">
      %iter_1947 = cute.get_iter(%view_1916) : !memref_smem_bf16_18
      %iter_1948 = cute.get_iter(%view_1930) : !memref_rmem_bf16_10
      %lay_1949 = cute.get_layout(%view_1916) : !memref_smem_bf16_18
      %lay_1950 = cute.get_layout(%view_1930) : !memref_rmem_bf16_10
      %append_1951 = cute.append_to_rank<2> (%lay_1949, %1057) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1952 = cute.append_to_rank<2> (%lay_1950, %1057) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1953 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1954 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1955 = cute.size(%lay_1953) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1058 = cute.get_scalars(%sz_1955) : !cute.int_tuple<"4">
      %c0_i32_1956 = arith.constant 0 : i32
      %c1_i32_1957 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1956 to %1058 step %c1_i32_1957  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_1953) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_1947, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_1954) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_1948, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1958 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1959 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_1960 = cute.crd2idx(%coord_1958, %lay_1959) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
      %iter_1961 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_1962 = cute.add_offset(%iter_1961, %idx_1960) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1963 = cute.make_view(%ptr_1962) : !memref_rmem_bf16_12
      %iter_1964 = cute.get_iter(%view_1963) : !memref_rmem_bf16_12
      %coord_1965 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1966 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_1967 = cute.crd2idx(%coord_1965, %lay_1966) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
      %iter_1968 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_1969 = cute.add_offset(%iter_1968, %idx_1967) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1970 = cute.make_view(%ptr_1969) : !memref_rmem_bf16_13
      %iter_1971 = cute.get_iter(%view_1970) : !memref_rmem_bf16_13
      %lay_1972 = cute.get_layout(%view_1963) : !memref_rmem_bf16_12
      %1059 = cute.get_shape(%lay_1972) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1973, %e1_1974, %e2_1975, %e3_1976 = cute.get_leaves(%1059) : !cute.shape<"((2,2,2),2)">
      %lay_1977 = cute.get_layout(%view_1970) : !memref_rmem_bf16_13
      %1060 = cute.get_shape(%lay_1977) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1978, %e1_1979, %e2_1980 = cute.get_leaves(%1060) : !cute.shape<"((2,2),8)">
      %iter_1981 = cute.get_iter(%view_1963) : !memref_rmem_bf16_12
      %iter_1982 = cute.get_iter(%view_1970) : !memref_rmem_bf16_13
      %iter_1983 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_1984 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_1985 = cute.get_layout(%view_1963) : !memref_rmem_bf16_12
      %lay_1986 = cute.get_layout(%view_1970) : !memref_rmem_bf16_13
      %lay_1987 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_1988 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1061 = cute.static : !cute.layout<"1:0">
      %append_1989 = cute.append_to_rank<3> (%lay_1985, %1061) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1990 = cute.append_to_rank<3> (%lay_1986, %1061) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1991 = cute.size(%append_1989) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1992 = cute.size(%append_1989) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1993 = cute.size(%append_1990) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1062 = cute.get_scalars(%sz_1991) : !cute.int_tuple<"1">
      %1063 = cute.get_scalars(%sz_1992) : !cute.int_tuple<"2">
      %1064 = cute.get_scalars(%sz_1993) : !cute.int_tuple<"8">
      %c0_i32_1994 = arith.constant 0 : i32
      %c1_i32_1995 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1994 to %1062 step %c1_i32_1995  : i32 {
        scf.for %arg6 = %c0_i32_1994 to %1063 step %c1_i32_1995  : i32 {
          scf.for %arg7 = %c0_i32_1994 to %1064 step %c1_i32_1995  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_1989) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_1981, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_1990) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_1982, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_1987) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_1983, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_1988) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_1984, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1996 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1997 = cute.size(%int_tuple_1996) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1998 = cute.get_leaves(%sz_1997) : !cute.int_tuple<"8">
      %coord_1999 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2000 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2001 = cute.crd2idx(%coord_1999, %lay_2000) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2002 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2003 = cute.add_offset(%iter_2002, %idx_2001) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2004 = cute.make_view(%ptr_2003) : !memref_smem_bf16_14
      %iter_2005 = cute.get_iter(%view_2004) : !memref_smem_bf16_14
      %coord_2006 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2007 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2008 = cute.crd2idx(%coord_2006, %lay_2007) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
      %iter_2009 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2010 = cute.add_offset(%iter_2009, %idx_2008) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2011 = cute.make_view(%ptr_2010) : !memref_rmem_bf16_6
      %iter_2012 = cute.get_iter(%view_2011) : !memref_rmem_bf16_6
      %lay_2013 = cute.get_layout(%view_2004) : !memref_smem_bf16_14
      %1065 = cute.get_shape(%lay_2013) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2014, %e1_2015, %e2_2016 = cute.get_leaves(%1065) : !cute.shape<"((8,1),2)">
      %lay_2017 = cute.get_layout(%view_2011) : !memref_rmem_bf16_6
      %1066 = cute.get_shape(%lay_2017) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2018, %e1_2019, %e2_2020 = cute.get_leaves(%1066) : !cute.shape<"((8,1),2)">
      %lay_2021 = cute.get_layout(%view_2004) : !memref_smem_bf16_14
      %shape_2022 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2023 = cute.make_layout() : !cute.layout<"1:0">
      %append_2024 = cute.append_to_rank<2> (%lay_2021, %lay_2023) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2025 = cute.make_view(%iter_2005, %append_2024) : !memref_smem_bf16_14
      %iter_2026 = cute.get_iter(%view_2025) : !memref_smem_bf16_14
      %lay_2027 = cute.get_layout(%view_2025) : !memref_smem_bf16_14
      %1067 = cute.get_shape(%lay_2027) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2028, %e1_2029, %e2_2030 = cute.get_leaves(%1067) : !cute.shape<"((8,1),2)">
      %iter_2031 = cute.get_iter(%view_2025) : !memref_smem_bf16_14
      %view_2032 = cute.make_view(%iter_2031) : !memref_smem_bf16_15
      %iter_2033 = cute.get_iter(%view_2032) : !memref_smem_bf16_15
      %iter_2034 = cute.get_iter(%view_2032) : !memref_smem_bf16_15
      %lay_2035 = cute.get_layout(%view_2011) : !memref_rmem_bf16_6
      %shape_2036 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2037 = cute.make_layout() : !cute.layout<"1:0">
      %append_2038 = cute.append_to_rank<2> (%lay_2035, %lay_2037) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2039 = cute.make_view(%iter_2012, %append_2038) : !memref_rmem_bf16_6
      %iter_2040 = cute.get_iter(%view_2039) : !memref_rmem_bf16_6
      %lay_2041 = cute.get_layout(%view_2039) : !memref_rmem_bf16_6
      %1068 = cute.get_shape(%lay_2041) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2042, %e1_2043, %e2_2044 = cute.get_leaves(%1068) : !cute.shape<"((8,1),2)">
      %iter_2045 = cute.get_iter(%view_2039) : !memref_rmem_bf16_6
      %view_2046 = cute.make_view(%iter_2045) : !memref_rmem_bf16_7
      %iter_2047 = cute.get_iter(%view_2046) : !memref_rmem_bf16_7
      %iter_2048 = cute.get_iter(%view_2046) : !memref_rmem_bf16_7
      %lay_2049 = cute.get_layout(%view_2032) : !memref_smem_bf16_15
      %1069 = cute.get_shape(%lay_2049) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2050, %e1_2051, %e2_2052 = cute.get_leaves(%1069) : !cute.shape<"((8,1),(2))">
      %lay_2053 = cute.get_layout(%view_2046) : !memref_rmem_bf16_7
      %1070 = cute.get_shape(%lay_2053) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2054, %e1_2055, %e2_2056 = cute.get_leaves(%1070) : !cute.shape<"((8,1),(2))">
      %lay_2057 = cute.get_layout(%view_2032) : !memref_smem_bf16_15
      %sz_2058 = cute.size(%lay_2057) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2059 = cute.get_leaves(%sz_2058) : !cute.int_tuple<"2">
      %lay_2060 = cute.get_layout(%view_2046) : !memref_rmem_bf16_7
      %sz_2061 = cute.size(%lay_2060) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2062 = cute.get_leaves(%sz_2061) : !cute.int_tuple<"2">
      %1071 = cute.static : !cute.layout<"1:0">
      %iter_2063 = cute.get_iter(%view_2032) : !memref_smem_bf16_15
      %iter_2064 = cute.get_iter(%view_2046) : !memref_rmem_bf16_7
      %lay_2065 = cute.get_layout(%view_2032) : !memref_smem_bf16_15
      %lay_2066 = cute.get_layout(%view_2046) : !memref_rmem_bf16_7
      %append_2067 = cute.append_to_rank<2> (%lay_2065, %1071) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2068 = cute.append_to_rank<2> (%lay_2066, %1071) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2069 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2070 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2071 = cute.size(%lay_2069) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1072 = cute.get_scalars(%sz_2071) : !cute.int_tuple<"2">
      %c0_i32_2072 = arith.constant 0 : i32
      %c1_i32_2073 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2072 to %1072 step %c1_i32_2073  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2069) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_2063, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2070) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2064, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2074 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2075 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_2076 = cute.crd2idx(%coord_2074, %lay_2075) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2077 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_2078 = cute.add_offset(%iter_2077, %idx_2076) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2079 = cute.make_view(%ptr_2078) : !memref_smem_bf16_17
      %iter_2080 = cute.get_iter(%view_2079) : !memref_smem_bf16_17
      %coord_2081 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2082 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_2083 = cute.crd2idx(%coord_2081, %lay_2082) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
      %iter_2084 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_2085 = cute.add_offset(%iter_2084, %idx_2083) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2086 = cute.make_view(%ptr_2085) : !memref_rmem_bf16_9
      %iter_2087 = cute.get_iter(%view_2086) : !memref_rmem_bf16_9
      %lay_2088 = cute.get_layout(%view_2079) : !memref_smem_bf16_17
      %1073 = cute.get_shape(%lay_2088) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2089, %e1_2090, %e2_2091 = cute.get_leaves(%1073) : !cute.shape<"((8,1),4)">
      %lay_2092 = cute.get_layout(%view_2086) : !memref_rmem_bf16_9
      %1074 = cute.get_shape(%lay_2092) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2093, %e1_2094, %e2_2095 = cute.get_leaves(%1074) : !cute.shape<"((8,1),4)">
      %lay_2096 = cute.get_layout(%view_2079) : !memref_smem_bf16_17
      %shape_2097 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2098 = cute.make_layout() : !cute.layout<"1:0">
      %append_2099 = cute.append_to_rank<2> (%lay_2096, %lay_2098) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2100 = cute.make_view(%iter_2080, %append_2099) : !memref_smem_bf16_17
      %iter_2101 = cute.get_iter(%view_2100) : !memref_smem_bf16_17
      %lay_2102 = cute.get_layout(%view_2100) : !memref_smem_bf16_17
      %1075 = cute.get_shape(%lay_2102) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2103, %e1_2104, %e2_2105 = cute.get_leaves(%1075) : !cute.shape<"((8,1),4)">
      %iter_2106 = cute.get_iter(%view_2100) : !memref_smem_bf16_17
      %view_2107 = cute.make_view(%iter_2106) : !memref_smem_bf16_18
      %iter_2108 = cute.get_iter(%view_2107) : !memref_smem_bf16_18
      %iter_2109 = cute.get_iter(%view_2107) : !memref_smem_bf16_18
      %lay_2110 = cute.get_layout(%view_2086) : !memref_rmem_bf16_9
      %shape_2111 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2112 = cute.make_layout() : !cute.layout<"1:0">
      %append_2113 = cute.append_to_rank<2> (%lay_2110, %lay_2112) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2114 = cute.make_view(%iter_2087, %append_2113) : !memref_rmem_bf16_9
      %iter_2115 = cute.get_iter(%view_2114) : !memref_rmem_bf16_9
      %lay_2116 = cute.get_layout(%view_2114) : !memref_rmem_bf16_9
      %1076 = cute.get_shape(%lay_2116) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2117, %e1_2118, %e2_2119 = cute.get_leaves(%1076) : !cute.shape<"((8,1),4)">
      %iter_2120 = cute.get_iter(%view_2114) : !memref_rmem_bf16_9
      %view_2121 = cute.make_view(%iter_2120) : !memref_rmem_bf16_10
      %iter_2122 = cute.get_iter(%view_2121) : !memref_rmem_bf16_10
      %iter_2123 = cute.get_iter(%view_2121) : !memref_rmem_bf16_10
      %lay_2124 = cute.get_layout(%view_2107) : !memref_smem_bf16_18
      %1077 = cute.get_shape(%lay_2124) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2125, %e1_2126, %e2_2127 = cute.get_leaves(%1077) : !cute.shape<"((8,1),(4))">
      %lay_2128 = cute.get_layout(%view_2121) : !memref_rmem_bf16_10
      %1078 = cute.get_shape(%lay_2128) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2129, %e1_2130, %e2_2131 = cute.get_leaves(%1078) : !cute.shape<"((8,1),(4))">
      %lay_2132 = cute.get_layout(%view_2107) : !memref_smem_bf16_18
      %sz_2133 = cute.size(%lay_2132) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2134 = cute.get_leaves(%sz_2133) : !cute.int_tuple<"4">
      %lay_2135 = cute.get_layout(%view_2121) : !memref_rmem_bf16_10
      %sz_2136 = cute.size(%lay_2135) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2137 = cute.get_leaves(%sz_2136) : !cute.int_tuple<"4">
      %1079 = cute.static : !cute.layout<"1:0">
      %iter_2138 = cute.get_iter(%view_2107) : !memref_smem_bf16_18
      %iter_2139 = cute.get_iter(%view_2121) : !memref_rmem_bf16_10
      %lay_2140 = cute.get_layout(%view_2107) : !memref_smem_bf16_18
      %lay_2141 = cute.get_layout(%view_2121) : !memref_rmem_bf16_10
      %append_2142 = cute.append_to_rank<2> (%lay_2140, %1079) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2143 = cute.append_to_rank<2> (%lay_2141, %1079) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2144 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2145 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2146 = cute.size(%lay_2144) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1080 = cute.get_scalars(%sz_2146) : !cute.int_tuple<"4">
      %c0_i32_2147 = arith.constant 0 : i32
      %c1_i32_2148 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2147 to %1080 step %c1_i32_2148  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2144) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_2138, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2145) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2139, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2149 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_2150 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2151 = cute.crd2idx(%coord_2149, %lay_2150) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
      %iter_2152 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2153 = cute.add_offset(%iter_2152, %idx_2151) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2154 = cute.make_view(%ptr_2153) : !memref_rmem_bf16_12
      %iter_2155 = cute.get_iter(%view_2154) : !memref_rmem_bf16_12
      %coord_2156 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_2157 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_2158 = cute.crd2idx(%coord_2156, %lay_2157) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
      %iter_2159 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_2160 = cute.add_offset(%iter_2159, %idx_2158) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2161 = cute.make_view(%ptr_2160) : !memref_rmem_bf16_13
      %iter_2162 = cute.get_iter(%view_2161) : !memref_rmem_bf16_13
      %lay_2163 = cute.get_layout(%view_2154) : !memref_rmem_bf16_12
      %1081 = cute.get_shape(%lay_2163) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2164, %e1_2165, %e2_2166, %e3_2167 = cute.get_leaves(%1081) : !cute.shape<"((2,2,2),2)">
      %lay_2168 = cute.get_layout(%view_2161) : !memref_rmem_bf16_13
      %1082 = cute.get_shape(%lay_2168) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2169, %e1_2170, %e2_2171 = cute.get_leaves(%1082) : !cute.shape<"((2,2),8)">
      %iter_2172 = cute.get_iter(%view_2154) : !memref_rmem_bf16_12
      %iter_2173 = cute.get_iter(%view_2161) : !memref_rmem_bf16_13
      %iter_2174 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_2175 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_2176 = cute.get_layout(%view_2154) : !memref_rmem_bf16_12
      %lay_2177 = cute.get_layout(%view_2161) : !memref_rmem_bf16_13
      %lay_2178 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_2179 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1083 = cute.static : !cute.layout<"1:0">
      %append_2180 = cute.append_to_rank<3> (%lay_2176, %1083) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2181 = cute.append_to_rank<3> (%lay_2177, %1083) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2182 = cute.size(%append_2180) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2183 = cute.size(%append_2180) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2184 = cute.size(%append_2181) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1084 = cute.get_scalars(%sz_2182) : !cute.int_tuple<"1">
      %1085 = cute.get_scalars(%sz_2183) : !cute.int_tuple<"2">
      %1086 = cute.get_scalars(%sz_2184) : !cute.int_tuple<"8">
      %c0_i32_2185 = arith.constant 0 : i32
      %c1_i32_2186 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2185 to %1084 step %c1_i32_2186  : i32 {
        scf.for %arg6 = %c0_i32_2185 to %1085 step %c1_i32_2186  : i32 {
          scf.for %arg7 = %c0_i32_2185 to %1086 step %c1_i32_2186  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_2180) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_2172, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_2181) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_2173, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_2178) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_2174, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_2179) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_2175, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2187 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2188 = cute.size(%int_tuple_2187) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2189 = cute.get_leaves(%sz_2188) : !cute.int_tuple<"8">
      %coord_2190 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2191 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2192 = cute.crd2idx(%coord_2190, %lay_2191) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2193 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2194 = cute.add_offset(%iter_2193, %idx_2192) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2195 = cute.make_view(%ptr_2194) : !memref_smem_bf16_14
      %iter_2196 = cute.get_iter(%view_2195) : !memref_smem_bf16_14
      %coord_2197 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2198 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2199 = cute.crd2idx(%coord_2197, %lay_2198) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
      %iter_2200 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2201 = cute.add_offset(%iter_2200, %idx_2199) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2202 = cute.make_view(%ptr_2201) : !memref_rmem_bf16_6
      %iter_2203 = cute.get_iter(%view_2202) : !memref_rmem_bf16_6
      %lay_2204 = cute.get_layout(%view_2195) : !memref_smem_bf16_14
      %1087 = cute.get_shape(%lay_2204) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2205, %e1_2206, %e2_2207 = cute.get_leaves(%1087) : !cute.shape<"((8,1),2)">
      %lay_2208 = cute.get_layout(%view_2202) : !memref_rmem_bf16_6
      %1088 = cute.get_shape(%lay_2208) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2209, %e1_2210, %e2_2211 = cute.get_leaves(%1088) : !cute.shape<"((8,1),2)">
      %lay_2212 = cute.get_layout(%view_2195) : !memref_smem_bf16_14
      %shape_2213 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2214 = cute.make_layout() : !cute.layout<"1:0">
      %append_2215 = cute.append_to_rank<2> (%lay_2212, %lay_2214) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2216 = cute.make_view(%iter_2196, %append_2215) : !memref_smem_bf16_14
      %iter_2217 = cute.get_iter(%view_2216) : !memref_smem_bf16_14
      %lay_2218 = cute.get_layout(%view_2216) : !memref_smem_bf16_14
      %1089 = cute.get_shape(%lay_2218) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2219, %e1_2220, %e2_2221 = cute.get_leaves(%1089) : !cute.shape<"((8,1),2)">
      %iter_2222 = cute.get_iter(%view_2216) : !memref_smem_bf16_14
      %view_2223 = cute.make_view(%iter_2222) : !memref_smem_bf16_15
      %iter_2224 = cute.get_iter(%view_2223) : !memref_smem_bf16_15
      %iter_2225 = cute.get_iter(%view_2223) : !memref_smem_bf16_15
      %lay_2226 = cute.get_layout(%view_2202) : !memref_rmem_bf16_6
      %shape_2227 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2228 = cute.make_layout() : !cute.layout<"1:0">
      %append_2229 = cute.append_to_rank<2> (%lay_2226, %lay_2228) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2230 = cute.make_view(%iter_2203, %append_2229) : !memref_rmem_bf16_6
      %iter_2231 = cute.get_iter(%view_2230) : !memref_rmem_bf16_6
      %lay_2232 = cute.get_layout(%view_2230) : !memref_rmem_bf16_6
      %1090 = cute.get_shape(%lay_2232) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2233, %e1_2234, %e2_2235 = cute.get_leaves(%1090) : !cute.shape<"((8,1),2)">
      %iter_2236 = cute.get_iter(%view_2230) : !memref_rmem_bf16_6
      %view_2237 = cute.make_view(%iter_2236) : !memref_rmem_bf16_7
      %iter_2238 = cute.get_iter(%view_2237) : !memref_rmem_bf16_7
      %iter_2239 = cute.get_iter(%view_2237) : !memref_rmem_bf16_7
      %lay_2240 = cute.get_layout(%view_2223) : !memref_smem_bf16_15
      %1091 = cute.get_shape(%lay_2240) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2241, %e1_2242, %e2_2243 = cute.get_leaves(%1091) : !cute.shape<"((8,1),(2))">
      %lay_2244 = cute.get_layout(%view_2237) : !memref_rmem_bf16_7
      %1092 = cute.get_shape(%lay_2244) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2245, %e1_2246, %e2_2247 = cute.get_leaves(%1092) : !cute.shape<"((8,1),(2))">
      %lay_2248 = cute.get_layout(%view_2223) : !memref_smem_bf16_15
      %sz_2249 = cute.size(%lay_2248) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2250 = cute.get_leaves(%sz_2249) : !cute.int_tuple<"2">
      %lay_2251 = cute.get_layout(%view_2237) : !memref_rmem_bf16_7
      %sz_2252 = cute.size(%lay_2251) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2253 = cute.get_leaves(%sz_2252) : !cute.int_tuple<"2">
      %1093 = cute.static : !cute.layout<"1:0">
      %iter_2254 = cute.get_iter(%view_2223) : !memref_smem_bf16_15
      %iter_2255 = cute.get_iter(%view_2237) : !memref_rmem_bf16_7
      %lay_2256 = cute.get_layout(%view_2223) : !memref_smem_bf16_15
      %lay_2257 = cute.get_layout(%view_2237) : !memref_rmem_bf16_7
      %append_2258 = cute.append_to_rank<2> (%lay_2256, %1093) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2259 = cute.append_to_rank<2> (%lay_2257, %1093) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2260 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2261 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2262 = cute.size(%lay_2260) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1094 = cute.get_scalars(%sz_2262) : !cute.int_tuple<"2">
      %c0_i32_2263 = arith.constant 0 : i32
      %c1_i32_2264 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2263 to %1094 step %c1_i32_2264  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2260) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_2254, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2261) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2255, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2265 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2266 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_2267 = cute.crd2idx(%coord_2265, %lay_2266) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2268 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_2269 = cute.add_offset(%iter_2268, %idx_2267) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2270 = cute.make_view(%ptr_2269) : !memref_smem_bf16_17
      %iter_2271 = cute.get_iter(%view_2270) : !memref_smem_bf16_17
      %coord_2272 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2273 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_2274 = cute.crd2idx(%coord_2272, %lay_2273) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
      %iter_2275 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_2276 = cute.add_offset(%iter_2275, %idx_2274) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2277 = cute.make_view(%ptr_2276) : !memref_rmem_bf16_9
      %iter_2278 = cute.get_iter(%view_2277) : !memref_rmem_bf16_9
      %lay_2279 = cute.get_layout(%view_2270) : !memref_smem_bf16_17
      %1095 = cute.get_shape(%lay_2279) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2280, %e1_2281, %e2_2282 = cute.get_leaves(%1095) : !cute.shape<"((8,1),4)">
      %lay_2283 = cute.get_layout(%view_2277) : !memref_rmem_bf16_9
      %1096 = cute.get_shape(%lay_2283) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2284, %e1_2285, %e2_2286 = cute.get_leaves(%1096) : !cute.shape<"((8,1),4)">
      %lay_2287 = cute.get_layout(%view_2270) : !memref_smem_bf16_17
      %shape_2288 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2289 = cute.make_layout() : !cute.layout<"1:0">
      %append_2290 = cute.append_to_rank<2> (%lay_2287, %lay_2289) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2291 = cute.make_view(%iter_2271, %append_2290) : !memref_smem_bf16_17
      %iter_2292 = cute.get_iter(%view_2291) : !memref_smem_bf16_17
      %lay_2293 = cute.get_layout(%view_2291) : !memref_smem_bf16_17
      %1097 = cute.get_shape(%lay_2293) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2294, %e1_2295, %e2_2296 = cute.get_leaves(%1097) : !cute.shape<"((8,1),4)">
      %iter_2297 = cute.get_iter(%view_2291) : !memref_smem_bf16_17
      %view_2298 = cute.make_view(%iter_2297) : !memref_smem_bf16_18
      %iter_2299 = cute.get_iter(%view_2298) : !memref_smem_bf16_18
      %iter_2300 = cute.get_iter(%view_2298) : !memref_smem_bf16_18
      %lay_2301 = cute.get_layout(%view_2277) : !memref_rmem_bf16_9
      %shape_2302 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2303 = cute.make_layout() : !cute.layout<"1:0">
      %append_2304 = cute.append_to_rank<2> (%lay_2301, %lay_2303) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2305 = cute.make_view(%iter_2278, %append_2304) : !memref_rmem_bf16_9
      %iter_2306 = cute.get_iter(%view_2305) : !memref_rmem_bf16_9
      %lay_2307 = cute.get_layout(%view_2305) : !memref_rmem_bf16_9
      %1098 = cute.get_shape(%lay_2307) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2308, %e1_2309, %e2_2310 = cute.get_leaves(%1098) : !cute.shape<"((8,1),4)">
      %iter_2311 = cute.get_iter(%view_2305) : !memref_rmem_bf16_9
      %view_2312 = cute.make_view(%iter_2311) : !memref_rmem_bf16_10
      %iter_2313 = cute.get_iter(%view_2312) : !memref_rmem_bf16_10
      %iter_2314 = cute.get_iter(%view_2312) : !memref_rmem_bf16_10
      %lay_2315 = cute.get_layout(%view_2298) : !memref_smem_bf16_18
      %1099 = cute.get_shape(%lay_2315) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2316, %e1_2317, %e2_2318 = cute.get_leaves(%1099) : !cute.shape<"((8,1),(4))">
      %lay_2319 = cute.get_layout(%view_2312) : !memref_rmem_bf16_10
      %1100 = cute.get_shape(%lay_2319) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2320, %e1_2321, %e2_2322 = cute.get_leaves(%1100) : !cute.shape<"((8,1),(4))">
      %lay_2323 = cute.get_layout(%view_2298) : !memref_smem_bf16_18
      %sz_2324 = cute.size(%lay_2323) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2325 = cute.get_leaves(%sz_2324) : !cute.int_tuple<"4">
      %lay_2326 = cute.get_layout(%view_2312) : !memref_rmem_bf16_10
      %sz_2327 = cute.size(%lay_2326) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2328 = cute.get_leaves(%sz_2327) : !cute.int_tuple<"4">
      %1101 = cute.static : !cute.layout<"1:0">
      %iter_2329 = cute.get_iter(%view_2298) : !memref_smem_bf16_18
      %iter_2330 = cute.get_iter(%view_2312) : !memref_rmem_bf16_10
      %lay_2331 = cute.get_layout(%view_2298) : !memref_smem_bf16_18
      %lay_2332 = cute.get_layout(%view_2312) : !memref_rmem_bf16_10
      %append_2333 = cute.append_to_rank<2> (%lay_2331, %1101) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2334 = cute.append_to_rank<2> (%lay_2332, %1101) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2335 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2336 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2337 = cute.size(%lay_2335) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1102 = cute.get_scalars(%sz_2337) : !cute.int_tuple<"4">
      %c0_i32_2338 = arith.constant 0 : i32
      %c1_i32_2339 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2338 to %1102 step %c1_i32_2339  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2335) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_2329, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2336) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2330, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2340 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2341 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2342 = cute.crd2idx(%coord_2340, %lay_2341) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
      %iter_2343 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2344 = cute.add_offset(%iter_2343, %idx_2342) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2345 = cute.make_view(%ptr_2344) : !memref_rmem_bf16_12
      %iter_2346 = cute.get_iter(%view_2345) : !memref_rmem_bf16_12
      %coord_2347 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2348 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_2349 = cute.crd2idx(%coord_2347, %lay_2348) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
      %iter_2350 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_2351 = cute.add_offset(%iter_2350, %idx_2349) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2352 = cute.make_view(%ptr_2351) : !memref_rmem_bf16_13
      %iter_2353 = cute.get_iter(%view_2352) : !memref_rmem_bf16_13
      %lay_2354 = cute.get_layout(%view_2345) : !memref_rmem_bf16_12
      %1103 = cute.get_shape(%lay_2354) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2355, %e1_2356, %e2_2357, %e3_2358 = cute.get_leaves(%1103) : !cute.shape<"((2,2,2),2)">
      %lay_2359 = cute.get_layout(%view_2352) : !memref_rmem_bf16_13
      %1104 = cute.get_shape(%lay_2359) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2360, %e1_2361, %e2_2362 = cute.get_leaves(%1104) : !cute.shape<"((2,2),8)">
      %iter_2363 = cute.get_iter(%view_2345) : !memref_rmem_bf16_12
      %iter_2364 = cute.get_iter(%view_2352) : !memref_rmem_bf16_13
      %iter_2365 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_2366 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_2367 = cute.get_layout(%view_2345) : !memref_rmem_bf16_12
      %lay_2368 = cute.get_layout(%view_2352) : !memref_rmem_bf16_13
      %lay_2369 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_2370 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1105 = cute.static : !cute.layout<"1:0">
      %append_2371 = cute.append_to_rank<3> (%lay_2367, %1105) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2372 = cute.append_to_rank<3> (%lay_2368, %1105) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2373 = cute.size(%append_2371) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2374 = cute.size(%append_2371) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2375 = cute.size(%append_2372) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1106 = cute.get_scalars(%sz_2373) : !cute.int_tuple<"1">
      %1107 = cute.get_scalars(%sz_2374) : !cute.int_tuple<"2">
      %1108 = cute.get_scalars(%sz_2375) : !cute.int_tuple<"8">
      %c0_i32_2376 = arith.constant 0 : i32
      %c1_i32_2377 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2376 to %1106 step %c1_i32_2377  : i32 {
        scf.for %arg6 = %c0_i32_2376 to %1107 step %c1_i32_2377  : i32 {
          scf.for %arg7 = %c0_i32_2376 to %1108 step %c1_i32_2377  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_2371) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_2363, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_2372) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_2364, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_2369) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_2365, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_2370) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_2366, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2378 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2379 = cute.size(%int_tuple_2378) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2380 = cute.get_leaves(%sz_2379) : !cute.int_tuple<"8">
      %coord_2381 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2382 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2383 = cute.crd2idx(%coord_2381, %lay_2382) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
      %iter_2384 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2385 = cute.add_offset(%iter_2384, %idx_2383) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2386 = cute.make_view(%ptr_2385) : !memref_smem_bf16_14
      %iter_2387 = cute.get_iter(%view_2386) : !memref_smem_bf16_14
      %coord_2388 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2389 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2390 = cute.crd2idx(%coord_2388, %lay_2389) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
      %iter_2391 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2392 = cute.add_offset(%iter_2391, %idx_2390) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2393 = cute.make_view(%ptr_2392) : !memref_rmem_bf16_6
      %iter_2394 = cute.get_iter(%view_2393) : !memref_rmem_bf16_6
      %lay_2395 = cute.get_layout(%view_2386) : !memref_smem_bf16_14
      %1109 = cute.get_shape(%lay_2395) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2396, %e1_2397, %e2_2398 = cute.get_leaves(%1109) : !cute.shape<"((8,1),2)">
      %lay_2399 = cute.get_layout(%view_2393) : !memref_rmem_bf16_6
      %1110 = cute.get_shape(%lay_2399) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2400, %e1_2401, %e2_2402 = cute.get_leaves(%1110) : !cute.shape<"((8,1),2)">
      %lay_2403 = cute.get_layout(%view_2386) : !memref_smem_bf16_14
      %shape_2404 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2405 = cute.make_layout() : !cute.layout<"1:0">
      %append_2406 = cute.append_to_rank<2> (%lay_2403, %lay_2405) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2407 = cute.make_view(%iter_2387, %append_2406) : !memref_smem_bf16_14
      %iter_2408 = cute.get_iter(%view_2407) : !memref_smem_bf16_14
      %lay_2409 = cute.get_layout(%view_2407) : !memref_smem_bf16_14
      %1111 = cute.get_shape(%lay_2409) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2410, %e1_2411, %e2_2412 = cute.get_leaves(%1111) : !cute.shape<"((8,1),2)">
      %iter_2413 = cute.get_iter(%view_2407) : !memref_smem_bf16_14
      %view_2414 = cute.make_view(%iter_2413) : !memref_smem_bf16_15
      %iter_2415 = cute.get_iter(%view_2414) : !memref_smem_bf16_15
      %iter_2416 = cute.get_iter(%view_2414) : !memref_smem_bf16_15
      %lay_2417 = cute.get_layout(%view_2393) : !memref_rmem_bf16_6
      %shape_2418 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2419 = cute.make_layout() : !cute.layout<"1:0">
      %append_2420 = cute.append_to_rank<2> (%lay_2417, %lay_2419) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2421 = cute.make_view(%iter_2394, %append_2420) : !memref_rmem_bf16_6
      %iter_2422 = cute.get_iter(%view_2421) : !memref_rmem_bf16_6
      %lay_2423 = cute.get_layout(%view_2421) : !memref_rmem_bf16_6
      %1112 = cute.get_shape(%lay_2423) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2424, %e1_2425, %e2_2426 = cute.get_leaves(%1112) : !cute.shape<"((8,1),2)">
      %iter_2427 = cute.get_iter(%view_2421) : !memref_rmem_bf16_6
      %view_2428 = cute.make_view(%iter_2427) : !memref_rmem_bf16_7
      %iter_2429 = cute.get_iter(%view_2428) : !memref_rmem_bf16_7
      %iter_2430 = cute.get_iter(%view_2428) : !memref_rmem_bf16_7
      %lay_2431 = cute.get_layout(%view_2414) : !memref_smem_bf16_15
      %1113 = cute.get_shape(%lay_2431) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2432, %e1_2433, %e2_2434 = cute.get_leaves(%1113) : !cute.shape<"((8,1),(2))">
      %lay_2435 = cute.get_layout(%view_2428) : !memref_rmem_bf16_7
      %1114 = cute.get_shape(%lay_2435) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2436, %e1_2437, %e2_2438 = cute.get_leaves(%1114) : !cute.shape<"((8,1),(2))">
      %lay_2439 = cute.get_layout(%view_2414) : !memref_smem_bf16_15
      %sz_2440 = cute.size(%lay_2439) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2441 = cute.get_leaves(%sz_2440) : !cute.int_tuple<"2">
      %lay_2442 = cute.get_layout(%view_2428) : !memref_rmem_bf16_7
      %sz_2443 = cute.size(%lay_2442) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2444 = cute.get_leaves(%sz_2443) : !cute.int_tuple<"2">
      %1115 = cute.static : !cute.layout<"1:0">
      %iter_2445 = cute.get_iter(%view_2414) : !memref_smem_bf16_15
      %iter_2446 = cute.get_iter(%view_2428) : !memref_rmem_bf16_7
      %lay_2447 = cute.get_layout(%view_2414) : !memref_smem_bf16_15
      %lay_2448 = cute.get_layout(%view_2428) : !memref_rmem_bf16_7
      %append_2449 = cute.append_to_rank<2> (%lay_2447, %1115) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2450 = cute.append_to_rank<2> (%lay_2448, %1115) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2451 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2452 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2453 = cute.size(%lay_2451) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1116 = cute.get_scalars(%sz_2453) : !cute.int_tuple<"2">
      %c0_i32_2454 = arith.constant 0 : i32
      %c1_i32_2455 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2454 to %1116 step %c1_i32_2455  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2451) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_2445, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2452) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2446, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2456 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2457 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_2458 = cute.crd2idx(%coord_2456, %lay_2457) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
      %iter_2459 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_2460 = cute.add_offset(%iter_2459, %idx_2458) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2461 = cute.make_view(%ptr_2460) : !memref_smem_bf16_17
      %iter_2462 = cute.get_iter(%view_2461) : !memref_smem_bf16_17
      %coord_2463 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2464 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_2465 = cute.crd2idx(%coord_2463, %lay_2464) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
      %iter_2466 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_2467 = cute.add_offset(%iter_2466, %idx_2465) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2468 = cute.make_view(%ptr_2467) : !memref_rmem_bf16_9
      %iter_2469 = cute.get_iter(%view_2468) : !memref_rmem_bf16_9
      %lay_2470 = cute.get_layout(%view_2461) : !memref_smem_bf16_17
      %1117 = cute.get_shape(%lay_2470) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2471, %e1_2472, %e2_2473 = cute.get_leaves(%1117) : !cute.shape<"((8,1),4)">
      %lay_2474 = cute.get_layout(%view_2468) : !memref_rmem_bf16_9
      %1118 = cute.get_shape(%lay_2474) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2475, %e1_2476, %e2_2477 = cute.get_leaves(%1118) : !cute.shape<"((8,1),4)">
      %lay_2478 = cute.get_layout(%view_2461) : !memref_smem_bf16_17
      %shape_2479 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2480 = cute.make_layout() : !cute.layout<"1:0">
      %append_2481 = cute.append_to_rank<2> (%lay_2478, %lay_2480) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2482 = cute.make_view(%iter_2462, %append_2481) : !memref_smem_bf16_17
      %iter_2483 = cute.get_iter(%view_2482) : !memref_smem_bf16_17
      %lay_2484 = cute.get_layout(%view_2482) : !memref_smem_bf16_17
      %1119 = cute.get_shape(%lay_2484) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2485, %e1_2486, %e2_2487 = cute.get_leaves(%1119) : !cute.shape<"((8,1),4)">
      %iter_2488 = cute.get_iter(%view_2482) : !memref_smem_bf16_17
      %view_2489 = cute.make_view(%iter_2488) : !memref_smem_bf16_18
      %iter_2490 = cute.get_iter(%view_2489) : !memref_smem_bf16_18
      %iter_2491 = cute.get_iter(%view_2489) : !memref_smem_bf16_18
      %lay_2492 = cute.get_layout(%view_2468) : !memref_rmem_bf16_9
      %shape_2493 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2494 = cute.make_layout() : !cute.layout<"1:0">
      %append_2495 = cute.append_to_rank<2> (%lay_2492, %lay_2494) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2496 = cute.make_view(%iter_2469, %append_2495) : !memref_rmem_bf16_9
      %iter_2497 = cute.get_iter(%view_2496) : !memref_rmem_bf16_9
      %lay_2498 = cute.get_layout(%view_2496) : !memref_rmem_bf16_9
      %1120 = cute.get_shape(%lay_2498) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2499, %e1_2500, %e2_2501 = cute.get_leaves(%1120) : !cute.shape<"((8,1),4)">
      %iter_2502 = cute.get_iter(%view_2496) : !memref_rmem_bf16_9
      %view_2503 = cute.make_view(%iter_2502) : !memref_rmem_bf16_10
      %iter_2504 = cute.get_iter(%view_2503) : !memref_rmem_bf16_10
      %iter_2505 = cute.get_iter(%view_2503) : !memref_rmem_bf16_10
      %lay_2506 = cute.get_layout(%view_2489) : !memref_smem_bf16_18
      %1121 = cute.get_shape(%lay_2506) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2507, %e1_2508, %e2_2509 = cute.get_leaves(%1121) : !cute.shape<"((8,1),(4))">
      %lay_2510 = cute.get_layout(%view_2503) : !memref_rmem_bf16_10
      %1122 = cute.get_shape(%lay_2510) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2511, %e1_2512, %e2_2513 = cute.get_leaves(%1122) : !cute.shape<"((8,1),(4))">
      %lay_2514 = cute.get_layout(%view_2489) : !memref_smem_bf16_18
      %sz_2515 = cute.size(%lay_2514) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2516 = cute.get_leaves(%sz_2515) : !cute.int_tuple<"4">
      %lay_2517 = cute.get_layout(%view_2503) : !memref_rmem_bf16_10
      %sz_2518 = cute.size(%lay_2517) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2519 = cute.get_leaves(%sz_2518) : !cute.int_tuple<"4">
      %1123 = cute.static : !cute.layout<"1:0">
      %iter_2520 = cute.get_iter(%view_2489) : !memref_smem_bf16_18
      %iter_2521 = cute.get_iter(%view_2503) : !memref_rmem_bf16_10
      %lay_2522 = cute.get_layout(%view_2489) : !memref_smem_bf16_18
      %lay_2523 = cute.get_layout(%view_2503) : !memref_rmem_bf16_10
      %append_2524 = cute.append_to_rank<2> (%lay_2522, %1123) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2525 = cute.append_to_rank<2> (%lay_2523, %1123) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2526 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2527 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2528 = cute.size(%lay_2526) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1124 = cute.get_scalars(%sz_2528) : !cute.int_tuple<"4">
      %c0_i32_2529 = arith.constant 0 : i32
      %c1_i32_2530 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2529 to %1124 step %c1_i32_2530  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2526) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_2520, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2527) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2521, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2531 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2532 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2533 = cute.crd2idx(%coord_2531, %lay_2532) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
      %iter_2534 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2535 = cute.add_offset(%iter_2534, %idx_2533) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2536 = cute.make_view(%ptr_2535) : !memref_rmem_bf16_12
      %iter_2537 = cute.get_iter(%view_2536) : !memref_rmem_bf16_12
      %coord_2538 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2539 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_2540 = cute.crd2idx(%coord_2538, %lay_2539) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
      %iter_2541 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_2542 = cute.add_offset(%iter_2541, %idx_2540) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2543 = cute.make_view(%ptr_2542) : !memref_rmem_bf16_13
      %iter_2544 = cute.get_iter(%view_2543) : !memref_rmem_bf16_13
      %lay_2545 = cute.get_layout(%view_2536) : !memref_rmem_bf16_12
      %1125 = cute.get_shape(%lay_2545) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2546, %e1_2547, %e2_2548, %e3_2549 = cute.get_leaves(%1125) : !cute.shape<"((2,2,2),2)">
      %lay_2550 = cute.get_layout(%view_2543) : !memref_rmem_bf16_13
      %1126 = cute.get_shape(%lay_2550) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2551, %e1_2552, %e2_2553 = cute.get_leaves(%1126) : !cute.shape<"((2,2),8)">
      %iter_2554 = cute.get_iter(%view_2536) : !memref_rmem_bf16_12
      %iter_2555 = cute.get_iter(%view_2543) : !memref_rmem_bf16_13
      %iter_2556 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_2557 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_2558 = cute.get_layout(%view_2536) : !memref_rmem_bf16_12
      %lay_2559 = cute.get_layout(%view_2543) : !memref_rmem_bf16_13
      %lay_2560 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_2561 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1127 = cute.static : !cute.layout<"1:0">
      %append_2562 = cute.append_to_rank<3> (%lay_2558, %1127) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2563 = cute.append_to_rank<3> (%lay_2559, %1127) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2564 = cute.size(%append_2562) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2565 = cute.size(%append_2562) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2566 = cute.size(%append_2563) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1128 = cute.get_scalars(%sz_2564) : !cute.int_tuple<"1">
      %1129 = cute.get_scalars(%sz_2565) : !cute.int_tuple<"2">
      %1130 = cute.get_scalars(%sz_2566) : !cute.int_tuple<"8">
      %c0_i32_2567 = arith.constant 0 : i32
      %c1_i32_2568 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2567 to %1128 step %c1_i32_2568  : i32 {
        scf.for %arg6 = %c0_i32_2567 to %1129 step %c1_i32_2568  : i32 {
          scf.for %arg7 = %c0_i32_2567 to %1130 step %c1_i32_2568  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_2562) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_2554, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_2563) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_2555, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_2560) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_2556, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_2561) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_2557, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2569 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2570 = cute.size(%int_tuple_2569) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2571 = cute.get_leaves(%sz_2570) : !cute.int_tuple<"8">
      %coord_2572 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2573 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2574 = cute.crd2idx(%coord_2572, %lay_2573) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2575 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2576 = cute.add_offset(%iter_2575, %idx_2574) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2577 = cute.make_view(%ptr_2576) : !memref_smem_bf16_14
      %iter_2578 = cute.get_iter(%view_2577) : !memref_smem_bf16_14
      %coord_2579 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2580 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2581 = cute.crd2idx(%coord_2579, %lay_2580) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
      %iter_2582 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2583 = cute.add_offset(%iter_2582, %idx_2581) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2584 = cute.make_view(%ptr_2583) : !memref_rmem_bf16_6
      %iter_2585 = cute.get_iter(%view_2584) : !memref_rmem_bf16_6
      %lay_2586 = cute.get_layout(%view_2577) : !memref_smem_bf16_14
      %1131 = cute.get_shape(%lay_2586) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2587, %e1_2588, %e2_2589 = cute.get_leaves(%1131) : !cute.shape<"((8,1),2)">
      %lay_2590 = cute.get_layout(%view_2584) : !memref_rmem_bf16_6
      %1132 = cute.get_shape(%lay_2590) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2591, %e1_2592, %e2_2593 = cute.get_leaves(%1132) : !cute.shape<"((8,1),2)">
      %lay_2594 = cute.get_layout(%view_2577) : !memref_smem_bf16_14
      %shape_2595 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2596 = cute.make_layout() : !cute.layout<"1:0">
      %append_2597 = cute.append_to_rank<2> (%lay_2594, %lay_2596) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2598 = cute.make_view(%iter_2578, %append_2597) : !memref_smem_bf16_14
      %iter_2599 = cute.get_iter(%view_2598) : !memref_smem_bf16_14
      %lay_2600 = cute.get_layout(%view_2598) : !memref_smem_bf16_14
      %1133 = cute.get_shape(%lay_2600) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2601, %e1_2602, %e2_2603 = cute.get_leaves(%1133) : !cute.shape<"((8,1),2)">
      %iter_2604 = cute.get_iter(%view_2598) : !memref_smem_bf16_14
      %view_2605 = cute.make_view(%iter_2604) : !memref_smem_bf16_15
      %iter_2606 = cute.get_iter(%view_2605) : !memref_smem_bf16_15
      %iter_2607 = cute.get_iter(%view_2605) : !memref_smem_bf16_15
      %lay_2608 = cute.get_layout(%view_2584) : !memref_rmem_bf16_6
      %shape_2609 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2610 = cute.make_layout() : !cute.layout<"1:0">
      %append_2611 = cute.append_to_rank<2> (%lay_2608, %lay_2610) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2612 = cute.make_view(%iter_2585, %append_2611) : !memref_rmem_bf16_6
      %iter_2613 = cute.get_iter(%view_2612) : !memref_rmem_bf16_6
      %lay_2614 = cute.get_layout(%view_2612) : !memref_rmem_bf16_6
      %1134 = cute.get_shape(%lay_2614) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2615, %e1_2616, %e2_2617 = cute.get_leaves(%1134) : !cute.shape<"((8,1),2)">
      %iter_2618 = cute.get_iter(%view_2612) : !memref_rmem_bf16_6
      %view_2619 = cute.make_view(%iter_2618) : !memref_rmem_bf16_7
      %iter_2620 = cute.get_iter(%view_2619) : !memref_rmem_bf16_7
      %iter_2621 = cute.get_iter(%view_2619) : !memref_rmem_bf16_7
      %lay_2622 = cute.get_layout(%view_2605) : !memref_smem_bf16_15
      %1135 = cute.get_shape(%lay_2622) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2623, %e1_2624, %e2_2625 = cute.get_leaves(%1135) : !cute.shape<"((8,1),(2))">
      %lay_2626 = cute.get_layout(%view_2619) : !memref_rmem_bf16_7
      %1136 = cute.get_shape(%lay_2626) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2627, %e1_2628, %e2_2629 = cute.get_leaves(%1136) : !cute.shape<"((8,1),(2))">
      %lay_2630 = cute.get_layout(%view_2605) : !memref_smem_bf16_15
      %sz_2631 = cute.size(%lay_2630) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2632 = cute.get_leaves(%sz_2631) : !cute.int_tuple<"2">
      %lay_2633 = cute.get_layout(%view_2619) : !memref_rmem_bf16_7
      %sz_2634 = cute.size(%lay_2633) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2635 = cute.get_leaves(%sz_2634) : !cute.int_tuple<"2">
      %1137 = cute.static : !cute.layout<"1:0">
      %iter_2636 = cute.get_iter(%view_2605) : !memref_smem_bf16_15
      %iter_2637 = cute.get_iter(%view_2619) : !memref_rmem_bf16_7
      %lay_2638 = cute.get_layout(%view_2605) : !memref_smem_bf16_15
      %lay_2639 = cute.get_layout(%view_2619) : !memref_rmem_bf16_7
      %append_2640 = cute.append_to_rank<2> (%lay_2638, %1137) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2641 = cute.append_to_rank<2> (%lay_2639, %1137) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2642 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2643 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2644 = cute.size(%lay_2642) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1138 = cute.get_scalars(%sz_2644) : !cute.int_tuple<"2">
      %c0_i32_2645 = arith.constant 0 : i32
      %c1_i32_2646 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2645 to %1138 step %c1_i32_2646  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2642) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_2636, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2643) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2637, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2647 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2648 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_2649 = cute.crd2idx(%coord_2647, %lay_2648) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2650 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_2651 = cute.add_offset(%iter_2650, %idx_2649) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2652 = cute.make_view(%ptr_2651) : !memref_smem_bf16_17
      %iter_2653 = cute.get_iter(%view_2652) : !memref_smem_bf16_17
      %coord_2654 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2655 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_2656 = cute.crd2idx(%coord_2654, %lay_2655) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
      %iter_2657 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_2658 = cute.add_offset(%iter_2657, %idx_2656) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2659 = cute.make_view(%ptr_2658) : !memref_rmem_bf16_9
      %iter_2660 = cute.get_iter(%view_2659) : !memref_rmem_bf16_9
      %lay_2661 = cute.get_layout(%view_2652) : !memref_smem_bf16_17
      %1139 = cute.get_shape(%lay_2661) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2662, %e1_2663, %e2_2664 = cute.get_leaves(%1139) : !cute.shape<"((8,1),4)">
      %lay_2665 = cute.get_layout(%view_2659) : !memref_rmem_bf16_9
      %1140 = cute.get_shape(%lay_2665) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2666, %e1_2667, %e2_2668 = cute.get_leaves(%1140) : !cute.shape<"((8,1),4)">
      %lay_2669 = cute.get_layout(%view_2652) : !memref_smem_bf16_17
      %shape_2670 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2671 = cute.make_layout() : !cute.layout<"1:0">
      %append_2672 = cute.append_to_rank<2> (%lay_2669, %lay_2671) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2673 = cute.make_view(%iter_2653, %append_2672) : !memref_smem_bf16_17
      %iter_2674 = cute.get_iter(%view_2673) : !memref_smem_bf16_17
      %lay_2675 = cute.get_layout(%view_2673) : !memref_smem_bf16_17
      %1141 = cute.get_shape(%lay_2675) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2676, %e1_2677, %e2_2678 = cute.get_leaves(%1141) : !cute.shape<"((8,1),4)">
      %iter_2679 = cute.get_iter(%view_2673) : !memref_smem_bf16_17
      %view_2680 = cute.make_view(%iter_2679) : !memref_smem_bf16_18
      %iter_2681 = cute.get_iter(%view_2680) : !memref_smem_bf16_18
      %iter_2682 = cute.get_iter(%view_2680) : !memref_smem_bf16_18
      %lay_2683 = cute.get_layout(%view_2659) : !memref_rmem_bf16_9
      %shape_2684 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2685 = cute.make_layout() : !cute.layout<"1:0">
      %append_2686 = cute.append_to_rank<2> (%lay_2683, %lay_2685) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2687 = cute.make_view(%iter_2660, %append_2686) : !memref_rmem_bf16_9
      %iter_2688 = cute.get_iter(%view_2687) : !memref_rmem_bf16_9
      %lay_2689 = cute.get_layout(%view_2687) : !memref_rmem_bf16_9
      %1142 = cute.get_shape(%lay_2689) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2690, %e1_2691, %e2_2692 = cute.get_leaves(%1142) : !cute.shape<"((8,1),4)">
      %iter_2693 = cute.get_iter(%view_2687) : !memref_rmem_bf16_9
      %view_2694 = cute.make_view(%iter_2693) : !memref_rmem_bf16_10
      %iter_2695 = cute.get_iter(%view_2694) : !memref_rmem_bf16_10
      %iter_2696 = cute.get_iter(%view_2694) : !memref_rmem_bf16_10
      %lay_2697 = cute.get_layout(%view_2680) : !memref_smem_bf16_18
      %1143 = cute.get_shape(%lay_2697) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2698, %e1_2699, %e2_2700 = cute.get_leaves(%1143) : !cute.shape<"((8,1),(4))">
      %lay_2701 = cute.get_layout(%view_2694) : !memref_rmem_bf16_10
      %1144 = cute.get_shape(%lay_2701) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2702, %e1_2703, %e2_2704 = cute.get_leaves(%1144) : !cute.shape<"((8,1),(4))">
      %lay_2705 = cute.get_layout(%view_2680) : !memref_smem_bf16_18
      %sz_2706 = cute.size(%lay_2705) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2707 = cute.get_leaves(%sz_2706) : !cute.int_tuple<"4">
      %lay_2708 = cute.get_layout(%view_2694) : !memref_rmem_bf16_10
      %sz_2709 = cute.size(%lay_2708) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2710 = cute.get_leaves(%sz_2709) : !cute.int_tuple<"4">
      %1145 = cute.static : !cute.layout<"1:0">
      %iter_2711 = cute.get_iter(%view_2680) : !memref_smem_bf16_18
      %iter_2712 = cute.get_iter(%view_2694) : !memref_rmem_bf16_10
      %lay_2713 = cute.get_layout(%view_2680) : !memref_smem_bf16_18
      %lay_2714 = cute.get_layout(%view_2694) : !memref_rmem_bf16_10
      %append_2715 = cute.append_to_rank<2> (%lay_2713, %1145) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2716 = cute.append_to_rank<2> (%lay_2714, %1145) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2717 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2718 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2719 = cute.size(%lay_2717) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1146 = cute.get_scalars(%sz_2719) : !cute.int_tuple<"4">
      %c0_i32_2720 = arith.constant 0 : i32
      %c1_i32_2721 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2720 to %1146 step %c1_i32_2721  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2717) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_2711, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2718) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2712, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2722 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2723 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2724 = cute.crd2idx(%coord_2722, %lay_2723) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
      %iter_2725 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2726 = cute.add_offset(%iter_2725, %idx_2724) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2727 = cute.make_view(%ptr_2726) : !memref_rmem_bf16_12
      %iter_2728 = cute.get_iter(%view_2727) : !memref_rmem_bf16_12
      %coord_2729 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2730 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_2731 = cute.crd2idx(%coord_2729, %lay_2730) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
      %iter_2732 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_2733 = cute.add_offset(%iter_2732, %idx_2731) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2734 = cute.make_view(%ptr_2733) : !memref_rmem_bf16_13
      %iter_2735 = cute.get_iter(%view_2734) : !memref_rmem_bf16_13
      %lay_2736 = cute.get_layout(%view_2727) : !memref_rmem_bf16_12
      %1147 = cute.get_shape(%lay_2736) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2737, %e1_2738, %e2_2739, %e3_2740 = cute.get_leaves(%1147) : !cute.shape<"((2,2,2),2)">
      %lay_2741 = cute.get_layout(%view_2734) : !memref_rmem_bf16_13
      %1148 = cute.get_shape(%lay_2741) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2742, %e1_2743, %e2_2744 = cute.get_leaves(%1148) : !cute.shape<"((2,2),8)">
      %iter_2745 = cute.get_iter(%view_2727) : !memref_rmem_bf16_12
      %iter_2746 = cute.get_iter(%view_2734) : !memref_rmem_bf16_13
      %iter_2747 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_2748 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_2749 = cute.get_layout(%view_2727) : !memref_rmem_bf16_12
      %lay_2750 = cute.get_layout(%view_2734) : !memref_rmem_bf16_13
      %lay_2751 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_2752 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1149 = cute.static : !cute.layout<"1:0">
      %append_2753 = cute.append_to_rank<3> (%lay_2749, %1149) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2754 = cute.append_to_rank<3> (%lay_2750, %1149) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2755 = cute.size(%append_2753) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2756 = cute.size(%append_2753) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2757 = cute.size(%append_2754) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1150 = cute.get_scalars(%sz_2755) : !cute.int_tuple<"1">
      %1151 = cute.get_scalars(%sz_2756) : !cute.int_tuple<"2">
      %1152 = cute.get_scalars(%sz_2757) : !cute.int_tuple<"8">
      %c0_i32_2758 = arith.constant 0 : i32
      %c1_i32_2759 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2758 to %1150 step %c1_i32_2759  : i32 {
        scf.for %arg6 = %c0_i32_2758 to %1151 step %c1_i32_2759  : i32 {
          scf.for %arg7 = %c0_i32_2758 to %1152 step %c1_i32_2759  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_2753) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_2745, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_2754) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_2746, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_2751) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_2747, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_2752) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_2748, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2760 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2761 = cute.size(%int_tuple_2760) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2762 = cute.get_leaves(%sz_2761) : !cute.int_tuple<"8">
      %coord_2763 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2764 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2765 = cute.crd2idx(%coord_2763, %lay_2764) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2766 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2767 = cute.add_offset(%iter_2766, %idx_2765) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2768 = cute.make_view(%ptr_2767) : !memref_smem_bf16_14
      %iter_2769 = cute.get_iter(%view_2768) : !memref_smem_bf16_14
      %coord_2770 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2771 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2772 = cute.crd2idx(%coord_2770, %lay_2771) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
      %iter_2773 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2774 = cute.add_offset(%iter_2773, %idx_2772) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2775 = cute.make_view(%ptr_2774) : !memref_rmem_bf16_6
      %iter_2776 = cute.get_iter(%view_2775) : !memref_rmem_bf16_6
      %lay_2777 = cute.get_layout(%view_2768) : !memref_smem_bf16_14
      %1153 = cute.get_shape(%lay_2777) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2778, %e1_2779, %e2_2780 = cute.get_leaves(%1153) : !cute.shape<"((8,1),2)">
      %lay_2781 = cute.get_layout(%view_2775) : !memref_rmem_bf16_6
      %1154 = cute.get_shape(%lay_2781) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2782, %e1_2783, %e2_2784 = cute.get_leaves(%1154) : !cute.shape<"((8,1),2)">
      %lay_2785 = cute.get_layout(%view_2768) : !memref_smem_bf16_14
      %shape_2786 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2787 = cute.make_layout() : !cute.layout<"1:0">
      %append_2788 = cute.append_to_rank<2> (%lay_2785, %lay_2787) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2789 = cute.make_view(%iter_2769, %append_2788) : !memref_smem_bf16_14
      %iter_2790 = cute.get_iter(%view_2789) : !memref_smem_bf16_14
      %lay_2791 = cute.get_layout(%view_2789) : !memref_smem_bf16_14
      %1155 = cute.get_shape(%lay_2791) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2792, %e1_2793, %e2_2794 = cute.get_leaves(%1155) : !cute.shape<"((8,1),2)">
      %iter_2795 = cute.get_iter(%view_2789) : !memref_smem_bf16_14
      %view_2796 = cute.make_view(%iter_2795) : !memref_smem_bf16_15
      %iter_2797 = cute.get_iter(%view_2796) : !memref_smem_bf16_15
      %iter_2798 = cute.get_iter(%view_2796) : !memref_smem_bf16_15
      %lay_2799 = cute.get_layout(%view_2775) : !memref_rmem_bf16_6
      %shape_2800 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2801 = cute.make_layout() : !cute.layout<"1:0">
      %append_2802 = cute.append_to_rank<2> (%lay_2799, %lay_2801) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2803 = cute.make_view(%iter_2776, %append_2802) : !memref_rmem_bf16_6
      %iter_2804 = cute.get_iter(%view_2803) : !memref_rmem_bf16_6
      %lay_2805 = cute.get_layout(%view_2803) : !memref_rmem_bf16_6
      %1156 = cute.get_shape(%lay_2805) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2806, %e1_2807, %e2_2808 = cute.get_leaves(%1156) : !cute.shape<"((8,1),2)">
      %iter_2809 = cute.get_iter(%view_2803) : !memref_rmem_bf16_6
      %view_2810 = cute.make_view(%iter_2809) : !memref_rmem_bf16_7
      %iter_2811 = cute.get_iter(%view_2810) : !memref_rmem_bf16_7
      %iter_2812 = cute.get_iter(%view_2810) : !memref_rmem_bf16_7
      %lay_2813 = cute.get_layout(%view_2796) : !memref_smem_bf16_15
      %1157 = cute.get_shape(%lay_2813) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2814, %e1_2815, %e2_2816 = cute.get_leaves(%1157) : !cute.shape<"((8,1),(2))">
      %lay_2817 = cute.get_layout(%view_2810) : !memref_rmem_bf16_7
      %1158 = cute.get_shape(%lay_2817) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2818, %e1_2819, %e2_2820 = cute.get_leaves(%1158) : !cute.shape<"((8,1),(2))">
      %lay_2821 = cute.get_layout(%view_2796) : !memref_smem_bf16_15
      %sz_2822 = cute.size(%lay_2821) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2823 = cute.get_leaves(%sz_2822) : !cute.int_tuple<"2">
      %lay_2824 = cute.get_layout(%view_2810) : !memref_rmem_bf16_7
      %sz_2825 = cute.size(%lay_2824) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2826 = cute.get_leaves(%sz_2825) : !cute.int_tuple<"2">
      %1159 = cute.static : !cute.layout<"1:0">
      %iter_2827 = cute.get_iter(%view_2796) : !memref_smem_bf16_15
      %iter_2828 = cute.get_iter(%view_2810) : !memref_rmem_bf16_7
      %lay_2829 = cute.get_layout(%view_2796) : !memref_smem_bf16_15
      %lay_2830 = cute.get_layout(%view_2810) : !memref_rmem_bf16_7
      %append_2831 = cute.append_to_rank<2> (%lay_2829, %1159) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2832 = cute.append_to_rank<2> (%lay_2830, %1159) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2833 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2834 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2835 = cute.size(%lay_2833) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1160 = cute.get_scalars(%sz_2835) : !cute.int_tuple<"2">
      %c0_i32_2836 = arith.constant 0 : i32
      %c1_i32_2837 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2836 to %1160 step %c1_i32_2837  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2833) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_2827, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2834) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2828, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2838 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2839 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_2840 = cute.crd2idx(%coord_2838, %lay_2839) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2841 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_2842 = cute.add_offset(%iter_2841, %idx_2840) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2843 = cute.make_view(%ptr_2842) : !memref_smem_bf16_17
      %iter_2844 = cute.get_iter(%view_2843) : !memref_smem_bf16_17
      %coord_2845 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2846 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_2847 = cute.crd2idx(%coord_2845, %lay_2846) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
      %iter_2848 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_2849 = cute.add_offset(%iter_2848, %idx_2847) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2850 = cute.make_view(%ptr_2849) : !memref_rmem_bf16_9
      %iter_2851 = cute.get_iter(%view_2850) : !memref_rmem_bf16_9
      %lay_2852 = cute.get_layout(%view_2843) : !memref_smem_bf16_17
      %1161 = cute.get_shape(%lay_2852) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2853, %e1_2854, %e2_2855 = cute.get_leaves(%1161) : !cute.shape<"((8,1),4)">
      %lay_2856 = cute.get_layout(%view_2850) : !memref_rmem_bf16_9
      %1162 = cute.get_shape(%lay_2856) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2857, %e1_2858, %e2_2859 = cute.get_leaves(%1162) : !cute.shape<"((8,1),4)">
      %lay_2860 = cute.get_layout(%view_2843) : !memref_smem_bf16_17
      %shape_2861 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2862 = cute.make_layout() : !cute.layout<"1:0">
      %append_2863 = cute.append_to_rank<2> (%lay_2860, %lay_2862) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2864 = cute.make_view(%iter_2844, %append_2863) : !memref_smem_bf16_17
      %iter_2865 = cute.get_iter(%view_2864) : !memref_smem_bf16_17
      %lay_2866 = cute.get_layout(%view_2864) : !memref_smem_bf16_17
      %1163 = cute.get_shape(%lay_2866) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2867, %e1_2868, %e2_2869 = cute.get_leaves(%1163) : !cute.shape<"((8,1),4)">
      %iter_2870 = cute.get_iter(%view_2864) : !memref_smem_bf16_17
      %view_2871 = cute.make_view(%iter_2870) : !memref_smem_bf16_18
      %iter_2872 = cute.get_iter(%view_2871) : !memref_smem_bf16_18
      %iter_2873 = cute.get_iter(%view_2871) : !memref_smem_bf16_18
      %lay_2874 = cute.get_layout(%view_2850) : !memref_rmem_bf16_9
      %shape_2875 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2876 = cute.make_layout() : !cute.layout<"1:0">
      %append_2877 = cute.append_to_rank<2> (%lay_2874, %lay_2876) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2878 = cute.make_view(%iter_2851, %append_2877) : !memref_rmem_bf16_9
      %iter_2879 = cute.get_iter(%view_2878) : !memref_rmem_bf16_9
      %lay_2880 = cute.get_layout(%view_2878) : !memref_rmem_bf16_9
      %1164 = cute.get_shape(%lay_2880) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2881, %e1_2882, %e2_2883 = cute.get_leaves(%1164) : !cute.shape<"((8,1),4)">
      %iter_2884 = cute.get_iter(%view_2878) : !memref_rmem_bf16_9
      %view_2885 = cute.make_view(%iter_2884) : !memref_rmem_bf16_10
      %iter_2886 = cute.get_iter(%view_2885) : !memref_rmem_bf16_10
      %iter_2887 = cute.get_iter(%view_2885) : !memref_rmem_bf16_10
      %lay_2888 = cute.get_layout(%view_2871) : !memref_smem_bf16_18
      %1165 = cute.get_shape(%lay_2888) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2889, %e1_2890, %e2_2891 = cute.get_leaves(%1165) : !cute.shape<"((8,1),(4))">
      %lay_2892 = cute.get_layout(%view_2885) : !memref_rmem_bf16_10
      %1166 = cute.get_shape(%lay_2892) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2893, %e1_2894, %e2_2895 = cute.get_leaves(%1166) : !cute.shape<"((8,1),(4))">
      %lay_2896 = cute.get_layout(%view_2871) : !memref_smem_bf16_18
      %sz_2897 = cute.size(%lay_2896) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2898 = cute.get_leaves(%sz_2897) : !cute.int_tuple<"4">
      %lay_2899 = cute.get_layout(%view_2885) : !memref_rmem_bf16_10
      %sz_2900 = cute.size(%lay_2899) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2901 = cute.get_leaves(%sz_2900) : !cute.int_tuple<"4">
      %1167 = cute.static : !cute.layout<"1:0">
      %iter_2902 = cute.get_iter(%view_2871) : !memref_smem_bf16_18
      %iter_2903 = cute.get_iter(%view_2885) : !memref_rmem_bf16_10
      %lay_2904 = cute.get_layout(%view_2871) : !memref_smem_bf16_18
      %lay_2905 = cute.get_layout(%view_2885) : !memref_rmem_bf16_10
      %append_2906 = cute.append_to_rank<2> (%lay_2904, %1167) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2907 = cute.append_to_rank<2> (%lay_2905, %1167) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2908 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2909 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2910 = cute.size(%lay_2908) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1168 = cute.get_scalars(%sz_2910) : !cute.int_tuple<"4">
      %c0_i32_2911 = arith.constant 0 : i32
      %c1_i32_2912 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2911 to %1168 step %c1_i32_2912  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_2908) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_2902, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_2909) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_2903, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2913 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2914 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2915 = cute.crd2idx(%coord_2913, %lay_2914) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
      %iter_2916 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2917 = cute.add_offset(%iter_2916, %idx_2915) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2918 = cute.make_view(%ptr_2917) : !memref_rmem_bf16_12
      %iter_2919 = cute.get_iter(%view_2918) : !memref_rmem_bf16_12
      %coord_2920 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2921 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_2922 = cute.crd2idx(%coord_2920, %lay_2921) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
      %iter_2923 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_2924 = cute.add_offset(%iter_2923, %idx_2922) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2925 = cute.make_view(%ptr_2924) : !memref_rmem_bf16_13
      %iter_2926 = cute.get_iter(%view_2925) : !memref_rmem_bf16_13
      %lay_2927 = cute.get_layout(%view_2918) : !memref_rmem_bf16_12
      %1169 = cute.get_shape(%lay_2927) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2928, %e1_2929, %e2_2930, %e3_2931 = cute.get_leaves(%1169) : !cute.shape<"((2,2,2),2)">
      %lay_2932 = cute.get_layout(%view_2925) : !memref_rmem_bf16_13
      %1170 = cute.get_shape(%lay_2932) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2933, %e1_2934, %e2_2935 = cute.get_leaves(%1170) : !cute.shape<"((2,2),8)">
      %iter_2936 = cute.get_iter(%view_2918) : !memref_rmem_bf16_12
      %iter_2937 = cute.get_iter(%view_2925) : !memref_rmem_bf16_13
      %iter_2938 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_2939 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_2940 = cute.get_layout(%view_2918) : !memref_rmem_bf16_12
      %lay_2941 = cute.get_layout(%view_2925) : !memref_rmem_bf16_13
      %lay_2942 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_2943 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1171 = cute.static : !cute.layout<"1:0">
      %append_2944 = cute.append_to_rank<3> (%lay_2940, %1171) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2945 = cute.append_to_rank<3> (%lay_2941, %1171) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2946 = cute.size(%append_2944) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2947 = cute.size(%append_2944) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2948 = cute.size(%append_2945) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1172 = cute.get_scalars(%sz_2946) : !cute.int_tuple<"1">
      %1173 = cute.get_scalars(%sz_2947) : !cute.int_tuple<"2">
      %1174 = cute.get_scalars(%sz_2948) : !cute.int_tuple<"8">
      %c0_i32_2949 = arith.constant 0 : i32
      %c1_i32_2950 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2949 to %1172 step %c1_i32_2950  : i32 {
        scf.for %arg6 = %c0_i32_2949 to %1173 step %c1_i32_2950  : i32 {
          scf.for %arg7 = %c0_i32_2949 to %1174 step %c1_i32_2950  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_2944) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_2936, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_2945) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_2937, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_2942) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_2938, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_2943) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_2939, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2951 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2952 = cute.size(%int_tuple_2951) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2953 = cute.get_leaves(%sz_2952) : !cute.int_tuple<"8">
      %coord_2954 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2955 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_2956 = cute.crd2idx(%coord_2954, %lay_2955) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2957 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_2958 = cute.add_offset(%iter_2957, %idx_2956) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2959 = cute.make_view(%ptr_2958) : !memref_smem_bf16_14
      %iter_2960 = cute.get_iter(%view_2959) : !memref_smem_bf16_14
      %coord_2961 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2962 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_2963 = cute.crd2idx(%coord_2961, %lay_2962) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
      %iter_2964 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_2965 = cute.add_offset(%iter_2964, %idx_2963) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2966 = cute.make_view(%ptr_2965) : !memref_rmem_bf16_6
      %iter_2967 = cute.get_iter(%view_2966) : !memref_rmem_bf16_6
      %lay_2968 = cute.get_layout(%view_2959) : !memref_smem_bf16_14
      %1175 = cute.get_shape(%lay_2968) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2969, %e1_2970, %e2_2971 = cute.get_leaves(%1175) : !cute.shape<"((8,1),2)">
      %lay_2972 = cute.get_layout(%view_2966) : !memref_rmem_bf16_6
      %1176 = cute.get_shape(%lay_2972) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2973, %e1_2974, %e2_2975 = cute.get_leaves(%1176) : !cute.shape<"((8,1),2)">
      %lay_2976 = cute.get_layout(%view_2959) : !memref_smem_bf16_14
      %shape_2977 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2978 = cute.make_layout() : !cute.layout<"1:0">
      %append_2979 = cute.append_to_rank<2> (%lay_2976, %lay_2978) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2980 = cute.make_view(%iter_2960, %append_2979) : !memref_smem_bf16_14
      %iter_2981 = cute.get_iter(%view_2980) : !memref_smem_bf16_14
      %lay_2982 = cute.get_layout(%view_2980) : !memref_smem_bf16_14
      %1177 = cute.get_shape(%lay_2982) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2983, %e1_2984, %e2_2985 = cute.get_leaves(%1177) : !cute.shape<"((8,1),2)">
      %iter_2986 = cute.get_iter(%view_2980) : !memref_smem_bf16_14
      %view_2987 = cute.make_view(%iter_2986) : !memref_smem_bf16_15
      %iter_2988 = cute.get_iter(%view_2987) : !memref_smem_bf16_15
      %iter_2989 = cute.get_iter(%view_2987) : !memref_smem_bf16_15
      %lay_2990 = cute.get_layout(%view_2966) : !memref_rmem_bf16_6
      %shape_2991 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2992 = cute.make_layout() : !cute.layout<"1:0">
      %append_2993 = cute.append_to_rank<2> (%lay_2990, %lay_2992) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2994 = cute.make_view(%iter_2967, %append_2993) : !memref_rmem_bf16_6
      %iter_2995 = cute.get_iter(%view_2994) : !memref_rmem_bf16_6
      %lay_2996 = cute.get_layout(%view_2994) : !memref_rmem_bf16_6
      %1178 = cute.get_shape(%lay_2996) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2997, %e1_2998, %e2_2999 = cute.get_leaves(%1178) : !cute.shape<"((8,1),2)">
      %iter_3000 = cute.get_iter(%view_2994) : !memref_rmem_bf16_6
      %view_3001 = cute.make_view(%iter_3000) : !memref_rmem_bf16_7
      %iter_3002 = cute.get_iter(%view_3001) : !memref_rmem_bf16_7
      %iter_3003 = cute.get_iter(%view_3001) : !memref_rmem_bf16_7
      %lay_3004 = cute.get_layout(%view_2987) : !memref_smem_bf16_15
      %1179 = cute.get_shape(%lay_3004) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_3005, %e1_3006, %e2_3007 = cute.get_leaves(%1179) : !cute.shape<"((8,1),(2))">
      %lay_3008 = cute.get_layout(%view_3001) : !memref_rmem_bf16_7
      %1180 = cute.get_shape(%lay_3008) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_3009, %e1_3010, %e2_3011 = cute.get_leaves(%1180) : !cute.shape<"((8,1),(2))">
      %lay_3012 = cute.get_layout(%view_2987) : !memref_smem_bf16_15
      %sz_3013 = cute.size(%lay_3012) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_3014 = cute.get_leaves(%sz_3013) : !cute.int_tuple<"2">
      %lay_3015 = cute.get_layout(%view_3001) : !memref_rmem_bf16_7
      %sz_3016 = cute.size(%lay_3015) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_3017 = cute.get_leaves(%sz_3016) : !cute.int_tuple<"2">
      %1181 = cute.static : !cute.layout<"1:0">
      %iter_3018 = cute.get_iter(%view_2987) : !memref_smem_bf16_15
      %iter_3019 = cute.get_iter(%view_3001) : !memref_rmem_bf16_7
      %lay_3020 = cute.get_layout(%view_2987) : !memref_smem_bf16_15
      %lay_3021 = cute.get_layout(%view_3001) : !memref_rmem_bf16_7
      %append_3022 = cute.append_to_rank<2> (%lay_3020, %1181) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_3023 = cute.append_to_rank<2> (%lay_3021, %1181) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3024 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_3025 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_3026 = cute.size(%lay_3024) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1182 = cute.get_scalars(%sz_3026) : !cute.int_tuple<"2">
      %c0_i32_3027 = arith.constant 0 : i32
      %c1_i32_3028 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3027 to %1182 step %c1_i32_3028  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_3024) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_3018, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_3025) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_3019, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3029 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3030 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_3031 = cute.crd2idx(%coord_3029, %lay_3030) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_3032 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_3033 = cute.add_offset(%iter_3032, %idx_3031) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3034 = cute.make_view(%ptr_3033) : !memref_smem_bf16_17
      %iter_3035 = cute.get_iter(%view_3034) : !memref_smem_bf16_17
      %coord_3036 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3037 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_3038 = cute.crd2idx(%coord_3036, %lay_3037) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
      %iter_3039 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_3040 = cute.add_offset(%iter_3039, %idx_3038) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3041 = cute.make_view(%ptr_3040) : !memref_rmem_bf16_9
      %iter_3042 = cute.get_iter(%view_3041) : !memref_rmem_bf16_9
      %lay_3043 = cute.get_layout(%view_3034) : !memref_smem_bf16_17
      %1183 = cute.get_shape(%lay_3043) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3044, %e1_3045, %e2_3046 = cute.get_leaves(%1183) : !cute.shape<"((8,1),4)">
      %lay_3047 = cute.get_layout(%view_3041) : !memref_rmem_bf16_9
      %1184 = cute.get_shape(%lay_3047) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3048, %e1_3049, %e2_3050 = cute.get_leaves(%1184) : !cute.shape<"((8,1),4)">
      %lay_3051 = cute.get_layout(%view_3034) : !memref_smem_bf16_17
      %shape_3052 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3053 = cute.make_layout() : !cute.layout<"1:0">
      %append_3054 = cute.append_to_rank<2> (%lay_3051, %lay_3053) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_3055 = cute.make_view(%iter_3035, %append_3054) : !memref_smem_bf16_17
      %iter_3056 = cute.get_iter(%view_3055) : !memref_smem_bf16_17
      %lay_3057 = cute.get_layout(%view_3055) : !memref_smem_bf16_17
      %1185 = cute.get_shape(%lay_3057) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3058, %e1_3059, %e2_3060 = cute.get_leaves(%1185) : !cute.shape<"((8,1),4)">
      %iter_3061 = cute.get_iter(%view_3055) : !memref_smem_bf16_17
      %view_3062 = cute.make_view(%iter_3061) : !memref_smem_bf16_18
      %iter_3063 = cute.get_iter(%view_3062) : !memref_smem_bf16_18
      %iter_3064 = cute.get_iter(%view_3062) : !memref_smem_bf16_18
      %lay_3065 = cute.get_layout(%view_3041) : !memref_rmem_bf16_9
      %shape_3066 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3067 = cute.make_layout() : !cute.layout<"1:0">
      %append_3068 = cute.append_to_rank<2> (%lay_3065, %lay_3067) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_3069 = cute.make_view(%iter_3042, %append_3068) : !memref_rmem_bf16_9
      %iter_3070 = cute.get_iter(%view_3069) : !memref_rmem_bf16_9
      %lay_3071 = cute.get_layout(%view_3069) : !memref_rmem_bf16_9
      %1186 = cute.get_shape(%lay_3071) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3072, %e1_3073, %e2_3074 = cute.get_leaves(%1186) : !cute.shape<"((8,1),4)">
      %iter_3075 = cute.get_iter(%view_3069) : !memref_rmem_bf16_9
      %view_3076 = cute.make_view(%iter_3075) : !memref_rmem_bf16_10
      %iter_3077 = cute.get_iter(%view_3076) : !memref_rmem_bf16_10
      %iter_3078 = cute.get_iter(%view_3076) : !memref_rmem_bf16_10
      %lay_3079 = cute.get_layout(%view_3062) : !memref_smem_bf16_18
      %1187 = cute.get_shape(%lay_3079) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_3080, %e1_3081, %e2_3082 = cute.get_leaves(%1187) : !cute.shape<"((8,1),(4))">
      %lay_3083 = cute.get_layout(%view_3076) : !memref_rmem_bf16_10
      %1188 = cute.get_shape(%lay_3083) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_3084, %e1_3085, %e2_3086 = cute.get_leaves(%1188) : !cute.shape<"((8,1),(4))">
      %lay_3087 = cute.get_layout(%view_3062) : !memref_smem_bf16_18
      %sz_3088 = cute.size(%lay_3087) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_3089 = cute.get_leaves(%sz_3088) : !cute.int_tuple<"4">
      %lay_3090 = cute.get_layout(%view_3076) : !memref_rmem_bf16_10
      %sz_3091 = cute.size(%lay_3090) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_3092 = cute.get_leaves(%sz_3091) : !cute.int_tuple<"4">
      %1189 = cute.static : !cute.layout<"1:0">
      %iter_3093 = cute.get_iter(%view_3062) : !memref_smem_bf16_18
      %iter_3094 = cute.get_iter(%view_3076) : !memref_rmem_bf16_10
      %lay_3095 = cute.get_layout(%view_3062) : !memref_smem_bf16_18
      %lay_3096 = cute.get_layout(%view_3076) : !memref_rmem_bf16_10
      %append_3097 = cute.append_to_rank<2> (%lay_3095, %1189) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_3098 = cute.append_to_rank<2> (%lay_3096, %1189) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3099 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_3100 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_3101 = cute.size(%lay_3099) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1190 = cute.get_scalars(%sz_3101) : !cute.int_tuple<"4">
      %c0_i32_3102 = arith.constant 0 : i32
      %c1_i32_3103 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3102 to %1190 step %c1_i32_3103  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_3099) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_3093, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_3100) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_3094, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3104 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_3105 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_3106 = cute.crd2idx(%coord_3104, %lay_3105) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
      %iter_3107 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_3108 = cute.add_offset(%iter_3107, %idx_3106) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3109 = cute.make_view(%ptr_3108) : !memref_rmem_bf16_12
      %iter_3110 = cute.get_iter(%view_3109) : !memref_rmem_bf16_12
      %coord_3111 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_3112 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_3113 = cute.crd2idx(%coord_3111, %lay_3112) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
      %iter_3114 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_3115 = cute.add_offset(%iter_3114, %idx_3113) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3116 = cute.make_view(%ptr_3115) : !memref_rmem_bf16_13
      %iter_3117 = cute.get_iter(%view_3116) : !memref_rmem_bf16_13
      %lay_3118 = cute.get_layout(%view_3109) : !memref_rmem_bf16_12
      %1191 = cute.get_shape(%lay_3118) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_3119, %e1_3120, %e2_3121, %e3_3122 = cute.get_leaves(%1191) : !cute.shape<"((2,2,2),2)">
      %lay_3123 = cute.get_layout(%view_3116) : !memref_rmem_bf16_13
      %1192 = cute.get_shape(%lay_3123) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_3124, %e1_3125, %e2_3126 = cute.get_leaves(%1192) : !cute.shape<"((2,2),8)">
      %iter_3127 = cute.get_iter(%view_3109) : !memref_rmem_bf16_12
      %iter_3128 = cute.get_iter(%view_3116) : !memref_rmem_bf16_13
      %iter_3129 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_3130 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_3131 = cute.get_layout(%view_3109) : !memref_rmem_bf16_12
      %lay_3132 = cute.get_layout(%view_3116) : !memref_rmem_bf16_13
      %lay_3133 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_3134 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1193 = cute.static : !cute.layout<"1:0">
      %append_3135 = cute.append_to_rank<3> (%lay_3131, %1193) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_3136 = cute.append_to_rank<3> (%lay_3132, %1193) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_3137 = cute.size(%append_3135) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_3138 = cute.size(%append_3135) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_3139 = cute.size(%append_3136) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1194 = cute.get_scalars(%sz_3137) : !cute.int_tuple<"1">
      %1195 = cute.get_scalars(%sz_3138) : !cute.int_tuple<"2">
      %1196 = cute.get_scalars(%sz_3139) : !cute.int_tuple<"8">
      %c0_i32_3140 = arith.constant 0 : i32
      %c1_i32_3141 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3140 to %1194 step %c1_i32_3141  : i32 {
        scf.for %arg6 = %c0_i32_3140 to %1195 step %c1_i32_3141  : i32 {
          scf.for %arg7 = %c0_i32_3140 to %1196 step %c1_i32_3141  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_3135) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_3127, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_3136) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_3128, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_3133) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_3129, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_3134) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_3130, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_3142 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_3143 = cute.size(%int_tuple_3142) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_3144 = cute.get_leaves(%sz_3143) : !cute.int_tuple<"8">
      %coord_3145 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3146 = cute.get_layout(%view_743) : !memref_smem_bf16_8
      %idx_3147 = cute.crd2idx(%coord_3145, %lay_3146) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_3148 = cute.get_iter(%view_743) : !memref_smem_bf16_8
      %ptr_3149 = cute.add_offset(%iter_3148, %idx_3147) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3150 = cute.make_view(%ptr_3149) : !memref_smem_bf16_14
      %iter_3151 = cute.get_iter(%view_3150) : !memref_smem_bf16_14
      %coord_3152 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3153 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
      %idx_3154 = cute.crd2idx(%coord_3152, %lay_3153) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_3155 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
      %ptr_3156 = cute.add_offset(%iter_3155, %idx_3154) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3157 = cute.make_view(%ptr_3156) : !memref_rmem_bf16_6
      %iter_3158 = cute.get_iter(%view_3157) : !memref_rmem_bf16_6
      %lay_3159 = cute.get_layout(%view_3150) : !memref_smem_bf16_14
      %1197 = cute.get_shape(%lay_3159) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3160, %e1_3161, %e2_3162 = cute.get_leaves(%1197) : !cute.shape<"((8,1),2)">
      %lay_3163 = cute.get_layout(%view_3157) : !memref_rmem_bf16_6
      %1198 = cute.get_shape(%lay_3163) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3164, %e1_3165, %e2_3166 = cute.get_leaves(%1198) : !cute.shape<"((8,1),2)">
      %lay_3167 = cute.get_layout(%view_3150) : !memref_smem_bf16_14
      %shape_3168 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3169 = cute.make_layout() : !cute.layout<"1:0">
      %append_3170 = cute.append_to_rank<2> (%lay_3167, %lay_3169) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_3171 = cute.make_view(%iter_3151, %append_3170) : !memref_smem_bf16_14
      %iter_3172 = cute.get_iter(%view_3171) : !memref_smem_bf16_14
      %lay_3173 = cute.get_layout(%view_3171) : !memref_smem_bf16_14
      %1199 = cute.get_shape(%lay_3173) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3174, %e1_3175, %e2_3176 = cute.get_leaves(%1199) : !cute.shape<"((8,1),2)">
      %iter_3177 = cute.get_iter(%view_3171) : !memref_smem_bf16_14
      %view_3178 = cute.make_view(%iter_3177) : !memref_smem_bf16_15
      %iter_3179 = cute.get_iter(%view_3178) : !memref_smem_bf16_15
      %iter_3180 = cute.get_iter(%view_3178) : !memref_smem_bf16_15
      %lay_3181 = cute.get_layout(%view_3157) : !memref_rmem_bf16_6
      %shape_3182 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3183 = cute.make_layout() : !cute.layout<"1:0">
      %append_3184 = cute.append_to_rank<2> (%lay_3181, %lay_3183) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_3185 = cute.make_view(%iter_3158, %append_3184) : !memref_rmem_bf16_6
      %iter_3186 = cute.get_iter(%view_3185) : !memref_rmem_bf16_6
      %lay_3187 = cute.get_layout(%view_3185) : !memref_rmem_bf16_6
      %1200 = cute.get_shape(%lay_3187) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3188, %e1_3189, %e2_3190 = cute.get_leaves(%1200) : !cute.shape<"((8,1),2)">
      %iter_3191 = cute.get_iter(%view_3185) : !memref_rmem_bf16_6
      %view_3192 = cute.make_view(%iter_3191) : !memref_rmem_bf16_7
      %iter_3193 = cute.get_iter(%view_3192) : !memref_rmem_bf16_7
      %iter_3194 = cute.get_iter(%view_3192) : !memref_rmem_bf16_7
      %lay_3195 = cute.get_layout(%view_3178) : !memref_smem_bf16_15
      %1201 = cute.get_shape(%lay_3195) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_3196, %e1_3197, %e2_3198 = cute.get_leaves(%1201) : !cute.shape<"((8,1),(2))">
      %lay_3199 = cute.get_layout(%view_3192) : !memref_rmem_bf16_7
      %1202 = cute.get_shape(%lay_3199) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_3200, %e1_3201, %e2_3202 = cute.get_leaves(%1202) : !cute.shape<"((8,1),(2))">
      %lay_3203 = cute.get_layout(%view_3178) : !memref_smem_bf16_15
      %sz_3204 = cute.size(%lay_3203) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_3205 = cute.get_leaves(%sz_3204) : !cute.int_tuple<"2">
      %lay_3206 = cute.get_layout(%view_3192) : !memref_rmem_bf16_7
      %sz_3207 = cute.size(%lay_3206) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_3208 = cute.get_leaves(%sz_3207) : !cute.int_tuple<"2">
      %1203 = cute.static : !cute.layout<"1:0">
      %iter_3209 = cute.get_iter(%view_3178) : !memref_smem_bf16_15
      %iter_3210 = cute.get_iter(%view_3192) : !memref_rmem_bf16_7
      %lay_3211 = cute.get_layout(%view_3178) : !memref_smem_bf16_15
      %lay_3212 = cute.get_layout(%view_3192) : !memref_rmem_bf16_7
      %append_3213 = cute.append_to_rank<2> (%lay_3211, %1203) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_3214 = cute.append_to_rank<2> (%lay_3212, %1203) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3215 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_3216 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_3217 = cute.size(%lay_3215) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1204 = cute.get_scalars(%sz_3217) : !cute.int_tuple<"2">
      %c0_i32_3218 = arith.constant 0 : i32
      %c1_i32_3219 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3218 to %1204 step %c1_i32_3219  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_3215) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8497 = cute.add_offset(%iter_3209, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_3216) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_3210, %idx_8500) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3220 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3221 = cute.get_layout(%view_801) : !memref_smem_bf16_9
      %idx_3222 = cute.crd2idx(%coord_3220, %lay_3221) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_3223 = cute.get_iter(%view_801) : !memref_smem_bf16_9
      %ptr_3224 = cute.add_offset(%iter_3223, %idx_3222) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3225 = cute.make_view(%ptr_3224) : !memref_smem_bf16_17
      %iter_3226 = cute.get_iter(%view_3225) : !memref_smem_bf16_17
      %coord_3227 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3228 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
      %idx_3229 = cute.crd2idx(%coord_3227, %lay_3228) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_3230 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
      %ptr_3231 = cute.add_offset(%iter_3230, %idx_3229) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3232 = cute.make_view(%ptr_3231) : !memref_rmem_bf16_9
      %iter_3233 = cute.get_iter(%view_3232) : !memref_rmem_bf16_9
      %lay_3234 = cute.get_layout(%view_3225) : !memref_smem_bf16_17
      %1205 = cute.get_shape(%lay_3234) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3235, %e1_3236, %e2_3237 = cute.get_leaves(%1205) : !cute.shape<"((8,1),4)">
      %lay_3238 = cute.get_layout(%view_3232) : !memref_rmem_bf16_9
      %1206 = cute.get_shape(%lay_3238) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3239, %e1_3240, %e2_3241 = cute.get_leaves(%1206) : !cute.shape<"((8,1),4)">
      %lay_3242 = cute.get_layout(%view_3225) : !memref_smem_bf16_17
      %shape_3243 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3244 = cute.make_layout() : !cute.layout<"1:0">
      %append_3245 = cute.append_to_rank<2> (%lay_3242, %lay_3244) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_3246 = cute.make_view(%iter_3226, %append_3245) : !memref_smem_bf16_17
      %iter_3247 = cute.get_iter(%view_3246) : !memref_smem_bf16_17
      %lay_3248 = cute.get_layout(%view_3246) : !memref_smem_bf16_17
      %1207 = cute.get_shape(%lay_3248) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3249, %e1_3250, %e2_3251 = cute.get_leaves(%1207) : !cute.shape<"((8,1),4)">
      %iter_3252 = cute.get_iter(%view_3246) : !memref_smem_bf16_17
      %view_3253 = cute.make_view(%iter_3252) : !memref_smem_bf16_18
      %iter_3254 = cute.get_iter(%view_3253) : !memref_smem_bf16_18
      %iter_3255 = cute.get_iter(%view_3253) : !memref_smem_bf16_18
      %lay_3256 = cute.get_layout(%view_3232) : !memref_rmem_bf16_9
      %shape_3257 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3258 = cute.make_layout() : !cute.layout<"1:0">
      %append_3259 = cute.append_to_rank<2> (%lay_3256, %lay_3258) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_3260 = cute.make_view(%iter_3233, %append_3259) : !memref_rmem_bf16_9
      %iter_3261 = cute.get_iter(%view_3260) : !memref_rmem_bf16_9
      %lay_3262 = cute.get_layout(%view_3260) : !memref_rmem_bf16_9
      %1208 = cute.get_shape(%lay_3262) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3263, %e1_3264, %e2_3265 = cute.get_leaves(%1208) : !cute.shape<"((8,1),4)">
      %iter_3266 = cute.get_iter(%view_3260) : !memref_rmem_bf16_9
      %view_3267 = cute.make_view(%iter_3266) : !memref_rmem_bf16_10
      %iter_3268 = cute.get_iter(%view_3267) : !memref_rmem_bf16_10
      %iter_3269 = cute.get_iter(%view_3267) : !memref_rmem_bf16_10
      %lay_3270 = cute.get_layout(%view_3253) : !memref_smem_bf16_18
      %1209 = cute.get_shape(%lay_3270) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_3271, %e1_3272, %e2_3273 = cute.get_leaves(%1209) : !cute.shape<"((8,1),(4))">
      %lay_3274 = cute.get_layout(%view_3267) : !memref_rmem_bf16_10
      %1210 = cute.get_shape(%lay_3274) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_3275, %e1_3276, %e2_3277 = cute.get_leaves(%1210) : !cute.shape<"((8,1),(4))">
      %lay_3278 = cute.get_layout(%view_3253) : !memref_smem_bf16_18
      %sz_3279 = cute.size(%lay_3278) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_3280 = cute.get_leaves(%sz_3279) : !cute.int_tuple<"4">
      %lay_3281 = cute.get_layout(%view_3267) : !memref_rmem_bf16_10
      %sz_3282 = cute.size(%lay_3281) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_3283 = cute.get_leaves(%sz_3282) : !cute.int_tuple<"4">
      %1211 = cute.static : !cute.layout<"1:0">
      %iter_3284 = cute.get_iter(%view_3253) : !memref_smem_bf16_18
      %iter_3285 = cute.get_iter(%view_3267) : !memref_rmem_bf16_10
      %lay_3286 = cute.get_layout(%view_3253) : !memref_smem_bf16_18
      %lay_3287 = cute.get_layout(%view_3267) : !memref_rmem_bf16_10
      %append_3288 = cute.append_to_rank<2> (%lay_3286, %1211) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_3289 = cute.append_to_rank<2> (%lay_3287, %1211) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3290 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_3291 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_3292 = cute.size(%lay_3290) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1212 = cute.get_scalars(%sz_3292) : !cute.int_tuple<"4">
      %c0_i32_3293 = arith.constant 0 : i32
      %c1_i32_3294 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3293 to %1212 step %c1_i32_3294  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_3290) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_3284, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_3291) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_3285, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3372 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3373 = llvm.mlir.constant(0 : i32) : i32
        %3374 = vector.extractelement %3372[%3373 : i32] : vector<4xi32>
        %3375 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3374, %3375 : i32, !llvm.ptr
        %3376 = llvm.mlir.constant(1 : i32) : i32
        %3377 = vector.extractelement %3372[%3376 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3378 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3377, %3378 : i32, !llvm.ptr
        %3379 = llvm.mlir.constant(2 : i32) : i32
        %3380 = vector.extractelement %3372[%3379 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3381 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3380, %3381 : i32, !llvm.ptr
        %3382 = llvm.mlir.constant(3 : i32) : i32
        %3383 = vector.extractelement %3372[%3382 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3295 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3296 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_3297 = cute.crd2idx(%coord_3295, %lay_3296) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
      %iter_3298 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_3299 = cute.add_offset(%iter_3298, %idx_3297) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3300 = cute.make_view(%ptr_3299) : !memref_rmem_bf16_12
      %iter_3301 = cute.get_iter(%view_3300) : !memref_rmem_bf16_12
      %coord_3302 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3303 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
      %idx_3304 = cute.crd2idx(%coord_3302, %lay_3303) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
      %iter_3305 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
      %ptr_3306 = cute.add_offset(%iter_3305, %idx_3304) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3307 = cute.make_view(%ptr_3306) : !memref_rmem_bf16_13
      %iter_3308 = cute.get_iter(%view_3307) : !memref_rmem_bf16_13
      %lay_3309 = cute.get_layout(%view_3300) : !memref_rmem_bf16_12
      %1213 = cute.get_shape(%lay_3309) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_3310, %e1_3311, %e2_3312, %e3_3313 = cute.get_leaves(%1213) : !cute.shape<"((2,2,2),2)">
      %lay_3314 = cute.get_layout(%view_3307) : !memref_rmem_bf16_13
      %1214 = cute.get_shape(%lay_3314) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_3315, %e1_3316, %e2_3317 = cute.get_leaves(%1214) : !cute.shape<"((2,2),8)">
      %iter_3318 = cute.get_iter(%view_3300) : !memref_rmem_bf16_12
      %iter_3319 = cute.get_iter(%view_3307) : !memref_rmem_bf16_13
      %iter_3320 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %iter_3321 = cute.get_iter(%rmem_1623) : !memref_rmem_f32_2
      %lay_3322 = cute.get_layout(%view_3300) : !memref_rmem_bf16_12
      %lay_3323 = cute.get_layout(%view_3307) : !memref_rmem_bf16_13
      %lay_3324 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_3325 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1215 = cute.static : !cute.layout<"1:0">
      %append_3326 = cute.append_to_rank<3> (%lay_3322, %1215) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_3327 = cute.append_to_rank<3> (%lay_3323, %1215) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_3328 = cute.size(%append_3326) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_3329 = cute.size(%append_3326) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_3330 = cute.size(%append_3327) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1216 = cute.get_scalars(%sz_3328) : !cute.int_tuple<"1">
      %1217 = cute.get_scalars(%sz_3329) : !cute.int_tuple<"2">
      %1218 = cute.get_scalars(%sz_3330) : !cute.int_tuple<"8">
      %c0_i32_3331 = arith.constant 0 : i32
      %c1_i32_3332 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3331 to %1216 step %c1_i32_3332  : i32 {
        scf.for %arg6 = %c0_i32_3331 to %1217 step %c1_i32_3332  : i32 {
          scf.for %arg7 = %c0_i32_3331 to %1218 step %c1_i32_3332  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_3326) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8499 = cute.add_offset(%iter_3318, %idx_8498) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_14
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_3327) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_3319, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_3324) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_3320, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_3325) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_3321, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_14
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      nvvm.cp.async.wait.group 0
      %c1_i32_3333 = arith.constant 1 : i32
      %c128_i32_3334 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_3333 number_of_threads = %c128_i32_3334
      %1219 = arith.cmpi sgt, %1023, %c0_i32_1614 : i32
      scf.if %1219 {
        %c1_i32_8494 = arith.constant 1 : i32
        %3370 = arith.subi %1023, %c1_i32_8494 : i32
        %coord_8495 = cute.make_coord(%3370) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_8496 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
        %3371:3 = cute.get_scalars(%lay_8496) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
        %3372 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
        %shape_8497 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
        %iv_8498 = cute.assume(%3371#1) : (i64) -> !cute.i64<divby 128>
        %stride_8499 = cute.make_stride(%iv_8498) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
        %lay_8500 = cute.make_layout(%shape_8497, %stride_8499) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %idx_8501 = cute.crd2idx(%coord_8495, %lay_8496) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8502 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
        %ptr_8503 = cute.add_offset(%iter_8502, %idx_8501) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8504 = cute.make_view(%ptr_8503, %lay_8500) : !memref_gmem_bf16_9
        %iter_8505 = cute.get_iter(%view_8504) : !memref_gmem_bf16_9
        %lay_8506 = cute.get_layout(%view_8504) : !memref_gmem_bf16_9
        %3373 = cute.get_shape(%lay_8506) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8507, %e1_8508, %e2_8509, %e3_8510 = cute.get_leaves(%3373) : !cute.shape<"((8,1),4,2)">
        %lay_8511 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %3374 = cute.get_shape(%lay_8511) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8512, %e1_8513, %e2_8514, %e3_8515 = cute.get_leaves(%3374) : !cute.shape<"((8,1),4,2)">
        %lay_8516 = cute.get_layout(%view_8504) : !memref_gmem_bf16_9
        %shape_8517 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8518 = cute.make_layout() : !cute.layout<"1:0">
        %append_8519 = cute.append_to_rank<2> (%lay_8516, %lay_8518) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_8520 = cute.make_view(%iter_8505, %append_8519) : !memref_gmem_bf16_9
        %iter_8521 = cute.get_iter(%view_8520) : !memref_gmem_bf16_9
        %lay_8522 = cute.get_layout(%view_8520) : !memref_gmem_bf16_9
        %3375 = cute.get_shape(%lay_8522) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8523, %e1_8524, %e2_8525, %e3_8526 = cute.get_leaves(%3375) : !cute.shape<"((8,1),4,2)">
        %iter_8527 = cute.get_iter(%view_8520) : !memref_gmem_bf16_9
        %lay_8528 = cute.get_layout(%view_8520) : !memref_gmem_bf16_9
        %3376 = cute.get_scalars(%lay_8528) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_8529 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_8530 = cute.assume(%3376) : (i64) -> !cute.i64<divby 128>
        %stride_8531 = cute.make_stride(%iv_8530) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_8532 = cute.make_layout(%shape_8529, %stride_8531) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_8533 = cute.make_view(%iter_8527, %lay_8532) : !memref_gmem_bf16_10
        %iter_8534 = cute.get_iter(%view_8533) : !memref_gmem_bf16_10
        %iter_8535 = cute.get_iter(%view_8533) : !memref_gmem_bf16_10
        %lay_8536 = cute.get_layout(%view_422) : !memref_smem_bf16_4
        %shape_8537 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8538 = cute.make_layout() : !cute.layout<"1:0">
        %append_8539 = cute.append_to_rank<2> (%lay_8536, %lay_8538) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_8540 = cute.make_view(%iter_423, %append_8539) : !memref_smem_bf16_4
        %iter_8541 = cute.get_iter(%view_8540) : !memref_smem_bf16_4
        %lay_8542 = cute.get_layout(%view_8540) : !memref_smem_bf16_4
        %3377 = cute.get_shape(%lay_8542) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8543, %e1_8544, %e2_8545, %e3_8546 = cute.get_leaves(%3377) : !cute.shape<"((8,1),4,2)">
        %iter_8547 = cute.get_iter(%view_8540) : !memref_smem_bf16_4
        %view_8548 = cute.make_view(%iter_8547) : !memref_smem_bf16_16
        %iter_8549 = cute.get_iter(%view_8548) : !memref_smem_bf16_16
        %iter_8550 = cute.get_iter(%view_8548) : !memref_smem_bf16_16
        %lay_8551 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_1034, %append_8554) : !memref_rmem_i8_1
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_1
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_1
        %3378 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_8558, %e1_8559, %e2_8560 = cute.get_leaves(%3378) : !cute.shape<"(1,4,2)">
        %iter_8561 = cute.get_iter(%view_8555) : !memref_rmem_i8_1
        %view_8562 = cute.make_view(%iter_8561) : !memref_rmem_i8_5
        %iter_8563 = cute.get_iter(%view_8562) : !memref_rmem_i8_5
        %iter_8564 = cute.get_iter(%view_8562) : !memref_rmem_i8_5
        %lay_8565 = cute.get_layout(%view_8533) : !memref_gmem_bf16_10
        %3379 = cute.get_shape(%lay_8565) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8566, %e1_8567, %e2_8568, %e3_8569 = cute.get_leaves(%3379) : !cute.shape<"((8,1),(4,2))">
        %lay_8570 = cute.get_layout(%view_8548) : !memref_smem_bf16_16
        %3380 = cute.get_shape(%lay_8570) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8571, %e1_8572, %e2_8573, %e3_8574 = cute.get_leaves(%3380) : !cute.shape<"((8,1),(4,2))">
        %lay_8575 = cute.get_layout(%view_8533) : !memref_gmem_bf16_10
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"8">
        %lay_8578 = cute.get_layout(%view_8548) : !memref_smem_bf16_16
        %sz_8579 = cute.size(%lay_8578) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_8580 = cute.get_leaves(%sz_8579) : !cute.int_tuple<"8">
        %3381 = cute.static : !cute.layout<"1:0">
        %iter_8581 = cute.get_iter(%view_8533) : !memref_gmem_bf16_10
        %iter_8582 = cute.get_iter(%view_8548) : !memref_smem_bf16_16
        %lay_8583 = cute.get_layout(%view_8533) : !memref_gmem_bf16_10
        %lay_8584 = cute.get_layout(%view_8548) : !memref_smem_bf16_16
        %append_8585 = cute.append_to_rank<2> (%lay_8583, %3381) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_8586 = cute.append_to_rank<2> (%lay_8584, %3381) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %3382 = cute.get_scalars(%append_8585) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_8587 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_8588 = cute.assume(%3382) : (i64) -> !cute.i64<divby 128>
        %stride_8589 = cute.make_stride(%iv_8588) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_8590 = cute.make_layout(%shape_8587, %stride_8589) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_8591 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_8592 = cute.get_iter(%view_8562) : !memref_rmem_i8_5
        %lay_8593 = cute.get_layout(%view_8562) : !memref_rmem_i8_5
        %append_8594 = cute.append_to_rank<2> (%lay_8593, %3381) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_8595 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_8596 = cute.size(%lay_8590) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %3383 = cute.get_scalars(%sz_8596) : !cute.int_tuple<"8">
        %c0_i32_8597 = arith.constant 0 : i32
        %c1_i32_8598 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8597 to %3383 step %c1_i32_8598  : i32 {
          %coord_8599 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3384 = cute.get_scalars(%lay_8590) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %3385 = cute.get_scalars(%coord_8599) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8600 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8601 = cute.crd2idx(%coord_8599, %lay_8590) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_8602 = cute.add_offset(%iter_8581, %idx_8601) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8603 = cute.make_view(%ptr_8602, %lay_8600) : !memref_gmem_bf16_8
          %3386 = cute.get_scalars(%coord_8599) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8604 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8605 = cute.crd2idx(%coord_8599, %lay_8591) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_8606 = cute.add_offset(%iter_8582, %idx_8605) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8607 = cute.make_view(%ptr_8606, %lay_8604) : !memref_smem_bf16_13
          %3387 = cute.get_scalars(%coord_8599) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8608 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8609 = cute.crd2idx(%coord_8599, %lay_8595) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_8610 = cute.add_offset(%iter_8592, %idx_8609) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8611 = cute.make_view(%ptr_8610, %lay_8608) : !memref_rmem_i8_4
          %iter_8612 = cute.get_iter(%view_8603) : !memref_gmem_bf16_8
          %iter_8613 = cute.get_iter(%view_8607) : !memref_smem_bf16_13
          %iter_8614 = cute.get_iter(%view_8611) : !memref_rmem_i8_4
          %3388 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3389 = llvm.load %3388 : !llvm.ptr -> i8
          %3390 = llvm.trunc %3389 : i8 to i1
          %iter_8615 = cute.recast_iter(%iter_8612) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8616 = cute.recast_iter(%iter_8613) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8616 : !cute.ptr<i128, smem>, %iter_8615 : !cute.ptr<i128, gmem>, %3390 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.commit.group
      }
      %lay_3335 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %1220 = cute.get_shape(%lay_3335) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3336, %e1_3337, %e2_3338, %e3_3339 = cute.get_leaves(%1220) : !cute.shape<"((2,2),2,8)">
      %shape_3340 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_3341 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %1221 = cute.get_shape(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3342, %e1_3343, %e2_3344, %e3_3345 = cute.get_leaves(%1221) : !cute.shape<"((2,2),2,8)">
      %1222 = cute.get_shape(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3346, %e1_3347, %e2_3348, %e3_3349 = cute.get_leaves(%1222) : !cute.shape<"((2,2),2,8)">
      %1223 = cute.get_shape(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3350, %e1_3351, %e2_3352, %e3_3353 = cute.get_leaves(%1223) : !cute.shape<"((2,2),2,8)">
      %1224 = cute.get_shape(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3354, %e1_3355, %e2_3356, %e3_3357 = cute.get_leaves(%1224) : !cute.shape<"((2,2),2,8)">
      %1225 = cute.get_stride(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3358, %e1_3359, %e2_3360, %e3_3361 = cute.get_leaves(%1225) : !cute.stride<"((1,2),4,8)">
      %1226 = cute.get_stride(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3362, %e1_3363, %e2_3364, %e3_3365 = cute.get_leaves(%1226) : !cute.stride<"((1,2),4,8)">
      %1227 = cute.get_stride(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3366, %e1_3367, %e2_3368, %e3_3369 = cute.get_leaves(%1227) : !cute.stride<"((1,2),4,8)">
      %1228 = cute.get_stride(%lay_3341) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3370, %e1_3371, %e2_3372, %e3_3373 = cute.get_leaves(%1228) : !cute.stride<"((1,2),4,8)">
      %shape_3374 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3375 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3376 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3377 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_3378 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %view_3379 = cute.make_view(%iter_1625, %lay_3378) : !memref_rmem_f32_4
      %iter_3380 = cute.get_iter(%view_3379) : !memref_rmem_f32_4
      %lay_3381 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %1229 = cute.get_shape(%lay_3381) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3382, %e1_3383, %e2_3384, %e3_3385 = cute.get_leaves(%1229) : !cute.shape<"((2,2),2,16)">
      %shape_3386 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_3387 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %1230 = cute.get_shape(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3388, %e1_3389, %e2_3390, %e3_3391 = cute.get_leaves(%1230) : !cute.shape<"((2,2),2,16)">
      %1231 = cute.get_shape(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3392, %e1_3393, %e2_3394, %e3_3395 = cute.get_leaves(%1231) : !cute.shape<"((2,2),2,16)">
      %1232 = cute.get_shape(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3396, %e1_3397, %e2_3398, %e3_3399 = cute.get_leaves(%1232) : !cute.shape<"((2,2),2,16)">
      %1233 = cute.get_shape(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3400, %e1_3401, %e2_3402, %e3_3403 = cute.get_leaves(%1233) : !cute.shape<"((2,2),2,16)">
      %1234 = cute.get_stride(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3404, %e1_3405, %e2_3406, %e3_3407 = cute.get_leaves(%1234) : !cute.stride<"((1,2),4,8)">
      %1235 = cute.get_stride(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3408, %e1_3409, %e2_3410, %e3_3411 = cute.get_leaves(%1235) : !cute.stride<"((1,2),4,8)">
      %1236 = cute.get_stride(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3412, %e1_3413, %e2_3414, %e3_3415 = cute.get_leaves(%1236) : !cute.stride<"((1,2),4,8)">
      %1237 = cute.get_stride(%lay_3387) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3416, %e1_3417, %e2_3418, %e3_3419 = cute.get_leaves(%1237) : !cute.stride<"((1,2),4,8)">
      %shape_3420 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_3421 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3422 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_3423 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_3424 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_3425 = cute.make_view(%iter_634, %lay_3424) : !memref_rmem_f32_5
      %iter_3426 = cute.get_iter(%view_3425) : !memref_rmem_f32_5
      %lay_3427 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %1238 = cute.get_shape(%lay_3427) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_3428, %e1_3429, %e2_3430, %e3_3431 = cute.get_leaves(%1238) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_3432 = cute.to_int_tuple(%e0_3428) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1239 = cute.get_scalars(%itup_3432) : !cute.int_tuple<"?">
      %itup_3433 = cute.to_int_tuple(%e1_3429) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1240 = cute.get_scalars(%itup_3433) : !cute.int_tuple<"?">
      %itup_3434 = cute.to_int_tuple(%e2_3430) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1241 = cute.get_scalars(%itup_3434) : !cute.int_tuple<"?">
      %itup_3435 = cute.to_int_tuple(%e3_3431) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1242 = cute.get_scalars(%itup_3435) : !cute.int_tuple<"?{div=8}">
      %lay_3436 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1243 = cute.get_shape(%lay_3436) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_3437, %e1_3438, %e2_3439, %e3_3440 = cute.get_leaves(%1243) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_3441 = cute.to_int_tuple(%e0_3437) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1244 = cute.get_scalars(%itup_3441) : !cute.int_tuple<"?">
      %itup_3442 = cute.to_int_tuple(%e1_3438) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1245 = cute.get_scalars(%itup_3442) : !cute.int_tuple<"?">
      %itup_3443 = cute.to_int_tuple(%e2_3439) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1246 = cute.get_scalars(%itup_3443) : !cute.int_tuple<"?">
      %itup_3444 = cute.to_int_tuple(%e3_3440) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1247 = cute.get_scalars(%itup_3444) : !cute.int_tuple<"?{div=8}">
      %shape_3445 = cute.make_shape(%itup_3432, %itup_3433, %itup_3434, %itup_3442) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)">
      %int_tuple_3446 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_3447 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_3448 = cute.make_layout(%shape_3445, %stride_3447) : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %view_3449 = cute.make_view(%int_tuple_3446, %lay_3448) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %iter_3450 = cute.get_iter(%view_3449) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %e0_3451, %e1_3452, %e2_3453, %e3_3454 = cute.get_leaves(%iter_3450) : !cute.int_tuple<"(0,0,0,0)">
      %coord_3455 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_3456 = cute.get_layout(%view_3449) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %1248:4 = cute.get_scalars(%lay_3456) <{only_dynamic}> : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %1249:2 = cute.get_scalars(%coord_3455) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %shape_3457 = cute.make_shape(%1248#1, %1248#3) : (i32, i32) -> !cute.shape<"(?,?)">
      %stride_3458 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_3459 = cute.make_layout(%shape_3457, %stride_3458) : !cute.layout<"(?,?):(1@1,1@3)">
      %idx_3460 = cute.crd2idx(%coord_3455, %lay_3456) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_3461 = cute.get_iter(%view_3449) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %tup_3462 = cute.add_offset(%iter_3461, %idx_3460) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_3463 = cute.make_view(%tup_3462, %lay_3459) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %iter_3464 = cute.get_iter(%view_3463) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_3465, %e1_3466, %e2_3467, %e3_3468 = cute.get_leaves(%iter_3464) : !cute.int_tuple<"(?,0,?,0)">
      %1250 = cute.get_scalars(%e0_3465) : !cute.int_tuple<"?">
      %1251 = cute.get_scalars(%e2_3467) : !cute.int_tuple<"?">
      %tile_3469 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]">
      %coord_3470 = cute.make_coord(%117, %1023) : (i32, i32) -> !cute.coord<"(?,?)">
      %1252:2 = cute.get_scalars(%coord_3470) <{only_dynamic}> : !cute.coord<"(?,?)">
      %coord_3471 = cute.make_coord(%1252#0, %1252#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
      %lay_3472 = cute.get_layout(%view_3463) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %1253:2 = cute.get_scalars(%lay_3472) <{only_dynamic}> : !cute.layout<"(?,?):(1@1,1@3)">
      %c128_i32_3473 = arith.constant 128 : i32
      %1254 = arith.ceildivsi %1253#0, %c128_i32_3473 : i32
      %c64_i32_3474 = arith.constant 64 : i32
      %1255 = arith.ceildivsi %1253#1, %c64_i32_3474 : i32
      %shape_3475 = cute.make_shape(%1254, %1255) : (i32, i32) -> !cute.shape<"((128,64),(?,?))">
      %stride_3476 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,64@3))">
      %lay_3477 = cute.make_layout(%shape_3475, %stride_3476) : !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">
      %idx_3478 = cute.crd2idx(%coord_3471, %lay_3477) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">) -> !cute.int_tuple<"(0,?{div=128},0,?{div=64})">
      %iter_3479 = cute.get_iter(%view_3463) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %tup_3480 = cute.add_offset(%iter_3479, %idx_3478) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,?{div=64})">) -> !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %view_3481 = cute.make_view(%tup_3480) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %iter_3482 = cute.get_iter(%view_3481) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %e0_3483, %e1_3484, %e2_3485, %e3_3486 = cute.get_leaves(%iter_3482) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %1256 = cute.get_scalars(%e0_3483) : !cute.int_tuple<"?">
      %1257 = cute.get_scalars(%e1_3484) : !cute.int_tuple<"?{div=128}">
      %1258 = cute.get_scalars(%e2_3485) : !cute.int_tuple<"?">
      %1259 = cute.get_scalars(%e3_3486) : !cute.int_tuple<"?{div=64}">
      %coord_3487 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_3488 = cute.get_iter(%view_3481) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %1260 = cute.get_scalars(%coord_3487) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_3489 = arith.constant 32 : i32
      %1261 = arith.remsi %1260, %c32_i32_3489 : i32
      %c32_i32_3490 = arith.constant 32 : i32
      %1262 = arith.divsi %1260, %c32_i32_3490 : i32
      %c4_i32_3491 = arith.constant 4 : i32
      %1263 = arith.remsi %1262, %c4_i32_3491 : i32
      %c32_i32_3492 = arith.constant 32 : i32
      %1264 = arith.remsi %1261, %c32_i32_3492 : i32
      %c4_i32_3493 = arith.constant 4 : i32
      %1265 = arith.remsi %1263, %c4_i32_3493 : i32
      %c4_i32_3494 = arith.constant 4 : i32
      %1266 = arith.divsi %1264, %c4_i32_3494 : i32
      %c4_i32_3495 = arith.constant 4 : i32
      %1267 = arith.remsi %1264, %c4_i32_3495 : i32
      %c2_i32_3496 = arith.constant 2 : i32
      %1268 = arith.muli %1267, %c2_i32_3496 : i32
      %c16_i32_3497 = arith.constant 16 : i32
      %1269 = arith.muli %1265, %c16_i32_3497 : i32
      %1270 = arith.addi %1266, %1269 : i32
      %iv_3498 = cute.assume(%1268) : (i32) -> !cute.i32<divby 2>
      %int_tuple_3499 = cute.make_int_tuple(%1270, %iv_3498) : (i32, !cute.i32<divby 2>) -> !cute.int_tuple<"(0,?,0,?{div=2})">
      %tup_3500 = cute.add_offset(%iter_3488, %int_tuple_3499) : (!cute.int_tuple<"(?,?{div=128},?,?{div=64})">, !cute.int_tuple<"(0,?,0,?{div=2})">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3501 = cute.make_view(%tup_3500) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %iter_3502 = cute.get_iter(%view_3501) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %e0_3503, %e1_3504, %e2_3505, %e3_3506 = cute.get_leaves(%iter_3502) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1271 = cute.get_scalars(%e0_3503) : !cute.int_tuple<"?">
      %1272 = cute.get_scalars(%e1_3504) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e2_3505) : !cute.int_tuple<"?">
      %1274 = cute.get_scalars(%e3_3506) : !cute.int_tuple<"?{div=2}">
      %lay_3507 = cute.get_layout(%view_3501) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %1275 = cute.get_shape(%lay_3507) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3508, %e1_3509, %e2_3510, %e3_3511 = cute.get_leaves(%1275) : !cute.shape<"((2,2),2,8)">
      %shape_3512 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_3513 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %1276 = cute.get_shape(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3514, %e1_3515, %e2_3516, %e3_3517 = cute.get_leaves(%1276) : !cute.shape<"((2,2),2,8)">
      %1277 = cute.get_shape(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3518, %e1_3519, %e2_3520, %e3_3521 = cute.get_leaves(%1277) : !cute.shape<"((2,2),2,8)">
      %1278 = cute.get_shape(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3522, %e1_3523, %e2_3524, %e3_3525 = cute.get_leaves(%1278) : !cute.shape<"((2,2),2,8)">
      %1279 = cute.get_shape(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3526, %e1_3527, %e2_3528, %e3_3529 = cute.get_leaves(%1279) : !cute.shape<"((2,2),2,8)">
      %1280 = cute.get_stride(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3530, %e1_3531, %e2_3532, %e3_3533 = cute.get_leaves(%1280) : !cute.stride<"((1,2),4,8)">
      %1281 = cute.get_stride(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3534, %e1_3535, %e2_3536, %e3_3537 = cute.get_leaves(%1281) : !cute.stride<"((1,2),4,8)">
      %1282 = cute.get_stride(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3538, %e1_3539, %e2_3540, %e3_3541 = cute.get_leaves(%1282) : !cute.stride<"((1,2),4,8)">
      %1283 = cute.get_stride(%lay_3513) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3542, %e1_3543, %e2_3544, %e3_3545 = cute.get_leaves(%1283) : !cute.stride<"((1,2),4,8)">
      %shape_3546 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3547 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3548 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3549 = cute.get_layout(%view_3501) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %lay_3550 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %int_tuple_3551 = cute.make_int_tuple(%e0_3503, %e1_3504, %e2_3505, %e3_3506) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3552 = cute.make_view(%int_tuple_3551, %lay_3550) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %iter_3553 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %e0_3554, %e1_3555, %e2_3556, %e3_3557 = cute.get_leaves(%iter_3553) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1284 = cute.get_scalars(%e0_3554) : !cute.int_tuple<"?">
      %1285 = cute.get_scalars(%e1_3555) : !cute.int_tuple<"?">
      %1286 = cute.get_scalars(%e2_3556) : !cute.int_tuple<"?">
      %1287 = cute.get_scalars(%e3_3557) : !cute.int_tuple<"?{div=2}">
      %lay_3558 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
      %sz_3559 = cute.size(%lay_3558) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_3560 = cute.get_leaves(%sz_3559) : !cute.int_tuple<"4">
      %lay_3561 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %1288 = cute.get_shape(%lay_3561) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3562, %e1_3563, %e2_3564, %e3_3565 = cute.get_leaves(%1288) : !cute.shape<"((2,2),(2,8))">
      %int_tuple_3566 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3567 = cute.size(%int_tuple_3566) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3568 = cute.get_leaves(%sz_3567) : !cute.int_tuple<"16">
      %coord_3569 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3570 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3571 = cute.crd2idx(%coord_3569, %lay_3570) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3572 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3573 = cute.add_offset(%iter_3572, %idx_3571) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3574 = cute.make_view(%tup_3573) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3575 = cute.get_iter(%view_3574) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3576, %e1_3577, %e2_3578, %e3_3579 = cute.get_leaves(%iter_3575) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1289 = cute.get_scalars(%e0_3576) : !cute.int_tuple<"?">
      %1290 = cute.get_scalars(%e1_3577) : !cute.int_tuple<"?">
      %1291 = cute.get_scalars(%e2_3578) : !cute.int_tuple<"?">
      %1292 = cute.get_scalars(%e3_3579) : !cute.int_tuple<"?{div=2}">
      %iter_3580 = cute.get_iter(%view_3574) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3581, %e1_3582, %e2_3583, %e3_3584 = cute.get_leaves(%iter_3580) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1293 = cute.get_scalars(%e0_3581) : !cute.int_tuple<"?">
      %1294 = cute.get_scalars(%e1_3582) : !cute.int_tuple<"?">
      %1295 = cute.get_scalars(%e2_3583) : !cute.int_tuple<"?">
      %1296 = cute.get_scalars(%e3_3584) : !cute.int_tuple<"?{div=2}">
      %iter_3585 = cute.get_iter(%view_3574) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3586, %e1_3587, %e2_3588, %e3_3589 = cute.get_leaves(%iter_3585) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1297 = cute.get_scalars(%e0_3586) : !cute.int_tuple<"?">
      %1298 = cute.get_scalars(%e1_3587) : !cute.int_tuple<"?">
      %1299 = cute.get_scalars(%e2_3588) : !cute.int_tuple<"?">
      %1300 = cute.get_scalars(%e3_3589) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3590 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3591 = cute.add_offset(%e3_3589, %int_tuple_3590) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1301 = cute.get_scalars(%tup_3591) : !cute.int_tuple<"?">
      %coord_3592 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3593 = cute.make_coord(%tup_3591) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1302 = cute.get_scalars(%coord_3592) : !cute.coord<"?">
      %1303 = cute.get_scalars(%coord_3593) : !cute.coord<"?">
      %true_3594 = arith.constant true
      %1304 = arith.cmpi slt, %1302, %1303 : i32
      %1305 = arith.andi %true_3594, %1304 : i1
      %lay_3595 = cute.get_layout(%view_3379) : !memref_rmem_f32_4
      %1306 = cute.get_shape(%lay_3595) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3596, %e1_3597, %e2_3598, %e3_3599 = cute.get_leaves(%1306) : !cute.shape<"((2,2),(2,8))">
      %1307 = cute.get_stride(%lay_3595) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3600, %e1_3601, %e2_3602, %e3_3603 = cute.get_leaves(%1307) : !cute.stride<"((2,4),(1,8))">
      %1308 = scf.if %1305 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%view_3379) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,0)">
        cute.memref.store(%view_3379, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,0)">, f32) -> ()
        %lay_8497 = cute.get_layout(%view_3379) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_3379 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%view_3379) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%view_3379) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_3379 : !memref_rmem_f32_4
      }
      %iter_3604 = cute.get_iter(%1308) : !memref_rmem_f32_4
      %lay_3605 = cute.get_layout(%1308) : !memref_rmem_f32_4
      %1309 = cute.get_shape(%lay_3605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3606, %e1_3607, %e2_3608, %e3_3609 = cute.get_leaves(%1309) : !cute.shape<"((2,2),(2,8))">
      %1310 = cute.get_stride(%lay_3605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3610, %e1_3611, %e2_3612, %e3_3613 = cute.get_leaves(%1310) : !cute.stride<"((2,4),(1,8))">
      %iter_3614 = cute.get_iter(%1308) : !memref_rmem_f32_4
      %iter_3615 = cute.get_iter(%1308) : !memref_rmem_f32_4
      %coord_3616 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3617 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3618 = cute.crd2idx(%coord_3616, %lay_3617) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3619 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3620 = cute.add_offset(%iter_3619, %idx_3618) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3621 = cute.make_view(%tup_3620) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3622 = cute.get_iter(%view_3621) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3623, %e1_3624, %e2_3625, %e3_3626 = cute.get_leaves(%iter_3622) : !cute.int_tuple<"(?,?,?,?)">
      %1311 = cute.get_scalars(%e0_3623) : !cute.int_tuple<"?">
      %1312 = cute.get_scalars(%e1_3624) : !cute.int_tuple<"?">
      %1313 = cute.get_scalars(%e2_3625) : !cute.int_tuple<"?">
      %1314 = cute.get_scalars(%e3_3626) : !cute.int_tuple<"?">
      %iter_3627 = cute.get_iter(%view_3621) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3628, %e1_3629, %e2_3630, %e3_3631 = cute.get_leaves(%iter_3627) : !cute.int_tuple<"(?,?,?,?)">
      %1315 = cute.get_scalars(%e0_3628) : !cute.int_tuple<"?">
      %1316 = cute.get_scalars(%e1_3629) : !cute.int_tuple<"?">
      %1317 = cute.get_scalars(%e2_3630) : !cute.int_tuple<"?">
      %1318 = cute.get_scalars(%e3_3631) : !cute.int_tuple<"?">
      %iter_3632 = cute.get_iter(%view_3621) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3633, %e1_3634, %e2_3635, %e3_3636 = cute.get_leaves(%iter_3632) : !cute.int_tuple<"(?,?,?,?)">
      %1319 = cute.get_scalars(%e0_3633) : !cute.int_tuple<"?">
      %1320 = cute.get_scalars(%e1_3634) : !cute.int_tuple<"?">
      %1321 = cute.get_scalars(%e2_3635) : !cute.int_tuple<"?">
      %1322 = cute.get_scalars(%e3_3636) : !cute.int_tuple<"?">
      %int_tuple_3637 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3638 = cute.add_offset(%e3_3636, %int_tuple_3637) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1323 = cute.get_scalars(%tup_3638) : !cute.int_tuple<"?">
      %coord_3639 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3640 = cute.make_coord(%tup_3638) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1324 = cute.get_scalars(%coord_3639) : !cute.coord<"?">
      %1325 = cute.get_scalars(%coord_3640) : !cute.coord<"?">
      %true_3641 = arith.constant true
      %1326 = arith.cmpi slt, %1324, %1325 : i32
      %1327 = arith.andi %true_3641, %1326 : i1
      %lay_3642 = cute.get_layout(%1308) : !memref_rmem_f32_4
      %1328 = cute.get_shape(%lay_3642) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3643, %e1_3644, %e2_3645, %e3_3646 = cute.get_leaves(%1328) : !cute.shape<"((2,2),(2,8))">
      %1329 = cute.get_stride(%lay_3642) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3647, %e1_3648, %e2_3649, %e3_3650 = cute.get_leaves(%1329) : !cute.stride<"((2,4),(1,8))">
      %1330 = scf.if %1327 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1308) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,1)">
        cute.memref.store(%1308, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,1)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1308) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1308 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1308) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1308) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1308 : !memref_rmem_f32_4
      }
      %iter_3651 = cute.get_iter(%1330) : !memref_rmem_f32_4
      %lay_3652 = cute.get_layout(%1330) : !memref_rmem_f32_4
      %1331 = cute.get_shape(%lay_3652) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3653, %e1_3654, %e2_3655, %e3_3656 = cute.get_leaves(%1331) : !cute.shape<"((2,2),(2,8))">
      %1332 = cute.get_stride(%lay_3652) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3657, %e1_3658, %e2_3659, %e3_3660 = cute.get_leaves(%1332) : !cute.stride<"((2,4),(1,8))">
      %iter_3661 = cute.get_iter(%1330) : !memref_rmem_f32_4
      %iter_3662 = cute.get_iter(%1330) : !memref_rmem_f32_4
      %coord_3663 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3664 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3665 = cute.crd2idx(%coord_3663, %lay_3664) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3666 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3667 = cute.add_offset(%iter_3666, %idx_3665) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3668 = cute.make_view(%tup_3667) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3669 = cute.get_iter(%view_3668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3670, %e1_3671, %e2_3672, %e3_3673 = cute.get_leaves(%iter_3669) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1333 = cute.get_scalars(%e0_3670) : !cute.int_tuple<"?">
      %1334 = cute.get_scalars(%e1_3671) : !cute.int_tuple<"?">
      %1335 = cute.get_scalars(%e2_3672) : !cute.int_tuple<"?">
      %1336 = cute.get_scalars(%e3_3673) : !cute.int_tuple<"?{div=2}">
      %iter_3674 = cute.get_iter(%view_3668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3675, %e1_3676, %e2_3677, %e3_3678 = cute.get_leaves(%iter_3674) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1337 = cute.get_scalars(%e0_3675) : !cute.int_tuple<"?">
      %1338 = cute.get_scalars(%e1_3676) : !cute.int_tuple<"?">
      %1339 = cute.get_scalars(%e2_3677) : !cute.int_tuple<"?">
      %1340 = cute.get_scalars(%e3_3678) : !cute.int_tuple<"?{div=2}">
      %iter_3679 = cute.get_iter(%view_3668) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3680, %e1_3681, %e2_3682, %e3_3683 = cute.get_leaves(%iter_3679) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1341 = cute.get_scalars(%e0_3680) : !cute.int_tuple<"?">
      %1342 = cute.get_scalars(%e1_3681) : !cute.int_tuple<"?">
      %1343 = cute.get_scalars(%e2_3682) : !cute.int_tuple<"?">
      %1344 = cute.get_scalars(%e3_3683) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3684 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3685 = cute.add_offset(%e3_3683, %int_tuple_3684) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1345 = cute.get_scalars(%tup_3685) : !cute.int_tuple<"?">
      %coord_3686 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3687 = cute.make_coord(%tup_3685) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1346 = cute.get_scalars(%coord_3686) : !cute.coord<"?">
      %1347 = cute.get_scalars(%coord_3687) : !cute.coord<"?">
      %true_3688 = arith.constant true
      %1348 = arith.cmpi slt, %1346, %1347 : i32
      %1349 = arith.andi %true_3688, %1348 : i1
      %lay_3689 = cute.get_layout(%1330) : !memref_rmem_f32_4
      %1350 = cute.get_shape(%lay_3689) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3690, %e1_3691, %e2_3692, %e3_3693 = cute.get_leaves(%1350) : !cute.shape<"((2,2),(2,8))">
      %1351 = cute.get_stride(%lay_3689) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3694, %e1_3695, %e2_3696, %e3_3697 = cute.get_leaves(%1351) : !cute.stride<"((2,4),(1,8))">
      %1352 = scf.if %1349 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1330) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,2)">
        cute.memref.store(%1330, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,2)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1330) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1330 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1330) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1330) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1330 : !memref_rmem_f32_4
      }
      %iter_3698 = cute.get_iter(%1352) : !memref_rmem_f32_4
      %lay_3699 = cute.get_layout(%1352) : !memref_rmem_f32_4
      %1353 = cute.get_shape(%lay_3699) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3700, %e1_3701, %e2_3702, %e3_3703 = cute.get_leaves(%1353) : !cute.shape<"((2,2),(2,8))">
      %1354 = cute.get_stride(%lay_3699) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3704, %e1_3705, %e2_3706, %e3_3707 = cute.get_leaves(%1354) : !cute.stride<"((2,4),(1,8))">
      %iter_3708 = cute.get_iter(%1352) : !memref_rmem_f32_4
      %iter_3709 = cute.get_iter(%1352) : !memref_rmem_f32_4
      %coord_3710 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_3711 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3712 = cute.crd2idx(%coord_3710, %lay_3711) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_3713 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3714 = cute.add_offset(%iter_3713, %idx_3712) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3715 = cute.make_view(%tup_3714) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3716 = cute.get_iter(%view_3715) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3717, %e1_3718, %e2_3719, %e3_3720 = cute.get_leaves(%iter_3716) : !cute.int_tuple<"(?,?,?,?)">
      %1355 = cute.get_scalars(%e0_3717) : !cute.int_tuple<"?">
      %1356 = cute.get_scalars(%e1_3718) : !cute.int_tuple<"?">
      %1357 = cute.get_scalars(%e2_3719) : !cute.int_tuple<"?">
      %1358 = cute.get_scalars(%e3_3720) : !cute.int_tuple<"?">
      %iter_3721 = cute.get_iter(%view_3715) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3722, %e1_3723, %e2_3724, %e3_3725 = cute.get_leaves(%iter_3721) : !cute.int_tuple<"(?,?,?,?)">
      %1359 = cute.get_scalars(%e0_3722) : !cute.int_tuple<"?">
      %1360 = cute.get_scalars(%e1_3723) : !cute.int_tuple<"?">
      %1361 = cute.get_scalars(%e2_3724) : !cute.int_tuple<"?">
      %1362 = cute.get_scalars(%e3_3725) : !cute.int_tuple<"?">
      %iter_3726 = cute.get_iter(%view_3715) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3727, %e1_3728, %e2_3729, %e3_3730 = cute.get_leaves(%iter_3726) : !cute.int_tuple<"(?,?,?,?)">
      %1363 = cute.get_scalars(%e0_3727) : !cute.int_tuple<"?">
      %1364 = cute.get_scalars(%e1_3728) : !cute.int_tuple<"?">
      %1365 = cute.get_scalars(%e2_3729) : !cute.int_tuple<"?">
      %1366 = cute.get_scalars(%e3_3730) : !cute.int_tuple<"?">
      %int_tuple_3731 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3732 = cute.add_offset(%e3_3730, %int_tuple_3731) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1367 = cute.get_scalars(%tup_3732) : !cute.int_tuple<"?">
      %coord_3733 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3734 = cute.make_coord(%tup_3732) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1368 = cute.get_scalars(%coord_3733) : !cute.coord<"?">
      %1369 = cute.get_scalars(%coord_3734) : !cute.coord<"?">
      %true_3735 = arith.constant true
      %1370 = arith.cmpi slt, %1368, %1369 : i32
      %1371 = arith.andi %true_3735, %1370 : i1
      %lay_3736 = cute.get_layout(%1352) : !memref_rmem_f32_4
      %1372 = cute.get_shape(%lay_3736) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3737, %e1_3738, %e2_3739, %e3_3740 = cute.get_leaves(%1372) : !cute.shape<"((2,2),(2,8))">
      %1373 = cute.get_stride(%lay_3736) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3741, %e1_3742, %e2_3743, %e3_3744 = cute.get_leaves(%1373) : !cute.stride<"((2,4),(1,8))">
      %1374 = scf.if %1371 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1352) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,3)">
        cute.memref.store(%1352, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,3)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1352) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1352 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1352) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1352) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1352 : !memref_rmem_f32_4
      }
      %iter_3745 = cute.get_iter(%1374) : !memref_rmem_f32_4
      %lay_3746 = cute.get_layout(%1374) : !memref_rmem_f32_4
      %1375 = cute.get_shape(%lay_3746) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3747, %e1_3748, %e2_3749, %e3_3750 = cute.get_leaves(%1375) : !cute.shape<"((2,2),(2,8))">
      %1376 = cute.get_stride(%lay_3746) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3751, %e1_3752, %e2_3753, %e3_3754 = cute.get_leaves(%1376) : !cute.stride<"((2,4),(1,8))">
      %iter_3755 = cute.get_iter(%1374) : !memref_rmem_f32_4
      %iter_3756 = cute.get_iter(%1374) : !memref_rmem_f32_4
      %coord_3757 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_3758 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3759 = cute.crd2idx(%coord_3757, %lay_3758) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_3760 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3761 = cute.add_offset(%iter_3760, %idx_3759) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3762 = cute.make_view(%tup_3761) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3763 = cute.get_iter(%view_3762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3764, %e1_3765, %e2_3766, %e3_3767 = cute.get_leaves(%iter_3763) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1377 = cute.get_scalars(%e0_3764) : !cute.int_tuple<"?">
      %1378 = cute.get_scalars(%e1_3765) : !cute.int_tuple<"?">
      %1379 = cute.get_scalars(%e2_3766) : !cute.int_tuple<"?">
      %1380 = cute.get_scalars(%e3_3767) : !cute.int_tuple<"?{div=2}">
      %iter_3768 = cute.get_iter(%view_3762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3769, %e1_3770, %e2_3771, %e3_3772 = cute.get_leaves(%iter_3768) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1381 = cute.get_scalars(%e0_3769) : !cute.int_tuple<"?">
      %1382 = cute.get_scalars(%e1_3770) : !cute.int_tuple<"?">
      %1383 = cute.get_scalars(%e2_3771) : !cute.int_tuple<"?">
      %1384 = cute.get_scalars(%e3_3772) : !cute.int_tuple<"?{div=2}">
      %iter_3773 = cute.get_iter(%view_3762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3774, %e1_3775, %e2_3776, %e3_3777 = cute.get_leaves(%iter_3773) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1385 = cute.get_scalars(%e0_3774) : !cute.int_tuple<"?">
      %1386 = cute.get_scalars(%e1_3775) : !cute.int_tuple<"?">
      %1387 = cute.get_scalars(%e2_3776) : !cute.int_tuple<"?">
      %1388 = cute.get_scalars(%e3_3777) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3778 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3779 = cute.add_offset(%e3_3777, %int_tuple_3778) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1389 = cute.get_scalars(%tup_3779) : !cute.int_tuple<"?">
      %coord_3780 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3781 = cute.make_coord(%tup_3779) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1390 = cute.get_scalars(%coord_3780) : !cute.coord<"?">
      %1391 = cute.get_scalars(%coord_3781) : !cute.coord<"?">
      %true_3782 = arith.constant true
      %1392 = arith.cmpi slt, %1390, %1391 : i32
      %1393 = arith.andi %true_3782, %1392 : i1
      %lay_3783 = cute.get_layout(%1374) : !memref_rmem_f32_4
      %1394 = cute.get_shape(%lay_3783) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3784, %e1_3785, %e2_3786, %e3_3787 = cute.get_leaves(%1394) : !cute.shape<"((2,2),(2,8))">
      %1395 = cute.get_stride(%lay_3783) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3788, %e1_3789, %e2_3790, %e3_3791 = cute.get_leaves(%1395) : !cute.stride<"((2,4),(1,8))">
      %1396 = scf.if %1393 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1374) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,4)">
        cute.memref.store(%1374, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,4)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1374) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1374 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1374) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1374) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1374 : !memref_rmem_f32_4
      }
      %iter_3792 = cute.get_iter(%1396) : !memref_rmem_f32_4
      %lay_3793 = cute.get_layout(%1396) : !memref_rmem_f32_4
      %1397 = cute.get_shape(%lay_3793) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3794, %e1_3795, %e2_3796, %e3_3797 = cute.get_leaves(%1397) : !cute.shape<"((2,2),(2,8))">
      %1398 = cute.get_stride(%lay_3793) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3798, %e1_3799, %e2_3800, %e3_3801 = cute.get_leaves(%1398) : !cute.stride<"((2,4),(1,8))">
      %iter_3802 = cute.get_iter(%1396) : !memref_rmem_f32_4
      %iter_3803 = cute.get_iter(%1396) : !memref_rmem_f32_4
      %coord_3804 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_3805 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3806 = cute.crd2idx(%coord_3804, %lay_3805) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_3807 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3808 = cute.add_offset(%iter_3807, %idx_3806) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3809 = cute.make_view(%tup_3808) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3810 = cute.get_iter(%view_3809) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3811, %e1_3812, %e2_3813, %e3_3814 = cute.get_leaves(%iter_3810) : !cute.int_tuple<"(?,?,?,?)">
      %1399 = cute.get_scalars(%e0_3811) : !cute.int_tuple<"?">
      %1400 = cute.get_scalars(%e1_3812) : !cute.int_tuple<"?">
      %1401 = cute.get_scalars(%e2_3813) : !cute.int_tuple<"?">
      %1402 = cute.get_scalars(%e3_3814) : !cute.int_tuple<"?">
      %iter_3815 = cute.get_iter(%view_3809) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3816, %e1_3817, %e2_3818, %e3_3819 = cute.get_leaves(%iter_3815) : !cute.int_tuple<"(?,?,?,?)">
      %1403 = cute.get_scalars(%e0_3816) : !cute.int_tuple<"?">
      %1404 = cute.get_scalars(%e1_3817) : !cute.int_tuple<"?">
      %1405 = cute.get_scalars(%e2_3818) : !cute.int_tuple<"?">
      %1406 = cute.get_scalars(%e3_3819) : !cute.int_tuple<"?">
      %iter_3820 = cute.get_iter(%view_3809) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3821, %e1_3822, %e2_3823, %e3_3824 = cute.get_leaves(%iter_3820) : !cute.int_tuple<"(?,?,?,?)">
      %1407 = cute.get_scalars(%e0_3821) : !cute.int_tuple<"?">
      %1408 = cute.get_scalars(%e1_3822) : !cute.int_tuple<"?">
      %1409 = cute.get_scalars(%e2_3823) : !cute.int_tuple<"?">
      %1410 = cute.get_scalars(%e3_3824) : !cute.int_tuple<"?">
      %int_tuple_3825 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3826 = cute.add_offset(%e3_3824, %int_tuple_3825) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1411 = cute.get_scalars(%tup_3826) : !cute.int_tuple<"?">
      %coord_3827 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3828 = cute.make_coord(%tup_3826) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1412 = cute.get_scalars(%coord_3827) : !cute.coord<"?">
      %1413 = cute.get_scalars(%coord_3828) : !cute.coord<"?">
      %true_3829 = arith.constant true
      %1414 = arith.cmpi slt, %1412, %1413 : i32
      %1415 = arith.andi %true_3829, %1414 : i1
      %lay_3830 = cute.get_layout(%1396) : !memref_rmem_f32_4
      %1416 = cute.get_shape(%lay_3830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3831, %e1_3832, %e2_3833, %e3_3834 = cute.get_leaves(%1416) : !cute.shape<"((2,2),(2,8))">
      %1417 = cute.get_stride(%lay_3830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3835, %e1_3836, %e2_3837, %e3_3838 = cute.get_leaves(%1417) : !cute.stride<"((2,4),(1,8))">
      %1418 = scf.if %1415 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1396) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,5)">
        cute.memref.store(%1396, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,5)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1396) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1396 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1396) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1396) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1396 : !memref_rmem_f32_4
      }
      %iter_3839 = cute.get_iter(%1418) : !memref_rmem_f32_4
      %lay_3840 = cute.get_layout(%1418) : !memref_rmem_f32_4
      %1419 = cute.get_shape(%lay_3840) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3841, %e1_3842, %e2_3843, %e3_3844 = cute.get_leaves(%1419) : !cute.shape<"((2,2),(2,8))">
      %1420 = cute.get_stride(%lay_3840) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3845, %e1_3846, %e2_3847, %e3_3848 = cute.get_leaves(%1420) : !cute.stride<"((2,4),(1,8))">
      %iter_3849 = cute.get_iter(%1418) : !memref_rmem_f32_4
      %iter_3850 = cute.get_iter(%1418) : !memref_rmem_f32_4
      %coord_3851 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_3852 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3853 = cute.crd2idx(%coord_3851, %lay_3852) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_3854 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3855 = cute.add_offset(%iter_3854, %idx_3853) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3856 = cute.make_view(%tup_3855) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3857 = cute.get_iter(%view_3856) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3858, %e1_3859, %e2_3860, %e3_3861 = cute.get_leaves(%iter_3857) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1421 = cute.get_scalars(%e0_3858) : !cute.int_tuple<"?">
      %1422 = cute.get_scalars(%e1_3859) : !cute.int_tuple<"?">
      %1423 = cute.get_scalars(%e2_3860) : !cute.int_tuple<"?">
      %1424 = cute.get_scalars(%e3_3861) : !cute.int_tuple<"?{div=2}">
      %iter_3862 = cute.get_iter(%view_3856) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3863, %e1_3864, %e2_3865, %e3_3866 = cute.get_leaves(%iter_3862) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1425 = cute.get_scalars(%e0_3863) : !cute.int_tuple<"?">
      %1426 = cute.get_scalars(%e1_3864) : !cute.int_tuple<"?">
      %1427 = cute.get_scalars(%e2_3865) : !cute.int_tuple<"?">
      %1428 = cute.get_scalars(%e3_3866) : !cute.int_tuple<"?{div=2}">
      %iter_3867 = cute.get_iter(%view_3856) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3868, %e1_3869, %e2_3870, %e3_3871 = cute.get_leaves(%iter_3867) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1429 = cute.get_scalars(%e0_3868) : !cute.int_tuple<"?">
      %1430 = cute.get_scalars(%e1_3869) : !cute.int_tuple<"?">
      %1431 = cute.get_scalars(%e2_3870) : !cute.int_tuple<"?">
      %1432 = cute.get_scalars(%e3_3871) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3872 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3873 = cute.add_offset(%e3_3871, %int_tuple_3872) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1433 = cute.get_scalars(%tup_3873) : !cute.int_tuple<"?">
      %coord_3874 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3875 = cute.make_coord(%tup_3873) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1434 = cute.get_scalars(%coord_3874) : !cute.coord<"?">
      %1435 = cute.get_scalars(%coord_3875) : !cute.coord<"?">
      %true_3876 = arith.constant true
      %1436 = arith.cmpi slt, %1434, %1435 : i32
      %1437 = arith.andi %true_3876, %1436 : i1
      %lay_3877 = cute.get_layout(%1418) : !memref_rmem_f32_4
      %1438 = cute.get_shape(%lay_3877) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3878, %e1_3879, %e2_3880, %e3_3881 = cute.get_leaves(%1438) : !cute.shape<"((2,2),(2,8))">
      %1439 = cute.get_stride(%lay_3877) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3882, %e1_3883, %e2_3884, %e3_3885 = cute.get_leaves(%1439) : !cute.stride<"((2,4),(1,8))">
      %1440 = scf.if %1437 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1418) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,6)">
        cute.memref.store(%1418, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,6)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1418) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1418 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1418) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1418) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1418 : !memref_rmem_f32_4
      }
      %iter_3886 = cute.get_iter(%1440) : !memref_rmem_f32_4
      %lay_3887 = cute.get_layout(%1440) : !memref_rmem_f32_4
      %1441 = cute.get_shape(%lay_3887) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3888, %e1_3889, %e2_3890, %e3_3891 = cute.get_leaves(%1441) : !cute.shape<"((2,2),(2,8))">
      %1442 = cute.get_stride(%lay_3887) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3892, %e1_3893, %e2_3894, %e3_3895 = cute.get_leaves(%1442) : !cute.stride<"((2,4),(1,8))">
      %iter_3896 = cute.get_iter(%1440) : !memref_rmem_f32_4
      %iter_3897 = cute.get_iter(%1440) : !memref_rmem_f32_4
      %coord_3898 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_3899 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3900 = cute.crd2idx(%coord_3898, %lay_3899) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_3901 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3902 = cute.add_offset(%iter_3901, %idx_3900) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3903 = cute.make_view(%tup_3902) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3904 = cute.get_iter(%view_3903) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3905, %e1_3906, %e2_3907, %e3_3908 = cute.get_leaves(%iter_3904) : !cute.int_tuple<"(?,?,?,?)">
      %1443 = cute.get_scalars(%e0_3905) : !cute.int_tuple<"?">
      %1444 = cute.get_scalars(%e1_3906) : !cute.int_tuple<"?">
      %1445 = cute.get_scalars(%e2_3907) : !cute.int_tuple<"?">
      %1446 = cute.get_scalars(%e3_3908) : !cute.int_tuple<"?">
      %iter_3909 = cute.get_iter(%view_3903) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%iter_3909) : !cute.int_tuple<"(?,?,?,?)">
      %1447 = cute.get_scalars(%e0_3910) : !cute.int_tuple<"?">
      %1448 = cute.get_scalars(%e1_3911) : !cute.int_tuple<"?">
      %1449 = cute.get_scalars(%e2_3912) : !cute.int_tuple<"?">
      %1450 = cute.get_scalars(%e3_3913) : !cute.int_tuple<"?">
      %iter_3914 = cute.get_iter(%view_3903) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3915, %e1_3916, %e2_3917, %e3_3918 = cute.get_leaves(%iter_3914) : !cute.int_tuple<"(?,?,?,?)">
      %1451 = cute.get_scalars(%e0_3915) : !cute.int_tuple<"?">
      %1452 = cute.get_scalars(%e1_3916) : !cute.int_tuple<"?">
      %1453 = cute.get_scalars(%e2_3917) : !cute.int_tuple<"?">
      %1454 = cute.get_scalars(%e3_3918) : !cute.int_tuple<"?">
      %int_tuple_3919 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3920 = cute.add_offset(%e3_3918, %int_tuple_3919) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%tup_3920) : !cute.int_tuple<"?">
      %coord_3921 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3922 = cute.make_coord(%tup_3920) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1456 = cute.get_scalars(%coord_3921) : !cute.coord<"?">
      %1457 = cute.get_scalars(%coord_3922) : !cute.coord<"?">
      %true_3923 = arith.constant true
      %1458 = arith.cmpi slt, %1456, %1457 : i32
      %1459 = arith.andi %true_3923, %1458 : i1
      %lay_3924 = cute.get_layout(%1440) : !memref_rmem_f32_4
      %1460 = cute.get_shape(%lay_3924) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3925, %e1_3926, %e2_3927, %e3_3928 = cute.get_leaves(%1460) : !cute.shape<"((2,2),(2,8))">
      %1461 = cute.get_stride(%lay_3924) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3929, %e1_3930, %e2_3931, %e3_3932 = cute.get_leaves(%1461) : !cute.stride<"((2,4),(1,8))">
      %1462 = scf.if %1459 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1440) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,7)">
        cute.memref.store(%1440, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,7)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1440) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1440 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1440) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1440) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1440 : !memref_rmem_f32_4
      }
      %iter_3933 = cute.get_iter(%1462) : !memref_rmem_f32_4
      %lay_3934 = cute.get_layout(%1462) : !memref_rmem_f32_4
      %1463 = cute.get_shape(%lay_3934) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3935, %e1_3936, %e2_3937, %e3_3938 = cute.get_leaves(%1463) : !cute.shape<"((2,2),(2,8))">
      %1464 = cute.get_stride(%lay_3934) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3939, %e1_3940, %e2_3941, %e3_3942 = cute.get_leaves(%1464) : !cute.stride<"((2,4),(1,8))">
      %iter_3943 = cute.get_iter(%1462) : !memref_rmem_f32_4
      %iter_3944 = cute.get_iter(%1462) : !memref_rmem_f32_4
      %coord_3945 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_3946 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3947 = cute.crd2idx(%coord_3945, %lay_3946) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_3948 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3949 = cute.add_offset(%iter_3948, %idx_3947) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3950 = cute.make_view(%tup_3949) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3951 = cute.get_iter(%view_3950) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3952, %e1_3953, %e2_3954, %e3_3955 = cute.get_leaves(%iter_3951) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1465 = cute.get_scalars(%e0_3952) : !cute.int_tuple<"?">
      %1466 = cute.get_scalars(%e1_3953) : !cute.int_tuple<"?">
      %1467 = cute.get_scalars(%e2_3954) : !cute.int_tuple<"?">
      %1468 = cute.get_scalars(%e3_3955) : !cute.int_tuple<"?{div=2}">
      %iter_3956 = cute.get_iter(%view_3950) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3957, %e1_3958, %e2_3959, %e3_3960 = cute.get_leaves(%iter_3956) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1469 = cute.get_scalars(%e0_3957) : !cute.int_tuple<"?">
      %1470 = cute.get_scalars(%e1_3958) : !cute.int_tuple<"?">
      %1471 = cute.get_scalars(%e2_3959) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e3_3960) : !cute.int_tuple<"?{div=2}">
      %iter_3961 = cute.get_iter(%view_3950) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3962, %e1_3963, %e2_3964, %e3_3965 = cute.get_leaves(%iter_3961) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1473 = cute.get_scalars(%e0_3962) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e1_3963) : !cute.int_tuple<"?">
      %1475 = cute.get_scalars(%e2_3964) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e3_3965) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3966 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3967 = cute.add_offset(%e3_3965, %int_tuple_3966) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%tup_3967) : !cute.int_tuple<"?">
      %coord_3968 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3969 = cute.make_coord(%tup_3967) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1478 = cute.get_scalars(%coord_3968) : !cute.coord<"?">
      %1479 = cute.get_scalars(%coord_3969) : !cute.coord<"?">
      %true_3970 = arith.constant true
      %1480 = arith.cmpi slt, %1478, %1479 : i32
      %1481 = arith.andi %true_3970, %1480 : i1
      %lay_3971 = cute.get_layout(%1462) : !memref_rmem_f32_4
      %1482 = cute.get_shape(%lay_3971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3972, %e1_3973, %e2_3974, %e3_3975 = cute.get_leaves(%1482) : !cute.shape<"((2,2),(2,8))">
      %1483 = cute.get_stride(%lay_3971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3976, %e1_3977, %e2_3978, %e3_3979 = cute.get_leaves(%1483) : !cute.stride<"((2,4),(1,8))">
      %1484 = scf.if %1481 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1462) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,8)">
        cute.memref.store(%1462, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,8)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1462) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1462 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1462) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1462) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1462 : !memref_rmem_f32_4
      }
      %iter_3980 = cute.get_iter(%1484) : !memref_rmem_f32_4
      %lay_3981 = cute.get_layout(%1484) : !memref_rmem_f32_4
      %1485 = cute.get_shape(%lay_3981) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3982, %e1_3983, %e2_3984, %e3_3985 = cute.get_leaves(%1485) : !cute.shape<"((2,2),(2,8))">
      %1486 = cute.get_stride(%lay_3981) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3986, %e1_3987, %e2_3988, %e3_3989 = cute.get_leaves(%1486) : !cute.stride<"((2,4),(1,8))">
      %iter_3990 = cute.get_iter(%1484) : !memref_rmem_f32_4
      %iter_3991 = cute.get_iter(%1484) : !memref_rmem_f32_4
      %coord_3992 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_3993 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3994 = cute.crd2idx(%coord_3992, %lay_3993) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_3995 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3996 = cute.add_offset(%iter_3995, %idx_3994) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3997 = cute.make_view(%tup_3996) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3998 = cute.get_iter(%view_3997) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3999, %e1_4000, %e2_4001, %e3_4002 = cute.get_leaves(%iter_3998) : !cute.int_tuple<"(?,?,?,?)">
      %1487 = cute.get_scalars(%e0_3999) : !cute.int_tuple<"?">
      %1488 = cute.get_scalars(%e1_4000) : !cute.int_tuple<"?">
      %1489 = cute.get_scalars(%e2_4001) : !cute.int_tuple<"?">
      %1490 = cute.get_scalars(%e3_4002) : !cute.int_tuple<"?">
      %iter_4003 = cute.get_iter(%view_3997) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4004, %e1_4005, %e2_4006, %e3_4007 = cute.get_leaves(%iter_4003) : !cute.int_tuple<"(?,?,?,?)">
      %1491 = cute.get_scalars(%e0_4004) : !cute.int_tuple<"?">
      %1492 = cute.get_scalars(%e1_4005) : !cute.int_tuple<"?">
      %1493 = cute.get_scalars(%e2_4006) : !cute.int_tuple<"?">
      %1494 = cute.get_scalars(%e3_4007) : !cute.int_tuple<"?">
      %iter_4008 = cute.get_iter(%view_3997) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4009, %e1_4010, %e2_4011, %e3_4012 = cute.get_leaves(%iter_4008) : !cute.int_tuple<"(?,?,?,?)">
      %1495 = cute.get_scalars(%e0_4009) : !cute.int_tuple<"?">
      %1496 = cute.get_scalars(%e1_4010) : !cute.int_tuple<"?">
      %1497 = cute.get_scalars(%e2_4011) : !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%e3_4012) : !cute.int_tuple<"?">
      %int_tuple_4013 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4014 = cute.add_offset(%e3_4012, %int_tuple_4013) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%tup_4014) : !cute.int_tuple<"?">
      %coord_4015 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4016 = cute.make_coord(%tup_4014) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1500 = cute.get_scalars(%coord_4015) : !cute.coord<"?">
      %1501 = cute.get_scalars(%coord_4016) : !cute.coord<"?">
      %true_4017 = arith.constant true
      %1502 = arith.cmpi slt, %1500, %1501 : i32
      %1503 = arith.andi %true_4017, %1502 : i1
      %lay_4018 = cute.get_layout(%1484) : !memref_rmem_f32_4
      %1504 = cute.get_shape(%lay_4018) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4019, %e1_4020, %e2_4021, %e3_4022 = cute.get_leaves(%1504) : !cute.shape<"((2,2),(2,8))">
      %1505 = cute.get_stride(%lay_4018) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4023, %e1_4024, %e2_4025, %e3_4026 = cute.get_leaves(%1505) : !cute.stride<"((2,4),(1,8))">
      %1506 = scf.if %1503 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1484) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,9)">
        cute.memref.store(%1484, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,9)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1484) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1484 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1484) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1484) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1484 : !memref_rmem_f32_4
      }
      %iter_4027 = cute.get_iter(%1506) : !memref_rmem_f32_4
      %lay_4028 = cute.get_layout(%1506) : !memref_rmem_f32_4
      %1507 = cute.get_shape(%lay_4028) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4029, %e1_4030, %e2_4031, %e3_4032 = cute.get_leaves(%1507) : !cute.shape<"((2,2),(2,8))">
      %1508 = cute.get_stride(%lay_4028) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4033, %e1_4034, %e2_4035, %e3_4036 = cute.get_leaves(%1508) : !cute.stride<"((2,4),(1,8))">
      %iter_4037 = cute.get_iter(%1506) : !memref_rmem_f32_4
      %iter_4038 = cute.get_iter(%1506) : !memref_rmem_f32_4
      %coord_4039 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4040 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4041 = cute.crd2idx(%coord_4039, %lay_4040) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4042 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4043 = cute.add_offset(%iter_4042, %idx_4041) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4044 = cute.make_view(%tup_4043) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4045 = cute.get_iter(%view_4044) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4046, %e1_4047, %e2_4048, %e3_4049 = cute.get_leaves(%iter_4045) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1509 = cute.get_scalars(%e0_4046) : !cute.int_tuple<"?">
      %1510 = cute.get_scalars(%e1_4047) : !cute.int_tuple<"?">
      %1511 = cute.get_scalars(%e2_4048) : !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%e3_4049) : !cute.int_tuple<"?{div=2}">
      %iter_4050 = cute.get_iter(%view_4044) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4051, %e1_4052, %e2_4053, %e3_4054 = cute.get_leaves(%iter_4050) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1513 = cute.get_scalars(%e0_4051) : !cute.int_tuple<"?">
      %1514 = cute.get_scalars(%e1_4052) : !cute.int_tuple<"?">
      %1515 = cute.get_scalars(%e2_4053) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e3_4054) : !cute.int_tuple<"?{div=2}">
      %iter_4055 = cute.get_iter(%view_4044) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4056, %e1_4057, %e2_4058, %e3_4059 = cute.get_leaves(%iter_4055) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1517 = cute.get_scalars(%e0_4056) : !cute.int_tuple<"?">
      %1518 = cute.get_scalars(%e1_4057) : !cute.int_tuple<"?">
      %1519 = cute.get_scalars(%e2_4058) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e3_4059) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4060 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4061 = cute.add_offset(%e3_4059, %int_tuple_4060) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%tup_4061) : !cute.int_tuple<"?">
      %coord_4062 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4063 = cute.make_coord(%tup_4061) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1522 = cute.get_scalars(%coord_4062) : !cute.coord<"?">
      %1523 = cute.get_scalars(%coord_4063) : !cute.coord<"?">
      %true_4064 = arith.constant true
      %1524 = arith.cmpi slt, %1522, %1523 : i32
      %1525 = arith.andi %true_4064, %1524 : i1
      %lay_4065 = cute.get_layout(%1506) : !memref_rmem_f32_4
      %1526 = cute.get_shape(%lay_4065) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4066, %e1_4067, %e2_4068, %e3_4069 = cute.get_leaves(%1526) : !cute.shape<"((2,2),(2,8))">
      %1527 = cute.get_stride(%lay_4065) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4070, %e1_4071, %e2_4072, %e3_4073 = cute.get_leaves(%1527) : !cute.stride<"((2,4),(1,8))">
      %1528 = scf.if %1525 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1506) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,10)">
        cute.memref.store(%1506, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,10)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1506) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1506 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1506) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1506) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1506 : !memref_rmem_f32_4
      }
      %iter_4074 = cute.get_iter(%1528) : !memref_rmem_f32_4
      %lay_4075 = cute.get_layout(%1528) : !memref_rmem_f32_4
      %1529 = cute.get_shape(%lay_4075) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4076, %e1_4077, %e2_4078, %e3_4079 = cute.get_leaves(%1529) : !cute.shape<"((2,2),(2,8))">
      %1530 = cute.get_stride(%lay_4075) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4080, %e1_4081, %e2_4082, %e3_4083 = cute.get_leaves(%1530) : !cute.stride<"((2,4),(1,8))">
      %iter_4084 = cute.get_iter(%1528) : !memref_rmem_f32_4
      %iter_4085 = cute.get_iter(%1528) : !memref_rmem_f32_4
      %coord_4086 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4087 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4088 = cute.crd2idx(%coord_4086, %lay_4087) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4089 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4090 = cute.add_offset(%iter_4089, %idx_4088) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4091 = cute.make_view(%tup_4090) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4092 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4093, %e1_4094, %e2_4095, %e3_4096 = cute.get_leaves(%iter_4092) : !cute.int_tuple<"(?,?,?,?)">
      %1531 = cute.get_scalars(%e0_4093) : !cute.int_tuple<"?">
      %1532 = cute.get_scalars(%e1_4094) : !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%e2_4095) : !cute.int_tuple<"?">
      %1534 = cute.get_scalars(%e3_4096) : !cute.int_tuple<"?">
      %iter_4097 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4098, %e1_4099, %e2_4100, %e3_4101 = cute.get_leaves(%iter_4097) : !cute.int_tuple<"(?,?,?,?)">
      %1535 = cute.get_scalars(%e0_4098) : !cute.int_tuple<"?">
      %1536 = cute.get_scalars(%e1_4099) : !cute.int_tuple<"?">
      %1537 = cute.get_scalars(%e2_4100) : !cute.int_tuple<"?">
      %1538 = cute.get_scalars(%e3_4101) : !cute.int_tuple<"?">
      %iter_4102 = cute.get_iter(%view_4091) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4103, %e1_4104, %e2_4105, %e3_4106 = cute.get_leaves(%iter_4102) : !cute.int_tuple<"(?,?,?,?)">
      %1539 = cute.get_scalars(%e0_4103) : !cute.int_tuple<"?">
      %1540 = cute.get_scalars(%e1_4104) : !cute.int_tuple<"?">
      %1541 = cute.get_scalars(%e2_4105) : !cute.int_tuple<"?">
      %1542 = cute.get_scalars(%e3_4106) : !cute.int_tuple<"?">
      %int_tuple_4107 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4108 = cute.add_offset(%e3_4106, %int_tuple_4107) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1543 = cute.get_scalars(%tup_4108) : !cute.int_tuple<"?">
      %coord_4109 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4110 = cute.make_coord(%tup_4108) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1544 = cute.get_scalars(%coord_4109) : !cute.coord<"?">
      %1545 = cute.get_scalars(%coord_4110) : !cute.coord<"?">
      %true_4111 = arith.constant true
      %1546 = arith.cmpi slt, %1544, %1545 : i32
      %1547 = arith.andi %true_4111, %1546 : i1
      %lay_4112 = cute.get_layout(%1528) : !memref_rmem_f32_4
      %1548 = cute.get_shape(%lay_4112) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4113, %e1_4114, %e2_4115, %e3_4116 = cute.get_leaves(%1548) : !cute.shape<"((2,2),(2,8))">
      %1549 = cute.get_stride(%lay_4112) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4117, %e1_4118, %e2_4119, %e3_4120 = cute.get_leaves(%1549) : !cute.stride<"((2,4),(1,8))">
      %1550 = scf.if %1547 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1528) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,11)">
        cute.memref.store(%1528, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,11)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1528) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1528 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1528) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1528) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1528 : !memref_rmem_f32_4
      }
      %iter_4121 = cute.get_iter(%1550) : !memref_rmem_f32_4
      %lay_4122 = cute.get_layout(%1550) : !memref_rmem_f32_4
      %1551 = cute.get_shape(%lay_4122) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4123, %e1_4124, %e2_4125, %e3_4126 = cute.get_leaves(%1551) : !cute.shape<"((2,2),(2,8))">
      %1552 = cute.get_stride(%lay_4122) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4127, %e1_4128, %e2_4129, %e3_4130 = cute.get_leaves(%1552) : !cute.stride<"((2,4),(1,8))">
      %iter_4131 = cute.get_iter(%1550) : !memref_rmem_f32_4
      %iter_4132 = cute.get_iter(%1550) : !memref_rmem_f32_4
      %coord_4133 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4134 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4135 = cute.crd2idx(%coord_4133, %lay_4134) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4136 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4137 = cute.add_offset(%iter_4136, %idx_4135) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4138 = cute.make_view(%tup_4137) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4139 = cute.get_iter(%view_4138) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4140, %e1_4141, %e2_4142, %e3_4143 = cute.get_leaves(%iter_4139) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1553 = cute.get_scalars(%e0_4140) : !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%e1_4141) : !cute.int_tuple<"?">
      %1555 = cute.get_scalars(%e2_4142) : !cute.int_tuple<"?">
      %1556 = cute.get_scalars(%e3_4143) : !cute.int_tuple<"?{div=2}">
      %iter_4144 = cute.get_iter(%view_4138) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4145, %e1_4146, %e2_4147, %e3_4148 = cute.get_leaves(%iter_4144) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1557 = cute.get_scalars(%e0_4145) : !cute.int_tuple<"?">
      %1558 = cute.get_scalars(%e1_4146) : !cute.int_tuple<"?">
      %1559 = cute.get_scalars(%e2_4147) : !cute.int_tuple<"?">
      %1560 = cute.get_scalars(%e3_4148) : !cute.int_tuple<"?{div=2}">
      %iter_4149 = cute.get_iter(%view_4138) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%iter_4149) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1561 = cute.get_scalars(%e0_4150) : !cute.int_tuple<"?">
      %1562 = cute.get_scalars(%e1_4151) : !cute.int_tuple<"?">
      %1563 = cute.get_scalars(%e2_4152) : !cute.int_tuple<"?">
      %1564 = cute.get_scalars(%e3_4153) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4154 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4155 = cute.add_offset(%e3_4153, %int_tuple_4154) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1565 = cute.get_scalars(%tup_4155) : !cute.int_tuple<"?">
      %coord_4156 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4157 = cute.make_coord(%tup_4155) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1566 = cute.get_scalars(%coord_4156) : !cute.coord<"?">
      %1567 = cute.get_scalars(%coord_4157) : !cute.coord<"?">
      %true_4158 = arith.constant true
      %1568 = arith.cmpi slt, %1566, %1567 : i32
      %1569 = arith.andi %true_4158, %1568 : i1
      %lay_4159 = cute.get_layout(%1550) : !memref_rmem_f32_4
      %1570 = cute.get_shape(%lay_4159) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4160, %e1_4161, %e2_4162, %e3_4163 = cute.get_leaves(%1570) : !cute.shape<"((2,2),(2,8))">
      %1571 = cute.get_stride(%lay_4159) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4164, %e1_4165, %e2_4166, %e3_4167 = cute.get_leaves(%1571) : !cute.stride<"((2,4),(1,8))">
      %1572 = scf.if %1569 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1550) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,12)">
        cute.memref.store(%1550, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,12)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1550) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1550 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1550) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1550) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1550 : !memref_rmem_f32_4
      }
      %iter_4168 = cute.get_iter(%1572) : !memref_rmem_f32_4
      %lay_4169 = cute.get_layout(%1572) : !memref_rmem_f32_4
      %1573 = cute.get_shape(%lay_4169) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4170, %e1_4171, %e2_4172, %e3_4173 = cute.get_leaves(%1573) : !cute.shape<"((2,2),(2,8))">
      %1574 = cute.get_stride(%lay_4169) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4174, %e1_4175, %e2_4176, %e3_4177 = cute.get_leaves(%1574) : !cute.stride<"((2,4),(1,8))">
      %iter_4178 = cute.get_iter(%1572) : !memref_rmem_f32_4
      %iter_4179 = cute.get_iter(%1572) : !memref_rmem_f32_4
      %coord_4180 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_4181 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4182 = cute.crd2idx(%coord_4180, %lay_4181) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_4183 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4184 = cute.add_offset(%iter_4183, %idx_4182) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4185 = cute.make_view(%tup_4184) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4186 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4187, %e1_4188, %e2_4189, %e3_4190 = cute.get_leaves(%iter_4186) : !cute.int_tuple<"(?,?,?,?)">
      %1575 = cute.get_scalars(%e0_4187) : !cute.int_tuple<"?">
      %1576 = cute.get_scalars(%e1_4188) : !cute.int_tuple<"?">
      %1577 = cute.get_scalars(%e2_4189) : !cute.int_tuple<"?">
      %1578 = cute.get_scalars(%e3_4190) : !cute.int_tuple<"?">
      %iter_4191 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4192, %e1_4193, %e2_4194, %e3_4195 = cute.get_leaves(%iter_4191) : !cute.int_tuple<"(?,?,?,?)">
      %1579 = cute.get_scalars(%e0_4192) : !cute.int_tuple<"?">
      %1580 = cute.get_scalars(%e1_4193) : !cute.int_tuple<"?">
      %1581 = cute.get_scalars(%e2_4194) : !cute.int_tuple<"?">
      %1582 = cute.get_scalars(%e3_4195) : !cute.int_tuple<"?">
      %iter_4196 = cute.get_iter(%view_4185) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4197, %e1_4198, %e2_4199, %e3_4200 = cute.get_leaves(%iter_4196) : !cute.int_tuple<"(?,?,?,?)">
      %1583 = cute.get_scalars(%e0_4197) : !cute.int_tuple<"?">
      %1584 = cute.get_scalars(%e1_4198) : !cute.int_tuple<"?">
      %1585 = cute.get_scalars(%e2_4199) : !cute.int_tuple<"?">
      %1586 = cute.get_scalars(%e3_4200) : !cute.int_tuple<"?">
      %int_tuple_4201 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4202 = cute.add_offset(%e3_4200, %int_tuple_4201) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%tup_4202) : !cute.int_tuple<"?">
      %coord_4203 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4204 = cute.make_coord(%tup_4202) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1588 = cute.get_scalars(%coord_4203) : !cute.coord<"?">
      %1589 = cute.get_scalars(%coord_4204) : !cute.coord<"?">
      %true_4205 = arith.constant true
      %1590 = arith.cmpi slt, %1588, %1589 : i32
      %1591 = arith.andi %true_4205, %1590 : i1
      %lay_4206 = cute.get_layout(%1572) : !memref_rmem_f32_4
      %1592 = cute.get_shape(%lay_4206) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4207, %e1_4208, %e2_4209, %e3_4210 = cute.get_leaves(%1592) : !cute.shape<"((2,2),(2,8))">
      %1593 = cute.get_stride(%lay_4206) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4211, %e1_4212, %e2_4213, %e3_4214 = cute.get_leaves(%1593) : !cute.stride<"((2,4),(1,8))">
      %1594 = scf.if %1591 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1572) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,13)">
        cute.memref.store(%1572, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,13)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1572) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1572 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1572) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1572) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1572 : !memref_rmem_f32_4
      }
      %iter_4215 = cute.get_iter(%1594) : !memref_rmem_f32_4
      %lay_4216 = cute.get_layout(%1594) : !memref_rmem_f32_4
      %1595 = cute.get_shape(%lay_4216) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4217, %e1_4218, %e2_4219, %e3_4220 = cute.get_leaves(%1595) : !cute.shape<"((2,2),(2,8))">
      %1596 = cute.get_stride(%lay_4216) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4221, %e1_4222, %e2_4223, %e3_4224 = cute.get_leaves(%1596) : !cute.stride<"((2,4),(1,8))">
      %iter_4225 = cute.get_iter(%1594) : !memref_rmem_f32_4
      %iter_4226 = cute.get_iter(%1594) : !memref_rmem_f32_4
      %coord_4227 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_4228 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4229 = cute.crd2idx(%coord_4227, %lay_4228) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_4230 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4231 = cute.add_offset(%iter_4230, %idx_4229) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4232 = cute.make_view(%tup_4231) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4233 = cute.get_iter(%view_4232) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4234, %e1_4235, %e2_4236, %e3_4237 = cute.get_leaves(%iter_4233) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1597 = cute.get_scalars(%e0_4234) : !cute.int_tuple<"?">
      %1598 = cute.get_scalars(%e1_4235) : !cute.int_tuple<"?">
      %1599 = cute.get_scalars(%e2_4236) : !cute.int_tuple<"?">
      %1600 = cute.get_scalars(%e3_4237) : !cute.int_tuple<"?{div=2}">
      %iter_4238 = cute.get_iter(%view_4232) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4239, %e1_4240, %e2_4241, %e3_4242 = cute.get_leaves(%iter_4238) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1601 = cute.get_scalars(%e0_4239) : !cute.int_tuple<"?">
      %1602 = cute.get_scalars(%e1_4240) : !cute.int_tuple<"?">
      %1603 = cute.get_scalars(%e2_4241) : !cute.int_tuple<"?">
      %1604 = cute.get_scalars(%e3_4242) : !cute.int_tuple<"?{div=2}">
      %iter_4243 = cute.get_iter(%view_4232) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4244, %e1_4245, %e2_4246, %e3_4247 = cute.get_leaves(%iter_4243) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1605 = cute.get_scalars(%e0_4244) : !cute.int_tuple<"?">
      %1606 = cute.get_scalars(%e1_4245) : !cute.int_tuple<"?">
      %1607 = cute.get_scalars(%e2_4246) : !cute.int_tuple<"?">
      %1608 = cute.get_scalars(%e3_4247) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4248 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4249 = cute.add_offset(%e3_4247, %int_tuple_4248) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1609 = cute.get_scalars(%tup_4249) : !cute.int_tuple<"?">
      %coord_4250 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4251 = cute.make_coord(%tup_4249) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1610 = cute.get_scalars(%coord_4250) : !cute.coord<"?">
      %1611 = cute.get_scalars(%coord_4251) : !cute.coord<"?">
      %true_4252 = arith.constant true
      %1612 = arith.cmpi slt, %1610, %1611 : i32
      %1613 = arith.andi %true_4252, %1612 : i1
      %lay_4253 = cute.get_layout(%1594) : !memref_rmem_f32_4
      %1614 = cute.get_shape(%lay_4253) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4254, %e1_4255, %e2_4256, %e3_4257 = cute.get_leaves(%1614) : !cute.shape<"((2,2),(2,8))">
      %1615 = cute.get_stride(%lay_4253) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4258, %e1_4259, %e2_4260, %e3_4261 = cute.get_leaves(%1615) : !cute.stride<"((2,4),(1,8))">
      %1616 = scf.if %1613 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1594) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,14)">
        cute.memref.store(%1594, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,14)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1594) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1594 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1594) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1594) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1594 : !memref_rmem_f32_4
      }
      %iter_4262 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %lay_4263 = cute.get_layout(%1616) : !memref_rmem_f32_4
      %1617 = cute.get_shape(%lay_4263) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4264, %e1_4265, %e2_4266, %e3_4267 = cute.get_leaves(%1617) : !cute.shape<"((2,2),(2,8))">
      %1618 = cute.get_stride(%lay_4263) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4268, %e1_4269, %e2_4270, %e3_4271 = cute.get_leaves(%1618) : !cute.stride<"((2,4),(1,8))">
      %iter_4272 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %iter_4273 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %coord_4274 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_4275 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4276 = cute.crd2idx(%coord_4274, %lay_4275) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_4277 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4278 = cute.add_offset(%iter_4277, %idx_4276) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4279 = cute.make_view(%tup_4278) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4280 = cute.get_iter(%view_4279) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4281, %e1_4282, %e2_4283, %e3_4284 = cute.get_leaves(%iter_4280) : !cute.int_tuple<"(?,?,?,?)">
      %1619 = cute.get_scalars(%e0_4281) : !cute.int_tuple<"?">
      %1620 = cute.get_scalars(%e1_4282) : !cute.int_tuple<"?">
      %1621 = cute.get_scalars(%e2_4283) : !cute.int_tuple<"?">
      %1622 = cute.get_scalars(%e3_4284) : !cute.int_tuple<"?">
      %iter_4285 = cute.get_iter(%view_4279) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4286, %e1_4287, %e2_4288, %e3_4289 = cute.get_leaves(%iter_4285) : !cute.int_tuple<"(?,?,?,?)">
      %1623 = cute.get_scalars(%e0_4286) : !cute.int_tuple<"?">
      %1624 = cute.get_scalars(%e1_4287) : !cute.int_tuple<"?">
      %1625 = cute.get_scalars(%e2_4288) : !cute.int_tuple<"?">
      %1626 = cute.get_scalars(%e3_4289) : !cute.int_tuple<"?">
      %iter_4290 = cute.get_iter(%view_4279) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4291, %e1_4292, %e2_4293, %e3_4294 = cute.get_leaves(%iter_4290) : !cute.int_tuple<"(?,?,?,?)">
      %1627 = cute.get_scalars(%e0_4291) : !cute.int_tuple<"?">
      %1628 = cute.get_scalars(%e1_4292) : !cute.int_tuple<"?">
      %1629 = cute.get_scalars(%e2_4293) : !cute.int_tuple<"?">
      %1630 = cute.get_scalars(%e3_4294) : !cute.int_tuple<"?">
      %int_tuple_4295 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4296 = cute.add_offset(%e3_4294, %int_tuple_4295) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1631 = cute.get_scalars(%tup_4296) : !cute.int_tuple<"?">
      %coord_4297 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4298 = cute.make_coord(%tup_4296) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1632 = cute.get_scalars(%coord_4297) : !cute.coord<"?">
      %1633 = cute.get_scalars(%coord_4298) : !cute.coord<"?">
      %true_4299 = arith.constant true
      %1634 = arith.cmpi slt, %1632, %1633 : i32
      %1635 = arith.andi %true_4299, %1634 : i1
      %lay_4300 = cute.get_layout(%1616) : !memref_rmem_f32_4
      %1636 = cute.get_shape(%lay_4300) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4301, %e1_4302, %e2_4303, %e3_4304 = cute.get_leaves(%1636) : !cute.shape<"((2,2),(2,8))">
      %1637 = cute.get_stride(%lay_4300) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4305, %e1_4306, %e2_4307, %e3_4308 = cute.get_leaves(%1637) : !cute.stride<"((2,4),(1,8))">
      %1638 = scf.if %1635 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1616) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(0,15)">
        cute.memref.store(%1616, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(0,15)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1616) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1616 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1616) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1616) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1616 : !memref_rmem_f32_4
      }
      %iter_4309 = cute.get_iter(%1638) : !memref_rmem_f32_4
      %lay_4310 = cute.get_layout(%1638) : !memref_rmem_f32_4
      %1639 = cute.get_shape(%lay_4310) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4311, %e1_4312, %e2_4313, %e3_4314 = cute.get_leaves(%1639) : !cute.shape<"((2,2),(2,8))">
      %1640 = cute.get_stride(%lay_4310) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4315, %e1_4316, %e2_4317, %e3_4318 = cute.get_leaves(%1640) : !cute.stride<"((2,4),(1,8))">
      %iter_4319 = cute.get_iter(%1638) : !memref_rmem_f32_4
      %iter_4320 = cute.get_iter(%1638) : !memref_rmem_f32_4
      %coord_4321 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_4322 = cute.get_layout(%1638) : !memref_rmem_f32_4
      %idx_4323 = cute.crd2idx(%coord_4321, %lay_4322) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_4324 = cute.get_iter(%1638) : !memref_rmem_f32_4
      %ptr_4325 = cute.add_offset(%iter_4324, %idx_4323) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_4326 = cute.make_view(%ptr_4325) : !memref_rmem_f32_6
      %iter_4327 = cute.get_iter(%view_4326) : !memref_rmem_f32_6
      %lay_4328 = cute.get_layout(%view_4326) : !memref_rmem_f32_6
      %1641 = cute.get_shape(%lay_4328) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4329, %e1_4330 = cute.get_leaves(%1641) : !cute.shape<"((2,8))">
      %1642 = cute.memref.load_vec %view_4326, row_major : !memref_rmem_f32_6
      %cst_4331 = arith.constant 0xFF800000 : f32
      %1643 = vector.reduction <maximumf>, %1642, %cst_4331 : vector<16xf32> into f32
      %c-1_i32 = arith.constant -1 : i32
      %c2_i32_4332 = arith.constant 2 : i32
      %c31_i32 = arith.constant 31 : i32
      %1644 = nvvm.shfl.sync  bfly %c-1_i32, %1643, %c2_i32_4332, %c31_i32 : f32 -> f32
      %1645 = nvvm.fmax %1643, %1644
      %c-1_i32_4333 = arith.constant -1 : i32
      %c1_i32_4334 = arith.constant 1 : i32
      %c31_i32_4335 = arith.constant 31 : i32
      %1646 = nvvm.shfl.sync  bfly %c-1_i32_4333, %1645, %c1_i32_4334, %c31_i32_4335 : f32 -> f32
      %1647 = nvvm.fmax %1645, %1646
      %1648 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1649 = arith.mulf %1642, %1648 : vector<16xf32>
      %1650 = arith.mulf %1647, %arg4 : f32
      %1651 = vector.broadcast %1650 : f32 to vector<16xf32>
      %1652 = arith.subf %1649, %1651 : vector<16xf32>
      %1653 = math.exp2 %1652 fastmath<fast> : vector<16xf32>
      %cst_4336 = arith.constant 0.000000e+00 : f32
      %1654 = vector.reduction <add>, %1653, %cst_4336 : vector<16xf32> into f32
      %coord_4337 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1582, %coord_4337, %1647) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_4338 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1587, %coord_4338, %1654) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_4339 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_4340 = cute.get_layout(%1638) : !memref_rmem_f32_4
      %idx_4341 = cute.crd2idx(%coord_4339, %lay_4340) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_4342 = cute.get_iter(%1638) : !memref_rmem_f32_4
      %ptr_4343 = cute.add_offset(%iter_4342, %idx_4341) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_4344 = cute.make_view(%ptr_4343) : !memref_rmem_f32_6
      %iter_4345 = cute.get_iter(%view_4344) : !memref_rmem_f32_6
      %lay_4346 = cute.get_layout(%view_4344) : !memref_rmem_f32_6
      %1655 = cute.get_shape(%lay_4346) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4347, %e1_4348 = cute.get_leaves(%1655) : !cute.shape<"((2,8))">
      %int_tuple_4349 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4350 = cute.size(%int_tuple_4349) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4351 = cute.get_leaves(%sz_4350) : !cute.int_tuple<"16">
      %int_tuple_4352 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4353 = cute.size(%int_tuple_4352) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4354 = cute.get_leaves(%sz_4353) : !cute.int_tuple<"16">
      cute.memref.store_vec %1653, %view_4344, row_major : !memref_rmem_f32_6
      %int_tuple_4355 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_4356 = cute.size(%int_tuple_4355) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_4357 = cute.get_leaves(%sz_4356) : !cute.int_tuple<"16">
      %coord_4358 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_4359 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4360 = cute.crd2idx(%coord_4358, %lay_4359) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_4361 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4362 = cute.add_offset(%iter_4361, %idx_4360) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4363 = cute.make_view(%tup_4362) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4364 = cute.get_iter(%view_4363) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4365, %e1_4366, %e2_4367, %e3_4368 = cute.get_leaves(%iter_4364) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1656 = cute.get_scalars(%e0_4365) : !cute.int_tuple<"?">
      %1657 = cute.get_scalars(%e1_4366) : !cute.int_tuple<"?">
      %1658 = cute.get_scalars(%e2_4367) : !cute.int_tuple<"?">
      %1659 = cute.get_scalars(%e3_4368) : !cute.int_tuple<"?{div=2}">
      %iter_4369 = cute.get_iter(%view_4363) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4370, %e1_4371, %e2_4372, %e3_4373 = cute.get_leaves(%iter_4369) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1660 = cute.get_scalars(%e0_4370) : !cute.int_tuple<"?">
      %1661 = cute.get_scalars(%e1_4371) : !cute.int_tuple<"?">
      %1662 = cute.get_scalars(%e2_4372) : !cute.int_tuple<"?">
      %1663 = cute.get_scalars(%e3_4373) : !cute.int_tuple<"?{div=2}">
      %iter_4374 = cute.get_iter(%view_4363) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4375, %e1_4376, %e2_4377, %e3_4378 = cute.get_leaves(%iter_4374) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1664 = cute.get_scalars(%e0_4375) : !cute.int_tuple<"?">
      %1665 = cute.get_scalars(%e1_4376) : !cute.int_tuple<"?">
      %1666 = cute.get_scalars(%e2_4377) : !cute.int_tuple<"?">
      %1667 = cute.get_scalars(%e3_4378) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4379 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4380 = cute.add_offset(%e3_4378, %int_tuple_4379) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1668 = cute.get_scalars(%tup_4380) : !cute.int_tuple<"?">
      %coord_4381 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4382 = cute.make_coord(%tup_4380) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1669 = cute.get_scalars(%coord_4381) : !cute.coord<"?">
      %1670 = cute.get_scalars(%coord_4382) : !cute.coord<"?">
      %true_4383 = arith.constant true
      %1671 = arith.cmpi slt, %1669, %1670 : i32
      %1672 = arith.andi %true_4383, %1671 : i1
      %lay_4384 = cute.get_layout(%1638) : !memref_rmem_f32_4
      %1673 = cute.get_shape(%lay_4384) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4385, %e1_4386, %e2_4387, %e3_4388 = cute.get_leaves(%1673) : !cute.shape<"((2,2),(2,8))">
      %1674 = cute.get_stride(%lay_4384) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4389, %e1_4390, %e2_4391, %e3_4392 = cute.get_leaves(%1674) : !cute.stride<"((2,4),(1,8))">
      %1675 = scf.if %1672 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1638) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,0)">
        cute.memref.store(%1638, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,0)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1638) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1638 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1638) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1638) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1638 : !memref_rmem_f32_4
      }
      %iter_4393 = cute.get_iter(%1675) : !memref_rmem_f32_4
      %lay_4394 = cute.get_layout(%1675) : !memref_rmem_f32_4
      %1676 = cute.get_shape(%lay_4394) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4395, %e1_4396, %e2_4397, %e3_4398 = cute.get_leaves(%1676) : !cute.shape<"((2,2),(2,8))">
      %1677 = cute.get_stride(%lay_4394) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4399, %e1_4400, %e2_4401, %e3_4402 = cute.get_leaves(%1677) : !cute.stride<"((2,4),(1,8))">
      %iter_4403 = cute.get_iter(%1675) : !memref_rmem_f32_4
      %iter_4404 = cute.get_iter(%1675) : !memref_rmem_f32_4
      %coord_4405 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_4406 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4407 = cute.crd2idx(%coord_4405, %lay_4406) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_4408 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4409 = cute.add_offset(%iter_4408, %idx_4407) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4410 = cute.make_view(%tup_4409) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4411 = cute.get_iter(%view_4410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4412, %e1_4413, %e2_4414, %e3_4415 = cute.get_leaves(%iter_4411) : !cute.int_tuple<"(?,?,?,?)">
      %1678 = cute.get_scalars(%e0_4412) : !cute.int_tuple<"?">
      %1679 = cute.get_scalars(%e1_4413) : !cute.int_tuple<"?">
      %1680 = cute.get_scalars(%e2_4414) : !cute.int_tuple<"?">
      %1681 = cute.get_scalars(%e3_4415) : !cute.int_tuple<"?">
      %iter_4416 = cute.get_iter(%view_4410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4417, %e1_4418, %e2_4419, %e3_4420 = cute.get_leaves(%iter_4416) : !cute.int_tuple<"(?,?,?,?)">
      %1682 = cute.get_scalars(%e0_4417) : !cute.int_tuple<"?">
      %1683 = cute.get_scalars(%e1_4418) : !cute.int_tuple<"?">
      %1684 = cute.get_scalars(%e2_4419) : !cute.int_tuple<"?">
      %1685 = cute.get_scalars(%e3_4420) : !cute.int_tuple<"?">
      %iter_4421 = cute.get_iter(%view_4410) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4422, %e1_4423, %e2_4424, %e3_4425 = cute.get_leaves(%iter_4421) : !cute.int_tuple<"(?,?,?,?)">
      %1686 = cute.get_scalars(%e0_4422) : !cute.int_tuple<"?">
      %1687 = cute.get_scalars(%e1_4423) : !cute.int_tuple<"?">
      %1688 = cute.get_scalars(%e2_4424) : !cute.int_tuple<"?">
      %1689 = cute.get_scalars(%e3_4425) : !cute.int_tuple<"?">
      %int_tuple_4426 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4427 = cute.add_offset(%e3_4425, %int_tuple_4426) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1690 = cute.get_scalars(%tup_4427) : !cute.int_tuple<"?">
      %coord_4428 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4429 = cute.make_coord(%tup_4427) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1691 = cute.get_scalars(%coord_4428) : !cute.coord<"?">
      %1692 = cute.get_scalars(%coord_4429) : !cute.coord<"?">
      %true_4430 = arith.constant true
      %1693 = arith.cmpi slt, %1691, %1692 : i32
      %1694 = arith.andi %true_4430, %1693 : i1
      %lay_4431 = cute.get_layout(%1675) : !memref_rmem_f32_4
      %1695 = cute.get_shape(%lay_4431) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4432, %e1_4433, %e2_4434, %e3_4435 = cute.get_leaves(%1695) : !cute.shape<"((2,2),(2,8))">
      %1696 = cute.get_stride(%lay_4431) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4436, %e1_4437, %e2_4438, %e3_4439 = cute.get_leaves(%1696) : !cute.stride<"((2,4),(1,8))">
      %1697 = scf.if %1694 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1675) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,1)">
        cute.memref.store(%1675, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,1)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1675) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1675 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1675) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1675) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1675 : !memref_rmem_f32_4
      }
      %iter_4440 = cute.get_iter(%1697) : !memref_rmem_f32_4
      %lay_4441 = cute.get_layout(%1697) : !memref_rmem_f32_4
      %1698 = cute.get_shape(%lay_4441) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4442, %e1_4443, %e2_4444, %e3_4445 = cute.get_leaves(%1698) : !cute.shape<"((2,2),(2,8))">
      %1699 = cute.get_stride(%lay_4441) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4446, %e1_4447, %e2_4448, %e3_4449 = cute.get_leaves(%1699) : !cute.stride<"((2,4),(1,8))">
      %iter_4450 = cute.get_iter(%1697) : !memref_rmem_f32_4
      %iter_4451 = cute.get_iter(%1697) : !memref_rmem_f32_4
      %coord_4452 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_4453 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4454 = cute.crd2idx(%coord_4452, %lay_4453) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_4455 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4456 = cute.add_offset(%iter_4455, %idx_4454) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4457 = cute.make_view(%tup_4456) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4458 = cute.get_iter(%view_4457) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4459, %e1_4460, %e2_4461, %e3_4462 = cute.get_leaves(%iter_4458) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1700 = cute.get_scalars(%e0_4459) : !cute.int_tuple<"?">
      %1701 = cute.get_scalars(%e1_4460) : !cute.int_tuple<"?">
      %1702 = cute.get_scalars(%e2_4461) : !cute.int_tuple<"?">
      %1703 = cute.get_scalars(%e3_4462) : !cute.int_tuple<"?{div=2}">
      %iter_4463 = cute.get_iter(%view_4457) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4464, %e1_4465, %e2_4466, %e3_4467 = cute.get_leaves(%iter_4463) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1704 = cute.get_scalars(%e0_4464) : !cute.int_tuple<"?">
      %1705 = cute.get_scalars(%e1_4465) : !cute.int_tuple<"?">
      %1706 = cute.get_scalars(%e2_4466) : !cute.int_tuple<"?">
      %1707 = cute.get_scalars(%e3_4467) : !cute.int_tuple<"?{div=2}">
      %iter_4468 = cute.get_iter(%view_4457) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4469, %e1_4470, %e2_4471, %e3_4472 = cute.get_leaves(%iter_4468) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1708 = cute.get_scalars(%e0_4469) : !cute.int_tuple<"?">
      %1709 = cute.get_scalars(%e1_4470) : !cute.int_tuple<"?">
      %1710 = cute.get_scalars(%e2_4471) : !cute.int_tuple<"?">
      %1711 = cute.get_scalars(%e3_4472) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4473 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4474 = cute.add_offset(%e3_4472, %int_tuple_4473) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1712 = cute.get_scalars(%tup_4474) : !cute.int_tuple<"?">
      %coord_4475 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4476 = cute.make_coord(%tup_4474) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1713 = cute.get_scalars(%coord_4475) : !cute.coord<"?">
      %1714 = cute.get_scalars(%coord_4476) : !cute.coord<"?">
      %true_4477 = arith.constant true
      %1715 = arith.cmpi slt, %1713, %1714 : i32
      %1716 = arith.andi %true_4477, %1715 : i1
      %lay_4478 = cute.get_layout(%1697) : !memref_rmem_f32_4
      %1717 = cute.get_shape(%lay_4478) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4479, %e1_4480, %e2_4481, %e3_4482 = cute.get_leaves(%1717) : !cute.shape<"((2,2),(2,8))">
      %1718 = cute.get_stride(%lay_4478) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4483, %e1_4484, %e2_4485, %e3_4486 = cute.get_leaves(%1718) : !cute.stride<"((2,4),(1,8))">
      %1719 = scf.if %1716 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1697) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,2)">
        cute.memref.store(%1697, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,2)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1697) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1697 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1697) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1697) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1697 : !memref_rmem_f32_4
      }
      %iter_4487 = cute.get_iter(%1719) : !memref_rmem_f32_4
      %lay_4488 = cute.get_layout(%1719) : !memref_rmem_f32_4
      %1720 = cute.get_shape(%lay_4488) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4489, %e1_4490, %e2_4491, %e3_4492 = cute.get_leaves(%1720) : !cute.shape<"((2,2),(2,8))">
      %1721 = cute.get_stride(%lay_4488) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4493, %e1_4494, %e2_4495, %e3_4496 = cute.get_leaves(%1721) : !cute.stride<"((2,4),(1,8))">
      %iter_4497 = cute.get_iter(%1719) : !memref_rmem_f32_4
      %iter_4498 = cute.get_iter(%1719) : !memref_rmem_f32_4
      %coord_4499 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_4500 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4501 = cute.crd2idx(%coord_4499, %lay_4500) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_4502 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4503 = cute.add_offset(%iter_4502, %idx_4501) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4504 = cute.make_view(%tup_4503) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4505 = cute.get_iter(%view_4504) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4506, %e1_4507, %e2_4508, %e3_4509 = cute.get_leaves(%iter_4505) : !cute.int_tuple<"(?,?,?,?)">
      %1722 = cute.get_scalars(%e0_4506) : !cute.int_tuple<"?">
      %1723 = cute.get_scalars(%e1_4507) : !cute.int_tuple<"?">
      %1724 = cute.get_scalars(%e2_4508) : !cute.int_tuple<"?">
      %1725 = cute.get_scalars(%e3_4509) : !cute.int_tuple<"?">
      %iter_4510 = cute.get_iter(%view_4504) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4511, %e1_4512, %e2_4513, %e3_4514 = cute.get_leaves(%iter_4510) : !cute.int_tuple<"(?,?,?,?)">
      %1726 = cute.get_scalars(%e0_4511) : !cute.int_tuple<"?">
      %1727 = cute.get_scalars(%e1_4512) : !cute.int_tuple<"?">
      %1728 = cute.get_scalars(%e2_4513) : !cute.int_tuple<"?">
      %1729 = cute.get_scalars(%e3_4514) : !cute.int_tuple<"?">
      %iter_4515 = cute.get_iter(%view_4504) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4516, %e1_4517, %e2_4518, %e3_4519 = cute.get_leaves(%iter_4515) : !cute.int_tuple<"(?,?,?,?)">
      %1730 = cute.get_scalars(%e0_4516) : !cute.int_tuple<"?">
      %1731 = cute.get_scalars(%e1_4517) : !cute.int_tuple<"?">
      %1732 = cute.get_scalars(%e2_4518) : !cute.int_tuple<"?">
      %1733 = cute.get_scalars(%e3_4519) : !cute.int_tuple<"?">
      %int_tuple_4520 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4521 = cute.add_offset(%e3_4519, %int_tuple_4520) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1734 = cute.get_scalars(%tup_4521) : !cute.int_tuple<"?">
      %coord_4522 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4523 = cute.make_coord(%tup_4521) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1735 = cute.get_scalars(%coord_4522) : !cute.coord<"?">
      %1736 = cute.get_scalars(%coord_4523) : !cute.coord<"?">
      %true_4524 = arith.constant true
      %1737 = arith.cmpi slt, %1735, %1736 : i32
      %1738 = arith.andi %true_4524, %1737 : i1
      %lay_4525 = cute.get_layout(%1719) : !memref_rmem_f32_4
      %1739 = cute.get_shape(%lay_4525) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4526, %e1_4527, %e2_4528, %e3_4529 = cute.get_leaves(%1739) : !cute.shape<"((2,2),(2,8))">
      %1740 = cute.get_stride(%lay_4525) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4530, %e1_4531, %e2_4532, %e3_4533 = cute.get_leaves(%1740) : !cute.stride<"((2,4),(1,8))">
      %1741 = scf.if %1738 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1719) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,3)">
        cute.memref.store(%1719, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,3)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1719) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1719 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1719) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1719) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1719 : !memref_rmem_f32_4
      }
      %iter_4534 = cute.get_iter(%1741) : !memref_rmem_f32_4
      %lay_4535 = cute.get_layout(%1741) : !memref_rmem_f32_4
      %1742 = cute.get_shape(%lay_4535) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4536, %e1_4537, %e2_4538, %e3_4539 = cute.get_leaves(%1742) : !cute.shape<"((2,2),(2,8))">
      %1743 = cute.get_stride(%lay_4535) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4540, %e1_4541, %e2_4542, %e3_4543 = cute.get_leaves(%1743) : !cute.stride<"((2,4),(1,8))">
      %iter_4544 = cute.get_iter(%1741) : !memref_rmem_f32_4
      %iter_4545 = cute.get_iter(%1741) : !memref_rmem_f32_4
      %coord_4546 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_4547 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4548 = cute.crd2idx(%coord_4546, %lay_4547) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_4549 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4550 = cute.add_offset(%iter_4549, %idx_4548) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4551 = cute.make_view(%tup_4550) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4552 = cute.get_iter(%view_4551) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4553, %e1_4554, %e2_4555, %e3_4556 = cute.get_leaves(%iter_4552) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1744 = cute.get_scalars(%e0_4553) : !cute.int_tuple<"?">
      %1745 = cute.get_scalars(%e1_4554) : !cute.int_tuple<"?">
      %1746 = cute.get_scalars(%e2_4555) : !cute.int_tuple<"?">
      %1747 = cute.get_scalars(%e3_4556) : !cute.int_tuple<"?{div=2}">
      %iter_4557 = cute.get_iter(%view_4551) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4558, %e1_4559, %e2_4560, %e3_4561 = cute.get_leaves(%iter_4557) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1748 = cute.get_scalars(%e0_4558) : !cute.int_tuple<"?">
      %1749 = cute.get_scalars(%e1_4559) : !cute.int_tuple<"?">
      %1750 = cute.get_scalars(%e2_4560) : !cute.int_tuple<"?">
      %1751 = cute.get_scalars(%e3_4561) : !cute.int_tuple<"?{div=2}">
      %iter_4562 = cute.get_iter(%view_4551) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4563, %e1_4564, %e2_4565, %e3_4566 = cute.get_leaves(%iter_4562) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1752 = cute.get_scalars(%e0_4563) : !cute.int_tuple<"?">
      %1753 = cute.get_scalars(%e1_4564) : !cute.int_tuple<"?">
      %1754 = cute.get_scalars(%e2_4565) : !cute.int_tuple<"?">
      %1755 = cute.get_scalars(%e3_4566) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4567 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4568 = cute.add_offset(%e3_4566, %int_tuple_4567) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1756 = cute.get_scalars(%tup_4568) : !cute.int_tuple<"?">
      %coord_4569 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4570 = cute.make_coord(%tup_4568) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1757 = cute.get_scalars(%coord_4569) : !cute.coord<"?">
      %1758 = cute.get_scalars(%coord_4570) : !cute.coord<"?">
      %true_4571 = arith.constant true
      %1759 = arith.cmpi slt, %1757, %1758 : i32
      %1760 = arith.andi %true_4571, %1759 : i1
      %lay_4572 = cute.get_layout(%1741) : !memref_rmem_f32_4
      %1761 = cute.get_shape(%lay_4572) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4573, %e1_4574, %e2_4575, %e3_4576 = cute.get_leaves(%1761) : !cute.shape<"((2,2),(2,8))">
      %1762 = cute.get_stride(%lay_4572) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4577, %e1_4578, %e2_4579, %e3_4580 = cute.get_leaves(%1762) : !cute.stride<"((2,4),(1,8))">
      %1763 = scf.if %1760 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1741) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,4)">
        cute.memref.store(%1741, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,4)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1741) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1741 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1741) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1741) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1741 : !memref_rmem_f32_4
      }
      %iter_4581 = cute.get_iter(%1763) : !memref_rmem_f32_4
      %lay_4582 = cute.get_layout(%1763) : !memref_rmem_f32_4
      %1764 = cute.get_shape(%lay_4582) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4583, %e1_4584, %e2_4585, %e3_4586 = cute.get_leaves(%1764) : !cute.shape<"((2,2),(2,8))">
      %1765 = cute.get_stride(%lay_4582) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4587, %e1_4588, %e2_4589, %e3_4590 = cute.get_leaves(%1765) : !cute.stride<"((2,4),(1,8))">
      %iter_4591 = cute.get_iter(%1763) : !memref_rmem_f32_4
      %iter_4592 = cute.get_iter(%1763) : !memref_rmem_f32_4
      %coord_4593 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4594 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4595 = cute.crd2idx(%coord_4593, %lay_4594) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4596 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4597 = cute.add_offset(%iter_4596, %idx_4595) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4598 = cute.make_view(%tup_4597) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4599 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4600, %e1_4601, %e2_4602, %e3_4603 = cute.get_leaves(%iter_4599) : !cute.int_tuple<"(?,?,?,?)">
      %1766 = cute.get_scalars(%e0_4600) : !cute.int_tuple<"?">
      %1767 = cute.get_scalars(%e1_4601) : !cute.int_tuple<"?">
      %1768 = cute.get_scalars(%e2_4602) : !cute.int_tuple<"?">
      %1769 = cute.get_scalars(%e3_4603) : !cute.int_tuple<"?">
      %iter_4604 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4605, %e1_4606, %e2_4607, %e3_4608 = cute.get_leaves(%iter_4604) : !cute.int_tuple<"(?,?,?,?)">
      %1770 = cute.get_scalars(%e0_4605) : !cute.int_tuple<"?">
      %1771 = cute.get_scalars(%e1_4606) : !cute.int_tuple<"?">
      %1772 = cute.get_scalars(%e2_4607) : !cute.int_tuple<"?">
      %1773 = cute.get_scalars(%e3_4608) : !cute.int_tuple<"?">
      %iter_4609 = cute.get_iter(%view_4598) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4610, %e1_4611, %e2_4612, %e3_4613 = cute.get_leaves(%iter_4609) : !cute.int_tuple<"(?,?,?,?)">
      %1774 = cute.get_scalars(%e0_4610) : !cute.int_tuple<"?">
      %1775 = cute.get_scalars(%e1_4611) : !cute.int_tuple<"?">
      %1776 = cute.get_scalars(%e2_4612) : !cute.int_tuple<"?">
      %1777 = cute.get_scalars(%e3_4613) : !cute.int_tuple<"?">
      %int_tuple_4614 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4615 = cute.add_offset(%e3_4613, %int_tuple_4614) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1778 = cute.get_scalars(%tup_4615) : !cute.int_tuple<"?">
      %coord_4616 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4617 = cute.make_coord(%tup_4615) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1779 = cute.get_scalars(%coord_4616) : !cute.coord<"?">
      %1780 = cute.get_scalars(%coord_4617) : !cute.coord<"?">
      %true_4618 = arith.constant true
      %1781 = arith.cmpi slt, %1779, %1780 : i32
      %1782 = arith.andi %true_4618, %1781 : i1
      %lay_4619 = cute.get_layout(%1763) : !memref_rmem_f32_4
      %1783 = cute.get_shape(%lay_4619) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4620, %e1_4621, %e2_4622, %e3_4623 = cute.get_leaves(%1783) : !cute.shape<"((2,2),(2,8))">
      %1784 = cute.get_stride(%lay_4619) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4624, %e1_4625, %e2_4626, %e3_4627 = cute.get_leaves(%1784) : !cute.stride<"((2,4),(1,8))">
      %1785 = scf.if %1782 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1763) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,5)">
        cute.memref.store(%1763, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,5)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1763) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1763 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1763) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1763) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1763 : !memref_rmem_f32_4
      }
      %iter_4628 = cute.get_iter(%1785) : !memref_rmem_f32_4
      %lay_4629 = cute.get_layout(%1785) : !memref_rmem_f32_4
      %1786 = cute.get_shape(%lay_4629) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4630, %e1_4631, %e2_4632, %e3_4633 = cute.get_leaves(%1786) : !cute.shape<"((2,2),(2,8))">
      %1787 = cute.get_stride(%lay_4629) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4634, %e1_4635, %e2_4636, %e3_4637 = cute.get_leaves(%1787) : !cute.stride<"((2,4),(1,8))">
      %iter_4638 = cute.get_iter(%1785) : !memref_rmem_f32_4
      %iter_4639 = cute.get_iter(%1785) : !memref_rmem_f32_4
      %coord_4640 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4641 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4642 = cute.crd2idx(%coord_4640, %lay_4641) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4643 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4644 = cute.add_offset(%iter_4643, %idx_4642) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4645 = cute.make_view(%tup_4644) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4646 = cute.get_iter(%view_4645) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4647, %e1_4648, %e2_4649, %e3_4650 = cute.get_leaves(%iter_4646) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1788 = cute.get_scalars(%e0_4647) : !cute.int_tuple<"?">
      %1789 = cute.get_scalars(%e1_4648) : !cute.int_tuple<"?">
      %1790 = cute.get_scalars(%e2_4649) : !cute.int_tuple<"?">
      %1791 = cute.get_scalars(%e3_4650) : !cute.int_tuple<"?{div=2}">
      %iter_4651 = cute.get_iter(%view_4645) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4652, %e1_4653, %e2_4654, %e3_4655 = cute.get_leaves(%iter_4651) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1792 = cute.get_scalars(%e0_4652) : !cute.int_tuple<"?">
      %1793 = cute.get_scalars(%e1_4653) : !cute.int_tuple<"?">
      %1794 = cute.get_scalars(%e2_4654) : !cute.int_tuple<"?">
      %1795 = cute.get_scalars(%e3_4655) : !cute.int_tuple<"?{div=2}">
      %iter_4656 = cute.get_iter(%view_4645) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4657, %e1_4658, %e2_4659, %e3_4660 = cute.get_leaves(%iter_4656) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1796 = cute.get_scalars(%e0_4657) : !cute.int_tuple<"?">
      %1797 = cute.get_scalars(%e1_4658) : !cute.int_tuple<"?">
      %1798 = cute.get_scalars(%e2_4659) : !cute.int_tuple<"?">
      %1799 = cute.get_scalars(%e3_4660) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4661 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4662 = cute.add_offset(%e3_4660, %int_tuple_4661) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1800 = cute.get_scalars(%tup_4662) : !cute.int_tuple<"?">
      %coord_4663 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4664 = cute.make_coord(%tup_4662) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1801 = cute.get_scalars(%coord_4663) : !cute.coord<"?">
      %1802 = cute.get_scalars(%coord_4664) : !cute.coord<"?">
      %true_4665 = arith.constant true
      %1803 = arith.cmpi slt, %1801, %1802 : i32
      %1804 = arith.andi %true_4665, %1803 : i1
      %lay_4666 = cute.get_layout(%1785) : !memref_rmem_f32_4
      %1805 = cute.get_shape(%lay_4666) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4667, %e1_4668, %e2_4669, %e3_4670 = cute.get_leaves(%1805) : !cute.shape<"((2,2),(2,8))">
      %1806 = cute.get_stride(%lay_4666) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4671, %e1_4672, %e2_4673, %e3_4674 = cute.get_leaves(%1806) : !cute.stride<"((2,4),(1,8))">
      %1807 = scf.if %1804 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1785) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,6)">
        cute.memref.store(%1785, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,6)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1785) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1785 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1785) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1785) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1785 : !memref_rmem_f32_4
      }
      %iter_4675 = cute.get_iter(%1807) : !memref_rmem_f32_4
      %lay_4676 = cute.get_layout(%1807) : !memref_rmem_f32_4
      %1808 = cute.get_shape(%lay_4676) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4677, %e1_4678, %e2_4679, %e3_4680 = cute.get_leaves(%1808) : !cute.shape<"((2,2),(2,8))">
      %1809 = cute.get_stride(%lay_4676) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4681, %e1_4682, %e2_4683, %e3_4684 = cute.get_leaves(%1809) : !cute.stride<"((2,4),(1,8))">
      %iter_4685 = cute.get_iter(%1807) : !memref_rmem_f32_4
      %iter_4686 = cute.get_iter(%1807) : !memref_rmem_f32_4
      %coord_4687 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4688 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4689 = cute.crd2idx(%coord_4687, %lay_4688) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4690 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4691 = cute.add_offset(%iter_4690, %idx_4689) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4692 = cute.make_view(%tup_4691) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4693 = cute.get_iter(%view_4692) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4694, %e1_4695, %e2_4696, %e3_4697 = cute.get_leaves(%iter_4693) : !cute.int_tuple<"(?,?,?,?)">
      %1810 = cute.get_scalars(%e0_4694) : !cute.int_tuple<"?">
      %1811 = cute.get_scalars(%e1_4695) : !cute.int_tuple<"?">
      %1812 = cute.get_scalars(%e2_4696) : !cute.int_tuple<"?">
      %1813 = cute.get_scalars(%e3_4697) : !cute.int_tuple<"?">
      %iter_4698 = cute.get_iter(%view_4692) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4699, %e1_4700, %e2_4701, %e3_4702 = cute.get_leaves(%iter_4698) : !cute.int_tuple<"(?,?,?,?)">
      %1814 = cute.get_scalars(%e0_4699) : !cute.int_tuple<"?">
      %1815 = cute.get_scalars(%e1_4700) : !cute.int_tuple<"?">
      %1816 = cute.get_scalars(%e2_4701) : !cute.int_tuple<"?">
      %1817 = cute.get_scalars(%e3_4702) : !cute.int_tuple<"?">
      %iter_4703 = cute.get_iter(%view_4692) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4704, %e1_4705, %e2_4706, %e3_4707 = cute.get_leaves(%iter_4703) : !cute.int_tuple<"(?,?,?,?)">
      %1818 = cute.get_scalars(%e0_4704) : !cute.int_tuple<"?">
      %1819 = cute.get_scalars(%e1_4705) : !cute.int_tuple<"?">
      %1820 = cute.get_scalars(%e2_4706) : !cute.int_tuple<"?">
      %1821 = cute.get_scalars(%e3_4707) : !cute.int_tuple<"?">
      %int_tuple_4708 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4709 = cute.add_offset(%e3_4707, %int_tuple_4708) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1822 = cute.get_scalars(%tup_4709) : !cute.int_tuple<"?">
      %coord_4710 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4711 = cute.make_coord(%tup_4709) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1823 = cute.get_scalars(%coord_4710) : !cute.coord<"?">
      %1824 = cute.get_scalars(%coord_4711) : !cute.coord<"?">
      %true_4712 = arith.constant true
      %1825 = arith.cmpi slt, %1823, %1824 : i32
      %1826 = arith.andi %true_4712, %1825 : i1
      %lay_4713 = cute.get_layout(%1807) : !memref_rmem_f32_4
      %1827 = cute.get_shape(%lay_4713) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4714, %e1_4715, %e2_4716, %e3_4717 = cute.get_leaves(%1827) : !cute.shape<"((2,2),(2,8))">
      %1828 = cute.get_stride(%lay_4713) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4718, %e1_4719, %e2_4720, %e3_4721 = cute.get_leaves(%1828) : !cute.stride<"((2,4),(1,8))">
      %1829 = scf.if %1826 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1807) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,7)">
        cute.memref.store(%1807, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,7)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1807) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1807 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1807) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1807) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1807 : !memref_rmem_f32_4
      }
      %iter_4722 = cute.get_iter(%1829) : !memref_rmem_f32_4
      %lay_4723 = cute.get_layout(%1829) : !memref_rmem_f32_4
      %1830 = cute.get_shape(%lay_4723) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4724, %e1_4725, %e2_4726, %e3_4727 = cute.get_leaves(%1830) : !cute.shape<"((2,2),(2,8))">
      %1831 = cute.get_stride(%lay_4723) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4728, %e1_4729, %e2_4730, %e3_4731 = cute.get_leaves(%1831) : !cute.stride<"((2,4),(1,8))">
      %iter_4732 = cute.get_iter(%1829) : !memref_rmem_f32_4
      %iter_4733 = cute.get_iter(%1829) : !memref_rmem_f32_4
      %coord_4734 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4735 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4736 = cute.crd2idx(%coord_4734, %lay_4735) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4737 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4738 = cute.add_offset(%iter_4737, %idx_4736) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4739 = cute.make_view(%tup_4738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4740 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4741, %e1_4742, %e2_4743, %e3_4744 = cute.get_leaves(%iter_4740) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1832 = cute.get_scalars(%e0_4741) : !cute.int_tuple<"?">
      %1833 = cute.get_scalars(%e1_4742) : !cute.int_tuple<"?">
      %1834 = cute.get_scalars(%e2_4743) : !cute.int_tuple<"?">
      %1835 = cute.get_scalars(%e3_4744) : !cute.int_tuple<"?{div=2}">
      %iter_4745 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4746, %e1_4747, %e2_4748, %e3_4749 = cute.get_leaves(%iter_4745) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1836 = cute.get_scalars(%e0_4746) : !cute.int_tuple<"?">
      %1837 = cute.get_scalars(%e1_4747) : !cute.int_tuple<"?">
      %1838 = cute.get_scalars(%e2_4748) : !cute.int_tuple<"?">
      %1839 = cute.get_scalars(%e3_4749) : !cute.int_tuple<"?{div=2}">
      %iter_4750 = cute.get_iter(%view_4739) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4751, %e1_4752, %e2_4753, %e3_4754 = cute.get_leaves(%iter_4750) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1840 = cute.get_scalars(%e0_4751) : !cute.int_tuple<"?">
      %1841 = cute.get_scalars(%e1_4752) : !cute.int_tuple<"?">
      %1842 = cute.get_scalars(%e2_4753) : !cute.int_tuple<"?">
      %1843 = cute.get_scalars(%e3_4754) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4755 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4756 = cute.add_offset(%e3_4754, %int_tuple_4755) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1844 = cute.get_scalars(%tup_4756) : !cute.int_tuple<"?">
      %coord_4757 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4758 = cute.make_coord(%tup_4756) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1845 = cute.get_scalars(%coord_4757) : !cute.coord<"?">
      %1846 = cute.get_scalars(%coord_4758) : !cute.coord<"?">
      %true_4759 = arith.constant true
      %1847 = arith.cmpi slt, %1845, %1846 : i32
      %1848 = arith.andi %true_4759, %1847 : i1
      %lay_4760 = cute.get_layout(%1829) : !memref_rmem_f32_4
      %1849 = cute.get_shape(%lay_4760) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4761, %e1_4762, %e2_4763, %e3_4764 = cute.get_leaves(%1849) : !cute.shape<"((2,2),(2,8))">
      %1850 = cute.get_stride(%lay_4760) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4765, %e1_4766, %e2_4767, %e3_4768 = cute.get_leaves(%1850) : !cute.stride<"((2,4),(1,8))">
      %1851 = scf.if %1848 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1829) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,8)">
        cute.memref.store(%1829, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,8)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1829) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1829 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1829) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1829) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1829 : !memref_rmem_f32_4
      }
      %iter_4769 = cute.get_iter(%1851) : !memref_rmem_f32_4
      %lay_4770 = cute.get_layout(%1851) : !memref_rmem_f32_4
      %1852 = cute.get_shape(%lay_4770) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4771, %e1_4772, %e2_4773, %e3_4774 = cute.get_leaves(%1852) : !cute.shape<"((2,2),(2,8))">
      %1853 = cute.get_stride(%lay_4770) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4775, %e1_4776, %e2_4777, %e3_4778 = cute.get_leaves(%1853) : !cute.stride<"((2,4),(1,8))">
      %iter_4779 = cute.get_iter(%1851) : !memref_rmem_f32_4
      %iter_4780 = cute.get_iter(%1851) : !memref_rmem_f32_4
      %coord_4781 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4782 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4783 = cute.crd2idx(%coord_4781, %lay_4782) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4784 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4785 = cute.add_offset(%iter_4784, %idx_4783) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4786 = cute.make_view(%tup_4785) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4787 = cute.get_iter(%view_4786) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4788, %e1_4789, %e2_4790, %e3_4791 = cute.get_leaves(%iter_4787) : !cute.int_tuple<"(?,?,?,?)">
      %1854 = cute.get_scalars(%e0_4788) : !cute.int_tuple<"?">
      %1855 = cute.get_scalars(%e1_4789) : !cute.int_tuple<"?">
      %1856 = cute.get_scalars(%e2_4790) : !cute.int_tuple<"?">
      %1857 = cute.get_scalars(%e3_4791) : !cute.int_tuple<"?">
      %iter_4792 = cute.get_iter(%view_4786) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4793, %e1_4794, %e2_4795, %e3_4796 = cute.get_leaves(%iter_4792) : !cute.int_tuple<"(?,?,?,?)">
      %1858 = cute.get_scalars(%e0_4793) : !cute.int_tuple<"?">
      %1859 = cute.get_scalars(%e1_4794) : !cute.int_tuple<"?">
      %1860 = cute.get_scalars(%e2_4795) : !cute.int_tuple<"?">
      %1861 = cute.get_scalars(%e3_4796) : !cute.int_tuple<"?">
      %iter_4797 = cute.get_iter(%view_4786) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4798, %e1_4799, %e2_4800, %e3_4801 = cute.get_leaves(%iter_4797) : !cute.int_tuple<"(?,?,?,?)">
      %1862 = cute.get_scalars(%e0_4798) : !cute.int_tuple<"?">
      %1863 = cute.get_scalars(%e1_4799) : !cute.int_tuple<"?">
      %1864 = cute.get_scalars(%e2_4800) : !cute.int_tuple<"?">
      %1865 = cute.get_scalars(%e3_4801) : !cute.int_tuple<"?">
      %int_tuple_4802 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4803 = cute.add_offset(%e3_4801, %int_tuple_4802) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1866 = cute.get_scalars(%tup_4803) : !cute.int_tuple<"?">
      %coord_4804 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4805 = cute.make_coord(%tup_4803) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1867 = cute.get_scalars(%coord_4804) : !cute.coord<"?">
      %1868 = cute.get_scalars(%coord_4805) : !cute.coord<"?">
      %true_4806 = arith.constant true
      %1869 = arith.cmpi slt, %1867, %1868 : i32
      %1870 = arith.andi %true_4806, %1869 : i1
      %lay_4807 = cute.get_layout(%1851) : !memref_rmem_f32_4
      %1871 = cute.get_shape(%lay_4807) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4808, %e1_4809, %e2_4810, %e3_4811 = cute.get_leaves(%1871) : !cute.shape<"((2,2),(2,8))">
      %1872 = cute.get_stride(%lay_4807) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4812, %e1_4813, %e2_4814, %e3_4815 = cute.get_leaves(%1872) : !cute.stride<"((2,4),(1,8))">
      %1873 = scf.if %1870 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1851) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,9)">
        cute.memref.store(%1851, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,9)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1851) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1851 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1851) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1851) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1851 : !memref_rmem_f32_4
      }
      %iter_4816 = cute.get_iter(%1873) : !memref_rmem_f32_4
      %lay_4817 = cute.get_layout(%1873) : !memref_rmem_f32_4
      %1874 = cute.get_shape(%lay_4817) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4818, %e1_4819, %e2_4820, %e3_4821 = cute.get_leaves(%1874) : !cute.shape<"((2,2),(2,8))">
      %1875 = cute.get_stride(%lay_4817) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4822, %e1_4823, %e2_4824, %e3_4825 = cute.get_leaves(%1875) : !cute.stride<"((2,4),(1,8))">
      %iter_4826 = cute.get_iter(%1873) : !memref_rmem_f32_4
      %iter_4827 = cute.get_iter(%1873) : !memref_rmem_f32_4
      %coord_4828 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4829 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4830 = cute.crd2idx(%coord_4828, %lay_4829) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4831 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4832 = cute.add_offset(%iter_4831, %idx_4830) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4833 = cute.make_view(%tup_4832) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4834 = cute.get_iter(%view_4833) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4835, %e1_4836, %e2_4837, %e3_4838 = cute.get_leaves(%iter_4834) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1876 = cute.get_scalars(%e0_4835) : !cute.int_tuple<"?">
      %1877 = cute.get_scalars(%e1_4836) : !cute.int_tuple<"?">
      %1878 = cute.get_scalars(%e2_4837) : !cute.int_tuple<"?">
      %1879 = cute.get_scalars(%e3_4838) : !cute.int_tuple<"?{div=2}">
      %iter_4839 = cute.get_iter(%view_4833) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4840, %e1_4841, %e2_4842, %e3_4843 = cute.get_leaves(%iter_4839) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1880 = cute.get_scalars(%e0_4840) : !cute.int_tuple<"?">
      %1881 = cute.get_scalars(%e1_4841) : !cute.int_tuple<"?">
      %1882 = cute.get_scalars(%e2_4842) : !cute.int_tuple<"?">
      %1883 = cute.get_scalars(%e3_4843) : !cute.int_tuple<"?{div=2}">
      %iter_4844 = cute.get_iter(%view_4833) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4845, %e1_4846, %e2_4847, %e3_4848 = cute.get_leaves(%iter_4844) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1884 = cute.get_scalars(%e0_4845) : !cute.int_tuple<"?">
      %1885 = cute.get_scalars(%e1_4846) : !cute.int_tuple<"?">
      %1886 = cute.get_scalars(%e2_4847) : !cute.int_tuple<"?">
      %1887 = cute.get_scalars(%e3_4848) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4849 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4850 = cute.add_offset(%e3_4848, %int_tuple_4849) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1888 = cute.get_scalars(%tup_4850) : !cute.int_tuple<"?">
      %coord_4851 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4852 = cute.make_coord(%tup_4850) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1889 = cute.get_scalars(%coord_4851) : !cute.coord<"?">
      %1890 = cute.get_scalars(%coord_4852) : !cute.coord<"?">
      %true_4853 = arith.constant true
      %1891 = arith.cmpi slt, %1889, %1890 : i32
      %1892 = arith.andi %true_4853, %1891 : i1
      %lay_4854 = cute.get_layout(%1873) : !memref_rmem_f32_4
      %1893 = cute.get_shape(%lay_4854) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4855, %e1_4856, %e2_4857, %e3_4858 = cute.get_leaves(%1893) : !cute.shape<"((2,2),(2,8))">
      %1894 = cute.get_stride(%lay_4854) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4859, %e1_4860, %e2_4861, %e3_4862 = cute.get_leaves(%1894) : !cute.stride<"((2,4),(1,8))">
      %1895 = scf.if %1892 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1873) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,10)">
        cute.memref.store(%1873, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,10)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1873) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1873 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1873) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1873) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1873 : !memref_rmem_f32_4
      }
      %iter_4863 = cute.get_iter(%1895) : !memref_rmem_f32_4
      %lay_4864 = cute.get_layout(%1895) : !memref_rmem_f32_4
      %1896 = cute.get_shape(%lay_4864) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4865, %e1_4866, %e2_4867, %e3_4868 = cute.get_leaves(%1896) : !cute.shape<"((2,2),(2,8))">
      %1897 = cute.get_stride(%lay_4864) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4869, %e1_4870, %e2_4871, %e3_4872 = cute.get_leaves(%1897) : !cute.stride<"((2,4),(1,8))">
      %iter_4873 = cute.get_iter(%1895) : !memref_rmem_f32_4
      %iter_4874 = cute.get_iter(%1895) : !memref_rmem_f32_4
      %coord_4875 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4876 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4877 = cute.crd2idx(%coord_4875, %lay_4876) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4878 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4879 = cute.add_offset(%iter_4878, %idx_4877) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4880 = cute.make_view(%tup_4879) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4881 = cute.get_iter(%view_4880) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4882, %e1_4883, %e2_4884, %e3_4885 = cute.get_leaves(%iter_4881) : !cute.int_tuple<"(?,?,?,?)">
      %1898 = cute.get_scalars(%e0_4882) : !cute.int_tuple<"?">
      %1899 = cute.get_scalars(%e1_4883) : !cute.int_tuple<"?">
      %1900 = cute.get_scalars(%e2_4884) : !cute.int_tuple<"?">
      %1901 = cute.get_scalars(%e3_4885) : !cute.int_tuple<"?">
      %iter_4886 = cute.get_iter(%view_4880) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4887, %e1_4888, %e2_4889, %e3_4890 = cute.get_leaves(%iter_4886) : !cute.int_tuple<"(?,?,?,?)">
      %1902 = cute.get_scalars(%e0_4887) : !cute.int_tuple<"?">
      %1903 = cute.get_scalars(%e1_4888) : !cute.int_tuple<"?">
      %1904 = cute.get_scalars(%e2_4889) : !cute.int_tuple<"?">
      %1905 = cute.get_scalars(%e3_4890) : !cute.int_tuple<"?">
      %iter_4891 = cute.get_iter(%view_4880) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4892, %e1_4893, %e2_4894, %e3_4895 = cute.get_leaves(%iter_4891) : !cute.int_tuple<"(?,?,?,?)">
      %1906 = cute.get_scalars(%e0_4892) : !cute.int_tuple<"?">
      %1907 = cute.get_scalars(%e1_4893) : !cute.int_tuple<"?">
      %1908 = cute.get_scalars(%e2_4894) : !cute.int_tuple<"?">
      %1909 = cute.get_scalars(%e3_4895) : !cute.int_tuple<"?">
      %int_tuple_4896 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4897 = cute.add_offset(%e3_4895, %int_tuple_4896) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1910 = cute.get_scalars(%tup_4897) : !cute.int_tuple<"?">
      %coord_4898 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4899 = cute.make_coord(%tup_4897) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1911 = cute.get_scalars(%coord_4898) : !cute.coord<"?">
      %1912 = cute.get_scalars(%coord_4899) : !cute.coord<"?">
      %true_4900 = arith.constant true
      %1913 = arith.cmpi slt, %1911, %1912 : i32
      %1914 = arith.andi %true_4900, %1913 : i1
      %lay_4901 = cute.get_layout(%1895) : !memref_rmem_f32_4
      %1915 = cute.get_shape(%lay_4901) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4902, %e1_4903, %e2_4904, %e3_4905 = cute.get_leaves(%1915) : !cute.shape<"((2,2),(2,8))">
      %1916 = cute.get_stride(%lay_4901) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4906, %e1_4907, %e2_4908, %e3_4909 = cute.get_leaves(%1916) : !cute.stride<"((2,4),(1,8))">
      %1917 = scf.if %1914 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1895) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,11)">
        cute.memref.store(%1895, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,11)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1895) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1895 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1895) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1895) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1895 : !memref_rmem_f32_4
      }
      %iter_4910 = cute.get_iter(%1917) : !memref_rmem_f32_4
      %lay_4911 = cute.get_layout(%1917) : !memref_rmem_f32_4
      %1918 = cute.get_shape(%lay_4911) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4912, %e1_4913, %e2_4914, %e3_4915 = cute.get_leaves(%1918) : !cute.shape<"((2,2),(2,8))">
      %1919 = cute.get_stride(%lay_4911) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4916, %e1_4917, %e2_4918, %e3_4919 = cute.get_leaves(%1919) : !cute.stride<"((2,4),(1,8))">
      %iter_4920 = cute.get_iter(%1917) : !memref_rmem_f32_4
      %iter_4921 = cute.get_iter(%1917) : !memref_rmem_f32_4
      %coord_4922 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4923 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4924 = cute.crd2idx(%coord_4922, %lay_4923) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4925 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4926 = cute.add_offset(%iter_4925, %idx_4924) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4927 = cute.make_view(%tup_4926) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4928 = cute.get_iter(%view_4927) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4929, %e1_4930, %e2_4931, %e3_4932 = cute.get_leaves(%iter_4928) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1920 = cute.get_scalars(%e0_4929) : !cute.int_tuple<"?">
      %1921 = cute.get_scalars(%e1_4930) : !cute.int_tuple<"?">
      %1922 = cute.get_scalars(%e2_4931) : !cute.int_tuple<"?">
      %1923 = cute.get_scalars(%e3_4932) : !cute.int_tuple<"?{div=2}">
      %iter_4933 = cute.get_iter(%view_4927) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4934, %e1_4935, %e2_4936, %e3_4937 = cute.get_leaves(%iter_4933) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1924 = cute.get_scalars(%e0_4934) : !cute.int_tuple<"?">
      %1925 = cute.get_scalars(%e1_4935) : !cute.int_tuple<"?">
      %1926 = cute.get_scalars(%e2_4936) : !cute.int_tuple<"?">
      %1927 = cute.get_scalars(%e3_4937) : !cute.int_tuple<"?{div=2}">
      %iter_4938 = cute.get_iter(%view_4927) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4939, %e1_4940, %e2_4941, %e3_4942 = cute.get_leaves(%iter_4938) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1928 = cute.get_scalars(%e0_4939) : !cute.int_tuple<"?">
      %1929 = cute.get_scalars(%e1_4940) : !cute.int_tuple<"?">
      %1930 = cute.get_scalars(%e2_4941) : !cute.int_tuple<"?">
      %1931 = cute.get_scalars(%e3_4942) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4943 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4944 = cute.add_offset(%e3_4942, %int_tuple_4943) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1932 = cute.get_scalars(%tup_4944) : !cute.int_tuple<"?">
      %coord_4945 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4946 = cute.make_coord(%tup_4944) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1933 = cute.get_scalars(%coord_4945) : !cute.coord<"?">
      %1934 = cute.get_scalars(%coord_4946) : !cute.coord<"?">
      %true_4947 = arith.constant true
      %1935 = arith.cmpi slt, %1933, %1934 : i32
      %1936 = arith.andi %true_4947, %1935 : i1
      %lay_4948 = cute.get_layout(%1917) : !memref_rmem_f32_4
      %1937 = cute.get_shape(%lay_4948) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4949, %e1_4950, %e2_4951, %e3_4952 = cute.get_leaves(%1937) : !cute.shape<"((2,2),(2,8))">
      %1938 = cute.get_stride(%lay_4948) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4953, %e1_4954, %e2_4955, %e3_4956 = cute.get_leaves(%1938) : !cute.stride<"((2,4),(1,8))">
      %1939 = scf.if %1936 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1917) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,12)">
        cute.memref.store(%1917, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,12)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1917) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1917 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1917) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1917) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1917 : !memref_rmem_f32_4
      }
      %iter_4957 = cute.get_iter(%1939) : !memref_rmem_f32_4
      %lay_4958 = cute.get_layout(%1939) : !memref_rmem_f32_4
      %1940 = cute.get_shape(%lay_4958) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4959, %e1_4960, %e2_4961, %e3_4962 = cute.get_leaves(%1940) : !cute.shape<"((2,2),(2,8))">
      %1941 = cute.get_stride(%lay_4958) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4963, %e1_4964, %e2_4965, %e3_4966 = cute.get_leaves(%1941) : !cute.stride<"((2,4),(1,8))">
      %iter_4967 = cute.get_iter(%1939) : !memref_rmem_f32_4
      %iter_4968 = cute.get_iter(%1939) : !memref_rmem_f32_4
      %coord_4969 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_4970 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4971 = cute.crd2idx(%coord_4969, %lay_4970) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_4972 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4973 = cute.add_offset(%iter_4972, %idx_4971) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4974 = cute.make_view(%tup_4973) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4975 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4976, %e1_4977, %e2_4978, %e3_4979 = cute.get_leaves(%iter_4975) : !cute.int_tuple<"(?,?,?,?)">
      %1942 = cute.get_scalars(%e0_4976) : !cute.int_tuple<"?">
      %1943 = cute.get_scalars(%e1_4977) : !cute.int_tuple<"?">
      %1944 = cute.get_scalars(%e2_4978) : !cute.int_tuple<"?">
      %1945 = cute.get_scalars(%e3_4979) : !cute.int_tuple<"?">
      %iter_4980 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4981, %e1_4982, %e2_4983, %e3_4984 = cute.get_leaves(%iter_4980) : !cute.int_tuple<"(?,?,?,?)">
      %1946 = cute.get_scalars(%e0_4981) : !cute.int_tuple<"?">
      %1947 = cute.get_scalars(%e1_4982) : !cute.int_tuple<"?">
      %1948 = cute.get_scalars(%e2_4983) : !cute.int_tuple<"?">
      %1949 = cute.get_scalars(%e3_4984) : !cute.int_tuple<"?">
      %iter_4985 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4986, %e1_4987, %e2_4988, %e3_4989 = cute.get_leaves(%iter_4985) : !cute.int_tuple<"(?,?,?,?)">
      %1950 = cute.get_scalars(%e0_4986) : !cute.int_tuple<"?">
      %1951 = cute.get_scalars(%e1_4987) : !cute.int_tuple<"?">
      %1952 = cute.get_scalars(%e2_4988) : !cute.int_tuple<"?">
      %1953 = cute.get_scalars(%e3_4989) : !cute.int_tuple<"?">
      %int_tuple_4990 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4991 = cute.add_offset(%e3_4989, %int_tuple_4990) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1954 = cute.get_scalars(%tup_4991) : !cute.int_tuple<"?">
      %coord_4992 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4993 = cute.make_coord(%tup_4991) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1955 = cute.get_scalars(%coord_4992) : !cute.coord<"?">
      %1956 = cute.get_scalars(%coord_4993) : !cute.coord<"?">
      %true_4994 = arith.constant true
      %1957 = arith.cmpi slt, %1955, %1956 : i32
      %1958 = arith.andi %true_4994, %1957 : i1
      %lay_4995 = cute.get_layout(%1939) : !memref_rmem_f32_4
      %1959 = cute.get_shape(%lay_4995) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4996, %e1_4997, %e2_4998, %e3_4999 = cute.get_leaves(%1959) : !cute.shape<"((2,2),(2,8))">
      %1960 = cute.get_stride(%lay_4995) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5000, %e1_5001, %e2_5002, %e3_5003 = cute.get_leaves(%1960) : !cute.stride<"((2,4),(1,8))">
      %1961 = scf.if %1958 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1939) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,13)">
        cute.memref.store(%1939, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,13)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1939) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1939 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1939) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1939) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1939 : !memref_rmem_f32_4
      }
      %iter_5004 = cute.get_iter(%1961) : !memref_rmem_f32_4
      %lay_5005 = cute.get_layout(%1961) : !memref_rmem_f32_4
      %1962 = cute.get_shape(%lay_5005) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5006, %e1_5007, %e2_5008, %e3_5009 = cute.get_leaves(%1962) : !cute.shape<"((2,2),(2,8))">
      %1963 = cute.get_stride(%lay_5005) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5010, %e1_5011, %e2_5012, %e3_5013 = cute.get_leaves(%1963) : !cute.stride<"((2,4),(1,8))">
      %iter_5014 = cute.get_iter(%1961) : !memref_rmem_f32_4
      %iter_5015 = cute.get_iter(%1961) : !memref_rmem_f32_4
      %coord_5016 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5017 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5018 = cute.crd2idx(%coord_5016, %lay_5017) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5019 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5020 = cute.add_offset(%iter_5019, %idx_5018) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5021 = cute.make_view(%tup_5020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5022 = cute.get_iter(%view_5021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5023, %e1_5024, %e2_5025, %e3_5026 = cute.get_leaves(%iter_5022) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1964 = cute.get_scalars(%e0_5023) : !cute.int_tuple<"?">
      %1965 = cute.get_scalars(%e1_5024) : !cute.int_tuple<"?">
      %1966 = cute.get_scalars(%e2_5025) : !cute.int_tuple<"?">
      %1967 = cute.get_scalars(%e3_5026) : !cute.int_tuple<"?{div=2}">
      %iter_5027 = cute.get_iter(%view_5021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5028, %e1_5029, %e2_5030, %e3_5031 = cute.get_leaves(%iter_5027) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1968 = cute.get_scalars(%e0_5028) : !cute.int_tuple<"?">
      %1969 = cute.get_scalars(%e1_5029) : !cute.int_tuple<"?">
      %1970 = cute.get_scalars(%e2_5030) : !cute.int_tuple<"?">
      %1971 = cute.get_scalars(%e3_5031) : !cute.int_tuple<"?{div=2}">
      %iter_5032 = cute.get_iter(%view_5021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5033, %e1_5034, %e2_5035, %e3_5036 = cute.get_leaves(%iter_5032) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1972 = cute.get_scalars(%e0_5033) : !cute.int_tuple<"?">
      %1973 = cute.get_scalars(%e1_5034) : !cute.int_tuple<"?">
      %1974 = cute.get_scalars(%e2_5035) : !cute.int_tuple<"?">
      %1975 = cute.get_scalars(%e3_5036) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5037 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5038 = cute.add_offset(%e3_5036, %int_tuple_5037) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1976 = cute.get_scalars(%tup_5038) : !cute.int_tuple<"?">
      %coord_5039 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5040 = cute.make_coord(%tup_5038) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1977 = cute.get_scalars(%coord_5039) : !cute.coord<"?">
      %1978 = cute.get_scalars(%coord_5040) : !cute.coord<"?">
      %true_5041 = arith.constant true
      %1979 = arith.cmpi slt, %1977, %1978 : i32
      %1980 = arith.andi %true_5041, %1979 : i1
      %lay_5042 = cute.get_layout(%1961) : !memref_rmem_f32_4
      %1981 = cute.get_shape(%lay_5042) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5043, %e1_5044, %e2_5045, %e3_5046 = cute.get_leaves(%1981) : !cute.shape<"((2,2),(2,8))">
      %1982 = cute.get_stride(%lay_5042) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5047, %e1_5048, %e2_5049, %e3_5050 = cute.get_leaves(%1982) : !cute.stride<"((2,4),(1,8))">
      %1983 = scf.if %1980 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1961) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,14)">
        cute.memref.store(%1961, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,14)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1961) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1961 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1961) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1961) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1961 : !memref_rmem_f32_4
      }
      %iter_5051 = cute.get_iter(%1983) : !memref_rmem_f32_4
      %lay_5052 = cute.get_layout(%1983) : !memref_rmem_f32_4
      %1984 = cute.get_shape(%lay_5052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1984) : !cute.shape<"((2,2),(2,8))">
      %1985 = cute.get_stride(%lay_5052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5057, %e1_5058, %e2_5059, %e3_5060 = cute.get_leaves(%1985) : !cute.stride<"((2,4),(1,8))">
      %iter_5061 = cute.get_iter(%1983) : !memref_rmem_f32_4
      %iter_5062 = cute.get_iter(%1983) : !memref_rmem_f32_4
      %coord_5063 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5064 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5065 = cute.crd2idx(%coord_5063, %lay_5064) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5066 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5067 = cute.add_offset(%iter_5066, %idx_5065) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5068 = cute.make_view(%tup_5067) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5069 = cute.get_iter(%view_5068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5070, %e1_5071, %e2_5072, %e3_5073 = cute.get_leaves(%iter_5069) : !cute.int_tuple<"(?,?,?,?)">
      %1986 = cute.get_scalars(%e0_5070) : !cute.int_tuple<"?">
      %1987 = cute.get_scalars(%e1_5071) : !cute.int_tuple<"?">
      %1988 = cute.get_scalars(%e2_5072) : !cute.int_tuple<"?">
      %1989 = cute.get_scalars(%e3_5073) : !cute.int_tuple<"?">
      %iter_5074 = cute.get_iter(%view_5068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5075, %e1_5076, %e2_5077, %e3_5078 = cute.get_leaves(%iter_5074) : !cute.int_tuple<"(?,?,?,?)">
      %1990 = cute.get_scalars(%e0_5075) : !cute.int_tuple<"?">
      %1991 = cute.get_scalars(%e1_5076) : !cute.int_tuple<"?">
      %1992 = cute.get_scalars(%e2_5077) : !cute.int_tuple<"?">
      %1993 = cute.get_scalars(%e3_5078) : !cute.int_tuple<"?">
      %iter_5079 = cute.get_iter(%view_5068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5080, %e1_5081, %e2_5082, %e3_5083 = cute.get_leaves(%iter_5079) : !cute.int_tuple<"(?,?,?,?)">
      %1994 = cute.get_scalars(%e0_5080) : !cute.int_tuple<"?">
      %1995 = cute.get_scalars(%e1_5081) : !cute.int_tuple<"?">
      %1996 = cute.get_scalars(%e2_5082) : !cute.int_tuple<"?">
      %1997 = cute.get_scalars(%e3_5083) : !cute.int_tuple<"?">
      %int_tuple_5084 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5085 = cute.add_offset(%e3_5083, %int_tuple_5084) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1998 = cute.get_scalars(%tup_5085) : !cute.int_tuple<"?">
      %coord_5086 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5087 = cute.make_coord(%tup_5085) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1999 = cute.get_scalars(%coord_5086) : !cute.coord<"?">
      %2000 = cute.get_scalars(%coord_5087) : !cute.coord<"?">
      %true_5088 = arith.constant true
      %2001 = arith.cmpi slt, %1999, %2000 : i32
      %2002 = arith.andi %true_5088, %2001 : i1
      %lay_5089 = cute.get_layout(%1983) : !memref_rmem_f32_4
      %2003 = cute.get_shape(%lay_5089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5090, %e1_5091, %e2_5092, %e3_5093 = cute.get_leaves(%2003) : !cute.shape<"((2,2),(2,8))">
      %2004 = cute.get_stride(%lay_5089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5094, %e1_5095, %e2_5096, %e3_5097 = cute.get_leaves(%2004) : !cute.stride<"((2,4),(1,8))">
      %2005 = scf.if %2002 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%1983) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(1,15)">
        cute.memref.store(%1983, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(1,15)">, f32) -> ()
        %lay_8497 = cute.get_layout(%1983) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1983 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%1983) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%1983) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1983 : !memref_rmem_f32_4
      }
      %iter_5098 = cute.get_iter(%2005) : !memref_rmem_f32_4
      %lay_5099 = cute.get_layout(%2005) : !memref_rmem_f32_4
      %2006 = cute.get_shape(%lay_5099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5100, %e1_5101, %e2_5102, %e3_5103 = cute.get_leaves(%2006) : !cute.shape<"((2,2),(2,8))">
      %2007 = cute.get_stride(%lay_5099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5104, %e1_5105, %e2_5106, %e3_5107 = cute.get_leaves(%2007) : !cute.stride<"((2,4),(1,8))">
      %iter_5108 = cute.get_iter(%2005) : !memref_rmem_f32_4
      %iter_5109 = cute.get_iter(%2005) : !memref_rmem_f32_4
      %coord_5110 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_5111 = cute.get_layout(%2005) : !memref_rmem_f32_4
      %idx_5112 = cute.crd2idx(%coord_5110, %lay_5111) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_5113 = cute.get_iter(%2005) : !memref_rmem_f32_4
      %ptr_5114 = cute.add_offset(%iter_5113, %idx_5112) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_5115 = cute.make_view(%ptr_5114) : !memref_rmem_f32_7
      %iter_5116 = cute.get_iter(%view_5115) : !memref_rmem_f32_7
      %lay_5117 = cute.get_layout(%view_5115) : !memref_rmem_f32_7
      %2008 = cute.get_shape(%lay_5117) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5118, %e1_5119 = cute.get_leaves(%2008) : !cute.shape<"((2,8))">
      %2009 = cute.memref.load_vec %view_5115, row_major : !memref_rmem_f32_7
      %cst_5120 = arith.constant 0xFF800000 : f32
      %2010 = vector.reduction <maximumf>, %2009, %cst_5120 : vector<16xf32> into f32
      %c-1_i32_5121 = arith.constant -1 : i32
      %c2_i32_5122 = arith.constant 2 : i32
      %c31_i32_5123 = arith.constant 31 : i32
      %2011 = nvvm.shfl.sync  bfly %c-1_i32_5121, %2010, %c2_i32_5122, %c31_i32_5123 : f32 -> f32
      %2012 = nvvm.fmax %2010, %2011
      %c-1_i32_5124 = arith.constant -1 : i32
      %c1_i32_5125 = arith.constant 1 : i32
      %c31_i32_5126 = arith.constant 31 : i32
      %2013 = nvvm.shfl.sync  bfly %c-1_i32_5124, %2012, %c1_i32_5125, %c31_i32_5126 : f32 -> f32
      %2014 = nvvm.fmax %2012, %2013
      %2015 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2016 = arith.mulf %2009, %2015 : vector<16xf32>
      %2017 = arith.mulf %2014, %arg4 : f32
      %2018 = vector.broadcast %2017 : f32 to vector<16xf32>
      %2019 = arith.subf %2016, %2018 : vector<16xf32>
      %2020 = math.exp2 %2019 fastmath<fast> : vector<16xf32>
      %cst_5127 = arith.constant 0.000000e+00 : f32
      %2021 = vector.reduction <add>, %2020, %cst_5127 : vector<16xf32> into f32
      %coord_5128 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1582, %coord_5128, %2014) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_5129 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1587, %coord_5129, %2021) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_5130 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_5131 = cute.get_layout(%2005) : !memref_rmem_f32_4
      %idx_5132 = cute.crd2idx(%coord_5130, %lay_5131) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_5133 = cute.get_iter(%2005) : !memref_rmem_f32_4
      %ptr_5134 = cute.add_offset(%iter_5133, %idx_5132) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_5135 = cute.make_view(%ptr_5134) : !memref_rmem_f32_7
      %iter_5136 = cute.get_iter(%view_5135) : !memref_rmem_f32_7
      %lay_5137 = cute.get_layout(%view_5135) : !memref_rmem_f32_7
      %2022 = cute.get_shape(%lay_5137) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5138, %e1_5139 = cute.get_leaves(%2022) : !cute.shape<"((2,8))">
      %int_tuple_5140 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5141 = cute.size(%int_tuple_5140) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5142 = cute.get_leaves(%sz_5141) : !cute.int_tuple<"16">
      %int_tuple_5143 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5144 = cute.size(%int_tuple_5143) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5145 = cute.get_leaves(%sz_5144) : !cute.int_tuple<"16">
      cute.memref.store_vec %2020, %view_5135, row_major : !memref_rmem_f32_7
      %int_tuple_5146 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_5147 = cute.size(%int_tuple_5146) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_5148 = cute.get_leaves(%sz_5147) : !cute.int_tuple<"16">
      %coord_5149 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_5150 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5151 = cute.crd2idx(%coord_5149, %lay_5150) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_5152 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5153 = cute.add_offset(%iter_5152, %idx_5151) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5154 = cute.make_view(%tup_5153) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5155 = cute.get_iter(%view_5154) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5156, %e1_5157, %e2_5158, %e3_5159 = cute.get_leaves(%iter_5155) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2023 = cute.get_scalars(%e0_5156) : !cute.int_tuple<"?">
      %2024 = cute.get_scalars(%e1_5157) : !cute.int_tuple<"?">
      %2025 = cute.get_scalars(%e2_5158) : !cute.int_tuple<"?">
      %2026 = cute.get_scalars(%e3_5159) : !cute.int_tuple<"?{div=2}">
      %iter_5160 = cute.get_iter(%view_5154) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5161, %e1_5162, %e2_5163, %e3_5164 = cute.get_leaves(%iter_5160) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2027 = cute.get_scalars(%e0_5161) : !cute.int_tuple<"?">
      %2028 = cute.get_scalars(%e1_5162) : !cute.int_tuple<"?">
      %2029 = cute.get_scalars(%e2_5163) : !cute.int_tuple<"?">
      %2030 = cute.get_scalars(%e3_5164) : !cute.int_tuple<"?{div=2}">
      %iter_5165 = cute.get_iter(%view_5154) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5166, %e1_5167, %e2_5168, %e3_5169 = cute.get_leaves(%iter_5165) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2031 = cute.get_scalars(%e0_5166) : !cute.int_tuple<"?">
      %2032 = cute.get_scalars(%e1_5167) : !cute.int_tuple<"?">
      %2033 = cute.get_scalars(%e2_5168) : !cute.int_tuple<"?">
      %2034 = cute.get_scalars(%e3_5169) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5170 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5171 = cute.add_offset(%e3_5169, %int_tuple_5170) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2035 = cute.get_scalars(%tup_5171) : !cute.int_tuple<"?">
      %coord_5172 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5173 = cute.make_coord(%tup_5171) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2036 = cute.get_scalars(%coord_5172) : !cute.coord<"?">
      %2037 = cute.get_scalars(%coord_5173) : !cute.coord<"?">
      %true_5174 = arith.constant true
      %2038 = arith.cmpi slt, %2036, %2037 : i32
      %2039 = arith.andi %true_5174, %2038 : i1
      %lay_5175 = cute.get_layout(%2005) : !memref_rmem_f32_4
      %2040 = cute.get_shape(%lay_5175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5176, %e1_5177, %e2_5178, %e3_5179 = cute.get_leaves(%2040) : !cute.shape<"((2,2),(2,8))">
      %2041 = cute.get_stride(%lay_5175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5180, %e1_5181, %e2_5182, %e3_5183 = cute.get_leaves(%2041) : !cute.stride<"((2,4),(1,8))">
      %2042 = scf.if %2039 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2005) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,0)">
        cute.memref.store(%2005, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,0)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2005) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2005 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2005) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2005) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2005 : !memref_rmem_f32_4
      }
      %iter_5184 = cute.get_iter(%2042) : !memref_rmem_f32_4
      %lay_5185 = cute.get_layout(%2042) : !memref_rmem_f32_4
      %2043 = cute.get_shape(%lay_5185) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5186, %e1_5187, %e2_5188, %e3_5189 = cute.get_leaves(%2043) : !cute.shape<"((2,2),(2,8))">
      %2044 = cute.get_stride(%lay_5185) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5190, %e1_5191, %e2_5192, %e3_5193 = cute.get_leaves(%2044) : !cute.stride<"((2,4),(1,8))">
      %iter_5194 = cute.get_iter(%2042) : !memref_rmem_f32_4
      %iter_5195 = cute.get_iter(%2042) : !memref_rmem_f32_4
      %coord_5196 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_5197 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5198 = cute.crd2idx(%coord_5196, %lay_5197) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_5199 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5200 = cute.add_offset(%iter_5199, %idx_5198) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5201 = cute.make_view(%tup_5200) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5202 = cute.get_iter(%view_5201) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5203, %e1_5204, %e2_5205, %e3_5206 = cute.get_leaves(%iter_5202) : !cute.int_tuple<"(?,?,?,?)">
      %2045 = cute.get_scalars(%e0_5203) : !cute.int_tuple<"?">
      %2046 = cute.get_scalars(%e1_5204) : !cute.int_tuple<"?">
      %2047 = cute.get_scalars(%e2_5205) : !cute.int_tuple<"?">
      %2048 = cute.get_scalars(%e3_5206) : !cute.int_tuple<"?">
      %iter_5207 = cute.get_iter(%view_5201) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5208, %e1_5209, %e2_5210, %e3_5211 = cute.get_leaves(%iter_5207) : !cute.int_tuple<"(?,?,?,?)">
      %2049 = cute.get_scalars(%e0_5208) : !cute.int_tuple<"?">
      %2050 = cute.get_scalars(%e1_5209) : !cute.int_tuple<"?">
      %2051 = cute.get_scalars(%e2_5210) : !cute.int_tuple<"?">
      %2052 = cute.get_scalars(%e3_5211) : !cute.int_tuple<"?">
      %iter_5212 = cute.get_iter(%view_5201) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5213, %e1_5214, %e2_5215, %e3_5216 = cute.get_leaves(%iter_5212) : !cute.int_tuple<"(?,?,?,?)">
      %2053 = cute.get_scalars(%e0_5213) : !cute.int_tuple<"?">
      %2054 = cute.get_scalars(%e1_5214) : !cute.int_tuple<"?">
      %2055 = cute.get_scalars(%e2_5215) : !cute.int_tuple<"?">
      %2056 = cute.get_scalars(%e3_5216) : !cute.int_tuple<"?">
      %int_tuple_5217 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5218 = cute.add_offset(%e3_5216, %int_tuple_5217) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2057 = cute.get_scalars(%tup_5218) : !cute.int_tuple<"?">
      %coord_5219 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5220 = cute.make_coord(%tup_5218) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2058 = cute.get_scalars(%coord_5219) : !cute.coord<"?">
      %2059 = cute.get_scalars(%coord_5220) : !cute.coord<"?">
      %true_5221 = arith.constant true
      %2060 = arith.cmpi slt, %2058, %2059 : i32
      %2061 = arith.andi %true_5221, %2060 : i1
      %lay_5222 = cute.get_layout(%2042) : !memref_rmem_f32_4
      %2062 = cute.get_shape(%lay_5222) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5223, %e1_5224, %e2_5225, %e3_5226 = cute.get_leaves(%2062) : !cute.shape<"((2,2),(2,8))">
      %2063 = cute.get_stride(%lay_5222) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5227, %e1_5228, %e2_5229, %e3_5230 = cute.get_leaves(%2063) : !cute.stride<"((2,4),(1,8))">
      %2064 = scf.if %2061 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2042) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,1)">
        cute.memref.store(%2042, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,1)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2042) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2042 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2042) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2042) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2042 : !memref_rmem_f32_4
      }
      %iter_5231 = cute.get_iter(%2064) : !memref_rmem_f32_4
      %lay_5232 = cute.get_layout(%2064) : !memref_rmem_f32_4
      %2065 = cute.get_shape(%lay_5232) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5233, %e1_5234, %e2_5235, %e3_5236 = cute.get_leaves(%2065) : !cute.shape<"((2,2),(2,8))">
      %2066 = cute.get_stride(%lay_5232) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5237, %e1_5238, %e2_5239, %e3_5240 = cute.get_leaves(%2066) : !cute.stride<"((2,4),(1,8))">
      %iter_5241 = cute.get_iter(%2064) : !memref_rmem_f32_4
      %iter_5242 = cute.get_iter(%2064) : !memref_rmem_f32_4
      %coord_5243 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_5244 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5245 = cute.crd2idx(%coord_5243, %lay_5244) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_5246 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5247 = cute.add_offset(%iter_5246, %idx_5245) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5248 = cute.make_view(%tup_5247) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5249 = cute.get_iter(%view_5248) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5250, %e1_5251, %e2_5252, %e3_5253 = cute.get_leaves(%iter_5249) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2067 = cute.get_scalars(%e0_5250) : !cute.int_tuple<"?">
      %2068 = cute.get_scalars(%e1_5251) : !cute.int_tuple<"?">
      %2069 = cute.get_scalars(%e2_5252) : !cute.int_tuple<"?">
      %2070 = cute.get_scalars(%e3_5253) : !cute.int_tuple<"?{div=2}">
      %iter_5254 = cute.get_iter(%view_5248) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5255, %e1_5256, %e2_5257, %e3_5258 = cute.get_leaves(%iter_5254) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2071 = cute.get_scalars(%e0_5255) : !cute.int_tuple<"?">
      %2072 = cute.get_scalars(%e1_5256) : !cute.int_tuple<"?">
      %2073 = cute.get_scalars(%e2_5257) : !cute.int_tuple<"?">
      %2074 = cute.get_scalars(%e3_5258) : !cute.int_tuple<"?{div=2}">
      %iter_5259 = cute.get_iter(%view_5248) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5260, %e1_5261, %e2_5262, %e3_5263 = cute.get_leaves(%iter_5259) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2075 = cute.get_scalars(%e0_5260) : !cute.int_tuple<"?">
      %2076 = cute.get_scalars(%e1_5261) : !cute.int_tuple<"?">
      %2077 = cute.get_scalars(%e2_5262) : !cute.int_tuple<"?">
      %2078 = cute.get_scalars(%e3_5263) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5264 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5265 = cute.add_offset(%e3_5263, %int_tuple_5264) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2079 = cute.get_scalars(%tup_5265) : !cute.int_tuple<"?">
      %coord_5266 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5267 = cute.make_coord(%tup_5265) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2080 = cute.get_scalars(%coord_5266) : !cute.coord<"?">
      %2081 = cute.get_scalars(%coord_5267) : !cute.coord<"?">
      %true_5268 = arith.constant true
      %2082 = arith.cmpi slt, %2080, %2081 : i32
      %2083 = arith.andi %true_5268, %2082 : i1
      %lay_5269 = cute.get_layout(%2064) : !memref_rmem_f32_4
      %2084 = cute.get_shape(%lay_5269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5270, %e1_5271, %e2_5272, %e3_5273 = cute.get_leaves(%2084) : !cute.shape<"((2,2),(2,8))">
      %2085 = cute.get_stride(%lay_5269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5274, %e1_5275, %e2_5276, %e3_5277 = cute.get_leaves(%2085) : !cute.stride<"((2,4),(1,8))">
      %2086 = scf.if %2083 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2064) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,2)">
        cute.memref.store(%2064, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,2)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2064) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2064 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2064) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2064) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2064 : !memref_rmem_f32_4
      }
      %iter_5278 = cute.get_iter(%2086) : !memref_rmem_f32_4
      %lay_5279 = cute.get_layout(%2086) : !memref_rmem_f32_4
      %2087 = cute.get_shape(%lay_5279) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5280, %e1_5281, %e2_5282, %e3_5283 = cute.get_leaves(%2087) : !cute.shape<"((2,2),(2,8))">
      %2088 = cute.get_stride(%lay_5279) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5284, %e1_5285, %e2_5286, %e3_5287 = cute.get_leaves(%2088) : !cute.stride<"((2,4),(1,8))">
      %iter_5288 = cute.get_iter(%2086) : !memref_rmem_f32_4
      %iter_5289 = cute.get_iter(%2086) : !memref_rmem_f32_4
      %coord_5290 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_5291 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5292 = cute.crd2idx(%coord_5290, %lay_5291) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_5293 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5294 = cute.add_offset(%iter_5293, %idx_5292) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5295 = cute.make_view(%tup_5294) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5296 = cute.get_iter(%view_5295) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5297, %e1_5298, %e2_5299, %e3_5300 = cute.get_leaves(%iter_5296) : !cute.int_tuple<"(?,?,?,?)">
      %2089 = cute.get_scalars(%e0_5297) : !cute.int_tuple<"?">
      %2090 = cute.get_scalars(%e1_5298) : !cute.int_tuple<"?">
      %2091 = cute.get_scalars(%e2_5299) : !cute.int_tuple<"?">
      %2092 = cute.get_scalars(%e3_5300) : !cute.int_tuple<"?">
      %iter_5301 = cute.get_iter(%view_5295) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5302, %e1_5303, %e2_5304, %e3_5305 = cute.get_leaves(%iter_5301) : !cute.int_tuple<"(?,?,?,?)">
      %2093 = cute.get_scalars(%e0_5302) : !cute.int_tuple<"?">
      %2094 = cute.get_scalars(%e1_5303) : !cute.int_tuple<"?">
      %2095 = cute.get_scalars(%e2_5304) : !cute.int_tuple<"?">
      %2096 = cute.get_scalars(%e3_5305) : !cute.int_tuple<"?">
      %iter_5306 = cute.get_iter(%view_5295) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5307, %e1_5308, %e2_5309, %e3_5310 = cute.get_leaves(%iter_5306) : !cute.int_tuple<"(?,?,?,?)">
      %2097 = cute.get_scalars(%e0_5307) : !cute.int_tuple<"?">
      %2098 = cute.get_scalars(%e1_5308) : !cute.int_tuple<"?">
      %2099 = cute.get_scalars(%e2_5309) : !cute.int_tuple<"?">
      %2100 = cute.get_scalars(%e3_5310) : !cute.int_tuple<"?">
      %int_tuple_5311 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5312 = cute.add_offset(%e3_5310, %int_tuple_5311) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2101 = cute.get_scalars(%tup_5312) : !cute.int_tuple<"?">
      %coord_5313 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5314 = cute.make_coord(%tup_5312) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2102 = cute.get_scalars(%coord_5313) : !cute.coord<"?">
      %2103 = cute.get_scalars(%coord_5314) : !cute.coord<"?">
      %true_5315 = arith.constant true
      %2104 = arith.cmpi slt, %2102, %2103 : i32
      %2105 = arith.andi %true_5315, %2104 : i1
      %lay_5316 = cute.get_layout(%2086) : !memref_rmem_f32_4
      %2106 = cute.get_shape(%lay_5316) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5317, %e1_5318, %e2_5319, %e3_5320 = cute.get_leaves(%2106) : !cute.shape<"((2,2),(2,8))">
      %2107 = cute.get_stride(%lay_5316) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5321, %e1_5322, %e2_5323, %e3_5324 = cute.get_leaves(%2107) : !cute.stride<"((2,4),(1,8))">
      %2108 = scf.if %2105 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2086) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,3)">
        cute.memref.store(%2086, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,3)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2086) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2086 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2086) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2086) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2086 : !memref_rmem_f32_4
      }
      %iter_5325 = cute.get_iter(%2108) : !memref_rmem_f32_4
      %lay_5326 = cute.get_layout(%2108) : !memref_rmem_f32_4
      %2109 = cute.get_shape(%lay_5326) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5327, %e1_5328, %e2_5329, %e3_5330 = cute.get_leaves(%2109) : !cute.shape<"((2,2),(2,8))">
      %2110 = cute.get_stride(%lay_5326) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5331, %e1_5332, %e2_5333, %e3_5334 = cute.get_leaves(%2110) : !cute.stride<"((2,4),(1,8))">
      %iter_5335 = cute.get_iter(%2108) : !memref_rmem_f32_4
      %iter_5336 = cute.get_iter(%2108) : !memref_rmem_f32_4
      %coord_5337 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_5338 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5339 = cute.crd2idx(%coord_5337, %lay_5338) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_5340 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5341 = cute.add_offset(%iter_5340, %idx_5339) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5342 = cute.make_view(%tup_5341) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5343 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5344, %e1_5345, %e2_5346, %e3_5347 = cute.get_leaves(%iter_5343) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2111 = cute.get_scalars(%e0_5344) : !cute.int_tuple<"?">
      %2112 = cute.get_scalars(%e1_5345) : !cute.int_tuple<"?">
      %2113 = cute.get_scalars(%e2_5346) : !cute.int_tuple<"?">
      %2114 = cute.get_scalars(%e3_5347) : !cute.int_tuple<"?{div=2}">
      %iter_5348 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5349, %e1_5350, %e2_5351, %e3_5352 = cute.get_leaves(%iter_5348) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2115 = cute.get_scalars(%e0_5349) : !cute.int_tuple<"?">
      %2116 = cute.get_scalars(%e1_5350) : !cute.int_tuple<"?">
      %2117 = cute.get_scalars(%e2_5351) : !cute.int_tuple<"?">
      %2118 = cute.get_scalars(%e3_5352) : !cute.int_tuple<"?{div=2}">
      %iter_5353 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5354, %e1_5355, %e2_5356, %e3_5357 = cute.get_leaves(%iter_5353) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2119 = cute.get_scalars(%e0_5354) : !cute.int_tuple<"?">
      %2120 = cute.get_scalars(%e1_5355) : !cute.int_tuple<"?">
      %2121 = cute.get_scalars(%e2_5356) : !cute.int_tuple<"?">
      %2122 = cute.get_scalars(%e3_5357) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5358 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5359 = cute.add_offset(%e3_5357, %int_tuple_5358) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2123 = cute.get_scalars(%tup_5359) : !cute.int_tuple<"?">
      %coord_5360 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5361 = cute.make_coord(%tup_5359) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2124 = cute.get_scalars(%coord_5360) : !cute.coord<"?">
      %2125 = cute.get_scalars(%coord_5361) : !cute.coord<"?">
      %true_5362 = arith.constant true
      %2126 = arith.cmpi slt, %2124, %2125 : i32
      %2127 = arith.andi %true_5362, %2126 : i1
      %lay_5363 = cute.get_layout(%2108) : !memref_rmem_f32_4
      %2128 = cute.get_shape(%lay_5363) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5364, %e1_5365, %e2_5366, %e3_5367 = cute.get_leaves(%2128) : !cute.shape<"((2,2),(2,8))">
      %2129 = cute.get_stride(%lay_5363) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5368, %e1_5369, %e2_5370, %e3_5371 = cute.get_leaves(%2129) : !cute.stride<"((2,4),(1,8))">
      %2130 = scf.if %2127 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2108) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,4)">
        cute.memref.store(%2108, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,4)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2108) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2108 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2108) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2108) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2108 : !memref_rmem_f32_4
      }
      %iter_5372 = cute.get_iter(%2130) : !memref_rmem_f32_4
      %lay_5373 = cute.get_layout(%2130) : !memref_rmem_f32_4
      %2131 = cute.get_shape(%lay_5373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5374, %e1_5375, %e2_5376, %e3_5377 = cute.get_leaves(%2131) : !cute.shape<"((2,2),(2,8))">
      %2132 = cute.get_stride(%lay_5373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5378, %e1_5379, %e2_5380, %e3_5381 = cute.get_leaves(%2132) : !cute.stride<"((2,4),(1,8))">
      %iter_5382 = cute.get_iter(%2130) : !memref_rmem_f32_4
      %iter_5383 = cute.get_iter(%2130) : !memref_rmem_f32_4
      %coord_5384 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_5385 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5386 = cute.crd2idx(%coord_5384, %lay_5385) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_5387 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5388 = cute.add_offset(%iter_5387, %idx_5386) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5389 = cute.make_view(%tup_5388) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5390 = cute.get_iter(%view_5389) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5391, %e1_5392, %e2_5393, %e3_5394 = cute.get_leaves(%iter_5390) : !cute.int_tuple<"(?,?,?,?)">
      %2133 = cute.get_scalars(%e0_5391) : !cute.int_tuple<"?">
      %2134 = cute.get_scalars(%e1_5392) : !cute.int_tuple<"?">
      %2135 = cute.get_scalars(%e2_5393) : !cute.int_tuple<"?">
      %2136 = cute.get_scalars(%e3_5394) : !cute.int_tuple<"?">
      %iter_5395 = cute.get_iter(%view_5389) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5396, %e1_5397, %e2_5398, %e3_5399 = cute.get_leaves(%iter_5395) : !cute.int_tuple<"(?,?,?,?)">
      %2137 = cute.get_scalars(%e0_5396) : !cute.int_tuple<"?">
      %2138 = cute.get_scalars(%e1_5397) : !cute.int_tuple<"?">
      %2139 = cute.get_scalars(%e2_5398) : !cute.int_tuple<"?">
      %2140 = cute.get_scalars(%e3_5399) : !cute.int_tuple<"?">
      %iter_5400 = cute.get_iter(%view_5389) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5401, %e1_5402, %e2_5403, %e3_5404 = cute.get_leaves(%iter_5400) : !cute.int_tuple<"(?,?,?,?)">
      %2141 = cute.get_scalars(%e0_5401) : !cute.int_tuple<"?">
      %2142 = cute.get_scalars(%e1_5402) : !cute.int_tuple<"?">
      %2143 = cute.get_scalars(%e2_5403) : !cute.int_tuple<"?">
      %2144 = cute.get_scalars(%e3_5404) : !cute.int_tuple<"?">
      %int_tuple_5405 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5406 = cute.add_offset(%e3_5404, %int_tuple_5405) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2145 = cute.get_scalars(%tup_5406) : !cute.int_tuple<"?">
      %coord_5407 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5408 = cute.make_coord(%tup_5406) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2146 = cute.get_scalars(%coord_5407) : !cute.coord<"?">
      %2147 = cute.get_scalars(%coord_5408) : !cute.coord<"?">
      %true_5409 = arith.constant true
      %2148 = arith.cmpi slt, %2146, %2147 : i32
      %2149 = arith.andi %true_5409, %2148 : i1
      %lay_5410 = cute.get_layout(%2130) : !memref_rmem_f32_4
      %2150 = cute.get_shape(%lay_5410) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5411, %e1_5412, %e2_5413, %e3_5414 = cute.get_leaves(%2150) : !cute.shape<"((2,2),(2,8))">
      %2151 = cute.get_stride(%lay_5410) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5415, %e1_5416, %e2_5417, %e3_5418 = cute.get_leaves(%2151) : !cute.stride<"((2,4),(1,8))">
      %2152 = scf.if %2149 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2130) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,5)">
        cute.memref.store(%2130, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,5)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2130) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2130 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2130) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2130) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2130 : !memref_rmem_f32_4
      }
      %iter_5419 = cute.get_iter(%2152) : !memref_rmem_f32_4
      %lay_5420 = cute.get_layout(%2152) : !memref_rmem_f32_4
      %2153 = cute.get_shape(%lay_5420) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5421, %e1_5422, %e2_5423, %e3_5424 = cute.get_leaves(%2153) : !cute.shape<"((2,2),(2,8))">
      %2154 = cute.get_stride(%lay_5420) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5425, %e1_5426, %e2_5427, %e3_5428 = cute.get_leaves(%2154) : !cute.stride<"((2,4),(1,8))">
      %iter_5429 = cute.get_iter(%2152) : !memref_rmem_f32_4
      %iter_5430 = cute.get_iter(%2152) : !memref_rmem_f32_4
      %coord_5431 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_5432 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5433 = cute.crd2idx(%coord_5431, %lay_5432) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_5434 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5435 = cute.add_offset(%iter_5434, %idx_5433) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5436 = cute.make_view(%tup_5435) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5437 = cute.get_iter(%view_5436) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5438, %e1_5439, %e2_5440, %e3_5441 = cute.get_leaves(%iter_5437) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2155 = cute.get_scalars(%e0_5438) : !cute.int_tuple<"?">
      %2156 = cute.get_scalars(%e1_5439) : !cute.int_tuple<"?">
      %2157 = cute.get_scalars(%e2_5440) : !cute.int_tuple<"?">
      %2158 = cute.get_scalars(%e3_5441) : !cute.int_tuple<"?{div=2}">
      %iter_5442 = cute.get_iter(%view_5436) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5443, %e1_5444, %e2_5445, %e3_5446 = cute.get_leaves(%iter_5442) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2159 = cute.get_scalars(%e0_5443) : !cute.int_tuple<"?">
      %2160 = cute.get_scalars(%e1_5444) : !cute.int_tuple<"?">
      %2161 = cute.get_scalars(%e2_5445) : !cute.int_tuple<"?">
      %2162 = cute.get_scalars(%e3_5446) : !cute.int_tuple<"?{div=2}">
      %iter_5447 = cute.get_iter(%view_5436) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5448, %e1_5449, %e2_5450, %e3_5451 = cute.get_leaves(%iter_5447) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2163 = cute.get_scalars(%e0_5448) : !cute.int_tuple<"?">
      %2164 = cute.get_scalars(%e1_5449) : !cute.int_tuple<"?">
      %2165 = cute.get_scalars(%e2_5450) : !cute.int_tuple<"?">
      %2166 = cute.get_scalars(%e3_5451) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5452 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5453 = cute.add_offset(%e3_5451, %int_tuple_5452) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2167 = cute.get_scalars(%tup_5453) : !cute.int_tuple<"?">
      %coord_5454 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5455 = cute.make_coord(%tup_5453) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2168 = cute.get_scalars(%coord_5454) : !cute.coord<"?">
      %2169 = cute.get_scalars(%coord_5455) : !cute.coord<"?">
      %true_5456 = arith.constant true
      %2170 = arith.cmpi slt, %2168, %2169 : i32
      %2171 = arith.andi %true_5456, %2170 : i1
      %lay_5457 = cute.get_layout(%2152) : !memref_rmem_f32_4
      %2172 = cute.get_shape(%lay_5457) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5458, %e1_5459, %e2_5460, %e3_5461 = cute.get_leaves(%2172) : !cute.shape<"((2,2),(2,8))">
      %2173 = cute.get_stride(%lay_5457) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5462, %e1_5463, %e2_5464, %e3_5465 = cute.get_leaves(%2173) : !cute.stride<"((2,4),(1,8))">
      %2174 = scf.if %2171 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2152) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,6)">
        cute.memref.store(%2152, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,6)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2152) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2152 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2152) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2152) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2152 : !memref_rmem_f32_4
      }
      %iter_5466 = cute.get_iter(%2174) : !memref_rmem_f32_4
      %lay_5467 = cute.get_layout(%2174) : !memref_rmem_f32_4
      %2175 = cute.get_shape(%lay_5467) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5468, %e1_5469, %e2_5470, %e3_5471 = cute.get_leaves(%2175) : !cute.shape<"((2,2),(2,8))">
      %2176 = cute.get_stride(%lay_5467) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5472, %e1_5473, %e2_5474, %e3_5475 = cute.get_leaves(%2176) : !cute.stride<"((2,4),(1,8))">
      %iter_5476 = cute.get_iter(%2174) : !memref_rmem_f32_4
      %iter_5477 = cute.get_iter(%2174) : !memref_rmem_f32_4
      %coord_5478 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_5479 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5480 = cute.crd2idx(%coord_5478, %lay_5479) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_5481 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5482 = cute.add_offset(%iter_5481, %idx_5480) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5483 = cute.make_view(%tup_5482) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5484 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5485, %e1_5486, %e2_5487, %e3_5488 = cute.get_leaves(%iter_5484) : !cute.int_tuple<"(?,?,?,?)">
      %2177 = cute.get_scalars(%e0_5485) : !cute.int_tuple<"?">
      %2178 = cute.get_scalars(%e1_5486) : !cute.int_tuple<"?">
      %2179 = cute.get_scalars(%e2_5487) : !cute.int_tuple<"?">
      %2180 = cute.get_scalars(%e3_5488) : !cute.int_tuple<"?">
      %iter_5489 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5490, %e1_5491, %e2_5492, %e3_5493 = cute.get_leaves(%iter_5489) : !cute.int_tuple<"(?,?,?,?)">
      %2181 = cute.get_scalars(%e0_5490) : !cute.int_tuple<"?">
      %2182 = cute.get_scalars(%e1_5491) : !cute.int_tuple<"?">
      %2183 = cute.get_scalars(%e2_5492) : !cute.int_tuple<"?">
      %2184 = cute.get_scalars(%e3_5493) : !cute.int_tuple<"?">
      %iter_5494 = cute.get_iter(%view_5483) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5495, %e1_5496, %e2_5497, %e3_5498 = cute.get_leaves(%iter_5494) : !cute.int_tuple<"(?,?,?,?)">
      %2185 = cute.get_scalars(%e0_5495) : !cute.int_tuple<"?">
      %2186 = cute.get_scalars(%e1_5496) : !cute.int_tuple<"?">
      %2187 = cute.get_scalars(%e2_5497) : !cute.int_tuple<"?">
      %2188 = cute.get_scalars(%e3_5498) : !cute.int_tuple<"?">
      %int_tuple_5499 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5500 = cute.add_offset(%e3_5498, %int_tuple_5499) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2189 = cute.get_scalars(%tup_5500) : !cute.int_tuple<"?">
      %coord_5501 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5502 = cute.make_coord(%tup_5500) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2190 = cute.get_scalars(%coord_5501) : !cute.coord<"?">
      %2191 = cute.get_scalars(%coord_5502) : !cute.coord<"?">
      %true_5503 = arith.constant true
      %2192 = arith.cmpi slt, %2190, %2191 : i32
      %2193 = arith.andi %true_5503, %2192 : i1
      %lay_5504 = cute.get_layout(%2174) : !memref_rmem_f32_4
      %2194 = cute.get_shape(%lay_5504) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5505, %e1_5506, %e2_5507, %e3_5508 = cute.get_leaves(%2194) : !cute.shape<"((2,2),(2,8))">
      %2195 = cute.get_stride(%lay_5504) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5509, %e1_5510, %e2_5511, %e3_5512 = cute.get_leaves(%2195) : !cute.stride<"((2,4),(1,8))">
      %2196 = scf.if %2193 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2174) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,7)">
        cute.memref.store(%2174, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,7)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2174) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2174 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2174) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2174) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2174 : !memref_rmem_f32_4
      }
      %iter_5513 = cute.get_iter(%2196) : !memref_rmem_f32_4
      %lay_5514 = cute.get_layout(%2196) : !memref_rmem_f32_4
      %2197 = cute.get_shape(%lay_5514) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5515, %e1_5516, %e2_5517, %e3_5518 = cute.get_leaves(%2197) : !cute.shape<"((2,2),(2,8))">
      %2198 = cute.get_stride(%lay_5514) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5519, %e1_5520, %e2_5521, %e3_5522 = cute.get_leaves(%2198) : !cute.stride<"((2,4),(1,8))">
      %iter_5523 = cute.get_iter(%2196) : !memref_rmem_f32_4
      %iter_5524 = cute.get_iter(%2196) : !memref_rmem_f32_4
      %coord_5525 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_5526 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5527 = cute.crd2idx(%coord_5525, %lay_5526) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_5528 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5529 = cute.add_offset(%iter_5528, %idx_5527) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5530 = cute.make_view(%tup_5529) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5531 = cute.get_iter(%view_5530) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5532, %e1_5533, %e2_5534, %e3_5535 = cute.get_leaves(%iter_5531) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2199 = cute.get_scalars(%e0_5532) : !cute.int_tuple<"?">
      %2200 = cute.get_scalars(%e1_5533) : !cute.int_tuple<"?">
      %2201 = cute.get_scalars(%e2_5534) : !cute.int_tuple<"?">
      %2202 = cute.get_scalars(%e3_5535) : !cute.int_tuple<"?{div=2}">
      %iter_5536 = cute.get_iter(%view_5530) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5537, %e1_5538, %e2_5539, %e3_5540 = cute.get_leaves(%iter_5536) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2203 = cute.get_scalars(%e0_5537) : !cute.int_tuple<"?">
      %2204 = cute.get_scalars(%e1_5538) : !cute.int_tuple<"?">
      %2205 = cute.get_scalars(%e2_5539) : !cute.int_tuple<"?">
      %2206 = cute.get_scalars(%e3_5540) : !cute.int_tuple<"?{div=2}">
      %iter_5541 = cute.get_iter(%view_5530) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5542, %e1_5543, %e2_5544, %e3_5545 = cute.get_leaves(%iter_5541) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2207 = cute.get_scalars(%e0_5542) : !cute.int_tuple<"?">
      %2208 = cute.get_scalars(%e1_5543) : !cute.int_tuple<"?">
      %2209 = cute.get_scalars(%e2_5544) : !cute.int_tuple<"?">
      %2210 = cute.get_scalars(%e3_5545) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5546 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5547 = cute.add_offset(%e3_5545, %int_tuple_5546) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2211 = cute.get_scalars(%tup_5547) : !cute.int_tuple<"?">
      %coord_5548 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5549 = cute.make_coord(%tup_5547) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2212 = cute.get_scalars(%coord_5548) : !cute.coord<"?">
      %2213 = cute.get_scalars(%coord_5549) : !cute.coord<"?">
      %true_5550 = arith.constant true
      %2214 = arith.cmpi slt, %2212, %2213 : i32
      %2215 = arith.andi %true_5550, %2214 : i1
      %lay_5551 = cute.get_layout(%2196) : !memref_rmem_f32_4
      %2216 = cute.get_shape(%lay_5551) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5552, %e1_5553, %e2_5554, %e3_5555 = cute.get_leaves(%2216) : !cute.shape<"((2,2),(2,8))">
      %2217 = cute.get_stride(%lay_5551) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5556, %e1_5557, %e2_5558, %e3_5559 = cute.get_leaves(%2217) : !cute.stride<"((2,4),(1,8))">
      %2218 = scf.if %2215 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2196) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,8)">
        cute.memref.store(%2196, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,8)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2196) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2196 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2196) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2196) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2196 : !memref_rmem_f32_4
      }
      %iter_5560 = cute.get_iter(%2218) : !memref_rmem_f32_4
      %lay_5561 = cute.get_layout(%2218) : !memref_rmem_f32_4
      %2219 = cute.get_shape(%lay_5561) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5562, %e1_5563, %e2_5564, %e3_5565 = cute.get_leaves(%2219) : !cute.shape<"((2,2),(2,8))">
      %2220 = cute.get_stride(%lay_5561) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5566, %e1_5567, %e2_5568, %e3_5569 = cute.get_leaves(%2220) : !cute.stride<"((2,4),(1,8))">
      %iter_5570 = cute.get_iter(%2218) : !memref_rmem_f32_4
      %iter_5571 = cute.get_iter(%2218) : !memref_rmem_f32_4
      %coord_5572 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_5573 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5574 = cute.crd2idx(%coord_5572, %lay_5573) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_5575 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5576 = cute.add_offset(%iter_5575, %idx_5574) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5577 = cute.make_view(%tup_5576) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5578 = cute.get_iter(%view_5577) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5579, %e1_5580, %e2_5581, %e3_5582 = cute.get_leaves(%iter_5578) : !cute.int_tuple<"(?,?,?,?)">
      %2221 = cute.get_scalars(%e0_5579) : !cute.int_tuple<"?">
      %2222 = cute.get_scalars(%e1_5580) : !cute.int_tuple<"?">
      %2223 = cute.get_scalars(%e2_5581) : !cute.int_tuple<"?">
      %2224 = cute.get_scalars(%e3_5582) : !cute.int_tuple<"?">
      %iter_5583 = cute.get_iter(%view_5577) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5584, %e1_5585, %e2_5586, %e3_5587 = cute.get_leaves(%iter_5583) : !cute.int_tuple<"(?,?,?,?)">
      %2225 = cute.get_scalars(%e0_5584) : !cute.int_tuple<"?">
      %2226 = cute.get_scalars(%e1_5585) : !cute.int_tuple<"?">
      %2227 = cute.get_scalars(%e2_5586) : !cute.int_tuple<"?">
      %2228 = cute.get_scalars(%e3_5587) : !cute.int_tuple<"?">
      %iter_5588 = cute.get_iter(%view_5577) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5589, %e1_5590, %e2_5591, %e3_5592 = cute.get_leaves(%iter_5588) : !cute.int_tuple<"(?,?,?,?)">
      %2229 = cute.get_scalars(%e0_5589) : !cute.int_tuple<"?">
      %2230 = cute.get_scalars(%e1_5590) : !cute.int_tuple<"?">
      %2231 = cute.get_scalars(%e2_5591) : !cute.int_tuple<"?">
      %2232 = cute.get_scalars(%e3_5592) : !cute.int_tuple<"?">
      %int_tuple_5593 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5594 = cute.add_offset(%e3_5592, %int_tuple_5593) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2233 = cute.get_scalars(%tup_5594) : !cute.int_tuple<"?">
      %coord_5595 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5596 = cute.make_coord(%tup_5594) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2234 = cute.get_scalars(%coord_5595) : !cute.coord<"?">
      %2235 = cute.get_scalars(%coord_5596) : !cute.coord<"?">
      %true_5597 = arith.constant true
      %2236 = arith.cmpi slt, %2234, %2235 : i32
      %2237 = arith.andi %true_5597, %2236 : i1
      %lay_5598 = cute.get_layout(%2218) : !memref_rmem_f32_4
      %2238 = cute.get_shape(%lay_5598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5599, %e1_5600, %e2_5601, %e3_5602 = cute.get_leaves(%2238) : !cute.shape<"((2,2),(2,8))">
      %2239 = cute.get_stride(%lay_5598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5603, %e1_5604, %e2_5605, %e3_5606 = cute.get_leaves(%2239) : !cute.stride<"((2,4),(1,8))">
      %2240 = scf.if %2237 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2218) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,9)">
        cute.memref.store(%2218, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,9)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2218) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2218 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2218) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2218) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2218 : !memref_rmem_f32_4
      }
      %iter_5607 = cute.get_iter(%2240) : !memref_rmem_f32_4
      %lay_5608 = cute.get_layout(%2240) : !memref_rmem_f32_4
      %2241 = cute.get_shape(%lay_5608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5609, %e1_5610, %e2_5611, %e3_5612 = cute.get_leaves(%2241) : !cute.shape<"((2,2),(2,8))">
      %2242 = cute.get_stride(%lay_5608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5613, %e1_5614, %e2_5615, %e3_5616 = cute.get_leaves(%2242) : !cute.stride<"((2,4),(1,8))">
      %iter_5617 = cute.get_iter(%2240) : !memref_rmem_f32_4
      %iter_5618 = cute.get_iter(%2240) : !memref_rmem_f32_4
      %coord_5619 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5620 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5621 = cute.crd2idx(%coord_5619, %lay_5620) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5622 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5623 = cute.add_offset(%iter_5622, %idx_5621) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5624 = cute.make_view(%tup_5623) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5625 = cute.get_iter(%view_5624) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5626, %e1_5627, %e2_5628, %e3_5629 = cute.get_leaves(%iter_5625) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2243 = cute.get_scalars(%e0_5626) : !cute.int_tuple<"?">
      %2244 = cute.get_scalars(%e1_5627) : !cute.int_tuple<"?">
      %2245 = cute.get_scalars(%e2_5628) : !cute.int_tuple<"?">
      %2246 = cute.get_scalars(%e3_5629) : !cute.int_tuple<"?{div=2}">
      %iter_5630 = cute.get_iter(%view_5624) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5631, %e1_5632, %e2_5633, %e3_5634 = cute.get_leaves(%iter_5630) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2247 = cute.get_scalars(%e0_5631) : !cute.int_tuple<"?">
      %2248 = cute.get_scalars(%e1_5632) : !cute.int_tuple<"?">
      %2249 = cute.get_scalars(%e2_5633) : !cute.int_tuple<"?">
      %2250 = cute.get_scalars(%e3_5634) : !cute.int_tuple<"?{div=2}">
      %iter_5635 = cute.get_iter(%view_5624) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5636, %e1_5637, %e2_5638, %e3_5639 = cute.get_leaves(%iter_5635) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2251 = cute.get_scalars(%e0_5636) : !cute.int_tuple<"?">
      %2252 = cute.get_scalars(%e1_5637) : !cute.int_tuple<"?">
      %2253 = cute.get_scalars(%e2_5638) : !cute.int_tuple<"?">
      %2254 = cute.get_scalars(%e3_5639) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5640 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5641 = cute.add_offset(%e3_5639, %int_tuple_5640) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2255 = cute.get_scalars(%tup_5641) : !cute.int_tuple<"?">
      %coord_5642 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5643 = cute.make_coord(%tup_5641) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2256 = cute.get_scalars(%coord_5642) : !cute.coord<"?">
      %2257 = cute.get_scalars(%coord_5643) : !cute.coord<"?">
      %true_5644 = arith.constant true
      %2258 = arith.cmpi slt, %2256, %2257 : i32
      %2259 = arith.andi %true_5644, %2258 : i1
      %lay_5645 = cute.get_layout(%2240) : !memref_rmem_f32_4
      %2260 = cute.get_shape(%lay_5645) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5646, %e1_5647, %e2_5648, %e3_5649 = cute.get_leaves(%2260) : !cute.shape<"((2,2),(2,8))">
      %2261 = cute.get_stride(%lay_5645) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5650, %e1_5651, %e2_5652, %e3_5653 = cute.get_leaves(%2261) : !cute.stride<"((2,4),(1,8))">
      %2262 = scf.if %2259 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2240) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,10)">
        cute.memref.store(%2240, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,10)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2240) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2240 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2240) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2240) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2240 : !memref_rmem_f32_4
      }
      %iter_5654 = cute.get_iter(%2262) : !memref_rmem_f32_4
      %lay_5655 = cute.get_layout(%2262) : !memref_rmem_f32_4
      %2263 = cute.get_shape(%lay_5655) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5656, %e1_5657, %e2_5658, %e3_5659 = cute.get_leaves(%2263) : !cute.shape<"((2,2),(2,8))">
      %2264 = cute.get_stride(%lay_5655) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5660, %e1_5661, %e2_5662, %e3_5663 = cute.get_leaves(%2264) : !cute.stride<"((2,4),(1,8))">
      %iter_5664 = cute.get_iter(%2262) : !memref_rmem_f32_4
      %iter_5665 = cute.get_iter(%2262) : !memref_rmem_f32_4
      %coord_5666 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5667 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5668 = cute.crd2idx(%coord_5666, %lay_5667) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5669 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5670 = cute.add_offset(%iter_5669, %idx_5668) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5671 = cute.make_view(%tup_5670) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5672 = cute.get_iter(%view_5671) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5673, %e1_5674, %e2_5675, %e3_5676 = cute.get_leaves(%iter_5672) : !cute.int_tuple<"(?,?,?,?)">
      %2265 = cute.get_scalars(%e0_5673) : !cute.int_tuple<"?">
      %2266 = cute.get_scalars(%e1_5674) : !cute.int_tuple<"?">
      %2267 = cute.get_scalars(%e2_5675) : !cute.int_tuple<"?">
      %2268 = cute.get_scalars(%e3_5676) : !cute.int_tuple<"?">
      %iter_5677 = cute.get_iter(%view_5671) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5678, %e1_5679, %e2_5680, %e3_5681 = cute.get_leaves(%iter_5677) : !cute.int_tuple<"(?,?,?,?)">
      %2269 = cute.get_scalars(%e0_5678) : !cute.int_tuple<"?">
      %2270 = cute.get_scalars(%e1_5679) : !cute.int_tuple<"?">
      %2271 = cute.get_scalars(%e2_5680) : !cute.int_tuple<"?">
      %2272 = cute.get_scalars(%e3_5681) : !cute.int_tuple<"?">
      %iter_5682 = cute.get_iter(%view_5671) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5683, %e1_5684, %e2_5685, %e3_5686 = cute.get_leaves(%iter_5682) : !cute.int_tuple<"(?,?,?,?)">
      %2273 = cute.get_scalars(%e0_5683) : !cute.int_tuple<"?">
      %2274 = cute.get_scalars(%e1_5684) : !cute.int_tuple<"?">
      %2275 = cute.get_scalars(%e2_5685) : !cute.int_tuple<"?">
      %2276 = cute.get_scalars(%e3_5686) : !cute.int_tuple<"?">
      %int_tuple_5687 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5688 = cute.add_offset(%e3_5686, %int_tuple_5687) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2277 = cute.get_scalars(%tup_5688) : !cute.int_tuple<"?">
      %coord_5689 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5690 = cute.make_coord(%tup_5688) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2278 = cute.get_scalars(%coord_5689) : !cute.coord<"?">
      %2279 = cute.get_scalars(%coord_5690) : !cute.coord<"?">
      %true_5691 = arith.constant true
      %2280 = arith.cmpi slt, %2278, %2279 : i32
      %2281 = arith.andi %true_5691, %2280 : i1
      %lay_5692 = cute.get_layout(%2262) : !memref_rmem_f32_4
      %2282 = cute.get_shape(%lay_5692) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5693, %e1_5694, %e2_5695, %e3_5696 = cute.get_leaves(%2282) : !cute.shape<"((2,2),(2,8))">
      %2283 = cute.get_stride(%lay_5692) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5697, %e1_5698, %e2_5699, %e3_5700 = cute.get_leaves(%2283) : !cute.stride<"((2,4),(1,8))">
      %2284 = scf.if %2281 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2262) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,11)">
        cute.memref.store(%2262, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,11)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2262) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2262 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2262) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2262) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2262 : !memref_rmem_f32_4
      }
      %iter_5701 = cute.get_iter(%2284) : !memref_rmem_f32_4
      %lay_5702 = cute.get_layout(%2284) : !memref_rmem_f32_4
      %2285 = cute.get_shape(%lay_5702) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5703, %e1_5704, %e2_5705, %e3_5706 = cute.get_leaves(%2285) : !cute.shape<"((2,2),(2,8))">
      %2286 = cute.get_stride(%lay_5702) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5707, %e1_5708, %e2_5709, %e3_5710 = cute.get_leaves(%2286) : !cute.stride<"((2,4),(1,8))">
      %iter_5711 = cute.get_iter(%2284) : !memref_rmem_f32_4
      %iter_5712 = cute.get_iter(%2284) : !memref_rmem_f32_4
      %coord_5713 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5714 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5715 = cute.crd2idx(%coord_5713, %lay_5714) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5716 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5717 = cute.add_offset(%iter_5716, %idx_5715) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5718 = cute.make_view(%tup_5717) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5719 = cute.get_iter(%view_5718) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5720, %e1_5721, %e2_5722, %e3_5723 = cute.get_leaves(%iter_5719) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2287 = cute.get_scalars(%e0_5720) : !cute.int_tuple<"?">
      %2288 = cute.get_scalars(%e1_5721) : !cute.int_tuple<"?">
      %2289 = cute.get_scalars(%e2_5722) : !cute.int_tuple<"?">
      %2290 = cute.get_scalars(%e3_5723) : !cute.int_tuple<"?{div=2}">
      %iter_5724 = cute.get_iter(%view_5718) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5725, %e1_5726, %e2_5727, %e3_5728 = cute.get_leaves(%iter_5724) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2291 = cute.get_scalars(%e0_5725) : !cute.int_tuple<"?">
      %2292 = cute.get_scalars(%e1_5726) : !cute.int_tuple<"?">
      %2293 = cute.get_scalars(%e2_5727) : !cute.int_tuple<"?">
      %2294 = cute.get_scalars(%e3_5728) : !cute.int_tuple<"?{div=2}">
      %iter_5729 = cute.get_iter(%view_5718) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5730, %e1_5731, %e2_5732, %e3_5733 = cute.get_leaves(%iter_5729) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2295 = cute.get_scalars(%e0_5730) : !cute.int_tuple<"?">
      %2296 = cute.get_scalars(%e1_5731) : !cute.int_tuple<"?">
      %2297 = cute.get_scalars(%e2_5732) : !cute.int_tuple<"?">
      %2298 = cute.get_scalars(%e3_5733) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5734 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5735 = cute.add_offset(%e3_5733, %int_tuple_5734) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2299 = cute.get_scalars(%tup_5735) : !cute.int_tuple<"?">
      %coord_5736 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5737 = cute.make_coord(%tup_5735) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2300 = cute.get_scalars(%coord_5736) : !cute.coord<"?">
      %2301 = cute.get_scalars(%coord_5737) : !cute.coord<"?">
      %true_5738 = arith.constant true
      %2302 = arith.cmpi slt, %2300, %2301 : i32
      %2303 = arith.andi %true_5738, %2302 : i1
      %lay_5739 = cute.get_layout(%2284) : !memref_rmem_f32_4
      %2304 = cute.get_shape(%lay_5739) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5740, %e1_5741, %e2_5742, %e3_5743 = cute.get_leaves(%2304) : !cute.shape<"((2,2),(2,8))">
      %2305 = cute.get_stride(%lay_5739) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5744, %e1_5745, %e2_5746, %e3_5747 = cute.get_leaves(%2305) : !cute.stride<"((2,4),(1,8))">
      %2306 = scf.if %2303 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2284) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,12)">
        cute.memref.store(%2284, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,12)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2284) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2284 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2284) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2284) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2284 : !memref_rmem_f32_4
      }
      %iter_5748 = cute.get_iter(%2306) : !memref_rmem_f32_4
      %lay_5749 = cute.get_layout(%2306) : !memref_rmem_f32_4
      %2307 = cute.get_shape(%lay_5749) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5750, %e1_5751, %e2_5752, %e3_5753 = cute.get_leaves(%2307) : !cute.shape<"((2,2),(2,8))">
      %2308 = cute.get_stride(%lay_5749) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5754, %e1_5755, %e2_5756, %e3_5757 = cute.get_leaves(%2308) : !cute.stride<"((2,4),(1,8))">
      %iter_5758 = cute.get_iter(%2306) : !memref_rmem_f32_4
      %iter_5759 = cute.get_iter(%2306) : !memref_rmem_f32_4
      %coord_5760 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5761 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5762 = cute.crd2idx(%coord_5760, %lay_5761) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5763 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5764 = cute.add_offset(%iter_5763, %idx_5762) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5765 = cute.make_view(%tup_5764) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5766 = cute.get_iter(%view_5765) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5767, %e1_5768, %e2_5769, %e3_5770 = cute.get_leaves(%iter_5766) : !cute.int_tuple<"(?,?,?,?)">
      %2309 = cute.get_scalars(%e0_5767) : !cute.int_tuple<"?">
      %2310 = cute.get_scalars(%e1_5768) : !cute.int_tuple<"?">
      %2311 = cute.get_scalars(%e2_5769) : !cute.int_tuple<"?">
      %2312 = cute.get_scalars(%e3_5770) : !cute.int_tuple<"?">
      %iter_5771 = cute.get_iter(%view_5765) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5772, %e1_5773, %e2_5774, %e3_5775 = cute.get_leaves(%iter_5771) : !cute.int_tuple<"(?,?,?,?)">
      %2313 = cute.get_scalars(%e0_5772) : !cute.int_tuple<"?">
      %2314 = cute.get_scalars(%e1_5773) : !cute.int_tuple<"?">
      %2315 = cute.get_scalars(%e2_5774) : !cute.int_tuple<"?">
      %2316 = cute.get_scalars(%e3_5775) : !cute.int_tuple<"?">
      %iter_5776 = cute.get_iter(%view_5765) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5777, %e1_5778, %e2_5779, %e3_5780 = cute.get_leaves(%iter_5776) : !cute.int_tuple<"(?,?,?,?)">
      %2317 = cute.get_scalars(%e0_5777) : !cute.int_tuple<"?">
      %2318 = cute.get_scalars(%e1_5778) : !cute.int_tuple<"?">
      %2319 = cute.get_scalars(%e2_5779) : !cute.int_tuple<"?">
      %2320 = cute.get_scalars(%e3_5780) : !cute.int_tuple<"?">
      %int_tuple_5781 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5782 = cute.add_offset(%e3_5780, %int_tuple_5781) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2321 = cute.get_scalars(%tup_5782) : !cute.int_tuple<"?">
      %coord_5783 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5784 = cute.make_coord(%tup_5782) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2322 = cute.get_scalars(%coord_5783) : !cute.coord<"?">
      %2323 = cute.get_scalars(%coord_5784) : !cute.coord<"?">
      %true_5785 = arith.constant true
      %2324 = arith.cmpi slt, %2322, %2323 : i32
      %2325 = arith.andi %true_5785, %2324 : i1
      %lay_5786 = cute.get_layout(%2306) : !memref_rmem_f32_4
      %2326 = cute.get_shape(%lay_5786) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5787, %e1_5788, %e2_5789, %e3_5790 = cute.get_leaves(%2326) : !cute.shape<"((2,2),(2,8))">
      %2327 = cute.get_stride(%lay_5786) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5791, %e1_5792, %e2_5793, %e3_5794 = cute.get_leaves(%2327) : !cute.stride<"((2,4),(1,8))">
      %2328 = scf.if %2325 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2306) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,13)">
        cute.memref.store(%2306, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,13)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2306) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2306 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2306) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2306) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2306 : !memref_rmem_f32_4
      }
      %iter_5795 = cute.get_iter(%2328) : !memref_rmem_f32_4
      %lay_5796 = cute.get_layout(%2328) : !memref_rmem_f32_4
      %2329 = cute.get_shape(%lay_5796) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5797, %e1_5798, %e2_5799, %e3_5800 = cute.get_leaves(%2329) : !cute.shape<"((2,2),(2,8))">
      %2330 = cute.get_stride(%lay_5796) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5801, %e1_5802, %e2_5803, %e3_5804 = cute.get_leaves(%2330) : !cute.stride<"((2,4),(1,8))">
      %iter_5805 = cute.get_iter(%2328) : !memref_rmem_f32_4
      %iter_5806 = cute.get_iter(%2328) : !memref_rmem_f32_4
      %coord_5807 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5808 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5809 = cute.crd2idx(%coord_5807, %lay_5808) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5810 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5811 = cute.add_offset(%iter_5810, %idx_5809) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5812 = cute.make_view(%tup_5811) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5813 = cute.get_iter(%view_5812) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5814, %e1_5815, %e2_5816, %e3_5817 = cute.get_leaves(%iter_5813) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2331 = cute.get_scalars(%e0_5814) : !cute.int_tuple<"?">
      %2332 = cute.get_scalars(%e1_5815) : !cute.int_tuple<"?">
      %2333 = cute.get_scalars(%e2_5816) : !cute.int_tuple<"?">
      %2334 = cute.get_scalars(%e3_5817) : !cute.int_tuple<"?{div=2}">
      %iter_5818 = cute.get_iter(%view_5812) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5819, %e1_5820, %e2_5821, %e3_5822 = cute.get_leaves(%iter_5818) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2335 = cute.get_scalars(%e0_5819) : !cute.int_tuple<"?">
      %2336 = cute.get_scalars(%e1_5820) : !cute.int_tuple<"?">
      %2337 = cute.get_scalars(%e2_5821) : !cute.int_tuple<"?">
      %2338 = cute.get_scalars(%e3_5822) : !cute.int_tuple<"?{div=2}">
      %iter_5823 = cute.get_iter(%view_5812) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5824, %e1_5825, %e2_5826, %e3_5827 = cute.get_leaves(%iter_5823) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2339 = cute.get_scalars(%e0_5824) : !cute.int_tuple<"?">
      %2340 = cute.get_scalars(%e1_5825) : !cute.int_tuple<"?">
      %2341 = cute.get_scalars(%e2_5826) : !cute.int_tuple<"?">
      %2342 = cute.get_scalars(%e3_5827) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5828 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5829 = cute.add_offset(%e3_5827, %int_tuple_5828) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2343 = cute.get_scalars(%tup_5829) : !cute.int_tuple<"?">
      %coord_5830 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5831 = cute.make_coord(%tup_5829) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2344 = cute.get_scalars(%coord_5830) : !cute.coord<"?">
      %2345 = cute.get_scalars(%coord_5831) : !cute.coord<"?">
      %true_5832 = arith.constant true
      %2346 = arith.cmpi slt, %2344, %2345 : i32
      %2347 = arith.andi %true_5832, %2346 : i1
      %lay_5833 = cute.get_layout(%2328) : !memref_rmem_f32_4
      %2348 = cute.get_shape(%lay_5833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5834, %e1_5835, %e2_5836, %e3_5837 = cute.get_leaves(%2348) : !cute.shape<"((2,2),(2,8))">
      %2349 = cute.get_stride(%lay_5833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5838, %e1_5839, %e2_5840, %e3_5841 = cute.get_leaves(%2349) : !cute.stride<"((2,4),(1,8))">
      %2350 = scf.if %2347 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2328) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,14)">
        cute.memref.store(%2328, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,14)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2328) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2328 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2328) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2328) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2328 : !memref_rmem_f32_4
      }
      %iter_5842 = cute.get_iter(%2350) : !memref_rmem_f32_4
      %lay_5843 = cute.get_layout(%2350) : !memref_rmem_f32_4
      %2351 = cute.get_shape(%lay_5843) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5844, %e1_5845, %e2_5846, %e3_5847 = cute.get_leaves(%2351) : !cute.shape<"((2,2),(2,8))">
      %2352 = cute.get_stride(%lay_5843) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5848, %e1_5849, %e2_5850, %e3_5851 = cute.get_leaves(%2352) : !cute.stride<"((2,4),(1,8))">
      %iter_5852 = cute.get_iter(%2350) : !memref_rmem_f32_4
      %iter_5853 = cute.get_iter(%2350) : !memref_rmem_f32_4
      %coord_5854 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5855 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5856 = cute.crd2idx(%coord_5854, %lay_5855) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5857 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5858 = cute.add_offset(%iter_5857, %idx_5856) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5859 = cute.make_view(%tup_5858) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5860 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5861, %e1_5862, %e2_5863, %e3_5864 = cute.get_leaves(%iter_5860) : !cute.int_tuple<"(?,?,?,?)">
      %2353 = cute.get_scalars(%e0_5861) : !cute.int_tuple<"?">
      %2354 = cute.get_scalars(%e1_5862) : !cute.int_tuple<"?">
      %2355 = cute.get_scalars(%e2_5863) : !cute.int_tuple<"?">
      %2356 = cute.get_scalars(%e3_5864) : !cute.int_tuple<"?">
      %iter_5865 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5866, %e1_5867, %e2_5868, %e3_5869 = cute.get_leaves(%iter_5865) : !cute.int_tuple<"(?,?,?,?)">
      %2357 = cute.get_scalars(%e0_5866) : !cute.int_tuple<"?">
      %2358 = cute.get_scalars(%e1_5867) : !cute.int_tuple<"?">
      %2359 = cute.get_scalars(%e2_5868) : !cute.int_tuple<"?">
      %2360 = cute.get_scalars(%e3_5869) : !cute.int_tuple<"?">
      %iter_5870 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5871, %e1_5872, %e2_5873, %e3_5874 = cute.get_leaves(%iter_5870) : !cute.int_tuple<"(?,?,?,?)">
      %2361 = cute.get_scalars(%e0_5871) : !cute.int_tuple<"?">
      %2362 = cute.get_scalars(%e1_5872) : !cute.int_tuple<"?">
      %2363 = cute.get_scalars(%e2_5873) : !cute.int_tuple<"?">
      %2364 = cute.get_scalars(%e3_5874) : !cute.int_tuple<"?">
      %int_tuple_5875 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5876 = cute.add_offset(%e3_5874, %int_tuple_5875) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2365 = cute.get_scalars(%tup_5876) : !cute.int_tuple<"?">
      %coord_5877 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5878 = cute.make_coord(%tup_5876) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2366 = cute.get_scalars(%coord_5877) : !cute.coord<"?">
      %2367 = cute.get_scalars(%coord_5878) : !cute.coord<"?">
      %true_5879 = arith.constant true
      %2368 = arith.cmpi slt, %2366, %2367 : i32
      %2369 = arith.andi %true_5879, %2368 : i1
      %lay_5880 = cute.get_layout(%2350) : !memref_rmem_f32_4
      %2370 = cute.get_shape(%lay_5880) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5881, %e1_5882, %e2_5883, %e3_5884 = cute.get_leaves(%2370) : !cute.shape<"((2,2),(2,8))">
      %2371 = cute.get_stride(%lay_5880) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5885, %e1_5886, %e2_5887, %e3_5888 = cute.get_leaves(%2371) : !cute.stride<"((2,4),(1,8))">
      %2372 = scf.if %2369 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2350) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(2,15)">
        cute.memref.store(%2350, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(2,15)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2350) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2350 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2350) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2350) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2350 : !memref_rmem_f32_4
      }
      %iter_5889 = cute.get_iter(%2372) : !memref_rmem_f32_4
      %lay_5890 = cute.get_layout(%2372) : !memref_rmem_f32_4
      %2373 = cute.get_shape(%lay_5890) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5891, %e1_5892, %e2_5893, %e3_5894 = cute.get_leaves(%2373) : !cute.shape<"((2,2),(2,8))">
      %2374 = cute.get_stride(%lay_5890) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5895, %e1_5896, %e2_5897, %e3_5898 = cute.get_leaves(%2374) : !cute.stride<"((2,4),(1,8))">
      %iter_5899 = cute.get_iter(%2372) : !memref_rmem_f32_4
      %iter_5900 = cute.get_iter(%2372) : !memref_rmem_f32_4
      %coord_5901 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5902 = cute.get_layout(%2372) : !memref_rmem_f32_4
      %idx_5903 = cute.crd2idx(%coord_5901, %lay_5902) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5904 = cute.get_iter(%2372) : !memref_rmem_f32_4
      %ptr_5905 = cute.add_offset(%iter_5904, %idx_5903) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5906 = cute.make_view(%ptr_5905) : !memref_rmem_f32_8
      %iter_5907 = cute.get_iter(%view_5906) : !memref_rmem_f32_8
      %lay_5908 = cute.get_layout(%view_5906) : !memref_rmem_f32_8
      %2375 = cute.get_shape(%lay_5908) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5909, %e1_5910 = cute.get_leaves(%2375) : !cute.shape<"((2,8))">
      %2376 = cute.memref.load_vec %view_5906, row_major : !memref_rmem_f32_8
      %cst_5911 = arith.constant 0xFF800000 : f32
      %2377 = vector.reduction <maximumf>, %2376, %cst_5911 : vector<16xf32> into f32
      %c-1_i32_5912 = arith.constant -1 : i32
      %c2_i32_5913 = arith.constant 2 : i32
      %c31_i32_5914 = arith.constant 31 : i32
      %2378 = nvvm.shfl.sync  bfly %c-1_i32_5912, %2377, %c2_i32_5913, %c31_i32_5914 : f32 -> f32
      %2379 = nvvm.fmax %2377, %2378
      %c-1_i32_5915 = arith.constant -1 : i32
      %c1_i32_5916 = arith.constant 1 : i32
      %c31_i32_5917 = arith.constant 31 : i32
      %2380 = nvvm.shfl.sync  bfly %c-1_i32_5915, %2379, %c1_i32_5916, %c31_i32_5917 : f32 -> f32
      %2381 = nvvm.fmax %2379, %2380
      %2382 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2383 = arith.mulf %2376, %2382 : vector<16xf32>
      %2384 = arith.mulf %2381, %arg4 : f32
      %2385 = vector.broadcast %2384 : f32 to vector<16xf32>
      %2386 = arith.subf %2383, %2385 : vector<16xf32>
      %2387 = math.exp2 %2386 fastmath<fast> : vector<16xf32>
      %cst_5918 = arith.constant 0.000000e+00 : f32
      %2388 = vector.reduction <add>, %2387, %cst_5918 : vector<16xf32> into f32
      %coord_5919 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1582, %coord_5919, %2381) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5920 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1587, %coord_5920, %2388) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5921 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5922 = cute.get_layout(%2372) : !memref_rmem_f32_4
      %idx_5923 = cute.crd2idx(%coord_5921, %lay_5922) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5924 = cute.get_iter(%2372) : !memref_rmem_f32_4
      %ptr_5925 = cute.add_offset(%iter_5924, %idx_5923) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5926 = cute.make_view(%ptr_5925) : !memref_rmem_f32_8
      %iter_5927 = cute.get_iter(%view_5926) : !memref_rmem_f32_8
      %lay_5928 = cute.get_layout(%view_5926) : !memref_rmem_f32_8
      %2389 = cute.get_shape(%lay_5928) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5929, %e1_5930 = cute.get_leaves(%2389) : !cute.shape<"((2,8))">
      %int_tuple_5931 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5932 = cute.size(%int_tuple_5931) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5933 = cute.get_leaves(%sz_5932) : !cute.int_tuple<"16">
      %int_tuple_5934 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5935 = cute.size(%int_tuple_5934) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5936 = cute.get_leaves(%sz_5935) : !cute.int_tuple<"16">
      cute.memref.store_vec %2387, %view_5926, row_major : !memref_rmem_f32_8
      %int_tuple_5937 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_5938 = cute.size(%int_tuple_5937) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_5939 = cute.get_leaves(%sz_5938) : !cute.int_tuple<"16">
      %coord_5940 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_5941 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5942 = cute.crd2idx(%coord_5940, %lay_5941) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_5943 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5944 = cute.add_offset(%iter_5943, %idx_5942) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5945 = cute.make_view(%tup_5944) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5946 = cute.get_iter(%view_5945) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5947, %e1_5948, %e2_5949, %e3_5950 = cute.get_leaves(%iter_5946) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2390 = cute.get_scalars(%e0_5947) : !cute.int_tuple<"?">
      %2391 = cute.get_scalars(%e1_5948) : !cute.int_tuple<"?">
      %2392 = cute.get_scalars(%e2_5949) : !cute.int_tuple<"?">
      %2393 = cute.get_scalars(%e3_5950) : !cute.int_tuple<"?{div=2}">
      %iter_5951 = cute.get_iter(%view_5945) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5952, %e1_5953, %e2_5954, %e3_5955 = cute.get_leaves(%iter_5951) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2394 = cute.get_scalars(%e0_5952) : !cute.int_tuple<"?">
      %2395 = cute.get_scalars(%e1_5953) : !cute.int_tuple<"?">
      %2396 = cute.get_scalars(%e2_5954) : !cute.int_tuple<"?">
      %2397 = cute.get_scalars(%e3_5955) : !cute.int_tuple<"?{div=2}">
      %iter_5956 = cute.get_iter(%view_5945) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5957, %e1_5958, %e2_5959, %e3_5960 = cute.get_leaves(%iter_5956) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2398 = cute.get_scalars(%e0_5957) : !cute.int_tuple<"?">
      %2399 = cute.get_scalars(%e1_5958) : !cute.int_tuple<"?">
      %2400 = cute.get_scalars(%e2_5959) : !cute.int_tuple<"?">
      %2401 = cute.get_scalars(%e3_5960) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5961 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5962 = cute.add_offset(%e3_5960, %int_tuple_5961) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2402 = cute.get_scalars(%tup_5962) : !cute.int_tuple<"?">
      %coord_5963 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5964 = cute.make_coord(%tup_5962) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2403 = cute.get_scalars(%coord_5963) : !cute.coord<"?">
      %2404 = cute.get_scalars(%coord_5964) : !cute.coord<"?">
      %true_5965 = arith.constant true
      %2405 = arith.cmpi slt, %2403, %2404 : i32
      %2406 = arith.andi %true_5965, %2405 : i1
      %lay_5966 = cute.get_layout(%2372) : !memref_rmem_f32_4
      %2407 = cute.get_shape(%lay_5966) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5967, %e1_5968, %e2_5969, %e3_5970 = cute.get_leaves(%2407) : !cute.shape<"((2,2),(2,8))">
      %2408 = cute.get_stride(%lay_5966) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5971, %e1_5972, %e2_5973, %e3_5974 = cute.get_leaves(%2408) : !cute.stride<"((2,4),(1,8))">
      %2409 = scf.if %2406 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2372) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,0)">
        cute.memref.store(%2372, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,0)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2372) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2372 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2372) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2372) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2372 : !memref_rmem_f32_4
      }
      %iter_5975 = cute.get_iter(%2409) : !memref_rmem_f32_4
      %lay_5976 = cute.get_layout(%2409) : !memref_rmem_f32_4
      %2410 = cute.get_shape(%lay_5976) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5977, %e1_5978, %e2_5979, %e3_5980 = cute.get_leaves(%2410) : !cute.shape<"((2,2),(2,8))">
      %2411 = cute.get_stride(%lay_5976) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5981, %e1_5982, %e2_5983, %e3_5984 = cute.get_leaves(%2411) : !cute.stride<"((2,4),(1,8))">
      %iter_5985 = cute.get_iter(%2409) : !memref_rmem_f32_4
      %iter_5986 = cute.get_iter(%2409) : !memref_rmem_f32_4
      %coord_5987 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_5988 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5989 = cute.crd2idx(%coord_5987, %lay_5988) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_5990 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5991 = cute.add_offset(%iter_5990, %idx_5989) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5992 = cute.make_view(%tup_5991) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5993 = cute.get_iter(%view_5992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5994, %e1_5995, %e2_5996, %e3_5997 = cute.get_leaves(%iter_5993) : !cute.int_tuple<"(?,?,?,?)">
      %2412 = cute.get_scalars(%e0_5994) : !cute.int_tuple<"?">
      %2413 = cute.get_scalars(%e1_5995) : !cute.int_tuple<"?">
      %2414 = cute.get_scalars(%e2_5996) : !cute.int_tuple<"?">
      %2415 = cute.get_scalars(%e3_5997) : !cute.int_tuple<"?">
      %iter_5998 = cute.get_iter(%view_5992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5999, %e1_6000, %e2_6001, %e3_6002 = cute.get_leaves(%iter_5998) : !cute.int_tuple<"(?,?,?,?)">
      %2416 = cute.get_scalars(%e0_5999) : !cute.int_tuple<"?">
      %2417 = cute.get_scalars(%e1_6000) : !cute.int_tuple<"?">
      %2418 = cute.get_scalars(%e2_6001) : !cute.int_tuple<"?">
      %2419 = cute.get_scalars(%e3_6002) : !cute.int_tuple<"?">
      %iter_6003 = cute.get_iter(%view_5992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6004, %e1_6005, %e2_6006, %e3_6007 = cute.get_leaves(%iter_6003) : !cute.int_tuple<"(?,?,?,?)">
      %2420 = cute.get_scalars(%e0_6004) : !cute.int_tuple<"?">
      %2421 = cute.get_scalars(%e1_6005) : !cute.int_tuple<"?">
      %2422 = cute.get_scalars(%e2_6006) : !cute.int_tuple<"?">
      %2423 = cute.get_scalars(%e3_6007) : !cute.int_tuple<"?">
      %int_tuple_6008 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6009 = cute.add_offset(%e3_6007, %int_tuple_6008) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2424 = cute.get_scalars(%tup_6009) : !cute.int_tuple<"?">
      %coord_6010 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6011 = cute.make_coord(%tup_6009) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2425 = cute.get_scalars(%coord_6010) : !cute.coord<"?">
      %2426 = cute.get_scalars(%coord_6011) : !cute.coord<"?">
      %true_6012 = arith.constant true
      %2427 = arith.cmpi slt, %2425, %2426 : i32
      %2428 = arith.andi %true_6012, %2427 : i1
      %lay_6013 = cute.get_layout(%2409) : !memref_rmem_f32_4
      %2429 = cute.get_shape(%lay_6013) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6014, %e1_6015, %e2_6016, %e3_6017 = cute.get_leaves(%2429) : !cute.shape<"((2,2),(2,8))">
      %2430 = cute.get_stride(%lay_6013) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6018, %e1_6019, %e2_6020, %e3_6021 = cute.get_leaves(%2430) : !cute.stride<"((2,4),(1,8))">
      %2431 = scf.if %2428 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2409) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,1)">
        cute.memref.store(%2409, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,1)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2409) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2409 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2409) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2409) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2409 : !memref_rmem_f32_4
      }
      %iter_6022 = cute.get_iter(%2431) : !memref_rmem_f32_4
      %lay_6023 = cute.get_layout(%2431) : !memref_rmem_f32_4
      %2432 = cute.get_shape(%lay_6023) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6024, %e1_6025, %e2_6026, %e3_6027 = cute.get_leaves(%2432) : !cute.shape<"((2,2),(2,8))">
      %2433 = cute.get_stride(%lay_6023) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6028, %e1_6029, %e2_6030, %e3_6031 = cute.get_leaves(%2433) : !cute.stride<"((2,4),(1,8))">
      %iter_6032 = cute.get_iter(%2431) : !memref_rmem_f32_4
      %iter_6033 = cute.get_iter(%2431) : !memref_rmem_f32_4
      %coord_6034 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_6035 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6036 = cute.crd2idx(%coord_6034, %lay_6035) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_6037 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6038 = cute.add_offset(%iter_6037, %idx_6036) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6039 = cute.make_view(%tup_6038) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6040 = cute.get_iter(%view_6039) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6041, %e1_6042, %e2_6043, %e3_6044 = cute.get_leaves(%iter_6040) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2434 = cute.get_scalars(%e0_6041) : !cute.int_tuple<"?">
      %2435 = cute.get_scalars(%e1_6042) : !cute.int_tuple<"?">
      %2436 = cute.get_scalars(%e2_6043) : !cute.int_tuple<"?">
      %2437 = cute.get_scalars(%e3_6044) : !cute.int_tuple<"?{div=2}">
      %iter_6045 = cute.get_iter(%view_6039) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6046, %e1_6047, %e2_6048, %e3_6049 = cute.get_leaves(%iter_6045) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2438 = cute.get_scalars(%e0_6046) : !cute.int_tuple<"?">
      %2439 = cute.get_scalars(%e1_6047) : !cute.int_tuple<"?">
      %2440 = cute.get_scalars(%e2_6048) : !cute.int_tuple<"?">
      %2441 = cute.get_scalars(%e3_6049) : !cute.int_tuple<"?{div=2}">
      %iter_6050 = cute.get_iter(%view_6039) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6051, %e1_6052, %e2_6053, %e3_6054 = cute.get_leaves(%iter_6050) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2442 = cute.get_scalars(%e0_6051) : !cute.int_tuple<"?">
      %2443 = cute.get_scalars(%e1_6052) : !cute.int_tuple<"?">
      %2444 = cute.get_scalars(%e2_6053) : !cute.int_tuple<"?">
      %2445 = cute.get_scalars(%e3_6054) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6055 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6056 = cute.add_offset(%e3_6054, %int_tuple_6055) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2446 = cute.get_scalars(%tup_6056) : !cute.int_tuple<"?">
      %coord_6057 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6058 = cute.make_coord(%tup_6056) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2447 = cute.get_scalars(%coord_6057) : !cute.coord<"?">
      %2448 = cute.get_scalars(%coord_6058) : !cute.coord<"?">
      %true_6059 = arith.constant true
      %2449 = arith.cmpi slt, %2447, %2448 : i32
      %2450 = arith.andi %true_6059, %2449 : i1
      %lay_6060 = cute.get_layout(%2431) : !memref_rmem_f32_4
      %2451 = cute.get_shape(%lay_6060) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6061, %e1_6062, %e2_6063, %e3_6064 = cute.get_leaves(%2451) : !cute.shape<"((2,2),(2,8))">
      %2452 = cute.get_stride(%lay_6060) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6065, %e1_6066, %e2_6067, %e3_6068 = cute.get_leaves(%2452) : !cute.stride<"((2,4),(1,8))">
      %2453 = scf.if %2450 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2431) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,2)">
        cute.memref.store(%2431, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,2)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2431) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2431 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2431) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2431) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2431 : !memref_rmem_f32_4
      }
      %iter_6069 = cute.get_iter(%2453) : !memref_rmem_f32_4
      %lay_6070 = cute.get_layout(%2453) : !memref_rmem_f32_4
      %2454 = cute.get_shape(%lay_6070) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6071, %e1_6072, %e2_6073, %e3_6074 = cute.get_leaves(%2454) : !cute.shape<"((2,2),(2,8))">
      %2455 = cute.get_stride(%lay_6070) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6075, %e1_6076, %e2_6077, %e3_6078 = cute.get_leaves(%2455) : !cute.stride<"((2,4),(1,8))">
      %iter_6079 = cute.get_iter(%2453) : !memref_rmem_f32_4
      %iter_6080 = cute.get_iter(%2453) : !memref_rmem_f32_4
      %coord_6081 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_6082 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6083 = cute.crd2idx(%coord_6081, %lay_6082) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_6084 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6085 = cute.add_offset(%iter_6084, %idx_6083) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6086 = cute.make_view(%tup_6085) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6087 = cute.get_iter(%view_6086) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6088, %e1_6089, %e2_6090, %e3_6091 = cute.get_leaves(%iter_6087) : !cute.int_tuple<"(?,?,?,?)">
      %2456 = cute.get_scalars(%e0_6088) : !cute.int_tuple<"?">
      %2457 = cute.get_scalars(%e1_6089) : !cute.int_tuple<"?">
      %2458 = cute.get_scalars(%e2_6090) : !cute.int_tuple<"?">
      %2459 = cute.get_scalars(%e3_6091) : !cute.int_tuple<"?">
      %iter_6092 = cute.get_iter(%view_6086) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6093, %e1_6094, %e2_6095, %e3_6096 = cute.get_leaves(%iter_6092) : !cute.int_tuple<"(?,?,?,?)">
      %2460 = cute.get_scalars(%e0_6093) : !cute.int_tuple<"?">
      %2461 = cute.get_scalars(%e1_6094) : !cute.int_tuple<"?">
      %2462 = cute.get_scalars(%e2_6095) : !cute.int_tuple<"?">
      %2463 = cute.get_scalars(%e3_6096) : !cute.int_tuple<"?">
      %iter_6097 = cute.get_iter(%view_6086) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6098, %e1_6099, %e2_6100, %e3_6101 = cute.get_leaves(%iter_6097) : !cute.int_tuple<"(?,?,?,?)">
      %2464 = cute.get_scalars(%e0_6098) : !cute.int_tuple<"?">
      %2465 = cute.get_scalars(%e1_6099) : !cute.int_tuple<"?">
      %2466 = cute.get_scalars(%e2_6100) : !cute.int_tuple<"?">
      %2467 = cute.get_scalars(%e3_6101) : !cute.int_tuple<"?">
      %int_tuple_6102 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6103 = cute.add_offset(%e3_6101, %int_tuple_6102) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2468 = cute.get_scalars(%tup_6103) : !cute.int_tuple<"?">
      %coord_6104 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6105 = cute.make_coord(%tup_6103) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2469 = cute.get_scalars(%coord_6104) : !cute.coord<"?">
      %2470 = cute.get_scalars(%coord_6105) : !cute.coord<"?">
      %true_6106 = arith.constant true
      %2471 = arith.cmpi slt, %2469, %2470 : i32
      %2472 = arith.andi %true_6106, %2471 : i1
      %lay_6107 = cute.get_layout(%2453) : !memref_rmem_f32_4
      %2473 = cute.get_shape(%lay_6107) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6108, %e1_6109, %e2_6110, %e3_6111 = cute.get_leaves(%2473) : !cute.shape<"((2,2),(2,8))">
      %2474 = cute.get_stride(%lay_6107) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6112, %e1_6113, %e2_6114, %e3_6115 = cute.get_leaves(%2474) : !cute.stride<"((2,4),(1,8))">
      %2475 = scf.if %2472 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2453) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,3)">
        cute.memref.store(%2453, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,3)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2453) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2453 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2453) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2453) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2453 : !memref_rmem_f32_4
      }
      %iter_6116 = cute.get_iter(%2475) : !memref_rmem_f32_4
      %lay_6117 = cute.get_layout(%2475) : !memref_rmem_f32_4
      %2476 = cute.get_shape(%lay_6117) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6118, %e1_6119, %e2_6120, %e3_6121 = cute.get_leaves(%2476) : !cute.shape<"((2,2),(2,8))">
      %2477 = cute.get_stride(%lay_6117) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6122, %e1_6123, %e2_6124, %e3_6125 = cute.get_leaves(%2477) : !cute.stride<"((2,4),(1,8))">
      %iter_6126 = cute.get_iter(%2475) : !memref_rmem_f32_4
      %iter_6127 = cute.get_iter(%2475) : !memref_rmem_f32_4
      %coord_6128 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_6129 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6130 = cute.crd2idx(%coord_6128, %lay_6129) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_6131 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6132 = cute.add_offset(%iter_6131, %idx_6130) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6133 = cute.make_view(%tup_6132) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6134 = cute.get_iter(%view_6133) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6135, %e1_6136, %e2_6137, %e3_6138 = cute.get_leaves(%iter_6134) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2478 = cute.get_scalars(%e0_6135) : !cute.int_tuple<"?">
      %2479 = cute.get_scalars(%e1_6136) : !cute.int_tuple<"?">
      %2480 = cute.get_scalars(%e2_6137) : !cute.int_tuple<"?">
      %2481 = cute.get_scalars(%e3_6138) : !cute.int_tuple<"?{div=2}">
      %iter_6139 = cute.get_iter(%view_6133) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6140, %e1_6141, %e2_6142, %e3_6143 = cute.get_leaves(%iter_6139) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2482 = cute.get_scalars(%e0_6140) : !cute.int_tuple<"?">
      %2483 = cute.get_scalars(%e1_6141) : !cute.int_tuple<"?">
      %2484 = cute.get_scalars(%e2_6142) : !cute.int_tuple<"?">
      %2485 = cute.get_scalars(%e3_6143) : !cute.int_tuple<"?{div=2}">
      %iter_6144 = cute.get_iter(%view_6133) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6145, %e1_6146, %e2_6147, %e3_6148 = cute.get_leaves(%iter_6144) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2486 = cute.get_scalars(%e0_6145) : !cute.int_tuple<"?">
      %2487 = cute.get_scalars(%e1_6146) : !cute.int_tuple<"?">
      %2488 = cute.get_scalars(%e2_6147) : !cute.int_tuple<"?">
      %2489 = cute.get_scalars(%e3_6148) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6149 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6150 = cute.add_offset(%e3_6148, %int_tuple_6149) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2490 = cute.get_scalars(%tup_6150) : !cute.int_tuple<"?">
      %coord_6151 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6152 = cute.make_coord(%tup_6150) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2491 = cute.get_scalars(%coord_6151) : !cute.coord<"?">
      %2492 = cute.get_scalars(%coord_6152) : !cute.coord<"?">
      %true_6153 = arith.constant true
      %2493 = arith.cmpi slt, %2491, %2492 : i32
      %2494 = arith.andi %true_6153, %2493 : i1
      %lay_6154 = cute.get_layout(%2475) : !memref_rmem_f32_4
      %2495 = cute.get_shape(%lay_6154) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6155, %e1_6156, %e2_6157, %e3_6158 = cute.get_leaves(%2495) : !cute.shape<"((2,2),(2,8))">
      %2496 = cute.get_stride(%lay_6154) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6159, %e1_6160, %e2_6161, %e3_6162 = cute.get_leaves(%2496) : !cute.stride<"((2,4),(1,8))">
      %2497 = scf.if %2494 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2475) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,4)">
        cute.memref.store(%2475, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,4)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2475) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2475 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2475) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2475) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2475 : !memref_rmem_f32_4
      }
      %iter_6163 = cute.get_iter(%2497) : !memref_rmem_f32_4
      %lay_6164 = cute.get_layout(%2497) : !memref_rmem_f32_4
      %2498 = cute.get_shape(%lay_6164) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6165, %e1_6166, %e2_6167, %e3_6168 = cute.get_leaves(%2498) : !cute.shape<"((2,2),(2,8))">
      %2499 = cute.get_stride(%lay_6164) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6169, %e1_6170, %e2_6171, %e3_6172 = cute.get_leaves(%2499) : !cute.stride<"((2,4),(1,8))">
      %iter_6173 = cute.get_iter(%2497) : !memref_rmem_f32_4
      %iter_6174 = cute.get_iter(%2497) : !memref_rmem_f32_4
      %coord_6175 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_6176 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6177 = cute.crd2idx(%coord_6175, %lay_6176) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_6178 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6179 = cute.add_offset(%iter_6178, %idx_6177) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6180 = cute.make_view(%tup_6179) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6181 = cute.get_iter(%view_6180) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6182, %e1_6183, %e2_6184, %e3_6185 = cute.get_leaves(%iter_6181) : !cute.int_tuple<"(?,?,?,?)">
      %2500 = cute.get_scalars(%e0_6182) : !cute.int_tuple<"?">
      %2501 = cute.get_scalars(%e1_6183) : !cute.int_tuple<"?">
      %2502 = cute.get_scalars(%e2_6184) : !cute.int_tuple<"?">
      %2503 = cute.get_scalars(%e3_6185) : !cute.int_tuple<"?">
      %iter_6186 = cute.get_iter(%view_6180) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6187, %e1_6188, %e2_6189, %e3_6190 = cute.get_leaves(%iter_6186) : !cute.int_tuple<"(?,?,?,?)">
      %2504 = cute.get_scalars(%e0_6187) : !cute.int_tuple<"?">
      %2505 = cute.get_scalars(%e1_6188) : !cute.int_tuple<"?">
      %2506 = cute.get_scalars(%e2_6189) : !cute.int_tuple<"?">
      %2507 = cute.get_scalars(%e3_6190) : !cute.int_tuple<"?">
      %iter_6191 = cute.get_iter(%view_6180) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6192, %e1_6193, %e2_6194, %e3_6195 = cute.get_leaves(%iter_6191) : !cute.int_tuple<"(?,?,?,?)">
      %2508 = cute.get_scalars(%e0_6192) : !cute.int_tuple<"?">
      %2509 = cute.get_scalars(%e1_6193) : !cute.int_tuple<"?">
      %2510 = cute.get_scalars(%e2_6194) : !cute.int_tuple<"?">
      %2511 = cute.get_scalars(%e3_6195) : !cute.int_tuple<"?">
      %int_tuple_6196 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6197 = cute.add_offset(%e3_6195, %int_tuple_6196) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2512 = cute.get_scalars(%tup_6197) : !cute.int_tuple<"?">
      %coord_6198 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6199 = cute.make_coord(%tup_6197) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2513 = cute.get_scalars(%coord_6198) : !cute.coord<"?">
      %2514 = cute.get_scalars(%coord_6199) : !cute.coord<"?">
      %true_6200 = arith.constant true
      %2515 = arith.cmpi slt, %2513, %2514 : i32
      %2516 = arith.andi %true_6200, %2515 : i1
      %lay_6201 = cute.get_layout(%2497) : !memref_rmem_f32_4
      %2517 = cute.get_shape(%lay_6201) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6202, %e1_6203, %e2_6204, %e3_6205 = cute.get_leaves(%2517) : !cute.shape<"((2,2),(2,8))">
      %2518 = cute.get_stride(%lay_6201) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6206, %e1_6207, %e2_6208, %e3_6209 = cute.get_leaves(%2518) : !cute.stride<"((2,4),(1,8))">
      %2519 = scf.if %2516 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2497) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,5)">
        cute.memref.store(%2497, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,5)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2497) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2497 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2497) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2497) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2497 : !memref_rmem_f32_4
      }
      %iter_6210 = cute.get_iter(%2519) : !memref_rmem_f32_4
      %lay_6211 = cute.get_layout(%2519) : !memref_rmem_f32_4
      %2520 = cute.get_shape(%lay_6211) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6212, %e1_6213, %e2_6214, %e3_6215 = cute.get_leaves(%2520) : !cute.shape<"((2,2),(2,8))">
      %2521 = cute.get_stride(%lay_6211) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6216, %e1_6217, %e2_6218, %e3_6219 = cute.get_leaves(%2521) : !cute.stride<"((2,4),(1,8))">
      %iter_6220 = cute.get_iter(%2519) : !memref_rmem_f32_4
      %iter_6221 = cute.get_iter(%2519) : !memref_rmem_f32_4
      %coord_6222 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_6223 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6224 = cute.crd2idx(%coord_6222, %lay_6223) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_6225 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6226 = cute.add_offset(%iter_6225, %idx_6224) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6227 = cute.make_view(%tup_6226) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6228 = cute.get_iter(%view_6227) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6229, %e1_6230, %e2_6231, %e3_6232 = cute.get_leaves(%iter_6228) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2522 = cute.get_scalars(%e0_6229) : !cute.int_tuple<"?">
      %2523 = cute.get_scalars(%e1_6230) : !cute.int_tuple<"?">
      %2524 = cute.get_scalars(%e2_6231) : !cute.int_tuple<"?">
      %2525 = cute.get_scalars(%e3_6232) : !cute.int_tuple<"?{div=2}">
      %iter_6233 = cute.get_iter(%view_6227) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6234, %e1_6235, %e2_6236, %e3_6237 = cute.get_leaves(%iter_6233) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2526 = cute.get_scalars(%e0_6234) : !cute.int_tuple<"?">
      %2527 = cute.get_scalars(%e1_6235) : !cute.int_tuple<"?">
      %2528 = cute.get_scalars(%e2_6236) : !cute.int_tuple<"?">
      %2529 = cute.get_scalars(%e3_6237) : !cute.int_tuple<"?{div=2}">
      %iter_6238 = cute.get_iter(%view_6227) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6239, %e1_6240, %e2_6241, %e3_6242 = cute.get_leaves(%iter_6238) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2530 = cute.get_scalars(%e0_6239) : !cute.int_tuple<"?">
      %2531 = cute.get_scalars(%e1_6240) : !cute.int_tuple<"?">
      %2532 = cute.get_scalars(%e2_6241) : !cute.int_tuple<"?">
      %2533 = cute.get_scalars(%e3_6242) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6243 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6244 = cute.add_offset(%e3_6242, %int_tuple_6243) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2534 = cute.get_scalars(%tup_6244) : !cute.int_tuple<"?">
      %coord_6245 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6246 = cute.make_coord(%tup_6244) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2535 = cute.get_scalars(%coord_6245) : !cute.coord<"?">
      %2536 = cute.get_scalars(%coord_6246) : !cute.coord<"?">
      %true_6247 = arith.constant true
      %2537 = arith.cmpi slt, %2535, %2536 : i32
      %2538 = arith.andi %true_6247, %2537 : i1
      %lay_6248 = cute.get_layout(%2519) : !memref_rmem_f32_4
      %2539 = cute.get_shape(%lay_6248) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6249, %e1_6250, %e2_6251, %e3_6252 = cute.get_leaves(%2539) : !cute.shape<"((2,2),(2,8))">
      %2540 = cute.get_stride(%lay_6248) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6253, %e1_6254, %e2_6255, %e3_6256 = cute.get_leaves(%2540) : !cute.stride<"((2,4),(1,8))">
      %2541 = scf.if %2538 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2519) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,6)">
        cute.memref.store(%2519, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,6)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2519) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2519 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2519) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2519) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2519 : !memref_rmem_f32_4
      }
      %iter_6257 = cute.get_iter(%2541) : !memref_rmem_f32_4
      %lay_6258 = cute.get_layout(%2541) : !memref_rmem_f32_4
      %2542 = cute.get_shape(%lay_6258) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6259, %e1_6260, %e2_6261, %e3_6262 = cute.get_leaves(%2542) : !cute.shape<"((2,2),(2,8))">
      %2543 = cute.get_stride(%lay_6258) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6263, %e1_6264, %e2_6265, %e3_6266 = cute.get_leaves(%2543) : !cute.stride<"((2,4),(1,8))">
      %iter_6267 = cute.get_iter(%2541) : !memref_rmem_f32_4
      %iter_6268 = cute.get_iter(%2541) : !memref_rmem_f32_4
      %coord_6269 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_6270 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6271 = cute.crd2idx(%coord_6269, %lay_6270) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_6272 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6273 = cute.add_offset(%iter_6272, %idx_6271) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6274 = cute.make_view(%tup_6273) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6275 = cute.get_iter(%view_6274) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6276, %e1_6277, %e2_6278, %e3_6279 = cute.get_leaves(%iter_6275) : !cute.int_tuple<"(?,?,?,?)">
      %2544 = cute.get_scalars(%e0_6276) : !cute.int_tuple<"?">
      %2545 = cute.get_scalars(%e1_6277) : !cute.int_tuple<"?">
      %2546 = cute.get_scalars(%e2_6278) : !cute.int_tuple<"?">
      %2547 = cute.get_scalars(%e3_6279) : !cute.int_tuple<"?">
      %iter_6280 = cute.get_iter(%view_6274) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6281, %e1_6282, %e2_6283, %e3_6284 = cute.get_leaves(%iter_6280) : !cute.int_tuple<"(?,?,?,?)">
      %2548 = cute.get_scalars(%e0_6281) : !cute.int_tuple<"?">
      %2549 = cute.get_scalars(%e1_6282) : !cute.int_tuple<"?">
      %2550 = cute.get_scalars(%e2_6283) : !cute.int_tuple<"?">
      %2551 = cute.get_scalars(%e3_6284) : !cute.int_tuple<"?">
      %iter_6285 = cute.get_iter(%view_6274) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6286, %e1_6287, %e2_6288, %e3_6289 = cute.get_leaves(%iter_6285) : !cute.int_tuple<"(?,?,?,?)">
      %2552 = cute.get_scalars(%e0_6286) : !cute.int_tuple<"?">
      %2553 = cute.get_scalars(%e1_6287) : !cute.int_tuple<"?">
      %2554 = cute.get_scalars(%e2_6288) : !cute.int_tuple<"?">
      %2555 = cute.get_scalars(%e3_6289) : !cute.int_tuple<"?">
      %int_tuple_6290 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6291 = cute.add_offset(%e3_6289, %int_tuple_6290) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2556 = cute.get_scalars(%tup_6291) : !cute.int_tuple<"?">
      %coord_6292 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6293 = cute.make_coord(%tup_6291) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2557 = cute.get_scalars(%coord_6292) : !cute.coord<"?">
      %2558 = cute.get_scalars(%coord_6293) : !cute.coord<"?">
      %true_6294 = arith.constant true
      %2559 = arith.cmpi slt, %2557, %2558 : i32
      %2560 = arith.andi %true_6294, %2559 : i1
      %lay_6295 = cute.get_layout(%2541) : !memref_rmem_f32_4
      %2561 = cute.get_shape(%lay_6295) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6296, %e1_6297, %e2_6298, %e3_6299 = cute.get_leaves(%2561) : !cute.shape<"((2,2),(2,8))">
      %2562 = cute.get_stride(%lay_6295) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6300, %e1_6301, %e2_6302, %e3_6303 = cute.get_leaves(%2562) : !cute.stride<"((2,4),(1,8))">
      %2563 = scf.if %2560 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2541) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,7)">
        cute.memref.store(%2541, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,7)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2541) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2541 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2541) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2541) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2541 : !memref_rmem_f32_4
      }
      %iter_6304 = cute.get_iter(%2563) : !memref_rmem_f32_4
      %lay_6305 = cute.get_layout(%2563) : !memref_rmem_f32_4
      %2564 = cute.get_shape(%lay_6305) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6306, %e1_6307, %e2_6308, %e3_6309 = cute.get_leaves(%2564) : !cute.shape<"((2,2),(2,8))">
      %2565 = cute.get_stride(%lay_6305) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6310, %e1_6311, %e2_6312, %e3_6313 = cute.get_leaves(%2565) : !cute.stride<"((2,4),(1,8))">
      %iter_6314 = cute.get_iter(%2563) : !memref_rmem_f32_4
      %iter_6315 = cute.get_iter(%2563) : !memref_rmem_f32_4
      %coord_6316 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_6317 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6318 = cute.crd2idx(%coord_6316, %lay_6317) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_6319 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6320 = cute.add_offset(%iter_6319, %idx_6318) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6321 = cute.make_view(%tup_6320) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6322 = cute.get_iter(%view_6321) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6323, %e1_6324, %e2_6325, %e3_6326 = cute.get_leaves(%iter_6322) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2566 = cute.get_scalars(%e0_6323) : !cute.int_tuple<"?">
      %2567 = cute.get_scalars(%e1_6324) : !cute.int_tuple<"?">
      %2568 = cute.get_scalars(%e2_6325) : !cute.int_tuple<"?">
      %2569 = cute.get_scalars(%e3_6326) : !cute.int_tuple<"?{div=2}">
      %iter_6327 = cute.get_iter(%view_6321) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6328, %e1_6329, %e2_6330, %e3_6331 = cute.get_leaves(%iter_6327) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2570 = cute.get_scalars(%e0_6328) : !cute.int_tuple<"?">
      %2571 = cute.get_scalars(%e1_6329) : !cute.int_tuple<"?">
      %2572 = cute.get_scalars(%e2_6330) : !cute.int_tuple<"?">
      %2573 = cute.get_scalars(%e3_6331) : !cute.int_tuple<"?{div=2}">
      %iter_6332 = cute.get_iter(%view_6321) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6333, %e1_6334, %e2_6335, %e3_6336 = cute.get_leaves(%iter_6332) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2574 = cute.get_scalars(%e0_6333) : !cute.int_tuple<"?">
      %2575 = cute.get_scalars(%e1_6334) : !cute.int_tuple<"?">
      %2576 = cute.get_scalars(%e2_6335) : !cute.int_tuple<"?">
      %2577 = cute.get_scalars(%e3_6336) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6337 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6338 = cute.add_offset(%e3_6336, %int_tuple_6337) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2578 = cute.get_scalars(%tup_6338) : !cute.int_tuple<"?">
      %coord_6339 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6340 = cute.make_coord(%tup_6338) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2579 = cute.get_scalars(%coord_6339) : !cute.coord<"?">
      %2580 = cute.get_scalars(%coord_6340) : !cute.coord<"?">
      %true_6341 = arith.constant true
      %2581 = arith.cmpi slt, %2579, %2580 : i32
      %2582 = arith.andi %true_6341, %2581 : i1
      %lay_6342 = cute.get_layout(%2563) : !memref_rmem_f32_4
      %2583 = cute.get_shape(%lay_6342) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6343, %e1_6344, %e2_6345, %e3_6346 = cute.get_leaves(%2583) : !cute.shape<"((2,2),(2,8))">
      %2584 = cute.get_stride(%lay_6342) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6347, %e1_6348, %e2_6349, %e3_6350 = cute.get_leaves(%2584) : !cute.stride<"((2,4),(1,8))">
      %2585 = scf.if %2582 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2563) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,8)">
        cute.memref.store(%2563, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,8)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2563) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2563 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2563) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2563) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2563 : !memref_rmem_f32_4
      }
      %iter_6351 = cute.get_iter(%2585) : !memref_rmem_f32_4
      %lay_6352 = cute.get_layout(%2585) : !memref_rmem_f32_4
      %2586 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2586) : !cute.shape<"((2,2),(2,8))">
      %2587 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2587) : !cute.stride<"((2,4),(1,8))">
      %iter_6361 = cute.get_iter(%2585) : !memref_rmem_f32_4
      %iter_6362 = cute.get_iter(%2585) : !memref_rmem_f32_4
      %coord_6363 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_6364 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6365 = cute.crd2idx(%coord_6363, %lay_6364) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_6366 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6367 = cute.add_offset(%iter_6366, %idx_6365) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6368 = cute.make_view(%tup_6367) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6369 = cute.get_iter(%view_6368) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6370, %e1_6371, %e2_6372, %e3_6373 = cute.get_leaves(%iter_6369) : !cute.int_tuple<"(?,?,?,?)">
      %2588 = cute.get_scalars(%e0_6370) : !cute.int_tuple<"?">
      %2589 = cute.get_scalars(%e1_6371) : !cute.int_tuple<"?">
      %2590 = cute.get_scalars(%e2_6372) : !cute.int_tuple<"?">
      %2591 = cute.get_scalars(%e3_6373) : !cute.int_tuple<"?">
      %iter_6374 = cute.get_iter(%view_6368) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6375, %e1_6376, %e2_6377, %e3_6378 = cute.get_leaves(%iter_6374) : !cute.int_tuple<"(?,?,?,?)">
      %2592 = cute.get_scalars(%e0_6375) : !cute.int_tuple<"?">
      %2593 = cute.get_scalars(%e1_6376) : !cute.int_tuple<"?">
      %2594 = cute.get_scalars(%e2_6377) : !cute.int_tuple<"?">
      %2595 = cute.get_scalars(%e3_6378) : !cute.int_tuple<"?">
      %iter_6379 = cute.get_iter(%view_6368) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6380, %e1_6381, %e2_6382, %e3_6383 = cute.get_leaves(%iter_6379) : !cute.int_tuple<"(?,?,?,?)">
      %2596 = cute.get_scalars(%e0_6380) : !cute.int_tuple<"?">
      %2597 = cute.get_scalars(%e1_6381) : !cute.int_tuple<"?">
      %2598 = cute.get_scalars(%e2_6382) : !cute.int_tuple<"?">
      %2599 = cute.get_scalars(%e3_6383) : !cute.int_tuple<"?">
      %int_tuple_6384 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6385 = cute.add_offset(%e3_6383, %int_tuple_6384) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2600 = cute.get_scalars(%tup_6385) : !cute.int_tuple<"?">
      %coord_6386 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6387 = cute.make_coord(%tup_6385) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2601 = cute.get_scalars(%coord_6386) : !cute.coord<"?">
      %2602 = cute.get_scalars(%coord_6387) : !cute.coord<"?">
      %true_6388 = arith.constant true
      %2603 = arith.cmpi slt, %2601, %2602 : i32
      %2604 = arith.andi %true_6388, %2603 : i1
      %lay_6389 = cute.get_layout(%2585) : !memref_rmem_f32_4
      %2605 = cute.get_shape(%lay_6389) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6390, %e1_6391, %e2_6392, %e3_6393 = cute.get_leaves(%2605) : !cute.shape<"((2,2),(2,8))">
      %2606 = cute.get_stride(%lay_6389) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6394, %e1_6395, %e2_6396, %e3_6397 = cute.get_leaves(%2606) : !cute.stride<"((2,4),(1,8))">
      %2607 = scf.if %2604 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2585) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,9)">
        cute.memref.store(%2585, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,9)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2585) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2585 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2585) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2585) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2585 : !memref_rmem_f32_4
      }
      %iter_6398 = cute.get_iter(%2607) : !memref_rmem_f32_4
      %lay_6399 = cute.get_layout(%2607) : !memref_rmem_f32_4
      %2608 = cute.get_shape(%lay_6399) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6400, %e1_6401, %e2_6402, %e3_6403 = cute.get_leaves(%2608) : !cute.shape<"((2,2),(2,8))">
      %2609 = cute.get_stride(%lay_6399) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6404, %e1_6405, %e2_6406, %e3_6407 = cute.get_leaves(%2609) : !cute.stride<"((2,4),(1,8))">
      %iter_6408 = cute.get_iter(%2607) : !memref_rmem_f32_4
      %iter_6409 = cute.get_iter(%2607) : !memref_rmem_f32_4
      %coord_6410 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_6411 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6412 = cute.crd2idx(%coord_6410, %lay_6411) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_6413 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6414 = cute.add_offset(%iter_6413, %idx_6412) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6415 = cute.make_view(%tup_6414) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6416 = cute.get_iter(%view_6415) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6417, %e1_6418, %e2_6419, %e3_6420 = cute.get_leaves(%iter_6416) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2610 = cute.get_scalars(%e0_6417) : !cute.int_tuple<"?">
      %2611 = cute.get_scalars(%e1_6418) : !cute.int_tuple<"?">
      %2612 = cute.get_scalars(%e2_6419) : !cute.int_tuple<"?">
      %2613 = cute.get_scalars(%e3_6420) : !cute.int_tuple<"?{div=2}">
      %iter_6421 = cute.get_iter(%view_6415) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6422, %e1_6423, %e2_6424, %e3_6425 = cute.get_leaves(%iter_6421) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2614 = cute.get_scalars(%e0_6422) : !cute.int_tuple<"?">
      %2615 = cute.get_scalars(%e1_6423) : !cute.int_tuple<"?">
      %2616 = cute.get_scalars(%e2_6424) : !cute.int_tuple<"?">
      %2617 = cute.get_scalars(%e3_6425) : !cute.int_tuple<"?{div=2}">
      %iter_6426 = cute.get_iter(%view_6415) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6427, %e1_6428, %e2_6429, %e3_6430 = cute.get_leaves(%iter_6426) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2618 = cute.get_scalars(%e0_6427) : !cute.int_tuple<"?">
      %2619 = cute.get_scalars(%e1_6428) : !cute.int_tuple<"?">
      %2620 = cute.get_scalars(%e2_6429) : !cute.int_tuple<"?">
      %2621 = cute.get_scalars(%e3_6430) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6431 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6432 = cute.add_offset(%e3_6430, %int_tuple_6431) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2622 = cute.get_scalars(%tup_6432) : !cute.int_tuple<"?">
      %coord_6433 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6434 = cute.make_coord(%tup_6432) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2623 = cute.get_scalars(%coord_6433) : !cute.coord<"?">
      %2624 = cute.get_scalars(%coord_6434) : !cute.coord<"?">
      %true_6435 = arith.constant true
      %2625 = arith.cmpi slt, %2623, %2624 : i32
      %2626 = arith.andi %true_6435, %2625 : i1
      %lay_6436 = cute.get_layout(%2607) : !memref_rmem_f32_4
      %2627 = cute.get_shape(%lay_6436) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6437, %e1_6438, %e2_6439, %e3_6440 = cute.get_leaves(%2627) : !cute.shape<"((2,2),(2,8))">
      %2628 = cute.get_stride(%lay_6436) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6441, %e1_6442, %e2_6443, %e3_6444 = cute.get_leaves(%2628) : !cute.stride<"((2,4),(1,8))">
      %2629 = scf.if %2626 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2607) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,10)">
        cute.memref.store(%2607, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,10)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2607) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2607 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2607) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2607) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2607 : !memref_rmem_f32_4
      }
      %iter_6445 = cute.get_iter(%2629) : !memref_rmem_f32_4
      %lay_6446 = cute.get_layout(%2629) : !memref_rmem_f32_4
      %2630 = cute.get_shape(%lay_6446) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6447, %e1_6448, %e2_6449, %e3_6450 = cute.get_leaves(%2630) : !cute.shape<"((2,2),(2,8))">
      %2631 = cute.get_stride(%lay_6446) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6451, %e1_6452, %e2_6453, %e3_6454 = cute.get_leaves(%2631) : !cute.stride<"((2,4),(1,8))">
      %iter_6455 = cute.get_iter(%2629) : !memref_rmem_f32_4
      %iter_6456 = cute.get_iter(%2629) : !memref_rmem_f32_4
      %coord_6457 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_6458 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6459 = cute.crd2idx(%coord_6457, %lay_6458) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_6460 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6461 = cute.add_offset(%iter_6460, %idx_6459) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6462 = cute.make_view(%tup_6461) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6463 = cute.get_iter(%view_6462) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6464, %e1_6465, %e2_6466, %e3_6467 = cute.get_leaves(%iter_6463) : !cute.int_tuple<"(?,?,?,?)">
      %2632 = cute.get_scalars(%e0_6464) : !cute.int_tuple<"?">
      %2633 = cute.get_scalars(%e1_6465) : !cute.int_tuple<"?">
      %2634 = cute.get_scalars(%e2_6466) : !cute.int_tuple<"?">
      %2635 = cute.get_scalars(%e3_6467) : !cute.int_tuple<"?">
      %iter_6468 = cute.get_iter(%view_6462) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6469, %e1_6470, %e2_6471, %e3_6472 = cute.get_leaves(%iter_6468) : !cute.int_tuple<"(?,?,?,?)">
      %2636 = cute.get_scalars(%e0_6469) : !cute.int_tuple<"?">
      %2637 = cute.get_scalars(%e1_6470) : !cute.int_tuple<"?">
      %2638 = cute.get_scalars(%e2_6471) : !cute.int_tuple<"?">
      %2639 = cute.get_scalars(%e3_6472) : !cute.int_tuple<"?">
      %iter_6473 = cute.get_iter(%view_6462) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6474, %e1_6475, %e2_6476, %e3_6477 = cute.get_leaves(%iter_6473) : !cute.int_tuple<"(?,?,?,?)">
      %2640 = cute.get_scalars(%e0_6474) : !cute.int_tuple<"?">
      %2641 = cute.get_scalars(%e1_6475) : !cute.int_tuple<"?">
      %2642 = cute.get_scalars(%e2_6476) : !cute.int_tuple<"?">
      %2643 = cute.get_scalars(%e3_6477) : !cute.int_tuple<"?">
      %int_tuple_6478 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6479 = cute.add_offset(%e3_6477, %int_tuple_6478) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2644 = cute.get_scalars(%tup_6479) : !cute.int_tuple<"?">
      %coord_6480 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6481 = cute.make_coord(%tup_6479) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2645 = cute.get_scalars(%coord_6480) : !cute.coord<"?">
      %2646 = cute.get_scalars(%coord_6481) : !cute.coord<"?">
      %true_6482 = arith.constant true
      %2647 = arith.cmpi slt, %2645, %2646 : i32
      %2648 = arith.andi %true_6482, %2647 : i1
      %lay_6483 = cute.get_layout(%2629) : !memref_rmem_f32_4
      %2649 = cute.get_shape(%lay_6483) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6484, %e1_6485, %e2_6486, %e3_6487 = cute.get_leaves(%2649) : !cute.shape<"((2,2),(2,8))">
      %2650 = cute.get_stride(%lay_6483) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6488, %e1_6489, %e2_6490, %e3_6491 = cute.get_leaves(%2650) : !cute.stride<"((2,4),(1,8))">
      %2651 = scf.if %2648 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2629) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,11)">
        cute.memref.store(%2629, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,11)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2629) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2629 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2629) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2629) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2629 : !memref_rmem_f32_4
      }
      %iter_6492 = cute.get_iter(%2651) : !memref_rmem_f32_4
      %lay_6493 = cute.get_layout(%2651) : !memref_rmem_f32_4
      %2652 = cute.get_shape(%lay_6493) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6494, %e1_6495, %e2_6496, %e3_6497 = cute.get_leaves(%2652) : !cute.shape<"((2,2),(2,8))">
      %2653 = cute.get_stride(%lay_6493) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6498, %e1_6499, %e2_6500, %e3_6501 = cute.get_leaves(%2653) : !cute.stride<"((2,4),(1,8))">
      %iter_6502 = cute.get_iter(%2651) : !memref_rmem_f32_4
      %iter_6503 = cute.get_iter(%2651) : !memref_rmem_f32_4
      %coord_6504 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_6505 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6506 = cute.crd2idx(%coord_6504, %lay_6505) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_6507 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6508 = cute.add_offset(%iter_6507, %idx_6506) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6509 = cute.make_view(%tup_6508) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6510 = cute.get_iter(%view_6509) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6511, %e1_6512, %e2_6513, %e3_6514 = cute.get_leaves(%iter_6510) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2654 = cute.get_scalars(%e0_6511) : !cute.int_tuple<"?">
      %2655 = cute.get_scalars(%e1_6512) : !cute.int_tuple<"?">
      %2656 = cute.get_scalars(%e2_6513) : !cute.int_tuple<"?">
      %2657 = cute.get_scalars(%e3_6514) : !cute.int_tuple<"?{div=2}">
      %iter_6515 = cute.get_iter(%view_6509) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6516, %e1_6517, %e2_6518, %e3_6519 = cute.get_leaves(%iter_6515) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2658 = cute.get_scalars(%e0_6516) : !cute.int_tuple<"?">
      %2659 = cute.get_scalars(%e1_6517) : !cute.int_tuple<"?">
      %2660 = cute.get_scalars(%e2_6518) : !cute.int_tuple<"?">
      %2661 = cute.get_scalars(%e3_6519) : !cute.int_tuple<"?{div=2}">
      %iter_6520 = cute.get_iter(%view_6509) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6521, %e1_6522, %e2_6523, %e3_6524 = cute.get_leaves(%iter_6520) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2662 = cute.get_scalars(%e0_6521) : !cute.int_tuple<"?">
      %2663 = cute.get_scalars(%e1_6522) : !cute.int_tuple<"?">
      %2664 = cute.get_scalars(%e2_6523) : !cute.int_tuple<"?">
      %2665 = cute.get_scalars(%e3_6524) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6525 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6526 = cute.add_offset(%e3_6524, %int_tuple_6525) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2666 = cute.get_scalars(%tup_6526) : !cute.int_tuple<"?">
      %coord_6527 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6528 = cute.make_coord(%tup_6526) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2667 = cute.get_scalars(%coord_6527) : !cute.coord<"?">
      %2668 = cute.get_scalars(%coord_6528) : !cute.coord<"?">
      %true_6529 = arith.constant true
      %2669 = arith.cmpi slt, %2667, %2668 : i32
      %2670 = arith.andi %true_6529, %2669 : i1
      %lay_6530 = cute.get_layout(%2651) : !memref_rmem_f32_4
      %2671 = cute.get_shape(%lay_6530) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6531, %e1_6532, %e2_6533, %e3_6534 = cute.get_leaves(%2671) : !cute.shape<"((2,2),(2,8))">
      %2672 = cute.get_stride(%lay_6530) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6535, %e1_6536, %e2_6537, %e3_6538 = cute.get_leaves(%2672) : !cute.stride<"((2,4),(1,8))">
      %2673 = scf.if %2670 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2651) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,12)">
        cute.memref.store(%2651, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,12)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2651) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2651 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2651) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2651) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2651 : !memref_rmem_f32_4
      }
      %iter_6539 = cute.get_iter(%2673) : !memref_rmem_f32_4
      %lay_6540 = cute.get_layout(%2673) : !memref_rmem_f32_4
      %2674 = cute.get_shape(%lay_6540) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6541, %e1_6542, %e2_6543, %e3_6544 = cute.get_leaves(%2674) : !cute.shape<"((2,2),(2,8))">
      %2675 = cute.get_stride(%lay_6540) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6545, %e1_6546, %e2_6547, %e3_6548 = cute.get_leaves(%2675) : !cute.stride<"((2,4),(1,8))">
      %iter_6549 = cute.get_iter(%2673) : !memref_rmem_f32_4
      %iter_6550 = cute.get_iter(%2673) : !memref_rmem_f32_4
      %coord_6551 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_6552 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6553 = cute.crd2idx(%coord_6551, %lay_6552) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_6554 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6555 = cute.add_offset(%iter_6554, %idx_6553) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6556 = cute.make_view(%tup_6555) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6557 = cute.get_iter(%view_6556) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6558, %e1_6559, %e2_6560, %e3_6561 = cute.get_leaves(%iter_6557) : !cute.int_tuple<"(?,?,?,?)">
      %2676 = cute.get_scalars(%e0_6558) : !cute.int_tuple<"?">
      %2677 = cute.get_scalars(%e1_6559) : !cute.int_tuple<"?">
      %2678 = cute.get_scalars(%e2_6560) : !cute.int_tuple<"?">
      %2679 = cute.get_scalars(%e3_6561) : !cute.int_tuple<"?">
      %iter_6562 = cute.get_iter(%view_6556) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6563, %e1_6564, %e2_6565, %e3_6566 = cute.get_leaves(%iter_6562) : !cute.int_tuple<"(?,?,?,?)">
      %2680 = cute.get_scalars(%e0_6563) : !cute.int_tuple<"?">
      %2681 = cute.get_scalars(%e1_6564) : !cute.int_tuple<"?">
      %2682 = cute.get_scalars(%e2_6565) : !cute.int_tuple<"?">
      %2683 = cute.get_scalars(%e3_6566) : !cute.int_tuple<"?">
      %iter_6567 = cute.get_iter(%view_6556) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6568, %e1_6569, %e2_6570, %e3_6571 = cute.get_leaves(%iter_6567) : !cute.int_tuple<"(?,?,?,?)">
      %2684 = cute.get_scalars(%e0_6568) : !cute.int_tuple<"?">
      %2685 = cute.get_scalars(%e1_6569) : !cute.int_tuple<"?">
      %2686 = cute.get_scalars(%e2_6570) : !cute.int_tuple<"?">
      %2687 = cute.get_scalars(%e3_6571) : !cute.int_tuple<"?">
      %int_tuple_6572 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6573 = cute.add_offset(%e3_6571, %int_tuple_6572) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2688 = cute.get_scalars(%tup_6573) : !cute.int_tuple<"?">
      %coord_6574 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6575 = cute.make_coord(%tup_6573) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2689 = cute.get_scalars(%coord_6574) : !cute.coord<"?">
      %2690 = cute.get_scalars(%coord_6575) : !cute.coord<"?">
      %true_6576 = arith.constant true
      %2691 = arith.cmpi slt, %2689, %2690 : i32
      %2692 = arith.andi %true_6576, %2691 : i1
      %lay_6577 = cute.get_layout(%2673) : !memref_rmem_f32_4
      %2693 = cute.get_shape(%lay_6577) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6578, %e1_6579, %e2_6580, %e3_6581 = cute.get_leaves(%2693) : !cute.shape<"((2,2),(2,8))">
      %2694 = cute.get_stride(%lay_6577) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6582, %e1_6583, %e2_6584, %e3_6585 = cute.get_leaves(%2694) : !cute.stride<"((2,4),(1,8))">
      %2695 = scf.if %2692 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2673) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,13)">
        cute.memref.store(%2673, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,13)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2673) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2673 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2673) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2673) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2673 : !memref_rmem_f32_4
      }
      %iter_6586 = cute.get_iter(%2695) : !memref_rmem_f32_4
      %lay_6587 = cute.get_layout(%2695) : !memref_rmem_f32_4
      %2696 = cute.get_shape(%lay_6587) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6588, %e1_6589, %e2_6590, %e3_6591 = cute.get_leaves(%2696) : !cute.shape<"((2,2),(2,8))">
      %2697 = cute.get_stride(%lay_6587) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6592, %e1_6593, %e2_6594, %e3_6595 = cute.get_leaves(%2697) : !cute.stride<"((2,4),(1,8))">
      %iter_6596 = cute.get_iter(%2695) : !memref_rmem_f32_4
      %iter_6597 = cute.get_iter(%2695) : !memref_rmem_f32_4
      %coord_6598 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_6599 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6600 = cute.crd2idx(%coord_6598, %lay_6599) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_6601 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6602 = cute.add_offset(%iter_6601, %idx_6600) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6603 = cute.make_view(%tup_6602) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6604 = cute.get_iter(%view_6603) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6605, %e1_6606, %e2_6607, %e3_6608 = cute.get_leaves(%iter_6604) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2698 = cute.get_scalars(%e0_6605) : !cute.int_tuple<"?">
      %2699 = cute.get_scalars(%e1_6606) : !cute.int_tuple<"?">
      %2700 = cute.get_scalars(%e2_6607) : !cute.int_tuple<"?">
      %2701 = cute.get_scalars(%e3_6608) : !cute.int_tuple<"?{div=2}">
      %iter_6609 = cute.get_iter(%view_6603) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6610, %e1_6611, %e2_6612, %e3_6613 = cute.get_leaves(%iter_6609) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2702 = cute.get_scalars(%e0_6610) : !cute.int_tuple<"?">
      %2703 = cute.get_scalars(%e1_6611) : !cute.int_tuple<"?">
      %2704 = cute.get_scalars(%e2_6612) : !cute.int_tuple<"?">
      %2705 = cute.get_scalars(%e3_6613) : !cute.int_tuple<"?{div=2}">
      %iter_6614 = cute.get_iter(%view_6603) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6615, %e1_6616, %e2_6617, %e3_6618 = cute.get_leaves(%iter_6614) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2706 = cute.get_scalars(%e0_6615) : !cute.int_tuple<"?">
      %2707 = cute.get_scalars(%e1_6616) : !cute.int_tuple<"?">
      %2708 = cute.get_scalars(%e2_6617) : !cute.int_tuple<"?">
      %2709 = cute.get_scalars(%e3_6618) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6619 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6620 = cute.add_offset(%e3_6618, %int_tuple_6619) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2710 = cute.get_scalars(%tup_6620) : !cute.int_tuple<"?">
      %coord_6621 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6622 = cute.make_coord(%tup_6620) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2711 = cute.get_scalars(%coord_6621) : !cute.coord<"?">
      %2712 = cute.get_scalars(%coord_6622) : !cute.coord<"?">
      %true_6623 = arith.constant true
      %2713 = arith.cmpi slt, %2711, %2712 : i32
      %2714 = arith.andi %true_6623, %2713 : i1
      %lay_6624 = cute.get_layout(%2695) : !memref_rmem_f32_4
      %2715 = cute.get_shape(%lay_6624) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6625, %e1_6626, %e2_6627, %e3_6628 = cute.get_leaves(%2715) : !cute.shape<"((2,2),(2,8))">
      %2716 = cute.get_stride(%lay_6624) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6629, %e1_6630, %e2_6631, %e3_6632 = cute.get_leaves(%2716) : !cute.stride<"((2,4),(1,8))">
      %2717 = scf.if %2714 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2695) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,14)">
        cute.memref.store(%2695, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,14)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2695) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2695 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2695) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2695) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2695 : !memref_rmem_f32_4
      }
      %iter_6633 = cute.get_iter(%2717) : !memref_rmem_f32_4
      %lay_6634 = cute.get_layout(%2717) : !memref_rmem_f32_4
      %2718 = cute.get_shape(%lay_6634) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6635, %e1_6636, %e2_6637, %e3_6638 = cute.get_leaves(%2718) : !cute.shape<"((2,2),(2,8))">
      %2719 = cute.get_stride(%lay_6634) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6639, %e1_6640, %e2_6641, %e3_6642 = cute.get_leaves(%2719) : !cute.stride<"((2,4),(1,8))">
      %iter_6643 = cute.get_iter(%2717) : !memref_rmem_f32_4
      %iter_6644 = cute.get_iter(%2717) : !memref_rmem_f32_4
      %coord_6645 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_6646 = cute.get_layout(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6647 = cute.crd2idx(%coord_6645, %lay_6646) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_6648 = cute.get_iter(%view_3552) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6649 = cute.add_offset(%iter_6648, %idx_6647) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6650 = cute.make_view(%tup_6649) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6651 = cute.get_iter(%view_6650) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6652, %e1_6653, %e2_6654, %e3_6655 = cute.get_leaves(%iter_6651) : !cute.int_tuple<"(?,?,?,?)">
      %2720 = cute.get_scalars(%e0_6652) : !cute.int_tuple<"?">
      %2721 = cute.get_scalars(%e1_6653) : !cute.int_tuple<"?">
      %2722 = cute.get_scalars(%e2_6654) : !cute.int_tuple<"?">
      %2723 = cute.get_scalars(%e3_6655) : !cute.int_tuple<"?">
      %iter_6656 = cute.get_iter(%view_6650) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6657, %e1_6658, %e2_6659, %e3_6660 = cute.get_leaves(%iter_6656) : !cute.int_tuple<"(?,?,?,?)">
      %2724 = cute.get_scalars(%e0_6657) : !cute.int_tuple<"?">
      %2725 = cute.get_scalars(%e1_6658) : !cute.int_tuple<"?">
      %2726 = cute.get_scalars(%e2_6659) : !cute.int_tuple<"?">
      %2727 = cute.get_scalars(%e3_6660) : !cute.int_tuple<"?">
      %iter_6661 = cute.get_iter(%view_6650) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6662, %e1_6663, %e2_6664, %e3_6665 = cute.get_leaves(%iter_6661) : !cute.int_tuple<"(?,?,?,?)">
      %2728 = cute.get_scalars(%e0_6662) : !cute.int_tuple<"?">
      %2729 = cute.get_scalars(%e1_6663) : !cute.int_tuple<"?">
      %2730 = cute.get_scalars(%e2_6664) : !cute.int_tuple<"?">
      %2731 = cute.get_scalars(%e3_6665) : !cute.int_tuple<"?">
      %int_tuple_6666 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6667 = cute.add_offset(%e3_6665, %int_tuple_6666) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2732 = cute.get_scalars(%tup_6667) : !cute.int_tuple<"?">
      %coord_6668 = cute.make_coord(%itup_3442) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6669 = cute.make_coord(%tup_6667) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2733 = cute.get_scalars(%coord_6668) : !cute.coord<"?">
      %2734 = cute.get_scalars(%coord_6669) : !cute.coord<"?">
      %true_6670 = arith.constant true
      %2735 = arith.cmpi slt, %2733, %2734 : i32
      %2736 = arith.andi %true_6670, %2735 : i1
      %lay_6671 = cute.get_layout(%2717) : !memref_rmem_f32_4
      %2737 = cute.get_shape(%lay_6671) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6672, %e1_6673, %e2_6674, %e3_6675 = cute.get_leaves(%2737) : !cute.shape<"((2,2),(2,8))">
      %2738 = cute.get_stride(%lay_6671) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6676, %e1_6677, %e2_6678, %e3_6679 = cute.get_leaves(%2738) : !cute.stride<"((2,4),(1,8))">
      %2739 = scf.if %2736 -> (!memref_rmem_f32_4) {
        %iter_8494 = cute.get_iter(%2717) : !memref_rmem_f32_4
        %cst_8495 = arith.constant 0xFF800000 : f32
        %coord_8496 = cute.make_coord() : () -> !cute.coord<"(3,15)">
        cute.memref.store(%2717, %coord_8496, %cst_8495) : (!memref_rmem_f32_4, !cute.coord<"(3,15)">, f32) -> ()
        %lay_8497 = cute.get_layout(%2717) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8498, %e1_8499, %e2_8500, %e3_8501 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8497) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8502, %e1_8503, %e2_8504, %e3_8505 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2717 : !memref_rmem_f32_4
      } else {
        %iter_8494 = cute.get_iter(%2717) : !memref_rmem_f32_4
        %lay_8495 = cute.get_layout(%2717) : !memref_rmem_f32_4
        %3370 = cute.get_shape(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8496, %e1_8497, %e2_8498, %e3_8499 = cute.get_leaves(%3370) : !cute.shape<"((2,2),(2,8))">
        %3371 = cute.get_stride(%lay_8495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8500, %e1_8501, %e2_8502, %e3_8503 = cute.get_leaves(%3371) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2717 : !memref_rmem_f32_4
      }
      %iter_6680 = cute.get_iter(%2739) : !memref_rmem_f32_4
      %lay_6681 = cute.get_layout(%2739) : !memref_rmem_f32_4
      %2740 = cute.get_shape(%lay_6681) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6682, %e1_6683, %e2_6684, %e3_6685 = cute.get_leaves(%2740) : !cute.shape<"((2,2),(2,8))">
      %2741 = cute.get_stride(%lay_6681) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6686, %e1_6687, %e2_6688, %e3_6689 = cute.get_leaves(%2741) : !cute.stride<"((2,4),(1,8))">
      %iter_6690 = cute.get_iter(%2739) : !memref_rmem_f32_4
      %iter_6691 = cute.get_iter(%2739) : !memref_rmem_f32_4
      %coord_6692 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6693 = cute.get_layout(%2739) : !memref_rmem_f32_4
      %idx_6694 = cute.crd2idx(%coord_6692, %lay_6693) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6695 = cute.get_iter(%2739) : !memref_rmem_f32_4
      %ptr_6696 = cute.add_offset(%iter_6695, %idx_6694) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6697 = cute.make_view(%ptr_6696) : !memref_rmem_f32_7
      %iter_6698 = cute.get_iter(%view_6697) : !memref_rmem_f32_7
      %lay_6699 = cute.get_layout(%view_6697) : !memref_rmem_f32_7
      %2742 = cute.get_shape(%lay_6699) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6700, %e1_6701 = cute.get_leaves(%2742) : !cute.shape<"((2,8))">
      %2743 = cute.memref.load_vec %view_6697, row_major : !memref_rmem_f32_7
      %cst_6702 = arith.constant 0xFF800000 : f32
      %2744 = vector.reduction <maximumf>, %2743, %cst_6702 : vector<16xf32> into f32
      %c-1_i32_6703 = arith.constant -1 : i32
      %c2_i32_6704 = arith.constant 2 : i32
      %c31_i32_6705 = arith.constant 31 : i32
      %2745 = nvvm.shfl.sync  bfly %c-1_i32_6703, %2744, %c2_i32_6704, %c31_i32_6705 : f32 -> f32
      %2746 = nvvm.fmax %2744, %2745
      %c-1_i32_6706 = arith.constant -1 : i32
      %c1_i32_6707 = arith.constant 1 : i32
      %c31_i32_6708 = arith.constant 31 : i32
      %2747 = nvvm.shfl.sync  bfly %c-1_i32_6706, %2746, %c1_i32_6707, %c31_i32_6708 : f32 -> f32
      %2748 = nvvm.fmax %2746, %2747
      %2749 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2750 = arith.mulf %2743, %2749 : vector<16xf32>
      %2751 = arith.mulf %2748, %arg4 : f32
      %2752 = vector.broadcast %2751 : f32 to vector<16xf32>
      %2753 = arith.subf %2750, %2752 : vector<16xf32>
      %2754 = math.exp2 %2753 fastmath<fast> : vector<16xf32>
      %cst_6709 = arith.constant 0.000000e+00 : f32
      %2755 = vector.reduction <add>, %2754, %cst_6709 : vector<16xf32> into f32
      %coord_6710 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1582, %coord_6710, %2748) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6711 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1587, %coord_6711, %2755) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6712 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6713 = cute.get_layout(%2739) : !memref_rmem_f32_4
      %idx_6714 = cute.crd2idx(%coord_6712, %lay_6713) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6715 = cute.get_iter(%2739) : !memref_rmem_f32_4
      %ptr_6716 = cute.add_offset(%iter_6715, %idx_6714) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6717 = cute.make_view(%ptr_6716) : !memref_rmem_f32_7
      %iter_6718 = cute.get_iter(%view_6717) : !memref_rmem_f32_7
      %lay_6719 = cute.get_layout(%view_6717) : !memref_rmem_f32_7
      %2756 = cute.get_shape(%lay_6719) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6720, %e1_6721 = cute.get_leaves(%2756) : !cute.shape<"((2,8))">
      %int_tuple_6722 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6723 = cute.size(%int_tuple_6722) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6724 = cute.get_leaves(%sz_6723) : !cute.int_tuple<"16">
      %int_tuple_6725 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6726 = cute.size(%int_tuple_6725) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6727 = cute.get_leaves(%sz_6726) : !cute.int_tuple<"16">
      cute.memref.store_vec %2754, %view_6717, row_major : !memref_rmem_f32_7
      %lay_6728 = cute.get_layout(%rmem_1623) : !memref_rmem_f32_2
      %lay_6729 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_6730 = cute.memref.alloca(%lay_6729) : !memref_rmem_bf16_16
      %iter_6731 = cute.get_iter(%rmem_6730) : !memref_rmem_bf16_16
      %iter_6732 = cute.get_iter(%rmem_6730) : !memref_rmem_bf16_16
      %2757 = cute.memref.load_vec %rmem_1623, row_major : !memref_rmem_f32_2
      %2758 = arith.truncf %2757 : vector<64xf32> to vector<64xbf16>
      %lay_6733 = cute.get_layout(%rmem_6730) : !memref_rmem_bf16_16
      %2759 = cute.get_shape(%lay_6733) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_6734, %e1_6735, %e2_6736, %e3_6737 = cute.get_leaves(%2759) : !cute.shape<"((2,2),2,8)">
      %int_tuple_6738 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6739 = cute.size(%int_tuple_6738) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6740 = cute.get_leaves(%sz_6739) : !cute.int_tuple<"64">
      %int_tuple_6741 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6742 = cute.size(%int_tuple_6741) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6743 = cute.get_leaves(%sz_6742) : !cute.int_tuple<"64">
      cute.memref.store_vec %2758, %rmem_6730, row_major : !memref_rmem_bf16_16
      %lay_6744 = cute.get_layout(%rmem_6730) : !memref_rmem_bf16_16
      %tile_6745 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
      %lay_6746 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
      %2760 = cute.get_shape(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6747, %e1_6748, %e2_6749, %e3_6750, %e4_6751 = cute.get_leaves(%2760) : !cute.shape<"((2,2),2,(2,4))">
      %2761 = cute.get_shape(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6752, %e1_6753, %e2_6754, %e3_6755, %e4_6756 = cute.get_leaves(%2761) : !cute.shape<"((2,2),2,(2,4))">
      %2762 = cute.get_shape(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6757, %e1_6758, %e2_6759, %e3_6760, %e4_6761 = cute.get_leaves(%2762) : !cute.shape<"((2,2),2,(2,4))">
      %2763 = cute.get_shape(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6762, %e1_6763, %e2_6764, %e3_6765, %e4_6766 = cute.get_leaves(%2763) : !cute.shape<"((2,2),2,(2,4))">
      %2764 = cute.get_stride(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6767, %e1_6768, %e2_6769, %e3_6770, %e4_6771 = cute.get_leaves(%2764) : !cute.stride<"((1,2),4,(8,16))">
      %2765 = cute.get_stride(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6772, %e1_6773, %e2_6774, %e3_6775, %e4_6776 = cute.get_leaves(%2765) : !cute.stride<"((1,2),4,(8,16))">
      %2766 = cute.get_stride(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6777, %e1_6778, %e2_6779, %e3_6780, %e4_6781 = cute.get_leaves(%2766) : !cute.stride<"((1,2),4,(8,16))">
      %2767 = cute.get_stride(%lay_6746) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6782, %e1_6783, %e2_6784, %e3_6785, %e4_6786 = cute.get_leaves(%2767) : !cute.stride<"((1,2),4,(8,16))">
      %shape_6787 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
      %stride_6788 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
      %lay_6789 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
      %view_6790 = cute.make_view(%iter_6732, %lay_6789) : !memref_rmem_bf16_17
      %iter_6791 = cute.get_iter(%view_6790) : !memref_rmem_bf16_17
      %coord_6792 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6793 = cute.get_layout(%view_859) : !memref_smem_bf16_10
      %2768:2 = cute.get_scalars(%lay_6793) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_6794 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_6795 = cute.assume(%2768#0) : (i32) -> !cute.i32<divby 16>
      %iv_6796 = cute.assume(%2768#1) : (i32) -> !cute.i32<divby 32>
      %stride_6797 = cute.make_stride(%iv_6795, %iv_6796) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_6798 = cute.make_layout(%shape_6794, %stride_6797) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_6799 = cute.crd2idx(%coord_6792, %lay_6793) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6800 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %ptr_6801 = cute.add_offset(%iter_6800, %idx_6799) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6802 = cute.make_view(%ptr_6801, %lay_6798) : !memref_smem_bf16_19
      %iter_6803 = cute.get_iter(%view_6802) : !memref_smem_bf16_19
      %coord_6804 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6805 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
      %idx_6806 = cute.crd2idx(%coord_6804, %lay_6805) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6807 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %ptr_6808 = cute.add_offset(%iter_6807, %idx_6806) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6809 = cute.make_view(%ptr_6808) : !memref_rmem_bf16_18
      %iter_6810 = cute.get_iter(%view_6809) : !memref_rmem_bf16_18
      %lay_6811 = cute.get_layout(%view_6802) : !memref_smem_bf16_19
      %2769 = cute.get_shape(%lay_6811) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6812, %e1_6813, %e2_6814, %e3_6815, %e4_6816 = cute.get_leaves(%2769) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6817 = cute.get_layout(%view_6809) : !memref_rmem_bf16_18
      %2770 = cute.get_shape(%lay_6817) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6818, %e1_6819, %e2_6820, %e3_6821 = cute.get_leaves(%2770) : !cute.shape<"((8,1),(4,2))">
      %lay_6822 = cute.get_layout(%view_6802) : !memref_smem_bf16_19
      %shape_6823 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6824 = cute.make_layout() : !cute.layout<"1:0">
      %append_6825 = cute.append_to_rank<2> (%lay_6822, %lay_6824) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6826 = cute.make_view(%iter_6803, %append_6825) : !memref_smem_bf16_19
      %iter_6827 = cute.get_iter(%view_6826) : !memref_smem_bf16_19
      %lay_6828 = cute.get_layout(%view_6826) : !memref_smem_bf16_19
      %2771 = cute.get_shape(%lay_6828) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6829, %e1_6830, %e2_6831, %e3_6832, %e4_6833 = cute.get_leaves(%2771) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6834 = cute.get_iter(%view_6826) : !memref_smem_bf16_19
      %lay_6835 = cute.get_layout(%view_6826) : !memref_smem_bf16_19
      %2772:2 = cute.get_scalars(%lay_6835) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6836 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6837 = cute.assume(%2772#0) : (i32) -> !cute.i32<divby 16>
      %iv_6838 = cute.assume(%2772#1) : (i32) -> !cute.i32<divby 32>
      %stride_6839 = cute.make_stride(%iv_6837, %iv_6838) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6840 = cute.make_layout(%shape_6836, %stride_6839) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6841 = cute.make_view(%iter_6834, %lay_6840) : !memref_smem_bf16_20
      %iter_6842 = cute.get_iter(%view_6841) : !memref_smem_bf16_20
      %iter_6843 = cute.get_iter(%view_6841) : !memref_smem_bf16_20
      %lay_6844 = cute.get_layout(%view_6809) : !memref_rmem_bf16_18
      %shape_6845 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6846 = cute.make_layout() : !cute.layout<"1:0">
      %append_6847 = cute.append_to_rank<2> (%lay_6844, %lay_6846) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6848 = cute.make_view(%iter_6810, %append_6847) : !memref_rmem_bf16_18
      %iter_6849 = cute.get_iter(%view_6848) : !memref_rmem_bf16_18
      %lay_6850 = cute.get_layout(%view_6848) : !memref_rmem_bf16_18
      %2773 = cute.get_shape(%lay_6850) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6851, %e1_6852, %e2_6853, %e3_6854 = cute.get_leaves(%2773) : !cute.shape<"((8,1),(4,2))">
      %iter_6855 = cute.get_iter(%view_6848) : !memref_rmem_bf16_18
      %view_6856 = cute.make_view(%iter_6855) : !memref_rmem_bf16_19
      %iter_6857 = cute.get_iter(%view_6856) : !memref_rmem_bf16_19
      %iter_6858 = cute.get_iter(%view_6856) : !memref_rmem_bf16_19
      %lay_6859 = cute.get_layout(%view_6841) : !memref_smem_bf16_20
      %2774 = cute.get_shape(%lay_6859) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6860, %e1_6861, %e2_6862, %e3_6863, %e4_6864 = cute.get_leaves(%2774) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6865 = cute.get_layout(%view_6856) : !memref_rmem_bf16_19
      %2775 = cute.get_shape(%lay_6865) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6866, %e1_6867, %e2_6868, %e3_6869 = cute.get_leaves(%2775) : !cute.shape<"((8,1),((4,2)))">
      %lay_6870 = cute.get_layout(%view_6841) : !memref_smem_bf16_20
      %sz_6871 = cute.size(%lay_6870) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6872 = cute.get_leaves(%sz_6871) : !cute.int_tuple<"8">
      %lay_6873 = cute.get_layout(%view_6856) : !memref_rmem_bf16_19
      %sz_6874 = cute.size(%lay_6873) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6875 = cute.get_leaves(%sz_6874) : !cute.int_tuple<"8">
      %2776 = cute.static : !cute.layout<"1:0">
      %iter_6876 = cute.get_iter(%view_6841) : !memref_smem_bf16_20
      %iter_6877 = cute.get_iter(%view_6856) : !memref_rmem_bf16_19
      %lay_6878 = cute.get_layout(%view_6841) : !memref_smem_bf16_20
      %lay_6879 = cute.get_layout(%view_6856) : !memref_rmem_bf16_19
      %append_6880 = cute.append_to_rank<2> (%lay_6878, %2776) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6881 = cute.append_to_rank<2> (%lay_6879, %2776) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2777:2 = cute.get_scalars(%append_6880) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6882 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6883 = cute.assume(%2777#0) : (i32) -> !cute.i32<divby 16>
      %iv_6884 = cute.assume(%2777#1) : (i32) -> !cute.i32<divby 32>
      %stride_6885 = cute.make_stride(%iv_6883, %iv_6884) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6886 = cute.make_layout(%shape_6882, %stride_6885) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6887 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6888 = cute.size(%lay_6886) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2778 = cute.get_scalars(%sz_6888) : !cute.int_tuple<"8">
      %c0_i32_6889 = arith.constant 0 : i32
      %c1_i32_6890 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6889 to %2778 step %c1_i32_6890  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370:2 = cute.get_scalars(%lay_6886) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_6886) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8497 = cute.add_offset(%iter_6876, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_6887) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_6877, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3373 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3374 = llvm.mlir.constant(0 : i32) : i32
        %3375 = vector.extractelement %3373[%3374 : i32] : vector<4xi32>
        %3376 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3375, %3376 : i32, !llvm.ptr
        %3377 = llvm.mlir.constant(1 : i32) : i32
        %3378 = vector.extractelement %3373[%3377 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3379 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3378, %3379 : i32, !llvm.ptr
        %3380 = llvm.mlir.constant(2 : i32) : i32
        %3381 = vector.extractelement %3373[%3380 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3382 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3381, %3382 : i32, !llvm.ptr
        %3383 = llvm.mlir.constant(3 : i32) : i32
        %3384 = vector.extractelement %3373[%3383 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3384, %3385 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_6891 = cute.get_layout(%view_6790) : !memref_rmem_bf16_17
      %2779 = cute.get_shape(%lay_6891) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
      %e0_6892, %e1_6893, %e2_6894, %e3_6895, %e4_6896 = cute.get_leaves(%2779) : !cute.shape<"(((2,2),2),2,4)">
      %int_tuple_6897 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6898 = cute.size(%int_tuple_6897) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6899 = cute.get_leaves(%sz_6898) : !cute.int_tuple<"4">
      %int_tuple_6900 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6901 = cute.size(%int_tuple_6900) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6902 = cute.get_leaves(%sz_6901) : !cute.int_tuple<"4">
      %coord_6903 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6904 = cute.get_layout(%view_859) : !memref_smem_bf16_10
      %2780:2 = cute.get_scalars(%lay_6904) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_6905 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_6906 = cute.assume(%2780#0) : (i32) -> !cute.i32<divby 16>
      %iv_6907 = cute.assume(%2780#1) : (i32) -> !cute.i32<divby 32>
      %stride_6908 = cute.make_stride(%iv_6906, %iv_6907) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_6909 = cute.make_layout(%shape_6905, %stride_6908) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_6910 = cute.crd2idx(%coord_6903, %lay_6904) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
      %iter_6911 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %ptr_6912 = cute.add_offset(%iter_6911, %idx_6910) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6913 = cute.make_view(%ptr_6912, %lay_6909) : !memref_smem_bf16_19
      %iter_6914 = cute.get_iter(%view_6913) : !memref_smem_bf16_19
      %coord_6915 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6916 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
      %idx_6917 = cute.crd2idx(%coord_6915, %lay_6916) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
      %iter_6918 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %ptr_6919 = cute.add_offset(%iter_6918, %idx_6917) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6920 = cute.make_view(%ptr_6919) : !memref_rmem_bf16_18
      %iter_6921 = cute.get_iter(%view_6920) : !memref_rmem_bf16_18
      %lay_6922 = cute.get_layout(%view_6913) : !memref_smem_bf16_19
      %2781 = cute.get_shape(%lay_6922) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6923, %e1_6924, %e2_6925, %e3_6926, %e4_6927 = cute.get_leaves(%2781) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6928 = cute.get_layout(%view_6920) : !memref_rmem_bf16_18
      %2782 = cute.get_shape(%lay_6928) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6929, %e1_6930, %e2_6931, %e3_6932 = cute.get_leaves(%2782) : !cute.shape<"((8,1),(4,2))">
      %lay_6933 = cute.get_layout(%view_6913) : !memref_smem_bf16_19
      %shape_6934 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6935 = cute.make_layout() : !cute.layout<"1:0">
      %append_6936 = cute.append_to_rank<2> (%lay_6933, %lay_6935) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6937 = cute.make_view(%iter_6914, %append_6936) : !memref_smem_bf16_19
      %iter_6938 = cute.get_iter(%view_6937) : !memref_smem_bf16_19
      %lay_6939 = cute.get_layout(%view_6937) : !memref_smem_bf16_19
      %2783 = cute.get_shape(%lay_6939) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6940, %e1_6941, %e2_6942, %e3_6943, %e4_6944 = cute.get_leaves(%2783) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6945 = cute.get_iter(%view_6937) : !memref_smem_bf16_19
      %lay_6946 = cute.get_layout(%view_6937) : !memref_smem_bf16_19
      %2784:2 = cute.get_scalars(%lay_6946) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6947 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6948 = cute.assume(%2784#0) : (i32) -> !cute.i32<divby 16>
      %iv_6949 = cute.assume(%2784#1) : (i32) -> !cute.i32<divby 32>
      %stride_6950 = cute.make_stride(%iv_6948, %iv_6949) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6951 = cute.make_layout(%shape_6947, %stride_6950) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6952 = cute.make_view(%iter_6945, %lay_6951) : !memref_smem_bf16_20
      %iter_6953 = cute.get_iter(%view_6952) : !memref_smem_bf16_20
      %iter_6954 = cute.get_iter(%view_6952) : !memref_smem_bf16_20
      %lay_6955 = cute.get_layout(%view_6920) : !memref_rmem_bf16_18
      %shape_6956 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6957 = cute.make_layout() : !cute.layout<"1:0">
      %append_6958 = cute.append_to_rank<2> (%lay_6955, %lay_6957) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6959 = cute.make_view(%iter_6921, %append_6958) : !memref_rmem_bf16_18
      %iter_6960 = cute.get_iter(%view_6959) : !memref_rmem_bf16_18
      %lay_6961 = cute.get_layout(%view_6959) : !memref_rmem_bf16_18
      %2785 = cute.get_shape(%lay_6961) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6962, %e1_6963, %e2_6964, %e3_6965 = cute.get_leaves(%2785) : !cute.shape<"((8,1),(4,2))">
      %iter_6966 = cute.get_iter(%view_6959) : !memref_rmem_bf16_18
      %view_6967 = cute.make_view(%iter_6966) : !memref_rmem_bf16_19
      %iter_6968 = cute.get_iter(%view_6967) : !memref_rmem_bf16_19
      %iter_6969 = cute.get_iter(%view_6967) : !memref_rmem_bf16_19
      %lay_6970 = cute.get_layout(%view_6952) : !memref_smem_bf16_20
      %2786 = cute.get_shape(%lay_6970) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6971, %e1_6972, %e2_6973, %e3_6974, %e4_6975 = cute.get_leaves(%2786) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6976 = cute.get_layout(%view_6967) : !memref_rmem_bf16_19
      %2787 = cute.get_shape(%lay_6976) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6977, %e1_6978, %e2_6979, %e3_6980 = cute.get_leaves(%2787) : !cute.shape<"((8,1),((4,2)))">
      %lay_6981 = cute.get_layout(%view_6952) : !memref_smem_bf16_20
      %sz_6982 = cute.size(%lay_6981) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6983 = cute.get_leaves(%sz_6982) : !cute.int_tuple<"8">
      %lay_6984 = cute.get_layout(%view_6967) : !memref_rmem_bf16_19
      %sz_6985 = cute.size(%lay_6984) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6986 = cute.get_leaves(%sz_6985) : !cute.int_tuple<"8">
      %2788 = cute.static : !cute.layout<"1:0">
      %iter_6987 = cute.get_iter(%view_6952) : !memref_smem_bf16_20
      %iter_6988 = cute.get_iter(%view_6967) : !memref_rmem_bf16_19
      %lay_6989 = cute.get_layout(%view_6952) : !memref_smem_bf16_20
      %lay_6990 = cute.get_layout(%view_6967) : !memref_rmem_bf16_19
      %append_6991 = cute.append_to_rank<2> (%lay_6989, %2788) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6992 = cute.append_to_rank<2> (%lay_6990, %2788) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2789:2 = cute.get_scalars(%append_6991) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6993 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6994 = cute.assume(%2789#0) : (i32) -> !cute.i32<divby 16>
      %iv_6995 = cute.assume(%2789#1) : (i32) -> !cute.i32<divby 32>
      %stride_6996 = cute.make_stride(%iv_6994, %iv_6995) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6997 = cute.make_layout(%shape_6993, %stride_6996) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6998 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6999 = cute.size(%lay_6997) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2790 = cute.get_scalars(%sz_6999) : !cute.int_tuple<"8">
      %c0_i32_7000 = arith.constant 0 : i32
      %c1_i32_7001 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7000 to %2790 step %c1_i32_7001  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370:2 = cute.get_scalars(%lay_6997) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_6997) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8497 = cute.add_offset(%iter_6987, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_6998) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_6988, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3373 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3374 = llvm.mlir.constant(0 : i32) : i32
        %3375 = vector.extractelement %3373[%3374 : i32] : vector<4xi32>
        %3376 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3375, %3376 : i32, !llvm.ptr
        %3377 = llvm.mlir.constant(1 : i32) : i32
        %3378 = vector.extractelement %3373[%3377 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3379 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3378, %3379 : i32, !llvm.ptr
        %3380 = llvm.mlir.constant(2 : i32) : i32
        %3381 = vector.extractelement %3373[%3380 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3382 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3381, %3382 : i32, !llvm.ptr
        %3383 = llvm.mlir.constant(3 : i32) : i32
        %3384 = vector.extractelement %3373[%3383 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3384, %3385 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7002 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7003 = cute.get_layout(%view_6790) : !memref_rmem_bf16_17
      %idx_7004 = cute.crd2idx(%coord_7002, %lay_7003) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
      %iter_7005 = cute.get_iter(%view_6790) : !memref_rmem_bf16_17
      %ptr_7006 = cute.add_offset(%iter_7005, %idx_7004) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7007 = cute.make_view(%ptr_7006) : !memref_rmem_bf16_20
      %iter_7008 = cute.get_iter(%view_7007) : !memref_rmem_bf16_20
      %coord_7009 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7010 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
      %idx_7011 = cute.crd2idx(%coord_7009, %lay_7010) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
      %iter_7012 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %ptr_7013 = cute.add_offset(%iter_7012, %idx_7011) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7014 = cute.make_view(%ptr_7013) : !memref_rmem_bf16_21
      %iter_7015 = cute.get_iter(%view_7014) : !memref_rmem_bf16_21
      %lay_7016 = cute.get_layout(%view_7007) : !memref_rmem_bf16_20
      %2791 = cute.get_shape(%lay_7016) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7017, %e1_7018, %e2_7019, %e3_7020 = cute.get_leaves(%2791) : !cute.shape<"(((2,2),2),2)">
      %lay_7021 = cute.get_layout(%view_7014) : !memref_rmem_bf16_21
      %2792 = cute.get_shape(%lay_7021) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7022, %e1_7023, %e2_7024, %e3_7025 = cute.get_leaves(%2792) : !cute.shape<"((2,2),(8,2))">
      %lay_7026 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2793 = cute.get_shape(%lay_7026) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7027, %e1_7028, %e2_7029, %e3_7030 = cute.get_leaves(%2793) : !cute.shape<"((2,2),2,16)">
      %iter_7031 = cute.get_iter(%view_7007) : !memref_rmem_bf16_20
      %iter_7032 = cute.get_iter(%view_7014) : !memref_rmem_bf16_21
      %iter_7033 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %iter_7034 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %lay_7035 = cute.get_layout(%view_7007) : !memref_rmem_bf16_20
      %lay_7036 = cute.get_layout(%view_7014) : !memref_rmem_bf16_21
      %lay_7037 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7038 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2794 = cute.static : !cute.layout<"1:0">
      %append_7039 = cute.append_to_rank<3> (%lay_7035, %2794) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7040 = cute.append_to_rank<3> (%lay_7036, %2794) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7041 = cute.size(%append_7039) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7042 = cute.size(%append_7039) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7043 = cute.size(%append_7040) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2795 = cute.get_scalars(%sz_7041) : !cute.int_tuple<"1">
      %2796 = cute.get_scalars(%sz_7042) : !cute.int_tuple<"2">
      %2797 = cute.get_scalars(%sz_7043) : !cute.int_tuple<"16">
      %c0_i32_7044 = arith.constant 0 : i32
      %c1_i32_7045 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7044 to %2795 step %c1_i32_7045  : i32 {
        scf.for %arg6 = %c0_i32_7044 to %2796 step %c1_i32_7045  : i32 {
          scf.for %arg7 = %c0_i32_7044 to %2797 step %c1_i32_7045  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_7039) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8499 = cute.add_offset(%iter_7031, %idx_8498) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_22
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_7040) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_7032, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_7037) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_7033, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_7038) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_7034, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_22
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7046 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7047 = cute.size(%int_tuple_7046) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7048 = cute.get_leaves(%sz_7047) : !cute.int_tuple<"4">
      %coord_7049 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7050 = cute.get_layout(%view_859) : !memref_smem_bf16_10
      %2798:2 = cute.get_scalars(%lay_7050) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7051 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7052 = cute.assume(%2798#0) : (i32) -> !cute.i32<divby 16>
      %iv_7053 = cute.assume(%2798#1) : (i32) -> !cute.i32<divby 32>
      %stride_7054 = cute.make_stride(%iv_7052, %iv_7053) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7055 = cute.make_layout(%shape_7051, %stride_7054) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7056 = cute.crd2idx(%coord_7049, %lay_7050) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
      %iter_7057 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %ptr_7058 = cute.add_offset(%iter_7057, %idx_7056) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7059 = cute.make_view(%ptr_7058, %lay_7055) : !memref_smem_bf16_19
      %iter_7060 = cute.get_iter(%view_7059) : !memref_smem_bf16_19
      %coord_7061 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7062 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
      %idx_7063 = cute.crd2idx(%coord_7061, %lay_7062) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
      %iter_7064 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %ptr_7065 = cute.add_offset(%iter_7064, %idx_7063) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7066 = cute.make_view(%ptr_7065) : !memref_rmem_bf16_18
      %iter_7067 = cute.get_iter(%view_7066) : !memref_rmem_bf16_18
      %lay_7068 = cute.get_layout(%view_7059) : !memref_smem_bf16_19
      %2799 = cute.get_shape(%lay_7068) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7069, %e1_7070, %e2_7071, %e3_7072, %e4_7073 = cute.get_leaves(%2799) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7074 = cute.get_layout(%view_7066) : !memref_rmem_bf16_18
      %2800 = cute.get_shape(%lay_7074) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7075, %e1_7076, %e2_7077, %e3_7078 = cute.get_leaves(%2800) : !cute.shape<"((8,1),(4,2))">
      %lay_7079 = cute.get_layout(%view_7059) : !memref_smem_bf16_19
      %shape_7080 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7081 = cute.make_layout() : !cute.layout<"1:0">
      %append_7082 = cute.append_to_rank<2> (%lay_7079, %lay_7081) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7083 = cute.make_view(%iter_7060, %append_7082) : !memref_smem_bf16_19
      %iter_7084 = cute.get_iter(%view_7083) : !memref_smem_bf16_19
      %lay_7085 = cute.get_layout(%view_7083) : !memref_smem_bf16_19
      %2801 = cute.get_shape(%lay_7085) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7086, %e1_7087, %e2_7088, %e3_7089, %e4_7090 = cute.get_leaves(%2801) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7091 = cute.get_iter(%view_7083) : !memref_smem_bf16_19
      %lay_7092 = cute.get_layout(%view_7083) : !memref_smem_bf16_19
      %2802:2 = cute.get_scalars(%lay_7092) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7093 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7094 = cute.assume(%2802#0) : (i32) -> !cute.i32<divby 16>
      %iv_7095 = cute.assume(%2802#1) : (i32) -> !cute.i32<divby 32>
      %stride_7096 = cute.make_stride(%iv_7094, %iv_7095) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7097 = cute.make_layout(%shape_7093, %stride_7096) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7098 = cute.make_view(%iter_7091, %lay_7097) : !memref_smem_bf16_20
      %iter_7099 = cute.get_iter(%view_7098) : !memref_smem_bf16_20
      %iter_7100 = cute.get_iter(%view_7098) : !memref_smem_bf16_20
      %lay_7101 = cute.get_layout(%view_7066) : !memref_rmem_bf16_18
      %shape_7102 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7103 = cute.make_layout() : !cute.layout<"1:0">
      %append_7104 = cute.append_to_rank<2> (%lay_7101, %lay_7103) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7105 = cute.make_view(%iter_7067, %append_7104) : !memref_rmem_bf16_18
      %iter_7106 = cute.get_iter(%view_7105) : !memref_rmem_bf16_18
      %lay_7107 = cute.get_layout(%view_7105) : !memref_rmem_bf16_18
      %2803 = cute.get_shape(%lay_7107) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7108, %e1_7109, %e2_7110, %e3_7111 = cute.get_leaves(%2803) : !cute.shape<"((8,1),(4,2))">
      %iter_7112 = cute.get_iter(%view_7105) : !memref_rmem_bf16_18
      %view_7113 = cute.make_view(%iter_7112) : !memref_rmem_bf16_19
      %iter_7114 = cute.get_iter(%view_7113) : !memref_rmem_bf16_19
      %iter_7115 = cute.get_iter(%view_7113) : !memref_rmem_bf16_19
      %lay_7116 = cute.get_layout(%view_7098) : !memref_smem_bf16_20
      %2804 = cute.get_shape(%lay_7116) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7117, %e1_7118, %e2_7119, %e3_7120, %e4_7121 = cute.get_leaves(%2804) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7122 = cute.get_layout(%view_7113) : !memref_rmem_bf16_19
      %2805 = cute.get_shape(%lay_7122) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7123, %e1_7124, %e2_7125, %e3_7126 = cute.get_leaves(%2805) : !cute.shape<"((8,1),((4,2)))">
      %lay_7127 = cute.get_layout(%view_7098) : !memref_smem_bf16_20
      %sz_7128 = cute.size(%lay_7127) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7129 = cute.get_leaves(%sz_7128) : !cute.int_tuple<"8">
      %lay_7130 = cute.get_layout(%view_7113) : !memref_rmem_bf16_19
      %sz_7131 = cute.size(%lay_7130) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7132 = cute.get_leaves(%sz_7131) : !cute.int_tuple<"8">
      %2806 = cute.static : !cute.layout<"1:0">
      %iter_7133 = cute.get_iter(%view_7098) : !memref_smem_bf16_20
      %iter_7134 = cute.get_iter(%view_7113) : !memref_rmem_bf16_19
      %lay_7135 = cute.get_layout(%view_7098) : !memref_smem_bf16_20
      %lay_7136 = cute.get_layout(%view_7113) : !memref_rmem_bf16_19
      %append_7137 = cute.append_to_rank<2> (%lay_7135, %2806) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7138 = cute.append_to_rank<2> (%lay_7136, %2806) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2807:2 = cute.get_scalars(%append_7137) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7139 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7140 = cute.assume(%2807#0) : (i32) -> !cute.i32<divby 16>
      %iv_7141 = cute.assume(%2807#1) : (i32) -> !cute.i32<divby 32>
      %stride_7142 = cute.make_stride(%iv_7140, %iv_7141) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7143 = cute.make_layout(%shape_7139, %stride_7142) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7144 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7145 = cute.size(%lay_7143) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2808 = cute.get_scalars(%sz_7145) : !cute.int_tuple<"8">
      %c0_i32_7146 = arith.constant 0 : i32
      %c1_i32_7147 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7146 to %2808 step %c1_i32_7147  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370:2 = cute.get_scalars(%lay_7143) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_7143) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8497 = cute.add_offset(%iter_7133, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_7144) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_7134, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3373 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3374 = llvm.mlir.constant(0 : i32) : i32
        %3375 = vector.extractelement %3373[%3374 : i32] : vector<4xi32>
        %3376 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3375, %3376 : i32, !llvm.ptr
        %3377 = llvm.mlir.constant(1 : i32) : i32
        %3378 = vector.extractelement %3373[%3377 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3379 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3378, %3379 : i32, !llvm.ptr
        %3380 = llvm.mlir.constant(2 : i32) : i32
        %3381 = vector.extractelement %3373[%3380 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3382 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3381, %3382 : i32, !llvm.ptr
        %3383 = llvm.mlir.constant(3 : i32) : i32
        %3384 = vector.extractelement %3373[%3383 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3384, %3385 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7148 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_7149 = cute.get_layout(%view_6790) : !memref_rmem_bf16_17
      %idx_7150 = cute.crd2idx(%coord_7148, %lay_7149) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
      %iter_7151 = cute.get_iter(%view_6790) : !memref_rmem_bf16_17
      %ptr_7152 = cute.add_offset(%iter_7151, %idx_7150) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7153 = cute.make_view(%ptr_7152) : !memref_rmem_bf16_20
      %iter_7154 = cute.get_iter(%view_7153) : !memref_rmem_bf16_20
      %coord_7155 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_7156 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
      %idx_7157 = cute.crd2idx(%coord_7155, %lay_7156) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
      %iter_7158 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %ptr_7159 = cute.add_offset(%iter_7158, %idx_7157) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7160 = cute.make_view(%ptr_7159) : !memref_rmem_bf16_21
      %iter_7161 = cute.get_iter(%view_7160) : !memref_rmem_bf16_21
      %lay_7162 = cute.get_layout(%view_7153) : !memref_rmem_bf16_20
      %2809 = cute.get_shape(%lay_7162) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7163, %e1_7164, %e2_7165, %e3_7166 = cute.get_leaves(%2809) : !cute.shape<"(((2,2),2),2)">
      %lay_7167 = cute.get_layout(%view_7160) : !memref_rmem_bf16_21
      %2810 = cute.get_shape(%lay_7167) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7168, %e1_7169, %e2_7170, %e3_7171 = cute.get_leaves(%2810) : !cute.shape<"((2,2),(8,2))">
      %iter_7172 = cute.get_iter(%view_7153) : !memref_rmem_bf16_20
      %iter_7173 = cute.get_iter(%view_7160) : !memref_rmem_bf16_21
      %iter_7174 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %iter_7175 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %lay_7176 = cute.get_layout(%view_7153) : !memref_rmem_bf16_20
      %lay_7177 = cute.get_layout(%view_7160) : !memref_rmem_bf16_21
      %lay_7178 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7179 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2811 = cute.static : !cute.layout<"1:0">
      %append_7180 = cute.append_to_rank<3> (%lay_7176, %2811) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7181 = cute.append_to_rank<3> (%lay_7177, %2811) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7182 = cute.size(%append_7180) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7183 = cute.size(%append_7180) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7184 = cute.size(%append_7181) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2812 = cute.get_scalars(%sz_7182) : !cute.int_tuple<"1">
      %2813 = cute.get_scalars(%sz_7183) : !cute.int_tuple<"2">
      %2814 = cute.get_scalars(%sz_7184) : !cute.int_tuple<"16">
      %c0_i32_7185 = arith.constant 0 : i32
      %c1_i32_7186 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7185 to %2812 step %c1_i32_7186  : i32 {
        scf.for %arg6 = %c0_i32_7185 to %2813 step %c1_i32_7186  : i32 {
          scf.for %arg7 = %c0_i32_7185 to %2814 step %c1_i32_7186  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_7180) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8499 = cute.add_offset(%iter_7172, %idx_8498) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_22
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_7181) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_7173, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_7178) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_7174, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_7179) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_7175, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_22
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7187 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7188 = cute.size(%int_tuple_7187) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7189 = cute.get_leaves(%sz_7188) : !cute.int_tuple<"4">
      %coord_7190 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7191 = cute.get_layout(%view_859) : !memref_smem_bf16_10
      %2815:2 = cute.get_scalars(%lay_7191) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7192 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7193 = cute.assume(%2815#0) : (i32) -> !cute.i32<divby 16>
      %iv_7194 = cute.assume(%2815#1) : (i32) -> !cute.i32<divby 32>
      %stride_7195 = cute.make_stride(%iv_7193, %iv_7194) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7196 = cute.make_layout(%shape_7192, %stride_7195) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7197 = cute.crd2idx(%coord_7190, %lay_7191) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
      %iter_7198 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %ptr_7199 = cute.add_offset(%iter_7198, %idx_7197) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7200 = cute.make_view(%ptr_7199, %lay_7196) : !memref_smem_bf16_19
      %iter_7201 = cute.get_iter(%view_7200) : !memref_smem_bf16_19
      %coord_7202 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7203 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
      %idx_7204 = cute.crd2idx(%coord_7202, %lay_7203) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
      %iter_7205 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %ptr_7206 = cute.add_offset(%iter_7205, %idx_7204) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7207 = cute.make_view(%ptr_7206) : !memref_rmem_bf16_18
      %iter_7208 = cute.get_iter(%view_7207) : !memref_rmem_bf16_18
      %lay_7209 = cute.get_layout(%view_7200) : !memref_smem_bf16_19
      %2816 = cute.get_shape(%lay_7209) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7210, %e1_7211, %e2_7212, %e3_7213, %e4_7214 = cute.get_leaves(%2816) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7215 = cute.get_layout(%view_7207) : !memref_rmem_bf16_18
      %2817 = cute.get_shape(%lay_7215) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7216, %e1_7217, %e2_7218, %e3_7219 = cute.get_leaves(%2817) : !cute.shape<"((8,1),(4,2))">
      %lay_7220 = cute.get_layout(%view_7200) : !memref_smem_bf16_19
      %shape_7221 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7222 = cute.make_layout() : !cute.layout<"1:0">
      %append_7223 = cute.append_to_rank<2> (%lay_7220, %lay_7222) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7224 = cute.make_view(%iter_7201, %append_7223) : !memref_smem_bf16_19
      %iter_7225 = cute.get_iter(%view_7224) : !memref_smem_bf16_19
      %lay_7226 = cute.get_layout(%view_7224) : !memref_smem_bf16_19
      %2818 = cute.get_shape(%lay_7226) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7227, %e1_7228, %e2_7229, %e3_7230, %e4_7231 = cute.get_leaves(%2818) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7232 = cute.get_iter(%view_7224) : !memref_smem_bf16_19
      %lay_7233 = cute.get_layout(%view_7224) : !memref_smem_bf16_19
      %2819:2 = cute.get_scalars(%lay_7233) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7234 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7235 = cute.assume(%2819#0) : (i32) -> !cute.i32<divby 16>
      %iv_7236 = cute.assume(%2819#1) : (i32) -> !cute.i32<divby 32>
      %stride_7237 = cute.make_stride(%iv_7235, %iv_7236) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7238 = cute.make_layout(%shape_7234, %stride_7237) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7239 = cute.make_view(%iter_7232, %lay_7238) : !memref_smem_bf16_20
      %iter_7240 = cute.get_iter(%view_7239) : !memref_smem_bf16_20
      %iter_7241 = cute.get_iter(%view_7239) : !memref_smem_bf16_20
      %lay_7242 = cute.get_layout(%view_7207) : !memref_rmem_bf16_18
      %shape_7243 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7244 = cute.make_layout() : !cute.layout<"1:0">
      %append_7245 = cute.append_to_rank<2> (%lay_7242, %lay_7244) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7246 = cute.make_view(%iter_7208, %append_7245) : !memref_rmem_bf16_18
      %iter_7247 = cute.get_iter(%view_7246) : !memref_rmem_bf16_18
      %lay_7248 = cute.get_layout(%view_7246) : !memref_rmem_bf16_18
      %2820 = cute.get_shape(%lay_7248) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7249, %e1_7250, %e2_7251, %e3_7252 = cute.get_leaves(%2820) : !cute.shape<"((8,1),(4,2))">
      %iter_7253 = cute.get_iter(%view_7246) : !memref_rmem_bf16_18
      %view_7254 = cute.make_view(%iter_7253) : !memref_rmem_bf16_19
      %iter_7255 = cute.get_iter(%view_7254) : !memref_rmem_bf16_19
      %iter_7256 = cute.get_iter(%view_7254) : !memref_rmem_bf16_19
      %lay_7257 = cute.get_layout(%view_7239) : !memref_smem_bf16_20
      %2821 = cute.get_shape(%lay_7257) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7258, %e1_7259, %e2_7260, %e3_7261, %e4_7262 = cute.get_leaves(%2821) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7263 = cute.get_layout(%view_7254) : !memref_rmem_bf16_19
      %2822 = cute.get_shape(%lay_7263) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7264, %e1_7265, %e2_7266, %e3_7267 = cute.get_leaves(%2822) : !cute.shape<"((8,1),((4,2)))">
      %lay_7268 = cute.get_layout(%view_7239) : !memref_smem_bf16_20
      %sz_7269 = cute.size(%lay_7268) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7270 = cute.get_leaves(%sz_7269) : !cute.int_tuple<"8">
      %lay_7271 = cute.get_layout(%view_7254) : !memref_rmem_bf16_19
      %sz_7272 = cute.size(%lay_7271) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7273 = cute.get_leaves(%sz_7272) : !cute.int_tuple<"8">
      %2823 = cute.static : !cute.layout<"1:0">
      %iter_7274 = cute.get_iter(%view_7239) : !memref_smem_bf16_20
      %iter_7275 = cute.get_iter(%view_7254) : !memref_rmem_bf16_19
      %lay_7276 = cute.get_layout(%view_7239) : !memref_smem_bf16_20
      %lay_7277 = cute.get_layout(%view_7254) : !memref_rmem_bf16_19
      %append_7278 = cute.append_to_rank<2> (%lay_7276, %2823) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7279 = cute.append_to_rank<2> (%lay_7277, %2823) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2824:2 = cute.get_scalars(%append_7278) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7280 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7281 = cute.assume(%2824#0) : (i32) -> !cute.i32<divby 16>
      %iv_7282 = cute.assume(%2824#1) : (i32) -> !cute.i32<divby 32>
      %stride_7283 = cute.make_stride(%iv_7281, %iv_7282) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7284 = cute.make_layout(%shape_7280, %stride_7283) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7285 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7286 = cute.size(%lay_7284) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2825 = cute.get_scalars(%sz_7286) : !cute.int_tuple<"8">
      %c0_i32_7287 = arith.constant 0 : i32
      %c1_i32_7288 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7287 to %2825 step %c1_i32_7288  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370:2 = cute.get_scalars(%lay_7284) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_7284) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8497 = cute.add_offset(%iter_7274, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_7285) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_7275, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3373 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3374 = llvm.mlir.constant(0 : i32) : i32
        %3375 = vector.extractelement %3373[%3374 : i32] : vector<4xi32>
        %3376 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3375, %3376 : i32, !llvm.ptr
        %3377 = llvm.mlir.constant(1 : i32) : i32
        %3378 = vector.extractelement %3373[%3377 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3379 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3378, %3379 : i32, !llvm.ptr
        %3380 = llvm.mlir.constant(2 : i32) : i32
        %3381 = vector.extractelement %3373[%3380 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3382 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3381, %3382 : i32, !llvm.ptr
        %3383 = llvm.mlir.constant(3 : i32) : i32
        %3384 = vector.extractelement %3373[%3383 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3384, %3385 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7289 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7290 = cute.get_layout(%view_6790) : !memref_rmem_bf16_17
      %idx_7291 = cute.crd2idx(%coord_7289, %lay_7290) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
      %iter_7292 = cute.get_iter(%view_6790) : !memref_rmem_bf16_17
      %ptr_7293 = cute.add_offset(%iter_7292, %idx_7291) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7294 = cute.make_view(%ptr_7293) : !memref_rmem_bf16_20
      %iter_7295 = cute.get_iter(%view_7294) : !memref_rmem_bf16_20
      %coord_7296 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7297 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
      %idx_7298 = cute.crd2idx(%coord_7296, %lay_7297) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
      %iter_7299 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %ptr_7300 = cute.add_offset(%iter_7299, %idx_7298) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7301 = cute.make_view(%ptr_7300) : !memref_rmem_bf16_21
      %iter_7302 = cute.get_iter(%view_7301) : !memref_rmem_bf16_21
      %lay_7303 = cute.get_layout(%view_7294) : !memref_rmem_bf16_20
      %2826 = cute.get_shape(%lay_7303) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7304, %e1_7305, %e2_7306, %e3_7307 = cute.get_leaves(%2826) : !cute.shape<"(((2,2),2),2)">
      %lay_7308 = cute.get_layout(%view_7301) : !memref_rmem_bf16_21
      %2827 = cute.get_shape(%lay_7308) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7309, %e1_7310, %e2_7311, %e3_7312 = cute.get_leaves(%2827) : !cute.shape<"((2,2),(8,2))">
      %iter_7313 = cute.get_iter(%view_7294) : !memref_rmem_bf16_20
      %iter_7314 = cute.get_iter(%view_7301) : !memref_rmem_bf16_21
      %iter_7315 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %iter_7316 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %lay_7317 = cute.get_layout(%view_7294) : !memref_rmem_bf16_20
      %lay_7318 = cute.get_layout(%view_7301) : !memref_rmem_bf16_21
      %lay_7319 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7320 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2828 = cute.static : !cute.layout<"1:0">
      %append_7321 = cute.append_to_rank<3> (%lay_7317, %2828) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7322 = cute.append_to_rank<3> (%lay_7318, %2828) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7323 = cute.size(%append_7321) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7324 = cute.size(%append_7321) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7325 = cute.size(%append_7322) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2829 = cute.get_scalars(%sz_7323) : !cute.int_tuple<"1">
      %2830 = cute.get_scalars(%sz_7324) : !cute.int_tuple<"2">
      %2831 = cute.get_scalars(%sz_7325) : !cute.int_tuple<"16">
      %c0_i32_7326 = arith.constant 0 : i32
      %c1_i32_7327 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7326 to %2829 step %c1_i32_7327  : i32 {
        scf.for %arg6 = %c0_i32_7326 to %2830 step %c1_i32_7327  : i32 {
          scf.for %arg7 = %c0_i32_7326 to %2831 step %c1_i32_7327  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_7321) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8499 = cute.add_offset(%iter_7313, %idx_8498) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_22
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_7322) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_7314, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_7319) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_7315, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_7320) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_7316, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_22
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7328 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7329 = cute.size(%int_tuple_7328) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7330 = cute.get_leaves(%sz_7329) : !cute.int_tuple<"4">
      %coord_7331 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7332 = cute.get_layout(%view_859) : !memref_smem_bf16_10
      %2832:2 = cute.get_scalars(%lay_7332) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7333 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7334 = cute.assume(%2832#0) : (i32) -> !cute.i32<divby 16>
      %iv_7335 = cute.assume(%2832#1) : (i32) -> !cute.i32<divby 32>
      %stride_7336 = cute.make_stride(%iv_7334, %iv_7335) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7337 = cute.make_layout(%shape_7333, %stride_7336) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7338 = cute.crd2idx(%coord_7331, %lay_7332) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_7339 = cute.get_iter(%view_859) : !memref_smem_bf16_10
      %ptr_7340 = cute.add_offset(%iter_7339, %idx_7338) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7341 = cute.make_view(%ptr_7340, %lay_7337) : !memref_smem_bf16_19
      %iter_7342 = cute.get_iter(%view_7341) : !memref_smem_bf16_19
      %coord_7343 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7344 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
      %idx_7345 = cute.crd2idx(%coord_7343, %lay_7344) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_7346 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
      %ptr_7347 = cute.add_offset(%iter_7346, %idx_7345) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7348 = cute.make_view(%ptr_7347) : !memref_rmem_bf16_18
      %iter_7349 = cute.get_iter(%view_7348) : !memref_rmem_bf16_18
      %lay_7350 = cute.get_layout(%view_7341) : !memref_smem_bf16_19
      %2833 = cute.get_shape(%lay_7350) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7351, %e1_7352, %e2_7353, %e3_7354, %e4_7355 = cute.get_leaves(%2833) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7356 = cute.get_layout(%view_7348) : !memref_rmem_bf16_18
      %2834 = cute.get_shape(%lay_7356) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7357, %e1_7358, %e2_7359, %e3_7360 = cute.get_leaves(%2834) : !cute.shape<"((8,1),(4,2))">
      %lay_7361 = cute.get_layout(%view_7341) : !memref_smem_bf16_19
      %shape_7362 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7363 = cute.make_layout() : !cute.layout<"1:0">
      %append_7364 = cute.append_to_rank<2> (%lay_7361, %lay_7363) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7365 = cute.make_view(%iter_7342, %append_7364) : !memref_smem_bf16_19
      %iter_7366 = cute.get_iter(%view_7365) : !memref_smem_bf16_19
      %lay_7367 = cute.get_layout(%view_7365) : !memref_smem_bf16_19
      %2835 = cute.get_shape(%lay_7367) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7368, %e1_7369, %e2_7370, %e3_7371, %e4_7372 = cute.get_leaves(%2835) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7373 = cute.get_iter(%view_7365) : !memref_smem_bf16_19
      %lay_7374 = cute.get_layout(%view_7365) : !memref_smem_bf16_19
      %2836:2 = cute.get_scalars(%lay_7374) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7375 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7376 = cute.assume(%2836#0) : (i32) -> !cute.i32<divby 16>
      %iv_7377 = cute.assume(%2836#1) : (i32) -> !cute.i32<divby 32>
      %stride_7378 = cute.make_stride(%iv_7376, %iv_7377) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7379 = cute.make_layout(%shape_7375, %stride_7378) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7380 = cute.make_view(%iter_7373, %lay_7379) : !memref_smem_bf16_20
      %iter_7381 = cute.get_iter(%view_7380) : !memref_smem_bf16_20
      %iter_7382 = cute.get_iter(%view_7380) : !memref_smem_bf16_20
      %lay_7383 = cute.get_layout(%view_7348) : !memref_rmem_bf16_18
      %shape_7384 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7385 = cute.make_layout() : !cute.layout<"1:0">
      %append_7386 = cute.append_to_rank<2> (%lay_7383, %lay_7385) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7387 = cute.make_view(%iter_7349, %append_7386) : !memref_rmem_bf16_18
      %iter_7388 = cute.get_iter(%view_7387) : !memref_rmem_bf16_18
      %lay_7389 = cute.get_layout(%view_7387) : !memref_rmem_bf16_18
      %2837 = cute.get_shape(%lay_7389) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7390, %e1_7391, %e2_7392, %e3_7393 = cute.get_leaves(%2837) : !cute.shape<"((8,1),(4,2))">
      %iter_7394 = cute.get_iter(%view_7387) : !memref_rmem_bf16_18
      %view_7395 = cute.make_view(%iter_7394) : !memref_rmem_bf16_19
      %iter_7396 = cute.get_iter(%view_7395) : !memref_rmem_bf16_19
      %iter_7397 = cute.get_iter(%view_7395) : !memref_rmem_bf16_19
      %lay_7398 = cute.get_layout(%view_7380) : !memref_smem_bf16_20
      %2838 = cute.get_shape(%lay_7398) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7399, %e1_7400, %e2_7401, %e3_7402, %e4_7403 = cute.get_leaves(%2838) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7404 = cute.get_layout(%view_7395) : !memref_rmem_bf16_19
      %2839 = cute.get_shape(%lay_7404) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7405, %e1_7406, %e2_7407, %e3_7408 = cute.get_leaves(%2839) : !cute.shape<"((8,1),((4,2)))">
      %lay_7409 = cute.get_layout(%view_7380) : !memref_smem_bf16_20
      %sz_7410 = cute.size(%lay_7409) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7411 = cute.get_leaves(%sz_7410) : !cute.int_tuple<"8">
      %lay_7412 = cute.get_layout(%view_7395) : !memref_rmem_bf16_19
      %sz_7413 = cute.size(%lay_7412) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7414 = cute.get_leaves(%sz_7413) : !cute.int_tuple<"8">
      %2840 = cute.static : !cute.layout<"1:0">
      %iter_7415 = cute.get_iter(%view_7380) : !memref_smem_bf16_20
      %iter_7416 = cute.get_iter(%view_7395) : !memref_rmem_bf16_19
      %lay_7417 = cute.get_layout(%view_7380) : !memref_smem_bf16_20
      %lay_7418 = cute.get_layout(%view_7395) : !memref_rmem_bf16_19
      %append_7419 = cute.append_to_rank<2> (%lay_7417, %2840) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7420 = cute.append_to_rank<2> (%lay_7418, %2840) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2841:2 = cute.get_scalars(%append_7419) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7421 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7422 = cute.assume(%2841#0) : (i32) -> !cute.i32<divby 16>
      %iv_7423 = cute.assume(%2841#1) : (i32) -> !cute.i32<divby 32>
      %stride_7424 = cute.make_stride(%iv_7422, %iv_7423) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7425 = cute.make_layout(%shape_7421, %stride_7424) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7426 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7427 = cute.size(%lay_7425) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2842 = cute.get_scalars(%sz_7427) : !cute.int_tuple<"8">
      %c0_i32_7428 = arith.constant 0 : i32
      %c1_i32_7429 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7428 to %2842 step %c1_i32_7429  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370:2 = cute.get_scalars(%lay_7425) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_7425) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8497 = cute.add_offset(%iter_7415, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_7426) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_7416, %idx_8500) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_11
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8503) : !cute.ptr<bf16, smem, align<16>>
        %3373 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3374 = llvm.mlir.constant(0 : i32) : i32
        %3375 = vector.extractelement %3373[%3374 : i32] : vector<4xi32>
        %3376 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3375, %3376 : i32, !llvm.ptr
        %3377 = llvm.mlir.constant(1 : i32) : i32
        %3378 = vector.extractelement %3373[%3377 : i32] : vector<4xi32>
        %int_tuple_8505 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8506 = cute.add_offset(%iter_8504, %int_tuple_8505) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3379 = builtin.unrealized_conversion_cast %ptr_8506 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3378, %3379 : i32, !llvm.ptr
        %3380 = llvm.mlir.constant(2 : i32) : i32
        %3381 = vector.extractelement %3373[%3380 : i32] : vector<4xi32>
        %int_tuple_8507 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8508 = cute.add_offset(%iter_8504, %int_tuple_8507) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3382 = builtin.unrealized_conversion_cast %ptr_8508 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3381, %3382 : i32, !llvm.ptr
        %3383 = llvm.mlir.constant(3 : i32) : i32
        %3384 = vector.extractelement %3373[%3383 : i32] : vector<4xi32>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8510 = cute.add_offset(%iter_8504, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3384, %3385 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7430 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7431 = cute.get_layout(%view_6790) : !memref_rmem_bf16_17
      %idx_7432 = cute.crd2idx(%coord_7430, %lay_7431) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
      %iter_7433 = cute.get_iter(%view_6790) : !memref_rmem_bf16_17
      %ptr_7434 = cute.add_offset(%iter_7433, %idx_7432) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7435 = cute.make_view(%ptr_7434) : !memref_rmem_bf16_20
      %iter_7436 = cute.get_iter(%view_7435) : !memref_rmem_bf16_20
      %coord_7437 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7438 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
      %idx_7439 = cute.crd2idx(%coord_7437, %lay_7438) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
      %iter_7440 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
      %ptr_7441 = cute.add_offset(%iter_7440, %idx_7439) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7442 = cute.make_view(%ptr_7441) : !memref_rmem_bf16_21
      %iter_7443 = cute.get_iter(%view_7442) : !memref_rmem_bf16_21
      %lay_7444 = cute.get_layout(%view_7435) : !memref_rmem_bf16_20
      %2843 = cute.get_shape(%lay_7444) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7445, %e1_7446, %e2_7447, %e3_7448 = cute.get_leaves(%2843) : !cute.shape<"(((2,2),2),2)">
      %lay_7449 = cute.get_layout(%view_7442) : !memref_rmem_bf16_21
      %2844 = cute.get_shape(%lay_7449) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7450, %e1_7451, %e2_7452, %e3_7453 = cute.get_leaves(%2844) : !cute.shape<"((2,2),(8,2))">
      %iter_7454 = cute.get_iter(%view_7435) : !memref_rmem_bf16_20
      %iter_7455 = cute.get_iter(%view_7442) : !memref_rmem_bf16_21
      %iter_7456 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %iter_7457 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
      %lay_7458 = cute.get_layout(%view_7435) : !memref_rmem_bf16_20
      %lay_7459 = cute.get_layout(%view_7442) : !memref_rmem_bf16_21
      %lay_7460 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7461 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2845 = cute.static : !cute.layout<"1:0">
      %append_7462 = cute.append_to_rank<3> (%lay_7458, %2845) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7463 = cute.append_to_rank<3> (%lay_7459, %2845) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7464 = cute.size(%append_7462) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7465 = cute.size(%append_7462) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7466 = cute.size(%append_7463) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2846 = cute.get_scalars(%sz_7464) : !cute.int_tuple<"1">
      %2847 = cute.get_scalars(%sz_7465) : !cute.int_tuple<"2">
      %2848 = cute.get_scalars(%sz_7466) : !cute.int_tuple<"16">
      %c0_i32_7467 = arith.constant 0 : i32
      %c1_i32_7468 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7467 to %2846 step %c1_i32_7468  : i32 {
        scf.for %arg6 = %c0_i32_7467 to %2847 step %c1_i32_7468  : i32 {
          scf.for %arg7 = %c0_i32_7467 to %2848 step %c1_i32_7468  : i32 {
            %coord_8494 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8495 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8496 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3370:2 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8497 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8498 = cute.crd2idx(%coord_8494, %append_7462) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8499 = cute.add_offset(%iter_7454, %idx_8498) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8500 = cute.make_view(%ptr_8499, %lay_8497) : !memref_rmem_bf16_22
            %3371:2 = cute.get_scalars(%coord_8495) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8501 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8502 = cute.crd2idx(%coord_8495, %append_7463) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8503 = cute.add_offset(%iter_7455, %idx_8502) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8504 = cute.make_view(%ptr_8503, %lay_8501) : !memref_rmem_bf16_15
            %3372:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8505 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8506 = cute.crd2idx(%coord_8496, %lay_7460) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8507 = cute.add_offset(%iter_7456, %idx_8506) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8508 = cute.make_view(%ptr_8507, %lay_8505) : !memref_rmem_f32_3
            %3373:2 = cute.get_scalars(%coord_8496) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8509 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8510 = cute.crd2idx(%coord_8496, %lay_7461) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8511 = cute.add_offset(%iter_7457, %idx_8510) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8512 = cute.make_view(%ptr_8511, %lay_8509) : !memref_rmem_f32_3
            %iter_8513 = cute.get_iter(%view_8500) : !memref_rmem_bf16_22
            %iter_8514 = cute.get_iter(%view_8504) : !memref_rmem_bf16_15
            %iter_8515 = cute.get_iter(%view_8508) : !memref_rmem_f32_3
            %iter_8516 = cute.get_iter(%view_8512) : !memref_rmem_f32_3
            %3374 = builtin.unrealized_conversion_cast %iter_8513 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3375 = llvm.load %3374 : !llvm.ptr -> i32
            %3376 = llvm.getelementptr %3374[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3377 = llvm.load %3376 : !llvm.ptr -> i32
            %3378 = llvm.getelementptr %3374[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3379 = llvm.load %3378 : !llvm.ptr -> i32
            %3380 = llvm.getelementptr %3374[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3381 = llvm.load %3380 : !llvm.ptr -> i32
            %3382 = builtin.unrealized_conversion_cast %iter_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3387 = llvm.load %3386 : !llvm.ptr -> f32
            %3388 = llvm.getelementptr %3386[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3389 = llvm.load %3388 : !llvm.ptr -> f32
            %3390 = llvm.getelementptr %3386[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3391 = llvm.load %3390 : !llvm.ptr -> f32
            %3392 = llvm.getelementptr %3386[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3393 = llvm.load %3392 : !llvm.ptr -> f32
            %3394:4 = cute_nvgpu.arch.mma.SM80 A[%3375, %3377, %3379, %3381]  B[%3383, %3385]  C[%3387, %3389, %3391, %3393] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3395 = builtin.unrealized_conversion_cast %iter_8515 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3394#0, %3395 : f32, !llvm.ptr
            %3396 = llvm.getelementptr %3395[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#1, %3396 : f32, !llvm.ptr
            %3397 = llvm.getelementptr %3395[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#2, %3397 : f32, !llvm.ptr
            %3398 = llvm.getelementptr %3395[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3394#3, %3398 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %c1_i32_7469 = arith.constant 1 : i32
      %2849:7 = scf.for %arg5 = %c1_i32_7469 to %128 step %c1_i32_7469 iter_args(%arg6 = %1023, %arg7 = %117, %arg8 = %1023, %arg9 = %arg0, %arg10 = %arg1, %arg11 = %118, %arg12 = %119) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_8494 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_8495 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %lay_8496 = cute.get_layout(%arg9) : !memref_gmem_bf16_
        %3370 = cute.get_shape(%lay_8496) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8497, %e1_8498, %e2_8499, %e3_8500 = cute.get_leaves(%3370) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8501 = cute.to_int_tuple(%e0_8497) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3371 = cute.get_scalars(%itup_8501) : !cute.int_tuple<"?">
        %itup_8502 = cute.to_int_tuple(%e1_8498) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3372 = cute.get_scalars(%itup_8502) : !cute.int_tuple<"?">
        %itup_8503 = cute.to_int_tuple(%e2_8499) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3373 = cute.get_scalars(%itup_8503) : !cute.int_tuple<"?">
        %itup_8504 = cute.to_int_tuple(%e3_8500) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3374 = cute.get_scalars(%itup_8504) : !cute.int_tuple<"?{div=8}">
        %3375 = cute.get_stride(%lay_8496) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_8505, %e1_8506, %e2_8507, %e3_8508 = cute.get_leaves(%3375) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_8509 = cute.to_int_tuple(%e0_8505) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3376 = cute.get_scalars(%itup_8509) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8510 = cute.to_int_tuple(%e1_8506) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3377 = cute.get_scalars(%itup_8510) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8511 = cute.to_int_tuple(%e2_8507) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3378 = cute.get_scalars(%itup_8511) : !cute.int_tuple<"?{i64 div=8}">
        %lay_8512 = cute.get_layout(%arg10) : !memref_gmem_bf16_
        %3379 = cute.get_shape(%lay_8512) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8513, %e1_8514, %e2_8515, %e3_8516 = cute.get_leaves(%3379) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8517 = cute.to_int_tuple(%e0_8513) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3380 = cute.get_scalars(%itup_8517) : !cute.int_tuple<"?">
        %itup_8518 = cute.to_int_tuple(%e1_8514) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3381 = cute.get_scalars(%itup_8518) : !cute.int_tuple<"?">
        %itup_8519 = cute.to_int_tuple(%e2_8515) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3382 = cute.get_scalars(%itup_8519) : !cute.int_tuple<"?">
        %itup_8520 = cute.to_int_tuple(%e3_8516) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3383 = cute.get_scalars(%itup_8520) : !cute.int_tuple<"?{div=8}">
        %3384 = cute.get_stride(%lay_8512) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_8521, %e1_8522, %e2_8523, %e3_8524 = cute.get_leaves(%3384) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_8525 = cute.to_int_tuple(%e0_8521) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3385 = cute.get_scalars(%itup_8525) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8526 = cute.to_int_tuple(%e1_8522) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3386 = cute.get_scalars(%itup_8526) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8527 = cute.to_int_tuple(%e2_8523) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3387 = cute.get_scalars(%itup_8527) : !cute.int_tuple<"?{i64 div=8}">
        %iter_8528 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_8529 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %3388 = arith.subi %128, %arg5 : i32
        %c1_i32_8530 = arith.constant 1 : i32
        %3389 = arith.subi %3388, %c1_i32_8530 : i32
        %shape_8531 = cute.make_shape() : () -> !cute.shape<"(128,64)">
        %shape_8532 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %e0_8533, %e1_8534, %e2_8535, %e3_8536 = cute.get_leaves(%shape_8532) : !cute.shape<"((2,2),2,8)">
        %shape_8537 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_8538 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_8539 = cute.memref.alloca(%lay_8538) : !memref_rmem_f32_2
        %iter_8540 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_8541 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_8542 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %sz_8543 = cute.size(%lay_8542) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
        %e0_8544 = cute.get_leaves(%sz_8543) : !cute.int_tuple<"64">
        %lay_8545 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3390 = cute.get_shape(%lay_8545) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_8546, %e1_8547, %e2_8548, %e3_8549 = cute.get_leaves(%3390) : !cute.shape<"((2,2),2,8)">
        %int_tuple_8550 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %int_tuple_8551 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
        %e0_8552 = cute.get_leaves(%int_tuple_8551) : !cute.int_tuple<"64">
        %cst_8553 = arith.constant 0.000000e+00 : f32
        %3391 = vector.splat %cst_8553 : vector<64xf32>
        %int_tuple_8554 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_8555 = cute.size(%int_tuple_8554) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_8556 = cute.get_leaves(%sz_8555) : !cute.int_tuple<"64">
        %int_tuple_8557 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_8558 = cute.size(%int_tuple_8557) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_8559 = cute.get_leaves(%sz_8558) : !cute.int_tuple<"64">
        cute.memref.store_vec %3391, %rmem_8539, row_major : !memref_rmem_f32_2
        nvvm.cp.async.wait.group 0
        %c1_i32_8560 = arith.constant 1 : i32
        %c128_i32_8561 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_8560 number_of_threads = %c128_i32_8561
        %false_8562 = arith.constant false
        scf.if %false_8562 {
          %lay_11367 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %3816 = cute.get_shape(%lay_11367) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11368, %e1_11369, %e2_11370, %e3_11371 = cute.get_leaves(%3816) : !cute.shape<"((8,1),4,2)">
          %int_tuple_11372 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_11373 = cute.size(%int_tuple_11372) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_11374 = cute.get_leaves(%sz_11373) : !cute.int_tuple<"4">
          %coord_11375 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_11376 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11377 = cute.crd2idx(%coord_11375, %lay_11376) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_11378 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11379 = cute.add_offset(%iter_11378, %idx_11377) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11380 = cute.make_view(%tup_11379) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11381 = cute.get_iter(%view_11380) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11382, %e1_11383, %e2_11384, %e3_11385 = cute.get_leaves(%iter_11381) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3817 = cute.get_scalars(%e0_11382) : !cute.int_tuple<"?">
          %3818 = cute.get_scalars(%e1_11383) : !cute.int_tuple<"?">
          %3819 = cute.get_scalars(%e2_11384) : !cute.int_tuple<"?">
          %3820 = cute.get_scalars(%e3_11385) : !cute.int_tuple<"?{div=8}">
          %iter_11386 = cute.get_iter(%view_11380) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11387, %e1_11388, %e2_11389, %e3_11390 = cute.get_leaves(%iter_11386) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3821 = cute.get_scalars(%e0_11387) : !cute.int_tuple<"?">
          %3822 = cute.get_scalars(%e1_11388) : !cute.int_tuple<"?">
          %3823 = cute.get_scalars(%e2_11389) : !cute.int_tuple<"?">
          %3824 = cute.get_scalars(%e3_11390) : !cute.int_tuple<"?{div=8}">
          %iter_11391 = cute.get_iter(%view_11380) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11392, %e1_11393, %e2_11394, %e3_11395 = cute.get_leaves(%iter_11391) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3825 = cute.get_scalars(%e0_11392) : !cute.int_tuple<"?">
          %3826 = cute.get_scalars(%e1_11393) : !cute.int_tuple<"?">
          %3827 = cute.get_scalars(%e2_11394) : !cute.int_tuple<"?">
          %3828 = cute.get_scalars(%e3_11395) : !cute.int_tuple<"?{div=8}">
          %lay_11396 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3829 = cute.get_shape(%lay_11396) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11397, %e1_11398, %e2_11399, %e3_11400 = cute.get_leaves(%3829) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11401 = cute.to_int_tuple(%e0_11397) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3830 = cute.get_scalars(%itup_11401) : !cute.int_tuple<"?">
          %itup_11402 = cute.to_int_tuple(%e1_11398) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3831 = cute.get_scalars(%itup_11402) : !cute.int_tuple<"?">
          %itup_11403 = cute.to_int_tuple(%e2_11399) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3832 = cute.get_scalars(%itup_11403) : !cute.int_tuple<"?">
          %itup_11404 = cute.to_int_tuple(%e3_11400) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3833 = cute.get_scalars(%itup_11404) : !cute.int_tuple<"?{div=8}">
          %coord_11405 = cute.make_coord(%e1_11393) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11406 = cute.make_coord(%itup_11402) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3834 = cute.get_scalars(%coord_11405) : !cute.coord<"?">
          %3835 = cute.get_scalars(%coord_11406) : !cute.coord<"?">
          %true_11407 = arith.constant true
          %3836 = arith.cmpi slt, %3834, %3835 : i32
          %3837 = arith.andi %true_11407, %3836 : i1
          scf.if %3837 {
            %coord_11507 = cute.make_coord(%3389) : (i32) -> !cute.coord<"(_,0,_,?)">
            %lay_11508 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_11510 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_gmem_bf16_6
            %iter_11513 = cute.get_iter(%view_11512) : !memref_gmem_bf16_6
            %coord_11514 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11515 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11516 = cute.crd2idx(%coord_11514, %lay_11515) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_11517 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11518 = cute.add_offset(%iter_11517, %idx_11516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11519 = cute.make_view(%ptr_11518) : !memref_smem_bf16_14
            %iter_11520 = cute.get_iter(%view_11519) : !memref_smem_bf16_14
            %coord_11521 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11522 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
            %idx_11523 = cute.crd2idx(%coord_11521, %lay_11522) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11524 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
            %ptr_11525 = cute.add_offset(%iter_11524, %idx_11523) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11526 = cute.make_view(%ptr_11525) : !memref_rmem_i8_2
            %iter_11527 = cute.get_iter(%view_11526) : !memref_rmem_i8_2
            %lay_11528 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %3901 = cute.get_shape(%lay_11528) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11529, %e1_11530, %e2_11531 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %lay_11532 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %3902 = cute.get_shape(%lay_11532) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11533, %e1_11534, %e2_11535 = cute.get_leaves(%3902) : !cute.shape<"((8,1),2)">
            %lay_11536 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %shape_11537 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11538 = cute.make_layout() : !cute.layout<"1:0">
            %append_11539 = cute.append_to_rank<2> (%lay_11536, %lay_11538) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11540 = cute.make_view(%iter_11513, %append_11539) : !memref_gmem_bf16_6
            %iter_11541 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %lay_11542 = cute.get_layout(%view_11540) : !memref_gmem_bf16_6
            %3903 = cute.get_shape(%lay_11542) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11543, %e1_11544, %e2_11545 = cute.get_leaves(%3903) : !cute.shape<"((8,1),2)">
            %iter_11546 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %view_11547 = cute.make_view(%iter_11546) : !memref_gmem_bf16_7
            %iter_11548 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11549 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %lay_11550 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %shape_11551 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11552 = cute.make_layout() : !cute.layout<"1:0">
            %append_11553 = cute.append_to_rank<2> (%lay_11550, %lay_11552) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11554 = cute.make_view(%iter_11520, %append_11553) : !memref_smem_bf16_14
            %iter_11555 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %lay_11556 = cute.get_layout(%view_11554) : !memref_smem_bf16_14
            %3904 = cute.get_shape(%lay_11556) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11557, %e1_11558, %e2_11559 = cute.get_leaves(%3904) : !cute.shape<"((8,1),2)">
            %iter_11560 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %view_11561 = cute.make_view(%iter_11560) : !memref_smem_bf16_15
            %iter_11562 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %iter_11563 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11564 = cute.get_layout(%view_11526) : !memref_rmem_i8_2
            %shape_11565 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11566 = cute.make_layout() : !cute.layout<"1:0">
            %append_11567 = cute.append_to_rank<2> (%lay_11564, %lay_11566) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11568 = cute.make_view(%iter_11527, %append_11567) : !memref_rmem_i8_2
            %iter_11569 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %lay_11570 = cute.get_layout(%view_11568) : !memref_rmem_i8_2
            %3905 = cute.get_shape(%lay_11570) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11571, %e1_11572 = cute.get_leaves(%3905) : !cute.shape<"(1,2)">
            %iter_11573 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %view_11574 = cute.make_view(%iter_11573) : !memref_rmem_i8_3
            %iter_11575 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %iter_11576 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11577 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %3906 = cute.get_shape(%lay_11577) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11578, %e1_11579, %e2_11580 = cute.get_leaves(%3906) : !cute.shape<"((8,1),(2))">
            %lay_11581 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %3907 = cute.get_shape(%lay_11581) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11582, %e1_11583, %e2_11584 = cute.get_leaves(%3907) : !cute.shape<"((8,1),(2))">
            %lay_11585 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %sz_11586 = cute.size(%lay_11585) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11587 = cute.get_leaves(%sz_11586) : !cute.int_tuple<"2">
            %lay_11588 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %sz_11589 = cute.size(%lay_11588) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11590 = cute.get_leaves(%sz_11589) : !cute.int_tuple<"2">
            %3908 = cute.static : !cute.layout<"1:0">
            %iter_11591 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11592 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11593 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %lay_11594 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %append_11595 = cute.append_to_rank<2> (%lay_11593, %3908) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11596 = cute.append_to_rank<2> (%lay_11594, %3908) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11597 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11598 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11599 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11600 = cute.get_layout(%view_11574) : !memref_rmem_i8_3
            %append_11601 = cute.append_to_rank<2> (%lay_11600, %3908) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11602 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11603 = cute.size(%lay_11597) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3909 = cute.get_scalars(%sz_11603) : !cute.int_tuple<"2">
            %c0_i32_11604 = arith.constant 0 : i32
            %c1_i32_11605 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11604 to %3909 step %c1_i32_11605  : i32 {
              %coord_11606 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3910 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11607 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11608 = cute.crd2idx(%coord_11606, %lay_11597) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11609 = cute.add_offset(%iter_11591, %idx_11608) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11610 = cute.make_view(%ptr_11609, %lay_11607) : !memref_gmem_bf16_8
              %3911 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11611 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11612 = cute.crd2idx(%coord_11606, %lay_11598) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11613 = cute.add_offset(%iter_11592, %idx_11612) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11614 = cute.make_view(%ptr_11613, %lay_11611) : !memref_smem_bf16_13
              %3912 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11615 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11616 = cute.crd2idx(%coord_11606, %lay_11602) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11617 = cute.add_offset(%iter_11599, %idx_11616) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11618 = cute.make_view(%ptr_11617, %lay_11615) : !memref_rmem_i8_4
              %iter_11619 = cute.get_iter(%view_11610) : !memref_gmem_bf16_8
              %iter_11620 = cute.get_iter(%view_11614) : !memref_smem_bf16_13
              %iter_11621 = cute.get_iter(%view_11618) : !memref_rmem_i8_4
              %3913 = builtin.unrealized_conversion_cast %iter_11621 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3914 = llvm.load %3913 : !llvm.ptr -> i8
              %3915 = llvm.trunc %3914 : i8 to i1
              %iter_11622 = cute.recast_iter(%iter_11619) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11623 = cute.recast_iter(%iter_11620) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11623 : !cute.ptr<i128, smem>, %iter_11622 : !cute.ptr<i128, gmem>, %3915 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11507 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11508 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_11510 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_smem_bf16_14
            %iter_11513 = cute.get_iter(%view_11512) : !memref_smem_bf16_14
            %lay_11514 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %sz_11515 = cute.size(%lay_11514) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11516 = cute.get_leaves(%sz_11515) : !cute.int_tuple<"16">
            %lay_11517 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %3901 = cute.get_shape(%lay_11517) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11518, %e1_11519, %e2_11520 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %int_tuple_11521 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11522 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11523 = cute.get_leaves(%int_tuple_11522) : !cute.int_tuple<"16">
            %cst_11524 = arith.constant 0.000000e+00 : bf16
            %3902 = vector.splat %cst_11524 : vector<16xbf16>
            %int_tuple_11525 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11526 = cute.size(%int_tuple_11525) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11527 = cute.get_leaves(%sz_11526) : !cute.int_tuple<"16">
            %int_tuple_11528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11529 = cute.size(%int_tuple_11528) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11530 = cute.get_leaves(%sz_11529) : !cute.int_tuple<"16">
            cute.memref.store_vec %3902, %view_11512, row_major : !memref_smem_bf16_14
          }
          %coord_11408 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_11409 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11410 = cute.crd2idx(%coord_11408, %lay_11409) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_11411 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11412 = cute.add_offset(%iter_11411, %idx_11410) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11413 = cute.make_view(%tup_11412) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11414 = cute.get_iter(%view_11413) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11415, %e1_11416, %e2_11417, %e3_11418 = cute.get_leaves(%iter_11414) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3838 = cute.get_scalars(%e0_11415) : !cute.int_tuple<"?">
          %3839 = cute.get_scalars(%e1_11416) : !cute.int_tuple<"?">
          %3840 = cute.get_scalars(%e2_11417) : !cute.int_tuple<"?">
          %3841 = cute.get_scalars(%e3_11418) : !cute.int_tuple<"?{div=8}">
          %iter_11419 = cute.get_iter(%view_11413) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11420, %e1_11421, %e2_11422, %e3_11423 = cute.get_leaves(%iter_11419) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3842 = cute.get_scalars(%e0_11420) : !cute.int_tuple<"?">
          %3843 = cute.get_scalars(%e1_11421) : !cute.int_tuple<"?">
          %3844 = cute.get_scalars(%e2_11422) : !cute.int_tuple<"?">
          %3845 = cute.get_scalars(%e3_11423) : !cute.int_tuple<"?{div=8}">
          %iter_11424 = cute.get_iter(%view_11413) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11425, %e1_11426, %e2_11427, %e3_11428 = cute.get_leaves(%iter_11424) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3846 = cute.get_scalars(%e0_11425) : !cute.int_tuple<"?">
          %3847 = cute.get_scalars(%e1_11426) : !cute.int_tuple<"?">
          %3848 = cute.get_scalars(%e2_11427) : !cute.int_tuple<"?">
          %3849 = cute.get_scalars(%e3_11428) : !cute.int_tuple<"?{div=8}">
          %lay_11429 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3850 = cute.get_shape(%lay_11429) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11430, %e1_11431, %e2_11432, %e3_11433 = cute.get_leaves(%3850) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11434 = cute.to_int_tuple(%e0_11430) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3851 = cute.get_scalars(%itup_11434) : !cute.int_tuple<"?">
          %itup_11435 = cute.to_int_tuple(%e1_11431) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3852 = cute.get_scalars(%itup_11435) : !cute.int_tuple<"?">
          %itup_11436 = cute.to_int_tuple(%e2_11432) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3853 = cute.get_scalars(%itup_11436) : !cute.int_tuple<"?">
          %itup_11437 = cute.to_int_tuple(%e3_11433) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3854 = cute.get_scalars(%itup_11437) : !cute.int_tuple<"?{div=8}">
          %coord_11438 = cute.make_coord(%e1_11426) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11439 = cute.make_coord(%itup_11435) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3855 = cute.get_scalars(%coord_11438) : !cute.coord<"?">
          %3856 = cute.get_scalars(%coord_11439) : !cute.coord<"?">
          %true_11440 = arith.constant true
          %3857 = arith.cmpi slt, %3855, %3856 : i32
          %3858 = arith.andi %true_11440, %3857 : i1
          scf.if %3858 {
            %coord_11507 = cute.make_coord(%3389) : (i32) -> !cute.coord<"(_,1,_,?)">
            %lay_11508 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_11510 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_gmem_bf16_6
            %iter_11513 = cute.get_iter(%view_11512) : !memref_gmem_bf16_6
            %coord_11514 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11515 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11516 = cute.crd2idx(%coord_11514, %lay_11515) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_11517 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11518 = cute.add_offset(%iter_11517, %idx_11516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11519 = cute.make_view(%ptr_11518) : !memref_smem_bf16_14
            %iter_11520 = cute.get_iter(%view_11519) : !memref_smem_bf16_14
            %coord_11521 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11522 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
            %idx_11523 = cute.crd2idx(%coord_11521, %lay_11522) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11524 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
            %ptr_11525 = cute.add_offset(%iter_11524, %idx_11523) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11526 = cute.make_view(%ptr_11525) : !memref_rmem_i8_2
            %iter_11527 = cute.get_iter(%view_11526) : !memref_rmem_i8_2
            %lay_11528 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %3901 = cute.get_shape(%lay_11528) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11529, %e1_11530, %e2_11531 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %lay_11532 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %3902 = cute.get_shape(%lay_11532) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11533, %e1_11534, %e2_11535 = cute.get_leaves(%3902) : !cute.shape<"((8,1),2)">
            %lay_11536 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %shape_11537 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11538 = cute.make_layout() : !cute.layout<"1:0">
            %append_11539 = cute.append_to_rank<2> (%lay_11536, %lay_11538) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11540 = cute.make_view(%iter_11513, %append_11539) : !memref_gmem_bf16_6
            %iter_11541 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %lay_11542 = cute.get_layout(%view_11540) : !memref_gmem_bf16_6
            %3903 = cute.get_shape(%lay_11542) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11543, %e1_11544, %e2_11545 = cute.get_leaves(%3903) : !cute.shape<"((8,1),2)">
            %iter_11546 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %view_11547 = cute.make_view(%iter_11546) : !memref_gmem_bf16_7
            %iter_11548 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11549 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %lay_11550 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %shape_11551 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11552 = cute.make_layout() : !cute.layout<"1:0">
            %append_11553 = cute.append_to_rank<2> (%lay_11550, %lay_11552) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11554 = cute.make_view(%iter_11520, %append_11553) : !memref_smem_bf16_14
            %iter_11555 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %lay_11556 = cute.get_layout(%view_11554) : !memref_smem_bf16_14
            %3904 = cute.get_shape(%lay_11556) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11557, %e1_11558, %e2_11559 = cute.get_leaves(%3904) : !cute.shape<"((8,1),2)">
            %iter_11560 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %view_11561 = cute.make_view(%iter_11560) : !memref_smem_bf16_15
            %iter_11562 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %iter_11563 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11564 = cute.get_layout(%view_11526) : !memref_rmem_i8_2
            %shape_11565 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11566 = cute.make_layout() : !cute.layout<"1:0">
            %append_11567 = cute.append_to_rank<2> (%lay_11564, %lay_11566) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11568 = cute.make_view(%iter_11527, %append_11567) : !memref_rmem_i8_2
            %iter_11569 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %lay_11570 = cute.get_layout(%view_11568) : !memref_rmem_i8_2
            %3905 = cute.get_shape(%lay_11570) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11571, %e1_11572 = cute.get_leaves(%3905) : !cute.shape<"(1,2)">
            %iter_11573 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %view_11574 = cute.make_view(%iter_11573) : !memref_rmem_i8_3
            %iter_11575 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %iter_11576 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11577 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %3906 = cute.get_shape(%lay_11577) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11578, %e1_11579, %e2_11580 = cute.get_leaves(%3906) : !cute.shape<"((8,1),(2))">
            %lay_11581 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %3907 = cute.get_shape(%lay_11581) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11582, %e1_11583, %e2_11584 = cute.get_leaves(%3907) : !cute.shape<"((8,1),(2))">
            %lay_11585 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %sz_11586 = cute.size(%lay_11585) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11587 = cute.get_leaves(%sz_11586) : !cute.int_tuple<"2">
            %lay_11588 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %sz_11589 = cute.size(%lay_11588) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11590 = cute.get_leaves(%sz_11589) : !cute.int_tuple<"2">
            %3908 = cute.static : !cute.layout<"1:0">
            %iter_11591 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11592 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11593 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %lay_11594 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %append_11595 = cute.append_to_rank<2> (%lay_11593, %3908) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11596 = cute.append_to_rank<2> (%lay_11594, %3908) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11597 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11598 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11599 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11600 = cute.get_layout(%view_11574) : !memref_rmem_i8_3
            %append_11601 = cute.append_to_rank<2> (%lay_11600, %3908) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11602 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11603 = cute.size(%lay_11597) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3909 = cute.get_scalars(%sz_11603) : !cute.int_tuple<"2">
            %c0_i32_11604 = arith.constant 0 : i32
            %c1_i32_11605 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11604 to %3909 step %c1_i32_11605  : i32 {
              %coord_11606 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3910 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11607 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11608 = cute.crd2idx(%coord_11606, %lay_11597) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11609 = cute.add_offset(%iter_11591, %idx_11608) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11610 = cute.make_view(%ptr_11609, %lay_11607) : !memref_gmem_bf16_8
              %3911 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11611 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11612 = cute.crd2idx(%coord_11606, %lay_11598) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11613 = cute.add_offset(%iter_11592, %idx_11612) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11614 = cute.make_view(%ptr_11613, %lay_11611) : !memref_smem_bf16_13
              %3912 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11615 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11616 = cute.crd2idx(%coord_11606, %lay_11602) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11617 = cute.add_offset(%iter_11599, %idx_11616) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11618 = cute.make_view(%ptr_11617, %lay_11615) : !memref_rmem_i8_4
              %iter_11619 = cute.get_iter(%view_11610) : !memref_gmem_bf16_8
              %iter_11620 = cute.get_iter(%view_11614) : !memref_smem_bf16_13
              %iter_11621 = cute.get_iter(%view_11618) : !memref_rmem_i8_4
              %3913 = builtin.unrealized_conversion_cast %iter_11621 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3914 = llvm.load %3913 : !llvm.ptr -> i8
              %3915 = llvm.trunc %3914 : i8 to i1
              %iter_11622 = cute.recast_iter(%iter_11619) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11623 = cute.recast_iter(%iter_11620) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11623 : !cute.ptr<i128, smem>, %iter_11622 : !cute.ptr<i128, gmem>, %3915 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11507 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11508 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_11510 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_smem_bf16_14
            %iter_11513 = cute.get_iter(%view_11512) : !memref_smem_bf16_14
            %lay_11514 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %sz_11515 = cute.size(%lay_11514) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11516 = cute.get_leaves(%sz_11515) : !cute.int_tuple<"16">
            %lay_11517 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %3901 = cute.get_shape(%lay_11517) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11518, %e1_11519, %e2_11520 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %int_tuple_11521 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11522 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11523 = cute.get_leaves(%int_tuple_11522) : !cute.int_tuple<"16">
            %cst_11524 = arith.constant 0.000000e+00 : bf16
            %3902 = vector.splat %cst_11524 : vector<16xbf16>
            %int_tuple_11525 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11526 = cute.size(%int_tuple_11525) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11527 = cute.get_leaves(%sz_11526) : !cute.int_tuple<"16">
            %int_tuple_11528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11529 = cute.size(%int_tuple_11528) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11530 = cute.get_leaves(%sz_11529) : !cute.int_tuple<"16">
            cute.memref.store_vec %3902, %view_11512, row_major : !memref_smem_bf16_14
          }
          %coord_11441 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_11442 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11443 = cute.crd2idx(%coord_11441, %lay_11442) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_11444 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11445 = cute.add_offset(%iter_11444, %idx_11443) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11446 = cute.make_view(%tup_11445) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11447 = cute.get_iter(%view_11446) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11448, %e1_11449, %e2_11450, %e3_11451 = cute.get_leaves(%iter_11447) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3859 = cute.get_scalars(%e0_11448) : !cute.int_tuple<"?">
          %3860 = cute.get_scalars(%e1_11449) : !cute.int_tuple<"?">
          %3861 = cute.get_scalars(%e2_11450) : !cute.int_tuple<"?">
          %3862 = cute.get_scalars(%e3_11451) : !cute.int_tuple<"?{div=8}">
          %iter_11452 = cute.get_iter(%view_11446) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11453, %e1_11454, %e2_11455, %e3_11456 = cute.get_leaves(%iter_11452) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3863 = cute.get_scalars(%e0_11453) : !cute.int_tuple<"?">
          %3864 = cute.get_scalars(%e1_11454) : !cute.int_tuple<"?">
          %3865 = cute.get_scalars(%e2_11455) : !cute.int_tuple<"?">
          %3866 = cute.get_scalars(%e3_11456) : !cute.int_tuple<"?{div=8}">
          %iter_11457 = cute.get_iter(%view_11446) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11458, %e1_11459, %e2_11460, %e3_11461 = cute.get_leaves(%iter_11457) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3867 = cute.get_scalars(%e0_11458) : !cute.int_tuple<"?">
          %3868 = cute.get_scalars(%e1_11459) : !cute.int_tuple<"?">
          %3869 = cute.get_scalars(%e2_11460) : !cute.int_tuple<"?">
          %3870 = cute.get_scalars(%e3_11461) : !cute.int_tuple<"?{div=8}">
          %lay_11462 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3871 = cute.get_shape(%lay_11462) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11463, %e1_11464, %e2_11465, %e3_11466 = cute.get_leaves(%3871) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11467 = cute.to_int_tuple(%e0_11463) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3872 = cute.get_scalars(%itup_11467) : !cute.int_tuple<"?">
          %itup_11468 = cute.to_int_tuple(%e1_11464) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3873 = cute.get_scalars(%itup_11468) : !cute.int_tuple<"?">
          %itup_11469 = cute.to_int_tuple(%e2_11465) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3874 = cute.get_scalars(%itup_11469) : !cute.int_tuple<"?">
          %itup_11470 = cute.to_int_tuple(%e3_11466) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3875 = cute.get_scalars(%itup_11470) : !cute.int_tuple<"?{div=8}">
          %coord_11471 = cute.make_coord(%e1_11459) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11472 = cute.make_coord(%itup_11468) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3876 = cute.get_scalars(%coord_11471) : !cute.coord<"?">
          %3877 = cute.get_scalars(%coord_11472) : !cute.coord<"?">
          %true_11473 = arith.constant true
          %3878 = arith.cmpi slt, %3876, %3877 : i32
          %3879 = arith.andi %true_11473, %3878 : i1
          scf.if %3879 {
            %coord_11507 = cute.make_coord(%3389) : (i32) -> !cute.coord<"(_,2,_,?)">
            %lay_11508 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_11510 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_gmem_bf16_6
            %iter_11513 = cute.get_iter(%view_11512) : !memref_gmem_bf16_6
            %coord_11514 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11515 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11516 = cute.crd2idx(%coord_11514, %lay_11515) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_11517 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11518 = cute.add_offset(%iter_11517, %idx_11516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11519 = cute.make_view(%ptr_11518) : !memref_smem_bf16_14
            %iter_11520 = cute.get_iter(%view_11519) : !memref_smem_bf16_14
            %coord_11521 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11522 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
            %idx_11523 = cute.crd2idx(%coord_11521, %lay_11522) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11524 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
            %ptr_11525 = cute.add_offset(%iter_11524, %idx_11523) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11526 = cute.make_view(%ptr_11525) : !memref_rmem_i8_2
            %iter_11527 = cute.get_iter(%view_11526) : !memref_rmem_i8_2
            %lay_11528 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %3901 = cute.get_shape(%lay_11528) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11529, %e1_11530, %e2_11531 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %lay_11532 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %3902 = cute.get_shape(%lay_11532) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11533, %e1_11534, %e2_11535 = cute.get_leaves(%3902) : !cute.shape<"((8,1),2)">
            %lay_11536 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %shape_11537 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11538 = cute.make_layout() : !cute.layout<"1:0">
            %append_11539 = cute.append_to_rank<2> (%lay_11536, %lay_11538) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11540 = cute.make_view(%iter_11513, %append_11539) : !memref_gmem_bf16_6
            %iter_11541 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %lay_11542 = cute.get_layout(%view_11540) : !memref_gmem_bf16_6
            %3903 = cute.get_shape(%lay_11542) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11543, %e1_11544, %e2_11545 = cute.get_leaves(%3903) : !cute.shape<"((8,1),2)">
            %iter_11546 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %view_11547 = cute.make_view(%iter_11546) : !memref_gmem_bf16_7
            %iter_11548 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11549 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %lay_11550 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %shape_11551 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11552 = cute.make_layout() : !cute.layout<"1:0">
            %append_11553 = cute.append_to_rank<2> (%lay_11550, %lay_11552) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11554 = cute.make_view(%iter_11520, %append_11553) : !memref_smem_bf16_14
            %iter_11555 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %lay_11556 = cute.get_layout(%view_11554) : !memref_smem_bf16_14
            %3904 = cute.get_shape(%lay_11556) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11557, %e1_11558, %e2_11559 = cute.get_leaves(%3904) : !cute.shape<"((8,1),2)">
            %iter_11560 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %view_11561 = cute.make_view(%iter_11560) : !memref_smem_bf16_15
            %iter_11562 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %iter_11563 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11564 = cute.get_layout(%view_11526) : !memref_rmem_i8_2
            %shape_11565 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11566 = cute.make_layout() : !cute.layout<"1:0">
            %append_11567 = cute.append_to_rank<2> (%lay_11564, %lay_11566) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11568 = cute.make_view(%iter_11527, %append_11567) : !memref_rmem_i8_2
            %iter_11569 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %lay_11570 = cute.get_layout(%view_11568) : !memref_rmem_i8_2
            %3905 = cute.get_shape(%lay_11570) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11571, %e1_11572 = cute.get_leaves(%3905) : !cute.shape<"(1,2)">
            %iter_11573 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %view_11574 = cute.make_view(%iter_11573) : !memref_rmem_i8_3
            %iter_11575 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %iter_11576 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11577 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %3906 = cute.get_shape(%lay_11577) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11578, %e1_11579, %e2_11580 = cute.get_leaves(%3906) : !cute.shape<"((8,1),(2))">
            %lay_11581 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %3907 = cute.get_shape(%lay_11581) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11582, %e1_11583, %e2_11584 = cute.get_leaves(%3907) : !cute.shape<"((8,1),(2))">
            %lay_11585 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %sz_11586 = cute.size(%lay_11585) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11587 = cute.get_leaves(%sz_11586) : !cute.int_tuple<"2">
            %lay_11588 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %sz_11589 = cute.size(%lay_11588) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11590 = cute.get_leaves(%sz_11589) : !cute.int_tuple<"2">
            %3908 = cute.static : !cute.layout<"1:0">
            %iter_11591 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11592 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11593 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %lay_11594 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %append_11595 = cute.append_to_rank<2> (%lay_11593, %3908) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11596 = cute.append_to_rank<2> (%lay_11594, %3908) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11597 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11598 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11599 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11600 = cute.get_layout(%view_11574) : !memref_rmem_i8_3
            %append_11601 = cute.append_to_rank<2> (%lay_11600, %3908) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11602 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11603 = cute.size(%lay_11597) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3909 = cute.get_scalars(%sz_11603) : !cute.int_tuple<"2">
            %c0_i32_11604 = arith.constant 0 : i32
            %c1_i32_11605 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11604 to %3909 step %c1_i32_11605  : i32 {
              %coord_11606 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3910 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11607 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11608 = cute.crd2idx(%coord_11606, %lay_11597) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11609 = cute.add_offset(%iter_11591, %idx_11608) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11610 = cute.make_view(%ptr_11609, %lay_11607) : !memref_gmem_bf16_8
              %3911 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11611 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11612 = cute.crd2idx(%coord_11606, %lay_11598) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11613 = cute.add_offset(%iter_11592, %idx_11612) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11614 = cute.make_view(%ptr_11613, %lay_11611) : !memref_smem_bf16_13
              %3912 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11615 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11616 = cute.crd2idx(%coord_11606, %lay_11602) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11617 = cute.add_offset(%iter_11599, %idx_11616) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11618 = cute.make_view(%ptr_11617, %lay_11615) : !memref_rmem_i8_4
              %iter_11619 = cute.get_iter(%view_11610) : !memref_gmem_bf16_8
              %iter_11620 = cute.get_iter(%view_11614) : !memref_smem_bf16_13
              %iter_11621 = cute.get_iter(%view_11618) : !memref_rmem_i8_4
              %3913 = builtin.unrealized_conversion_cast %iter_11621 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3914 = llvm.load %3913 : !llvm.ptr -> i8
              %3915 = llvm.trunc %3914 : i8 to i1
              %iter_11622 = cute.recast_iter(%iter_11619) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11623 = cute.recast_iter(%iter_11620) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11623 : !cute.ptr<i128, smem>, %iter_11622 : !cute.ptr<i128, gmem>, %3915 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11507 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11508 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_11510 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_smem_bf16_14
            %iter_11513 = cute.get_iter(%view_11512) : !memref_smem_bf16_14
            %lay_11514 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %sz_11515 = cute.size(%lay_11514) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11516 = cute.get_leaves(%sz_11515) : !cute.int_tuple<"16">
            %lay_11517 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %3901 = cute.get_shape(%lay_11517) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11518, %e1_11519, %e2_11520 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %int_tuple_11521 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11522 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11523 = cute.get_leaves(%int_tuple_11522) : !cute.int_tuple<"16">
            %cst_11524 = arith.constant 0.000000e+00 : bf16
            %3902 = vector.splat %cst_11524 : vector<16xbf16>
            %int_tuple_11525 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11526 = cute.size(%int_tuple_11525) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11527 = cute.get_leaves(%sz_11526) : !cute.int_tuple<"16">
            %int_tuple_11528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11529 = cute.size(%int_tuple_11528) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11530 = cute.get_leaves(%sz_11529) : !cute.int_tuple<"16">
            cute.memref.store_vec %3902, %view_11512, row_major : !memref_smem_bf16_14
          }
          %coord_11474 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_11475 = cute.get_layout(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11476 = cute.crd2idx(%coord_11474, %lay_11475) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_11477 = cute.get_iter(%view_989) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11478 = cute.add_offset(%iter_11477, %idx_11476) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11479 = cute.make_view(%tup_11478) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11480 = cute.get_iter(%view_11479) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11481, %e1_11482, %e2_11483, %e3_11484 = cute.get_leaves(%iter_11480) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3880 = cute.get_scalars(%e0_11481) : !cute.int_tuple<"?">
          %3881 = cute.get_scalars(%e1_11482) : !cute.int_tuple<"?">
          %3882 = cute.get_scalars(%e2_11483) : !cute.int_tuple<"?">
          %3883 = cute.get_scalars(%e3_11484) : !cute.int_tuple<"?{div=8}">
          %iter_11485 = cute.get_iter(%view_11479) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11486, %e1_11487, %e2_11488, %e3_11489 = cute.get_leaves(%iter_11485) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3884 = cute.get_scalars(%e0_11486) : !cute.int_tuple<"?">
          %3885 = cute.get_scalars(%e1_11487) : !cute.int_tuple<"?">
          %3886 = cute.get_scalars(%e2_11488) : !cute.int_tuple<"?">
          %3887 = cute.get_scalars(%e3_11489) : !cute.int_tuple<"?{div=8}">
          %iter_11490 = cute.get_iter(%view_11479) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11491, %e1_11492, %e2_11493, %e3_11494 = cute.get_leaves(%iter_11490) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3888 = cute.get_scalars(%e0_11491) : !cute.int_tuple<"?">
          %3889 = cute.get_scalars(%e1_11492) : !cute.int_tuple<"?">
          %3890 = cute.get_scalars(%e2_11493) : !cute.int_tuple<"?">
          %3891 = cute.get_scalars(%e3_11494) : !cute.int_tuple<"?{div=8}">
          %lay_11495 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3892 = cute.get_shape(%lay_11495) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11496, %e1_11497, %e2_11498, %e3_11499 = cute.get_leaves(%3892) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11500 = cute.to_int_tuple(%e0_11496) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3893 = cute.get_scalars(%itup_11500) : !cute.int_tuple<"?">
          %itup_11501 = cute.to_int_tuple(%e1_11497) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3894 = cute.get_scalars(%itup_11501) : !cute.int_tuple<"?">
          %itup_11502 = cute.to_int_tuple(%e2_11498) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3895 = cute.get_scalars(%itup_11502) : !cute.int_tuple<"?">
          %itup_11503 = cute.to_int_tuple(%e3_11499) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3896 = cute.get_scalars(%itup_11503) : !cute.int_tuple<"?{div=8}">
          %coord_11504 = cute.make_coord(%e1_11492) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11505 = cute.make_coord(%itup_11501) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3897 = cute.get_scalars(%coord_11504) : !cute.coord<"?">
          %3898 = cute.get_scalars(%coord_11505) : !cute.coord<"?">
          %true_11506 = arith.constant true
          %3899 = arith.cmpi slt, %3897, %3898 : i32
          %3900 = arith.andi %true_11506, %3899 : i1
          scf.if %3900 {
            %coord_11507 = cute.make_coord(%3389) : (i32) -> !cute.coord<"(_,3,_,?)">
            %lay_11508 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_11510 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_gmem_bf16_6
            %iter_11513 = cute.get_iter(%view_11512) : !memref_gmem_bf16_6
            %coord_11514 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11515 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11516 = cute.crd2idx(%coord_11514, %lay_11515) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_11517 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11518 = cute.add_offset(%iter_11517, %idx_11516) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11519 = cute.make_view(%ptr_11518) : !memref_smem_bf16_14
            %iter_11520 = cute.get_iter(%view_11519) : !memref_smem_bf16_14
            %coord_11521 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11522 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
            %idx_11523 = cute.crd2idx(%coord_11521, %lay_11522) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11524 = cute.get_iter(%rmem_1032) : !memref_rmem_i8_1
            %ptr_11525 = cute.add_offset(%iter_11524, %idx_11523) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11526 = cute.make_view(%ptr_11525) : !memref_rmem_i8_2
            %iter_11527 = cute.get_iter(%view_11526) : !memref_rmem_i8_2
            %lay_11528 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %3901 = cute.get_shape(%lay_11528) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11529, %e1_11530, %e2_11531 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %lay_11532 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %3902 = cute.get_shape(%lay_11532) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11533, %e1_11534, %e2_11535 = cute.get_leaves(%3902) : !cute.shape<"((8,1),2)">
            %lay_11536 = cute.get_layout(%view_11512) : !memref_gmem_bf16_6
            %shape_11537 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11538 = cute.make_layout() : !cute.layout<"1:0">
            %append_11539 = cute.append_to_rank<2> (%lay_11536, %lay_11538) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11540 = cute.make_view(%iter_11513, %append_11539) : !memref_gmem_bf16_6
            %iter_11541 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %lay_11542 = cute.get_layout(%view_11540) : !memref_gmem_bf16_6
            %3903 = cute.get_shape(%lay_11542) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11543, %e1_11544, %e2_11545 = cute.get_leaves(%3903) : !cute.shape<"((8,1),2)">
            %iter_11546 = cute.get_iter(%view_11540) : !memref_gmem_bf16_6
            %view_11547 = cute.make_view(%iter_11546) : !memref_gmem_bf16_7
            %iter_11548 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11549 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %lay_11550 = cute.get_layout(%view_11519) : !memref_smem_bf16_14
            %shape_11551 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11552 = cute.make_layout() : !cute.layout<"1:0">
            %append_11553 = cute.append_to_rank<2> (%lay_11550, %lay_11552) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11554 = cute.make_view(%iter_11520, %append_11553) : !memref_smem_bf16_14
            %iter_11555 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %lay_11556 = cute.get_layout(%view_11554) : !memref_smem_bf16_14
            %3904 = cute.get_shape(%lay_11556) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11557, %e1_11558, %e2_11559 = cute.get_leaves(%3904) : !cute.shape<"((8,1),2)">
            %iter_11560 = cute.get_iter(%view_11554) : !memref_smem_bf16_14
            %view_11561 = cute.make_view(%iter_11560) : !memref_smem_bf16_15
            %iter_11562 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %iter_11563 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11564 = cute.get_layout(%view_11526) : !memref_rmem_i8_2
            %shape_11565 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11566 = cute.make_layout() : !cute.layout<"1:0">
            %append_11567 = cute.append_to_rank<2> (%lay_11564, %lay_11566) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11568 = cute.make_view(%iter_11527, %append_11567) : !memref_rmem_i8_2
            %iter_11569 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %lay_11570 = cute.get_layout(%view_11568) : !memref_rmem_i8_2
            %3905 = cute.get_shape(%lay_11570) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11571, %e1_11572 = cute.get_leaves(%3905) : !cute.shape<"(1,2)">
            %iter_11573 = cute.get_iter(%view_11568) : !memref_rmem_i8_2
            %view_11574 = cute.make_view(%iter_11573) : !memref_rmem_i8_3
            %iter_11575 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %iter_11576 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11577 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %3906 = cute.get_shape(%lay_11577) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11578, %e1_11579, %e2_11580 = cute.get_leaves(%3906) : !cute.shape<"((8,1),(2))">
            %lay_11581 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %3907 = cute.get_shape(%lay_11581) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11582, %e1_11583, %e2_11584 = cute.get_leaves(%3907) : !cute.shape<"((8,1),(2))">
            %lay_11585 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %sz_11586 = cute.size(%lay_11585) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11587 = cute.get_leaves(%sz_11586) : !cute.int_tuple<"2">
            %lay_11588 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %sz_11589 = cute.size(%lay_11588) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11590 = cute.get_leaves(%sz_11589) : !cute.int_tuple<"2">
            %3908 = cute.static : !cute.layout<"1:0">
            %iter_11591 = cute.get_iter(%view_11547) : !memref_gmem_bf16_7
            %iter_11592 = cute.get_iter(%view_11561) : !memref_smem_bf16_15
            %lay_11593 = cute.get_layout(%view_11547) : !memref_gmem_bf16_7
            %lay_11594 = cute.get_layout(%view_11561) : !memref_smem_bf16_15
            %append_11595 = cute.append_to_rank<2> (%lay_11593, %3908) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11596 = cute.append_to_rank<2> (%lay_11594, %3908) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11597 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11598 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11599 = cute.get_iter(%view_11574) : !memref_rmem_i8_3
            %lay_11600 = cute.get_layout(%view_11574) : !memref_rmem_i8_3
            %append_11601 = cute.append_to_rank<2> (%lay_11600, %3908) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11602 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11603 = cute.size(%lay_11597) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3909 = cute.get_scalars(%sz_11603) : !cute.int_tuple<"2">
            %c0_i32_11604 = arith.constant 0 : i32
            %c1_i32_11605 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11604 to %3909 step %c1_i32_11605  : i32 {
              %coord_11606 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3910 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11607 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11608 = cute.crd2idx(%coord_11606, %lay_11597) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11609 = cute.add_offset(%iter_11591, %idx_11608) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11610 = cute.make_view(%ptr_11609, %lay_11607) : !memref_gmem_bf16_8
              %3911 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11611 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11612 = cute.crd2idx(%coord_11606, %lay_11598) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11613 = cute.add_offset(%iter_11592, %idx_11612) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11614 = cute.make_view(%ptr_11613, %lay_11611) : !memref_smem_bf16_13
              %3912 = cute.get_scalars(%coord_11606) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11615 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11616 = cute.crd2idx(%coord_11606, %lay_11602) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11617 = cute.add_offset(%iter_11599, %idx_11616) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11618 = cute.make_view(%ptr_11617, %lay_11615) : !memref_rmem_i8_4
              %iter_11619 = cute.get_iter(%view_11610) : !memref_gmem_bf16_8
              %iter_11620 = cute.get_iter(%view_11614) : !memref_smem_bf16_13
              %iter_11621 = cute.get_iter(%view_11618) : !memref_rmem_i8_4
              %3913 = builtin.unrealized_conversion_cast %iter_11621 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3914 = llvm.load %3913 : !llvm.ptr -> i8
              %3915 = llvm.trunc %3914 : i8 to i1
              %iter_11622 = cute.recast_iter(%iter_11619) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11623 = cute.recast_iter(%iter_11620) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11623 : !cute.ptr<i128, smem>, %iter_11622 : !cute.ptr<i128, gmem>, %3915 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11507 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11508 = cute.get_layout(%view_486) : !memref_smem_bf16_4
            %idx_11509 = cute.crd2idx(%coord_11507, %lay_11508) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_11510 = cute.get_iter(%view_486) : !memref_smem_bf16_4
            %ptr_11511 = cute.add_offset(%iter_11510, %idx_11509) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11512 = cute.make_view(%ptr_11511) : !memref_smem_bf16_14
            %iter_11513 = cute.get_iter(%view_11512) : !memref_smem_bf16_14
            %lay_11514 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %sz_11515 = cute.size(%lay_11514) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11516 = cute.get_leaves(%sz_11515) : !cute.int_tuple<"16">
            %lay_11517 = cute.get_layout(%view_11512) : !memref_smem_bf16_14
            %3901 = cute.get_shape(%lay_11517) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11518, %e1_11519, %e2_11520 = cute.get_leaves(%3901) : !cute.shape<"((8,1),2)">
            %int_tuple_11521 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11522 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11523 = cute.get_leaves(%int_tuple_11522) : !cute.int_tuple<"16">
            %cst_11524 = arith.constant 0.000000e+00 : bf16
            %3902 = vector.splat %cst_11524 : vector<16xbf16>
            %int_tuple_11525 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11526 = cute.size(%int_tuple_11525) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11527 = cute.get_leaves(%sz_11526) : !cute.int_tuple<"16">
            %int_tuple_11528 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11529 = cute.size(%int_tuple_11528) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11530 = cute.get_leaves(%sz_11529) : !cute.int_tuple<"16">
            cute.memref.store_vec %3902, %view_11512, row_major : !memref_smem_bf16_14
          }
        } else {
          %coord_11367 = cute.make_coord(%3389) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_11368 = cute.get_layout(%view_441) : !memref_gmem_bf16_5
          %3816:3 = cute.get_scalars(%lay_11368) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_11369 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_11370 = cute.assume(%3816#1) : (i64) -> !cute.i64<divby 128>
          %stride_11371 = cute.make_stride(%iv_11370) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_11372 = cute.make_layout(%shape_11369, %stride_11371) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_11368) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_11374 = cute.get_iter(%view_441) : !memref_gmem_bf16_5
          %ptr_11375 = cute.add_offset(%iter_11374, %idx_11373) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_11376 = cute.make_view(%ptr_11375, %lay_11372) : !memref_gmem_bf16_9
          %iter_11377 = cute.get_iter(%view_11376) : !memref_gmem_bf16_9
          %lay_11378 = cute.get_layout(%view_11376) : !memref_gmem_bf16_9
          %3818 = cute.get_shape(%lay_11378) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11379, %e1_11380, %e2_11381, %e3_11382 = cute.get_leaves(%3818) : !cute.shape<"((8,1),4,2)">
          %lay_11383 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %3819 = cute.get_shape(%lay_11383) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11384, %e1_11385, %e2_11386, %e3_11387 = cute.get_leaves(%3819) : !cute.shape<"((8,1),4,2)">
          %lay_11388 = cute.get_layout(%view_11376) : !memref_gmem_bf16_9
          %shape_11389 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11390 = cute.make_layout() : !cute.layout<"1:0">
          %append_11391 = cute.append_to_rank<2> (%lay_11388, %lay_11390) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_11392 = cute.make_view(%iter_11377, %append_11391) : !memref_gmem_bf16_9
          %iter_11393 = cute.get_iter(%view_11392) : !memref_gmem_bf16_9
          %lay_11394 = cute.get_layout(%view_11392) : !memref_gmem_bf16_9
          %3820 = cute.get_shape(%lay_11394) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11395, %e1_11396, %e2_11397, %e3_11398 = cute.get_leaves(%3820) : !cute.shape<"((8,1),4,2)">
          %iter_11399 = cute.get_iter(%view_11392) : !memref_gmem_bf16_9
          %lay_11400 = cute.get_layout(%view_11392) : !memref_gmem_bf16_9
          %3821 = cute.get_scalars(%lay_11400) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_11401 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_11402 = cute.assume(%3821) : (i64) -> !cute.i64<divby 128>
          %stride_11403 = cute.make_stride(%iv_11402) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_11404 = cute.make_layout(%shape_11401, %stride_11403) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_11405 = cute.make_view(%iter_11399, %lay_11404) : !memref_gmem_bf16_10
          %iter_11406 = cute.get_iter(%view_11405) : !memref_gmem_bf16_10
          %iter_11407 = cute.get_iter(%view_11405) : !memref_gmem_bf16_10
          %lay_11408 = cute.get_layout(%view_486) : !memref_smem_bf16_4
          %shape_11409 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11410 = cute.make_layout() : !cute.layout<"1:0">
          %append_11411 = cute.append_to_rank<2> (%lay_11408, %lay_11410) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_11412 = cute.make_view(%iter_487, %append_11411) : !memref_smem_bf16_4
          %iter_11413 = cute.get_iter(%view_11412) : !memref_smem_bf16_4
          %lay_11414 = cute.get_layout(%view_11412) : !memref_smem_bf16_4
          %3822 = cute.get_shape(%lay_11414) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11415, %e1_11416, %e2_11417, %e3_11418 = cute.get_leaves(%3822) : !cute.shape<"((8,1),4,2)">
          %iter_11419 = cute.get_iter(%view_11412) : !memref_smem_bf16_4
          %view_11420 = cute.make_view(%iter_11419) : !memref_smem_bf16_16
          %iter_11421 = cute.get_iter(%view_11420) : !memref_smem_bf16_16
          %iter_11422 = cute.get_iter(%view_11420) : !memref_smem_bf16_16
          %lay_11423 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %shape_11424 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11425 = cute.make_layout() : !cute.layout<"1:0">
          %append_11426 = cute.append_to_rank<2> (%lay_11423, %lay_11425) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_11427 = cute.make_view(%iter_1034, %append_11426) : !memref_rmem_i8_1
          %iter_11428 = cute.get_iter(%view_11427) : !memref_rmem_i8_1
          %lay_11429 = cute.get_layout(%view_11427) : !memref_rmem_i8_1
          %3823 = cute.get_shape(%lay_11429) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_11430, %e1_11431, %e2_11432 = cute.get_leaves(%3823) : !cute.shape<"(1,4,2)">
          %iter_11433 = cute.get_iter(%view_11427) : !memref_rmem_i8_1
          %view_11434 = cute.make_view(%iter_11433) : !memref_rmem_i8_5
          %iter_11435 = cute.get_iter(%view_11434) : !memref_rmem_i8_5
          %iter_11436 = cute.get_iter(%view_11434) : !memref_rmem_i8_5
          %lay_11437 = cute.get_layout(%view_11405) : !memref_gmem_bf16_10
          %3824 = cute.get_shape(%lay_11437) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11438, %e1_11439, %e2_11440, %e3_11441 = cute.get_leaves(%3824) : !cute.shape<"((8,1),(4,2))">
          %lay_11442 = cute.get_layout(%view_11420) : !memref_smem_bf16_16
          %3825 = cute.get_shape(%lay_11442) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11443, %e1_11444, %e2_11445, %e3_11446 = cute.get_leaves(%3825) : !cute.shape<"((8,1),(4,2))">
          %lay_11447 = cute.get_layout(%view_11405) : !memref_gmem_bf16_10
          %sz_11448 = cute.size(%lay_11447) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_11449 = cute.get_leaves(%sz_11448) : !cute.int_tuple<"8">
          %lay_11450 = cute.get_layout(%view_11420) : !memref_smem_bf16_16
          %sz_11451 = cute.size(%lay_11450) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_11452 = cute.get_leaves(%sz_11451) : !cute.int_tuple<"8">
          %3826 = cute.static : !cute.layout<"1:0">
          %iter_11453 = cute.get_iter(%view_11405) : !memref_gmem_bf16_10
          %iter_11454 = cute.get_iter(%view_11420) : !memref_smem_bf16_16
          %lay_11455 = cute.get_layout(%view_11405) : !memref_gmem_bf16_10
          %lay_11456 = cute.get_layout(%view_11420) : !memref_smem_bf16_16
          %append_11457 = cute.append_to_rank<2> (%lay_11455, %3826) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_11458 = cute.append_to_rank<2> (%lay_11456, %3826) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %3827 = cute.get_scalars(%append_11457) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_11459 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_11460 = cute.assume(%3827) : (i64) -> !cute.i64<divby 128>
          %stride_11461 = cute.make_stride(%iv_11460) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_11462 = cute.make_layout(%shape_11459, %stride_11461) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_11463 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_11464 = cute.get_iter(%view_11434) : !memref_rmem_i8_5
          %lay_11465 = cute.get_layout(%view_11434) : !memref_rmem_i8_5
          %append_11466 = cute.append_to_rank<2> (%lay_11465, %3826) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_11467 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_11468 = cute.size(%lay_11462) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %3828 = cute.get_scalars(%sz_11468) : !cute.int_tuple<"8">
          %c0_i32_11469 = arith.constant 0 : i32
          %c1_i32_11470 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_11469 to %3828 step %c1_i32_11470  : i32 {
            %coord_11471 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %3829 = cute.get_scalars(%lay_11462) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %3830 = cute.get_scalars(%coord_11471) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11472 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11473 = cute.crd2idx(%coord_11471, %lay_11462) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_11474 = cute.add_offset(%iter_11453, %idx_11473) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11475 = cute.make_view(%ptr_11474, %lay_11472) : !memref_gmem_bf16_8
            %3831 = cute.get_scalars(%coord_11471) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11476 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11477 = cute.crd2idx(%coord_11471, %lay_11463) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_11478 = cute.add_offset(%iter_11454, %idx_11477) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11479 = cute.make_view(%ptr_11478, %lay_11476) : !memref_smem_bf16_13
            %3832 = cute.get_scalars(%coord_11471) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11480 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_11481 = cute.crd2idx(%coord_11471, %lay_11467) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_11482 = cute.add_offset(%iter_11464, %idx_11481) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_11483 = cute.make_view(%ptr_11482, %lay_11480) : !memref_rmem_i8_4
            %iter_11484 = cute.get_iter(%view_11475) : !memref_gmem_bf16_8
            %iter_11485 = cute.get_iter(%view_11479) : !memref_smem_bf16_13
            %iter_11486 = cute.get_iter(%view_11483) : !memref_rmem_i8_4
            %3833 = builtin.unrealized_conversion_cast %iter_11486 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3834 = llvm.load %3833 : !llvm.ptr -> i8
            %3835 = llvm.trunc %3834 : i8 to i1
            %iter_11487 = cute.recast_iter(%iter_11484) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_11488 = cute.recast_iter(%iter_11485) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_11488 : !cute.ptr<i128, smem>, %iter_11487 : !cute.ptr<i128, gmem>, %3835 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %coord_8563 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8564 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_8565 = cute.crd2idx(%coord_8563, %lay_8564) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_8566 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_8567 = cute.add_offset(%iter_8566, %idx_8565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8568 = cute.make_view(%ptr_8567) : !memref_smem_bf16_14
        %iter_8569 = cute.get_iter(%view_8568) : !memref_smem_bf16_14
        %coord_8570 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8571 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_8572 = cute.crd2idx(%coord_8570, %lay_8571) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_8573 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_8574 = cute.add_offset(%iter_8573, %idx_8572) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8575 = cute.make_view(%ptr_8574) : !memref_rmem_bf16_6
        %iter_8576 = cute.get_iter(%view_8575) : !memref_rmem_bf16_6
        %lay_8577 = cute.get_layout(%view_8568) : !memref_smem_bf16_14
        %3392 = cute.get_shape(%lay_8577) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8578, %e1_8579, %e2_8580 = cute.get_leaves(%3392) : !cute.shape<"((8,1),2)">
        %lay_8581 = cute.get_layout(%view_8575) : !memref_rmem_bf16_6
        %3393 = cute.get_shape(%lay_8581) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8582, %e1_8583, %e2_8584 = cute.get_leaves(%3393) : !cute.shape<"((8,1),2)">
        %lay_8585 = cute.get_layout(%view_8568) : !memref_smem_bf16_14
        %shape_8586 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8587 = cute.make_layout() : !cute.layout<"1:0">
        %append_8588 = cute.append_to_rank<2> (%lay_8585, %lay_8587) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8589 = cute.make_view(%iter_8569, %append_8588) : !memref_smem_bf16_14
        %iter_8590 = cute.get_iter(%view_8589) : !memref_smem_bf16_14
        %lay_8591 = cute.get_layout(%view_8589) : !memref_smem_bf16_14
        %3394 = cute.get_shape(%lay_8591) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8592, %e1_8593, %e2_8594 = cute.get_leaves(%3394) : !cute.shape<"((8,1),2)">
        %iter_8595 = cute.get_iter(%view_8589) : !memref_smem_bf16_14
        %view_8596 = cute.make_view(%iter_8595) : !memref_smem_bf16_15
        %iter_8597 = cute.get_iter(%view_8596) : !memref_smem_bf16_15
        %iter_8598 = cute.get_iter(%view_8596) : !memref_smem_bf16_15
        %lay_8599 = cute.get_layout(%view_8575) : !memref_rmem_bf16_6
        %shape_8600 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8601 = cute.make_layout() : !cute.layout<"1:0">
        %append_8602 = cute.append_to_rank<2> (%lay_8599, %lay_8601) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8603 = cute.make_view(%iter_8576, %append_8602) : !memref_rmem_bf16_6
        %iter_8604 = cute.get_iter(%view_8603) : !memref_rmem_bf16_6
        %lay_8605 = cute.get_layout(%view_8603) : !memref_rmem_bf16_6
        %3395 = cute.get_shape(%lay_8605) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8606, %e1_8607, %e2_8608 = cute.get_leaves(%3395) : !cute.shape<"((8,1),2)">
        %iter_8609 = cute.get_iter(%view_8603) : !memref_rmem_bf16_6
        %view_8610 = cute.make_view(%iter_8609) : !memref_rmem_bf16_7
        %iter_8611 = cute.get_iter(%view_8610) : !memref_rmem_bf16_7
        %iter_8612 = cute.get_iter(%view_8610) : !memref_rmem_bf16_7
        %lay_8613 = cute.get_layout(%view_8596) : !memref_smem_bf16_15
        %3396 = cute.get_shape(%lay_8613) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8614, %e1_8615, %e2_8616 = cute.get_leaves(%3396) : !cute.shape<"((8,1),(2))">
        %lay_8617 = cute.get_layout(%view_8610) : !memref_rmem_bf16_7
        %3397 = cute.get_shape(%lay_8617) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8618, %e1_8619, %e2_8620 = cute.get_leaves(%3397) : !cute.shape<"((8,1),(2))">
        %lay_8621 = cute.get_layout(%view_8596) : !memref_smem_bf16_15
        %sz_8622 = cute.size(%lay_8621) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8623 = cute.get_leaves(%sz_8622) : !cute.int_tuple<"2">
        %lay_8624 = cute.get_layout(%view_8610) : !memref_rmem_bf16_7
        %sz_8625 = cute.size(%lay_8624) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8626 = cute.get_leaves(%sz_8625) : !cute.int_tuple<"2">
        %3398 = cute.static : !cute.layout<"1:0">
        %iter_8627 = cute.get_iter(%view_8596) : !memref_smem_bf16_15
        %iter_8628 = cute.get_iter(%view_8610) : !memref_rmem_bf16_7
        %lay_8629 = cute.get_layout(%view_8596) : !memref_smem_bf16_15
        %lay_8630 = cute.get_layout(%view_8610) : !memref_rmem_bf16_7
        %append_8631 = cute.append_to_rank<2> (%lay_8629, %3398) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8632 = cute.append_to_rank<2> (%lay_8630, %3398) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8633 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8634 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8635 = cute.size(%lay_8633) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3399 = cute.get_scalars(%sz_8635) : !cute.int_tuple<"2">
        %c0_i32_8636 = arith.constant 0 : i32
        %c1_i32_8637 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8636 to %3399 step %c1_i32_8637  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_8633) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_8627, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_8634) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_8628, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8638 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8639 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_8640 = cute.crd2idx(%coord_8638, %lay_8639) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_8641 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_8642 = cute.add_offset(%iter_8641, %idx_8640) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8643 = cute.make_view(%ptr_8642) : !memref_smem_bf16_17
        %iter_8644 = cute.get_iter(%view_8643) : !memref_smem_bf16_17
        %coord_8645 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8646 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_8647 = cute.crd2idx(%coord_8645, %lay_8646) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_8648 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_8649 = cute.add_offset(%iter_8648, %idx_8647) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8650 = cute.make_view(%ptr_8649) : !memref_rmem_bf16_9
        %iter_8651 = cute.get_iter(%view_8650) : !memref_rmem_bf16_9
        %lay_8652 = cute.get_layout(%view_8643) : !memref_smem_bf16_17
        %3400 = cute.get_shape(%lay_8652) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8653, %e1_8654, %e2_8655 = cute.get_leaves(%3400) : !cute.shape<"((8,1),4)">
        %lay_8656 = cute.get_layout(%view_8650) : !memref_rmem_bf16_9
        %3401 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3401) : !cute.shape<"((8,1),4)">
        %lay_8660 = cute.get_layout(%view_8643) : !memref_smem_bf16_17
        %shape_8661 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8662 = cute.make_layout() : !cute.layout<"1:0">
        %append_8663 = cute.append_to_rank<2> (%lay_8660, %lay_8662) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8664 = cute.make_view(%iter_8644, %append_8663) : !memref_smem_bf16_17
        %iter_8665 = cute.get_iter(%view_8664) : !memref_smem_bf16_17
        %lay_8666 = cute.get_layout(%view_8664) : !memref_smem_bf16_17
        %3402 = cute.get_shape(%lay_8666) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8667, %e1_8668, %e2_8669 = cute.get_leaves(%3402) : !cute.shape<"((8,1),4)">
        %iter_8670 = cute.get_iter(%view_8664) : !memref_smem_bf16_17
        %view_8671 = cute.make_view(%iter_8670) : !memref_smem_bf16_18
        %iter_8672 = cute.get_iter(%view_8671) : !memref_smem_bf16_18
        %iter_8673 = cute.get_iter(%view_8671) : !memref_smem_bf16_18
        %lay_8674 = cute.get_layout(%view_8650) : !memref_rmem_bf16_9
        %shape_8675 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8676 = cute.make_layout() : !cute.layout<"1:0">
        %append_8677 = cute.append_to_rank<2> (%lay_8674, %lay_8676) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8678 = cute.make_view(%iter_8651, %append_8677) : !memref_rmem_bf16_9
        %iter_8679 = cute.get_iter(%view_8678) : !memref_rmem_bf16_9
        %lay_8680 = cute.get_layout(%view_8678) : !memref_rmem_bf16_9
        %3403 = cute.get_shape(%lay_8680) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8681, %e1_8682, %e2_8683 = cute.get_leaves(%3403) : !cute.shape<"((8,1),4)">
        %iter_8684 = cute.get_iter(%view_8678) : !memref_rmem_bf16_9
        %view_8685 = cute.make_view(%iter_8684) : !memref_rmem_bf16_10
        %iter_8686 = cute.get_iter(%view_8685) : !memref_rmem_bf16_10
        %iter_8687 = cute.get_iter(%view_8685) : !memref_rmem_bf16_10
        %lay_8688 = cute.get_layout(%view_8671) : !memref_smem_bf16_18
        %3404 = cute.get_shape(%lay_8688) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8689, %e1_8690, %e2_8691 = cute.get_leaves(%3404) : !cute.shape<"((8,1),(4))">
        %lay_8692 = cute.get_layout(%view_8685) : !memref_rmem_bf16_10
        %3405 = cute.get_shape(%lay_8692) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8693, %e1_8694, %e2_8695 = cute.get_leaves(%3405) : !cute.shape<"((8,1),(4))">
        %lay_8696 = cute.get_layout(%view_8671) : !memref_smem_bf16_18
        %sz_8697 = cute.size(%lay_8696) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8698 = cute.get_leaves(%sz_8697) : !cute.int_tuple<"4">
        %lay_8699 = cute.get_layout(%view_8685) : !memref_rmem_bf16_10
        %sz_8700 = cute.size(%lay_8699) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8701 = cute.get_leaves(%sz_8700) : !cute.int_tuple<"4">
        %3406 = cute.static : !cute.layout<"1:0">
        %iter_8702 = cute.get_iter(%view_8671) : !memref_smem_bf16_18
        %iter_8703 = cute.get_iter(%view_8685) : !memref_rmem_bf16_10
        %lay_8704 = cute.get_layout(%view_8671) : !memref_smem_bf16_18
        %lay_8705 = cute.get_layout(%view_8685) : !memref_rmem_bf16_10
        %append_8706 = cute.append_to_rank<2> (%lay_8704, %3406) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8707 = cute.append_to_rank<2> (%lay_8705, %3406) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8708 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8709 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8710 = cute.size(%lay_8708) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3407 = cute.get_scalars(%sz_8710) : !cute.int_tuple<"4">
        %c0_i32_8711 = arith.constant 0 : i32
        %c1_i32_8712 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8711 to %3407 step %c1_i32_8712  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_8708) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_8702, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_8709) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_8703, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_8713 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %3408 = cute.get_shape(%lay_8713) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
        %e0_8714, %e1_8715, %e2_8716, %e3_8717, %e4_8718, %e5_8719 = cute.get_leaves(%3408) : !cute.shape<"((8,1),2,((2,2),2))">
        %int_tuple_8720 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8721 = cute.size(%int_tuple_8720) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8722 = cute.get_leaves(%sz_8721) : !cute.int_tuple<"8">
        %int_tuple_8723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8724 = cute.size(%int_tuple_8723) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8725 = cute.get_leaves(%sz_8724) : !cute.int_tuple<"8">
        %coord_8726 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8727 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_8728 = cute.crd2idx(%coord_8726, %lay_8727) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8729 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_8730 = cute.add_offset(%iter_8729, %idx_8728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8731 = cute.make_view(%ptr_8730) : !memref_smem_bf16_14
        %iter_8732 = cute.get_iter(%view_8731) : !memref_smem_bf16_14
        %coord_8733 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8734 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_8735 = cute.crd2idx(%coord_8733, %lay_8734) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
        %iter_8736 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_8737 = cute.add_offset(%iter_8736, %idx_8735) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8738 = cute.make_view(%ptr_8737) : !memref_rmem_bf16_6
        %iter_8739 = cute.get_iter(%view_8738) : !memref_rmem_bf16_6
        %lay_8740 = cute.get_layout(%view_8731) : !memref_smem_bf16_14
        %3409 = cute.get_shape(%lay_8740) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8741, %e1_8742, %e2_8743 = cute.get_leaves(%3409) : !cute.shape<"((8,1),2)">
        %lay_8744 = cute.get_layout(%view_8738) : !memref_rmem_bf16_6
        %3410 = cute.get_shape(%lay_8744) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8745, %e1_8746, %e2_8747 = cute.get_leaves(%3410) : !cute.shape<"((8,1),2)">
        %lay_8748 = cute.get_layout(%view_8731) : !memref_smem_bf16_14
        %shape_8749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8750 = cute.make_layout() : !cute.layout<"1:0">
        %append_8751 = cute.append_to_rank<2> (%lay_8748, %lay_8750) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8752 = cute.make_view(%iter_8732, %append_8751) : !memref_smem_bf16_14
        %iter_8753 = cute.get_iter(%view_8752) : !memref_smem_bf16_14
        %lay_8754 = cute.get_layout(%view_8752) : !memref_smem_bf16_14
        %3411 = cute.get_shape(%lay_8754) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8755, %e1_8756, %e2_8757 = cute.get_leaves(%3411) : !cute.shape<"((8,1),2)">
        %iter_8758 = cute.get_iter(%view_8752) : !memref_smem_bf16_14
        %view_8759 = cute.make_view(%iter_8758) : !memref_smem_bf16_15
        %iter_8760 = cute.get_iter(%view_8759) : !memref_smem_bf16_15
        %iter_8761 = cute.get_iter(%view_8759) : !memref_smem_bf16_15
        %lay_8762 = cute.get_layout(%view_8738) : !memref_rmem_bf16_6
        %shape_8763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8764 = cute.make_layout() : !cute.layout<"1:0">
        %append_8765 = cute.append_to_rank<2> (%lay_8762, %lay_8764) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8766 = cute.make_view(%iter_8739, %append_8765) : !memref_rmem_bf16_6
        %iter_8767 = cute.get_iter(%view_8766) : !memref_rmem_bf16_6
        %lay_8768 = cute.get_layout(%view_8766) : !memref_rmem_bf16_6
        %3412 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%3412) : !cute.shape<"((8,1),2)">
        %iter_8772 = cute.get_iter(%view_8766) : !memref_rmem_bf16_6
        %view_8773 = cute.make_view(%iter_8772) : !memref_rmem_bf16_7
        %iter_8774 = cute.get_iter(%view_8773) : !memref_rmem_bf16_7
        %iter_8775 = cute.get_iter(%view_8773) : !memref_rmem_bf16_7
        %lay_8776 = cute.get_layout(%view_8759) : !memref_smem_bf16_15
        %3413 = cute.get_shape(%lay_8776) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8777, %e1_8778, %e2_8779 = cute.get_leaves(%3413) : !cute.shape<"((8,1),(2))">
        %lay_8780 = cute.get_layout(%view_8773) : !memref_rmem_bf16_7
        %3414 = cute.get_shape(%lay_8780) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8781, %e1_8782, %e2_8783 = cute.get_leaves(%3414) : !cute.shape<"((8,1),(2))">
        %lay_8784 = cute.get_layout(%view_8759) : !memref_smem_bf16_15
        %sz_8785 = cute.size(%lay_8784) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8786 = cute.get_leaves(%sz_8785) : !cute.int_tuple<"2">
        %lay_8787 = cute.get_layout(%view_8773) : !memref_rmem_bf16_7
        %sz_8788 = cute.size(%lay_8787) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8789 = cute.get_leaves(%sz_8788) : !cute.int_tuple<"2">
        %3415 = cute.static : !cute.layout<"1:0">
        %iter_8790 = cute.get_iter(%view_8759) : !memref_smem_bf16_15
        %iter_8791 = cute.get_iter(%view_8773) : !memref_rmem_bf16_7
        %lay_8792 = cute.get_layout(%view_8759) : !memref_smem_bf16_15
        %lay_8793 = cute.get_layout(%view_8773) : !memref_rmem_bf16_7
        %append_8794 = cute.append_to_rank<2> (%lay_8792, %3415) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8795 = cute.append_to_rank<2> (%lay_8793, %3415) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8797 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8798 = cute.size(%lay_8796) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3416 = cute.get_scalars(%sz_8798) : !cute.int_tuple<"2">
        %c0_i32_8799 = arith.constant 0 : i32
        %c1_i32_8800 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8799 to %3416 step %c1_i32_8800  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_8796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_8790, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_8797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_8791, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8801 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8802 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_8803 = cute.crd2idx(%coord_8801, %lay_8802) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8804 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_8805 = cute.add_offset(%iter_8804, %idx_8803) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8806 = cute.make_view(%ptr_8805) : !memref_smem_bf16_17
        %iter_8807 = cute.get_iter(%view_8806) : !memref_smem_bf16_17
        %coord_8808 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8809 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_8810 = cute.crd2idx(%coord_8808, %lay_8809) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
        %iter_8811 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_8812 = cute.add_offset(%iter_8811, %idx_8810) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8813 = cute.make_view(%ptr_8812) : !memref_rmem_bf16_9
        %iter_8814 = cute.get_iter(%view_8813) : !memref_rmem_bf16_9
        %lay_8815 = cute.get_layout(%view_8806) : !memref_smem_bf16_17
        %3417 = cute.get_shape(%lay_8815) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8816, %e1_8817, %e2_8818 = cute.get_leaves(%3417) : !cute.shape<"((8,1),4)">
        %lay_8819 = cute.get_layout(%view_8813) : !memref_rmem_bf16_9
        %3418 = cute.get_shape(%lay_8819) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8820, %e1_8821, %e2_8822 = cute.get_leaves(%3418) : !cute.shape<"((8,1),4)">
        %lay_8823 = cute.get_layout(%view_8806) : !memref_smem_bf16_17
        %shape_8824 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8825 = cute.make_layout() : !cute.layout<"1:0">
        %append_8826 = cute.append_to_rank<2> (%lay_8823, %lay_8825) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8827 = cute.make_view(%iter_8807, %append_8826) : !memref_smem_bf16_17
        %iter_8828 = cute.get_iter(%view_8827) : !memref_smem_bf16_17
        %lay_8829 = cute.get_layout(%view_8827) : !memref_smem_bf16_17
        %3419 = cute.get_shape(%lay_8829) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8830, %e1_8831, %e2_8832 = cute.get_leaves(%3419) : !cute.shape<"((8,1),4)">
        %iter_8833 = cute.get_iter(%view_8827) : !memref_smem_bf16_17
        %view_8834 = cute.make_view(%iter_8833) : !memref_smem_bf16_18
        %iter_8835 = cute.get_iter(%view_8834) : !memref_smem_bf16_18
        %iter_8836 = cute.get_iter(%view_8834) : !memref_smem_bf16_18
        %lay_8837 = cute.get_layout(%view_8813) : !memref_rmem_bf16_9
        %shape_8838 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8839 = cute.make_layout() : !cute.layout<"1:0">
        %append_8840 = cute.append_to_rank<2> (%lay_8837, %lay_8839) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8841 = cute.make_view(%iter_8814, %append_8840) : !memref_rmem_bf16_9
        %iter_8842 = cute.get_iter(%view_8841) : !memref_rmem_bf16_9
        %lay_8843 = cute.get_layout(%view_8841) : !memref_rmem_bf16_9
        %3420 = cute.get_shape(%lay_8843) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8844, %e1_8845, %e2_8846 = cute.get_leaves(%3420) : !cute.shape<"((8,1),4)">
        %iter_8847 = cute.get_iter(%view_8841) : !memref_rmem_bf16_9
        %view_8848 = cute.make_view(%iter_8847) : !memref_rmem_bf16_10
        %iter_8849 = cute.get_iter(%view_8848) : !memref_rmem_bf16_10
        %iter_8850 = cute.get_iter(%view_8848) : !memref_rmem_bf16_10
        %lay_8851 = cute.get_layout(%view_8834) : !memref_smem_bf16_18
        %3421 = cute.get_shape(%lay_8851) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8852, %e1_8853, %e2_8854 = cute.get_leaves(%3421) : !cute.shape<"((8,1),(4))">
        %lay_8855 = cute.get_layout(%view_8848) : !memref_rmem_bf16_10
        %3422 = cute.get_shape(%lay_8855) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8856, %e1_8857, %e2_8858 = cute.get_leaves(%3422) : !cute.shape<"((8,1),(4))">
        %lay_8859 = cute.get_layout(%view_8834) : !memref_smem_bf16_18
        %sz_8860 = cute.size(%lay_8859) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8861 = cute.get_leaves(%sz_8860) : !cute.int_tuple<"4">
        %lay_8862 = cute.get_layout(%view_8848) : !memref_rmem_bf16_10
        %sz_8863 = cute.size(%lay_8862) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8864 = cute.get_leaves(%sz_8863) : !cute.int_tuple<"4">
        %3423 = cute.static : !cute.layout<"1:0">
        %iter_8865 = cute.get_iter(%view_8834) : !memref_smem_bf16_18
        %iter_8866 = cute.get_iter(%view_8848) : !memref_rmem_bf16_10
        %lay_8867 = cute.get_layout(%view_8834) : !memref_smem_bf16_18
        %lay_8868 = cute.get_layout(%view_8848) : !memref_rmem_bf16_10
        %append_8869 = cute.append_to_rank<2> (%lay_8867, %3423) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8870 = cute.append_to_rank<2> (%lay_8868, %3423) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8871 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8872 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8873 = cute.size(%lay_8871) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3424 = cute.get_scalars(%sz_8873) : !cute.int_tuple<"4">
        %c0_i32_8874 = arith.constant 0 : i32
        %c1_i32_8875 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8874 to %3424 step %c1_i32_8875  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_8871) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_8865, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_8872) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_8866, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8876 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8877 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_8878 = cute.crd2idx(%coord_8876, %lay_8877) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
        %iter_8879 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_8880 = cute.add_offset(%iter_8879, %idx_8878) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8881 = cute.make_view(%ptr_8880) : !memref_rmem_bf16_12
        %iter_8882 = cute.get_iter(%view_8881) : !memref_rmem_bf16_12
        %coord_8883 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8884 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_8885 = cute.crd2idx(%coord_8883, %lay_8884) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
        %iter_8886 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_8887 = cute.add_offset(%iter_8886, %idx_8885) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8888 = cute.make_view(%ptr_8887) : !memref_rmem_bf16_13
        %iter_8889 = cute.get_iter(%view_8888) : !memref_rmem_bf16_13
        %lay_8890 = cute.get_layout(%view_8881) : !memref_rmem_bf16_12
        %3425 = cute.get_shape(%lay_8890) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8891, %e1_8892, %e2_8893, %e3_8894 = cute.get_leaves(%3425) : !cute.shape<"((2,2,2),2)">
        %lay_8895 = cute.get_layout(%view_8888) : !memref_rmem_bf16_13
        %3426 = cute.get_shape(%lay_8895) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8896, %e1_8897, %e2_8898 = cute.get_leaves(%3426) : !cute.shape<"((2,2),8)">
        %iter_8899 = cute.get_iter(%view_8881) : !memref_rmem_bf16_12
        %iter_8900 = cute.get_iter(%view_8888) : !memref_rmem_bf16_13
        %iter_8901 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_8902 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_8903 = cute.get_layout(%view_8881) : !memref_rmem_bf16_12
        %lay_8904 = cute.get_layout(%view_8888) : !memref_rmem_bf16_13
        %lay_8905 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_8906 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3427 = cute.static : !cute.layout<"1:0">
        %append_8907 = cute.append_to_rank<3> (%lay_8903, %3427) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8908 = cute.append_to_rank<3> (%lay_8904, %3427) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8909 = cute.size(%append_8907) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8910 = cute.size(%append_8907) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8911 = cute.size(%append_8908) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3428 = cute.get_scalars(%sz_8909) : !cute.int_tuple<"1">
        %3429 = cute.get_scalars(%sz_8910) : !cute.int_tuple<"2">
        %3430 = cute.get_scalars(%sz_8911) : !cute.int_tuple<"8">
        %c0_i32_8912 = arith.constant 0 : i32
        %c1_i32_8913 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8912 to %3428 step %c1_i32_8913  : i32 {
          scf.for %arg14 = %c0_i32_8912 to %3429 step %c1_i32_8913  : i32 {
            scf.for %arg15 = %c0_i32_8912 to %3430 step %c1_i32_8913  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_8907) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_8899, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_8908) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_8900, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_8905) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_8901, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_8906) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_8902, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8914 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8915 = cute.size(%int_tuple_8914) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8916 = cute.get_leaves(%sz_8915) : !cute.int_tuple<"8">
        %coord_8917 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8918 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_8919 = cute.crd2idx(%coord_8917, %lay_8918) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8920 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_8921 = cute.add_offset(%iter_8920, %idx_8919) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8922 = cute.make_view(%ptr_8921) : !memref_smem_bf16_14
        %iter_8923 = cute.get_iter(%view_8922) : !memref_smem_bf16_14
        %coord_8924 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8925 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_8926 = cute.crd2idx(%coord_8924, %lay_8925) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
        %iter_8927 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_8928 = cute.add_offset(%iter_8927, %idx_8926) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8929 = cute.make_view(%ptr_8928) : !memref_rmem_bf16_6
        %iter_8930 = cute.get_iter(%view_8929) : !memref_rmem_bf16_6
        %lay_8931 = cute.get_layout(%view_8922) : !memref_smem_bf16_14
        %3431 = cute.get_shape(%lay_8931) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8932, %e1_8933, %e2_8934 = cute.get_leaves(%3431) : !cute.shape<"((8,1),2)">
        %lay_8935 = cute.get_layout(%view_8929) : !memref_rmem_bf16_6
        %3432 = cute.get_shape(%lay_8935) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8936, %e1_8937, %e2_8938 = cute.get_leaves(%3432) : !cute.shape<"((8,1),2)">
        %lay_8939 = cute.get_layout(%view_8922) : !memref_smem_bf16_14
        %shape_8940 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8941 = cute.make_layout() : !cute.layout<"1:0">
        %append_8942 = cute.append_to_rank<2> (%lay_8939, %lay_8941) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8943 = cute.make_view(%iter_8923, %append_8942) : !memref_smem_bf16_14
        %iter_8944 = cute.get_iter(%view_8943) : !memref_smem_bf16_14
        %lay_8945 = cute.get_layout(%view_8943) : !memref_smem_bf16_14
        %3433 = cute.get_shape(%lay_8945) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8946, %e1_8947, %e2_8948 = cute.get_leaves(%3433) : !cute.shape<"((8,1),2)">
        %iter_8949 = cute.get_iter(%view_8943) : !memref_smem_bf16_14
        %view_8950 = cute.make_view(%iter_8949) : !memref_smem_bf16_15
        %iter_8951 = cute.get_iter(%view_8950) : !memref_smem_bf16_15
        %iter_8952 = cute.get_iter(%view_8950) : !memref_smem_bf16_15
        %lay_8953 = cute.get_layout(%view_8929) : !memref_rmem_bf16_6
        %shape_8954 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8955 = cute.make_layout() : !cute.layout<"1:0">
        %append_8956 = cute.append_to_rank<2> (%lay_8953, %lay_8955) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8957 = cute.make_view(%iter_8930, %append_8956) : !memref_rmem_bf16_6
        %iter_8958 = cute.get_iter(%view_8957) : !memref_rmem_bf16_6
        %lay_8959 = cute.get_layout(%view_8957) : !memref_rmem_bf16_6
        %3434 = cute.get_shape(%lay_8959) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8960, %e1_8961, %e2_8962 = cute.get_leaves(%3434) : !cute.shape<"((8,1),2)">
        %iter_8963 = cute.get_iter(%view_8957) : !memref_rmem_bf16_6
        %view_8964 = cute.make_view(%iter_8963) : !memref_rmem_bf16_7
        %iter_8965 = cute.get_iter(%view_8964) : !memref_rmem_bf16_7
        %iter_8966 = cute.get_iter(%view_8964) : !memref_rmem_bf16_7
        %lay_8967 = cute.get_layout(%view_8950) : !memref_smem_bf16_15
        %3435 = cute.get_shape(%lay_8967) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8968, %e1_8969, %e2_8970 = cute.get_leaves(%3435) : !cute.shape<"((8,1),(2))">
        %lay_8971 = cute.get_layout(%view_8964) : !memref_rmem_bf16_7
        %3436 = cute.get_shape(%lay_8971) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8972, %e1_8973, %e2_8974 = cute.get_leaves(%3436) : !cute.shape<"((8,1),(2))">
        %lay_8975 = cute.get_layout(%view_8950) : !memref_smem_bf16_15
        %sz_8976 = cute.size(%lay_8975) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8977 = cute.get_leaves(%sz_8976) : !cute.int_tuple<"2">
        %lay_8978 = cute.get_layout(%view_8964) : !memref_rmem_bf16_7
        %sz_8979 = cute.size(%lay_8978) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8980 = cute.get_leaves(%sz_8979) : !cute.int_tuple<"2">
        %3437 = cute.static : !cute.layout<"1:0">
        %iter_8981 = cute.get_iter(%view_8950) : !memref_smem_bf16_15
        %iter_8982 = cute.get_iter(%view_8964) : !memref_rmem_bf16_7
        %lay_8983 = cute.get_layout(%view_8950) : !memref_smem_bf16_15
        %lay_8984 = cute.get_layout(%view_8964) : !memref_rmem_bf16_7
        %append_8985 = cute.append_to_rank<2> (%lay_8983, %3437) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8986 = cute.append_to_rank<2> (%lay_8984, %3437) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8987 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8988 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8989 = cute.size(%lay_8987) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3438 = cute.get_scalars(%sz_8989) : !cute.int_tuple<"2">
        %c0_i32_8990 = arith.constant 0 : i32
        %c1_i32_8991 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8990 to %3438 step %c1_i32_8991  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_8987) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_8981, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_8988) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_8982, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8992 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8993 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_8994 = cute.crd2idx(%coord_8992, %lay_8993) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8995 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_8996 = cute.add_offset(%iter_8995, %idx_8994) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8997 = cute.make_view(%ptr_8996) : !memref_smem_bf16_17
        %iter_8998 = cute.get_iter(%view_8997) : !memref_smem_bf16_17
        %coord_8999 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9000 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9001 = cute.crd2idx(%coord_8999, %lay_9000) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
        %iter_9002 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9003 = cute.add_offset(%iter_9002, %idx_9001) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9004 = cute.make_view(%ptr_9003) : !memref_rmem_bf16_9
        %iter_9005 = cute.get_iter(%view_9004) : !memref_rmem_bf16_9
        %lay_9006 = cute.get_layout(%view_8997) : !memref_smem_bf16_17
        %3439 = cute.get_shape(%lay_9006) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9007, %e1_9008, %e2_9009 = cute.get_leaves(%3439) : !cute.shape<"((8,1),4)">
        %lay_9010 = cute.get_layout(%view_9004) : !memref_rmem_bf16_9
        %3440 = cute.get_shape(%lay_9010) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9011, %e1_9012, %e2_9013 = cute.get_leaves(%3440) : !cute.shape<"((8,1),4)">
        %lay_9014 = cute.get_layout(%view_8997) : !memref_smem_bf16_17
        %shape_9015 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9016 = cute.make_layout() : !cute.layout<"1:0">
        %append_9017 = cute.append_to_rank<2> (%lay_9014, %lay_9016) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9018 = cute.make_view(%iter_8998, %append_9017) : !memref_smem_bf16_17
        %iter_9019 = cute.get_iter(%view_9018) : !memref_smem_bf16_17
        %lay_9020 = cute.get_layout(%view_9018) : !memref_smem_bf16_17
        %3441 = cute.get_shape(%lay_9020) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9021, %e1_9022, %e2_9023 = cute.get_leaves(%3441) : !cute.shape<"((8,1),4)">
        %iter_9024 = cute.get_iter(%view_9018) : !memref_smem_bf16_17
        %view_9025 = cute.make_view(%iter_9024) : !memref_smem_bf16_18
        %iter_9026 = cute.get_iter(%view_9025) : !memref_smem_bf16_18
        %iter_9027 = cute.get_iter(%view_9025) : !memref_smem_bf16_18
        %lay_9028 = cute.get_layout(%view_9004) : !memref_rmem_bf16_9
        %shape_9029 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9030 = cute.make_layout() : !cute.layout<"1:0">
        %append_9031 = cute.append_to_rank<2> (%lay_9028, %lay_9030) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9032 = cute.make_view(%iter_9005, %append_9031) : !memref_rmem_bf16_9
        %iter_9033 = cute.get_iter(%view_9032) : !memref_rmem_bf16_9
        %lay_9034 = cute.get_layout(%view_9032) : !memref_rmem_bf16_9
        %3442 = cute.get_shape(%lay_9034) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9035, %e1_9036, %e2_9037 = cute.get_leaves(%3442) : !cute.shape<"((8,1),4)">
        %iter_9038 = cute.get_iter(%view_9032) : !memref_rmem_bf16_9
        %view_9039 = cute.make_view(%iter_9038) : !memref_rmem_bf16_10
        %iter_9040 = cute.get_iter(%view_9039) : !memref_rmem_bf16_10
        %iter_9041 = cute.get_iter(%view_9039) : !memref_rmem_bf16_10
        %lay_9042 = cute.get_layout(%view_9025) : !memref_smem_bf16_18
        %3443 = cute.get_shape(%lay_9042) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9043, %e1_9044, %e2_9045 = cute.get_leaves(%3443) : !cute.shape<"((8,1),(4))">
        %lay_9046 = cute.get_layout(%view_9039) : !memref_rmem_bf16_10
        %3444 = cute.get_shape(%lay_9046) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9047, %e1_9048, %e2_9049 = cute.get_leaves(%3444) : !cute.shape<"((8,1),(4))">
        %lay_9050 = cute.get_layout(%view_9025) : !memref_smem_bf16_18
        %sz_9051 = cute.size(%lay_9050) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9052 = cute.get_leaves(%sz_9051) : !cute.int_tuple<"4">
        %lay_9053 = cute.get_layout(%view_9039) : !memref_rmem_bf16_10
        %sz_9054 = cute.size(%lay_9053) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9055 = cute.get_leaves(%sz_9054) : !cute.int_tuple<"4">
        %3445 = cute.static : !cute.layout<"1:0">
        %iter_9056 = cute.get_iter(%view_9025) : !memref_smem_bf16_18
        %iter_9057 = cute.get_iter(%view_9039) : !memref_rmem_bf16_10
        %lay_9058 = cute.get_layout(%view_9025) : !memref_smem_bf16_18
        %lay_9059 = cute.get_layout(%view_9039) : !memref_rmem_bf16_10
        %append_9060 = cute.append_to_rank<2> (%lay_9058, %3445) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9061 = cute.append_to_rank<2> (%lay_9059, %3445) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9062 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9063 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9064 = cute.size(%lay_9062) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3446 = cute.get_scalars(%sz_9064) : !cute.int_tuple<"4">
        %c0_i32_9065 = arith.constant 0 : i32
        %c1_i32_9066 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9065 to %3446 step %c1_i32_9066  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9062) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_9056, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9063) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9057, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9067 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_9068 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9069 = cute.crd2idx(%coord_9067, %lay_9068) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
        %iter_9070 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9071 = cute.add_offset(%iter_9070, %idx_9069) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9072 = cute.make_view(%ptr_9071) : !memref_rmem_bf16_12
        %iter_9073 = cute.get_iter(%view_9072) : !memref_rmem_bf16_12
        %coord_9074 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_9075 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_9076 = cute.crd2idx(%coord_9074, %lay_9075) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
        %iter_9077 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_9078 = cute.add_offset(%iter_9077, %idx_9076) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9079 = cute.make_view(%ptr_9078) : !memref_rmem_bf16_13
        %iter_9080 = cute.get_iter(%view_9079) : !memref_rmem_bf16_13
        %lay_9081 = cute.get_layout(%view_9072) : !memref_rmem_bf16_12
        %3447 = cute.get_shape(%lay_9081) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9082, %e1_9083, %e2_9084, %e3_9085 = cute.get_leaves(%3447) : !cute.shape<"((2,2,2),2)">
        %lay_9086 = cute.get_layout(%view_9079) : !memref_rmem_bf16_13
        %3448 = cute.get_shape(%lay_9086) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9087, %e1_9088, %e2_9089 = cute.get_leaves(%3448) : !cute.shape<"((2,2),8)">
        %iter_9090 = cute.get_iter(%view_9072) : !memref_rmem_bf16_12
        %iter_9091 = cute.get_iter(%view_9079) : !memref_rmem_bf16_13
        %iter_9092 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_9093 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_9094 = cute.get_layout(%view_9072) : !memref_rmem_bf16_12
        %lay_9095 = cute.get_layout(%view_9079) : !memref_rmem_bf16_13
        %lay_9096 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_9097 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3449 = cute.static : !cute.layout<"1:0">
        %append_9098 = cute.append_to_rank<3> (%lay_9094, %3449) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9099 = cute.append_to_rank<3> (%lay_9095, %3449) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9100 = cute.size(%append_9098) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9101 = cute.size(%append_9098) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9102 = cute.size(%append_9099) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3450 = cute.get_scalars(%sz_9100) : !cute.int_tuple<"1">
        %3451 = cute.get_scalars(%sz_9101) : !cute.int_tuple<"2">
        %3452 = cute.get_scalars(%sz_9102) : !cute.int_tuple<"8">
        %c0_i32_9103 = arith.constant 0 : i32
        %c1_i32_9104 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9103 to %3450 step %c1_i32_9104  : i32 {
          scf.for %arg14 = %c0_i32_9103 to %3451 step %c1_i32_9104  : i32 {
            scf.for %arg15 = %c0_i32_9103 to %3452 step %c1_i32_9104  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_9098) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_9090, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_9099) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_9091, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_9096) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_9092, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_9097) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_9093, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9106 = cute.size(%int_tuple_9105) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9107 = cute.get_leaves(%sz_9106) : !cute.int_tuple<"8">
        %coord_9108 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9109 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_9110 = cute.crd2idx(%coord_9108, %lay_9109) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9111 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_9112 = cute.add_offset(%iter_9111, %idx_9110) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9113 = cute.make_view(%ptr_9112) : !memref_smem_bf16_14
        %iter_9114 = cute.get_iter(%view_9113) : !memref_smem_bf16_14
        %coord_9115 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9116 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_9117 = cute.crd2idx(%coord_9115, %lay_9116) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
        %iter_9118 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_9119 = cute.add_offset(%iter_9118, %idx_9117) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9120 = cute.make_view(%ptr_9119) : !memref_rmem_bf16_6
        %iter_9121 = cute.get_iter(%view_9120) : !memref_rmem_bf16_6
        %lay_9122 = cute.get_layout(%view_9113) : !memref_smem_bf16_14
        %3453 = cute.get_shape(%lay_9122) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9123, %e1_9124, %e2_9125 = cute.get_leaves(%3453) : !cute.shape<"((8,1),2)">
        %lay_9126 = cute.get_layout(%view_9120) : !memref_rmem_bf16_6
        %3454 = cute.get_shape(%lay_9126) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9127, %e1_9128, %e2_9129 = cute.get_leaves(%3454) : !cute.shape<"((8,1),2)">
        %lay_9130 = cute.get_layout(%view_9113) : !memref_smem_bf16_14
        %shape_9131 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9132 = cute.make_layout() : !cute.layout<"1:0">
        %append_9133 = cute.append_to_rank<2> (%lay_9130, %lay_9132) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9134 = cute.make_view(%iter_9114, %append_9133) : !memref_smem_bf16_14
        %iter_9135 = cute.get_iter(%view_9134) : !memref_smem_bf16_14
        %lay_9136 = cute.get_layout(%view_9134) : !memref_smem_bf16_14
        %3455 = cute.get_shape(%lay_9136) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9137, %e1_9138, %e2_9139 = cute.get_leaves(%3455) : !cute.shape<"((8,1),2)">
        %iter_9140 = cute.get_iter(%view_9134) : !memref_smem_bf16_14
        %view_9141 = cute.make_view(%iter_9140) : !memref_smem_bf16_15
        %iter_9142 = cute.get_iter(%view_9141) : !memref_smem_bf16_15
        %iter_9143 = cute.get_iter(%view_9141) : !memref_smem_bf16_15
        %lay_9144 = cute.get_layout(%view_9120) : !memref_rmem_bf16_6
        %shape_9145 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9146 = cute.make_layout() : !cute.layout<"1:0">
        %append_9147 = cute.append_to_rank<2> (%lay_9144, %lay_9146) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9148 = cute.make_view(%iter_9121, %append_9147) : !memref_rmem_bf16_6
        %iter_9149 = cute.get_iter(%view_9148) : !memref_rmem_bf16_6
        %lay_9150 = cute.get_layout(%view_9148) : !memref_rmem_bf16_6
        %3456 = cute.get_shape(%lay_9150) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9151, %e1_9152, %e2_9153 = cute.get_leaves(%3456) : !cute.shape<"((8,1),2)">
        %iter_9154 = cute.get_iter(%view_9148) : !memref_rmem_bf16_6
        %view_9155 = cute.make_view(%iter_9154) : !memref_rmem_bf16_7
        %iter_9156 = cute.get_iter(%view_9155) : !memref_rmem_bf16_7
        %iter_9157 = cute.get_iter(%view_9155) : !memref_rmem_bf16_7
        %lay_9158 = cute.get_layout(%view_9141) : !memref_smem_bf16_15
        %3457 = cute.get_shape(%lay_9158) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9159, %e1_9160, %e2_9161 = cute.get_leaves(%3457) : !cute.shape<"((8,1),(2))">
        %lay_9162 = cute.get_layout(%view_9155) : !memref_rmem_bf16_7
        %3458 = cute.get_shape(%lay_9162) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9163, %e1_9164, %e2_9165 = cute.get_leaves(%3458) : !cute.shape<"((8,1),(2))">
        %lay_9166 = cute.get_layout(%view_9141) : !memref_smem_bf16_15
        %sz_9167 = cute.size(%lay_9166) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9168 = cute.get_leaves(%sz_9167) : !cute.int_tuple<"2">
        %lay_9169 = cute.get_layout(%view_9155) : !memref_rmem_bf16_7
        %sz_9170 = cute.size(%lay_9169) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9171 = cute.get_leaves(%sz_9170) : !cute.int_tuple<"2">
        %3459 = cute.static : !cute.layout<"1:0">
        %iter_9172 = cute.get_iter(%view_9141) : !memref_smem_bf16_15
        %iter_9173 = cute.get_iter(%view_9155) : !memref_rmem_bf16_7
        %lay_9174 = cute.get_layout(%view_9141) : !memref_smem_bf16_15
        %lay_9175 = cute.get_layout(%view_9155) : !memref_rmem_bf16_7
        %append_9176 = cute.append_to_rank<2> (%lay_9174, %3459) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9177 = cute.append_to_rank<2> (%lay_9175, %3459) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9178 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9179 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9180 = cute.size(%lay_9178) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3460 = cute.get_scalars(%sz_9180) : !cute.int_tuple<"2">
        %c0_i32_9181 = arith.constant 0 : i32
        %c1_i32_9182 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9181 to %3460 step %c1_i32_9182  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9178) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_9172, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9179) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9173, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9183 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9184 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_9185 = cute.crd2idx(%coord_9183, %lay_9184) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9186 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_9187 = cute.add_offset(%iter_9186, %idx_9185) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9188 = cute.make_view(%ptr_9187) : !memref_smem_bf16_17
        %iter_9189 = cute.get_iter(%view_9188) : !memref_smem_bf16_17
        %coord_9190 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9191 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9192 = cute.crd2idx(%coord_9190, %lay_9191) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
        %iter_9193 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9194 = cute.add_offset(%iter_9193, %idx_9192) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9195 = cute.make_view(%ptr_9194) : !memref_rmem_bf16_9
        %iter_9196 = cute.get_iter(%view_9195) : !memref_rmem_bf16_9
        %lay_9197 = cute.get_layout(%view_9188) : !memref_smem_bf16_17
        %3461 = cute.get_shape(%lay_9197) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9198, %e1_9199, %e2_9200 = cute.get_leaves(%3461) : !cute.shape<"((8,1),4)">
        %lay_9201 = cute.get_layout(%view_9195) : !memref_rmem_bf16_9
        %3462 = cute.get_shape(%lay_9201) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9202, %e1_9203, %e2_9204 = cute.get_leaves(%3462) : !cute.shape<"((8,1),4)">
        %lay_9205 = cute.get_layout(%view_9188) : !memref_smem_bf16_17
        %shape_9206 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9207 = cute.make_layout() : !cute.layout<"1:0">
        %append_9208 = cute.append_to_rank<2> (%lay_9205, %lay_9207) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9209 = cute.make_view(%iter_9189, %append_9208) : !memref_smem_bf16_17
        %iter_9210 = cute.get_iter(%view_9209) : !memref_smem_bf16_17
        %lay_9211 = cute.get_layout(%view_9209) : !memref_smem_bf16_17
        %3463 = cute.get_shape(%lay_9211) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9212, %e1_9213, %e2_9214 = cute.get_leaves(%3463) : !cute.shape<"((8,1),4)">
        %iter_9215 = cute.get_iter(%view_9209) : !memref_smem_bf16_17
        %view_9216 = cute.make_view(%iter_9215) : !memref_smem_bf16_18
        %iter_9217 = cute.get_iter(%view_9216) : !memref_smem_bf16_18
        %iter_9218 = cute.get_iter(%view_9216) : !memref_smem_bf16_18
        %lay_9219 = cute.get_layout(%view_9195) : !memref_rmem_bf16_9
        %shape_9220 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9221 = cute.make_layout() : !cute.layout<"1:0">
        %append_9222 = cute.append_to_rank<2> (%lay_9219, %lay_9221) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9223 = cute.make_view(%iter_9196, %append_9222) : !memref_rmem_bf16_9
        %iter_9224 = cute.get_iter(%view_9223) : !memref_rmem_bf16_9
        %lay_9225 = cute.get_layout(%view_9223) : !memref_rmem_bf16_9
        %3464 = cute.get_shape(%lay_9225) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9226, %e1_9227, %e2_9228 = cute.get_leaves(%3464) : !cute.shape<"((8,1),4)">
        %iter_9229 = cute.get_iter(%view_9223) : !memref_rmem_bf16_9
        %view_9230 = cute.make_view(%iter_9229) : !memref_rmem_bf16_10
        %iter_9231 = cute.get_iter(%view_9230) : !memref_rmem_bf16_10
        %iter_9232 = cute.get_iter(%view_9230) : !memref_rmem_bf16_10
        %lay_9233 = cute.get_layout(%view_9216) : !memref_smem_bf16_18
        %3465 = cute.get_shape(%lay_9233) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9234, %e1_9235, %e2_9236 = cute.get_leaves(%3465) : !cute.shape<"((8,1),(4))">
        %lay_9237 = cute.get_layout(%view_9230) : !memref_rmem_bf16_10
        %3466 = cute.get_shape(%lay_9237) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9238, %e1_9239, %e2_9240 = cute.get_leaves(%3466) : !cute.shape<"((8,1),(4))">
        %lay_9241 = cute.get_layout(%view_9216) : !memref_smem_bf16_18
        %sz_9242 = cute.size(%lay_9241) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9243 = cute.get_leaves(%sz_9242) : !cute.int_tuple<"4">
        %lay_9244 = cute.get_layout(%view_9230) : !memref_rmem_bf16_10
        %sz_9245 = cute.size(%lay_9244) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9246 = cute.get_leaves(%sz_9245) : !cute.int_tuple<"4">
        %3467 = cute.static : !cute.layout<"1:0">
        %iter_9247 = cute.get_iter(%view_9216) : !memref_smem_bf16_18
        %iter_9248 = cute.get_iter(%view_9230) : !memref_rmem_bf16_10
        %lay_9249 = cute.get_layout(%view_9216) : !memref_smem_bf16_18
        %lay_9250 = cute.get_layout(%view_9230) : !memref_rmem_bf16_10
        %append_9251 = cute.append_to_rank<2> (%lay_9249, %3467) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9252 = cute.append_to_rank<2> (%lay_9250, %3467) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9253 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9254 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9255 = cute.size(%lay_9253) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3468 = cute.get_scalars(%sz_9255) : !cute.int_tuple<"4">
        %c0_i32_9256 = arith.constant 0 : i32
        %c1_i32_9257 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9256 to %3468 step %c1_i32_9257  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9253) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_9247, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9254) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9248, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9258 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9259 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9260 = cute.crd2idx(%coord_9258, %lay_9259) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
        %iter_9261 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9262 = cute.add_offset(%iter_9261, %idx_9260) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9263 = cute.make_view(%ptr_9262) : !memref_rmem_bf16_12
        %iter_9264 = cute.get_iter(%view_9263) : !memref_rmem_bf16_12
        %coord_9265 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9266 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_9267 = cute.crd2idx(%coord_9265, %lay_9266) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
        %iter_9268 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_9269 = cute.add_offset(%iter_9268, %idx_9267) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9270 = cute.make_view(%ptr_9269) : !memref_rmem_bf16_13
        %iter_9271 = cute.get_iter(%view_9270) : !memref_rmem_bf16_13
        %lay_9272 = cute.get_layout(%view_9263) : !memref_rmem_bf16_12
        %3469 = cute.get_shape(%lay_9272) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9273, %e1_9274, %e2_9275, %e3_9276 = cute.get_leaves(%3469) : !cute.shape<"((2,2,2),2)">
        %lay_9277 = cute.get_layout(%view_9270) : !memref_rmem_bf16_13
        %3470 = cute.get_shape(%lay_9277) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9278, %e1_9279, %e2_9280 = cute.get_leaves(%3470) : !cute.shape<"((2,2),8)">
        %iter_9281 = cute.get_iter(%view_9263) : !memref_rmem_bf16_12
        %iter_9282 = cute.get_iter(%view_9270) : !memref_rmem_bf16_13
        %iter_9283 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_9284 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_9285 = cute.get_layout(%view_9263) : !memref_rmem_bf16_12
        %lay_9286 = cute.get_layout(%view_9270) : !memref_rmem_bf16_13
        %lay_9287 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_9288 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3471 = cute.static : !cute.layout<"1:0">
        %append_9289 = cute.append_to_rank<3> (%lay_9285, %3471) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9290 = cute.append_to_rank<3> (%lay_9286, %3471) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9291 = cute.size(%append_9289) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9292 = cute.size(%append_9289) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9293 = cute.size(%append_9290) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3472 = cute.get_scalars(%sz_9291) : !cute.int_tuple<"1">
        %3473 = cute.get_scalars(%sz_9292) : !cute.int_tuple<"2">
        %3474 = cute.get_scalars(%sz_9293) : !cute.int_tuple<"8">
        %c0_i32_9294 = arith.constant 0 : i32
        %c1_i32_9295 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9294 to %3472 step %c1_i32_9295  : i32 {
          scf.for %arg14 = %c0_i32_9294 to %3473 step %c1_i32_9295  : i32 {
            scf.for %arg15 = %c0_i32_9294 to %3474 step %c1_i32_9295  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_9289) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_9281, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_9290) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_9282, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_9287) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_9283, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_9288) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_9284, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9296 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9297 = cute.size(%int_tuple_9296) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9298 = cute.get_leaves(%sz_9297) : !cute.int_tuple<"8">
        %coord_9299 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9300 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_9301 = cute.crd2idx(%coord_9299, %lay_9300) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
        %iter_9302 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_9303 = cute.add_offset(%iter_9302, %idx_9301) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9304 = cute.make_view(%ptr_9303) : !memref_smem_bf16_14
        %iter_9305 = cute.get_iter(%view_9304) : !memref_smem_bf16_14
        %coord_9306 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9307 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_9308 = cute.crd2idx(%coord_9306, %lay_9307) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
        %iter_9309 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_9310 = cute.add_offset(%iter_9309, %idx_9308) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9311 = cute.make_view(%ptr_9310) : !memref_rmem_bf16_6
        %iter_9312 = cute.get_iter(%view_9311) : !memref_rmem_bf16_6
        %lay_9313 = cute.get_layout(%view_9304) : !memref_smem_bf16_14
        %3475 = cute.get_shape(%lay_9313) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9314, %e1_9315, %e2_9316 = cute.get_leaves(%3475) : !cute.shape<"((8,1),2)">
        %lay_9317 = cute.get_layout(%view_9311) : !memref_rmem_bf16_6
        %3476 = cute.get_shape(%lay_9317) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9318, %e1_9319, %e2_9320 = cute.get_leaves(%3476) : !cute.shape<"((8,1),2)">
        %lay_9321 = cute.get_layout(%view_9304) : !memref_smem_bf16_14
        %shape_9322 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9323 = cute.make_layout() : !cute.layout<"1:0">
        %append_9324 = cute.append_to_rank<2> (%lay_9321, %lay_9323) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9325 = cute.make_view(%iter_9305, %append_9324) : !memref_smem_bf16_14
        %iter_9326 = cute.get_iter(%view_9325) : !memref_smem_bf16_14
        %lay_9327 = cute.get_layout(%view_9325) : !memref_smem_bf16_14
        %3477 = cute.get_shape(%lay_9327) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9328, %e1_9329, %e2_9330 = cute.get_leaves(%3477) : !cute.shape<"((8,1),2)">
        %iter_9331 = cute.get_iter(%view_9325) : !memref_smem_bf16_14
        %view_9332 = cute.make_view(%iter_9331) : !memref_smem_bf16_15
        %iter_9333 = cute.get_iter(%view_9332) : !memref_smem_bf16_15
        %iter_9334 = cute.get_iter(%view_9332) : !memref_smem_bf16_15
        %lay_9335 = cute.get_layout(%view_9311) : !memref_rmem_bf16_6
        %shape_9336 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9337 = cute.make_layout() : !cute.layout<"1:0">
        %append_9338 = cute.append_to_rank<2> (%lay_9335, %lay_9337) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9339 = cute.make_view(%iter_9312, %append_9338) : !memref_rmem_bf16_6
        %iter_9340 = cute.get_iter(%view_9339) : !memref_rmem_bf16_6
        %lay_9341 = cute.get_layout(%view_9339) : !memref_rmem_bf16_6
        %3478 = cute.get_shape(%lay_9341) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9342, %e1_9343, %e2_9344 = cute.get_leaves(%3478) : !cute.shape<"((8,1),2)">
        %iter_9345 = cute.get_iter(%view_9339) : !memref_rmem_bf16_6
        %view_9346 = cute.make_view(%iter_9345) : !memref_rmem_bf16_7
        %iter_9347 = cute.get_iter(%view_9346) : !memref_rmem_bf16_7
        %iter_9348 = cute.get_iter(%view_9346) : !memref_rmem_bf16_7
        %lay_9349 = cute.get_layout(%view_9332) : !memref_smem_bf16_15
        %3479 = cute.get_shape(%lay_9349) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9350, %e1_9351, %e2_9352 = cute.get_leaves(%3479) : !cute.shape<"((8,1),(2))">
        %lay_9353 = cute.get_layout(%view_9346) : !memref_rmem_bf16_7
        %3480 = cute.get_shape(%lay_9353) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9354, %e1_9355, %e2_9356 = cute.get_leaves(%3480) : !cute.shape<"((8,1),(2))">
        %lay_9357 = cute.get_layout(%view_9332) : !memref_smem_bf16_15
        %sz_9358 = cute.size(%lay_9357) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9359 = cute.get_leaves(%sz_9358) : !cute.int_tuple<"2">
        %lay_9360 = cute.get_layout(%view_9346) : !memref_rmem_bf16_7
        %sz_9361 = cute.size(%lay_9360) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9362 = cute.get_leaves(%sz_9361) : !cute.int_tuple<"2">
        %3481 = cute.static : !cute.layout<"1:0">
        %iter_9363 = cute.get_iter(%view_9332) : !memref_smem_bf16_15
        %iter_9364 = cute.get_iter(%view_9346) : !memref_rmem_bf16_7
        %lay_9365 = cute.get_layout(%view_9332) : !memref_smem_bf16_15
        %lay_9366 = cute.get_layout(%view_9346) : !memref_rmem_bf16_7
        %append_9367 = cute.append_to_rank<2> (%lay_9365, %3481) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9368 = cute.append_to_rank<2> (%lay_9366, %3481) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9369 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9370 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9371 = cute.size(%lay_9369) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3482 = cute.get_scalars(%sz_9371) : !cute.int_tuple<"2">
        %c0_i32_9372 = arith.constant 0 : i32
        %c1_i32_9373 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9372 to %3482 step %c1_i32_9373  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9369) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_9363, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9370) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9364, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9374 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9375 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_9376 = cute.crd2idx(%coord_9374, %lay_9375) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
        %iter_9377 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_9378 = cute.add_offset(%iter_9377, %idx_9376) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9379 = cute.make_view(%ptr_9378) : !memref_smem_bf16_17
        %iter_9380 = cute.get_iter(%view_9379) : !memref_smem_bf16_17
        %coord_9381 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9382 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9383 = cute.crd2idx(%coord_9381, %lay_9382) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
        %iter_9384 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9385 = cute.add_offset(%iter_9384, %idx_9383) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9386 = cute.make_view(%ptr_9385) : !memref_rmem_bf16_9
        %iter_9387 = cute.get_iter(%view_9386) : !memref_rmem_bf16_9
        %lay_9388 = cute.get_layout(%view_9379) : !memref_smem_bf16_17
        %3483 = cute.get_shape(%lay_9388) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9389, %e1_9390, %e2_9391 = cute.get_leaves(%3483) : !cute.shape<"((8,1),4)">
        %lay_9392 = cute.get_layout(%view_9386) : !memref_rmem_bf16_9
        %3484 = cute.get_shape(%lay_9392) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9393, %e1_9394, %e2_9395 = cute.get_leaves(%3484) : !cute.shape<"((8,1),4)">
        %lay_9396 = cute.get_layout(%view_9379) : !memref_smem_bf16_17
        %shape_9397 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9398 = cute.make_layout() : !cute.layout<"1:0">
        %append_9399 = cute.append_to_rank<2> (%lay_9396, %lay_9398) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9400 = cute.make_view(%iter_9380, %append_9399) : !memref_smem_bf16_17
        %iter_9401 = cute.get_iter(%view_9400) : !memref_smem_bf16_17
        %lay_9402 = cute.get_layout(%view_9400) : !memref_smem_bf16_17
        %3485 = cute.get_shape(%lay_9402) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9403, %e1_9404, %e2_9405 = cute.get_leaves(%3485) : !cute.shape<"((8,1),4)">
        %iter_9406 = cute.get_iter(%view_9400) : !memref_smem_bf16_17
        %view_9407 = cute.make_view(%iter_9406) : !memref_smem_bf16_18
        %iter_9408 = cute.get_iter(%view_9407) : !memref_smem_bf16_18
        %iter_9409 = cute.get_iter(%view_9407) : !memref_smem_bf16_18
        %lay_9410 = cute.get_layout(%view_9386) : !memref_rmem_bf16_9
        %shape_9411 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9412 = cute.make_layout() : !cute.layout<"1:0">
        %append_9413 = cute.append_to_rank<2> (%lay_9410, %lay_9412) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9414 = cute.make_view(%iter_9387, %append_9413) : !memref_rmem_bf16_9
        %iter_9415 = cute.get_iter(%view_9414) : !memref_rmem_bf16_9
        %lay_9416 = cute.get_layout(%view_9414) : !memref_rmem_bf16_9
        %3486 = cute.get_shape(%lay_9416) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9417, %e1_9418, %e2_9419 = cute.get_leaves(%3486) : !cute.shape<"((8,1),4)">
        %iter_9420 = cute.get_iter(%view_9414) : !memref_rmem_bf16_9
        %view_9421 = cute.make_view(%iter_9420) : !memref_rmem_bf16_10
        %iter_9422 = cute.get_iter(%view_9421) : !memref_rmem_bf16_10
        %iter_9423 = cute.get_iter(%view_9421) : !memref_rmem_bf16_10
        %lay_9424 = cute.get_layout(%view_9407) : !memref_smem_bf16_18
        %3487 = cute.get_shape(%lay_9424) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9425, %e1_9426, %e2_9427 = cute.get_leaves(%3487) : !cute.shape<"((8,1),(4))">
        %lay_9428 = cute.get_layout(%view_9421) : !memref_rmem_bf16_10
        %3488 = cute.get_shape(%lay_9428) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9429, %e1_9430, %e2_9431 = cute.get_leaves(%3488) : !cute.shape<"((8,1),(4))">
        %lay_9432 = cute.get_layout(%view_9407) : !memref_smem_bf16_18
        %sz_9433 = cute.size(%lay_9432) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9434 = cute.get_leaves(%sz_9433) : !cute.int_tuple<"4">
        %lay_9435 = cute.get_layout(%view_9421) : !memref_rmem_bf16_10
        %sz_9436 = cute.size(%lay_9435) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9437 = cute.get_leaves(%sz_9436) : !cute.int_tuple<"4">
        %3489 = cute.static : !cute.layout<"1:0">
        %iter_9438 = cute.get_iter(%view_9407) : !memref_smem_bf16_18
        %iter_9439 = cute.get_iter(%view_9421) : !memref_rmem_bf16_10
        %lay_9440 = cute.get_layout(%view_9407) : !memref_smem_bf16_18
        %lay_9441 = cute.get_layout(%view_9421) : !memref_rmem_bf16_10
        %append_9442 = cute.append_to_rank<2> (%lay_9440, %3489) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9443 = cute.append_to_rank<2> (%lay_9441, %3489) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9444 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9445 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9446 = cute.size(%lay_9444) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3490 = cute.get_scalars(%sz_9446) : !cute.int_tuple<"4">
        %c0_i32_9447 = arith.constant 0 : i32
        %c1_i32_9448 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9447 to %3490 step %c1_i32_9448  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9444) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_9438, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9445) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9439, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9449 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9450 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9451 = cute.crd2idx(%coord_9449, %lay_9450) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
        %iter_9452 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9453 = cute.add_offset(%iter_9452, %idx_9451) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9454 = cute.make_view(%ptr_9453) : !memref_rmem_bf16_12
        %iter_9455 = cute.get_iter(%view_9454) : !memref_rmem_bf16_12
        %coord_9456 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9457 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_9458 = cute.crd2idx(%coord_9456, %lay_9457) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
        %iter_9459 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_9460 = cute.add_offset(%iter_9459, %idx_9458) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9461 = cute.make_view(%ptr_9460) : !memref_rmem_bf16_13
        %iter_9462 = cute.get_iter(%view_9461) : !memref_rmem_bf16_13
        %lay_9463 = cute.get_layout(%view_9454) : !memref_rmem_bf16_12
        %3491 = cute.get_shape(%lay_9463) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9464, %e1_9465, %e2_9466, %e3_9467 = cute.get_leaves(%3491) : !cute.shape<"((2,2,2),2)">
        %lay_9468 = cute.get_layout(%view_9461) : !memref_rmem_bf16_13
        %3492 = cute.get_shape(%lay_9468) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9469, %e1_9470, %e2_9471 = cute.get_leaves(%3492) : !cute.shape<"((2,2),8)">
        %iter_9472 = cute.get_iter(%view_9454) : !memref_rmem_bf16_12
        %iter_9473 = cute.get_iter(%view_9461) : !memref_rmem_bf16_13
        %iter_9474 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_9475 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_9476 = cute.get_layout(%view_9454) : !memref_rmem_bf16_12
        %lay_9477 = cute.get_layout(%view_9461) : !memref_rmem_bf16_13
        %lay_9478 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_9479 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3493 = cute.static : !cute.layout<"1:0">
        %append_9480 = cute.append_to_rank<3> (%lay_9476, %3493) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9481 = cute.append_to_rank<3> (%lay_9477, %3493) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9482 = cute.size(%append_9480) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9483 = cute.size(%append_9480) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9484 = cute.size(%append_9481) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3494 = cute.get_scalars(%sz_9482) : !cute.int_tuple<"1">
        %3495 = cute.get_scalars(%sz_9483) : !cute.int_tuple<"2">
        %3496 = cute.get_scalars(%sz_9484) : !cute.int_tuple<"8">
        %c0_i32_9485 = arith.constant 0 : i32
        %c1_i32_9486 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9485 to %3494 step %c1_i32_9486  : i32 {
          scf.for %arg14 = %c0_i32_9485 to %3495 step %c1_i32_9486  : i32 {
            scf.for %arg15 = %c0_i32_9485 to %3496 step %c1_i32_9486  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_9480) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_9472, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_9481) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_9473, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_9478) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_9474, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_9479) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_9475, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9487 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9488 = cute.size(%int_tuple_9487) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9489 = cute.get_leaves(%sz_9488) : !cute.int_tuple<"8">
        %coord_9490 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9491 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_9492 = cute.crd2idx(%coord_9490, %lay_9491) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9493 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_9494 = cute.add_offset(%iter_9493, %idx_9492) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9495 = cute.make_view(%ptr_9494) : !memref_smem_bf16_14
        %iter_9496 = cute.get_iter(%view_9495) : !memref_smem_bf16_14
        %coord_9497 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9498 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_9499 = cute.crd2idx(%coord_9497, %lay_9498) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
        %iter_9500 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_9501 = cute.add_offset(%iter_9500, %idx_9499) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9502 = cute.make_view(%ptr_9501) : !memref_rmem_bf16_6
        %iter_9503 = cute.get_iter(%view_9502) : !memref_rmem_bf16_6
        %lay_9504 = cute.get_layout(%view_9495) : !memref_smem_bf16_14
        %3497 = cute.get_shape(%lay_9504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9505, %e1_9506, %e2_9507 = cute.get_leaves(%3497) : !cute.shape<"((8,1),2)">
        %lay_9508 = cute.get_layout(%view_9502) : !memref_rmem_bf16_6
        %3498 = cute.get_shape(%lay_9508) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9509, %e1_9510, %e2_9511 = cute.get_leaves(%3498) : !cute.shape<"((8,1),2)">
        %lay_9512 = cute.get_layout(%view_9495) : !memref_smem_bf16_14
        %shape_9513 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9514 = cute.make_layout() : !cute.layout<"1:0">
        %append_9515 = cute.append_to_rank<2> (%lay_9512, %lay_9514) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9516 = cute.make_view(%iter_9496, %append_9515) : !memref_smem_bf16_14
        %iter_9517 = cute.get_iter(%view_9516) : !memref_smem_bf16_14
        %lay_9518 = cute.get_layout(%view_9516) : !memref_smem_bf16_14
        %3499 = cute.get_shape(%lay_9518) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9519, %e1_9520, %e2_9521 = cute.get_leaves(%3499) : !cute.shape<"((8,1),2)">
        %iter_9522 = cute.get_iter(%view_9516) : !memref_smem_bf16_14
        %view_9523 = cute.make_view(%iter_9522) : !memref_smem_bf16_15
        %iter_9524 = cute.get_iter(%view_9523) : !memref_smem_bf16_15
        %iter_9525 = cute.get_iter(%view_9523) : !memref_smem_bf16_15
        %lay_9526 = cute.get_layout(%view_9502) : !memref_rmem_bf16_6
        %shape_9527 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9528 = cute.make_layout() : !cute.layout<"1:0">
        %append_9529 = cute.append_to_rank<2> (%lay_9526, %lay_9528) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9530 = cute.make_view(%iter_9503, %append_9529) : !memref_rmem_bf16_6
        %iter_9531 = cute.get_iter(%view_9530) : !memref_rmem_bf16_6
        %lay_9532 = cute.get_layout(%view_9530) : !memref_rmem_bf16_6
        %3500 = cute.get_shape(%lay_9532) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9533, %e1_9534, %e2_9535 = cute.get_leaves(%3500) : !cute.shape<"((8,1),2)">
        %iter_9536 = cute.get_iter(%view_9530) : !memref_rmem_bf16_6
        %view_9537 = cute.make_view(%iter_9536) : !memref_rmem_bf16_7
        %iter_9538 = cute.get_iter(%view_9537) : !memref_rmem_bf16_7
        %iter_9539 = cute.get_iter(%view_9537) : !memref_rmem_bf16_7
        %lay_9540 = cute.get_layout(%view_9523) : !memref_smem_bf16_15
        %3501 = cute.get_shape(%lay_9540) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9541, %e1_9542, %e2_9543 = cute.get_leaves(%3501) : !cute.shape<"((8,1),(2))">
        %lay_9544 = cute.get_layout(%view_9537) : !memref_rmem_bf16_7
        %3502 = cute.get_shape(%lay_9544) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9545, %e1_9546, %e2_9547 = cute.get_leaves(%3502) : !cute.shape<"((8,1),(2))">
        %lay_9548 = cute.get_layout(%view_9523) : !memref_smem_bf16_15
        %sz_9549 = cute.size(%lay_9548) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9550 = cute.get_leaves(%sz_9549) : !cute.int_tuple<"2">
        %lay_9551 = cute.get_layout(%view_9537) : !memref_rmem_bf16_7
        %sz_9552 = cute.size(%lay_9551) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9553 = cute.get_leaves(%sz_9552) : !cute.int_tuple<"2">
        %3503 = cute.static : !cute.layout<"1:0">
        %iter_9554 = cute.get_iter(%view_9523) : !memref_smem_bf16_15
        %iter_9555 = cute.get_iter(%view_9537) : !memref_rmem_bf16_7
        %lay_9556 = cute.get_layout(%view_9523) : !memref_smem_bf16_15
        %lay_9557 = cute.get_layout(%view_9537) : !memref_rmem_bf16_7
        %append_9558 = cute.append_to_rank<2> (%lay_9556, %3503) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9559 = cute.append_to_rank<2> (%lay_9557, %3503) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9560 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9561 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9562 = cute.size(%lay_9560) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3504 = cute.get_scalars(%sz_9562) : !cute.int_tuple<"2">
        %c0_i32_9563 = arith.constant 0 : i32
        %c1_i32_9564 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9563 to %3504 step %c1_i32_9564  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9560) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_9554, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9561) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9555, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9565 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9566 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_9567 = cute.crd2idx(%coord_9565, %lay_9566) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9568 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_9569 = cute.add_offset(%iter_9568, %idx_9567) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9570 = cute.make_view(%ptr_9569) : !memref_smem_bf16_17
        %iter_9571 = cute.get_iter(%view_9570) : !memref_smem_bf16_17
        %coord_9572 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9573 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9574 = cute.crd2idx(%coord_9572, %lay_9573) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
        %iter_9575 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9576 = cute.add_offset(%iter_9575, %idx_9574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9577 = cute.make_view(%ptr_9576) : !memref_rmem_bf16_9
        %iter_9578 = cute.get_iter(%view_9577) : !memref_rmem_bf16_9
        %lay_9579 = cute.get_layout(%view_9570) : !memref_smem_bf16_17
        %3505 = cute.get_shape(%lay_9579) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9580, %e1_9581, %e2_9582 = cute.get_leaves(%3505) : !cute.shape<"((8,1),4)">
        %lay_9583 = cute.get_layout(%view_9577) : !memref_rmem_bf16_9
        %3506 = cute.get_shape(%lay_9583) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9584, %e1_9585, %e2_9586 = cute.get_leaves(%3506) : !cute.shape<"((8,1),4)">
        %lay_9587 = cute.get_layout(%view_9570) : !memref_smem_bf16_17
        %shape_9588 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9589 = cute.make_layout() : !cute.layout<"1:0">
        %append_9590 = cute.append_to_rank<2> (%lay_9587, %lay_9589) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9591 = cute.make_view(%iter_9571, %append_9590) : !memref_smem_bf16_17
        %iter_9592 = cute.get_iter(%view_9591) : !memref_smem_bf16_17
        %lay_9593 = cute.get_layout(%view_9591) : !memref_smem_bf16_17
        %3507 = cute.get_shape(%lay_9593) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9594, %e1_9595, %e2_9596 = cute.get_leaves(%3507) : !cute.shape<"((8,1),4)">
        %iter_9597 = cute.get_iter(%view_9591) : !memref_smem_bf16_17
        %view_9598 = cute.make_view(%iter_9597) : !memref_smem_bf16_18
        %iter_9599 = cute.get_iter(%view_9598) : !memref_smem_bf16_18
        %iter_9600 = cute.get_iter(%view_9598) : !memref_smem_bf16_18
        %lay_9601 = cute.get_layout(%view_9577) : !memref_rmem_bf16_9
        %shape_9602 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9603 = cute.make_layout() : !cute.layout<"1:0">
        %append_9604 = cute.append_to_rank<2> (%lay_9601, %lay_9603) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9605 = cute.make_view(%iter_9578, %append_9604) : !memref_rmem_bf16_9
        %iter_9606 = cute.get_iter(%view_9605) : !memref_rmem_bf16_9
        %lay_9607 = cute.get_layout(%view_9605) : !memref_rmem_bf16_9
        %3508 = cute.get_shape(%lay_9607) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9608, %e1_9609, %e2_9610 = cute.get_leaves(%3508) : !cute.shape<"((8,1),4)">
        %iter_9611 = cute.get_iter(%view_9605) : !memref_rmem_bf16_9
        %view_9612 = cute.make_view(%iter_9611) : !memref_rmem_bf16_10
        %iter_9613 = cute.get_iter(%view_9612) : !memref_rmem_bf16_10
        %iter_9614 = cute.get_iter(%view_9612) : !memref_rmem_bf16_10
        %lay_9615 = cute.get_layout(%view_9598) : !memref_smem_bf16_18
        %3509 = cute.get_shape(%lay_9615) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9616, %e1_9617, %e2_9618 = cute.get_leaves(%3509) : !cute.shape<"((8,1),(4))">
        %lay_9619 = cute.get_layout(%view_9612) : !memref_rmem_bf16_10
        %3510 = cute.get_shape(%lay_9619) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9620, %e1_9621, %e2_9622 = cute.get_leaves(%3510) : !cute.shape<"((8,1),(4))">
        %lay_9623 = cute.get_layout(%view_9598) : !memref_smem_bf16_18
        %sz_9624 = cute.size(%lay_9623) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9625 = cute.get_leaves(%sz_9624) : !cute.int_tuple<"4">
        %lay_9626 = cute.get_layout(%view_9612) : !memref_rmem_bf16_10
        %sz_9627 = cute.size(%lay_9626) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9628 = cute.get_leaves(%sz_9627) : !cute.int_tuple<"4">
        %3511 = cute.static : !cute.layout<"1:0">
        %iter_9629 = cute.get_iter(%view_9598) : !memref_smem_bf16_18
        %iter_9630 = cute.get_iter(%view_9612) : !memref_rmem_bf16_10
        %lay_9631 = cute.get_layout(%view_9598) : !memref_smem_bf16_18
        %lay_9632 = cute.get_layout(%view_9612) : !memref_rmem_bf16_10
        %append_9633 = cute.append_to_rank<2> (%lay_9631, %3511) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9634 = cute.append_to_rank<2> (%lay_9632, %3511) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9635 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9636 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9637 = cute.size(%lay_9635) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3512 = cute.get_scalars(%sz_9637) : !cute.int_tuple<"4">
        %c0_i32_9638 = arith.constant 0 : i32
        %c1_i32_9639 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9638 to %3512 step %c1_i32_9639  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9635) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_9629, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9636) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9630, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9640 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9641 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9642 = cute.crd2idx(%coord_9640, %lay_9641) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
        %iter_9643 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9644 = cute.add_offset(%iter_9643, %idx_9642) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9645 = cute.make_view(%ptr_9644) : !memref_rmem_bf16_12
        %iter_9646 = cute.get_iter(%view_9645) : !memref_rmem_bf16_12
        %coord_9647 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9648 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_9649 = cute.crd2idx(%coord_9647, %lay_9648) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
        %iter_9650 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_9651 = cute.add_offset(%iter_9650, %idx_9649) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9652 = cute.make_view(%ptr_9651) : !memref_rmem_bf16_13
        %iter_9653 = cute.get_iter(%view_9652) : !memref_rmem_bf16_13
        %lay_9654 = cute.get_layout(%view_9645) : !memref_rmem_bf16_12
        %3513 = cute.get_shape(%lay_9654) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9655, %e1_9656, %e2_9657, %e3_9658 = cute.get_leaves(%3513) : !cute.shape<"((2,2,2),2)">
        %lay_9659 = cute.get_layout(%view_9652) : !memref_rmem_bf16_13
        %3514 = cute.get_shape(%lay_9659) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9660, %e1_9661, %e2_9662 = cute.get_leaves(%3514) : !cute.shape<"((2,2),8)">
        %iter_9663 = cute.get_iter(%view_9645) : !memref_rmem_bf16_12
        %iter_9664 = cute.get_iter(%view_9652) : !memref_rmem_bf16_13
        %iter_9665 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_9666 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_9667 = cute.get_layout(%view_9645) : !memref_rmem_bf16_12
        %lay_9668 = cute.get_layout(%view_9652) : !memref_rmem_bf16_13
        %lay_9669 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_9670 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3515 = cute.static : !cute.layout<"1:0">
        %append_9671 = cute.append_to_rank<3> (%lay_9667, %3515) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9672 = cute.append_to_rank<3> (%lay_9668, %3515) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9673 = cute.size(%append_9671) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9674 = cute.size(%append_9671) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9675 = cute.size(%append_9672) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3516 = cute.get_scalars(%sz_9673) : !cute.int_tuple<"1">
        %3517 = cute.get_scalars(%sz_9674) : !cute.int_tuple<"2">
        %3518 = cute.get_scalars(%sz_9675) : !cute.int_tuple<"8">
        %c0_i32_9676 = arith.constant 0 : i32
        %c1_i32_9677 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9676 to %3516 step %c1_i32_9677  : i32 {
          scf.for %arg14 = %c0_i32_9676 to %3517 step %c1_i32_9677  : i32 {
            scf.for %arg15 = %c0_i32_9676 to %3518 step %c1_i32_9677  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_9671) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_9663, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_9672) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_9664, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_9669) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_9665, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_9670) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_9666, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9678 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9679 = cute.size(%int_tuple_9678) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9680 = cute.get_leaves(%sz_9679) : !cute.int_tuple<"8">
        %coord_9681 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9682 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_9683 = cute.crd2idx(%coord_9681, %lay_9682) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9684 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_9685 = cute.add_offset(%iter_9684, %idx_9683) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9686 = cute.make_view(%ptr_9685) : !memref_smem_bf16_14
        %iter_9687 = cute.get_iter(%view_9686) : !memref_smem_bf16_14
        %coord_9688 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9689 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_9690 = cute.crd2idx(%coord_9688, %lay_9689) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
        %iter_9691 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_9692 = cute.add_offset(%iter_9691, %idx_9690) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9693 = cute.make_view(%ptr_9692) : !memref_rmem_bf16_6
        %iter_9694 = cute.get_iter(%view_9693) : !memref_rmem_bf16_6
        %lay_9695 = cute.get_layout(%view_9686) : !memref_smem_bf16_14
        %3519 = cute.get_shape(%lay_9695) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9696, %e1_9697, %e2_9698 = cute.get_leaves(%3519) : !cute.shape<"((8,1),2)">
        %lay_9699 = cute.get_layout(%view_9693) : !memref_rmem_bf16_6
        %3520 = cute.get_shape(%lay_9699) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9700, %e1_9701, %e2_9702 = cute.get_leaves(%3520) : !cute.shape<"((8,1),2)">
        %lay_9703 = cute.get_layout(%view_9686) : !memref_smem_bf16_14
        %shape_9704 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9705 = cute.make_layout() : !cute.layout<"1:0">
        %append_9706 = cute.append_to_rank<2> (%lay_9703, %lay_9705) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9707 = cute.make_view(%iter_9687, %append_9706) : !memref_smem_bf16_14
        %iter_9708 = cute.get_iter(%view_9707) : !memref_smem_bf16_14
        %lay_9709 = cute.get_layout(%view_9707) : !memref_smem_bf16_14
        %3521 = cute.get_shape(%lay_9709) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9710, %e1_9711, %e2_9712 = cute.get_leaves(%3521) : !cute.shape<"((8,1),2)">
        %iter_9713 = cute.get_iter(%view_9707) : !memref_smem_bf16_14
        %view_9714 = cute.make_view(%iter_9713) : !memref_smem_bf16_15
        %iter_9715 = cute.get_iter(%view_9714) : !memref_smem_bf16_15
        %iter_9716 = cute.get_iter(%view_9714) : !memref_smem_bf16_15
        %lay_9717 = cute.get_layout(%view_9693) : !memref_rmem_bf16_6
        %shape_9718 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9719 = cute.make_layout() : !cute.layout<"1:0">
        %append_9720 = cute.append_to_rank<2> (%lay_9717, %lay_9719) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9721 = cute.make_view(%iter_9694, %append_9720) : !memref_rmem_bf16_6
        %iter_9722 = cute.get_iter(%view_9721) : !memref_rmem_bf16_6
        %lay_9723 = cute.get_layout(%view_9721) : !memref_rmem_bf16_6
        %3522 = cute.get_shape(%lay_9723) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9724, %e1_9725, %e2_9726 = cute.get_leaves(%3522) : !cute.shape<"((8,1),2)">
        %iter_9727 = cute.get_iter(%view_9721) : !memref_rmem_bf16_6
        %view_9728 = cute.make_view(%iter_9727) : !memref_rmem_bf16_7
        %iter_9729 = cute.get_iter(%view_9728) : !memref_rmem_bf16_7
        %iter_9730 = cute.get_iter(%view_9728) : !memref_rmem_bf16_7
        %lay_9731 = cute.get_layout(%view_9714) : !memref_smem_bf16_15
        %3523 = cute.get_shape(%lay_9731) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9732, %e1_9733, %e2_9734 = cute.get_leaves(%3523) : !cute.shape<"((8,1),(2))">
        %lay_9735 = cute.get_layout(%view_9728) : !memref_rmem_bf16_7
        %3524 = cute.get_shape(%lay_9735) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9736, %e1_9737, %e2_9738 = cute.get_leaves(%3524) : !cute.shape<"((8,1),(2))">
        %lay_9739 = cute.get_layout(%view_9714) : !memref_smem_bf16_15
        %sz_9740 = cute.size(%lay_9739) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9741 = cute.get_leaves(%sz_9740) : !cute.int_tuple<"2">
        %lay_9742 = cute.get_layout(%view_9728) : !memref_rmem_bf16_7
        %sz_9743 = cute.size(%lay_9742) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9744 = cute.get_leaves(%sz_9743) : !cute.int_tuple<"2">
        %3525 = cute.static : !cute.layout<"1:0">
        %iter_9745 = cute.get_iter(%view_9714) : !memref_smem_bf16_15
        %iter_9746 = cute.get_iter(%view_9728) : !memref_rmem_bf16_7
        %lay_9747 = cute.get_layout(%view_9714) : !memref_smem_bf16_15
        %lay_9748 = cute.get_layout(%view_9728) : !memref_rmem_bf16_7
        %append_9749 = cute.append_to_rank<2> (%lay_9747, %3525) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9750 = cute.append_to_rank<2> (%lay_9748, %3525) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9751 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9752 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9753 = cute.size(%lay_9751) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3526 = cute.get_scalars(%sz_9753) : !cute.int_tuple<"2">
        %c0_i32_9754 = arith.constant 0 : i32
        %c1_i32_9755 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9754 to %3526 step %c1_i32_9755  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9751) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_9745, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9752) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9746, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9756 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9757 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_9758 = cute.crd2idx(%coord_9756, %lay_9757) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9759 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_9760 = cute.add_offset(%iter_9759, %idx_9758) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9761 = cute.make_view(%ptr_9760) : !memref_smem_bf16_17
        %iter_9762 = cute.get_iter(%view_9761) : !memref_smem_bf16_17
        %coord_9763 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9764 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9765 = cute.crd2idx(%coord_9763, %lay_9764) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
        %iter_9766 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9767 = cute.add_offset(%iter_9766, %idx_9765) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9768 = cute.make_view(%ptr_9767) : !memref_rmem_bf16_9
        %iter_9769 = cute.get_iter(%view_9768) : !memref_rmem_bf16_9
        %lay_9770 = cute.get_layout(%view_9761) : !memref_smem_bf16_17
        %3527 = cute.get_shape(%lay_9770) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9771, %e1_9772, %e2_9773 = cute.get_leaves(%3527) : !cute.shape<"((8,1),4)">
        %lay_9774 = cute.get_layout(%view_9768) : !memref_rmem_bf16_9
        %3528 = cute.get_shape(%lay_9774) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9775, %e1_9776, %e2_9777 = cute.get_leaves(%3528) : !cute.shape<"((8,1),4)">
        %lay_9778 = cute.get_layout(%view_9761) : !memref_smem_bf16_17
        %shape_9779 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9780 = cute.make_layout() : !cute.layout<"1:0">
        %append_9781 = cute.append_to_rank<2> (%lay_9778, %lay_9780) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9782 = cute.make_view(%iter_9762, %append_9781) : !memref_smem_bf16_17
        %iter_9783 = cute.get_iter(%view_9782) : !memref_smem_bf16_17
        %lay_9784 = cute.get_layout(%view_9782) : !memref_smem_bf16_17
        %3529 = cute.get_shape(%lay_9784) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9785, %e1_9786, %e2_9787 = cute.get_leaves(%3529) : !cute.shape<"((8,1),4)">
        %iter_9788 = cute.get_iter(%view_9782) : !memref_smem_bf16_17
        %view_9789 = cute.make_view(%iter_9788) : !memref_smem_bf16_18
        %iter_9790 = cute.get_iter(%view_9789) : !memref_smem_bf16_18
        %iter_9791 = cute.get_iter(%view_9789) : !memref_smem_bf16_18
        %lay_9792 = cute.get_layout(%view_9768) : !memref_rmem_bf16_9
        %shape_9793 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9794 = cute.make_layout() : !cute.layout<"1:0">
        %append_9795 = cute.append_to_rank<2> (%lay_9792, %lay_9794) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9796 = cute.make_view(%iter_9769, %append_9795) : !memref_rmem_bf16_9
        %iter_9797 = cute.get_iter(%view_9796) : !memref_rmem_bf16_9
        %lay_9798 = cute.get_layout(%view_9796) : !memref_rmem_bf16_9
        %3530 = cute.get_shape(%lay_9798) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9799, %e1_9800, %e2_9801 = cute.get_leaves(%3530) : !cute.shape<"((8,1),4)">
        %iter_9802 = cute.get_iter(%view_9796) : !memref_rmem_bf16_9
        %view_9803 = cute.make_view(%iter_9802) : !memref_rmem_bf16_10
        %iter_9804 = cute.get_iter(%view_9803) : !memref_rmem_bf16_10
        %iter_9805 = cute.get_iter(%view_9803) : !memref_rmem_bf16_10
        %lay_9806 = cute.get_layout(%view_9789) : !memref_smem_bf16_18
        %3531 = cute.get_shape(%lay_9806) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9807, %e1_9808, %e2_9809 = cute.get_leaves(%3531) : !cute.shape<"((8,1),(4))">
        %lay_9810 = cute.get_layout(%view_9803) : !memref_rmem_bf16_10
        %3532 = cute.get_shape(%lay_9810) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9811, %e1_9812, %e2_9813 = cute.get_leaves(%3532) : !cute.shape<"((8,1),(4))">
        %lay_9814 = cute.get_layout(%view_9789) : !memref_smem_bf16_18
        %sz_9815 = cute.size(%lay_9814) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9816 = cute.get_leaves(%sz_9815) : !cute.int_tuple<"4">
        %lay_9817 = cute.get_layout(%view_9803) : !memref_rmem_bf16_10
        %sz_9818 = cute.size(%lay_9817) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9819 = cute.get_leaves(%sz_9818) : !cute.int_tuple<"4">
        %3533 = cute.static : !cute.layout<"1:0">
        %iter_9820 = cute.get_iter(%view_9789) : !memref_smem_bf16_18
        %iter_9821 = cute.get_iter(%view_9803) : !memref_rmem_bf16_10
        %lay_9822 = cute.get_layout(%view_9789) : !memref_smem_bf16_18
        %lay_9823 = cute.get_layout(%view_9803) : !memref_rmem_bf16_10
        %append_9824 = cute.append_to_rank<2> (%lay_9822, %3533) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9825 = cute.append_to_rank<2> (%lay_9823, %3533) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9826 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9827 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9828 = cute.size(%lay_9826) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3534 = cute.get_scalars(%sz_9828) : !cute.int_tuple<"4">
        %c0_i32_9829 = arith.constant 0 : i32
        %c1_i32_9830 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9829 to %3534 step %c1_i32_9830  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9826) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_9820, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9827) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9821, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9831 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9832 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9833 = cute.crd2idx(%coord_9831, %lay_9832) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
        %iter_9834 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9835 = cute.add_offset(%iter_9834, %idx_9833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9836 = cute.make_view(%ptr_9835) : !memref_rmem_bf16_12
        %iter_9837 = cute.get_iter(%view_9836) : !memref_rmem_bf16_12
        %coord_9838 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9839 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_9840 = cute.crd2idx(%coord_9838, %lay_9839) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
        %iter_9841 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_9842 = cute.add_offset(%iter_9841, %idx_9840) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9843 = cute.make_view(%ptr_9842) : !memref_rmem_bf16_13
        %iter_9844 = cute.get_iter(%view_9843) : !memref_rmem_bf16_13
        %lay_9845 = cute.get_layout(%view_9836) : !memref_rmem_bf16_12
        %3535 = cute.get_shape(%lay_9845) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9846, %e1_9847, %e2_9848, %e3_9849 = cute.get_leaves(%3535) : !cute.shape<"((2,2,2),2)">
        %lay_9850 = cute.get_layout(%view_9843) : !memref_rmem_bf16_13
        %3536 = cute.get_shape(%lay_9850) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9851, %e1_9852, %e2_9853 = cute.get_leaves(%3536) : !cute.shape<"((2,2),8)">
        %iter_9854 = cute.get_iter(%view_9836) : !memref_rmem_bf16_12
        %iter_9855 = cute.get_iter(%view_9843) : !memref_rmem_bf16_13
        %iter_9856 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_9857 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_9858 = cute.get_layout(%view_9836) : !memref_rmem_bf16_12
        %lay_9859 = cute.get_layout(%view_9843) : !memref_rmem_bf16_13
        %lay_9860 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_9861 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3537 = cute.static : !cute.layout<"1:0">
        %append_9862 = cute.append_to_rank<3> (%lay_9858, %3537) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9863 = cute.append_to_rank<3> (%lay_9859, %3537) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9864 = cute.size(%append_9862) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9865 = cute.size(%append_9862) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9866 = cute.size(%append_9863) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3538 = cute.get_scalars(%sz_9864) : !cute.int_tuple<"1">
        %3539 = cute.get_scalars(%sz_9865) : !cute.int_tuple<"2">
        %3540 = cute.get_scalars(%sz_9866) : !cute.int_tuple<"8">
        %c0_i32_9867 = arith.constant 0 : i32
        %c1_i32_9868 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9867 to %3538 step %c1_i32_9868  : i32 {
          scf.for %arg14 = %c0_i32_9867 to %3539 step %c1_i32_9868  : i32 {
            scf.for %arg15 = %c0_i32_9867 to %3540 step %c1_i32_9868  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_9862) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_9854, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_9863) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_9855, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_9860) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_9856, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_9861) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_9857, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9870 = cute.size(%int_tuple_9869) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9871 = cute.get_leaves(%sz_9870) : !cute.int_tuple<"8">
        %coord_9872 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9873 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_9874 = cute.crd2idx(%coord_9872, %lay_9873) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9875 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_9876 = cute.add_offset(%iter_9875, %idx_9874) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9877 = cute.make_view(%ptr_9876) : !memref_smem_bf16_14
        %iter_9878 = cute.get_iter(%view_9877) : !memref_smem_bf16_14
        %coord_9879 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9880 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_9881 = cute.crd2idx(%coord_9879, %lay_9880) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
        %iter_9882 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_9883 = cute.add_offset(%iter_9882, %idx_9881) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9884 = cute.make_view(%ptr_9883) : !memref_rmem_bf16_6
        %iter_9885 = cute.get_iter(%view_9884) : !memref_rmem_bf16_6
        %lay_9886 = cute.get_layout(%view_9877) : !memref_smem_bf16_14
        %3541 = cute.get_shape(%lay_9886) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9887, %e1_9888, %e2_9889 = cute.get_leaves(%3541) : !cute.shape<"((8,1),2)">
        %lay_9890 = cute.get_layout(%view_9884) : !memref_rmem_bf16_6
        %3542 = cute.get_shape(%lay_9890) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9891, %e1_9892, %e2_9893 = cute.get_leaves(%3542) : !cute.shape<"((8,1),2)">
        %lay_9894 = cute.get_layout(%view_9877) : !memref_smem_bf16_14
        %shape_9895 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9896 = cute.make_layout() : !cute.layout<"1:0">
        %append_9897 = cute.append_to_rank<2> (%lay_9894, %lay_9896) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9898 = cute.make_view(%iter_9878, %append_9897) : !memref_smem_bf16_14
        %iter_9899 = cute.get_iter(%view_9898) : !memref_smem_bf16_14
        %lay_9900 = cute.get_layout(%view_9898) : !memref_smem_bf16_14
        %3543 = cute.get_shape(%lay_9900) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9901, %e1_9902, %e2_9903 = cute.get_leaves(%3543) : !cute.shape<"((8,1),2)">
        %iter_9904 = cute.get_iter(%view_9898) : !memref_smem_bf16_14
        %view_9905 = cute.make_view(%iter_9904) : !memref_smem_bf16_15
        %iter_9906 = cute.get_iter(%view_9905) : !memref_smem_bf16_15
        %iter_9907 = cute.get_iter(%view_9905) : !memref_smem_bf16_15
        %lay_9908 = cute.get_layout(%view_9884) : !memref_rmem_bf16_6
        %shape_9909 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9910 = cute.make_layout() : !cute.layout<"1:0">
        %append_9911 = cute.append_to_rank<2> (%lay_9908, %lay_9910) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9912 = cute.make_view(%iter_9885, %append_9911) : !memref_rmem_bf16_6
        %iter_9913 = cute.get_iter(%view_9912) : !memref_rmem_bf16_6
        %lay_9914 = cute.get_layout(%view_9912) : !memref_rmem_bf16_6
        %3544 = cute.get_shape(%lay_9914) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9915, %e1_9916, %e2_9917 = cute.get_leaves(%3544) : !cute.shape<"((8,1),2)">
        %iter_9918 = cute.get_iter(%view_9912) : !memref_rmem_bf16_6
        %view_9919 = cute.make_view(%iter_9918) : !memref_rmem_bf16_7
        %iter_9920 = cute.get_iter(%view_9919) : !memref_rmem_bf16_7
        %iter_9921 = cute.get_iter(%view_9919) : !memref_rmem_bf16_7
        %lay_9922 = cute.get_layout(%view_9905) : !memref_smem_bf16_15
        %3545 = cute.get_shape(%lay_9922) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9923, %e1_9924, %e2_9925 = cute.get_leaves(%3545) : !cute.shape<"((8,1),(2))">
        %lay_9926 = cute.get_layout(%view_9919) : !memref_rmem_bf16_7
        %3546 = cute.get_shape(%lay_9926) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9927, %e1_9928, %e2_9929 = cute.get_leaves(%3546) : !cute.shape<"((8,1),(2))">
        %lay_9930 = cute.get_layout(%view_9905) : !memref_smem_bf16_15
        %sz_9931 = cute.size(%lay_9930) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9932 = cute.get_leaves(%sz_9931) : !cute.int_tuple<"2">
        %lay_9933 = cute.get_layout(%view_9919) : !memref_rmem_bf16_7
        %sz_9934 = cute.size(%lay_9933) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9935 = cute.get_leaves(%sz_9934) : !cute.int_tuple<"2">
        %3547 = cute.static : !cute.layout<"1:0">
        %iter_9936 = cute.get_iter(%view_9905) : !memref_smem_bf16_15
        %iter_9937 = cute.get_iter(%view_9919) : !memref_rmem_bf16_7
        %lay_9938 = cute.get_layout(%view_9905) : !memref_smem_bf16_15
        %lay_9939 = cute.get_layout(%view_9919) : !memref_rmem_bf16_7
        %append_9940 = cute.append_to_rank<2> (%lay_9938, %3547) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9941 = cute.append_to_rank<2> (%lay_9939, %3547) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9942 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9943 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9944 = cute.size(%lay_9942) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3548 = cute.get_scalars(%sz_9944) : !cute.int_tuple<"2">
        %c0_i32_9945 = arith.constant 0 : i32
        %c1_i32_9946 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9945 to %3548 step %c1_i32_9946  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_9942) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_9936, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_9943) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_9937, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9947 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9948 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_9949 = cute.crd2idx(%coord_9947, %lay_9948) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9950 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_9951 = cute.add_offset(%iter_9950, %idx_9949) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9952 = cute.make_view(%ptr_9951) : !memref_smem_bf16_17
        %iter_9953 = cute.get_iter(%view_9952) : !memref_smem_bf16_17
        %coord_9954 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9955 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_9956 = cute.crd2idx(%coord_9954, %lay_9955) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
        %iter_9957 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_9958 = cute.add_offset(%iter_9957, %idx_9956) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9959 = cute.make_view(%ptr_9958) : !memref_rmem_bf16_9
        %iter_9960 = cute.get_iter(%view_9959) : !memref_rmem_bf16_9
        %lay_9961 = cute.get_layout(%view_9952) : !memref_smem_bf16_17
        %3549 = cute.get_shape(%lay_9961) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9962, %e1_9963, %e2_9964 = cute.get_leaves(%3549) : !cute.shape<"((8,1),4)">
        %lay_9965 = cute.get_layout(%view_9959) : !memref_rmem_bf16_9
        %3550 = cute.get_shape(%lay_9965) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9966, %e1_9967, %e2_9968 = cute.get_leaves(%3550) : !cute.shape<"((8,1),4)">
        %lay_9969 = cute.get_layout(%view_9952) : !memref_smem_bf16_17
        %shape_9970 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9971 = cute.make_layout() : !cute.layout<"1:0">
        %append_9972 = cute.append_to_rank<2> (%lay_9969, %lay_9971) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9973 = cute.make_view(%iter_9953, %append_9972) : !memref_smem_bf16_17
        %iter_9974 = cute.get_iter(%view_9973) : !memref_smem_bf16_17
        %lay_9975 = cute.get_layout(%view_9973) : !memref_smem_bf16_17
        %3551 = cute.get_shape(%lay_9975) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9976, %e1_9977, %e2_9978 = cute.get_leaves(%3551) : !cute.shape<"((8,1),4)">
        %iter_9979 = cute.get_iter(%view_9973) : !memref_smem_bf16_17
        %view_9980 = cute.make_view(%iter_9979) : !memref_smem_bf16_18
        %iter_9981 = cute.get_iter(%view_9980) : !memref_smem_bf16_18
        %iter_9982 = cute.get_iter(%view_9980) : !memref_smem_bf16_18
        %lay_9983 = cute.get_layout(%view_9959) : !memref_rmem_bf16_9
        %shape_9984 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9985 = cute.make_layout() : !cute.layout<"1:0">
        %append_9986 = cute.append_to_rank<2> (%lay_9983, %lay_9985) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9987 = cute.make_view(%iter_9960, %append_9986) : !memref_rmem_bf16_9
        %iter_9988 = cute.get_iter(%view_9987) : !memref_rmem_bf16_9
        %lay_9989 = cute.get_layout(%view_9987) : !memref_rmem_bf16_9
        %3552 = cute.get_shape(%lay_9989) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9990, %e1_9991, %e2_9992 = cute.get_leaves(%3552) : !cute.shape<"((8,1),4)">
        %iter_9993 = cute.get_iter(%view_9987) : !memref_rmem_bf16_9
        %view_9994 = cute.make_view(%iter_9993) : !memref_rmem_bf16_10
        %iter_9995 = cute.get_iter(%view_9994) : !memref_rmem_bf16_10
        %iter_9996 = cute.get_iter(%view_9994) : !memref_rmem_bf16_10
        %lay_9997 = cute.get_layout(%view_9980) : !memref_smem_bf16_18
        %3553 = cute.get_shape(%lay_9997) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9998, %e1_9999, %e2_10000 = cute.get_leaves(%3553) : !cute.shape<"((8,1),(4))">
        %lay_10001 = cute.get_layout(%view_9994) : !memref_rmem_bf16_10
        %3554 = cute.get_shape(%lay_10001) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_10002, %e1_10003, %e2_10004 = cute.get_leaves(%3554) : !cute.shape<"((8,1),(4))">
        %lay_10005 = cute.get_layout(%view_9980) : !memref_smem_bf16_18
        %sz_10006 = cute.size(%lay_10005) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_10007 = cute.get_leaves(%sz_10006) : !cute.int_tuple<"4">
        %lay_10008 = cute.get_layout(%view_9994) : !memref_rmem_bf16_10
        %sz_10009 = cute.size(%lay_10008) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_10010 = cute.get_leaves(%sz_10009) : !cute.int_tuple<"4">
        %3555 = cute.static : !cute.layout<"1:0">
        %iter_10011 = cute.get_iter(%view_9980) : !memref_smem_bf16_18
        %iter_10012 = cute.get_iter(%view_9994) : !memref_rmem_bf16_10
        %lay_10013 = cute.get_layout(%view_9980) : !memref_smem_bf16_18
        %lay_10014 = cute.get_layout(%view_9994) : !memref_rmem_bf16_10
        %append_10015 = cute.append_to_rank<2> (%lay_10013, %3555) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_10016 = cute.append_to_rank<2> (%lay_10014, %3555) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10017 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_10018 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_10019 = cute.size(%lay_10017) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3556 = cute.get_scalars(%sz_10019) : !cute.int_tuple<"4">
        %c0_i32_10020 = arith.constant 0 : i32
        %c1_i32_10021 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10020 to %3556 step %c1_i32_10021  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10017) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_10011, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10018) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_10012, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10022 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_10023 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_10024 = cute.crd2idx(%coord_10022, %lay_10023) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
        %iter_10025 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_10026 = cute.add_offset(%iter_10025, %idx_10024) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10027 = cute.make_view(%ptr_10026) : !memref_rmem_bf16_12
        %iter_10028 = cute.get_iter(%view_10027) : !memref_rmem_bf16_12
        %coord_10029 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_10030 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_10031 = cute.crd2idx(%coord_10029, %lay_10030) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
        %iter_10032 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_10033 = cute.add_offset(%iter_10032, %idx_10031) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10034 = cute.make_view(%ptr_10033) : !memref_rmem_bf16_13
        %iter_10035 = cute.get_iter(%view_10034) : !memref_rmem_bf16_13
        %lay_10036 = cute.get_layout(%view_10027) : !memref_rmem_bf16_12
        %3557 = cute.get_shape(%lay_10036) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_10037, %e1_10038, %e2_10039, %e3_10040 = cute.get_leaves(%3557) : !cute.shape<"((2,2,2),2)">
        %lay_10041 = cute.get_layout(%view_10034) : !memref_rmem_bf16_13
        %3558 = cute.get_shape(%lay_10041) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_10042, %e1_10043, %e2_10044 = cute.get_leaves(%3558) : !cute.shape<"((2,2),8)">
        %iter_10045 = cute.get_iter(%view_10027) : !memref_rmem_bf16_12
        %iter_10046 = cute.get_iter(%view_10034) : !memref_rmem_bf16_13
        %iter_10047 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_10048 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_10049 = cute.get_layout(%view_10027) : !memref_rmem_bf16_12
        %lay_10050 = cute.get_layout(%view_10034) : !memref_rmem_bf16_13
        %lay_10051 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_10052 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3559 = cute.static : !cute.layout<"1:0">
        %append_10053 = cute.append_to_rank<3> (%lay_10049, %3559) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_10054 = cute.append_to_rank<3> (%lay_10050, %3559) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_10055 = cute.size(%append_10053) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_10056 = cute.size(%append_10053) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_10057 = cute.size(%append_10054) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3560 = cute.get_scalars(%sz_10055) : !cute.int_tuple<"1">
        %3561 = cute.get_scalars(%sz_10056) : !cute.int_tuple<"2">
        %3562 = cute.get_scalars(%sz_10057) : !cute.int_tuple<"8">
        %c0_i32_10058 = arith.constant 0 : i32
        %c1_i32_10059 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10058 to %3560 step %c1_i32_10059  : i32 {
          scf.for %arg14 = %c0_i32_10058 to %3561 step %c1_i32_10059  : i32 {
            scf.for %arg15 = %c0_i32_10058 to %3562 step %c1_i32_10059  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_10053) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_10045, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_10054) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_10046, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_10051) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_10047, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_10052) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_10048, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10060 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_10061 = cute.size(%int_tuple_10060) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_10062 = cute.get_leaves(%sz_10061) : !cute.int_tuple<"8">
        %coord_10063 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10064 = cute.get_layout(%view_743) : !memref_smem_bf16_8
        %idx_10065 = cute.crd2idx(%coord_10063, %lay_10064) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_10066 = cute.get_iter(%view_743) : !memref_smem_bf16_8
        %ptr_10067 = cute.add_offset(%iter_10066, %idx_10065) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10068 = cute.make_view(%ptr_10067) : !memref_smem_bf16_14
        %iter_10069 = cute.get_iter(%view_10068) : !memref_smem_bf16_14
        %coord_10070 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10071 = cute.get_layout(%view_746) : !memref_rmem_bf16_3
        %idx_10072 = cute.crd2idx(%coord_10070, %lay_10071) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_10073 = cute.get_iter(%view_746) : !memref_rmem_bf16_3
        %ptr_10074 = cute.add_offset(%iter_10073, %idx_10072) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10075 = cute.make_view(%ptr_10074) : !memref_rmem_bf16_6
        %iter_10076 = cute.get_iter(%view_10075) : !memref_rmem_bf16_6
        %lay_10077 = cute.get_layout(%view_10068) : !memref_smem_bf16_14
        %3563 = cute.get_shape(%lay_10077) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10078, %e1_10079, %e2_10080 = cute.get_leaves(%3563) : !cute.shape<"((8,1),2)">
        %lay_10081 = cute.get_layout(%view_10075) : !memref_rmem_bf16_6
        %3564 = cute.get_shape(%lay_10081) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10082, %e1_10083, %e2_10084 = cute.get_leaves(%3564) : !cute.shape<"((8,1),2)">
        %lay_10085 = cute.get_layout(%view_10068) : !memref_smem_bf16_14
        %shape_10086 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10087 = cute.make_layout() : !cute.layout<"1:0">
        %append_10088 = cute.append_to_rank<2> (%lay_10085, %lay_10087) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_10089 = cute.make_view(%iter_10069, %append_10088) : !memref_smem_bf16_14
        %iter_10090 = cute.get_iter(%view_10089) : !memref_smem_bf16_14
        %lay_10091 = cute.get_layout(%view_10089) : !memref_smem_bf16_14
        %3565 = cute.get_shape(%lay_10091) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10092, %e1_10093, %e2_10094 = cute.get_leaves(%3565) : !cute.shape<"((8,1),2)">
        %iter_10095 = cute.get_iter(%view_10089) : !memref_smem_bf16_14
        %view_10096 = cute.make_view(%iter_10095) : !memref_smem_bf16_15
        %iter_10097 = cute.get_iter(%view_10096) : !memref_smem_bf16_15
        %iter_10098 = cute.get_iter(%view_10096) : !memref_smem_bf16_15
        %lay_10099 = cute.get_layout(%view_10075) : !memref_rmem_bf16_6
        %shape_10100 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10101 = cute.make_layout() : !cute.layout<"1:0">
        %append_10102 = cute.append_to_rank<2> (%lay_10099, %lay_10101) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_10103 = cute.make_view(%iter_10076, %append_10102) : !memref_rmem_bf16_6
        %iter_10104 = cute.get_iter(%view_10103) : !memref_rmem_bf16_6
        %lay_10105 = cute.get_layout(%view_10103) : !memref_rmem_bf16_6
        %3566 = cute.get_shape(%lay_10105) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10106, %e1_10107, %e2_10108 = cute.get_leaves(%3566) : !cute.shape<"((8,1),2)">
        %iter_10109 = cute.get_iter(%view_10103) : !memref_rmem_bf16_6
        %view_10110 = cute.make_view(%iter_10109) : !memref_rmem_bf16_7
        %iter_10111 = cute.get_iter(%view_10110) : !memref_rmem_bf16_7
        %iter_10112 = cute.get_iter(%view_10110) : !memref_rmem_bf16_7
        %lay_10113 = cute.get_layout(%view_10096) : !memref_smem_bf16_15
        %3567 = cute.get_shape(%lay_10113) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_10114, %e1_10115, %e2_10116 = cute.get_leaves(%3567) : !cute.shape<"((8,1),(2))">
        %lay_10117 = cute.get_layout(%view_10110) : !memref_rmem_bf16_7
        %3568 = cute.get_shape(%lay_10117) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_10118, %e1_10119, %e2_10120 = cute.get_leaves(%3568) : !cute.shape<"((8,1),(2))">
        %lay_10121 = cute.get_layout(%view_10096) : !memref_smem_bf16_15
        %sz_10122 = cute.size(%lay_10121) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_10123 = cute.get_leaves(%sz_10122) : !cute.int_tuple<"2">
        %lay_10124 = cute.get_layout(%view_10110) : !memref_rmem_bf16_7
        %sz_10125 = cute.size(%lay_10124) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_10126 = cute.get_leaves(%sz_10125) : !cute.int_tuple<"2">
        %3569 = cute.static : !cute.layout<"1:0">
        %iter_10127 = cute.get_iter(%view_10096) : !memref_smem_bf16_15
        %iter_10128 = cute.get_iter(%view_10110) : !memref_rmem_bf16_7
        %lay_10129 = cute.get_layout(%view_10096) : !memref_smem_bf16_15
        %lay_10130 = cute.get_layout(%view_10110) : !memref_rmem_bf16_7
        %append_10131 = cute.append_to_rank<2> (%lay_10129, %3569) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_10132 = cute.append_to_rank<2> (%lay_10130, %3569) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10133 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_10134 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_10135 = cute.size(%lay_10133) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3570 = cute.get_scalars(%sz_10135) : !cute.int_tuple<"2">
        %c0_i32_10136 = arith.constant 0 : i32
        %c1_i32_10137 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10136 to %3570 step %c1_i32_10137  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10133) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11370 = cute.add_offset(%iter_10127, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10134) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_10128, %idx_11373) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_8
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10138 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10139 = cute.get_layout(%view_801) : !memref_smem_bf16_9
        %idx_10140 = cute.crd2idx(%coord_10138, %lay_10139) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_10141 = cute.get_iter(%view_801) : !memref_smem_bf16_9
        %ptr_10142 = cute.add_offset(%iter_10141, %idx_10140) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10143 = cute.make_view(%ptr_10142) : !memref_smem_bf16_17
        %iter_10144 = cute.get_iter(%view_10143) : !memref_smem_bf16_17
        %coord_10145 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10146 = cute.get_layout(%view_804) : !memref_rmem_bf16_4
        %idx_10147 = cute.crd2idx(%coord_10145, %lay_10146) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_10148 = cute.get_iter(%view_804) : !memref_rmem_bf16_4
        %ptr_10149 = cute.add_offset(%iter_10148, %idx_10147) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10150 = cute.make_view(%ptr_10149) : !memref_rmem_bf16_9
        %iter_10151 = cute.get_iter(%view_10150) : !memref_rmem_bf16_9
        %lay_10152 = cute.get_layout(%view_10143) : !memref_smem_bf16_17
        %3571 = cute.get_shape(%lay_10152) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10153, %e1_10154, %e2_10155 = cute.get_leaves(%3571) : !cute.shape<"((8,1),4)">
        %lay_10156 = cute.get_layout(%view_10150) : !memref_rmem_bf16_9
        %3572 = cute.get_shape(%lay_10156) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10157, %e1_10158, %e2_10159 = cute.get_leaves(%3572) : !cute.shape<"((8,1),4)">
        %lay_10160 = cute.get_layout(%view_10143) : !memref_smem_bf16_17
        %shape_10161 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10162 = cute.make_layout() : !cute.layout<"1:0">
        %append_10163 = cute.append_to_rank<2> (%lay_10160, %lay_10162) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_10164 = cute.make_view(%iter_10144, %append_10163) : !memref_smem_bf16_17
        %iter_10165 = cute.get_iter(%view_10164) : !memref_smem_bf16_17
        %lay_10166 = cute.get_layout(%view_10164) : !memref_smem_bf16_17
        %3573 = cute.get_shape(%lay_10166) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10167, %e1_10168, %e2_10169 = cute.get_leaves(%3573) : !cute.shape<"((8,1),4)">
        %iter_10170 = cute.get_iter(%view_10164) : !memref_smem_bf16_17
        %view_10171 = cute.make_view(%iter_10170) : !memref_smem_bf16_18
        %iter_10172 = cute.get_iter(%view_10171) : !memref_smem_bf16_18
        %iter_10173 = cute.get_iter(%view_10171) : !memref_smem_bf16_18
        %lay_10174 = cute.get_layout(%view_10150) : !memref_rmem_bf16_9
        %shape_10175 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10176 = cute.make_layout() : !cute.layout<"1:0">
        %append_10177 = cute.append_to_rank<2> (%lay_10174, %lay_10176) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_10178 = cute.make_view(%iter_10151, %append_10177) : !memref_rmem_bf16_9
        %iter_10179 = cute.get_iter(%view_10178) : !memref_rmem_bf16_9
        %lay_10180 = cute.get_layout(%view_10178) : !memref_rmem_bf16_9
        %3574 = cute.get_shape(%lay_10180) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10181, %e1_10182, %e2_10183 = cute.get_leaves(%3574) : !cute.shape<"((8,1),4)">
        %iter_10184 = cute.get_iter(%view_10178) : !memref_rmem_bf16_9
        %view_10185 = cute.make_view(%iter_10184) : !memref_rmem_bf16_10
        %iter_10186 = cute.get_iter(%view_10185) : !memref_rmem_bf16_10
        %iter_10187 = cute.get_iter(%view_10185) : !memref_rmem_bf16_10
        %lay_10188 = cute.get_layout(%view_10171) : !memref_smem_bf16_18
        %3575 = cute.get_shape(%lay_10188) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_10189, %e1_10190, %e2_10191 = cute.get_leaves(%3575) : !cute.shape<"((8,1),(4))">
        %lay_10192 = cute.get_layout(%view_10185) : !memref_rmem_bf16_10
        %3576 = cute.get_shape(%lay_10192) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_10193, %e1_10194, %e2_10195 = cute.get_leaves(%3576) : !cute.shape<"((8,1),(4))">
        %lay_10196 = cute.get_layout(%view_10171) : !memref_smem_bf16_18
        %sz_10197 = cute.size(%lay_10196) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_10198 = cute.get_leaves(%sz_10197) : !cute.int_tuple<"4">
        %lay_10199 = cute.get_layout(%view_10185) : !memref_rmem_bf16_10
        %sz_10200 = cute.size(%lay_10199) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_10201 = cute.get_leaves(%sz_10200) : !cute.int_tuple<"4">
        %3577 = cute.static : !cute.layout<"1:0">
        %iter_10202 = cute.get_iter(%view_10171) : !memref_smem_bf16_18
        %iter_10203 = cute.get_iter(%view_10185) : !memref_rmem_bf16_10
        %lay_10204 = cute.get_layout(%view_10171) : !memref_smem_bf16_18
        %lay_10205 = cute.get_layout(%view_10185) : !memref_rmem_bf16_10
        %append_10206 = cute.append_to_rank<2> (%lay_10204, %3577) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_10207 = cute.append_to_rank<2> (%lay_10205, %3577) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10208 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_10209 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_10210 = cute.size(%lay_10208) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3578 = cute.get_scalars(%sz_10210) : !cute.int_tuple<"4">
        %c0_i32_10211 = arith.constant 0 : i32
        %c1_i32_10212 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10211 to %3578 step %c1_i32_10212  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10208) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11370 = cute.add_offset(%iter_10202, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10209) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_10203, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3818 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3819 = llvm.mlir.constant(0 : i32) : i32
          %3820 = vector.extractelement %3818[%3819 : i32] : vector<4xi32>
          %3821 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3820, %3821 : i32, !llvm.ptr
          %3822 = llvm.mlir.constant(1 : i32) : i32
          %3823 = vector.extractelement %3818[%3822 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3823, %3824 : i32, !llvm.ptr
          %3825 = llvm.mlir.constant(2 : i32) : i32
          %3826 = vector.extractelement %3818[%3825 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3827 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3826, %3827 : i32, !llvm.ptr
          %3828 = llvm.mlir.constant(3 : i32) : i32
          %3829 = vector.extractelement %3818[%3828 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3830 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10213 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10214 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_10215 = cute.crd2idx(%coord_10213, %lay_10214) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
        %iter_10216 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_10217 = cute.add_offset(%iter_10216, %idx_10215) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10218 = cute.make_view(%ptr_10217) : !memref_rmem_bf16_12
        %iter_10219 = cute.get_iter(%view_10218) : !memref_rmem_bf16_12
        %coord_10220 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10221 = cute.get_layout(%rmem_599) : !memref_rmem_bf16_1
        %idx_10222 = cute.crd2idx(%coord_10220, %lay_10221) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
        %iter_10223 = cute.get_iter(%rmem_599) : !memref_rmem_bf16_1
        %ptr_10224 = cute.add_offset(%iter_10223, %idx_10222) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10225 = cute.make_view(%ptr_10224) : !memref_rmem_bf16_13
        %iter_10226 = cute.get_iter(%view_10225) : !memref_rmem_bf16_13
        %lay_10227 = cute.get_layout(%view_10218) : !memref_rmem_bf16_12
        %3579 = cute.get_shape(%lay_10227) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_10228, %e1_10229, %e2_10230, %e3_10231 = cute.get_leaves(%3579) : !cute.shape<"((2,2,2),2)">
        %lay_10232 = cute.get_layout(%view_10225) : !memref_rmem_bf16_13
        %3580 = cute.get_shape(%lay_10232) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_10233, %e1_10234, %e2_10235 = cute.get_leaves(%3580) : !cute.shape<"((2,2),8)">
        %iter_10236 = cute.get_iter(%view_10218) : !memref_rmem_bf16_12
        %iter_10237 = cute.get_iter(%view_10225) : !memref_rmem_bf16_13
        %iter_10238 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %iter_10239 = cute.get_iter(%rmem_8539) : !memref_rmem_f32_2
        %lay_10240 = cute.get_layout(%view_10218) : !memref_rmem_bf16_12
        %lay_10241 = cute.get_layout(%view_10225) : !memref_rmem_bf16_13
        %lay_10242 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_10243 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3581 = cute.static : !cute.layout<"1:0">
        %append_10244 = cute.append_to_rank<3> (%lay_10240, %3581) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_10245 = cute.append_to_rank<3> (%lay_10241, %3581) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_10246 = cute.size(%append_10244) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_10247 = cute.size(%append_10244) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_10248 = cute.size(%append_10245) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3582 = cute.get_scalars(%sz_10246) : !cute.int_tuple<"1">
        %3583 = cute.get_scalars(%sz_10247) : !cute.int_tuple<"2">
        %3584 = cute.get_scalars(%sz_10248) : !cute.int_tuple<"8">
        %c0_i32_10249 = arith.constant 0 : i32
        %c1_i32_10250 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10249 to %3582 step %c1_i32_10250  : i32 {
          scf.for %arg14 = %c0_i32_10249 to %3583 step %c1_i32_10250  : i32 {
            scf.for %arg15 = %c0_i32_10249 to %3584 step %c1_i32_10250  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_10244) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11372 = cute.add_offset(%iter_10236, %idx_11371) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_14
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_10245) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_10237, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_10242) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_10238, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_10243) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_10239, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_14
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_10251 = arith.constant 1 : i32
        %c128_i32_10252 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_10251 number_of_threads = %c128_i32_10252
        %c0_i32_10253 = arith.constant 0 : i32
        %3585 = arith.cmpi sgt, %3389, %c0_i32_10253 : i32
        scf.if %3585 {
          %c1_i32_11367 = arith.constant 1 : i32
          %3816 = arith.subi %3389, %c1_i32_11367 : i32
          %coord_11368 = cute.make_coord(%3816) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_11369 = cute.get_layout(%view_377) : !memref_gmem_bf16_5
          %3817:3 = cute.get_scalars(%lay_11369) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %3818 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_11370 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_11371 = cute.assume(%3817#1) : (i64) -> !cute.i64<divby 128>
          %stride_11372 = cute.make_stride(%iv_11371) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_11373 = cute.make_layout(%shape_11370, %stride_11372) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_11374 = cute.crd2idx(%coord_11368, %lay_11369) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_11375 = cute.get_iter(%view_377) : !memref_gmem_bf16_5
          %ptr_11376 = cute.add_offset(%iter_11375, %idx_11374) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_11377 = cute.make_view(%ptr_11376, %lay_11373) : !memref_gmem_bf16_9
          %iter_11378 = cute.get_iter(%view_11377) : !memref_gmem_bf16_9
          %lay_11379 = cute.get_layout(%view_11377) : !memref_gmem_bf16_9
          %3819 = cute.get_shape(%lay_11379) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11380, %e1_11381, %e2_11382, %e3_11383 = cute.get_leaves(%3819) : !cute.shape<"((8,1),4,2)">
          %lay_11384 = cute.get_layout(%view_422) : !memref_smem_bf16_4
          %3820 = cute.get_shape(%lay_11384) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11385, %e1_11386, %e2_11387, %e3_11388 = cute.get_leaves(%3820) : !cute.shape<"((8,1),4,2)">
          %lay_11389 = cute.get_layout(%view_11377) : !memref_gmem_bf16_9
          %shape_11390 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11391 = cute.make_layout() : !cute.layout<"1:0">
          %append_11392 = cute.append_to_rank<2> (%lay_11389, %lay_11391) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_11393 = cute.make_view(%iter_11378, %append_11392) : !memref_gmem_bf16_9
          %iter_11394 = cute.get_iter(%view_11393) : !memref_gmem_bf16_9
          %lay_11395 = cute.get_layout(%view_11393) : !memref_gmem_bf16_9
          %3821 = cute.get_shape(%lay_11395) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11396, %e1_11397, %e2_11398, %e3_11399 = cute.get_leaves(%3821) : !cute.shape<"((8,1),4,2)">
          %iter_11400 = cute.get_iter(%view_11393) : !memref_gmem_bf16_9
          %lay_11401 = cute.get_layout(%view_11393) : !memref_gmem_bf16_9
          %3822 = cute.get_scalars(%lay_11401) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_11402 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_11403 = cute.assume(%3822) : (i64) -> !cute.i64<divby 128>
          %stride_11404 = cute.make_stride(%iv_11403) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_11405 = cute.make_layout(%shape_11402, %stride_11404) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_11406 = cute.make_view(%iter_11400, %lay_11405) : !memref_gmem_bf16_10
          %iter_11407 = cute.get_iter(%view_11406) : !memref_gmem_bf16_10
          %iter_11408 = cute.get_iter(%view_11406) : !memref_gmem_bf16_10
          %lay_11409 = cute.get_layout(%view_422) : !memref_smem_bf16_4
          %shape_11410 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11411 = cute.make_layout() : !cute.layout<"1:0">
          %append_11412 = cute.append_to_rank<2> (%lay_11409, %lay_11411) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_11413 = cute.make_view(%iter_423, %append_11412) : !memref_smem_bf16_4
          %iter_11414 = cute.get_iter(%view_11413) : !memref_smem_bf16_4
          %lay_11415 = cute.get_layout(%view_11413) : !memref_smem_bf16_4
          %3823 = cute.get_shape(%lay_11415) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11416, %e1_11417, %e2_11418, %e3_11419 = cute.get_leaves(%3823) : !cute.shape<"((8,1),4,2)">
          %iter_11420 = cute.get_iter(%view_11413) : !memref_smem_bf16_4
          %view_11421 = cute.make_view(%iter_11420) : !memref_smem_bf16_16
          %iter_11422 = cute.get_iter(%view_11421) : !memref_smem_bf16_16
          %iter_11423 = cute.get_iter(%view_11421) : !memref_smem_bf16_16
          %lay_11424 = cute.get_layout(%rmem_1032) : !memref_rmem_i8_1
          %shape_11425 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11426 = cute.make_layout() : !cute.layout<"1:0">
          %append_11427 = cute.append_to_rank<2> (%lay_11424, %lay_11426) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_11428 = cute.make_view(%iter_1034, %append_11427) : !memref_rmem_i8_1
          %iter_11429 = cute.get_iter(%view_11428) : !memref_rmem_i8_1
          %lay_11430 = cute.get_layout(%view_11428) : !memref_rmem_i8_1
          %3824 = cute.get_shape(%lay_11430) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_11431, %e1_11432, %e2_11433 = cute.get_leaves(%3824) : !cute.shape<"(1,4,2)">
          %iter_11434 = cute.get_iter(%view_11428) : !memref_rmem_i8_1
          %view_11435 = cute.make_view(%iter_11434) : !memref_rmem_i8_5
          %iter_11436 = cute.get_iter(%view_11435) : !memref_rmem_i8_5
          %iter_11437 = cute.get_iter(%view_11435) : !memref_rmem_i8_5
          %lay_11438 = cute.get_layout(%view_11406) : !memref_gmem_bf16_10
          %3825 = cute.get_shape(%lay_11438) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11439, %e1_11440, %e2_11441, %e3_11442 = cute.get_leaves(%3825) : !cute.shape<"((8,1),(4,2))">
          %lay_11443 = cute.get_layout(%view_11421) : !memref_smem_bf16_16
          %3826 = cute.get_shape(%lay_11443) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11444, %e1_11445, %e2_11446, %e3_11447 = cute.get_leaves(%3826) : !cute.shape<"((8,1),(4,2))">
          %lay_11448 = cute.get_layout(%view_11406) : !memref_gmem_bf16_10
          %sz_11449 = cute.size(%lay_11448) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_11450 = cute.get_leaves(%sz_11449) : !cute.int_tuple<"8">
          %lay_11451 = cute.get_layout(%view_11421) : !memref_smem_bf16_16
          %sz_11452 = cute.size(%lay_11451) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_11453 = cute.get_leaves(%sz_11452) : !cute.int_tuple<"8">
          %3827 = cute.static : !cute.layout<"1:0">
          %iter_11454 = cute.get_iter(%view_11406) : !memref_gmem_bf16_10
          %iter_11455 = cute.get_iter(%view_11421) : !memref_smem_bf16_16
          %lay_11456 = cute.get_layout(%view_11406) : !memref_gmem_bf16_10
          %lay_11457 = cute.get_layout(%view_11421) : !memref_smem_bf16_16
          %append_11458 = cute.append_to_rank<2> (%lay_11456, %3827) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_11459 = cute.append_to_rank<2> (%lay_11457, %3827) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %3828 = cute.get_scalars(%append_11458) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_11460 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_11461 = cute.assume(%3828) : (i64) -> !cute.i64<divby 128>
          %stride_11462 = cute.make_stride(%iv_11461) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_11463 = cute.make_layout(%shape_11460, %stride_11462) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_11464 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_11465 = cute.get_iter(%view_11435) : !memref_rmem_i8_5
          %lay_11466 = cute.get_layout(%view_11435) : !memref_rmem_i8_5
          %append_11467 = cute.append_to_rank<2> (%lay_11466, %3827) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_11468 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_11469 = cute.size(%lay_11463) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %3829 = cute.get_scalars(%sz_11469) : !cute.int_tuple<"8">
          %c0_i32_11470 = arith.constant 0 : i32
          %c1_i32_11471 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_11470 to %3829 step %c1_i32_11471  : i32 {
            %coord_11472 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %3830 = cute.get_scalars(%lay_11463) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %3831 = cute.get_scalars(%coord_11472) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11473 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11474 = cute.crd2idx(%coord_11472, %lay_11463) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_11475 = cute.add_offset(%iter_11454, %idx_11474) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11476 = cute.make_view(%ptr_11475, %lay_11473) : !memref_gmem_bf16_8
            %3832 = cute.get_scalars(%coord_11472) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11477 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11478 = cute.crd2idx(%coord_11472, %lay_11464) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_11479 = cute.add_offset(%iter_11455, %idx_11478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11480 = cute.make_view(%ptr_11479, %lay_11477) : !memref_smem_bf16_13
            %3833 = cute.get_scalars(%coord_11472) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11481 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_11482 = cute.crd2idx(%coord_11472, %lay_11468) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_11483 = cute.add_offset(%iter_11465, %idx_11482) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_11484 = cute.make_view(%ptr_11483, %lay_11481) : !memref_rmem_i8_4
            %iter_11485 = cute.get_iter(%view_11476) : !memref_gmem_bf16_8
            %iter_11486 = cute.get_iter(%view_11480) : !memref_smem_bf16_13
            %iter_11487 = cute.get_iter(%view_11484) : !memref_rmem_i8_4
            %3834 = builtin.unrealized_conversion_cast %iter_11487 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3835 = llvm.load %3834 : !llvm.ptr -> i8
            %3836 = llvm.trunc %3835 : i8 to i1
            %iter_11488 = cute.recast_iter(%iter_11485) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_11489 = cute.recast_iter(%iter_11486) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_11489 : !cute.ptr<i128, smem>, %iter_11488 : !cute.ptr<i128, gmem>, %3836 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
          nvvm.cp.async.commit.group
        }
        %lay_10254 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %3586 = cute.get_shape(%lay_10254) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10255, %e1_10256, %e2_10257, %e3_10258 = cute.get_leaves(%3586) : !cute.shape<"((2,2),2,8)">
        %shape_10259 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_10260 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %3587 = cute.get_shape(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10261, %e1_10262, %e2_10263, %e3_10264 = cute.get_leaves(%3587) : !cute.shape<"((2,2),2,8)">
        %3588 = cute.get_shape(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10265, %e1_10266, %e2_10267, %e3_10268 = cute.get_leaves(%3588) : !cute.shape<"((2,2),2,8)">
        %3589 = cute.get_shape(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10269, %e1_10270, %e2_10271, %e3_10272 = cute.get_leaves(%3589) : !cute.shape<"((2,2),2,8)">
        %3590 = cute.get_shape(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10273, %e1_10274, %e2_10275, %e3_10276 = cute.get_leaves(%3590) : !cute.shape<"((2,2),2,8)">
        %3591 = cute.get_stride(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10277, %e1_10278, %e2_10279, %e3_10280 = cute.get_leaves(%3591) : !cute.stride<"((1,2),4,8)">
        %3592 = cute.get_stride(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10281, %e1_10282, %e2_10283, %e3_10284 = cute.get_leaves(%3592) : !cute.stride<"((1,2),4,8)">
        %3593 = cute.get_stride(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10285, %e1_10286, %e2_10287, %e3_10288 = cute.get_leaves(%3593) : !cute.stride<"((1,2),4,8)">
        %3594 = cute.get_stride(%lay_10260) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10289, %e1_10290, %e2_10291, %e3_10292 = cute.get_leaves(%3594) : !cute.stride<"((1,2),4,8)">
        %shape_10293 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
        %stride_10294 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_10295 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %lay_10296 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_10297 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %view_10298 = cute.make_view(%iter_8541, %lay_10297) : !memref_rmem_f32_4
        %iter_10299 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %lay_10300 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3595 = cute.get_shape(%lay_10300) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10301, %e1_10302, %e2_10303, %e3_10304 = cute.get_leaves(%3595) : !cute.shape<"((2,2),2,16)">
        %shape_10305 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
        %lay_10306 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
        %3596 = cute.get_shape(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10307, %e1_10308, %e2_10309, %e3_10310 = cute.get_leaves(%3596) : !cute.shape<"((2,2),2,16)">
        %3597 = cute.get_shape(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10311, %e1_10312, %e2_10313, %e3_10314 = cute.get_leaves(%3597) : !cute.shape<"((2,2),2,16)">
        %3598 = cute.get_shape(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10315, %e1_10316, %e2_10317, %e3_10318 = cute.get_leaves(%3598) : !cute.shape<"((2,2),2,16)">
        %3599 = cute.get_shape(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10319, %e1_10320, %e2_10321, %e3_10322 = cute.get_leaves(%3599) : !cute.shape<"((2,2),2,16)">
        %3600 = cute.get_stride(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10323, %e1_10324, %e2_10325, %e3_10326 = cute.get_leaves(%3600) : !cute.stride<"((1,2),4,8)">
        %3601 = cute.get_stride(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10327, %e1_10328, %e2_10329, %e3_10330 = cute.get_leaves(%3601) : !cute.stride<"((1,2),4,8)">
        %3602 = cute.get_stride(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10331, %e1_10332, %e2_10333, %e3_10334 = cute.get_leaves(%3602) : !cute.stride<"((1,2),4,8)">
        %3603 = cute.get_stride(%lay_10306) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10335, %e1_10336, %e2_10337, %e3_10338 = cute.get_leaves(%3603) : !cute.stride<"((1,2),4,8)">
        %shape_10339 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
        %stride_10340 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_10341 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %lay_10342 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %lay_10343 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %view_10344 = cute.make_view(%iter_634, %lay_10343) : !memref_rmem_f32_5
        %iter_10345 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %lay_10346 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
        %lay_10347 = cute.make_layout() : !cute.layout<"4:1">
        %rmem_10348 = cute.memref.alloca(%lay_10347) : !memref_rmem_f32_1
        %iter_10349 = cute.get_iter(%rmem_10348) : !memref_rmem_f32_1
        %iter_10350 = cute.get_iter(%rmem_10348) : !memref_rmem_f32_1
        %lay_10351 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
        %3604 = cute.get_shape(%lay_10351) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_10352 = cute.get_leaves(%3604) : !cute.shape<"4">
        %lay_10353 = cute.get_layout(%rmem_10348) : !memref_rmem_f32_1
        %3605 = cute.get_shape(%lay_10353) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_10354 = cute.get_leaves(%3605) : !cute.shape<"4">
        %atom_10355 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b>
        %3606 = cute.static : !cute.layout<"1:0">
        %iter_10356 = cute.get_iter(%rmem_1582) : !memref_rmem_f32_1
        %iter_10357 = cute.get_iter(%rmem_10348) : !memref_rmem_f32_1
        %lay_10358 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
        %lay_10359 = cute.get_layout(%rmem_10348) : !memref_rmem_f32_1
        %append_10360 = cute.append_to_rank<2> (%lay_10358, %3606) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %append_10361 = cute.append_to_rank<2> (%lay_10359, %3606) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %lay_10362 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %lay_10363 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %sz_10364 = cute.size(%lay_10362) <{mode = [1]}> : (!cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"1">
        %3607 = cute.get_scalars(%sz_10364) : !cute.int_tuple<"1">
        %c0_i32_10365 = arith.constant 0 : i32
        %c1_i32_10366 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10365 to %3607 step %c1_i32_10366  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"(4):(1)">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10362) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_11370 = cute.add_offset(%iter_10356, %idx_11369) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_rmem_f32_9
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"(4):(1)">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10363) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_11374 = cute.add_offset(%iter_10357, %idx_11373) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_f32_9
          %iter_11376 = cute.get_iter(%view_11371) : !memref_rmem_f32_9
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_f32_9
          %3818 = builtin.unrealized_conversion_cast %iter_11376 : !cute.ptr<f32, rmem, align<32>> to !llvm.ptr
          %3819 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<f32, rmem, align<32>> to !llvm.ptr
          %3820 = llvm.load %3818 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3820, %3819 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %ptr_11379 = cute.add_offset(%iter_11376, %int_tuple_11378) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"1">) -> !cute.ptr<f32, rmem>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"1">) -> !cute.ptr<f32, rmem>
          %3821 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3822 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3823 = llvm.load %3821 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3823, %3822 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11383 = cute.add_offset(%iter_11376, %int_tuple_11382) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
          %int_tuple_11384 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11385 = cute.add_offset(%iter_11377, %int_tuple_11384) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
          %3824 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<f32, rmem, align<8>> to !llvm.ptr
          %3825 = builtin.unrealized_conversion_cast %ptr_11385 : !cute.ptr<f32, rmem, align<8>> to !llvm.ptr
          %3826 = llvm.load %3824 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3826, %3825 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11386 = cute.make_int_tuple() : () -> !cute.int_tuple<"3">
          %ptr_11387 = cute.add_offset(%iter_11376, %int_tuple_11386) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"3">) -> !cute.ptr<f32, rmem>
          %int_tuple_11388 = cute.make_int_tuple() : () -> !cute.int_tuple<"3">
          %ptr_11389 = cute.add_offset(%iter_11377, %int_tuple_11388) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"3">) -> !cute.ptr<f32, rmem>
          %3827 = builtin.unrealized_conversion_cast %ptr_11387 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3828 = builtin.unrealized_conversion_cast %ptr_11389 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3829 = llvm.load %3827 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3829, %3828 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10367 = cute.get_layout(%rmem_1582) : !memref_rmem_f32_1
        %sz_10368 = cute.size(%lay_10367) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
        %e0_10369 = cute.get_leaves(%sz_10368) : !cute.int_tuple<"4">
        %coord_10370 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10371 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10372 = cute.crd2idx(%coord_10370, %lay_10371) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10373 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10374 = cute.add_offset(%iter_10373, %idx_10372) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10375 = cute.make_view(%ptr_10374) : !memref_rmem_f32_6
        %iter_10376 = cute.get_iter(%view_10375) : !memref_rmem_f32_6
        %lay_10377 = cute.get_layout(%view_10375) : !memref_rmem_f32_6
        %3608 = cute.get_shape(%lay_10377) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10378, %e1_10379 = cute.get_leaves(%3608) : !cute.shape<"((2,8))">
        %3609 = cute.memref.load_vec %view_10375, row_major : !memref_rmem_f32_6
        %cst_10380 = arith.constant 0xFF800000 : f32
        %3610 = vector.reduction <maximumf>, %3609, %cst_10380 : vector<16xf32> into f32
        %c-1_i32_10381 = arith.constant -1 : i32
        %c2_i32_10382 = arith.constant 2 : i32
        %c31_i32_10383 = arith.constant 31 : i32
        %3611 = nvvm.shfl.sync  bfly %c-1_i32_10381, %3610, %c2_i32_10382, %c31_i32_10383 : f32 -> f32
        %3612 = nvvm.fmax %3610, %3611
        %c-1_i32_10384 = arith.constant -1 : i32
        %c1_i32_10385 = arith.constant 1 : i32
        %c31_i32_10386 = arith.constant 31 : i32
        %3613 = nvvm.shfl.sync  bfly %c-1_i32_10384, %3612, %c1_i32_10385, %c31_i32_10386 : f32 -> f32
        %3614 = nvvm.fmax %3612, %3613
        %coord_10387 = cute.make_coord() : () -> !cute.coord<"0">
        %3615 = cute.memref.load(%rmem_10348, %coord_10387) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %3616 = nvvm.fmax %3615, %3614
        %3617 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3618 = arith.mulf %3609, %3617 : vector<16xf32>
        %3619 = arith.mulf %3616, %arg4 : f32
        %3620 = vector.broadcast %3619 : f32 to vector<16xf32>
        %3621 = arith.subf %3618, %3620 : vector<16xf32>
        %3622 = math.exp2 %3621 fastmath<fast> : vector<16xf32>
        %cst_10388 = arith.constant 0.000000e+00 : f32
        %3623 = vector.reduction <add>, %3622, %cst_10388 : vector<16xf32> into f32
        %3624 = arith.mulf %3615, %arg4 : f32
        %3625 = arith.mulf %3616, %arg4 : f32
        %3626 = arith.subf %3624, %3625 : f32
        %3627 = math.exp2 %3626 fastmath<fast> : f32
        %coord_10389 = cute.make_coord() : () -> !cute.coord<"0">
        %3628 = cute.memref.load(%rmem_1587, %coord_10389) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %3629 = arith.mulf %3628, %3627 : f32
        %3630 = arith.addf %3629, %3623 : f32
        %coord_10390 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10391 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10392 = cute.crd2idx(%coord_10390, %lay_10391) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10393 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10394 = cute.add_offset(%iter_10393, %idx_10392) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10395 = cute.make_view(%ptr_10394) : !memref_rmem_f32_10
        %iter_10396 = cute.get_iter(%view_10395) : !memref_rmem_f32_10
        %lay_10397 = cute.get_layout(%view_10395) : !memref_rmem_f32_10
        %3631 = cute.get_shape(%lay_10397) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10398, %e1_10399 = cute.get_leaves(%3631) : !cute.shape<"((2,16))">
        %3632 = cute.memref.load_vec %view_10395, row_major : !memref_rmem_f32_10
        %3633 = vector.broadcast %3627 : f32 to vector<32xf32>
        %3634 = arith.mulf %3632, %3633 : vector<32xf32>
        %coord_10400 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10401 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10402 = cute.crd2idx(%coord_10400, %lay_10401) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10403 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10404 = cute.add_offset(%iter_10403, %idx_10402) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10405 = cute.make_view(%ptr_10404) : !memref_rmem_f32_10
        %iter_10406 = cute.get_iter(%view_10405) : !memref_rmem_f32_10
        %lay_10407 = cute.get_layout(%view_10405) : !memref_rmem_f32_10
        %3635 = cute.get_shape(%lay_10407) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10408, %e1_10409 = cute.get_leaves(%3635) : !cute.shape<"((2,16))">
        %int_tuple_10410 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10411 = cute.size(%int_tuple_10410) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10412 = cute.get_leaves(%sz_10411) : !cute.int_tuple<"32">
        %int_tuple_10413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10414 = cute.size(%int_tuple_10413) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10415 = cute.get_leaves(%sz_10414) : !cute.int_tuple<"32">
        cute.memref.store_vec %3634, %view_10405, row_major : !memref_rmem_f32_10
        %coord_10416 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1582, %coord_10416, %3616) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_10417 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1587, %coord_10417, %3630) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_10418 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10419 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10420 = cute.crd2idx(%coord_10418, %lay_10419) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10421 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10422 = cute.add_offset(%iter_10421, %idx_10420) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10423 = cute.make_view(%ptr_10422) : !memref_rmem_f32_6
        %iter_10424 = cute.get_iter(%view_10423) : !memref_rmem_f32_6
        %lay_10425 = cute.get_layout(%view_10423) : !memref_rmem_f32_6
        %3636 = cute.get_shape(%lay_10425) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10426, %e1_10427 = cute.get_leaves(%3636) : !cute.shape<"((2,8))">
        %int_tuple_10428 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10429 = cute.size(%int_tuple_10428) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10430 = cute.get_leaves(%sz_10429) : !cute.int_tuple<"16">
        %int_tuple_10431 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10432 = cute.size(%int_tuple_10431) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10433 = cute.get_leaves(%sz_10432) : !cute.int_tuple<"16">
        cute.memref.store_vec %3622, %view_10423, row_major : !memref_rmem_f32_6
        %coord_10434 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10435 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10436 = cute.crd2idx(%coord_10434, %lay_10435) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10437 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10438 = cute.add_offset(%iter_10437, %idx_10436) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10439 = cute.make_view(%ptr_10438) : !memref_rmem_f32_7
        %iter_10440 = cute.get_iter(%view_10439) : !memref_rmem_f32_7
        %lay_10441 = cute.get_layout(%view_10439) : !memref_rmem_f32_7
        %3637 = cute.get_shape(%lay_10441) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10442, %e1_10443 = cute.get_leaves(%3637) : !cute.shape<"((2,8))">
        %3638 = cute.memref.load_vec %view_10439, row_major : !memref_rmem_f32_7
        %cst_10444 = arith.constant 0xFF800000 : f32
        %3639 = vector.reduction <maximumf>, %3638, %cst_10444 : vector<16xf32> into f32
        %c-1_i32_10445 = arith.constant -1 : i32
        %c2_i32_10446 = arith.constant 2 : i32
        %c31_i32_10447 = arith.constant 31 : i32
        %3640 = nvvm.shfl.sync  bfly %c-1_i32_10445, %3639, %c2_i32_10446, %c31_i32_10447 : f32 -> f32
        %3641 = nvvm.fmax %3639, %3640
        %c-1_i32_10448 = arith.constant -1 : i32
        %c1_i32_10449 = arith.constant 1 : i32
        %c31_i32_10450 = arith.constant 31 : i32
        %3642 = nvvm.shfl.sync  bfly %c-1_i32_10448, %3641, %c1_i32_10449, %c31_i32_10450 : f32 -> f32
        %3643 = nvvm.fmax %3641, %3642
        %coord_10451 = cute.make_coord() : () -> !cute.coord<"1">
        %3644 = cute.memref.load(%rmem_10348, %coord_10451) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %3645 = nvvm.fmax %3644, %3643
        %3646 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3647 = arith.mulf %3638, %3646 : vector<16xf32>
        %3648 = arith.mulf %3645, %arg4 : f32
        %3649 = vector.broadcast %3648 : f32 to vector<16xf32>
        %3650 = arith.subf %3647, %3649 : vector<16xf32>
        %3651 = math.exp2 %3650 fastmath<fast> : vector<16xf32>
        %cst_10452 = arith.constant 0.000000e+00 : f32
        %3652 = vector.reduction <add>, %3651, %cst_10452 : vector<16xf32> into f32
        %3653 = arith.mulf %3644, %arg4 : f32
        %3654 = arith.mulf %3645, %arg4 : f32
        %3655 = arith.subf %3653, %3654 : f32
        %3656 = math.exp2 %3655 fastmath<fast> : f32
        %coord_10453 = cute.make_coord() : () -> !cute.coord<"1">
        %3657 = cute.memref.load(%rmem_1587, %coord_10453) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %3658 = arith.mulf %3657, %3656 : f32
        %3659 = arith.addf %3658, %3652 : f32
        %coord_10454 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10455 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10456 = cute.crd2idx(%coord_10454, %lay_10455) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10457 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10458 = cute.add_offset(%iter_10457, %idx_10456) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10459 = cute.make_view(%ptr_10458) : !memref_rmem_f32_11
        %iter_10460 = cute.get_iter(%view_10459) : !memref_rmem_f32_11
        %lay_10461 = cute.get_layout(%view_10459) : !memref_rmem_f32_11
        %3660 = cute.get_shape(%lay_10461) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10462, %e1_10463 = cute.get_leaves(%3660) : !cute.shape<"((2,16))">
        %3661 = cute.memref.load_vec %view_10459, row_major : !memref_rmem_f32_11
        %3662 = vector.broadcast %3656 : f32 to vector<32xf32>
        %3663 = arith.mulf %3661, %3662 : vector<32xf32>
        %coord_10464 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10465 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10466 = cute.crd2idx(%coord_10464, %lay_10465) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10467 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10468 = cute.add_offset(%iter_10467, %idx_10466) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10469 = cute.make_view(%ptr_10468) : !memref_rmem_f32_11
        %iter_10470 = cute.get_iter(%view_10469) : !memref_rmem_f32_11
        %lay_10471 = cute.get_layout(%view_10469) : !memref_rmem_f32_11
        %3664 = cute.get_shape(%lay_10471) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10472, %e1_10473 = cute.get_leaves(%3664) : !cute.shape<"((2,16))">
        %int_tuple_10474 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10475 = cute.size(%int_tuple_10474) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10476 = cute.get_leaves(%sz_10475) : !cute.int_tuple<"32">
        %int_tuple_10477 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10478 = cute.size(%int_tuple_10477) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10479 = cute.get_leaves(%sz_10478) : !cute.int_tuple<"32">
        cute.memref.store_vec %3663, %view_10469, row_major : !memref_rmem_f32_11
        %coord_10480 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1582, %coord_10480, %3645) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_10481 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1587, %coord_10481, %3659) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_10482 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10483 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10484 = cute.crd2idx(%coord_10482, %lay_10483) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10485 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10486 = cute.add_offset(%iter_10485, %idx_10484) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10487 = cute.make_view(%ptr_10486) : !memref_rmem_f32_7
        %iter_10488 = cute.get_iter(%view_10487) : !memref_rmem_f32_7
        %lay_10489 = cute.get_layout(%view_10487) : !memref_rmem_f32_7
        %3665 = cute.get_shape(%lay_10489) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10490, %e1_10491 = cute.get_leaves(%3665) : !cute.shape<"((2,8))">
        %int_tuple_10492 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10493 = cute.size(%int_tuple_10492) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10494 = cute.get_leaves(%sz_10493) : !cute.int_tuple<"16">
        %int_tuple_10495 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10496 = cute.size(%int_tuple_10495) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10497 = cute.get_leaves(%sz_10496) : !cute.int_tuple<"16">
        cute.memref.store_vec %3651, %view_10487, row_major : !memref_rmem_f32_7
        %coord_10498 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10499 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10500 = cute.crd2idx(%coord_10498, %lay_10499) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10501 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10502 = cute.add_offset(%iter_10501, %idx_10500) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10503 = cute.make_view(%ptr_10502) : !memref_rmem_f32_8
        %iter_10504 = cute.get_iter(%view_10503) : !memref_rmem_f32_8
        %lay_10505 = cute.get_layout(%view_10503) : !memref_rmem_f32_8
        %3666 = cute.get_shape(%lay_10505) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10506, %e1_10507 = cute.get_leaves(%3666) : !cute.shape<"((2,8))">
        %3667 = cute.memref.load_vec %view_10503, row_major : !memref_rmem_f32_8
        %cst_10508 = arith.constant 0xFF800000 : f32
        %3668 = vector.reduction <maximumf>, %3667, %cst_10508 : vector<16xf32> into f32
        %c-1_i32_10509 = arith.constant -1 : i32
        %c2_i32_10510 = arith.constant 2 : i32
        %c31_i32_10511 = arith.constant 31 : i32
        %3669 = nvvm.shfl.sync  bfly %c-1_i32_10509, %3668, %c2_i32_10510, %c31_i32_10511 : f32 -> f32
        %3670 = nvvm.fmax %3668, %3669
        %c-1_i32_10512 = arith.constant -1 : i32
        %c1_i32_10513 = arith.constant 1 : i32
        %c31_i32_10514 = arith.constant 31 : i32
        %3671 = nvvm.shfl.sync  bfly %c-1_i32_10512, %3670, %c1_i32_10513, %c31_i32_10514 : f32 -> f32
        %3672 = nvvm.fmax %3670, %3671
        %coord_10515 = cute.make_coord() : () -> !cute.coord<"2">
        %3673 = cute.memref.load(%rmem_10348, %coord_10515) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %3674 = nvvm.fmax %3673, %3672
        %3675 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3676 = arith.mulf %3667, %3675 : vector<16xf32>
        %3677 = arith.mulf %3674, %arg4 : f32
        %3678 = vector.broadcast %3677 : f32 to vector<16xf32>
        %3679 = arith.subf %3676, %3678 : vector<16xf32>
        %3680 = math.exp2 %3679 fastmath<fast> : vector<16xf32>
        %cst_10516 = arith.constant 0.000000e+00 : f32
        %3681 = vector.reduction <add>, %3680, %cst_10516 : vector<16xf32> into f32
        %3682 = arith.mulf %3673, %arg4 : f32
        %3683 = arith.mulf %3674, %arg4 : f32
        %3684 = arith.subf %3682, %3683 : f32
        %3685 = math.exp2 %3684 fastmath<fast> : f32
        %coord_10517 = cute.make_coord() : () -> !cute.coord<"2">
        %3686 = cute.memref.load(%rmem_1587, %coord_10517) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %3687 = arith.mulf %3686, %3685 : f32
        %3688 = arith.addf %3687, %3681 : f32
        %coord_10518 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10519 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10520 = cute.crd2idx(%coord_10518, %lay_10519) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10521 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10522 = cute.add_offset(%iter_10521, %idx_10520) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10523 = cute.make_view(%ptr_10522) : !memref_rmem_f32_12
        %iter_10524 = cute.get_iter(%view_10523) : !memref_rmem_f32_12
        %lay_10525 = cute.get_layout(%view_10523) : !memref_rmem_f32_12
        %3689 = cute.get_shape(%lay_10525) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10526, %e1_10527 = cute.get_leaves(%3689) : !cute.shape<"((2,16))">
        %3690 = cute.memref.load_vec %view_10523, row_major : !memref_rmem_f32_12
        %3691 = vector.broadcast %3685 : f32 to vector<32xf32>
        %3692 = arith.mulf %3690, %3691 : vector<32xf32>
        %coord_10528 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10529 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10530 = cute.crd2idx(%coord_10528, %lay_10529) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10531 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10532 = cute.add_offset(%iter_10531, %idx_10530) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10533 = cute.make_view(%ptr_10532) : !memref_rmem_f32_12
        %iter_10534 = cute.get_iter(%view_10533) : !memref_rmem_f32_12
        %lay_10535 = cute.get_layout(%view_10533) : !memref_rmem_f32_12
        %3693 = cute.get_shape(%lay_10535) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10536, %e1_10537 = cute.get_leaves(%3693) : !cute.shape<"((2,16))">
        %int_tuple_10538 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10539 = cute.size(%int_tuple_10538) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10540 = cute.get_leaves(%sz_10539) : !cute.int_tuple<"32">
        %int_tuple_10541 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10542 = cute.size(%int_tuple_10541) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10543 = cute.get_leaves(%sz_10542) : !cute.int_tuple<"32">
        cute.memref.store_vec %3692, %view_10533, row_major : !memref_rmem_f32_12
        %coord_10544 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1582, %coord_10544, %3674) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_10545 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1587, %coord_10545, %3688) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_10546 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10547 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10548 = cute.crd2idx(%coord_10546, %lay_10547) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10549 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10550 = cute.add_offset(%iter_10549, %idx_10548) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10551 = cute.make_view(%ptr_10550) : !memref_rmem_f32_8
        %iter_10552 = cute.get_iter(%view_10551) : !memref_rmem_f32_8
        %lay_10553 = cute.get_layout(%view_10551) : !memref_rmem_f32_8
        %3694 = cute.get_shape(%lay_10553) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10554, %e1_10555 = cute.get_leaves(%3694) : !cute.shape<"((2,8))">
        %int_tuple_10556 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10557 = cute.size(%int_tuple_10556) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10558 = cute.get_leaves(%sz_10557) : !cute.int_tuple<"16">
        %int_tuple_10559 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10560 = cute.size(%int_tuple_10559) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10561 = cute.get_leaves(%sz_10560) : !cute.int_tuple<"16">
        cute.memref.store_vec %3680, %view_10551, row_major : !memref_rmem_f32_8
        %coord_10562 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10563 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10564 = cute.crd2idx(%coord_10562, %lay_10563) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10565 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10566 = cute.add_offset(%iter_10565, %idx_10564) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10567 = cute.make_view(%ptr_10566) : !memref_rmem_f32_7
        %iter_10568 = cute.get_iter(%view_10567) : !memref_rmem_f32_7
        %lay_10569 = cute.get_layout(%view_10567) : !memref_rmem_f32_7
        %3695 = cute.get_shape(%lay_10569) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10570, %e1_10571 = cute.get_leaves(%3695) : !cute.shape<"((2,8))">
        %3696 = cute.memref.load_vec %view_10567, row_major : !memref_rmem_f32_7
        %cst_10572 = arith.constant 0xFF800000 : f32
        %3697 = vector.reduction <maximumf>, %3696, %cst_10572 : vector<16xf32> into f32
        %c-1_i32_10573 = arith.constant -1 : i32
        %c2_i32_10574 = arith.constant 2 : i32
        %c31_i32_10575 = arith.constant 31 : i32
        %3698 = nvvm.shfl.sync  bfly %c-1_i32_10573, %3697, %c2_i32_10574, %c31_i32_10575 : f32 -> f32
        %3699 = nvvm.fmax %3697, %3698
        %c-1_i32_10576 = arith.constant -1 : i32
        %c1_i32_10577 = arith.constant 1 : i32
        %c31_i32_10578 = arith.constant 31 : i32
        %3700 = nvvm.shfl.sync  bfly %c-1_i32_10576, %3699, %c1_i32_10577, %c31_i32_10578 : f32 -> f32
        %3701 = nvvm.fmax %3699, %3700
        %coord_10579 = cute.make_coord() : () -> !cute.coord<"3">
        %3702 = cute.memref.load(%rmem_10348, %coord_10579) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %3703 = nvvm.fmax %3702, %3701
        %3704 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3705 = arith.mulf %3696, %3704 : vector<16xf32>
        %3706 = arith.mulf %3703, %arg4 : f32
        %3707 = vector.broadcast %3706 : f32 to vector<16xf32>
        %3708 = arith.subf %3705, %3707 : vector<16xf32>
        %3709 = math.exp2 %3708 fastmath<fast> : vector<16xf32>
        %cst_10580 = arith.constant 0.000000e+00 : f32
        %3710 = vector.reduction <add>, %3709, %cst_10580 : vector<16xf32> into f32
        %3711 = arith.mulf %3702, %arg4 : f32
        %3712 = arith.mulf %3703, %arg4 : f32
        %3713 = arith.subf %3711, %3712 : f32
        %3714 = math.exp2 %3713 fastmath<fast> : f32
        %coord_10581 = cute.make_coord() : () -> !cute.coord<"3">
        %3715 = cute.memref.load(%rmem_1587, %coord_10581) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %3716 = arith.mulf %3715, %3714 : f32
        %3717 = arith.addf %3716, %3710 : f32
        %coord_10582 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10583 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10584 = cute.crd2idx(%coord_10582, %lay_10583) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10585 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10586 = cute.add_offset(%iter_10585, %idx_10584) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10587 = cute.make_view(%ptr_10586) : !memref_rmem_f32_11
        %iter_10588 = cute.get_iter(%view_10587) : !memref_rmem_f32_11
        %lay_10589 = cute.get_layout(%view_10587) : !memref_rmem_f32_11
        %3718 = cute.get_shape(%lay_10589) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10590, %e1_10591 = cute.get_leaves(%3718) : !cute.shape<"((2,16))">
        %3719 = cute.memref.load_vec %view_10587, row_major : !memref_rmem_f32_11
        %3720 = vector.broadcast %3714 : f32 to vector<32xf32>
        %3721 = arith.mulf %3719, %3720 : vector<32xf32>
        %coord_10592 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10593 = cute.get_layout(%view_10344) : !memref_rmem_f32_5
        %idx_10594 = cute.crd2idx(%coord_10592, %lay_10593) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10595 = cute.get_iter(%view_10344) : !memref_rmem_f32_5
        %ptr_10596 = cute.add_offset(%iter_10595, %idx_10594) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10597 = cute.make_view(%ptr_10596) : !memref_rmem_f32_11
        %iter_10598 = cute.get_iter(%view_10597) : !memref_rmem_f32_11
        %lay_10599 = cute.get_layout(%view_10597) : !memref_rmem_f32_11
        %3722 = cute.get_shape(%lay_10599) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10600, %e1_10601 = cute.get_leaves(%3722) : !cute.shape<"((2,16))">
        %int_tuple_10602 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10603 = cute.size(%int_tuple_10602) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10604 = cute.get_leaves(%sz_10603) : !cute.int_tuple<"32">
        %int_tuple_10605 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10606 = cute.size(%int_tuple_10605) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10607 = cute.get_leaves(%sz_10606) : !cute.int_tuple<"32">
        cute.memref.store_vec %3721, %view_10597, row_major : !memref_rmem_f32_11
        %coord_10608 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1582, %coord_10608, %3703) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10609 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1587, %coord_10609, %3717) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10610 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10611 = cute.get_layout(%view_10298) : !memref_rmem_f32_4
        %idx_10612 = cute.crd2idx(%coord_10610, %lay_10611) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10613 = cute.get_iter(%view_10298) : !memref_rmem_f32_4
        %ptr_10614 = cute.add_offset(%iter_10613, %idx_10612) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10615 = cute.make_view(%ptr_10614) : !memref_rmem_f32_7
        %iter_10616 = cute.get_iter(%view_10615) : !memref_rmem_f32_7
        %lay_10617 = cute.get_layout(%view_10615) : !memref_rmem_f32_7
        %3723 = cute.get_shape(%lay_10617) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10618, %e1_10619 = cute.get_leaves(%3723) : !cute.shape<"((2,8))">
        %int_tuple_10620 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10621 = cute.size(%int_tuple_10620) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10622 = cute.get_leaves(%sz_10621) : !cute.int_tuple<"16">
        %int_tuple_10623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10624 = cute.size(%int_tuple_10623) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10625 = cute.get_leaves(%sz_10624) : !cute.int_tuple<"16">
        cute.memref.store_vec %3709, %view_10615, row_major : !memref_rmem_f32_7
        %lay_10626 = cute.get_layout(%rmem_8539) : !memref_rmem_f32_2
        %lay_10627 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_10628 = cute.memref.alloca(%lay_10627) : !memref_rmem_bf16_16
        %iter_10629 = cute.get_iter(%rmem_10628) : !memref_rmem_bf16_16
        %iter_10630 = cute.get_iter(%rmem_10628) : !memref_rmem_bf16_16
        %3724 = cute.memref.load_vec %rmem_8539, row_major : !memref_rmem_f32_2
        %3725 = arith.truncf %3724 : vector<64xf32> to vector<64xbf16>
        %lay_10631 = cute.get_layout(%rmem_10628) : !memref_rmem_bf16_16
        %3726 = cute.get_shape(%lay_10631) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10632, %e1_10633, %e2_10634, %e3_10635 = cute.get_leaves(%3726) : !cute.shape<"((2,2),2,8)">
        %int_tuple_10636 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10637 = cute.size(%int_tuple_10636) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10638 = cute.get_leaves(%sz_10637) : !cute.int_tuple<"64">
        %int_tuple_10639 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10640 = cute.size(%int_tuple_10639) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10641 = cute.get_leaves(%sz_10640) : !cute.int_tuple<"64">
        cute.memref.store_vec %3725, %rmem_10628, row_major : !memref_rmem_bf16_16
        %lay_10642 = cute.get_layout(%rmem_10628) : !memref_rmem_bf16_16
        %tile_10643 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_10644 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
        %3727 = cute.get_shape(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10645, %e1_10646, %e2_10647, %e3_10648, %e4_10649 = cute.get_leaves(%3727) : !cute.shape<"((2,2),2,(2,4))">
        %3728 = cute.get_shape(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10650, %e1_10651, %e2_10652, %e3_10653, %e4_10654 = cute.get_leaves(%3728) : !cute.shape<"((2,2),2,(2,4))">
        %3729 = cute.get_shape(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10655, %e1_10656, %e2_10657, %e3_10658, %e4_10659 = cute.get_leaves(%3729) : !cute.shape<"((2,2),2,(2,4))">
        %3730 = cute.get_shape(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10660, %e1_10661, %e2_10662, %e3_10663, %e4_10664 = cute.get_leaves(%3730) : !cute.shape<"((2,2),2,(2,4))">
        %3731 = cute.get_stride(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10665, %e1_10666, %e2_10667, %e3_10668, %e4_10669 = cute.get_leaves(%3731) : !cute.stride<"((1,2),4,(8,16))">
        %3732 = cute.get_stride(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10670, %e1_10671, %e2_10672, %e3_10673, %e4_10674 = cute.get_leaves(%3732) : !cute.stride<"((1,2),4,(8,16))">
        %3733 = cute.get_stride(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10675, %e1_10676, %e2_10677, %e3_10678, %e4_10679 = cute.get_leaves(%3733) : !cute.stride<"((1,2),4,(8,16))">
        %3734 = cute.get_stride(%lay_10644) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10680, %e1_10681, %e2_10682, %e3_10683, %e4_10684 = cute.get_leaves(%3734) : !cute.stride<"((1,2),4,(8,16))">
        %shape_10685 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
        %stride_10686 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
        %lay_10687 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
        %view_10688 = cute.make_view(%iter_10630, %lay_10687) : !memref_rmem_bf16_17
        %iter_10689 = cute.get_iter(%view_10688) : !memref_rmem_bf16_17
        %coord_10690 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10691 = cute.get_layout(%view_859) : !memref_smem_bf16_10
        %3735:2 = cute.get_scalars(%lay_10691) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_10692 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_10693 = cute.assume(%3735#0) : (i32) -> !cute.i32<divby 16>
        %iv_10694 = cute.assume(%3735#1) : (i32) -> !cute.i32<divby 32>
        %stride_10695 = cute.make_stride(%iv_10693, %iv_10694) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_10696 = cute.make_layout(%shape_10692, %stride_10695) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_10697 = cute.crd2idx(%coord_10690, %lay_10691) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_10698 = cute.get_iter(%view_859) : !memref_smem_bf16_10
        %ptr_10699 = cute.add_offset(%iter_10698, %idx_10697) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10700 = cute.make_view(%ptr_10699, %lay_10696) : !memref_smem_bf16_19
        %iter_10701 = cute.get_iter(%view_10700) : !memref_smem_bf16_19
        %coord_10702 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10703 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
        %idx_10704 = cute.crd2idx(%coord_10702, %lay_10703) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_10705 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
        %ptr_10706 = cute.add_offset(%iter_10705, %idx_10704) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10707 = cute.make_view(%ptr_10706) : !memref_rmem_bf16_18
        %iter_10708 = cute.get_iter(%view_10707) : !memref_rmem_bf16_18
        %lay_10709 = cute.get_layout(%view_10700) : !memref_smem_bf16_19
        %3736 = cute.get_shape(%lay_10709) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10710, %e1_10711, %e2_10712, %e3_10713, %e4_10714 = cute.get_leaves(%3736) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10715 = cute.get_layout(%view_10707) : !memref_rmem_bf16_18
        %3737 = cute.get_shape(%lay_10715) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10716, %e1_10717, %e2_10718, %e3_10719 = cute.get_leaves(%3737) : !cute.shape<"((8,1),(4,2))">
        %lay_10720 = cute.get_layout(%view_10700) : !memref_smem_bf16_19
        %shape_10721 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10722 = cute.make_layout() : !cute.layout<"1:0">
        %append_10723 = cute.append_to_rank<2> (%lay_10720, %lay_10722) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10724 = cute.make_view(%iter_10701, %append_10723) : !memref_smem_bf16_19
        %iter_10725 = cute.get_iter(%view_10724) : !memref_smem_bf16_19
        %lay_10726 = cute.get_layout(%view_10724) : !memref_smem_bf16_19
        %3738 = cute.get_shape(%lay_10726) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10727, %e1_10728, %e2_10729, %e3_10730, %e4_10731 = cute.get_leaves(%3738) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10732 = cute.get_iter(%view_10724) : !memref_smem_bf16_19
        %lay_10733 = cute.get_layout(%view_10724) : !memref_smem_bf16_19
        %3739:2 = cute.get_scalars(%lay_10733) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10734 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10735 = cute.assume(%3739#0) : (i32) -> !cute.i32<divby 16>
        %iv_10736 = cute.assume(%3739#1) : (i32) -> !cute.i32<divby 32>
        %stride_10737 = cute.make_stride(%iv_10735, %iv_10736) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10738 = cute.make_layout(%shape_10734, %stride_10737) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10739 = cute.make_view(%iter_10732, %lay_10738) : !memref_smem_bf16_20
        %iter_10740 = cute.get_iter(%view_10739) : !memref_smem_bf16_20
        %iter_10741 = cute.get_iter(%view_10739) : !memref_smem_bf16_20
        %lay_10742 = cute.get_layout(%view_10707) : !memref_rmem_bf16_18
        %shape_10743 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10744 = cute.make_layout() : !cute.layout<"1:0">
        %append_10745 = cute.append_to_rank<2> (%lay_10742, %lay_10744) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10746 = cute.make_view(%iter_10708, %append_10745) : !memref_rmem_bf16_18
        %iter_10747 = cute.get_iter(%view_10746) : !memref_rmem_bf16_18
        %lay_10748 = cute.get_layout(%view_10746) : !memref_rmem_bf16_18
        %3740 = cute.get_shape(%lay_10748) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10749, %e1_10750, %e2_10751, %e3_10752 = cute.get_leaves(%3740) : !cute.shape<"((8,1),(4,2))">
        %iter_10753 = cute.get_iter(%view_10746) : !memref_rmem_bf16_18
        %view_10754 = cute.make_view(%iter_10753) : !memref_rmem_bf16_19
        %iter_10755 = cute.get_iter(%view_10754) : !memref_rmem_bf16_19
        %iter_10756 = cute.get_iter(%view_10754) : !memref_rmem_bf16_19
        %lay_10757 = cute.get_layout(%view_10739) : !memref_smem_bf16_20
        %3741 = cute.get_shape(%lay_10757) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10758, %e1_10759, %e2_10760, %e3_10761, %e4_10762 = cute.get_leaves(%3741) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10763 = cute.get_layout(%view_10754) : !memref_rmem_bf16_19
        %3742 = cute.get_shape(%lay_10763) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10764, %e1_10765, %e2_10766, %e3_10767 = cute.get_leaves(%3742) : !cute.shape<"((8,1),((4,2)))">
        %lay_10768 = cute.get_layout(%view_10739) : !memref_smem_bf16_20
        %sz_10769 = cute.size(%lay_10768) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10770 = cute.get_leaves(%sz_10769) : !cute.int_tuple<"8">
        %lay_10771 = cute.get_layout(%view_10754) : !memref_rmem_bf16_19
        %sz_10772 = cute.size(%lay_10771) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10773 = cute.get_leaves(%sz_10772) : !cute.int_tuple<"8">
        %3743 = cute.static : !cute.layout<"1:0">
        %iter_10774 = cute.get_iter(%view_10739) : !memref_smem_bf16_20
        %iter_10775 = cute.get_iter(%view_10754) : !memref_rmem_bf16_19
        %lay_10776 = cute.get_layout(%view_10739) : !memref_smem_bf16_20
        %lay_10777 = cute.get_layout(%view_10754) : !memref_rmem_bf16_19
        %append_10778 = cute.append_to_rank<2> (%lay_10776, %3743) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10779 = cute.append_to_rank<2> (%lay_10777, %3743) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3744:2 = cute.get_scalars(%append_10778) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10780 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10781 = cute.assume(%3744#0) : (i32) -> !cute.i32<divby 16>
        %iv_10782 = cute.assume(%3744#1) : (i32) -> !cute.i32<divby 32>
        %stride_10783 = cute.make_stride(%iv_10781, %iv_10782) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10784 = cute.make_layout(%shape_10780, %stride_10783) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10785 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10786 = cute.size(%lay_10784) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3745 = cute.get_scalars(%sz_10786) : !cute.int_tuple<"8">
        %c0_i32_10787 = arith.constant 0 : i32
        %c1_i32_10788 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10787 to %3745 step %c1_i32_10788  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816:2 = cute.get_scalars(%lay_10784) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10784) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11370 = cute.add_offset(%iter_10774, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3818 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10785) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_10775, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3820 = llvm.mlir.constant(0 : i32) : i32
          %3821 = vector.extractelement %3819[%3820 : i32] : vector<4xi32>
          %3822 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3821, %3822 : i32, !llvm.ptr
          %3823 = llvm.mlir.constant(1 : i32) : i32
          %3824 = vector.extractelement %3819[%3823 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3825 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3824, %3825 : i32, !llvm.ptr
          %3826 = llvm.mlir.constant(2 : i32) : i32
          %3827 = vector.extractelement %3819[%3826 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3828 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3827, %3828 : i32, !llvm.ptr
          %3829 = llvm.mlir.constant(3 : i32) : i32
          %3830 = vector.extractelement %3819[%3829 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3831 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3830, %3831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10789 = cute.get_layout(%view_10688) : !memref_rmem_bf16_17
        %3746 = cute.get_shape(%lay_10789) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
        %e0_10790, %e1_10791, %e2_10792, %e3_10793, %e4_10794 = cute.get_leaves(%3746) : !cute.shape<"(((2,2),2),2,4)">
        %int_tuple_10795 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10796 = cute.size(%int_tuple_10795) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10797 = cute.get_leaves(%sz_10796) : !cute.int_tuple<"4">
        %int_tuple_10798 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10799 = cute.size(%int_tuple_10798) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10800 = cute.get_leaves(%sz_10799) : !cute.int_tuple<"4">
        %coord_10801 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10802 = cute.get_layout(%view_859) : !memref_smem_bf16_10
        %3747:2 = cute.get_scalars(%lay_10802) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_10803 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_10804 = cute.assume(%3747#0) : (i32) -> !cute.i32<divby 16>
        %iv_10805 = cute.assume(%3747#1) : (i32) -> !cute.i32<divby 32>
        %stride_10806 = cute.make_stride(%iv_10804, %iv_10805) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_10807 = cute.make_layout(%shape_10803, %stride_10806) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_10808 = cute.crd2idx(%coord_10801, %lay_10802) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
        %iter_10809 = cute.get_iter(%view_859) : !memref_smem_bf16_10
        %ptr_10810 = cute.add_offset(%iter_10809, %idx_10808) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10811 = cute.make_view(%ptr_10810, %lay_10807) : !memref_smem_bf16_19
        %iter_10812 = cute.get_iter(%view_10811) : !memref_smem_bf16_19
        %coord_10813 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10814 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
        %idx_10815 = cute.crd2idx(%coord_10813, %lay_10814) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
        %iter_10816 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
        %ptr_10817 = cute.add_offset(%iter_10816, %idx_10815) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10818 = cute.make_view(%ptr_10817) : !memref_rmem_bf16_18
        %iter_10819 = cute.get_iter(%view_10818) : !memref_rmem_bf16_18
        %lay_10820 = cute.get_layout(%view_10811) : !memref_smem_bf16_19
        %3748 = cute.get_shape(%lay_10820) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10821, %e1_10822, %e2_10823, %e3_10824, %e4_10825 = cute.get_leaves(%3748) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10826 = cute.get_layout(%view_10818) : !memref_rmem_bf16_18
        %3749 = cute.get_shape(%lay_10826) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10827, %e1_10828, %e2_10829, %e3_10830 = cute.get_leaves(%3749) : !cute.shape<"((8,1),(4,2))">
        %lay_10831 = cute.get_layout(%view_10811) : !memref_smem_bf16_19
        %shape_10832 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10833 = cute.make_layout() : !cute.layout<"1:0">
        %append_10834 = cute.append_to_rank<2> (%lay_10831, %lay_10833) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10835 = cute.make_view(%iter_10812, %append_10834) : !memref_smem_bf16_19
        %iter_10836 = cute.get_iter(%view_10835) : !memref_smem_bf16_19
        %lay_10837 = cute.get_layout(%view_10835) : !memref_smem_bf16_19
        %3750 = cute.get_shape(%lay_10837) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10838, %e1_10839, %e2_10840, %e3_10841, %e4_10842 = cute.get_leaves(%3750) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10843 = cute.get_iter(%view_10835) : !memref_smem_bf16_19
        %lay_10844 = cute.get_layout(%view_10835) : !memref_smem_bf16_19
        %3751:2 = cute.get_scalars(%lay_10844) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10845 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10846 = cute.assume(%3751#0) : (i32) -> !cute.i32<divby 16>
        %iv_10847 = cute.assume(%3751#1) : (i32) -> !cute.i32<divby 32>
        %stride_10848 = cute.make_stride(%iv_10846, %iv_10847) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10849 = cute.make_layout(%shape_10845, %stride_10848) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10850 = cute.make_view(%iter_10843, %lay_10849) : !memref_smem_bf16_20
        %iter_10851 = cute.get_iter(%view_10850) : !memref_smem_bf16_20
        %iter_10852 = cute.get_iter(%view_10850) : !memref_smem_bf16_20
        %lay_10853 = cute.get_layout(%view_10818) : !memref_rmem_bf16_18
        %shape_10854 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10855 = cute.make_layout() : !cute.layout<"1:0">
        %append_10856 = cute.append_to_rank<2> (%lay_10853, %lay_10855) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10857 = cute.make_view(%iter_10819, %append_10856) : !memref_rmem_bf16_18
        %iter_10858 = cute.get_iter(%view_10857) : !memref_rmem_bf16_18
        %lay_10859 = cute.get_layout(%view_10857) : !memref_rmem_bf16_18
        %3752 = cute.get_shape(%lay_10859) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10860, %e1_10861, %e2_10862, %e3_10863 = cute.get_leaves(%3752) : !cute.shape<"((8,1),(4,2))">
        %iter_10864 = cute.get_iter(%view_10857) : !memref_rmem_bf16_18
        %view_10865 = cute.make_view(%iter_10864) : !memref_rmem_bf16_19
        %iter_10866 = cute.get_iter(%view_10865) : !memref_rmem_bf16_19
        %iter_10867 = cute.get_iter(%view_10865) : !memref_rmem_bf16_19
        %lay_10868 = cute.get_layout(%view_10850) : !memref_smem_bf16_20
        %3753 = cute.get_shape(%lay_10868) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10869, %e1_10870, %e2_10871, %e3_10872, %e4_10873 = cute.get_leaves(%3753) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10874 = cute.get_layout(%view_10865) : !memref_rmem_bf16_19
        %3754 = cute.get_shape(%lay_10874) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10875, %e1_10876, %e2_10877, %e3_10878 = cute.get_leaves(%3754) : !cute.shape<"((8,1),((4,2)))">
        %lay_10879 = cute.get_layout(%view_10850) : !memref_smem_bf16_20
        %sz_10880 = cute.size(%lay_10879) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10881 = cute.get_leaves(%sz_10880) : !cute.int_tuple<"8">
        %lay_10882 = cute.get_layout(%view_10865) : !memref_rmem_bf16_19
        %sz_10883 = cute.size(%lay_10882) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10884 = cute.get_leaves(%sz_10883) : !cute.int_tuple<"8">
        %3755 = cute.static : !cute.layout<"1:0">
        %iter_10885 = cute.get_iter(%view_10850) : !memref_smem_bf16_20
        %iter_10886 = cute.get_iter(%view_10865) : !memref_rmem_bf16_19
        %lay_10887 = cute.get_layout(%view_10850) : !memref_smem_bf16_20
        %lay_10888 = cute.get_layout(%view_10865) : !memref_rmem_bf16_19
        %append_10889 = cute.append_to_rank<2> (%lay_10887, %3755) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10890 = cute.append_to_rank<2> (%lay_10888, %3755) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3756:2 = cute.get_scalars(%append_10889) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10891 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10892 = cute.assume(%3756#0) : (i32) -> !cute.i32<divby 16>
        %iv_10893 = cute.assume(%3756#1) : (i32) -> !cute.i32<divby 32>
        %stride_10894 = cute.make_stride(%iv_10892, %iv_10893) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10895 = cute.make_layout(%shape_10891, %stride_10894) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10896 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10897 = cute.size(%lay_10895) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3757 = cute.get_scalars(%sz_10897) : !cute.int_tuple<"8">
        %c0_i32_10898 = arith.constant 0 : i32
        %c1_i32_10899 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10898 to %3757 step %c1_i32_10899  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816:2 = cute.get_scalars(%lay_10895) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_10895) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11370 = cute.add_offset(%iter_10885, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3818 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_10896) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_10886, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3820 = llvm.mlir.constant(0 : i32) : i32
          %3821 = vector.extractelement %3819[%3820 : i32] : vector<4xi32>
          %3822 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3821, %3822 : i32, !llvm.ptr
          %3823 = llvm.mlir.constant(1 : i32) : i32
          %3824 = vector.extractelement %3819[%3823 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3825 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3824, %3825 : i32, !llvm.ptr
          %3826 = llvm.mlir.constant(2 : i32) : i32
          %3827 = vector.extractelement %3819[%3826 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3828 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3827, %3828 : i32, !llvm.ptr
          %3829 = llvm.mlir.constant(3 : i32) : i32
          %3830 = vector.extractelement %3819[%3829 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3831 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3830, %3831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10900 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10901 = cute.get_layout(%view_10688) : !memref_rmem_bf16_17
        %idx_10902 = cute.crd2idx(%coord_10900, %lay_10901) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
        %iter_10903 = cute.get_iter(%view_10688) : !memref_rmem_bf16_17
        %ptr_10904 = cute.add_offset(%iter_10903, %idx_10902) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10905 = cute.make_view(%ptr_10904) : !memref_rmem_bf16_20
        %iter_10906 = cute.get_iter(%view_10905) : !memref_rmem_bf16_20
        %coord_10907 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10908 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
        %idx_10909 = cute.crd2idx(%coord_10907, %lay_10908) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_10910 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
        %ptr_10911 = cute.add_offset(%iter_10910, %idx_10909) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10912 = cute.make_view(%ptr_10911) : !memref_rmem_bf16_21
        %iter_10913 = cute.get_iter(%view_10912) : !memref_rmem_bf16_21
        %lay_10914 = cute.get_layout(%view_10905) : !memref_rmem_bf16_20
        %3758 = cute.get_shape(%lay_10914) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10915, %e1_10916, %e2_10917, %e3_10918 = cute.get_leaves(%3758) : !cute.shape<"(((2,2),2),2)">
        %lay_10919 = cute.get_layout(%view_10912) : !memref_rmem_bf16_21
        %3759 = cute.get_shape(%lay_10919) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10920, %e1_10921, %e2_10922, %e3_10923 = cute.get_leaves(%3759) : !cute.shape<"((2,2),(8,2))">
        %lay_10924 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3760 = cute.get_shape(%lay_10924) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10925, %e1_10926, %e2_10927, %e3_10928 = cute.get_leaves(%3760) : !cute.shape<"((2,2),2,16)">
        %iter_10929 = cute.get_iter(%view_10905) : !memref_rmem_bf16_20
        %iter_10930 = cute.get_iter(%view_10912) : !memref_rmem_bf16_21
        %iter_10931 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %iter_10932 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %lay_10933 = cute.get_layout(%view_10905) : !memref_rmem_bf16_20
        %lay_10934 = cute.get_layout(%view_10912) : !memref_rmem_bf16_21
        %lay_10935 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %lay_10936 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3761 = cute.static : !cute.layout<"1:0">
        %append_10937 = cute.append_to_rank<3> (%lay_10933, %3761) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10938 = cute.append_to_rank<3> (%lay_10934, %3761) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10939 = cute.size(%append_10937) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10940 = cute.size(%append_10937) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10941 = cute.size(%append_10938) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3762 = cute.get_scalars(%sz_10939) : !cute.int_tuple<"1">
        %3763 = cute.get_scalars(%sz_10940) : !cute.int_tuple<"2">
        %3764 = cute.get_scalars(%sz_10941) : !cute.int_tuple<"16">
        %c0_i32_10942 = arith.constant 0 : i32
        %c1_i32_10943 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10942 to %3762 step %c1_i32_10943  : i32 {
          scf.for %arg14 = %c0_i32_10942 to %3763 step %c1_i32_10943  : i32 {
            scf.for %arg15 = %c0_i32_10942 to %3764 step %c1_i32_10943  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_10937) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11372 = cute.add_offset(%iter_10929, %idx_11371) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_22
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_10938) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_10930, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_10935) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_10931, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_10936) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_10932, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_22
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10944 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10945 = cute.size(%int_tuple_10944) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10946 = cute.get_leaves(%sz_10945) : !cute.int_tuple<"4">
        %coord_10947 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10948 = cute.get_layout(%view_859) : !memref_smem_bf16_10
        %3765:2 = cute.get_scalars(%lay_10948) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_10949 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_10950 = cute.assume(%3765#0) : (i32) -> !cute.i32<divby 16>
        %iv_10951 = cute.assume(%3765#1) : (i32) -> !cute.i32<divby 32>
        %stride_10952 = cute.make_stride(%iv_10950, %iv_10951) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_10953 = cute.make_layout(%shape_10949, %stride_10952) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_10954 = cute.crd2idx(%coord_10947, %lay_10948) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
        %iter_10955 = cute.get_iter(%view_859) : !memref_smem_bf16_10
        %ptr_10956 = cute.add_offset(%iter_10955, %idx_10954) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10957 = cute.make_view(%ptr_10956, %lay_10953) : !memref_smem_bf16_19
        %iter_10958 = cute.get_iter(%view_10957) : !memref_smem_bf16_19
        %coord_10959 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10960 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
        %idx_10961 = cute.crd2idx(%coord_10959, %lay_10960) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
        %iter_10962 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
        %ptr_10963 = cute.add_offset(%iter_10962, %idx_10961) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10964 = cute.make_view(%ptr_10963) : !memref_rmem_bf16_18
        %iter_10965 = cute.get_iter(%view_10964) : !memref_rmem_bf16_18
        %lay_10966 = cute.get_layout(%view_10957) : !memref_smem_bf16_19
        %3766 = cute.get_shape(%lay_10966) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10967, %e1_10968, %e2_10969, %e3_10970, %e4_10971 = cute.get_leaves(%3766) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10972 = cute.get_layout(%view_10964) : !memref_rmem_bf16_18
        %3767 = cute.get_shape(%lay_10972) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10973, %e1_10974, %e2_10975, %e3_10976 = cute.get_leaves(%3767) : !cute.shape<"((8,1),(4,2))">
        %lay_10977 = cute.get_layout(%view_10957) : !memref_smem_bf16_19
        %shape_10978 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10979 = cute.make_layout() : !cute.layout<"1:0">
        %append_10980 = cute.append_to_rank<2> (%lay_10977, %lay_10979) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10981 = cute.make_view(%iter_10958, %append_10980) : !memref_smem_bf16_19
        %iter_10982 = cute.get_iter(%view_10981) : !memref_smem_bf16_19
        %lay_10983 = cute.get_layout(%view_10981) : !memref_smem_bf16_19
        %3768 = cute.get_shape(%lay_10983) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10984, %e1_10985, %e2_10986, %e3_10987, %e4_10988 = cute.get_leaves(%3768) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10989 = cute.get_iter(%view_10981) : !memref_smem_bf16_19
        %lay_10990 = cute.get_layout(%view_10981) : !memref_smem_bf16_19
        %3769:2 = cute.get_scalars(%lay_10990) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10991 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10992 = cute.assume(%3769#0) : (i32) -> !cute.i32<divby 16>
        %iv_10993 = cute.assume(%3769#1) : (i32) -> !cute.i32<divby 32>
        %stride_10994 = cute.make_stride(%iv_10992, %iv_10993) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10995 = cute.make_layout(%shape_10991, %stride_10994) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10996 = cute.make_view(%iter_10989, %lay_10995) : !memref_smem_bf16_20
        %iter_10997 = cute.get_iter(%view_10996) : !memref_smem_bf16_20
        %iter_10998 = cute.get_iter(%view_10996) : !memref_smem_bf16_20
        %lay_10999 = cute.get_layout(%view_10964) : !memref_rmem_bf16_18
        %shape_11000 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11001 = cute.make_layout() : !cute.layout<"1:0">
        %append_11002 = cute.append_to_rank<2> (%lay_10999, %lay_11001) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11003 = cute.make_view(%iter_10965, %append_11002) : !memref_rmem_bf16_18
        %iter_11004 = cute.get_iter(%view_11003) : !memref_rmem_bf16_18
        %lay_11005 = cute.get_layout(%view_11003) : !memref_rmem_bf16_18
        %3770 = cute.get_shape(%lay_11005) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11006, %e1_11007, %e2_11008, %e3_11009 = cute.get_leaves(%3770) : !cute.shape<"((8,1),(4,2))">
        %iter_11010 = cute.get_iter(%view_11003) : !memref_rmem_bf16_18
        %view_11011 = cute.make_view(%iter_11010) : !memref_rmem_bf16_19
        %iter_11012 = cute.get_iter(%view_11011) : !memref_rmem_bf16_19
        %iter_11013 = cute.get_iter(%view_11011) : !memref_rmem_bf16_19
        %lay_11014 = cute.get_layout(%view_10996) : !memref_smem_bf16_20
        %3771 = cute.get_shape(%lay_11014) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11015, %e1_11016, %e2_11017, %e3_11018, %e4_11019 = cute.get_leaves(%3771) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11020 = cute.get_layout(%view_11011) : !memref_rmem_bf16_19
        %3772 = cute.get_shape(%lay_11020) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11021, %e1_11022, %e2_11023, %e3_11024 = cute.get_leaves(%3772) : !cute.shape<"((8,1),((4,2)))">
        %lay_11025 = cute.get_layout(%view_10996) : !memref_smem_bf16_20
        %sz_11026 = cute.size(%lay_11025) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11027 = cute.get_leaves(%sz_11026) : !cute.int_tuple<"8">
        %lay_11028 = cute.get_layout(%view_11011) : !memref_rmem_bf16_19
        %sz_11029 = cute.size(%lay_11028) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11030 = cute.get_leaves(%sz_11029) : !cute.int_tuple<"8">
        %3773 = cute.static : !cute.layout<"1:0">
        %iter_11031 = cute.get_iter(%view_10996) : !memref_smem_bf16_20
        %iter_11032 = cute.get_iter(%view_11011) : !memref_rmem_bf16_19
        %lay_11033 = cute.get_layout(%view_10996) : !memref_smem_bf16_20
        %lay_11034 = cute.get_layout(%view_11011) : !memref_rmem_bf16_19
        %append_11035 = cute.append_to_rank<2> (%lay_11033, %3773) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11036 = cute.append_to_rank<2> (%lay_11034, %3773) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3774:2 = cute.get_scalars(%append_11035) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11037 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11038 = cute.assume(%3774#0) : (i32) -> !cute.i32<divby 16>
        %iv_11039 = cute.assume(%3774#1) : (i32) -> !cute.i32<divby 32>
        %stride_11040 = cute.make_stride(%iv_11038, %iv_11039) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11041 = cute.make_layout(%shape_11037, %stride_11040) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11042 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11043 = cute.size(%lay_11041) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3775 = cute.get_scalars(%sz_11043) : !cute.int_tuple<"8">
        %c0_i32_11044 = arith.constant 0 : i32
        %c1_i32_11045 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11044 to %3775 step %c1_i32_11045  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816:2 = cute.get_scalars(%lay_11041) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_11041) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11370 = cute.add_offset(%iter_11031, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3818 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_11042) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_11032, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3820 = llvm.mlir.constant(0 : i32) : i32
          %3821 = vector.extractelement %3819[%3820 : i32] : vector<4xi32>
          %3822 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3821, %3822 : i32, !llvm.ptr
          %3823 = llvm.mlir.constant(1 : i32) : i32
          %3824 = vector.extractelement %3819[%3823 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3825 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3824, %3825 : i32, !llvm.ptr
          %3826 = llvm.mlir.constant(2 : i32) : i32
          %3827 = vector.extractelement %3819[%3826 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3828 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3827, %3828 : i32, !llvm.ptr
          %3829 = llvm.mlir.constant(3 : i32) : i32
          %3830 = vector.extractelement %3819[%3829 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3831 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3830, %3831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11046 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_11047 = cute.get_layout(%view_10688) : !memref_rmem_bf16_17
        %idx_11048 = cute.crd2idx(%coord_11046, %lay_11047) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
        %iter_11049 = cute.get_iter(%view_10688) : !memref_rmem_bf16_17
        %ptr_11050 = cute.add_offset(%iter_11049, %idx_11048) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11051 = cute.make_view(%ptr_11050) : !memref_rmem_bf16_20
        %iter_11052 = cute.get_iter(%view_11051) : !memref_rmem_bf16_20
        %coord_11053 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_11054 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
        %idx_11055 = cute.crd2idx(%coord_11053, %lay_11054) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_11056 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
        %ptr_11057 = cute.add_offset(%iter_11056, %idx_11055) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11058 = cute.make_view(%ptr_11057) : !memref_rmem_bf16_21
        %iter_11059 = cute.get_iter(%view_11058) : !memref_rmem_bf16_21
        %lay_11060 = cute.get_layout(%view_11051) : !memref_rmem_bf16_20
        %3776 = cute.get_shape(%lay_11060) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11061, %e1_11062, %e2_11063, %e3_11064 = cute.get_leaves(%3776) : !cute.shape<"(((2,2),2),2)">
        %lay_11065 = cute.get_layout(%view_11058) : !memref_rmem_bf16_21
        %3777 = cute.get_shape(%lay_11065) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11066, %e1_11067, %e2_11068, %e3_11069 = cute.get_leaves(%3777) : !cute.shape<"((2,2),(8,2))">
        %iter_11070 = cute.get_iter(%view_11051) : !memref_rmem_bf16_20
        %iter_11071 = cute.get_iter(%view_11058) : !memref_rmem_bf16_21
        %iter_11072 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %iter_11073 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %lay_11074 = cute.get_layout(%view_11051) : !memref_rmem_bf16_20
        %lay_11075 = cute.get_layout(%view_11058) : !memref_rmem_bf16_21
        %lay_11076 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %lay_11077 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3778 = cute.static : !cute.layout<"1:0">
        %append_11078 = cute.append_to_rank<3> (%lay_11074, %3778) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11079 = cute.append_to_rank<3> (%lay_11075, %3778) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11080 = cute.size(%append_11078) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11081 = cute.size(%append_11078) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11082 = cute.size(%append_11079) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3779 = cute.get_scalars(%sz_11080) : !cute.int_tuple<"1">
        %3780 = cute.get_scalars(%sz_11081) : !cute.int_tuple<"2">
        %3781 = cute.get_scalars(%sz_11082) : !cute.int_tuple<"16">
        %c0_i32_11083 = arith.constant 0 : i32
        %c1_i32_11084 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11083 to %3779 step %c1_i32_11084  : i32 {
          scf.for %arg14 = %c0_i32_11083 to %3780 step %c1_i32_11084  : i32 {
            scf.for %arg15 = %c0_i32_11083 to %3781 step %c1_i32_11084  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_11078) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11372 = cute.add_offset(%iter_11070, %idx_11371) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_22
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_11079) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_11071, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_11076) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_11072, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_11077) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_11073, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_22
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_11085 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_11086 = cute.size(%int_tuple_11085) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_11087 = cute.get_leaves(%sz_11086) : !cute.int_tuple<"4">
        %coord_11088 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11089 = cute.get_layout(%view_859) : !memref_smem_bf16_10
        %3782:2 = cute.get_scalars(%lay_11089) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_11090 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_11091 = cute.assume(%3782#0) : (i32) -> !cute.i32<divby 16>
        %iv_11092 = cute.assume(%3782#1) : (i32) -> !cute.i32<divby 32>
        %stride_11093 = cute.make_stride(%iv_11091, %iv_11092) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_11094 = cute.make_layout(%shape_11090, %stride_11093) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_11095 = cute.crd2idx(%coord_11088, %lay_11089) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
        %iter_11096 = cute.get_iter(%view_859) : !memref_smem_bf16_10
        %ptr_11097 = cute.add_offset(%iter_11096, %idx_11095) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_11098 = cute.make_view(%ptr_11097, %lay_11094) : !memref_smem_bf16_19
        %iter_11099 = cute.get_iter(%view_11098) : !memref_smem_bf16_19
        %coord_11100 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11101 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
        %idx_11102 = cute.crd2idx(%coord_11100, %lay_11101) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
        %iter_11103 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
        %ptr_11104 = cute.add_offset(%iter_11103, %idx_11102) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11105 = cute.make_view(%ptr_11104) : !memref_rmem_bf16_18
        %iter_11106 = cute.get_iter(%view_11105) : !memref_rmem_bf16_18
        %lay_11107 = cute.get_layout(%view_11098) : !memref_smem_bf16_19
        %3783 = cute.get_shape(%lay_11107) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11108, %e1_11109, %e2_11110, %e3_11111, %e4_11112 = cute.get_leaves(%3783) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11113 = cute.get_layout(%view_11105) : !memref_rmem_bf16_18
        %3784 = cute.get_shape(%lay_11113) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11114, %e1_11115, %e2_11116, %e3_11117 = cute.get_leaves(%3784) : !cute.shape<"((8,1),(4,2))">
        %lay_11118 = cute.get_layout(%view_11098) : !memref_smem_bf16_19
        %shape_11119 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11120 = cute.make_layout() : !cute.layout<"1:0">
        %append_11121 = cute.append_to_rank<2> (%lay_11118, %lay_11120) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11122 = cute.make_view(%iter_11099, %append_11121) : !memref_smem_bf16_19
        %iter_11123 = cute.get_iter(%view_11122) : !memref_smem_bf16_19
        %lay_11124 = cute.get_layout(%view_11122) : !memref_smem_bf16_19
        %3785 = cute.get_shape(%lay_11124) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11125, %e1_11126, %e2_11127, %e3_11128, %e4_11129 = cute.get_leaves(%3785) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11130 = cute.get_iter(%view_11122) : !memref_smem_bf16_19
        %lay_11131 = cute.get_layout(%view_11122) : !memref_smem_bf16_19
        %3786:2 = cute.get_scalars(%lay_11131) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11132 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11133 = cute.assume(%3786#0) : (i32) -> !cute.i32<divby 16>
        %iv_11134 = cute.assume(%3786#1) : (i32) -> !cute.i32<divby 32>
        %stride_11135 = cute.make_stride(%iv_11133, %iv_11134) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11136 = cute.make_layout(%shape_11132, %stride_11135) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11137 = cute.make_view(%iter_11130, %lay_11136) : !memref_smem_bf16_20
        %iter_11138 = cute.get_iter(%view_11137) : !memref_smem_bf16_20
        %iter_11139 = cute.get_iter(%view_11137) : !memref_smem_bf16_20
        %lay_11140 = cute.get_layout(%view_11105) : !memref_rmem_bf16_18
        %shape_11141 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11142 = cute.make_layout() : !cute.layout<"1:0">
        %append_11143 = cute.append_to_rank<2> (%lay_11140, %lay_11142) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11144 = cute.make_view(%iter_11106, %append_11143) : !memref_rmem_bf16_18
        %iter_11145 = cute.get_iter(%view_11144) : !memref_rmem_bf16_18
        %lay_11146 = cute.get_layout(%view_11144) : !memref_rmem_bf16_18
        %3787 = cute.get_shape(%lay_11146) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11147, %e1_11148, %e2_11149, %e3_11150 = cute.get_leaves(%3787) : !cute.shape<"((8,1),(4,2))">
        %iter_11151 = cute.get_iter(%view_11144) : !memref_rmem_bf16_18
        %view_11152 = cute.make_view(%iter_11151) : !memref_rmem_bf16_19
        %iter_11153 = cute.get_iter(%view_11152) : !memref_rmem_bf16_19
        %iter_11154 = cute.get_iter(%view_11152) : !memref_rmem_bf16_19
        %lay_11155 = cute.get_layout(%view_11137) : !memref_smem_bf16_20
        %3788 = cute.get_shape(%lay_11155) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11156, %e1_11157, %e2_11158, %e3_11159, %e4_11160 = cute.get_leaves(%3788) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11161 = cute.get_layout(%view_11152) : !memref_rmem_bf16_19
        %3789 = cute.get_shape(%lay_11161) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11162, %e1_11163, %e2_11164, %e3_11165 = cute.get_leaves(%3789) : !cute.shape<"((8,1),((4,2)))">
        %lay_11166 = cute.get_layout(%view_11137) : !memref_smem_bf16_20
        %sz_11167 = cute.size(%lay_11166) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11168 = cute.get_leaves(%sz_11167) : !cute.int_tuple<"8">
        %lay_11169 = cute.get_layout(%view_11152) : !memref_rmem_bf16_19
        %sz_11170 = cute.size(%lay_11169) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11171 = cute.get_leaves(%sz_11170) : !cute.int_tuple<"8">
        %3790 = cute.static : !cute.layout<"1:0">
        %iter_11172 = cute.get_iter(%view_11137) : !memref_smem_bf16_20
        %iter_11173 = cute.get_iter(%view_11152) : !memref_rmem_bf16_19
        %lay_11174 = cute.get_layout(%view_11137) : !memref_smem_bf16_20
        %lay_11175 = cute.get_layout(%view_11152) : !memref_rmem_bf16_19
        %append_11176 = cute.append_to_rank<2> (%lay_11174, %3790) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11177 = cute.append_to_rank<2> (%lay_11175, %3790) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3791:2 = cute.get_scalars(%append_11176) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11178 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11179 = cute.assume(%3791#0) : (i32) -> !cute.i32<divby 16>
        %iv_11180 = cute.assume(%3791#1) : (i32) -> !cute.i32<divby 32>
        %stride_11181 = cute.make_stride(%iv_11179, %iv_11180) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11182 = cute.make_layout(%shape_11178, %stride_11181) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11183 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11184 = cute.size(%lay_11182) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3792 = cute.get_scalars(%sz_11184) : !cute.int_tuple<"8">
        %c0_i32_11185 = arith.constant 0 : i32
        %c1_i32_11186 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11185 to %3792 step %c1_i32_11186  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816:2 = cute.get_scalars(%lay_11182) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_11182) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11370 = cute.add_offset(%iter_11172, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3818 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_11183) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_11173, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3820 = llvm.mlir.constant(0 : i32) : i32
          %3821 = vector.extractelement %3819[%3820 : i32] : vector<4xi32>
          %3822 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3821, %3822 : i32, !llvm.ptr
          %3823 = llvm.mlir.constant(1 : i32) : i32
          %3824 = vector.extractelement %3819[%3823 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3825 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3824, %3825 : i32, !llvm.ptr
          %3826 = llvm.mlir.constant(2 : i32) : i32
          %3827 = vector.extractelement %3819[%3826 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3828 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3827, %3828 : i32, !llvm.ptr
          %3829 = llvm.mlir.constant(3 : i32) : i32
          %3830 = vector.extractelement %3819[%3829 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3831 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3830, %3831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11187 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11188 = cute.get_layout(%view_10688) : !memref_rmem_bf16_17
        %idx_11189 = cute.crd2idx(%coord_11187, %lay_11188) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
        %iter_11190 = cute.get_iter(%view_10688) : !memref_rmem_bf16_17
        %ptr_11191 = cute.add_offset(%iter_11190, %idx_11189) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11192 = cute.make_view(%ptr_11191) : !memref_rmem_bf16_20
        %iter_11193 = cute.get_iter(%view_11192) : !memref_rmem_bf16_20
        %coord_11194 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11195 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
        %idx_11196 = cute.crd2idx(%coord_11194, %lay_11195) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_11197 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
        %ptr_11198 = cute.add_offset(%iter_11197, %idx_11196) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11199 = cute.make_view(%ptr_11198) : !memref_rmem_bf16_21
        %iter_11200 = cute.get_iter(%view_11199) : !memref_rmem_bf16_21
        %lay_11201 = cute.get_layout(%view_11192) : !memref_rmem_bf16_20
        %3793 = cute.get_shape(%lay_11201) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11202, %e1_11203, %e2_11204, %e3_11205 = cute.get_leaves(%3793) : !cute.shape<"(((2,2),2),2)">
        %lay_11206 = cute.get_layout(%view_11199) : !memref_rmem_bf16_21
        %3794 = cute.get_shape(%lay_11206) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11207, %e1_11208, %e2_11209, %e3_11210 = cute.get_leaves(%3794) : !cute.shape<"((2,2),(8,2))">
        %iter_11211 = cute.get_iter(%view_11192) : !memref_rmem_bf16_20
        %iter_11212 = cute.get_iter(%view_11199) : !memref_rmem_bf16_21
        %iter_11213 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %iter_11214 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %lay_11215 = cute.get_layout(%view_11192) : !memref_rmem_bf16_20
        %lay_11216 = cute.get_layout(%view_11199) : !memref_rmem_bf16_21
        %lay_11217 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %lay_11218 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3795 = cute.static : !cute.layout<"1:0">
        %append_11219 = cute.append_to_rank<3> (%lay_11215, %3795) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11220 = cute.append_to_rank<3> (%lay_11216, %3795) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11221 = cute.size(%append_11219) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11222 = cute.size(%append_11219) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11223 = cute.size(%append_11220) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3796 = cute.get_scalars(%sz_11221) : !cute.int_tuple<"1">
        %3797 = cute.get_scalars(%sz_11222) : !cute.int_tuple<"2">
        %3798 = cute.get_scalars(%sz_11223) : !cute.int_tuple<"16">
        %c0_i32_11224 = arith.constant 0 : i32
        %c1_i32_11225 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11224 to %3796 step %c1_i32_11225  : i32 {
          scf.for %arg14 = %c0_i32_11224 to %3797 step %c1_i32_11225  : i32 {
            scf.for %arg15 = %c0_i32_11224 to %3798 step %c1_i32_11225  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_11219) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11372 = cute.add_offset(%iter_11211, %idx_11371) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_22
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_11220) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_11212, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_11217) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_11213, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_11218) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_11214, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_22
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_11226 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_11227 = cute.size(%int_tuple_11226) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_11228 = cute.get_leaves(%sz_11227) : !cute.int_tuple<"4">
        %coord_11229 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11230 = cute.get_layout(%view_859) : !memref_smem_bf16_10
        %3799:2 = cute.get_scalars(%lay_11230) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_11231 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_11232 = cute.assume(%3799#0) : (i32) -> !cute.i32<divby 16>
        %iv_11233 = cute.assume(%3799#1) : (i32) -> !cute.i32<divby 32>
        %stride_11234 = cute.make_stride(%iv_11232, %iv_11233) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_11235 = cute.make_layout(%shape_11231, %stride_11234) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_11236 = cute.crd2idx(%coord_11229, %lay_11230) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_11237 = cute.get_iter(%view_859) : !memref_smem_bf16_10
        %ptr_11238 = cute.add_offset(%iter_11237, %idx_11236) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_11239 = cute.make_view(%ptr_11238, %lay_11235) : !memref_smem_bf16_19
        %iter_11240 = cute.get_iter(%view_11239) : !memref_smem_bf16_19
        %coord_11241 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11242 = cute.get_layout(%view_862) : !memref_rmem_bf16_5
        %idx_11243 = cute.crd2idx(%coord_11241, %lay_11242) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_11244 = cute.get_iter(%view_862) : !memref_rmem_bf16_5
        %ptr_11245 = cute.add_offset(%iter_11244, %idx_11243) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11246 = cute.make_view(%ptr_11245) : !memref_rmem_bf16_18
        %iter_11247 = cute.get_iter(%view_11246) : !memref_rmem_bf16_18
        %lay_11248 = cute.get_layout(%view_11239) : !memref_smem_bf16_19
        %3800 = cute.get_shape(%lay_11248) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11249, %e1_11250, %e2_11251, %e3_11252, %e4_11253 = cute.get_leaves(%3800) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11254 = cute.get_layout(%view_11246) : !memref_rmem_bf16_18
        %3801 = cute.get_shape(%lay_11254) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11255, %e1_11256, %e2_11257, %e3_11258 = cute.get_leaves(%3801) : !cute.shape<"((8,1),(4,2))">
        %lay_11259 = cute.get_layout(%view_11239) : !memref_smem_bf16_19
        %shape_11260 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11261 = cute.make_layout() : !cute.layout<"1:0">
        %append_11262 = cute.append_to_rank<2> (%lay_11259, %lay_11261) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11263 = cute.make_view(%iter_11240, %append_11262) : !memref_smem_bf16_19
        %iter_11264 = cute.get_iter(%view_11263) : !memref_smem_bf16_19
        %lay_11265 = cute.get_layout(%view_11263) : !memref_smem_bf16_19
        %3802 = cute.get_shape(%lay_11265) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11266, %e1_11267, %e2_11268, %e3_11269, %e4_11270 = cute.get_leaves(%3802) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11271 = cute.get_iter(%view_11263) : !memref_smem_bf16_19
        %lay_11272 = cute.get_layout(%view_11263) : !memref_smem_bf16_19
        %3803:2 = cute.get_scalars(%lay_11272) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11273 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11274 = cute.assume(%3803#0) : (i32) -> !cute.i32<divby 16>
        %iv_11275 = cute.assume(%3803#1) : (i32) -> !cute.i32<divby 32>
        %stride_11276 = cute.make_stride(%iv_11274, %iv_11275) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11277 = cute.make_layout(%shape_11273, %stride_11276) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11278 = cute.make_view(%iter_11271, %lay_11277) : !memref_smem_bf16_20
        %iter_11279 = cute.get_iter(%view_11278) : !memref_smem_bf16_20
        %iter_11280 = cute.get_iter(%view_11278) : !memref_smem_bf16_20
        %lay_11281 = cute.get_layout(%view_11246) : !memref_rmem_bf16_18
        %shape_11282 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11283 = cute.make_layout() : !cute.layout<"1:0">
        %append_11284 = cute.append_to_rank<2> (%lay_11281, %lay_11283) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11285 = cute.make_view(%iter_11247, %append_11284) : !memref_rmem_bf16_18
        %iter_11286 = cute.get_iter(%view_11285) : !memref_rmem_bf16_18
        %lay_11287 = cute.get_layout(%view_11285) : !memref_rmem_bf16_18
        %3804 = cute.get_shape(%lay_11287) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11288, %e1_11289, %e2_11290, %e3_11291 = cute.get_leaves(%3804) : !cute.shape<"((8,1),(4,2))">
        %iter_11292 = cute.get_iter(%view_11285) : !memref_rmem_bf16_18
        %view_11293 = cute.make_view(%iter_11292) : !memref_rmem_bf16_19
        %iter_11294 = cute.get_iter(%view_11293) : !memref_rmem_bf16_19
        %iter_11295 = cute.get_iter(%view_11293) : !memref_rmem_bf16_19
        %lay_11296 = cute.get_layout(%view_11278) : !memref_smem_bf16_20
        %3805 = cute.get_shape(%lay_11296) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11297, %e1_11298, %e2_11299, %e3_11300, %e4_11301 = cute.get_leaves(%3805) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11302 = cute.get_layout(%view_11293) : !memref_rmem_bf16_19
        %3806 = cute.get_shape(%lay_11302) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11303, %e1_11304, %e2_11305, %e3_11306 = cute.get_leaves(%3806) : !cute.shape<"((8,1),((4,2)))">
        %lay_11307 = cute.get_layout(%view_11278) : !memref_smem_bf16_20
        %sz_11308 = cute.size(%lay_11307) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11309 = cute.get_leaves(%sz_11308) : !cute.int_tuple<"8">
        %lay_11310 = cute.get_layout(%view_11293) : !memref_rmem_bf16_19
        %sz_11311 = cute.size(%lay_11310) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11312 = cute.get_leaves(%sz_11311) : !cute.int_tuple<"8">
        %3807 = cute.static : !cute.layout<"1:0">
        %iter_11313 = cute.get_iter(%view_11278) : !memref_smem_bf16_20
        %iter_11314 = cute.get_iter(%view_11293) : !memref_rmem_bf16_19
        %lay_11315 = cute.get_layout(%view_11278) : !memref_smem_bf16_20
        %lay_11316 = cute.get_layout(%view_11293) : !memref_rmem_bf16_19
        %append_11317 = cute.append_to_rank<2> (%lay_11315, %3807) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11318 = cute.append_to_rank<2> (%lay_11316, %3807) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3808:2 = cute.get_scalars(%append_11317) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11319 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11320 = cute.assume(%3808#0) : (i32) -> !cute.i32<divby 16>
        %iv_11321 = cute.assume(%3808#1) : (i32) -> !cute.i32<divby 32>
        %stride_11322 = cute.make_stride(%iv_11320, %iv_11321) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11323 = cute.make_layout(%shape_11319, %stride_11322) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11324 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11325 = cute.size(%lay_11323) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3809 = cute.get_scalars(%sz_11325) : !cute.int_tuple<"8">
        %c0_i32_11326 = arith.constant 0 : i32
        %c1_i32_11327 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11326 to %3809 step %c1_i32_11327  : i32 {
          %coord_11367 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3816:2 = cute.get_scalars(%lay_11323) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3817 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11368 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11369 = cute.crd2idx(%coord_11367, %lay_11323) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11370 = cute.add_offset(%iter_11313, %idx_11369) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11371 = cute.make_view(%ptr_11370, %lay_11368) : !memref_smem_bf16_13
          %3818 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11372 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11373 = cute.crd2idx(%coord_11367, %lay_11324) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11374 = cute.add_offset(%iter_11314, %idx_11373) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11375 = cute.make_view(%ptr_11374, %lay_11372) : !memref_rmem_bf16_11
          %iter_11376 = cute.get_iter(%view_11371) : !memref_smem_bf16_13
          %iter_11377 = cute.get_iter(%view_11375) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11376) : !cute.ptr<bf16, smem, align<16>>
          %3819 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3820 = llvm.mlir.constant(0 : i32) : i32
          %3821 = vector.extractelement %3819[%3820 : i32] : vector<4xi32>
          %3822 = builtin.unrealized_conversion_cast %iter_11377 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3821, %3822 : i32, !llvm.ptr
          %3823 = llvm.mlir.constant(1 : i32) : i32
          %3824 = vector.extractelement %3819[%3823 : i32] : vector<4xi32>
          %int_tuple_11378 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11379 = cute.add_offset(%iter_11377, %int_tuple_11378) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3825 = builtin.unrealized_conversion_cast %ptr_11379 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3824, %3825 : i32, !llvm.ptr
          %3826 = llvm.mlir.constant(2 : i32) : i32
          %3827 = vector.extractelement %3819[%3826 : i32] : vector<4xi32>
          %int_tuple_11380 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11381 = cute.add_offset(%iter_11377, %int_tuple_11380) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3828 = builtin.unrealized_conversion_cast %ptr_11381 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3827, %3828 : i32, !llvm.ptr
          %3829 = llvm.mlir.constant(3 : i32) : i32
          %3830 = vector.extractelement %3819[%3829 : i32] : vector<4xi32>
          %int_tuple_11382 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11383 = cute.add_offset(%iter_11377, %int_tuple_11382) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3831 = builtin.unrealized_conversion_cast %ptr_11383 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3830, %3831 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11328 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11329 = cute.get_layout(%view_10688) : !memref_rmem_bf16_17
        %idx_11330 = cute.crd2idx(%coord_11328, %lay_11329) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
        %iter_11331 = cute.get_iter(%view_10688) : !memref_rmem_bf16_17
        %ptr_11332 = cute.add_offset(%iter_11331, %idx_11330) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11333 = cute.make_view(%ptr_11332) : !memref_rmem_bf16_20
        %iter_11334 = cute.get_iter(%view_11333) : !memref_rmem_bf16_20
        %coord_11335 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11336 = cute.get_layout(%rmem_622) : !memref_rmem_bf16_2
        %idx_11337 = cute.crd2idx(%coord_11335, %lay_11336) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_11338 = cute.get_iter(%rmem_622) : !memref_rmem_bf16_2
        %ptr_11339 = cute.add_offset(%iter_11338, %idx_11337) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11340 = cute.make_view(%ptr_11339) : !memref_rmem_bf16_21
        %iter_11341 = cute.get_iter(%view_11340) : !memref_rmem_bf16_21
        %lay_11342 = cute.get_layout(%view_11333) : !memref_rmem_bf16_20
        %3810 = cute.get_shape(%lay_11342) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11343, %e1_11344, %e2_11345, %e3_11346 = cute.get_leaves(%3810) : !cute.shape<"(((2,2),2),2)">
        %lay_11347 = cute.get_layout(%view_11340) : !memref_rmem_bf16_21
        %3811 = cute.get_shape(%lay_11347) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11348, %e1_11349, %e2_11350, %e3_11351 = cute.get_leaves(%3811) : !cute.shape<"((2,2),(8,2))">
        %iter_11352 = cute.get_iter(%view_11333) : !memref_rmem_bf16_20
        %iter_11353 = cute.get_iter(%view_11340) : !memref_rmem_bf16_21
        %iter_11354 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %iter_11355 = cute.get_iter(%rmem_632) : !memref_rmem_f32_
        %lay_11356 = cute.get_layout(%view_11333) : !memref_rmem_bf16_20
        %lay_11357 = cute.get_layout(%view_11340) : !memref_rmem_bf16_21
        %lay_11358 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %lay_11359 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
        %3812 = cute.static : !cute.layout<"1:0">
        %append_11360 = cute.append_to_rank<3> (%lay_11356, %3812) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11361 = cute.append_to_rank<3> (%lay_11357, %3812) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11362 = cute.size(%append_11360) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11363 = cute.size(%append_11360) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11364 = cute.size(%append_11361) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3813 = cute.get_scalars(%sz_11362) : !cute.int_tuple<"1">
        %3814 = cute.get_scalars(%sz_11363) : !cute.int_tuple<"2">
        %3815 = cute.get_scalars(%sz_11364) : !cute.int_tuple<"16">
        %c0_i32_11365 = arith.constant 0 : i32
        %c1_i32_11366 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11365 to %3813 step %c1_i32_11366  : i32 {
          scf.for %arg14 = %c0_i32_11365 to %3814 step %c1_i32_11366  : i32 {
            scf.for %arg15 = %c0_i32_11365 to %3815 step %c1_i32_11366  : i32 {
              %coord_11367 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11368 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11369 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3816:2 = cute.get_scalars(%coord_11367) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11370 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11371 = cute.crd2idx(%coord_11367, %append_11360) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11372 = cute.add_offset(%iter_11352, %idx_11371) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11373 = cute.make_view(%ptr_11372, %lay_11370) : !memref_rmem_bf16_22
              %3817:2 = cute.get_scalars(%coord_11368) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11374 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11375 = cute.crd2idx(%coord_11368, %append_11361) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11376 = cute.add_offset(%iter_11353, %idx_11375) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11377 = cute.make_view(%ptr_11376, %lay_11374) : !memref_rmem_bf16_15
              %3818:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11378 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11379 = cute.crd2idx(%coord_11369, %lay_11358) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11380 = cute.add_offset(%iter_11354, %idx_11379) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11381 = cute.make_view(%ptr_11380, %lay_11378) : !memref_rmem_f32_3
              %3819:2 = cute.get_scalars(%coord_11369) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11382 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11383 = cute.crd2idx(%coord_11369, %lay_11359) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11384 = cute.add_offset(%iter_11355, %idx_11383) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11385 = cute.make_view(%ptr_11384, %lay_11382) : !memref_rmem_f32_3
              %iter_11386 = cute.get_iter(%view_11373) : !memref_rmem_bf16_22
              %iter_11387 = cute.get_iter(%view_11377) : !memref_rmem_bf16_15
              %iter_11388 = cute.get_iter(%view_11381) : !memref_rmem_f32_3
              %iter_11389 = cute.get_iter(%view_11385) : !memref_rmem_f32_3
              %3820 = builtin.unrealized_conversion_cast %iter_11386 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3821 = llvm.load %3820 : !llvm.ptr -> i32
              %3822 = llvm.getelementptr %3820[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3823 = llvm.load %3822 : !llvm.ptr -> i32
              %3824 = llvm.getelementptr %3820[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3825 = llvm.load %3824 : !llvm.ptr -> i32
              %3826 = llvm.getelementptr %3820[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3827 = llvm.load %3826 : !llvm.ptr -> i32
              %3828 = builtin.unrealized_conversion_cast %iter_11387 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3833 = llvm.load %3832 : !llvm.ptr -> f32
              %3834 = llvm.getelementptr %3832[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3835 = llvm.load %3834 : !llvm.ptr -> f32
              %3836 = llvm.getelementptr %3832[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3837 = llvm.load %3836 : !llvm.ptr -> f32
              %3838 = llvm.getelementptr %3832[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3839 = llvm.load %3838 : !llvm.ptr -> f32
              %3840:4 = cute_nvgpu.arch.mma.SM80 A[%3821, %3823, %3825, %3827]  B[%3829, %3831]  C[%3833, %3835, %3837, %3839] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3841 = builtin.unrealized_conversion_cast %iter_11388 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3840#0, %3841 : f32, !llvm.ptr
              %3842 = llvm.getelementptr %3841[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#1, %3842 : f32, !llvm.ptr
              %3843 = llvm.getelementptr %3841[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#2, %3843 : f32, !llvm.ptr
              %3844 = llvm.getelementptr %3841[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3840#3, %3844 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        scf.yield %3389, %arg7, %3389, %arg9, %arg10, %arg11, %arg12 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32
      }
      %iter_7470 = cute.get_iter(%2849#3) : !memref_gmem_bf16_
      %lay_7471 = cute.get_layout(%2849#3) : !memref_gmem_bf16_
      %2850 = cute.get_shape(%lay_7471) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7472, %e1_7473, %e2_7474, %e3_7475 = cute.get_leaves(%2850) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7476 = cute.to_int_tuple(%e0_7472) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2851 = cute.get_scalars(%itup_7476) : !cute.int_tuple<"?">
      %itup_7477 = cute.to_int_tuple(%e1_7473) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2852 = cute.get_scalars(%itup_7477) : !cute.int_tuple<"?">
      %itup_7478 = cute.to_int_tuple(%e2_7474) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2853 = cute.get_scalars(%itup_7478) : !cute.int_tuple<"?">
      %itup_7479 = cute.to_int_tuple(%e3_7475) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2854 = cute.get_scalars(%itup_7479) : !cute.int_tuple<"?{div=8}">
      %2855 = cute.get_stride(%lay_7471) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_7480, %e1_7481, %e2_7482, %e3_7483 = cute.get_leaves(%2855) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_7484 = cute.to_int_tuple(%e0_7480) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2856 = cute.get_scalars(%itup_7484) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7485 = cute.to_int_tuple(%e1_7481) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2857 = cute.get_scalars(%itup_7485) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7486 = cute.to_int_tuple(%e2_7482) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2858 = cute.get_scalars(%itup_7486) : !cute.int_tuple<"?{i64 div=8}">
      %iter_7487 = cute.get_iter(%2849#4) : !memref_gmem_bf16_
      %lay_7488 = cute.get_layout(%2849#4) : !memref_gmem_bf16_
      %2859 = cute.get_shape(%lay_7488) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7489, %e1_7490, %e2_7491, %e3_7492 = cute.get_leaves(%2859) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7493 = cute.to_int_tuple(%e0_7489) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2860 = cute.get_scalars(%itup_7493) : !cute.int_tuple<"?">
      %itup_7494 = cute.to_int_tuple(%e1_7490) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2861 = cute.get_scalars(%itup_7494) : !cute.int_tuple<"?">
      %itup_7495 = cute.to_int_tuple(%e2_7491) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2862 = cute.get_scalars(%itup_7495) : !cute.int_tuple<"?">
      %itup_7496 = cute.to_int_tuple(%e3_7492) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2863 = cute.get_scalars(%itup_7496) : !cute.int_tuple<"?{div=8}">
      %2864 = cute.get_stride(%lay_7488) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_7497, %e1_7498, %e2_7499, %e3_7500 = cute.get_leaves(%2864) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_7501 = cute.to_int_tuple(%e0_7497) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2865 = cute.get_scalars(%itup_7501) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7502 = cute.to_int_tuple(%e1_7498) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2866 = cute.get_scalars(%itup_7502) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7503 = cute.to_int_tuple(%e2_7499) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2867 = cute.get_scalars(%itup_7503) : !cute.int_tuple<"?{i64 div=8}">
      %iter_7504 = cute.get_iter(%2849#3) : !memref_gmem_bf16_
      %iter_7505 = cute.get_iter(%2849#3) : !memref_gmem_bf16_
      %iter_7506 = cute.get_iter(%2849#4) : !memref_gmem_bf16_
      %iter_7507 = cute.get_iter(%2849#4) : !memref_gmem_bf16_
      %lay_7508 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2868 = cute.get_shape(%lay_7508) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7509, %e1_7510, %e2_7511, %e3_7512 = cute.get_leaves(%2868) : !cute.shape<"((2,2),2,16)">
      %shape_7513 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_7514 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %2869 = cute.get_shape(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7515, %e1_7516, %e2_7517, %e3_7518 = cute.get_leaves(%2869) : !cute.shape<"((2,2),2,16)">
      %2870 = cute.get_shape(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7519, %e1_7520, %e2_7521, %e3_7522 = cute.get_leaves(%2870) : !cute.shape<"((2,2),2,16)">
      %2871 = cute.get_shape(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7523, %e1_7524, %e2_7525, %e3_7526 = cute.get_leaves(%2871) : !cute.shape<"((2,2),2,16)">
      %2872 = cute.get_shape(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7527, %e1_7528, %e2_7529, %e3_7530 = cute.get_leaves(%2872) : !cute.shape<"((2,2),2,16)">
      %2873 = cute.get_stride(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7531, %e1_7532, %e2_7533, %e3_7534 = cute.get_leaves(%2873) : !cute.stride<"((1,2),4,8)">
      %2874 = cute.get_stride(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7535, %e1_7536, %e2_7537, %e3_7538 = cute.get_leaves(%2874) : !cute.stride<"((1,2),4,8)">
      %2875 = cute.get_stride(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7539, %e1_7540, %e2_7541, %e3_7542 = cute.get_leaves(%2875) : !cute.stride<"((1,2),4,8)">
      %2876 = cute.get_stride(%lay_7514) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7543, %e1_7544, %e2_7545, %e3_7546 = cute.get_leaves(%2876) : !cute.stride<"((1,2),4,8)">
      %shape_7547 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_7548 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_7549 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_7550 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7551 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_7552 = cute.make_view(%iter_634, %lay_7551) : !memref_rmem_f32_5
      %iter_7553 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %lay_7554 = cute.get_layout(%rmem_1587) : !memref_rmem_f32_1
      %sz_7555 = cute.size(%lay_7554) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_7556 = cute.get_leaves(%sz_7555) : !cute.int_tuple<"4">
      %coord_7557 = cute.make_coord() : () -> !cute.coord<"0">
      %2877 = cute.memref.load(%rmem_1587, %coord_7557) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %c-1_i32_7558 = arith.constant -1 : i32
      %c2_i32_7559 = arith.constant 2 : i32
      %c31_i32_7560 = arith.constant 31 : i32
      %2878 = nvvm.shfl.sync  bfly %c-1_i32_7558, %2877, %c2_i32_7559, %c31_i32_7560 : f32 -> f32
      %2879 = arith.addf %2877, %2878 : f32
      %c-1_i32_7561 = arith.constant -1 : i32
      %c1_i32_7562 = arith.constant 1 : i32
      %c31_i32_7563 = arith.constant 31 : i32
      %2880 = nvvm.shfl.sync  bfly %c-1_i32_7561, %2879, %c1_i32_7562, %c31_i32_7563 : f32 -> f32
      %2881 = arith.addf %2879, %2880 : f32
      %coord_7564 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1587, %coord_7564, %2881) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_7565 = cute.make_coord() : () -> !cute.coord<"0">
      %2882 = cute.memref.load(%rmem_1587, %coord_7565) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %cst_7566 = arith.constant 0.000000e+00 : f32
      %2883 = arith.cmpf oeq, %2882, %cst_7566 : f32
      %coord_7567 = cute.make_coord() : () -> !cute.coord<"0">
      %2884 = cute.memref.load(%rmem_1587, %coord_7567) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2885 = arith.cmpf oeq, %2884, %cst_7566 : f32
      %coord_7568 = cute.make_coord() : () -> !cute.coord<"0">
      %2886 = cute.memref.load(%rmem_1587, %coord_7568) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %coord_7569 = cute.make_coord() : () -> !cute.coord<"0">
      %2887 = cute.memref.load(%rmem_1587, %coord_7569) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2888 = arith.cmpf une, %2886, %2887 : f32
      %2889 = arith.extui %2885 : i1 to i32
      %c0_i32_7570 = arith.constant 0 : i32
      %2890 = arith.cmpi ne, %2889, %c0_i32_7570 : i32
      %2891 = arith.extui %2885 : i1 to i32
      %2892 = arith.extui %2888 : i1 to i32
      %2893 = arith.select %2890, %2891, %2892 : i32
      %c0_i32_7571 = arith.constant 0 : i32
      %2894 = arith.cmpi ne, %2893, %c0_i32_7571 : i32
      %coord_7572 = cute.make_coord() : () -> !cute.coord<"0">
      %2895 = cute.memref.load(%rmem_1587, %coord_7572) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2896 = nvvm.rcp.approx.ftz.f %2895 : f32
      %cst_7573 = arith.constant 1.000000e+00 : f32
      %2897 = arith.select %2894, %cst_7573, %2896 : f32
      %coord_7574 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7575 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7576 = cute.crd2idx(%coord_7574, %lay_7575) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7577 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7578 = cute.add_offset(%iter_7577, %idx_7576) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7579 = cute.make_view(%ptr_7578) : !memref_rmem_f32_10
      %iter_7580 = cute.get_iter(%view_7579) : !memref_rmem_f32_10
      %lay_7581 = cute.get_layout(%view_7579) : !memref_rmem_f32_10
      %2898 = cute.get_shape(%lay_7581) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7582, %e1_7583 = cute.get_leaves(%2898) : !cute.shape<"((2,16))">
      %2899 = cute.memref.load_vec %view_7579, row_major : !memref_rmem_f32_10
      %2900 = vector.broadcast %2897 : f32 to vector<32xf32>
      %2901 = arith.mulf %2899, %2900 : vector<32xf32>
      %coord_7584 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7585 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7586 = cute.crd2idx(%coord_7584, %lay_7585) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7587 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7588 = cute.add_offset(%iter_7587, %idx_7586) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7589 = cute.make_view(%ptr_7588) : !memref_rmem_f32_10
      %iter_7590 = cute.get_iter(%view_7589) : !memref_rmem_f32_10
      %lay_7591 = cute.get_layout(%view_7589) : !memref_rmem_f32_10
      %2902 = cute.get_shape(%lay_7591) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7592, %e1_7593 = cute.get_leaves(%2902) : !cute.shape<"((2,16))">
      %int_tuple_7594 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7595 = cute.size(%int_tuple_7594) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7596 = cute.get_leaves(%sz_7595) : !cute.int_tuple<"32">
      %int_tuple_7597 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7598 = cute.size(%int_tuple_7597) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7599 = cute.get_leaves(%sz_7598) : !cute.int_tuple<"32">
      cute.memref.store_vec %2901, %view_7589, row_major : !memref_rmem_f32_10
      %coord_7600 = cute.make_coord() : () -> !cute.coord<"1">
      %2903 = cute.memref.load(%rmem_1587, %coord_7600) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %c-1_i32_7601 = arith.constant -1 : i32
      %c2_i32_7602 = arith.constant 2 : i32
      %c31_i32_7603 = arith.constant 31 : i32
      %2904 = nvvm.shfl.sync  bfly %c-1_i32_7601, %2903, %c2_i32_7602, %c31_i32_7603 : f32 -> f32
      %2905 = arith.addf %2903, %2904 : f32
      %c-1_i32_7604 = arith.constant -1 : i32
      %c1_i32_7605 = arith.constant 1 : i32
      %c31_i32_7606 = arith.constant 31 : i32
      %2906 = nvvm.shfl.sync  bfly %c-1_i32_7604, %2905, %c1_i32_7605, %c31_i32_7606 : f32 -> f32
      %2907 = arith.addf %2905, %2906 : f32
      %coord_7607 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1587, %coord_7607, %2907) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_7608 = cute.make_coord() : () -> !cute.coord<"1">
      %2908 = cute.memref.load(%rmem_1587, %coord_7608) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2909 = arith.cmpf oeq, %2908, %cst_7566 : f32
      %coord_7609 = cute.make_coord() : () -> !cute.coord<"1">
      %2910 = cute.memref.load(%rmem_1587, %coord_7609) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2911 = arith.cmpf oeq, %2910, %cst_7566 : f32
      %coord_7610 = cute.make_coord() : () -> !cute.coord<"1">
      %2912 = cute.memref.load(%rmem_1587, %coord_7610) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %coord_7611 = cute.make_coord() : () -> !cute.coord<"1">
      %2913 = cute.memref.load(%rmem_1587, %coord_7611) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2914 = arith.cmpf une, %2912, %2913 : f32
      %2915 = arith.extui %2911 : i1 to i32
      %2916 = arith.cmpi ne, %2915, %c0_i32_7570 : i32
      %2917 = arith.extui %2911 : i1 to i32
      %2918 = arith.extui %2914 : i1 to i32
      %2919 = arith.select %2916, %2917, %2918 : i32
      %2920 = arith.cmpi ne, %2919, %c0_i32_7571 : i32
      %coord_7612 = cute.make_coord() : () -> !cute.coord<"1">
      %2921 = cute.memref.load(%rmem_1587, %coord_7612) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2922 = nvvm.rcp.approx.ftz.f %2921 : f32
      %2923 = arith.select %2920, %cst_7573, %2922 : f32
      %coord_7613 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7614 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7615 = cute.crd2idx(%coord_7613, %lay_7614) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7616 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7617 = cute.add_offset(%iter_7616, %idx_7615) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7618 = cute.make_view(%ptr_7617) : !memref_rmem_f32_11
      %iter_7619 = cute.get_iter(%view_7618) : !memref_rmem_f32_11
      %lay_7620 = cute.get_layout(%view_7618) : !memref_rmem_f32_11
      %2924 = cute.get_shape(%lay_7620) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7621, %e1_7622 = cute.get_leaves(%2924) : !cute.shape<"((2,16))">
      %2925 = cute.memref.load_vec %view_7618, row_major : !memref_rmem_f32_11
      %2926 = vector.broadcast %2923 : f32 to vector<32xf32>
      %2927 = arith.mulf %2925, %2926 : vector<32xf32>
      %coord_7623 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7624 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7625 = cute.crd2idx(%coord_7623, %lay_7624) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7626 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7627 = cute.add_offset(%iter_7626, %idx_7625) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7628 = cute.make_view(%ptr_7627) : !memref_rmem_f32_11
      %iter_7629 = cute.get_iter(%view_7628) : !memref_rmem_f32_11
      %lay_7630 = cute.get_layout(%view_7628) : !memref_rmem_f32_11
      %2928 = cute.get_shape(%lay_7630) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7631, %e1_7632 = cute.get_leaves(%2928) : !cute.shape<"((2,16))">
      %int_tuple_7633 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7634 = cute.size(%int_tuple_7633) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7635 = cute.get_leaves(%sz_7634) : !cute.int_tuple<"32">
      %int_tuple_7636 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7637 = cute.size(%int_tuple_7636) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7638 = cute.get_leaves(%sz_7637) : !cute.int_tuple<"32">
      cute.memref.store_vec %2927, %view_7628, row_major : !memref_rmem_f32_11
      %coord_7639 = cute.make_coord() : () -> !cute.coord<"2">
      %2929 = cute.memref.load(%rmem_1587, %coord_7639) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %c-1_i32_7640 = arith.constant -1 : i32
      %c2_i32_7641 = arith.constant 2 : i32
      %c31_i32_7642 = arith.constant 31 : i32
      %2930 = nvvm.shfl.sync  bfly %c-1_i32_7640, %2929, %c2_i32_7641, %c31_i32_7642 : f32 -> f32
      %2931 = arith.addf %2929, %2930 : f32
      %c-1_i32_7643 = arith.constant -1 : i32
      %c1_i32_7644 = arith.constant 1 : i32
      %c31_i32_7645 = arith.constant 31 : i32
      %2932 = nvvm.shfl.sync  bfly %c-1_i32_7643, %2931, %c1_i32_7644, %c31_i32_7645 : f32 -> f32
      %2933 = arith.addf %2931, %2932 : f32
      %coord_7646 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1587, %coord_7646, %2933) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_7647 = cute.make_coord() : () -> !cute.coord<"2">
      %2934 = cute.memref.load(%rmem_1587, %coord_7647) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2935 = arith.cmpf oeq, %2934, %cst_7566 : f32
      %coord_7648 = cute.make_coord() : () -> !cute.coord<"2">
      %2936 = cute.memref.load(%rmem_1587, %coord_7648) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2937 = arith.cmpf oeq, %2936, %cst_7566 : f32
      %coord_7649 = cute.make_coord() : () -> !cute.coord<"2">
      %2938 = cute.memref.load(%rmem_1587, %coord_7649) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %coord_7650 = cute.make_coord() : () -> !cute.coord<"2">
      %2939 = cute.memref.load(%rmem_1587, %coord_7650) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2940 = arith.cmpf une, %2938, %2939 : f32
      %2941 = arith.extui %2937 : i1 to i32
      %2942 = arith.cmpi ne, %2941, %c0_i32_7570 : i32
      %2943 = arith.extui %2937 : i1 to i32
      %2944 = arith.extui %2940 : i1 to i32
      %2945 = arith.select %2942, %2943, %2944 : i32
      %2946 = arith.cmpi ne, %2945, %c0_i32_7571 : i32
      %coord_7651 = cute.make_coord() : () -> !cute.coord<"2">
      %2947 = cute.memref.load(%rmem_1587, %coord_7651) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2948 = nvvm.rcp.approx.ftz.f %2947 : f32
      %2949 = arith.select %2946, %cst_7573, %2948 : f32
      %coord_7652 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7653 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7654 = cute.crd2idx(%coord_7652, %lay_7653) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7655 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7656 = cute.add_offset(%iter_7655, %idx_7654) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7657 = cute.make_view(%ptr_7656) : !memref_rmem_f32_12
      %iter_7658 = cute.get_iter(%view_7657) : !memref_rmem_f32_12
      %lay_7659 = cute.get_layout(%view_7657) : !memref_rmem_f32_12
      %2950 = cute.get_shape(%lay_7659) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7660, %e1_7661 = cute.get_leaves(%2950) : !cute.shape<"((2,16))">
      %2951 = cute.memref.load_vec %view_7657, row_major : !memref_rmem_f32_12
      %2952 = vector.broadcast %2949 : f32 to vector<32xf32>
      %2953 = arith.mulf %2951, %2952 : vector<32xf32>
      %coord_7662 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7663 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7664 = cute.crd2idx(%coord_7662, %lay_7663) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7665 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7666 = cute.add_offset(%iter_7665, %idx_7664) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7667 = cute.make_view(%ptr_7666) : !memref_rmem_f32_12
      %iter_7668 = cute.get_iter(%view_7667) : !memref_rmem_f32_12
      %lay_7669 = cute.get_layout(%view_7667) : !memref_rmem_f32_12
      %2954 = cute.get_shape(%lay_7669) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7670, %e1_7671 = cute.get_leaves(%2954) : !cute.shape<"((2,16))">
      %int_tuple_7672 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7673 = cute.size(%int_tuple_7672) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7674 = cute.get_leaves(%sz_7673) : !cute.int_tuple<"32">
      %int_tuple_7675 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7676 = cute.size(%int_tuple_7675) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7677 = cute.get_leaves(%sz_7676) : !cute.int_tuple<"32">
      cute.memref.store_vec %2953, %view_7667, row_major : !memref_rmem_f32_12
      %coord_7678 = cute.make_coord() : () -> !cute.coord<"3">
      %2955 = cute.memref.load(%rmem_1587, %coord_7678) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %c-1_i32_7679 = arith.constant -1 : i32
      %c2_i32_7680 = arith.constant 2 : i32
      %c31_i32_7681 = arith.constant 31 : i32
      %2956 = nvvm.shfl.sync  bfly %c-1_i32_7679, %2955, %c2_i32_7680, %c31_i32_7681 : f32 -> f32
      %2957 = arith.addf %2955, %2956 : f32
      %c-1_i32_7682 = arith.constant -1 : i32
      %c1_i32_7683 = arith.constant 1 : i32
      %c31_i32_7684 = arith.constant 31 : i32
      %2958 = nvvm.shfl.sync  bfly %c-1_i32_7682, %2957, %c1_i32_7683, %c31_i32_7684 : f32 -> f32
      %2959 = arith.addf %2957, %2958 : f32
      %coord_7685 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1587, %coord_7685, %2959) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_7686 = cute.make_coord() : () -> !cute.coord<"3">
      %2960 = cute.memref.load(%rmem_1587, %coord_7686) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2961 = arith.cmpf oeq, %2960, %cst_7566 : f32
      %coord_7687 = cute.make_coord() : () -> !cute.coord<"3">
      %2962 = cute.memref.load(%rmem_1587, %coord_7687) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2963 = arith.cmpf oeq, %2962, %cst_7566 : f32
      %coord_7688 = cute.make_coord() : () -> !cute.coord<"3">
      %2964 = cute.memref.load(%rmem_1587, %coord_7688) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %coord_7689 = cute.make_coord() : () -> !cute.coord<"3">
      %2965 = cute.memref.load(%rmem_1587, %coord_7689) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2966 = arith.cmpf une, %2964, %2965 : f32
      %2967 = arith.extui %2963 : i1 to i32
      %2968 = arith.cmpi ne, %2967, %c0_i32_7570 : i32
      %2969 = arith.extui %2963 : i1 to i32
      %2970 = arith.extui %2966 : i1 to i32
      %2971 = arith.select %2968, %2969, %2970 : i32
      %2972 = arith.cmpi ne, %2971, %c0_i32_7571 : i32
      %coord_7690 = cute.make_coord() : () -> !cute.coord<"3">
      %2973 = cute.memref.load(%rmem_1587, %coord_7690) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2974 = nvvm.rcp.approx.ftz.f %2973 : f32
      %2975 = arith.select %2972, %cst_7573, %2974 : f32
      %coord_7691 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7692 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7693 = cute.crd2idx(%coord_7691, %lay_7692) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7694 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7695 = cute.add_offset(%iter_7694, %idx_7693) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7696 = cute.make_view(%ptr_7695) : !memref_rmem_f32_11
      %iter_7697 = cute.get_iter(%view_7696) : !memref_rmem_f32_11
      %lay_7698 = cute.get_layout(%view_7696) : !memref_rmem_f32_11
      %2976 = cute.get_shape(%lay_7698) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7699, %e1_7700 = cute.get_leaves(%2976) : !cute.shape<"((2,16))">
      %2977 = cute.memref.load_vec %view_7696, row_major : !memref_rmem_f32_11
      %2978 = vector.broadcast %2975 : f32 to vector<32xf32>
      %2979 = arith.mulf %2977, %2978 : vector<32xf32>
      %coord_7701 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7702 = cute.get_layout(%view_7552) : !memref_rmem_f32_5
      %idx_7703 = cute.crd2idx(%coord_7701, %lay_7702) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7704 = cute.get_iter(%view_7552) : !memref_rmem_f32_5
      %ptr_7705 = cute.add_offset(%iter_7704, %idx_7703) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7706 = cute.make_view(%ptr_7705) : !memref_rmem_f32_11
      %iter_7707 = cute.get_iter(%view_7706) : !memref_rmem_f32_11
      %lay_7708 = cute.get_layout(%view_7706) : !memref_rmem_f32_11
      %2980 = cute.get_shape(%lay_7708) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7709, %e1_7710 = cute.get_leaves(%2980) : !cute.shape<"((2,16))">
      %int_tuple_7711 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7712 = cute.size(%int_tuple_7711) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7713 = cute.get_leaves(%sz_7712) : !cute.int_tuple<"32">
      %int_tuple_7714 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7715 = cute.size(%int_tuple_7714) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7716 = cute.get_leaves(%sz_7715) : !cute.int_tuple<"32">
      cute.memref.store_vec %2979, %view_7706, row_major : !memref_rmem_f32_11
      %lay_7717 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %lay_7718 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_7719 = cute.memref.alloca(%lay_7718) : !memref_rmem_bf16_23
      %iter_7720 = cute.get_iter(%rmem_7719) : !memref_rmem_bf16_23
      %iter_7721 = cute.get_iter(%rmem_7719) : !memref_rmem_bf16_23
      %lay_7722 = cute.get_layout(%rmem_632) : !memref_rmem_f32_
      %2981 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2981) : !cute.shape<"((2,2),2,16)">
      %2982 = cute.memref.load_vec %rmem_632, row_major : !memref_rmem_f32_
      %2983 = arith.truncf %2982 : vector<128xf32> to vector<128xbf16>
      %lay_7727 = cute.get_layout(%rmem_7719) : !memref_rmem_bf16_23
      %2984 = cute.get_shape(%lay_7727) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7728, %e1_7729, %e2_7730, %e3_7731 = cute.get_leaves(%2984) : !cute.shape<"((2,2),2,16)">
      %int_tuple_7732 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7733 = cute.size(%int_tuple_7732) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7734 = cute.get_leaves(%sz_7733) : !cute.int_tuple<"128">
      %int_tuple_7735 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7736 = cute.size(%int_tuple_7735) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7737 = cute.get_leaves(%sz_7736) : !cute.int_tuple<"128">
      cute.memref.store_vec %2983, %rmem_7719, row_major : !memref_rmem_bf16_23
      %view_7738 = cute.make_view(%iter_295, %2) : !memref_smem_bf16_
      %iter_7739 = cute.get_iter(%view_7738) : !memref_smem_bf16_
      %atom_7740 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %2985 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %2986 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2986) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7744 = cute.size(%e0_7741) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_7745 = cute.get_leaves(%sz_7744) : !cute.int_tuple<"64">
      %2987 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7746, %e1_7747, %e2_7748 = cute.get_leaves(%2987) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7749 = cute.size(%e1_7747) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_7750 = cute.get_leaves(%sz_7749) : !cute.int_tuple<"16">
      %tile_7751 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %2988 = cute.make_tiled_copy(%atom_7740) : !copy_simt1
      %iter_7752 = cute.get_iter(%rmem_7719) : !memref_rmem_bf16_23
      %view_7753 = cute.make_view(%iter_7752) : !memref_rmem_bf16_24
      %iter_7754 = cute.get_iter(%view_7753) : !memref_rmem_bf16_24
      %coord_7755 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_7756 = cute.get_iter(%view_7738) : !memref_smem_bf16_
      %2989 = cute.get_scalars(%coord_7755) <{only_dynamic}> : !cute.coord<"?">
      %c4_i32_7757 = arith.constant 4 : i32
      %2990 = arith.divsi %2989, %c4_i32_7757 : i32
      %c4_i32_7758 = arith.constant 4 : i32
      %2991 = arith.remsi %2989, %c4_i32_7758 : i32
      %c8_i32_7759 = arith.constant 8 : i32
      %2992 = arith.divsi %2990, %c8_i32_7759 : i32
      %c8_i32_7760 = arith.constant 8 : i32
      %2993 = arith.remsi %2990, %c8_i32_7760 : i32
      %c64_i32_7761 = arith.constant 64 : i32
      %2994 = arith.muli %2993, %c64_i32_7761 : i32
      %c0_i32_7762 = arith.constant 0 : i32
      %2995 = arith.xori %2994, %c0_i32_7762 : i32
      %c4_i32_7763 = arith.constant 4 : i32
      %2996 = arith.divsi %2989, %c4_i32_7763 : i32
      %c4_i32_7764 = arith.constant 4 : i32
      %2997 = arith.remsi %2989, %c4_i32_7764 : i32
      %c2_i32_7765 = arith.constant 2 : i32
      %2998 = arith.muli %2997, %c2_i32_7765 : i32
      %c8_i32_7766 = arith.constant 8 : i32
      %2999 = arith.divsi %2996, %c8_i32_7766 : i32
      %c8_i32_7767 = arith.constant 8 : i32
      %3000 = arith.remsi %2996, %c8_i32_7767 : i32
      %c1024_i32_7768 = arith.constant 1024 : i32
      %3001 = arith.muli %2999, %c1024_i32_7768 : i32
      %3002 = arith.addi %2998, %3001 : i32
      %c64_i32_7769 = arith.constant 64 : i32
      %3003 = arith.andi %2995, %c64_i32_7769 : i32
      %c0_i32_7770 = arith.constant 0 : i32
      %3004 = arith.cmpi eq, %3003, %c0_i32_7770 : i32
      %3005 = scf.if %3004 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_7771 = arith.constant 128 : i32
      %3006 = arith.andi %2995, %c128_i32_7771 : i32
      %c0_i32_7772 = arith.constant 0 : i32
      %3007 = arith.cmpi eq, %3006, %c0_i32_7772 : i32
      %3008 = scf.if %3007 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_7773 = arith.constant 256 : i32
      %3009 = arith.andi %2995, %c256_i32_7773 : i32
      %c0_i32_7774 = arith.constant 0 : i32
      %3010 = arith.cmpi eq, %3009, %c0_i32_7774 : i32
      %3011 = scf.if %3010 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_7775 = arith.constant 8 : i32
      %3012 = arith.andi %2995, %c8_i32_7775 : i32
      %c0_i32_7776 = arith.constant 0 : i32
      %3013 = arith.cmpi eq, %3012, %c0_i32_7776 : i32
      %3014 = scf.if %3013 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_7777 = arith.constant 16 : i32
      %3015 = arith.andi %2995, %c16_i32_7777 : i32
      %c0_i32_7778 = arith.constant 0 : i32
      %3016 = arith.cmpi eq, %3015, %c0_i32_7778 : i32
      %3017 = scf.if %3016 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_7779 = arith.constant 32 : i32
      %3018 = arith.andi %2995, %c32_i32_7779 : i32
      %c0_i32_7780 = arith.constant 0 : i32
      %3019 = arith.cmpi eq, %3018, %c0_i32_7780 : i32
      %3020 = scf.if %3019 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_7781 = arith.constant 448 : i32
      %3021 = arith.andi %2995, %c448_i32_7781 : i32
      %c3_i32_7782 = arith.constant 3 : i32
      %3022 = arith.shrsi %3021, %c3_i32_7782 : i32
      %3023 = arith.xori %2995, %3022 : i32
      %3024 = arith.addi %3023, %3002 : i32
      %c64_i32_7783 = arith.constant 64 : i32
      %3025 = arith.muli %3005, %c64_i32_7783 : i32
      %c32_i32_7784 = arith.constant 32 : i32
      %3026 = arith.muli %3008, %c32_i32_7784 : i32
      %c16_i32_7785 = arith.constant 16 : i32
      %3027 = arith.muli %3011, %c16_i32_7785 : i32
      %c8_i32_7786 = arith.constant 8 : i32
      %3028 = arith.muli %3014, %c8_i32_7786 : i32
      %c4_i32_7787 = arith.constant 4 : i32
      %3029 = arith.muli %3017, %c4_i32_7787 : i32
      %c2_i32_7788 = arith.constant 2 : i32
      %3030 = arith.muli %3020, %c2_i32_7788 : i32
      %c512_i32_7789 = arith.constant 512 : i32
      %3031 = arith.muli %3005, %c512_i32_7789 : i32
      %c256_i32_7790 = arith.constant 256 : i32
      %3032 = arith.muli %3008, %c256_i32_7790 : i32
      %c128_i32_7791 = arith.constant 128 : i32
      %3033 = arith.muli %3011, %c128_i32_7791 : i32
      %c64_i32_7792 = arith.constant 64 : i32
      %3034 = arith.muli %3014, %c64_i32_7792 : i32
      %c32_i32_7793 = arith.constant 32 : i32
      %3035 = arith.muli %3017, %c32_i32_7793 : i32
      %c16_i32_7794 = arith.constant 16 : i32
      %3036 = arith.muli %3020, %c16_i32_7794 : i32
      %c2_i32_7795 = arith.constant 2 : i32
      %3037 = arith.muli %3005, %c2_i32_7795 : i32
      %c1024_i32_7796 = arith.constant 1024 : i32
      %3038 = arith.muli %3005, %c1024_i32_7796 : i32
      %c512_i32_7797 = arith.constant 512 : i32
      %3039 = arith.muli %3008, %c512_i32_7797 : i32
      %c256_i32_7798 = arith.constant 256 : i32
      %3040 = arith.muli %3011, %c256_i32_7798 : i32
      %c128_i32_7799 = arith.constant 128 : i32
      %3041 = arith.muli %3014, %c128_i32_7799 : i32
      %c64_i32_7800 = arith.constant 64 : i32
      %3042 = arith.muli %3017, %c64_i32_7800 : i32
      %c32_i32_7801 = arith.constant 32 : i32
      %3043 = arith.muli %3020, %c32_i32_7801 : i32
      %iv_7802 = cute.assume(%3024) : (i32) -> !cute.i32<divby 2>
      %int_tuple_7803 = cute.make_int_tuple(%iv_7802) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_7804 = cute.add_offset(%iter_7756, %int_tuple_7803) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_7805 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iv_7806 = cute.assume(%3005) : (i32) -> !cute.i32<divby 8>
      %iv_7807 = cute.assume(%3008) : (i32) -> !cute.i32<divby 16>
      %iv_7808 = cute.assume(%3011) : (i32) -> !cute.i32<divby 32>
      %stride_7809 = cute.make_stride(%iv_7806, %iv_7807, %iv_7808) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %lay_7810 = cute.make_layout(%shape_7805, %stride_7809) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %view_7811 = cute.make_view(%ptr_7804, %lay_7810) : !memref_smem_bf16_21
      %iter_7812 = cute.get_iter(%view_7811) : !memref_smem_bf16_21
      %lay_7813 = cute.get_layout(%view_7753) : !memref_rmem_bf16_24
      %3044 = cute.get_shape(%lay_7813) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7814, %e1_7815, %e2_7816, %e3_7817, %e4_7818 = cute.get_leaves(%3044) : !cute.shape<"((1,(4,2)),2,8)">
      %lay_7819 = cute.get_layout(%view_7811) : !memref_smem_bf16_21
      %3045 = cute.get_shape(%lay_7819) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7820, %e1_7821, %e2_7822, %e3_7823, %e4_7824, %e5_7825, %e6, %e7 = cute.get_leaves(%3045) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %lay_7826 = cute.get_layout(%view_7753) : !memref_rmem_bf16_24
      %shape_7827 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7828 = cute.make_layout() : !cute.layout<"1:0">
      %append_7829 = cute.append_to_rank<2> (%lay_7826, %lay_7828) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0">
      %view_7830 = cute.make_view(%iter_7754, %append_7829) : !memref_rmem_bf16_24
      %iter_7831 = cute.get_iter(%view_7830) : !memref_rmem_bf16_24
      %lay_7832 = cute.get_layout(%view_7830) : !memref_rmem_bf16_24
      %3046 = cute.get_shape(%lay_7832) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7833, %e1_7834, %e2_7835, %e3_7836, %e4_7837 = cute.get_leaves(%3046) : !cute.shape<"((1,(4,2)),2,8)">
      %iter_7838 = cute.get_iter(%view_7830) : !memref_rmem_bf16_24
      %view_7839 = cute.make_view(%iter_7838) : !memref_rmem_bf16_25
      %iter_7840 = cute.get_iter(%view_7839) : !memref_rmem_bf16_25
      %iter_7841 = cute.get_iter(%view_7839) : !memref_rmem_bf16_25
      %lay_7842 = cute.get_layout(%view_7811) : !memref_smem_bf16_21
      %shape_7843 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7844 = cute.make_layout() : !cute.layout<"1:0">
      %append_7845 = cute.append_to_rank<2> (%lay_7842, %lay_7844) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0">
      %view_7846 = cute.make_view(%iter_7812, %append_7845) : !memref_smem_bf16_21
      %iter_7847 = cute.get_iter(%view_7846) : !memref_smem_bf16_21
      %lay_7848 = cute.get_layout(%view_7846) : !memref_smem_bf16_21
      %3047 = cute.get_shape(%lay_7848) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7849, %e1_7850, %e2_7851, %e3_7852, %e4_7853, %e5_7854, %e6_7855, %e7_7856 = cute.get_leaves(%3047) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iter_7857 = cute.get_iter(%view_7846) : !memref_smem_bf16_21
      %lay_7858 = cute.get_layout(%view_7846) : !memref_smem_bf16_21
      %3048:3 = cute.get_scalars(%lay_7858) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %shape_7859 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %iv_7860 = cute.assume(%3048#0) : (i32) -> !cute.i32<divby 8>
      %iv_7861 = cute.assume(%3048#1) : (i32) -> !cute.i32<divby 16>
      %iv_7862 = cute.assume(%3048#2) : (i32) -> !cute.i32<divby 32>
      %stride_7863 = cute.make_stride(%iv_7860, %iv_7861, %iv_7862) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %lay_7864 = cute.make_layout(%shape_7859, %stride_7863) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %view_7865 = cute.make_view(%iter_7857, %lay_7864) : !memref_smem_bf16_22
      %iter_7866 = cute.get_iter(%view_7865) : !memref_smem_bf16_22
      %iter_7867 = cute.get_iter(%view_7865) : !memref_smem_bf16_22
      %lay_7868 = cute.get_layout(%view_7839) : !memref_rmem_bf16_25
      %3049 = cute.get_shape(%lay_7868) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))">
      %e0_7869, %e1_7870, %e2_7871, %e3_7872, %e4_7873 = cute.get_leaves(%3049) : !cute.shape<"((1,(4,2)),(2,8))">
      %lay_7874 = cute.get_layout(%view_7865) : !memref_smem_bf16_22
      %3050 = cute.get_shape(%lay_7874) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %e0_7875, %e1_7876, %e2_7877, %e3_7878, %e4_7879, %e5_7880, %e6_7881, %e7_7882 = cute.get_leaves(%3050) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %lay_7883 = cute.get_layout(%view_7839) : !memref_rmem_bf16_25
      %sz_7884 = cute.size(%lay_7883) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.int_tuple<"16">
      %e0_7885 = cute.get_leaves(%sz_7884) : !cute.int_tuple<"16">
      %lay_7886 = cute.get_layout(%view_7865) : !memref_smem_bf16_22
      %sz_7887 = cute.size(%lay_7886) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.int_tuple<"16">
      %e0_7888 = cute.get_leaves(%sz_7887) : !cute.int_tuple<"16">
      %3051 = cute.static : !cute.layout<"1:0">
      %iter_7889 = cute.get_iter(%view_7839) : !memref_rmem_bf16_25
      %iter_7890 = cute.get_iter(%view_7865) : !memref_smem_bf16_22
      %lay_7891 = cute.get_layout(%view_7839) : !memref_rmem_bf16_25
      %lay_7892 = cute.get_layout(%view_7865) : !memref_smem_bf16_22
      %append_7893 = cute.append_to_rank<2> (%lay_7891, %3051) : !cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">, !cute.layout<"1:0">
      %append_7894 = cute.append_to_rank<2> (%lay_7892, %3051) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">, !cute.layout<"1:0">
      %lay_7895 = cute.make_layout() : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">
      %3052:3 = cute.get_scalars(%append_7894) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %shape_7896 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),((2,((2,2),2))))">
      %iv_7897 = cute.assume(%3052#0) : (i32) -> !cute.i32<divby 8>
      %iv_7898 = cute.assume(%3052#1) : (i32) -> !cute.i32<divby 16>
      %iv_7899 = cute.assume(%3052#2) : (i32) -> !cute.i32<divby 32>
      %stride_7900 = cute.make_stride(%iv_7897, %iv_7898, %iv_7899) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %lay_7901 = cute.make_layout(%shape_7896, %stride_7900) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %sz_7902 = cute.size(%lay_7895) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"16">
      %3053 = cute.get_scalars(%sz_7902) : !cute.int_tuple<"16">
      %c0_i32_7903 = arith.constant 0 : i32
      %c1_i32_7904 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7903 to %3053 step %c1_i32_7904  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((1,(4,2))):((0,(1,8)))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_7895) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"?{div=4}">
        %ptr_8497 = cute.add_offset(%iter_7889, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_rmem_bf16_26
        %3371:3 = cute.get_scalars(%lay_7901) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
        %3372 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %shape_8499 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)))">
        %iv_8500 = cute.assume(%3371#0) : (i32) -> !cute.i32<divby 8>
        %stride_8501 = cute.make_stride(%iv_8500) : (!cute.i32<divby 8>) -> !cute.stride<"((0,(1,512,?{div=8})))">
        %lay_8502 = cute.make_layout(%shape_8499, %stride_8501) : !cute.layout<"((1,(2,2,2))):((0,(1,512,?{div=8})))">
        %idx_8503 = cute.crd2idx(%coord_8494, %lay_7901) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8504 = cute.add_offset(%iter_7890, %idx_8503) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>>
        %view_8505 = cute.make_view(%ptr_8504, %lay_8502) : !memref_smem_bf16_23
        %iter_8506 = cute.get_iter(%view_8498) : !memref_rmem_bf16_26
        %iter_8507 = cute.get_iter(%view_8505) : !memref_smem_bf16_23
        %lay_8508 = cute.get_layout(%view_8505) : !memref_smem_bf16_23
        %3373 = cute.get_scalars(%lay_8508) <{only_dynamic}> : !cute.layout<"((1,(2,2,2))):((0,(1,512,?{div=8})))">
        %3374 = builtin.unrealized_conversion_cast %iter_8506 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %3375 = builtin.unrealized_conversion_cast %iter_8507 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3376 = llvm.load %3374 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3376, %3375 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8509 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8510 = cute.add_offset(%iter_8506, %int_tuple_8509) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_8511 = cute.make_int_tuple() : () -> !cute.int_tuple<"512">
        %ptr_8512 = cute.add_offset(%iter_8507, %int_tuple_8511) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"512">) -> !cute.ptr<bf16, smem, align<4>>
        %3377 = builtin.unrealized_conversion_cast %ptr_8510 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %3378 = builtin.unrealized_conversion_cast %ptr_8512 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3379 = llvm.load %3377 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3379, %3378 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8513 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %ptr_8514 = cute.add_offset(%iter_8506, %int_tuple_8513) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<8>>
        %iv_8515 = cute.assume(%3373) : (i32) -> !cute.i32<divby 8>
        %int_tuple_8516 = cute.make_int_tuple(%iv_8515) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
        %ptr_8517 = cute.add_offset(%iter_8507, %int_tuple_8516) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<4>>
        %3380 = builtin.unrealized_conversion_cast %ptr_8514 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %3381 = builtin.unrealized_conversion_cast %ptr_8517 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3382 = llvm.load %3380 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3382, %3381 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8518 = cute.make_int_tuple() : () -> !cute.int_tuple<"10">
        %ptr_8519 = cute.add_offset(%iter_8506, %int_tuple_8518) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"10">) -> !cute.ptr<bf16, rmem, align<4>>
        %c512_i32_8520 = arith.constant 512 : i32
        %3383 = arith.addi %3373, %c512_i32_8520 : i32
        %iv_8521 = cute.assume(%3383) : (i32) -> !cute.i32<divby 8>
        %int_tuple_8522 = cute.make_int_tuple(%iv_8521) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
        %ptr_8523 = cute.add_offset(%iter_8507, %int_tuple_8522) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<4>>
        %3384 = builtin.unrealized_conversion_cast %ptr_8519 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %3385 = builtin.unrealized_conversion_cast %ptr_8523 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3386 = llvm.load %3384 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3386, %3385 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7905 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_7906 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3054:7 = cute.get_scalars(%lay_7906) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %3055:2 = cute.get_scalars(%coord_7905) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_7907 = cute.assume(%3054#3) : (i32) -> !cute.i32<divby 8>
      %shape_7908 = cute.make_shape(%3054#1, %iv_7907) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_7909 = cute.assume(%3054#5) : (i64) -> !cute.i64<divby 8>
      %stride_7910 = cute.make_stride(%iv_7909) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_7911 = cute.make_layout(%shape_7908, %stride_7910) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_7912 = cute.crd2idx(%coord_7905, %lay_7906) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_7913 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_7914 = cute.add_offset(%iter_7913, %idx_7912) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7915 = cute.make_view(%ptr_7914, %lay_7911) : !memref_gmem_bf16_1
      %iter_7916 = cute.get_iter(%view_7915) : !memref_gmem_bf16_1
      %tile_7917 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_7918 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %3056 = cute.get_scalars(%coord_7918) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_7919 = cute.make_coord(%3056) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_7920 = cute.get_layout(%view_7915) : !memref_gmem_bf16_1
      %3057:3 = cute.get_scalars(%lay_7920) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32_7921 = arith.constant 128 : i32
      %3058 = arith.ceildivsi %3057#0, %c128_i32_7921 : i32
      %c128_i64_7922 = arith.constant 128 : i64
      %3059 = arith.muli %3057#2, %c128_i64_7922 : i64
      %c128_i32_7923 = arith.constant 128 : i32
      %3060 = arith.ceildivsi %3057#1, %c128_i32_7923 : i32
      %shape_7924 = cute.make_shape(%3058, %3060) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_7925 = cute.assume(%3057#2) : (i64) -> !cute.i64<divby 8>
      %iv_7926 = cute.assume(%3059) : (i64) -> !cute.i64<divby 1024>
      %stride_7927 = cute.make_stride(%iv_7925, %iv_7926) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_7928 = cute.make_layout(%shape_7924, %stride_7927) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %3061:4 = cute.get_scalars(%lay_7928) <{only_dynamic}> : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %3062 = cute.get_scalars(%coord_7919) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_7929 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %iv_7930 = cute.assume(%3061#2) : (i64) -> !cute.i64<divby 8>
      %stride_7931 = cute.make_stride(%iv_7930) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_7932 = cute.make_layout(%shape_7929, %stride_7931) : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %idx_7933 = cute.crd2idx(%coord_7919, %lay_7928) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_7934 = cute.get_iter(%view_7915) : !memref_gmem_bf16_1
      %ptr_7935 = cute.add_offset(%iter_7934, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7936 = cute.make_view(%ptr_7935, %lay_7932) : !memref_gmem_bf16_2
      %iter_7937 = cute.get_iter(%view_7936) : !memref_gmem_bf16_2
      %coord_7938 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_7939 = cute.get_iter(%view_7738) : !memref_smem_bf16_
      %3063 = cute.get_scalars(%coord_7938) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_7940 = arith.constant 8 : i32
      %3064 = arith.divsi %3063, %c8_i32_7940 : i32
      %c8_i32_7941 = arith.constant 8 : i32
      %3065 = arith.remsi %3063, %c8_i32_7941 : i32
      %c8_i32_7942 = arith.constant 8 : i32
      %3066 = arith.muli %3065, %c8_i32_7942 : i32
      %c8_i32_7943 = arith.constant 8 : i32
      %3067 = arith.divsi %3064, %c8_i32_7943 : i32
      %c8_i32_7944 = arith.constant 8 : i32
      %3068 = arith.remsi %3064, %c8_i32_7944 : i32
      %c64_i32_7945 = arith.constant 64 : i32
      %3069 = arith.muli %3068, %c64_i32_7945 : i32
      %3070 = arith.addi %3066, %3069 : i32
      %c0_i32_7946 = arith.constant 0 : i32
      %3071 = arith.xori %3070, %c0_i32_7946 : i32
      %c8_i32_7947 = arith.constant 8 : i32
      %3072 = arith.divsi %3063, %c8_i32_7947 : i32
      %c8_i32_7948 = arith.constant 8 : i32
      %3073 = arith.remsi %3063, %c8_i32_7948 : i32
      %c8_i32_7949 = arith.constant 8 : i32
      %3074 = arith.divsi %3072, %c8_i32_7949 : i32
      %c8_i32_7950 = arith.constant 8 : i32
      %3075 = arith.remsi %3072, %c8_i32_7950 : i32
      %c512_i32_7951 = arith.constant 512 : i32
      %3076 = arith.muli %3074, %c512_i32_7951 : i32
      %c64_i32_7952 = arith.constant 64 : i32
      %3077 = arith.andi %3071, %c64_i32_7952 : i32
      %c0_i32_7953 = arith.constant 0 : i32
      %3078 = arith.cmpi eq, %3077, %c0_i32_7953 : i32
      %3079 = scf.if %3078 -> (i32) {
        %c8_i32_8494 = arith.constant 8 : i32
        scf.yield %c8_i32_8494 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_7954 = arith.constant 128 : i32
      %3080 = arith.andi %3071, %c128_i32_7954 : i32
      %c0_i32_7955 = arith.constant 0 : i32
      %3081 = arith.cmpi eq, %3080, %c0_i32_7955 : i32
      %3082 = scf.if %3081 -> (i32) {
        %c16_i32_8494 = arith.constant 16 : i32
        scf.yield %c16_i32_8494 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_7956 = arith.constant 256 : i32
      %3083 = arith.andi %3071, %c256_i32_7956 : i32
      %c0_i32_7957 = arith.constant 0 : i32
      %3084 = arith.cmpi eq, %3083, %c0_i32_7957 : i32
      %3085 = scf.if %3084 -> (i32) {
        %c32_i32_8494 = arith.constant 32 : i32
        scf.yield %c32_i32_8494 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_7958 = arith.constant 8 : i32
      %3086 = arith.andi %3071, %c8_i32_7958 : i32
      %c0_i32_7959 = arith.constant 0 : i32
      %3087 = arith.cmpi eq, %3086, %c0_i32_7959 : i32
      %3088 = scf.if %3087 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_7960 = arith.constant 16 : i32
      %3089 = arith.andi %3071, %c16_i32_7960 : i32
      %c0_i32_7961 = arith.constant 0 : i32
      %3090 = arith.cmpi eq, %3089, %c0_i32_7961 : i32
      %3091 = scf.if %3090 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_7962 = arith.constant 32 : i32
      %3092 = arith.andi %3071, %c32_i32_7962 : i32
      %c0_i32_7963 = arith.constant 0 : i32
      %3093 = arith.cmpi eq, %3092, %c0_i32_7963 : i32
      %3094 = scf.if %3093 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_7964 = arith.constant 448 : i32
      %3095 = arith.andi %3071, %c448_i32_7964 : i32
      %c3_i32_7965 = arith.constant 3 : i32
      %3096 = arith.shrsi %3095, %c3_i32_7965 : i32
      %3097 = arith.xori %3071, %3096 : i32
      %3098 = arith.addi %3097, %3076 : i32
      %c128_i32_7966 = arith.constant 128 : i32
      %3099 = arith.muli %3079, %c128_i32_7966 : i32
      %c64_i32_7967 = arith.constant 64 : i32
      %3100 = arith.muli %3082, %c64_i32_7967 : i32
      %c32_i32_7968 = arith.constant 32 : i32
      %3101 = arith.muli %3085, %c32_i32_7968 : i32
      %c16_i32_7969 = arith.constant 16 : i32
      %3102 = arith.muli %3088, %c16_i32_7969 : i32
      %c8_i32_7970 = arith.constant 8 : i32
      %3103 = arith.muli %3091, %c8_i32_7970 : i32
      %c4_i32_7971 = arith.constant 4 : i32
      %3104 = arith.muli %3094, %c4_i32_7971 : i32
      %c1024_i32_7972 = arith.constant 1024 : i32
      %3105 = arith.muli %3079, %c1024_i32_7972 : i32
      %c512_i32_7973 = arith.constant 512 : i32
      %3106 = arith.muli %3082, %c512_i32_7973 : i32
      %c256_i32_7974 = arith.constant 256 : i32
      %3107 = arith.muli %3085, %c256_i32_7974 : i32
      %c128_i32_7975 = arith.constant 128 : i32
      %3108 = arith.muli %3088, %c128_i32_7975 : i32
      %c64_i32_7976 = arith.constant 64 : i32
      %3109 = arith.muli %3091, %c64_i32_7976 : i32
      %c32_i32_7977 = arith.constant 32 : i32
      %3110 = arith.muli %3094, %c32_i32_7977 : i32
      %iv_7978 = cute.assume(%3098) : (i32) -> !cute.i32<divby 8>
      %int_tuple_7979 = cute.make_int_tuple(%iv_7978) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_7980 = cute.add_offset(%iter_7939, %int_tuple_7979) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7981 = cute.make_view(%ptr_7980) : !memref_smem_bf16_3
      %iter_7982 = cute.get_iter(%view_7981) : !memref_smem_bf16_3
      %coord_7983 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_7984 = cute.get_iter(%view_7936) : !memref_gmem_bf16_2
      %lay_7985 = cute.get_layout(%view_7936) : !memref_gmem_bf16_2
      %3111 = cute.get_scalars(%lay_7985) <{only_dynamic}> : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %3112 = cute.get_scalars(%coord_7983) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_7986 = arith.constant 16 : i64
      %3113 = arith.muli %3111, %c16_i64_7986 : i64
      %c128_i64_7987 = arith.constant 128 : i64
      %3114 = arith.muli %3111, %c128_i64_7987 : i64
      %c16_i64_7988 = arith.constant 16 : i64
      %3115 = arith.muli %3111, %c16_i64_7988 : i64
      %c8_i32_7989 = arith.constant 8 : i32
      %3116 = arith.divsi %3112, %c8_i32_7989 : i32
      %c8_i32_7990 = arith.constant 8 : i32
      %3117 = arith.remsi %3112, %c8_i32_7990 : i32
      %c8_i32_7991 = arith.constant 8 : i32
      %3118 = arith.muli %3117, %c8_i32_7991 : i32
      %3119 = arith.extsi %3116 : i32 to i64
      %3120 = arith.muli %3119, %3111 : i64
      %3121 = arith.extsi %3118 : i32 to i64
      %3122 = arith.addi %3121, %3120 : i64
      %iv_7992 = cute.assume(%3122) : (i64) -> !cute.i64<divby 8>
      %int_tuple_7993 = cute.make_int_tuple(%iv_7992) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_7994 = cute.add_offset(%iter_7984, %int_tuple_7993) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_7995 = cute.make_shape() : () -> !cute.shape<"((8,1),8,2)">
      %iv_7996 = cute.assume(%3113) : (i64) -> !cute.i64<divby 128>
      %stride_7997 = cute.make_stride(%iv_7996) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_7998 = cute.make_layout(%shape_7995, %stride_7997) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %view_7999 = cute.make_view(%ptr_7994, %lay_7998) : !memref_gmem_bf16_4
      %iter_8000 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
      %lay_8001 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
      %3123 = cute.get_scalars(%lay_8001) <{only_dynamic}> : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %lay_8002 = cute.make_layout() : !cute.layout<"((8,1),8,2):((1,0),16,8)">
      %rmem_8003 = cute.memref.alloca(%lay_8002) : !memref_rmem_bf16_27
      %iter_8004 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
      %iter_8005 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
      %c1_i32_8006 = arith.constant 1 : i32
      %c128_i32_8007 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_8006 number_of_threads = %c128_i32_8007
      %lay_8008 = cute.get_layout(%view_7981) : !memref_smem_bf16_3
      %3124 = cute.get_shape(%lay_8008) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8009, %e1_8010, %e2_8011, %e3_8012 = cute.get_leaves(%3124) : !cute.shape<"((8,1),8,2)">
      %lay_8013 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
      %3125 = cute.get_shape(%lay_8013) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8014, %e1_8015, %e2_8016, %e3_8017 = cute.get_leaves(%3125) : !cute.shape<"((8,1),8,2)">
      %lay_8018 = cute.get_layout(%view_7981) : !memref_smem_bf16_3
      %shape_8019 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_8020 = cute.make_layout() : !cute.layout<"1:0">
      %append_8021 = cute.append_to_rank<2> (%lay_8018, %lay_8020) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0">
      %view_8022 = cute.make_view(%iter_7982, %append_8021) : !memref_smem_bf16_3
      %iter_8023 = cute.get_iter(%view_8022) : !memref_smem_bf16_3
      %lay_8024 = cute.get_layout(%view_8022) : !memref_smem_bf16_3
      %3126 = cute.get_shape(%lay_8024) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8025, %e1_8026, %e2_8027, %e3_8028 = cute.get_leaves(%3126) : !cute.shape<"((8,1),8,2)">
      %iter_8029 = cute.get_iter(%view_8022) : !memref_smem_bf16_3
      %view_8030 = cute.make_view(%iter_8029) : !memref_smem_bf16_24
      %iter_8031 = cute.get_iter(%view_8030) : !memref_smem_bf16_24
      %iter_8032 = cute.get_iter(%view_8030) : !memref_smem_bf16_24
      %lay_8033 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
      %shape_8034 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_8035 = cute.make_layout() : !cute.layout<"1:0">
      %append_8036 = cute.append_to_rank<2> (%lay_8033, %lay_8035) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_8037 = cute.make_view(%iter_8005, %append_8036) : !memref_rmem_bf16_27
      %iter_8038 = cute.get_iter(%view_8037) : !memref_rmem_bf16_27
      %lay_8039 = cute.get_layout(%view_8037) : !memref_rmem_bf16_27
      %3127 = cute.get_shape(%lay_8039) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8040, %e1_8041, %e2_8042, %e3_8043 = cute.get_leaves(%3127) : !cute.shape<"((8,1),8,2)">
      %iter_8044 = cute.get_iter(%view_8037) : !memref_rmem_bf16_27
      %view_8045 = cute.make_view(%iter_8044) : !memref_rmem_bf16_28
      %iter_8046 = cute.get_iter(%view_8045) : !memref_rmem_bf16_28
      %iter_8047 = cute.get_iter(%view_8045) : !memref_rmem_bf16_28
      %lay_8048 = cute.get_layout(%view_8030) : !memref_smem_bf16_24
      %3128 = cute.get_shape(%lay_8048) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_8049, %e1_8050, %e2_8051, %e3_8052 = cute.get_leaves(%3128) : !cute.shape<"((8,1),(8,2))">
      %lay_8053 = cute.get_layout(%view_8045) : !memref_rmem_bf16_28
      %3129 = cute.get_shape(%lay_8053) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_8054, %e1_8055, %e2_8056, %e3_8057 = cute.get_leaves(%3129) : !cute.shape<"((8,1),(8,2))">
      %lay_8058 = cute.get_layout(%view_8030) : !memref_smem_bf16_24
      %sz_8059 = cute.size(%lay_8058) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.int_tuple<"16">
      %e0_8060 = cute.get_leaves(%sz_8059) : !cute.int_tuple<"16">
      %lay_8061 = cute.get_layout(%view_8045) : !memref_rmem_bf16_28
      %sz_8062 = cute.size(%lay_8061) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.int_tuple<"16">
      %e0_8063 = cute.get_leaves(%sz_8062) : !cute.int_tuple<"16">
      %3130 = cute.static : !cute.layout<"1:0">
      %iter_8064 = cute.get_iter(%view_8030) : !memref_smem_bf16_24
      %iter_8065 = cute.get_iter(%view_8045) : !memref_rmem_bf16_28
      %lay_8066 = cute.get_layout(%view_8030) : !memref_smem_bf16_24
      %lay_8067 = cute.get_layout(%view_8045) : !memref_rmem_bf16_28
      %append_8068 = cute.append_to_rank<2> (%lay_8066, %3130) : !cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">, !cute.layout<"1:0">
      %append_8069 = cute.append_to_rank<2> (%lay_8067, %3130) : !cute.layout<"((8,1),(8,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_8070 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">
      %lay_8071 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">
      %sz_8072 = cute.size(%lay_8070) <{mode = [1]}> : (!cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"16">
      %3131 = cute.get_scalars(%sz_8072) : !cute.int_tuple<"16">
      %c0_i32_8073 = arith.constant 0 : i32
      %c1_i32_8074 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_8073 to %3131 step %c1_i32_8074  : i32 {
        %coord_8494 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3370 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8495 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8070) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8497 = cute.add_offset(%iter_8064, %idx_8496) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8498 = cute.make_view(%ptr_8497, %lay_8495) : !memref_smem_bf16_13
        %3371 = cute.get_scalars(%coord_8494) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8499 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8500 = cute.crd2idx(%coord_8494, %lay_8071) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8501 = cute.add_offset(%iter_8065, %idx_8500) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8502 = cute.make_view(%ptr_8501, %lay_8499) : !memref_rmem_bf16_8
        %iter_8503 = cute.get_iter(%view_8498) : !memref_smem_bf16_13
        %iter_8504 = cute.get_iter(%view_8502) : !memref_rmem_bf16_8
        %3372 = builtin.unrealized_conversion_cast %iter_8503 : !cute.ptr<bf16, smem, align<16>> to !llvm.ptr<3>
        %3373 = builtin.unrealized_conversion_cast %iter_8504 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %3374 = llvm.load %3372 {alignment = 16 : i64} : !llvm.ptr<3> -> vector<8xbf16>
        llvm.store %3374, %3373 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_8075 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3132 = cute.get_shape(%lay_8075) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8076, %e1_8077, %e2_8078, %e3_8079 = cute.get_leaves(%3132) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8080 = cute.to_int_tuple(%e0_8076) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3133 = cute.get_scalars(%itup_8080) : !cute.int_tuple<"?">
      %itup_8081 = cute.to_int_tuple(%e1_8077) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3134 = cute.get_scalars(%itup_8081) : !cute.int_tuple<"?">
      %itup_8082 = cute.to_int_tuple(%e2_8078) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3135 = cute.get_scalars(%itup_8082) : !cute.int_tuple<"?">
      %itup_8083 = cute.to_int_tuple(%e3_8079) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3136 = cute.get_scalars(%itup_8083) : !cute.int_tuple<"?{div=8}">
      %shape_8084 = cute.make_shape(%itup_8080, %itup_8081, %itup_8082, %itup_8083) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_8085 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_8086 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_8087 = cute.make_layout(%shape_8084, %stride_8086) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_8088 = cute.make_view(%int_tuple_8085, %lay_8087) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_8089 = cute.get_iter(%view_8088) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_8090, %e1_8091, %e2_8092, %e3_8093 = cute.get_leaves(%iter_8089) : !cute.int_tuple<"(0,0,0,0)">
      %coord_8094 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_8095 = cute.get_layout(%view_8088) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %3137:4 = cute.get_scalars(%lay_8095) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %3138:2 = cute.get_scalars(%coord_8094) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_8096 = cute.assume(%3137#3) : (i32) -> !cute.i32<divby 8>
      %shape_8097 = cute.make_shape(%3137#1, %iv_8096) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_8098 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_8099 = cute.make_layout(%shape_8097, %stride_8098) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_8100 = cute.crd2idx(%coord_8094, %lay_8095) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_8101 = cute.get_iter(%view_8088) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_8102 = cute.add_offset(%iter_8101, %idx_8100) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_8103 = cute.make_view(%tup_8102, %lay_8099) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_8104 = cute.get_iter(%view_8103) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_8105, %e1_8106, %e2_8107, %e3_8108 = cute.get_leaves(%iter_8104) : !cute.int_tuple<"(?,0,?,0)">
      %3139 = cute.get_scalars(%e0_8105) : !cute.int_tuple<"?">
      %3140 = cute.get_scalars(%e2_8107) : !cute.int_tuple<"?">
      %tile_8109 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_8110 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %3141 = cute.get_scalars(%coord_8110) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_8111 = cute.make_coord(%3141) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_8112 = cute.get_layout(%view_8103) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %3142:2 = cute.get_scalars(%lay_8112) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_8113 = arith.constant 128 : i32
      %3143 = arith.ceildivsi %3142#0, %c128_i32_8113 : i32
      %c128_i32_8114 = arith.constant 128 : i32
      %3144 = arith.ceildivsi %3142#1, %c128_i32_8114 : i32
      %shape_8115 = cute.make_shape(%3143, %3144) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_8116 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_8117 = cute.make_layout(%shape_8115, %stride_8116) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_8118 = cute.crd2idx(%coord_8111, %lay_8117) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_8119 = cute.get_iter(%view_8103) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_8120 = cute.add_offset(%iter_8119, %idx_8118) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_8121 = cute.make_view(%tup_8120) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_8122 = cute.get_iter(%view_8121) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_8123, %e1_8124, %e2_8125, %e3_8126 = cute.get_leaves(%iter_8122) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %3145 = cute.get_scalars(%e0_8123) : !cute.int_tuple<"?">
      %3146 = cute.get_scalars(%e1_8124) : !cute.int_tuple<"?{div=128}">
      %3147 = cute.get_scalars(%e2_8125) : !cute.int_tuple<"?">
      %coord_8127 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_8128 = cute.get_iter(%view_8121) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %3148 = cute.get_scalars(%coord_8127) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_8129 = arith.constant 8 : i32
      %3149 = arith.divsi %3148, %c8_i32_8129 : i32
      %c8_i32_8130 = arith.constant 8 : i32
      %3150 = arith.remsi %3148, %c8_i32_8130 : i32
      %c8_i32_8131 = arith.constant 8 : i32
      %3151 = arith.muli %3150, %c8_i32_8131 : i32
      %iv_8132 = cute.assume(%3151) : (i32) -> !cute.i32<divby 8>
      %int_tuple_8133 = cute.make_int_tuple(%3149, %iv_8132) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_8134 = cute.add_offset(%iter_8128, %int_tuple_8133) : (!cute.int_tuple<"(?,?{div=128},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8135 = cute.make_view(%tup_8134) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_8136 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_8137, %e1_8138, %e2_8139, %e3_8140 = cute.get_leaves(%iter_8136) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3152 = cute.get_scalars(%e0_8137) : !cute.int_tuple<"?">
      %3153 = cute.get_scalars(%e1_8138) : !cute.int_tuple<"?">
      %3154 = cute.get_scalars(%e2_8139) : !cute.int_tuple<"?">
      %3155 = cute.get_scalars(%e3_8140) : !cute.int_tuple<"?{div=8}">
      %lay_8141 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
      %3156 = cute.get_shape(%lay_8141) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8142, %e1_8143, %e2_8144, %e3_8145 = cute.get_leaves(%3156) : !cute.shape<"((8,1),8,2)">
      %shape_8146 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_8147 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_8148 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_8149 = cute.memref.alloca(%lay_8148) : !memref_rmem_i8_
      %iter_8150 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
      %iter_8151 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
      %lay_8152 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
      %3157 = cute.get_shape(%lay_8152) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_8153, %e1_8154, %e2_8155 = cute.get_leaves(%3157) : !cute.shape<"(1,8,2)">
      %int_tuple_8156 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_8157 = cute.size(%int_tuple_8156) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_8158 = cute.get_leaves(%sz_8157) : !cute.int_tuple<"2">
      %coord_8159 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_8160 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8161 = cute.crd2idx(%coord_8159, %lay_8160) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_8162 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8163 = cute.add_offset(%iter_8162, %idx_8161) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8164 = cute.make_view(%tup_8163) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8165 = cute.get_iter(%view_8164) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8166, %e1_8167, %e2_8168, %e3_8169 = cute.get_leaves(%iter_8165) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3158 = cute.get_scalars(%e0_8166) : !cute.int_tuple<"?">
      %3159 = cute.get_scalars(%e1_8167) : !cute.int_tuple<"?">
      %3160 = cute.get_scalars(%e2_8168) : !cute.int_tuple<"?">
      %3161 = cute.get_scalars(%e3_8169) : !cute.int_tuple<"?{div=8}">
      %iter_8170 = cute.get_iter(%view_8164) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8171, %e1_8172, %e2_8173, %e3_8174 = cute.get_leaves(%iter_8170) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3162 = cute.get_scalars(%e0_8171) : !cute.int_tuple<"?">
      %3163 = cute.get_scalars(%e1_8172) : !cute.int_tuple<"?">
      %3164 = cute.get_scalars(%e2_8173) : !cute.int_tuple<"?">
      %3165 = cute.get_scalars(%e3_8174) : !cute.int_tuple<"?{div=8}">
      %iter_8175 = cute.get_iter(%view_8164) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8176, %e1_8177, %e2_8178, %e3_8179 = cute.get_leaves(%iter_8175) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3166 = cute.get_scalars(%e0_8176) : !cute.int_tuple<"?">
      %3167 = cute.get_scalars(%e1_8177) : !cute.int_tuple<"?">
      %3168 = cute.get_scalars(%e2_8178) : !cute.int_tuple<"?">
      %3169 = cute.get_scalars(%e3_8179) : !cute.int_tuple<"?{div=8}">
      %lay_8180 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3170 = cute.get_shape(%lay_8180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8181, %e1_8182, %e2_8183, %e3_8184 = cute.get_leaves(%3170) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8185 = cute.to_int_tuple(%e0_8181) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3171 = cute.get_scalars(%itup_8185) : !cute.int_tuple<"?">
      %itup_8186 = cute.to_int_tuple(%e1_8182) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3172 = cute.get_scalars(%itup_8186) : !cute.int_tuple<"?">
      %itup_8187 = cute.to_int_tuple(%e2_8183) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3173 = cute.get_scalars(%itup_8187) : !cute.int_tuple<"?">
      %itup_8188 = cute.to_int_tuple(%e3_8184) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3174 = cute.get_scalars(%itup_8188) : !cute.int_tuple<"?{div=8}">
      %coord_8189 = cute.make_coord(%e3_8179) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_8190 = cute.make_coord(%itup_8188) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %3175 = cute.get_scalars(%coord_8189) : !cute.coord<"?{div=8}">
      %3176 = cute.get_scalars(%coord_8190) : !cute.coord<"?{div=8}">
      %true_8191 = arith.constant true
      %3177 = arith.cmpi slt, %3175, %3176 : i32
      %3178 = arith.andi %true_8191, %3177 : i1
      %3179 = arith.extui %3178 : i1 to i8
      %coord_8192 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_8149, %coord_8192, %3179) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_8193 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_8194 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8195 = cute.crd2idx(%coord_8193, %lay_8194) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_8196 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8197 = cute.add_offset(%iter_8196, %idx_8195) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8198 = cute.make_view(%tup_8197) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8199 = cute.get_iter(%view_8198) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8200, %e1_8201, %e2_8202, %e3_8203 = cute.get_leaves(%iter_8199) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3180 = cute.get_scalars(%e0_8200) : !cute.int_tuple<"?">
      %3181 = cute.get_scalars(%e1_8201) : !cute.int_tuple<"?">
      %3182 = cute.get_scalars(%e2_8202) : !cute.int_tuple<"?">
      %3183 = cute.get_scalars(%e3_8203) : !cute.int_tuple<"?{div=8}">
      %iter_8204 = cute.get_iter(%view_8198) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8205, %e1_8206, %e2_8207, %e3_8208 = cute.get_leaves(%iter_8204) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3184 = cute.get_scalars(%e0_8205) : !cute.int_tuple<"?">
      %3185 = cute.get_scalars(%e1_8206) : !cute.int_tuple<"?">
      %3186 = cute.get_scalars(%e2_8207) : !cute.int_tuple<"?">
      %3187 = cute.get_scalars(%e3_8208) : !cute.int_tuple<"?{div=8}">
      %iter_8209 = cute.get_iter(%view_8198) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8210, %e1_8211, %e2_8212, %e3_8213 = cute.get_leaves(%iter_8209) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3188 = cute.get_scalars(%e0_8210) : !cute.int_tuple<"?">
      %3189 = cute.get_scalars(%e1_8211) : !cute.int_tuple<"?">
      %3190 = cute.get_scalars(%e2_8212) : !cute.int_tuple<"?">
      %3191 = cute.get_scalars(%e3_8213) : !cute.int_tuple<"?{div=8}">
      %lay_8214 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3192 = cute.get_shape(%lay_8214) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8215, %e1_8216, %e2_8217, %e3_8218 = cute.get_leaves(%3192) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8219 = cute.to_int_tuple(%e0_8215) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3193 = cute.get_scalars(%itup_8219) : !cute.int_tuple<"?">
      %itup_8220 = cute.to_int_tuple(%e1_8216) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3194 = cute.get_scalars(%itup_8220) : !cute.int_tuple<"?">
      %itup_8221 = cute.to_int_tuple(%e2_8217) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3195 = cute.get_scalars(%itup_8221) : !cute.int_tuple<"?">
      %itup_8222 = cute.to_int_tuple(%e3_8218) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3196 = cute.get_scalars(%itup_8222) : !cute.int_tuple<"?{div=8}">
      %coord_8223 = cute.make_coord(%e3_8213) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_8224 = cute.make_coord(%itup_8222) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %3197 = cute.get_scalars(%coord_8223) : !cute.coord<"?{div=8}">
      %3198 = cute.get_scalars(%coord_8224) : !cute.coord<"?{div=8}">
      %true_8225 = arith.constant true
      %3199 = arith.cmpi slt, %3197, %3198 : i32
      %3200 = arith.andi %true_8225, %3199 : i1
      %3201 = arith.extui %3200 : i1 to i8
      %coord_8226 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_8149, %coord_8226, %3201) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_8227 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_8228 = cute.size(%int_tuple_8227) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_8229 = cute.get_leaves(%sz_8228) : !cute.int_tuple<"8">
      %coord_8230 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_8231 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8232 = cute.crd2idx(%coord_8230, %lay_8231) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_8233 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8234 = cute.add_offset(%iter_8233, %idx_8232) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8235 = cute.make_view(%tup_8234) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8236 = cute.get_iter(%view_8235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8237, %e1_8238, %e2_8239, %e3_8240 = cute.get_leaves(%iter_8236) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3202 = cute.get_scalars(%e0_8237) : !cute.int_tuple<"?">
      %3203 = cute.get_scalars(%e1_8238) : !cute.int_tuple<"?">
      %3204 = cute.get_scalars(%e2_8239) : !cute.int_tuple<"?">
      %3205 = cute.get_scalars(%e3_8240) : !cute.int_tuple<"?{div=8}">
      %iter_8241 = cute.get_iter(%view_8235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8242, %e1_8243, %e2_8244, %e3_8245 = cute.get_leaves(%iter_8241) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3206 = cute.get_scalars(%e0_8242) : !cute.int_tuple<"?">
      %3207 = cute.get_scalars(%e1_8243) : !cute.int_tuple<"?">
      %3208 = cute.get_scalars(%e2_8244) : !cute.int_tuple<"?">
      %3209 = cute.get_scalars(%e3_8245) : !cute.int_tuple<"?{div=8}">
      %iter_8246 = cute.get_iter(%view_8235) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8247, %e1_8248, %e2_8249, %e3_8250 = cute.get_leaves(%iter_8246) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3210 = cute.get_scalars(%e0_8247) : !cute.int_tuple<"?">
      %3211 = cute.get_scalars(%e1_8248) : !cute.int_tuple<"?">
      %3212 = cute.get_scalars(%e2_8249) : !cute.int_tuple<"?">
      %3213 = cute.get_scalars(%e3_8250) : !cute.int_tuple<"?{div=8}">
      %lay_8251 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3214 = cute.get_shape(%lay_8251) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8252, %e1_8253, %e2_8254, %e3_8255 = cute.get_leaves(%3214) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8256 = cute.to_int_tuple(%e0_8252) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3215 = cute.get_scalars(%itup_8256) : !cute.int_tuple<"?">
      %itup_8257 = cute.to_int_tuple(%e1_8253) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3216 = cute.get_scalars(%itup_8257) : !cute.int_tuple<"?">
      %itup_8258 = cute.to_int_tuple(%e2_8254) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3217 = cute.get_scalars(%itup_8258) : !cute.int_tuple<"?">
      %itup_8259 = cute.to_int_tuple(%e3_8255) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3218 = cute.get_scalars(%itup_8259) : !cute.int_tuple<"?{div=8}">
      %coord_8260 = cute.make_coord(%e1_8248) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8261 = cute.make_coord(%itup_8257) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3219 = cute.get_scalars(%coord_8260) : !cute.coord<"?">
      %3220 = cute.get_scalars(%coord_8261) : !cute.coord<"?">
      %true_8262 = arith.constant true
      %3221 = arith.cmpi slt, %3219, %3220 : i32
      %3222 = arith.andi %true_8262, %3221 : i1
      scf.if %3222 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8263 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_8264 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8265 = cute.crd2idx(%coord_8263, %lay_8264) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_8266 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8267 = cute.add_offset(%iter_8266, %idx_8265) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8268 = cute.make_view(%tup_8267) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8269 = cute.get_iter(%view_8268) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8270, %e1_8271, %e2_8272, %e3_8273 = cute.get_leaves(%iter_8269) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3223 = cute.get_scalars(%e0_8270) : !cute.int_tuple<"?">
      %3224 = cute.get_scalars(%e1_8271) : !cute.int_tuple<"?">
      %3225 = cute.get_scalars(%e2_8272) : !cute.int_tuple<"?">
      %3226 = cute.get_scalars(%e3_8273) : !cute.int_tuple<"?{div=8}">
      %iter_8274 = cute.get_iter(%view_8268) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8275, %e1_8276, %e2_8277, %e3_8278 = cute.get_leaves(%iter_8274) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3227 = cute.get_scalars(%e0_8275) : !cute.int_tuple<"?">
      %3228 = cute.get_scalars(%e1_8276) : !cute.int_tuple<"?">
      %3229 = cute.get_scalars(%e2_8277) : !cute.int_tuple<"?">
      %3230 = cute.get_scalars(%e3_8278) : !cute.int_tuple<"?{div=8}">
      %iter_8279 = cute.get_iter(%view_8268) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8280, %e1_8281, %e2_8282, %e3_8283 = cute.get_leaves(%iter_8279) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3231 = cute.get_scalars(%e0_8280) : !cute.int_tuple<"?">
      %3232 = cute.get_scalars(%e1_8281) : !cute.int_tuple<"?">
      %3233 = cute.get_scalars(%e2_8282) : !cute.int_tuple<"?">
      %3234 = cute.get_scalars(%e3_8283) : !cute.int_tuple<"?{div=8}">
      %lay_8284 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3235 = cute.get_shape(%lay_8284) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8285, %e1_8286, %e2_8287, %e3_8288 = cute.get_leaves(%3235) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8289 = cute.to_int_tuple(%e0_8285) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3236 = cute.get_scalars(%itup_8289) : !cute.int_tuple<"?">
      %itup_8290 = cute.to_int_tuple(%e1_8286) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3237 = cute.get_scalars(%itup_8290) : !cute.int_tuple<"?">
      %itup_8291 = cute.to_int_tuple(%e2_8287) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3238 = cute.get_scalars(%itup_8291) : !cute.int_tuple<"?">
      %itup_8292 = cute.to_int_tuple(%e3_8288) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3239 = cute.get_scalars(%itup_8292) : !cute.int_tuple<"?{div=8}">
      %coord_8293 = cute.make_coord(%e1_8281) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8294 = cute.make_coord(%itup_8290) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3240 = cute.get_scalars(%coord_8293) : !cute.coord<"?">
      %3241 = cute.get_scalars(%coord_8294) : !cute.coord<"?">
      %true_8295 = arith.constant true
      %3242 = arith.cmpi slt, %3240, %3241 : i32
      %3243 = arith.andi %true_8295, %3242 : i1
      scf.if %3243 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8296 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_8297 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8298 = cute.crd2idx(%coord_8296, %lay_8297) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_8299 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8300 = cute.add_offset(%iter_8299, %idx_8298) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8301 = cute.make_view(%tup_8300) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8302 = cute.get_iter(%view_8301) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8303, %e1_8304, %e2_8305, %e3_8306 = cute.get_leaves(%iter_8302) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3244 = cute.get_scalars(%e0_8303) : !cute.int_tuple<"?">
      %3245 = cute.get_scalars(%e1_8304) : !cute.int_tuple<"?">
      %3246 = cute.get_scalars(%e2_8305) : !cute.int_tuple<"?">
      %3247 = cute.get_scalars(%e3_8306) : !cute.int_tuple<"?{div=8}">
      %iter_8307 = cute.get_iter(%view_8301) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8308, %e1_8309, %e2_8310, %e3_8311 = cute.get_leaves(%iter_8307) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3248 = cute.get_scalars(%e0_8308) : !cute.int_tuple<"?">
      %3249 = cute.get_scalars(%e1_8309) : !cute.int_tuple<"?">
      %3250 = cute.get_scalars(%e2_8310) : !cute.int_tuple<"?">
      %3251 = cute.get_scalars(%e3_8311) : !cute.int_tuple<"?{div=8}">
      %iter_8312 = cute.get_iter(%view_8301) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8313, %e1_8314, %e2_8315, %e3_8316 = cute.get_leaves(%iter_8312) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3252 = cute.get_scalars(%e0_8313) : !cute.int_tuple<"?">
      %3253 = cute.get_scalars(%e1_8314) : !cute.int_tuple<"?">
      %3254 = cute.get_scalars(%e2_8315) : !cute.int_tuple<"?">
      %3255 = cute.get_scalars(%e3_8316) : !cute.int_tuple<"?{div=8}">
      %lay_8317 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3256 = cute.get_shape(%lay_8317) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8318, %e1_8319, %e2_8320, %e3_8321 = cute.get_leaves(%3256) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8322 = cute.to_int_tuple(%e0_8318) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3257 = cute.get_scalars(%itup_8322) : !cute.int_tuple<"?">
      %itup_8323 = cute.to_int_tuple(%e1_8319) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3258 = cute.get_scalars(%itup_8323) : !cute.int_tuple<"?">
      %itup_8324 = cute.to_int_tuple(%e2_8320) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3259 = cute.get_scalars(%itup_8324) : !cute.int_tuple<"?">
      %itup_8325 = cute.to_int_tuple(%e3_8321) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3260 = cute.get_scalars(%itup_8325) : !cute.int_tuple<"?{div=8}">
      %coord_8326 = cute.make_coord(%e1_8314) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8327 = cute.make_coord(%itup_8323) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3261 = cute.get_scalars(%coord_8326) : !cute.coord<"?">
      %3262 = cute.get_scalars(%coord_8327) : !cute.coord<"?">
      %true_8328 = arith.constant true
      %3263 = arith.cmpi slt, %3261, %3262 : i32
      %3264 = arith.andi %true_8328, %3263 : i1
      scf.if %3264 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8329 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_8330 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8331 = cute.crd2idx(%coord_8329, %lay_8330) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_8332 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8333 = cute.add_offset(%iter_8332, %idx_8331) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8334 = cute.make_view(%tup_8333) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8335 = cute.get_iter(%view_8334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8336, %e1_8337, %e2_8338, %e3_8339 = cute.get_leaves(%iter_8335) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3265 = cute.get_scalars(%e0_8336) : !cute.int_tuple<"?">
      %3266 = cute.get_scalars(%e1_8337) : !cute.int_tuple<"?">
      %3267 = cute.get_scalars(%e2_8338) : !cute.int_tuple<"?">
      %3268 = cute.get_scalars(%e3_8339) : !cute.int_tuple<"?{div=8}">
      %iter_8340 = cute.get_iter(%view_8334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8341, %e1_8342, %e2_8343, %e3_8344 = cute.get_leaves(%iter_8340) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3269 = cute.get_scalars(%e0_8341) : !cute.int_tuple<"?">
      %3270 = cute.get_scalars(%e1_8342) : !cute.int_tuple<"?">
      %3271 = cute.get_scalars(%e2_8343) : !cute.int_tuple<"?">
      %3272 = cute.get_scalars(%e3_8344) : !cute.int_tuple<"?{div=8}">
      %iter_8345 = cute.get_iter(%view_8334) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8346, %e1_8347, %e2_8348, %e3_8349 = cute.get_leaves(%iter_8345) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3273 = cute.get_scalars(%e0_8346) : !cute.int_tuple<"?">
      %3274 = cute.get_scalars(%e1_8347) : !cute.int_tuple<"?">
      %3275 = cute.get_scalars(%e2_8348) : !cute.int_tuple<"?">
      %3276 = cute.get_scalars(%e3_8349) : !cute.int_tuple<"?{div=8}">
      %lay_8350 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3277 = cute.get_shape(%lay_8350) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8351, %e1_8352, %e2_8353, %e3_8354 = cute.get_leaves(%3277) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8355 = cute.to_int_tuple(%e0_8351) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3278 = cute.get_scalars(%itup_8355) : !cute.int_tuple<"?">
      %itup_8356 = cute.to_int_tuple(%e1_8352) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3279 = cute.get_scalars(%itup_8356) : !cute.int_tuple<"?">
      %itup_8357 = cute.to_int_tuple(%e2_8353) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3280 = cute.get_scalars(%itup_8357) : !cute.int_tuple<"?">
      %itup_8358 = cute.to_int_tuple(%e3_8354) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3281 = cute.get_scalars(%itup_8358) : !cute.int_tuple<"?{div=8}">
      %coord_8359 = cute.make_coord(%e1_8347) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8360 = cute.make_coord(%itup_8356) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3282 = cute.get_scalars(%coord_8359) : !cute.coord<"?">
      %3283 = cute.get_scalars(%coord_8360) : !cute.coord<"?">
      %true_8361 = arith.constant true
      %3284 = arith.cmpi slt, %3282, %3283 : i32
      %3285 = arith.andi %true_8361, %3284 : i1
      scf.if %3285 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8362 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_8363 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8364 = cute.crd2idx(%coord_8362, %lay_8363) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_8365 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8366 = cute.add_offset(%iter_8365, %idx_8364) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8367 = cute.make_view(%tup_8366) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8368 = cute.get_iter(%view_8367) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8369, %e1_8370, %e2_8371, %e3_8372 = cute.get_leaves(%iter_8368) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3286 = cute.get_scalars(%e0_8369) : !cute.int_tuple<"?">
      %3287 = cute.get_scalars(%e1_8370) : !cute.int_tuple<"?">
      %3288 = cute.get_scalars(%e2_8371) : !cute.int_tuple<"?">
      %3289 = cute.get_scalars(%e3_8372) : !cute.int_tuple<"?{div=8}">
      %iter_8373 = cute.get_iter(%view_8367) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8374, %e1_8375, %e2_8376, %e3_8377 = cute.get_leaves(%iter_8373) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3290 = cute.get_scalars(%e0_8374) : !cute.int_tuple<"?">
      %3291 = cute.get_scalars(%e1_8375) : !cute.int_tuple<"?">
      %3292 = cute.get_scalars(%e2_8376) : !cute.int_tuple<"?">
      %3293 = cute.get_scalars(%e3_8377) : !cute.int_tuple<"?{div=8}">
      %iter_8378 = cute.get_iter(%view_8367) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8379, %e1_8380, %e2_8381, %e3_8382 = cute.get_leaves(%iter_8378) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3294 = cute.get_scalars(%e0_8379) : !cute.int_tuple<"?">
      %3295 = cute.get_scalars(%e1_8380) : !cute.int_tuple<"?">
      %3296 = cute.get_scalars(%e2_8381) : !cute.int_tuple<"?">
      %3297 = cute.get_scalars(%e3_8382) : !cute.int_tuple<"?{div=8}">
      %lay_8383 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3298 = cute.get_shape(%lay_8383) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8384, %e1_8385, %e2_8386, %e3_8387 = cute.get_leaves(%3298) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8388 = cute.to_int_tuple(%e0_8384) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3299 = cute.get_scalars(%itup_8388) : !cute.int_tuple<"?">
      %itup_8389 = cute.to_int_tuple(%e1_8385) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3300 = cute.get_scalars(%itup_8389) : !cute.int_tuple<"?">
      %itup_8390 = cute.to_int_tuple(%e2_8386) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3301 = cute.get_scalars(%itup_8390) : !cute.int_tuple<"?">
      %itup_8391 = cute.to_int_tuple(%e3_8387) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3302 = cute.get_scalars(%itup_8391) : !cute.int_tuple<"?{div=8}">
      %coord_8392 = cute.make_coord(%e1_8380) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8393 = cute.make_coord(%itup_8389) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3303 = cute.get_scalars(%coord_8392) : !cute.coord<"?">
      %3304 = cute.get_scalars(%coord_8393) : !cute.coord<"?">
      %true_8394 = arith.constant true
      %3305 = arith.cmpi slt, %3303, %3304 : i32
      %3306 = arith.andi %true_8394, %3305 : i1
      scf.if %3306 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"64">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8395 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_8396 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8397 = cute.crd2idx(%coord_8395, %lay_8396) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_8398 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8399 = cute.add_offset(%iter_8398, %idx_8397) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8400 = cute.make_view(%tup_8399) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8401 = cute.get_iter(%view_8400) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8402, %e1_8403, %e2_8404, %e3_8405 = cute.get_leaves(%iter_8401) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3307 = cute.get_scalars(%e0_8402) : !cute.int_tuple<"?">
      %3308 = cute.get_scalars(%e1_8403) : !cute.int_tuple<"?">
      %3309 = cute.get_scalars(%e2_8404) : !cute.int_tuple<"?">
      %3310 = cute.get_scalars(%e3_8405) : !cute.int_tuple<"?{div=8}">
      %iter_8406 = cute.get_iter(%view_8400) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8407, %e1_8408, %e2_8409, %e3_8410 = cute.get_leaves(%iter_8406) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3311 = cute.get_scalars(%e0_8407) : !cute.int_tuple<"?">
      %3312 = cute.get_scalars(%e1_8408) : !cute.int_tuple<"?">
      %3313 = cute.get_scalars(%e2_8409) : !cute.int_tuple<"?">
      %3314 = cute.get_scalars(%e3_8410) : !cute.int_tuple<"?{div=8}">
      %iter_8411 = cute.get_iter(%view_8400) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8412, %e1_8413, %e2_8414, %e3_8415 = cute.get_leaves(%iter_8411) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3315 = cute.get_scalars(%e0_8412) : !cute.int_tuple<"?">
      %3316 = cute.get_scalars(%e1_8413) : !cute.int_tuple<"?">
      %3317 = cute.get_scalars(%e2_8414) : !cute.int_tuple<"?">
      %3318 = cute.get_scalars(%e3_8415) : !cute.int_tuple<"?{div=8}">
      %lay_8416 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3319 = cute.get_shape(%lay_8416) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8417, %e1_8418, %e2_8419, %e3_8420 = cute.get_leaves(%3319) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8421 = cute.to_int_tuple(%e0_8417) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3320 = cute.get_scalars(%itup_8421) : !cute.int_tuple<"?">
      %itup_8422 = cute.to_int_tuple(%e1_8418) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3321 = cute.get_scalars(%itup_8422) : !cute.int_tuple<"?">
      %itup_8423 = cute.to_int_tuple(%e2_8419) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3322 = cute.get_scalars(%itup_8423) : !cute.int_tuple<"?">
      %itup_8424 = cute.to_int_tuple(%e3_8420) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3323 = cute.get_scalars(%itup_8424) : !cute.int_tuple<"?{div=8}">
      %coord_8425 = cute.make_coord(%e1_8413) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8426 = cute.make_coord(%itup_8422) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3324 = cute.get_scalars(%coord_8425) : !cute.coord<"?">
      %3325 = cute.get_scalars(%coord_8426) : !cute.coord<"?">
      %true_8427 = arith.constant true
      %3326 = arith.cmpi slt, %3324, %3325 : i32
      %3327 = arith.andi %true_8427, %3326 : i1
      scf.if %3327 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"80">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8428 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_8429 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8430 = cute.crd2idx(%coord_8428, %lay_8429) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_8431 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8432 = cute.add_offset(%iter_8431, %idx_8430) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8433 = cute.make_view(%tup_8432) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8434 = cute.get_iter(%view_8433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8435, %e1_8436, %e2_8437, %e3_8438 = cute.get_leaves(%iter_8434) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3328 = cute.get_scalars(%e0_8435) : !cute.int_tuple<"?">
      %3329 = cute.get_scalars(%e1_8436) : !cute.int_tuple<"?">
      %3330 = cute.get_scalars(%e2_8437) : !cute.int_tuple<"?">
      %3331 = cute.get_scalars(%e3_8438) : !cute.int_tuple<"?{div=8}">
      %iter_8439 = cute.get_iter(%view_8433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8440, %e1_8441, %e2_8442, %e3_8443 = cute.get_leaves(%iter_8439) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3332 = cute.get_scalars(%e0_8440) : !cute.int_tuple<"?">
      %3333 = cute.get_scalars(%e1_8441) : !cute.int_tuple<"?">
      %3334 = cute.get_scalars(%e2_8442) : !cute.int_tuple<"?">
      %3335 = cute.get_scalars(%e3_8443) : !cute.int_tuple<"?{div=8}">
      %iter_8444 = cute.get_iter(%view_8433) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8445, %e1_8446, %e2_8447, %e3_8448 = cute.get_leaves(%iter_8444) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3336 = cute.get_scalars(%e0_8445) : !cute.int_tuple<"?">
      %3337 = cute.get_scalars(%e1_8446) : !cute.int_tuple<"?">
      %3338 = cute.get_scalars(%e2_8447) : !cute.int_tuple<"?">
      %3339 = cute.get_scalars(%e3_8448) : !cute.int_tuple<"?{div=8}">
      %lay_8449 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3340 = cute.get_shape(%lay_8449) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8450, %e1_8451, %e2_8452, %e3_8453 = cute.get_leaves(%3340) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8454 = cute.to_int_tuple(%e0_8450) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3341 = cute.get_scalars(%itup_8454) : !cute.int_tuple<"?">
      %itup_8455 = cute.to_int_tuple(%e1_8451) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3342 = cute.get_scalars(%itup_8455) : !cute.int_tuple<"?">
      %itup_8456 = cute.to_int_tuple(%e2_8452) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3343 = cute.get_scalars(%itup_8456) : !cute.int_tuple<"?">
      %itup_8457 = cute.to_int_tuple(%e3_8453) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3344 = cute.get_scalars(%itup_8457) : !cute.int_tuple<"?{div=8}">
      %coord_8458 = cute.make_coord(%e1_8446) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8459 = cute.make_coord(%itup_8455) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3345 = cute.get_scalars(%coord_8458) : !cute.coord<"?">
      %3346 = cute.get_scalars(%coord_8459) : !cute.coord<"?">
      %true_8460 = arith.constant true
      %3347 = arith.cmpi slt, %3345, %3346 : i32
      %3348 = arith.andi %true_8460, %3347 : i1
      scf.if %3348 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"96">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8461 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_8462 = cute.get_layout(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8463 = cute.crd2idx(%coord_8461, %lay_8462) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_8464 = cute.get_iter(%view_8135) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8465 = cute.add_offset(%iter_8464, %idx_8463) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8466 = cute.make_view(%tup_8465) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8467 = cute.get_iter(%view_8466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8468, %e1_8469, %e2_8470, %e3_8471 = cute.get_leaves(%iter_8467) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3349 = cute.get_scalars(%e0_8468) : !cute.int_tuple<"?">
      %3350 = cute.get_scalars(%e1_8469) : !cute.int_tuple<"?">
      %3351 = cute.get_scalars(%e2_8470) : !cute.int_tuple<"?">
      %3352 = cute.get_scalars(%e3_8471) : !cute.int_tuple<"?{div=8}">
      %iter_8472 = cute.get_iter(%view_8466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8473, %e1_8474, %e2_8475, %e3_8476 = cute.get_leaves(%iter_8472) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3353 = cute.get_scalars(%e0_8473) : !cute.int_tuple<"?">
      %3354 = cute.get_scalars(%e1_8474) : !cute.int_tuple<"?">
      %3355 = cute.get_scalars(%e2_8475) : !cute.int_tuple<"?">
      %3356 = cute.get_scalars(%e3_8476) : !cute.int_tuple<"?{div=8}">
      %iter_8477 = cute.get_iter(%view_8466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8478, %e1_8479, %e2_8480, %e3_8481 = cute.get_leaves(%iter_8477) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3357 = cute.get_scalars(%e0_8478) : !cute.int_tuple<"?">
      %3358 = cute.get_scalars(%e1_8479) : !cute.int_tuple<"?">
      %3359 = cute.get_scalars(%e2_8480) : !cute.int_tuple<"?">
      %3360 = cute.get_scalars(%e3_8481) : !cute.int_tuple<"?{div=8}">
      %lay_8482 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3361 = cute.get_shape(%lay_8482) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8483, %e1_8484, %e2_8485, %e3_8486 = cute.get_leaves(%3361) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8487 = cute.to_int_tuple(%e0_8483) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3362 = cute.get_scalars(%itup_8487) : !cute.int_tuple<"?">
      %itup_8488 = cute.to_int_tuple(%e1_8484) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3363 = cute.get_scalars(%itup_8488) : !cute.int_tuple<"?">
      %itup_8489 = cute.to_int_tuple(%e2_8485) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3364 = cute.get_scalars(%itup_8489) : !cute.int_tuple<"?">
      %itup_8490 = cute.to_int_tuple(%e3_8486) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3365 = cute.get_scalars(%itup_8490) : !cute.int_tuple<"?{div=8}">
      %coord_8491 = cute.make_coord(%e1_8479) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8492 = cute.make_coord(%itup_8488) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3366 = cute.get_scalars(%coord_8491) : !cute.coord<"?">
      %3367 = cute.get_scalars(%coord_8492) : !cute.coord<"?">
      %true_8493 = arith.constant true
      %3368 = arith.cmpi slt, %3366, %3367 : i32
      %3369 = arith.andi %true_8493, %3368 : i1
      scf.if %3369 {
        %coord_8494 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8495 = cute.get_layout(%rmem_8003) : !memref_rmem_bf16_27
        %idx_8496 = cute.crd2idx(%coord_8494, %lay_8495) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"112">
        %iter_8497 = cute.get_iter(%rmem_8003) : !memref_rmem_bf16_27
        %ptr_8498 = cute.add_offset(%iter_8497, %idx_8496) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8499 = cute.make_view(%ptr_8498) : !memref_rmem_bf16_29
        %iter_8500 = cute.get_iter(%view_8499) : !memref_rmem_bf16_29
        %coord_8501 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8502 = cute.get_layout(%view_7999) : !memref_gmem_bf16_4
        %idx_8503 = cute.crd2idx(%coord_8501, %lay_8502) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_8504 = cute.get_iter(%view_7999) : !memref_gmem_bf16_4
        %ptr_8505 = cute.add_offset(%iter_8504, %idx_8503) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8506 = cute.make_view(%ptr_8505) : !memref_gmem_bf16_6
        %iter_8507 = cute.get_iter(%view_8506) : !memref_gmem_bf16_6
        %coord_8508 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8509 = cute.get_layout(%rmem_8149) : !memref_rmem_i8_
        %idx_8510 = cute.crd2idx(%coord_8508, %lay_8509) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8511 = cute.get_iter(%rmem_8149) : !memref_rmem_i8_
        %ptr_8512 = cute.add_offset(%iter_8511, %idx_8510) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8513 = cute.make_view(%ptr_8512) : !memref_rmem_i8_2
        %iter_8514 = cute.get_iter(%view_8513) : !memref_rmem_i8_2
        %lay_8515 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %3370 = cute.get_shape(%lay_8515) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8516, %e1_8517, %e2_8518 = cute.get_leaves(%3370) : !cute.shape<"((8,1),2)">
        %lay_8519 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %3371 = cute.get_shape(%lay_8519) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8520, %e1_8521, %e2_8522 = cute.get_leaves(%3371) : !cute.shape<"((8,1),2)">
        %lay_8523 = cute.get_layout(%view_8499) : !memref_rmem_bf16_29
        %shape_8524 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8525 = cute.make_layout() : !cute.layout<"1:0">
        %append_8526 = cute.append_to_rank<2> (%lay_8523, %lay_8525) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8527 = cute.make_view(%iter_8500, %append_8526) : !memref_rmem_bf16_29
        %iter_8528 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %lay_8529 = cute.get_layout(%view_8527) : !memref_rmem_bf16_29
        %3372 = cute.get_shape(%lay_8529) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8530, %e1_8531, %e2_8532 = cute.get_leaves(%3372) : !cute.shape<"((8,1),2)">
        %iter_8533 = cute.get_iter(%view_8527) : !memref_rmem_bf16_29
        %view_8534 = cute.make_view(%iter_8533) : !memref_rmem_bf16_30
        %iter_8535 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8536 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %lay_8537 = cute.get_layout(%view_8506) : !memref_gmem_bf16_6
        %shape_8538 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8539 = cute.make_layout() : !cute.layout<"1:0">
        %append_8540 = cute.append_to_rank<2> (%lay_8537, %lay_8539) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8541 = cute.make_view(%iter_8507, %append_8540) : !memref_gmem_bf16_6
        %iter_8542 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %lay_8543 = cute.get_layout(%view_8541) : !memref_gmem_bf16_6
        %3373 = cute.get_shape(%lay_8543) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8544, %e1_8545, %e2_8546 = cute.get_leaves(%3373) : !cute.shape<"((8,1),2)">
        %iter_8547 = cute.get_iter(%view_8541) : !memref_gmem_bf16_6
        %view_8548 = cute.make_view(%iter_8547) : !memref_gmem_bf16_7
        %iter_8549 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %iter_8550 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8551 = cute.get_layout(%view_8513) : !memref_rmem_i8_2
        %shape_8552 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8553 = cute.make_layout() : !cute.layout<"1:0">
        %append_8554 = cute.append_to_rank<2> (%lay_8551, %lay_8553) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8555 = cute.make_view(%iter_8514, %append_8554) : !memref_rmem_i8_2
        %iter_8556 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %lay_8557 = cute.get_layout(%view_8555) : !memref_rmem_i8_2
        %3374 = cute.get_shape(%lay_8557) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8558, %e1_8559 = cute.get_leaves(%3374) : !cute.shape<"(1,2)">
        %iter_8560 = cute.get_iter(%view_8555) : !memref_rmem_i8_2
        %view_8561 = cute.make_view(%iter_8560) : !memref_rmem_i8_3
        %iter_8562 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %iter_8563 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8564 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %3375 = cute.get_shape(%lay_8564) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8565, %e1_8566, %e2_8567 = cute.get_leaves(%3375) : !cute.shape<"((8,1),(2))">
        %lay_8568 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %3376 = cute.get_shape(%lay_8568) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8569, %e1_8570, %e2_8571 = cute.get_leaves(%3376) : !cute.shape<"((8,1),(2))">
        %lay_8572 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %sz_8573 = cute.size(%lay_8572) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8574 = cute.get_leaves(%sz_8573) : !cute.int_tuple<"2">
        %lay_8575 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %sz_8576 = cute.size(%lay_8575) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8577 = cute.get_leaves(%sz_8576) : !cute.int_tuple<"2">
        %3377 = cute.static : !cute.layout<"1:0">
        %iter_8578 = cute.get_iter(%view_8534) : !memref_rmem_bf16_30
        %iter_8579 = cute.get_iter(%view_8548) : !memref_gmem_bf16_7
        %lay_8580 = cute.get_layout(%view_8534) : !memref_rmem_bf16_30
        %lay_8581 = cute.get_layout(%view_8548) : !memref_gmem_bf16_7
        %append_8582 = cute.append_to_rank<2> (%lay_8580, %3377) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8583 = cute.append_to_rank<2> (%lay_8581, %3377) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8584 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8585 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8586 = cute.get_iter(%view_8561) : !memref_rmem_i8_3
        %lay_8587 = cute.get_layout(%view_8561) : !memref_rmem_i8_3
        %append_8588 = cute.append_to_rank<2> (%lay_8587, %3377) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8589 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8590 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3378 = cute.get_scalars(%sz_8590) : !cute.int_tuple<"2">
        %c0_i32_8591 = arith.constant 0 : i32
        %c1_i32_8592 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8591 to %3378 step %c1_i32_8592  : i32 {
          %coord_8593 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3379 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8594 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8595 = cute.crd2idx(%coord_8593, %lay_8584) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8596 = cute.add_offset(%iter_8578, %idx_8595) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8597 = cute.make_view(%ptr_8596, %lay_8594) : !memref_rmem_bf16_8
          %3380 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8598 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8599 = cute.crd2idx(%coord_8593, %lay_8585) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8600 = cute.add_offset(%iter_8579, %idx_8599) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8601 = cute.make_view(%ptr_8600, %lay_8598) : !memref_gmem_bf16_8
          %3381 = cute.get_scalars(%coord_8593) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8602 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8603 = cute.crd2idx(%coord_8593, %lay_8589) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8604 = cute.add_offset(%iter_8586, %idx_8603) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8605 = cute.make_view(%ptr_8604, %lay_8602) : !memref_rmem_i8_4
          %iter_8606 = cute.get_iter(%view_8597) : !memref_rmem_bf16_8
          %iter_8607 = cute.get_iter(%view_8601) : !memref_gmem_bf16_8
          %iter_8608 = cute.get_iter(%view_8605) : !memref_rmem_i8_4
          %3382 = builtin.unrealized_conversion_cast %iter_8608 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3383 = llvm.load %3382 : !llvm.ptr -> i8
          %3384 = llvm.mlir.constant(0 : i8) : i8
          %3385 = llvm.icmp "ne" %3383, %3384 : i8
          scf.if %3385 {
            %3386 = builtin.unrealized_conversion_cast %iter_8606 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3387 = builtin.unrealized_conversion_cast %iter_8607 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3388 = llvm.load %3386 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3388, %3387 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32, %arg5: !gpu.async.token) attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %36 = cute.static : !cute.swizzle<"S<3,3,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_65 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)">
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %38 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %39 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %cosz = cute.cosize(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384">
    %e0_73 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384">
    %cosz_74 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_75 = cute.get_leaves(%cosz_74) : !cute.int_tuple<"8192">
    %cosz_76 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_77 = cute.get_leaves(%cosz_76) : !cute.int_tuple<"8192">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>
    %atom_78 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %40 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %41 = cute.get_shape(%40) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_79, %e1_80 = cute.get_leaves(%41) : !cute.shape<"(8,64)">
    %shape_81 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_82 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_84 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_85 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %lay_86 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_87 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_88 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_89 = cute.get_leaves(%sz_88) : !cute.int_tuple<"8">
    %shape_90 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_91 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%lay_86) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_92 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %42 = cute.get_shape(%lay_86) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_93, %e1_94, %e2_95 = cute.get_leaves(%42) : !cute.shape<"(16,(8,8))">
    %int_tuple_96 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_97 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_98, %e1_99 = cute.get_leaves(%int_tuple_97) : !cute.int_tuple<"(16,64)">
    %int_tuple_100 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_101 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_102, %e1_103 = cute.get_leaves(%int_tuple_101) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %43 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %lay_104 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_105 = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"128">
    %sz_107 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_108 = cute.get_leaves(%sz_107) : !cute.int_tuple<"8">
    %shape_109 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_110 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_111 = cute.right_inverse(%lay_104) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_112 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %44 = cute.get_shape(%lay_104) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_113, %e1_114, %e2_115 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))">
    %int_tuple_116 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_118, %e1_119 = cute.get_leaves(%int_tuple_117) : !cute.int_tuple<"(16,64)">
    %int_tuple_120 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_121 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_122, %e1_123 = cute.get_leaves(%int_tuple_121) : !cute.int_tuple<"(16,64)">
    %tile_124 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %45 = cute.make_tiled_copy(%atom_78) : !copy_simt
    %shape_125 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_126 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_127 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_128 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %46 = cute.get_shape(%lay_128) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_129, %e1_130, %e2_131 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)">
    %tile_132 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %47 = cute.make_tiled_mma(%atom_126) : !mma_bf16_bf16_f32_16x8x16_
    %lay_133 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %48 = cute.get_shape(%lay_133) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_134, %e1_135, %e2_136, %e3_137 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_138 = cute.to_int_tuple(%e0_134) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %49 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?">
    %itup_139 = cute.to_int_tuple(%e1_135) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %50 = cute.get_scalars(%itup_139) : !cute.int_tuple<"?">
    %itup_140 = cute.to_int_tuple(%e2_136) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %51 = cute.get_scalars(%itup_140) : !cute.int_tuple<"?">
    %itup_141 = cute.to_int_tuple(%e3_137) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %52 = cute.get_scalars(%itup_141) : !cute.int_tuple<"?{div=8}">
    %int_tuple_142 = cute.make_int_tuple(%itup_139) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_143 = cute.make_tile() : () -> !cute.tile<"128:1">
    %53 = cute.get_scalars(%int_tuple_142) <{only_dynamic}> : !cute.int_tuple<"?">
    %c128_i32 = arith.constant 128 : i32
    %54 = arith.ceildivsi %53, %c128_i32 : i32
    %int_tuple_144 = cute.make_int_tuple(%54) : (i32) -> !cute.int_tuple<"?">
    %e0_145 = cute.get_leaves(%int_tuple_144) : !cute.int_tuple<"?">
    %55 = cute.get_scalars(%e0_145) : !cute.int_tuple<"?">
    %int_tuple_146 = cute.make_int_tuple(%itup_138) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_147 = cute.size(%int_tuple_146) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_148 = cute.get_leaves(%sz_147) : !cute.int_tuple<"?">
    %56 = cute.get_scalars(%e0_148) : !cute.int_tuple<"?">
    %int_tuple_149 = cute.make_int_tuple(%itup_140) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_150 = cute.size(%int_tuple_149) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_151 = cute.get_leaves(%sz_150) : !cute.int_tuple<"?">
    %57 = cute.get_scalars(%e0_151) : !cute.int_tuple<"?">
    %cst = arith.constant 1.44269502 : f32
    %58 = arith.mulf %arg4, %cst : f32
    %lay_152 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %59 = cute.get_shape(%lay_152) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_153, %e1_154, %e2_155, %e3_156 = cute.get_leaves(%59) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_157 = cute.to_int_tuple(%e0_153) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_157) : !cute.int_tuple<"?">
    %itup_158 = cute.to_int_tuple(%e1_154) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?">
    %itup_159 = cute.to_int_tuple(%e2_155) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %62 = cute.get_scalars(%itup_159) : !cute.int_tuple<"?">
    %itup_160 = cute.to_int_tuple(%e3_156) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %63 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?{div=8}">
    %64 = cute.get_stride(%lay_152) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_161, %e1_162, %e2_163, %e3_164 = cute.get_leaves(%64) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_165 = cute.to_int_tuple(%e0_161) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %65 = cute.get_scalars(%itup_165) : !cute.int_tuple<"?{i64 div=8}">
    %itup_166 = cute.to_int_tuple(%e1_162) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %66 = cute.get_scalars(%itup_166) : !cute.int_tuple<"?{i64 div=8}">
    %itup_167 = cute.to_int_tuple(%e2_163) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %67 = cute.get_scalars(%itup_167) : !cute.int_tuple<"?{i64 div=8}">
    %lay_168 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %68 = cute.get_shape(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_169, %e1_170, %e2_171, %e3_172 = cute.get_leaves(%68) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_173 = cute.to_int_tuple(%e0_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e1_170) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %70 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?">
    %itup_175 = cute.to_int_tuple(%e2_171) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %71 = cute.get_scalars(%itup_175) : !cute.int_tuple<"?">
    %itup_176 = cute.to_int_tuple(%e3_172) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %72 = cute.get_scalars(%itup_176) : !cute.int_tuple<"?{div=8}">
    %73 = cute.get_stride(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_177, %e1_178, %e2_179, %e3_180 = cute.get_leaves(%73) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_181 = cute.to_int_tuple(%e0_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %itup_182 = cute.to_int_tuple(%e1_178) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %75 = cute.get_scalars(%itup_182) : !cute.int_tuple<"?{i64 div=8}">
    %itup_183 = cute.to_int_tuple(%e2_179) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %76 = cute.get_scalars(%itup_183) : !cute.int_tuple<"?{i64 div=8}">
    %lay_184 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %77 = cute.get_shape(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_185, %e1_186, %e2_187, %e3_188 = cute.get_leaves(%77) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_189 = cute.to_int_tuple(%e0_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e1_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %79 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
    %itup_191 = cute.to_int_tuple(%e2_187) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %80 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?">
    %itup_192 = cute.to_int_tuple(%e3_188) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %81 = cute.get_scalars(%itup_192) : !cute.int_tuple<"?{div=8}">
    %82 = cute.get_stride(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_193, %e1_194, %e2_195, %e3_196 = cute.get_leaves(%82) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_197 = cute.to_int_tuple(%e0_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %itup_198 = cute.to_int_tuple(%e1_194) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %84 = cute.get_scalars(%itup_198) : !cute.int_tuple<"?{i64 div=8}">
    %itup_199 = cute.to_int_tuple(%e2_195) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %85 = cute.get_scalars(%itup_199) : !cute.int_tuple<"?{i64 div=8}">
    %lay_200 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %86 = cute.get_shape(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_201, %e1_202, %e2_203, %e3_204 = cute.get_leaves(%86) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_205 = cute.to_int_tuple(%e0_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e1_202) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %88 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?">
    %itup_207 = cute.to_int_tuple(%e2_203) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %89 = cute.get_scalars(%itup_207) : !cute.int_tuple<"?">
    %itup_208 = cute.to_int_tuple(%e3_204) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %90 = cute.get_scalars(%itup_208) : !cute.int_tuple<"?{div=8}">
    %91 = cute.get_stride(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_209, %e1_210, %e2_211, %e3_212 = cute.get_leaves(%91) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_213 = cute.to_int_tuple(%e0_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %itup_214 = cute.to_int_tuple(%e1_210) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %93 = cute.get_scalars(%itup_214) : !cute.int_tuple<"?{i64 div=8}">
    %itup_215 = cute.to_int_tuple(%e2_211) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %94 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?{i64 div=8}">
    %95 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %96 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_216 = cute.get_leaves(%96) : !cute.int_tuple<"0">
    %97 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %98 = cute.get_shape(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%98) : !cute.shape<"((8,16),(64,2))">
    %99 = cute.get_stride(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_221, %e1_222, %e2_223, %e3_224 = cute.get_leaves(%99) : !cute.stride<"((64,512),(1,8192))">
    %100 = cute.composed_get_inner(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
    %101 = cute.composed_get_offset(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_225 = cute.get_leaves(%101) : !cute.int_tuple<"0">
    %102 = cute.composed_get_outer(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %103 = cute.get_shape(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_226, %e1_227, %e2_228, %e3_229 = cute.get_leaves(%103) : !cute.shape<"((8,8),(64,2))">
    %104 = cute.get_stride(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_230, %e1_231, %e2_232, %e3_233 = cute.get_leaves(%104) : !cute.stride<"((64,512),(1,4096))">
    %105 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %106 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_234 = cute.get_leaves(%106) : !cute.int_tuple<"0">
    %107 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %108 = cute.get_shape(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_235, %e1_236, %e2_237, %e3_238 = cute.get_leaves(%108) : !cute.shape<"((8,16),(64,2))">
    %109 = cute.get_stride(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_239, %e1_240, %e2_241, %e3_242 = cute.get_leaves(%109) : !cute.stride<"((64,512),(1,8192))">
    %110 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_243, %e1_244 = cute.get_leaves(%110) : !cute.tile<"[16:1;64:1]">
    %111 = cute.get_shape(%e0_243) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_245 = cute.get_leaves(%111) : !cute.shape<"16">
    %112 = cute.get_stride(%e0_243) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_246 = cute.get_leaves(%112) : !cute.stride<"1">
    %113 = cute.get_shape(%e1_244) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_247 = cute.get_leaves(%113) : !cute.shape<"64">
    %114 = cute.get_stride(%e1_244) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_248 = cute.get_leaves(%114) : !cute.stride<"1">
    %115 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %116 = cute.get_shape(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_249, %e1_250, %e2_251 = cute.get_leaves(%116) : !cute.shape<"((8,16),8)">
    %117 = cute.get_stride(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_252, %e1_253, %e2_254 = cute.get_leaves(%117) : !cute.stride<"((128,1),16)">
    %118 = cute.static : !cute.layout<"1:0">
    %119 = cute.get_shape(%118) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_255 = cute.get_leaves(%119) : !cute.shape<"1">
    %120 = cute.get_stride(%118) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_256 = cute.get_leaves(%120) : !cute.stride<"0">
    %121 = cute.static : !cute.layout<"(1,8):(0,1)">
    %122 = cute.get_shape(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_257, %e1_258 = cute.get_leaves(%122) : !cute.shape<"(1,8)">
    %123 = cute.get_stride(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_259, %e1_260 = cute.get_leaves(%123) : !cute.stride<"(0,1)">
    %124 = cute.static : !cute.layout<"(1,8):(0,1)">
    %125 = cute.get_shape(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_261, %e1_262 = cute.get_leaves(%125) : !cute.shape<"(1,8)">
    %126 = cute.get_stride(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_263, %e1_264 = cute.get_leaves(%126) : !cute.stride<"(0,1)">
    %127 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_265, %e1_266 = cute.get_leaves(%127) : !cute.tile<"[16:1;64:1]">
    %128 = cute.get_shape(%e0_265) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_267 = cute.get_leaves(%128) : !cute.shape<"16">
    %129 = cute.get_stride(%e0_265) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_268 = cute.get_leaves(%129) : !cute.stride<"1">
    %130 = cute.get_shape(%e1_266) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_269 = cute.get_leaves(%130) : !cute.shape<"64">
    %131 = cute.get_stride(%e1_266) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_270 = cute.get_leaves(%131) : !cute.stride<"1">
    %132 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %133 = cute.get_shape(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_271, %e1_272, %e2_273 = cute.get_leaves(%133) : !cute.shape<"((8,16),8)">
    %134 = cute.get_stride(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_274, %e1_275, %e2_276 = cute.get_leaves(%134) : !cute.stride<"((128,1),16)">
    %135 = cute.static : !cute.layout<"1:0">
    %136 = cute.get_shape(%135) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_277 = cute.get_leaves(%136) : !cute.shape<"1">
    %137 = cute.get_stride(%135) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_278 = cute.get_leaves(%137) : !cute.stride<"0">
    %138 = cute.static : !cute.layout<"(1,8):(0,1)">
    %139 = cute.get_shape(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_279, %e1_280 = cute.get_leaves(%139) : !cute.shape<"(1,8)">
    %140 = cute.get_stride(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_281, %e1_282 = cute.get_leaves(%140) : !cute.stride<"(0,1)">
    %141 = cute.static : !cute.layout<"(1,8):(0,1)">
    %142 = cute.get_shape(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_283, %e1_284 = cute.get_leaves(%142) : !cute.shape<"(1,8)">
    %143 = cute.get_stride(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_285, %e1_286 = cute.get_leaves(%143) : !cute.stride<"(0,1)">
    %144 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %145 = cute.get_shape(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_287, %e1_288, %e2_289, %e3_290 = cute.get_leaves(%145) : !cute.shape<"(32,4,1,1)">
    %146 = cute.get_stride(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_291, %e1_292, %e2_293, %e3_294 = cute.get_leaves(%146) : !cute.stride<"(1,32,0,0)">
    %147 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_295, %e1_296, %e2_297 = cute.get_leaves(%147) : !cute.tile<"[64:1;16:1;16:1]">
    %148 = cute.get_shape(%e0_295) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_298 = cute.get_leaves(%148) : !cute.shape<"64">
    %149 = cute.get_stride(%e0_295) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_299 = cute.get_leaves(%149) : !cute.stride<"1">
    %150 = cute.get_shape(%e1_296) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_300 = cute.get_leaves(%150) : !cute.shape<"16">
    %151 = cute.get_stride(%e1_296) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_301 = cute.get_leaves(%151) : !cute.stride<"1">
    %152 = cute.get_shape(%e2_297) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_302 = cute.get_leaves(%152) : !cute.shape<"16">
    %153 = cute.get_stride(%e2_297) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_303 = cute.get_leaves(%153) : !cute.stride<"1">
    %154 = cute.static : !cute.layout<"32:1">
    %155 = cute.get_shape(%154) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_304 = cute.get_leaves(%155) : !cute.shape<"32">
    %156 = cute.get_stride(%154) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_305 = cute.get_leaves(%156) : !cute.stride<"1">
    %157 = cute.static : !cute.shape<"(16,8,16)">
    %e0_306, %e1_307, %e2_308 = cute.get_leaves(%157) : !cute.shape<"(16,8,16)">
    %158 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %159 = cute.get_shape(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_309, %e1_310, %e2_311, %e3_312, %e4 = cute.get_leaves(%159) : !cute.shape<"((4,8),(2,2,2))">
    %160 = cute.get_stride(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_313, %e1_314, %e2_315, %e3_316, %e4_317 = cute.get_leaves(%160) : !cute.stride<"((32,1),(16,8,128))">
    %161 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %162 = cute.get_shape(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_318, %e1_319, %e2_320, %e3_321 = cute.get_leaves(%162) : !cute.shape<"((4,8),(2,2))">
    %163 = cute.get_stride(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_322, %e1_323, %e2_324, %e3_325 = cute.get_leaves(%163) : !cute.stride<"((16,1),(8,64))">
    %164 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %165 = cute.get_shape(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%165) : !cute.shape<"((4,8),(2,2))">
    %166 = cute.get_stride(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_330, %e1_331, %e2_332, %e3_333 = cute.get_leaves(%166) : !cute.stride<"((32,1),(16,8))">
    %167 = arith.index_cast %55 : i32 to index
    %168 = arith.index_cast %56 : i32 to index
    %169 = arith.index_cast %57 : i32 to index
    %c128 = arith.constant 128 : index
    %c1 = arith.constant 1 : index
    %c65536_i32 = arith.constant 65536 : i32
    %170 = gpu.launch_func async [%arg5] @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0 blocks in (%167, %168, %169) threads in (%c128, %c1, %c1)  dynamic_shared_memory_size %c65536_i32 args(%arg0 : !memref_gmem_bf16_, %arg1 : !memref_gmem_bf16_, %arg2 : !memref_gmem_bf16_, %arg3 : !memref_gmem_bf16_, %58 : f32) {use_pdl = false}
    return
  }
}
