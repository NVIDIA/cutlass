!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "(((2,2),2)):(((1,2),8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<8>, "((1,(4,2))):((0,(1,8)))">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<32>, "(4):(1)">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_11 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_12 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_5 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2))):((0,(1,512,?{div=8})))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %1 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %3 = cute.static : !copy_ldgsts
      %4 = cute.static : !copy_simt
      %5 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %6 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%6) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %7 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %10 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
      %11 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%11) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %12 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %15 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%15) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %16 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %19 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
      %20 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%20) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %21 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %24 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%24) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %25 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %28 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
      %29 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%29) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %30 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %33 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%33) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %34 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %37 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
      %38 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%38) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %39 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %43 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_65 = cute.get_leaves(%43) : !cute.int_tuple<"0">
      %44 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %45 = cute.get_shape(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%45) : !cute.shape<"((8,16),(64,2))">
      %46 = cute.get_stride(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%46) : !cute.stride<"((64,512),(1,8192))">
      %47 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
      %48 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_74 = cute.get_leaves(%48) : !cute.int_tuple<"0">
      %49 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %50 = cute.get_shape(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%50) : !cute.shape<"((8,8),(64,2))">
      %51 = cute.get_stride(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%51) : !cute.stride<"((64,512),(1,4096))">
      %52 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %53 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,16),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,8192))">
      %57 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_92, %e1_93 = cute.get_leaves(%57) : !cute.tile<"[16:1;64:1]">
      %58 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_94 = cute.get_leaves(%58) : !cute.shape<"16">
      %59 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_95 = cute.get_leaves(%59) : !cute.stride<"1">
      %60 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_96 = cute.get_leaves(%60) : !cute.shape<"64">
      %61 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_97 = cute.get_leaves(%61) : !cute.stride<"1">
      %62 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %63 = cute.get_shape(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%63) : !cute.shape<"((8,16),8)">
      %64 = cute.get_stride(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%64) : !cute.stride<"((128,1),16)">
      %65 = cute.static : !cute.layout<"1:0">
      %66 = cute.get_shape(%65) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_104 = cute.get_leaves(%66) : !cute.shape<"1">
      %67 = cute.get_stride(%65) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_105 = cute.get_leaves(%67) : !cute.stride<"0">
      %68 = cute.static : !cute.layout<"(1,8):(0,1)">
      %69 = cute.get_shape(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_106, %e1_107 = cute.get_leaves(%69) : !cute.shape<"(1,8)">
      %70 = cute.get_stride(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_108, %e1_109 = cute.get_leaves(%70) : !cute.stride<"(0,1)">
      %71 = cute.static : !cute.layout<"(1,8):(0,1)">
      %72 = cute.get_shape(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_110, %e1_111 = cute.get_leaves(%72) : !cute.shape<"(1,8)">
      %73 = cute.get_stride(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_112, %e1_113 = cute.get_leaves(%73) : !cute.stride<"(0,1)">
      %74 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_114, %e1_115 = cute.get_leaves(%74) : !cute.tile<"[16:1;64:1]">
      %75 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_116 = cute.get_leaves(%75) : !cute.shape<"16">
      %76 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_117 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_118 = cute.get_leaves(%77) : !cute.shape<"64">
      %78 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_119 = cute.get_leaves(%78) : !cute.stride<"1">
      %79 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %80 = cute.get_shape(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%80) : !cute.shape<"((8,16),8)">
      %81 = cute.get_stride(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%81) : !cute.stride<"((128,1),16)">
      %82 = cute.static : !cute.layout<"1:0">
      %83 = cute.get_shape(%82) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_126 = cute.get_leaves(%83) : !cute.shape<"1">
      %84 = cute.get_stride(%82) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_127 = cute.get_leaves(%84) : !cute.stride<"0">
      %85 = cute.static : !cute.layout<"(1,8):(0,1)">
      %86 = cute.get_shape(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_128, %e1_129 = cute.get_leaves(%86) : !cute.shape<"(1,8)">
      %87 = cute.get_stride(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_130, %e1_131 = cute.get_leaves(%87) : !cute.stride<"(0,1)">
      %88 = cute.static : !cute.layout<"(1,8):(0,1)">
      %89 = cute.get_shape(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_132, %e1_133 = cute.get_leaves(%89) : !cute.shape<"(1,8)">
      %90 = cute.get_stride(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_134, %e1_135 = cute.get_leaves(%90) : !cute.stride<"(0,1)">
      %91 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %92 = cute.get_shape(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%92) : !cute.shape<"(32,4,1,1)">
      %93 = cute.get_stride(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%93) : !cute.stride<"(1,32,0,0)">
      %94 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%94) : !cute.tile<"[64:1;16:1;16:1]">
      %95 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_147 = cute.get_leaves(%95) : !cute.shape<"64">
      %96 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_148 = cute.get_leaves(%96) : !cute.stride<"1">
      %97 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_149 = cute.get_leaves(%97) : !cute.shape<"16">
      %98 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_150 = cute.get_leaves(%98) : !cute.stride<"1">
      %99 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_151 = cute.get_leaves(%99) : !cute.shape<"16">
      %100 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_152 = cute.get_leaves(%100) : !cute.stride<"1">
      %101 = cute.static : !cute.layout<"32:1">
      %102 = cute.get_shape(%101) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_153 = cute.get_leaves(%102) : !cute.shape<"32">
      %103 = cute.get_stride(%101) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_154 = cute.get_leaves(%103) : !cute.stride<"1">
      %104 = cute.static : !cute.shape<"(16,8,16)">
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%104) : !cute.shape<"(16,8,16)">
      %105 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2,2))">
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8,128))">
      %108 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %109 = cute.get_shape(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%109) : !cute.shape<"((4,8),(2,2))">
      %110 = cute.get_stride(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%110) : !cute.stride<"((16,1),(8,64))">
      %111 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %112 = cute.get_shape(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%112) : !cute.shape<"((4,8),(2,2))">
      %113 = cute.get_stride(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%113) : !cute.stride<"((32,1),(16,8))">
      %114 = nvvm.read.ptx.sreg.tid.x : i32
      %115 = nvvm.read.ptx.sreg.tid.y : i32
      %116 = nvvm.read.ptx.sreg.tid.z : i32
      %117 = nvvm.read.ptx.sreg.ctaid.x : i32
      %118 = nvvm.read.ptx.sreg.ctaid.y : i32
      %119 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %120 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%120) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %121 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %122 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %123 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %124 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %125 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %126 = arith.ceildivsi %125, %c64_i32 : i32
      %int_tuple_192 = cute.make_int_tuple(%126) : (i32) -> !cute.int_tuple<"?">
      %e0_193 = cute.get_leaves(%int_tuple_192) : !cute.int_tuple<"?">
      %127 = cute.get_scalars(%e0_193) : !cute.int_tuple<"?">
      %false = arith.constant false
      %128 = scf.if %false -> (i32) {
        %c1_i32_8604 = arith.constant 1 : i32
        %3378 = arith.addi %117, %c1_i32_8604 : i32
        %c128_i32_8605 = arith.constant 128 : i32
        %3379 = arith.muli %3378, %c128_i32_8605 : i32
        %int_tuple_8606 = cute.make_int_tuple(%3379) : (i32) -> !cute.int_tuple<"?">
        %tile_8607 = cute.make_tile() : () -> !cute.tile<"64:1">
        %3380 = cute.get_scalars(%int_tuple_8606) <{only_dynamic}> : !cute.int_tuple<"?">
        %c64_i32_8608 = arith.constant 64 : i32
        %3381 = arith.ceildivsi %3380, %c64_i32_8608 : i32
        %int_tuple_8609 = cute.make_int_tuple(%3381) : (i32) -> !cute.int_tuple<"?">
        %e0_8610 = cute.get_leaves(%int_tuple_8609) : !cute.int_tuple<"?">
        %3382 = cute.get_scalars(%e0_8610) : !cute.int_tuple<"?">
        %3383 = arith.minsi %3382, %127 : i32
        scf.yield %3383 : i32
      } else {
        scf.yield %127 : i32
      }
      %c1_i32 = arith.constant 1 : i32
      %129 = arith.subi %128, %c1_i32 : i32
      %coord = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_194 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %130:7 = cute.get_scalars(%lay_194) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %131:2 = cute.get_scalars(%coord) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv = cute.assume(%130#3) : (i32) -> !cute.i32<divby 8>
      %shape = cute.make_shape(%130#1, %iv) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_195 = cute.assume(%130#5) : (i64) -> !cute.i64<divby 8>
      %stride = cute.make_stride(%iv_195) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_196 = cute.make_layout(%shape, %stride) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx = cute.crd2idx(%coord, %lay_194) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_197 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_197, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %lay_196) : !memref_gmem_bf16_1
      %iter_198 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %iter_199 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_200 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_201 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %132 = cute.get_scalars(%coord_201) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_202 = cute.make_coord(%132) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_203 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %133:3 = cute.get_scalars(%lay_203) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32 = arith.constant 128 : i32
      %134 = arith.ceildivsi %133#0, %c128_i32 : i32
      %c128_i64 = arith.constant 128 : i64
      %135 = arith.muli %133#2, %c128_i64 : i64
      %c128_i32_204 = arith.constant 128 : i32
      %136 = arith.ceildivsi %133#1, %c128_i32_204 : i32
      %shape_205 = cute.make_shape(%134, %136) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_206 = cute.assume(%133#2) : (i64) -> !cute.i64<divby 8>
      %iv_207 = cute.assume(%135) : (i64) -> !cute.i64<divby 1024>
      %stride_208 = cute.make_stride(%iv_206, %iv_207) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_209 = cute.make_layout(%shape_205, %stride_208) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %137:4 = cute.get_scalars(%lay_209) <{only_dynamic}> : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %138 = cute.get_scalars(%coord_202) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_210 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %iv_211 = cute.assume(%137#2) : (i64) -> !cute.i64<divby 8>
      %stride_212 = cute.make_stride(%iv_211) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_213 = cute.make_layout(%shape_210, %stride_212) : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %idx_214 = cute.crd2idx(%coord_202, %lay_209) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_215 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_216 = cute.add_offset(%iter_215, %idx_214) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_217 = cute.make_view(%ptr_216, %lay_213) : !memref_gmem_bf16_2
      %iter_218 = cute.get_iter(%view_217) : !memref_gmem_bf16_2
      %coord_219 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_220 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %139:7 = cute.get_scalars(%lay_220) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %140:2 = cute.get_scalars(%coord_219) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_221 = cute.assume(%139#3) : (i32) -> !cute.i32<divby 8>
      %shape_222 = cute.make_shape(%139#1, %iv_221) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_223 = cute.assume(%139#5) : (i64) -> !cute.i64<divby 8>
      %stride_224 = cute.make_stride(%iv_223) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_225 = cute.make_layout(%shape_222, %stride_224) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_226 = cute.crd2idx(%coord_219, %lay_220) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_227 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_228 = cute.add_offset(%iter_227, %idx_226) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_229 = cute.make_view(%ptr_228, %lay_225) : !memref_gmem_bf16_1
      %iter_230 = cute.get_iter(%view_229) : !memref_gmem_bf16_1
      %iter_231 = cute.get_iter(%view_229) : !memref_gmem_bf16_1
      %tile_232 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_233 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_234 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_235 = cute.get_layout(%view_229) : !memref_gmem_bf16_1
      %141:3 = cute.get_scalars(%lay_235) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_236 = arith.constant 64 : i32
      %142 = arith.ceildivsi %141#0, %c64_i32_236 : i32
      %c64_i64 = arith.constant 64 : i64
      %143 = arith.muli %141#2, %c64_i64 : i64
      %c128_i32_237 = arith.constant 128 : i32
      %144 = arith.ceildivsi %141#1, %c128_i32_237 : i32
      %shape_238 = cute.make_shape(%142, %144) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_239 = cute.assume(%141#2) : (i64) -> !cute.i64<divby 8>
      %iv_240 = cute.assume(%143) : (i64) -> !cute.i64<divby 512>
      %stride_241 = cute.make_stride(%iv_239, %iv_240) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_242 = cute.make_layout(%shape_238, %stride_241) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %145:4 = cute.get_scalars(%lay_242) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_243 = cute.make_shape(%145#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_244 = cute.assume(%145#2) : (i64) -> !cute.i64<divby 8>
      %iv_245 = cute.assume(%145#3) : (i64) -> !cute.i64<divby 512>
      %stride_246 = cute.make_stride(%iv_244, %iv_245) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_247 = cute.make_layout(%shape_243, %stride_246) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_248 = cute.crd2idx(%coord_234, %lay_242) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_249 = cute.get_iter(%view_229) : !memref_gmem_bf16_1
      %ptr_250 = cute.add_offset(%iter_249, %idx_248) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_251 = cute.make_view(%ptr_250, %lay_247) : !memref_gmem_bf16_3
      %iter_252 = cute.get_iter(%view_251) : !memref_gmem_bf16_3
      %coord_253 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_254 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %146:7 = cute.get_scalars(%lay_254) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %147:2 = cute.get_scalars(%coord_253) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_255 = cute.assume(%146#3) : (i32) -> !cute.i32<divby 8>
      %shape_256 = cute.make_shape(%146#1, %iv_255) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_257 = cute.assume(%146#5) : (i64) -> !cute.i64<divby 8>
      %stride_258 = cute.make_stride(%iv_257) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_259 = cute.make_layout(%shape_256, %stride_258) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_260 = cute.crd2idx(%coord_253, %lay_254) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_261 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_262 = cute.add_offset(%iter_261, %idx_260) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_263 = cute.make_view(%ptr_262, %lay_259) : !memref_gmem_bf16_1
      %iter_264 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %iter_265 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %tile_266 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_267 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_268 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_269 = cute.get_layout(%view_263) : !memref_gmem_bf16_1
      %148:3 = cute.get_scalars(%lay_269) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_270 = arith.constant 64 : i32
      %149 = arith.ceildivsi %148#0, %c64_i32_270 : i32
      %c64_i64_271 = arith.constant 64 : i64
      %150 = arith.muli %148#2, %c64_i64_271 : i64
      %c128_i32_272 = arith.constant 128 : i32
      %151 = arith.ceildivsi %148#1, %c128_i32_272 : i32
      %shape_273 = cute.make_shape(%149, %151) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_274 = cute.assume(%148#2) : (i64) -> !cute.i64<divby 8>
      %iv_275 = cute.assume(%150) : (i64) -> !cute.i64<divby 512>
      %stride_276 = cute.make_stride(%iv_274, %iv_275) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_277 = cute.make_layout(%shape_273, %stride_276) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %152:4 = cute.get_scalars(%lay_277) <{only_dynamic}> : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %shape_278 = cute.make_shape(%152#0) : (i32) -> !cute.shape<"(64,128,?)">
      %iv_279 = cute.assume(%152#2) : (i64) -> !cute.i64<divby 8>
      %iv_280 = cute.assume(%152#3) : (i64) -> !cute.i64<divby 512>
      %stride_281 = cute.make_stride(%iv_279, %iv_280) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"(?{i64 div=8},1,?{i64 div=512})">
      %lay_282 = cute.make_layout(%shape_278, %stride_281) : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %idx_283 = cute.crd2idx(%coord_268, %lay_277) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_284 = cute.get_iter(%view_263) : !memref_gmem_bf16_1
      %ptr_285 = cute.add_offset(%iter_284, %idx_283) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_286 = cute.make_view(%ptr_285, %lay_282) : !memref_gmem_bf16_3
      %iter_287 = cute.get_iter(%view_286) : !memref_gmem_bf16_3
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_288 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536">
      %ptr_289 = cute.add_offset(%smem_ptr, %int_tuple_288) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c65536_i32 = arith.constant 65536 : i32
      %153 = arith.cmpi sge, %smem_size, %c65536_i32 : i32
      %int_tuple_290 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_291 = cute.add_offset(%smem_ptr, %int_tuple_290) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_292 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_293 = cute.add_offset(%smem_ptr, %int_tuple_292) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_294 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_295 = cute.add_offset(%smem_ptr, %int_tuple_294) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_296 = cute.recast_iter(%ptr_291) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_297 = cute.make_view(%iter_296, %0) : !memref_smem_bf16_
      %iter_298 = cute.get_iter(%view_297) : !memref_smem_bf16_
      %iter_299 = cute.recast_iter(%ptr_293) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_300 = cute.make_view(%iter_299, %1) : !memref_smem_bf16_1
      %iter_301 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %iter_302 = cute.recast_iter(%ptr_295) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_303 = cute.make_view(%iter_302, %1) : !memref_smem_bf16_1
      %iter_304 = cute.get_iter(%view_303) : !memref_smem_bf16_1
      %shape_305 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_306 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_307 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_308 = cute.get_iter(%view_303) : !memref_smem_bf16_1
      %view_309 = cute.make_view(%iter_308) : !memref_smem_bf16_2
      %iter_310 = cute.get_iter(%view_309) : !memref_smem_bf16_2
      %coord_311 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_312 = cute.get_iter(%view_217) : !memref_gmem_bf16_2
      %lay_313 = cute.get_layout(%view_217) : !memref_gmem_bf16_2
      %154 = cute.get_scalars(%lay_313) <{only_dynamic}> : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %155 = cute.get_scalars(%coord_311) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64 = arith.constant 16 : i64
      %156 = arith.muli %154, %c16_i64 : i64
      %c128_i64_314 = arith.constant 128 : i64
      %157 = arith.muli %154, %c128_i64_314 : i64
      %c16_i64_315 = arith.constant 16 : i64
      %158 = arith.muli %154, %c16_i64_315 : i64
      %c8_i32 = arith.constant 8 : i32
      %159 = arith.divsi %155, %c8_i32 : i32
      %c8_i32_316 = arith.constant 8 : i32
      %160 = arith.remsi %155, %c8_i32_316 : i32
      %c8_i32_317 = arith.constant 8 : i32
      %161 = arith.muli %160, %c8_i32_317 : i32
      %162 = arith.extsi %159 : i32 to i64
      %163 = arith.muli %162, %154 : i64
      %164 = arith.extsi %161 : i32 to i64
      %165 = arith.addi %164, %163 : i64
      %iv_318 = cute.assume(%165) : (i64) -> !cute.i64<divby 8>
      %int_tuple_319 = cute.make_int_tuple(%iv_318) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_320 = cute.add_offset(%iter_312, %int_tuple_319) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_321 = cute.make_shape() : () -> !cute.shape<"((8,1),8,2)">
      %iv_322 = cute.assume(%156) : (i64) -> !cute.i64<divby 128>
      %stride_323 = cute.make_stride(%iv_322) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_324 = cute.make_layout(%shape_321, %stride_323) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %view_325 = cute.make_view(%ptr_320, %lay_324) : !memref_gmem_bf16_4
      %iter_326 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
      %coord_327 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_328 = cute.get_iter(%view_297) : !memref_smem_bf16_
      %166 = cute.get_scalars(%coord_327) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_329 = arith.constant 8 : i32
      %167 = arith.divsi %166, %c8_i32_329 : i32
      %c8_i32_330 = arith.constant 8 : i32
      %168 = arith.remsi %166, %c8_i32_330 : i32
      %c8_i32_331 = arith.constant 8 : i32
      %169 = arith.muli %168, %c8_i32_331 : i32
      %c8_i32_332 = arith.constant 8 : i32
      %170 = arith.divsi %167, %c8_i32_332 : i32
      %c8_i32_333 = arith.constant 8 : i32
      %171 = arith.remsi %167, %c8_i32_333 : i32
      %c64_i32_334 = arith.constant 64 : i32
      %172 = arith.muli %171, %c64_i32_334 : i32
      %173 = arith.addi %169, %172 : i32
      %c0_i32 = arith.constant 0 : i32
      %174 = arith.xori %173, %c0_i32 : i32
      %c8_i32_335 = arith.constant 8 : i32
      %175 = arith.divsi %166, %c8_i32_335 : i32
      %c8_i32_336 = arith.constant 8 : i32
      %176 = arith.remsi %166, %c8_i32_336 : i32
      %c8_i32_337 = arith.constant 8 : i32
      %177 = arith.divsi %175, %c8_i32_337 : i32
      %c8_i32_338 = arith.constant 8 : i32
      %178 = arith.remsi %175, %c8_i32_338 : i32
      %c512_i32 = arith.constant 512 : i32
      %179 = arith.muli %177, %c512_i32 : i32
      %c64_i32_339 = arith.constant 64 : i32
      %180 = arith.andi %174, %c64_i32_339 : i32
      %c0_i32_340 = arith.constant 0 : i32
      %181 = arith.cmpi eq, %180, %c0_i32_340 : i32
      %182 = scf.if %181 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_341 = arith.constant 128 : i32
      %183 = arith.andi %174, %c128_i32_341 : i32
      %c0_i32_342 = arith.constant 0 : i32
      %184 = arith.cmpi eq, %183, %c0_i32_342 : i32
      %185 = scf.if %184 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32 = arith.constant 256 : i32
      %186 = arith.andi %174, %c256_i32 : i32
      %c0_i32_343 = arith.constant 0 : i32
      %187 = arith.cmpi eq, %186, %c0_i32_343 : i32
      %188 = scf.if %187 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_344 = arith.constant 8 : i32
      %189 = arith.andi %174, %c8_i32_344 : i32
      %c0_i32_345 = arith.constant 0 : i32
      %190 = arith.cmpi eq, %189, %c0_i32_345 : i32
      %191 = scf.if %190 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32 = arith.constant 16 : i32
      %192 = arith.andi %174, %c16_i32 : i32
      %c0_i32_346 = arith.constant 0 : i32
      %193 = arith.cmpi eq, %192, %c0_i32_346 : i32
      %194 = scf.if %193 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32 = arith.constant 32 : i32
      %195 = arith.andi %174, %c32_i32 : i32
      %c0_i32_347 = arith.constant 0 : i32
      %196 = arith.cmpi eq, %195, %c0_i32_347 : i32
      %197 = scf.if %196 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32 = arith.constant 448 : i32
      %198 = arith.andi %174, %c448_i32 : i32
      %c3_i32 = arith.constant 3 : i32
      %199 = arith.shrsi %198, %c3_i32 : i32
      %200 = arith.xori %174, %199 : i32
      %201 = arith.addi %200, %179 : i32
      %c128_i32_348 = arith.constant 128 : i32
      %202 = arith.muli %182, %c128_i32_348 : i32
      %c64_i32_349 = arith.constant 64 : i32
      %203 = arith.muli %185, %c64_i32_349 : i32
      %c32_i32_350 = arith.constant 32 : i32
      %204 = arith.muli %188, %c32_i32_350 : i32
      %c16_i32_351 = arith.constant 16 : i32
      %205 = arith.muli %191, %c16_i32_351 : i32
      %c8_i32_352 = arith.constant 8 : i32
      %206 = arith.muli %194, %c8_i32_352 : i32
      %c4_i32 = arith.constant 4 : i32
      %207 = arith.muli %197, %c4_i32 : i32
      %c1024_i32 = arith.constant 1024 : i32
      %208 = arith.muli %182, %c1024_i32 : i32
      %c512_i32_353 = arith.constant 512 : i32
      %209 = arith.muli %185, %c512_i32_353 : i32
      %c256_i32_354 = arith.constant 256 : i32
      %210 = arith.muli %188, %c256_i32_354 : i32
      %c128_i32_355 = arith.constant 128 : i32
      %211 = arith.muli %191, %c128_i32_355 : i32
      %c64_i32_356 = arith.constant 64 : i32
      %212 = arith.muli %194, %c64_i32_356 : i32
      %c32_i32_357 = arith.constant 32 : i32
      %213 = arith.muli %197, %c32_i32_357 : i32
      %iv_358 = cute.assume(%201) : (i32) -> !cute.i32<divby 8>
      %int_tuple_359 = cute.make_int_tuple(%iv_358) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_360 = cute.add_offset(%iter_328, %int_tuple_359) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_361 = cute.make_view(%ptr_360) : !memref_smem_bf16_3
      %iter_362 = cute.get_iter(%view_361) : !memref_smem_bf16_3
      %coord_363 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_364 = cute.get_iter(%view_251) : !memref_gmem_bf16_3
      %lay_365 = cute.get_layout(%view_251) : !memref_gmem_bf16_3
      %214:3 = cute.get_scalars(%lay_365) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %215 = cute.get_scalars(%coord_363) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_366 = arith.constant 16 : i64
      %216 = arith.muli %214#1, %c16_i64_366 : i64
      %c128_i64_367 = arith.constant 128 : i64
      %217 = arith.muli %214#1, %c128_i64_367 : i64
      %c16_i64_368 = arith.constant 16 : i64
      %218 = arith.muli %214#1, %c16_i64_368 : i64
      %c8_i32_369 = arith.constant 8 : i32
      %219 = arith.divsi %215, %c8_i32_369 : i32
      %c8_i32_370 = arith.constant 8 : i32
      %220 = arith.remsi %215, %c8_i32_370 : i32
      %c8_i32_371 = arith.constant 8 : i32
      %221 = arith.muli %220, %c8_i32_371 : i32
      %222 = arith.extsi %219 : i32 to i64
      %223 = arith.muli %222, %214#1 : i64
      %224 = arith.extsi %221 : i32 to i64
      %225 = arith.addi %224, %223 : i64
      %iv_372 = cute.assume(%225) : (i64) -> !cute.i64<divby 8>
      %int_tuple_373 = cute.make_int_tuple(%iv_372) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_374 = cute.add_offset(%iter_364, %int_tuple_373) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_375 = cute.make_shape(%214#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_376 = cute.assume(%216) : (i64) -> !cute.i64<divby 128>
      %iv_377 = cute.assume(%214#2) : (i64) -> !cute.i64<divby 512>
      %stride_378 = cute.make_stride(%iv_376, %iv_377) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_379 = cute.make_layout(%shape_375, %stride_378) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_380 = cute.make_view(%ptr_374, %lay_379) : !memref_gmem_bf16_5
      %iter_381 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
      %coord_382 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_383 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %226 = cute.get_scalars(%coord_382) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_384 = arith.constant 8 : i32
      %227 = arith.divsi %226, %c8_i32_384 : i32
      %c8_i32_385 = arith.constant 8 : i32
      %228 = arith.remsi %226, %c8_i32_385 : i32
      %c8_i32_386 = arith.constant 8 : i32
      %229 = arith.muli %228, %c8_i32_386 : i32
      %c8_i32_387 = arith.constant 8 : i32
      %230 = arith.divsi %227, %c8_i32_387 : i32
      %c8_i32_388 = arith.constant 8 : i32
      %231 = arith.remsi %227, %c8_i32_388 : i32
      %c64_i32_389 = arith.constant 64 : i32
      %232 = arith.muli %231, %c64_i32_389 : i32
      %233 = arith.addi %229, %232 : i32
      %c0_i32_390 = arith.constant 0 : i32
      %234 = arith.xori %233, %c0_i32_390 : i32
      %c8_i32_391 = arith.constant 8 : i32
      %235 = arith.divsi %226, %c8_i32_391 : i32
      %c8_i32_392 = arith.constant 8 : i32
      %236 = arith.remsi %226, %c8_i32_392 : i32
      %c8_i32_393 = arith.constant 8 : i32
      %237 = arith.divsi %235, %c8_i32_393 : i32
      %c8_i32_394 = arith.constant 8 : i32
      %238 = arith.remsi %235, %c8_i32_394 : i32
      %c512_i32_395 = arith.constant 512 : i32
      %239 = arith.muli %237, %c512_i32_395 : i32
      %c64_i32_396 = arith.constant 64 : i32
      %240 = arith.andi %234, %c64_i32_396 : i32
      %c0_i32_397 = arith.constant 0 : i32
      %241 = arith.cmpi eq, %240, %c0_i32_397 : i32
      %242 = scf.if %241 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_398 = arith.constant 128 : i32
      %243 = arith.andi %234, %c128_i32_398 : i32
      %c0_i32_399 = arith.constant 0 : i32
      %244 = arith.cmpi eq, %243, %c0_i32_399 : i32
      %245 = scf.if %244 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_400 = arith.constant 256 : i32
      %246 = arith.andi %234, %c256_i32_400 : i32
      %c0_i32_401 = arith.constant 0 : i32
      %247 = arith.cmpi eq, %246, %c0_i32_401 : i32
      %248 = scf.if %247 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_402 = arith.constant 8 : i32
      %249 = arith.andi %234, %c8_i32_402 : i32
      %c0_i32_403 = arith.constant 0 : i32
      %250 = arith.cmpi eq, %249, %c0_i32_403 : i32
      %251 = scf.if %250 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_404 = arith.constant 16 : i32
      %252 = arith.andi %234, %c16_i32_404 : i32
      %c0_i32_405 = arith.constant 0 : i32
      %253 = arith.cmpi eq, %252, %c0_i32_405 : i32
      %254 = scf.if %253 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_406 = arith.constant 32 : i32
      %255 = arith.andi %234, %c32_i32_406 : i32
      %c0_i32_407 = arith.constant 0 : i32
      %256 = arith.cmpi eq, %255, %c0_i32_407 : i32
      %257 = scf.if %256 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_408 = arith.constant 448 : i32
      %258 = arith.andi %234, %c448_i32_408 : i32
      %c3_i32_409 = arith.constant 3 : i32
      %259 = arith.shrsi %258, %c3_i32_409 : i32
      %260 = arith.xori %234, %259 : i32
      %261 = arith.addi %260, %239 : i32
      %c128_i32_410 = arith.constant 128 : i32
      %262 = arith.muli %242, %c128_i32_410 : i32
      %c64_i32_411 = arith.constant 64 : i32
      %263 = arith.muli %245, %c64_i32_411 : i32
      %c32_i32_412 = arith.constant 32 : i32
      %264 = arith.muli %248, %c32_i32_412 : i32
      %c16_i32_413 = arith.constant 16 : i32
      %265 = arith.muli %251, %c16_i32_413 : i32
      %c8_i32_414 = arith.constant 8 : i32
      %266 = arith.muli %254, %c8_i32_414 : i32
      %c4_i32_415 = arith.constant 4 : i32
      %267 = arith.muli %257, %c4_i32_415 : i32
      %c512_i32_416 = arith.constant 512 : i32
      %268 = arith.muli %242, %c512_i32_416 : i32
      %c256_i32_417 = arith.constant 256 : i32
      %269 = arith.muli %245, %c256_i32_417 : i32
      %c128_i32_418 = arith.constant 128 : i32
      %270 = arith.muli %248, %c128_i32_418 : i32
      %c64_i32_419 = arith.constant 64 : i32
      %271 = arith.muli %251, %c64_i32_419 : i32
      %c32_i32_420 = arith.constant 32 : i32
      %272 = arith.muli %254, %c32_i32_420 : i32
      %c16_i32_421 = arith.constant 16 : i32
      %273 = arith.muli %257, %c16_i32_421 : i32
      %iv_422 = cute.assume(%261) : (i32) -> !cute.i32<divby 8>
      %int_tuple_423 = cute.make_int_tuple(%iv_422) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_424 = cute.add_offset(%iter_383, %int_tuple_423) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_425 = cute.make_view(%ptr_424) : !memref_smem_bf16_4
      %iter_426 = cute.get_iter(%view_425) : !memref_smem_bf16_4
      %coord_427 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_428 = cute.get_iter(%view_286) : !memref_gmem_bf16_3
      %lay_429 = cute.get_layout(%view_286) : !memref_gmem_bf16_3
      %274:3 = cute.get_scalars(%lay_429) <{only_dynamic}> : !cute.layout<"(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
      %275 = cute.get_scalars(%coord_427) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_430 = arith.constant 16 : i64
      %276 = arith.muli %274#1, %c16_i64_430 : i64
      %c128_i64_431 = arith.constant 128 : i64
      %277 = arith.muli %274#1, %c128_i64_431 : i64
      %c16_i64_432 = arith.constant 16 : i64
      %278 = arith.muli %274#1, %c16_i64_432 : i64
      %c8_i32_433 = arith.constant 8 : i32
      %279 = arith.divsi %275, %c8_i32_433 : i32
      %c8_i32_434 = arith.constant 8 : i32
      %280 = arith.remsi %275, %c8_i32_434 : i32
      %c8_i32_435 = arith.constant 8 : i32
      %281 = arith.muli %280, %c8_i32_435 : i32
      %282 = arith.extsi %279 : i32 to i64
      %283 = arith.muli %282, %274#1 : i64
      %284 = arith.extsi %281 : i32 to i64
      %285 = arith.addi %284, %283 : i64
      %iv_436 = cute.assume(%285) : (i64) -> !cute.i64<divby 8>
      %int_tuple_437 = cute.make_int_tuple(%iv_436) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_438 = cute.add_offset(%iter_428, %int_tuple_437) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_439 = cute.make_shape(%274#0) : (i32) -> !cute.shape<"((8,1),4,2,?)">
      %iv_440 = cute.assume(%276) : (i64) -> !cute.i64<divby 128>
      %iv_441 = cute.assume(%274#2) : (i64) -> !cute.i64<divby 512>
      %stride_442 = cute.make_stride(%iv_440, %iv_441) : (!cute.i64<divby 128>, !cute.i64<divby 512>) -> !cute.stride<"((1,0),?{i64 div=128},64,?{i64 div=512})">
      %lay_443 = cute.make_layout(%shape_439, %stride_442) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
      %view_444 = cute.make_view(%ptr_438, %lay_443) : !memref_gmem_bf16_5
      %iter_445 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
      %coord_446 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_447 = cute.get_iter(%view_303) : !memref_smem_bf16_1
      %286 = cute.get_scalars(%coord_446) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_448 = arith.constant 8 : i32
      %287 = arith.divsi %286, %c8_i32_448 : i32
      %c8_i32_449 = arith.constant 8 : i32
      %288 = arith.remsi %286, %c8_i32_449 : i32
      %c8_i32_450 = arith.constant 8 : i32
      %289 = arith.muli %288, %c8_i32_450 : i32
      %c8_i32_451 = arith.constant 8 : i32
      %290 = arith.divsi %287, %c8_i32_451 : i32
      %c8_i32_452 = arith.constant 8 : i32
      %291 = arith.remsi %287, %c8_i32_452 : i32
      %c64_i32_453 = arith.constant 64 : i32
      %292 = arith.muli %291, %c64_i32_453 : i32
      %293 = arith.addi %289, %292 : i32
      %c0_i32_454 = arith.constant 0 : i32
      %294 = arith.xori %293, %c0_i32_454 : i32
      %c8_i32_455 = arith.constant 8 : i32
      %295 = arith.divsi %286, %c8_i32_455 : i32
      %c8_i32_456 = arith.constant 8 : i32
      %296 = arith.remsi %286, %c8_i32_456 : i32
      %c8_i32_457 = arith.constant 8 : i32
      %297 = arith.divsi %295, %c8_i32_457 : i32
      %c8_i32_458 = arith.constant 8 : i32
      %298 = arith.remsi %295, %c8_i32_458 : i32
      %c512_i32_459 = arith.constant 512 : i32
      %299 = arith.muli %297, %c512_i32_459 : i32
      %c64_i32_460 = arith.constant 64 : i32
      %300 = arith.andi %294, %c64_i32_460 : i32
      %c0_i32_461 = arith.constant 0 : i32
      %301 = arith.cmpi eq, %300, %c0_i32_461 : i32
      %302 = scf.if %301 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_462 = arith.constant 128 : i32
      %303 = arith.andi %294, %c128_i32_462 : i32
      %c0_i32_463 = arith.constant 0 : i32
      %304 = arith.cmpi eq, %303, %c0_i32_463 : i32
      %305 = scf.if %304 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_464 = arith.constant 256 : i32
      %306 = arith.andi %294, %c256_i32_464 : i32
      %c0_i32_465 = arith.constant 0 : i32
      %307 = arith.cmpi eq, %306, %c0_i32_465 : i32
      %308 = scf.if %307 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_466 = arith.constant 8 : i32
      %309 = arith.andi %294, %c8_i32_466 : i32
      %c0_i32_467 = arith.constant 0 : i32
      %310 = arith.cmpi eq, %309, %c0_i32_467 : i32
      %311 = scf.if %310 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_468 = arith.constant 16 : i32
      %312 = arith.andi %294, %c16_i32_468 : i32
      %c0_i32_469 = arith.constant 0 : i32
      %313 = arith.cmpi eq, %312, %c0_i32_469 : i32
      %314 = scf.if %313 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_470 = arith.constant 32 : i32
      %315 = arith.andi %294, %c32_i32_470 : i32
      %c0_i32_471 = arith.constant 0 : i32
      %316 = arith.cmpi eq, %315, %c0_i32_471 : i32
      %317 = scf.if %316 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_472 = arith.constant 448 : i32
      %318 = arith.andi %294, %c448_i32_472 : i32
      %c3_i32_473 = arith.constant 3 : i32
      %319 = arith.shrsi %318, %c3_i32_473 : i32
      %320 = arith.xori %294, %319 : i32
      %321 = arith.addi %320, %299 : i32
      %c128_i32_474 = arith.constant 128 : i32
      %322 = arith.muli %302, %c128_i32_474 : i32
      %c64_i32_475 = arith.constant 64 : i32
      %323 = arith.muli %305, %c64_i32_475 : i32
      %c32_i32_476 = arith.constant 32 : i32
      %324 = arith.muli %308, %c32_i32_476 : i32
      %c16_i32_477 = arith.constant 16 : i32
      %325 = arith.muli %311, %c16_i32_477 : i32
      %c8_i32_478 = arith.constant 8 : i32
      %326 = arith.muli %314, %c8_i32_478 : i32
      %c4_i32_479 = arith.constant 4 : i32
      %327 = arith.muli %317, %c4_i32_479 : i32
      %c512_i32_480 = arith.constant 512 : i32
      %328 = arith.muli %302, %c512_i32_480 : i32
      %c256_i32_481 = arith.constant 256 : i32
      %329 = arith.muli %305, %c256_i32_481 : i32
      %c128_i32_482 = arith.constant 128 : i32
      %330 = arith.muli %308, %c128_i32_482 : i32
      %c64_i32_483 = arith.constant 64 : i32
      %331 = arith.muli %311, %c64_i32_483 : i32
      %c32_i32_484 = arith.constant 32 : i32
      %332 = arith.muli %314, %c32_i32_484 : i32
      %c16_i32_485 = arith.constant 16 : i32
      %333 = arith.muli %317, %c16_i32_485 : i32
      %iv_486 = cute.assume(%321) : (i32) -> !cute.i32<divby 8>
      %int_tuple_487 = cute.make_int_tuple(%iv_486) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_488 = cute.add_offset(%iter_447, %int_tuple_487) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_489 = cute.make_view(%ptr_488) : !memref_smem_bf16_4
      %iter_490 = cute.get_iter(%view_489) : !memref_smem_bf16_4
      %coord_491 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_492 = cute.get_iter(%view_297) : !memref_smem_bf16_
      %334 = cute.get_scalars(%coord_491) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_493 = arith.constant 32 : i32
      %335 = arith.remsi %334, %c32_i32_493 : i32
      %c32_i32_494 = arith.constant 32 : i32
      %336 = arith.divsi %334, %c32_i32_494 : i32
      %c4_i32_495 = arith.constant 4 : i32
      %337 = arith.remsi %336, %c4_i32_495 : i32
      %c32_i32_496 = arith.constant 32 : i32
      %338 = arith.remsi %335, %c32_i32_496 : i32
      %c4_i32_497 = arith.constant 4 : i32
      %339 = arith.remsi %337, %c4_i32_497 : i32
      %c4_i32_498 = arith.constant 4 : i32
      %340 = arith.divsi %338, %c4_i32_498 : i32
      %c4_i32_499 = arith.constant 4 : i32
      %341 = arith.remsi %338, %c4_i32_499 : i32
      %c64_i32_500 = arith.constant 64 : i32
      %342 = arith.muli %340, %c64_i32_500 : i32
      %c0_i32_501 = arith.constant 0 : i32
      %343 = arith.xori %342, %c0_i32_501 : i32
      %c4_i32_502 = arith.constant 4 : i32
      %344 = arith.divsi %338, %c4_i32_502 : i32
      %c4_i32_503 = arith.constant 4 : i32
      %345 = arith.remsi %338, %c4_i32_503 : i32
      %c2_i32 = arith.constant 2 : i32
      %346 = arith.muli %345, %c2_i32 : i32
      %c1024_i32_504 = arith.constant 1024 : i32
      %347 = arith.muli %339, %c1024_i32_504 : i32
      %348 = arith.addi %346, %347 : i32
      %c64_i32_505 = arith.constant 64 : i32
      %349 = arith.andi %343, %c64_i32_505 : i32
      %c0_i32_506 = arith.constant 0 : i32
      %350 = arith.cmpi eq, %349, %c0_i32_506 : i32
      %351 = scf.if %350 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_507 = arith.constant 128 : i32
      %352 = arith.andi %343, %c128_i32_507 : i32
      %c0_i32_508 = arith.constant 0 : i32
      %353 = arith.cmpi eq, %352, %c0_i32_508 : i32
      %354 = scf.if %353 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_509 = arith.constant 256 : i32
      %355 = arith.andi %343, %c256_i32_509 : i32
      %c0_i32_510 = arith.constant 0 : i32
      %356 = arith.cmpi eq, %355, %c0_i32_510 : i32
      %357 = scf.if %356 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_511 = arith.constant 8 : i32
      %358 = arith.andi %343, %c8_i32_511 : i32
      %c0_i32_512 = arith.constant 0 : i32
      %359 = arith.cmpi eq, %358, %c0_i32_512 : i32
      %360 = scf.if %359 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_513 = arith.constant 16 : i32
      %361 = arith.andi %343, %c16_i32_513 : i32
      %c0_i32_514 = arith.constant 0 : i32
      %362 = arith.cmpi eq, %361, %c0_i32_514 : i32
      %363 = scf.if %362 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_515 = arith.constant 32 : i32
      %364 = arith.andi %343, %c32_i32_515 : i32
      %c0_i32_516 = arith.constant 0 : i32
      %365 = arith.cmpi eq, %364, %c0_i32_516 : i32
      %366 = scf.if %365 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_517 = arith.constant 448 : i32
      %367 = arith.andi %343, %c448_i32_517 : i32
      %c3_i32_518 = arith.constant 3 : i32
      %368 = arith.shrsi %367, %c3_i32_518 : i32
      %369 = arith.xori %343, %368 : i32
      %370 = arith.addi %369, %348 : i32
      %c64_i32_519 = arith.constant 64 : i32
      %371 = arith.muli %351, %c64_i32_519 : i32
      %c32_i32_520 = arith.constant 32 : i32
      %372 = arith.muli %354, %c32_i32_520 : i32
      %c16_i32_521 = arith.constant 16 : i32
      %373 = arith.muli %357, %c16_i32_521 : i32
      %c8_i32_522 = arith.constant 8 : i32
      %374 = arith.muli %360, %c8_i32_522 : i32
      %c4_i32_523 = arith.constant 4 : i32
      %375 = arith.muli %363, %c4_i32_523 : i32
      %c2_i32_524 = arith.constant 2 : i32
      %376 = arith.muli %366, %c2_i32_524 : i32
      %c512_i32_525 = arith.constant 512 : i32
      %377 = arith.muli %351, %c512_i32_525 : i32
      %c256_i32_526 = arith.constant 256 : i32
      %378 = arith.muli %354, %c256_i32_526 : i32
      %c128_i32_527 = arith.constant 128 : i32
      %379 = arith.muli %357, %c128_i32_527 : i32
      %c64_i32_528 = arith.constant 64 : i32
      %380 = arith.muli %360, %c64_i32_528 : i32
      %c32_i32_529 = arith.constant 32 : i32
      %381 = arith.muli %363, %c32_i32_529 : i32
      %c16_i32_530 = arith.constant 16 : i32
      %382 = arith.muli %366, %c16_i32_530 : i32
      %c2_i32_531 = arith.constant 2 : i32
      %383 = arith.muli %351, %c2_i32_531 : i32
      %c1024_i32_532 = arith.constant 1024 : i32
      %384 = arith.muli %351, %c1024_i32_532 : i32
      %c512_i32_533 = arith.constant 512 : i32
      %385 = arith.muli %354, %c512_i32_533 : i32
      %c256_i32_534 = arith.constant 256 : i32
      %386 = arith.muli %357, %c256_i32_534 : i32
      %c128_i32_535 = arith.constant 128 : i32
      %387 = arith.muli %360, %c128_i32_535 : i32
      %c64_i32_536 = arith.constant 64 : i32
      %388 = arith.muli %363, %c64_i32_536 : i32
      %c32_i32_537 = arith.constant 32 : i32
      %389 = arith.muli %366, %c32_i32_537 : i32
      %iv_538 = cute.assume(%370) : (i32) -> !cute.i32<divby 2>
      %int_tuple_539 = cute.make_int_tuple(%iv_538) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_540 = cute.add_offset(%iter_492, %int_tuple_539) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_541 = cute.make_shape() : () -> !cute.shape<"((2,2,2),2,((2,2),2))">
      %iv_542 = cute.assume(%351) : (i32) -> !cute.i32<divby 8>
      %iv_543 = cute.assume(%354) : (i32) -> !cute.i32<divby 16>
      %iv_544 = cute.assume(%357) : (i32) -> !cute.i32<divby 32>
      %stride_545 = cute.make_stride(%iv_542, %iv_543, %iv_544) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
      %lay_546 = cute.make_layout(%shape_541, %stride_545) : !cute.layout<"((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
      %view_547 = cute.make_view(%ptr_540, %lay_546) : !memref_smem_bf16_5
      %iter_548 = cute.get_iter(%view_547) : !memref_smem_bf16_5
      %rmem = cute.memref.alloca() : !memref_rmem_bf16_
      %iter_549 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %coord_550 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_551 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %390 = cute.get_scalars(%coord_550) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_552 = arith.constant 32 : i32
      %391 = arith.remsi %390, %c32_i32_552 : i32
      %c32_i32_553 = arith.constant 32 : i32
      %392 = arith.divsi %390, %c32_i32_553 : i32
      %c4_i32_554 = arith.constant 4 : i32
      %393 = arith.remsi %392, %c4_i32_554 : i32
      %c32_i32_555 = arith.constant 32 : i32
      %394 = arith.remsi %391, %c32_i32_555 : i32
      %c4_i32_556 = arith.constant 4 : i32
      %395 = arith.remsi %393, %c4_i32_556 : i32
      %c4_i32_557 = arith.constant 4 : i32
      %396 = arith.divsi %394, %c4_i32_557 : i32
      %c4_i32_558 = arith.constant 4 : i32
      %397 = arith.remsi %394, %c4_i32_558 : i32
      %c64_i32_559 = arith.constant 64 : i32
      %398 = arith.muli %396, %c64_i32_559 : i32
      %c0_i32_560 = arith.constant 0 : i32
      %399 = arith.xori %398, %c0_i32_560 : i32
      %c4_i32_561 = arith.constant 4 : i32
      %400 = arith.divsi %394, %c4_i32_561 : i32
      %c4_i32_562 = arith.constant 4 : i32
      %401 = arith.remsi %394, %c4_i32_562 : i32
      %c2_i32_563 = arith.constant 2 : i32
      %402 = arith.muli %401, %c2_i32_563 : i32
      %c64_i32_564 = arith.constant 64 : i32
      %403 = arith.andi %399, %c64_i32_564 : i32
      %c0_i32_565 = arith.constant 0 : i32
      %404 = arith.cmpi eq, %403, %c0_i32_565 : i32
      %405 = scf.if %404 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_566 = arith.constant 128 : i32
      %406 = arith.andi %399, %c128_i32_566 : i32
      %c0_i32_567 = arith.constant 0 : i32
      %407 = arith.cmpi eq, %406, %c0_i32_567 : i32
      %408 = scf.if %407 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_568 = arith.constant 256 : i32
      %409 = arith.andi %399, %c256_i32_568 : i32
      %c0_i32_569 = arith.constant 0 : i32
      %410 = arith.cmpi eq, %409, %c0_i32_569 : i32
      %411 = scf.if %410 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_570 = arith.constant 8 : i32
      %412 = arith.andi %399, %c8_i32_570 : i32
      %c0_i32_571 = arith.constant 0 : i32
      %413 = arith.cmpi eq, %412, %c0_i32_571 : i32
      %414 = scf.if %413 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_572 = arith.constant 16 : i32
      %415 = arith.andi %399, %c16_i32_572 : i32
      %c0_i32_573 = arith.constant 0 : i32
      %416 = arith.cmpi eq, %415, %c0_i32_573 : i32
      %417 = scf.if %416 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_574 = arith.constant 32 : i32
      %418 = arith.andi %399, %c32_i32_574 : i32
      %c0_i32_575 = arith.constant 0 : i32
      %419 = arith.cmpi eq, %418, %c0_i32_575 : i32
      %420 = scf.if %419 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_576 = arith.constant 448 : i32
      %421 = arith.andi %399, %c448_i32_576 : i32
      %c3_i32_577 = arith.constant 3 : i32
      %422 = arith.shrsi %421, %c3_i32_577 : i32
      %423 = arith.xori %399, %422 : i32
      %424 = arith.addi %423, %402 : i32
      %c64_i32_578 = arith.constant 64 : i32
      %425 = arith.muli %405, %c64_i32_578 : i32
      %c32_i32_579 = arith.constant 32 : i32
      %426 = arith.muli %408, %c32_i32_579 : i32
      %c16_i32_580 = arith.constant 16 : i32
      %427 = arith.muli %411, %c16_i32_580 : i32
      %c8_i32_581 = arith.constant 8 : i32
      %428 = arith.muli %414, %c8_i32_581 : i32
      %c4_i32_582 = arith.constant 4 : i32
      %429 = arith.muli %417, %c4_i32_582 : i32
      %c2_i32_583 = arith.constant 2 : i32
      %430 = arith.muli %420, %c2_i32_583 : i32
      %c2_i32_584 = arith.constant 2 : i32
      %431 = arith.muli %405, %c2_i32_584 : i32
      %c512_i32_585 = arith.constant 512 : i32
      %432 = arith.muli %405, %c512_i32_585 : i32
      %c256_i32_586 = arith.constant 256 : i32
      %433 = arith.muli %408, %c256_i32_586 : i32
      %c128_i32_587 = arith.constant 128 : i32
      %434 = arith.muli %411, %c128_i32_587 : i32
      %c64_i32_588 = arith.constant 64 : i32
      %435 = arith.muli %414, %c64_i32_588 : i32
      %c32_i32_589 = arith.constant 32 : i32
      %436 = arith.muli %417, %c32_i32_589 : i32
      %c16_i32_590 = arith.constant 16 : i32
      %437 = arith.muli %420, %c16_i32_590 : i32
      %iv_591 = cute.assume(%424) : (i32) -> !cute.i32<divby 2>
      %int_tuple_592 = cute.make_int_tuple(%iv_591) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_593 = cute.add_offset(%iter_551, %int_tuple_592) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_594 = cute.make_shape() : () -> !cute.shape<"((2,2),8,((2,2),2))">
      %iv_595 = cute.assume(%405) : (i32) -> !cute.i32<divby 8>
      %iv_596 = cute.assume(%408) : (i32) -> !cute.i32<divby 16>
      %iv_597 = cute.assume(%411) : (i32) -> !cute.i32<divby 32>
      %stride_598 = cute.make_stride(%iv_595, %iv_596, %iv_597) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
      %lay_599 = cute.make_layout(%shape_594, %stride_598) : !cute.layout<"((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
      %view_600 = cute.make_view(%ptr_593, %lay_599) : !memref_smem_bf16_6
      %iter_601 = cute.get_iter(%view_600) : !memref_smem_bf16_6
      %rmem_602 = cute.memref.alloca() : !memref_rmem_bf16_1
      %iter_603 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %coord_604 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_605 = cute.get_iter(%view_309) : !memref_smem_bf16_2
      %438 = cute.get_scalars(%coord_604) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_606 = arith.constant 32 : i32
      %439 = arith.remsi %438, %c32_i32_606 : i32
      %c32_i32_607 = arith.constant 32 : i32
      %440 = arith.divsi %438, %c32_i32_607 : i32
      %c4_i32_608 = arith.constant 4 : i32
      %441 = arith.remsi %440, %c4_i32_608 : i32
      %c32_i32_609 = arith.constant 32 : i32
      %442 = arith.remsi %439, %c32_i32_609 : i32
      %c4_i32_610 = arith.constant 4 : i32
      %443 = arith.remsi %441, %c4_i32_610 : i32
      %c4_i32_611 = arith.constant 4 : i32
      %444 = arith.divsi %442, %c4_i32_611 : i32
      %c4_i32_612 = arith.constant 4 : i32
      %445 = arith.remsi %442, %c4_i32_612 : i32
      %c128_i32_613 = arith.constant 128 : i32
      %446 = arith.muli %445, %c128_i32_613 : i32
      %c0_i32_614 = arith.constant 0 : i32
      %447 = arith.xori %446, %c0_i32_614 : i32
      %c4_i32_615 = arith.constant 4 : i32
      %448 = arith.divsi %442, %c4_i32_615 : i32
      %c4_i32_616 = arith.constant 4 : i32
      %449 = arith.remsi %442, %c4_i32_616 : i32
      %int_tuple_617 = cute.make_int_tuple(%448) : (i32) -> !cute.int_tuple<"?">
      %ptr_618 = cute.add_offset(%iter_605, %int_tuple_617) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?">) -> !cute.ptr<bf16, smem>
      %lay_619 = cute.make_layout() : !cute.layout<"((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %iv_620 = cute.assume(%447) : (i32) -> !cute.i32<divby 128>
      %int_tuple_621 = cute.make_int_tuple(%iv_620) : (!cute.i32<divby 128>) -> !cute.int_tuple<"?{div=128}">
      %450 = cute.static : !cute.swizzle<"S<3,3,3>">
      %lay_622 = cute.make_composed_layout(%450, %int_tuple_621, %lay_619) : !cute.composed_layout<"S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
      %view_623 = cute.make_view(%ptr_618, %lay_622) : !memref_smem_bf16_7
      %iter_624 = cute.get_iter(%view_623) : !memref_smem_bf16_7
      %rmem_625 = cute.memref.alloca() : !memref_rmem_bf16_2
      %iter_626 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %shape_627 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %shape_628 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %e0_629, %e1_630, %e2_631, %e3_632 = cute.get_leaves(%shape_628) : !cute.shape<"((2,2),2,16)">
      %shape_633 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_634 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_635 = cute.memref.alloca(%lay_634) : !memref_rmem_f32_
      %iter_636 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %iter_637 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %lay_638 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %sz = cute.size(%lay_638) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"128">
      %e0_639 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
      %lay_640 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %451 = cute.get_shape(%lay_640) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_641, %e1_642, %e2_643, %e3_644 = cute.get_leaves(%451) : !cute.shape<"((2,2),2,16)">
      %int_tuple_645 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %int_tuple_646 = cute.make_int_tuple() : () -> !cute.int_tuple<"128">
      %e0_647 = cute.get_leaves(%int_tuple_646) : !cute.int_tuple<"128">
      %cst = arith.constant 0.000000e+00 : f32
      %452 = vector.splat %cst : vector<128xf32>
      %int_tuple_648 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_649 = cute.size(%int_tuple_648) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_650 = cute.get_leaves(%sz_649) : !cute.int_tuple<"128">
      %int_tuple_651 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_652 = cute.size(%int_tuple_651) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_653 = cute.get_leaves(%sz_652) : !cute.int_tuple<"128">
      cute.memref.store_vec %452, %rmem_635 : !memref_rmem_f32_
      %shape_654 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_655 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_656 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_657 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_658 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %453 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %454 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_659, %e1_660, %e2_661 = cute.get_leaves(%454) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_662 = cute.size(%e0_659) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_663 = cute.get_leaves(%sz_662) : !cute.int_tuple<"64">
      %455 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_664, %e1_665, %e2_666 = cute.get_leaves(%455) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_667 = cute.size(%e2_666) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_668 = cute.get_leaves(%sz_667) : !cute.int_tuple<"16">
      %tile_669 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %456 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %457 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %458 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_670, %e1_671, %e2_672 = cute.get_leaves(%458) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_673 = cute.size(%e1_671) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_674 = cute.get_leaves(%sz_673) : !cute.int_tuple<"16">
      %459 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_675, %e1_676, %e2_677 = cute.get_leaves(%459) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_678 = cute.size(%e2_677) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_679 = cute.get_leaves(%sz_678) : !cute.int_tuple<"16">
      %tile_680 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %460 = cute.make_tiled_copy(%atom_656) : !copy_ldsm_4_1
      %461 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %462 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_681, %e1_682, %e2_683 = cute.get_leaves(%462) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_684 = cute.size(%e1_682) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_685 = cute.get_leaves(%sz_684) : !cute.int_tuple<"16">
      %463 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_686, %e1_687, %e2_688 = cute.get_leaves(%463) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_689 = cute.size(%e2_688) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_690 = cute.get_leaves(%sz_689) : !cute.int_tuple<"16">
      %tile_691 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %464 = cute.make_tiled_copy(%atom_658) : !copy_ldsm_4_2
      %coord_692 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_693 = cute.get_iter(%view_297) : !memref_smem_bf16_
      %465 = cute.get_scalars(%coord_692) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_694 = arith.constant 16 : i32
      %466 = arith.divsi %465, %c16_i32_694 : i32
      %c16_i32_695 = arith.constant 16 : i32
      %467 = arith.remsi %465, %c16_i32_695 : i32
      %c8_i32_696 = arith.constant 8 : i32
      %468 = arith.divsi %467, %c8_i32_696 : i32
      %c8_i32_697 = arith.constant 8 : i32
      %469 = arith.remsi %467, %c8_i32_697 : i32
      %c64_i32_698 = arith.constant 64 : i32
      %470 = arith.muli %469, %c64_i32_698 : i32
      %c2_i32_699 = arith.constant 2 : i32
      %471 = arith.divsi %466, %c2_i32_699 : i32
      %c2_i32_700 = arith.constant 2 : i32
      %472 = arith.remsi %466, %c2_i32_700 : i32
      %c8_i32_701 = arith.constant 8 : i32
      %473 = arith.muli %472, %c8_i32_701 : i32
      %474 = arith.addi %470, %473 : i32
      %c0_i32_702 = arith.constant 0 : i32
      %475 = arith.xori %474, %c0_i32_702 : i32
      %c16_i32_703 = arith.constant 16 : i32
      %476 = arith.divsi %465, %c16_i32_703 : i32
      %c16_i32_704 = arith.constant 16 : i32
      %477 = arith.remsi %465, %c16_i32_704 : i32
      %c8_i32_705 = arith.constant 8 : i32
      %478 = arith.divsi %477, %c8_i32_705 : i32
      %c8_i32_706 = arith.constant 8 : i32
      %479 = arith.remsi %477, %c8_i32_706 : i32
      %c512_i32_707 = arith.constant 512 : i32
      %480 = arith.muli %478, %c512_i32_707 : i32
      %c2_i32_708 = arith.constant 2 : i32
      %481 = arith.divsi %476, %c2_i32_708 : i32
      %c2_i32_709 = arith.constant 2 : i32
      %482 = arith.remsi %476, %c2_i32_709 : i32
      %c1024_i32_710 = arith.constant 1024 : i32
      %483 = arith.muli %481, %c1024_i32_710 : i32
      %484 = arith.addi %480, %483 : i32
      %c64_i32_711 = arith.constant 64 : i32
      %485 = arith.andi %475, %c64_i32_711 : i32
      %c0_i32_712 = arith.constant 0 : i32
      %486 = arith.cmpi eq, %485, %c0_i32_712 : i32
      %487 = scf.if %486 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_713 = arith.constant 128 : i32
      %488 = arith.andi %475, %c128_i32_713 : i32
      %c0_i32_714 = arith.constant 0 : i32
      %489 = arith.cmpi eq, %488, %c0_i32_714 : i32
      %490 = scf.if %489 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_715 = arith.constant 256 : i32
      %491 = arith.andi %475, %c256_i32_715 : i32
      %c0_i32_716 = arith.constant 0 : i32
      %492 = arith.cmpi eq, %491, %c0_i32_716 : i32
      %493 = scf.if %492 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_717 = arith.constant 8 : i32
      %494 = arith.andi %475, %c8_i32_717 : i32
      %c0_i32_718 = arith.constant 0 : i32
      %495 = arith.cmpi eq, %494, %c0_i32_718 : i32
      %496 = scf.if %495 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_719 = arith.constant 16 : i32
      %497 = arith.andi %475, %c16_i32_719 : i32
      %c0_i32_720 = arith.constant 0 : i32
      %498 = arith.cmpi eq, %497, %c0_i32_720 : i32
      %499 = scf.if %498 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_721 = arith.constant 32 : i32
      %500 = arith.andi %475, %c32_i32_721 : i32
      %c0_i32_722 = arith.constant 0 : i32
      %501 = arith.cmpi eq, %500, %c0_i32_722 : i32
      %502 = scf.if %501 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_723 = arith.constant 448 : i32
      %503 = arith.andi %475, %c448_i32_723 : i32
      %c3_i32_724 = arith.constant 3 : i32
      %504 = arith.shrsi %503, %c3_i32_724 : i32
      %505 = arith.xori %475, %504 : i32
      %506 = arith.addi %505, %484 : i32
      %c512_i32_725 = arith.constant 512 : i32
      %507 = arith.muli %487, %c512_i32_725 : i32
      %c256_i32_726 = arith.constant 256 : i32
      %508 = arith.muli %490, %c256_i32_726 : i32
      %c128_i32_727 = arith.constant 128 : i32
      %509 = arith.muli %493, %c128_i32_727 : i32
      %c64_i32_728 = arith.constant 64 : i32
      %510 = arith.muli %496, %c64_i32_728 : i32
      %c32_i32_729 = arith.constant 32 : i32
      %511 = arith.muli %499, %c32_i32_729 : i32
      %c16_i32_730 = arith.constant 16 : i32
      %512 = arith.muli %502, %c16_i32_730 : i32
      %c2_i32_731 = arith.constant 2 : i32
      %513 = arith.muli %487, %c2_i32_731 : i32
      %c1024_i32_732 = arith.constant 1024 : i32
      %514 = arith.muli %487, %c1024_i32_732 : i32
      %c512_i32_733 = arith.constant 512 : i32
      %515 = arith.muli %490, %c512_i32_733 : i32
      %c256_i32_734 = arith.constant 256 : i32
      %516 = arith.muli %493, %c256_i32_734 : i32
      %c128_i32_735 = arith.constant 128 : i32
      %517 = arith.muli %496, %c128_i32_735 : i32
      %c64_i32_736 = arith.constant 64 : i32
      %518 = arith.muli %499, %c64_i32_736 : i32
      %c32_i32_737 = arith.constant 32 : i32
      %519 = arith.muli %502, %c32_i32_737 : i32
      %iv_738 = cute.assume(%506) : (i32) -> !cute.i32<divby 8>
      %int_tuple_739 = cute.make_int_tuple(%iv_738) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_740 = cute.add_offset(%iter_693, %int_tuple_739) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_741 = cute.make_shape() : () -> !cute.shape<"((8,1),2,((2,2),2))">
      %iv_742 = cute.assume(%490) : (i32) -> !cute.i32<divby 16>
      %iv_743 = cute.assume(%493) : (i32) -> !cute.i32<divby 32>
      %stride_744 = cute.make_stride(%iv_742, %iv_743) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),4096,((?{div=16},?{div=32}),8192))">
      %lay_745 = cute.make_layout(%shape_741, %stride_744) : !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
      %view_746 = cute.make_view(%ptr_740, %lay_745) : !memref_smem_bf16_8
      %iter_747 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %iter_748 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %view_749 = cute.make_view(%iter_748) : !memref_rmem_bf16_3
      %iter_750 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %coord_751 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_752 = cute.get_iter(%view_300) : !memref_smem_bf16_1
      %520 = cute.get_scalars(%coord_751) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_753 = arith.constant 8 : i32
      %521 = arith.divsi %520, %c8_i32_753 : i32
      %c8_i32_754 = arith.constant 8 : i32
      %522 = arith.remsi %520, %c8_i32_754 : i32
      %c64_i32_755 = arith.constant 64 : i32
      %523 = arith.muli %522, %c64_i32_755 : i32
      %c2_i32_756 = arith.constant 2 : i32
      %524 = arith.divsi %521, %c2_i32_756 : i32
      %c2_i32_757 = arith.constant 2 : i32
      %525 = arith.remsi %521, %c2_i32_757 : i32
      %c8_i32_758 = arith.constant 8 : i32
      %526 = arith.muli %525, %c8_i32_758 : i32
      %527 = arith.addi %523, %526 : i32
      %c2_i32_759 = arith.constant 2 : i32
      %528 = arith.divsi %524, %c2_i32_759 : i32
      %c2_i32_760 = arith.constant 2 : i32
      %529 = arith.remsi %524, %c2_i32_760 : i32
      %c0_i32_761 = arith.constant 0 : i32
      %530 = arith.xori %527, %c0_i32_761 : i32
      %c8_i32_762 = arith.constant 8 : i32
      %531 = arith.divsi %520, %c8_i32_762 : i32
      %c8_i32_763 = arith.constant 8 : i32
      %532 = arith.remsi %520, %c8_i32_763 : i32
      %c2_i32_764 = arith.constant 2 : i32
      %533 = arith.divsi %531, %c2_i32_764 : i32
      %c2_i32_765 = arith.constant 2 : i32
      %534 = arith.remsi %531, %c2_i32_765 : i32
      %c2_i32_766 = arith.constant 2 : i32
      %535 = arith.divsi %533, %c2_i32_766 : i32
      %c2_i32_767 = arith.constant 2 : i32
      %536 = arith.remsi %533, %c2_i32_767 : i32
      %c512_i32_768 = arith.constant 512 : i32
      %537 = arith.muli %536, %c512_i32_768 : i32
      %c64_i32_769 = arith.constant 64 : i32
      %538 = arith.andi %530, %c64_i32_769 : i32
      %c0_i32_770 = arith.constant 0 : i32
      %539 = arith.cmpi eq, %538, %c0_i32_770 : i32
      %540 = scf.if %539 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_771 = arith.constant 128 : i32
      %541 = arith.andi %530, %c128_i32_771 : i32
      %c0_i32_772 = arith.constant 0 : i32
      %542 = arith.cmpi eq, %541, %c0_i32_772 : i32
      %543 = scf.if %542 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_773 = arith.constant 256 : i32
      %544 = arith.andi %530, %c256_i32_773 : i32
      %c0_i32_774 = arith.constant 0 : i32
      %545 = arith.cmpi eq, %544, %c0_i32_774 : i32
      %546 = scf.if %545 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_775 = arith.constant 8 : i32
      %547 = arith.andi %530, %c8_i32_775 : i32
      %c0_i32_776 = arith.constant 0 : i32
      %548 = arith.cmpi eq, %547, %c0_i32_776 : i32
      %549 = scf.if %548 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_777 = arith.constant 16 : i32
      %550 = arith.andi %530, %c16_i32_777 : i32
      %c0_i32_778 = arith.constant 0 : i32
      %551 = arith.cmpi eq, %550, %c0_i32_778 : i32
      %552 = scf.if %551 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_779 = arith.constant 32 : i32
      %553 = arith.andi %530, %c32_i32_779 : i32
      %c0_i32_780 = arith.constant 0 : i32
      %554 = arith.cmpi eq, %553, %c0_i32_780 : i32
      %555 = scf.if %554 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_781 = arith.constant 448 : i32
      %556 = arith.andi %530, %c448_i32_781 : i32
      %c3_i32_782 = arith.constant 3 : i32
      %557 = arith.shrsi %556, %c3_i32_782 : i32
      %558 = arith.xori %530, %557 : i32
      %559 = arith.addi %558, %537 : i32
      %c128_i32_783 = arith.constant 128 : i32
      %560 = arith.muli %540, %c128_i32_783 : i32
      %c64_i32_784 = arith.constant 64 : i32
      %561 = arith.muli %543, %c64_i32_784 : i32
      %c32_i32_785 = arith.constant 32 : i32
      %562 = arith.muli %546, %c32_i32_785 : i32
      %c16_i32_786 = arith.constant 16 : i32
      %563 = arith.muli %549, %c16_i32_786 : i32
      %c8_i32_787 = arith.constant 8 : i32
      %564 = arith.muli %552, %c8_i32_787 : i32
      %c4_i32_788 = arith.constant 4 : i32
      %565 = arith.muli %555, %c4_i32_788 : i32
      %c2_i32_789 = arith.constant 2 : i32
      %566 = arith.muli %540, %c2_i32_789 : i32
      %c512_i32_790 = arith.constant 512 : i32
      %567 = arith.muli %540, %c512_i32_790 : i32
      %c256_i32_791 = arith.constant 256 : i32
      %568 = arith.muli %543, %c256_i32_791 : i32
      %c128_i32_792 = arith.constant 128 : i32
      %569 = arith.muli %546, %c128_i32_792 : i32
      %c64_i32_793 = arith.constant 64 : i32
      %570 = arith.muli %549, %c64_i32_793 : i32
      %c32_i32_794 = arith.constant 32 : i32
      %571 = arith.muli %552, %c32_i32_794 : i32
      %c16_i32_795 = arith.constant 16 : i32
      %572 = arith.muli %555, %c16_i32_795 : i32
      %iv_796 = cute.assume(%559) : (i32) -> !cute.i32<divby 8>
      %int_tuple_797 = cute.make_int_tuple(%iv_796) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_798 = cute.add_offset(%iter_752, %int_tuple_797) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_799 = cute.make_shape() : () -> !cute.shape<"((8,1),4,((2,2),2))">
      %iv_800 = cute.assume(%543) : (i32) -> !cute.i32<divby 16>
      %iv_801 = cute.assume(%546) : (i32) -> !cute.i32<divby 32>
      %stride_802 = cute.make_stride(%iv_800, %iv_801) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),1024,((?{div=16},?{div=32}),4096))">
      %lay_803 = cute.make_layout(%shape_799, %stride_802) : !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
      %view_804 = cute.make_view(%ptr_798, %lay_803) : !memref_smem_bf16_9
      %iter_805 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %iter_806 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %view_807 = cute.make_view(%iter_806) : !memref_rmem_bf16_4
      %iter_808 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %coord_809 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_810 = cute.get_iter(%view_309) : !memref_smem_bf16_2
      %573 = cute.get_scalars(%coord_809) <{only_dynamic}> : !cute.coord<"?">
      %c16_i32_811 = arith.constant 16 : i32
      %574 = arith.divsi %573, %c16_i32_811 : i32
      %c16_i32_812 = arith.constant 16 : i32
      %575 = arith.remsi %573, %c16_i32_812 : i32
      %c8_i32_813 = arith.constant 8 : i32
      %576 = arith.divsi %575, %c8_i32_813 : i32
      %c8_i32_814 = arith.constant 8 : i32
      %577 = arith.remsi %575, %c8_i32_814 : i32
      %c64_i32_815 = arith.constant 64 : i32
      %578 = arith.muli %577, %c64_i32_815 : i32
      %c2_i32_816 = arith.constant 2 : i32
      %579 = arith.divsi %574, %c2_i32_816 : i32
      %c2_i32_817 = arith.constant 2 : i32
      %580 = arith.remsi %574, %c2_i32_817 : i32
      %c8_i32_818 = arith.constant 8 : i32
      %581 = arith.muli %580, %c8_i32_818 : i32
      %582 = arith.addi %578, %581 : i32
      %c0_i32_819 = arith.constant 0 : i32
      %583 = arith.xori %582, %c0_i32_819 : i32
      %c16_i32_820 = arith.constant 16 : i32
      %584 = arith.divsi %573, %c16_i32_820 : i32
      %c16_i32_821 = arith.constant 16 : i32
      %585 = arith.remsi %573, %c16_i32_821 : i32
      %c8_i32_822 = arith.constant 8 : i32
      %586 = arith.divsi %585, %c8_i32_822 : i32
      %c8_i32_823 = arith.constant 8 : i32
      %587 = arith.remsi %585, %c8_i32_823 : i32
      %c512_i32_824 = arith.constant 512 : i32
      %588 = arith.muli %586, %c512_i32_824 : i32
      %c2_i32_825 = arith.constant 2 : i32
      %589 = arith.divsi %584, %c2_i32_825 : i32
      %c2_i32_826 = arith.constant 2 : i32
      %590 = arith.remsi %584, %c2_i32_826 : i32
      %c64_i32_827 = arith.constant 64 : i32
      %591 = arith.andi %583, %c64_i32_827 : i32
      %c0_i32_828 = arith.constant 0 : i32
      %592 = arith.cmpi eq, %591, %c0_i32_828 : i32
      %593 = scf.if %592 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_829 = arith.constant 128 : i32
      %594 = arith.andi %583, %c128_i32_829 : i32
      %c0_i32_830 = arith.constant 0 : i32
      %595 = arith.cmpi eq, %594, %c0_i32_830 : i32
      %596 = scf.if %595 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_831 = arith.constant 256 : i32
      %597 = arith.andi %583, %c256_i32_831 : i32
      %c0_i32_832 = arith.constant 0 : i32
      %598 = arith.cmpi eq, %597, %c0_i32_832 : i32
      %599 = scf.if %598 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_833 = arith.constant 8 : i32
      %600 = arith.andi %583, %c8_i32_833 : i32
      %c0_i32_834 = arith.constant 0 : i32
      %601 = arith.cmpi eq, %600, %c0_i32_834 : i32
      %602 = scf.if %601 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_835 = arith.constant 16 : i32
      %603 = arith.andi %583, %c16_i32_835 : i32
      %c0_i32_836 = arith.constant 0 : i32
      %604 = arith.cmpi eq, %603, %c0_i32_836 : i32
      %605 = scf.if %604 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_837 = arith.constant 32 : i32
      %606 = arith.andi %583, %c32_i32_837 : i32
      %c0_i32_838 = arith.constant 0 : i32
      %607 = arith.cmpi eq, %606, %c0_i32_838 : i32
      %608 = scf.if %607 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_839 = arith.constant 448 : i32
      %609 = arith.andi %583, %c448_i32_839 : i32
      %c3_i32_840 = arith.constant 3 : i32
      %610 = arith.shrsi %609, %c3_i32_840 : i32
      %611 = arith.xori %583, %610 : i32
      %612 = arith.addi %611, %588 : i32
      %c2_i32_841 = arith.constant 2 : i32
      %613 = arith.muli %593, %c2_i32_841 : i32
      %c512_i32_842 = arith.constant 512 : i32
      %614 = arith.muli %593, %c512_i32_842 : i32
      %c256_i32_843 = arith.constant 256 : i32
      %615 = arith.muli %596, %c256_i32_843 : i32
      %c128_i32_844 = arith.constant 128 : i32
      %616 = arith.muli %599, %c128_i32_844 : i32
      %c64_i32_845 = arith.constant 64 : i32
      %617 = arith.muli %602, %c64_i32_845 : i32
      %c32_i32_846 = arith.constant 32 : i32
      %618 = arith.muli %605, %c32_i32_846 : i32
      %c16_i32_847 = arith.constant 16 : i32
      %619 = arith.muli %608, %c16_i32_847 : i32
      %c128_i32_848 = arith.constant 128 : i32
      %620 = arith.muli %593, %c128_i32_848 : i32
      %c64_i32_849 = arith.constant 64 : i32
      %621 = arith.muli %596, %c64_i32_849 : i32
      %c32_i32_850 = arith.constant 32 : i32
      %622 = arith.muli %599, %c32_i32_850 : i32
      %c16_i32_851 = arith.constant 16 : i32
      %623 = arith.muli %602, %c16_i32_851 : i32
      %c8_i32_852 = arith.constant 8 : i32
      %624 = arith.muli %605, %c8_i32_852 : i32
      %c4_i32_853 = arith.constant 4 : i32
      %625 = arith.muli %608, %c4_i32_853 : i32
      %iv_854 = cute.assume(%612) : (i32) -> !cute.i32<divby 8>
      %int_tuple_855 = cute.make_int_tuple(%iv_854) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_856 = cute.add_offset(%iter_810, %int_tuple_855) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %shape_857 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2),4)">
      %iv_858 = cute.assume(%596) : (i32) -> !cute.i32<divby 16>
      %iv_859 = cute.assume(%599) : (i32) -> !cute.i32<divby 32>
      %stride_860 = cute.make_stride(%iv_858, %iv_859) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096),1024)">
      %lay_861 = cute.make_layout(%shape_857, %stride_860) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %view_862 = cute.make_view(%ptr_856, %lay_861) : !memref_smem_bf16_10
      %iter_863 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %iter_864 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %view_865 = cute.make_view(%iter_864) : !memref_rmem_bf16_5
      %iter_866 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %lay_867 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %626 = cute.get_shape(%lay_867) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_868, %e1_869, %e2_870, %e3_871 = cute.get_leaves(%626) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_872 = cute.to_int_tuple(%e0_868) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %627 = cute.get_scalars(%itup_872) : !cute.int_tuple<"?">
      %itup_873 = cute.to_int_tuple(%e1_869) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %628 = cute.get_scalars(%itup_873) : !cute.int_tuple<"?">
      %itup_874 = cute.to_int_tuple(%e2_870) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %629 = cute.get_scalars(%itup_874) : !cute.int_tuple<"?">
      %itup_875 = cute.to_int_tuple(%e3_871) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %630 = cute.get_scalars(%itup_875) : !cute.int_tuple<"?{div=8}">
      %shape_876 = cute.make_shape(%itup_872, %itup_873, %itup_874, %itup_875) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_877 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_878 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_879 = cute.make_layout(%shape_876, %stride_878) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_880 = cute.make_view(%int_tuple_877, %lay_879) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_881 = cute.get_iter(%view_880) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_882, %e1_883, %e2_884, %e3_885 = cute.get_leaves(%iter_881) : !cute.int_tuple<"(0,0,0,0)">
      %lay_886 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %631 = cute.get_shape(%lay_886) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_887, %e1_888, %e2_889, %e3_890 = cute.get_leaves(%631) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_891 = cute.to_int_tuple(%e0_887) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %632 = cute.get_scalars(%itup_891) : !cute.int_tuple<"?">
      %itup_892 = cute.to_int_tuple(%e1_888) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %633 = cute.get_scalars(%itup_892) : !cute.int_tuple<"?">
      %itup_893 = cute.to_int_tuple(%e2_889) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %634 = cute.get_scalars(%itup_893) : !cute.int_tuple<"?">
      %itup_894 = cute.to_int_tuple(%e3_890) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %635 = cute.get_scalars(%itup_894) : !cute.int_tuple<"?{div=8}">
      %shape_895 = cute.make_shape(%itup_891, %itup_892, %itup_893, %itup_894) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_896 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_897 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_898 = cute.make_layout(%shape_895, %stride_897) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_899 = cute.make_view(%int_tuple_896, %lay_898) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_900 = cute.get_iter(%view_899) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_901, %e1_902, %e2_903, %e3_904 = cute.get_leaves(%iter_900) : !cute.int_tuple<"(0,0,0,0)">
      %coord_905 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_906 = cute.get_layout(%view_880) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %636:4 = cute.get_scalars(%lay_906) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %637:2 = cute.get_scalars(%coord_905) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_907 = cute.assume(%636#3) : (i32) -> !cute.i32<divby 8>
      %shape_908 = cute.make_shape(%636#1, %iv_907) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_909 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_910 = cute.make_layout(%shape_908, %stride_909) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_911 = cute.crd2idx(%coord_905, %lay_906) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_912 = cute.get_iter(%view_880) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_912, %idx_911) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_913 = cute.make_view(%tup, %lay_910) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_914 = cute.get_iter(%view_913) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_915, %e1_916, %e2_917, %e3_918 = cute.get_leaves(%iter_914) : !cute.int_tuple<"(?,0,?,0)">
      %638 = cute.get_scalars(%e0_915) : !cute.int_tuple<"?">
      %639 = cute.get_scalars(%e2_917) : !cute.int_tuple<"?">
      %iter_919 = cute.get_iter(%view_913) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_920, %e1_921, %e2_922, %e3_923 = cute.get_leaves(%iter_919) : !cute.int_tuple<"(?,0,?,0)">
      %640 = cute.get_scalars(%e0_920) : !cute.int_tuple<"?">
      %641 = cute.get_scalars(%e2_922) : !cute.int_tuple<"?">
      %tile_924 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_925 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %642 = cute.get_scalars(%coord_925) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_926 = cute.make_coord(%642) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_927 = cute.get_layout(%view_913) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %643:2 = cute.get_scalars(%lay_927) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_928 = arith.constant 128 : i32
      %644 = arith.ceildivsi %643#0, %c128_i32_928 : i32
      %c128_i32_929 = arith.constant 128 : i32
      %645 = arith.ceildivsi %643#1, %c128_i32_929 : i32
      %shape_930 = cute.make_shape(%644, %645) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_931 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_932 = cute.make_layout(%shape_930, %stride_931) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_933 = cute.crd2idx(%coord_926, %lay_932) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_934 = cute.get_iter(%view_913) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_935 = cute.add_offset(%iter_934, %idx_933) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_936 = cute.make_view(%tup_935) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_937 = cute.get_iter(%view_936) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_938, %e1_939, %e2_940, %e3_941 = cute.get_leaves(%iter_937) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %646 = cute.get_scalars(%e0_938) : !cute.int_tuple<"?">
      %647 = cute.get_scalars(%e1_939) : !cute.int_tuple<"?{div=128}">
      %648 = cute.get_scalars(%e2_940) : !cute.int_tuple<"?">
      %coord_942 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_943 = cute.get_layout(%view_899) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %649:4 = cute.get_scalars(%lay_943) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %650:2 = cute.get_scalars(%coord_942) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_944 = cute.assume(%649#3) : (i32) -> !cute.i32<divby 8>
      %shape_945 = cute.make_shape(%649#1, %iv_944) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_946 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_947 = cute.make_layout(%shape_945, %stride_946) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_948 = cute.crd2idx(%coord_942, %lay_943) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_949 = cute.get_iter(%view_899) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_950 = cute.add_offset(%iter_949, %idx_948) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_951 = cute.make_view(%tup_950, %lay_947) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_952 = cute.get_iter(%view_951) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_953, %e1_954, %e2_955, %e3_956 = cute.get_leaves(%iter_952) : !cute.int_tuple<"(?,0,?,0)">
      %651 = cute.get_scalars(%e0_953) : !cute.int_tuple<"?">
      %652 = cute.get_scalars(%e2_955) : !cute.int_tuple<"?">
      %iter_957 = cute.get_iter(%view_951) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_958, %e1_959, %e2_960, %e3_961 = cute.get_leaves(%iter_957) : !cute.int_tuple<"(?,0,?,0)">
      %653 = cute.get_scalars(%e0_958) : !cute.int_tuple<"?">
      %654 = cute.get_scalars(%e2_960) : !cute.int_tuple<"?">
      %tile_962 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_963 = cute.make_coord(%129) : (i32) -> !cute.coord<"(?,0)">
      %655 = cute.get_scalars(%coord_963) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_964 = cute.make_coord(%655) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_965 = cute.get_layout(%view_951) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %656:2 = cute.get_scalars(%lay_965) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_966 = arith.constant 64 : i32
      %657 = arith.ceildivsi %656#0, %c64_i32_966 : i32
      %c128_i32_967 = arith.constant 128 : i32
      %658 = arith.ceildivsi %656#1, %c128_i32_967 : i32
      %shape_968 = cute.make_shape(%657, %658) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_969 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_970 = cute.make_layout(%shape_968, %stride_969) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_971 = cute.crd2idx(%coord_964, %lay_970) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_972 = cute.get_iter(%view_951) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_973 = cute.add_offset(%iter_972, %idx_971) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_974 = cute.make_view(%tup_973) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_975 = cute.get_iter(%view_974) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_976, %e1_977, %e2_978, %e3_979 = cute.get_leaves(%iter_975) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %659 = cute.get_scalars(%e0_976) : !cute.int_tuple<"?">
      %660 = cute.get_scalars(%e1_977) : !cute.int_tuple<"?{div=64}">
      %661 = cute.get_scalars(%e2_978) : !cute.int_tuple<"?">
      %coord_980 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_981 = cute.get_iter(%view_936) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %662 = cute.get_scalars(%coord_980) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_982 = arith.constant 8 : i32
      %663 = arith.divsi %662, %c8_i32_982 : i32
      %c8_i32_983 = arith.constant 8 : i32
      %664 = arith.remsi %662, %c8_i32_983 : i32
      %c8_i32_984 = arith.constant 8 : i32
      %665 = arith.muli %664, %c8_i32_984 : i32
      %iv_985 = cute.assume(%665) : (i32) -> !cute.i32<divby 8>
      %int_tuple_986 = cute.make_int_tuple(%663, %iv_985) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_987 = cute.add_offset(%iter_981, %int_tuple_986) : (!cute.int_tuple<"(?,?{div=128},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_988 = cute.make_view(%tup_987) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_989 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_990, %e1_991, %e2_992, %e3_993 = cute.get_leaves(%iter_989) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %666 = cute.get_scalars(%e0_990) : !cute.int_tuple<"?">
      %667 = cute.get_scalars(%e1_991) : !cute.int_tuple<"?">
      %668 = cute.get_scalars(%e2_992) : !cute.int_tuple<"?">
      %669 = cute.get_scalars(%e3_993) : !cute.int_tuple<"?{div=8}">
      %coord_994 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_995 = cute.get_iter(%view_974) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %670 = cute.get_scalars(%coord_994) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_996 = arith.constant 8 : i32
      %671 = arith.divsi %670, %c8_i32_996 : i32
      %c8_i32_997 = arith.constant 8 : i32
      %672 = arith.remsi %670, %c8_i32_997 : i32
      %c8_i32_998 = arith.constant 8 : i32
      %673 = arith.muli %672, %c8_i32_998 : i32
      %iv_999 = cute.assume(%673) : (i32) -> !cute.i32<divby 8>
      %int_tuple_1000 = cute.make_int_tuple(%671, %iv_999) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_1001 = cute.add_offset(%iter_995, %int_tuple_1000) : (!cute.int_tuple<"(?,?{div=64},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1002 = cute.make_view(%tup_1001) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_1003 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_1004, %e1_1005, %e2_1006, %e3_1007 = cute.get_leaves(%iter_1003) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %674 = cute.get_scalars(%e0_1004) : !cute.int_tuple<"?">
      %675 = cute.get_scalars(%e1_1005) : !cute.int_tuple<"?">
      %676 = cute.get_scalars(%e2_1006) : !cute.int_tuple<"?">
      %677 = cute.get_scalars(%e3_1007) : !cute.int_tuple<"?{div=8}">
      %lay_1008 = cute.get_layout(%view_361) : !memref_smem_bf16_3
      %678 = cute.get_shape(%lay_1008) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_1009, %e1_1010, %e2_1011, %e3_1012 = cute.get_leaves(%678) : !cute.shape<"((8,1),8,2)">
      %lay_1013 = cute.get_layout(%view_361) : !memref_smem_bf16_3
      %sz_1014 = cute.size(%lay_1013) <{mode = [1]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"8">
      %e0_1015 = cute.get_leaves(%sz_1014) : !cute.int_tuple<"8">
      %lay_1016 = cute.get_layout(%view_361) : !memref_smem_bf16_3
      %sz_1017 = cute.size(%lay_1016) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_1018 = cute.get_leaves(%sz_1017) : !cute.int_tuple<"2">
      %lay_1019 = cute.get_layout(%view_361) : !memref_smem_bf16_3
      %sz_1020 = cute.size(%lay_1019) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_1021 = cute.get_leaves(%sz_1020) : !cute.int_tuple<"2">
      %shape_1022 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_1023 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1024 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_1025 = cute.memref.alloca(%lay_1024) : !memref_rmem_i8_
      %iter_1026 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
      %iter_1027 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
      %lay_1028 = cute.get_layout(%view_425) : !memref_smem_bf16_4
      %679 = cute.get_shape(%lay_1028) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_1029, %e1_1030, %e2_1031, %e3_1032 = cute.get_leaves(%679) : !cute.shape<"((8,1),4,2)">
      %lay_1033 = cute.get_layout(%view_425) : !memref_smem_bf16_4
      %sz_1034 = cute.size(%lay_1033) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_1035 = cute.get_leaves(%sz_1034) : !cute.int_tuple<"4">
      %lay_1036 = cute.get_layout(%view_425) : !memref_smem_bf16_4
      %sz_1037 = cute.size(%lay_1036) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1038 = cute.get_leaves(%sz_1037) : !cute.int_tuple<"2">
      %lay_1039 = cute.get_layout(%view_425) : !memref_smem_bf16_4
      %sz_1040 = cute.size(%lay_1039) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_1041 = cute.get_leaves(%sz_1040) : !cute.int_tuple<"2">
      %shape_1042 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_1043 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_1044 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_1045 = cute.memref.alloca(%lay_1044) : !memref_rmem_i8_1
      %iter_1046 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
      %iter_1047 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
      %lay_1048 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
      %680 = cute.get_shape(%lay_1048) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_1049, %e1_1050, %e2_1051 = cute.get_leaves(%680) : !cute.shape<"(1,8,2)">
      %coord_1052 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1053 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1054 = cute.crd2idx(%coord_1052, %lay_1053) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1055 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1056 = cute.add_offset(%iter_1055, %idx_1054) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1057 = cute.make_view(%tup_1056) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1058 = cute.get_iter(%view_1057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1059, %e1_1060, %e2_1061, %e3_1062 = cute.get_leaves(%iter_1058) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %681 = cute.get_scalars(%e0_1059) : !cute.int_tuple<"?">
      %682 = cute.get_scalars(%e1_1060) : !cute.int_tuple<"?">
      %683 = cute.get_scalars(%e2_1061) : !cute.int_tuple<"?">
      %684 = cute.get_scalars(%e3_1062) : !cute.int_tuple<"?{div=8}">
      %iter_1063 = cute.get_iter(%view_1057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1064, %e1_1065, %e2_1066, %e3_1067 = cute.get_leaves(%iter_1063) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %685 = cute.get_scalars(%e0_1064) : !cute.int_tuple<"?">
      %686 = cute.get_scalars(%e1_1065) : !cute.int_tuple<"?">
      %687 = cute.get_scalars(%e2_1066) : !cute.int_tuple<"?">
      %688 = cute.get_scalars(%e3_1067) : !cute.int_tuple<"?{div=8}">
      %iter_1068 = cute.get_iter(%view_1057) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1069, %e1_1070, %e2_1071, %e3_1072 = cute.get_leaves(%iter_1068) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %689 = cute.get_scalars(%e0_1069) : !cute.int_tuple<"?">
      %690 = cute.get_scalars(%e1_1070) : !cute.int_tuple<"?">
      %691 = cute.get_scalars(%e2_1071) : !cute.int_tuple<"?">
      %692 = cute.get_scalars(%e3_1072) : !cute.int_tuple<"?{div=8}">
      %lay_1073 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %693 = cute.get_shape(%lay_1073) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1074, %e1_1075, %e2_1076, %e3_1077 = cute.get_leaves(%693) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1078 = cute.to_int_tuple(%e0_1074) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %694 = cute.get_scalars(%itup_1078) : !cute.int_tuple<"?">
      %itup_1079 = cute.to_int_tuple(%e1_1075) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %695 = cute.get_scalars(%itup_1079) : !cute.int_tuple<"?">
      %itup_1080 = cute.to_int_tuple(%e2_1076) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %696 = cute.get_scalars(%itup_1080) : !cute.int_tuple<"?">
      %itup_1081 = cute.to_int_tuple(%e3_1077) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %697 = cute.get_scalars(%itup_1081) : !cute.int_tuple<"?{div=8}">
      %coord_1082 = cute.make_coord(%e3_1072) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1083 = cute.make_coord(%itup_1081) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %698 = cute.get_scalars(%coord_1082) : !cute.coord<"?{div=8}">
      %699 = cute.get_scalars(%coord_1083) : !cute.coord<"?{div=8}">
      %true = arith.constant true
      %700 = arith.cmpi slt, %698, %699 : i32
      %701 = arith.andi %true, %700 : i1
      %702 = arith.extui %701 : i1 to i8
      %coord_1084 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1025, %coord_1084, %702) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1085 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1086 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1087 = cute.crd2idx(%coord_1085, %lay_1086) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1088 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1089 = cute.add_offset(%iter_1088, %idx_1087) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1090 = cute.make_view(%tup_1089) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1091 = cute.get_iter(%view_1090) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1092, %e1_1093, %e2_1094, %e3_1095 = cute.get_leaves(%iter_1091) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %703 = cute.get_scalars(%e0_1092) : !cute.int_tuple<"?">
      %704 = cute.get_scalars(%e1_1093) : !cute.int_tuple<"?">
      %705 = cute.get_scalars(%e2_1094) : !cute.int_tuple<"?">
      %706 = cute.get_scalars(%e3_1095) : !cute.int_tuple<"?{div=8}">
      %iter_1096 = cute.get_iter(%view_1090) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1097, %e1_1098, %e2_1099, %e3_1100 = cute.get_leaves(%iter_1096) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %707 = cute.get_scalars(%e0_1097) : !cute.int_tuple<"?">
      %708 = cute.get_scalars(%e1_1098) : !cute.int_tuple<"?">
      %709 = cute.get_scalars(%e2_1099) : !cute.int_tuple<"?">
      %710 = cute.get_scalars(%e3_1100) : !cute.int_tuple<"?{div=8}">
      %iter_1101 = cute.get_iter(%view_1090) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1102, %e1_1103, %e2_1104, %e3_1105 = cute.get_leaves(%iter_1101) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %711 = cute.get_scalars(%e0_1102) : !cute.int_tuple<"?">
      %712 = cute.get_scalars(%e1_1103) : !cute.int_tuple<"?">
      %713 = cute.get_scalars(%e2_1104) : !cute.int_tuple<"?">
      %714 = cute.get_scalars(%e3_1105) : !cute.int_tuple<"?{div=8}">
      %lay_1106 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %715 = cute.get_shape(%lay_1106) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1107, %e1_1108, %e2_1109, %e3_1110 = cute.get_leaves(%715) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1111 = cute.to_int_tuple(%e0_1107) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %716 = cute.get_scalars(%itup_1111) : !cute.int_tuple<"?">
      %itup_1112 = cute.to_int_tuple(%e1_1108) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %717 = cute.get_scalars(%itup_1112) : !cute.int_tuple<"?">
      %itup_1113 = cute.to_int_tuple(%e2_1109) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %718 = cute.get_scalars(%itup_1113) : !cute.int_tuple<"?">
      %itup_1114 = cute.to_int_tuple(%e3_1110) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %719 = cute.get_scalars(%itup_1114) : !cute.int_tuple<"?{div=8}">
      %coord_1115 = cute.make_coord(%e3_1105) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1116 = cute.make_coord(%itup_1114) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %720 = cute.get_scalars(%coord_1115) : !cute.coord<"?{div=8}">
      %721 = cute.get_scalars(%coord_1116) : !cute.coord<"?{div=8}">
      %true_1117 = arith.constant true
      %722 = arith.cmpi slt, %720, %721 : i32
      %723 = arith.andi %true_1117, %722 : i1
      %724 = arith.extui %723 : i1 to i8
      %coord_1118 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1025, %coord_1118, %724) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_1119 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
      %725 = cute.get_shape(%lay_1119) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_1120, %e1_1121, %e2_1122 = cute.get_leaves(%725) : !cute.shape<"(1,4,2)">
      %coord_1123 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_1124 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1125 = cute.crd2idx(%coord_1123, %lay_1124) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1126 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1127 = cute.add_offset(%iter_1126, %idx_1125) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1128 = cute.make_view(%tup_1127) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1129 = cute.get_iter(%view_1128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1130, %e1_1131, %e2_1132, %e3_1133 = cute.get_leaves(%iter_1129) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %726 = cute.get_scalars(%e0_1130) : !cute.int_tuple<"?">
      %727 = cute.get_scalars(%e1_1131) : !cute.int_tuple<"?">
      %728 = cute.get_scalars(%e2_1132) : !cute.int_tuple<"?">
      %729 = cute.get_scalars(%e3_1133) : !cute.int_tuple<"?{div=8}">
      %iter_1134 = cute.get_iter(%view_1128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1135, %e1_1136, %e2_1137, %e3_1138 = cute.get_leaves(%iter_1134) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %730 = cute.get_scalars(%e0_1135) : !cute.int_tuple<"?">
      %731 = cute.get_scalars(%e1_1136) : !cute.int_tuple<"?">
      %732 = cute.get_scalars(%e2_1137) : !cute.int_tuple<"?">
      %733 = cute.get_scalars(%e3_1138) : !cute.int_tuple<"?{div=8}">
      %iter_1139 = cute.get_iter(%view_1128) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1140, %e1_1141, %e2_1142, %e3_1143 = cute.get_leaves(%iter_1139) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %734 = cute.get_scalars(%e0_1140) : !cute.int_tuple<"?">
      %735 = cute.get_scalars(%e1_1141) : !cute.int_tuple<"?">
      %736 = cute.get_scalars(%e2_1142) : !cute.int_tuple<"?">
      %737 = cute.get_scalars(%e3_1143) : !cute.int_tuple<"?{div=8}">
      %lay_1144 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %738 = cute.get_shape(%lay_1144) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1145, %e1_1146, %e2_1147, %e3_1148 = cute.get_leaves(%738) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1149 = cute.to_int_tuple(%e0_1145) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %739 = cute.get_scalars(%itup_1149) : !cute.int_tuple<"?">
      %itup_1150 = cute.to_int_tuple(%e1_1146) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %740 = cute.get_scalars(%itup_1150) : !cute.int_tuple<"?">
      %itup_1151 = cute.to_int_tuple(%e2_1147) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %741 = cute.get_scalars(%itup_1151) : !cute.int_tuple<"?">
      %itup_1152 = cute.to_int_tuple(%e3_1148) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %742 = cute.get_scalars(%itup_1152) : !cute.int_tuple<"?{div=8}">
      %coord_1153 = cute.make_coord(%e3_1143) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1154 = cute.make_coord(%itup_1152) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %743 = cute.get_scalars(%coord_1153) : !cute.coord<"?{div=8}">
      %744 = cute.get_scalars(%coord_1154) : !cute.coord<"?{div=8}">
      %true_1155 = arith.constant true
      %745 = arith.cmpi slt, %743, %744 : i32
      %746 = arith.andi %true_1155, %745 : i1
      %747 = arith.extui %746 : i1 to i8
      %coord_1156 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_1045, %coord_1156, %747) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_1157 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_1158 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1159 = cute.crd2idx(%coord_1157, %lay_1158) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_1160 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1161 = cute.add_offset(%iter_1160, %idx_1159) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1162 = cute.make_view(%tup_1161) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1163 = cute.get_iter(%view_1162) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1164, %e1_1165, %e2_1166, %e3_1167 = cute.get_leaves(%iter_1163) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %748 = cute.get_scalars(%e0_1164) : !cute.int_tuple<"?">
      %749 = cute.get_scalars(%e1_1165) : !cute.int_tuple<"?">
      %750 = cute.get_scalars(%e2_1166) : !cute.int_tuple<"?">
      %751 = cute.get_scalars(%e3_1167) : !cute.int_tuple<"?{div=8}">
      %iter_1168 = cute.get_iter(%view_1162) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1169, %e1_1170, %e2_1171, %e3_1172 = cute.get_leaves(%iter_1168) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %752 = cute.get_scalars(%e0_1169) : !cute.int_tuple<"?">
      %753 = cute.get_scalars(%e1_1170) : !cute.int_tuple<"?">
      %754 = cute.get_scalars(%e2_1171) : !cute.int_tuple<"?">
      %755 = cute.get_scalars(%e3_1172) : !cute.int_tuple<"?{div=8}">
      %iter_1173 = cute.get_iter(%view_1162) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1174, %e1_1175, %e2_1176, %e3_1177 = cute.get_leaves(%iter_1173) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %756 = cute.get_scalars(%e0_1174) : !cute.int_tuple<"?">
      %757 = cute.get_scalars(%e1_1175) : !cute.int_tuple<"?">
      %758 = cute.get_scalars(%e2_1176) : !cute.int_tuple<"?">
      %759 = cute.get_scalars(%e3_1177) : !cute.int_tuple<"?{div=8}">
      %lay_1178 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %760 = cute.get_shape(%lay_1178) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1179, %e1_1180, %e2_1181, %e3_1182 = cute.get_leaves(%760) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1183 = cute.to_int_tuple(%e0_1179) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %761 = cute.get_scalars(%itup_1183) : !cute.int_tuple<"?">
      %itup_1184 = cute.to_int_tuple(%e1_1180) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %762 = cute.get_scalars(%itup_1184) : !cute.int_tuple<"?">
      %itup_1185 = cute.to_int_tuple(%e2_1181) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %763 = cute.get_scalars(%itup_1185) : !cute.int_tuple<"?">
      %itup_1186 = cute.to_int_tuple(%e3_1182) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %764 = cute.get_scalars(%itup_1186) : !cute.int_tuple<"?{div=8}">
      %coord_1187 = cute.make_coord(%e3_1177) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_1188 = cute.make_coord(%itup_1186) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %765 = cute.get_scalars(%coord_1187) : !cute.coord<"?{div=8}">
      %766 = cute.get_scalars(%coord_1188) : !cute.coord<"?{div=8}">
      %true_1189 = arith.constant true
      %767 = arith.cmpi slt, %765, %766 : i32
      %768 = arith.andi %true_1189, %767 : i1
      %769 = arith.extui %768 : i1 to i8
      %coord_1190 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_1045, %coord_1190, %769) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_1191 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_1192 = cute.size(%int_tuple_1191) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_1193 = cute.get_leaves(%sz_1192) : !cute.int_tuple<"8">
      %coord_1194 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1195 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1196 = cute.crd2idx(%coord_1194, %lay_1195) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1197 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1198 = cute.add_offset(%iter_1197, %idx_1196) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1199 = cute.make_view(%tup_1198) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1200 = cute.get_iter(%view_1199) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1201, %e1_1202, %e2_1203, %e3_1204 = cute.get_leaves(%iter_1200) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %770 = cute.get_scalars(%e0_1201) : !cute.int_tuple<"?">
      %771 = cute.get_scalars(%e1_1202) : !cute.int_tuple<"?">
      %772 = cute.get_scalars(%e2_1203) : !cute.int_tuple<"?">
      %773 = cute.get_scalars(%e3_1204) : !cute.int_tuple<"?{div=8}">
      %iter_1205 = cute.get_iter(%view_1199) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1206, %e1_1207, %e2_1208, %e3_1209 = cute.get_leaves(%iter_1205) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %774 = cute.get_scalars(%e0_1206) : !cute.int_tuple<"?">
      %775 = cute.get_scalars(%e1_1207) : !cute.int_tuple<"?">
      %776 = cute.get_scalars(%e2_1208) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e3_1209) : !cute.int_tuple<"?{div=8}">
      %iter_1210 = cute.get_iter(%view_1199) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1211, %e1_1212, %e2_1213, %e3_1214 = cute.get_leaves(%iter_1210) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %778 = cute.get_scalars(%e0_1211) : !cute.int_tuple<"?">
      %779 = cute.get_scalars(%e1_1212) : !cute.int_tuple<"?">
      %780 = cute.get_scalars(%e2_1213) : !cute.int_tuple<"?">
      %781 = cute.get_scalars(%e3_1214) : !cute.int_tuple<"?{div=8}">
      %lay_1215 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %782 = cute.get_shape(%lay_1215) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1216, %e1_1217, %e2_1218, %e3_1219 = cute.get_leaves(%782) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1220 = cute.to_int_tuple(%e0_1216) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %783 = cute.get_scalars(%itup_1220) : !cute.int_tuple<"?">
      %itup_1221 = cute.to_int_tuple(%e1_1217) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %784 = cute.get_scalars(%itup_1221) : !cute.int_tuple<"?">
      %itup_1222 = cute.to_int_tuple(%e2_1218) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %785 = cute.get_scalars(%itup_1222) : !cute.int_tuple<"?">
      %itup_1223 = cute.to_int_tuple(%e3_1219) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %786 = cute.get_scalars(%itup_1223) : !cute.int_tuple<"?{div=8}">
      %coord_1224 = cute.make_coord(%e1_1212) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1225 = cute.make_coord(%itup_1221) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %787 = cute.get_scalars(%coord_1224) : !cute.coord<"?">
      %788 = cute.get_scalars(%coord_1225) : !cute.coord<"?">
      %true_1226 = arith.constant true
      %789 = arith.cmpi slt, %787, %788 : i32
      %790 = arith.andi %true_1226, %789 : i1
      scf.if %790 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1227 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1228 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1229 = cute.crd2idx(%coord_1227, %lay_1228) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1230 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1231 = cute.add_offset(%iter_1230, %idx_1229) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1232 = cute.make_view(%tup_1231) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1233 = cute.get_iter(%view_1232) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1234, %e1_1235, %e2_1236, %e3_1237 = cute.get_leaves(%iter_1233) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %791 = cute.get_scalars(%e0_1234) : !cute.int_tuple<"?">
      %792 = cute.get_scalars(%e1_1235) : !cute.int_tuple<"?">
      %793 = cute.get_scalars(%e2_1236) : !cute.int_tuple<"?">
      %794 = cute.get_scalars(%e3_1237) : !cute.int_tuple<"?{div=8}">
      %iter_1238 = cute.get_iter(%view_1232) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1239, %e1_1240, %e2_1241, %e3_1242 = cute.get_leaves(%iter_1238) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %795 = cute.get_scalars(%e0_1239) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e1_1240) : !cute.int_tuple<"?">
      %797 = cute.get_scalars(%e2_1241) : !cute.int_tuple<"?">
      %798 = cute.get_scalars(%e3_1242) : !cute.int_tuple<"?{div=8}">
      %iter_1243 = cute.get_iter(%view_1232) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1244, %e1_1245, %e2_1246, %e3_1247 = cute.get_leaves(%iter_1243) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %799 = cute.get_scalars(%e0_1244) : !cute.int_tuple<"?">
      %800 = cute.get_scalars(%e1_1245) : !cute.int_tuple<"?">
      %801 = cute.get_scalars(%e2_1246) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e3_1247) : !cute.int_tuple<"?{div=8}">
      %lay_1248 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %803 = cute.get_shape(%lay_1248) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1249, %e1_1250, %e2_1251, %e3_1252 = cute.get_leaves(%803) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1253 = cute.to_int_tuple(%e0_1249) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %804 = cute.get_scalars(%itup_1253) : !cute.int_tuple<"?">
      %itup_1254 = cute.to_int_tuple(%e1_1250) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %805 = cute.get_scalars(%itup_1254) : !cute.int_tuple<"?">
      %itup_1255 = cute.to_int_tuple(%e2_1251) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %806 = cute.get_scalars(%itup_1255) : !cute.int_tuple<"?">
      %itup_1256 = cute.to_int_tuple(%e3_1252) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %807 = cute.get_scalars(%itup_1256) : !cute.int_tuple<"?{div=8}">
      %coord_1257 = cute.make_coord(%e1_1245) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1258 = cute.make_coord(%itup_1254) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %808 = cute.get_scalars(%coord_1257) : !cute.coord<"?">
      %809 = cute.get_scalars(%coord_1258) : !cute.coord<"?">
      %true_1259 = arith.constant true
      %810 = arith.cmpi slt, %808, %809 : i32
      %811 = arith.andi %true_1259, %810 : i1
      scf.if %811 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1260 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1261 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1262 = cute.crd2idx(%coord_1260, %lay_1261) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1263 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1264 = cute.add_offset(%iter_1263, %idx_1262) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1265 = cute.make_view(%tup_1264) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1266 = cute.get_iter(%view_1265) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1267, %e1_1268, %e2_1269, %e3_1270 = cute.get_leaves(%iter_1266) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %812 = cute.get_scalars(%e0_1267) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e1_1268) : !cute.int_tuple<"?">
      %814 = cute.get_scalars(%e2_1269) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e3_1270) : !cute.int_tuple<"?{div=8}">
      %iter_1271 = cute.get_iter(%view_1265) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1272, %e1_1273, %e2_1274, %e3_1275 = cute.get_leaves(%iter_1271) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %816 = cute.get_scalars(%e0_1272) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e1_1273) : !cute.int_tuple<"?">
      %818 = cute.get_scalars(%e2_1274) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e3_1275) : !cute.int_tuple<"?{div=8}">
      %iter_1276 = cute.get_iter(%view_1265) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1277, %e1_1278, %e2_1279, %e3_1280 = cute.get_leaves(%iter_1276) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %820 = cute.get_scalars(%e0_1277) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e1_1278) : !cute.int_tuple<"?">
      %822 = cute.get_scalars(%e2_1279) : !cute.int_tuple<"?">
      %823 = cute.get_scalars(%e3_1280) : !cute.int_tuple<"?{div=8}">
      %lay_1281 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %824 = cute.get_shape(%lay_1281) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1282, %e1_1283, %e2_1284, %e3_1285 = cute.get_leaves(%824) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1286 = cute.to_int_tuple(%e0_1282) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %825 = cute.get_scalars(%itup_1286) : !cute.int_tuple<"?">
      %itup_1287 = cute.to_int_tuple(%e1_1283) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %826 = cute.get_scalars(%itup_1287) : !cute.int_tuple<"?">
      %itup_1288 = cute.to_int_tuple(%e2_1284) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %827 = cute.get_scalars(%itup_1288) : !cute.int_tuple<"?">
      %itup_1289 = cute.to_int_tuple(%e3_1285) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %828 = cute.get_scalars(%itup_1289) : !cute.int_tuple<"?{div=8}">
      %coord_1290 = cute.make_coord(%e1_1278) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1291 = cute.make_coord(%itup_1287) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %829 = cute.get_scalars(%coord_1290) : !cute.coord<"?">
      %830 = cute.get_scalars(%coord_1291) : !cute.coord<"?">
      %true_1292 = arith.constant true
      %831 = arith.cmpi slt, %829, %830 : i32
      %832 = arith.andi %true_1292, %831 : i1
      scf.if %832 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1293 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1294 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1295 = cute.crd2idx(%coord_1293, %lay_1294) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1296 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1297 = cute.add_offset(%iter_1296, %idx_1295) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1298 = cute.make_view(%tup_1297) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1299 = cute.get_iter(%view_1298) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1300, %e1_1301, %e2_1302, %e3_1303 = cute.get_leaves(%iter_1299) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %833 = cute.get_scalars(%e0_1300) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e1_1301) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e2_1302) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e3_1303) : !cute.int_tuple<"?{div=8}">
      %iter_1304 = cute.get_iter(%view_1298) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1305, %e1_1306, %e2_1307, %e3_1308 = cute.get_leaves(%iter_1304) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %837 = cute.get_scalars(%e0_1305) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_1306) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_1307) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_1308) : !cute.int_tuple<"?{div=8}">
      %iter_1309 = cute.get_iter(%view_1298) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1310, %e1_1311, %e2_1312, %e3_1313 = cute.get_leaves(%iter_1309) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %841 = cute.get_scalars(%e0_1310) : !cute.int_tuple<"?">
      %842 = cute.get_scalars(%e1_1311) : !cute.int_tuple<"?">
      %843 = cute.get_scalars(%e2_1312) : !cute.int_tuple<"?">
      %844 = cute.get_scalars(%e3_1313) : !cute.int_tuple<"?{div=8}">
      %lay_1314 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %845 = cute.get_shape(%lay_1314) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1315, %e1_1316, %e2_1317, %e3_1318 = cute.get_leaves(%845) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1319 = cute.to_int_tuple(%e0_1315) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %846 = cute.get_scalars(%itup_1319) : !cute.int_tuple<"?">
      %itup_1320 = cute.to_int_tuple(%e1_1316) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %847 = cute.get_scalars(%itup_1320) : !cute.int_tuple<"?">
      %itup_1321 = cute.to_int_tuple(%e2_1317) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %848 = cute.get_scalars(%itup_1321) : !cute.int_tuple<"?">
      %itup_1322 = cute.to_int_tuple(%e3_1318) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %849 = cute.get_scalars(%itup_1322) : !cute.int_tuple<"?{div=8}">
      %coord_1323 = cute.make_coord(%e1_1311) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1324 = cute.make_coord(%itup_1320) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %850 = cute.get_scalars(%coord_1323) : !cute.coord<"?">
      %851 = cute.get_scalars(%coord_1324) : !cute.coord<"?">
      %true_1325 = arith.constant true
      %852 = arith.cmpi slt, %850, %851 : i32
      %853 = arith.andi %true_1325, %852 : i1
      scf.if %853 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1326 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_1327 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1328 = cute.crd2idx(%coord_1326, %lay_1327) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_1329 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1330 = cute.add_offset(%iter_1329, %idx_1328) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1331 = cute.make_view(%tup_1330) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1332 = cute.get_iter(%view_1331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1333, %e1_1334, %e2_1335, %e3_1336 = cute.get_leaves(%iter_1332) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %854 = cute.get_scalars(%e0_1333) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e1_1334) : !cute.int_tuple<"?">
      %856 = cute.get_scalars(%e2_1335) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e3_1336) : !cute.int_tuple<"?{div=8}">
      %iter_1337 = cute.get_iter(%view_1331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1338, %e1_1339, %e2_1340, %e3_1341 = cute.get_leaves(%iter_1337) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %858 = cute.get_scalars(%e0_1338) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e1_1339) : !cute.int_tuple<"?">
      %860 = cute.get_scalars(%e2_1340) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e3_1341) : !cute.int_tuple<"?{div=8}">
      %iter_1342 = cute.get_iter(%view_1331) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1343, %e1_1344, %e2_1345, %e3_1346 = cute.get_leaves(%iter_1342) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %862 = cute.get_scalars(%e0_1343) : !cute.int_tuple<"?">
      %863 = cute.get_scalars(%e1_1344) : !cute.int_tuple<"?">
      %864 = cute.get_scalars(%e2_1345) : !cute.int_tuple<"?">
      %865 = cute.get_scalars(%e3_1346) : !cute.int_tuple<"?{div=8}">
      %lay_1347 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %866 = cute.get_shape(%lay_1347) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1348, %e1_1349, %e2_1350, %e3_1351 = cute.get_leaves(%866) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1352 = cute.to_int_tuple(%e0_1348) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %867 = cute.get_scalars(%itup_1352) : !cute.int_tuple<"?">
      %itup_1353 = cute.to_int_tuple(%e1_1349) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %868 = cute.get_scalars(%itup_1353) : !cute.int_tuple<"?">
      %itup_1354 = cute.to_int_tuple(%e2_1350) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %869 = cute.get_scalars(%itup_1354) : !cute.int_tuple<"?">
      %itup_1355 = cute.to_int_tuple(%e3_1351) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %870 = cute.get_scalars(%itup_1355) : !cute.int_tuple<"?{div=8}">
      %coord_1356 = cute.make_coord(%e1_1344) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1357 = cute.make_coord(%itup_1353) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %871 = cute.get_scalars(%coord_1356) : !cute.coord<"?">
      %872 = cute.get_scalars(%coord_1357) : !cute.coord<"?">
      %true_1358 = arith.constant true
      %873 = arith.cmpi slt, %871, %872 : i32
      %874 = arith.andi %true_1358, %873 : i1
      scf.if %874 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1359 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_1360 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1361 = cute.crd2idx(%coord_1359, %lay_1360) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_1362 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1363 = cute.add_offset(%iter_1362, %idx_1361) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1364 = cute.make_view(%tup_1363) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1365 = cute.get_iter(%view_1364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1366, %e1_1367, %e2_1368, %e3_1369 = cute.get_leaves(%iter_1365) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %875 = cute.get_scalars(%e0_1366) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e1_1367) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e2_1368) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e3_1369) : !cute.int_tuple<"?{div=8}">
      %iter_1370 = cute.get_iter(%view_1364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1371, %e1_1372, %e2_1373, %e3_1374 = cute.get_leaves(%iter_1370) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %879 = cute.get_scalars(%e0_1371) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e1_1372) : !cute.int_tuple<"?">
      %881 = cute.get_scalars(%e2_1373) : !cute.int_tuple<"?">
      %882 = cute.get_scalars(%e3_1374) : !cute.int_tuple<"?{div=8}">
      %iter_1375 = cute.get_iter(%view_1364) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1376, %e1_1377, %e2_1378, %e3_1379 = cute.get_leaves(%iter_1375) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %883 = cute.get_scalars(%e0_1376) : !cute.int_tuple<"?">
      %884 = cute.get_scalars(%e1_1377) : !cute.int_tuple<"?">
      %885 = cute.get_scalars(%e2_1378) : !cute.int_tuple<"?">
      %886 = cute.get_scalars(%e3_1379) : !cute.int_tuple<"?{div=8}">
      %lay_1380 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %887 = cute.get_shape(%lay_1380) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1381, %e1_1382, %e2_1383, %e3_1384 = cute.get_leaves(%887) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1385 = cute.to_int_tuple(%e0_1381) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %888 = cute.get_scalars(%itup_1385) : !cute.int_tuple<"?">
      %itup_1386 = cute.to_int_tuple(%e1_1382) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %889 = cute.get_scalars(%itup_1386) : !cute.int_tuple<"?">
      %itup_1387 = cute.to_int_tuple(%e2_1383) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %890 = cute.get_scalars(%itup_1387) : !cute.int_tuple<"?">
      %itup_1388 = cute.to_int_tuple(%e3_1384) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %891 = cute.get_scalars(%itup_1388) : !cute.int_tuple<"?{div=8}">
      %coord_1389 = cute.make_coord(%e1_1377) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1390 = cute.make_coord(%itup_1386) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %892 = cute.get_scalars(%coord_1389) : !cute.coord<"?">
      %893 = cute.get_scalars(%coord_1390) : !cute.coord<"?">
      %true_1391 = arith.constant true
      %894 = arith.cmpi slt, %892, %893 : i32
      %895 = arith.andi %true_1391, %894 : i1
      scf.if %895 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1392 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_1393 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1394 = cute.crd2idx(%coord_1392, %lay_1393) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_1395 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1396 = cute.add_offset(%iter_1395, %idx_1394) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1397 = cute.make_view(%tup_1396) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1398 = cute.get_iter(%view_1397) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1399, %e1_1400, %e2_1401, %e3_1402 = cute.get_leaves(%iter_1398) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %896 = cute.get_scalars(%e0_1399) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e1_1400) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e2_1401) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e3_1402) : !cute.int_tuple<"?{div=8}">
      %iter_1403 = cute.get_iter(%view_1397) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1404, %e1_1405, %e2_1406, %e3_1407 = cute.get_leaves(%iter_1403) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %900 = cute.get_scalars(%e0_1404) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e1_1405) : !cute.int_tuple<"?">
      %902 = cute.get_scalars(%e2_1406) : !cute.int_tuple<"?">
      %903 = cute.get_scalars(%e3_1407) : !cute.int_tuple<"?{div=8}">
      %iter_1408 = cute.get_iter(%view_1397) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1409, %e1_1410, %e2_1411, %e3_1412 = cute.get_leaves(%iter_1408) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %904 = cute.get_scalars(%e0_1409) : !cute.int_tuple<"?">
      %905 = cute.get_scalars(%e1_1410) : !cute.int_tuple<"?">
      %906 = cute.get_scalars(%e2_1411) : !cute.int_tuple<"?">
      %907 = cute.get_scalars(%e3_1412) : !cute.int_tuple<"?{div=8}">
      %lay_1413 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %908 = cute.get_shape(%lay_1413) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1414, %e1_1415, %e2_1416, %e3_1417 = cute.get_leaves(%908) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1418 = cute.to_int_tuple(%e0_1414) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %909 = cute.get_scalars(%itup_1418) : !cute.int_tuple<"?">
      %itup_1419 = cute.to_int_tuple(%e1_1415) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %910 = cute.get_scalars(%itup_1419) : !cute.int_tuple<"?">
      %itup_1420 = cute.to_int_tuple(%e2_1416) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %911 = cute.get_scalars(%itup_1420) : !cute.int_tuple<"?">
      %itup_1421 = cute.to_int_tuple(%e3_1417) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %912 = cute.get_scalars(%itup_1421) : !cute.int_tuple<"?{div=8}">
      %coord_1422 = cute.make_coord(%e1_1410) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1423 = cute.make_coord(%itup_1419) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %913 = cute.get_scalars(%coord_1422) : !cute.coord<"?">
      %914 = cute.get_scalars(%coord_1423) : !cute.coord<"?">
      %true_1424 = arith.constant true
      %915 = arith.cmpi slt, %913, %914 : i32
      %916 = arith.andi %true_1424, %915 : i1
      scf.if %916 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %coord_1425 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_1426 = cute.get_layout(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_1427 = cute.crd2idx(%coord_1425, %lay_1426) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_1428 = cute.get_iter(%view_988) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_1429 = cute.add_offset(%iter_1428, %idx_1427) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1430 = cute.make_view(%tup_1429) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1431 = cute.get_iter(%view_1430) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1432, %e1_1433, %e2_1434, %e3_1435 = cute.get_leaves(%iter_1431) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %917 = cute.get_scalars(%e0_1432) : !cute.int_tuple<"?">
      %918 = cute.get_scalars(%e1_1433) : !cute.int_tuple<"?">
      %919 = cute.get_scalars(%e2_1434) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e3_1435) : !cute.int_tuple<"?{div=8}">
      %iter_1436 = cute.get_iter(%view_1430) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1437, %e1_1438, %e2_1439, %e3_1440 = cute.get_leaves(%iter_1436) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %921 = cute.get_scalars(%e0_1437) : !cute.int_tuple<"?">
      %922 = cute.get_scalars(%e1_1438) : !cute.int_tuple<"?">
      %923 = cute.get_scalars(%e2_1439) : !cute.int_tuple<"?">
      %924 = cute.get_scalars(%e3_1440) : !cute.int_tuple<"?{div=8}">
      %iter_1441 = cute.get_iter(%view_1430) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1442, %e1_1443, %e2_1444, %e3_1445 = cute.get_leaves(%iter_1441) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %925 = cute.get_scalars(%e0_1442) : !cute.int_tuple<"?">
      %926 = cute.get_scalars(%e1_1443) : !cute.int_tuple<"?">
      %927 = cute.get_scalars(%e2_1444) : !cute.int_tuple<"?">
      %928 = cute.get_scalars(%e3_1445) : !cute.int_tuple<"?{div=8}">
      %lay_1446 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %929 = cute.get_shape(%lay_1446) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1447, %e1_1448, %e2_1449, %e3_1450 = cute.get_leaves(%929) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1451 = cute.to_int_tuple(%e0_1447) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %930 = cute.get_scalars(%itup_1451) : !cute.int_tuple<"?">
      %itup_1452 = cute.to_int_tuple(%e1_1448) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %931 = cute.get_scalars(%itup_1452) : !cute.int_tuple<"?">
      %itup_1453 = cute.to_int_tuple(%e2_1449) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %932 = cute.get_scalars(%itup_1453) : !cute.int_tuple<"?">
      %itup_1454 = cute.to_int_tuple(%e3_1450) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %933 = cute.get_scalars(%itup_1454) : !cute.int_tuple<"?{div=8}">
      %coord_1455 = cute.make_coord(%e1_1443) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1456 = cute.make_coord(%itup_1452) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %934 = cute.get_scalars(%coord_1455) : !cute.coord<"?">
      %935 = cute.get_scalars(%coord_1456) : !cute.coord<"?">
      %true_1457 = arith.constant true
      %936 = arith.cmpi slt, %934, %935 : i32
      %937 = arith.andi %true_1457, %936 : i1
      scf.if %937 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8605 = cute.get_layout(%view_325) : !memref_gmem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_8607 = cute.get_iter(%view_325) : !memref_gmem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8613 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_8615 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_11
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_11
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8621 = cute.get_layout(%rmem_1025) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1025) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_11
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_11
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_11
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_11
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_12
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_12
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_12
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8605 = cute.get_layout(%view_361) : !memref_smem_bf16_3
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_8607 = cute.get_iter(%view_361) : !memref_smem_bf16_3
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_11
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_11
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_11
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_11
      }
      %int_tuple_1458 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1459 = cute.size(%int_tuple_1458) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1460 = cute.get_leaves(%sz_1459) : !cute.int_tuple<"4">
      %coord_1461 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_1462 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1463 = cute.crd2idx(%coord_1461, %lay_1462) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_1464 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1465 = cute.add_offset(%iter_1464, %idx_1463) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1466 = cute.make_view(%tup_1465) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1467 = cute.get_iter(%view_1466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1468, %e1_1469, %e2_1470, %e3_1471 = cute.get_leaves(%iter_1467) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %938 = cute.get_scalars(%e0_1468) : !cute.int_tuple<"?">
      %939 = cute.get_scalars(%e1_1469) : !cute.int_tuple<"?">
      %940 = cute.get_scalars(%e2_1470) : !cute.int_tuple<"?">
      %941 = cute.get_scalars(%e3_1471) : !cute.int_tuple<"?{div=8}">
      %iter_1472 = cute.get_iter(%view_1466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1473, %e1_1474, %e2_1475, %e3_1476 = cute.get_leaves(%iter_1472) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %942 = cute.get_scalars(%e0_1473) : !cute.int_tuple<"?">
      %943 = cute.get_scalars(%e1_1474) : !cute.int_tuple<"?">
      %944 = cute.get_scalars(%e2_1475) : !cute.int_tuple<"?">
      %945 = cute.get_scalars(%e3_1476) : !cute.int_tuple<"?{div=8}">
      %iter_1477 = cute.get_iter(%view_1466) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1478, %e1_1479, %e2_1480, %e3_1481 = cute.get_leaves(%iter_1477) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %946 = cute.get_scalars(%e0_1478) : !cute.int_tuple<"?">
      %947 = cute.get_scalars(%e1_1479) : !cute.int_tuple<"?">
      %948 = cute.get_scalars(%e2_1480) : !cute.int_tuple<"?">
      %949 = cute.get_scalars(%e3_1481) : !cute.int_tuple<"?{div=8}">
      %lay_1482 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %950 = cute.get_shape(%lay_1482) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1483, %e1_1484, %e2_1485, %e3_1486 = cute.get_leaves(%950) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1487 = cute.to_int_tuple(%e0_1483) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %951 = cute.get_scalars(%itup_1487) : !cute.int_tuple<"?">
      %itup_1488 = cute.to_int_tuple(%e1_1484) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %952 = cute.get_scalars(%itup_1488) : !cute.int_tuple<"?">
      %itup_1489 = cute.to_int_tuple(%e2_1485) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %953 = cute.get_scalars(%itup_1489) : !cute.int_tuple<"?">
      %itup_1490 = cute.to_int_tuple(%e3_1486) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %954 = cute.get_scalars(%itup_1490) : !cute.int_tuple<"?{div=8}">
      %coord_1491 = cute.make_coord(%e1_1479) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1492 = cute.make_coord(%itup_1488) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %955 = cute.get_scalars(%coord_1491) : !cute.coord<"?">
      %956 = cute.get_scalars(%coord_1492) : !cute.coord<"?">
      %true_1493 = arith.constant true
      %957 = arith.cmpi slt, %955, %956 : i32
      %958 = arith.andi %true_1493, %957 : i1
      scf.if %958 {
        %coord_8604 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,0,_,?)">
        %lay_8605 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8607 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8613 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_8615 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_14
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8621 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_14
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_14
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_15
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8605 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_8607 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_14
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_14
      }
      %coord_1494 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_1495 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1496 = cute.crd2idx(%coord_1494, %lay_1495) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_1497 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1498 = cute.add_offset(%iter_1497, %idx_1496) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1499 = cute.make_view(%tup_1498) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1500 = cute.get_iter(%view_1499) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1501, %e1_1502, %e2_1503, %e3_1504 = cute.get_leaves(%iter_1500) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %959 = cute.get_scalars(%e0_1501) : !cute.int_tuple<"?">
      %960 = cute.get_scalars(%e1_1502) : !cute.int_tuple<"?">
      %961 = cute.get_scalars(%e2_1503) : !cute.int_tuple<"?">
      %962 = cute.get_scalars(%e3_1504) : !cute.int_tuple<"?{div=8}">
      %iter_1505 = cute.get_iter(%view_1499) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1506, %e1_1507, %e2_1508, %e3_1509 = cute.get_leaves(%iter_1505) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %963 = cute.get_scalars(%e0_1506) : !cute.int_tuple<"?">
      %964 = cute.get_scalars(%e1_1507) : !cute.int_tuple<"?">
      %965 = cute.get_scalars(%e2_1508) : !cute.int_tuple<"?">
      %966 = cute.get_scalars(%e3_1509) : !cute.int_tuple<"?{div=8}">
      %iter_1510 = cute.get_iter(%view_1499) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1511, %e1_1512, %e2_1513, %e3_1514 = cute.get_leaves(%iter_1510) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %967 = cute.get_scalars(%e0_1511) : !cute.int_tuple<"?">
      %968 = cute.get_scalars(%e1_1512) : !cute.int_tuple<"?">
      %969 = cute.get_scalars(%e2_1513) : !cute.int_tuple<"?">
      %970 = cute.get_scalars(%e3_1514) : !cute.int_tuple<"?{div=8}">
      %lay_1515 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %971 = cute.get_shape(%lay_1515) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1516, %e1_1517, %e2_1518, %e3_1519 = cute.get_leaves(%971) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1520 = cute.to_int_tuple(%e0_1516) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %972 = cute.get_scalars(%itup_1520) : !cute.int_tuple<"?">
      %itup_1521 = cute.to_int_tuple(%e1_1517) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %973 = cute.get_scalars(%itup_1521) : !cute.int_tuple<"?">
      %itup_1522 = cute.to_int_tuple(%e2_1518) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %974 = cute.get_scalars(%itup_1522) : !cute.int_tuple<"?">
      %itup_1523 = cute.to_int_tuple(%e3_1519) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %975 = cute.get_scalars(%itup_1523) : !cute.int_tuple<"?{div=8}">
      %coord_1524 = cute.make_coord(%e1_1512) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1525 = cute.make_coord(%itup_1521) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %976 = cute.get_scalars(%coord_1524) : !cute.coord<"?">
      %977 = cute.get_scalars(%coord_1525) : !cute.coord<"?">
      %true_1526 = arith.constant true
      %978 = arith.cmpi slt, %976, %977 : i32
      %979 = arith.andi %true_1526, %978 : i1
      scf.if %979 {
        %coord_8604 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,1,_,?)">
        %lay_8605 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8607 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8613 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_8615 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_14
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8621 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_14
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_14
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_15
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8605 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_8607 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_14
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_14
      }
      %coord_1527 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1528 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1529 = cute.crd2idx(%coord_1527, %lay_1528) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1530 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1531 = cute.add_offset(%iter_1530, %idx_1529) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1532 = cute.make_view(%tup_1531) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1533 = cute.get_iter(%view_1532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1534, %e1_1535, %e2_1536, %e3_1537 = cute.get_leaves(%iter_1533) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %980 = cute.get_scalars(%e0_1534) : !cute.int_tuple<"?">
      %981 = cute.get_scalars(%e1_1535) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e2_1536) : !cute.int_tuple<"?">
      %983 = cute.get_scalars(%e3_1537) : !cute.int_tuple<"?{div=8}">
      %iter_1538 = cute.get_iter(%view_1532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1539, %e1_1540, %e2_1541, %e3_1542 = cute.get_leaves(%iter_1538) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %984 = cute.get_scalars(%e0_1539) : !cute.int_tuple<"?">
      %985 = cute.get_scalars(%e1_1540) : !cute.int_tuple<"?">
      %986 = cute.get_scalars(%e2_1541) : !cute.int_tuple<"?">
      %987 = cute.get_scalars(%e3_1542) : !cute.int_tuple<"?{div=8}">
      %iter_1543 = cute.get_iter(%view_1532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1544, %e1_1545, %e2_1546, %e3_1547 = cute.get_leaves(%iter_1543) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %988 = cute.get_scalars(%e0_1544) : !cute.int_tuple<"?">
      %989 = cute.get_scalars(%e1_1545) : !cute.int_tuple<"?">
      %990 = cute.get_scalars(%e2_1546) : !cute.int_tuple<"?">
      %991 = cute.get_scalars(%e3_1547) : !cute.int_tuple<"?{div=8}">
      %lay_1548 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %992 = cute.get_shape(%lay_1548) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1549, %e1_1550, %e2_1551, %e3_1552 = cute.get_leaves(%992) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1553 = cute.to_int_tuple(%e0_1549) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %993 = cute.get_scalars(%itup_1553) : !cute.int_tuple<"?">
      %itup_1554 = cute.to_int_tuple(%e1_1550) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %994 = cute.get_scalars(%itup_1554) : !cute.int_tuple<"?">
      %itup_1555 = cute.to_int_tuple(%e2_1551) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %995 = cute.get_scalars(%itup_1555) : !cute.int_tuple<"?">
      %itup_1556 = cute.to_int_tuple(%e3_1552) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %996 = cute.get_scalars(%itup_1556) : !cute.int_tuple<"?{div=8}">
      %coord_1557 = cute.make_coord(%e1_1545) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1558 = cute.make_coord(%itup_1554) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %997 = cute.get_scalars(%coord_1557) : !cute.coord<"?">
      %998 = cute.get_scalars(%coord_1558) : !cute.coord<"?">
      %true_1559 = arith.constant true
      %999 = arith.cmpi slt, %997, %998 : i32
      %1000 = arith.andi %true_1559, %999 : i1
      scf.if %1000 {
        %coord_8604 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,2,_,?)">
        %lay_8605 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8607 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8613 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_8615 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_14
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8621 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_14
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_14
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_15
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8605 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_8607 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_14
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_14
      }
      %coord_1560 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1561 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1562 = cute.crd2idx(%coord_1560, %lay_1561) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1563 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1564 = cute.add_offset(%iter_1563, %idx_1562) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1565 = cute.make_view(%tup_1564) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1566 = cute.get_iter(%view_1565) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1567, %e1_1568, %e2_1569, %e3_1570 = cute.get_leaves(%iter_1566) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1001 = cute.get_scalars(%e0_1567) : !cute.int_tuple<"?">
      %1002 = cute.get_scalars(%e1_1568) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e2_1569) : !cute.int_tuple<"?">
      %1004 = cute.get_scalars(%e3_1570) : !cute.int_tuple<"?{div=8}">
      %iter_1571 = cute.get_iter(%view_1565) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1572, %e1_1573, %e2_1574, %e3_1575 = cute.get_leaves(%iter_1571) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1005 = cute.get_scalars(%e0_1572) : !cute.int_tuple<"?">
      %1006 = cute.get_scalars(%e1_1573) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e2_1574) : !cute.int_tuple<"?">
      %1008 = cute.get_scalars(%e3_1575) : !cute.int_tuple<"?{div=8}">
      %iter_1576 = cute.get_iter(%view_1565) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1577, %e1_1578, %e2_1579, %e3_1580 = cute.get_leaves(%iter_1576) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %1009 = cute.get_scalars(%e0_1577) : !cute.int_tuple<"?">
      %1010 = cute.get_scalars(%e1_1578) : !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%e2_1579) : !cute.int_tuple<"?">
      %1012 = cute.get_scalars(%e3_1580) : !cute.int_tuple<"?{div=8}">
      %lay_1581 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1013 = cute.get_shape(%lay_1581) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1582, %e1_1583, %e2_1584, %e3_1585 = cute.get_leaves(%1013) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1586 = cute.to_int_tuple(%e0_1582) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1014 = cute.get_scalars(%itup_1586) : !cute.int_tuple<"?">
      %itup_1587 = cute.to_int_tuple(%e1_1583) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1015 = cute.get_scalars(%itup_1587) : !cute.int_tuple<"?">
      %itup_1588 = cute.to_int_tuple(%e2_1584) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1016 = cute.get_scalars(%itup_1588) : !cute.int_tuple<"?">
      %itup_1589 = cute.to_int_tuple(%e3_1585) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1017 = cute.get_scalars(%itup_1589) : !cute.int_tuple<"?{div=8}">
      %coord_1590 = cute.make_coord(%e1_1578) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1591 = cute.make_coord(%itup_1587) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1018 = cute.get_scalars(%coord_1590) : !cute.coord<"?">
      %1019 = cute.get_scalars(%coord_1591) : !cute.coord<"?">
      %true_1592 = arith.constant true
      %1020 = arith.cmpi slt, %1018, %1019 : i32
      %1021 = arith.andi %true_1592, %1020 : i1
      scf.if %1021 {
        %coord_8604 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,3,_,?)">
        %lay_8605 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8607 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_gmem_bf16_6
        %iter_8610 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %iter_8611 = cute.get_iter(%view_8609) : !memref_gmem_bf16_6
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8613 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_8615 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_smem_bf16_14
        %iter_8618 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %iter_8619 = cute.get_iter(%view_8617) : !memref_smem_bf16_14
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8621 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_gmem_bf16_6
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_gmem_bf16_6
        %iter_8641 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %lay_8642 = cute.get_layout(%view_8640) : !memref_gmem_bf16_6
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_gmem_bf16_6
        %view_8647 = cute.make_view(%iter_8646) : !memref_gmem_bf16_7
        %iter_8648 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8649 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %lay_8650 = cute.get_layout(%view_8617) : !memref_smem_bf16_14
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_smem_bf16_14
        %iter_8655 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %lay_8656 = cute.get_layout(%view_8654) : !memref_smem_bf16_14
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_smem_bf16_14
        %view_8661 = cute.make_view(%iter_8660) : !memref_smem_bf16_15
        %iter_8662 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %iter_8663 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_gmem_bf16_7
        %iter_8692 = cute.get_iter(%view_8661) : !memref_smem_bf16_15
        %lay_8693 = cute.get_layout(%view_8647) : !memref_gmem_bf16_7
        %lay_8694 = cute.get_layout(%view_8661) : !memref_smem_bf16_15
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_gmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_smem_bf16_13
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_gmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_smem_bf16_13
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.trunc %3391 : i8 to i1
          %iter_8722 = cute.recast_iter(%iter_8719) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8723 = cute.recast_iter(%iter_8720) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8723 : !cute.ptr<i128, smem>, %iter_8722 : !cute.ptr<i128, gmem>, %3392 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8605 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_8607 = cute.get_iter(%view_425) : !memref_smem_bf16_4
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_smem_bf16_14
        %iter_8610 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %iter_8611 = cute.get_iter(%view_8609) : !memref_smem_bf16_14
        %lay_8612 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %sz_8613 = cute.size(%lay_8612) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_8614 = cute.get_leaves(%sz_8613) : !cute.int_tuple<"16">
        %lay_8615 = cute.get_layout(%view_8609) : !memref_smem_bf16_14
        %3378 = cute.get_shape(%lay_8615) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8616, %e1_8617, %e2_8618 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %int_tuple_8620 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
        %e0_8621 = cute.get_leaves(%int_tuple_8620) : !cute.int_tuple<"16">
        %cst_8622 = arith.constant 0.000000e+00 : bf16
        %3379 = vector.splat %cst_8622 : vector<16xbf16>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8624 = cute.size(%int_tuple_8623) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8625 = cute.get_leaves(%sz_8624) : !cute.int_tuple<"16">
        %int_tuple_8626 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_8627 = cute.size(%int_tuple_8626) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_8628 = cute.get_leaves(%sz_8627) : !cute.int_tuple<"16">
        cute.memref.store_vec %3379, %view_8609 : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %shape_1593 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1594 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1595 = cute.memref.alloca(%lay_1594) : !memref_rmem_f32_1
      %iter_1596 = cute.get_iter(%rmem_1595) : !memref_rmem_f32_1
      %iter_1597 = cute.get_iter(%rmem_1595) : !memref_rmem_f32_1
      %shape_1598 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1599 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1600 = cute.memref.alloca(%lay_1599) : !memref_rmem_f32_1
      %iter_1601 = cute.get_iter(%rmem_1600) : !memref_rmem_f32_1
      %iter_1602 = cute.get_iter(%rmem_1600) : !memref_rmem_f32_1
      %lay_1603 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
      %sz_1604 = cute.size(%lay_1603) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1605 = cute.get_leaves(%sz_1604) : !cute.int_tuple<"4">
      %lay_1606 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
      %1022 = cute.get_shape(%lay_1606) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1607 = cute.get_leaves(%1022) : !cute.shape<"4">
      %cst_1608 = arith.constant 0xFF800000 : f32
      %1023 = vector.splat %cst_1608 : vector<4xf32>
      %int_tuple_1609 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1610 = cute.size(%int_tuple_1609) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1611 = cute.get_leaves(%sz_1610) : !cute.int_tuple<"4">
      %int_tuple_1612 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1613 = cute.size(%int_tuple_1612) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1614 = cute.get_leaves(%sz_1613) : !cute.int_tuple<"4">
      cute.memref.store_vec %1023, %rmem_1595 : !memref_rmem_f32_1
      %lay_1615 = cute.get_layout(%rmem_1600) : !memref_rmem_f32_1
      %sz_1616 = cute.size(%lay_1615) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1617 = cute.get_leaves(%sz_1616) : !cute.int_tuple<"4">
      %lay_1618 = cute.get_layout(%rmem_1600) : !memref_rmem_f32_1
      %1024 = cute.get_shape(%lay_1618) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1619 = cute.get_leaves(%1024) : !cute.shape<"4">
      %cst_1620 = arith.constant 0.000000e+00 : f32
      %1025 = vector.splat %cst_1620 : vector<4xf32>
      %int_tuple_1621 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1622 = cute.size(%int_tuple_1621) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1623 = cute.get_leaves(%sz_1622) : !cute.int_tuple<"4">
      %int_tuple_1624 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1625 = cute.size(%int_tuple_1624) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1626 = cute.get_leaves(%sz_1625) : !cute.int_tuple<"4">
      cute.memref.store_vec %1025, %rmem_1600 : !memref_rmem_f32_1
      %c0_i32_1627 = arith.constant 0 : i32
      %1026 = arith.subi %128, %c0_i32_1627 : i32
      %1027 = arith.subi %1026, %c1_i32 : i32
      %shape_1628 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %shape_1629 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %e0_1630, %e1_1631, %e2_1632, %e3_1633 = cute.get_leaves(%shape_1629) : !cute.shape<"((2,2),2,8)">
      %shape_1634 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_1635 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_1636 = cute.memref.alloca(%lay_1635) : !memref_rmem_f32_2
      %iter_1637 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_1638 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_1639 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %sz_1640 = cute.size(%lay_1639) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
      %e0_1641 = cute.get_leaves(%sz_1640) : !cute.int_tuple<"64">
      %lay_1642 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1028 = cute.get_shape(%lay_1642) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1643, %e1_1644, %e2_1645, %e3_1646 = cute.get_leaves(%1028) : !cute.shape<"((2,2),2,8)">
      %int_tuple_1647 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %int_tuple_1648 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
      %e0_1649 = cute.get_leaves(%int_tuple_1648) : !cute.int_tuple<"64">
      %cst_1650 = arith.constant 0.000000e+00 : f32
      %1029 = vector.splat %cst_1650 : vector<64xf32>
      %int_tuple_1651 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1652 = cute.size(%int_tuple_1651) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1653 = cute.get_leaves(%sz_1652) : !cute.int_tuple<"64">
      %int_tuple_1654 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1655 = cute.size(%int_tuple_1654) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1656 = cute.get_leaves(%sz_1655) : !cute.int_tuple<"64">
      cute.memref.store_vec %1029, %rmem_1636 : !memref_rmem_f32_2
      nvvm.cp.async.wait.group 0
      %c1_i32_1657 = arith.constant 1 : i32
      %c128_i32_1658 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1657 number_of_threads = %c128_i32_1658
      %true_1659 = arith.constant true
      scf.if %true_1659 {
        %lay_8604 = cute.get_layout(%view_489) : !memref_smem_bf16_4
        %3378 = cute.get_shape(%lay_8604) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8605, %e1_8606, %e2_8607, %e3_8608 = cute.get_leaves(%3378) : !cute.shape<"((8,1),4,2)">
        %int_tuple_8609 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_8610 = cute.size(%int_tuple_8609) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_8611 = cute.get_leaves(%sz_8610) : !cute.int_tuple<"4">
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
        %lay_8613 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
        %iter_8615 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8617 = cute.make_view(%tup_8616) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8618 = cute.get_iter(%view_8617) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8619, %e1_8620, %e2_8621, %e3_8622 = cute.get_leaves(%iter_8618) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3379 = cute.get_scalars(%e0_8619) : !cute.int_tuple<"?">
        %3380 = cute.get_scalars(%e1_8620) : !cute.int_tuple<"?">
        %3381 = cute.get_scalars(%e2_8621) : !cute.int_tuple<"?">
        %3382 = cute.get_scalars(%e3_8622) : !cute.int_tuple<"?{div=8}">
        %iter_8623 = cute.get_iter(%view_8617) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8624, %e1_8625, %e2_8626, %e3_8627 = cute.get_leaves(%iter_8623) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3383 = cute.get_scalars(%e0_8624) : !cute.int_tuple<"?">
        %3384 = cute.get_scalars(%e1_8625) : !cute.int_tuple<"?">
        %3385 = cute.get_scalars(%e2_8626) : !cute.int_tuple<"?">
        %3386 = cute.get_scalars(%e3_8627) : !cute.int_tuple<"?{div=8}">
        %iter_8628 = cute.get_iter(%view_8617) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8629, %e1_8630, %e2_8631, %e3_8632 = cute.get_leaves(%iter_8628) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3387 = cute.get_scalars(%e0_8629) : !cute.int_tuple<"?">
        %3388 = cute.get_scalars(%e1_8630) : !cute.int_tuple<"?">
        %3389 = cute.get_scalars(%e2_8631) : !cute.int_tuple<"?">
        %3390 = cute.get_scalars(%e3_8632) : !cute.int_tuple<"?{div=8}">
        %lay_8633 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3391 = cute.get_shape(%lay_8633) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8634, %e1_8635, %e2_8636, %e3_8637 = cute.get_leaves(%3391) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8638 = cute.to_int_tuple(%e0_8634) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3392 = cute.get_scalars(%itup_8638) : !cute.int_tuple<"?">
        %itup_8639 = cute.to_int_tuple(%e1_8635) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3393 = cute.get_scalars(%itup_8639) : !cute.int_tuple<"?">
        %itup_8640 = cute.to_int_tuple(%e2_8636) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3394 = cute.get_scalars(%itup_8640) : !cute.int_tuple<"?">
        %itup_8641 = cute.to_int_tuple(%e3_8637) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3395 = cute.get_scalars(%itup_8641) : !cute.int_tuple<"?{div=8}">
        %coord_8642 = cute.make_coord(%e1_8630) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8643 = cute.make_coord(%itup_8639) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3396 = cute.get_scalars(%coord_8642) : !cute.coord<"?">
        %3397 = cute.get_scalars(%coord_8643) : !cute.coord<"?">
        %true_8644 = arith.constant true
        %3398 = arith.cmpi slt, %3396, %3397 : i32
        %3399 = arith.andi %true_8644, %3398 : i1
        scf.if %3399 {
          %coord_8744 = cute.make_coord(%1027) : (i32) -> !cute.coord<"(_,0,_,?)">
          %lay_8745 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_8747 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_gmem_bf16_6
          %iter_8750 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %iter_8751 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %coord_8752 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8753 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8754 = cute.crd2idx(%coord_8752, %lay_8753) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_8755 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8756 = cute.add_offset(%iter_8755, %idx_8754) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8757 = cute.make_view(%ptr_8756) : !memref_smem_bf16_14
          %iter_8758 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %iter_8759 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %coord_8760 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8761 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %idx_8762 = cute.crd2idx(%coord_8760, %lay_8761) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8763 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
          %ptr_8764 = cute.add_offset(%iter_8763, %idx_8762) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8765 = cute.make_view(%ptr_8764) : !memref_rmem_i8_2
          %iter_8766 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %iter_8767 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %lay_8768 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %3463 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %lay_8772 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %3464 = cute.get_shape(%lay_8772) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8773, %e1_8774, %e2_8775 = cute.get_leaves(%3464) : !cute.shape<"((8,1),2)">
          %lay_8776 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %shape_8777 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8778 = cute.make_layout() : !cute.layout<"1:0">
          %append_8779 = cute.append_to_rank<2> (%lay_8776, %lay_8778) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8780 = cute.make_view(%iter_8751, %append_8779) : !memref_gmem_bf16_6
          %iter_8781 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %lay_8782 = cute.get_layout(%view_8780) : !memref_gmem_bf16_6
          %3465 = cute.get_shape(%lay_8782) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8783, %e1_8784, %e2_8785 = cute.get_leaves(%3465) : !cute.shape<"((8,1),2)">
          %iter_8786 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %view_8787 = cute.make_view(%iter_8786) : !memref_gmem_bf16_7
          %iter_8788 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8789 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %lay_8790 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %shape_8791 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8792 = cute.make_layout() : !cute.layout<"1:0">
          %append_8793 = cute.append_to_rank<2> (%lay_8790, %lay_8792) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8794 = cute.make_view(%iter_8759, %append_8793) : !memref_smem_bf16_14
          %iter_8795 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %lay_8796 = cute.get_layout(%view_8794) : !memref_smem_bf16_14
          %3466 = cute.get_shape(%lay_8796) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8797, %e1_8798, %e2_8799 = cute.get_leaves(%3466) : !cute.shape<"((8,1),2)">
          %iter_8800 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %view_8801 = cute.make_view(%iter_8800) : !memref_smem_bf16_15
          %iter_8802 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %iter_8803 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8804 = cute.get_layout(%view_8765) : !memref_rmem_i8_2
          %shape_8805 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8806 = cute.make_layout() : !cute.layout<"1:0">
          %append_8807 = cute.append_to_rank<2> (%lay_8804, %lay_8806) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8808 = cute.make_view(%iter_8767, %append_8807) : !memref_rmem_i8_2
          %iter_8809 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %lay_8810 = cute.get_layout(%view_8808) : !memref_rmem_i8_2
          %3467 = cute.get_shape(%lay_8810) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8811, %e1_8812 = cute.get_leaves(%3467) : !cute.shape<"(1,2)">
          %iter_8813 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %view_8814 = cute.make_view(%iter_8813) : !memref_rmem_i8_3
          %iter_8815 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %iter_8816 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8817 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %3468 = cute.get_shape(%lay_8817) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8818, %e1_8819, %e2_8820 = cute.get_leaves(%3468) : !cute.shape<"((8,1),(2))">
          %lay_8821 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %3469 = cute.get_shape(%lay_8821) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8822, %e1_8823, %e2_8824 = cute.get_leaves(%3469) : !cute.shape<"((8,1),(2))">
          %lay_8825 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %sz_8826 = cute.size(%lay_8825) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8827 = cute.get_leaves(%sz_8826) : !cute.int_tuple<"2">
          %lay_8828 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %sz_8829 = cute.size(%lay_8828) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8830 = cute.get_leaves(%sz_8829) : !cute.int_tuple<"2">
          %3470 = cute.static : !cute.layout<"1:0">
          %iter_8831 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8832 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8833 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %lay_8834 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %append_8835 = cute.append_to_rank<2> (%lay_8833, %3470) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8836 = cute.append_to_rank<2> (%lay_8834, %3470) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8837 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8838 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8839 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8840 = cute.get_layout(%view_8814) : !memref_rmem_i8_3
          %append_8841 = cute.append_to_rank<2> (%lay_8840, %3470) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8842 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8843 = cute.size(%lay_8837) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3471 = cute.get_scalars(%sz_8843) : !cute.int_tuple<"2">
          %c0_i32_8844 = arith.constant 0 : i32
          %c1_i32_8845 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8844 to %3471 step %c1_i32_8845  : i32 {
            %coord_8846 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3472 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8847 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8848 = cute.crd2idx(%coord_8846, %lay_8837) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8849 = cute.add_offset(%iter_8831, %idx_8848) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8850 = cute.make_view(%ptr_8849, %lay_8847) : !memref_gmem_bf16_8
            %3473 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8851 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8852 = cute.crd2idx(%coord_8846, %lay_8838) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8853 = cute.add_offset(%iter_8832, %idx_8852) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8854 = cute.make_view(%ptr_8853, %lay_8851) : !memref_smem_bf16_13
            %3474 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8855 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8856 = cute.crd2idx(%coord_8846, %lay_8842) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8857 = cute.add_offset(%iter_8839, %idx_8856) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8858 = cute.make_view(%ptr_8857, %lay_8855) : !memref_rmem_i8_4
            %iter_8859 = cute.get_iter(%view_8850) : !memref_gmem_bf16_8
            %iter_8860 = cute.get_iter(%view_8854) : !memref_smem_bf16_13
            %iter_8861 = cute.get_iter(%view_8858) : !memref_rmem_i8_4
            %3475 = builtin.unrealized_conversion_cast %iter_8861 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3476 = llvm.load %3475 : !llvm.ptr -> i8
            %3477 = llvm.trunc %3476 : i8 to i1
            %iter_8862 = cute.recast_iter(%iter_8859) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8863 = cute.recast_iter(%iter_8860) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8863 : !cute.ptr<i128, smem>, %iter_8862 : !cute.ptr<i128, gmem>, %3477 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8744 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_8745 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_8747 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_smem_bf16_14
          %iter_8750 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %iter_8751 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %lay_8752 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %sz_8753 = cute.size(%lay_8752) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8754 = cute.get_leaves(%sz_8753) : !cute.int_tuple<"16">
          %lay_8755 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %3463 = cute.get_shape(%lay_8755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8756, %e1_8757, %e2_8758 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %int_tuple_8759 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8760 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8761 = cute.get_leaves(%int_tuple_8760) : !cute.int_tuple<"16">
          %cst_8762 = arith.constant 0.000000e+00 : bf16
          %3464 = vector.splat %cst_8762 : vector<16xbf16>
          %int_tuple_8763 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8764 = cute.size(%int_tuple_8763) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8765 = cute.get_leaves(%sz_8764) : !cute.int_tuple<"16">
          %int_tuple_8766 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8767 = cute.size(%int_tuple_8766) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8768 = cute.get_leaves(%sz_8767) : !cute.int_tuple<"16">
          cute.memref.store_vec %3464, %view_8749 : !memref_smem_bf16_14
        }
        %coord_8645 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
        %lay_8646 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8647 = cute.crd2idx(%coord_8645, %lay_8646) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
        %iter_8648 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8649 = cute.add_offset(%iter_8648, %idx_8647) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8650 = cute.make_view(%tup_8649) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8651 = cute.get_iter(%view_8650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8652, %e1_8653, %e2_8654, %e3_8655 = cute.get_leaves(%iter_8651) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3400 = cute.get_scalars(%e0_8652) : !cute.int_tuple<"?">
        %3401 = cute.get_scalars(%e1_8653) : !cute.int_tuple<"?">
        %3402 = cute.get_scalars(%e2_8654) : !cute.int_tuple<"?">
        %3403 = cute.get_scalars(%e3_8655) : !cute.int_tuple<"?{div=8}">
        %iter_8656 = cute.get_iter(%view_8650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8657, %e1_8658, %e2_8659, %e3_8660 = cute.get_leaves(%iter_8656) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3404 = cute.get_scalars(%e0_8657) : !cute.int_tuple<"?">
        %3405 = cute.get_scalars(%e1_8658) : !cute.int_tuple<"?">
        %3406 = cute.get_scalars(%e2_8659) : !cute.int_tuple<"?">
        %3407 = cute.get_scalars(%e3_8660) : !cute.int_tuple<"?{div=8}">
        %iter_8661 = cute.get_iter(%view_8650) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8662, %e1_8663, %e2_8664, %e3_8665 = cute.get_leaves(%iter_8661) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3408 = cute.get_scalars(%e0_8662) : !cute.int_tuple<"?">
        %3409 = cute.get_scalars(%e1_8663) : !cute.int_tuple<"?">
        %3410 = cute.get_scalars(%e2_8664) : !cute.int_tuple<"?">
        %3411 = cute.get_scalars(%e3_8665) : !cute.int_tuple<"?{div=8}">
        %lay_8666 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3412 = cute.get_shape(%lay_8666) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8667, %e1_8668, %e2_8669, %e3_8670 = cute.get_leaves(%3412) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8671 = cute.to_int_tuple(%e0_8667) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3413 = cute.get_scalars(%itup_8671) : !cute.int_tuple<"?">
        %itup_8672 = cute.to_int_tuple(%e1_8668) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3414 = cute.get_scalars(%itup_8672) : !cute.int_tuple<"?">
        %itup_8673 = cute.to_int_tuple(%e2_8669) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3415 = cute.get_scalars(%itup_8673) : !cute.int_tuple<"?">
        %itup_8674 = cute.to_int_tuple(%e3_8670) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3416 = cute.get_scalars(%itup_8674) : !cute.int_tuple<"?{div=8}">
        %coord_8675 = cute.make_coord(%e1_8663) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8676 = cute.make_coord(%itup_8672) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3417 = cute.get_scalars(%coord_8675) : !cute.coord<"?">
        %3418 = cute.get_scalars(%coord_8676) : !cute.coord<"?">
        %true_8677 = arith.constant true
        %3419 = arith.cmpi slt, %3417, %3418 : i32
        %3420 = arith.andi %true_8677, %3419 : i1
        scf.if %3420 {
          %coord_8744 = cute.make_coord(%1027) : (i32) -> !cute.coord<"(_,1,_,?)">
          %lay_8745 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_8747 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_gmem_bf16_6
          %iter_8750 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %iter_8751 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %coord_8752 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8753 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8754 = cute.crd2idx(%coord_8752, %lay_8753) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_8755 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8756 = cute.add_offset(%iter_8755, %idx_8754) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8757 = cute.make_view(%ptr_8756) : !memref_smem_bf16_14
          %iter_8758 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %iter_8759 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %coord_8760 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8761 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %idx_8762 = cute.crd2idx(%coord_8760, %lay_8761) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8763 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
          %ptr_8764 = cute.add_offset(%iter_8763, %idx_8762) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8765 = cute.make_view(%ptr_8764) : !memref_rmem_i8_2
          %iter_8766 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %iter_8767 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %lay_8768 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %3463 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %lay_8772 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %3464 = cute.get_shape(%lay_8772) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8773, %e1_8774, %e2_8775 = cute.get_leaves(%3464) : !cute.shape<"((8,1),2)">
          %lay_8776 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %shape_8777 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8778 = cute.make_layout() : !cute.layout<"1:0">
          %append_8779 = cute.append_to_rank<2> (%lay_8776, %lay_8778) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8780 = cute.make_view(%iter_8751, %append_8779) : !memref_gmem_bf16_6
          %iter_8781 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %lay_8782 = cute.get_layout(%view_8780) : !memref_gmem_bf16_6
          %3465 = cute.get_shape(%lay_8782) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8783, %e1_8784, %e2_8785 = cute.get_leaves(%3465) : !cute.shape<"((8,1),2)">
          %iter_8786 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %view_8787 = cute.make_view(%iter_8786) : !memref_gmem_bf16_7
          %iter_8788 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8789 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %lay_8790 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %shape_8791 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8792 = cute.make_layout() : !cute.layout<"1:0">
          %append_8793 = cute.append_to_rank<2> (%lay_8790, %lay_8792) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8794 = cute.make_view(%iter_8759, %append_8793) : !memref_smem_bf16_14
          %iter_8795 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %lay_8796 = cute.get_layout(%view_8794) : !memref_smem_bf16_14
          %3466 = cute.get_shape(%lay_8796) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8797, %e1_8798, %e2_8799 = cute.get_leaves(%3466) : !cute.shape<"((8,1),2)">
          %iter_8800 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %view_8801 = cute.make_view(%iter_8800) : !memref_smem_bf16_15
          %iter_8802 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %iter_8803 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8804 = cute.get_layout(%view_8765) : !memref_rmem_i8_2
          %shape_8805 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8806 = cute.make_layout() : !cute.layout<"1:0">
          %append_8807 = cute.append_to_rank<2> (%lay_8804, %lay_8806) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8808 = cute.make_view(%iter_8767, %append_8807) : !memref_rmem_i8_2
          %iter_8809 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %lay_8810 = cute.get_layout(%view_8808) : !memref_rmem_i8_2
          %3467 = cute.get_shape(%lay_8810) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8811, %e1_8812 = cute.get_leaves(%3467) : !cute.shape<"(1,2)">
          %iter_8813 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %view_8814 = cute.make_view(%iter_8813) : !memref_rmem_i8_3
          %iter_8815 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %iter_8816 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8817 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %3468 = cute.get_shape(%lay_8817) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8818, %e1_8819, %e2_8820 = cute.get_leaves(%3468) : !cute.shape<"((8,1),(2))">
          %lay_8821 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %3469 = cute.get_shape(%lay_8821) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8822, %e1_8823, %e2_8824 = cute.get_leaves(%3469) : !cute.shape<"((8,1),(2))">
          %lay_8825 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %sz_8826 = cute.size(%lay_8825) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8827 = cute.get_leaves(%sz_8826) : !cute.int_tuple<"2">
          %lay_8828 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %sz_8829 = cute.size(%lay_8828) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8830 = cute.get_leaves(%sz_8829) : !cute.int_tuple<"2">
          %3470 = cute.static : !cute.layout<"1:0">
          %iter_8831 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8832 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8833 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %lay_8834 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %append_8835 = cute.append_to_rank<2> (%lay_8833, %3470) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8836 = cute.append_to_rank<2> (%lay_8834, %3470) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8837 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8838 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8839 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8840 = cute.get_layout(%view_8814) : !memref_rmem_i8_3
          %append_8841 = cute.append_to_rank<2> (%lay_8840, %3470) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8842 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8843 = cute.size(%lay_8837) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3471 = cute.get_scalars(%sz_8843) : !cute.int_tuple<"2">
          %c0_i32_8844 = arith.constant 0 : i32
          %c1_i32_8845 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8844 to %3471 step %c1_i32_8845  : i32 {
            %coord_8846 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3472 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8847 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8848 = cute.crd2idx(%coord_8846, %lay_8837) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8849 = cute.add_offset(%iter_8831, %idx_8848) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8850 = cute.make_view(%ptr_8849, %lay_8847) : !memref_gmem_bf16_8
            %3473 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8851 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8852 = cute.crd2idx(%coord_8846, %lay_8838) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8853 = cute.add_offset(%iter_8832, %idx_8852) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8854 = cute.make_view(%ptr_8853, %lay_8851) : !memref_smem_bf16_13
            %3474 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8855 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8856 = cute.crd2idx(%coord_8846, %lay_8842) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8857 = cute.add_offset(%iter_8839, %idx_8856) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8858 = cute.make_view(%ptr_8857, %lay_8855) : !memref_rmem_i8_4
            %iter_8859 = cute.get_iter(%view_8850) : !memref_gmem_bf16_8
            %iter_8860 = cute.get_iter(%view_8854) : !memref_smem_bf16_13
            %iter_8861 = cute.get_iter(%view_8858) : !memref_rmem_i8_4
            %3475 = builtin.unrealized_conversion_cast %iter_8861 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3476 = llvm.load %3475 : !llvm.ptr -> i8
            %3477 = llvm.trunc %3476 : i8 to i1
            %iter_8862 = cute.recast_iter(%iter_8859) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8863 = cute.recast_iter(%iter_8860) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8863 : !cute.ptr<i128, smem>, %iter_8862 : !cute.ptr<i128, gmem>, %3477 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8744 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_8745 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_8747 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_smem_bf16_14
          %iter_8750 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %iter_8751 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %lay_8752 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %sz_8753 = cute.size(%lay_8752) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8754 = cute.get_leaves(%sz_8753) : !cute.int_tuple<"16">
          %lay_8755 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %3463 = cute.get_shape(%lay_8755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8756, %e1_8757, %e2_8758 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %int_tuple_8759 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8760 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8761 = cute.get_leaves(%int_tuple_8760) : !cute.int_tuple<"16">
          %cst_8762 = arith.constant 0.000000e+00 : bf16
          %3464 = vector.splat %cst_8762 : vector<16xbf16>
          %int_tuple_8763 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8764 = cute.size(%int_tuple_8763) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8765 = cute.get_leaves(%sz_8764) : !cute.int_tuple<"16">
          %int_tuple_8766 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8767 = cute.size(%int_tuple_8766) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8768 = cute.get_leaves(%sz_8767) : !cute.int_tuple<"16">
          cute.memref.store_vec %3464, %view_8749 : !memref_smem_bf16_14
        }
        %coord_8678 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
        %lay_8679 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8680 = cute.crd2idx(%coord_8678, %lay_8679) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
        %iter_8681 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8682 = cute.add_offset(%iter_8681, %idx_8680) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8683 = cute.make_view(%tup_8682) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8684 = cute.get_iter(%view_8683) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8685, %e1_8686, %e2_8687, %e3_8688 = cute.get_leaves(%iter_8684) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3421 = cute.get_scalars(%e0_8685) : !cute.int_tuple<"?">
        %3422 = cute.get_scalars(%e1_8686) : !cute.int_tuple<"?">
        %3423 = cute.get_scalars(%e2_8687) : !cute.int_tuple<"?">
        %3424 = cute.get_scalars(%e3_8688) : !cute.int_tuple<"?{div=8}">
        %iter_8689 = cute.get_iter(%view_8683) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8690, %e1_8691, %e2_8692, %e3_8693 = cute.get_leaves(%iter_8689) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3425 = cute.get_scalars(%e0_8690) : !cute.int_tuple<"?">
        %3426 = cute.get_scalars(%e1_8691) : !cute.int_tuple<"?">
        %3427 = cute.get_scalars(%e2_8692) : !cute.int_tuple<"?">
        %3428 = cute.get_scalars(%e3_8693) : !cute.int_tuple<"?{div=8}">
        %iter_8694 = cute.get_iter(%view_8683) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8695, %e1_8696, %e2_8697, %e3_8698 = cute.get_leaves(%iter_8694) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3429 = cute.get_scalars(%e0_8695) : !cute.int_tuple<"?">
        %3430 = cute.get_scalars(%e1_8696) : !cute.int_tuple<"?">
        %3431 = cute.get_scalars(%e2_8697) : !cute.int_tuple<"?">
        %3432 = cute.get_scalars(%e3_8698) : !cute.int_tuple<"?{div=8}">
        %lay_8699 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3433 = cute.get_shape(%lay_8699) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8700, %e1_8701, %e2_8702, %e3_8703 = cute.get_leaves(%3433) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8704 = cute.to_int_tuple(%e0_8700) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3434 = cute.get_scalars(%itup_8704) : !cute.int_tuple<"?">
        %itup_8705 = cute.to_int_tuple(%e1_8701) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3435 = cute.get_scalars(%itup_8705) : !cute.int_tuple<"?">
        %itup_8706 = cute.to_int_tuple(%e2_8702) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3436 = cute.get_scalars(%itup_8706) : !cute.int_tuple<"?">
        %itup_8707 = cute.to_int_tuple(%e3_8703) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3437 = cute.get_scalars(%itup_8707) : !cute.int_tuple<"?{div=8}">
        %coord_8708 = cute.make_coord(%e1_8696) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8709 = cute.make_coord(%itup_8705) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3438 = cute.get_scalars(%coord_8708) : !cute.coord<"?">
        %3439 = cute.get_scalars(%coord_8709) : !cute.coord<"?">
        %true_8710 = arith.constant true
        %3440 = arith.cmpi slt, %3438, %3439 : i32
        %3441 = arith.andi %true_8710, %3440 : i1
        scf.if %3441 {
          %coord_8744 = cute.make_coord(%1027) : (i32) -> !cute.coord<"(_,2,_,?)">
          %lay_8745 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
          %iter_8747 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_gmem_bf16_6
          %iter_8750 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %iter_8751 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %coord_8752 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8753 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8754 = cute.crd2idx(%coord_8752, %lay_8753) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_8755 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8756 = cute.add_offset(%iter_8755, %idx_8754) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8757 = cute.make_view(%ptr_8756) : !memref_smem_bf16_14
          %iter_8758 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %iter_8759 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %coord_8760 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8761 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %idx_8762 = cute.crd2idx(%coord_8760, %lay_8761) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8763 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
          %ptr_8764 = cute.add_offset(%iter_8763, %idx_8762) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8765 = cute.make_view(%ptr_8764) : !memref_rmem_i8_2
          %iter_8766 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %iter_8767 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %lay_8768 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %3463 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %lay_8772 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %3464 = cute.get_shape(%lay_8772) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8773, %e1_8774, %e2_8775 = cute.get_leaves(%3464) : !cute.shape<"((8,1),2)">
          %lay_8776 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %shape_8777 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8778 = cute.make_layout() : !cute.layout<"1:0">
          %append_8779 = cute.append_to_rank<2> (%lay_8776, %lay_8778) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8780 = cute.make_view(%iter_8751, %append_8779) : !memref_gmem_bf16_6
          %iter_8781 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %lay_8782 = cute.get_layout(%view_8780) : !memref_gmem_bf16_6
          %3465 = cute.get_shape(%lay_8782) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8783, %e1_8784, %e2_8785 = cute.get_leaves(%3465) : !cute.shape<"((8,1),2)">
          %iter_8786 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %view_8787 = cute.make_view(%iter_8786) : !memref_gmem_bf16_7
          %iter_8788 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8789 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %lay_8790 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %shape_8791 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8792 = cute.make_layout() : !cute.layout<"1:0">
          %append_8793 = cute.append_to_rank<2> (%lay_8790, %lay_8792) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8794 = cute.make_view(%iter_8759, %append_8793) : !memref_smem_bf16_14
          %iter_8795 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %lay_8796 = cute.get_layout(%view_8794) : !memref_smem_bf16_14
          %3466 = cute.get_shape(%lay_8796) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8797, %e1_8798, %e2_8799 = cute.get_leaves(%3466) : !cute.shape<"((8,1),2)">
          %iter_8800 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %view_8801 = cute.make_view(%iter_8800) : !memref_smem_bf16_15
          %iter_8802 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %iter_8803 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8804 = cute.get_layout(%view_8765) : !memref_rmem_i8_2
          %shape_8805 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8806 = cute.make_layout() : !cute.layout<"1:0">
          %append_8807 = cute.append_to_rank<2> (%lay_8804, %lay_8806) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8808 = cute.make_view(%iter_8767, %append_8807) : !memref_rmem_i8_2
          %iter_8809 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %lay_8810 = cute.get_layout(%view_8808) : !memref_rmem_i8_2
          %3467 = cute.get_shape(%lay_8810) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8811, %e1_8812 = cute.get_leaves(%3467) : !cute.shape<"(1,2)">
          %iter_8813 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %view_8814 = cute.make_view(%iter_8813) : !memref_rmem_i8_3
          %iter_8815 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %iter_8816 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8817 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %3468 = cute.get_shape(%lay_8817) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8818, %e1_8819, %e2_8820 = cute.get_leaves(%3468) : !cute.shape<"((8,1),(2))">
          %lay_8821 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %3469 = cute.get_shape(%lay_8821) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8822, %e1_8823, %e2_8824 = cute.get_leaves(%3469) : !cute.shape<"((8,1),(2))">
          %lay_8825 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %sz_8826 = cute.size(%lay_8825) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8827 = cute.get_leaves(%sz_8826) : !cute.int_tuple<"2">
          %lay_8828 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %sz_8829 = cute.size(%lay_8828) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8830 = cute.get_leaves(%sz_8829) : !cute.int_tuple<"2">
          %3470 = cute.static : !cute.layout<"1:0">
          %iter_8831 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8832 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8833 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %lay_8834 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %append_8835 = cute.append_to_rank<2> (%lay_8833, %3470) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8836 = cute.append_to_rank<2> (%lay_8834, %3470) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8837 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8838 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8839 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8840 = cute.get_layout(%view_8814) : !memref_rmem_i8_3
          %append_8841 = cute.append_to_rank<2> (%lay_8840, %3470) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8842 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8843 = cute.size(%lay_8837) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3471 = cute.get_scalars(%sz_8843) : !cute.int_tuple<"2">
          %c0_i32_8844 = arith.constant 0 : i32
          %c1_i32_8845 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8844 to %3471 step %c1_i32_8845  : i32 {
            %coord_8846 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3472 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8847 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8848 = cute.crd2idx(%coord_8846, %lay_8837) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8849 = cute.add_offset(%iter_8831, %idx_8848) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8850 = cute.make_view(%ptr_8849, %lay_8847) : !memref_gmem_bf16_8
            %3473 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8851 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8852 = cute.crd2idx(%coord_8846, %lay_8838) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8853 = cute.add_offset(%iter_8832, %idx_8852) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8854 = cute.make_view(%ptr_8853, %lay_8851) : !memref_smem_bf16_13
            %3474 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8855 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8856 = cute.crd2idx(%coord_8846, %lay_8842) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8857 = cute.add_offset(%iter_8839, %idx_8856) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8858 = cute.make_view(%ptr_8857, %lay_8855) : !memref_rmem_i8_4
            %iter_8859 = cute.get_iter(%view_8850) : !memref_gmem_bf16_8
            %iter_8860 = cute.get_iter(%view_8854) : !memref_smem_bf16_13
            %iter_8861 = cute.get_iter(%view_8858) : !memref_rmem_i8_4
            %3475 = builtin.unrealized_conversion_cast %iter_8861 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3476 = llvm.load %3475 : !llvm.ptr -> i8
            %3477 = llvm.trunc %3476 : i8 to i1
            %iter_8862 = cute.recast_iter(%iter_8859) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8863 = cute.recast_iter(%iter_8860) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8863 : !cute.ptr<i128, smem>, %iter_8862 : !cute.ptr<i128, gmem>, %3477 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8744 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_8745 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_8747 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_smem_bf16_14
          %iter_8750 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %iter_8751 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %lay_8752 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %sz_8753 = cute.size(%lay_8752) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8754 = cute.get_leaves(%sz_8753) : !cute.int_tuple<"16">
          %lay_8755 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %3463 = cute.get_shape(%lay_8755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8756, %e1_8757, %e2_8758 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %int_tuple_8759 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8760 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8761 = cute.get_leaves(%int_tuple_8760) : !cute.int_tuple<"16">
          %cst_8762 = arith.constant 0.000000e+00 : bf16
          %3464 = vector.splat %cst_8762 : vector<16xbf16>
          %int_tuple_8763 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8764 = cute.size(%int_tuple_8763) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8765 = cute.get_leaves(%sz_8764) : !cute.int_tuple<"16">
          %int_tuple_8766 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8767 = cute.size(%int_tuple_8766) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8768 = cute.get_leaves(%sz_8767) : !cute.int_tuple<"16">
          cute.memref.store_vec %3464, %view_8749 : !memref_smem_bf16_14
        }
        %coord_8711 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
        %lay_8712 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_8713 = cute.crd2idx(%coord_8711, %lay_8712) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
        %iter_8714 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_8715 = cute.add_offset(%iter_8714, %idx_8713) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_8716 = cute.make_view(%tup_8715) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_8717 = cute.get_iter(%view_8716) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8718, %e1_8719, %e2_8720, %e3_8721 = cute.get_leaves(%iter_8717) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3442 = cute.get_scalars(%e0_8718) : !cute.int_tuple<"?">
        %3443 = cute.get_scalars(%e1_8719) : !cute.int_tuple<"?">
        %3444 = cute.get_scalars(%e2_8720) : !cute.int_tuple<"?">
        %3445 = cute.get_scalars(%e3_8721) : !cute.int_tuple<"?{div=8}">
        %iter_8722 = cute.get_iter(%view_8716) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8723, %e1_8724, %e2_8725, %e3_8726 = cute.get_leaves(%iter_8722) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3446 = cute.get_scalars(%e0_8723) : !cute.int_tuple<"?">
        %3447 = cute.get_scalars(%e1_8724) : !cute.int_tuple<"?">
        %3448 = cute.get_scalars(%e2_8725) : !cute.int_tuple<"?">
        %3449 = cute.get_scalars(%e3_8726) : !cute.int_tuple<"?{div=8}">
        %iter_8727 = cute.get_iter(%view_8716) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_8728, %e1_8729, %e2_8730, %e3_8731 = cute.get_leaves(%iter_8727) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %3450 = cute.get_scalars(%e0_8728) : !cute.int_tuple<"?">
        %3451 = cute.get_scalars(%e1_8729) : !cute.int_tuple<"?">
        %3452 = cute.get_scalars(%e2_8730) : !cute.int_tuple<"?">
        %3453 = cute.get_scalars(%e3_8731) : !cute.int_tuple<"?{div=8}">
        %lay_8732 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %3454 = cute.get_shape(%lay_8732) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8733, %e1_8734, %e2_8735, %e3_8736 = cute.get_leaves(%3454) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8737 = cute.to_int_tuple(%e0_8733) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3455 = cute.get_scalars(%itup_8737) : !cute.int_tuple<"?">
        %itup_8738 = cute.to_int_tuple(%e1_8734) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3456 = cute.get_scalars(%itup_8738) : !cute.int_tuple<"?">
        %itup_8739 = cute.to_int_tuple(%e2_8735) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3457 = cute.get_scalars(%itup_8739) : !cute.int_tuple<"?">
        %itup_8740 = cute.to_int_tuple(%e3_8736) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3458 = cute.get_scalars(%itup_8740) : !cute.int_tuple<"?{div=8}">
        %coord_8741 = cute.make_coord(%e1_8729) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_8742 = cute.make_coord(%itup_8738) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %3459 = cute.get_scalars(%coord_8741) : !cute.coord<"?">
        %3460 = cute.get_scalars(%coord_8742) : !cute.coord<"?">
        %true_8743 = arith.constant true
        %3461 = arith.cmpi slt, %3459, %3460 : i32
        %3462 = arith.andi %true_8743, %3461 : i1
        scf.if %3462 {
          %coord_8744 = cute.make_coord(%1027) : (i32) -> !cute.coord<"(_,3,_,?)">
          %lay_8745 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_8747 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_gmem_bf16_6
          %iter_8750 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %iter_8751 = cute.get_iter(%view_8749) : !memref_gmem_bf16_6
          %coord_8752 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8753 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8754 = cute.crd2idx(%coord_8752, %lay_8753) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_8755 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8756 = cute.add_offset(%iter_8755, %idx_8754) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8757 = cute.make_view(%ptr_8756) : !memref_smem_bf16_14
          %iter_8758 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %iter_8759 = cute.get_iter(%view_8757) : !memref_smem_bf16_14
          %coord_8760 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8761 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %idx_8762 = cute.crd2idx(%coord_8760, %lay_8761) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_8763 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
          %ptr_8764 = cute.add_offset(%iter_8763, %idx_8762) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_8765 = cute.make_view(%ptr_8764) : !memref_rmem_i8_2
          %iter_8766 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %iter_8767 = cute.get_iter(%view_8765) : !memref_rmem_i8_2
          %lay_8768 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %3463 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %lay_8772 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %3464 = cute.get_shape(%lay_8772) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8773, %e1_8774, %e2_8775 = cute.get_leaves(%3464) : !cute.shape<"((8,1),2)">
          %lay_8776 = cute.get_layout(%view_8749) : !memref_gmem_bf16_6
          %shape_8777 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8778 = cute.make_layout() : !cute.layout<"1:0">
          %append_8779 = cute.append_to_rank<2> (%lay_8776, %lay_8778) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8780 = cute.make_view(%iter_8751, %append_8779) : !memref_gmem_bf16_6
          %iter_8781 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %lay_8782 = cute.get_layout(%view_8780) : !memref_gmem_bf16_6
          %3465 = cute.get_shape(%lay_8782) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8783, %e1_8784, %e2_8785 = cute.get_leaves(%3465) : !cute.shape<"((8,1),2)">
          %iter_8786 = cute.get_iter(%view_8780) : !memref_gmem_bf16_6
          %view_8787 = cute.make_view(%iter_8786) : !memref_gmem_bf16_7
          %iter_8788 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8789 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %lay_8790 = cute.get_layout(%view_8757) : !memref_smem_bf16_14
          %shape_8791 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8792 = cute.make_layout() : !cute.layout<"1:0">
          %append_8793 = cute.append_to_rank<2> (%lay_8790, %lay_8792) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8794 = cute.make_view(%iter_8759, %append_8793) : !memref_smem_bf16_14
          %iter_8795 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %lay_8796 = cute.get_layout(%view_8794) : !memref_smem_bf16_14
          %3466 = cute.get_shape(%lay_8796) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8797, %e1_8798, %e2_8799 = cute.get_leaves(%3466) : !cute.shape<"((8,1),2)">
          %iter_8800 = cute.get_iter(%view_8794) : !memref_smem_bf16_14
          %view_8801 = cute.make_view(%iter_8800) : !memref_smem_bf16_15
          %iter_8802 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %iter_8803 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8804 = cute.get_layout(%view_8765) : !memref_rmem_i8_2
          %shape_8805 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8806 = cute.make_layout() : !cute.layout<"1:0">
          %append_8807 = cute.append_to_rank<2> (%lay_8804, %lay_8806) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8808 = cute.make_view(%iter_8767, %append_8807) : !memref_rmem_i8_2
          %iter_8809 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %lay_8810 = cute.get_layout(%view_8808) : !memref_rmem_i8_2
          %3467 = cute.get_shape(%lay_8810) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8811, %e1_8812 = cute.get_leaves(%3467) : !cute.shape<"(1,2)">
          %iter_8813 = cute.get_iter(%view_8808) : !memref_rmem_i8_2
          %view_8814 = cute.make_view(%iter_8813) : !memref_rmem_i8_3
          %iter_8815 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %iter_8816 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8817 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %3468 = cute.get_shape(%lay_8817) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8818, %e1_8819, %e2_8820 = cute.get_leaves(%3468) : !cute.shape<"((8,1),(2))">
          %lay_8821 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %3469 = cute.get_shape(%lay_8821) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8822, %e1_8823, %e2_8824 = cute.get_leaves(%3469) : !cute.shape<"((8,1),(2))">
          %lay_8825 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %sz_8826 = cute.size(%lay_8825) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8827 = cute.get_leaves(%sz_8826) : !cute.int_tuple<"2">
          %lay_8828 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %sz_8829 = cute.size(%lay_8828) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8830 = cute.get_leaves(%sz_8829) : !cute.int_tuple<"2">
          %3470 = cute.static : !cute.layout<"1:0">
          %iter_8831 = cute.get_iter(%view_8787) : !memref_gmem_bf16_7
          %iter_8832 = cute.get_iter(%view_8801) : !memref_smem_bf16_15
          %lay_8833 = cute.get_layout(%view_8787) : !memref_gmem_bf16_7
          %lay_8834 = cute.get_layout(%view_8801) : !memref_smem_bf16_15
          %append_8835 = cute.append_to_rank<2> (%lay_8833, %3470) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8836 = cute.append_to_rank<2> (%lay_8834, %3470) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8837 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8838 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8839 = cute.get_iter(%view_8814) : !memref_rmem_i8_3
          %lay_8840 = cute.get_layout(%view_8814) : !memref_rmem_i8_3
          %append_8841 = cute.append_to_rank<2> (%lay_8840, %3470) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8842 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8843 = cute.size(%lay_8837) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %3471 = cute.get_scalars(%sz_8843) : !cute.int_tuple<"2">
          %c0_i32_8844 = arith.constant 0 : i32
          %c1_i32_8845 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8844 to %3471 step %c1_i32_8845  : i32 {
            %coord_8846 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %3472 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8847 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8848 = cute.crd2idx(%coord_8846, %lay_8837) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8849 = cute.add_offset(%iter_8831, %idx_8848) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8850 = cute.make_view(%ptr_8849, %lay_8847) : !memref_gmem_bf16_8
            %3473 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8851 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_8852 = cute.crd2idx(%coord_8846, %lay_8838) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8853 = cute.add_offset(%iter_8832, %idx_8852) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8854 = cute.make_view(%ptr_8853, %lay_8851) : !memref_smem_bf16_13
            %3474 = cute.get_scalars(%coord_8846) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_8855 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_8856 = cute.crd2idx(%coord_8846, %lay_8842) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8857 = cute.add_offset(%iter_8839, %idx_8856) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8858 = cute.make_view(%ptr_8857, %lay_8855) : !memref_rmem_i8_4
            %iter_8859 = cute.get_iter(%view_8850) : !memref_gmem_bf16_8
            %iter_8860 = cute.get_iter(%view_8854) : !memref_smem_bf16_13
            %iter_8861 = cute.get_iter(%view_8858) : !memref_rmem_i8_4
            %3475 = builtin.unrealized_conversion_cast %iter_8861 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3476 = llvm.load %3475 : !llvm.ptr -> i8
            %3477 = llvm.trunc %3476 : i8 to i1
            %iter_8862 = cute.recast_iter(%iter_8859) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_8863 = cute.recast_iter(%iter_8860) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_8863 : !cute.ptr<i128, smem>, %iter_8862 : !cute.ptr<i128, gmem>, %3477 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_8744 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_8745 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %idx_8746 = cute.crd2idx(%coord_8744, %lay_8745) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_8747 = cute.get_iter(%view_489) : !memref_smem_bf16_4
          %ptr_8748 = cute.add_offset(%iter_8747, %idx_8746) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8749 = cute.make_view(%ptr_8748) : !memref_smem_bf16_14
          %iter_8750 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %iter_8751 = cute.get_iter(%view_8749) : !memref_smem_bf16_14
          %lay_8752 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %sz_8753 = cute.size(%lay_8752) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_8754 = cute.get_leaves(%sz_8753) : !cute.int_tuple<"16">
          %lay_8755 = cute.get_layout(%view_8749) : !memref_smem_bf16_14
          %3463 = cute.get_shape(%lay_8755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8756, %e1_8757, %e2_8758 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
          %int_tuple_8759 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %int_tuple_8760 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
          %e0_8761 = cute.get_leaves(%int_tuple_8760) : !cute.int_tuple<"16">
          %cst_8762 = arith.constant 0.000000e+00 : bf16
          %3464 = vector.splat %cst_8762 : vector<16xbf16>
          %int_tuple_8763 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8764 = cute.size(%int_tuple_8763) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8765 = cute.get_leaves(%sz_8764) : !cute.int_tuple<"16">
          %int_tuple_8766 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_8767 = cute.size(%int_tuple_8766) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_8768 = cute.get_leaves(%sz_8767) : !cute.int_tuple<"16">
          cute.memref.store_vec %3464, %view_8749 : !memref_smem_bf16_14
        }
      } else {
        %coord_8604 = cute.make_coord(%1027) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_8605 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
        %3378:3 = cute.get_scalars(%lay_8605) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
        %shape_8606 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
        %iv_8607 = cute.assume(%3378#1) : (i64) -> !cute.i64<divby 128>
        %stride_8608 = cute.make_stride(%iv_8607) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
        %lay_8609 = cute.make_layout(%shape_8606, %stride_8608) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8611 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
        %ptr_8612 = cute.add_offset(%iter_8611, %idx_8610) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8613 = cute.make_view(%ptr_8612, %lay_8609) : !memref_gmem_bf16_9
        %iter_8614 = cute.get_iter(%view_8613) : !memref_gmem_bf16_9
        %iter_8615 = cute.get_iter(%view_8613) : !memref_gmem_bf16_9
        %lay_8616 = cute.get_layout(%view_8613) : !memref_gmem_bf16_9
        %3380 = cute.get_shape(%lay_8616) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8617, %e1_8618, %e2_8619, %e3_8620 = cute.get_leaves(%3380) : !cute.shape<"((8,1),4,2)">
        %lay_8621 = cute.get_layout(%view_489) : !memref_smem_bf16_4
        %3381 = cute.get_shape(%lay_8621) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8622, %e1_8623, %e2_8624, %e3_8625 = cute.get_leaves(%3381) : !cute.shape<"((8,1),4,2)">
        %lay_8626 = cute.get_layout(%view_8613) : !memref_gmem_bf16_9
        %shape_8627 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8628 = cute.make_layout() : !cute.layout<"1:0">
        %append_8629 = cute.append_to_rank<2> (%lay_8626, %lay_8628) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_8630 = cute.make_view(%iter_8615, %append_8629) : !memref_gmem_bf16_9
        %iter_8631 = cute.get_iter(%view_8630) : !memref_gmem_bf16_9
        %lay_8632 = cute.get_layout(%view_8630) : !memref_gmem_bf16_9
        %3382 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8633, %e1_8634, %e2_8635, %e3_8636 = cute.get_leaves(%3382) : !cute.shape<"((8,1),4,2)">
        %iter_8637 = cute.get_iter(%view_8630) : !memref_gmem_bf16_9
        %lay_8638 = cute.get_layout(%view_8630) : !memref_gmem_bf16_9
        %3383 = cute.get_scalars(%lay_8638) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_8639 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_8640 = cute.assume(%3383) : (i64) -> !cute.i64<divby 128>
        %stride_8641 = cute.make_stride(%iv_8640) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_8642 = cute.make_layout(%shape_8639, %stride_8641) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_8643 = cute.make_view(%iter_8637, %lay_8642) : !memref_gmem_bf16_10
        %iter_8644 = cute.get_iter(%view_8643) : !memref_gmem_bf16_10
        %iter_8645 = cute.get_iter(%view_8643) : !memref_gmem_bf16_10
        %lay_8646 = cute.get_layout(%view_489) : !memref_smem_bf16_4
        %shape_8647 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8648 = cute.make_layout() : !cute.layout<"1:0">
        %append_8649 = cute.append_to_rank<2> (%lay_8646, %lay_8648) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_8650 = cute.make_view(%iter_490, %append_8649) : !memref_smem_bf16_4
        %iter_8651 = cute.get_iter(%view_8650) : !memref_smem_bf16_4
        %lay_8652 = cute.get_layout(%view_8650) : !memref_smem_bf16_4
        %3384 = cute.get_shape(%lay_8652) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8653, %e1_8654, %e2_8655, %e3_8656 = cute.get_leaves(%3384) : !cute.shape<"((8,1),4,2)">
        %iter_8657 = cute.get_iter(%view_8650) : !memref_smem_bf16_4
        %view_8658 = cute.make_view(%iter_8657) : !memref_smem_bf16_16
        %iter_8659 = cute.get_iter(%view_8658) : !memref_smem_bf16_16
        %iter_8660 = cute.get_iter(%view_8658) : !memref_smem_bf16_16
        %lay_8661 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %shape_8662 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8663 = cute.make_layout() : !cute.layout<"1:0">
        %append_8664 = cute.append_to_rank<2> (%lay_8661, %lay_8663) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_8665 = cute.make_view(%iter_1047, %append_8664) : !memref_rmem_i8_1
        %iter_8666 = cute.get_iter(%view_8665) : !memref_rmem_i8_1
        %lay_8667 = cute.get_layout(%view_8665) : !memref_rmem_i8_1
        %3385 = cute.get_shape(%lay_8667) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_8668, %e1_8669, %e2_8670 = cute.get_leaves(%3385) : !cute.shape<"(1,4,2)">
        %iter_8671 = cute.get_iter(%view_8665) : !memref_rmem_i8_1
        %view_8672 = cute.make_view(%iter_8671) : !memref_rmem_i8_5
        %iter_8673 = cute.get_iter(%view_8672) : !memref_rmem_i8_5
        %iter_8674 = cute.get_iter(%view_8672) : !memref_rmem_i8_5
        %lay_8675 = cute.get_layout(%view_8643) : !memref_gmem_bf16_10
        %3386 = cute.get_shape(%lay_8675) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8676, %e1_8677, %e2_8678, %e3_8679 = cute.get_leaves(%3386) : !cute.shape<"((8,1),(4,2))">
        %lay_8680 = cute.get_layout(%view_8658) : !memref_smem_bf16_16
        %3387 = cute.get_shape(%lay_8680) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8681, %e1_8682, %e2_8683, %e3_8684 = cute.get_leaves(%3387) : !cute.shape<"((8,1),(4,2))">
        %lay_8685 = cute.get_layout(%view_8643) : !memref_gmem_bf16_10
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"8">
        %lay_8688 = cute.get_layout(%view_8658) : !memref_smem_bf16_16
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"8">
        %3388 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8643) : !memref_gmem_bf16_10
        %iter_8692 = cute.get_iter(%view_8658) : !memref_smem_bf16_16
        %lay_8693 = cute.get_layout(%view_8643) : !memref_gmem_bf16_10
        %lay_8694 = cute.get_layout(%view_8658) : !memref_smem_bf16_16
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3388) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3388) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %3389 = cute.get_scalars(%append_8695) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_8697 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_8698 = cute.assume(%3389) : (i64) -> !cute.i64<divby 128>
        %stride_8699 = cute.make_stride(%iv_8698) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_8700 = cute.make_layout(%shape_8697, %stride_8699) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_8701 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_8702 = cute.get_iter(%view_8672) : !memref_rmem_i8_5
        %lay_8703 = cute.get_layout(%view_8672) : !memref_rmem_i8_5
        %append_8704 = cute.append_to_rank<2> (%lay_8703, %3388) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_8705 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_8706 = cute.size(%lay_8700) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %3390 = cute.get_scalars(%sz_8706) : !cute.int_tuple<"8">
        %c0_i32_8707 = arith.constant 0 : i32
        %c1_i32_8708 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8707 to %3390 step %c1_i32_8708  : i32 {
          %coord_8709 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3391 = cute.get_scalars(%lay_8700) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %3392 = cute.get_scalars(%coord_8709) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8710 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8711 = cute.crd2idx(%coord_8709, %lay_8700) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_8712 = cute.add_offset(%iter_8691, %idx_8711) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8713 = cute.make_view(%ptr_8712, %lay_8710) : !memref_gmem_bf16_8
          %3393 = cute.get_scalars(%coord_8709) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8714 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8715 = cute.crd2idx(%coord_8709, %lay_8701) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_8716 = cute.add_offset(%iter_8692, %idx_8715) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8717 = cute.make_view(%ptr_8716, %lay_8714) : !memref_smem_bf16_13
          %3394 = cute.get_scalars(%coord_8709) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8718 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8719 = cute.crd2idx(%coord_8709, %lay_8705) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_8720 = cute.add_offset(%iter_8702, %idx_8719) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8721 = cute.make_view(%ptr_8720, %lay_8718) : !memref_rmem_i8_4
          %iter_8722 = cute.get_iter(%view_8713) : !memref_gmem_bf16_8
          %iter_8723 = cute.get_iter(%view_8717) : !memref_smem_bf16_13
          %iter_8724 = cute.get_iter(%view_8721) : !memref_rmem_i8_4
          %3395 = builtin.unrealized_conversion_cast %iter_8724 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3396 = llvm.load %3395 : !llvm.ptr -> i8
          %3397 = llvm.trunc %3396 : i8 to i1
          %iter_8725 = cute.recast_iter(%iter_8722) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8726 = cute.recast_iter(%iter_8723) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8726 : !cute.ptr<i128, smem>, %iter_8725 : !cute.ptr<i128, gmem>, %3397 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
      }
      nvvm.cp.async.commit.group
      %coord_1660 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1661 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_1662 = cute.crd2idx(%coord_1660, %lay_1661) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_1663 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_1664 = cute.add_offset(%iter_1663, %idx_1662) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1665 = cute.make_view(%ptr_1664) : !memref_smem_bf16_14
      %iter_1666 = cute.get_iter(%view_1665) : !memref_smem_bf16_14
      %iter_1667 = cute.get_iter(%view_1665) : !memref_smem_bf16_14
      %coord_1668 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1669 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_1670 = cute.crd2idx(%coord_1668, %lay_1669) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_1671 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_1672 = cute.add_offset(%iter_1671, %idx_1670) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1673 = cute.make_view(%ptr_1672) : !memref_rmem_bf16_6
      %iter_1674 = cute.get_iter(%view_1673) : !memref_rmem_bf16_6
      %iter_1675 = cute.get_iter(%view_1673) : !memref_rmem_bf16_6
      %lay_1676 = cute.get_layout(%view_1665) : !memref_smem_bf16_14
      %1030 = cute.get_shape(%lay_1676) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1677, %e1_1678, %e2_1679 = cute.get_leaves(%1030) : !cute.shape<"((8,1),2)">
      %lay_1680 = cute.get_layout(%view_1673) : !memref_rmem_bf16_6
      %1031 = cute.get_shape(%lay_1680) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1681, %e1_1682, %e2_1683 = cute.get_leaves(%1031) : !cute.shape<"((8,1),2)">
      %lay_1684 = cute.get_layout(%view_1665) : !memref_smem_bf16_14
      %shape_1685 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1686 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1684, %lay_1686) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1687 = cute.make_view(%iter_1667, %append) : !memref_smem_bf16_14
      %iter_1688 = cute.get_iter(%view_1687) : !memref_smem_bf16_14
      %lay_1689 = cute.get_layout(%view_1687) : !memref_smem_bf16_14
      %1032 = cute.get_shape(%lay_1689) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1690, %e1_1691, %e2_1692 = cute.get_leaves(%1032) : !cute.shape<"((8,1),2)">
      %iter_1693 = cute.get_iter(%view_1687) : !memref_smem_bf16_14
      %view_1694 = cute.make_view(%iter_1693) : !memref_smem_bf16_15
      %iter_1695 = cute.get_iter(%view_1694) : !memref_smem_bf16_15
      %iter_1696 = cute.get_iter(%view_1694) : !memref_smem_bf16_15
      %lay_1697 = cute.get_layout(%view_1673) : !memref_rmem_bf16_6
      %shape_1698 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1699 = cute.make_layout() : !cute.layout<"1:0">
      %append_1700 = cute.append_to_rank<2> (%lay_1697, %lay_1699) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1701 = cute.make_view(%iter_1675, %append_1700) : !memref_rmem_bf16_6
      %iter_1702 = cute.get_iter(%view_1701) : !memref_rmem_bf16_6
      %lay_1703 = cute.get_layout(%view_1701) : !memref_rmem_bf16_6
      %1033 = cute.get_shape(%lay_1703) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1704, %e1_1705, %e2_1706 = cute.get_leaves(%1033) : !cute.shape<"((8,1),2)">
      %iter_1707 = cute.get_iter(%view_1701) : !memref_rmem_bf16_6
      %view_1708 = cute.make_view(%iter_1707) : !memref_rmem_bf16_7
      %iter_1709 = cute.get_iter(%view_1708) : !memref_rmem_bf16_7
      %iter_1710 = cute.get_iter(%view_1708) : !memref_rmem_bf16_7
      %lay_1711 = cute.get_layout(%view_1694) : !memref_smem_bf16_15
      %1034 = cute.get_shape(%lay_1711) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1712, %e1_1713, %e2_1714 = cute.get_leaves(%1034) : !cute.shape<"((8,1),(2))">
      %lay_1715 = cute.get_layout(%view_1708) : !memref_rmem_bf16_7
      %1035 = cute.get_shape(%lay_1715) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1716, %e1_1717, %e2_1718 = cute.get_leaves(%1035) : !cute.shape<"((8,1),(2))">
      %lay_1719 = cute.get_layout(%view_1694) : !memref_smem_bf16_15
      %sz_1720 = cute.size(%lay_1719) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1721 = cute.get_leaves(%sz_1720) : !cute.int_tuple<"2">
      %lay_1722 = cute.get_layout(%view_1708) : !memref_rmem_bf16_7
      %sz_1723 = cute.size(%lay_1722) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1724 = cute.get_leaves(%sz_1723) : !cute.int_tuple<"2">
      %1036 = cute.static : !cute.layout<"1:0">
      %iter_1725 = cute.get_iter(%view_1694) : !memref_smem_bf16_15
      %iter_1726 = cute.get_iter(%view_1708) : !memref_rmem_bf16_7
      %lay_1727 = cute.get_layout(%view_1694) : !memref_smem_bf16_15
      %lay_1728 = cute.get_layout(%view_1708) : !memref_rmem_bf16_7
      %append_1729 = cute.append_to_rank<2> (%lay_1727, %1036) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1730 = cute.append_to_rank<2> (%lay_1728, %1036) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1731 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1732 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1733 = cute.size(%lay_1731) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1037 = cute.get_scalars(%sz_1733) : !cute.int_tuple<"2">
      %c0_i32_1734 = arith.constant 0 : i32
      %c1_i32_1735 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1734 to %1037 step %c1_i32_1735  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_1731) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_1725, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_1732) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_1726, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1736 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1737 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_1738 = cute.crd2idx(%coord_1736, %lay_1737) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_1739 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_1740 = cute.add_offset(%iter_1739, %idx_1738) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1741 = cute.make_view(%ptr_1740) : !memref_smem_bf16_17
      %iter_1742 = cute.get_iter(%view_1741) : !memref_smem_bf16_17
      %iter_1743 = cute.get_iter(%view_1741) : !memref_smem_bf16_17
      %coord_1744 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1745 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_1746 = cute.crd2idx(%coord_1744, %lay_1745) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_1747 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_1748 = cute.add_offset(%iter_1747, %idx_1746) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1749 = cute.make_view(%ptr_1748) : !memref_rmem_bf16_9
      %iter_1750 = cute.get_iter(%view_1749) : !memref_rmem_bf16_9
      %iter_1751 = cute.get_iter(%view_1749) : !memref_rmem_bf16_9
      %lay_1752 = cute.get_layout(%view_1741) : !memref_smem_bf16_17
      %1038 = cute.get_shape(%lay_1752) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1753, %e1_1754, %e2_1755 = cute.get_leaves(%1038) : !cute.shape<"((8,1),4)">
      %lay_1756 = cute.get_layout(%view_1749) : !memref_rmem_bf16_9
      %1039 = cute.get_shape(%lay_1756) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1757, %e1_1758, %e2_1759 = cute.get_leaves(%1039) : !cute.shape<"((8,1),4)">
      %lay_1760 = cute.get_layout(%view_1741) : !memref_smem_bf16_17
      %shape_1761 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1762 = cute.make_layout() : !cute.layout<"1:0">
      %append_1763 = cute.append_to_rank<2> (%lay_1760, %lay_1762) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1764 = cute.make_view(%iter_1743, %append_1763) : !memref_smem_bf16_17
      %iter_1765 = cute.get_iter(%view_1764) : !memref_smem_bf16_17
      %lay_1766 = cute.get_layout(%view_1764) : !memref_smem_bf16_17
      %1040 = cute.get_shape(%lay_1766) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1767, %e1_1768, %e2_1769 = cute.get_leaves(%1040) : !cute.shape<"((8,1),4)">
      %iter_1770 = cute.get_iter(%view_1764) : !memref_smem_bf16_17
      %view_1771 = cute.make_view(%iter_1770) : !memref_smem_bf16_18
      %iter_1772 = cute.get_iter(%view_1771) : !memref_smem_bf16_18
      %iter_1773 = cute.get_iter(%view_1771) : !memref_smem_bf16_18
      %lay_1774 = cute.get_layout(%view_1749) : !memref_rmem_bf16_9
      %shape_1775 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1776 = cute.make_layout() : !cute.layout<"1:0">
      %append_1777 = cute.append_to_rank<2> (%lay_1774, %lay_1776) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1778 = cute.make_view(%iter_1751, %append_1777) : !memref_rmem_bf16_9
      %iter_1779 = cute.get_iter(%view_1778) : !memref_rmem_bf16_9
      %lay_1780 = cute.get_layout(%view_1778) : !memref_rmem_bf16_9
      %1041 = cute.get_shape(%lay_1780) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1781, %e1_1782, %e2_1783 = cute.get_leaves(%1041) : !cute.shape<"((8,1),4)">
      %iter_1784 = cute.get_iter(%view_1778) : !memref_rmem_bf16_9
      %view_1785 = cute.make_view(%iter_1784) : !memref_rmem_bf16_10
      %iter_1786 = cute.get_iter(%view_1785) : !memref_rmem_bf16_10
      %iter_1787 = cute.get_iter(%view_1785) : !memref_rmem_bf16_10
      %lay_1788 = cute.get_layout(%view_1771) : !memref_smem_bf16_18
      %1042 = cute.get_shape(%lay_1788) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1789, %e1_1790, %e2_1791 = cute.get_leaves(%1042) : !cute.shape<"((8,1),(4))">
      %lay_1792 = cute.get_layout(%view_1785) : !memref_rmem_bf16_10
      %1043 = cute.get_shape(%lay_1792) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1793, %e1_1794, %e2_1795 = cute.get_leaves(%1043) : !cute.shape<"((8,1),(4))">
      %lay_1796 = cute.get_layout(%view_1771) : !memref_smem_bf16_18
      %sz_1797 = cute.size(%lay_1796) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1798 = cute.get_leaves(%sz_1797) : !cute.int_tuple<"4">
      %lay_1799 = cute.get_layout(%view_1785) : !memref_rmem_bf16_10
      %sz_1800 = cute.size(%lay_1799) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1801 = cute.get_leaves(%sz_1800) : !cute.int_tuple<"4">
      %1044 = cute.static : !cute.layout<"1:0">
      %iter_1802 = cute.get_iter(%view_1771) : !memref_smem_bf16_18
      %iter_1803 = cute.get_iter(%view_1785) : !memref_rmem_bf16_10
      %lay_1804 = cute.get_layout(%view_1771) : !memref_smem_bf16_18
      %lay_1805 = cute.get_layout(%view_1785) : !memref_rmem_bf16_10
      %append_1806 = cute.append_to_rank<2> (%lay_1804, %1044) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1807 = cute.append_to_rank<2> (%lay_1805, %1044) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1808 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1809 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1810 = cute.size(%lay_1808) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1045 = cute.get_scalars(%sz_1810) : !cute.int_tuple<"4">
      %c0_i32_1811 = arith.constant 0 : i32
      %c1_i32_1812 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1811 to %1045 step %c1_i32_1812  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_1808) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_1802, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_1809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_1803, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1813 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %1046 = cute.get_shape(%lay_1813) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
      %e0_1814, %e1_1815, %e2_1816, %e3_1817, %e4_1818, %e5 = cute.get_leaves(%1046) : !cute.shape<"((8,1),2,((2,2),2))">
      %int_tuple_1819 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1820 = cute.size(%int_tuple_1819) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1821 = cute.get_leaves(%sz_1820) : !cute.int_tuple<"8">
      %int_tuple_1822 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1823 = cute.size(%int_tuple_1822) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1824 = cute.get_leaves(%sz_1823) : !cute.int_tuple<"8">
      %coord_1825 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1826 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_1827 = cute.crd2idx(%coord_1825, %lay_1826) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1828 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_1829 = cute.add_offset(%iter_1828, %idx_1827) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1830 = cute.make_view(%ptr_1829) : !memref_smem_bf16_14
      %iter_1831 = cute.get_iter(%view_1830) : !memref_smem_bf16_14
      %iter_1832 = cute.get_iter(%view_1830) : !memref_smem_bf16_14
      %coord_1833 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1834 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_1835 = cute.crd2idx(%coord_1833, %lay_1834) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
      %iter_1836 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_1837 = cute.add_offset(%iter_1836, %idx_1835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1838 = cute.make_view(%ptr_1837) : !memref_rmem_bf16_6
      %iter_1839 = cute.get_iter(%view_1838) : !memref_rmem_bf16_6
      %iter_1840 = cute.get_iter(%view_1838) : !memref_rmem_bf16_6
      %lay_1841 = cute.get_layout(%view_1830) : !memref_smem_bf16_14
      %1047 = cute.get_shape(%lay_1841) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1842, %e1_1843, %e2_1844 = cute.get_leaves(%1047) : !cute.shape<"((8,1),2)">
      %lay_1845 = cute.get_layout(%view_1838) : !memref_rmem_bf16_6
      %1048 = cute.get_shape(%lay_1845) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1846, %e1_1847, %e2_1848 = cute.get_leaves(%1048) : !cute.shape<"((8,1),2)">
      %lay_1849 = cute.get_layout(%view_1830) : !memref_smem_bf16_14
      %shape_1850 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1851 = cute.make_layout() : !cute.layout<"1:0">
      %append_1852 = cute.append_to_rank<2> (%lay_1849, %lay_1851) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1853 = cute.make_view(%iter_1832, %append_1852) : !memref_smem_bf16_14
      %iter_1854 = cute.get_iter(%view_1853) : !memref_smem_bf16_14
      %lay_1855 = cute.get_layout(%view_1853) : !memref_smem_bf16_14
      %1049 = cute.get_shape(%lay_1855) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1856, %e1_1857, %e2_1858 = cute.get_leaves(%1049) : !cute.shape<"((8,1),2)">
      %iter_1859 = cute.get_iter(%view_1853) : !memref_smem_bf16_14
      %view_1860 = cute.make_view(%iter_1859) : !memref_smem_bf16_15
      %iter_1861 = cute.get_iter(%view_1860) : !memref_smem_bf16_15
      %iter_1862 = cute.get_iter(%view_1860) : !memref_smem_bf16_15
      %lay_1863 = cute.get_layout(%view_1838) : !memref_rmem_bf16_6
      %shape_1864 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1865 = cute.make_layout() : !cute.layout<"1:0">
      %append_1866 = cute.append_to_rank<2> (%lay_1863, %lay_1865) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1867 = cute.make_view(%iter_1840, %append_1866) : !memref_rmem_bf16_6
      %iter_1868 = cute.get_iter(%view_1867) : !memref_rmem_bf16_6
      %lay_1869 = cute.get_layout(%view_1867) : !memref_rmem_bf16_6
      %1050 = cute.get_shape(%lay_1869) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1870, %e1_1871, %e2_1872 = cute.get_leaves(%1050) : !cute.shape<"((8,1),2)">
      %iter_1873 = cute.get_iter(%view_1867) : !memref_rmem_bf16_6
      %view_1874 = cute.make_view(%iter_1873) : !memref_rmem_bf16_7
      %iter_1875 = cute.get_iter(%view_1874) : !memref_rmem_bf16_7
      %iter_1876 = cute.get_iter(%view_1874) : !memref_rmem_bf16_7
      %lay_1877 = cute.get_layout(%view_1860) : !memref_smem_bf16_15
      %1051 = cute.get_shape(%lay_1877) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1878, %e1_1879, %e2_1880 = cute.get_leaves(%1051) : !cute.shape<"((8,1),(2))">
      %lay_1881 = cute.get_layout(%view_1874) : !memref_rmem_bf16_7
      %1052 = cute.get_shape(%lay_1881) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1882, %e1_1883, %e2_1884 = cute.get_leaves(%1052) : !cute.shape<"((8,1),(2))">
      %lay_1885 = cute.get_layout(%view_1860) : !memref_smem_bf16_15
      %sz_1886 = cute.size(%lay_1885) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1887 = cute.get_leaves(%sz_1886) : !cute.int_tuple<"2">
      %lay_1888 = cute.get_layout(%view_1874) : !memref_rmem_bf16_7
      %sz_1889 = cute.size(%lay_1888) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1890 = cute.get_leaves(%sz_1889) : !cute.int_tuple<"2">
      %1053 = cute.static : !cute.layout<"1:0">
      %iter_1891 = cute.get_iter(%view_1860) : !memref_smem_bf16_15
      %iter_1892 = cute.get_iter(%view_1874) : !memref_rmem_bf16_7
      %lay_1893 = cute.get_layout(%view_1860) : !memref_smem_bf16_15
      %lay_1894 = cute.get_layout(%view_1874) : !memref_rmem_bf16_7
      %append_1895 = cute.append_to_rank<2> (%lay_1893, %1053) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1896 = cute.append_to_rank<2> (%lay_1894, %1053) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1897 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1898 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1899 = cute.size(%lay_1897) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1054 = cute.get_scalars(%sz_1899) : !cute.int_tuple<"2">
      %c0_i32_1900 = arith.constant 0 : i32
      %c1_i32_1901 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1900 to %1054 step %c1_i32_1901  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_1897) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_1891, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_1898) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_1892, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1902 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1903 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_1904 = cute.crd2idx(%coord_1902, %lay_1903) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1905 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_1906 = cute.add_offset(%iter_1905, %idx_1904) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1907 = cute.make_view(%ptr_1906) : !memref_smem_bf16_17
      %iter_1908 = cute.get_iter(%view_1907) : !memref_smem_bf16_17
      %iter_1909 = cute.get_iter(%view_1907) : !memref_smem_bf16_17
      %coord_1910 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1911 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_1912 = cute.crd2idx(%coord_1910, %lay_1911) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
      %iter_1913 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_1914 = cute.add_offset(%iter_1913, %idx_1912) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1915 = cute.make_view(%ptr_1914) : !memref_rmem_bf16_9
      %iter_1916 = cute.get_iter(%view_1915) : !memref_rmem_bf16_9
      %iter_1917 = cute.get_iter(%view_1915) : !memref_rmem_bf16_9
      %lay_1918 = cute.get_layout(%view_1907) : !memref_smem_bf16_17
      %1055 = cute.get_shape(%lay_1918) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1919, %e1_1920, %e2_1921 = cute.get_leaves(%1055) : !cute.shape<"((8,1),4)">
      %lay_1922 = cute.get_layout(%view_1915) : !memref_rmem_bf16_9
      %1056 = cute.get_shape(%lay_1922) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1923, %e1_1924, %e2_1925 = cute.get_leaves(%1056) : !cute.shape<"((8,1),4)">
      %lay_1926 = cute.get_layout(%view_1907) : !memref_smem_bf16_17
      %shape_1927 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1928 = cute.make_layout() : !cute.layout<"1:0">
      %append_1929 = cute.append_to_rank<2> (%lay_1926, %lay_1928) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1930 = cute.make_view(%iter_1909, %append_1929) : !memref_smem_bf16_17
      %iter_1931 = cute.get_iter(%view_1930) : !memref_smem_bf16_17
      %lay_1932 = cute.get_layout(%view_1930) : !memref_smem_bf16_17
      %1057 = cute.get_shape(%lay_1932) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1933, %e1_1934, %e2_1935 = cute.get_leaves(%1057) : !cute.shape<"((8,1),4)">
      %iter_1936 = cute.get_iter(%view_1930) : !memref_smem_bf16_17
      %view_1937 = cute.make_view(%iter_1936) : !memref_smem_bf16_18
      %iter_1938 = cute.get_iter(%view_1937) : !memref_smem_bf16_18
      %iter_1939 = cute.get_iter(%view_1937) : !memref_smem_bf16_18
      %lay_1940 = cute.get_layout(%view_1915) : !memref_rmem_bf16_9
      %shape_1941 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1942 = cute.make_layout() : !cute.layout<"1:0">
      %append_1943 = cute.append_to_rank<2> (%lay_1940, %lay_1942) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1944 = cute.make_view(%iter_1917, %append_1943) : !memref_rmem_bf16_9
      %iter_1945 = cute.get_iter(%view_1944) : !memref_rmem_bf16_9
      %lay_1946 = cute.get_layout(%view_1944) : !memref_rmem_bf16_9
      %1058 = cute.get_shape(%lay_1946) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1947, %e1_1948, %e2_1949 = cute.get_leaves(%1058) : !cute.shape<"((8,1),4)">
      %iter_1950 = cute.get_iter(%view_1944) : !memref_rmem_bf16_9
      %view_1951 = cute.make_view(%iter_1950) : !memref_rmem_bf16_10
      %iter_1952 = cute.get_iter(%view_1951) : !memref_rmem_bf16_10
      %iter_1953 = cute.get_iter(%view_1951) : !memref_rmem_bf16_10
      %lay_1954 = cute.get_layout(%view_1937) : !memref_smem_bf16_18
      %1059 = cute.get_shape(%lay_1954) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1955, %e1_1956, %e2_1957 = cute.get_leaves(%1059) : !cute.shape<"((8,1),(4))">
      %lay_1958 = cute.get_layout(%view_1951) : !memref_rmem_bf16_10
      %1060 = cute.get_shape(%lay_1958) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1959, %e1_1960, %e2_1961 = cute.get_leaves(%1060) : !cute.shape<"((8,1),(4))">
      %lay_1962 = cute.get_layout(%view_1937) : !memref_smem_bf16_18
      %sz_1963 = cute.size(%lay_1962) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1964 = cute.get_leaves(%sz_1963) : !cute.int_tuple<"4">
      %lay_1965 = cute.get_layout(%view_1951) : !memref_rmem_bf16_10
      %sz_1966 = cute.size(%lay_1965) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1967 = cute.get_leaves(%sz_1966) : !cute.int_tuple<"4">
      %1061 = cute.static : !cute.layout<"1:0">
      %iter_1968 = cute.get_iter(%view_1937) : !memref_smem_bf16_18
      %iter_1969 = cute.get_iter(%view_1951) : !memref_rmem_bf16_10
      %lay_1970 = cute.get_layout(%view_1937) : !memref_smem_bf16_18
      %lay_1971 = cute.get_layout(%view_1951) : !memref_rmem_bf16_10
      %append_1972 = cute.append_to_rank<2> (%lay_1970, %1061) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1973 = cute.append_to_rank<2> (%lay_1971, %1061) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1974 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1975 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1976 = cute.size(%lay_1974) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1062 = cute.get_scalars(%sz_1976) : !cute.int_tuple<"4">
      %c0_i32_1977 = arith.constant 0 : i32
      %c1_i32_1978 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1977 to %1062 step %c1_i32_1978  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_1974) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_1968, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_1975) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_1969, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1979 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1980 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_1981 = cute.crd2idx(%coord_1979, %lay_1980) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
      %iter_1982 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_1983 = cute.add_offset(%iter_1982, %idx_1981) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1984 = cute.make_view(%ptr_1983) : !memref_rmem_bf16_12
      %iter_1985 = cute.get_iter(%view_1984) : !memref_rmem_bf16_12
      %iter_1986 = cute.get_iter(%view_1984) : !memref_rmem_bf16_12
      %coord_1987 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1988 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_1989 = cute.crd2idx(%coord_1987, %lay_1988) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
      %iter_1990 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_1991 = cute.add_offset(%iter_1990, %idx_1989) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1992 = cute.make_view(%ptr_1991) : !memref_rmem_bf16_13
      %iter_1993 = cute.get_iter(%view_1992) : !memref_rmem_bf16_13
      %iter_1994 = cute.get_iter(%view_1992) : !memref_rmem_bf16_13
      %lay_1995 = cute.get_layout(%view_1984) : !memref_rmem_bf16_12
      %1063 = cute.get_shape(%lay_1995) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1996, %e1_1997, %e2_1998, %e3_1999 = cute.get_leaves(%1063) : !cute.shape<"((2,2,2),2)">
      %lay_2000 = cute.get_layout(%view_1992) : !memref_rmem_bf16_13
      %1064 = cute.get_shape(%lay_2000) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2001, %e1_2002, %e2_2003 = cute.get_leaves(%1064) : !cute.shape<"((2,2),8)">
      %iter_2004 = cute.get_iter(%view_1984) : !memref_rmem_bf16_12
      %iter_2005 = cute.get_iter(%view_1992) : !memref_rmem_bf16_13
      %iter_2006 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2007 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2008 = cute.get_layout(%view_1984) : !memref_rmem_bf16_12
      %lay_2009 = cute.get_layout(%view_1992) : !memref_rmem_bf16_13
      %lay_2010 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2011 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1065 = cute.static : !cute.layout<"1:0">
      %append_2012 = cute.append_to_rank<3> (%lay_2008, %1065) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2013 = cute.append_to_rank<3> (%lay_2009, %1065) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2014 = cute.size(%append_2012) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2015 = cute.size(%append_2012) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2016 = cute.size(%append_2013) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1066 = cute.get_scalars(%sz_2014) : !cute.int_tuple<"1">
      %1067 = cute.get_scalars(%sz_2015) : !cute.int_tuple<"2">
      %1068 = cute.get_scalars(%sz_2016) : !cute.int_tuple<"8">
      %c0_i32_2017 = arith.constant 0 : i32
      %c1_i32_2018 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2017 to %1066 step %c1_i32_2018  : i32 {
        scf.for %arg6 = %c0_i32_2017 to %1067 step %c1_i32_2018  : i32 {
          scf.for %arg7 = %c0_i32_2017 to %1068 step %c1_i32_2018  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2012) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2004, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2013) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2005, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2010) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2006, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2011) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2007, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2019 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2020 = cute.size(%int_tuple_2019) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2021 = cute.get_leaves(%sz_2020) : !cute.int_tuple<"8">
      %coord_2022 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2023 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_2024 = cute.crd2idx(%coord_2022, %lay_2023) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2025 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_2026 = cute.add_offset(%iter_2025, %idx_2024) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2027 = cute.make_view(%ptr_2026) : !memref_smem_bf16_14
      %iter_2028 = cute.get_iter(%view_2027) : !memref_smem_bf16_14
      %iter_2029 = cute.get_iter(%view_2027) : !memref_smem_bf16_14
      %coord_2030 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2031 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_2032 = cute.crd2idx(%coord_2030, %lay_2031) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
      %iter_2033 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_2034 = cute.add_offset(%iter_2033, %idx_2032) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2035 = cute.make_view(%ptr_2034) : !memref_rmem_bf16_6
      %iter_2036 = cute.get_iter(%view_2035) : !memref_rmem_bf16_6
      %iter_2037 = cute.get_iter(%view_2035) : !memref_rmem_bf16_6
      %lay_2038 = cute.get_layout(%view_2027) : !memref_smem_bf16_14
      %1069 = cute.get_shape(%lay_2038) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2039, %e1_2040, %e2_2041 = cute.get_leaves(%1069) : !cute.shape<"((8,1),2)">
      %lay_2042 = cute.get_layout(%view_2035) : !memref_rmem_bf16_6
      %1070 = cute.get_shape(%lay_2042) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2043, %e1_2044, %e2_2045 = cute.get_leaves(%1070) : !cute.shape<"((8,1),2)">
      %lay_2046 = cute.get_layout(%view_2027) : !memref_smem_bf16_14
      %shape_2047 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2048 = cute.make_layout() : !cute.layout<"1:0">
      %append_2049 = cute.append_to_rank<2> (%lay_2046, %lay_2048) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2050 = cute.make_view(%iter_2029, %append_2049) : !memref_smem_bf16_14
      %iter_2051 = cute.get_iter(%view_2050) : !memref_smem_bf16_14
      %lay_2052 = cute.get_layout(%view_2050) : !memref_smem_bf16_14
      %1071 = cute.get_shape(%lay_2052) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2053, %e1_2054, %e2_2055 = cute.get_leaves(%1071) : !cute.shape<"((8,1),2)">
      %iter_2056 = cute.get_iter(%view_2050) : !memref_smem_bf16_14
      %view_2057 = cute.make_view(%iter_2056) : !memref_smem_bf16_15
      %iter_2058 = cute.get_iter(%view_2057) : !memref_smem_bf16_15
      %iter_2059 = cute.get_iter(%view_2057) : !memref_smem_bf16_15
      %lay_2060 = cute.get_layout(%view_2035) : !memref_rmem_bf16_6
      %shape_2061 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2062 = cute.make_layout() : !cute.layout<"1:0">
      %append_2063 = cute.append_to_rank<2> (%lay_2060, %lay_2062) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2064 = cute.make_view(%iter_2037, %append_2063) : !memref_rmem_bf16_6
      %iter_2065 = cute.get_iter(%view_2064) : !memref_rmem_bf16_6
      %lay_2066 = cute.get_layout(%view_2064) : !memref_rmem_bf16_6
      %1072 = cute.get_shape(%lay_2066) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2067, %e1_2068, %e2_2069 = cute.get_leaves(%1072) : !cute.shape<"((8,1),2)">
      %iter_2070 = cute.get_iter(%view_2064) : !memref_rmem_bf16_6
      %view_2071 = cute.make_view(%iter_2070) : !memref_rmem_bf16_7
      %iter_2072 = cute.get_iter(%view_2071) : !memref_rmem_bf16_7
      %iter_2073 = cute.get_iter(%view_2071) : !memref_rmem_bf16_7
      %lay_2074 = cute.get_layout(%view_2057) : !memref_smem_bf16_15
      %1073 = cute.get_shape(%lay_2074) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2075, %e1_2076, %e2_2077 = cute.get_leaves(%1073) : !cute.shape<"((8,1),(2))">
      %lay_2078 = cute.get_layout(%view_2071) : !memref_rmem_bf16_7
      %1074 = cute.get_shape(%lay_2078) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2079, %e1_2080, %e2_2081 = cute.get_leaves(%1074) : !cute.shape<"((8,1),(2))">
      %lay_2082 = cute.get_layout(%view_2057) : !memref_smem_bf16_15
      %sz_2083 = cute.size(%lay_2082) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2084 = cute.get_leaves(%sz_2083) : !cute.int_tuple<"2">
      %lay_2085 = cute.get_layout(%view_2071) : !memref_rmem_bf16_7
      %sz_2086 = cute.size(%lay_2085) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2087 = cute.get_leaves(%sz_2086) : !cute.int_tuple<"2">
      %1075 = cute.static : !cute.layout<"1:0">
      %iter_2088 = cute.get_iter(%view_2057) : !memref_smem_bf16_15
      %iter_2089 = cute.get_iter(%view_2071) : !memref_rmem_bf16_7
      %lay_2090 = cute.get_layout(%view_2057) : !memref_smem_bf16_15
      %lay_2091 = cute.get_layout(%view_2071) : !memref_rmem_bf16_7
      %append_2092 = cute.append_to_rank<2> (%lay_2090, %1075) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2093 = cute.append_to_rank<2> (%lay_2091, %1075) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2094 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2095 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2096 = cute.size(%lay_2094) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1076 = cute.get_scalars(%sz_2096) : !cute.int_tuple<"2">
      %c0_i32_2097 = arith.constant 0 : i32
      %c1_i32_2098 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2097 to %1076 step %c1_i32_2098  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2094) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_2088, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2095) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2089, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2099 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2100 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_2101 = cute.crd2idx(%coord_2099, %lay_2100) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2102 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_2103 = cute.add_offset(%iter_2102, %idx_2101) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2104 = cute.make_view(%ptr_2103) : !memref_smem_bf16_17
      %iter_2105 = cute.get_iter(%view_2104) : !memref_smem_bf16_17
      %iter_2106 = cute.get_iter(%view_2104) : !memref_smem_bf16_17
      %coord_2107 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2108 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_2109 = cute.crd2idx(%coord_2107, %lay_2108) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
      %iter_2110 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_2111 = cute.add_offset(%iter_2110, %idx_2109) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2112 = cute.make_view(%ptr_2111) : !memref_rmem_bf16_9
      %iter_2113 = cute.get_iter(%view_2112) : !memref_rmem_bf16_9
      %iter_2114 = cute.get_iter(%view_2112) : !memref_rmem_bf16_9
      %lay_2115 = cute.get_layout(%view_2104) : !memref_smem_bf16_17
      %1077 = cute.get_shape(%lay_2115) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2116, %e1_2117, %e2_2118 = cute.get_leaves(%1077) : !cute.shape<"((8,1),4)">
      %lay_2119 = cute.get_layout(%view_2112) : !memref_rmem_bf16_9
      %1078 = cute.get_shape(%lay_2119) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2120, %e1_2121, %e2_2122 = cute.get_leaves(%1078) : !cute.shape<"((8,1),4)">
      %lay_2123 = cute.get_layout(%view_2104) : !memref_smem_bf16_17
      %shape_2124 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2125 = cute.make_layout() : !cute.layout<"1:0">
      %append_2126 = cute.append_to_rank<2> (%lay_2123, %lay_2125) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2127 = cute.make_view(%iter_2106, %append_2126) : !memref_smem_bf16_17
      %iter_2128 = cute.get_iter(%view_2127) : !memref_smem_bf16_17
      %lay_2129 = cute.get_layout(%view_2127) : !memref_smem_bf16_17
      %1079 = cute.get_shape(%lay_2129) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2130, %e1_2131, %e2_2132 = cute.get_leaves(%1079) : !cute.shape<"((8,1),4)">
      %iter_2133 = cute.get_iter(%view_2127) : !memref_smem_bf16_17
      %view_2134 = cute.make_view(%iter_2133) : !memref_smem_bf16_18
      %iter_2135 = cute.get_iter(%view_2134) : !memref_smem_bf16_18
      %iter_2136 = cute.get_iter(%view_2134) : !memref_smem_bf16_18
      %lay_2137 = cute.get_layout(%view_2112) : !memref_rmem_bf16_9
      %shape_2138 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2139 = cute.make_layout() : !cute.layout<"1:0">
      %append_2140 = cute.append_to_rank<2> (%lay_2137, %lay_2139) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2141 = cute.make_view(%iter_2114, %append_2140) : !memref_rmem_bf16_9
      %iter_2142 = cute.get_iter(%view_2141) : !memref_rmem_bf16_9
      %lay_2143 = cute.get_layout(%view_2141) : !memref_rmem_bf16_9
      %1080 = cute.get_shape(%lay_2143) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2144, %e1_2145, %e2_2146 = cute.get_leaves(%1080) : !cute.shape<"((8,1),4)">
      %iter_2147 = cute.get_iter(%view_2141) : !memref_rmem_bf16_9
      %view_2148 = cute.make_view(%iter_2147) : !memref_rmem_bf16_10
      %iter_2149 = cute.get_iter(%view_2148) : !memref_rmem_bf16_10
      %iter_2150 = cute.get_iter(%view_2148) : !memref_rmem_bf16_10
      %lay_2151 = cute.get_layout(%view_2134) : !memref_smem_bf16_18
      %1081 = cute.get_shape(%lay_2151) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2152, %e1_2153, %e2_2154 = cute.get_leaves(%1081) : !cute.shape<"((8,1),(4))">
      %lay_2155 = cute.get_layout(%view_2148) : !memref_rmem_bf16_10
      %1082 = cute.get_shape(%lay_2155) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2156, %e1_2157, %e2_2158 = cute.get_leaves(%1082) : !cute.shape<"((8,1),(4))">
      %lay_2159 = cute.get_layout(%view_2134) : !memref_smem_bf16_18
      %sz_2160 = cute.size(%lay_2159) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2161 = cute.get_leaves(%sz_2160) : !cute.int_tuple<"4">
      %lay_2162 = cute.get_layout(%view_2148) : !memref_rmem_bf16_10
      %sz_2163 = cute.size(%lay_2162) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2164 = cute.get_leaves(%sz_2163) : !cute.int_tuple<"4">
      %1083 = cute.static : !cute.layout<"1:0">
      %iter_2165 = cute.get_iter(%view_2134) : !memref_smem_bf16_18
      %iter_2166 = cute.get_iter(%view_2148) : !memref_rmem_bf16_10
      %lay_2167 = cute.get_layout(%view_2134) : !memref_smem_bf16_18
      %lay_2168 = cute.get_layout(%view_2148) : !memref_rmem_bf16_10
      %append_2169 = cute.append_to_rank<2> (%lay_2167, %1083) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2170 = cute.append_to_rank<2> (%lay_2168, %1083) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2171 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2172 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2173 = cute.size(%lay_2171) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1084 = cute.get_scalars(%sz_2173) : !cute.int_tuple<"4">
      %c0_i32_2174 = arith.constant 0 : i32
      %c1_i32_2175 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2174 to %1084 step %c1_i32_2175  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2171) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_2165, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2172) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2166, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2176 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_2177 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2178 = cute.crd2idx(%coord_2176, %lay_2177) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
      %iter_2179 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2180 = cute.add_offset(%iter_2179, %idx_2178) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2181 = cute.make_view(%ptr_2180) : !memref_rmem_bf16_12
      %iter_2182 = cute.get_iter(%view_2181) : !memref_rmem_bf16_12
      %iter_2183 = cute.get_iter(%view_2181) : !memref_rmem_bf16_12
      %coord_2184 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_2185 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_2186 = cute.crd2idx(%coord_2184, %lay_2185) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
      %iter_2187 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_2188 = cute.add_offset(%iter_2187, %idx_2186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2189 = cute.make_view(%ptr_2188) : !memref_rmem_bf16_13
      %iter_2190 = cute.get_iter(%view_2189) : !memref_rmem_bf16_13
      %iter_2191 = cute.get_iter(%view_2189) : !memref_rmem_bf16_13
      %lay_2192 = cute.get_layout(%view_2181) : !memref_rmem_bf16_12
      %1085 = cute.get_shape(%lay_2192) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2193, %e1_2194, %e2_2195, %e3_2196 = cute.get_leaves(%1085) : !cute.shape<"((2,2,2),2)">
      %lay_2197 = cute.get_layout(%view_2189) : !memref_rmem_bf16_13
      %1086 = cute.get_shape(%lay_2197) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2198, %e1_2199, %e2_2200 = cute.get_leaves(%1086) : !cute.shape<"((2,2),8)">
      %iter_2201 = cute.get_iter(%view_2181) : !memref_rmem_bf16_12
      %iter_2202 = cute.get_iter(%view_2189) : !memref_rmem_bf16_13
      %iter_2203 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2204 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2205 = cute.get_layout(%view_2181) : !memref_rmem_bf16_12
      %lay_2206 = cute.get_layout(%view_2189) : !memref_rmem_bf16_13
      %lay_2207 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2208 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1087 = cute.static : !cute.layout<"1:0">
      %append_2209 = cute.append_to_rank<3> (%lay_2205, %1087) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2210 = cute.append_to_rank<3> (%lay_2206, %1087) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2211 = cute.size(%append_2209) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2212 = cute.size(%append_2209) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2213 = cute.size(%append_2210) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1088 = cute.get_scalars(%sz_2211) : !cute.int_tuple<"1">
      %1089 = cute.get_scalars(%sz_2212) : !cute.int_tuple<"2">
      %1090 = cute.get_scalars(%sz_2213) : !cute.int_tuple<"8">
      %c0_i32_2214 = arith.constant 0 : i32
      %c1_i32_2215 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2214 to %1088 step %c1_i32_2215  : i32 {
        scf.for %arg6 = %c0_i32_2214 to %1089 step %c1_i32_2215  : i32 {
          scf.for %arg7 = %c0_i32_2214 to %1090 step %c1_i32_2215  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2209) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2201, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2210) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2202, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2207) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2203, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2208) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2204, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2216 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2217 = cute.size(%int_tuple_2216) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2218 = cute.get_leaves(%sz_2217) : !cute.int_tuple<"8">
      %coord_2219 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2220 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_2221 = cute.crd2idx(%coord_2219, %lay_2220) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2222 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_2223 = cute.add_offset(%iter_2222, %idx_2221) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2224 = cute.make_view(%ptr_2223) : !memref_smem_bf16_14
      %iter_2225 = cute.get_iter(%view_2224) : !memref_smem_bf16_14
      %iter_2226 = cute.get_iter(%view_2224) : !memref_smem_bf16_14
      %coord_2227 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2228 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_2229 = cute.crd2idx(%coord_2227, %lay_2228) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
      %iter_2230 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_2231 = cute.add_offset(%iter_2230, %idx_2229) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2232 = cute.make_view(%ptr_2231) : !memref_rmem_bf16_6
      %iter_2233 = cute.get_iter(%view_2232) : !memref_rmem_bf16_6
      %iter_2234 = cute.get_iter(%view_2232) : !memref_rmem_bf16_6
      %lay_2235 = cute.get_layout(%view_2224) : !memref_smem_bf16_14
      %1091 = cute.get_shape(%lay_2235) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2236, %e1_2237, %e2_2238 = cute.get_leaves(%1091) : !cute.shape<"((8,1),2)">
      %lay_2239 = cute.get_layout(%view_2232) : !memref_rmem_bf16_6
      %1092 = cute.get_shape(%lay_2239) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2240, %e1_2241, %e2_2242 = cute.get_leaves(%1092) : !cute.shape<"((8,1),2)">
      %lay_2243 = cute.get_layout(%view_2224) : !memref_smem_bf16_14
      %shape_2244 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2245 = cute.make_layout() : !cute.layout<"1:0">
      %append_2246 = cute.append_to_rank<2> (%lay_2243, %lay_2245) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2247 = cute.make_view(%iter_2226, %append_2246) : !memref_smem_bf16_14
      %iter_2248 = cute.get_iter(%view_2247) : !memref_smem_bf16_14
      %lay_2249 = cute.get_layout(%view_2247) : !memref_smem_bf16_14
      %1093 = cute.get_shape(%lay_2249) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2250, %e1_2251, %e2_2252 = cute.get_leaves(%1093) : !cute.shape<"((8,1),2)">
      %iter_2253 = cute.get_iter(%view_2247) : !memref_smem_bf16_14
      %view_2254 = cute.make_view(%iter_2253) : !memref_smem_bf16_15
      %iter_2255 = cute.get_iter(%view_2254) : !memref_smem_bf16_15
      %iter_2256 = cute.get_iter(%view_2254) : !memref_smem_bf16_15
      %lay_2257 = cute.get_layout(%view_2232) : !memref_rmem_bf16_6
      %shape_2258 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2259 = cute.make_layout() : !cute.layout<"1:0">
      %append_2260 = cute.append_to_rank<2> (%lay_2257, %lay_2259) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2261 = cute.make_view(%iter_2234, %append_2260) : !memref_rmem_bf16_6
      %iter_2262 = cute.get_iter(%view_2261) : !memref_rmem_bf16_6
      %lay_2263 = cute.get_layout(%view_2261) : !memref_rmem_bf16_6
      %1094 = cute.get_shape(%lay_2263) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2264, %e1_2265, %e2_2266 = cute.get_leaves(%1094) : !cute.shape<"((8,1),2)">
      %iter_2267 = cute.get_iter(%view_2261) : !memref_rmem_bf16_6
      %view_2268 = cute.make_view(%iter_2267) : !memref_rmem_bf16_7
      %iter_2269 = cute.get_iter(%view_2268) : !memref_rmem_bf16_7
      %iter_2270 = cute.get_iter(%view_2268) : !memref_rmem_bf16_7
      %lay_2271 = cute.get_layout(%view_2254) : !memref_smem_bf16_15
      %1095 = cute.get_shape(%lay_2271) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2272, %e1_2273, %e2_2274 = cute.get_leaves(%1095) : !cute.shape<"((8,1),(2))">
      %lay_2275 = cute.get_layout(%view_2268) : !memref_rmem_bf16_7
      %1096 = cute.get_shape(%lay_2275) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2276, %e1_2277, %e2_2278 = cute.get_leaves(%1096) : !cute.shape<"((8,1),(2))">
      %lay_2279 = cute.get_layout(%view_2254) : !memref_smem_bf16_15
      %sz_2280 = cute.size(%lay_2279) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2281 = cute.get_leaves(%sz_2280) : !cute.int_tuple<"2">
      %lay_2282 = cute.get_layout(%view_2268) : !memref_rmem_bf16_7
      %sz_2283 = cute.size(%lay_2282) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2284 = cute.get_leaves(%sz_2283) : !cute.int_tuple<"2">
      %1097 = cute.static : !cute.layout<"1:0">
      %iter_2285 = cute.get_iter(%view_2254) : !memref_smem_bf16_15
      %iter_2286 = cute.get_iter(%view_2268) : !memref_rmem_bf16_7
      %lay_2287 = cute.get_layout(%view_2254) : !memref_smem_bf16_15
      %lay_2288 = cute.get_layout(%view_2268) : !memref_rmem_bf16_7
      %append_2289 = cute.append_to_rank<2> (%lay_2287, %1097) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2290 = cute.append_to_rank<2> (%lay_2288, %1097) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2291 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2292 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2293 = cute.size(%lay_2291) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1098 = cute.get_scalars(%sz_2293) : !cute.int_tuple<"2">
      %c0_i32_2294 = arith.constant 0 : i32
      %c1_i32_2295 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2294 to %1098 step %c1_i32_2295  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2291) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_2285, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2292) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2286, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2296 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2297 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_2298 = cute.crd2idx(%coord_2296, %lay_2297) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2299 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_2300 = cute.add_offset(%iter_2299, %idx_2298) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2301 = cute.make_view(%ptr_2300) : !memref_smem_bf16_17
      %iter_2302 = cute.get_iter(%view_2301) : !memref_smem_bf16_17
      %iter_2303 = cute.get_iter(%view_2301) : !memref_smem_bf16_17
      %coord_2304 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2305 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_2306 = cute.crd2idx(%coord_2304, %lay_2305) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
      %iter_2307 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_2308 = cute.add_offset(%iter_2307, %idx_2306) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2309 = cute.make_view(%ptr_2308) : !memref_rmem_bf16_9
      %iter_2310 = cute.get_iter(%view_2309) : !memref_rmem_bf16_9
      %iter_2311 = cute.get_iter(%view_2309) : !memref_rmem_bf16_9
      %lay_2312 = cute.get_layout(%view_2301) : !memref_smem_bf16_17
      %1099 = cute.get_shape(%lay_2312) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2313, %e1_2314, %e2_2315 = cute.get_leaves(%1099) : !cute.shape<"((8,1),4)">
      %lay_2316 = cute.get_layout(%view_2309) : !memref_rmem_bf16_9
      %1100 = cute.get_shape(%lay_2316) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2317, %e1_2318, %e2_2319 = cute.get_leaves(%1100) : !cute.shape<"((8,1),4)">
      %lay_2320 = cute.get_layout(%view_2301) : !memref_smem_bf16_17
      %shape_2321 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2322 = cute.make_layout() : !cute.layout<"1:0">
      %append_2323 = cute.append_to_rank<2> (%lay_2320, %lay_2322) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2324 = cute.make_view(%iter_2303, %append_2323) : !memref_smem_bf16_17
      %iter_2325 = cute.get_iter(%view_2324) : !memref_smem_bf16_17
      %lay_2326 = cute.get_layout(%view_2324) : !memref_smem_bf16_17
      %1101 = cute.get_shape(%lay_2326) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2327, %e1_2328, %e2_2329 = cute.get_leaves(%1101) : !cute.shape<"((8,1),4)">
      %iter_2330 = cute.get_iter(%view_2324) : !memref_smem_bf16_17
      %view_2331 = cute.make_view(%iter_2330) : !memref_smem_bf16_18
      %iter_2332 = cute.get_iter(%view_2331) : !memref_smem_bf16_18
      %iter_2333 = cute.get_iter(%view_2331) : !memref_smem_bf16_18
      %lay_2334 = cute.get_layout(%view_2309) : !memref_rmem_bf16_9
      %shape_2335 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2336 = cute.make_layout() : !cute.layout<"1:0">
      %append_2337 = cute.append_to_rank<2> (%lay_2334, %lay_2336) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2338 = cute.make_view(%iter_2311, %append_2337) : !memref_rmem_bf16_9
      %iter_2339 = cute.get_iter(%view_2338) : !memref_rmem_bf16_9
      %lay_2340 = cute.get_layout(%view_2338) : !memref_rmem_bf16_9
      %1102 = cute.get_shape(%lay_2340) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2341, %e1_2342, %e2_2343 = cute.get_leaves(%1102) : !cute.shape<"((8,1),4)">
      %iter_2344 = cute.get_iter(%view_2338) : !memref_rmem_bf16_9
      %view_2345 = cute.make_view(%iter_2344) : !memref_rmem_bf16_10
      %iter_2346 = cute.get_iter(%view_2345) : !memref_rmem_bf16_10
      %iter_2347 = cute.get_iter(%view_2345) : !memref_rmem_bf16_10
      %lay_2348 = cute.get_layout(%view_2331) : !memref_smem_bf16_18
      %1103 = cute.get_shape(%lay_2348) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2349, %e1_2350, %e2_2351 = cute.get_leaves(%1103) : !cute.shape<"((8,1),(4))">
      %lay_2352 = cute.get_layout(%view_2345) : !memref_rmem_bf16_10
      %1104 = cute.get_shape(%lay_2352) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2353, %e1_2354, %e2_2355 = cute.get_leaves(%1104) : !cute.shape<"((8,1),(4))">
      %lay_2356 = cute.get_layout(%view_2331) : !memref_smem_bf16_18
      %sz_2357 = cute.size(%lay_2356) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2358 = cute.get_leaves(%sz_2357) : !cute.int_tuple<"4">
      %lay_2359 = cute.get_layout(%view_2345) : !memref_rmem_bf16_10
      %sz_2360 = cute.size(%lay_2359) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2361 = cute.get_leaves(%sz_2360) : !cute.int_tuple<"4">
      %1105 = cute.static : !cute.layout<"1:0">
      %iter_2362 = cute.get_iter(%view_2331) : !memref_smem_bf16_18
      %iter_2363 = cute.get_iter(%view_2345) : !memref_rmem_bf16_10
      %lay_2364 = cute.get_layout(%view_2331) : !memref_smem_bf16_18
      %lay_2365 = cute.get_layout(%view_2345) : !memref_rmem_bf16_10
      %append_2366 = cute.append_to_rank<2> (%lay_2364, %1105) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2367 = cute.append_to_rank<2> (%lay_2365, %1105) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2368 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2369 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2370 = cute.size(%lay_2368) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1106 = cute.get_scalars(%sz_2370) : !cute.int_tuple<"4">
      %c0_i32_2371 = arith.constant 0 : i32
      %c1_i32_2372 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2371 to %1106 step %c1_i32_2372  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2368) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_2362, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2369) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2363, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2373 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2374 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2375 = cute.crd2idx(%coord_2373, %lay_2374) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
      %iter_2376 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2377 = cute.add_offset(%iter_2376, %idx_2375) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2378 = cute.make_view(%ptr_2377) : !memref_rmem_bf16_12
      %iter_2379 = cute.get_iter(%view_2378) : !memref_rmem_bf16_12
      %iter_2380 = cute.get_iter(%view_2378) : !memref_rmem_bf16_12
      %coord_2381 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_2382 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_2383 = cute.crd2idx(%coord_2381, %lay_2382) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
      %iter_2384 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_2385 = cute.add_offset(%iter_2384, %idx_2383) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2386 = cute.make_view(%ptr_2385) : !memref_rmem_bf16_13
      %iter_2387 = cute.get_iter(%view_2386) : !memref_rmem_bf16_13
      %iter_2388 = cute.get_iter(%view_2386) : !memref_rmem_bf16_13
      %lay_2389 = cute.get_layout(%view_2378) : !memref_rmem_bf16_12
      %1107 = cute.get_shape(%lay_2389) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2390, %e1_2391, %e2_2392, %e3_2393 = cute.get_leaves(%1107) : !cute.shape<"((2,2,2),2)">
      %lay_2394 = cute.get_layout(%view_2386) : !memref_rmem_bf16_13
      %1108 = cute.get_shape(%lay_2394) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2395, %e1_2396, %e2_2397 = cute.get_leaves(%1108) : !cute.shape<"((2,2),8)">
      %iter_2398 = cute.get_iter(%view_2378) : !memref_rmem_bf16_12
      %iter_2399 = cute.get_iter(%view_2386) : !memref_rmem_bf16_13
      %iter_2400 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2401 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2402 = cute.get_layout(%view_2378) : !memref_rmem_bf16_12
      %lay_2403 = cute.get_layout(%view_2386) : !memref_rmem_bf16_13
      %lay_2404 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2405 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1109 = cute.static : !cute.layout<"1:0">
      %append_2406 = cute.append_to_rank<3> (%lay_2402, %1109) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2407 = cute.append_to_rank<3> (%lay_2403, %1109) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2408 = cute.size(%append_2406) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2409 = cute.size(%append_2406) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2410 = cute.size(%append_2407) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1110 = cute.get_scalars(%sz_2408) : !cute.int_tuple<"1">
      %1111 = cute.get_scalars(%sz_2409) : !cute.int_tuple<"2">
      %1112 = cute.get_scalars(%sz_2410) : !cute.int_tuple<"8">
      %c0_i32_2411 = arith.constant 0 : i32
      %c1_i32_2412 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2411 to %1110 step %c1_i32_2412  : i32 {
        scf.for %arg6 = %c0_i32_2411 to %1111 step %c1_i32_2412  : i32 {
          scf.for %arg7 = %c0_i32_2411 to %1112 step %c1_i32_2412  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2406) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2398, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2407) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2399, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2404) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2400, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2405) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2401, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2413 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2414 = cute.size(%int_tuple_2413) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2415 = cute.get_leaves(%sz_2414) : !cute.int_tuple<"8">
      %coord_2416 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2417 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_2418 = cute.crd2idx(%coord_2416, %lay_2417) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
      %iter_2419 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_2420 = cute.add_offset(%iter_2419, %idx_2418) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2421 = cute.make_view(%ptr_2420) : !memref_smem_bf16_14
      %iter_2422 = cute.get_iter(%view_2421) : !memref_smem_bf16_14
      %iter_2423 = cute.get_iter(%view_2421) : !memref_smem_bf16_14
      %coord_2424 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2425 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_2426 = cute.crd2idx(%coord_2424, %lay_2425) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
      %iter_2427 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_2428 = cute.add_offset(%iter_2427, %idx_2426) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2429 = cute.make_view(%ptr_2428) : !memref_rmem_bf16_6
      %iter_2430 = cute.get_iter(%view_2429) : !memref_rmem_bf16_6
      %iter_2431 = cute.get_iter(%view_2429) : !memref_rmem_bf16_6
      %lay_2432 = cute.get_layout(%view_2421) : !memref_smem_bf16_14
      %1113 = cute.get_shape(%lay_2432) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2433, %e1_2434, %e2_2435 = cute.get_leaves(%1113) : !cute.shape<"((8,1),2)">
      %lay_2436 = cute.get_layout(%view_2429) : !memref_rmem_bf16_6
      %1114 = cute.get_shape(%lay_2436) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2437, %e1_2438, %e2_2439 = cute.get_leaves(%1114) : !cute.shape<"((8,1),2)">
      %lay_2440 = cute.get_layout(%view_2421) : !memref_smem_bf16_14
      %shape_2441 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2442 = cute.make_layout() : !cute.layout<"1:0">
      %append_2443 = cute.append_to_rank<2> (%lay_2440, %lay_2442) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2444 = cute.make_view(%iter_2423, %append_2443) : !memref_smem_bf16_14
      %iter_2445 = cute.get_iter(%view_2444) : !memref_smem_bf16_14
      %lay_2446 = cute.get_layout(%view_2444) : !memref_smem_bf16_14
      %1115 = cute.get_shape(%lay_2446) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2447, %e1_2448, %e2_2449 = cute.get_leaves(%1115) : !cute.shape<"((8,1),2)">
      %iter_2450 = cute.get_iter(%view_2444) : !memref_smem_bf16_14
      %view_2451 = cute.make_view(%iter_2450) : !memref_smem_bf16_15
      %iter_2452 = cute.get_iter(%view_2451) : !memref_smem_bf16_15
      %iter_2453 = cute.get_iter(%view_2451) : !memref_smem_bf16_15
      %lay_2454 = cute.get_layout(%view_2429) : !memref_rmem_bf16_6
      %shape_2455 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2456 = cute.make_layout() : !cute.layout<"1:0">
      %append_2457 = cute.append_to_rank<2> (%lay_2454, %lay_2456) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2458 = cute.make_view(%iter_2431, %append_2457) : !memref_rmem_bf16_6
      %iter_2459 = cute.get_iter(%view_2458) : !memref_rmem_bf16_6
      %lay_2460 = cute.get_layout(%view_2458) : !memref_rmem_bf16_6
      %1116 = cute.get_shape(%lay_2460) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2461, %e1_2462, %e2_2463 = cute.get_leaves(%1116) : !cute.shape<"((8,1),2)">
      %iter_2464 = cute.get_iter(%view_2458) : !memref_rmem_bf16_6
      %view_2465 = cute.make_view(%iter_2464) : !memref_rmem_bf16_7
      %iter_2466 = cute.get_iter(%view_2465) : !memref_rmem_bf16_7
      %iter_2467 = cute.get_iter(%view_2465) : !memref_rmem_bf16_7
      %lay_2468 = cute.get_layout(%view_2451) : !memref_smem_bf16_15
      %1117 = cute.get_shape(%lay_2468) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2469, %e1_2470, %e2_2471 = cute.get_leaves(%1117) : !cute.shape<"((8,1),(2))">
      %lay_2472 = cute.get_layout(%view_2465) : !memref_rmem_bf16_7
      %1118 = cute.get_shape(%lay_2472) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2473, %e1_2474, %e2_2475 = cute.get_leaves(%1118) : !cute.shape<"((8,1),(2))">
      %lay_2476 = cute.get_layout(%view_2451) : !memref_smem_bf16_15
      %sz_2477 = cute.size(%lay_2476) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2478 = cute.get_leaves(%sz_2477) : !cute.int_tuple<"2">
      %lay_2479 = cute.get_layout(%view_2465) : !memref_rmem_bf16_7
      %sz_2480 = cute.size(%lay_2479) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2481 = cute.get_leaves(%sz_2480) : !cute.int_tuple<"2">
      %1119 = cute.static : !cute.layout<"1:0">
      %iter_2482 = cute.get_iter(%view_2451) : !memref_smem_bf16_15
      %iter_2483 = cute.get_iter(%view_2465) : !memref_rmem_bf16_7
      %lay_2484 = cute.get_layout(%view_2451) : !memref_smem_bf16_15
      %lay_2485 = cute.get_layout(%view_2465) : !memref_rmem_bf16_7
      %append_2486 = cute.append_to_rank<2> (%lay_2484, %1119) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2487 = cute.append_to_rank<2> (%lay_2485, %1119) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2488 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2489 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2490 = cute.size(%lay_2488) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1120 = cute.get_scalars(%sz_2490) : !cute.int_tuple<"2">
      %c0_i32_2491 = arith.constant 0 : i32
      %c1_i32_2492 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2491 to %1120 step %c1_i32_2492  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2488) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_2482, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2489) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2483, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2493 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2494 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_2495 = cute.crd2idx(%coord_2493, %lay_2494) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
      %iter_2496 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_2497 = cute.add_offset(%iter_2496, %idx_2495) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2498 = cute.make_view(%ptr_2497) : !memref_smem_bf16_17
      %iter_2499 = cute.get_iter(%view_2498) : !memref_smem_bf16_17
      %iter_2500 = cute.get_iter(%view_2498) : !memref_smem_bf16_17
      %coord_2501 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2502 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_2503 = cute.crd2idx(%coord_2501, %lay_2502) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
      %iter_2504 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_2505 = cute.add_offset(%iter_2504, %idx_2503) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2506 = cute.make_view(%ptr_2505) : !memref_rmem_bf16_9
      %iter_2507 = cute.get_iter(%view_2506) : !memref_rmem_bf16_9
      %iter_2508 = cute.get_iter(%view_2506) : !memref_rmem_bf16_9
      %lay_2509 = cute.get_layout(%view_2498) : !memref_smem_bf16_17
      %1121 = cute.get_shape(%lay_2509) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2510, %e1_2511, %e2_2512 = cute.get_leaves(%1121) : !cute.shape<"((8,1),4)">
      %lay_2513 = cute.get_layout(%view_2506) : !memref_rmem_bf16_9
      %1122 = cute.get_shape(%lay_2513) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2514, %e1_2515, %e2_2516 = cute.get_leaves(%1122) : !cute.shape<"((8,1),4)">
      %lay_2517 = cute.get_layout(%view_2498) : !memref_smem_bf16_17
      %shape_2518 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2519 = cute.make_layout() : !cute.layout<"1:0">
      %append_2520 = cute.append_to_rank<2> (%lay_2517, %lay_2519) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2521 = cute.make_view(%iter_2500, %append_2520) : !memref_smem_bf16_17
      %iter_2522 = cute.get_iter(%view_2521) : !memref_smem_bf16_17
      %lay_2523 = cute.get_layout(%view_2521) : !memref_smem_bf16_17
      %1123 = cute.get_shape(%lay_2523) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2524, %e1_2525, %e2_2526 = cute.get_leaves(%1123) : !cute.shape<"((8,1),4)">
      %iter_2527 = cute.get_iter(%view_2521) : !memref_smem_bf16_17
      %view_2528 = cute.make_view(%iter_2527) : !memref_smem_bf16_18
      %iter_2529 = cute.get_iter(%view_2528) : !memref_smem_bf16_18
      %iter_2530 = cute.get_iter(%view_2528) : !memref_smem_bf16_18
      %lay_2531 = cute.get_layout(%view_2506) : !memref_rmem_bf16_9
      %shape_2532 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2533 = cute.make_layout() : !cute.layout<"1:0">
      %append_2534 = cute.append_to_rank<2> (%lay_2531, %lay_2533) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2535 = cute.make_view(%iter_2508, %append_2534) : !memref_rmem_bf16_9
      %iter_2536 = cute.get_iter(%view_2535) : !memref_rmem_bf16_9
      %lay_2537 = cute.get_layout(%view_2535) : !memref_rmem_bf16_9
      %1124 = cute.get_shape(%lay_2537) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2538, %e1_2539, %e2_2540 = cute.get_leaves(%1124) : !cute.shape<"((8,1),4)">
      %iter_2541 = cute.get_iter(%view_2535) : !memref_rmem_bf16_9
      %view_2542 = cute.make_view(%iter_2541) : !memref_rmem_bf16_10
      %iter_2543 = cute.get_iter(%view_2542) : !memref_rmem_bf16_10
      %iter_2544 = cute.get_iter(%view_2542) : !memref_rmem_bf16_10
      %lay_2545 = cute.get_layout(%view_2528) : !memref_smem_bf16_18
      %1125 = cute.get_shape(%lay_2545) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2546, %e1_2547, %e2_2548 = cute.get_leaves(%1125) : !cute.shape<"((8,1),(4))">
      %lay_2549 = cute.get_layout(%view_2542) : !memref_rmem_bf16_10
      %1126 = cute.get_shape(%lay_2549) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2550, %e1_2551, %e2_2552 = cute.get_leaves(%1126) : !cute.shape<"((8,1),(4))">
      %lay_2553 = cute.get_layout(%view_2528) : !memref_smem_bf16_18
      %sz_2554 = cute.size(%lay_2553) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2555 = cute.get_leaves(%sz_2554) : !cute.int_tuple<"4">
      %lay_2556 = cute.get_layout(%view_2542) : !memref_rmem_bf16_10
      %sz_2557 = cute.size(%lay_2556) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2558 = cute.get_leaves(%sz_2557) : !cute.int_tuple<"4">
      %1127 = cute.static : !cute.layout<"1:0">
      %iter_2559 = cute.get_iter(%view_2528) : !memref_smem_bf16_18
      %iter_2560 = cute.get_iter(%view_2542) : !memref_rmem_bf16_10
      %lay_2561 = cute.get_layout(%view_2528) : !memref_smem_bf16_18
      %lay_2562 = cute.get_layout(%view_2542) : !memref_rmem_bf16_10
      %append_2563 = cute.append_to_rank<2> (%lay_2561, %1127) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2564 = cute.append_to_rank<2> (%lay_2562, %1127) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2565 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2566 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2567 = cute.size(%lay_2565) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1128 = cute.get_scalars(%sz_2567) : !cute.int_tuple<"4">
      %c0_i32_2568 = arith.constant 0 : i32
      %c1_i32_2569 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2568 to %1128 step %c1_i32_2569  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2565) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_2559, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2566) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2560, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2570 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2571 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2572 = cute.crd2idx(%coord_2570, %lay_2571) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
      %iter_2573 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2574 = cute.add_offset(%iter_2573, %idx_2572) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2575 = cute.make_view(%ptr_2574) : !memref_rmem_bf16_12
      %iter_2576 = cute.get_iter(%view_2575) : !memref_rmem_bf16_12
      %iter_2577 = cute.get_iter(%view_2575) : !memref_rmem_bf16_12
      %coord_2578 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2579 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_2580 = cute.crd2idx(%coord_2578, %lay_2579) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
      %iter_2581 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_2582 = cute.add_offset(%iter_2581, %idx_2580) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2583 = cute.make_view(%ptr_2582) : !memref_rmem_bf16_13
      %iter_2584 = cute.get_iter(%view_2583) : !memref_rmem_bf16_13
      %iter_2585 = cute.get_iter(%view_2583) : !memref_rmem_bf16_13
      %lay_2586 = cute.get_layout(%view_2575) : !memref_rmem_bf16_12
      %1129 = cute.get_shape(%lay_2586) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2587, %e1_2588, %e2_2589, %e3_2590 = cute.get_leaves(%1129) : !cute.shape<"((2,2,2),2)">
      %lay_2591 = cute.get_layout(%view_2583) : !memref_rmem_bf16_13
      %1130 = cute.get_shape(%lay_2591) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2592, %e1_2593, %e2_2594 = cute.get_leaves(%1130) : !cute.shape<"((2,2),8)">
      %iter_2595 = cute.get_iter(%view_2575) : !memref_rmem_bf16_12
      %iter_2596 = cute.get_iter(%view_2583) : !memref_rmem_bf16_13
      %iter_2597 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2598 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2599 = cute.get_layout(%view_2575) : !memref_rmem_bf16_12
      %lay_2600 = cute.get_layout(%view_2583) : !memref_rmem_bf16_13
      %lay_2601 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2602 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1131 = cute.static : !cute.layout<"1:0">
      %append_2603 = cute.append_to_rank<3> (%lay_2599, %1131) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2604 = cute.append_to_rank<3> (%lay_2600, %1131) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2605 = cute.size(%append_2603) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2606 = cute.size(%append_2603) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2607 = cute.size(%append_2604) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1132 = cute.get_scalars(%sz_2605) : !cute.int_tuple<"1">
      %1133 = cute.get_scalars(%sz_2606) : !cute.int_tuple<"2">
      %1134 = cute.get_scalars(%sz_2607) : !cute.int_tuple<"8">
      %c0_i32_2608 = arith.constant 0 : i32
      %c1_i32_2609 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2608 to %1132 step %c1_i32_2609  : i32 {
        scf.for %arg6 = %c0_i32_2608 to %1133 step %c1_i32_2609  : i32 {
          scf.for %arg7 = %c0_i32_2608 to %1134 step %c1_i32_2609  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2603) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2595, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2604) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2596, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2601) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2597, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2602) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2598, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2610 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2611 = cute.size(%int_tuple_2610) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2612 = cute.get_leaves(%sz_2611) : !cute.int_tuple<"8">
      %coord_2613 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2614 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_2615 = cute.crd2idx(%coord_2613, %lay_2614) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2616 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_2617 = cute.add_offset(%iter_2616, %idx_2615) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2618 = cute.make_view(%ptr_2617) : !memref_smem_bf16_14
      %iter_2619 = cute.get_iter(%view_2618) : !memref_smem_bf16_14
      %iter_2620 = cute.get_iter(%view_2618) : !memref_smem_bf16_14
      %coord_2621 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2622 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_2623 = cute.crd2idx(%coord_2621, %lay_2622) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
      %iter_2624 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_2625 = cute.add_offset(%iter_2624, %idx_2623) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2626 = cute.make_view(%ptr_2625) : !memref_rmem_bf16_6
      %iter_2627 = cute.get_iter(%view_2626) : !memref_rmem_bf16_6
      %iter_2628 = cute.get_iter(%view_2626) : !memref_rmem_bf16_6
      %lay_2629 = cute.get_layout(%view_2618) : !memref_smem_bf16_14
      %1135 = cute.get_shape(%lay_2629) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2630, %e1_2631, %e2_2632 = cute.get_leaves(%1135) : !cute.shape<"((8,1),2)">
      %lay_2633 = cute.get_layout(%view_2626) : !memref_rmem_bf16_6
      %1136 = cute.get_shape(%lay_2633) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2634, %e1_2635, %e2_2636 = cute.get_leaves(%1136) : !cute.shape<"((8,1),2)">
      %lay_2637 = cute.get_layout(%view_2618) : !memref_smem_bf16_14
      %shape_2638 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2639 = cute.make_layout() : !cute.layout<"1:0">
      %append_2640 = cute.append_to_rank<2> (%lay_2637, %lay_2639) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2641 = cute.make_view(%iter_2620, %append_2640) : !memref_smem_bf16_14
      %iter_2642 = cute.get_iter(%view_2641) : !memref_smem_bf16_14
      %lay_2643 = cute.get_layout(%view_2641) : !memref_smem_bf16_14
      %1137 = cute.get_shape(%lay_2643) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2644, %e1_2645, %e2_2646 = cute.get_leaves(%1137) : !cute.shape<"((8,1),2)">
      %iter_2647 = cute.get_iter(%view_2641) : !memref_smem_bf16_14
      %view_2648 = cute.make_view(%iter_2647) : !memref_smem_bf16_15
      %iter_2649 = cute.get_iter(%view_2648) : !memref_smem_bf16_15
      %iter_2650 = cute.get_iter(%view_2648) : !memref_smem_bf16_15
      %lay_2651 = cute.get_layout(%view_2626) : !memref_rmem_bf16_6
      %shape_2652 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2653 = cute.make_layout() : !cute.layout<"1:0">
      %append_2654 = cute.append_to_rank<2> (%lay_2651, %lay_2653) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2655 = cute.make_view(%iter_2628, %append_2654) : !memref_rmem_bf16_6
      %iter_2656 = cute.get_iter(%view_2655) : !memref_rmem_bf16_6
      %lay_2657 = cute.get_layout(%view_2655) : !memref_rmem_bf16_6
      %1138 = cute.get_shape(%lay_2657) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2658, %e1_2659, %e2_2660 = cute.get_leaves(%1138) : !cute.shape<"((8,1),2)">
      %iter_2661 = cute.get_iter(%view_2655) : !memref_rmem_bf16_6
      %view_2662 = cute.make_view(%iter_2661) : !memref_rmem_bf16_7
      %iter_2663 = cute.get_iter(%view_2662) : !memref_rmem_bf16_7
      %iter_2664 = cute.get_iter(%view_2662) : !memref_rmem_bf16_7
      %lay_2665 = cute.get_layout(%view_2648) : !memref_smem_bf16_15
      %1139 = cute.get_shape(%lay_2665) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2666, %e1_2667, %e2_2668 = cute.get_leaves(%1139) : !cute.shape<"((8,1),(2))">
      %lay_2669 = cute.get_layout(%view_2662) : !memref_rmem_bf16_7
      %1140 = cute.get_shape(%lay_2669) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2670, %e1_2671, %e2_2672 = cute.get_leaves(%1140) : !cute.shape<"((8,1),(2))">
      %lay_2673 = cute.get_layout(%view_2648) : !memref_smem_bf16_15
      %sz_2674 = cute.size(%lay_2673) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2675 = cute.get_leaves(%sz_2674) : !cute.int_tuple<"2">
      %lay_2676 = cute.get_layout(%view_2662) : !memref_rmem_bf16_7
      %sz_2677 = cute.size(%lay_2676) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2678 = cute.get_leaves(%sz_2677) : !cute.int_tuple<"2">
      %1141 = cute.static : !cute.layout<"1:0">
      %iter_2679 = cute.get_iter(%view_2648) : !memref_smem_bf16_15
      %iter_2680 = cute.get_iter(%view_2662) : !memref_rmem_bf16_7
      %lay_2681 = cute.get_layout(%view_2648) : !memref_smem_bf16_15
      %lay_2682 = cute.get_layout(%view_2662) : !memref_rmem_bf16_7
      %append_2683 = cute.append_to_rank<2> (%lay_2681, %1141) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2684 = cute.append_to_rank<2> (%lay_2682, %1141) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2685 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2686 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2687 = cute.size(%lay_2685) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1142 = cute.get_scalars(%sz_2687) : !cute.int_tuple<"2">
      %c0_i32_2688 = arith.constant 0 : i32
      %c1_i32_2689 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2688 to %1142 step %c1_i32_2689  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2685) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_2679, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2686) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2680, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2690 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2691 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_2692 = cute.crd2idx(%coord_2690, %lay_2691) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2693 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_2694 = cute.add_offset(%iter_2693, %idx_2692) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2695 = cute.make_view(%ptr_2694) : !memref_smem_bf16_17
      %iter_2696 = cute.get_iter(%view_2695) : !memref_smem_bf16_17
      %iter_2697 = cute.get_iter(%view_2695) : !memref_smem_bf16_17
      %coord_2698 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2699 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_2700 = cute.crd2idx(%coord_2698, %lay_2699) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
      %iter_2701 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_2702 = cute.add_offset(%iter_2701, %idx_2700) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2703 = cute.make_view(%ptr_2702) : !memref_rmem_bf16_9
      %iter_2704 = cute.get_iter(%view_2703) : !memref_rmem_bf16_9
      %iter_2705 = cute.get_iter(%view_2703) : !memref_rmem_bf16_9
      %lay_2706 = cute.get_layout(%view_2695) : !memref_smem_bf16_17
      %1143 = cute.get_shape(%lay_2706) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2707, %e1_2708, %e2_2709 = cute.get_leaves(%1143) : !cute.shape<"((8,1),4)">
      %lay_2710 = cute.get_layout(%view_2703) : !memref_rmem_bf16_9
      %1144 = cute.get_shape(%lay_2710) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2711, %e1_2712, %e2_2713 = cute.get_leaves(%1144) : !cute.shape<"((8,1),4)">
      %lay_2714 = cute.get_layout(%view_2695) : !memref_smem_bf16_17
      %shape_2715 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2716 = cute.make_layout() : !cute.layout<"1:0">
      %append_2717 = cute.append_to_rank<2> (%lay_2714, %lay_2716) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2718 = cute.make_view(%iter_2697, %append_2717) : !memref_smem_bf16_17
      %iter_2719 = cute.get_iter(%view_2718) : !memref_smem_bf16_17
      %lay_2720 = cute.get_layout(%view_2718) : !memref_smem_bf16_17
      %1145 = cute.get_shape(%lay_2720) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2721, %e1_2722, %e2_2723 = cute.get_leaves(%1145) : !cute.shape<"((8,1),4)">
      %iter_2724 = cute.get_iter(%view_2718) : !memref_smem_bf16_17
      %view_2725 = cute.make_view(%iter_2724) : !memref_smem_bf16_18
      %iter_2726 = cute.get_iter(%view_2725) : !memref_smem_bf16_18
      %iter_2727 = cute.get_iter(%view_2725) : !memref_smem_bf16_18
      %lay_2728 = cute.get_layout(%view_2703) : !memref_rmem_bf16_9
      %shape_2729 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2730 = cute.make_layout() : !cute.layout<"1:0">
      %append_2731 = cute.append_to_rank<2> (%lay_2728, %lay_2730) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2732 = cute.make_view(%iter_2705, %append_2731) : !memref_rmem_bf16_9
      %iter_2733 = cute.get_iter(%view_2732) : !memref_rmem_bf16_9
      %lay_2734 = cute.get_layout(%view_2732) : !memref_rmem_bf16_9
      %1146 = cute.get_shape(%lay_2734) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2735, %e1_2736, %e2_2737 = cute.get_leaves(%1146) : !cute.shape<"((8,1),4)">
      %iter_2738 = cute.get_iter(%view_2732) : !memref_rmem_bf16_9
      %view_2739 = cute.make_view(%iter_2738) : !memref_rmem_bf16_10
      %iter_2740 = cute.get_iter(%view_2739) : !memref_rmem_bf16_10
      %iter_2741 = cute.get_iter(%view_2739) : !memref_rmem_bf16_10
      %lay_2742 = cute.get_layout(%view_2725) : !memref_smem_bf16_18
      %1147 = cute.get_shape(%lay_2742) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2743, %e1_2744, %e2_2745 = cute.get_leaves(%1147) : !cute.shape<"((8,1),(4))">
      %lay_2746 = cute.get_layout(%view_2739) : !memref_rmem_bf16_10
      %1148 = cute.get_shape(%lay_2746) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2747, %e1_2748, %e2_2749 = cute.get_leaves(%1148) : !cute.shape<"((8,1),(4))">
      %lay_2750 = cute.get_layout(%view_2725) : !memref_smem_bf16_18
      %sz_2751 = cute.size(%lay_2750) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2752 = cute.get_leaves(%sz_2751) : !cute.int_tuple<"4">
      %lay_2753 = cute.get_layout(%view_2739) : !memref_rmem_bf16_10
      %sz_2754 = cute.size(%lay_2753) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2755 = cute.get_leaves(%sz_2754) : !cute.int_tuple<"4">
      %1149 = cute.static : !cute.layout<"1:0">
      %iter_2756 = cute.get_iter(%view_2725) : !memref_smem_bf16_18
      %iter_2757 = cute.get_iter(%view_2739) : !memref_rmem_bf16_10
      %lay_2758 = cute.get_layout(%view_2725) : !memref_smem_bf16_18
      %lay_2759 = cute.get_layout(%view_2739) : !memref_rmem_bf16_10
      %append_2760 = cute.append_to_rank<2> (%lay_2758, %1149) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2761 = cute.append_to_rank<2> (%lay_2759, %1149) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2762 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2763 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2764 = cute.size(%lay_2762) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1150 = cute.get_scalars(%sz_2764) : !cute.int_tuple<"4">
      %c0_i32_2765 = arith.constant 0 : i32
      %c1_i32_2766 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2765 to %1150 step %c1_i32_2766  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2762) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_2756, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2763) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2757, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2767 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2768 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2769 = cute.crd2idx(%coord_2767, %lay_2768) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
      %iter_2770 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2771 = cute.add_offset(%iter_2770, %idx_2769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2772 = cute.make_view(%ptr_2771) : !memref_rmem_bf16_12
      %iter_2773 = cute.get_iter(%view_2772) : !memref_rmem_bf16_12
      %iter_2774 = cute.get_iter(%view_2772) : !memref_rmem_bf16_12
      %coord_2775 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2776 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_2777 = cute.crd2idx(%coord_2775, %lay_2776) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
      %iter_2778 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_2779 = cute.add_offset(%iter_2778, %idx_2777) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2780 = cute.make_view(%ptr_2779) : !memref_rmem_bf16_13
      %iter_2781 = cute.get_iter(%view_2780) : !memref_rmem_bf16_13
      %iter_2782 = cute.get_iter(%view_2780) : !memref_rmem_bf16_13
      %lay_2783 = cute.get_layout(%view_2772) : !memref_rmem_bf16_12
      %1151 = cute.get_shape(%lay_2783) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2784, %e1_2785, %e2_2786, %e3_2787 = cute.get_leaves(%1151) : !cute.shape<"((2,2,2),2)">
      %lay_2788 = cute.get_layout(%view_2780) : !memref_rmem_bf16_13
      %1152 = cute.get_shape(%lay_2788) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2789, %e1_2790, %e2_2791 = cute.get_leaves(%1152) : !cute.shape<"((2,2),8)">
      %iter_2792 = cute.get_iter(%view_2772) : !memref_rmem_bf16_12
      %iter_2793 = cute.get_iter(%view_2780) : !memref_rmem_bf16_13
      %iter_2794 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2795 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2796 = cute.get_layout(%view_2772) : !memref_rmem_bf16_12
      %lay_2797 = cute.get_layout(%view_2780) : !memref_rmem_bf16_13
      %lay_2798 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2799 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1153 = cute.static : !cute.layout<"1:0">
      %append_2800 = cute.append_to_rank<3> (%lay_2796, %1153) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2801 = cute.append_to_rank<3> (%lay_2797, %1153) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2802 = cute.size(%append_2800) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2803 = cute.size(%append_2800) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2804 = cute.size(%append_2801) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1154 = cute.get_scalars(%sz_2802) : !cute.int_tuple<"1">
      %1155 = cute.get_scalars(%sz_2803) : !cute.int_tuple<"2">
      %1156 = cute.get_scalars(%sz_2804) : !cute.int_tuple<"8">
      %c0_i32_2805 = arith.constant 0 : i32
      %c1_i32_2806 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2805 to %1154 step %c1_i32_2806  : i32 {
        scf.for %arg6 = %c0_i32_2805 to %1155 step %c1_i32_2806  : i32 {
          scf.for %arg7 = %c0_i32_2805 to %1156 step %c1_i32_2806  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2800) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2792, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2801) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2793, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2798) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2794, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2799) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2795, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2807 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2808 = cute.size(%int_tuple_2807) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2809 = cute.get_leaves(%sz_2808) : !cute.int_tuple<"8">
      %coord_2810 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2811 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_2812 = cute.crd2idx(%coord_2810, %lay_2811) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2813 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_2814 = cute.add_offset(%iter_2813, %idx_2812) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2815 = cute.make_view(%ptr_2814) : !memref_smem_bf16_14
      %iter_2816 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
      %iter_2817 = cute.get_iter(%view_2815) : !memref_smem_bf16_14
      %coord_2818 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2819 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_2820 = cute.crd2idx(%coord_2818, %lay_2819) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
      %iter_2821 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_2822 = cute.add_offset(%iter_2821, %idx_2820) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2823 = cute.make_view(%ptr_2822) : !memref_rmem_bf16_6
      %iter_2824 = cute.get_iter(%view_2823) : !memref_rmem_bf16_6
      %iter_2825 = cute.get_iter(%view_2823) : !memref_rmem_bf16_6
      %lay_2826 = cute.get_layout(%view_2815) : !memref_smem_bf16_14
      %1157 = cute.get_shape(%lay_2826) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2827, %e1_2828, %e2_2829 = cute.get_leaves(%1157) : !cute.shape<"((8,1),2)">
      %lay_2830 = cute.get_layout(%view_2823) : !memref_rmem_bf16_6
      %1158 = cute.get_shape(%lay_2830) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2831, %e1_2832, %e2_2833 = cute.get_leaves(%1158) : !cute.shape<"((8,1),2)">
      %lay_2834 = cute.get_layout(%view_2815) : !memref_smem_bf16_14
      %shape_2835 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2836 = cute.make_layout() : !cute.layout<"1:0">
      %append_2837 = cute.append_to_rank<2> (%lay_2834, %lay_2836) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2838 = cute.make_view(%iter_2817, %append_2837) : !memref_smem_bf16_14
      %iter_2839 = cute.get_iter(%view_2838) : !memref_smem_bf16_14
      %lay_2840 = cute.get_layout(%view_2838) : !memref_smem_bf16_14
      %1159 = cute.get_shape(%lay_2840) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2841, %e1_2842, %e2_2843 = cute.get_leaves(%1159) : !cute.shape<"((8,1),2)">
      %iter_2844 = cute.get_iter(%view_2838) : !memref_smem_bf16_14
      %view_2845 = cute.make_view(%iter_2844) : !memref_smem_bf16_15
      %iter_2846 = cute.get_iter(%view_2845) : !memref_smem_bf16_15
      %iter_2847 = cute.get_iter(%view_2845) : !memref_smem_bf16_15
      %lay_2848 = cute.get_layout(%view_2823) : !memref_rmem_bf16_6
      %shape_2849 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2850 = cute.make_layout() : !cute.layout<"1:0">
      %append_2851 = cute.append_to_rank<2> (%lay_2848, %lay_2850) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2852 = cute.make_view(%iter_2825, %append_2851) : !memref_rmem_bf16_6
      %iter_2853 = cute.get_iter(%view_2852) : !memref_rmem_bf16_6
      %lay_2854 = cute.get_layout(%view_2852) : !memref_rmem_bf16_6
      %1160 = cute.get_shape(%lay_2854) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2855, %e1_2856, %e2_2857 = cute.get_leaves(%1160) : !cute.shape<"((8,1),2)">
      %iter_2858 = cute.get_iter(%view_2852) : !memref_rmem_bf16_6
      %view_2859 = cute.make_view(%iter_2858) : !memref_rmem_bf16_7
      %iter_2860 = cute.get_iter(%view_2859) : !memref_rmem_bf16_7
      %iter_2861 = cute.get_iter(%view_2859) : !memref_rmem_bf16_7
      %lay_2862 = cute.get_layout(%view_2845) : !memref_smem_bf16_15
      %1161 = cute.get_shape(%lay_2862) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2863, %e1_2864, %e2_2865 = cute.get_leaves(%1161) : !cute.shape<"((8,1),(2))">
      %lay_2866 = cute.get_layout(%view_2859) : !memref_rmem_bf16_7
      %1162 = cute.get_shape(%lay_2866) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2867, %e1_2868, %e2_2869 = cute.get_leaves(%1162) : !cute.shape<"((8,1),(2))">
      %lay_2870 = cute.get_layout(%view_2845) : !memref_smem_bf16_15
      %sz_2871 = cute.size(%lay_2870) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2872 = cute.get_leaves(%sz_2871) : !cute.int_tuple<"2">
      %lay_2873 = cute.get_layout(%view_2859) : !memref_rmem_bf16_7
      %sz_2874 = cute.size(%lay_2873) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2875 = cute.get_leaves(%sz_2874) : !cute.int_tuple<"2">
      %1163 = cute.static : !cute.layout<"1:0">
      %iter_2876 = cute.get_iter(%view_2845) : !memref_smem_bf16_15
      %iter_2877 = cute.get_iter(%view_2859) : !memref_rmem_bf16_7
      %lay_2878 = cute.get_layout(%view_2845) : !memref_smem_bf16_15
      %lay_2879 = cute.get_layout(%view_2859) : !memref_rmem_bf16_7
      %append_2880 = cute.append_to_rank<2> (%lay_2878, %1163) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2881 = cute.append_to_rank<2> (%lay_2879, %1163) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2882 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2883 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2884 = cute.size(%lay_2882) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1164 = cute.get_scalars(%sz_2884) : !cute.int_tuple<"2">
      %c0_i32_2885 = arith.constant 0 : i32
      %c1_i32_2886 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2885 to %1164 step %c1_i32_2886  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2882) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_2876, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2883) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2877, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2887 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2888 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_2889 = cute.crd2idx(%coord_2887, %lay_2888) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2890 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_2891 = cute.add_offset(%iter_2890, %idx_2889) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2892 = cute.make_view(%ptr_2891) : !memref_smem_bf16_17
      %iter_2893 = cute.get_iter(%view_2892) : !memref_smem_bf16_17
      %iter_2894 = cute.get_iter(%view_2892) : !memref_smem_bf16_17
      %coord_2895 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2896 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_2897 = cute.crd2idx(%coord_2895, %lay_2896) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
      %iter_2898 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_2899 = cute.add_offset(%iter_2898, %idx_2897) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2900 = cute.make_view(%ptr_2899) : !memref_rmem_bf16_9
      %iter_2901 = cute.get_iter(%view_2900) : !memref_rmem_bf16_9
      %iter_2902 = cute.get_iter(%view_2900) : !memref_rmem_bf16_9
      %lay_2903 = cute.get_layout(%view_2892) : !memref_smem_bf16_17
      %1165 = cute.get_shape(%lay_2903) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2904, %e1_2905, %e2_2906 = cute.get_leaves(%1165) : !cute.shape<"((8,1),4)">
      %lay_2907 = cute.get_layout(%view_2900) : !memref_rmem_bf16_9
      %1166 = cute.get_shape(%lay_2907) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2908, %e1_2909, %e2_2910 = cute.get_leaves(%1166) : !cute.shape<"((8,1),4)">
      %lay_2911 = cute.get_layout(%view_2892) : !memref_smem_bf16_17
      %shape_2912 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2913 = cute.make_layout() : !cute.layout<"1:0">
      %append_2914 = cute.append_to_rank<2> (%lay_2911, %lay_2913) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2915 = cute.make_view(%iter_2894, %append_2914) : !memref_smem_bf16_17
      %iter_2916 = cute.get_iter(%view_2915) : !memref_smem_bf16_17
      %lay_2917 = cute.get_layout(%view_2915) : !memref_smem_bf16_17
      %1167 = cute.get_shape(%lay_2917) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2918, %e1_2919, %e2_2920 = cute.get_leaves(%1167) : !cute.shape<"((8,1),4)">
      %iter_2921 = cute.get_iter(%view_2915) : !memref_smem_bf16_17
      %view_2922 = cute.make_view(%iter_2921) : !memref_smem_bf16_18
      %iter_2923 = cute.get_iter(%view_2922) : !memref_smem_bf16_18
      %iter_2924 = cute.get_iter(%view_2922) : !memref_smem_bf16_18
      %lay_2925 = cute.get_layout(%view_2900) : !memref_rmem_bf16_9
      %shape_2926 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2927 = cute.make_layout() : !cute.layout<"1:0">
      %append_2928 = cute.append_to_rank<2> (%lay_2925, %lay_2927) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2929 = cute.make_view(%iter_2902, %append_2928) : !memref_rmem_bf16_9
      %iter_2930 = cute.get_iter(%view_2929) : !memref_rmem_bf16_9
      %lay_2931 = cute.get_layout(%view_2929) : !memref_rmem_bf16_9
      %1168 = cute.get_shape(%lay_2931) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2932, %e1_2933, %e2_2934 = cute.get_leaves(%1168) : !cute.shape<"((8,1),4)">
      %iter_2935 = cute.get_iter(%view_2929) : !memref_rmem_bf16_9
      %view_2936 = cute.make_view(%iter_2935) : !memref_rmem_bf16_10
      %iter_2937 = cute.get_iter(%view_2936) : !memref_rmem_bf16_10
      %iter_2938 = cute.get_iter(%view_2936) : !memref_rmem_bf16_10
      %lay_2939 = cute.get_layout(%view_2922) : !memref_smem_bf16_18
      %1169 = cute.get_shape(%lay_2939) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2940, %e1_2941, %e2_2942 = cute.get_leaves(%1169) : !cute.shape<"((8,1),(4))">
      %lay_2943 = cute.get_layout(%view_2936) : !memref_rmem_bf16_10
      %1170 = cute.get_shape(%lay_2943) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2944, %e1_2945, %e2_2946 = cute.get_leaves(%1170) : !cute.shape<"((8,1),(4))">
      %lay_2947 = cute.get_layout(%view_2922) : !memref_smem_bf16_18
      %sz_2948 = cute.size(%lay_2947) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2949 = cute.get_leaves(%sz_2948) : !cute.int_tuple<"4">
      %lay_2950 = cute.get_layout(%view_2936) : !memref_rmem_bf16_10
      %sz_2951 = cute.size(%lay_2950) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2952 = cute.get_leaves(%sz_2951) : !cute.int_tuple<"4">
      %1171 = cute.static : !cute.layout<"1:0">
      %iter_2953 = cute.get_iter(%view_2922) : !memref_smem_bf16_18
      %iter_2954 = cute.get_iter(%view_2936) : !memref_rmem_bf16_10
      %lay_2955 = cute.get_layout(%view_2922) : !memref_smem_bf16_18
      %lay_2956 = cute.get_layout(%view_2936) : !memref_rmem_bf16_10
      %append_2957 = cute.append_to_rank<2> (%lay_2955, %1171) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2958 = cute.append_to_rank<2> (%lay_2956, %1171) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2959 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2960 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2961 = cute.size(%lay_2959) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1172 = cute.get_scalars(%sz_2961) : !cute.int_tuple<"4">
      %c0_i32_2962 = arith.constant 0 : i32
      %c1_i32_2963 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2962 to %1172 step %c1_i32_2963  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_2959) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_2953, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_2960) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_2954, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2964 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2965 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_2966 = cute.crd2idx(%coord_2964, %lay_2965) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
      %iter_2967 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_2968 = cute.add_offset(%iter_2967, %idx_2966) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2969 = cute.make_view(%ptr_2968) : !memref_rmem_bf16_12
      %iter_2970 = cute.get_iter(%view_2969) : !memref_rmem_bf16_12
      %iter_2971 = cute.get_iter(%view_2969) : !memref_rmem_bf16_12
      %coord_2972 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2973 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_2974 = cute.crd2idx(%coord_2972, %lay_2973) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
      %iter_2975 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_2976 = cute.add_offset(%iter_2975, %idx_2974) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2977 = cute.make_view(%ptr_2976) : !memref_rmem_bf16_13
      %iter_2978 = cute.get_iter(%view_2977) : !memref_rmem_bf16_13
      %iter_2979 = cute.get_iter(%view_2977) : !memref_rmem_bf16_13
      %lay_2980 = cute.get_layout(%view_2969) : !memref_rmem_bf16_12
      %1173 = cute.get_shape(%lay_2980) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2981, %e1_2982, %e2_2983, %e3_2984 = cute.get_leaves(%1173) : !cute.shape<"((2,2,2),2)">
      %lay_2985 = cute.get_layout(%view_2977) : !memref_rmem_bf16_13
      %1174 = cute.get_shape(%lay_2985) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2986, %e1_2987, %e2_2988 = cute.get_leaves(%1174) : !cute.shape<"((2,2),8)">
      %iter_2989 = cute.get_iter(%view_2969) : !memref_rmem_bf16_12
      %iter_2990 = cute.get_iter(%view_2977) : !memref_rmem_bf16_13
      %iter_2991 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_2992 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_2993 = cute.get_layout(%view_2969) : !memref_rmem_bf16_12
      %lay_2994 = cute.get_layout(%view_2977) : !memref_rmem_bf16_13
      %lay_2995 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_2996 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1175 = cute.static : !cute.layout<"1:0">
      %append_2997 = cute.append_to_rank<3> (%lay_2993, %1175) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2998 = cute.append_to_rank<3> (%lay_2994, %1175) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2999 = cute.size(%append_2997) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_3000 = cute.size(%append_2997) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_3001 = cute.size(%append_2998) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1176 = cute.get_scalars(%sz_2999) : !cute.int_tuple<"1">
      %1177 = cute.get_scalars(%sz_3000) : !cute.int_tuple<"2">
      %1178 = cute.get_scalars(%sz_3001) : !cute.int_tuple<"8">
      %c0_i32_3002 = arith.constant 0 : i32
      %c1_i32_3003 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3002 to %1176 step %c1_i32_3003  : i32 {
        scf.for %arg6 = %c0_i32_3002 to %1177 step %c1_i32_3003  : i32 {
          scf.for %arg7 = %c0_i32_3002 to %1178 step %c1_i32_3003  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_2997) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_2989, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_2998) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_2990, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_2995) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_2991, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_2996) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_2992, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_3004 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_3005 = cute.size(%int_tuple_3004) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_3006 = cute.get_leaves(%sz_3005) : !cute.int_tuple<"8">
      %coord_3007 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3008 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_3009 = cute.crd2idx(%coord_3007, %lay_3008) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_3010 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_3011 = cute.add_offset(%iter_3010, %idx_3009) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3012 = cute.make_view(%ptr_3011) : !memref_smem_bf16_14
      %iter_3013 = cute.get_iter(%view_3012) : !memref_smem_bf16_14
      %iter_3014 = cute.get_iter(%view_3012) : !memref_smem_bf16_14
      %coord_3015 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3016 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_3017 = cute.crd2idx(%coord_3015, %lay_3016) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
      %iter_3018 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_3019 = cute.add_offset(%iter_3018, %idx_3017) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3020 = cute.make_view(%ptr_3019) : !memref_rmem_bf16_6
      %iter_3021 = cute.get_iter(%view_3020) : !memref_rmem_bf16_6
      %iter_3022 = cute.get_iter(%view_3020) : !memref_rmem_bf16_6
      %lay_3023 = cute.get_layout(%view_3012) : !memref_smem_bf16_14
      %1179 = cute.get_shape(%lay_3023) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3024, %e1_3025, %e2_3026 = cute.get_leaves(%1179) : !cute.shape<"((8,1),2)">
      %lay_3027 = cute.get_layout(%view_3020) : !memref_rmem_bf16_6
      %1180 = cute.get_shape(%lay_3027) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3028, %e1_3029, %e2_3030 = cute.get_leaves(%1180) : !cute.shape<"((8,1),2)">
      %lay_3031 = cute.get_layout(%view_3012) : !memref_smem_bf16_14
      %shape_3032 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3033 = cute.make_layout() : !cute.layout<"1:0">
      %append_3034 = cute.append_to_rank<2> (%lay_3031, %lay_3033) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_3035 = cute.make_view(%iter_3014, %append_3034) : !memref_smem_bf16_14
      %iter_3036 = cute.get_iter(%view_3035) : !memref_smem_bf16_14
      %lay_3037 = cute.get_layout(%view_3035) : !memref_smem_bf16_14
      %1181 = cute.get_shape(%lay_3037) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3038, %e1_3039, %e2_3040 = cute.get_leaves(%1181) : !cute.shape<"((8,1),2)">
      %iter_3041 = cute.get_iter(%view_3035) : !memref_smem_bf16_14
      %view_3042 = cute.make_view(%iter_3041) : !memref_smem_bf16_15
      %iter_3043 = cute.get_iter(%view_3042) : !memref_smem_bf16_15
      %iter_3044 = cute.get_iter(%view_3042) : !memref_smem_bf16_15
      %lay_3045 = cute.get_layout(%view_3020) : !memref_rmem_bf16_6
      %shape_3046 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3047 = cute.make_layout() : !cute.layout<"1:0">
      %append_3048 = cute.append_to_rank<2> (%lay_3045, %lay_3047) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_3049 = cute.make_view(%iter_3022, %append_3048) : !memref_rmem_bf16_6
      %iter_3050 = cute.get_iter(%view_3049) : !memref_rmem_bf16_6
      %lay_3051 = cute.get_layout(%view_3049) : !memref_rmem_bf16_6
      %1182 = cute.get_shape(%lay_3051) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3052, %e1_3053, %e2_3054 = cute.get_leaves(%1182) : !cute.shape<"((8,1),2)">
      %iter_3055 = cute.get_iter(%view_3049) : !memref_rmem_bf16_6
      %view_3056 = cute.make_view(%iter_3055) : !memref_rmem_bf16_7
      %iter_3057 = cute.get_iter(%view_3056) : !memref_rmem_bf16_7
      %iter_3058 = cute.get_iter(%view_3056) : !memref_rmem_bf16_7
      %lay_3059 = cute.get_layout(%view_3042) : !memref_smem_bf16_15
      %1183 = cute.get_shape(%lay_3059) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_3060, %e1_3061, %e2_3062 = cute.get_leaves(%1183) : !cute.shape<"((8,1),(2))">
      %lay_3063 = cute.get_layout(%view_3056) : !memref_rmem_bf16_7
      %1184 = cute.get_shape(%lay_3063) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_3064, %e1_3065, %e2_3066 = cute.get_leaves(%1184) : !cute.shape<"((8,1),(2))">
      %lay_3067 = cute.get_layout(%view_3042) : !memref_smem_bf16_15
      %sz_3068 = cute.size(%lay_3067) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_3069 = cute.get_leaves(%sz_3068) : !cute.int_tuple<"2">
      %lay_3070 = cute.get_layout(%view_3056) : !memref_rmem_bf16_7
      %sz_3071 = cute.size(%lay_3070) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_3072 = cute.get_leaves(%sz_3071) : !cute.int_tuple<"2">
      %1185 = cute.static : !cute.layout<"1:0">
      %iter_3073 = cute.get_iter(%view_3042) : !memref_smem_bf16_15
      %iter_3074 = cute.get_iter(%view_3056) : !memref_rmem_bf16_7
      %lay_3075 = cute.get_layout(%view_3042) : !memref_smem_bf16_15
      %lay_3076 = cute.get_layout(%view_3056) : !memref_rmem_bf16_7
      %append_3077 = cute.append_to_rank<2> (%lay_3075, %1185) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_3078 = cute.append_to_rank<2> (%lay_3076, %1185) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3079 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_3080 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_3081 = cute.size(%lay_3079) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1186 = cute.get_scalars(%sz_3081) : !cute.int_tuple<"2">
      %c0_i32_3082 = arith.constant 0 : i32
      %c1_i32_3083 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3082 to %1186 step %c1_i32_3083  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_3079) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_3073, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_3080) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_3074, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3084 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3085 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_3086 = cute.crd2idx(%coord_3084, %lay_3085) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_3087 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_3088 = cute.add_offset(%iter_3087, %idx_3086) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3089 = cute.make_view(%ptr_3088) : !memref_smem_bf16_17
      %iter_3090 = cute.get_iter(%view_3089) : !memref_smem_bf16_17
      %iter_3091 = cute.get_iter(%view_3089) : !memref_smem_bf16_17
      %coord_3092 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3093 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_3094 = cute.crd2idx(%coord_3092, %lay_3093) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
      %iter_3095 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_3096 = cute.add_offset(%iter_3095, %idx_3094) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3097 = cute.make_view(%ptr_3096) : !memref_rmem_bf16_9
      %iter_3098 = cute.get_iter(%view_3097) : !memref_rmem_bf16_9
      %iter_3099 = cute.get_iter(%view_3097) : !memref_rmem_bf16_9
      %lay_3100 = cute.get_layout(%view_3089) : !memref_smem_bf16_17
      %1187 = cute.get_shape(%lay_3100) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3101, %e1_3102, %e2_3103 = cute.get_leaves(%1187) : !cute.shape<"((8,1),4)">
      %lay_3104 = cute.get_layout(%view_3097) : !memref_rmem_bf16_9
      %1188 = cute.get_shape(%lay_3104) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3105, %e1_3106, %e2_3107 = cute.get_leaves(%1188) : !cute.shape<"((8,1),4)">
      %lay_3108 = cute.get_layout(%view_3089) : !memref_smem_bf16_17
      %shape_3109 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3110 = cute.make_layout() : !cute.layout<"1:0">
      %append_3111 = cute.append_to_rank<2> (%lay_3108, %lay_3110) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_3112 = cute.make_view(%iter_3091, %append_3111) : !memref_smem_bf16_17
      %iter_3113 = cute.get_iter(%view_3112) : !memref_smem_bf16_17
      %lay_3114 = cute.get_layout(%view_3112) : !memref_smem_bf16_17
      %1189 = cute.get_shape(%lay_3114) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3115, %e1_3116, %e2_3117 = cute.get_leaves(%1189) : !cute.shape<"((8,1),4)">
      %iter_3118 = cute.get_iter(%view_3112) : !memref_smem_bf16_17
      %view_3119 = cute.make_view(%iter_3118) : !memref_smem_bf16_18
      %iter_3120 = cute.get_iter(%view_3119) : !memref_smem_bf16_18
      %iter_3121 = cute.get_iter(%view_3119) : !memref_smem_bf16_18
      %lay_3122 = cute.get_layout(%view_3097) : !memref_rmem_bf16_9
      %shape_3123 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3124 = cute.make_layout() : !cute.layout<"1:0">
      %append_3125 = cute.append_to_rank<2> (%lay_3122, %lay_3124) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_3126 = cute.make_view(%iter_3099, %append_3125) : !memref_rmem_bf16_9
      %iter_3127 = cute.get_iter(%view_3126) : !memref_rmem_bf16_9
      %lay_3128 = cute.get_layout(%view_3126) : !memref_rmem_bf16_9
      %1190 = cute.get_shape(%lay_3128) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3129, %e1_3130, %e2_3131 = cute.get_leaves(%1190) : !cute.shape<"((8,1),4)">
      %iter_3132 = cute.get_iter(%view_3126) : !memref_rmem_bf16_9
      %view_3133 = cute.make_view(%iter_3132) : !memref_rmem_bf16_10
      %iter_3134 = cute.get_iter(%view_3133) : !memref_rmem_bf16_10
      %iter_3135 = cute.get_iter(%view_3133) : !memref_rmem_bf16_10
      %lay_3136 = cute.get_layout(%view_3119) : !memref_smem_bf16_18
      %1191 = cute.get_shape(%lay_3136) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_3137, %e1_3138, %e2_3139 = cute.get_leaves(%1191) : !cute.shape<"((8,1),(4))">
      %lay_3140 = cute.get_layout(%view_3133) : !memref_rmem_bf16_10
      %1192 = cute.get_shape(%lay_3140) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_3141, %e1_3142, %e2_3143 = cute.get_leaves(%1192) : !cute.shape<"((8,1),(4))">
      %lay_3144 = cute.get_layout(%view_3119) : !memref_smem_bf16_18
      %sz_3145 = cute.size(%lay_3144) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_3146 = cute.get_leaves(%sz_3145) : !cute.int_tuple<"4">
      %lay_3147 = cute.get_layout(%view_3133) : !memref_rmem_bf16_10
      %sz_3148 = cute.size(%lay_3147) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_3149 = cute.get_leaves(%sz_3148) : !cute.int_tuple<"4">
      %1193 = cute.static : !cute.layout<"1:0">
      %iter_3150 = cute.get_iter(%view_3119) : !memref_smem_bf16_18
      %iter_3151 = cute.get_iter(%view_3133) : !memref_rmem_bf16_10
      %lay_3152 = cute.get_layout(%view_3119) : !memref_smem_bf16_18
      %lay_3153 = cute.get_layout(%view_3133) : !memref_rmem_bf16_10
      %append_3154 = cute.append_to_rank<2> (%lay_3152, %1193) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_3155 = cute.append_to_rank<2> (%lay_3153, %1193) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3156 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_3157 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_3158 = cute.size(%lay_3156) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1194 = cute.get_scalars(%sz_3158) : !cute.int_tuple<"4">
      %c0_i32_3159 = arith.constant 0 : i32
      %c1_i32_3160 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3159 to %1194 step %c1_i32_3160  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_3156) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_3150, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_3157) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_3151, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3161 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_3162 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_3163 = cute.crd2idx(%coord_3161, %lay_3162) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
      %iter_3164 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_3165 = cute.add_offset(%iter_3164, %idx_3163) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3166 = cute.make_view(%ptr_3165) : !memref_rmem_bf16_12
      %iter_3167 = cute.get_iter(%view_3166) : !memref_rmem_bf16_12
      %iter_3168 = cute.get_iter(%view_3166) : !memref_rmem_bf16_12
      %coord_3169 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_3170 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_3171 = cute.crd2idx(%coord_3169, %lay_3170) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
      %iter_3172 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_3173 = cute.add_offset(%iter_3172, %idx_3171) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3174 = cute.make_view(%ptr_3173) : !memref_rmem_bf16_13
      %iter_3175 = cute.get_iter(%view_3174) : !memref_rmem_bf16_13
      %iter_3176 = cute.get_iter(%view_3174) : !memref_rmem_bf16_13
      %lay_3177 = cute.get_layout(%view_3166) : !memref_rmem_bf16_12
      %1195 = cute.get_shape(%lay_3177) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_3178, %e1_3179, %e2_3180, %e3_3181 = cute.get_leaves(%1195) : !cute.shape<"((2,2,2),2)">
      %lay_3182 = cute.get_layout(%view_3174) : !memref_rmem_bf16_13
      %1196 = cute.get_shape(%lay_3182) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_3183, %e1_3184, %e2_3185 = cute.get_leaves(%1196) : !cute.shape<"((2,2),8)">
      %iter_3186 = cute.get_iter(%view_3166) : !memref_rmem_bf16_12
      %iter_3187 = cute.get_iter(%view_3174) : !memref_rmem_bf16_13
      %iter_3188 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_3189 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_3190 = cute.get_layout(%view_3166) : !memref_rmem_bf16_12
      %lay_3191 = cute.get_layout(%view_3174) : !memref_rmem_bf16_13
      %lay_3192 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_3193 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1197 = cute.static : !cute.layout<"1:0">
      %append_3194 = cute.append_to_rank<3> (%lay_3190, %1197) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_3195 = cute.append_to_rank<3> (%lay_3191, %1197) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_3196 = cute.size(%append_3194) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_3197 = cute.size(%append_3194) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_3198 = cute.size(%append_3195) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1198 = cute.get_scalars(%sz_3196) : !cute.int_tuple<"1">
      %1199 = cute.get_scalars(%sz_3197) : !cute.int_tuple<"2">
      %1200 = cute.get_scalars(%sz_3198) : !cute.int_tuple<"8">
      %c0_i32_3199 = arith.constant 0 : i32
      %c1_i32_3200 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3199 to %1198 step %c1_i32_3200  : i32 {
        scf.for %arg6 = %c0_i32_3199 to %1199 step %c1_i32_3200  : i32 {
          scf.for %arg7 = %c0_i32_3199 to %1200 step %c1_i32_3200  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_3194) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_3186, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_3195) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_3187, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_3192) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_3188, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_3193) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_3189, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_3201 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_3202 = cute.size(%int_tuple_3201) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_3203 = cute.get_leaves(%sz_3202) : !cute.int_tuple<"8">
      %coord_3204 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3205 = cute.get_layout(%view_746) : !memref_smem_bf16_8
      %idx_3206 = cute.crd2idx(%coord_3204, %lay_3205) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_3207 = cute.get_iter(%view_746) : !memref_smem_bf16_8
      %ptr_3208 = cute.add_offset(%iter_3207, %idx_3206) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3209 = cute.make_view(%ptr_3208) : !memref_smem_bf16_14
      %iter_3210 = cute.get_iter(%view_3209) : !memref_smem_bf16_14
      %iter_3211 = cute.get_iter(%view_3209) : !memref_smem_bf16_14
      %coord_3212 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3213 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
      %idx_3214 = cute.crd2idx(%coord_3212, %lay_3213) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_3215 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
      %ptr_3216 = cute.add_offset(%iter_3215, %idx_3214) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3217 = cute.make_view(%ptr_3216) : !memref_rmem_bf16_6
      %iter_3218 = cute.get_iter(%view_3217) : !memref_rmem_bf16_6
      %iter_3219 = cute.get_iter(%view_3217) : !memref_rmem_bf16_6
      %lay_3220 = cute.get_layout(%view_3209) : !memref_smem_bf16_14
      %1201 = cute.get_shape(%lay_3220) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3221, %e1_3222, %e2_3223 = cute.get_leaves(%1201) : !cute.shape<"((8,1),2)">
      %lay_3224 = cute.get_layout(%view_3217) : !memref_rmem_bf16_6
      %1202 = cute.get_shape(%lay_3224) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3225, %e1_3226, %e2_3227 = cute.get_leaves(%1202) : !cute.shape<"((8,1),2)">
      %lay_3228 = cute.get_layout(%view_3209) : !memref_smem_bf16_14
      %shape_3229 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3230 = cute.make_layout() : !cute.layout<"1:0">
      %append_3231 = cute.append_to_rank<2> (%lay_3228, %lay_3230) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_3232 = cute.make_view(%iter_3211, %append_3231) : !memref_smem_bf16_14
      %iter_3233 = cute.get_iter(%view_3232) : !memref_smem_bf16_14
      %lay_3234 = cute.get_layout(%view_3232) : !memref_smem_bf16_14
      %1203 = cute.get_shape(%lay_3234) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_3235, %e1_3236, %e2_3237 = cute.get_leaves(%1203) : !cute.shape<"((8,1),2)">
      %iter_3238 = cute.get_iter(%view_3232) : !memref_smem_bf16_14
      %view_3239 = cute.make_view(%iter_3238) : !memref_smem_bf16_15
      %iter_3240 = cute.get_iter(%view_3239) : !memref_smem_bf16_15
      %iter_3241 = cute.get_iter(%view_3239) : !memref_smem_bf16_15
      %lay_3242 = cute.get_layout(%view_3217) : !memref_rmem_bf16_6
      %shape_3243 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3244 = cute.make_layout() : !cute.layout<"1:0">
      %append_3245 = cute.append_to_rank<2> (%lay_3242, %lay_3244) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_3246 = cute.make_view(%iter_3219, %append_3245) : !memref_rmem_bf16_6
      %iter_3247 = cute.get_iter(%view_3246) : !memref_rmem_bf16_6
      %lay_3248 = cute.get_layout(%view_3246) : !memref_rmem_bf16_6
      %1204 = cute.get_shape(%lay_3248) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_3249, %e1_3250, %e2_3251 = cute.get_leaves(%1204) : !cute.shape<"((8,1),2)">
      %iter_3252 = cute.get_iter(%view_3246) : !memref_rmem_bf16_6
      %view_3253 = cute.make_view(%iter_3252) : !memref_rmem_bf16_7
      %iter_3254 = cute.get_iter(%view_3253) : !memref_rmem_bf16_7
      %iter_3255 = cute.get_iter(%view_3253) : !memref_rmem_bf16_7
      %lay_3256 = cute.get_layout(%view_3239) : !memref_smem_bf16_15
      %1205 = cute.get_shape(%lay_3256) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_3257, %e1_3258, %e2_3259 = cute.get_leaves(%1205) : !cute.shape<"((8,1),(2))">
      %lay_3260 = cute.get_layout(%view_3253) : !memref_rmem_bf16_7
      %1206 = cute.get_shape(%lay_3260) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_3261, %e1_3262, %e2_3263 = cute.get_leaves(%1206) : !cute.shape<"((8,1),(2))">
      %lay_3264 = cute.get_layout(%view_3239) : !memref_smem_bf16_15
      %sz_3265 = cute.size(%lay_3264) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_3266 = cute.get_leaves(%sz_3265) : !cute.int_tuple<"2">
      %lay_3267 = cute.get_layout(%view_3253) : !memref_rmem_bf16_7
      %sz_3268 = cute.size(%lay_3267) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_3269 = cute.get_leaves(%sz_3268) : !cute.int_tuple<"2">
      %1207 = cute.static : !cute.layout<"1:0">
      %iter_3270 = cute.get_iter(%view_3239) : !memref_smem_bf16_15
      %iter_3271 = cute.get_iter(%view_3253) : !memref_rmem_bf16_7
      %lay_3272 = cute.get_layout(%view_3239) : !memref_smem_bf16_15
      %lay_3273 = cute.get_layout(%view_3253) : !memref_rmem_bf16_7
      %append_3274 = cute.append_to_rank<2> (%lay_3272, %1207) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_3275 = cute.append_to_rank<2> (%lay_3273, %1207) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3276 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_3277 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_3278 = cute.size(%lay_3276) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %1208 = cute.get_scalars(%sz_3278) : !cute.int_tuple<"2">
      %c0_i32_3279 = arith.constant 0 : i32
      %c1_i32_3280 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3279 to %1208 step %c1_i32_3280  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_3276) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_8607 = cute.add_offset(%iter_3270, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_3277) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_3271, %idx_8610) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3281 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3282 = cute.get_layout(%view_804) : !memref_smem_bf16_9
      %idx_3283 = cute.crd2idx(%coord_3281, %lay_3282) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_3284 = cute.get_iter(%view_804) : !memref_smem_bf16_9
      %ptr_3285 = cute.add_offset(%iter_3284, %idx_3283) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_3286 = cute.make_view(%ptr_3285) : !memref_smem_bf16_17
      %iter_3287 = cute.get_iter(%view_3286) : !memref_smem_bf16_17
      %iter_3288 = cute.get_iter(%view_3286) : !memref_smem_bf16_17
      %coord_3289 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_3290 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
      %idx_3291 = cute.crd2idx(%coord_3289, %lay_3290) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_3292 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
      %ptr_3293 = cute.add_offset(%iter_3292, %idx_3291) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3294 = cute.make_view(%ptr_3293) : !memref_rmem_bf16_9
      %iter_3295 = cute.get_iter(%view_3294) : !memref_rmem_bf16_9
      %iter_3296 = cute.get_iter(%view_3294) : !memref_rmem_bf16_9
      %lay_3297 = cute.get_layout(%view_3286) : !memref_smem_bf16_17
      %1209 = cute.get_shape(%lay_3297) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3298, %e1_3299, %e2_3300 = cute.get_leaves(%1209) : !cute.shape<"((8,1),4)">
      %lay_3301 = cute.get_layout(%view_3294) : !memref_rmem_bf16_9
      %1210 = cute.get_shape(%lay_3301) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3302, %e1_3303, %e2_3304 = cute.get_leaves(%1210) : !cute.shape<"((8,1),4)">
      %lay_3305 = cute.get_layout(%view_3286) : !memref_smem_bf16_17
      %shape_3306 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3307 = cute.make_layout() : !cute.layout<"1:0">
      %append_3308 = cute.append_to_rank<2> (%lay_3305, %lay_3307) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_3309 = cute.make_view(%iter_3288, %append_3308) : !memref_smem_bf16_17
      %iter_3310 = cute.get_iter(%view_3309) : !memref_smem_bf16_17
      %lay_3311 = cute.get_layout(%view_3309) : !memref_smem_bf16_17
      %1211 = cute.get_shape(%lay_3311) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_3312, %e1_3313, %e2_3314 = cute.get_leaves(%1211) : !cute.shape<"((8,1),4)">
      %iter_3315 = cute.get_iter(%view_3309) : !memref_smem_bf16_17
      %view_3316 = cute.make_view(%iter_3315) : !memref_smem_bf16_18
      %iter_3317 = cute.get_iter(%view_3316) : !memref_smem_bf16_18
      %iter_3318 = cute.get_iter(%view_3316) : !memref_smem_bf16_18
      %lay_3319 = cute.get_layout(%view_3294) : !memref_rmem_bf16_9
      %shape_3320 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_3321 = cute.make_layout() : !cute.layout<"1:0">
      %append_3322 = cute.append_to_rank<2> (%lay_3319, %lay_3321) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_3323 = cute.make_view(%iter_3296, %append_3322) : !memref_rmem_bf16_9
      %iter_3324 = cute.get_iter(%view_3323) : !memref_rmem_bf16_9
      %lay_3325 = cute.get_layout(%view_3323) : !memref_rmem_bf16_9
      %1212 = cute.get_shape(%lay_3325) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_3326, %e1_3327, %e2_3328 = cute.get_leaves(%1212) : !cute.shape<"((8,1),4)">
      %iter_3329 = cute.get_iter(%view_3323) : !memref_rmem_bf16_9
      %view_3330 = cute.make_view(%iter_3329) : !memref_rmem_bf16_10
      %iter_3331 = cute.get_iter(%view_3330) : !memref_rmem_bf16_10
      %iter_3332 = cute.get_iter(%view_3330) : !memref_rmem_bf16_10
      %lay_3333 = cute.get_layout(%view_3316) : !memref_smem_bf16_18
      %1213 = cute.get_shape(%lay_3333) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_3334, %e1_3335, %e2_3336 = cute.get_leaves(%1213) : !cute.shape<"((8,1),(4))">
      %lay_3337 = cute.get_layout(%view_3330) : !memref_rmem_bf16_10
      %1214 = cute.get_shape(%lay_3337) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_3338, %e1_3339, %e2_3340 = cute.get_leaves(%1214) : !cute.shape<"((8,1),(4))">
      %lay_3341 = cute.get_layout(%view_3316) : !memref_smem_bf16_18
      %sz_3342 = cute.size(%lay_3341) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_3343 = cute.get_leaves(%sz_3342) : !cute.int_tuple<"4">
      %lay_3344 = cute.get_layout(%view_3330) : !memref_rmem_bf16_10
      %sz_3345 = cute.size(%lay_3344) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_3346 = cute.get_leaves(%sz_3345) : !cute.int_tuple<"4">
      %1215 = cute.static : !cute.layout<"1:0">
      %iter_3347 = cute.get_iter(%view_3316) : !memref_smem_bf16_18
      %iter_3348 = cute.get_iter(%view_3330) : !memref_rmem_bf16_10
      %lay_3349 = cute.get_layout(%view_3316) : !memref_smem_bf16_18
      %lay_3350 = cute.get_layout(%view_3330) : !memref_rmem_bf16_10
      %append_3351 = cute.append_to_rank<2> (%lay_3349, %1215) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_3352 = cute.append_to_rank<2> (%lay_3350, %1215) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_3353 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_3354 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_3355 = cute.size(%lay_3353) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %1216 = cute.get_scalars(%sz_3355) : !cute.int_tuple<"4">
      %c0_i32_3356 = arith.constant 0 : i32
      %c1_i32_3357 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3356 to %1216 step %c1_i32_3357  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_3353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_3347, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_3354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_3348, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3380 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
        %3381 = llvm.mlir.constant(0 : i32) : i32
        %3382 = vector.extractelement %3380[%3381 : i32] : vector<4xi32>
        %3383 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3382, %3383 : i32, !llvm.ptr
        %3384 = llvm.mlir.constant(1 : i32) : i32
        %3385 = vector.extractelement %3380[%3384 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3386 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3385, %3386 : i32, !llvm.ptr
        %3387 = llvm.mlir.constant(2 : i32) : i32
        %3388 = vector.extractelement %3380[%3387 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3389 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3388, %3389 : i32, !llvm.ptr
        %3390 = llvm.mlir.constant(3 : i32) : i32
        %3391 = vector.extractelement %3380[%3390 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3391, %3392 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_3358 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3359 = cute.get_layout(%rmem) : !memref_rmem_bf16_
      %idx_3360 = cute.crd2idx(%coord_3358, %lay_3359) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
      %iter_3361 = cute.get_iter(%rmem) : !memref_rmem_bf16_
      %ptr_3362 = cute.add_offset(%iter_3361, %idx_3360) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_3363 = cute.make_view(%ptr_3362) : !memref_rmem_bf16_12
      %iter_3364 = cute.get_iter(%view_3363) : !memref_rmem_bf16_12
      %iter_3365 = cute.get_iter(%view_3363) : !memref_rmem_bf16_12
      %coord_3366 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_3367 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
      %idx_3368 = cute.crd2idx(%coord_3366, %lay_3367) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
      %iter_3369 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
      %ptr_3370 = cute.add_offset(%iter_3369, %idx_3368) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_3371 = cute.make_view(%ptr_3370) : !memref_rmem_bf16_13
      %iter_3372 = cute.get_iter(%view_3371) : !memref_rmem_bf16_13
      %iter_3373 = cute.get_iter(%view_3371) : !memref_rmem_bf16_13
      %lay_3374 = cute.get_layout(%view_3363) : !memref_rmem_bf16_12
      %1217 = cute.get_shape(%lay_3374) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_3375, %e1_3376, %e2_3377, %e3_3378 = cute.get_leaves(%1217) : !cute.shape<"((2,2,2),2)">
      %lay_3379 = cute.get_layout(%view_3371) : !memref_rmem_bf16_13
      %1218 = cute.get_shape(%lay_3379) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_3380, %e1_3381, %e2_3382 = cute.get_leaves(%1218) : !cute.shape<"((2,2),8)">
      %iter_3383 = cute.get_iter(%view_3363) : !memref_rmem_bf16_12
      %iter_3384 = cute.get_iter(%view_3371) : !memref_rmem_bf16_13
      %iter_3385 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %iter_3386 = cute.get_iter(%rmem_1636) : !memref_rmem_f32_2
      %lay_3387 = cute.get_layout(%view_3363) : !memref_rmem_bf16_12
      %lay_3388 = cute.get_layout(%view_3371) : !memref_rmem_bf16_13
      %lay_3389 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_3390 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1219 = cute.static : !cute.layout<"1:0">
      %append_3391 = cute.append_to_rank<3> (%lay_3387, %1219) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_3392 = cute.append_to_rank<3> (%lay_3388, %1219) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_3393 = cute.size(%append_3391) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_3394 = cute.size(%append_3391) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_3395 = cute.size(%append_3392) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %1220 = cute.get_scalars(%sz_3393) : !cute.int_tuple<"1">
      %1221 = cute.get_scalars(%sz_3394) : !cute.int_tuple<"2">
      %1222 = cute.get_scalars(%sz_3395) : !cute.int_tuple<"8">
      %c0_i32_3396 = arith.constant 0 : i32
      %c1_i32_3397 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_3396 to %1220 step %c1_i32_3397  : i32 {
        scf.for %arg6 = %c0_i32_3396 to %1221 step %c1_i32_3397  : i32 {
          scf.for %arg7 = %c0_i32_3396 to %1222 step %c1_i32_3397  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_3391) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_8609 = cute.add_offset(%iter_3383, %idx_8608) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_14
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_3392) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_3384, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_3389) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_3385, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_3390) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_3386, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_14
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[2] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[3] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      nvvm.cp.async.wait.group 0
      %c1_i32_3398 = arith.constant 1 : i32
      %c128_i32_3399 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_3398 number_of_threads = %c128_i32_3399
      %1223 = arith.cmpi sgt, %1027, %c0_i32_1627 : i32
      scf.if %1223 {
        %c1_i32_8604 = arith.constant 1 : i32
        %3378 = arith.subi %1027, %c1_i32_8604 : i32
        %coord_8605 = cute.make_coord(%3378) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_8606 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
        %3379:3 = cute.get_scalars(%lay_8606) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
        %3380 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
        %shape_8607 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
        %iv_8608 = cute.assume(%3379#1) : (i64) -> !cute.i64<divby 128>
        %stride_8609 = cute.make_stride(%iv_8608) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
        %lay_8610 = cute.make_layout(%shape_8607, %stride_8609) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %idx_8611 = cute.crd2idx(%coord_8605, %lay_8606) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8612 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
        %ptr_8613 = cute.add_offset(%iter_8612, %idx_8611) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8614 = cute.make_view(%ptr_8613, %lay_8610) : !memref_gmem_bf16_9
        %iter_8615 = cute.get_iter(%view_8614) : !memref_gmem_bf16_9
        %iter_8616 = cute.get_iter(%view_8614) : !memref_gmem_bf16_9
        %lay_8617 = cute.get_layout(%view_8614) : !memref_gmem_bf16_9
        %3381 = cute.get_shape(%lay_8617) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8618, %e1_8619, %e2_8620, %e3_8621 = cute.get_leaves(%3381) : !cute.shape<"((8,1),4,2)">
        %lay_8622 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %3382 = cute.get_shape(%lay_8622) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8623, %e1_8624, %e2_8625, %e3_8626 = cute.get_leaves(%3382) : !cute.shape<"((8,1),4,2)">
        %lay_8627 = cute.get_layout(%view_8614) : !memref_gmem_bf16_9
        %shape_8628 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8629 = cute.make_layout() : !cute.layout<"1:0">
        %append_8630 = cute.append_to_rank<2> (%lay_8627, %lay_8629) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_8631 = cute.make_view(%iter_8616, %append_8630) : !memref_gmem_bf16_9
        %iter_8632 = cute.get_iter(%view_8631) : !memref_gmem_bf16_9
        %lay_8633 = cute.get_layout(%view_8631) : !memref_gmem_bf16_9
        %3383 = cute.get_shape(%lay_8633) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8634, %e1_8635, %e2_8636, %e3_8637 = cute.get_leaves(%3383) : !cute.shape<"((8,1),4,2)">
        %iter_8638 = cute.get_iter(%view_8631) : !memref_gmem_bf16_9
        %lay_8639 = cute.get_layout(%view_8631) : !memref_gmem_bf16_9
        %3384 = cute.get_scalars(%lay_8639) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_8640 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_8641 = cute.assume(%3384) : (i64) -> !cute.i64<divby 128>
        %stride_8642 = cute.make_stride(%iv_8641) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_8643 = cute.make_layout(%shape_8640, %stride_8642) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_8644 = cute.make_view(%iter_8638, %lay_8643) : !memref_gmem_bf16_10
        %iter_8645 = cute.get_iter(%view_8644) : !memref_gmem_bf16_10
        %iter_8646 = cute.get_iter(%view_8644) : !memref_gmem_bf16_10
        %lay_8647 = cute.get_layout(%view_425) : !memref_smem_bf16_4
        %shape_8648 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8649 = cute.make_layout() : !cute.layout<"1:0">
        %append_8650 = cute.append_to_rank<2> (%lay_8647, %lay_8649) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_8651 = cute.make_view(%iter_426, %append_8650) : !memref_smem_bf16_4
        %iter_8652 = cute.get_iter(%view_8651) : !memref_smem_bf16_4
        %lay_8653 = cute.get_layout(%view_8651) : !memref_smem_bf16_4
        %3385 = cute.get_shape(%lay_8653) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_8654, %e1_8655, %e2_8656, %e3_8657 = cute.get_leaves(%3385) : !cute.shape<"((8,1),4,2)">
        %iter_8658 = cute.get_iter(%view_8651) : !memref_smem_bf16_4
        %view_8659 = cute.make_view(%iter_8658) : !memref_smem_bf16_16
        %iter_8660 = cute.get_iter(%view_8659) : !memref_smem_bf16_16
        %iter_8661 = cute.get_iter(%view_8659) : !memref_smem_bf16_16
        %lay_8662 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
        %shape_8663 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8664 = cute.make_layout() : !cute.layout<"1:0">
        %append_8665 = cute.append_to_rank<2> (%lay_8662, %lay_8664) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_8666 = cute.make_view(%iter_1047, %append_8665) : !memref_rmem_i8_1
        %iter_8667 = cute.get_iter(%view_8666) : !memref_rmem_i8_1
        %lay_8668 = cute.get_layout(%view_8666) : !memref_rmem_i8_1
        %3386 = cute.get_shape(%lay_8668) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_8669, %e1_8670, %e2_8671 = cute.get_leaves(%3386) : !cute.shape<"(1,4,2)">
        %iter_8672 = cute.get_iter(%view_8666) : !memref_rmem_i8_1
        %view_8673 = cute.make_view(%iter_8672) : !memref_rmem_i8_5
        %iter_8674 = cute.get_iter(%view_8673) : !memref_rmem_i8_5
        %iter_8675 = cute.get_iter(%view_8673) : !memref_rmem_i8_5
        %lay_8676 = cute.get_layout(%view_8644) : !memref_gmem_bf16_10
        %3387 = cute.get_shape(%lay_8676) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8677, %e1_8678, %e2_8679, %e3_8680 = cute.get_leaves(%3387) : !cute.shape<"((8,1),(4,2))">
        %lay_8681 = cute.get_layout(%view_8659) : !memref_smem_bf16_16
        %3388 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_8682, %e1_8683, %e2_8684, %e3_8685 = cute.get_leaves(%3388) : !cute.shape<"((8,1),(4,2))">
        %lay_8686 = cute.get_layout(%view_8644) : !memref_gmem_bf16_10
        %sz_8687 = cute.size(%lay_8686) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_8688 = cute.get_leaves(%sz_8687) : !cute.int_tuple<"8">
        %lay_8689 = cute.get_layout(%view_8659) : !memref_smem_bf16_16
        %sz_8690 = cute.size(%lay_8689) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_8691 = cute.get_leaves(%sz_8690) : !cute.int_tuple<"8">
        %3389 = cute.static : !cute.layout<"1:0">
        %iter_8692 = cute.get_iter(%view_8644) : !memref_gmem_bf16_10
        %iter_8693 = cute.get_iter(%view_8659) : !memref_smem_bf16_16
        %lay_8694 = cute.get_layout(%view_8644) : !memref_gmem_bf16_10
        %lay_8695 = cute.get_layout(%view_8659) : !memref_smem_bf16_16
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3389) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_8697 = cute.append_to_rank<2> (%lay_8695, %3389) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %3390 = cute.get_scalars(%append_8696) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_8698 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_8699 = cute.assume(%3390) : (i64) -> !cute.i64<divby 128>
        %stride_8700 = cute.make_stride(%iv_8699) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_8701 = cute.make_layout(%shape_8698, %stride_8700) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_8702 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_8703 = cute.get_iter(%view_8673) : !memref_rmem_i8_5
        %lay_8704 = cute.get_layout(%view_8673) : !memref_rmem_i8_5
        %append_8705 = cute.append_to_rank<2> (%lay_8704, %3389) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_8706 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_8707 = cute.size(%lay_8701) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %3391 = cute.get_scalars(%sz_8707) : !cute.int_tuple<"8">
        %c0_i32_8708 = arith.constant 0 : i32
        %c1_i32_8709 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8708 to %3391 step %c1_i32_8709  : i32 {
          %coord_8710 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3392 = cute.get_scalars(%lay_8701) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %3393 = cute.get_scalars(%coord_8710) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8710, %lay_8701) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3394 = cute.get_scalars(%coord_8710) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8716 = cute.crd2idx(%coord_8710, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_8717 = cute.add_offset(%iter_8693, %idx_8716) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_smem_bf16_13
          %3395 = cute.get_scalars(%coord_8710) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8719 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8720 = cute.crd2idx(%coord_8710, %lay_8706) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_8721 = cute.add_offset(%iter_8703, %idx_8720) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8722 = cute.make_view(%ptr_8721, %lay_8719) : !memref_rmem_i8_4
          %iter_8723 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8724 = cute.get_iter(%view_8718) : !memref_smem_bf16_13
          %iter_8725 = cute.get_iter(%view_8722) : !memref_rmem_i8_4
          %3396 = builtin.unrealized_conversion_cast %iter_8725 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3397 = llvm.load %3396 : !llvm.ptr -> i8
          %3398 = llvm.trunc %3397 : i8 to i1
          %iter_8726 = cute.recast_iter(%iter_8723) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
          %iter_8727 = cute.recast_iter(%iter_8724) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
          cute_nvgpu.arch.copy.SM80.cp_async(%iter_8727 : !cute.ptr<i128, smem>, %iter_8726 : !cute.ptr<i128, gmem>, %3398 : i1) {cache_mode = <global>}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.commit.group
      }
      %lay_3400 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %1224 = cute.get_shape(%lay_3400) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3401, %e1_3402, %e2_3403, %e3_3404 = cute.get_leaves(%1224) : !cute.shape<"((2,2),2,8)">
      %shape_3405 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_3406 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %1225 = cute.get_shape(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3407, %e1_3408, %e2_3409, %e3_3410 = cute.get_leaves(%1225) : !cute.shape<"((2,2),2,8)">
      %1226 = cute.get_shape(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3411, %e1_3412, %e2_3413, %e3_3414 = cute.get_leaves(%1226) : !cute.shape<"((2,2),2,8)">
      %1227 = cute.get_shape(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3415, %e1_3416, %e2_3417, %e3_3418 = cute.get_leaves(%1227) : !cute.shape<"((2,2),2,8)">
      %1228 = cute.get_shape(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3419, %e1_3420, %e2_3421, %e3_3422 = cute.get_leaves(%1228) : !cute.shape<"((2,2),2,8)">
      %1229 = cute.get_stride(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3423, %e1_3424, %e2_3425, %e3_3426 = cute.get_leaves(%1229) : !cute.stride<"((1,2),4,8)">
      %1230 = cute.get_stride(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3427, %e1_3428, %e2_3429, %e3_3430 = cute.get_leaves(%1230) : !cute.stride<"((1,2),4,8)">
      %1231 = cute.get_stride(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3431, %e1_3432, %e2_3433, %e3_3434 = cute.get_leaves(%1231) : !cute.stride<"((1,2),4,8)">
      %1232 = cute.get_stride(%lay_3406) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3435, %e1_3436, %e2_3437, %e3_3438 = cute.get_leaves(%1232) : !cute.stride<"((1,2),4,8)">
      %shape_3439 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3440 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3441 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3442 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_3443 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %view_3444 = cute.make_view(%iter_1638, %lay_3443) : !memref_rmem_f32_4
      %iter_3445 = cute.get_iter(%view_3444) : !memref_rmem_f32_4
      %lay_3446 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %1233 = cute.get_shape(%lay_3446) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3447, %e1_3448, %e2_3449, %e3_3450 = cute.get_leaves(%1233) : !cute.shape<"((2,2),2,16)">
      %shape_3451 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_3452 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %1234 = cute.get_shape(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3453, %e1_3454, %e2_3455, %e3_3456 = cute.get_leaves(%1234) : !cute.shape<"((2,2),2,16)">
      %1235 = cute.get_shape(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3457, %e1_3458, %e2_3459, %e3_3460 = cute.get_leaves(%1235) : !cute.shape<"((2,2),2,16)">
      %1236 = cute.get_shape(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3461, %e1_3462, %e2_3463, %e3_3464 = cute.get_leaves(%1236) : !cute.shape<"((2,2),2,16)">
      %1237 = cute.get_shape(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_3465, %e1_3466, %e2_3467, %e3_3468 = cute.get_leaves(%1237) : !cute.shape<"((2,2),2,16)">
      %1238 = cute.get_stride(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3469, %e1_3470, %e2_3471, %e3_3472 = cute.get_leaves(%1238) : !cute.stride<"((1,2),4,8)">
      %1239 = cute.get_stride(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3473, %e1_3474, %e2_3475, %e3_3476 = cute.get_leaves(%1239) : !cute.stride<"((1,2),4,8)">
      %1240 = cute.get_stride(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3477, %e1_3478, %e2_3479, %e3_3480 = cute.get_leaves(%1240) : !cute.stride<"((1,2),4,8)">
      %1241 = cute.get_stride(%lay_3452) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3481, %e1_3482, %e2_3483, %e3_3484 = cute.get_leaves(%1241) : !cute.stride<"((1,2),4,8)">
      %shape_3485 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_3486 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3487 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_3488 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_3489 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_3490 = cute.make_view(%iter_637, %lay_3489) : !memref_rmem_f32_5
      %iter_3491 = cute.get_iter(%view_3490) : !memref_rmem_f32_5
      %lay_3492 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %1242 = cute.get_shape(%lay_3492) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_3493, %e1_3494, %e2_3495, %e3_3496 = cute.get_leaves(%1242) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_3497 = cute.to_int_tuple(%e0_3493) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1243 = cute.get_scalars(%itup_3497) : !cute.int_tuple<"?">
      %itup_3498 = cute.to_int_tuple(%e1_3494) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1244 = cute.get_scalars(%itup_3498) : !cute.int_tuple<"?">
      %itup_3499 = cute.to_int_tuple(%e2_3495) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1245 = cute.get_scalars(%itup_3499) : !cute.int_tuple<"?">
      %itup_3500 = cute.to_int_tuple(%e3_3496) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1246 = cute.get_scalars(%itup_3500) : !cute.int_tuple<"?{div=8}">
      %lay_3501 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %1247 = cute.get_shape(%lay_3501) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_3502, %e1_3503, %e2_3504, %e3_3505 = cute.get_leaves(%1247) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_3506 = cute.to_int_tuple(%e0_3502) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1248 = cute.get_scalars(%itup_3506) : !cute.int_tuple<"?">
      %itup_3507 = cute.to_int_tuple(%e1_3503) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1249 = cute.get_scalars(%itup_3507) : !cute.int_tuple<"?">
      %itup_3508 = cute.to_int_tuple(%e2_3504) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%itup_3508) : !cute.int_tuple<"?">
      %itup_3509 = cute.to_int_tuple(%e3_3505) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %1251 = cute.get_scalars(%itup_3509) : !cute.int_tuple<"?{div=8}">
      %shape_3510 = cute.make_shape(%itup_3497, %itup_3498, %itup_3499, %itup_3507) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)">
      %int_tuple_3511 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_3512 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_3513 = cute.make_layout(%shape_3510, %stride_3512) : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %view_3514 = cute.make_view(%int_tuple_3511, %lay_3513) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %iter_3515 = cute.get_iter(%view_3514) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %e0_3516, %e1_3517, %e2_3518, %e3_3519 = cute.get_leaves(%iter_3515) : !cute.int_tuple<"(0,0,0,0)">
      %coord_3520 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_3521 = cute.get_layout(%view_3514) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %1252:4 = cute.get_scalars(%lay_3521) <{only_dynamic}> : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %1253:2 = cute.get_scalars(%coord_3520) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %shape_3522 = cute.make_shape(%1252#1, %1252#3) : (i32, i32) -> !cute.shape<"(?,?)">
      %stride_3523 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_3524 = cute.make_layout(%shape_3522, %stride_3523) : !cute.layout<"(?,?):(1@1,1@3)">
      %idx_3525 = cute.crd2idx(%coord_3520, %lay_3521) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_3526 = cute.get_iter(%view_3514) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %tup_3527 = cute.add_offset(%iter_3526, %idx_3525) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_3528 = cute.make_view(%tup_3527, %lay_3524) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %iter_3529 = cute.get_iter(%view_3528) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_3530, %e1_3531, %e2_3532, %e3_3533 = cute.get_leaves(%iter_3529) : !cute.int_tuple<"(?,0,?,0)">
      %1254 = cute.get_scalars(%e0_3530) : !cute.int_tuple<"?">
      %1255 = cute.get_scalars(%e2_3532) : !cute.int_tuple<"?">
      %iter_3534 = cute.get_iter(%view_3528) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_3535, %e1_3536, %e2_3537, %e3_3538 = cute.get_leaves(%iter_3534) : !cute.int_tuple<"(?,0,?,0)">
      %1256 = cute.get_scalars(%e0_3535) : !cute.int_tuple<"?">
      %1257 = cute.get_scalars(%e2_3537) : !cute.int_tuple<"?">
      %tile_3539 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]">
      %coord_3540 = cute.make_coord(%117, %1027) : (i32, i32) -> !cute.coord<"(?,?)">
      %1258:2 = cute.get_scalars(%coord_3540) <{only_dynamic}> : !cute.coord<"(?,?)">
      %coord_3541 = cute.make_coord(%1258#0, %1258#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
      %lay_3542 = cute.get_layout(%view_3528) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %1259:2 = cute.get_scalars(%lay_3542) <{only_dynamic}> : !cute.layout<"(?,?):(1@1,1@3)">
      %c128_i32_3543 = arith.constant 128 : i32
      %1260 = arith.ceildivsi %1259#0, %c128_i32_3543 : i32
      %c64_i32_3544 = arith.constant 64 : i32
      %1261 = arith.ceildivsi %1259#1, %c64_i32_3544 : i32
      %shape_3545 = cute.make_shape(%1260, %1261) : (i32, i32) -> !cute.shape<"((128,64),(?,?))">
      %stride_3546 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,64@3))">
      %lay_3547 = cute.make_layout(%shape_3545, %stride_3546) : !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">
      %idx_3548 = cute.crd2idx(%coord_3541, %lay_3547) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">) -> !cute.int_tuple<"(0,?{div=128},0,?{div=64})">
      %iter_3549 = cute.get_iter(%view_3528) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %tup_3550 = cute.add_offset(%iter_3549, %idx_3548) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,?{div=64})">) -> !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %view_3551 = cute.make_view(%tup_3550) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %iter_3552 = cute.get_iter(%view_3551) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %e0_3553, %e1_3554, %e2_3555, %e3_3556 = cute.get_leaves(%iter_3552) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %1262 = cute.get_scalars(%e0_3553) : !cute.int_tuple<"?">
      %1263 = cute.get_scalars(%e1_3554) : !cute.int_tuple<"?{div=128}">
      %1264 = cute.get_scalars(%e2_3555) : !cute.int_tuple<"?">
      %1265 = cute.get_scalars(%e3_3556) : !cute.int_tuple<"?{div=64}">
      %coord_3557 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_3558 = cute.get_iter(%view_3551) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %1266 = cute.get_scalars(%coord_3557) <{only_dynamic}> : !cute.coord<"?">
      %c32_i32_3559 = arith.constant 32 : i32
      %1267 = arith.remsi %1266, %c32_i32_3559 : i32
      %c32_i32_3560 = arith.constant 32 : i32
      %1268 = arith.divsi %1266, %c32_i32_3560 : i32
      %c4_i32_3561 = arith.constant 4 : i32
      %1269 = arith.remsi %1268, %c4_i32_3561 : i32
      %c32_i32_3562 = arith.constant 32 : i32
      %1270 = arith.remsi %1267, %c32_i32_3562 : i32
      %c4_i32_3563 = arith.constant 4 : i32
      %1271 = arith.remsi %1269, %c4_i32_3563 : i32
      %c4_i32_3564 = arith.constant 4 : i32
      %1272 = arith.divsi %1270, %c4_i32_3564 : i32
      %c4_i32_3565 = arith.constant 4 : i32
      %1273 = arith.remsi %1270, %c4_i32_3565 : i32
      %c2_i32_3566 = arith.constant 2 : i32
      %1274 = arith.muli %1273, %c2_i32_3566 : i32
      %c16_i32_3567 = arith.constant 16 : i32
      %1275 = arith.muli %1271, %c16_i32_3567 : i32
      %1276 = arith.addi %1272, %1275 : i32
      %iv_3568 = cute.assume(%1274) : (i32) -> !cute.i32<divby 2>
      %int_tuple_3569 = cute.make_int_tuple(%1276, %iv_3568) : (i32, !cute.i32<divby 2>) -> !cute.int_tuple<"(0,?,0,?{div=2})">
      %tup_3570 = cute.add_offset(%iter_3558, %int_tuple_3569) : (!cute.int_tuple<"(?,?{div=128},?,?{div=64})">, !cute.int_tuple<"(0,?,0,?{div=2})">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3571 = cute.make_view(%tup_3570) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %iter_3572 = cute.get_iter(%view_3571) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %e0_3573, %e1_3574, %e2_3575, %e3_3576 = cute.get_leaves(%iter_3572) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1277 = cute.get_scalars(%e0_3573) : !cute.int_tuple<"?">
      %1278 = cute.get_scalars(%e1_3574) : !cute.int_tuple<"?">
      %1279 = cute.get_scalars(%e2_3575) : !cute.int_tuple<"?">
      %1280 = cute.get_scalars(%e3_3576) : !cute.int_tuple<"?{div=2}">
      %lay_3577 = cute.get_layout(%view_3571) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %1281 = cute.get_shape(%lay_3577) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3578, %e1_3579, %e2_3580, %e3_3581 = cute.get_leaves(%1281) : !cute.shape<"((2,2),2,8)">
      %shape_3582 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_3583 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %1282 = cute.get_shape(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3584, %e1_3585, %e2_3586, %e3_3587 = cute.get_leaves(%1282) : !cute.shape<"((2,2),2,8)">
      %1283 = cute.get_shape(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3588, %e1_3589, %e2_3590, %e3_3591 = cute.get_leaves(%1283) : !cute.shape<"((2,2),2,8)">
      %1284 = cute.get_shape(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3592, %e1_3593, %e2_3594, %e3_3595 = cute.get_leaves(%1284) : !cute.shape<"((2,2),2,8)">
      %1285 = cute.get_shape(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3596, %e1_3597, %e2_3598, %e3_3599 = cute.get_leaves(%1285) : !cute.shape<"((2,2),2,8)">
      %1286 = cute.get_stride(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3600, %e1_3601, %e2_3602, %e3_3603 = cute.get_leaves(%1286) : !cute.stride<"((1,2),4,8)">
      %1287 = cute.get_stride(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3604, %e1_3605, %e2_3606, %e3_3607 = cute.get_leaves(%1287) : !cute.stride<"((1,2),4,8)">
      %1288 = cute.get_stride(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3608, %e1_3609, %e2_3610, %e3_3611 = cute.get_leaves(%1288) : !cute.stride<"((1,2),4,8)">
      %1289 = cute.get_stride(%lay_3583) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3612, %e1_3613, %e2_3614, %e3_3615 = cute.get_leaves(%1289) : !cute.stride<"((1,2),4,8)">
      %shape_3616 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3617 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3618 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3619 = cute.get_layout(%view_3571) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %lay_3620 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %int_tuple_3621 = cute.make_int_tuple(%e0_3573, %e1_3574, %e2_3575, %e3_3576) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3622 = cute.make_view(%int_tuple_3621, %lay_3620) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %iter_3623 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %e0_3624, %e1_3625, %e2_3626, %e3_3627 = cute.get_leaves(%iter_3623) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1290 = cute.get_scalars(%e0_3624) : !cute.int_tuple<"?">
      %1291 = cute.get_scalars(%e1_3625) : !cute.int_tuple<"?">
      %1292 = cute.get_scalars(%e2_3626) : !cute.int_tuple<"?">
      %1293 = cute.get_scalars(%e3_3627) : !cute.int_tuple<"?{div=2}">
      %lay_3628 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
      %sz_3629 = cute.size(%lay_3628) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_3630 = cute.get_leaves(%sz_3629) : !cute.int_tuple<"4">
      %lay_3631 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %1294 = cute.get_shape(%lay_3631) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3632, %e1_3633, %e2_3634, %e3_3635 = cute.get_leaves(%1294) : !cute.shape<"((2,2),(2,8))">
      %int_tuple_3636 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3637 = cute.size(%int_tuple_3636) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3638 = cute.get_leaves(%sz_3637) : !cute.int_tuple<"16">
      %coord_3639 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3640 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3641 = cute.crd2idx(%coord_3639, %lay_3640) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3642 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3643 = cute.add_offset(%iter_3642, %idx_3641) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3644 = cute.make_view(%tup_3643) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3645 = cute.get_iter(%view_3644) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3646, %e1_3647, %e2_3648, %e3_3649 = cute.get_leaves(%iter_3645) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1295 = cute.get_scalars(%e0_3646) : !cute.int_tuple<"?">
      %1296 = cute.get_scalars(%e1_3647) : !cute.int_tuple<"?">
      %1297 = cute.get_scalars(%e2_3648) : !cute.int_tuple<"?">
      %1298 = cute.get_scalars(%e3_3649) : !cute.int_tuple<"?{div=2}">
      %iter_3650 = cute.get_iter(%view_3644) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3651, %e1_3652, %e2_3653, %e3_3654 = cute.get_leaves(%iter_3650) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1299 = cute.get_scalars(%e0_3651) : !cute.int_tuple<"?">
      %1300 = cute.get_scalars(%e1_3652) : !cute.int_tuple<"?">
      %1301 = cute.get_scalars(%e2_3653) : !cute.int_tuple<"?">
      %1302 = cute.get_scalars(%e3_3654) : !cute.int_tuple<"?{div=2}">
      %iter_3655 = cute.get_iter(%view_3644) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3656, %e1_3657, %e2_3658, %e3_3659 = cute.get_leaves(%iter_3655) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1303 = cute.get_scalars(%e0_3656) : !cute.int_tuple<"?">
      %1304 = cute.get_scalars(%e1_3657) : !cute.int_tuple<"?">
      %1305 = cute.get_scalars(%e2_3658) : !cute.int_tuple<"?">
      %1306 = cute.get_scalars(%e3_3659) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3660 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3661 = cute.add_offset(%e3_3659, %int_tuple_3660) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1307 = cute.get_scalars(%tup_3661) : !cute.int_tuple<"?">
      %coord_3662 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3663 = cute.make_coord(%tup_3661) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1308 = cute.get_scalars(%coord_3662) : !cute.coord<"?">
      %1309 = cute.get_scalars(%coord_3663) : !cute.coord<"?">
      %true_3664 = arith.constant true
      %1310 = arith.cmpi slt, %1308, %1309 : i32
      %1311 = arith.andi %true_3664, %1310 : i1
      %lay_3665 = cute.get_layout(%view_3444) : !memref_rmem_f32_4
      %1312 = cute.get_shape(%lay_3665) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3666, %e1_3667, %e2_3668, %e3_3669 = cute.get_leaves(%1312) : !cute.shape<"((2,2),(2,8))">
      %1313 = cute.get_stride(%lay_3665) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3670, %e1_3671, %e2_3672, %e3_3673 = cute.get_leaves(%1313) : !cute.stride<"((2,4),(1,8))">
      %1314 = scf.if %1311 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%view_3444) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,0)">
        cute.memref.store(%view_3444, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,0)">, f32) -> ()
        %lay_8607 = cute.get_layout(%view_3444) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_3444 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%view_3444) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%view_3444) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_3444 : !memref_rmem_f32_4
      }
      %iter_3674 = cute.get_iter(%1314) : !memref_rmem_f32_4
      %lay_3675 = cute.get_layout(%1314) : !memref_rmem_f32_4
      %1315 = cute.get_shape(%lay_3675) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3676, %e1_3677, %e2_3678, %e3_3679 = cute.get_leaves(%1315) : !cute.shape<"((2,2),(2,8))">
      %1316 = cute.get_stride(%lay_3675) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3680, %e1_3681, %e2_3682, %e3_3683 = cute.get_leaves(%1316) : !cute.stride<"((2,4),(1,8))">
      %iter_3684 = cute.get_iter(%1314) : !memref_rmem_f32_4
      %iter_3685 = cute.get_iter(%1314) : !memref_rmem_f32_4
      %coord_3686 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3687 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3688 = cute.crd2idx(%coord_3686, %lay_3687) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3689 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3690 = cute.add_offset(%iter_3689, %idx_3688) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3691 = cute.make_view(%tup_3690) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3692 = cute.get_iter(%view_3691) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3693, %e1_3694, %e2_3695, %e3_3696 = cute.get_leaves(%iter_3692) : !cute.int_tuple<"(?,?,?,?)">
      %1317 = cute.get_scalars(%e0_3693) : !cute.int_tuple<"?">
      %1318 = cute.get_scalars(%e1_3694) : !cute.int_tuple<"?">
      %1319 = cute.get_scalars(%e2_3695) : !cute.int_tuple<"?">
      %1320 = cute.get_scalars(%e3_3696) : !cute.int_tuple<"?">
      %iter_3697 = cute.get_iter(%view_3691) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3698, %e1_3699, %e2_3700, %e3_3701 = cute.get_leaves(%iter_3697) : !cute.int_tuple<"(?,?,?,?)">
      %1321 = cute.get_scalars(%e0_3698) : !cute.int_tuple<"?">
      %1322 = cute.get_scalars(%e1_3699) : !cute.int_tuple<"?">
      %1323 = cute.get_scalars(%e2_3700) : !cute.int_tuple<"?">
      %1324 = cute.get_scalars(%e3_3701) : !cute.int_tuple<"?">
      %iter_3702 = cute.get_iter(%view_3691) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3703, %e1_3704, %e2_3705, %e3_3706 = cute.get_leaves(%iter_3702) : !cute.int_tuple<"(?,?,?,?)">
      %1325 = cute.get_scalars(%e0_3703) : !cute.int_tuple<"?">
      %1326 = cute.get_scalars(%e1_3704) : !cute.int_tuple<"?">
      %1327 = cute.get_scalars(%e2_3705) : !cute.int_tuple<"?">
      %1328 = cute.get_scalars(%e3_3706) : !cute.int_tuple<"?">
      %int_tuple_3707 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3708 = cute.add_offset(%e3_3706, %int_tuple_3707) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1329 = cute.get_scalars(%tup_3708) : !cute.int_tuple<"?">
      %coord_3709 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3710 = cute.make_coord(%tup_3708) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1330 = cute.get_scalars(%coord_3709) : !cute.coord<"?">
      %1331 = cute.get_scalars(%coord_3710) : !cute.coord<"?">
      %true_3711 = arith.constant true
      %1332 = arith.cmpi slt, %1330, %1331 : i32
      %1333 = arith.andi %true_3711, %1332 : i1
      %lay_3712 = cute.get_layout(%1314) : !memref_rmem_f32_4
      %1334 = cute.get_shape(%lay_3712) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3713, %e1_3714, %e2_3715, %e3_3716 = cute.get_leaves(%1334) : !cute.shape<"((2,2),(2,8))">
      %1335 = cute.get_stride(%lay_3712) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3717, %e1_3718, %e2_3719, %e3_3720 = cute.get_leaves(%1335) : !cute.stride<"((2,4),(1,8))">
      %1336 = scf.if %1333 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1314) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,1)">
        cute.memref.store(%1314, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,1)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1314) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1314 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1314) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1314) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1314 : !memref_rmem_f32_4
      }
      %iter_3721 = cute.get_iter(%1336) : !memref_rmem_f32_4
      %lay_3722 = cute.get_layout(%1336) : !memref_rmem_f32_4
      %1337 = cute.get_shape(%lay_3722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3723, %e1_3724, %e2_3725, %e3_3726 = cute.get_leaves(%1337) : !cute.shape<"((2,2),(2,8))">
      %1338 = cute.get_stride(%lay_3722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3727, %e1_3728, %e2_3729, %e3_3730 = cute.get_leaves(%1338) : !cute.stride<"((2,4),(1,8))">
      %iter_3731 = cute.get_iter(%1336) : !memref_rmem_f32_4
      %iter_3732 = cute.get_iter(%1336) : !memref_rmem_f32_4
      %coord_3733 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3734 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3735 = cute.crd2idx(%coord_3733, %lay_3734) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3736 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3737 = cute.add_offset(%iter_3736, %idx_3735) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3738 = cute.make_view(%tup_3737) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3739 = cute.get_iter(%view_3738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3740, %e1_3741, %e2_3742, %e3_3743 = cute.get_leaves(%iter_3739) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1339 = cute.get_scalars(%e0_3740) : !cute.int_tuple<"?">
      %1340 = cute.get_scalars(%e1_3741) : !cute.int_tuple<"?">
      %1341 = cute.get_scalars(%e2_3742) : !cute.int_tuple<"?">
      %1342 = cute.get_scalars(%e3_3743) : !cute.int_tuple<"?{div=2}">
      %iter_3744 = cute.get_iter(%view_3738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3745, %e1_3746, %e2_3747, %e3_3748 = cute.get_leaves(%iter_3744) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1343 = cute.get_scalars(%e0_3745) : !cute.int_tuple<"?">
      %1344 = cute.get_scalars(%e1_3746) : !cute.int_tuple<"?">
      %1345 = cute.get_scalars(%e2_3747) : !cute.int_tuple<"?">
      %1346 = cute.get_scalars(%e3_3748) : !cute.int_tuple<"?{div=2}">
      %iter_3749 = cute.get_iter(%view_3738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3750, %e1_3751, %e2_3752, %e3_3753 = cute.get_leaves(%iter_3749) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1347 = cute.get_scalars(%e0_3750) : !cute.int_tuple<"?">
      %1348 = cute.get_scalars(%e1_3751) : !cute.int_tuple<"?">
      %1349 = cute.get_scalars(%e2_3752) : !cute.int_tuple<"?">
      %1350 = cute.get_scalars(%e3_3753) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3754 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3755 = cute.add_offset(%e3_3753, %int_tuple_3754) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1351 = cute.get_scalars(%tup_3755) : !cute.int_tuple<"?">
      %coord_3756 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3757 = cute.make_coord(%tup_3755) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1352 = cute.get_scalars(%coord_3756) : !cute.coord<"?">
      %1353 = cute.get_scalars(%coord_3757) : !cute.coord<"?">
      %true_3758 = arith.constant true
      %1354 = arith.cmpi slt, %1352, %1353 : i32
      %1355 = arith.andi %true_3758, %1354 : i1
      %lay_3759 = cute.get_layout(%1336) : !memref_rmem_f32_4
      %1356 = cute.get_shape(%lay_3759) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3760, %e1_3761, %e2_3762, %e3_3763 = cute.get_leaves(%1356) : !cute.shape<"((2,2),(2,8))">
      %1357 = cute.get_stride(%lay_3759) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3764, %e1_3765, %e2_3766, %e3_3767 = cute.get_leaves(%1357) : !cute.stride<"((2,4),(1,8))">
      %1358 = scf.if %1355 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1336) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,2)">
        cute.memref.store(%1336, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,2)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1336) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1336 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1336) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1336) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1336 : !memref_rmem_f32_4
      }
      %iter_3768 = cute.get_iter(%1358) : !memref_rmem_f32_4
      %lay_3769 = cute.get_layout(%1358) : !memref_rmem_f32_4
      %1359 = cute.get_shape(%lay_3769) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3770, %e1_3771, %e2_3772, %e3_3773 = cute.get_leaves(%1359) : !cute.shape<"((2,2),(2,8))">
      %1360 = cute.get_stride(%lay_3769) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3774, %e1_3775, %e2_3776, %e3_3777 = cute.get_leaves(%1360) : !cute.stride<"((2,4),(1,8))">
      %iter_3778 = cute.get_iter(%1358) : !memref_rmem_f32_4
      %iter_3779 = cute.get_iter(%1358) : !memref_rmem_f32_4
      %coord_3780 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_3781 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3782 = cute.crd2idx(%coord_3780, %lay_3781) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_3783 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3784 = cute.add_offset(%iter_3783, %idx_3782) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3785 = cute.make_view(%tup_3784) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3786 = cute.get_iter(%view_3785) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3787, %e1_3788, %e2_3789, %e3_3790 = cute.get_leaves(%iter_3786) : !cute.int_tuple<"(?,?,?,?)">
      %1361 = cute.get_scalars(%e0_3787) : !cute.int_tuple<"?">
      %1362 = cute.get_scalars(%e1_3788) : !cute.int_tuple<"?">
      %1363 = cute.get_scalars(%e2_3789) : !cute.int_tuple<"?">
      %1364 = cute.get_scalars(%e3_3790) : !cute.int_tuple<"?">
      %iter_3791 = cute.get_iter(%view_3785) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3792, %e1_3793, %e2_3794, %e3_3795 = cute.get_leaves(%iter_3791) : !cute.int_tuple<"(?,?,?,?)">
      %1365 = cute.get_scalars(%e0_3792) : !cute.int_tuple<"?">
      %1366 = cute.get_scalars(%e1_3793) : !cute.int_tuple<"?">
      %1367 = cute.get_scalars(%e2_3794) : !cute.int_tuple<"?">
      %1368 = cute.get_scalars(%e3_3795) : !cute.int_tuple<"?">
      %iter_3796 = cute.get_iter(%view_3785) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3797, %e1_3798, %e2_3799, %e3_3800 = cute.get_leaves(%iter_3796) : !cute.int_tuple<"(?,?,?,?)">
      %1369 = cute.get_scalars(%e0_3797) : !cute.int_tuple<"?">
      %1370 = cute.get_scalars(%e1_3798) : !cute.int_tuple<"?">
      %1371 = cute.get_scalars(%e2_3799) : !cute.int_tuple<"?">
      %1372 = cute.get_scalars(%e3_3800) : !cute.int_tuple<"?">
      %int_tuple_3801 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3802 = cute.add_offset(%e3_3800, %int_tuple_3801) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1373 = cute.get_scalars(%tup_3802) : !cute.int_tuple<"?">
      %coord_3803 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3804 = cute.make_coord(%tup_3802) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1374 = cute.get_scalars(%coord_3803) : !cute.coord<"?">
      %1375 = cute.get_scalars(%coord_3804) : !cute.coord<"?">
      %true_3805 = arith.constant true
      %1376 = arith.cmpi slt, %1374, %1375 : i32
      %1377 = arith.andi %true_3805, %1376 : i1
      %lay_3806 = cute.get_layout(%1358) : !memref_rmem_f32_4
      %1378 = cute.get_shape(%lay_3806) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3807, %e1_3808, %e2_3809, %e3_3810 = cute.get_leaves(%1378) : !cute.shape<"((2,2),(2,8))">
      %1379 = cute.get_stride(%lay_3806) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3811, %e1_3812, %e2_3813, %e3_3814 = cute.get_leaves(%1379) : !cute.stride<"((2,4),(1,8))">
      %1380 = scf.if %1377 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1358) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,3)">
        cute.memref.store(%1358, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,3)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1358) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1358 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1358) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1358) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1358 : !memref_rmem_f32_4
      }
      %iter_3815 = cute.get_iter(%1380) : !memref_rmem_f32_4
      %lay_3816 = cute.get_layout(%1380) : !memref_rmem_f32_4
      %1381 = cute.get_shape(%lay_3816) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3817, %e1_3818, %e2_3819, %e3_3820 = cute.get_leaves(%1381) : !cute.shape<"((2,2),(2,8))">
      %1382 = cute.get_stride(%lay_3816) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3821, %e1_3822, %e2_3823, %e3_3824 = cute.get_leaves(%1382) : !cute.stride<"((2,4),(1,8))">
      %iter_3825 = cute.get_iter(%1380) : !memref_rmem_f32_4
      %iter_3826 = cute.get_iter(%1380) : !memref_rmem_f32_4
      %coord_3827 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_3828 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3829 = cute.crd2idx(%coord_3827, %lay_3828) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_3830 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3831 = cute.add_offset(%iter_3830, %idx_3829) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3832 = cute.make_view(%tup_3831) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3833 = cute.get_iter(%view_3832) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3834, %e1_3835, %e2_3836, %e3_3837 = cute.get_leaves(%iter_3833) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1383 = cute.get_scalars(%e0_3834) : !cute.int_tuple<"?">
      %1384 = cute.get_scalars(%e1_3835) : !cute.int_tuple<"?">
      %1385 = cute.get_scalars(%e2_3836) : !cute.int_tuple<"?">
      %1386 = cute.get_scalars(%e3_3837) : !cute.int_tuple<"?{div=2}">
      %iter_3838 = cute.get_iter(%view_3832) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3839, %e1_3840, %e2_3841, %e3_3842 = cute.get_leaves(%iter_3838) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1387 = cute.get_scalars(%e0_3839) : !cute.int_tuple<"?">
      %1388 = cute.get_scalars(%e1_3840) : !cute.int_tuple<"?">
      %1389 = cute.get_scalars(%e2_3841) : !cute.int_tuple<"?">
      %1390 = cute.get_scalars(%e3_3842) : !cute.int_tuple<"?{div=2}">
      %iter_3843 = cute.get_iter(%view_3832) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3844, %e1_3845, %e2_3846, %e3_3847 = cute.get_leaves(%iter_3843) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1391 = cute.get_scalars(%e0_3844) : !cute.int_tuple<"?">
      %1392 = cute.get_scalars(%e1_3845) : !cute.int_tuple<"?">
      %1393 = cute.get_scalars(%e2_3846) : !cute.int_tuple<"?">
      %1394 = cute.get_scalars(%e3_3847) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3848 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3849 = cute.add_offset(%e3_3847, %int_tuple_3848) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1395 = cute.get_scalars(%tup_3849) : !cute.int_tuple<"?">
      %coord_3850 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3851 = cute.make_coord(%tup_3849) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1396 = cute.get_scalars(%coord_3850) : !cute.coord<"?">
      %1397 = cute.get_scalars(%coord_3851) : !cute.coord<"?">
      %true_3852 = arith.constant true
      %1398 = arith.cmpi slt, %1396, %1397 : i32
      %1399 = arith.andi %true_3852, %1398 : i1
      %lay_3853 = cute.get_layout(%1380) : !memref_rmem_f32_4
      %1400 = cute.get_shape(%lay_3853) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3854, %e1_3855, %e2_3856, %e3_3857 = cute.get_leaves(%1400) : !cute.shape<"((2,2),(2,8))">
      %1401 = cute.get_stride(%lay_3853) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3858, %e1_3859, %e2_3860, %e3_3861 = cute.get_leaves(%1401) : !cute.stride<"((2,4),(1,8))">
      %1402 = scf.if %1399 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1380) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,4)">
        cute.memref.store(%1380, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,4)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1380) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1380 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1380) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1380) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1380 : !memref_rmem_f32_4
      }
      %iter_3862 = cute.get_iter(%1402) : !memref_rmem_f32_4
      %lay_3863 = cute.get_layout(%1402) : !memref_rmem_f32_4
      %1403 = cute.get_shape(%lay_3863) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3864, %e1_3865, %e2_3866, %e3_3867 = cute.get_leaves(%1403) : !cute.shape<"((2,2),(2,8))">
      %1404 = cute.get_stride(%lay_3863) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3868, %e1_3869, %e2_3870, %e3_3871 = cute.get_leaves(%1404) : !cute.stride<"((2,4),(1,8))">
      %iter_3872 = cute.get_iter(%1402) : !memref_rmem_f32_4
      %iter_3873 = cute.get_iter(%1402) : !memref_rmem_f32_4
      %coord_3874 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_3875 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3876 = cute.crd2idx(%coord_3874, %lay_3875) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_3877 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3878 = cute.add_offset(%iter_3877, %idx_3876) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3879 = cute.make_view(%tup_3878) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3880 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3881, %e1_3882, %e2_3883, %e3_3884 = cute.get_leaves(%iter_3880) : !cute.int_tuple<"(?,?,?,?)">
      %1405 = cute.get_scalars(%e0_3881) : !cute.int_tuple<"?">
      %1406 = cute.get_scalars(%e1_3882) : !cute.int_tuple<"?">
      %1407 = cute.get_scalars(%e2_3883) : !cute.int_tuple<"?">
      %1408 = cute.get_scalars(%e3_3884) : !cute.int_tuple<"?">
      %iter_3885 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3886, %e1_3887, %e2_3888, %e3_3889 = cute.get_leaves(%iter_3885) : !cute.int_tuple<"(?,?,?,?)">
      %1409 = cute.get_scalars(%e0_3886) : !cute.int_tuple<"?">
      %1410 = cute.get_scalars(%e1_3887) : !cute.int_tuple<"?">
      %1411 = cute.get_scalars(%e2_3888) : !cute.int_tuple<"?">
      %1412 = cute.get_scalars(%e3_3889) : !cute.int_tuple<"?">
      %iter_3890 = cute.get_iter(%view_3879) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3891, %e1_3892, %e2_3893, %e3_3894 = cute.get_leaves(%iter_3890) : !cute.int_tuple<"(?,?,?,?)">
      %1413 = cute.get_scalars(%e0_3891) : !cute.int_tuple<"?">
      %1414 = cute.get_scalars(%e1_3892) : !cute.int_tuple<"?">
      %1415 = cute.get_scalars(%e2_3893) : !cute.int_tuple<"?">
      %1416 = cute.get_scalars(%e3_3894) : !cute.int_tuple<"?">
      %int_tuple_3895 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3896 = cute.add_offset(%e3_3894, %int_tuple_3895) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1417 = cute.get_scalars(%tup_3896) : !cute.int_tuple<"?">
      %coord_3897 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3898 = cute.make_coord(%tup_3896) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1418 = cute.get_scalars(%coord_3897) : !cute.coord<"?">
      %1419 = cute.get_scalars(%coord_3898) : !cute.coord<"?">
      %true_3899 = arith.constant true
      %1420 = arith.cmpi slt, %1418, %1419 : i32
      %1421 = arith.andi %true_3899, %1420 : i1
      %lay_3900 = cute.get_layout(%1402) : !memref_rmem_f32_4
      %1422 = cute.get_shape(%lay_3900) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3901, %e1_3902, %e2_3903, %e3_3904 = cute.get_leaves(%1422) : !cute.shape<"((2,2),(2,8))">
      %1423 = cute.get_stride(%lay_3900) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3905, %e1_3906, %e2_3907, %e3_3908 = cute.get_leaves(%1423) : !cute.stride<"((2,4),(1,8))">
      %1424 = scf.if %1421 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1402) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,5)">
        cute.memref.store(%1402, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,5)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1402) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1402 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1402) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1402) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1402 : !memref_rmem_f32_4
      }
      %iter_3909 = cute.get_iter(%1424) : !memref_rmem_f32_4
      %lay_3910 = cute.get_layout(%1424) : !memref_rmem_f32_4
      %1425 = cute.get_shape(%lay_3910) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3911, %e1_3912, %e2_3913, %e3_3914 = cute.get_leaves(%1425) : !cute.shape<"((2,2),(2,8))">
      %1426 = cute.get_stride(%lay_3910) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3915, %e1_3916, %e2_3917, %e3_3918 = cute.get_leaves(%1426) : !cute.stride<"((2,4),(1,8))">
      %iter_3919 = cute.get_iter(%1424) : !memref_rmem_f32_4
      %iter_3920 = cute.get_iter(%1424) : !memref_rmem_f32_4
      %coord_3921 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_3922 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3923 = cute.crd2idx(%coord_3921, %lay_3922) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_3924 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3925 = cute.add_offset(%iter_3924, %idx_3923) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3926 = cute.make_view(%tup_3925) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3927 = cute.get_iter(%view_3926) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3928, %e1_3929, %e2_3930, %e3_3931 = cute.get_leaves(%iter_3927) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1427 = cute.get_scalars(%e0_3928) : !cute.int_tuple<"?">
      %1428 = cute.get_scalars(%e1_3929) : !cute.int_tuple<"?">
      %1429 = cute.get_scalars(%e2_3930) : !cute.int_tuple<"?">
      %1430 = cute.get_scalars(%e3_3931) : !cute.int_tuple<"?{div=2}">
      %iter_3932 = cute.get_iter(%view_3926) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3933, %e1_3934, %e2_3935, %e3_3936 = cute.get_leaves(%iter_3932) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1431 = cute.get_scalars(%e0_3933) : !cute.int_tuple<"?">
      %1432 = cute.get_scalars(%e1_3934) : !cute.int_tuple<"?">
      %1433 = cute.get_scalars(%e2_3935) : !cute.int_tuple<"?">
      %1434 = cute.get_scalars(%e3_3936) : !cute.int_tuple<"?{div=2}">
      %iter_3937 = cute.get_iter(%view_3926) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3938, %e1_3939, %e2_3940, %e3_3941 = cute.get_leaves(%iter_3937) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1435 = cute.get_scalars(%e0_3938) : !cute.int_tuple<"?">
      %1436 = cute.get_scalars(%e1_3939) : !cute.int_tuple<"?">
      %1437 = cute.get_scalars(%e2_3940) : !cute.int_tuple<"?">
      %1438 = cute.get_scalars(%e3_3941) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3942 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3943 = cute.add_offset(%e3_3941, %int_tuple_3942) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1439 = cute.get_scalars(%tup_3943) : !cute.int_tuple<"?">
      %coord_3944 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3945 = cute.make_coord(%tup_3943) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1440 = cute.get_scalars(%coord_3944) : !cute.coord<"?">
      %1441 = cute.get_scalars(%coord_3945) : !cute.coord<"?">
      %true_3946 = arith.constant true
      %1442 = arith.cmpi slt, %1440, %1441 : i32
      %1443 = arith.andi %true_3946, %1442 : i1
      %lay_3947 = cute.get_layout(%1424) : !memref_rmem_f32_4
      %1444 = cute.get_shape(%lay_3947) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3948, %e1_3949, %e2_3950, %e3_3951 = cute.get_leaves(%1444) : !cute.shape<"((2,2),(2,8))">
      %1445 = cute.get_stride(%lay_3947) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3952, %e1_3953, %e2_3954, %e3_3955 = cute.get_leaves(%1445) : !cute.stride<"((2,4),(1,8))">
      %1446 = scf.if %1443 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1424) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,6)">
        cute.memref.store(%1424, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,6)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1424) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1424 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1424) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1424) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1424 : !memref_rmem_f32_4
      }
      %iter_3956 = cute.get_iter(%1446) : !memref_rmem_f32_4
      %lay_3957 = cute.get_layout(%1446) : !memref_rmem_f32_4
      %1447 = cute.get_shape(%lay_3957) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3958, %e1_3959, %e2_3960, %e3_3961 = cute.get_leaves(%1447) : !cute.shape<"((2,2),(2,8))">
      %1448 = cute.get_stride(%lay_3957) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3962, %e1_3963, %e2_3964, %e3_3965 = cute.get_leaves(%1448) : !cute.stride<"((2,4),(1,8))">
      %iter_3966 = cute.get_iter(%1446) : !memref_rmem_f32_4
      %iter_3967 = cute.get_iter(%1446) : !memref_rmem_f32_4
      %coord_3968 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_3969 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3970 = cute.crd2idx(%coord_3968, %lay_3969) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_3971 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3972 = cute.add_offset(%iter_3971, %idx_3970) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3973 = cute.make_view(%tup_3972) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3974 = cute.get_iter(%view_3973) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3975, %e1_3976, %e2_3977, %e3_3978 = cute.get_leaves(%iter_3974) : !cute.int_tuple<"(?,?,?,?)">
      %1449 = cute.get_scalars(%e0_3975) : !cute.int_tuple<"?">
      %1450 = cute.get_scalars(%e1_3976) : !cute.int_tuple<"?">
      %1451 = cute.get_scalars(%e2_3977) : !cute.int_tuple<"?">
      %1452 = cute.get_scalars(%e3_3978) : !cute.int_tuple<"?">
      %iter_3979 = cute.get_iter(%view_3973) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3980, %e1_3981, %e2_3982, %e3_3983 = cute.get_leaves(%iter_3979) : !cute.int_tuple<"(?,?,?,?)">
      %1453 = cute.get_scalars(%e0_3980) : !cute.int_tuple<"?">
      %1454 = cute.get_scalars(%e1_3981) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e2_3982) : !cute.int_tuple<"?">
      %1456 = cute.get_scalars(%e3_3983) : !cute.int_tuple<"?">
      %iter_3984 = cute.get_iter(%view_3973) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3985, %e1_3986, %e2_3987, %e3_3988 = cute.get_leaves(%iter_3984) : !cute.int_tuple<"(?,?,?,?)">
      %1457 = cute.get_scalars(%e0_3985) : !cute.int_tuple<"?">
      %1458 = cute.get_scalars(%e1_3986) : !cute.int_tuple<"?">
      %1459 = cute.get_scalars(%e2_3987) : !cute.int_tuple<"?">
      %1460 = cute.get_scalars(%e3_3988) : !cute.int_tuple<"?">
      %int_tuple_3989 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3990 = cute.add_offset(%e3_3988, %int_tuple_3989) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1461 = cute.get_scalars(%tup_3990) : !cute.int_tuple<"?">
      %coord_3991 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3992 = cute.make_coord(%tup_3990) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1462 = cute.get_scalars(%coord_3991) : !cute.coord<"?">
      %1463 = cute.get_scalars(%coord_3992) : !cute.coord<"?">
      %true_3993 = arith.constant true
      %1464 = arith.cmpi slt, %1462, %1463 : i32
      %1465 = arith.andi %true_3993, %1464 : i1
      %lay_3994 = cute.get_layout(%1446) : !memref_rmem_f32_4
      %1466 = cute.get_shape(%lay_3994) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3995, %e1_3996, %e2_3997, %e3_3998 = cute.get_leaves(%1466) : !cute.shape<"((2,2),(2,8))">
      %1467 = cute.get_stride(%lay_3994) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3999, %e1_4000, %e2_4001, %e3_4002 = cute.get_leaves(%1467) : !cute.stride<"((2,4),(1,8))">
      %1468 = scf.if %1465 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1446) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,7)">
        cute.memref.store(%1446, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,7)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1446) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1446 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1446) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1446) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1446 : !memref_rmem_f32_4
      }
      %iter_4003 = cute.get_iter(%1468) : !memref_rmem_f32_4
      %lay_4004 = cute.get_layout(%1468) : !memref_rmem_f32_4
      %1469 = cute.get_shape(%lay_4004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4005, %e1_4006, %e2_4007, %e3_4008 = cute.get_leaves(%1469) : !cute.shape<"((2,2),(2,8))">
      %1470 = cute.get_stride(%lay_4004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4009, %e1_4010, %e2_4011, %e3_4012 = cute.get_leaves(%1470) : !cute.stride<"((2,4),(1,8))">
      %iter_4013 = cute.get_iter(%1468) : !memref_rmem_f32_4
      %iter_4014 = cute.get_iter(%1468) : !memref_rmem_f32_4
      %coord_4015 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4016 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4017 = cute.crd2idx(%coord_4015, %lay_4016) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4018 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4019 = cute.add_offset(%iter_4018, %idx_4017) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4020 = cute.make_view(%tup_4019) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4021 = cute.get_iter(%view_4020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4022, %e1_4023, %e2_4024, %e3_4025 = cute.get_leaves(%iter_4021) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1471 = cute.get_scalars(%e0_4022) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e1_4023) : !cute.int_tuple<"?">
      %1473 = cute.get_scalars(%e2_4024) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e3_4025) : !cute.int_tuple<"?{div=2}">
      %iter_4026 = cute.get_iter(%view_4020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4027, %e1_4028, %e2_4029, %e3_4030 = cute.get_leaves(%iter_4026) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1475 = cute.get_scalars(%e0_4027) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e1_4028) : !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%e2_4029) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e3_4030) : !cute.int_tuple<"?{div=2}">
      %iter_4031 = cute.get_iter(%view_4020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4032, %e1_4033, %e2_4034, %e3_4035 = cute.get_leaves(%iter_4031) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1479 = cute.get_scalars(%e0_4032) : !cute.int_tuple<"?">
      %1480 = cute.get_scalars(%e1_4033) : !cute.int_tuple<"?">
      %1481 = cute.get_scalars(%e2_4034) : !cute.int_tuple<"?">
      %1482 = cute.get_scalars(%e3_4035) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4036 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4037 = cute.add_offset(%e3_4035, %int_tuple_4036) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1483 = cute.get_scalars(%tup_4037) : !cute.int_tuple<"?">
      %coord_4038 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4039 = cute.make_coord(%tup_4037) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1484 = cute.get_scalars(%coord_4038) : !cute.coord<"?">
      %1485 = cute.get_scalars(%coord_4039) : !cute.coord<"?">
      %true_4040 = arith.constant true
      %1486 = arith.cmpi slt, %1484, %1485 : i32
      %1487 = arith.andi %true_4040, %1486 : i1
      %lay_4041 = cute.get_layout(%1468) : !memref_rmem_f32_4
      %1488 = cute.get_shape(%lay_4041) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4042, %e1_4043, %e2_4044, %e3_4045 = cute.get_leaves(%1488) : !cute.shape<"((2,2),(2,8))">
      %1489 = cute.get_stride(%lay_4041) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4046, %e1_4047, %e2_4048, %e3_4049 = cute.get_leaves(%1489) : !cute.stride<"((2,4),(1,8))">
      %1490 = scf.if %1487 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1468) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,8)">
        cute.memref.store(%1468, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,8)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1468) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1468 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1468) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1468) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1468 : !memref_rmem_f32_4
      }
      %iter_4050 = cute.get_iter(%1490) : !memref_rmem_f32_4
      %lay_4051 = cute.get_layout(%1490) : !memref_rmem_f32_4
      %1491 = cute.get_shape(%lay_4051) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4052, %e1_4053, %e2_4054, %e3_4055 = cute.get_leaves(%1491) : !cute.shape<"((2,2),(2,8))">
      %1492 = cute.get_stride(%lay_4051) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4056, %e1_4057, %e2_4058, %e3_4059 = cute.get_leaves(%1492) : !cute.stride<"((2,4),(1,8))">
      %iter_4060 = cute.get_iter(%1490) : !memref_rmem_f32_4
      %iter_4061 = cute.get_iter(%1490) : !memref_rmem_f32_4
      %coord_4062 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4063 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4064 = cute.crd2idx(%coord_4062, %lay_4063) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4065 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4066 = cute.add_offset(%iter_4065, %idx_4064) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4067 = cute.make_view(%tup_4066) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4068 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4069, %e1_4070, %e2_4071, %e3_4072 = cute.get_leaves(%iter_4068) : !cute.int_tuple<"(?,?,?,?)">
      %1493 = cute.get_scalars(%e0_4069) : !cute.int_tuple<"?">
      %1494 = cute.get_scalars(%e1_4070) : !cute.int_tuple<"?">
      %1495 = cute.get_scalars(%e2_4071) : !cute.int_tuple<"?">
      %1496 = cute.get_scalars(%e3_4072) : !cute.int_tuple<"?">
      %iter_4073 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4074, %e1_4075, %e2_4076, %e3_4077 = cute.get_leaves(%iter_4073) : !cute.int_tuple<"(?,?,?,?)">
      %1497 = cute.get_scalars(%e0_4074) : !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%e1_4075) : !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%e2_4076) : !cute.int_tuple<"?">
      %1500 = cute.get_scalars(%e3_4077) : !cute.int_tuple<"?">
      %iter_4078 = cute.get_iter(%view_4067) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4079, %e1_4080, %e2_4081, %e3_4082 = cute.get_leaves(%iter_4078) : !cute.int_tuple<"(?,?,?,?)">
      %1501 = cute.get_scalars(%e0_4079) : !cute.int_tuple<"?">
      %1502 = cute.get_scalars(%e1_4080) : !cute.int_tuple<"?">
      %1503 = cute.get_scalars(%e2_4081) : !cute.int_tuple<"?">
      %1504 = cute.get_scalars(%e3_4082) : !cute.int_tuple<"?">
      %int_tuple_4083 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4084 = cute.add_offset(%e3_4082, %int_tuple_4083) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1505 = cute.get_scalars(%tup_4084) : !cute.int_tuple<"?">
      %coord_4085 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4086 = cute.make_coord(%tup_4084) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1506 = cute.get_scalars(%coord_4085) : !cute.coord<"?">
      %1507 = cute.get_scalars(%coord_4086) : !cute.coord<"?">
      %true_4087 = arith.constant true
      %1508 = arith.cmpi slt, %1506, %1507 : i32
      %1509 = arith.andi %true_4087, %1508 : i1
      %lay_4088 = cute.get_layout(%1490) : !memref_rmem_f32_4
      %1510 = cute.get_shape(%lay_4088) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4089, %e1_4090, %e2_4091, %e3_4092 = cute.get_leaves(%1510) : !cute.shape<"((2,2),(2,8))">
      %1511 = cute.get_stride(%lay_4088) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4093, %e1_4094, %e2_4095, %e3_4096 = cute.get_leaves(%1511) : !cute.stride<"((2,4),(1,8))">
      %1512 = scf.if %1509 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1490) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,9)">
        cute.memref.store(%1490, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,9)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1490) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1490 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1490) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1490) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1490 : !memref_rmem_f32_4
      }
      %iter_4097 = cute.get_iter(%1512) : !memref_rmem_f32_4
      %lay_4098 = cute.get_layout(%1512) : !memref_rmem_f32_4
      %1513 = cute.get_shape(%lay_4098) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4099, %e1_4100, %e2_4101, %e3_4102 = cute.get_leaves(%1513) : !cute.shape<"((2,2),(2,8))">
      %1514 = cute.get_stride(%lay_4098) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4103, %e1_4104, %e2_4105, %e3_4106 = cute.get_leaves(%1514) : !cute.stride<"((2,4),(1,8))">
      %iter_4107 = cute.get_iter(%1512) : !memref_rmem_f32_4
      %iter_4108 = cute.get_iter(%1512) : !memref_rmem_f32_4
      %coord_4109 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4110 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4111 = cute.crd2idx(%coord_4109, %lay_4110) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4112 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4113 = cute.add_offset(%iter_4112, %idx_4111) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4114 = cute.make_view(%tup_4113) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4115 = cute.get_iter(%view_4114) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4116, %e1_4117, %e2_4118, %e3_4119 = cute.get_leaves(%iter_4115) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1515 = cute.get_scalars(%e0_4116) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e1_4117) : !cute.int_tuple<"?">
      %1517 = cute.get_scalars(%e2_4118) : !cute.int_tuple<"?">
      %1518 = cute.get_scalars(%e3_4119) : !cute.int_tuple<"?{div=2}">
      %iter_4120 = cute.get_iter(%view_4114) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4121, %e1_4122, %e2_4123, %e3_4124 = cute.get_leaves(%iter_4120) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1519 = cute.get_scalars(%e0_4121) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e1_4122) : !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%e2_4123) : !cute.int_tuple<"?">
      %1522 = cute.get_scalars(%e3_4124) : !cute.int_tuple<"?{div=2}">
      %iter_4125 = cute.get_iter(%view_4114) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4126, %e1_4127, %e2_4128, %e3_4129 = cute.get_leaves(%iter_4125) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1523 = cute.get_scalars(%e0_4126) : !cute.int_tuple<"?">
      %1524 = cute.get_scalars(%e1_4127) : !cute.int_tuple<"?">
      %1525 = cute.get_scalars(%e2_4128) : !cute.int_tuple<"?">
      %1526 = cute.get_scalars(%e3_4129) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4130 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4131 = cute.add_offset(%e3_4129, %int_tuple_4130) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1527 = cute.get_scalars(%tup_4131) : !cute.int_tuple<"?">
      %coord_4132 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4133 = cute.make_coord(%tup_4131) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1528 = cute.get_scalars(%coord_4132) : !cute.coord<"?">
      %1529 = cute.get_scalars(%coord_4133) : !cute.coord<"?">
      %true_4134 = arith.constant true
      %1530 = arith.cmpi slt, %1528, %1529 : i32
      %1531 = arith.andi %true_4134, %1530 : i1
      %lay_4135 = cute.get_layout(%1512) : !memref_rmem_f32_4
      %1532 = cute.get_shape(%lay_4135) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4136, %e1_4137, %e2_4138, %e3_4139 = cute.get_leaves(%1532) : !cute.shape<"((2,2),(2,8))">
      %1533 = cute.get_stride(%lay_4135) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4140, %e1_4141, %e2_4142, %e3_4143 = cute.get_leaves(%1533) : !cute.stride<"((2,4),(1,8))">
      %1534 = scf.if %1531 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1512) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,10)">
        cute.memref.store(%1512, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,10)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1512) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1512 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1512) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1512) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1512 : !memref_rmem_f32_4
      }
      %iter_4144 = cute.get_iter(%1534) : !memref_rmem_f32_4
      %lay_4145 = cute.get_layout(%1534) : !memref_rmem_f32_4
      %1535 = cute.get_shape(%lay_4145) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4146, %e1_4147, %e2_4148, %e3_4149 = cute.get_leaves(%1535) : !cute.shape<"((2,2),(2,8))">
      %1536 = cute.get_stride(%lay_4145) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1536) : !cute.stride<"((2,4),(1,8))">
      %iter_4154 = cute.get_iter(%1534) : !memref_rmem_f32_4
      %iter_4155 = cute.get_iter(%1534) : !memref_rmem_f32_4
      %coord_4156 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4157 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4158 = cute.crd2idx(%coord_4156, %lay_4157) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4159 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4160 = cute.add_offset(%iter_4159, %idx_4158) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4161 = cute.make_view(%tup_4160) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4162 = cute.get_iter(%view_4161) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4163, %e1_4164, %e2_4165, %e3_4166 = cute.get_leaves(%iter_4162) : !cute.int_tuple<"(?,?,?,?)">
      %1537 = cute.get_scalars(%e0_4163) : !cute.int_tuple<"?">
      %1538 = cute.get_scalars(%e1_4164) : !cute.int_tuple<"?">
      %1539 = cute.get_scalars(%e2_4165) : !cute.int_tuple<"?">
      %1540 = cute.get_scalars(%e3_4166) : !cute.int_tuple<"?">
      %iter_4167 = cute.get_iter(%view_4161) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4168, %e1_4169, %e2_4170, %e3_4171 = cute.get_leaves(%iter_4167) : !cute.int_tuple<"(?,?,?,?)">
      %1541 = cute.get_scalars(%e0_4168) : !cute.int_tuple<"?">
      %1542 = cute.get_scalars(%e1_4169) : !cute.int_tuple<"?">
      %1543 = cute.get_scalars(%e2_4170) : !cute.int_tuple<"?">
      %1544 = cute.get_scalars(%e3_4171) : !cute.int_tuple<"?">
      %iter_4172 = cute.get_iter(%view_4161) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4173, %e1_4174, %e2_4175, %e3_4176 = cute.get_leaves(%iter_4172) : !cute.int_tuple<"(?,?,?,?)">
      %1545 = cute.get_scalars(%e0_4173) : !cute.int_tuple<"?">
      %1546 = cute.get_scalars(%e1_4174) : !cute.int_tuple<"?">
      %1547 = cute.get_scalars(%e2_4175) : !cute.int_tuple<"?">
      %1548 = cute.get_scalars(%e3_4176) : !cute.int_tuple<"?">
      %int_tuple_4177 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4178 = cute.add_offset(%e3_4176, %int_tuple_4177) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1549 = cute.get_scalars(%tup_4178) : !cute.int_tuple<"?">
      %coord_4179 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4180 = cute.make_coord(%tup_4178) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1550 = cute.get_scalars(%coord_4179) : !cute.coord<"?">
      %1551 = cute.get_scalars(%coord_4180) : !cute.coord<"?">
      %true_4181 = arith.constant true
      %1552 = arith.cmpi slt, %1550, %1551 : i32
      %1553 = arith.andi %true_4181, %1552 : i1
      %lay_4182 = cute.get_layout(%1534) : !memref_rmem_f32_4
      %1554 = cute.get_shape(%lay_4182) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4183, %e1_4184, %e2_4185, %e3_4186 = cute.get_leaves(%1554) : !cute.shape<"((2,2),(2,8))">
      %1555 = cute.get_stride(%lay_4182) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4187, %e1_4188, %e2_4189, %e3_4190 = cute.get_leaves(%1555) : !cute.stride<"((2,4),(1,8))">
      %1556 = scf.if %1553 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1534) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,11)">
        cute.memref.store(%1534, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,11)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1534) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1534 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1534) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1534) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1534 : !memref_rmem_f32_4
      }
      %iter_4191 = cute.get_iter(%1556) : !memref_rmem_f32_4
      %lay_4192 = cute.get_layout(%1556) : !memref_rmem_f32_4
      %1557 = cute.get_shape(%lay_4192) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4193, %e1_4194, %e2_4195, %e3_4196 = cute.get_leaves(%1557) : !cute.shape<"((2,2),(2,8))">
      %1558 = cute.get_stride(%lay_4192) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4197, %e1_4198, %e2_4199, %e3_4200 = cute.get_leaves(%1558) : !cute.stride<"((2,4),(1,8))">
      %iter_4201 = cute.get_iter(%1556) : !memref_rmem_f32_4
      %iter_4202 = cute.get_iter(%1556) : !memref_rmem_f32_4
      %coord_4203 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4204 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4205 = cute.crd2idx(%coord_4203, %lay_4204) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4206 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4207 = cute.add_offset(%iter_4206, %idx_4205) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4208 = cute.make_view(%tup_4207) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4209 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4210, %e1_4211, %e2_4212, %e3_4213 = cute.get_leaves(%iter_4209) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1559 = cute.get_scalars(%e0_4210) : !cute.int_tuple<"?">
      %1560 = cute.get_scalars(%e1_4211) : !cute.int_tuple<"?">
      %1561 = cute.get_scalars(%e2_4212) : !cute.int_tuple<"?">
      %1562 = cute.get_scalars(%e3_4213) : !cute.int_tuple<"?{div=2}">
      %iter_4214 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4215, %e1_4216, %e2_4217, %e3_4218 = cute.get_leaves(%iter_4214) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1563 = cute.get_scalars(%e0_4215) : !cute.int_tuple<"?">
      %1564 = cute.get_scalars(%e1_4216) : !cute.int_tuple<"?">
      %1565 = cute.get_scalars(%e2_4217) : !cute.int_tuple<"?">
      %1566 = cute.get_scalars(%e3_4218) : !cute.int_tuple<"?{div=2}">
      %iter_4219 = cute.get_iter(%view_4208) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4220, %e1_4221, %e2_4222, %e3_4223 = cute.get_leaves(%iter_4219) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1567 = cute.get_scalars(%e0_4220) : !cute.int_tuple<"?">
      %1568 = cute.get_scalars(%e1_4221) : !cute.int_tuple<"?">
      %1569 = cute.get_scalars(%e2_4222) : !cute.int_tuple<"?">
      %1570 = cute.get_scalars(%e3_4223) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4224 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4225 = cute.add_offset(%e3_4223, %int_tuple_4224) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1571 = cute.get_scalars(%tup_4225) : !cute.int_tuple<"?">
      %coord_4226 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4227 = cute.make_coord(%tup_4225) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1572 = cute.get_scalars(%coord_4226) : !cute.coord<"?">
      %1573 = cute.get_scalars(%coord_4227) : !cute.coord<"?">
      %true_4228 = arith.constant true
      %1574 = arith.cmpi slt, %1572, %1573 : i32
      %1575 = arith.andi %true_4228, %1574 : i1
      %lay_4229 = cute.get_layout(%1556) : !memref_rmem_f32_4
      %1576 = cute.get_shape(%lay_4229) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4230, %e1_4231, %e2_4232, %e3_4233 = cute.get_leaves(%1576) : !cute.shape<"((2,2),(2,8))">
      %1577 = cute.get_stride(%lay_4229) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4234, %e1_4235, %e2_4236, %e3_4237 = cute.get_leaves(%1577) : !cute.stride<"((2,4),(1,8))">
      %1578 = scf.if %1575 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1556) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,12)">
        cute.memref.store(%1556, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,12)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1556) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1556 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1556) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1556) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1556 : !memref_rmem_f32_4
      }
      %iter_4238 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %lay_4239 = cute.get_layout(%1578) : !memref_rmem_f32_4
      %1579 = cute.get_shape(%lay_4239) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4240, %e1_4241, %e2_4242, %e3_4243 = cute.get_leaves(%1579) : !cute.shape<"((2,2),(2,8))">
      %1580 = cute.get_stride(%lay_4239) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4244, %e1_4245, %e2_4246, %e3_4247 = cute.get_leaves(%1580) : !cute.stride<"((2,4),(1,8))">
      %iter_4248 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %iter_4249 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %coord_4250 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_4251 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4252 = cute.crd2idx(%coord_4250, %lay_4251) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_4253 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4254 = cute.add_offset(%iter_4253, %idx_4252) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4255 = cute.make_view(%tup_4254) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4256 = cute.get_iter(%view_4255) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4257, %e1_4258, %e2_4259, %e3_4260 = cute.get_leaves(%iter_4256) : !cute.int_tuple<"(?,?,?,?)">
      %1581 = cute.get_scalars(%e0_4257) : !cute.int_tuple<"?">
      %1582 = cute.get_scalars(%e1_4258) : !cute.int_tuple<"?">
      %1583 = cute.get_scalars(%e2_4259) : !cute.int_tuple<"?">
      %1584 = cute.get_scalars(%e3_4260) : !cute.int_tuple<"?">
      %iter_4261 = cute.get_iter(%view_4255) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4262, %e1_4263, %e2_4264, %e3_4265 = cute.get_leaves(%iter_4261) : !cute.int_tuple<"(?,?,?,?)">
      %1585 = cute.get_scalars(%e0_4262) : !cute.int_tuple<"?">
      %1586 = cute.get_scalars(%e1_4263) : !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%e2_4264) : !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%e3_4265) : !cute.int_tuple<"?">
      %iter_4266 = cute.get_iter(%view_4255) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4267, %e1_4268, %e2_4269, %e3_4270 = cute.get_leaves(%iter_4266) : !cute.int_tuple<"(?,?,?,?)">
      %1589 = cute.get_scalars(%e0_4267) : !cute.int_tuple<"?">
      %1590 = cute.get_scalars(%e1_4268) : !cute.int_tuple<"?">
      %1591 = cute.get_scalars(%e2_4269) : !cute.int_tuple<"?">
      %1592 = cute.get_scalars(%e3_4270) : !cute.int_tuple<"?">
      %int_tuple_4271 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4272 = cute.add_offset(%e3_4270, %int_tuple_4271) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1593 = cute.get_scalars(%tup_4272) : !cute.int_tuple<"?">
      %coord_4273 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4274 = cute.make_coord(%tup_4272) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1594 = cute.get_scalars(%coord_4273) : !cute.coord<"?">
      %1595 = cute.get_scalars(%coord_4274) : !cute.coord<"?">
      %true_4275 = arith.constant true
      %1596 = arith.cmpi slt, %1594, %1595 : i32
      %1597 = arith.andi %true_4275, %1596 : i1
      %lay_4276 = cute.get_layout(%1578) : !memref_rmem_f32_4
      %1598 = cute.get_shape(%lay_4276) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4277, %e1_4278, %e2_4279, %e3_4280 = cute.get_leaves(%1598) : !cute.shape<"((2,2),(2,8))">
      %1599 = cute.get_stride(%lay_4276) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4281, %e1_4282, %e2_4283, %e3_4284 = cute.get_leaves(%1599) : !cute.stride<"((2,4),(1,8))">
      %1600 = scf.if %1597 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1578) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,13)">
        cute.memref.store(%1578, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,13)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1578) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1578 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1578) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1578) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1578 : !memref_rmem_f32_4
      }
      %iter_4285 = cute.get_iter(%1600) : !memref_rmem_f32_4
      %lay_4286 = cute.get_layout(%1600) : !memref_rmem_f32_4
      %1601 = cute.get_shape(%lay_4286) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4287, %e1_4288, %e2_4289, %e3_4290 = cute.get_leaves(%1601) : !cute.shape<"((2,2),(2,8))">
      %1602 = cute.get_stride(%lay_4286) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4291, %e1_4292, %e2_4293, %e3_4294 = cute.get_leaves(%1602) : !cute.stride<"((2,4),(1,8))">
      %iter_4295 = cute.get_iter(%1600) : !memref_rmem_f32_4
      %iter_4296 = cute.get_iter(%1600) : !memref_rmem_f32_4
      %coord_4297 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_4298 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4299 = cute.crd2idx(%coord_4297, %lay_4298) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_4300 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4301 = cute.add_offset(%iter_4300, %idx_4299) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4302 = cute.make_view(%tup_4301) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4303 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4304, %e1_4305, %e2_4306, %e3_4307 = cute.get_leaves(%iter_4303) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1603 = cute.get_scalars(%e0_4304) : !cute.int_tuple<"?">
      %1604 = cute.get_scalars(%e1_4305) : !cute.int_tuple<"?">
      %1605 = cute.get_scalars(%e2_4306) : !cute.int_tuple<"?">
      %1606 = cute.get_scalars(%e3_4307) : !cute.int_tuple<"?{div=2}">
      %iter_4308 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4309, %e1_4310, %e2_4311, %e3_4312 = cute.get_leaves(%iter_4308) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1607 = cute.get_scalars(%e0_4309) : !cute.int_tuple<"?">
      %1608 = cute.get_scalars(%e1_4310) : !cute.int_tuple<"?">
      %1609 = cute.get_scalars(%e2_4311) : !cute.int_tuple<"?">
      %1610 = cute.get_scalars(%e3_4312) : !cute.int_tuple<"?{div=2}">
      %iter_4313 = cute.get_iter(%view_4302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4314, %e1_4315, %e2_4316, %e3_4317 = cute.get_leaves(%iter_4313) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1611 = cute.get_scalars(%e0_4314) : !cute.int_tuple<"?">
      %1612 = cute.get_scalars(%e1_4315) : !cute.int_tuple<"?">
      %1613 = cute.get_scalars(%e2_4316) : !cute.int_tuple<"?">
      %1614 = cute.get_scalars(%e3_4317) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4318 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4319 = cute.add_offset(%e3_4317, %int_tuple_4318) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1615 = cute.get_scalars(%tup_4319) : !cute.int_tuple<"?">
      %coord_4320 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4321 = cute.make_coord(%tup_4319) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1616 = cute.get_scalars(%coord_4320) : !cute.coord<"?">
      %1617 = cute.get_scalars(%coord_4321) : !cute.coord<"?">
      %true_4322 = arith.constant true
      %1618 = arith.cmpi slt, %1616, %1617 : i32
      %1619 = arith.andi %true_4322, %1618 : i1
      %lay_4323 = cute.get_layout(%1600) : !memref_rmem_f32_4
      %1620 = cute.get_shape(%lay_4323) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4324, %e1_4325, %e2_4326, %e3_4327 = cute.get_leaves(%1620) : !cute.shape<"((2,2),(2,8))">
      %1621 = cute.get_stride(%lay_4323) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4328, %e1_4329, %e2_4330, %e3_4331 = cute.get_leaves(%1621) : !cute.stride<"((2,4),(1,8))">
      %1622 = scf.if %1619 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1600) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,14)">
        cute.memref.store(%1600, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,14)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1600) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1600 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1600) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1600) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1600 : !memref_rmem_f32_4
      }
      %iter_4332 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %lay_4333 = cute.get_layout(%1622) : !memref_rmem_f32_4
      %1623 = cute.get_shape(%lay_4333) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4334, %e1_4335, %e2_4336, %e3_4337 = cute.get_leaves(%1623) : !cute.shape<"((2,2),(2,8))">
      %1624 = cute.get_stride(%lay_4333) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4338, %e1_4339, %e2_4340, %e3_4341 = cute.get_leaves(%1624) : !cute.stride<"((2,4),(1,8))">
      %iter_4342 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %iter_4343 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %coord_4344 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_4345 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4346 = cute.crd2idx(%coord_4344, %lay_4345) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_4347 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4348 = cute.add_offset(%iter_4347, %idx_4346) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4349 = cute.make_view(%tup_4348) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4350 = cute.get_iter(%view_4349) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4351, %e1_4352, %e2_4353, %e3_4354 = cute.get_leaves(%iter_4350) : !cute.int_tuple<"(?,?,?,?)">
      %1625 = cute.get_scalars(%e0_4351) : !cute.int_tuple<"?">
      %1626 = cute.get_scalars(%e1_4352) : !cute.int_tuple<"?">
      %1627 = cute.get_scalars(%e2_4353) : !cute.int_tuple<"?">
      %1628 = cute.get_scalars(%e3_4354) : !cute.int_tuple<"?">
      %iter_4355 = cute.get_iter(%view_4349) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4356, %e1_4357, %e2_4358, %e3_4359 = cute.get_leaves(%iter_4355) : !cute.int_tuple<"(?,?,?,?)">
      %1629 = cute.get_scalars(%e0_4356) : !cute.int_tuple<"?">
      %1630 = cute.get_scalars(%e1_4357) : !cute.int_tuple<"?">
      %1631 = cute.get_scalars(%e2_4358) : !cute.int_tuple<"?">
      %1632 = cute.get_scalars(%e3_4359) : !cute.int_tuple<"?">
      %iter_4360 = cute.get_iter(%view_4349) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4361, %e1_4362, %e2_4363, %e3_4364 = cute.get_leaves(%iter_4360) : !cute.int_tuple<"(?,?,?,?)">
      %1633 = cute.get_scalars(%e0_4361) : !cute.int_tuple<"?">
      %1634 = cute.get_scalars(%e1_4362) : !cute.int_tuple<"?">
      %1635 = cute.get_scalars(%e2_4363) : !cute.int_tuple<"?">
      %1636 = cute.get_scalars(%e3_4364) : !cute.int_tuple<"?">
      %int_tuple_4365 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4366 = cute.add_offset(%e3_4364, %int_tuple_4365) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1637 = cute.get_scalars(%tup_4366) : !cute.int_tuple<"?">
      %coord_4367 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4368 = cute.make_coord(%tup_4366) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1638 = cute.get_scalars(%coord_4367) : !cute.coord<"?">
      %1639 = cute.get_scalars(%coord_4368) : !cute.coord<"?">
      %true_4369 = arith.constant true
      %1640 = arith.cmpi slt, %1638, %1639 : i32
      %1641 = arith.andi %true_4369, %1640 : i1
      %lay_4370 = cute.get_layout(%1622) : !memref_rmem_f32_4
      %1642 = cute.get_shape(%lay_4370) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4371, %e1_4372, %e2_4373, %e3_4374 = cute.get_leaves(%1642) : !cute.shape<"((2,2),(2,8))">
      %1643 = cute.get_stride(%lay_4370) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4375, %e1_4376, %e2_4377, %e3_4378 = cute.get_leaves(%1643) : !cute.stride<"((2,4),(1,8))">
      %1644 = scf.if %1641 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1622) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(0,15)">
        cute.memref.store(%1622, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(0,15)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1622) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1622 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1622) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1622) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1622 : !memref_rmem_f32_4
      }
      %iter_4379 = cute.get_iter(%1644) : !memref_rmem_f32_4
      %lay_4380 = cute.get_layout(%1644) : !memref_rmem_f32_4
      %1645 = cute.get_shape(%lay_4380) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4381, %e1_4382, %e2_4383, %e3_4384 = cute.get_leaves(%1645) : !cute.shape<"((2,2),(2,8))">
      %1646 = cute.get_stride(%lay_4380) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4385, %e1_4386, %e2_4387, %e3_4388 = cute.get_leaves(%1646) : !cute.stride<"((2,4),(1,8))">
      %iter_4389 = cute.get_iter(%1644) : !memref_rmem_f32_4
      %iter_4390 = cute.get_iter(%1644) : !memref_rmem_f32_4
      %coord_4391 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_4392 = cute.get_layout(%1644) : !memref_rmem_f32_4
      %idx_4393 = cute.crd2idx(%coord_4391, %lay_4392) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_4394 = cute.get_iter(%1644) : !memref_rmem_f32_4
      %ptr_4395 = cute.add_offset(%iter_4394, %idx_4393) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_4396 = cute.make_view(%ptr_4395) : !memref_rmem_f32_6
      %iter_4397 = cute.get_iter(%view_4396) : !memref_rmem_f32_6
      %iter_4398 = cute.get_iter(%view_4396) : !memref_rmem_f32_6
      %lay_4399 = cute.get_layout(%view_4396) : !memref_rmem_f32_6
      %1647 = cute.get_shape(%lay_4399) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4400, %e1_4401 = cute.get_leaves(%1647) : !cute.shape<"((2,8))">
      %1648 = cute.memref.load_vec %view_4396 : !memref_rmem_f32_6
      %cst_4402 = arith.constant 0xFF800000 : f32
      %1649 = vector.reduction <maximumf>, %1648, %cst_4402 : vector<16xf32> into f32
      %c-1_i32 = arith.constant -1 : i32
      %c2_i32_4403 = arith.constant 2 : i32
      %c31_i32 = arith.constant 31 : i32
      %1650 = nvvm.shfl.sync  bfly %c-1_i32, %1649, %c2_i32_4403, %c31_i32 : f32 -> f32
      %1651 = nvvm.fmax %1649, %1650
      %c-1_i32_4404 = arith.constant -1 : i32
      %c1_i32_4405 = arith.constant 1 : i32
      %c31_i32_4406 = arith.constant 31 : i32
      %1652 = nvvm.shfl.sync  bfly %c-1_i32_4404, %1651, %c1_i32_4405, %c31_i32_4406 : f32 -> f32
      %1653 = nvvm.fmax %1651, %1652
      %1654 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1655 = arith.mulf %1648, %1654 : vector<16xf32>
      %1656 = arith.mulf %1653, %arg4 : f32
      %1657 = vector.broadcast %1656 : f32 to vector<16xf32>
      %1658 = arith.subf %1655, %1657 : vector<16xf32>
      %1659 = math.exp2 %1658 fastmath<fast> : vector<16xf32>
      %cst_4407 = arith.constant 0.000000e+00 : f32
      %1660 = vector.reduction <add>, %1659, %cst_4407 : vector<16xf32> into f32
      %coord_4408 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1595, %coord_4408, %1653) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_4409 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1600, %coord_4409, %1660) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_4410 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_4411 = cute.get_layout(%1644) : !memref_rmem_f32_4
      %idx_4412 = cute.crd2idx(%coord_4410, %lay_4411) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_4413 = cute.get_iter(%1644) : !memref_rmem_f32_4
      %ptr_4414 = cute.add_offset(%iter_4413, %idx_4412) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_4415 = cute.make_view(%ptr_4414) : !memref_rmem_f32_6
      %iter_4416 = cute.get_iter(%view_4415) : !memref_rmem_f32_6
      %iter_4417 = cute.get_iter(%view_4415) : !memref_rmem_f32_6
      %lay_4418 = cute.get_layout(%view_4415) : !memref_rmem_f32_6
      %1661 = cute.get_shape(%lay_4418) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4419, %e1_4420 = cute.get_leaves(%1661) : !cute.shape<"((2,8))">
      %int_tuple_4421 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4422 = cute.size(%int_tuple_4421) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4423 = cute.get_leaves(%sz_4422) : !cute.int_tuple<"16">
      %int_tuple_4424 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4425 = cute.size(%int_tuple_4424) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4426 = cute.get_leaves(%sz_4425) : !cute.int_tuple<"16">
      cute.memref.store_vec %1659, %view_4415 : !memref_rmem_f32_6
      %int_tuple_4427 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_4428 = cute.size(%int_tuple_4427) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_4429 = cute.get_leaves(%sz_4428) : !cute.int_tuple<"16">
      %coord_4430 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_4431 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4432 = cute.crd2idx(%coord_4430, %lay_4431) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_4433 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4434 = cute.add_offset(%iter_4433, %idx_4432) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4435 = cute.make_view(%tup_4434) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4436 = cute.get_iter(%view_4435) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4437, %e1_4438, %e2_4439, %e3_4440 = cute.get_leaves(%iter_4436) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1662 = cute.get_scalars(%e0_4437) : !cute.int_tuple<"?">
      %1663 = cute.get_scalars(%e1_4438) : !cute.int_tuple<"?">
      %1664 = cute.get_scalars(%e2_4439) : !cute.int_tuple<"?">
      %1665 = cute.get_scalars(%e3_4440) : !cute.int_tuple<"?{div=2}">
      %iter_4441 = cute.get_iter(%view_4435) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4442, %e1_4443, %e2_4444, %e3_4445 = cute.get_leaves(%iter_4441) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1666 = cute.get_scalars(%e0_4442) : !cute.int_tuple<"?">
      %1667 = cute.get_scalars(%e1_4443) : !cute.int_tuple<"?">
      %1668 = cute.get_scalars(%e2_4444) : !cute.int_tuple<"?">
      %1669 = cute.get_scalars(%e3_4445) : !cute.int_tuple<"?{div=2}">
      %iter_4446 = cute.get_iter(%view_4435) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4447, %e1_4448, %e2_4449, %e3_4450 = cute.get_leaves(%iter_4446) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1670 = cute.get_scalars(%e0_4447) : !cute.int_tuple<"?">
      %1671 = cute.get_scalars(%e1_4448) : !cute.int_tuple<"?">
      %1672 = cute.get_scalars(%e2_4449) : !cute.int_tuple<"?">
      %1673 = cute.get_scalars(%e3_4450) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4451 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4452 = cute.add_offset(%e3_4450, %int_tuple_4451) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1674 = cute.get_scalars(%tup_4452) : !cute.int_tuple<"?">
      %coord_4453 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4454 = cute.make_coord(%tup_4452) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1675 = cute.get_scalars(%coord_4453) : !cute.coord<"?">
      %1676 = cute.get_scalars(%coord_4454) : !cute.coord<"?">
      %true_4455 = arith.constant true
      %1677 = arith.cmpi slt, %1675, %1676 : i32
      %1678 = arith.andi %true_4455, %1677 : i1
      %lay_4456 = cute.get_layout(%1644) : !memref_rmem_f32_4
      %1679 = cute.get_shape(%lay_4456) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4457, %e1_4458, %e2_4459, %e3_4460 = cute.get_leaves(%1679) : !cute.shape<"((2,2),(2,8))">
      %1680 = cute.get_stride(%lay_4456) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4461, %e1_4462, %e2_4463, %e3_4464 = cute.get_leaves(%1680) : !cute.stride<"((2,4),(1,8))">
      %1681 = scf.if %1678 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1644) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,0)">
        cute.memref.store(%1644, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,0)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1644) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1644 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1644) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1644) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1644 : !memref_rmem_f32_4
      }
      %iter_4465 = cute.get_iter(%1681) : !memref_rmem_f32_4
      %lay_4466 = cute.get_layout(%1681) : !memref_rmem_f32_4
      %1682 = cute.get_shape(%lay_4466) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4467, %e1_4468, %e2_4469, %e3_4470 = cute.get_leaves(%1682) : !cute.shape<"((2,2),(2,8))">
      %1683 = cute.get_stride(%lay_4466) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4471, %e1_4472, %e2_4473, %e3_4474 = cute.get_leaves(%1683) : !cute.stride<"((2,4),(1,8))">
      %iter_4475 = cute.get_iter(%1681) : !memref_rmem_f32_4
      %iter_4476 = cute.get_iter(%1681) : !memref_rmem_f32_4
      %coord_4477 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_4478 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4479 = cute.crd2idx(%coord_4477, %lay_4478) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_4480 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4481 = cute.add_offset(%iter_4480, %idx_4479) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4482 = cute.make_view(%tup_4481) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4483 = cute.get_iter(%view_4482) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4484, %e1_4485, %e2_4486, %e3_4487 = cute.get_leaves(%iter_4483) : !cute.int_tuple<"(?,?,?,?)">
      %1684 = cute.get_scalars(%e0_4484) : !cute.int_tuple<"?">
      %1685 = cute.get_scalars(%e1_4485) : !cute.int_tuple<"?">
      %1686 = cute.get_scalars(%e2_4486) : !cute.int_tuple<"?">
      %1687 = cute.get_scalars(%e3_4487) : !cute.int_tuple<"?">
      %iter_4488 = cute.get_iter(%view_4482) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4489, %e1_4490, %e2_4491, %e3_4492 = cute.get_leaves(%iter_4488) : !cute.int_tuple<"(?,?,?,?)">
      %1688 = cute.get_scalars(%e0_4489) : !cute.int_tuple<"?">
      %1689 = cute.get_scalars(%e1_4490) : !cute.int_tuple<"?">
      %1690 = cute.get_scalars(%e2_4491) : !cute.int_tuple<"?">
      %1691 = cute.get_scalars(%e3_4492) : !cute.int_tuple<"?">
      %iter_4493 = cute.get_iter(%view_4482) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4494, %e1_4495, %e2_4496, %e3_4497 = cute.get_leaves(%iter_4493) : !cute.int_tuple<"(?,?,?,?)">
      %1692 = cute.get_scalars(%e0_4494) : !cute.int_tuple<"?">
      %1693 = cute.get_scalars(%e1_4495) : !cute.int_tuple<"?">
      %1694 = cute.get_scalars(%e2_4496) : !cute.int_tuple<"?">
      %1695 = cute.get_scalars(%e3_4497) : !cute.int_tuple<"?">
      %int_tuple_4498 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4499 = cute.add_offset(%e3_4497, %int_tuple_4498) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1696 = cute.get_scalars(%tup_4499) : !cute.int_tuple<"?">
      %coord_4500 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4501 = cute.make_coord(%tup_4499) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1697 = cute.get_scalars(%coord_4500) : !cute.coord<"?">
      %1698 = cute.get_scalars(%coord_4501) : !cute.coord<"?">
      %true_4502 = arith.constant true
      %1699 = arith.cmpi slt, %1697, %1698 : i32
      %1700 = arith.andi %true_4502, %1699 : i1
      %lay_4503 = cute.get_layout(%1681) : !memref_rmem_f32_4
      %1701 = cute.get_shape(%lay_4503) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4504, %e1_4505, %e2_4506, %e3_4507 = cute.get_leaves(%1701) : !cute.shape<"((2,2),(2,8))">
      %1702 = cute.get_stride(%lay_4503) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4508, %e1_4509, %e2_4510, %e3_4511 = cute.get_leaves(%1702) : !cute.stride<"((2,4),(1,8))">
      %1703 = scf.if %1700 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1681) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,1)">
        cute.memref.store(%1681, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,1)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1681) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1681 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1681) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1681) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1681 : !memref_rmem_f32_4
      }
      %iter_4512 = cute.get_iter(%1703) : !memref_rmem_f32_4
      %lay_4513 = cute.get_layout(%1703) : !memref_rmem_f32_4
      %1704 = cute.get_shape(%lay_4513) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4514, %e1_4515, %e2_4516, %e3_4517 = cute.get_leaves(%1704) : !cute.shape<"((2,2),(2,8))">
      %1705 = cute.get_stride(%lay_4513) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4518, %e1_4519, %e2_4520, %e3_4521 = cute.get_leaves(%1705) : !cute.stride<"((2,4),(1,8))">
      %iter_4522 = cute.get_iter(%1703) : !memref_rmem_f32_4
      %iter_4523 = cute.get_iter(%1703) : !memref_rmem_f32_4
      %coord_4524 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_4525 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4526 = cute.crd2idx(%coord_4524, %lay_4525) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_4527 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4528 = cute.add_offset(%iter_4527, %idx_4526) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4529 = cute.make_view(%tup_4528) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4530 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4531, %e1_4532, %e2_4533, %e3_4534 = cute.get_leaves(%iter_4530) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1706 = cute.get_scalars(%e0_4531) : !cute.int_tuple<"?">
      %1707 = cute.get_scalars(%e1_4532) : !cute.int_tuple<"?">
      %1708 = cute.get_scalars(%e2_4533) : !cute.int_tuple<"?">
      %1709 = cute.get_scalars(%e3_4534) : !cute.int_tuple<"?{div=2}">
      %iter_4535 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4536, %e1_4537, %e2_4538, %e3_4539 = cute.get_leaves(%iter_4535) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1710 = cute.get_scalars(%e0_4536) : !cute.int_tuple<"?">
      %1711 = cute.get_scalars(%e1_4537) : !cute.int_tuple<"?">
      %1712 = cute.get_scalars(%e2_4538) : !cute.int_tuple<"?">
      %1713 = cute.get_scalars(%e3_4539) : !cute.int_tuple<"?{div=2}">
      %iter_4540 = cute.get_iter(%view_4529) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4541, %e1_4542, %e2_4543, %e3_4544 = cute.get_leaves(%iter_4540) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1714 = cute.get_scalars(%e0_4541) : !cute.int_tuple<"?">
      %1715 = cute.get_scalars(%e1_4542) : !cute.int_tuple<"?">
      %1716 = cute.get_scalars(%e2_4543) : !cute.int_tuple<"?">
      %1717 = cute.get_scalars(%e3_4544) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4545 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4546 = cute.add_offset(%e3_4544, %int_tuple_4545) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1718 = cute.get_scalars(%tup_4546) : !cute.int_tuple<"?">
      %coord_4547 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4548 = cute.make_coord(%tup_4546) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1719 = cute.get_scalars(%coord_4547) : !cute.coord<"?">
      %1720 = cute.get_scalars(%coord_4548) : !cute.coord<"?">
      %true_4549 = arith.constant true
      %1721 = arith.cmpi slt, %1719, %1720 : i32
      %1722 = arith.andi %true_4549, %1721 : i1
      %lay_4550 = cute.get_layout(%1703) : !memref_rmem_f32_4
      %1723 = cute.get_shape(%lay_4550) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4551, %e1_4552, %e2_4553, %e3_4554 = cute.get_leaves(%1723) : !cute.shape<"((2,2),(2,8))">
      %1724 = cute.get_stride(%lay_4550) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4555, %e1_4556, %e2_4557, %e3_4558 = cute.get_leaves(%1724) : !cute.stride<"((2,4),(1,8))">
      %1725 = scf.if %1722 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1703) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,2)">
        cute.memref.store(%1703, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,2)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1703) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1703 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1703) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1703) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1703 : !memref_rmem_f32_4
      }
      %iter_4559 = cute.get_iter(%1725) : !memref_rmem_f32_4
      %lay_4560 = cute.get_layout(%1725) : !memref_rmem_f32_4
      %1726 = cute.get_shape(%lay_4560) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4561, %e1_4562, %e2_4563, %e3_4564 = cute.get_leaves(%1726) : !cute.shape<"((2,2),(2,8))">
      %1727 = cute.get_stride(%lay_4560) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4565, %e1_4566, %e2_4567, %e3_4568 = cute.get_leaves(%1727) : !cute.stride<"((2,4),(1,8))">
      %iter_4569 = cute.get_iter(%1725) : !memref_rmem_f32_4
      %iter_4570 = cute.get_iter(%1725) : !memref_rmem_f32_4
      %coord_4571 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_4572 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4573 = cute.crd2idx(%coord_4571, %lay_4572) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_4574 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4575 = cute.add_offset(%iter_4574, %idx_4573) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4576 = cute.make_view(%tup_4575) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4577 = cute.get_iter(%view_4576) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4578, %e1_4579, %e2_4580, %e3_4581 = cute.get_leaves(%iter_4577) : !cute.int_tuple<"(?,?,?,?)">
      %1728 = cute.get_scalars(%e0_4578) : !cute.int_tuple<"?">
      %1729 = cute.get_scalars(%e1_4579) : !cute.int_tuple<"?">
      %1730 = cute.get_scalars(%e2_4580) : !cute.int_tuple<"?">
      %1731 = cute.get_scalars(%e3_4581) : !cute.int_tuple<"?">
      %iter_4582 = cute.get_iter(%view_4576) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4583, %e1_4584, %e2_4585, %e3_4586 = cute.get_leaves(%iter_4582) : !cute.int_tuple<"(?,?,?,?)">
      %1732 = cute.get_scalars(%e0_4583) : !cute.int_tuple<"?">
      %1733 = cute.get_scalars(%e1_4584) : !cute.int_tuple<"?">
      %1734 = cute.get_scalars(%e2_4585) : !cute.int_tuple<"?">
      %1735 = cute.get_scalars(%e3_4586) : !cute.int_tuple<"?">
      %iter_4587 = cute.get_iter(%view_4576) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4588, %e1_4589, %e2_4590, %e3_4591 = cute.get_leaves(%iter_4587) : !cute.int_tuple<"(?,?,?,?)">
      %1736 = cute.get_scalars(%e0_4588) : !cute.int_tuple<"?">
      %1737 = cute.get_scalars(%e1_4589) : !cute.int_tuple<"?">
      %1738 = cute.get_scalars(%e2_4590) : !cute.int_tuple<"?">
      %1739 = cute.get_scalars(%e3_4591) : !cute.int_tuple<"?">
      %int_tuple_4592 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4593 = cute.add_offset(%e3_4591, %int_tuple_4592) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1740 = cute.get_scalars(%tup_4593) : !cute.int_tuple<"?">
      %coord_4594 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4595 = cute.make_coord(%tup_4593) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1741 = cute.get_scalars(%coord_4594) : !cute.coord<"?">
      %1742 = cute.get_scalars(%coord_4595) : !cute.coord<"?">
      %true_4596 = arith.constant true
      %1743 = arith.cmpi slt, %1741, %1742 : i32
      %1744 = arith.andi %true_4596, %1743 : i1
      %lay_4597 = cute.get_layout(%1725) : !memref_rmem_f32_4
      %1745 = cute.get_shape(%lay_4597) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4598, %e1_4599, %e2_4600, %e3_4601 = cute.get_leaves(%1745) : !cute.shape<"((2,2),(2,8))">
      %1746 = cute.get_stride(%lay_4597) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4602, %e1_4603, %e2_4604, %e3_4605 = cute.get_leaves(%1746) : !cute.stride<"((2,4),(1,8))">
      %1747 = scf.if %1744 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1725) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,3)">
        cute.memref.store(%1725, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,3)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1725) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1725 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1725) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1725) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1725 : !memref_rmem_f32_4
      }
      %iter_4606 = cute.get_iter(%1747) : !memref_rmem_f32_4
      %lay_4607 = cute.get_layout(%1747) : !memref_rmem_f32_4
      %1748 = cute.get_shape(%lay_4607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4608, %e1_4609, %e2_4610, %e3_4611 = cute.get_leaves(%1748) : !cute.shape<"((2,2),(2,8))">
      %1749 = cute.get_stride(%lay_4607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4612, %e1_4613, %e2_4614, %e3_4615 = cute.get_leaves(%1749) : !cute.stride<"((2,4),(1,8))">
      %iter_4616 = cute.get_iter(%1747) : !memref_rmem_f32_4
      %iter_4617 = cute.get_iter(%1747) : !memref_rmem_f32_4
      %coord_4618 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_4619 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4620 = cute.crd2idx(%coord_4618, %lay_4619) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_4621 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4622 = cute.add_offset(%iter_4621, %idx_4620) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4623 = cute.make_view(%tup_4622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4624 = cute.get_iter(%view_4623) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4625, %e1_4626, %e2_4627, %e3_4628 = cute.get_leaves(%iter_4624) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1750 = cute.get_scalars(%e0_4625) : !cute.int_tuple<"?">
      %1751 = cute.get_scalars(%e1_4626) : !cute.int_tuple<"?">
      %1752 = cute.get_scalars(%e2_4627) : !cute.int_tuple<"?">
      %1753 = cute.get_scalars(%e3_4628) : !cute.int_tuple<"?{div=2}">
      %iter_4629 = cute.get_iter(%view_4623) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4630, %e1_4631, %e2_4632, %e3_4633 = cute.get_leaves(%iter_4629) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1754 = cute.get_scalars(%e0_4630) : !cute.int_tuple<"?">
      %1755 = cute.get_scalars(%e1_4631) : !cute.int_tuple<"?">
      %1756 = cute.get_scalars(%e2_4632) : !cute.int_tuple<"?">
      %1757 = cute.get_scalars(%e3_4633) : !cute.int_tuple<"?{div=2}">
      %iter_4634 = cute.get_iter(%view_4623) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4635, %e1_4636, %e2_4637, %e3_4638 = cute.get_leaves(%iter_4634) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1758 = cute.get_scalars(%e0_4635) : !cute.int_tuple<"?">
      %1759 = cute.get_scalars(%e1_4636) : !cute.int_tuple<"?">
      %1760 = cute.get_scalars(%e2_4637) : !cute.int_tuple<"?">
      %1761 = cute.get_scalars(%e3_4638) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4639 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4640 = cute.add_offset(%e3_4638, %int_tuple_4639) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1762 = cute.get_scalars(%tup_4640) : !cute.int_tuple<"?">
      %coord_4641 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4642 = cute.make_coord(%tup_4640) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1763 = cute.get_scalars(%coord_4641) : !cute.coord<"?">
      %1764 = cute.get_scalars(%coord_4642) : !cute.coord<"?">
      %true_4643 = arith.constant true
      %1765 = arith.cmpi slt, %1763, %1764 : i32
      %1766 = arith.andi %true_4643, %1765 : i1
      %lay_4644 = cute.get_layout(%1747) : !memref_rmem_f32_4
      %1767 = cute.get_shape(%lay_4644) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4645, %e1_4646, %e2_4647, %e3_4648 = cute.get_leaves(%1767) : !cute.shape<"((2,2),(2,8))">
      %1768 = cute.get_stride(%lay_4644) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4649, %e1_4650, %e2_4651, %e3_4652 = cute.get_leaves(%1768) : !cute.stride<"((2,4),(1,8))">
      %1769 = scf.if %1766 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1747) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,4)">
        cute.memref.store(%1747, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,4)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1747) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1747 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1747) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1747) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1747 : !memref_rmem_f32_4
      }
      %iter_4653 = cute.get_iter(%1769) : !memref_rmem_f32_4
      %lay_4654 = cute.get_layout(%1769) : !memref_rmem_f32_4
      %1770 = cute.get_shape(%lay_4654) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4655, %e1_4656, %e2_4657, %e3_4658 = cute.get_leaves(%1770) : !cute.shape<"((2,2),(2,8))">
      %1771 = cute.get_stride(%lay_4654) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4659, %e1_4660, %e2_4661, %e3_4662 = cute.get_leaves(%1771) : !cute.stride<"((2,4),(1,8))">
      %iter_4663 = cute.get_iter(%1769) : !memref_rmem_f32_4
      %iter_4664 = cute.get_iter(%1769) : !memref_rmem_f32_4
      %coord_4665 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4666 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4667 = cute.crd2idx(%coord_4665, %lay_4666) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4668 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4669 = cute.add_offset(%iter_4668, %idx_4667) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4670 = cute.make_view(%tup_4669) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4671 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4672, %e1_4673, %e2_4674, %e3_4675 = cute.get_leaves(%iter_4671) : !cute.int_tuple<"(?,?,?,?)">
      %1772 = cute.get_scalars(%e0_4672) : !cute.int_tuple<"?">
      %1773 = cute.get_scalars(%e1_4673) : !cute.int_tuple<"?">
      %1774 = cute.get_scalars(%e2_4674) : !cute.int_tuple<"?">
      %1775 = cute.get_scalars(%e3_4675) : !cute.int_tuple<"?">
      %iter_4676 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4677, %e1_4678, %e2_4679, %e3_4680 = cute.get_leaves(%iter_4676) : !cute.int_tuple<"(?,?,?,?)">
      %1776 = cute.get_scalars(%e0_4677) : !cute.int_tuple<"?">
      %1777 = cute.get_scalars(%e1_4678) : !cute.int_tuple<"?">
      %1778 = cute.get_scalars(%e2_4679) : !cute.int_tuple<"?">
      %1779 = cute.get_scalars(%e3_4680) : !cute.int_tuple<"?">
      %iter_4681 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4682, %e1_4683, %e2_4684, %e3_4685 = cute.get_leaves(%iter_4681) : !cute.int_tuple<"(?,?,?,?)">
      %1780 = cute.get_scalars(%e0_4682) : !cute.int_tuple<"?">
      %1781 = cute.get_scalars(%e1_4683) : !cute.int_tuple<"?">
      %1782 = cute.get_scalars(%e2_4684) : !cute.int_tuple<"?">
      %1783 = cute.get_scalars(%e3_4685) : !cute.int_tuple<"?">
      %int_tuple_4686 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4687 = cute.add_offset(%e3_4685, %int_tuple_4686) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1784 = cute.get_scalars(%tup_4687) : !cute.int_tuple<"?">
      %coord_4688 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4689 = cute.make_coord(%tup_4687) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1785 = cute.get_scalars(%coord_4688) : !cute.coord<"?">
      %1786 = cute.get_scalars(%coord_4689) : !cute.coord<"?">
      %true_4690 = arith.constant true
      %1787 = arith.cmpi slt, %1785, %1786 : i32
      %1788 = arith.andi %true_4690, %1787 : i1
      %lay_4691 = cute.get_layout(%1769) : !memref_rmem_f32_4
      %1789 = cute.get_shape(%lay_4691) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4692, %e1_4693, %e2_4694, %e3_4695 = cute.get_leaves(%1789) : !cute.shape<"((2,2),(2,8))">
      %1790 = cute.get_stride(%lay_4691) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4696, %e1_4697, %e2_4698, %e3_4699 = cute.get_leaves(%1790) : !cute.stride<"((2,4),(1,8))">
      %1791 = scf.if %1788 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1769) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,5)">
        cute.memref.store(%1769, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,5)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1769) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1769 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1769) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1769) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1769 : !memref_rmem_f32_4
      }
      %iter_4700 = cute.get_iter(%1791) : !memref_rmem_f32_4
      %lay_4701 = cute.get_layout(%1791) : !memref_rmem_f32_4
      %1792 = cute.get_shape(%lay_4701) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4702, %e1_4703, %e2_4704, %e3_4705 = cute.get_leaves(%1792) : !cute.shape<"((2,2),(2,8))">
      %1793 = cute.get_stride(%lay_4701) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4706, %e1_4707, %e2_4708, %e3_4709 = cute.get_leaves(%1793) : !cute.stride<"((2,4),(1,8))">
      %iter_4710 = cute.get_iter(%1791) : !memref_rmem_f32_4
      %iter_4711 = cute.get_iter(%1791) : !memref_rmem_f32_4
      %coord_4712 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4713 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4714 = cute.crd2idx(%coord_4712, %lay_4713) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4715 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4716 = cute.add_offset(%iter_4715, %idx_4714) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4717 = cute.make_view(%tup_4716) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4718 = cute.get_iter(%view_4717) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4719, %e1_4720, %e2_4721, %e3_4722 = cute.get_leaves(%iter_4718) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1794 = cute.get_scalars(%e0_4719) : !cute.int_tuple<"?">
      %1795 = cute.get_scalars(%e1_4720) : !cute.int_tuple<"?">
      %1796 = cute.get_scalars(%e2_4721) : !cute.int_tuple<"?">
      %1797 = cute.get_scalars(%e3_4722) : !cute.int_tuple<"?{div=2}">
      %iter_4723 = cute.get_iter(%view_4717) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4724, %e1_4725, %e2_4726, %e3_4727 = cute.get_leaves(%iter_4723) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1798 = cute.get_scalars(%e0_4724) : !cute.int_tuple<"?">
      %1799 = cute.get_scalars(%e1_4725) : !cute.int_tuple<"?">
      %1800 = cute.get_scalars(%e2_4726) : !cute.int_tuple<"?">
      %1801 = cute.get_scalars(%e3_4727) : !cute.int_tuple<"?{div=2}">
      %iter_4728 = cute.get_iter(%view_4717) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4729, %e1_4730, %e2_4731, %e3_4732 = cute.get_leaves(%iter_4728) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1802 = cute.get_scalars(%e0_4729) : !cute.int_tuple<"?">
      %1803 = cute.get_scalars(%e1_4730) : !cute.int_tuple<"?">
      %1804 = cute.get_scalars(%e2_4731) : !cute.int_tuple<"?">
      %1805 = cute.get_scalars(%e3_4732) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4733 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4734 = cute.add_offset(%e3_4732, %int_tuple_4733) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1806 = cute.get_scalars(%tup_4734) : !cute.int_tuple<"?">
      %coord_4735 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4736 = cute.make_coord(%tup_4734) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1807 = cute.get_scalars(%coord_4735) : !cute.coord<"?">
      %1808 = cute.get_scalars(%coord_4736) : !cute.coord<"?">
      %true_4737 = arith.constant true
      %1809 = arith.cmpi slt, %1807, %1808 : i32
      %1810 = arith.andi %true_4737, %1809 : i1
      %lay_4738 = cute.get_layout(%1791) : !memref_rmem_f32_4
      %1811 = cute.get_shape(%lay_4738) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4739, %e1_4740, %e2_4741, %e3_4742 = cute.get_leaves(%1811) : !cute.shape<"((2,2),(2,8))">
      %1812 = cute.get_stride(%lay_4738) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4743, %e1_4744, %e2_4745, %e3_4746 = cute.get_leaves(%1812) : !cute.stride<"((2,4),(1,8))">
      %1813 = scf.if %1810 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1791) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,6)">
        cute.memref.store(%1791, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,6)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1791) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1791 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1791) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1791) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1791 : !memref_rmem_f32_4
      }
      %iter_4747 = cute.get_iter(%1813) : !memref_rmem_f32_4
      %lay_4748 = cute.get_layout(%1813) : !memref_rmem_f32_4
      %1814 = cute.get_shape(%lay_4748) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4749, %e1_4750, %e2_4751, %e3_4752 = cute.get_leaves(%1814) : !cute.shape<"((2,2),(2,8))">
      %1815 = cute.get_stride(%lay_4748) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4753, %e1_4754, %e2_4755, %e3_4756 = cute.get_leaves(%1815) : !cute.stride<"((2,4),(1,8))">
      %iter_4757 = cute.get_iter(%1813) : !memref_rmem_f32_4
      %iter_4758 = cute.get_iter(%1813) : !memref_rmem_f32_4
      %coord_4759 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4760 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4761 = cute.crd2idx(%coord_4759, %lay_4760) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4762 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4763 = cute.add_offset(%iter_4762, %idx_4761) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4764 = cute.make_view(%tup_4763) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4765 = cute.get_iter(%view_4764) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4766, %e1_4767, %e2_4768, %e3_4769 = cute.get_leaves(%iter_4765) : !cute.int_tuple<"(?,?,?,?)">
      %1816 = cute.get_scalars(%e0_4766) : !cute.int_tuple<"?">
      %1817 = cute.get_scalars(%e1_4767) : !cute.int_tuple<"?">
      %1818 = cute.get_scalars(%e2_4768) : !cute.int_tuple<"?">
      %1819 = cute.get_scalars(%e3_4769) : !cute.int_tuple<"?">
      %iter_4770 = cute.get_iter(%view_4764) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4771, %e1_4772, %e2_4773, %e3_4774 = cute.get_leaves(%iter_4770) : !cute.int_tuple<"(?,?,?,?)">
      %1820 = cute.get_scalars(%e0_4771) : !cute.int_tuple<"?">
      %1821 = cute.get_scalars(%e1_4772) : !cute.int_tuple<"?">
      %1822 = cute.get_scalars(%e2_4773) : !cute.int_tuple<"?">
      %1823 = cute.get_scalars(%e3_4774) : !cute.int_tuple<"?">
      %iter_4775 = cute.get_iter(%view_4764) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4776, %e1_4777, %e2_4778, %e3_4779 = cute.get_leaves(%iter_4775) : !cute.int_tuple<"(?,?,?,?)">
      %1824 = cute.get_scalars(%e0_4776) : !cute.int_tuple<"?">
      %1825 = cute.get_scalars(%e1_4777) : !cute.int_tuple<"?">
      %1826 = cute.get_scalars(%e2_4778) : !cute.int_tuple<"?">
      %1827 = cute.get_scalars(%e3_4779) : !cute.int_tuple<"?">
      %int_tuple_4780 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4781 = cute.add_offset(%e3_4779, %int_tuple_4780) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1828 = cute.get_scalars(%tup_4781) : !cute.int_tuple<"?">
      %coord_4782 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4783 = cute.make_coord(%tup_4781) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1829 = cute.get_scalars(%coord_4782) : !cute.coord<"?">
      %1830 = cute.get_scalars(%coord_4783) : !cute.coord<"?">
      %true_4784 = arith.constant true
      %1831 = arith.cmpi slt, %1829, %1830 : i32
      %1832 = arith.andi %true_4784, %1831 : i1
      %lay_4785 = cute.get_layout(%1813) : !memref_rmem_f32_4
      %1833 = cute.get_shape(%lay_4785) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4786, %e1_4787, %e2_4788, %e3_4789 = cute.get_leaves(%1833) : !cute.shape<"((2,2),(2,8))">
      %1834 = cute.get_stride(%lay_4785) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4790, %e1_4791, %e2_4792, %e3_4793 = cute.get_leaves(%1834) : !cute.stride<"((2,4),(1,8))">
      %1835 = scf.if %1832 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1813) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,7)">
        cute.memref.store(%1813, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,7)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1813) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1813 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1813) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1813) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1813 : !memref_rmem_f32_4
      }
      %iter_4794 = cute.get_iter(%1835) : !memref_rmem_f32_4
      %lay_4795 = cute.get_layout(%1835) : !memref_rmem_f32_4
      %1836 = cute.get_shape(%lay_4795) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4796, %e1_4797, %e2_4798, %e3_4799 = cute.get_leaves(%1836) : !cute.shape<"((2,2),(2,8))">
      %1837 = cute.get_stride(%lay_4795) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4800, %e1_4801, %e2_4802, %e3_4803 = cute.get_leaves(%1837) : !cute.stride<"((2,4),(1,8))">
      %iter_4804 = cute.get_iter(%1835) : !memref_rmem_f32_4
      %iter_4805 = cute.get_iter(%1835) : !memref_rmem_f32_4
      %coord_4806 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4807 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4808 = cute.crd2idx(%coord_4806, %lay_4807) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4809 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4810 = cute.add_offset(%iter_4809, %idx_4808) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4811 = cute.make_view(%tup_4810) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4812 = cute.get_iter(%view_4811) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4813, %e1_4814, %e2_4815, %e3_4816 = cute.get_leaves(%iter_4812) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1838 = cute.get_scalars(%e0_4813) : !cute.int_tuple<"?">
      %1839 = cute.get_scalars(%e1_4814) : !cute.int_tuple<"?">
      %1840 = cute.get_scalars(%e2_4815) : !cute.int_tuple<"?">
      %1841 = cute.get_scalars(%e3_4816) : !cute.int_tuple<"?{div=2}">
      %iter_4817 = cute.get_iter(%view_4811) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4818, %e1_4819, %e2_4820, %e3_4821 = cute.get_leaves(%iter_4817) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1842 = cute.get_scalars(%e0_4818) : !cute.int_tuple<"?">
      %1843 = cute.get_scalars(%e1_4819) : !cute.int_tuple<"?">
      %1844 = cute.get_scalars(%e2_4820) : !cute.int_tuple<"?">
      %1845 = cute.get_scalars(%e3_4821) : !cute.int_tuple<"?{div=2}">
      %iter_4822 = cute.get_iter(%view_4811) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4823, %e1_4824, %e2_4825, %e3_4826 = cute.get_leaves(%iter_4822) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1846 = cute.get_scalars(%e0_4823) : !cute.int_tuple<"?">
      %1847 = cute.get_scalars(%e1_4824) : !cute.int_tuple<"?">
      %1848 = cute.get_scalars(%e2_4825) : !cute.int_tuple<"?">
      %1849 = cute.get_scalars(%e3_4826) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4827 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4828 = cute.add_offset(%e3_4826, %int_tuple_4827) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1850 = cute.get_scalars(%tup_4828) : !cute.int_tuple<"?">
      %coord_4829 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4830 = cute.make_coord(%tup_4828) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1851 = cute.get_scalars(%coord_4829) : !cute.coord<"?">
      %1852 = cute.get_scalars(%coord_4830) : !cute.coord<"?">
      %true_4831 = arith.constant true
      %1853 = arith.cmpi slt, %1851, %1852 : i32
      %1854 = arith.andi %true_4831, %1853 : i1
      %lay_4832 = cute.get_layout(%1835) : !memref_rmem_f32_4
      %1855 = cute.get_shape(%lay_4832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4833, %e1_4834, %e2_4835, %e3_4836 = cute.get_leaves(%1855) : !cute.shape<"((2,2),(2,8))">
      %1856 = cute.get_stride(%lay_4832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4837, %e1_4838, %e2_4839, %e3_4840 = cute.get_leaves(%1856) : !cute.stride<"((2,4),(1,8))">
      %1857 = scf.if %1854 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1835) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,8)">
        cute.memref.store(%1835, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,8)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1835) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1835 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1835) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1835) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1835 : !memref_rmem_f32_4
      }
      %iter_4841 = cute.get_iter(%1857) : !memref_rmem_f32_4
      %lay_4842 = cute.get_layout(%1857) : !memref_rmem_f32_4
      %1858 = cute.get_shape(%lay_4842) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4843, %e1_4844, %e2_4845, %e3_4846 = cute.get_leaves(%1858) : !cute.shape<"((2,2),(2,8))">
      %1859 = cute.get_stride(%lay_4842) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4847, %e1_4848, %e2_4849, %e3_4850 = cute.get_leaves(%1859) : !cute.stride<"((2,4),(1,8))">
      %iter_4851 = cute.get_iter(%1857) : !memref_rmem_f32_4
      %iter_4852 = cute.get_iter(%1857) : !memref_rmem_f32_4
      %coord_4853 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4854 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4855 = cute.crd2idx(%coord_4853, %lay_4854) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4856 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4857 = cute.add_offset(%iter_4856, %idx_4855) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4858 = cute.make_view(%tup_4857) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4859 = cute.get_iter(%view_4858) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4860, %e1_4861, %e2_4862, %e3_4863 = cute.get_leaves(%iter_4859) : !cute.int_tuple<"(?,?,?,?)">
      %1860 = cute.get_scalars(%e0_4860) : !cute.int_tuple<"?">
      %1861 = cute.get_scalars(%e1_4861) : !cute.int_tuple<"?">
      %1862 = cute.get_scalars(%e2_4862) : !cute.int_tuple<"?">
      %1863 = cute.get_scalars(%e3_4863) : !cute.int_tuple<"?">
      %iter_4864 = cute.get_iter(%view_4858) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4865, %e1_4866, %e2_4867, %e3_4868 = cute.get_leaves(%iter_4864) : !cute.int_tuple<"(?,?,?,?)">
      %1864 = cute.get_scalars(%e0_4865) : !cute.int_tuple<"?">
      %1865 = cute.get_scalars(%e1_4866) : !cute.int_tuple<"?">
      %1866 = cute.get_scalars(%e2_4867) : !cute.int_tuple<"?">
      %1867 = cute.get_scalars(%e3_4868) : !cute.int_tuple<"?">
      %iter_4869 = cute.get_iter(%view_4858) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4870, %e1_4871, %e2_4872, %e3_4873 = cute.get_leaves(%iter_4869) : !cute.int_tuple<"(?,?,?,?)">
      %1868 = cute.get_scalars(%e0_4870) : !cute.int_tuple<"?">
      %1869 = cute.get_scalars(%e1_4871) : !cute.int_tuple<"?">
      %1870 = cute.get_scalars(%e2_4872) : !cute.int_tuple<"?">
      %1871 = cute.get_scalars(%e3_4873) : !cute.int_tuple<"?">
      %int_tuple_4874 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4875 = cute.add_offset(%e3_4873, %int_tuple_4874) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1872 = cute.get_scalars(%tup_4875) : !cute.int_tuple<"?">
      %coord_4876 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4877 = cute.make_coord(%tup_4875) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1873 = cute.get_scalars(%coord_4876) : !cute.coord<"?">
      %1874 = cute.get_scalars(%coord_4877) : !cute.coord<"?">
      %true_4878 = arith.constant true
      %1875 = arith.cmpi slt, %1873, %1874 : i32
      %1876 = arith.andi %true_4878, %1875 : i1
      %lay_4879 = cute.get_layout(%1857) : !memref_rmem_f32_4
      %1877 = cute.get_shape(%lay_4879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4880, %e1_4881, %e2_4882, %e3_4883 = cute.get_leaves(%1877) : !cute.shape<"((2,2),(2,8))">
      %1878 = cute.get_stride(%lay_4879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4884, %e1_4885, %e2_4886, %e3_4887 = cute.get_leaves(%1878) : !cute.stride<"((2,4),(1,8))">
      %1879 = scf.if %1876 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1857) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,9)">
        cute.memref.store(%1857, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,9)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1857) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1857 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1857) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1857) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1857 : !memref_rmem_f32_4
      }
      %iter_4888 = cute.get_iter(%1879) : !memref_rmem_f32_4
      %lay_4889 = cute.get_layout(%1879) : !memref_rmem_f32_4
      %1880 = cute.get_shape(%lay_4889) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4890, %e1_4891, %e2_4892, %e3_4893 = cute.get_leaves(%1880) : !cute.shape<"((2,2),(2,8))">
      %1881 = cute.get_stride(%lay_4889) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4894, %e1_4895, %e2_4896, %e3_4897 = cute.get_leaves(%1881) : !cute.stride<"((2,4),(1,8))">
      %iter_4898 = cute.get_iter(%1879) : !memref_rmem_f32_4
      %iter_4899 = cute.get_iter(%1879) : !memref_rmem_f32_4
      %coord_4900 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4901 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4902 = cute.crd2idx(%coord_4900, %lay_4901) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4903 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4904 = cute.add_offset(%iter_4903, %idx_4902) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4905 = cute.make_view(%tup_4904) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4906 = cute.get_iter(%view_4905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%iter_4906) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1882 = cute.get_scalars(%e0_4907) : !cute.int_tuple<"?">
      %1883 = cute.get_scalars(%e1_4908) : !cute.int_tuple<"?">
      %1884 = cute.get_scalars(%e2_4909) : !cute.int_tuple<"?">
      %1885 = cute.get_scalars(%e3_4910) : !cute.int_tuple<"?{div=2}">
      %iter_4911 = cute.get_iter(%view_4905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4912, %e1_4913, %e2_4914, %e3_4915 = cute.get_leaves(%iter_4911) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1886 = cute.get_scalars(%e0_4912) : !cute.int_tuple<"?">
      %1887 = cute.get_scalars(%e1_4913) : !cute.int_tuple<"?">
      %1888 = cute.get_scalars(%e2_4914) : !cute.int_tuple<"?">
      %1889 = cute.get_scalars(%e3_4915) : !cute.int_tuple<"?{div=2}">
      %iter_4916 = cute.get_iter(%view_4905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4917, %e1_4918, %e2_4919, %e3_4920 = cute.get_leaves(%iter_4916) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1890 = cute.get_scalars(%e0_4917) : !cute.int_tuple<"?">
      %1891 = cute.get_scalars(%e1_4918) : !cute.int_tuple<"?">
      %1892 = cute.get_scalars(%e2_4919) : !cute.int_tuple<"?">
      %1893 = cute.get_scalars(%e3_4920) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4921 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4922 = cute.add_offset(%e3_4920, %int_tuple_4921) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1894 = cute.get_scalars(%tup_4922) : !cute.int_tuple<"?">
      %coord_4923 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4924 = cute.make_coord(%tup_4922) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1895 = cute.get_scalars(%coord_4923) : !cute.coord<"?">
      %1896 = cute.get_scalars(%coord_4924) : !cute.coord<"?">
      %true_4925 = arith.constant true
      %1897 = arith.cmpi slt, %1895, %1896 : i32
      %1898 = arith.andi %true_4925, %1897 : i1
      %lay_4926 = cute.get_layout(%1879) : !memref_rmem_f32_4
      %1899 = cute.get_shape(%lay_4926) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4927, %e1_4928, %e2_4929, %e3_4930 = cute.get_leaves(%1899) : !cute.shape<"((2,2),(2,8))">
      %1900 = cute.get_stride(%lay_4926) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4931, %e1_4932, %e2_4933, %e3_4934 = cute.get_leaves(%1900) : !cute.stride<"((2,4),(1,8))">
      %1901 = scf.if %1898 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1879) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,10)">
        cute.memref.store(%1879, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,10)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1879) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1879 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1879) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1879) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1879 : !memref_rmem_f32_4
      }
      %iter_4935 = cute.get_iter(%1901) : !memref_rmem_f32_4
      %lay_4936 = cute.get_layout(%1901) : !memref_rmem_f32_4
      %1902 = cute.get_shape(%lay_4936) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4937, %e1_4938, %e2_4939, %e3_4940 = cute.get_leaves(%1902) : !cute.shape<"((2,2),(2,8))">
      %1903 = cute.get_stride(%lay_4936) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4941, %e1_4942, %e2_4943, %e3_4944 = cute.get_leaves(%1903) : !cute.stride<"((2,4),(1,8))">
      %iter_4945 = cute.get_iter(%1901) : !memref_rmem_f32_4
      %iter_4946 = cute.get_iter(%1901) : !memref_rmem_f32_4
      %coord_4947 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4948 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4949 = cute.crd2idx(%coord_4947, %lay_4948) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4950 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4951 = cute.add_offset(%iter_4950, %idx_4949) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4952 = cute.make_view(%tup_4951) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4953 = cute.get_iter(%view_4952) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4954, %e1_4955, %e2_4956, %e3_4957 = cute.get_leaves(%iter_4953) : !cute.int_tuple<"(?,?,?,?)">
      %1904 = cute.get_scalars(%e0_4954) : !cute.int_tuple<"?">
      %1905 = cute.get_scalars(%e1_4955) : !cute.int_tuple<"?">
      %1906 = cute.get_scalars(%e2_4956) : !cute.int_tuple<"?">
      %1907 = cute.get_scalars(%e3_4957) : !cute.int_tuple<"?">
      %iter_4958 = cute.get_iter(%view_4952) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4959, %e1_4960, %e2_4961, %e3_4962 = cute.get_leaves(%iter_4958) : !cute.int_tuple<"(?,?,?,?)">
      %1908 = cute.get_scalars(%e0_4959) : !cute.int_tuple<"?">
      %1909 = cute.get_scalars(%e1_4960) : !cute.int_tuple<"?">
      %1910 = cute.get_scalars(%e2_4961) : !cute.int_tuple<"?">
      %1911 = cute.get_scalars(%e3_4962) : !cute.int_tuple<"?">
      %iter_4963 = cute.get_iter(%view_4952) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4964, %e1_4965, %e2_4966, %e3_4967 = cute.get_leaves(%iter_4963) : !cute.int_tuple<"(?,?,?,?)">
      %1912 = cute.get_scalars(%e0_4964) : !cute.int_tuple<"?">
      %1913 = cute.get_scalars(%e1_4965) : !cute.int_tuple<"?">
      %1914 = cute.get_scalars(%e2_4966) : !cute.int_tuple<"?">
      %1915 = cute.get_scalars(%e3_4967) : !cute.int_tuple<"?">
      %int_tuple_4968 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4969 = cute.add_offset(%e3_4967, %int_tuple_4968) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1916 = cute.get_scalars(%tup_4969) : !cute.int_tuple<"?">
      %coord_4970 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4971 = cute.make_coord(%tup_4969) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1917 = cute.get_scalars(%coord_4970) : !cute.coord<"?">
      %1918 = cute.get_scalars(%coord_4971) : !cute.coord<"?">
      %true_4972 = arith.constant true
      %1919 = arith.cmpi slt, %1917, %1918 : i32
      %1920 = arith.andi %true_4972, %1919 : i1
      %lay_4973 = cute.get_layout(%1901) : !memref_rmem_f32_4
      %1921 = cute.get_shape(%lay_4973) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4974, %e1_4975, %e2_4976, %e3_4977 = cute.get_leaves(%1921) : !cute.shape<"((2,2),(2,8))">
      %1922 = cute.get_stride(%lay_4973) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4978, %e1_4979, %e2_4980, %e3_4981 = cute.get_leaves(%1922) : !cute.stride<"((2,4),(1,8))">
      %1923 = scf.if %1920 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1901) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,11)">
        cute.memref.store(%1901, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,11)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1901) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1901 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1901) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1901) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1901 : !memref_rmem_f32_4
      }
      %iter_4982 = cute.get_iter(%1923) : !memref_rmem_f32_4
      %lay_4983 = cute.get_layout(%1923) : !memref_rmem_f32_4
      %1924 = cute.get_shape(%lay_4983) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4984, %e1_4985, %e2_4986, %e3_4987 = cute.get_leaves(%1924) : !cute.shape<"((2,2),(2,8))">
      %1925 = cute.get_stride(%lay_4983) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4988, %e1_4989, %e2_4990, %e3_4991 = cute.get_leaves(%1925) : !cute.stride<"((2,4),(1,8))">
      %iter_4992 = cute.get_iter(%1923) : !memref_rmem_f32_4
      %iter_4993 = cute.get_iter(%1923) : !memref_rmem_f32_4
      %coord_4994 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4995 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4996 = cute.crd2idx(%coord_4994, %lay_4995) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4997 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4998 = cute.add_offset(%iter_4997, %idx_4996) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4999 = cute.make_view(%tup_4998) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5000 = cute.get_iter(%view_4999) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5001, %e1_5002, %e2_5003, %e3_5004 = cute.get_leaves(%iter_5000) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1926 = cute.get_scalars(%e0_5001) : !cute.int_tuple<"?">
      %1927 = cute.get_scalars(%e1_5002) : !cute.int_tuple<"?">
      %1928 = cute.get_scalars(%e2_5003) : !cute.int_tuple<"?">
      %1929 = cute.get_scalars(%e3_5004) : !cute.int_tuple<"?{div=2}">
      %iter_5005 = cute.get_iter(%view_4999) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5006, %e1_5007, %e2_5008, %e3_5009 = cute.get_leaves(%iter_5005) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1930 = cute.get_scalars(%e0_5006) : !cute.int_tuple<"?">
      %1931 = cute.get_scalars(%e1_5007) : !cute.int_tuple<"?">
      %1932 = cute.get_scalars(%e2_5008) : !cute.int_tuple<"?">
      %1933 = cute.get_scalars(%e3_5009) : !cute.int_tuple<"?{div=2}">
      %iter_5010 = cute.get_iter(%view_4999) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5011, %e1_5012, %e2_5013, %e3_5014 = cute.get_leaves(%iter_5010) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1934 = cute.get_scalars(%e0_5011) : !cute.int_tuple<"?">
      %1935 = cute.get_scalars(%e1_5012) : !cute.int_tuple<"?">
      %1936 = cute.get_scalars(%e2_5013) : !cute.int_tuple<"?">
      %1937 = cute.get_scalars(%e3_5014) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5015 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5016 = cute.add_offset(%e3_5014, %int_tuple_5015) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1938 = cute.get_scalars(%tup_5016) : !cute.int_tuple<"?">
      %coord_5017 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5018 = cute.make_coord(%tup_5016) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1939 = cute.get_scalars(%coord_5017) : !cute.coord<"?">
      %1940 = cute.get_scalars(%coord_5018) : !cute.coord<"?">
      %true_5019 = arith.constant true
      %1941 = arith.cmpi slt, %1939, %1940 : i32
      %1942 = arith.andi %true_5019, %1941 : i1
      %lay_5020 = cute.get_layout(%1923) : !memref_rmem_f32_4
      %1943 = cute.get_shape(%lay_5020) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5021, %e1_5022, %e2_5023, %e3_5024 = cute.get_leaves(%1943) : !cute.shape<"((2,2),(2,8))">
      %1944 = cute.get_stride(%lay_5020) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5025, %e1_5026, %e2_5027, %e3_5028 = cute.get_leaves(%1944) : !cute.stride<"((2,4),(1,8))">
      %1945 = scf.if %1942 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1923) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,12)">
        cute.memref.store(%1923, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,12)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1923) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1923 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1923) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1923) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1923 : !memref_rmem_f32_4
      }
      %iter_5029 = cute.get_iter(%1945) : !memref_rmem_f32_4
      %lay_5030 = cute.get_layout(%1945) : !memref_rmem_f32_4
      %1946 = cute.get_shape(%lay_5030) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5031, %e1_5032, %e2_5033, %e3_5034 = cute.get_leaves(%1946) : !cute.shape<"((2,2),(2,8))">
      %1947 = cute.get_stride(%lay_5030) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5035, %e1_5036, %e2_5037, %e3_5038 = cute.get_leaves(%1947) : !cute.stride<"((2,4),(1,8))">
      %iter_5039 = cute.get_iter(%1945) : !memref_rmem_f32_4
      %iter_5040 = cute.get_iter(%1945) : !memref_rmem_f32_4
      %coord_5041 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5042 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5043 = cute.crd2idx(%coord_5041, %lay_5042) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5044 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5045 = cute.add_offset(%iter_5044, %idx_5043) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5046 = cute.make_view(%tup_5045) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5047 = cute.get_iter(%view_5046) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5048, %e1_5049, %e2_5050, %e3_5051 = cute.get_leaves(%iter_5047) : !cute.int_tuple<"(?,?,?,?)">
      %1948 = cute.get_scalars(%e0_5048) : !cute.int_tuple<"?">
      %1949 = cute.get_scalars(%e1_5049) : !cute.int_tuple<"?">
      %1950 = cute.get_scalars(%e2_5050) : !cute.int_tuple<"?">
      %1951 = cute.get_scalars(%e3_5051) : !cute.int_tuple<"?">
      %iter_5052 = cute.get_iter(%view_5046) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%iter_5052) : !cute.int_tuple<"(?,?,?,?)">
      %1952 = cute.get_scalars(%e0_5053) : !cute.int_tuple<"?">
      %1953 = cute.get_scalars(%e1_5054) : !cute.int_tuple<"?">
      %1954 = cute.get_scalars(%e2_5055) : !cute.int_tuple<"?">
      %1955 = cute.get_scalars(%e3_5056) : !cute.int_tuple<"?">
      %iter_5057 = cute.get_iter(%view_5046) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5058, %e1_5059, %e2_5060, %e3_5061 = cute.get_leaves(%iter_5057) : !cute.int_tuple<"(?,?,?,?)">
      %1956 = cute.get_scalars(%e0_5058) : !cute.int_tuple<"?">
      %1957 = cute.get_scalars(%e1_5059) : !cute.int_tuple<"?">
      %1958 = cute.get_scalars(%e2_5060) : !cute.int_tuple<"?">
      %1959 = cute.get_scalars(%e3_5061) : !cute.int_tuple<"?">
      %int_tuple_5062 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5063 = cute.add_offset(%e3_5061, %int_tuple_5062) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1960 = cute.get_scalars(%tup_5063) : !cute.int_tuple<"?">
      %coord_5064 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5065 = cute.make_coord(%tup_5063) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1961 = cute.get_scalars(%coord_5064) : !cute.coord<"?">
      %1962 = cute.get_scalars(%coord_5065) : !cute.coord<"?">
      %true_5066 = arith.constant true
      %1963 = arith.cmpi slt, %1961, %1962 : i32
      %1964 = arith.andi %true_5066, %1963 : i1
      %lay_5067 = cute.get_layout(%1945) : !memref_rmem_f32_4
      %1965 = cute.get_shape(%lay_5067) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5068, %e1_5069, %e2_5070, %e3_5071 = cute.get_leaves(%1965) : !cute.shape<"((2,2),(2,8))">
      %1966 = cute.get_stride(%lay_5067) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5072, %e1_5073, %e2_5074, %e3_5075 = cute.get_leaves(%1966) : !cute.stride<"((2,4),(1,8))">
      %1967 = scf.if %1964 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1945) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,13)">
        cute.memref.store(%1945, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,13)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1945) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1945 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1945) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1945) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1945 : !memref_rmem_f32_4
      }
      %iter_5076 = cute.get_iter(%1967) : !memref_rmem_f32_4
      %lay_5077 = cute.get_layout(%1967) : !memref_rmem_f32_4
      %1968 = cute.get_shape(%lay_5077) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5078, %e1_5079, %e2_5080, %e3_5081 = cute.get_leaves(%1968) : !cute.shape<"((2,2),(2,8))">
      %1969 = cute.get_stride(%lay_5077) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5082, %e1_5083, %e2_5084, %e3_5085 = cute.get_leaves(%1969) : !cute.stride<"((2,4),(1,8))">
      %iter_5086 = cute.get_iter(%1967) : !memref_rmem_f32_4
      %iter_5087 = cute.get_iter(%1967) : !memref_rmem_f32_4
      %coord_5088 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5089 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5090 = cute.crd2idx(%coord_5088, %lay_5089) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5091 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5092 = cute.add_offset(%iter_5091, %idx_5090) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5093 = cute.make_view(%tup_5092) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5094 = cute.get_iter(%view_5093) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5095, %e1_5096, %e2_5097, %e3_5098 = cute.get_leaves(%iter_5094) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1970 = cute.get_scalars(%e0_5095) : !cute.int_tuple<"?">
      %1971 = cute.get_scalars(%e1_5096) : !cute.int_tuple<"?">
      %1972 = cute.get_scalars(%e2_5097) : !cute.int_tuple<"?">
      %1973 = cute.get_scalars(%e3_5098) : !cute.int_tuple<"?{div=2}">
      %iter_5099 = cute.get_iter(%view_5093) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5100, %e1_5101, %e2_5102, %e3_5103 = cute.get_leaves(%iter_5099) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1974 = cute.get_scalars(%e0_5100) : !cute.int_tuple<"?">
      %1975 = cute.get_scalars(%e1_5101) : !cute.int_tuple<"?">
      %1976 = cute.get_scalars(%e2_5102) : !cute.int_tuple<"?">
      %1977 = cute.get_scalars(%e3_5103) : !cute.int_tuple<"?{div=2}">
      %iter_5104 = cute.get_iter(%view_5093) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5105, %e1_5106, %e2_5107, %e3_5108 = cute.get_leaves(%iter_5104) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1978 = cute.get_scalars(%e0_5105) : !cute.int_tuple<"?">
      %1979 = cute.get_scalars(%e1_5106) : !cute.int_tuple<"?">
      %1980 = cute.get_scalars(%e2_5107) : !cute.int_tuple<"?">
      %1981 = cute.get_scalars(%e3_5108) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5109 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5110 = cute.add_offset(%e3_5108, %int_tuple_5109) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1982 = cute.get_scalars(%tup_5110) : !cute.int_tuple<"?">
      %coord_5111 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5112 = cute.make_coord(%tup_5110) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1983 = cute.get_scalars(%coord_5111) : !cute.coord<"?">
      %1984 = cute.get_scalars(%coord_5112) : !cute.coord<"?">
      %true_5113 = arith.constant true
      %1985 = arith.cmpi slt, %1983, %1984 : i32
      %1986 = arith.andi %true_5113, %1985 : i1
      %lay_5114 = cute.get_layout(%1967) : !memref_rmem_f32_4
      %1987 = cute.get_shape(%lay_5114) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1987) : !cute.shape<"((2,2),(2,8))">
      %1988 = cute.get_stride(%lay_5114) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5119, %e1_5120, %e2_5121, %e3_5122 = cute.get_leaves(%1988) : !cute.stride<"((2,4),(1,8))">
      %1989 = scf.if %1986 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1967) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,14)">
        cute.memref.store(%1967, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,14)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1967) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1967 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1967) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1967) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1967 : !memref_rmem_f32_4
      }
      %iter_5123 = cute.get_iter(%1989) : !memref_rmem_f32_4
      %lay_5124 = cute.get_layout(%1989) : !memref_rmem_f32_4
      %1990 = cute.get_shape(%lay_5124) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5125, %e1_5126, %e2_5127, %e3_5128 = cute.get_leaves(%1990) : !cute.shape<"((2,2),(2,8))">
      %1991 = cute.get_stride(%lay_5124) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5129, %e1_5130, %e2_5131, %e3_5132 = cute.get_leaves(%1991) : !cute.stride<"((2,4),(1,8))">
      %iter_5133 = cute.get_iter(%1989) : !memref_rmem_f32_4
      %iter_5134 = cute.get_iter(%1989) : !memref_rmem_f32_4
      %coord_5135 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5136 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5137 = cute.crd2idx(%coord_5135, %lay_5136) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5138 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5139 = cute.add_offset(%iter_5138, %idx_5137) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5140 = cute.make_view(%tup_5139) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5141 = cute.get_iter(%view_5140) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5142, %e1_5143, %e2_5144, %e3_5145 = cute.get_leaves(%iter_5141) : !cute.int_tuple<"(?,?,?,?)">
      %1992 = cute.get_scalars(%e0_5142) : !cute.int_tuple<"?">
      %1993 = cute.get_scalars(%e1_5143) : !cute.int_tuple<"?">
      %1994 = cute.get_scalars(%e2_5144) : !cute.int_tuple<"?">
      %1995 = cute.get_scalars(%e3_5145) : !cute.int_tuple<"?">
      %iter_5146 = cute.get_iter(%view_5140) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5147, %e1_5148, %e2_5149, %e3_5150 = cute.get_leaves(%iter_5146) : !cute.int_tuple<"(?,?,?,?)">
      %1996 = cute.get_scalars(%e0_5147) : !cute.int_tuple<"?">
      %1997 = cute.get_scalars(%e1_5148) : !cute.int_tuple<"?">
      %1998 = cute.get_scalars(%e2_5149) : !cute.int_tuple<"?">
      %1999 = cute.get_scalars(%e3_5150) : !cute.int_tuple<"?">
      %iter_5151 = cute.get_iter(%view_5140) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5152, %e1_5153, %e2_5154, %e3_5155 = cute.get_leaves(%iter_5151) : !cute.int_tuple<"(?,?,?,?)">
      %2000 = cute.get_scalars(%e0_5152) : !cute.int_tuple<"?">
      %2001 = cute.get_scalars(%e1_5153) : !cute.int_tuple<"?">
      %2002 = cute.get_scalars(%e2_5154) : !cute.int_tuple<"?">
      %2003 = cute.get_scalars(%e3_5155) : !cute.int_tuple<"?">
      %int_tuple_5156 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5157 = cute.add_offset(%e3_5155, %int_tuple_5156) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2004 = cute.get_scalars(%tup_5157) : !cute.int_tuple<"?">
      %coord_5158 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5159 = cute.make_coord(%tup_5157) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2005 = cute.get_scalars(%coord_5158) : !cute.coord<"?">
      %2006 = cute.get_scalars(%coord_5159) : !cute.coord<"?">
      %true_5160 = arith.constant true
      %2007 = arith.cmpi slt, %2005, %2006 : i32
      %2008 = arith.andi %true_5160, %2007 : i1
      %lay_5161 = cute.get_layout(%1989) : !memref_rmem_f32_4
      %2009 = cute.get_shape(%lay_5161) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5162, %e1_5163, %e2_5164, %e3_5165 = cute.get_leaves(%2009) : !cute.shape<"((2,2),(2,8))">
      %2010 = cute.get_stride(%lay_5161) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5166, %e1_5167, %e2_5168, %e3_5169 = cute.get_leaves(%2010) : !cute.stride<"((2,4),(1,8))">
      %2011 = scf.if %2008 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%1989) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(1,15)">
        cute.memref.store(%1989, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(1,15)">, f32) -> ()
        %lay_8607 = cute.get_layout(%1989) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1989 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%1989) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%1989) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1989 : !memref_rmem_f32_4
      }
      %iter_5170 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %lay_5171 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %2012 = cute.get_shape(%lay_5171) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5172, %e1_5173, %e2_5174, %e3_5175 = cute.get_leaves(%2012) : !cute.shape<"((2,2),(2,8))">
      %2013 = cute.get_stride(%lay_5171) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5176, %e1_5177, %e2_5178, %e3_5179 = cute.get_leaves(%2013) : !cute.stride<"((2,4),(1,8))">
      %iter_5180 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %iter_5181 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %coord_5182 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_5183 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %idx_5184 = cute.crd2idx(%coord_5182, %lay_5183) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_5185 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %ptr_5186 = cute.add_offset(%iter_5185, %idx_5184) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_5187 = cute.make_view(%ptr_5186) : !memref_rmem_f32_7
      %iter_5188 = cute.get_iter(%view_5187) : !memref_rmem_f32_7
      %iter_5189 = cute.get_iter(%view_5187) : !memref_rmem_f32_7
      %lay_5190 = cute.get_layout(%view_5187) : !memref_rmem_f32_7
      %2014 = cute.get_shape(%lay_5190) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5191, %e1_5192 = cute.get_leaves(%2014) : !cute.shape<"((2,8))">
      %2015 = cute.memref.load_vec %view_5187 : !memref_rmem_f32_7
      %cst_5193 = arith.constant 0xFF800000 : f32
      %2016 = vector.reduction <maximumf>, %2015, %cst_5193 : vector<16xf32> into f32
      %c-1_i32_5194 = arith.constant -1 : i32
      %c2_i32_5195 = arith.constant 2 : i32
      %c31_i32_5196 = arith.constant 31 : i32
      %2017 = nvvm.shfl.sync  bfly %c-1_i32_5194, %2016, %c2_i32_5195, %c31_i32_5196 : f32 -> f32
      %2018 = nvvm.fmax %2016, %2017
      %c-1_i32_5197 = arith.constant -1 : i32
      %c1_i32_5198 = arith.constant 1 : i32
      %c31_i32_5199 = arith.constant 31 : i32
      %2019 = nvvm.shfl.sync  bfly %c-1_i32_5197, %2018, %c1_i32_5198, %c31_i32_5199 : f32 -> f32
      %2020 = nvvm.fmax %2018, %2019
      %2021 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2022 = arith.mulf %2015, %2021 : vector<16xf32>
      %2023 = arith.mulf %2020, %arg4 : f32
      %2024 = vector.broadcast %2023 : f32 to vector<16xf32>
      %2025 = arith.subf %2022, %2024 : vector<16xf32>
      %2026 = math.exp2 %2025 fastmath<fast> : vector<16xf32>
      %cst_5200 = arith.constant 0.000000e+00 : f32
      %2027 = vector.reduction <add>, %2026, %cst_5200 : vector<16xf32> into f32
      %coord_5201 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1595, %coord_5201, %2020) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_5202 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1600, %coord_5202, %2027) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_5203 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_5204 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %idx_5205 = cute.crd2idx(%coord_5203, %lay_5204) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_5206 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %ptr_5207 = cute.add_offset(%iter_5206, %idx_5205) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_5208 = cute.make_view(%ptr_5207) : !memref_rmem_f32_7
      %iter_5209 = cute.get_iter(%view_5208) : !memref_rmem_f32_7
      %iter_5210 = cute.get_iter(%view_5208) : !memref_rmem_f32_7
      %lay_5211 = cute.get_layout(%view_5208) : !memref_rmem_f32_7
      %2028 = cute.get_shape(%lay_5211) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5212, %e1_5213 = cute.get_leaves(%2028) : !cute.shape<"((2,8))">
      %int_tuple_5214 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5215 = cute.size(%int_tuple_5214) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5216 = cute.get_leaves(%sz_5215) : !cute.int_tuple<"16">
      %int_tuple_5217 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5218 = cute.size(%int_tuple_5217) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5219 = cute.get_leaves(%sz_5218) : !cute.int_tuple<"16">
      cute.memref.store_vec %2026, %view_5208 : !memref_rmem_f32_7
      %int_tuple_5220 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_5221 = cute.size(%int_tuple_5220) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_5222 = cute.get_leaves(%sz_5221) : !cute.int_tuple<"16">
      %coord_5223 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_5224 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5225 = cute.crd2idx(%coord_5223, %lay_5224) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_5226 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5227 = cute.add_offset(%iter_5226, %idx_5225) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5228 = cute.make_view(%tup_5227) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5229 = cute.get_iter(%view_5228) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5230, %e1_5231, %e2_5232, %e3_5233 = cute.get_leaves(%iter_5229) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2029 = cute.get_scalars(%e0_5230) : !cute.int_tuple<"?">
      %2030 = cute.get_scalars(%e1_5231) : !cute.int_tuple<"?">
      %2031 = cute.get_scalars(%e2_5232) : !cute.int_tuple<"?">
      %2032 = cute.get_scalars(%e3_5233) : !cute.int_tuple<"?{div=2}">
      %iter_5234 = cute.get_iter(%view_5228) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5235, %e1_5236, %e2_5237, %e3_5238 = cute.get_leaves(%iter_5234) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2033 = cute.get_scalars(%e0_5235) : !cute.int_tuple<"?">
      %2034 = cute.get_scalars(%e1_5236) : !cute.int_tuple<"?">
      %2035 = cute.get_scalars(%e2_5237) : !cute.int_tuple<"?">
      %2036 = cute.get_scalars(%e3_5238) : !cute.int_tuple<"?{div=2}">
      %iter_5239 = cute.get_iter(%view_5228) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5240, %e1_5241, %e2_5242, %e3_5243 = cute.get_leaves(%iter_5239) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2037 = cute.get_scalars(%e0_5240) : !cute.int_tuple<"?">
      %2038 = cute.get_scalars(%e1_5241) : !cute.int_tuple<"?">
      %2039 = cute.get_scalars(%e2_5242) : !cute.int_tuple<"?">
      %2040 = cute.get_scalars(%e3_5243) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5244 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5245 = cute.add_offset(%e3_5243, %int_tuple_5244) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2041 = cute.get_scalars(%tup_5245) : !cute.int_tuple<"?">
      %coord_5246 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5247 = cute.make_coord(%tup_5245) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2042 = cute.get_scalars(%coord_5246) : !cute.coord<"?">
      %2043 = cute.get_scalars(%coord_5247) : !cute.coord<"?">
      %true_5248 = arith.constant true
      %2044 = arith.cmpi slt, %2042, %2043 : i32
      %2045 = arith.andi %true_5248, %2044 : i1
      %lay_5249 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %2046 = cute.get_shape(%lay_5249) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5250, %e1_5251, %e2_5252, %e3_5253 = cute.get_leaves(%2046) : !cute.shape<"((2,2),(2,8))">
      %2047 = cute.get_stride(%lay_5249) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5254, %e1_5255, %e2_5256, %e3_5257 = cute.get_leaves(%2047) : !cute.stride<"((2,4),(1,8))">
      %2048 = scf.if %2045 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2011) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,0)">
        cute.memref.store(%2011, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,0)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2011) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2011 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2011) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2011) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2011 : !memref_rmem_f32_4
      }
      %iter_5258 = cute.get_iter(%2048) : !memref_rmem_f32_4
      %lay_5259 = cute.get_layout(%2048) : !memref_rmem_f32_4
      %2049 = cute.get_shape(%lay_5259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5260, %e1_5261, %e2_5262, %e3_5263 = cute.get_leaves(%2049) : !cute.shape<"((2,2),(2,8))">
      %2050 = cute.get_stride(%lay_5259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5264, %e1_5265, %e2_5266, %e3_5267 = cute.get_leaves(%2050) : !cute.stride<"((2,4),(1,8))">
      %iter_5268 = cute.get_iter(%2048) : !memref_rmem_f32_4
      %iter_5269 = cute.get_iter(%2048) : !memref_rmem_f32_4
      %coord_5270 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_5271 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5272 = cute.crd2idx(%coord_5270, %lay_5271) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_5273 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5274 = cute.add_offset(%iter_5273, %idx_5272) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5275 = cute.make_view(%tup_5274) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5276 = cute.get_iter(%view_5275) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5277, %e1_5278, %e2_5279, %e3_5280 = cute.get_leaves(%iter_5276) : !cute.int_tuple<"(?,?,?,?)">
      %2051 = cute.get_scalars(%e0_5277) : !cute.int_tuple<"?">
      %2052 = cute.get_scalars(%e1_5278) : !cute.int_tuple<"?">
      %2053 = cute.get_scalars(%e2_5279) : !cute.int_tuple<"?">
      %2054 = cute.get_scalars(%e3_5280) : !cute.int_tuple<"?">
      %iter_5281 = cute.get_iter(%view_5275) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5282, %e1_5283, %e2_5284, %e3_5285 = cute.get_leaves(%iter_5281) : !cute.int_tuple<"(?,?,?,?)">
      %2055 = cute.get_scalars(%e0_5282) : !cute.int_tuple<"?">
      %2056 = cute.get_scalars(%e1_5283) : !cute.int_tuple<"?">
      %2057 = cute.get_scalars(%e2_5284) : !cute.int_tuple<"?">
      %2058 = cute.get_scalars(%e3_5285) : !cute.int_tuple<"?">
      %iter_5286 = cute.get_iter(%view_5275) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5287, %e1_5288, %e2_5289, %e3_5290 = cute.get_leaves(%iter_5286) : !cute.int_tuple<"(?,?,?,?)">
      %2059 = cute.get_scalars(%e0_5287) : !cute.int_tuple<"?">
      %2060 = cute.get_scalars(%e1_5288) : !cute.int_tuple<"?">
      %2061 = cute.get_scalars(%e2_5289) : !cute.int_tuple<"?">
      %2062 = cute.get_scalars(%e3_5290) : !cute.int_tuple<"?">
      %int_tuple_5291 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5292 = cute.add_offset(%e3_5290, %int_tuple_5291) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2063 = cute.get_scalars(%tup_5292) : !cute.int_tuple<"?">
      %coord_5293 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5294 = cute.make_coord(%tup_5292) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2064 = cute.get_scalars(%coord_5293) : !cute.coord<"?">
      %2065 = cute.get_scalars(%coord_5294) : !cute.coord<"?">
      %true_5295 = arith.constant true
      %2066 = arith.cmpi slt, %2064, %2065 : i32
      %2067 = arith.andi %true_5295, %2066 : i1
      %lay_5296 = cute.get_layout(%2048) : !memref_rmem_f32_4
      %2068 = cute.get_shape(%lay_5296) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5297, %e1_5298, %e2_5299, %e3_5300 = cute.get_leaves(%2068) : !cute.shape<"((2,2),(2,8))">
      %2069 = cute.get_stride(%lay_5296) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5301, %e1_5302, %e2_5303, %e3_5304 = cute.get_leaves(%2069) : !cute.stride<"((2,4),(1,8))">
      %2070 = scf.if %2067 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2048) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,1)">
        cute.memref.store(%2048, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,1)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2048) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2048 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2048) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2048) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2048 : !memref_rmem_f32_4
      }
      %iter_5305 = cute.get_iter(%2070) : !memref_rmem_f32_4
      %lay_5306 = cute.get_layout(%2070) : !memref_rmem_f32_4
      %2071 = cute.get_shape(%lay_5306) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5307, %e1_5308, %e2_5309, %e3_5310 = cute.get_leaves(%2071) : !cute.shape<"((2,2),(2,8))">
      %2072 = cute.get_stride(%lay_5306) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5311, %e1_5312, %e2_5313, %e3_5314 = cute.get_leaves(%2072) : !cute.stride<"((2,4),(1,8))">
      %iter_5315 = cute.get_iter(%2070) : !memref_rmem_f32_4
      %iter_5316 = cute.get_iter(%2070) : !memref_rmem_f32_4
      %coord_5317 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_5318 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5319 = cute.crd2idx(%coord_5317, %lay_5318) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_5320 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5321 = cute.add_offset(%iter_5320, %idx_5319) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5322 = cute.make_view(%tup_5321) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5323 = cute.get_iter(%view_5322) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5324, %e1_5325, %e2_5326, %e3_5327 = cute.get_leaves(%iter_5323) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2073 = cute.get_scalars(%e0_5324) : !cute.int_tuple<"?">
      %2074 = cute.get_scalars(%e1_5325) : !cute.int_tuple<"?">
      %2075 = cute.get_scalars(%e2_5326) : !cute.int_tuple<"?">
      %2076 = cute.get_scalars(%e3_5327) : !cute.int_tuple<"?{div=2}">
      %iter_5328 = cute.get_iter(%view_5322) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5329, %e1_5330, %e2_5331, %e3_5332 = cute.get_leaves(%iter_5328) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2077 = cute.get_scalars(%e0_5329) : !cute.int_tuple<"?">
      %2078 = cute.get_scalars(%e1_5330) : !cute.int_tuple<"?">
      %2079 = cute.get_scalars(%e2_5331) : !cute.int_tuple<"?">
      %2080 = cute.get_scalars(%e3_5332) : !cute.int_tuple<"?{div=2}">
      %iter_5333 = cute.get_iter(%view_5322) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5334, %e1_5335, %e2_5336, %e3_5337 = cute.get_leaves(%iter_5333) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2081 = cute.get_scalars(%e0_5334) : !cute.int_tuple<"?">
      %2082 = cute.get_scalars(%e1_5335) : !cute.int_tuple<"?">
      %2083 = cute.get_scalars(%e2_5336) : !cute.int_tuple<"?">
      %2084 = cute.get_scalars(%e3_5337) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5338 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5339 = cute.add_offset(%e3_5337, %int_tuple_5338) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2085 = cute.get_scalars(%tup_5339) : !cute.int_tuple<"?">
      %coord_5340 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5341 = cute.make_coord(%tup_5339) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2086 = cute.get_scalars(%coord_5340) : !cute.coord<"?">
      %2087 = cute.get_scalars(%coord_5341) : !cute.coord<"?">
      %true_5342 = arith.constant true
      %2088 = arith.cmpi slt, %2086, %2087 : i32
      %2089 = arith.andi %true_5342, %2088 : i1
      %lay_5343 = cute.get_layout(%2070) : !memref_rmem_f32_4
      %2090 = cute.get_shape(%lay_5343) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5344, %e1_5345, %e2_5346, %e3_5347 = cute.get_leaves(%2090) : !cute.shape<"((2,2),(2,8))">
      %2091 = cute.get_stride(%lay_5343) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5348, %e1_5349, %e2_5350, %e3_5351 = cute.get_leaves(%2091) : !cute.stride<"((2,4),(1,8))">
      %2092 = scf.if %2089 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2070) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,2)">
        cute.memref.store(%2070, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,2)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2070) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2070 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2070) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2070) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2070 : !memref_rmem_f32_4
      }
      %iter_5352 = cute.get_iter(%2092) : !memref_rmem_f32_4
      %lay_5353 = cute.get_layout(%2092) : !memref_rmem_f32_4
      %2093 = cute.get_shape(%lay_5353) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5354, %e1_5355, %e2_5356, %e3_5357 = cute.get_leaves(%2093) : !cute.shape<"((2,2),(2,8))">
      %2094 = cute.get_stride(%lay_5353) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5358, %e1_5359, %e2_5360, %e3_5361 = cute.get_leaves(%2094) : !cute.stride<"((2,4),(1,8))">
      %iter_5362 = cute.get_iter(%2092) : !memref_rmem_f32_4
      %iter_5363 = cute.get_iter(%2092) : !memref_rmem_f32_4
      %coord_5364 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_5365 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5366 = cute.crd2idx(%coord_5364, %lay_5365) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_5367 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5368 = cute.add_offset(%iter_5367, %idx_5366) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5369 = cute.make_view(%tup_5368) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5370 = cute.get_iter(%view_5369) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5371, %e1_5372, %e2_5373, %e3_5374 = cute.get_leaves(%iter_5370) : !cute.int_tuple<"(?,?,?,?)">
      %2095 = cute.get_scalars(%e0_5371) : !cute.int_tuple<"?">
      %2096 = cute.get_scalars(%e1_5372) : !cute.int_tuple<"?">
      %2097 = cute.get_scalars(%e2_5373) : !cute.int_tuple<"?">
      %2098 = cute.get_scalars(%e3_5374) : !cute.int_tuple<"?">
      %iter_5375 = cute.get_iter(%view_5369) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5376, %e1_5377, %e2_5378, %e3_5379 = cute.get_leaves(%iter_5375) : !cute.int_tuple<"(?,?,?,?)">
      %2099 = cute.get_scalars(%e0_5376) : !cute.int_tuple<"?">
      %2100 = cute.get_scalars(%e1_5377) : !cute.int_tuple<"?">
      %2101 = cute.get_scalars(%e2_5378) : !cute.int_tuple<"?">
      %2102 = cute.get_scalars(%e3_5379) : !cute.int_tuple<"?">
      %iter_5380 = cute.get_iter(%view_5369) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5381, %e1_5382, %e2_5383, %e3_5384 = cute.get_leaves(%iter_5380) : !cute.int_tuple<"(?,?,?,?)">
      %2103 = cute.get_scalars(%e0_5381) : !cute.int_tuple<"?">
      %2104 = cute.get_scalars(%e1_5382) : !cute.int_tuple<"?">
      %2105 = cute.get_scalars(%e2_5383) : !cute.int_tuple<"?">
      %2106 = cute.get_scalars(%e3_5384) : !cute.int_tuple<"?">
      %int_tuple_5385 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5386 = cute.add_offset(%e3_5384, %int_tuple_5385) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2107 = cute.get_scalars(%tup_5386) : !cute.int_tuple<"?">
      %coord_5387 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5388 = cute.make_coord(%tup_5386) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2108 = cute.get_scalars(%coord_5387) : !cute.coord<"?">
      %2109 = cute.get_scalars(%coord_5388) : !cute.coord<"?">
      %true_5389 = arith.constant true
      %2110 = arith.cmpi slt, %2108, %2109 : i32
      %2111 = arith.andi %true_5389, %2110 : i1
      %lay_5390 = cute.get_layout(%2092) : !memref_rmem_f32_4
      %2112 = cute.get_shape(%lay_5390) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5391, %e1_5392, %e2_5393, %e3_5394 = cute.get_leaves(%2112) : !cute.shape<"((2,2),(2,8))">
      %2113 = cute.get_stride(%lay_5390) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5395, %e1_5396, %e2_5397, %e3_5398 = cute.get_leaves(%2113) : !cute.stride<"((2,4),(1,8))">
      %2114 = scf.if %2111 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2092) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,3)">
        cute.memref.store(%2092, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,3)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2092) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2092 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2092) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2092) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2092 : !memref_rmem_f32_4
      }
      %iter_5399 = cute.get_iter(%2114) : !memref_rmem_f32_4
      %lay_5400 = cute.get_layout(%2114) : !memref_rmem_f32_4
      %2115 = cute.get_shape(%lay_5400) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5401, %e1_5402, %e2_5403, %e3_5404 = cute.get_leaves(%2115) : !cute.shape<"((2,2),(2,8))">
      %2116 = cute.get_stride(%lay_5400) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5405, %e1_5406, %e2_5407, %e3_5408 = cute.get_leaves(%2116) : !cute.stride<"((2,4),(1,8))">
      %iter_5409 = cute.get_iter(%2114) : !memref_rmem_f32_4
      %iter_5410 = cute.get_iter(%2114) : !memref_rmem_f32_4
      %coord_5411 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_5412 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5413 = cute.crd2idx(%coord_5411, %lay_5412) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_5414 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5415 = cute.add_offset(%iter_5414, %idx_5413) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5416 = cute.make_view(%tup_5415) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5417 = cute.get_iter(%view_5416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5418, %e1_5419, %e2_5420, %e3_5421 = cute.get_leaves(%iter_5417) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2117 = cute.get_scalars(%e0_5418) : !cute.int_tuple<"?">
      %2118 = cute.get_scalars(%e1_5419) : !cute.int_tuple<"?">
      %2119 = cute.get_scalars(%e2_5420) : !cute.int_tuple<"?">
      %2120 = cute.get_scalars(%e3_5421) : !cute.int_tuple<"?{div=2}">
      %iter_5422 = cute.get_iter(%view_5416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5423, %e1_5424, %e2_5425, %e3_5426 = cute.get_leaves(%iter_5422) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2121 = cute.get_scalars(%e0_5423) : !cute.int_tuple<"?">
      %2122 = cute.get_scalars(%e1_5424) : !cute.int_tuple<"?">
      %2123 = cute.get_scalars(%e2_5425) : !cute.int_tuple<"?">
      %2124 = cute.get_scalars(%e3_5426) : !cute.int_tuple<"?{div=2}">
      %iter_5427 = cute.get_iter(%view_5416) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5428, %e1_5429, %e2_5430, %e3_5431 = cute.get_leaves(%iter_5427) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2125 = cute.get_scalars(%e0_5428) : !cute.int_tuple<"?">
      %2126 = cute.get_scalars(%e1_5429) : !cute.int_tuple<"?">
      %2127 = cute.get_scalars(%e2_5430) : !cute.int_tuple<"?">
      %2128 = cute.get_scalars(%e3_5431) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5432 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5433 = cute.add_offset(%e3_5431, %int_tuple_5432) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2129 = cute.get_scalars(%tup_5433) : !cute.int_tuple<"?">
      %coord_5434 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5435 = cute.make_coord(%tup_5433) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2130 = cute.get_scalars(%coord_5434) : !cute.coord<"?">
      %2131 = cute.get_scalars(%coord_5435) : !cute.coord<"?">
      %true_5436 = arith.constant true
      %2132 = arith.cmpi slt, %2130, %2131 : i32
      %2133 = arith.andi %true_5436, %2132 : i1
      %lay_5437 = cute.get_layout(%2114) : !memref_rmem_f32_4
      %2134 = cute.get_shape(%lay_5437) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5438, %e1_5439, %e2_5440, %e3_5441 = cute.get_leaves(%2134) : !cute.shape<"((2,2),(2,8))">
      %2135 = cute.get_stride(%lay_5437) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5442, %e1_5443, %e2_5444, %e3_5445 = cute.get_leaves(%2135) : !cute.stride<"((2,4),(1,8))">
      %2136 = scf.if %2133 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2114) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,4)">
        cute.memref.store(%2114, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,4)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2114) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2114 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2114) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2114) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2114 : !memref_rmem_f32_4
      }
      %iter_5446 = cute.get_iter(%2136) : !memref_rmem_f32_4
      %lay_5447 = cute.get_layout(%2136) : !memref_rmem_f32_4
      %2137 = cute.get_shape(%lay_5447) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5448, %e1_5449, %e2_5450, %e3_5451 = cute.get_leaves(%2137) : !cute.shape<"((2,2),(2,8))">
      %2138 = cute.get_stride(%lay_5447) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5452, %e1_5453, %e2_5454, %e3_5455 = cute.get_leaves(%2138) : !cute.stride<"((2,4),(1,8))">
      %iter_5456 = cute.get_iter(%2136) : !memref_rmem_f32_4
      %iter_5457 = cute.get_iter(%2136) : !memref_rmem_f32_4
      %coord_5458 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_5459 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5460 = cute.crd2idx(%coord_5458, %lay_5459) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_5461 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5462 = cute.add_offset(%iter_5461, %idx_5460) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5463 = cute.make_view(%tup_5462) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5464 = cute.get_iter(%view_5463) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5465, %e1_5466, %e2_5467, %e3_5468 = cute.get_leaves(%iter_5464) : !cute.int_tuple<"(?,?,?,?)">
      %2139 = cute.get_scalars(%e0_5465) : !cute.int_tuple<"?">
      %2140 = cute.get_scalars(%e1_5466) : !cute.int_tuple<"?">
      %2141 = cute.get_scalars(%e2_5467) : !cute.int_tuple<"?">
      %2142 = cute.get_scalars(%e3_5468) : !cute.int_tuple<"?">
      %iter_5469 = cute.get_iter(%view_5463) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5470, %e1_5471, %e2_5472, %e3_5473 = cute.get_leaves(%iter_5469) : !cute.int_tuple<"(?,?,?,?)">
      %2143 = cute.get_scalars(%e0_5470) : !cute.int_tuple<"?">
      %2144 = cute.get_scalars(%e1_5471) : !cute.int_tuple<"?">
      %2145 = cute.get_scalars(%e2_5472) : !cute.int_tuple<"?">
      %2146 = cute.get_scalars(%e3_5473) : !cute.int_tuple<"?">
      %iter_5474 = cute.get_iter(%view_5463) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5475, %e1_5476, %e2_5477, %e3_5478 = cute.get_leaves(%iter_5474) : !cute.int_tuple<"(?,?,?,?)">
      %2147 = cute.get_scalars(%e0_5475) : !cute.int_tuple<"?">
      %2148 = cute.get_scalars(%e1_5476) : !cute.int_tuple<"?">
      %2149 = cute.get_scalars(%e2_5477) : !cute.int_tuple<"?">
      %2150 = cute.get_scalars(%e3_5478) : !cute.int_tuple<"?">
      %int_tuple_5479 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5480 = cute.add_offset(%e3_5478, %int_tuple_5479) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2151 = cute.get_scalars(%tup_5480) : !cute.int_tuple<"?">
      %coord_5481 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5482 = cute.make_coord(%tup_5480) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2152 = cute.get_scalars(%coord_5481) : !cute.coord<"?">
      %2153 = cute.get_scalars(%coord_5482) : !cute.coord<"?">
      %true_5483 = arith.constant true
      %2154 = arith.cmpi slt, %2152, %2153 : i32
      %2155 = arith.andi %true_5483, %2154 : i1
      %lay_5484 = cute.get_layout(%2136) : !memref_rmem_f32_4
      %2156 = cute.get_shape(%lay_5484) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5485, %e1_5486, %e2_5487, %e3_5488 = cute.get_leaves(%2156) : !cute.shape<"((2,2),(2,8))">
      %2157 = cute.get_stride(%lay_5484) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5489, %e1_5490, %e2_5491, %e3_5492 = cute.get_leaves(%2157) : !cute.stride<"((2,4),(1,8))">
      %2158 = scf.if %2155 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2136) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,5)">
        cute.memref.store(%2136, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,5)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2136) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2136 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2136) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2136) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2136 : !memref_rmem_f32_4
      }
      %iter_5493 = cute.get_iter(%2158) : !memref_rmem_f32_4
      %lay_5494 = cute.get_layout(%2158) : !memref_rmem_f32_4
      %2159 = cute.get_shape(%lay_5494) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5495, %e1_5496, %e2_5497, %e3_5498 = cute.get_leaves(%2159) : !cute.shape<"((2,2),(2,8))">
      %2160 = cute.get_stride(%lay_5494) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5499, %e1_5500, %e2_5501, %e3_5502 = cute.get_leaves(%2160) : !cute.stride<"((2,4),(1,8))">
      %iter_5503 = cute.get_iter(%2158) : !memref_rmem_f32_4
      %iter_5504 = cute.get_iter(%2158) : !memref_rmem_f32_4
      %coord_5505 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_5506 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5507 = cute.crd2idx(%coord_5505, %lay_5506) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_5508 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5509 = cute.add_offset(%iter_5508, %idx_5507) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5510 = cute.make_view(%tup_5509) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5511 = cute.get_iter(%view_5510) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5512, %e1_5513, %e2_5514, %e3_5515 = cute.get_leaves(%iter_5511) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2161 = cute.get_scalars(%e0_5512) : !cute.int_tuple<"?">
      %2162 = cute.get_scalars(%e1_5513) : !cute.int_tuple<"?">
      %2163 = cute.get_scalars(%e2_5514) : !cute.int_tuple<"?">
      %2164 = cute.get_scalars(%e3_5515) : !cute.int_tuple<"?{div=2}">
      %iter_5516 = cute.get_iter(%view_5510) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5517, %e1_5518, %e2_5519, %e3_5520 = cute.get_leaves(%iter_5516) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2165 = cute.get_scalars(%e0_5517) : !cute.int_tuple<"?">
      %2166 = cute.get_scalars(%e1_5518) : !cute.int_tuple<"?">
      %2167 = cute.get_scalars(%e2_5519) : !cute.int_tuple<"?">
      %2168 = cute.get_scalars(%e3_5520) : !cute.int_tuple<"?{div=2}">
      %iter_5521 = cute.get_iter(%view_5510) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5522, %e1_5523, %e2_5524, %e3_5525 = cute.get_leaves(%iter_5521) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2169 = cute.get_scalars(%e0_5522) : !cute.int_tuple<"?">
      %2170 = cute.get_scalars(%e1_5523) : !cute.int_tuple<"?">
      %2171 = cute.get_scalars(%e2_5524) : !cute.int_tuple<"?">
      %2172 = cute.get_scalars(%e3_5525) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5526 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5527 = cute.add_offset(%e3_5525, %int_tuple_5526) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2173 = cute.get_scalars(%tup_5527) : !cute.int_tuple<"?">
      %coord_5528 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5529 = cute.make_coord(%tup_5527) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2174 = cute.get_scalars(%coord_5528) : !cute.coord<"?">
      %2175 = cute.get_scalars(%coord_5529) : !cute.coord<"?">
      %true_5530 = arith.constant true
      %2176 = arith.cmpi slt, %2174, %2175 : i32
      %2177 = arith.andi %true_5530, %2176 : i1
      %lay_5531 = cute.get_layout(%2158) : !memref_rmem_f32_4
      %2178 = cute.get_shape(%lay_5531) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5532, %e1_5533, %e2_5534, %e3_5535 = cute.get_leaves(%2178) : !cute.shape<"((2,2),(2,8))">
      %2179 = cute.get_stride(%lay_5531) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5536, %e1_5537, %e2_5538, %e3_5539 = cute.get_leaves(%2179) : !cute.stride<"((2,4),(1,8))">
      %2180 = scf.if %2177 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2158) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,6)">
        cute.memref.store(%2158, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,6)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2158) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2158 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2158) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2158) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2158 : !memref_rmem_f32_4
      }
      %iter_5540 = cute.get_iter(%2180) : !memref_rmem_f32_4
      %lay_5541 = cute.get_layout(%2180) : !memref_rmem_f32_4
      %2181 = cute.get_shape(%lay_5541) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5542, %e1_5543, %e2_5544, %e3_5545 = cute.get_leaves(%2181) : !cute.shape<"((2,2),(2,8))">
      %2182 = cute.get_stride(%lay_5541) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5546, %e1_5547, %e2_5548, %e3_5549 = cute.get_leaves(%2182) : !cute.stride<"((2,4),(1,8))">
      %iter_5550 = cute.get_iter(%2180) : !memref_rmem_f32_4
      %iter_5551 = cute.get_iter(%2180) : !memref_rmem_f32_4
      %coord_5552 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_5553 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5554 = cute.crd2idx(%coord_5552, %lay_5553) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_5555 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5556 = cute.add_offset(%iter_5555, %idx_5554) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5557 = cute.make_view(%tup_5556) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5558 = cute.get_iter(%view_5557) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5559, %e1_5560, %e2_5561, %e3_5562 = cute.get_leaves(%iter_5558) : !cute.int_tuple<"(?,?,?,?)">
      %2183 = cute.get_scalars(%e0_5559) : !cute.int_tuple<"?">
      %2184 = cute.get_scalars(%e1_5560) : !cute.int_tuple<"?">
      %2185 = cute.get_scalars(%e2_5561) : !cute.int_tuple<"?">
      %2186 = cute.get_scalars(%e3_5562) : !cute.int_tuple<"?">
      %iter_5563 = cute.get_iter(%view_5557) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5564, %e1_5565, %e2_5566, %e3_5567 = cute.get_leaves(%iter_5563) : !cute.int_tuple<"(?,?,?,?)">
      %2187 = cute.get_scalars(%e0_5564) : !cute.int_tuple<"?">
      %2188 = cute.get_scalars(%e1_5565) : !cute.int_tuple<"?">
      %2189 = cute.get_scalars(%e2_5566) : !cute.int_tuple<"?">
      %2190 = cute.get_scalars(%e3_5567) : !cute.int_tuple<"?">
      %iter_5568 = cute.get_iter(%view_5557) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5569, %e1_5570, %e2_5571, %e3_5572 = cute.get_leaves(%iter_5568) : !cute.int_tuple<"(?,?,?,?)">
      %2191 = cute.get_scalars(%e0_5569) : !cute.int_tuple<"?">
      %2192 = cute.get_scalars(%e1_5570) : !cute.int_tuple<"?">
      %2193 = cute.get_scalars(%e2_5571) : !cute.int_tuple<"?">
      %2194 = cute.get_scalars(%e3_5572) : !cute.int_tuple<"?">
      %int_tuple_5573 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5574 = cute.add_offset(%e3_5572, %int_tuple_5573) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2195 = cute.get_scalars(%tup_5574) : !cute.int_tuple<"?">
      %coord_5575 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5576 = cute.make_coord(%tup_5574) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2196 = cute.get_scalars(%coord_5575) : !cute.coord<"?">
      %2197 = cute.get_scalars(%coord_5576) : !cute.coord<"?">
      %true_5577 = arith.constant true
      %2198 = arith.cmpi slt, %2196, %2197 : i32
      %2199 = arith.andi %true_5577, %2198 : i1
      %lay_5578 = cute.get_layout(%2180) : !memref_rmem_f32_4
      %2200 = cute.get_shape(%lay_5578) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5579, %e1_5580, %e2_5581, %e3_5582 = cute.get_leaves(%2200) : !cute.shape<"((2,2),(2,8))">
      %2201 = cute.get_stride(%lay_5578) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5583, %e1_5584, %e2_5585, %e3_5586 = cute.get_leaves(%2201) : !cute.stride<"((2,4),(1,8))">
      %2202 = scf.if %2199 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2180) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,7)">
        cute.memref.store(%2180, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,7)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2180) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2180 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2180) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2180) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2180 : !memref_rmem_f32_4
      }
      %iter_5587 = cute.get_iter(%2202) : !memref_rmem_f32_4
      %lay_5588 = cute.get_layout(%2202) : !memref_rmem_f32_4
      %2203 = cute.get_shape(%lay_5588) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5589, %e1_5590, %e2_5591, %e3_5592 = cute.get_leaves(%2203) : !cute.shape<"((2,2),(2,8))">
      %2204 = cute.get_stride(%lay_5588) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5593, %e1_5594, %e2_5595, %e3_5596 = cute.get_leaves(%2204) : !cute.stride<"((2,4),(1,8))">
      %iter_5597 = cute.get_iter(%2202) : !memref_rmem_f32_4
      %iter_5598 = cute.get_iter(%2202) : !memref_rmem_f32_4
      %coord_5599 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_5600 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5601 = cute.crd2idx(%coord_5599, %lay_5600) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_5602 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5603 = cute.add_offset(%iter_5602, %idx_5601) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5604 = cute.make_view(%tup_5603) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5605 = cute.get_iter(%view_5604) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5606, %e1_5607, %e2_5608, %e3_5609 = cute.get_leaves(%iter_5605) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2205 = cute.get_scalars(%e0_5606) : !cute.int_tuple<"?">
      %2206 = cute.get_scalars(%e1_5607) : !cute.int_tuple<"?">
      %2207 = cute.get_scalars(%e2_5608) : !cute.int_tuple<"?">
      %2208 = cute.get_scalars(%e3_5609) : !cute.int_tuple<"?{div=2}">
      %iter_5610 = cute.get_iter(%view_5604) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5611, %e1_5612, %e2_5613, %e3_5614 = cute.get_leaves(%iter_5610) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2209 = cute.get_scalars(%e0_5611) : !cute.int_tuple<"?">
      %2210 = cute.get_scalars(%e1_5612) : !cute.int_tuple<"?">
      %2211 = cute.get_scalars(%e2_5613) : !cute.int_tuple<"?">
      %2212 = cute.get_scalars(%e3_5614) : !cute.int_tuple<"?{div=2}">
      %iter_5615 = cute.get_iter(%view_5604) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5616, %e1_5617, %e2_5618, %e3_5619 = cute.get_leaves(%iter_5615) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2213 = cute.get_scalars(%e0_5616) : !cute.int_tuple<"?">
      %2214 = cute.get_scalars(%e1_5617) : !cute.int_tuple<"?">
      %2215 = cute.get_scalars(%e2_5618) : !cute.int_tuple<"?">
      %2216 = cute.get_scalars(%e3_5619) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5620 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5621 = cute.add_offset(%e3_5619, %int_tuple_5620) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2217 = cute.get_scalars(%tup_5621) : !cute.int_tuple<"?">
      %coord_5622 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5623 = cute.make_coord(%tup_5621) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2218 = cute.get_scalars(%coord_5622) : !cute.coord<"?">
      %2219 = cute.get_scalars(%coord_5623) : !cute.coord<"?">
      %true_5624 = arith.constant true
      %2220 = arith.cmpi slt, %2218, %2219 : i32
      %2221 = arith.andi %true_5624, %2220 : i1
      %lay_5625 = cute.get_layout(%2202) : !memref_rmem_f32_4
      %2222 = cute.get_shape(%lay_5625) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5626, %e1_5627, %e2_5628, %e3_5629 = cute.get_leaves(%2222) : !cute.shape<"((2,2),(2,8))">
      %2223 = cute.get_stride(%lay_5625) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5630, %e1_5631, %e2_5632, %e3_5633 = cute.get_leaves(%2223) : !cute.stride<"((2,4),(1,8))">
      %2224 = scf.if %2221 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2202) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,8)">
        cute.memref.store(%2202, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,8)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2202) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2202 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2202) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2202) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2202 : !memref_rmem_f32_4
      }
      %iter_5634 = cute.get_iter(%2224) : !memref_rmem_f32_4
      %lay_5635 = cute.get_layout(%2224) : !memref_rmem_f32_4
      %2225 = cute.get_shape(%lay_5635) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5636, %e1_5637, %e2_5638, %e3_5639 = cute.get_leaves(%2225) : !cute.shape<"((2,2),(2,8))">
      %2226 = cute.get_stride(%lay_5635) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5640, %e1_5641, %e2_5642, %e3_5643 = cute.get_leaves(%2226) : !cute.stride<"((2,4),(1,8))">
      %iter_5644 = cute.get_iter(%2224) : !memref_rmem_f32_4
      %iter_5645 = cute.get_iter(%2224) : !memref_rmem_f32_4
      %coord_5646 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_5647 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5648 = cute.crd2idx(%coord_5646, %lay_5647) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_5649 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5650 = cute.add_offset(%iter_5649, %idx_5648) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5651 = cute.make_view(%tup_5650) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5652 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5653, %e1_5654, %e2_5655, %e3_5656 = cute.get_leaves(%iter_5652) : !cute.int_tuple<"(?,?,?,?)">
      %2227 = cute.get_scalars(%e0_5653) : !cute.int_tuple<"?">
      %2228 = cute.get_scalars(%e1_5654) : !cute.int_tuple<"?">
      %2229 = cute.get_scalars(%e2_5655) : !cute.int_tuple<"?">
      %2230 = cute.get_scalars(%e3_5656) : !cute.int_tuple<"?">
      %iter_5657 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5658, %e1_5659, %e2_5660, %e3_5661 = cute.get_leaves(%iter_5657) : !cute.int_tuple<"(?,?,?,?)">
      %2231 = cute.get_scalars(%e0_5658) : !cute.int_tuple<"?">
      %2232 = cute.get_scalars(%e1_5659) : !cute.int_tuple<"?">
      %2233 = cute.get_scalars(%e2_5660) : !cute.int_tuple<"?">
      %2234 = cute.get_scalars(%e3_5661) : !cute.int_tuple<"?">
      %iter_5662 = cute.get_iter(%view_5651) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5663, %e1_5664, %e2_5665, %e3_5666 = cute.get_leaves(%iter_5662) : !cute.int_tuple<"(?,?,?,?)">
      %2235 = cute.get_scalars(%e0_5663) : !cute.int_tuple<"?">
      %2236 = cute.get_scalars(%e1_5664) : !cute.int_tuple<"?">
      %2237 = cute.get_scalars(%e2_5665) : !cute.int_tuple<"?">
      %2238 = cute.get_scalars(%e3_5666) : !cute.int_tuple<"?">
      %int_tuple_5667 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5668 = cute.add_offset(%e3_5666, %int_tuple_5667) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2239 = cute.get_scalars(%tup_5668) : !cute.int_tuple<"?">
      %coord_5669 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5670 = cute.make_coord(%tup_5668) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2240 = cute.get_scalars(%coord_5669) : !cute.coord<"?">
      %2241 = cute.get_scalars(%coord_5670) : !cute.coord<"?">
      %true_5671 = arith.constant true
      %2242 = arith.cmpi slt, %2240, %2241 : i32
      %2243 = arith.andi %true_5671, %2242 : i1
      %lay_5672 = cute.get_layout(%2224) : !memref_rmem_f32_4
      %2244 = cute.get_shape(%lay_5672) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5673, %e1_5674, %e2_5675, %e3_5676 = cute.get_leaves(%2244) : !cute.shape<"((2,2),(2,8))">
      %2245 = cute.get_stride(%lay_5672) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5677, %e1_5678, %e2_5679, %e3_5680 = cute.get_leaves(%2245) : !cute.stride<"((2,4),(1,8))">
      %2246 = scf.if %2243 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2224) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,9)">
        cute.memref.store(%2224, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,9)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2224) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2224 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2224) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2224) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2224 : !memref_rmem_f32_4
      }
      %iter_5681 = cute.get_iter(%2246) : !memref_rmem_f32_4
      %lay_5682 = cute.get_layout(%2246) : !memref_rmem_f32_4
      %2247 = cute.get_shape(%lay_5682) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5683, %e1_5684, %e2_5685, %e3_5686 = cute.get_leaves(%2247) : !cute.shape<"((2,2),(2,8))">
      %2248 = cute.get_stride(%lay_5682) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5687, %e1_5688, %e2_5689, %e3_5690 = cute.get_leaves(%2248) : !cute.stride<"((2,4),(1,8))">
      %iter_5691 = cute.get_iter(%2246) : !memref_rmem_f32_4
      %iter_5692 = cute.get_iter(%2246) : !memref_rmem_f32_4
      %coord_5693 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5694 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5695 = cute.crd2idx(%coord_5693, %lay_5694) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5696 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5697 = cute.add_offset(%iter_5696, %idx_5695) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5698 = cute.make_view(%tup_5697) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5699 = cute.get_iter(%view_5698) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5700, %e1_5701, %e2_5702, %e3_5703 = cute.get_leaves(%iter_5699) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2249 = cute.get_scalars(%e0_5700) : !cute.int_tuple<"?">
      %2250 = cute.get_scalars(%e1_5701) : !cute.int_tuple<"?">
      %2251 = cute.get_scalars(%e2_5702) : !cute.int_tuple<"?">
      %2252 = cute.get_scalars(%e3_5703) : !cute.int_tuple<"?{div=2}">
      %iter_5704 = cute.get_iter(%view_5698) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5705, %e1_5706, %e2_5707, %e3_5708 = cute.get_leaves(%iter_5704) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2253 = cute.get_scalars(%e0_5705) : !cute.int_tuple<"?">
      %2254 = cute.get_scalars(%e1_5706) : !cute.int_tuple<"?">
      %2255 = cute.get_scalars(%e2_5707) : !cute.int_tuple<"?">
      %2256 = cute.get_scalars(%e3_5708) : !cute.int_tuple<"?{div=2}">
      %iter_5709 = cute.get_iter(%view_5698) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5710, %e1_5711, %e2_5712, %e3_5713 = cute.get_leaves(%iter_5709) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2257 = cute.get_scalars(%e0_5710) : !cute.int_tuple<"?">
      %2258 = cute.get_scalars(%e1_5711) : !cute.int_tuple<"?">
      %2259 = cute.get_scalars(%e2_5712) : !cute.int_tuple<"?">
      %2260 = cute.get_scalars(%e3_5713) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5714 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5715 = cute.add_offset(%e3_5713, %int_tuple_5714) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2261 = cute.get_scalars(%tup_5715) : !cute.int_tuple<"?">
      %coord_5716 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5717 = cute.make_coord(%tup_5715) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2262 = cute.get_scalars(%coord_5716) : !cute.coord<"?">
      %2263 = cute.get_scalars(%coord_5717) : !cute.coord<"?">
      %true_5718 = arith.constant true
      %2264 = arith.cmpi slt, %2262, %2263 : i32
      %2265 = arith.andi %true_5718, %2264 : i1
      %lay_5719 = cute.get_layout(%2246) : !memref_rmem_f32_4
      %2266 = cute.get_shape(%lay_5719) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5720, %e1_5721, %e2_5722, %e3_5723 = cute.get_leaves(%2266) : !cute.shape<"((2,2),(2,8))">
      %2267 = cute.get_stride(%lay_5719) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5724, %e1_5725, %e2_5726, %e3_5727 = cute.get_leaves(%2267) : !cute.stride<"((2,4),(1,8))">
      %2268 = scf.if %2265 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2246) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,10)">
        cute.memref.store(%2246, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,10)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2246) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2246 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2246) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2246) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2246 : !memref_rmem_f32_4
      }
      %iter_5728 = cute.get_iter(%2268) : !memref_rmem_f32_4
      %lay_5729 = cute.get_layout(%2268) : !memref_rmem_f32_4
      %2269 = cute.get_shape(%lay_5729) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5730, %e1_5731, %e2_5732, %e3_5733 = cute.get_leaves(%2269) : !cute.shape<"((2,2),(2,8))">
      %2270 = cute.get_stride(%lay_5729) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5734, %e1_5735, %e2_5736, %e3_5737 = cute.get_leaves(%2270) : !cute.stride<"((2,4),(1,8))">
      %iter_5738 = cute.get_iter(%2268) : !memref_rmem_f32_4
      %iter_5739 = cute.get_iter(%2268) : !memref_rmem_f32_4
      %coord_5740 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5741 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5742 = cute.crd2idx(%coord_5740, %lay_5741) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5743 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5744 = cute.add_offset(%iter_5743, %idx_5742) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5745 = cute.make_view(%tup_5744) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5746 = cute.get_iter(%view_5745) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5747, %e1_5748, %e2_5749, %e3_5750 = cute.get_leaves(%iter_5746) : !cute.int_tuple<"(?,?,?,?)">
      %2271 = cute.get_scalars(%e0_5747) : !cute.int_tuple<"?">
      %2272 = cute.get_scalars(%e1_5748) : !cute.int_tuple<"?">
      %2273 = cute.get_scalars(%e2_5749) : !cute.int_tuple<"?">
      %2274 = cute.get_scalars(%e3_5750) : !cute.int_tuple<"?">
      %iter_5751 = cute.get_iter(%view_5745) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5752, %e1_5753, %e2_5754, %e3_5755 = cute.get_leaves(%iter_5751) : !cute.int_tuple<"(?,?,?,?)">
      %2275 = cute.get_scalars(%e0_5752) : !cute.int_tuple<"?">
      %2276 = cute.get_scalars(%e1_5753) : !cute.int_tuple<"?">
      %2277 = cute.get_scalars(%e2_5754) : !cute.int_tuple<"?">
      %2278 = cute.get_scalars(%e3_5755) : !cute.int_tuple<"?">
      %iter_5756 = cute.get_iter(%view_5745) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5757, %e1_5758, %e2_5759, %e3_5760 = cute.get_leaves(%iter_5756) : !cute.int_tuple<"(?,?,?,?)">
      %2279 = cute.get_scalars(%e0_5757) : !cute.int_tuple<"?">
      %2280 = cute.get_scalars(%e1_5758) : !cute.int_tuple<"?">
      %2281 = cute.get_scalars(%e2_5759) : !cute.int_tuple<"?">
      %2282 = cute.get_scalars(%e3_5760) : !cute.int_tuple<"?">
      %int_tuple_5761 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5762 = cute.add_offset(%e3_5760, %int_tuple_5761) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2283 = cute.get_scalars(%tup_5762) : !cute.int_tuple<"?">
      %coord_5763 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5764 = cute.make_coord(%tup_5762) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2284 = cute.get_scalars(%coord_5763) : !cute.coord<"?">
      %2285 = cute.get_scalars(%coord_5764) : !cute.coord<"?">
      %true_5765 = arith.constant true
      %2286 = arith.cmpi slt, %2284, %2285 : i32
      %2287 = arith.andi %true_5765, %2286 : i1
      %lay_5766 = cute.get_layout(%2268) : !memref_rmem_f32_4
      %2288 = cute.get_shape(%lay_5766) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5767, %e1_5768, %e2_5769, %e3_5770 = cute.get_leaves(%2288) : !cute.shape<"((2,2),(2,8))">
      %2289 = cute.get_stride(%lay_5766) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5771, %e1_5772, %e2_5773, %e3_5774 = cute.get_leaves(%2289) : !cute.stride<"((2,4),(1,8))">
      %2290 = scf.if %2287 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2268) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,11)">
        cute.memref.store(%2268, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,11)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2268) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2268 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2268) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2268) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2268 : !memref_rmem_f32_4
      }
      %iter_5775 = cute.get_iter(%2290) : !memref_rmem_f32_4
      %lay_5776 = cute.get_layout(%2290) : !memref_rmem_f32_4
      %2291 = cute.get_shape(%lay_5776) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5777, %e1_5778, %e2_5779, %e3_5780 = cute.get_leaves(%2291) : !cute.shape<"((2,2),(2,8))">
      %2292 = cute.get_stride(%lay_5776) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5781, %e1_5782, %e2_5783, %e3_5784 = cute.get_leaves(%2292) : !cute.stride<"((2,4),(1,8))">
      %iter_5785 = cute.get_iter(%2290) : !memref_rmem_f32_4
      %iter_5786 = cute.get_iter(%2290) : !memref_rmem_f32_4
      %coord_5787 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5788 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5789 = cute.crd2idx(%coord_5787, %lay_5788) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5790 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5791 = cute.add_offset(%iter_5790, %idx_5789) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5792 = cute.make_view(%tup_5791) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5793 = cute.get_iter(%view_5792) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5794, %e1_5795, %e2_5796, %e3_5797 = cute.get_leaves(%iter_5793) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2293 = cute.get_scalars(%e0_5794) : !cute.int_tuple<"?">
      %2294 = cute.get_scalars(%e1_5795) : !cute.int_tuple<"?">
      %2295 = cute.get_scalars(%e2_5796) : !cute.int_tuple<"?">
      %2296 = cute.get_scalars(%e3_5797) : !cute.int_tuple<"?{div=2}">
      %iter_5798 = cute.get_iter(%view_5792) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5799, %e1_5800, %e2_5801, %e3_5802 = cute.get_leaves(%iter_5798) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2297 = cute.get_scalars(%e0_5799) : !cute.int_tuple<"?">
      %2298 = cute.get_scalars(%e1_5800) : !cute.int_tuple<"?">
      %2299 = cute.get_scalars(%e2_5801) : !cute.int_tuple<"?">
      %2300 = cute.get_scalars(%e3_5802) : !cute.int_tuple<"?{div=2}">
      %iter_5803 = cute.get_iter(%view_5792) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5804, %e1_5805, %e2_5806, %e3_5807 = cute.get_leaves(%iter_5803) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2301 = cute.get_scalars(%e0_5804) : !cute.int_tuple<"?">
      %2302 = cute.get_scalars(%e1_5805) : !cute.int_tuple<"?">
      %2303 = cute.get_scalars(%e2_5806) : !cute.int_tuple<"?">
      %2304 = cute.get_scalars(%e3_5807) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5808 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5809 = cute.add_offset(%e3_5807, %int_tuple_5808) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2305 = cute.get_scalars(%tup_5809) : !cute.int_tuple<"?">
      %coord_5810 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5811 = cute.make_coord(%tup_5809) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2306 = cute.get_scalars(%coord_5810) : !cute.coord<"?">
      %2307 = cute.get_scalars(%coord_5811) : !cute.coord<"?">
      %true_5812 = arith.constant true
      %2308 = arith.cmpi slt, %2306, %2307 : i32
      %2309 = arith.andi %true_5812, %2308 : i1
      %lay_5813 = cute.get_layout(%2290) : !memref_rmem_f32_4
      %2310 = cute.get_shape(%lay_5813) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5814, %e1_5815, %e2_5816, %e3_5817 = cute.get_leaves(%2310) : !cute.shape<"((2,2),(2,8))">
      %2311 = cute.get_stride(%lay_5813) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5818, %e1_5819, %e2_5820, %e3_5821 = cute.get_leaves(%2311) : !cute.stride<"((2,4),(1,8))">
      %2312 = scf.if %2309 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2290) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,12)">
        cute.memref.store(%2290, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,12)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2290) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2290 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2290) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2290) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2290 : !memref_rmem_f32_4
      }
      %iter_5822 = cute.get_iter(%2312) : !memref_rmem_f32_4
      %lay_5823 = cute.get_layout(%2312) : !memref_rmem_f32_4
      %2313 = cute.get_shape(%lay_5823) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5824, %e1_5825, %e2_5826, %e3_5827 = cute.get_leaves(%2313) : !cute.shape<"((2,2),(2,8))">
      %2314 = cute.get_stride(%lay_5823) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5828, %e1_5829, %e2_5830, %e3_5831 = cute.get_leaves(%2314) : !cute.stride<"((2,4),(1,8))">
      %iter_5832 = cute.get_iter(%2312) : !memref_rmem_f32_4
      %iter_5833 = cute.get_iter(%2312) : !memref_rmem_f32_4
      %coord_5834 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5835 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5836 = cute.crd2idx(%coord_5834, %lay_5835) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5837 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5838 = cute.add_offset(%iter_5837, %idx_5836) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5839 = cute.make_view(%tup_5838) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5840 = cute.get_iter(%view_5839) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5841, %e1_5842, %e2_5843, %e3_5844 = cute.get_leaves(%iter_5840) : !cute.int_tuple<"(?,?,?,?)">
      %2315 = cute.get_scalars(%e0_5841) : !cute.int_tuple<"?">
      %2316 = cute.get_scalars(%e1_5842) : !cute.int_tuple<"?">
      %2317 = cute.get_scalars(%e2_5843) : !cute.int_tuple<"?">
      %2318 = cute.get_scalars(%e3_5844) : !cute.int_tuple<"?">
      %iter_5845 = cute.get_iter(%view_5839) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5846, %e1_5847, %e2_5848, %e3_5849 = cute.get_leaves(%iter_5845) : !cute.int_tuple<"(?,?,?,?)">
      %2319 = cute.get_scalars(%e0_5846) : !cute.int_tuple<"?">
      %2320 = cute.get_scalars(%e1_5847) : !cute.int_tuple<"?">
      %2321 = cute.get_scalars(%e2_5848) : !cute.int_tuple<"?">
      %2322 = cute.get_scalars(%e3_5849) : !cute.int_tuple<"?">
      %iter_5850 = cute.get_iter(%view_5839) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5851, %e1_5852, %e2_5853, %e3_5854 = cute.get_leaves(%iter_5850) : !cute.int_tuple<"(?,?,?,?)">
      %2323 = cute.get_scalars(%e0_5851) : !cute.int_tuple<"?">
      %2324 = cute.get_scalars(%e1_5852) : !cute.int_tuple<"?">
      %2325 = cute.get_scalars(%e2_5853) : !cute.int_tuple<"?">
      %2326 = cute.get_scalars(%e3_5854) : !cute.int_tuple<"?">
      %int_tuple_5855 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5856 = cute.add_offset(%e3_5854, %int_tuple_5855) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2327 = cute.get_scalars(%tup_5856) : !cute.int_tuple<"?">
      %coord_5857 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5858 = cute.make_coord(%tup_5856) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2328 = cute.get_scalars(%coord_5857) : !cute.coord<"?">
      %2329 = cute.get_scalars(%coord_5858) : !cute.coord<"?">
      %true_5859 = arith.constant true
      %2330 = arith.cmpi slt, %2328, %2329 : i32
      %2331 = arith.andi %true_5859, %2330 : i1
      %lay_5860 = cute.get_layout(%2312) : !memref_rmem_f32_4
      %2332 = cute.get_shape(%lay_5860) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5861, %e1_5862, %e2_5863, %e3_5864 = cute.get_leaves(%2332) : !cute.shape<"((2,2),(2,8))">
      %2333 = cute.get_stride(%lay_5860) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5865, %e1_5866, %e2_5867, %e3_5868 = cute.get_leaves(%2333) : !cute.stride<"((2,4),(1,8))">
      %2334 = scf.if %2331 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2312) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,13)">
        cute.memref.store(%2312, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,13)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2312) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2312 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2312) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2312) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2312 : !memref_rmem_f32_4
      }
      %iter_5869 = cute.get_iter(%2334) : !memref_rmem_f32_4
      %lay_5870 = cute.get_layout(%2334) : !memref_rmem_f32_4
      %2335 = cute.get_shape(%lay_5870) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5871, %e1_5872, %e2_5873, %e3_5874 = cute.get_leaves(%2335) : !cute.shape<"((2,2),(2,8))">
      %2336 = cute.get_stride(%lay_5870) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5875, %e1_5876, %e2_5877, %e3_5878 = cute.get_leaves(%2336) : !cute.stride<"((2,4),(1,8))">
      %iter_5879 = cute.get_iter(%2334) : !memref_rmem_f32_4
      %iter_5880 = cute.get_iter(%2334) : !memref_rmem_f32_4
      %coord_5881 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5882 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5883 = cute.crd2idx(%coord_5881, %lay_5882) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5884 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5885 = cute.add_offset(%iter_5884, %idx_5883) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5886 = cute.make_view(%tup_5885) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5887 = cute.get_iter(%view_5886) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5888, %e1_5889, %e2_5890, %e3_5891 = cute.get_leaves(%iter_5887) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2337 = cute.get_scalars(%e0_5888) : !cute.int_tuple<"?">
      %2338 = cute.get_scalars(%e1_5889) : !cute.int_tuple<"?">
      %2339 = cute.get_scalars(%e2_5890) : !cute.int_tuple<"?">
      %2340 = cute.get_scalars(%e3_5891) : !cute.int_tuple<"?{div=2}">
      %iter_5892 = cute.get_iter(%view_5886) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5893, %e1_5894, %e2_5895, %e3_5896 = cute.get_leaves(%iter_5892) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2341 = cute.get_scalars(%e0_5893) : !cute.int_tuple<"?">
      %2342 = cute.get_scalars(%e1_5894) : !cute.int_tuple<"?">
      %2343 = cute.get_scalars(%e2_5895) : !cute.int_tuple<"?">
      %2344 = cute.get_scalars(%e3_5896) : !cute.int_tuple<"?{div=2}">
      %iter_5897 = cute.get_iter(%view_5886) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5898, %e1_5899, %e2_5900, %e3_5901 = cute.get_leaves(%iter_5897) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2345 = cute.get_scalars(%e0_5898) : !cute.int_tuple<"?">
      %2346 = cute.get_scalars(%e1_5899) : !cute.int_tuple<"?">
      %2347 = cute.get_scalars(%e2_5900) : !cute.int_tuple<"?">
      %2348 = cute.get_scalars(%e3_5901) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5902 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5903 = cute.add_offset(%e3_5901, %int_tuple_5902) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2349 = cute.get_scalars(%tup_5903) : !cute.int_tuple<"?">
      %coord_5904 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5905 = cute.make_coord(%tup_5903) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2350 = cute.get_scalars(%coord_5904) : !cute.coord<"?">
      %2351 = cute.get_scalars(%coord_5905) : !cute.coord<"?">
      %true_5906 = arith.constant true
      %2352 = arith.cmpi slt, %2350, %2351 : i32
      %2353 = arith.andi %true_5906, %2352 : i1
      %lay_5907 = cute.get_layout(%2334) : !memref_rmem_f32_4
      %2354 = cute.get_shape(%lay_5907) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5908, %e1_5909, %e2_5910, %e3_5911 = cute.get_leaves(%2354) : !cute.shape<"((2,2),(2,8))">
      %2355 = cute.get_stride(%lay_5907) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5912, %e1_5913, %e2_5914, %e3_5915 = cute.get_leaves(%2355) : !cute.stride<"((2,4),(1,8))">
      %2356 = scf.if %2353 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2334) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,14)">
        cute.memref.store(%2334, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,14)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2334) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2334 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2334) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2334) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2334 : !memref_rmem_f32_4
      }
      %iter_5916 = cute.get_iter(%2356) : !memref_rmem_f32_4
      %lay_5917 = cute.get_layout(%2356) : !memref_rmem_f32_4
      %2357 = cute.get_shape(%lay_5917) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5918, %e1_5919, %e2_5920, %e3_5921 = cute.get_leaves(%2357) : !cute.shape<"((2,2),(2,8))">
      %2358 = cute.get_stride(%lay_5917) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5922, %e1_5923, %e2_5924, %e3_5925 = cute.get_leaves(%2358) : !cute.stride<"((2,4),(1,8))">
      %iter_5926 = cute.get_iter(%2356) : !memref_rmem_f32_4
      %iter_5927 = cute.get_iter(%2356) : !memref_rmem_f32_4
      %coord_5928 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5929 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5930 = cute.crd2idx(%coord_5928, %lay_5929) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5931 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5932 = cute.add_offset(%iter_5931, %idx_5930) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5933 = cute.make_view(%tup_5932) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5934 = cute.get_iter(%view_5933) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5935, %e1_5936, %e2_5937, %e3_5938 = cute.get_leaves(%iter_5934) : !cute.int_tuple<"(?,?,?,?)">
      %2359 = cute.get_scalars(%e0_5935) : !cute.int_tuple<"?">
      %2360 = cute.get_scalars(%e1_5936) : !cute.int_tuple<"?">
      %2361 = cute.get_scalars(%e2_5937) : !cute.int_tuple<"?">
      %2362 = cute.get_scalars(%e3_5938) : !cute.int_tuple<"?">
      %iter_5939 = cute.get_iter(%view_5933) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5940, %e1_5941, %e2_5942, %e3_5943 = cute.get_leaves(%iter_5939) : !cute.int_tuple<"(?,?,?,?)">
      %2363 = cute.get_scalars(%e0_5940) : !cute.int_tuple<"?">
      %2364 = cute.get_scalars(%e1_5941) : !cute.int_tuple<"?">
      %2365 = cute.get_scalars(%e2_5942) : !cute.int_tuple<"?">
      %2366 = cute.get_scalars(%e3_5943) : !cute.int_tuple<"?">
      %iter_5944 = cute.get_iter(%view_5933) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5945, %e1_5946, %e2_5947, %e3_5948 = cute.get_leaves(%iter_5944) : !cute.int_tuple<"(?,?,?,?)">
      %2367 = cute.get_scalars(%e0_5945) : !cute.int_tuple<"?">
      %2368 = cute.get_scalars(%e1_5946) : !cute.int_tuple<"?">
      %2369 = cute.get_scalars(%e2_5947) : !cute.int_tuple<"?">
      %2370 = cute.get_scalars(%e3_5948) : !cute.int_tuple<"?">
      %int_tuple_5949 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5950 = cute.add_offset(%e3_5948, %int_tuple_5949) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2371 = cute.get_scalars(%tup_5950) : !cute.int_tuple<"?">
      %coord_5951 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5952 = cute.make_coord(%tup_5950) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2372 = cute.get_scalars(%coord_5951) : !cute.coord<"?">
      %2373 = cute.get_scalars(%coord_5952) : !cute.coord<"?">
      %true_5953 = arith.constant true
      %2374 = arith.cmpi slt, %2372, %2373 : i32
      %2375 = arith.andi %true_5953, %2374 : i1
      %lay_5954 = cute.get_layout(%2356) : !memref_rmem_f32_4
      %2376 = cute.get_shape(%lay_5954) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5955, %e1_5956, %e2_5957, %e3_5958 = cute.get_leaves(%2376) : !cute.shape<"((2,2),(2,8))">
      %2377 = cute.get_stride(%lay_5954) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5959, %e1_5960, %e2_5961, %e3_5962 = cute.get_leaves(%2377) : !cute.stride<"((2,4),(1,8))">
      %2378 = scf.if %2375 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2356) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(2,15)">
        cute.memref.store(%2356, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(2,15)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2356) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2356 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2356) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2356) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2356 : !memref_rmem_f32_4
      }
      %iter_5963 = cute.get_iter(%2378) : !memref_rmem_f32_4
      %lay_5964 = cute.get_layout(%2378) : !memref_rmem_f32_4
      %2379 = cute.get_shape(%lay_5964) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5965, %e1_5966, %e2_5967, %e3_5968 = cute.get_leaves(%2379) : !cute.shape<"((2,2),(2,8))">
      %2380 = cute.get_stride(%lay_5964) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5969, %e1_5970, %e2_5971, %e3_5972 = cute.get_leaves(%2380) : !cute.stride<"((2,4),(1,8))">
      %iter_5973 = cute.get_iter(%2378) : !memref_rmem_f32_4
      %iter_5974 = cute.get_iter(%2378) : !memref_rmem_f32_4
      %coord_5975 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5976 = cute.get_layout(%2378) : !memref_rmem_f32_4
      %idx_5977 = cute.crd2idx(%coord_5975, %lay_5976) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5978 = cute.get_iter(%2378) : !memref_rmem_f32_4
      %ptr_5979 = cute.add_offset(%iter_5978, %idx_5977) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5980 = cute.make_view(%ptr_5979) : !memref_rmem_f32_8
      %iter_5981 = cute.get_iter(%view_5980) : !memref_rmem_f32_8
      %iter_5982 = cute.get_iter(%view_5980) : !memref_rmem_f32_8
      %lay_5983 = cute.get_layout(%view_5980) : !memref_rmem_f32_8
      %2381 = cute.get_shape(%lay_5983) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5984, %e1_5985 = cute.get_leaves(%2381) : !cute.shape<"((2,8))">
      %2382 = cute.memref.load_vec %view_5980 : !memref_rmem_f32_8
      %cst_5986 = arith.constant 0xFF800000 : f32
      %2383 = vector.reduction <maximumf>, %2382, %cst_5986 : vector<16xf32> into f32
      %c-1_i32_5987 = arith.constant -1 : i32
      %c2_i32_5988 = arith.constant 2 : i32
      %c31_i32_5989 = arith.constant 31 : i32
      %2384 = nvvm.shfl.sync  bfly %c-1_i32_5987, %2383, %c2_i32_5988, %c31_i32_5989 : f32 -> f32
      %2385 = nvvm.fmax %2383, %2384
      %c-1_i32_5990 = arith.constant -1 : i32
      %c1_i32_5991 = arith.constant 1 : i32
      %c31_i32_5992 = arith.constant 31 : i32
      %2386 = nvvm.shfl.sync  bfly %c-1_i32_5990, %2385, %c1_i32_5991, %c31_i32_5992 : f32 -> f32
      %2387 = nvvm.fmax %2385, %2386
      %2388 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2389 = arith.mulf %2382, %2388 : vector<16xf32>
      %2390 = arith.mulf %2387, %arg4 : f32
      %2391 = vector.broadcast %2390 : f32 to vector<16xf32>
      %2392 = arith.subf %2389, %2391 : vector<16xf32>
      %2393 = math.exp2 %2392 fastmath<fast> : vector<16xf32>
      %cst_5993 = arith.constant 0.000000e+00 : f32
      %2394 = vector.reduction <add>, %2393, %cst_5993 : vector<16xf32> into f32
      %coord_5994 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1595, %coord_5994, %2387) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5995 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1600, %coord_5995, %2394) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5996 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5997 = cute.get_layout(%2378) : !memref_rmem_f32_4
      %idx_5998 = cute.crd2idx(%coord_5996, %lay_5997) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5999 = cute.get_iter(%2378) : !memref_rmem_f32_4
      %ptr_6000 = cute.add_offset(%iter_5999, %idx_5998) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_6001 = cute.make_view(%ptr_6000) : !memref_rmem_f32_8
      %iter_6002 = cute.get_iter(%view_6001) : !memref_rmem_f32_8
      %iter_6003 = cute.get_iter(%view_6001) : !memref_rmem_f32_8
      %lay_6004 = cute.get_layout(%view_6001) : !memref_rmem_f32_8
      %2395 = cute.get_shape(%lay_6004) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6005, %e1_6006 = cute.get_leaves(%2395) : !cute.shape<"((2,8))">
      %int_tuple_6007 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6008 = cute.size(%int_tuple_6007) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6009 = cute.get_leaves(%sz_6008) : !cute.int_tuple<"16">
      %int_tuple_6010 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6011 = cute.size(%int_tuple_6010) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6012 = cute.get_leaves(%sz_6011) : !cute.int_tuple<"16">
      cute.memref.store_vec %2393, %view_6001 : !memref_rmem_f32_8
      %int_tuple_6013 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_6014 = cute.size(%int_tuple_6013) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_6015 = cute.get_leaves(%sz_6014) : !cute.int_tuple<"16">
      %coord_6016 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_6017 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6018 = cute.crd2idx(%coord_6016, %lay_6017) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_6019 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6020 = cute.add_offset(%iter_6019, %idx_6018) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6021 = cute.make_view(%tup_6020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6022 = cute.get_iter(%view_6021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6023, %e1_6024, %e2_6025, %e3_6026 = cute.get_leaves(%iter_6022) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2396 = cute.get_scalars(%e0_6023) : !cute.int_tuple<"?">
      %2397 = cute.get_scalars(%e1_6024) : !cute.int_tuple<"?">
      %2398 = cute.get_scalars(%e2_6025) : !cute.int_tuple<"?">
      %2399 = cute.get_scalars(%e3_6026) : !cute.int_tuple<"?{div=2}">
      %iter_6027 = cute.get_iter(%view_6021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6028, %e1_6029, %e2_6030, %e3_6031 = cute.get_leaves(%iter_6027) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2400 = cute.get_scalars(%e0_6028) : !cute.int_tuple<"?">
      %2401 = cute.get_scalars(%e1_6029) : !cute.int_tuple<"?">
      %2402 = cute.get_scalars(%e2_6030) : !cute.int_tuple<"?">
      %2403 = cute.get_scalars(%e3_6031) : !cute.int_tuple<"?{div=2}">
      %iter_6032 = cute.get_iter(%view_6021) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6033, %e1_6034, %e2_6035, %e3_6036 = cute.get_leaves(%iter_6032) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2404 = cute.get_scalars(%e0_6033) : !cute.int_tuple<"?">
      %2405 = cute.get_scalars(%e1_6034) : !cute.int_tuple<"?">
      %2406 = cute.get_scalars(%e2_6035) : !cute.int_tuple<"?">
      %2407 = cute.get_scalars(%e3_6036) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6037 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6038 = cute.add_offset(%e3_6036, %int_tuple_6037) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2408 = cute.get_scalars(%tup_6038) : !cute.int_tuple<"?">
      %coord_6039 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6040 = cute.make_coord(%tup_6038) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2409 = cute.get_scalars(%coord_6039) : !cute.coord<"?">
      %2410 = cute.get_scalars(%coord_6040) : !cute.coord<"?">
      %true_6041 = arith.constant true
      %2411 = arith.cmpi slt, %2409, %2410 : i32
      %2412 = arith.andi %true_6041, %2411 : i1
      %lay_6042 = cute.get_layout(%2378) : !memref_rmem_f32_4
      %2413 = cute.get_shape(%lay_6042) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6043, %e1_6044, %e2_6045, %e3_6046 = cute.get_leaves(%2413) : !cute.shape<"((2,2),(2,8))">
      %2414 = cute.get_stride(%lay_6042) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6047, %e1_6048, %e2_6049, %e3_6050 = cute.get_leaves(%2414) : !cute.stride<"((2,4),(1,8))">
      %2415 = scf.if %2412 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2378) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,0)">
        cute.memref.store(%2378, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,0)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2378) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2378 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2378) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2378) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2378 : !memref_rmem_f32_4
      }
      %iter_6051 = cute.get_iter(%2415) : !memref_rmem_f32_4
      %lay_6052 = cute.get_layout(%2415) : !memref_rmem_f32_4
      %2416 = cute.get_shape(%lay_6052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6053, %e1_6054, %e2_6055, %e3_6056 = cute.get_leaves(%2416) : !cute.shape<"((2,2),(2,8))">
      %2417 = cute.get_stride(%lay_6052) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6057, %e1_6058, %e2_6059, %e3_6060 = cute.get_leaves(%2417) : !cute.stride<"((2,4),(1,8))">
      %iter_6061 = cute.get_iter(%2415) : !memref_rmem_f32_4
      %iter_6062 = cute.get_iter(%2415) : !memref_rmem_f32_4
      %coord_6063 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_6064 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6065 = cute.crd2idx(%coord_6063, %lay_6064) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_6066 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6067 = cute.add_offset(%iter_6066, %idx_6065) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6068 = cute.make_view(%tup_6067) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6069 = cute.get_iter(%view_6068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6070, %e1_6071, %e2_6072, %e3_6073 = cute.get_leaves(%iter_6069) : !cute.int_tuple<"(?,?,?,?)">
      %2418 = cute.get_scalars(%e0_6070) : !cute.int_tuple<"?">
      %2419 = cute.get_scalars(%e1_6071) : !cute.int_tuple<"?">
      %2420 = cute.get_scalars(%e2_6072) : !cute.int_tuple<"?">
      %2421 = cute.get_scalars(%e3_6073) : !cute.int_tuple<"?">
      %iter_6074 = cute.get_iter(%view_6068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6075, %e1_6076, %e2_6077, %e3_6078 = cute.get_leaves(%iter_6074) : !cute.int_tuple<"(?,?,?,?)">
      %2422 = cute.get_scalars(%e0_6075) : !cute.int_tuple<"?">
      %2423 = cute.get_scalars(%e1_6076) : !cute.int_tuple<"?">
      %2424 = cute.get_scalars(%e2_6077) : !cute.int_tuple<"?">
      %2425 = cute.get_scalars(%e3_6078) : !cute.int_tuple<"?">
      %iter_6079 = cute.get_iter(%view_6068) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6080, %e1_6081, %e2_6082, %e3_6083 = cute.get_leaves(%iter_6079) : !cute.int_tuple<"(?,?,?,?)">
      %2426 = cute.get_scalars(%e0_6080) : !cute.int_tuple<"?">
      %2427 = cute.get_scalars(%e1_6081) : !cute.int_tuple<"?">
      %2428 = cute.get_scalars(%e2_6082) : !cute.int_tuple<"?">
      %2429 = cute.get_scalars(%e3_6083) : !cute.int_tuple<"?">
      %int_tuple_6084 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6085 = cute.add_offset(%e3_6083, %int_tuple_6084) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2430 = cute.get_scalars(%tup_6085) : !cute.int_tuple<"?">
      %coord_6086 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6087 = cute.make_coord(%tup_6085) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2431 = cute.get_scalars(%coord_6086) : !cute.coord<"?">
      %2432 = cute.get_scalars(%coord_6087) : !cute.coord<"?">
      %true_6088 = arith.constant true
      %2433 = arith.cmpi slt, %2431, %2432 : i32
      %2434 = arith.andi %true_6088, %2433 : i1
      %lay_6089 = cute.get_layout(%2415) : !memref_rmem_f32_4
      %2435 = cute.get_shape(%lay_6089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6090, %e1_6091, %e2_6092, %e3_6093 = cute.get_leaves(%2435) : !cute.shape<"((2,2),(2,8))">
      %2436 = cute.get_stride(%lay_6089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6094, %e1_6095, %e2_6096, %e3_6097 = cute.get_leaves(%2436) : !cute.stride<"((2,4),(1,8))">
      %2437 = scf.if %2434 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2415) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,1)">
        cute.memref.store(%2415, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,1)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2415) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2415 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2415) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2415) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2415 : !memref_rmem_f32_4
      }
      %iter_6098 = cute.get_iter(%2437) : !memref_rmem_f32_4
      %lay_6099 = cute.get_layout(%2437) : !memref_rmem_f32_4
      %2438 = cute.get_shape(%lay_6099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6100, %e1_6101, %e2_6102, %e3_6103 = cute.get_leaves(%2438) : !cute.shape<"((2,2),(2,8))">
      %2439 = cute.get_stride(%lay_6099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6104, %e1_6105, %e2_6106, %e3_6107 = cute.get_leaves(%2439) : !cute.stride<"((2,4),(1,8))">
      %iter_6108 = cute.get_iter(%2437) : !memref_rmem_f32_4
      %iter_6109 = cute.get_iter(%2437) : !memref_rmem_f32_4
      %coord_6110 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_6111 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6112 = cute.crd2idx(%coord_6110, %lay_6111) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_6113 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6114 = cute.add_offset(%iter_6113, %idx_6112) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6115 = cute.make_view(%tup_6114) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6116 = cute.get_iter(%view_6115) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6117, %e1_6118, %e2_6119, %e3_6120 = cute.get_leaves(%iter_6116) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2440 = cute.get_scalars(%e0_6117) : !cute.int_tuple<"?">
      %2441 = cute.get_scalars(%e1_6118) : !cute.int_tuple<"?">
      %2442 = cute.get_scalars(%e2_6119) : !cute.int_tuple<"?">
      %2443 = cute.get_scalars(%e3_6120) : !cute.int_tuple<"?{div=2}">
      %iter_6121 = cute.get_iter(%view_6115) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6122, %e1_6123, %e2_6124, %e3_6125 = cute.get_leaves(%iter_6121) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2444 = cute.get_scalars(%e0_6122) : !cute.int_tuple<"?">
      %2445 = cute.get_scalars(%e1_6123) : !cute.int_tuple<"?">
      %2446 = cute.get_scalars(%e2_6124) : !cute.int_tuple<"?">
      %2447 = cute.get_scalars(%e3_6125) : !cute.int_tuple<"?{div=2}">
      %iter_6126 = cute.get_iter(%view_6115) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6127, %e1_6128, %e2_6129, %e3_6130 = cute.get_leaves(%iter_6126) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2448 = cute.get_scalars(%e0_6127) : !cute.int_tuple<"?">
      %2449 = cute.get_scalars(%e1_6128) : !cute.int_tuple<"?">
      %2450 = cute.get_scalars(%e2_6129) : !cute.int_tuple<"?">
      %2451 = cute.get_scalars(%e3_6130) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6131 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6132 = cute.add_offset(%e3_6130, %int_tuple_6131) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2452 = cute.get_scalars(%tup_6132) : !cute.int_tuple<"?">
      %coord_6133 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6134 = cute.make_coord(%tup_6132) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2453 = cute.get_scalars(%coord_6133) : !cute.coord<"?">
      %2454 = cute.get_scalars(%coord_6134) : !cute.coord<"?">
      %true_6135 = arith.constant true
      %2455 = arith.cmpi slt, %2453, %2454 : i32
      %2456 = arith.andi %true_6135, %2455 : i1
      %lay_6136 = cute.get_layout(%2437) : !memref_rmem_f32_4
      %2457 = cute.get_shape(%lay_6136) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6137, %e1_6138, %e2_6139, %e3_6140 = cute.get_leaves(%2457) : !cute.shape<"((2,2),(2,8))">
      %2458 = cute.get_stride(%lay_6136) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6141, %e1_6142, %e2_6143, %e3_6144 = cute.get_leaves(%2458) : !cute.stride<"((2,4),(1,8))">
      %2459 = scf.if %2456 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2437) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,2)">
        cute.memref.store(%2437, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,2)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2437) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2437 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2437) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2437) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2437 : !memref_rmem_f32_4
      }
      %iter_6145 = cute.get_iter(%2459) : !memref_rmem_f32_4
      %lay_6146 = cute.get_layout(%2459) : !memref_rmem_f32_4
      %2460 = cute.get_shape(%lay_6146) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6147, %e1_6148, %e2_6149, %e3_6150 = cute.get_leaves(%2460) : !cute.shape<"((2,2),(2,8))">
      %2461 = cute.get_stride(%lay_6146) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6151, %e1_6152, %e2_6153, %e3_6154 = cute.get_leaves(%2461) : !cute.stride<"((2,4),(1,8))">
      %iter_6155 = cute.get_iter(%2459) : !memref_rmem_f32_4
      %iter_6156 = cute.get_iter(%2459) : !memref_rmem_f32_4
      %coord_6157 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_6158 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6159 = cute.crd2idx(%coord_6157, %lay_6158) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_6160 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6161 = cute.add_offset(%iter_6160, %idx_6159) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6162 = cute.make_view(%tup_6161) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6163 = cute.get_iter(%view_6162) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6164, %e1_6165, %e2_6166, %e3_6167 = cute.get_leaves(%iter_6163) : !cute.int_tuple<"(?,?,?,?)">
      %2462 = cute.get_scalars(%e0_6164) : !cute.int_tuple<"?">
      %2463 = cute.get_scalars(%e1_6165) : !cute.int_tuple<"?">
      %2464 = cute.get_scalars(%e2_6166) : !cute.int_tuple<"?">
      %2465 = cute.get_scalars(%e3_6167) : !cute.int_tuple<"?">
      %iter_6168 = cute.get_iter(%view_6162) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6169, %e1_6170, %e2_6171, %e3_6172 = cute.get_leaves(%iter_6168) : !cute.int_tuple<"(?,?,?,?)">
      %2466 = cute.get_scalars(%e0_6169) : !cute.int_tuple<"?">
      %2467 = cute.get_scalars(%e1_6170) : !cute.int_tuple<"?">
      %2468 = cute.get_scalars(%e2_6171) : !cute.int_tuple<"?">
      %2469 = cute.get_scalars(%e3_6172) : !cute.int_tuple<"?">
      %iter_6173 = cute.get_iter(%view_6162) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6174, %e1_6175, %e2_6176, %e3_6177 = cute.get_leaves(%iter_6173) : !cute.int_tuple<"(?,?,?,?)">
      %2470 = cute.get_scalars(%e0_6174) : !cute.int_tuple<"?">
      %2471 = cute.get_scalars(%e1_6175) : !cute.int_tuple<"?">
      %2472 = cute.get_scalars(%e2_6176) : !cute.int_tuple<"?">
      %2473 = cute.get_scalars(%e3_6177) : !cute.int_tuple<"?">
      %int_tuple_6178 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6179 = cute.add_offset(%e3_6177, %int_tuple_6178) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2474 = cute.get_scalars(%tup_6179) : !cute.int_tuple<"?">
      %coord_6180 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6181 = cute.make_coord(%tup_6179) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2475 = cute.get_scalars(%coord_6180) : !cute.coord<"?">
      %2476 = cute.get_scalars(%coord_6181) : !cute.coord<"?">
      %true_6182 = arith.constant true
      %2477 = arith.cmpi slt, %2475, %2476 : i32
      %2478 = arith.andi %true_6182, %2477 : i1
      %lay_6183 = cute.get_layout(%2459) : !memref_rmem_f32_4
      %2479 = cute.get_shape(%lay_6183) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6184, %e1_6185, %e2_6186, %e3_6187 = cute.get_leaves(%2479) : !cute.shape<"((2,2),(2,8))">
      %2480 = cute.get_stride(%lay_6183) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6188, %e1_6189, %e2_6190, %e3_6191 = cute.get_leaves(%2480) : !cute.stride<"((2,4),(1,8))">
      %2481 = scf.if %2478 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2459) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,3)">
        cute.memref.store(%2459, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,3)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2459) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2459 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2459) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2459) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2459 : !memref_rmem_f32_4
      }
      %iter_6192 = cute.get_iter(%2481) : !memref_rmem_f32_4
      %lay_6193 = cute.get_layout(%2481) : !memref_rmem_f32_4
      %2482 = cute.get_shape(%lay_6193) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6194, %e1_6195, %e2_6196, %e3_6197 = cute.get_leaves(%2482) : !cute.shape<"((2,2),(2,8))">
      %2483 = cute.get_stride(%lay_6193) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6198, %e1_6199, %e2_6200, %e3_6201 = cute.get_leaves(%2483) : !cute.stride<"((2,4),(1,8))">
      %iter_6202 = cute.get_iter(%2481) : !memref_rmem_f32_4
      %iter_6203 = cute.get_iter(%2481) : !memref_rmem_f32_4
      %coord_6204 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_6205 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6206 = cute.crd2idx(%coord_6204, %lay_6205) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_6207 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6208 = cute.add_offset(%iter_6207, %idx_6206) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6209 = cute.make_view(%tup_6208) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6210 = cute.get_iter(%view_6209) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6211, %e1_6212, %e2_6213, %e3_6214 = cute.get_leaves(%iter_6210) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2484 = cute.get_scalars(%e0_6211) : !cute.int_tuple<"?">
      %2485 = cute.get_scalars(%e1_6212) : !cute.int_tuple<"?">
      %2486 = cute.get_scalars(%e2_6213) : !cute.int_tuple<"?">
      %2487 = cute.get_scalars(%e3_6214) : !cute.int_tuple<"?{div=2}">
      %iter_6215 = cute.get_iter(%view_6209) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6216, %e1_6217, %e2_6218, %e3_6219 = cute.get_leaves(%iter_6215) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2488 = cute.get_scalars(%e0_6216) : !cute.int_tuple<"?">
      %2489 = cute.get_scalars(%e1_6217) : !cute.int_tuple<"?">
      %2490 = cute.get_scalars(%e2_6218) : !cute.int_tuple<"?">
      %2491 = cute.get_scalars(%e3_6219) : !cute.int_tuple<"?{div=2}">
      %iter_6220 = cute.get_iter(%view_6209) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6221, %e1_6222, %e2_6223, %e3_6224 = cute.get_leaves(%iter_6220) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2492 = cute.get_scalars(%e0_6221) : !cute.int_tuple<"?">
      %2493 = cute.get_scalars(%e1_6222) : !cute.int_tuple<"?">
      %2494 = cute.get_scalars(%e2_6223) : !cute.int_tuple<"?">
      %2495 = cute.get_scalars(%e3_6224) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6225 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6226 = cute.add_offset(%e3_6224, %int_tuple_6225) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2496 = cute.get_scalars(%tup_6226) : !cute.int_tuple<"?">
      %coord_6227 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6228 = cute.make_coord(%tup_6226) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2497 = cute.get_scalars(%coord_6227) : !cute.coord<"?">
      %2498 = cute.get_scalars(%coord_6228) : !cute.coord<"?">
      %true_6229 = arith.constant true
      %2499 = arith.cmpi slt, %2497, %2498 : i32
      %2500 = arith.andi %true_6229, %2499 : i1
      %lay_6230 = cute.get_layout(%2481) : !memref_rmem_f32_4
      %2501 = cute.get_shape(%lay_6230) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6231, %e1_6232, %e2_6233, %e3_6234 = cute.get_leaves(%2501) : !cute.shape<"((2,2),(2,8))">
      %2502 = cute.get_stride(%lay_6230) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6235, %e1_6236, %e2_6237, %e3_6238 = cute.get_leaves(%2502) : !cute.stride<"((2,4),(1,8))">
      %2503 = scf.if %2500 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2481) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,4)">
        cute.memref.store(%2481, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,4)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2481) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2481 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2481) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2481) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2481 : !memref_rmem_f32_4
      }
      %iter_6239 = cute.get_iter(%2503) : !memref_rmem_f32_4
      %lay_6240 = cute.get_layout(%2503) : !memref_rmem_f32_4
      %2504 = cute.get_shape(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6241, %e1_6242, %e2_6243, %e3_6244 = cute.get_leaves(%2504) : !cute.shape<"((2,2),(2,8))">
      %2505 = cute.get_stride(%lay_6240) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%2505) : !cute.stride<"((2,4),(1,8))">
      %iter_6249 = cute.get_iter(%2503) : !memref_rmem_f32_4
      %iter_6250 = cute.get_iter(%2503) : !memref_rmem_f32_4
      %coord_6251 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_6252 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6253 = cute.crd2idx(%coord_6251, %lay_6252) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_6254 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6255 = cute.add_offset(%iter_6254, %idx_6253) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6256 = cute.make_view(%tup_6255) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6257 = cute.get_iter(%view_6256) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6258, %e1_6259, %e2_6260, %e3_6261 = cute.get_leaves(%iter_6257) : !cute.int_tuple<"(?,?,?,?)">
      %2506 = cute.get_scalars(%e0_6258) : !cute.int_tuple<"?">
      %2507 = cute.get_scalars(%e1_6259) : !cute.int_tuple<"?">
      %2508 = cute.get_scalars(%e2_6260) : !cute.int_tuple<"?">
      %2509 = cute.get_scalars(%e3_6261) : !cute.int_tuple<"?">
      %iter_6262 = cute.get_iter(%view_6256) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6263, %e1_6264, %e2_6265, %e3_6266 = cute.get_leaves(%iter_6262) : !cute.int_tuple<"(?,?,?,?)">
      %2510 = cute.get_scalars(%e0_6263) : !cute.int_tuple<"?">
      %2511 = cute.get_scalars(%e1_6264) : !cute.int_tuple<"?">
      %2512 = cute.get_scalars(%e2_6265) : !cute.int_tuple<"?">
      %2513 = cute.get_scalars(%e3_6266) : !cute.int_tuple<"?">
      %iter_6267 = cute.get_iter(%view_6256) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6268, %e1_6269, %e2_6270, %e3_6271 = cute.get_leaves(%iter_6267) : !cute.int_tuple<"(?,?,?,?)">
      %2514 = cute.get_scalars(%e0_6268) : !cute.int_tuple<"?">
      %2515 = cute.get_scalars(%e1_6269) : !cute.int_tuple<"?">
      %2516 = cute.get_scalars(%e2_6270) : !cute.int_tuple<"?">
      %2517 = cute.get_scalars(%e3_6271) : !cute.int_tuple<"?">
      %int_tuple_6272 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6273 = cute.add_offset(%e3_6271, %int_tuple_6272) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2518 = cute.get_scalars(%tup_6273) : !cute.int_tuple<"?">
      %coord_6274 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6275 = cute.make_coord(%tup_6273) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2519 = cute.get_scalars(%coord_6274) : !cute.coord<"?">
      %2520 = cute.get_scalars(%coord_6275) : !cute.coord<"?">
      %true_6276 = arith.constant true
      %2521 = arith.cmpi slt, %2519, %2520 : i32
      %2522 = arith.andi %true_6276, %2521 : i1
      %lay_6277 = cute.get_layout(%2503) : !memref_rmem_f32_4
      %2523 = cute.get_shape(%lay_6277) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6278, %e1_6279, %e2_6280, %e3_6281 = cute.get_leaves(%2523) : !cute.shape<"((2,2),(2,8))">
      %2524 = cute.get_stride(%lay_6277) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6282, %e1_6283, %e2_6284, %e3_6285 = cute.get_leaves(%2524) : !cute.stride<"((2,4),(1,8))">
      %2525 = scf.if %2522 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2503) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,5)">
        cute.memref.store(%2503, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,5)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2503) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2503 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2503) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2503) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2503 : !memref_rmem_f32_4
      }
      %iter_6286 = cute.get_iter(%2525) : !memref_rmem_f32_4
      %lay_6287 = cute.get_layout(%2525) : !memref_rmem_f32_4
      %2526 = cute.get_shape(%lay_6287) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6288, %e1_6289, %e2_6290, %e3_6291 = cute.get_leaves(%2526) : !cute.shape<"((2,2),(2,8))">
      %2527 = cute.get_stride(%lay_6287) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6292, %e1_6293, %e2_6294, %e3_6295 = cute.get_leaves(%2527) : !cute.stride<"((2,4),(1,8))">
      %iter_6296 = cute.get_iter(%2525) : !memref_rmem_f32_4
      %iter_6297 = cute.get_iter(%2525) : !memref_rmem_f32_4
      %coord_6298 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_6299 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6300 = cute.crd2idx(%coord_6298, %lay_6299) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_6301 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6302 = cute.add_offset(%iter_6301, %idx_6300) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6303 = cute.make_view(%tup_6302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6304 = cute.get_iter(%view_6303) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6305, %e1_6306, %e2_6307, %e3_6308 = cute.get_leaves(%iter_6304) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2528 = cute.get_scalars(%e0_6305) : !cute.int_tuple<"?">
      %2529 = cute.get_scalars(%e1_6306) : !cute.int_tuple<"?">
      %2530 = cute.get_scalars(%e2_6307) : !cute.int_tuple<"?">
      %2531 = cute.get_scalars(%e3_6308) : !cute.int_tuple<"?{div=2}">
      %iter_6309 = cute.get_iter(%view_6303) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6310, %e1_6311, %e2_6312, %e3_6313 = cute.get_leaves(%iter_6309) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2532 = cute.get_scalars(%e0_6310) : !cute.int_tuple<"?">
      %2533 = cute.get_scalars(%e1_6311) : !cute.int_tuple<"?">
      %2534 = cute.get_scalars(%e2_6312) : !cute.int_tuple<"?">
      %2535 = cute.get_scalars(%e3_6313) : !cute.int_tuple<"?{div=2}">
      %iter_6314 = cute.get_iter(%view_6303) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6315, %e1_6316, %e2_6317, %e3_6318 = cute.get_leaves(%iter_6314) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2536 = cute.get_scalars(%e0_6315) : !cute.int_tuple<"?">
      %2537 = cute.get_scalars(%e1_6316) : !cute.int_tuple<"?">
      %2538 = cute.get_scalars(%e2_6317) : !cute.int_tuple<"?">
      %2539 = cute.get_scalars(%e3_6318) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6319 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6320 = cute.add_offset(%e3_6318, %int_tuple_6319) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2540 = cute.get_scalars(%tup_6320) : !cute.int_tuple<"?">
      %coord_6321 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6322 = cute.make_coord(%tup_6320) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2541 = cute.get_scalars(%coord_6321) : !cute.coord<"?">
      %2542 = cute.get_scalars(%coord_6322) : !cute.coord<"?">
      %true_6323 = arith.constant true
      %2543 = arith.cmpi slt, %2541, %2542 : i32
      %2544 = arith.andi %true_6323, %2543 : i1
      %lay_6324 = cute.get_layout(%2525) : !memref_rmem_f32_4
      %2545 = cute.get_shape(%lay_6324) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6325, %e1_6326, %e2_6327, %e3_6328 = cute.get_leaves(%2545) : !cute.shape<"((2,2),(2,8))">
      %2546 = cute.get_stride(%lay_6324) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6329, %e1_6330, %e2_6331, %e3_6332 = cute.get_leaves(%2546) : !cute.stride<"((2,4),(1,8))">
      %2547 = scf.if %2544 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2525) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,6)">
        cute.memref.store(%2525, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,6)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2525) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2525 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2525) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2525) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2525 : !memref_rmem_f32_4
      }
      %iter_6333 = cute.get_iter(%2547) : !memref_rmem_f32_4
      %lay_6334 = cute.get_layout(%2547) : !memref_rmem_f32_4
      %2548 = cute.get_shape(%lay_6334) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6335, %e1_6336, %e2_6337, %e3_6338 = cute.get_leaves(%2548) : !cute.shape<"((2,2),(2,8))">
      %2549 = cute.get_stride(%lay_6334) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6339, %e1_6340, %e2_6341, %e3_6342 = cute.get_leaves(%2549) : !cute.stride<"((2,4),(1,8))">
      %iter_6343 = cute.get_iter(%2547) : !memref_rmem_f32_4
      %iter_6344 = cute.get_iter(%2547) : !memref_rmem_f32_4
      %coord_6345 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_6346 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6347 = cute.crd2idx(%coord_6345, %lay_6346) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_6348 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6349 = cute.add_offset(%iter_6348, %idx_6347) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6350 = cute.make_view(%tup_6349) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6351 = cute.get_iter(%view_6350) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6352, %e1_6353, %e2_6354, %e3_6355 = cute.get_leaves(%iter_6351) : !cute.int_tuple<"(?,?,?,?)">
      %2550 = cute.get_scalars(%e0_6352) : !cute.int_tuple<"?">
      %2551 = cute.get_scalars(%e1_6353) : !cute.int_tuple<"?">
      %2552 = cute.get_scalars(%e2_6354) : !cute.int_tuple<"?">
      %2553 = cute.get_scalars(%e3_6355) : !cute.int_tuple<"?">
      %iter_6356 = cute.get_iter(%view_6350) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%iter_6356) : !cute.int_tuple<"(?,?,?,?)">
      %2554 = cute.get_scalars(%e0_6357) : !cute.int_tuple<"?">
      %2555 = cute.get_scalars(%e1_6358) : !cute.int_tuple<"?">
      %2556 = cute.get_scalars(%e2_6359) : !cute.int_tuple<"?">
      %2557 = cute.get_scalars(%e3_6360) : !cute.int_tuple<"?">
      %iter_6361 = cute.get_iter(%view_6350) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6362, %e1_6363, %e2_6364, %e3_6365 = cute.get_leaves(%iter_6361) : !cute.int_tuple<"(?,?,?,?)">
      %2558 = cute.get_scalars(%e0_6362) : !cute.int_tuple<"?">
      %2559 = cute.get_scalars(%e1_6363) : !cute.int_tuple<"?">
      %2560 = cute.get_scalars(%e2_6364) : !cute.int_tuple<"?">
      %2561 = cute.get_scalars(%e3_6365) : !cute.int_tuple<"?">
      %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6367 = cute.add_offset(%e3_6365, %int_tuple_6366) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2562 = cute.get_scalars(%tup_6367) : !cute.int_tuple<"?">
      %coord_6368 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6369 = cute.make_coord(%tup_6367) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2563 = cute.get_scalars(%coord_6368) : !cute.coord<"?">
      %2564 = cute.get_scalars(%coord_6369) : !cute.coord<"?">
      %true_6370 = arith.constant true
      %2565 = arith.cmpi slt, %2563, %2564 : i32
      %2566 = arith.andi %true_6370, %2565 : i1
      %lay_6371 = cute.get_layout(%2547) : !memref_rmem_f32_4
      %2567 = cute.get_shape(%lay_6371) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6372, %e1_6373, %e2_6374, %e3_6375 = cute.get_leaves(%2567) : !cute.shape<"((2,2),(2,8))">
      %2568 = cute.get_stride(%lay_6371) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6376, %e1_6377, %e2_6378, %e3_6379 = cute.get_leaves(%2568) : !cute.stride<"((2,4),(1,8))">
      %2569 = scf.if %2566 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2547) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,7)">
        cute.memref.store(%2547, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,7)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2547) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2547 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2547) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2547) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2547 : !memref_rmem_f32_4
      }
      %iter_6380 = cute.get_iter(%2569) : !memref_rmem_f32_4
      %lay_6381 = cute.get_layout(%2569) : !memref_rmem_f32_4
      %2570 = cute.get_shape(%lay_6381) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6382, %e1_6383, %e2_6384, %e3_6385 = cute.get_leaves(%2570) : !cute.shape<"((2,2),(2,8))">
      %2571 = cute.get_stride(%lay_6381) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6386, %e1_6387, %e2_6388, %e3_6389 = cute.get_leaves(%2571) : !cute.stride<"((2,4),(1,8))">
      %iter_6390 = cute.get_iter(%2569) : !memref_rmem_f32_4
      %iter_6391 = cute.get_iter(%2569) : !memref_rmem_f32_4
      %coord_6392 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_6393 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6394 = cute.crd2idx(%coord_6392, %lay_6393) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_6395 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6396 = cute.add_offset(%iter_6395, %idx_6394) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6397 = cute.make_view(%tup_6396) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6398 = cute.get_iter(%view_6397) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6399, %e1_6400, %e2_6401, %e3_6402 = cute.get_leaves(%iter_6398) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2572 = cute.get_scalars(%e0_6399) : !cute.int_tuple<"?">
      %2573 = cute.get_scalars(%e1_6400) : !cute.int_tuple<"?">
      %2574 = cute.get_scalars(%e2_6401) : !cute.int_tuple<"?">
      %2575 = cute.get_scalars(%e3_6402) : !cute.int_tuple<"?{div=2}">
      %iter_6403 = cute.get_iter(%view_6397) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6404, %e1_6405, %e2_6406, %e3_6407 = cute.get_leaves(%iter_6403) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2576 = cute.get_scalars(%e0_6404) : !cute.int_tuple<"?">
      %2577 = cute.get_scalars(%e1_6405) : !cute.int_tuple<"?">
      %2578 = cute.get_scalars(%e2_6406) : !cute.int_tuple<"?">
      %2579 = cute.get_scalars(%e3_6407) : !cute.int_tuple<"?{div=2}">
      %iter_6408 = cute.get_iter(%view_6397) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6409, %e1_6410, %e2_6411, %e3_6412 = cute.get_leaves(%iter_6408) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2580 = cute.get_scalars(%e0_6409) : !cute.int_tuple<"?">
      %2581 = cute.get_scalars(%e1_6410) : !cute.int_tuple<"?">
      %2582 = cute.get_scalars(%e2_6411) : !cute.int_tuple<"?">
      %2583 = cute.get_scalars(%e3_6412) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6413 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6414 = cute.add_offset(%e3_6412, %int_tuple_6413) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2584 = cute.get_scalars(%tup_6414) : !cute.int_tuple<"?">
      %coord_6415 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6416 = cute.make_coord(%tup_6414) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2585 = cute.get_scalars(%coord_6415) : !cute.coord<"?">
      %2586 = cute.get_scalars(%coord_6416) : !cute.coord<"?">
      %true_6417 = arith.constant true
      %2587 = arith.cmpi slt, %2585, %2586 : i32
      %2588 = arith.andi %true_6417, %2587 : i1
      %lay_6418 = cute.get_layout(%2569) : !memref_rmem_f32_4
      %2589 = cute.get_shape(%lay_6418) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6419, %e1_6420, %e2_6421, %e3_6422 = cute.get_leaves(%2589) : !cute.shape<"((2,2),(2,8))">
      %2590 = cute.get_stride(%lay_6418) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6423, %e1_6424, %e2_6425, %e3_6426 = cute.get_leaves(%2590) : !cute.stride<"((2,4),(1,8))">
      %2591 = scf.if %2588 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2569) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,8)">
        cute.memref.store(%2569, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,8)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2569) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2569 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2569) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2569) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2569 : !memref_rmem_f32_4
      }
      %iter_6427 = cute.get_iter(%2591) : !memref_rmem_f32_4
      %lay_6428 = cute.get_layout(%2591) : !memref_rmem_f32_4
      %2592 = cute.get_shape(%lay_6428) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6429, %e1_6430, %e2_6431, %e3_6432 = cute.get_leaves(%2592) : !cute.shape<"((2,2),(2,8))">
      %2593 = cute.get_stride(%lay_6428) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6433, %e1_6434, %e2_6435, %e3_6436 = cute.get_leaves(%2593) : !cute.stride<"((2,4),(1,8))">
      %iter_6437 = cute.get_iter(%2591) : !memref_rmem_f32_4
      %iter_6438 = cute.get_iter(%2591) : !memref_rmem_f32_4
      %coord_6439 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_6440 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6441 = cute.crd2idx(%coord_6439, %lay_6440) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_6442 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6443 = cute.add_offset(%iter_6442, %idx_6441) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6444 = cute.make_view(%tup_6443) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6445 = cute.get_iter(%view_6444) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6446, %e1_6447, %e2_6448, %e3_6449 = cute.get_leaves(%iter_6445) : !cute.int_tuple<"(?,?,?,?)">
      %2594 = cute.get_scalars(%e0_6446) : !cute.int_tuple<"?">
      %2595 = cute.get_scalars(%e1_6447) : !cute.int_tuple<"?">
      %2596 = cute.get_scalars(%e2_6448) : !cute.int_tuple<"?">
      %2597 = cute.get_scalars(%e3_6449) : !cute.int_tuple<"?">
      %iter_6450 = cute.get_iter(%view_6444) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6451, %e1_6452, %e2_6453, %e3_6454 = cute.get_leaves(%iter_6450) : !cute.int_tuple<"(?,?,?,?)">
      %2598 = cute.get_scalars(%e0_6451) : !cute.int_tuple<"?">
      %2599 = cute.get_scalars(%e1_6452) : !cute.int_tuple<"?">
      %2600 = cute.get_scalars(%e2_6453) : !cute.int_tuple<"?">
      %2601 = cute.get_scalars(%e3_6454) : !cute.int_tuple<"?">
      %iter_6455 = cute.get_iter(%view_6444) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6456, %e1_6457, %e2_6458, %e3_6459 = cute.get_leaves(%iter_6455) : !cute.int_tuple<"(?,?,?,?)">
      %2602 = cute.get_scalars(%e0_6456) : !cute.int_tuple<"?">
      %2603 = cute.get_scalars(%e1_6457) : !cute.int_tuple<"?">
      %2604 = cute.get_scalars(%e2_6458) : !cute.int_tuple<"?">
      %2605 = cute.get_scalars(%e3_6459) : !cute.int_tuple<"?">
      %int_tuple_6460 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6461 = cute.add_offset(%e3_6459, %int_tuple_6460) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2606 = cute.get_scalars(%tup_6461) : !cute.int_tuple<"?">
      %coord_6462 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6463 = cute.make_coord(%tup_6461) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2607 = cute.get_scalars(%coord_6462) : !cute.coord<"?">
      %2608 = cute.get_scalars(%coord_6463) : !cute.coord<"?">
      %true_6464 = arith.constant true
      %2609 = arith.cmpi slt, %2607, %2608 : i32
      %2610 = arith.andi %true_6464, %2609 : i1
      %lay_6465 = cute.get_layout(%2591) : !memref_rmem_f32_4
      %2611 = cute.get_shape(%lay_6465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6466, %e1_6467, %e2_6468, %e3_6469 = cute.get_leaves(%2611) : !cute.shape<"((2,2),(2,8))">
      %2612 = cute.get_stride(%lay_6465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6470, %e1_6471, %e2_6472, %e3_6473 = cute.get_leaves(%2612) : !cute.stride<"((2,4),(1,8))">
      %2613 = scf.if %2610 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2591) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,9)">
        cute.memref.store(%2591, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,9)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2591) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2591 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2591) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2591) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2591 : !memref_rmem_f32_4
      }
      %iter_6474 = cute.get_iter(%2613) : !memref_rmem_f32_4
      %lay_6475 = cute.get_layout(%2613) : !memref_rmem_f32_4
      %2614 = cute.get_shape(%lay_6475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6476, %e1_6477, %e2_6478, %e3_6479 = cute.get_leaves(%2614) : !cute.shape<"((2,2),(2,8))">
      %2615 = cute.get_stride(%lay_6475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6480, %e1_6481, %e2_6482, %e3_6483 = cute.get_leaves(%2615) : !cute.stride<"((2,4),(1,8))">
      %iter_6484 = cute.get_iter(%2613) : !memref_rmem_f32_4
      %iter_6485 = cute.get_iter(%2613) : !memref_rmem_f32_4
      %coord_6486 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_6487 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6488 = cute.crd2idx(%coord_6486, %lay_6487) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_6489 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6490 = cute.add_offset(%iter_6489, %idx_6488) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6491 = cute.make_view(%tup_6490) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6492 = cute.get_iter(%view_6491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6493, %e1_6494, %e2_6495, %e3_6496 = cute.get_leaves(%iter_6492) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2616 = cute.get_scalars(%e0_6493) : !cute.int_tuple<"?">
      %2617 = cute.get_scalars(%e1_6494) : !cute.int_tuple<"?">
      %2618 = cute.get_scalars(%e2_6495) : !cute.int_tuple<"?">
      %2619 = cute.get_scalars(%e3_6496) : !cute.int_tuple<"?{div=2}">
      %iter_6497 = cute.get_iter(%view_6491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6498, %e1_6499, %e2_6500, %e3_6501 = cute.get_leaves(%iter_6497) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2620 = cute.get_scalars(%e0_6498) : !cute.int_tuple<"?">
      %2621 = cute.get_scalars(%e1_6499) : !cute.int_tuple<"?">
      %2622 = cute.get_scalars(%e2_6500) : !cute.int_tuple<"?">
      %2623 = cute.get_scalars(%e3_6501) : !cute.int_tuple<"?{div=2}">
      %iter_6502 = cute.get_iter(%view_6491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6503, %e1_6504, %e2_6505, %e3_6506 = cute.get_leaves(%iter_6502) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2624 = cute.get_scalars(%e0_6503) : !cute.int_tuple<"?">
      %2625 = cute.get_scalars(%e1_6504) : !cute.int_tuple<"?">
      %2626 = cute.get_scalars(%e2_6505) : !cute.int_tuple<"?">
      %2627 = cute.get_scalars(%e3_6506) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6507 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6508 = cute.add_offset(%e3_6506, %int_tuple_6507) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2628 = cute.get_scalars(%tup_6508) : !cute.int_tuple<"?">
      %coord_6509 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6510 = cute.make_coord(%tup_6508) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2629 = cute.get_scalars(%coord_6509) : !cute.coord<"?">
      %2630 = cute.get_scalars(%coord_6510) : !cute.coord<"?">
      %true_6511 = arith.constant true
      %2631 = arith.cmpi slt, %2629, %2630 : i32
      %2632 = arith.andi %true_6511, %2631 : i1
      %lay_6512 = cute.get_layout(%2613) : !memref_rmem_f32_4
      %2633 = cute.get_shape(%lay_6512) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6513, %e1_6514, %e2_6515, %e3_6516 = cute.get_leaves(%2633) : !cute.shape<"((2,2),(2,8))">
      %2634 = cute.get_stride(%lay_6512) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6517, %e1_6518, %e2_6519, %e3_6520 = cute.get_leaves(%2634) : !cute.stride<"((2,4),(1,8))">
      %2635 = scf.if %2632 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2613) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,10)">
        cute.memref.store(%2613, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,10)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2613) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2613 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2613) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2613) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2613 : !memref_rmem_f32_4
      }
      %iter_6521 = cute.get_iter(%2635) : !memref_rmem_f32_4
      %lay_6522 = cute.get_layout(%2635) : !memref_rmem_f32_4
      %2636 = cute.get_shape(%lay_6522) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6523, %e1_6524, %e2_6525, %e3_6526 = cute.get_leaves(%2636) : !cute.shape<"((2,2),(2,8))">
      %2637 = cute.get_stride(%lay_6522) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6527, %e1_6528, %e2_6529, %e3_6530 = cute.get_leaves(%2637) : !cute.stride<"((2,4),(1,8))">
      %iter_6531 = cute.get_iter(%2635) : !memref_rmem_f32_4
      %iter_6532 = cute.get_iter(%2635) : !memref_rmem_f32_4
      %coord_6533 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_6534 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6535 = cute.crd2idx(%coord_6533, %lay_6534) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_6536 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6537 = cute.add_offset(%iter_6536, %idx_6535) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6538 = cute.make_view(%tup_6537) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6539 = cute.get_iter(%view_6538) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6540, %e1_6541, %e2_6542, %e3_6543 = cute.get_leaves(%iter_6539) : !cute.int_tuple<"(?,?,?,?)">
      %2638 = cute.get_scalars(%e0_6540) : !cute.int_tuple<"?">
      %2639 = cute.get_scalars(%e1_6541) : !cute.int_tuple<"?">
      %2640 = cute.get_scalars(%e2_6542) : !cute.int_tuple<"?">
      %2641 = cute.get_scalars(%e3_6543) : !cute.int_tuple<"?">
      %iter_6544 = cute.get_iter(%view_6538) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6545, %e1_6546, %e2_6547, %e3_6548 = cute.get_leaves(%iter_6544) : !cute.int_tuple<"(?,?,?,?)">
      %2642 = cute.get_scalars(%e0_6545) : !cute.int_tuple<"?">
      %2643 = cute.get_scalars(%e1_6546) : !cute.int_tuple<"?">
      %2644 = cute.get_scalars(%e2_6547) : !cute.int_tuple<"?">
      %2645 = cute.get_scalars(%e3_6548) : !cute.int_tuple<"?">
      %iter_6549 = cute.get_iter(%view_6538) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6550, %e1_6551, %e2_6552, %e3_6553 = cute.get_leaves(%iter_6549) : !cute.int_tuple<"(?,?,?,?)">
      %2646 = cute.get_scalars(%e0_6550) : !cute.int_tuple<"?">
      %2647 = cute.get_scalars(%e1_6551) : !cute.int_tuple<"?">
      %2648 = cute.get_scalars(%e2_6552) : !cute.int_tuple<"?">
      %2649 = cute.get_scalars(%e3_6553) : !cute.int_tuple<"?">
      %int_tuple_6554 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6555 = cute.add_offset(%e3_6553, %int_tuple_6554) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2650 = cute.get_scalars(%tup_6555) : !cute.int_tuple<"?">
      %coord_6556 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6557 = cute.make_coord(%tup_6555) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2651 = cute.get_scalars(%coord_6556) : !cute.coord<"?">
      %2652 = cute.get_scalars(%coord_6557) : !cute.coord<"?">
      %true_6558 = arith.constant true
      %2653 = arith.cmpi slt, %2651, %2652 : i32
      %2654 = arith.andi %true_6558, %2653 : i1
      %lay_6559 = cute.get_layout(%2635) : !memref_rmem_f32_4
      %2655 = cute.get_shape(%lay_6559) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6560, %e1_6561, %e2_6562, %e3_6563 = cute.get_leaves(%2655) : !cute.shape<"((2,2),(2,8))">
      %2656 = cute.get_stride(%lay_6559) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6564, %e1_6565, %e2_6566, %e3_6567 = cute.get_leaves(%2656) : !cute.stride<"((2,4),(1,8))">
      %2657 = scf.if %2654 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2635) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,11)">
        cute.memref.store(%2635, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,11)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2635) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2635 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2635) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2635) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2635 : !memref_rmem_f32_4
      }
      %iter_6568 = cute.get_iter(%2657) : !memref_rmem_f32_4
      %lay_6569 = cute.get_layout(%2657) : !memref_rmem_f32_4
      %2658 = cute.get_shape(%lay_6569) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6570, %e1_6571, %e2_6572, %e3_6573 = cute.get_leaves(%2658) : !cute.shape<"((2,2),(2,8))">
      %2659 = cute.get_stride(%lay_6569) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6574, %e1_6575, %e2_6576, %e3_6577 = cute.get_leaves(%2659) : !cute.stride<"((2,4),(1,8))">
      %iter_6578 = cute.get_iter(%2657) : !memref_rmem_f32_4
      %iter_6579 = cute.get_iter(%2657) : !memref_rmem_f32_4
      %coord_6580 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_6581 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6582 = cute.crd2idx(%coord_6580, %lay_6581) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_6583 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6584 = cute.add_offset(%iter_6583, %idx_6582) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6585 = cute.make_view(%tup_6584) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6586 = cute.get_iter(%view_6585) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6587, %e1_6588, %e2_6589, %e3_6590 = cute.get_leaves(%iter_6586) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2660 = cute.get_scalars(%e0_6587) : !cute.int_tuple<"?">
      %2661 = cute.get_scalars(%e1_6588) : !cute.int_tuple<"?">
      %2662 = cute.get_scalars(%e2_6589) : !cute.int_tuple<"?">
      %2663 = cute.get_scalars(%e3_6590) : !cute.int_tuple<"?{div=2}">
      %iter_6591 = cute.get_iter(%view_6585) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6592, %e1_6593, %e2_6594, %e3_6595 = cute.get_leaves(%iter_6591) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2664 = cute.get_scalars(%e0_6592) : !cute.int_tuple<"?">
      %2665 = cute.get_scalars(%e1_6593) : !cute.int_tuple<"?">
      %2666 = cute.get_scalars(%e2_6594) : !cute.int_tuple<"?">
      %2667 = cute.get_scalars(%e3_6595) : !cute.int_tuple<"?{div=2}">
      %iter_6596 = cute.get_iter(%view_6585) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6597, %e1_6598, %e2_6599, %e3_6600 = cute.get_leaves(%iter_6596) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2668 = cute.get_scalars(%e0_6597) : !cute.int_tuple<"?">
      %2669 = cute.get_scalars(%e1_6598) : !cute.int_tuple<"?">
      %2670 = cute.get_scalars(%e2_6599) : !cute.int_tuple<"?">
      %2671 = cute.get_scalars(%e3_6600) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6601 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6602 = cute.add_offset(%e3_6600, %int_tuple_6601) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2672 = cute.get_scalars(%tup_6602) : !cute.int_tuple<"?">
      %coord_6603 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6604 = cute.make_coord(%tup_6602) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2673 = cute.get_scalars(%coord_6603) : !cute.coord<"?">
      %2674 = cute.get_scalars(%coord_6604) : !cute.coord<"?">
      %true_6605 = arith.constant true
      %2675 = arith.cmpi slt, %2673, %2674 : i32
      %2676 = arith.andi %true_6605, %2675 : i1
      %lay_6606 = cute.get_layout(%2657) : !memref_rmem_f32_4
      %2677 = cute.get_shape(%lay_6606) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6607, %e1_6608, %e2_6609, %e3_6610 = cute.get_leaves(%2677) : !cute.shape<"((2,2),(2,8))">
      %2678 = cute.get_stride(%lay_6606) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6611, %e1_6612, %e2_6613, %e3_6614 = cute.get_leaves(%2678) : !cute.stride<"((2,4),(1,8))">
      %2679 = scf.if %2676 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2657) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,12)">
        cute.memref.store(%2657, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,12)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2657) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2657 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2657) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2657) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2657 : !memref_rmem_f32_4
      }
      %iter_6615 = cute.get_iter(%2679) : !memref_rmem_f32_4
      %lay_6616 = cute.get_layout(%2679) : !memref_rmem_f32_4
      %2680 = cute.get_shape(%lay_6616) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6617, %e1_6618, %e2_6619, %e3_6620 = cute.get_leaves(%2680) : !cute.shape<"((2,2),(2,8))">
      %2681 = cute.get_stride(%lay_6616) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6621, %e1_6622, %e2_6623, %e3_6624 = cute.get_leaves(%2681) : !cute.stride<"((2,4),(1,8))">
      %iter_6625 = cute.get_iter(%2679) : !memref_rmem_f32_4
      %iter_6626 = cute.get_iter(%2679) : !memref_rmem_f32_4
      %coord_6627 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_6628 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6629 = cute.crd2idx(%coord_6627, %lay_6628) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_6630 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6631 = cute.add_offset(%iter_6630, %idx_6629) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6632 = cute.make_view(%tup_6631) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6633 = cute.get_iter(%view_6632) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6634, %e1_6635, %e2_6636, %e3_6637 = cute.get_leaves(%iter_6633) : !cute.int_tuple<"(?,?,?,?)">
      %2682 = cute.get_scalars(%e0_6634) : !cute.int_tuple<"?">
      %2683 = cute.get_scalars(%e1_6635) : !cute.int_tuple<"?">
      %2684 = cute.get_scalars(%e2_6636) : !cute.int_tuple<"?">
      %2685 = cute.get_scalars(%e3_6637) : !cute.int_tuple<"?">
      %iter_6638 = cute.get_iter(%view_6632) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6639, %e1_6640, %e2_6641, %e3_6642 = cute.get_leaves(%iter_6638) : !cute.int_tuple<"(?,?,?,?)">
      %2686 = cute.get_scalars(%e0_6639) : !cute.int_tuple<"?">
      %2687 = cute.get_scalars(%e1_6640) : !cute.int_tuple<"?">
      %2688 = cute.get_scalars(%e2_6641) : !cute.int_tuple<"?">
      %2689 = cute.get_scalars(%e3_6642) : !cute.int_tuple<"?">
      %iter_6643 = cute.get_iter(%view_6632) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6644, %e1_6645, %e2_6646, %e3_6647 = cute.get_leaves(%iter_6643) : !cute.int_tuple<"(?,?,?,?)">
      %2690 = cute.get_scalars(%e0_6644) : !cute.int_tuple<"?">
      %2691 = cute.get_scalars(%e1_6645) : !cute.int_tuple<"?">
      %2692 = cute.get_scalars(%e2_6646) : !cute.int_tuple<"?">
      %2693 = cute.get_scalars(%e3_6647) : !cute.int_tuple<"?">
      %int_tuple_6648 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6649 = cute.add_offset(%e3_6647, %int_tuple_6648) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2694 = cute.get_scalars(%tup_6649) : !cute.int_tuple<"?">
      %coord_6650 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6651 = cute.make_coord(%tup_6649) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2695 = cute.get_scalars(%coord_6650) : !cute.coord<"?">
      %2696 = cute.get_scalars(%coord_6651) : !cute.coord<"?">
      %true_6652 = arith.constant true
      %2697 = arith.cmpi slt, %2695, %2696 : i32
      %2698 = arith.andi %true_6652, %2697 : i1
      %lay_6653 = cute.get_layout(%2679) : !memref_rmem_f32_4
      %2699 = cute.get_shape(%lay_6653) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6654, %e1_6655, %e2_6656, %e3_6657 = cute.get_leaves(%2699) : !cute.shape<"((2,2),(2,8))">
      %2700 = cute.get_stride(%lay_6653) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6658, %e1_6659, %e2_6660, %e3_6661 = cute.get_leaves(%2700) : !cute.stride<"((2,4),(1,8))">
      %2701 = scf.if %2698 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2679) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,13)">
        cute.memref.store(%2679, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,13)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2679) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2679 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2679) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2679) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2679 : !memref_rmem_f32_4
      }
      %iter_6662 = cute.get_iter(%2701) : !memref_rmem_f32_4
      %lay_6663 = cute.get_layout(%2701) : !memref_rmem_f32_4
      %2702 = cute.get_shape(%lay_6663) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6664, %e1_6665, %e2_6666, %e3_6667 = cute.get_leaves(%2702) : !cute.shape<"((2,2),(2,8))">
      %2703 = cute.get_stride(%lay_6663) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6668, %e1_6669, %e2_6670, %e3_6671 = cute.get_leaves(%2703) : !cute.stride<"((2,4),(1,8))">
      %iter_6672 = cute.get_iter(%2701) : !memref_rmem_f32_4
      %iter_6673 = cute.get_iter(%2701) : !memref_rmem_f32_4
      %coord_6674 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_6675 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6676 = cute.crd2idx(%coord_6674, %lay_6675) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_6677 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6678 = cute.add_offset(%iter_6677, %idx_6676) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6679 = cute.make_view(%tup_6678) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6680 = cute.get_iter(%view_6679) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6681, %e1_6682, %e2_6683, %e3_6684 = cute.get_leaves(%iter_6680) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2704 = cute.get_scalars(%e0_6681) : !cute.int_tuple<"?">
      %2705 = cute.get_scalars(%e1_6682) : !cute.int_tuple<"?">
      %2706 = cute.get_scalars(%e2_6683) : !cute.int_tuple<"?">
      %2707 = cute.get_scalars(%e3_6684) : !cute.int_tuple<"?{div=2}">
      %iter_6685 = cute.get_iter(%view_6679) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6686, %e1_6687, %e2_6688, %e3_6689 = cute.get_leaves(%iter_6685) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2708 = cute.get_scalars(%e0_6686) : !cute.int_tuple<"?">
      %2709 = cute.get_scalars(%e1_6687) : !cute.int_tuple<"?">
      %2710 = cute.get_scalars(%e2_6688) : !cute.int_tuple<"?">
      %2711 = cute.get_scalars(%e3_6689) : !cute.int_tuple<"?{div=2}">
      %iter_6690 = cute.get_iter(%view_6679) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6691, %e1_6692, %e2_6693, %e3_6694 = cute.get_leaves(%iter_6690) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %2712 = cute.get_scalars(%e0_6691) : !cute.int_tuple<"?">
      %2713 = cute.get_scalars(%e1_6692) : !cute.int_tuple<"?">
      %2714 = cute.get_scalars(%e2_6693) : !cute.int_tuple<"?">
      %2715 = cute.get_scalars(%e3_6694) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6695 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6696 = cute.add_offset(%e3_6694, %int_tuple_6695) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2716 = cute.get_scalars(%tup_6696) : !cute.int_tuple<"?">
      %coord_6697 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6698 = cute.make_coord(%tup_6696) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2717 = cute.get_scalars(%coord_6697) : !cute.coord<"?">
      %2718 = cute.get_scalars(%coord_6698) : !cute.coord<"?">
      %true_6699 = arith.constant true
      %2719 = arith.cmpi slt, %2717, %2718 : i32
      %2720 = arith.andi %true_6699, %2719 : i1
      %lay_6700 = cute.get_layout(%2701) : !memref_rmem_f32_4
      %2721 = cute.get_shape(%lay_6700) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6701, %e1_6702, %e2_6703, %e3_6704 = cute.get_leaves(%2721) : !cute.shape<"((2,2),(2,8))">
      %2722 = cute.get_stride(%lay_6700) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6705, %e1_6706, %e2_6707, %e3_6708 = cute.get_leaves(%2722) : !cute.stride<"((2,4),(1,8))">
      %2723 = scf.if %2720 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2701) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,14)">
        cute.memref.store(%2701, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,14)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2701) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2701 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2701) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2701) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2701 : !memref_rmem_f32_4
      }
      %iter_6709 = cute.get_iter(%2723) : !memref_rmem_f32_4
      %lay_6710 = cute.get_layout(%2723) : !memref_rmem_f32_4
      %2724 = cute.get_shape(%lay_6710) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6711, %e1_6712, %e2_6713, %e3_6714 = cute.get_leaves(%2724) : !cute.shape<"((2,2),(2,8))">
      %2725 = cute.get_stride(%lay_6710) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6715, %e1_6716, %e2_6717, %e3_6718 = cute.get_leaves(%2725) : !cute.stride<"((2,4),(1,8))">
      %iter_6719 = cute.get_iter(%2723) : !memref_rmem_f32_4
      %iter_6720 = cute.get_iter(%2723) : !memref_rmem_f32_4
      %coord_6721 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_6722 = cute.get_layout(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6723 = cute.crd2idx(%coord_6721, %lay_6722) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_6724 = cute.get_iter(%view_3622) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6725 = cute.add_offset(%iter_6724, %idx_6723) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6726 = cute.make_view(%tup_6725) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6727 = cute.get_iter(%view_6726) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6728, %e1_6729, %e2_6730, %e3_6731 = cute.get_leaves(%iter_6727) : !cute.int_tuple<"(?,?,?,?)">
      %2726 = cute.get_scalars(%e0_6728) : !cute.int_tuple<"?">
      %2727 = cute.get_scalars(%e1_6729) : !cute.int_tuple<"?">
      %2728 = cute.get_scalars(%e2_6730) : !cute.int_tuple<"?">
      %2729 = cute.get_scalars(%e3_6731) : !cute.int_tuple<"?">
      %iter_6732 = cute.get_iter(%view_6726) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6733, %e1_6734, %e2_6735, %e3_6736 = cute.get_leaves(%iter_6732) : !cute.int_tuple<"(?,?,?,?)">
      %2730 = cute.get_scalars(%e0_6733) : !cute.int_tuple<"?">
      %2731 = cute.get_scalars(%e1_6734) : !cute.int_tuple<"?">
      %2732 = cute.get_scalars(%e2_6735) : !cute.int_tuple<"?">
      %2733 = cute.get_scalars(%e3_6736) : !cute.int_tuple<"?">
      %iter_6737 = cute.get_iter(%view_6726) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6738, %e1_6739, %e2_6740, %e3_6741 = cute.get_leaves(%iter_6737) : !cute.int_tuple<"(?,?,?,?)">
      %2734 = cute.get_scalars(%e0_6738) : !cute.int_tuple<"?">
      %2735 = cute.get_scalars(%e1_6739) : !cute.int_tuple<"?">
      %2736 = cute.get_scalars(%e2_6740) : !cute.int_tuple<"?">
      %2737 = cute.get_scalars(%e3_6741) : !cute.int_tuple<"?">
      %int_tuple_6742 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6743 = cute.add_offset(%e3_6741, %int_tuple_6742) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2738 = cute.get_scalars(%tup_6743) : !cute.int_tuple<"?">
      %coord_6744 = cute.make_coord(%itup_3507) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6745 = cute.make_coord(%tup_6743) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2739 = cute.get_scalars(%coord_6744) : !cute.coord<"?">
      %2740 = cute.get_scalars(%coord_6745) : !cute.coord<"?">
      %true_6746 = arith.constant true
      %2741 = arith.cmpi slt, %2739, %2740 : i32
      %2742 = arith.andi %true_6746, %2741 : i1
      %lay_6747 = cute.get_layout(%2723) : !memref_rmem_f32_4
      %2743 = cute.get_shape(%lay_6747) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6748, %e1_6749, %e2_6750, %e3_6751 = cute.get_leaves(%2743) : !cute.shape<"((2,2),(2,8))">
      %2744 = cute.get_stride(%lay_6747) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6752, %e1_6753, %e2_6754, %e3_6755 = cute.get_leaves(%2744) : !cute.stride<"((2,4),(1,8))">
      %2745 = scf.if %2742 -> (!memref_rmem_f32_4) {
        %iter_8604 = cute.get_iter(%2723) : !memref_rmem_f32_4
        %cst_8605 = arith.constant 0xFF800000 : f32
        %coord_8606 = cute.make_coord() : () -> !cute.coord<"(3,15)">
        cute.memref.store(%2723, %coord_8606, %cst_8605) : (!memref_rmem_f32_4, !cute.coord<"(3,15)">, f32) -> ()
        %lay_8607 = cute.get_layout(%2723) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8608, %e1_8609, %e2_8610, %e3_8611 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8607) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8612, %e1_8613, %e2_8614, %e3_8615 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2723 : !memref_rmem_f32_4
      } else {
        %iter_8604 = cute.get_iter(%2723) : !memref_rmem_f32_4
        %lay_8605 = cute.get_layout(%2723) : !memref_rmem_f32_4
        %3378 = cute.get_shape(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_8606, %e1_8607, %e2_8608, %e3_8609 = cute.get_leaves(%3378) : !cute.shape<"((2,2),(2,8))">
        %3379 = cute.get_stride(%lay_8605) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_8610, %e1_8611, %e2_8612, %e3_8613 = cute.get_leaves(%3379) : !cute.stride<"((2,4),(1,8))">
        scf.yield %2723 : !memref_rmem_f32_4
      }
      %iter_6756 = cute.get_iter(%2745) : !memref_rmem_f32_4
      %lay_6757 = cute.get_layout(%2745) : !memref_rmem_f32_4
      %2746 = cute.get_shape(%lay_6757) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6758, %e1_6759, %e2_6760, %e3_6761 = cute.get_leaves(%2746) : !cute.shape<"((2,2),(2,8))">
      %2747 = cute.get_stride(%lay_6757) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6762, %e1_6763, %e2_6764, %e3_6765 = cute.get_leaves(%2747) : !cute.stride<"((2,4),(1,8))">
      %iter_6766 = cute.get_iter(%2745) : !memref_rmem_f32_4
      %iter_6767 = cute.get_iter(%2745) : !memref_rmem_f32_4
      %coord_6768 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6769 = cute.get_layout(%2745) : !memref_rmem_f32_4
      %idx_6770 = cute.crd2idx(%coord_6768, %lay_6769) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6771 = cute.get_iter(%2745) : !memref_rmem_f32_4
      %ptr_6772 = cute.add_offset(%iter_6771, %idx_6770) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6773 = cute.make_view(%ptr_6772) : !memref_rmem_f32_7
      %iter_6774 = cute.get_iter(%view_6773) : !memref_rmem_f32_7
      %iter_6775 = cute.get_iter(%view_6773) : !memref_rmem_f32_7
      %lay_6776 = cute.get_layout(%view_6773) : !memref_rmem_f32_7
      %2748 = cute.get_shape(%lay_6776) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6777, %e1_6778 = cute.get_leaves(%2748) : !cute.shape<"((2,8))">
      %2749 = cute.memref.load_vec %view_6773 : !memref_rmem_f32_7
      %cst_6779 = arith.constant 0xFF800000 : f32
      %2750 = vector.reduction <maximumf>, %2749, %cst_6779 : vector<16xf32> into f32
      %c-1_i32_6780 = arith.constant -1 : i32
      %c2_i32_6781 = arith.constant 2 : i32
      %c31_i32_6782 = arith.constant 31 : i32
      %2751 = nvvm.shfl.sync  bfly %c-1_i32_6780, %2750, %c2_i32_6781, %c31_i32_6782 : f32 -> f32
      %2752 = nvvm.fmax %2750, %2751
      %c-1_i32_6783 = arith.constant -1 : i32
      %c1_i32_6784 = arith.constant 1 : i32
      %c31_i32_6785 = arith.constant 31 : i32
      %2753 = nvvm.shfl.sync  bfly %c-1_i32_6783, %2752, %c1_i32_6784, %c31_i32_6785 : f32 -> f32
      %2754 = nvvm.fmax %2752, %2753
      %2755 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2756 = arith.mulf %2749, %2755 : vector<16xf32>
      %2757 = arith.mulf %2754, %arg4 : f32
      %2758 = vector.broadcast %2757 : f32 to vector<16xf32>
      %2759 = arith.subf %2756, %2758 : vector<16xf32>
      %2760 = math.exp2 %2759 fastmath<fast> : vector<16xf32>
      %cst_6786 = arith.constant 0.000000e+00 : f32
      %2761 = vector.reduction <add>, %2760, %cst_6786 : vector<16xf32> into f32
      %coord_6787 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1595, %coord_6787, %2754) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6788 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1600, %coord_6788, %2761) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6789 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6790 = cute.get_layout(%2745) : !memref_rmem_f32_4
      %idx_6791 = cute.crd2idx(%coord_6789, %lay_6790) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6792 = cute.get_iter(%2745) : !memref_rmem_f32_4
      %ptr_6793 = cute.add_offset(%iter_6792, %idx_6791) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6794 = cute.make_view(%ptr_6793) : !memref_rmem_f32_7
      %iter_6795 = cute.get_iter(%view_6794) : !memref_rmem_f32_7
      %iter_6796 = cute.get_iter(%view_6794) : !memref_rmem_f32_7
      %lay_6797 = cute.get_layout(%view_6794) : !memref_rmem_f32_7
      %2762 = cute.get_shape(%lay_6797) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6798, %e1_6799 = cute.get_leaves(%2762) : !cute.shape<"((2,8))">
      %int_tuple_6800 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6801 = cute.size(%int_tuple_6800) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6802 = cute.get_leaves(%sz_6801) : !cute.int_tuple<"16">
      %int_tuple_6803 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6804 = cute.size(%int_tuple_6803) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6805 = cute.get_leaves(%sz_6804) : !cute.int_tuple<"16">
      cute.memref.store_vec %2760, %view_6794 : !memref_rmem_f32_7
      %lay_6806 = cute.get_layout(%rmem_1636) : !memref_rmem_f32_2
      %lay_6807 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_6808 = cute.memref.alloca(%lay_6807) : !memref_rmem_bf16_16
      %iter_6809 = cute.get_iter(%rmem_6808) : !memref_rmem_bf16_16
      %iter_6810 = cute.get_iter(%rmem_6808) : !memref_rmem_bf16_16
      %2763 = cute.memref.load_vec %rmem_1636 : !memref_rmem_f32_2
      %2764 = arith.truncf %2763 : vector<64xf32> to vector<64xbf16>
      %lay_6811 = cute.get_layout(%rmem_6808) : !memref_rmem_bf16_16
      %2765 = cute.get_shape(%lay_6811) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_6812, %e1_6813, %e2_6814, %e3_6815 = cute.get_leaves(%2765) : !cute.shape<"((2,2),2,8)">
      %int_tuple_6816 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6817 = cute.size(%int_tuple_6816) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6818 = cute.get_leaves(%sz_6817) : !cute.int_tuple<"64">
      %int_tuple_6819 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6820 = cute.size(%int_tuple_6819) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6821 = cute.get_leaves(%sz_6820) : !cute.int_tuple<"64">
      cute.memref.store_vec %2764, %rmem_6808 : !memref_rmem_bf16_16
      %lay_6822 = cute.get_layout(%rmem_6808) : !memref_rmem_bf16_16
      %tile_6823 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
      %lay_6824 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
      %2766 = cute.get_shape(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6825, %e1_6826, %e2_6827, %e3_6828, %e4_6829 = cute.get_leaves(%2766) : !cute.shape<"((2,2),2,(2,4))">
      %2767 = cute.get_shape(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6830, %e1_6831, %e2_6832, %e3_6833, %e4_6834 = cute.get_leaves(%2767) : !cute.shape<"((2,2),2,(2,4))">
      %2768 = cute.get_shape(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6835, %e1_6836, %e2_6837, %e3_6838, %e4_6839 = cute.get_leaves(%2768) : !cute.shape<"((2,2),2,(2,4))">
      %2769 = cute.get_shape(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6840, %e1_6841, %e2_6842, %e3_6843, %e4_6844 = cute.get_leaves(%2769) : !cute.shape<"((2,2),2,(2,4))">
      %2770 = cute.get_stride(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6845, %e1_6846, %e2_6847, %e3_6848, %e4_6849 = cute.get_leaves(%2770) : !cute.stride<"((1,2),4,(8,16))">
      %2771 = cute.get_stride(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6850, %e1_6851, %e2_6852, %e3_6853, %e4_6854 = cute.get_leaves(%2771) : !cute.stride<"((1,2),4,(8,16))">
      %2772 = cute.get_stride(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6855, %e1_6856, %e2_6857, %e3_6858, %e4_6859 = cute.get_leaves(%2772) : !cute.stride<"((1,2),4,(8,16))">
      %2773 = cute.get_stride(%lay_6824) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6860, %e1_6861, %e2_6862, %e3_6863, %e4_6864 = cute.get_leaves(%2773) : !cute.stride<"((1,2),4,(8,16))">
      %shape_6865 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
      %stride_6866 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
      %lay_6867 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
      %view_6868 = cute.make_view(%iter_6810, %lay_6867) : !memref_rmem_bf16_17
      %iter_6869 = cute.get_iter(%view_6868) : !memref_rmem_bf16_17
      %coord_6870 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6871 = cute.get_layout(%view_862) : !memref_smem_bf16_10
      %2774:2 = cute.get_scalars(%lay_6871) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_6872 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_6873 = cute.assume(%2774#0) : (i32) -> !cute.i32<divby 16>
      %iv_6874 = cute.assume(%2774#1) : (i32) -> !cute.i32<divby 32>
      %stride_6875 = cute.make_stride(%iv_6873, %iv_6874) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_6876 = cute.make_layout(%shape_6872, %stride_6875) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_6877 = cute.crd2idx(%coord_6870, %lay_6871) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6878 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %ptr_6879 = cute.add_offset(%iter_6878, %idx_6877) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6880 = cute.make_view(%ptr_6879, %lay_6876) : !memref_smem_bf16_19
      %iter_6881 = cute.get_iter(%view_6880) : !memref_smem_bf16_19
      %iter_6882 = cute.get_iter(%view_6880) : !memref_smem_bf16_19
      %coord_6883 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6884 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
      %idx_6885 = cute.crd2idx(%coord_6883, %lay_6884) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6886 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %ptr_6887 = cute.add_offset(%iter_6886, %idx_6885) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6888 = cute.make_view(%ptr_6887) : !memref_rmem_bf16_18
      %iter_6889 = cute.get_iter(%view_6888) : !memref_rmem_bf16_18
      %iter_6890 = cute.get_iter(%view_6888) : !memref_rmem_bf16_18
      %lay_6891 = cute.get_layout(%view_6880) : !memref_smem_bf16_19
      %2775 = cute.get_shape(%lay_6891) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6892, %e1_6893, %e2_6894, %e3_6895, %e4_6896 = cute.get_leaves(%2775) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6897 = cute.get_layout(%view_6888) : !memref_rmem_bf16_18
      %2776 = cute.get_shape(%lay_6897) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6898, %e1_6899, %e2_6900, %e3_6901 = cute.get_leaves(%2776) : !cute.shape<"((8,1),(4,2))">
      %lay_6902 = cute.get_layout(%view_6880) : !memref_smem_bf16_19
      %shape_6903 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6904 = cute.make_layout() : !cute.layout<"1:0">
      %append_6905 = cute.append_to_rank<2> (%lay_6902, %lay_6904) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6906 = cute.make_view(%iter_6882, %append_6905) : !memref_smem_bf16_19
      %iter_6907 = cute.get_iter(%view_6906) : !memref_smem_bf16_19
      %lay_6908 = cute.get_layout(%view_6906) : !memref_smem_bf16_19
      %2777 = cute.get_shape(%lay_6908) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6909, %e1_6910, %e2_6911, %e3_6912, %e4_6913 = cute.get_leaves(%2777) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6914 = cute.get_iter(%view_6906) : !memref_smem_bf16_19
      %lay_6915 = cute.get_layout(%view_6906) : !memref_smem_bf16_19
      %2778:2 = cute.get_scalars(%lay_6915) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6916 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6917 = cute.assume(%2778#0) : (i32) -> !cute.i32<divby 16>
      %iv_6918 = cute.assume(%2778#1) : (i32) -> !cute.i32<divby 32>
      %stride_6919 = cute.make_stride(%iv_6917, %iv_6918) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6920 = cute.make_layout(%shape_6916, %stride_6919) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6921 = cute.make_view(%iter_6914, %lay_6920) : !memref_smem_bf16_20
      %iter_6922 = cute.get_iter(%view_6921) : !memref_smem_bf16_20
      %iter_6923 = cute.get_iter(%view_6921) : !memref_smem_bf16_20
      %lay_6924 = cute.get_layout(%view_6888) : !memref_rmem_bf16_18
      %shape_6925 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6926 = cute.make_layout() : !cute.layout<"1:0">
      %append_6927 = cute.append_to_rank<2> (%lay_6924, %lay_6926) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6928 = cute.make_view(%iter_6890, %append_6927) : !memref_rmem_bf16_18
      %iter_6929 = cute.get_iter(%view_6928) : !memref_rmem_bf16_18
      %lay_6930 = cute.get_layout(%view_6928) : !memref_rmem_bf16_18
      %2779 = cute.get_shape(%lay_6930) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6931, %e1_6932, %e2_6933, %e3_6934 = cute.get_leaves(%2779) : !cute.shape<"((8,1),(4,2))">
      %iter_6935 = cute.get_iter(%view_6928) : !memref_rmem_bf16_18
      %view_6936 = cute.make_view(%iter_6935) : !memref_rmem_bf16_19
      %iter_6937 = cute.get_iter(%view_6936) : !memref_rmem_bf16_19
      %iter_6938 = cute.get_iter(%view_6936) : !memref_rmem_bf16_19
      %lay_6939 = cute.get_layout(%view_6921) : !memref_smem_bf16_20
      %2780 = cute.get_shape(%lay_6939) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6940, %e1_6941, %e2_6942, %e3_6943, %e4_6944 = cute.get_leaves(%2780) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6945 = cute.get_layout(%view_6936) : !memref_rmem_bf16_19
      %2781 = cute.get_shape(%lay_6945) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6946, %e1_6947, %e2_6948, %e3_6949 = cute.get_leaves(%2781) : !cute.shape<"((8,1),((4,2)))">
      %lay_6950 = cute.get_layout(%view_6921) : !memref_smem_bf16_20
      %sz_6951 = cute.size(%lay_6950) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6952 = cute.get_leaves(%sz_6951) : !cute.int_tuple<"8">
      %lay_6953 = cute.get_layout(%view_6936) : !memref_rmem_bf16_19
      %sz_6954 = cute.size(%lay_6953) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6955 = cute.get_leaves(%sz_6954) : !cute.int_tuple<"8">
      %2782 = cute.static : !cute.layout<"1:0">
      %iter_6956 = cute.get_iter(%view_6921) : !memref_smem_bf16_20
      %iter_6957 = cute.get_iter(%view_6936) : !memref_rmem_bf16_19
      %lay_6958 = cute.get_layout(%view_6921) : !memref_smem_bf16_20
      %lay_6959 = cute.get_layout(%view_6936) : !memref_rmem_bf16_19
      %append_6960 = cute.append_to_rank<2> (%lay_6958, %2782) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6961 = cute.append_to_rank<2> (%lay_6959, %2782) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2783:2 = cute.get_scalars(%append_6960) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6962 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6963 = cute.assume(%2783#0) : (i32) -> !cute.i32<divby 16>
      %iv_6964 = cute.assume(%2783#1) : (i32) -> !cute.i32<divby 32>
      %stride_6965 = cute.make_stride(%iv_6963, %iv_6964) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6966 = cute.make_layout(%shape_6962, %stride_6965) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6967 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6968 = cute.size(%lay_6966) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2784 = cute.get_scalars(%sz_6968) : !cute.int_tuple<"8">
      %c0_i32_6969 = arith.constant 0 : i32
      %c1_i32_6970 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6969 to %2784 step %c1_i32_6970  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378:2 = cute.get_scalars(%lay_6966) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_6966) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8607 = cute.add_offset(%iter_6956, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_6967) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_6957, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3381 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3382 = llvm.mlir.constant(0 : i32) : i32
        %3383 = vector.extractelement %3381[%3382 : i32] : vector<4xi32>
        %3384 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
        %3385 = llvm.mlir.constant(1 : i32) : i32
        %3386 = vector.extractelement %3381[%3385 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3387 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3386, %3387 : i32, !llvm.ptr
        %3388 = llvm.mlir.constant(2 : i32) : i32
        %3389 = vector.extractelement %3381[%3388 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3390 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3389, %3390 : i32, !llvm.ptr
        %3391 = llvm.mlir.constant(3 : i32) : i32
        %3392 = vector.extractelement %3381[%3391 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3393 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3392, %3393 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_6971 = cute.get_layout(%view_6868) : !memref_rmem_bf16_17
      %2785 = cute.get_shape(%lay_6971) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
      %e0_6972, %e1_6973, %e2_6974, %e3_6975, %e4_6976 = cute.get_leaves(%2785) : !cute.shape<"(((2,2),2),2,4)">
      %int_tuple_6977 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6978 = cute.size(%int_tuple_6977) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6979 = cute.get_leaves(%sz_6978) : !cute.int_tuple<"4">
      %int_tuple_6980 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6981 = cute.size(%int_tuple_6980) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6982 = cute.get_leaves(%sz_6981) : !cute.int_tuple<"4">
      %coord_6983 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6984 = cute.get_layout(%view_862) : !memref_smem_bf16_10
      %2786:2 = cute.get_scalars(%lay_6984) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_6985 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_6986 = cute.assume(%2786#0) : (i32) -> !cute.i32<divby 16>
      %iv_6987 = cute.assume(%2786#1) : (i32) -> !cute.i32<divby 32>
      %stride_6988 = cute.make_stride(%iv_6986, %iv_6987) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_6989 = cute.make_layout(%shape_6985, %stride_6988) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_6990 = cute.crd2idx(%coord_6983, %lay_6984) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
      %iter_6991 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %ptr_6992 = cute.add_offset(%iter_6991, %idx_6990) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6993 = cute.make_view(%ptr_6992, %lay_6989) : !memref_smem_bf16_19
      %iter_6994 = cute.get_iter(%view_6993) : !memref_smem_bf16_19
      %iter_6995 = cute.get_iter(%view_6993) : !memref_smem_bf16_19
      %coord_6996 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6997 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
      %idx_6998 = cute.crd2idx(%coord_6996, %lay_6997) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
      %iter_6999 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %ptr_7000 = cute.add_offset(%iter_6999, %idx_6998) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7001 = cute.make_view(%ptr_7000) : !memref_rmem_bf16_18
      %iter_7002 = cute.get_iter(%view_7001) : !memref_rmem_bf16_18
      %iter_7003 = cute.get_iter(%view_7001) : !memref_rmem_bf16_18
      %lay_7004 = cute.get_layout(%view_6993) : !memref_smem_bf16_19
      %2787 = cute.get_shape(%lay_7004) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7005, %e1_7006, %e2_7007, %e3_7008, %e4_7009 = cute.get_leaves(%2787) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7010 = cute.get_layout(%view_7001) : !memref_rmem_bf16_18
      %2788 = cute.get_shape(%lay_7010) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7011, %e1_7012, %e2_7013, %e3_7014 = cute.get_leaves(%2788) : !cute.shape<"((8,1),(4,2))">
      %lay_7015 = cute.get_layout(%view_6993) : !memref_smem_bf16_19
      %shape_7016 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7017 = cute.make_layout() : !cute.layout<"1:0">
      %append_7018 = cute.append_to_rank<2> (%lay_7015, %lay_7017) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7019 = cute.make_view(%iter_6995, %append_7018) : !memref_smem_bf16_19
      %iter_7020 = cute.get_iter(%view_7019) : !memref_smem_bf16_19
      %lay_7021 = cute.get_layout(%view_7019) : !memref_smem_bf16_19
      %2789 = cute.get_shape(%lay_7021) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7022, %e1_7023, %e2_7024, %e3_7025, %e4_7026 = cute.get_leaves(%2789) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7027 = cute.get_iter(%view_7019) : !memref_smem_bf16_19
      %lay_7028 = cute.get_layout(%view_7019) : !memref_smem_bf16_19
      %2790:2 = cute.get_scalars(%lay_7028) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7029 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7030 = cute.assume(%2790#0) : (i32) -> !cute.i32<divby 16>
      %iv_7031 = cute.assume(%2790#1) : (i32) -> !cute.i32<divby 32>
      %stride_7032 = cute.make_stride(%iv_7030, %iv_7031) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7033 = cute.make_layout(%shape_7029, %stride_7032) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7034 = cute.make_view(%iter_7027, %lay_7033) : !memref_smem_bf16_20
      %iter_7035 = cute.get_iter(%view_7034) : !memref_smem_bf16_20
      %iter_7036 = cute.get_iter(%view_7034) : !memref_smem_bf16_20
      %lay_7037 = cute.get_layout(%view_7001) : !memref_rmem_bf16_18
      %shape_7038 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7039 = cute.make_layout() : !cute.layout<"1:0">
      %append_7040 = cute.append_to_rank<2> (%lay_7037, %lay_7039) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7041 = cute.make_view(%iter_7003, %append_7040) : !memref_rmem_bf16_18
      %iter_7042 = cute.get_iter(%view_7041) : !memref_rmem_bf16_18
      %lay_7043 = cute.get_layout(%view_7041) : !memref_rmem_bf16_18
      %2791 = cute.get_shape(%lay_7043) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7044, %e1_7045, %e2_7046, %e3_7047 = cute.get_leaves(%2791) : !cute.shape<"((8,1),(4,2))">
      %iter_7048 = cute.get_iter(%view_7041) : !memref_rmem_bf16_18
      %view_7049 = cute.make_view(%iter_7048) : !memref_rmem_bf16_19
      %iter_7050 = cute.get_iter(%view_7049) : !memref_rmem_bf16_19
      %iter_7051 = cute.get_iter(%view_7049) : !memref_rmem_bf16_19
      %lay_7052 = cute.get_layout(%view_7034) : !memref_smem_bf16_20
      %2792 = cute.get_shape(%lay_7052) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7053, %e1_7054, %e2_7055, %e3_7056, %e4_7057 = cute.get_leaves(%2792) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7058 = cute.get_layout(%view_7049) : !memref_rmem_bf16_19
      %2793 = cute.get_shape(%lay_7058) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7059, %e1_7060, %e2_7061, %e3_7062 = cute.get_leaves(%2793) : !cute.shape<"((8,1),((4,2)))">
      %lay_7063 = cute.get_layout(%view_7034) : !memref_smem_bf16_20
      %sz_7064 = cute.size(%lay_7063) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7065 = cute.get_leaves(%sz_7064) : !cute.int_tuple<"8">
      %lay_7066 = cute.get_layout(%view_7049) : !memref_rmem_bf16_19
      %sz_7067 = cute.size(%lay_7066) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7068 = cute.get_leaves(%sz_7067) : !cute.int_tuple<"8">
      %2794 = cute.static : !cute.layout<"1:0">
      %iter_7069 = cute.get_iter(%view_7034) : !memref_smem_bf16_20
      %iter_7070 = cute.get_iter(%view_7049) : !memref_rmem_bf16_19
      %lay_7071 = cute.get_layout(%view_7034) : !memref_smem_bf16_20
      %lay_7072 = cute.get_layout(%view_7049) : !memref_rmem_bf16_19
      %append_7073 = cute.append_to_rank<2> (%lay_7071, %2794) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7074 = cute.append_to_rank<2> (%lay_7072, %2794) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2795:2 = cute.get_scalars(%append_7073) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7075 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7076 = cute.assume(%2795#0) : (i32) -> !cute.i32<divby 16>
      %iv_7077 = cute.assume(%2795#1) : (i32) -> !cute.i32<divby 32>
      %stride_7078 = cute.make_stride(%iv_7076, %iv_7077) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7079 = cute.make_layout(%shape_7075, %stride_7078) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7080 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7081 = cute.size(%lay_7079) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2796 = cute.get_scalars(%sz_7081) : !cute.int_tuple<"8">
      %c0_i32_7082 = arith.constant 0 : i32
      %c1_i32_7083 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7082 to %2796 step %c1_i32_7083  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378:2 = cute.get_scalars(%lay_7079) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_7079) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8607 = cute.add_offset(%iter_7069, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_7080) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_7070, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3381 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3382 = llvm.mlir.constant(0 : i32) : i32
        %3383 = vector.extractelement %3381[%3382 : i32] : vector<4xi32>
        %3384 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
        %3385 = llvm.mlir.constant(1 : i32) : i32
        %3386 = vector.extractelement %3381[%3385 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3387 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3386, %3387 : i32, !llvm.ptr
        %3388 = llvm.mlir.constant(2 : i32) : i32
        %3389 = vector.extractelement %3381[%3388 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3390 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3389, %3390 : i32, !llvm.ptr
        %3391 = llvm.mlir.constant(3 : i32) : i32
        %3392 = vector.extractelement %3381[%3391 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3393 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3392, %3393 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7084 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7085 = cute.get_layout(%view_6868) : !memref_rmem_bf16_17
      %idx_7086 = cute.crd2idx(%coord_7084, %lay_7085) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
      %iter_7087 = cute.get_iter(%view_6868) : !memref_rmem_bf16_17
      %ptr_7088 = cute.add_offset(%iter_7087, %idx_7086) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7089 = cute.make_view(%ptr_7088) : !memref_rmem_bf16_20
      %iter_7090 = cute.get_iter(%view_7089) : !memref_rmem_bf16_20
      %iter_7091 = cute.get_iter(%view_7089) : !memref_rmem_bf16_20
      %coord_7092 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7093 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
      %idx_7094 = cute.crd2idx(%coord_7092, %lay_7093) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
      %iter_7095 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %ptr_7096 = cute.add_offset(%iter_7095, %idx_7094) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7097 = cute.make_view(%ptr_7096) : !memref_rmem_bf16_21
      %iter_7098 = cute.get_iter(%view_7097) : !memref_rmem_bf16_21
      %iter_7099 = cute.get_iter(%view_7097) : !memref_rmem_bf16_21
      %lay_7100 = cute.get_layout(%view_7089) : !memref_rmem_bf16_20
      %2797 = cute.get_shape(%lay_7100) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7101, %e1_7102, %e2_7103, %e3_7104 = cute.get_leaves(%2797) : !cute.shape<"(((2,2),2),2)">
      %lay_7105 = cute.get_layout(%view_7097) : !memref_rmem_bf16_21
      %2798 = cute.get_shape(%lay_7105) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7106, %e1_7107, %e2_7108, %e3_7109 = cute.get_leaves(%2798) : !cute.shape<"((2,2),(8,2))">
      %lay_7110 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2799 = cute.get_shape(%lay_7110) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7111, %e1_7112, %e2_7113, %e3_7114 = cute.get_leaves(%2799) : !cute.shape<"((2,2),2,16)">
      %iter_7115 = cute.get_iter(%view_7089) : !memref_rmem_bf16_20
      %iter_7116 = cute.get_iter(%view_7097) : !memref_rmem_bf16_21
      %iter_7117 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %iter_7118 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %lay_7119 = cute.get_layout(%view_7089) : !memref_rmem_bf16_20
      %lay_7120 = cute.get_layout(%view_7097) : !memref_rmem_bf16_21
      %lay_7121 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7122 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2800 = cute.static : !cute.layout<"1:0">
      %append_7123 = cute.append_to_rank<3> (%lay_7119, %2800) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7124 = cute.append_to_rank<3> (%lay_7120, %2800) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7125 = cute.size(%append_7123) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7126 = cute.size(%append_7123) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7127 = cute.size(%append_7124) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2801 = cute.get_scalars(%sz_7125) : !cute.int_tuple<"1">
      %2802 = cute.get_scalars(%sz_7126) : !cute.int_tuple<"2">
      %2803 = cute.get_scalars(%sz_7127) : !cute.int_tuple<"16">
      %c0_i32_7128 = arith.constant 0 : i32
      %c1_i32_7129 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7128 to %2801 step %c1_i32_7129  : i32 {
        scf.for %arg6 = %c0_i32_7128 to %2802 step %c1_i32_7129  : i32 {
          scf.for %arg7 = %c0_i32_7128 to %2803 step %c1_i32_7129  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_7123) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8609 = cute.add_offset(%iter_7115, %idx_8608) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_22
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_7124) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_7116, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_7121) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_7117, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_7122) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_7118, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_22
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7130 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7131 = cute.size(%int_tuple_7130) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7132 = cute.get_leaves(%sz_7131) : !cute.int_tuple<"4">
      %coord_7133 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7134 = cute.get_layout(%view_862) : !memref_smem_bf16_10
      %2804:2 = cute.get_scalars(%lay_7134) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7135 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7136 = cute.assume(%2804#0) : (i32) -> !cute.i32<divby 16>
      %iv_7137 = cute.assume(%2804#1) : (i32) -> !cute.i32<divby 32>
      %stride_7138 = cute.make_stride(%iv_7136, %iv_7137) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7139 = cute.make_layout(%shape_7135, %stride_7138) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7140 = cute.crd2idx(%coord_7133, %lay_7134) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
      %iter_7141 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %ptr_7142 = cute.add_offset(%iter_7141, %idx_7140) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7143 = cute.make_view(%ptr_7142, %lay_7139) : !memref_smem_bf16_19
      %iter_7144 = cute.get_iter(%view_7143) : !memref_smem_bf16_19
      %iter_7145 = cute.get_iter(%view_7143) : !memref_smem_bf16_19
      %coord_7146 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7147 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
      %idx_7148 = cute.crd2idx(%coord_7146, %lay_7147) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
      %iter_7149 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %ptr_7150 = cute.add_offset(%iter_7149, %idx_7148) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7151 = cute.make_view(%ptr_7150) : !memref_rmem_bf16_18
      %iter_7152 = cute.get_iter(%view_7151) : !memref_rmem_bf16_18
      %iter_7153 = cute.get_iter(%view_7151) : !memref_rmem_bf16_18
      %lay_7154 = cute.get_layout(%view_7143) : !memref_smem_bf16_19
      %2805 = cute.get_shape(%lay_7154) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7155, %e1_7156, %e2_7157, %e3_7158, %e4_7159 = cute.get_leaves(%2805) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7160 = cute.get_layout(%view_7151) : !memref_rmem_bf16_18
      %2806 = cute.get_shape(%lay_7160) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7161, %e1_7162, %e2_7163, %e3_7164 = cute.get_leaves(%2806) : !cute.shape<"((8,1),(4,2))">
      %lay_7165 = cute.get_layout(%view_7143) : !memref_smem_bf16_19
      %shape_7166 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7167 = cute.make_layout() : !cute.layout<"1:0">
      %append_7168 = cute.append_to_rank<2> (%lay_7165, %lay_7167) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7169 = cute.make_view(%iter_7145, %append_7168) : !memref_smem_bf16_19
      %iter_7170 = cute.get_iter(%view_7169) : !memref_smem_bf16_19
      %lay_7171 = cute.get_layout(%view_7169) : !memref_smem_bf16_19
      %2807 = cute.get_shape(%lay_7171) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7172, %e1_7173, %e2_7174, %e3_7175, %e4_7176 = cute.get_leaves(%2807) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7177 = cute.get_iter(%view_7169) : !memref_smem_bf16_19
      %lay_7178 = cute.get_layout(%view_7169) : !memref_smem_bf16_19
      %2808:2 = cute.get_scalars(%lay_7178) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7179 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7180 = cute.assume(%2808#0) : (i32) -> !cute.i32<divby 16>
      %iv_7181 = cute.assume(%2808#1) : (i32) -> !cute.i32<divby 32>
      %stride_7182 = cute.make_stride(%iv_7180, %iv_7181) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7183 = cute.make_layout(%shape_7179, %stride_7182) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7184 = cute.make_view(%iter_7177, %lay_7183) : !memref_smem_bf16_20
      %iter_7185 = cute.get_iter(%view_7184) : !memref_smem_bf16_20
      %iter_7186 = cute.get_iter(%view_7184) : !memref_smem_bf16_20
      %lay_7187 = cute.get_layout(%view_7151) : !memref_rmem_bf16_18
      %shape_7188 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7189 = cute.make_layout() : !cute.layout<"1:0">
      %append_7190 = cute.append_to_rank<2> (%lay_7187, %lay_7189) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7191 = cute.make_view(%iter_7153, %append_7190) : !memref_rmem_bf16_18
      %iter_7192 = cute.get_iter(%view_7191) : !memref_rmem_bf16_18
      %lay_7193 = cute.get_layout(%view_7191) : !memref_rmem_bf16_18
      %2809 = cute.get_shape(%lay_7193) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7194, %e1_7195, %e2_7196, %e3_7197 = cute.get_leaves(%2809) : !cute.shape<"((8,1),(4,2))">
      %iter_7198 = cute.get_iter(%view_7191) : !memref_rmem_bf16_18
      %view_7199 = cute.make_view(%iter_7198) : !memref_rmem_bf16_19
      %iter_7200 = cute.get_iter(%view_7199) : !memref_rmem_bf16_19
      %iter_7201 = cute.get_iter(%view_7199) : !memref_rmem_bf16_19
      %lay_7202 = cute.get_layout(%view_7184) : !memref_smem_bf16_20
      %2810 = cute.get_shape(%lay_7202) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7203, %e1_7204, %e2_7205, %e3_7206, %e4_7207 = cute.get_leaves(%2810) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7208 = cute.get_layout(%view_7199) : !memref_rmem_bf16_19
      %2811 = cute.get_shape(%lay_7208) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7209, %e1_7210, %e2_7211, %e3_7212 = cute.get_leaves(%2811) : !cute.shape<"((8,1),((4,2)))">
      %lay_7213 = cute.get_layout(%view_7184) : !memref_smem_bf16_20
      %sz_7214 = cute.size(%lay_7213) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7215 = cute.get_leaves(%sz_7214) : !cute.int_tuple<"8">
      %lay_7216 = cute.get_layout(%view_7199) : !memref_rmem_bf16_19
      %sz_7217 = cute.size(%lay_7216) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7218 = cute.get_leaves(%sz_7217) : !cute.int_tuple<"8">
      %2812 = cute.static : !cute.layout<"1:0">
      %iter_7219 = cute.get_iter(%view_7184) : !memref_smem_bf16_20
      %iter_7220 = cute.get_iter(%view_7199) : !memref_rmem_bf16_19
      %lay_7221 = cute.get_layout(%view_7184) : !memref_smem_bf16_20
      %lay_7222 = cute.get_layout(%view_7199) : !memref_rmem_bf16_19
      %append_7223 = cute.append_to_rank<2> (%lay_7221, %2812) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7224 = cute.append_to_rank<2> (%lay_7222, %2812) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2813:2 = cute.get_scalars(%append_7223) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7225 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7226 = cute.assume(%2813#0) : (i32) -> !cute.i32<divby 16>
      %iv_7227 = cute.assume(%2813#1) : (i32) -> !cute.i32<divby 32>
      %stride_7228 = cute.make_stride(%iv_7226, %iv_7227) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7229 = cute.make_layout(%shape_7225, %stride_7228) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7230 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7231 = cute.size(%lay_7229) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2814 = cute.get_scalars(%sz_7231) : !cute.int_tuple<"8">
      %c0_i32_7232 = arith.constant 0 : i32
      %c1_i32_7233 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7232 to %2814 step %c1_i32_7233  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378:2 = cute.get_scalars(%lay_7229) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_7229) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8607 = cute.add_offset(%iter_7219, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_7230) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_7220, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3381 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3382 = llvm.mlir.constant(0 : i32) : i32
        %3383 = vector.extractelement %3381[%3382 : i32] : vector<4xi32>
        %3384 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
        %3385 = llvm.mlir.constant(1 : i32) : i32
        %3386 = vector.extractelement %3381[%3385 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3387 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3386, %3387 : i32, !llvm.ptr
        %3388 = llvm.mlir.constant(2 : i32) : i32
        %3389 = vector.extractelement %3381[%3388 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3390 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3389, %3390 : i32, !llvm.ptr
        %3391 = llvm.mlir.constant(3 : i32) : i32
        %3392 = vector.extractelement %3381[%3391 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3393 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3392, %3393 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7234 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_7235 = cute.get_layout(%view_6868) : !memref_rmem_bf16_17
      %idx_7236 = cute.crd2idx(%coord_7234, %lay_7235) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
      %iter_7237 = cute.get_iter(%view_6868) : !memref_rmem_bf16_17
      %ptr_7238 = cute.add_offset(%iter_7237, %idx_7236) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7239 = cute.make_view(%ptr_7238) : !memref_rmem_bf16_20
      %iter_7240 = cute.get_iter(%view_7239) : !memref_rmem_bf16_20
      %iter_7241 = cute.get_iter(%view_7239) : !memref_rmem_bf16_20
      %coord_7242 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_7243 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
      %idx_7244 = cute.crd2idx(%coord_7242, %lay_7243) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
      %iter_7245 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %ptr_7246 = cute.add_offset(%iter_7245, %idx_7244) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7247 = cute.make_view(%ptr_7246) : !memref_rmem_bf16_21
      %iter_7248 = cute.get_iter(%view_7247) : !memref_rmem_bf16_21
      %iter_7249 = cute.get_iter(%view_7247) : !memref_rmem_bf16_21
      %lay_7250 = cute.get_layout(%view_7239) : !memref_rmem_bf16_20
      %2815 = cute.get_shape(%lay_7250) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7251, %e1_7252, %e2_7253, %e3_7254 = cute.get_leaves(%2815) : !cute.shape<"(((2,2),2),2)">
      %lay_7255 = cute.get_layout(%view_7247) : !memref_rmem_bf16_21
      %2816 = cute.get_shape(%lay_7255) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7256, %e1_7257, %e2_7258, %e3_7259 = cute.get_leaves(%2816) : !cute.shape<"((2,2),(8,2))">
      %iter_7260 = cute.get_iter(%view_7239) : !memref_rmem_bf16_20
      %iter_7261 = cute.get_iter(%view_7247) : !memref_rmem_bf16_21
      %iter_7262 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %iter_7263 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %lay_7264 = cute.get_layout(%view_7239) : !memref_rmem_bf16_20
      %lay_7265 = cute.get_layout(%view_7247) : !memref_rmem_bf16_21
      %lay_7266 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7267 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2817 = cute.static : !cute.layout<"1:0">
      %append_7268 = cute.append_to_rank<3> (%lay_7264, %2817) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7269 = cute.append_to_rank<3> (%lay_7265, %2817) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7270 = cute.size(%append_7268) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7271 = cute.size(%append_7268) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7272 = cute.size(%append_7269) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2818 = cute.get_scalars(%sz_7270) : !cute.int_tuple<"1">
      %2819 = cute.get_scalars(%sz_7271) : !cute.int_tuple<"2">
      %2820 = cute.get_scalars(%sz_7272) : !cute.int_tuple<"16">
      %c0_i32_7273 = arith.constant 0 : i32
      %c1_i32_7274 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7273 to %2818 step %c1_i32_7274  : i32 {
        scf.for %arg6 = %c0_i32_7273 to %2819 step %c1_i32_7274  : i32 {
          scf.for %arg7 = %c0_i32_7273 to %2820 step %c1_i32_7274  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_7268) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8609 = cute.add_offset(%iter_7260, %idx_8608) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_22
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_7269) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_7261, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_7266) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_7262, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_7267) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_7263, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_22
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7275 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7276 = cute.size(%int_tuple_7275) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7277 = cute.get_leaves(%sz_7276) : !cute.int_tuple<"4">
      %coord_7278 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7279 = cute.get_layout(%view_862) : !memref_smem_bf16_10
      %2821:2 = cute.get_scalars(%lay_7279) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7280 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7281 = cute.assume(%2821#0) : (i32) -> !cute.i32<divby 16>
      %iv_7282 = cute.assume(%2821#1) : (i32) -> !cute.i32<divby 32>
      %stride_7283 = cute.make_stride(%iv_7281, %iv_7282) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7284 = cute.make_layout(%shape_7280, %stride_7283) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7285 = cute.crd2idx(%coord_7278, %lay_7279) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
      %iter_7286 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %ptr_7287 = cute.add_offset(%iter_7286, %idx_7285) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7288 = cute.make_view(%ptr_7287, %lay_7284) : !memref_smem_bf16_19
      %iter_7289 = cute.get_iter(%view_7288) : !memref_smem_bf16_19
      %iter_7290 = cute.get_iter(%view_7288) : !memref_smem_bf16_19
      %coord_7291 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7292 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
      %idx_7293 = cute.crd2idx(%coord_7291, %lay_7292) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
      %iter_7294 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %ptr_7295 = cute.add_offset(%iter_7294, %idx_7293) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7296 = cute.make_view(%ptr_7295) : !memref_rmem_bf16_18
      %iter_7297 = cute.get_iter(%view_7296) : !memref_rmem_bf16_18
      %iter_7298 = cute.get_iter(%view_7296) : !memref_rmem_bf16_18
      %lay_7299 = cute.get_layout(%view_7288) : !memref_smem_bf16_19
      %2822 = cute.get_shape(%lay_7299) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7300, %e1_7301, %e2_7302, %e3_7303, %e4_7304 = cute.get_leaves(%2822) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7305 = cute.get_layout(%view_7296) : !memref_rmem_bf16_18
      %2823 = cute.get_shape(%lay_7305) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7306, %e1_7307, %e2_7308, %e3_7309 = cute.get_leaves(%2823) : !cute.shape<"((8,1),(4,2))">
      %lay_7310 = cute.get_layout(%view_7288) : !memref_smem_bf16_19
      %shape_7311 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7312 = cute.make_layout() : !cute.layout<"1:0">
      %append_7313 = cute.append_to_rank<2> (%lay_7310, %lay_7312) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7314 = cute.make_view(%iter_7290, %append_7313) : !memref_smem_bf16_19
      %iter_7315 = cute.get_iter(%view_7314) : !memref_smem_bf16_19
      %lay_7316 = cute.get_layout(%view_7314) : !memref_smem_bf16_19
      %2824 = cute.get_shape(%lay_7316) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7317, %e1_7318, %e2_7319, %e3_7320, %e4_7321 = cute.get_leaves(%2824) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7322 = cute.get_iter(%view_7314) : !memref_smem_bf16_19
      %lay_7323 = cute.get_layout(%view_7314) : !memref_smem_bf16_19
      %2825:2 = cute.get_scalars(%lay_7323) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7324 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7325 = cute.assume(%2825#0) : (i32) -> !cute.i32<divby 16>
      %iv_7326 = cute.assume(%2825#1) : (i32) -> !cute.i32<divby 32>
      %stride_7327 = cute.make_stride(%iv_7325, %iv_7326) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7328 = cute.make_layout(%shape_7324, %stride_7327) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7329 = cute.make_view(%iter_7322, %lay_7328) : !memref_smem_bf16_20
      %iter_7330 = cute.get_iter(%view_7329) : !memref_smem_bf16_20
      %iter_7331 = cute.get_iter(%view_7329) : !memref_smem_bf16_20
      %lay_7332 = cute.get_layout(%view_7296) : !memref_rmem_bf16_18
      %shape_7333 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7334 = cute.make_layout() : !cute.layout<"1:0">
      %append_7335 = cute.append_to_rank<2> (%lay_7332, %lay_7334) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7336 = cute.make_view(%iter_7298, %append_7335) : !memref_rmem_bf16_18
      %iter_7337 = cute.get_iter(%view_7336) : !memref_rmem_bf16_18
      %lay_7338 = cute.get_layout(%view_7336) : !memref_rmem_bf16_18
      %2826 = cute.get_shape(%lay_7338) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7339, %e1_7340, %e2_7341, %e3_7342 = cute.get_leaves(%2826) : !cute.shape<"((8,1),(4,2))">
      %iter_7343 = cute.get_iter(%view_7336) : !memref_rmem_bf16_18
      %view_7344 = cute.make_view(%iter_7343) : !memref_rmem_bf16_19
      %iter_7345 = cute.get_iter(%view_7344) : !memref_rmem_bf16_19
      %iter_7346 = cute.get_iter(%view_7344) : !memref_rmem_bf16_19
      %lay_7347 = cute.get_layout(%view_7329) : !memref_smem_bf16_20
      %2827 = cute.get_shape(%lay_7347) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7348, %e1_7349, %e2_7350, %e3_7351, %e4_7352 = cute.get_leaves(%2827) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7353 = cute.get_layout(%view_7344) : !memref_rmem_bf16_19
      %2828 = cute.get_shape(%lay_7353) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7354, %e1_7355, %e2_7356, %e3_7357 = cute.get_leaves(%2828) : !cute.shape<"((8,1),((4,2)))">
      %lay_7358 = cute.get_layout(%view_7329) : !memref_smem_bf16_20
      %sz_7359 = cute.size(%lay_7358) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7360 = cute.get_leaves(%sz_7359) : !cute.int_tuple<"8">
      %lay_7361 = cute.get_layout(%view_7344) : !memref_rmem_bf16_19
      %sz_7362 = cute.size(%lay_7361) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7363 = cute.get_leaves(%sz_7362) : !cute.int_tuple<"8">
      %2829 = cute.static : !cute.layout<"1:0">
      %iter_7364 = cute.get_iter(%view_7329) : !memref_smem_bf16_20
      %iter_7365 = cute.get_iter(%view_7344) : !memref_rmem_bf16_19
      %lay_7366 = cute.get_layout(%view_7329) : !memref_smem_bf16_20
      %lay_7367 = cute.get_layout(%view_7344) : !memref_rmem_bf16_19
      %append_7368 = cute.append_to_rank<2> (%lay_7366, %2829) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7369 = cute.append_to_rank<2> (%lay_7367, %2829) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2830:2 = cute.get_scalars(%append_7368) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7370 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7371 = cute.assume(%2830#0) : (i32) -> !cute.i32<divby 16>
      %iv_7372 = cute.assume(%2830#1) : (i32) -> !cute.i32<divby 32>
      %stride_7373 = cute.make_stride(%iv_7371, %iv_7372) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7374 = cute.make_layout(%shape_7370, %stride_7373) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7375 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7376 = cute.size(%lay_7374) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2831 = cute.get_scalars(%sz_7376) : !cute.int_tuple<"8">
      %c0_i32_7377 = arith.constant 0 : i32
      %c1_i32_7378 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7377 to %2831 step %c1_i32_7378  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378:2 = cute.get_scalars(%lay_7374) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_7374) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8607 = cute.add_offset(%iter_7364, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_7375) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_7365, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3381 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3382 = llvm.mlir.constant(0 : i32) : i32
        %3383 = vector.extractelement %3381[%3382 : i32] : vector<4xi32>
        %3384 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
        %3385 = llvm.mlir.constant(1 : i32) : i32
        %3386 = vector.extractelement %3381[%3385 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3387 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3386, %3387 : i32, !llvm.ptr
        %3388 = llvm.mlir.constant(2 : i32) : i32
        %3389 = vector.extractelement %3381[%3388 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3390 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3389, %3390 : i32, !llvm.ptr
        %3391 = llvm.mlir.constant(3 : i32) : i32
        %3392 = vector.extractelement %3381[%3391 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3393 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3392, %3393 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7379 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7380 = cute.get_layout(%view_6868) : !memref_rmem_bf16_17
      %idx_7381 = cute.crd2idx(%coord_7379, %lay_7380) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
      %iter_7382 = cute.get_iter(%view_6868) : !memref_rmem_bf16_17
      %ptr_7383 = cute.add_offset(%iter_7382, %idx_7381) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7384 = cute.make_view(%ptr_7383) : !memref_rmem_bf16_20
      %iter_7385 = cute.get_iter(%view_7384) : !memref_rmem_bf16_20
      %iter_7386 = cute.get_iter(%view_7384) : !memref_rmem_bf16_20
      %coord_7387 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_7388 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
      %idx_7389 = cute.crd2idx(%coord_7387, %lay_7388) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
      %iter_7390 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %ptr_7391 = cute.add_offset(%iter_7390, %idx_7389) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7392 = cute.make_view(%ptr_7391) : !memref_rmem_bf16_21
      %iter_7393 = cute.get_iter(%view_7392) : !memref_rmem_bf16_21
      %iter_7394 = cute.get_iter(%view_7392) : !memref_rmem_bf16_21
      %lay_7395 = cute.get_layout(%view_7384) : !memref_rmem_bf16_20
      %2832 = cute.get_shape(%lay_7395) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7396, %e1_7397, %e2_7398, %e3_7399 = cute.get_leaves(%2832) : !cute.shape<"(((2,2),2),2)">
      %lay_7400 = cute.get_layout(%view_7392) : !memref_rmem_bf16_21
      %2833 = cute.get_shape(%lay_7400) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7401, %e1_7402, %e2_7403, %e3_7404 = cute.get_leaves(%2833) : !cute.shape<"((2,2),(8,2))">
      %iter_7405 = cute.get_iter(%view_7384) : !memref_rmem_bf16_20
      %iter_7406 = cute.get_iter(%view_7392) : !memref_rmem_bf16_21
      %iter_7407 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %iter_7408 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %lay_7409 = cute.get_layout(%view_7384) : !memref_rmem_bf16_20
      %lay_7410 = cute.get_layout(%view_7392) : !memref_rmem_bf16_21
      %lay_7411 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7412 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2834 = cute.static : !cute.layout<"1:0">
      %append_7413 = cute.append_to_rank<3> (%lay_7409, %2834) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7414 = cute.append_to_rank<3> (%lay_7410, %2834) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7415 = cute.size(%append_7413) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7416 = cute.size(%append_7413) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7417 = cute.size(%append_7414) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2835 = cute.get_scalars(%sz_7415) : !cute.int_tuple<"1">
      %2836 = cute.get_scalars(%sz_7416) : !cute.int_tuple<"2">
      %2837 = cute.get_scalars(%sz_7417) : !cute.int_tuple<"16">
      %c0_i32_7418 = arith.constant 0 : i32
      %c1_i32_7419 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7418 to %2835 step %c1_i32_7419  : i32 {
        scf.for %arg6 = %c0_i32_7418 to %2836 step %c1_i32_7419  : i32 {
          scf.for %arg7 = %c0_i32_7418 to %2837 step %c1_i32_7419  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_7413) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8609 = cute.add_offset(%iter_7405, %idx_8608) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_22
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_7414) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_7406, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_7411) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_7407, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_7412) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_7408, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_22
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_7420 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_7421 = cute.size(%int_tuple_7420) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_7422 = cute.get_leaves(%sz_7421) : !cute.int_tuple<"4">
      %coord_7423 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7424 = cute.get_layout(%view_862) : !memref_smem_bf16_10
      %2838:2 = cute.get_scalars(%lay_7424) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
      %shape_7425 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
      %iv_7426 = cute.assume(%2838#0) : (i32) -> !cute.i32<divby 16>
      %iv_7427 = cute.assume(%2838#1) : (i32) -> !cute.i32<divby 32>
      %stride_7428 = cute.make_stride(%iv_7426, %iv_7427) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
      %lay_7429 = cute.make_layout(%shape_7425, %stride_7428) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %idx_7430 = cute.crd2idx(%coord_7423, %lay_7424) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_7431 = cute.get_iter(%view_862) : !memref_smem_bf16_10
      %ptr_7432 = cute.add_offset(%iter_7431, %idx_7430) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_7433 = cute.make_view(%ptr_7432, %lay_7429) : !memref_smem_bf16_19
      %iter_7434 = cute.get_iter(%view_7433) : !memref_smem_bf16_19
      %iter_7435 = cute.get_iter(%view_7433) : !memref_smem_bf16_19
      %coord_7436 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_7437 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
      %idx_7438 = cute.crd2idx(%coord_7436, %lay_7437) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_7439 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
      %ptr_7440 = cute.add_offset(%iter_7439, %idx_7438) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7441 = cute.make_view(%ptr_7440) : !memref_rmem_bf16_18
      %iter_7442 = cute.get_iter(%view_7441) : !memref_rmem_bf16_18
      %iter_7443 = cute.get_iter(%view_7441) : !memref_rmem_bf16_18
      %lay_7444 = cute.get_layout(%view_7433) : !memref_smem_bf16_19
      %2839 = cute.get_shape(%lay_7444) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7445, %e1_7446, %e2_7447, %e3_7448, %e4_7449 = cute.get_leaves(%2839) : !cute.shape<"((8,1),((2,2),2))">
      %lay_7450 = cute.get_layout(%view_7441) : !memref_rmem_bf16_18
      %2840 = cute.get_shape(%lay_7450) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7451, %e1_7452, %e2_7453, %e3_7454 = cute.get_leaves(%2840) : !cute.shape<"((8,1),(4,2))">
      %lay_7455 = cute.get_layout(%view_7433) : !memref_smem_bf16_19
      %shape_7456 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7457 = cute.make_layout() : !cute.layout<"1:0">
      %append_7458 = cute.append_to_rank<2> (%lay_7455, %lay_7457) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_7459 = cute.make_view(%iter_7435, %append_7458) : !memref_smem_bf16_19
      %iter_7460 = cute.get_iter(%view_7459) : !memref_smem_bf16_19
      %lay_7461 = cute.get_layout(%view_7459) : !memref_smem_bf16_19
      %2841 = cute.get_shape(%lay_7461) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_7462, %e1_7463, %e2_7464, %e3_7465, %e4_7466 = cute.get_leaves(%2841) : !cute.shape<"((8,1),((2,2),2))">
      %iter_7467 = cute.get_iter(%view_7459) : !memref_smem_bf16_19
      %lay_7468 = cute.get_layout(%view_7459) : !memref_smem_bf16_19
      %2842:2 = cute.get_scalars(%lay_7468) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_7469 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_7470 = cute.assume(%2842#0) : (i32) -> !cute.i32<divby 16>
      %iv_7471 = cute.assume(%2842#1) : (i32) -> !cute.i32<divby 32>
      %stride_7472 = cute.make_stride(%iv_7470, %iv_7471) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_7473 = cute.make_layout(%shape_7469, %stride_7472) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_7474 = cute.make_view(%iter_7467, %lay_7473) : !memref_smem_bf16_20
      %iter_7475 = cute.get_iter(%view_7474) : !memref_smem_bf16_20
      %iter_7476 = cute.get_iter(%view_7474) : !memref_smem_bf16_20
      %lay_7477 = cute.get_layout(%view_7441) : !memref_rmem_bf16_18
      %shape_7478 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7479 = cute.make_layout() : !cute.layout<"1:0">
      %append_7480 = cute.append_to_rank<2> (%lay_7477, %lay_7479) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_7481 = cute.make_view(%iter_7443, %append_7480) : !memref_rmem_bf16_18
      %iter_7482 = cute.get_iter(%view_7481) : !memref_rmem_bf16_18
      %lay_7483 = cute.get_layout(%view_7481) : !memref_rmem_bf16_18
      %2843 = cute.get_shape(%lay_7483) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_7484, %e1_7485, %e2_7486, %e3_7487 = cute.get_leaves(%2843) : !cute.shape<"((8,1),(4,2))">
      %iter_7488 = cute.get_iter(%view_7481) : !memref_rmem_bf16_18
      %view_7489 = cute.make_view(%iter_7488) : !memref_rmem_bf16_19
      %iter_7490 = cute.get_iter(%view_7489) : !memref_rmem_bf16_19
      %iter_7491 = cute.get_iter(%view_7489) : !memref_rmem_bf16_19
      %lay_7492 = cute.get_layout(%view_7474) : !memref_smem_bf16_20
      %2844 = cute.get_shape(%lay_7492) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_7493, %e1_7494, %e2_7495, %e3_7496, %e4_7497 = cute.get_leaves(%2844) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_7498 = cute.get_layout(%view_7489) : !memref_rmem_bf16_19
      %2845 = cute.get_shape(%lay_7498) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_7499, %e1_7500, %e2_7501, %e3_7502 = cute.get_leaves(%2845) : !cute.shape<"((8,1),((4,2)))">
      %lay_7503 = cute.get_layout(%view_7474) : !memref_smem_bf16_20
      %sz_7504 = cute.size(%lay_7503) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_7505 = cute.get_leaves(%sz_7504) : !cute.int_tuple<"8">
      %lay_7506 = cute.get_layout(%view_7489) : !memref_rmem_bf16_19
      %sz_7507 = cute.size(%lay_7506) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_7508 = cute.get_leaves(%sz_7507) : !cute.int_tuple<"8">
      %2846 = cute.static : !cute.layout<"1:0">
      %iter_7509 = cute.get_iter(%view_7474) : !memref_smem_bf16_20
      %iter_7510 = cute.get_iter(%view_7489) : !memref_rmem_bf16_19
      %lay_7511 = cute.get_layout(%view_7474) : !memref_smem_bf16_20
      %lay_7512 = cute.get_layout(%view_7489) : !memref_rmem_bf16_19
      %append_7513 = cute.append_to_rank<2> (%lay_7511, %2846) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_7514 = cute.append_to_rank<2> (%lay_7512, %2846) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2847:2 = cute.get_scalars(%append_7513) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_7515 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_7516 = cute.assume(%2847#0) : (i32) -> !cute.i32<divby 16>
      %iv_7517 = cute.assume(%2847#1) : (i32) -> !cute.i32<divby 32>
      %stride_7518 = cute.make_stride(%iv_7516, %iv_7517) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7519 = cute.make_layout(%shape_7515, %stride_7518) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_7520 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_7521 = cute.size(%lay_7519) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2848 = cute.get_scalars(%sz_7521) : !cute.int_tuple<"8">
      %c0_i32_7522 = arith.constant 0 : i32
      %c1_i32_7523 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7522 to %2848 step %c1_i32_7523  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378:2 = cute.get_scalars(%lay_7519) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_7519) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8607 = cute.add_offset(%iter_7509, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_7520) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_7510, %idx_8610) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_11
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_11
        %swizzled = cute.apply_swizzle(%iter_8613) : !cute.ptr<bf16, smem, align<16>>
        %3381 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
        %3382 = llvm.mlir.constant(0 : i32) : i32
        %3383 = vector.extractelement %3381[%3382 : i32] : vector<4xi32>
        %3384 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3383, %3384 : i32, !llvm.ptr
        %3385 = llvm.mlir.constant(1 : i32) : i32
        %3386 = vector.extractelement %3381[%3385 : i32] : vector<4xi32>
        %int_tuple_8615 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8616 = cute.add_offset(%iter_8614, %int_tuple_8615) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %3387 = builtin.unrealized_conversion_cast %ptr_8616 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3386, %3387 : i32, !llvm.ptr
        %3388 = llvm.mlir.constant(2 : i32) : i32
        %3389 = vector.extractelement %3381[%3388 : i32] : vector<4xi32>
        %int_tuple_8617 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %ptr_8618 = cute.add_offset(%iter_8614, %int_tuple_8617) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
        %3390 = builtin.unrealized_conversion_cast %ptr_8618 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        llvm.store %3389, %3390 : i32, !llvm.ptr
        %3391 = llvm.mlir.constant(3 : i32) : i32
        %3392 = vector.extractelement %3381[%3391 : i32] : vector<4xi32>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
        %ptr_8620 = cute.add_offset(%iter_8614, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
        %3393 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        llvm.store %3392, %3393 : i32, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7524 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7525 = cute.get_layout(%view_6868) : !memref_rmem_bf16_17
      %idx_7526 = cute.crd2idx(%coord_7524, %lay_7525) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
      %iter_7527 = cute.get_iter(%view_6868) : !memref_rmem_bf16_17
      %ptr_7528 = cute.add_offset(%iter_7527, %idx_7526) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_7529 = cute.make_view(%ptr_7528) : !memref_rmem_bf16_20
      %iter_7530 = cute.get_iter(%view_7529) : !memref_rmem_bf16_20
      %iter_7531 = cute.get_iter(%view_7529) : !memref_rmem_bf16_20
      %coord_7532 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_7533 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
      %idx_7534 = cute.crd2idx(%coord_7532, %lay_7533) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
      %iter_7535 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
      %ptr_7536 = cute.add_offset(%iter_7535, %idx_7534) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_7537 = cute.make_view(%ptr_7536) : !memref_rmem_bf16_21
      %iter_7538 = cute.get_iter(%view_7537) : !memref_rmem_bf16_21
      %iter_7539 = cute.get_iter(%view_7537) : !memref_rmem_bf16_21
      %lay_7540 = cute.get_layout(%view_7529) : !memref_rmem_bf16_20
      %2849 = cute.get_shape(%lay_7540) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_7541, %e1_7542, %e2_7543, %e3_7544 = cute.get_leaves(%2849) : !cute.shape<"(((2,2),2),2)">
      %lay_7545 = cute.get_layout(%view_7537) : !memref_rmem_bf16_21
      %2850 = cute.get_shape(%lay_7545) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_7546, %e1_7547, %e2_7548, %e3_7549 = cute.get_leaves(%2850) : !cute.shape<"((2,2),(8,2))">
      %iter_7550 = cute.get_iter(%view_7529) : !memref_rmem_bf16_20
      %iter_7551 = cute.get_iter(%view_7537) : !memref_rmem_bf16_21
      %iter_7552 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %iter_7553 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
      %lay_7554 = cute.get_layout(%view_7529) : !memref_rmem_bf16_20
      %lay_7555 = cute.get_layout(%view_7537) : !memref_rmem_bf16_21
      %lay_7556 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7557 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2851 = cute.static : !cute.layout<"1:0">
      %append_7558 = cute.append_to_rank<3> (%lay_7554, %2851) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_7559 = cute.append_to_rank<3> (%lay_7555, %2851) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_7560 = cute.size(%append_7558) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_7561 = cute.size(%append_7558) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_7562 = cute.size(%append_7559) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2852 = cute.get_scalars(%sz_7560) : !cute.int_tuple<"1">
      %2853 = cute.get_scalars(%sz_7561) : !cute.int_tuple<"2">
      %2854 = cute.get_scalars(%sz_7562) : !cute.int_tuple<"16">
      %c0_i32_7563 = arith.constant 0 : i32
      %c1_i32_7564 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7563 to %2852 step %c1_i32_7564  : i32 {
        scf.for %arg6 = %c0_i32_7563 to %2853 step %c1_i32_7564  : i32 {
          scf.for %arg7 = %c0_i32_7563 to %2854 step %c1_i32_7564  : i32 {
            %coord_8604 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8605 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_8606 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %3378:2 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8607 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
            %idx_8608 = cute.crd2idx(%coord_8604, %append_7558) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8609 = cute.add_offset(%iter_7550, %idx_8608) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8610 = cute.make_view(%ptr_8609, %lay_8607) : !memref_rmem_bf16_22
            %3379:2 = cute.get_scalars(%coord_8605) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8611 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8612 = cute.crd2idx(%coord_8605, %append_7559) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8613 = cute.add_offset(%iter_7551, %idx_8612) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_8614 = cute.make_view(%ptr_8613, %lay_8611) : !memref_rmem_bf16_15
            %3380:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8615 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8616 = cute.crd2idx(%coord_8606, %lay_7556) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8617 = cute.add_offset(%iter_7552, %idx_8616) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8618 = cute.make_view(%ptr_8617, %lay_8615) : !memref_rmem_f32_3
            %3381:2 = cute.get_scalars(%coord_8606) <{only_dynamic}> : !cute.coord<"(_,?,?)">
            %lay_8619 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
            %idx_8620 = cute.crd2idx(%coord_8606, %lay_7557) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_8621 = cute.add_offset(%iter_7553, %idx_8620) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_8622 = cute.make_view(%ptr_8621, %lay_8619) : !memref_rmem_f32_3
            %iter_8623 = cute.get_iter(%view_8610) : !memref_rmem_bf16_22
            %iter_8624 = cute.get_iter(%view_8614) : !memref_rmem_bf16_15
            %iter_8625 = cute.get_iter(%view_8618) : !memref_rmem_f32_3
            %iter_8626 = cute.get_iter(%view_8622) : !memref_rmem_f32_3
            %3382 = builtin.unrealized_conversion_cast %iter_8623 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3383 = llvm.load %3382 : !llvm.ptr -> i32
            %3384 = llvm.getelementptr %3382[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3385 = llvm.load %3384 : !llvm.ptr -> i32
            %3386 = llvm.getelementptr %3382[4] : (!llvm.ptr) -> !llvm.ptr, i32
            %3387 = llvm.load %3386 : !llvm.ptr -> i32
            %3388 = llvm.getelementptr %3382[5] : (!llvm.ptr) -> !llvm.ptr, i32
            %3389 = llvm.load %3388 : !llvm.ptr -> i32
            %3390 = builtin.unrealized_conversion_cast %iter_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
            %3391 = llvm.load %3390 : !llvm.ptr -> i32
            %3392 = llvm.getelementptr %3390[1] : (!llvm.ptr) -> !llvm.ptr, i32
            %3393 = llvm.load %3392 : !llvm.ptr -> i32
            %3394 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            %3395 = llvm.load %3394 : !llvm.ptr -> f32
            %3396 = llvm.getelementptr %3394[1] : (!llvm.ptr) -> !llvm.ptr, f32
            %3397 = llvm.load %3396 : !llvm.ptr -> f32
            %3398 = llvm.getelementptr %3394[2] : (!llvm.ptr) -> !llvm.ptr, f32
            %3399 = llvm.load %3398 : !llvm.ptr -> f32
            %3400 = llvm.getelementptr %3394[3] : (!llvm.ptr) -> !llvm.ptr, f32
            %3401 = llvm.load %3400 : !llvm.ptr -> f32
            %3402:4 = cute_nvgpu.arch.mma.SM80 A[%3383, %3385, %3387, %3389]  B[%3391, %3393]  C[%3395, %3397, %3399, %3401] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
            %3403 = builtin.unrealized_conversion_cast %iter_8625 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
            llvm.store %3402#0, %3403 : f32, !llvm.ptr
            %3404 = llvm.getelementptr %3403[1] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#1, %3404 : f32, !llvm.ptr
            %3405 = llvm.getelementptr %3403[2] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#2, %3405 : f32, !llvm.ptr
            %3406 = llvm.getelementptr %3403[3] : (!llvm.ptr) -> !llvm.ptr, f32
            llvm.store %3402#3, %3406 : f32, !llvm.ptr
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %c1_i32_7565 = arith.constant 1 : i32
      %2855:7 = scf.for %arg5 = %c1_i32_7565 to %128 step %c1_i32_7565 iter_args(%arg6 = %1027, %arg7 = %117, %arg8 = %1027, %arg9 = %arg0, %arg10 = %arg1, %arg11 = %118, %arg12 = %119) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_8604 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_8605 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %lay_8606 = cute.get_layout(%arg9) : !memref_gmem_bf16_
        %3378 = cute.get_shape(%lay_8606) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8607, %e1_8608, %e2_8609, %e3_8610 = cute.get_leaves(%3378) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8611 = cute.to_int_tuple(%e0_8607) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3379 = cute.get_scalars(%itup_8611) : !cute.int_tuple<"?">
        %itup_8612 = cute.to_int_tuple(%e1_8608) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3380 = cute.get_scalars(%itup_8612) : !cute.int_tuple<"?">
        %itup_8613 = cute.to_int_tuple(%e2_8609) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3381 = cute.get_scalars(%itup_8613) : !cute.int_tuple<"?">
        %itup_8614 = cute.to_int_tuple(%e3_8610) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3382 = cute.get_scalars(%itup_8614) : !cute.int_tuple<"?{div=8}">
        %3383 = cute.get_stride(%lay_8606) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_8615, %e1_8616, %e2_8617, %e3_8618 = cute.get_leaves(%3383) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_8619 = cute.to_int_tuple(%e0_8615) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3384 = cute.get_scalars(%itup_8619) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8620 = cute.to_int_tuple(%e1_8616) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3385 = cute.get_scalars(%itup_8620) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8621 = cute.to_int_tuple(%e2_8617) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3386 = cute.get_scalars(%itup_8621) : !cute.int_tuple<"?{i64 div=8}">
        %lay_8622 = cute.get_layout(%arg10) : !memref_gmem_bf16_
        %3387 = cute.get_shape(%lay_8622) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_8623, %e1_8624, %e2_8625, %e3_8626 = cute.get_leaves(%3387) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_8627 = cute.to_int_tuple(%e0_8623) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3388 = cute.get_scalars(%itup_8627) : !cute.int_tuple<"?">
        %itup_8628 = cute.to_int_tuple(%e1_8624) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3389 = cute.get_scalars(%itup_8628) : !cute.int_tuple<"?">
        %itup_8629 = cute.to_int_tuple(%e2_8625) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %3390 = cute.get_scalars(%itup_8629) : !cute.int_tuple<"?">
        %itup_8630 = cute.to_int_tuple(%e3_8626) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %3391 = cute.get_scalars(%itup_8630) : !cute.int_tuple<"?{div=8}">
        %3392 = cute.get_stride(%lay_8622) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_8631, %e1_8632, %e2_8633, %e3_8634 = cute.get_leaves(%3392) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_8635 = cute.to_int_tuple(%e0_8631) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3393 = cute.get_scalars(%itup_8635) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8636 = cute.to_int_tuple(%e1_8632) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3394 = cute.get_scalars(%itup_8636) : !cute.int_tuple<"?{i64 div=8}">
        %itup_8637 = cute.to_int_tuple(%e2_8633) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %3395 = cute.get_scalars(%itup_8637) : !cute.int_tuple<"?{i64 div=8}">
        %iter_8638 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_8639 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %3396 = arith.subi %128, %arg5 : i32
        %c1_i32_8640 = arith.constant 1 : i32
        %3397 = arith.subi %3396, %c1_i32_8640 : i32
        %shape_8641 = cute.make_shape() : () -> !cute.shape<"(128,64)">
        %shape_8642 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %e0_8643, %e1_8644, %e2_8645, %e3_8646 = cute.get_leaves(%shape_8642) : !cute.shape<"((2,2),2,8)">
        %shape_8647 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_8648 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_8649 = cute.memref.alloca(%lay_8648) : !memref_rmem_f32_2
        %iter_8650 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_8651 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_8652 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %sz_8653 = cute.size(%lay_8652) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
        %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"64">
        %lay_8655 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3398 = cute.get_shape(%lay_8655) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_8656, %e1_8657, %e2_8658, %e3_8659 = cute.get_leaves(%3398) : !cute.shape<"((2,2),2,8)">
        %int_tuple_8660 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %int_tuple_8661 = cute.make_int_tuple() : () -> !cute.int_tuple<"64">
        %e0_8662 = cute.get_leaves(%int_tuple_8661) : !cute.int_tuple<"64">
        %cst_8663 = arith.constant 0.000000e+00 : f32
        %3399 = vector.splat %cst_8663 : vector<64xf32>
        %int_tuple_8664 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_8665 = cute.size(%int_tuple_8664) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_8666 = cute.get_leaves(%sz_8665) : !cute.int_tuple<"64">
        %int_tuple_8667 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_8668 = cute.size(%int_tuple_8667) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_8669 = cute.get_leaves(%sz_8668) : !cute.int_tuple<"64">
        cute.memref.store_vec %3399, %rmem_8649 : !memref_rmem_f32_2
        nvvm.cp.async.wait.group 0
        %c1_i32_8670 = arith.constant 1 : i32
        %c128_i32_8671 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_8670 number_of_threads = %c128_i32_8671
        %false_8672 = arith.constant false
        scf.if %false_8672 {
          %lay_11563 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %3824 = cute.get_shape(%lay_11563) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11564, %e1_11565, %e2_11566, %e3_11567 = cute.get_leaves(%3824) : !cute.shape<"((8,1),4,2)">
          %int_tuple_11568 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_11569 = cute.size(%int_tuple_11568) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_11570 = cute.get_leaves(%sz_11569) : !cute.int_tuple<"4">
          %coord_11571 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_11572 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11573 = cute.crd2idx(%coord_11571, %lay_11572) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_11574 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11575 = cute.add_offset(%iter_11574, %idx_11573) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11576 = cute.make_view(%tup_11575) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11577 = cute.get_iter(%view_11576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11578, %e1_11579, %e2_11580, %e3_11581 = cute.get_leaves(%iter_11577) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3825 = cute.get_scalars(%e0_11578) : !cute.int_tuple<"?">
          %3826 = cute.get_scalars(%e1_11579) : !cute.int_tuple<"?">
          %3827 = cute.get_scalars(%e2_11580) : !cute.int_tuple<"?">
          %3828 = cute.get_scalars(%e3_11581) : !cute.int_tuple<"?{div=8}">
          %iter_11582 = cute.get_iter(%view_11576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11583, %e1_11584, %e2_11585, %e3_11586 = cute.get_leaves(%iter_11582) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3829 = cute.get_scalars(%e0_11583) : !cute.int_tuple<"?">
          %3830 = cute.get_scalars(%e1_11584) : !cute.int_tuple<"?">
          %3831 = cute.get_scalars(%e2_11585) : !cute.int_tuple<"?">
          %3832 = cute.get_scalars(%e3_11586) : !cute.int_tuple<"?{div=8}">
          %iter_11587 = cute.get_iter(%view_11576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11588, %e1_11589, %e2_11590, %e3_11591 = cute.get_leaves(%iter_11587) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3833 = cute.get_scalars(%e0_11588) : !cute.int_tuple<"?">
          %3834 = cute.get_scalars(%e1_11589) : !cute.int_tuple<"?">
          %3835 = cute.get_scalars(%e2_11590) : !cute.int_tuple<"?">
          %3836 = cute.get_scalars(%e3_11591) : !cute.int_tuple<"?{div=8}">
          %lay_11592 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3837 = cute.get_shape(%lay_11592) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11593, %e1_11594, %e2_11595, %e3_11596 = cute.get_leaves(%3837) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11597 = cute.to_int_tuple(%e0_11593) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3838 = cute.get_scalars(%itup_11597) : !cute.int_tuple<"?">
          %itup_11598 = cute.to_int_tuple(%e1_11594) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3839 = cute.get_scalars(%itup_11598) : !cute.int_tuple<"?">
          %itup_11599 = cute.to_int_tuple(%e2_11595) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3840 = cute.get_scalars(%itup_11599) : !cute.int_tuple<"?">
          %itup_11600 = cute.to_int_tuple(%e3_11596) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3841 = cute.get_scalars(%itup_11600) : !cute.int_tuple<"?{div=8}">
          %coord_11601 = cute.make_coord(%e1_11589) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11602 = cute.make_coord(%itup_11598) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3842 = cute.get_scalars(%coord_11601) : !cute.coord<"?">
          %3843 = cute.get_scalars(%coord_11602) : !cute.coord<"?">
          %true_11603 = arith.constant true
          %3844 = arith.cmpi slt, %3842, %3843 : i32
          %3845 = arith.andi %true_11603, %3844 : i1
          scf.if %3845 {
            %coord_11703 = cute.make_coord(%3397) : (i32) -> !cute.coord<"(_,0,_,?)">
            %lay_11704 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_11706 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_gmem_bf16_6
            %iter_11709 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %iter_11710 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %coord_11711 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11712 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11713 = cute.crd2idx(%coord_11711, %lay_11712) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_11714 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11715 = cute.add_offset(%iter_11714, %idx_11713) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11716 = cute.make_view(%ptr_11715) : !memref_smem_bf16_14
            %iter_11717 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %iter_11718 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %coord_11719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11720 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
            %idx_11721 = cute.crd2idx(%coord_11719, %lay_11720) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11722 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
            %ptr_11723 = cute.add_offset(%iter_11722, %idx_11721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11724 = cute.make_view(%ptr_11723) : !memref_rmem_i8_2
            %iter_11725 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %iter_11726 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %lay_11727 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %3909 = cute.get_shape(%lay_11727) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11728, %e1_11729, %e2_11730 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %lay_11731 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %3910 = cute.get_shape(%lay_11731) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11732, %e1_11733, %e2_11734 = cute.get_leaves(%3910) : !cute.shape<"((8,1),2)">
            %lay_11735 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %shape_11736 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11737 = cute.make_layout() : !cute.layout<"1:0">
            %append_11738 = cute.append_to_rank<2> (%lay_11735, %lay_11737) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11739 = cute.make_view(%iter_11710, %append_11738) : !memref_gmem_bf16_6
            %iter_11740 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %lay_11741 = cute.get_layout(%view_11739) : !memref_gmem_bf16_6
            %3911 = cute.get_shape(%lay_11741) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11742, %e1_11743, %e2_11744 = cute.get_leaves(%3911) : !cute.shape<"((8,1),2)">
            %iter_11745 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %view_11746 = cute.make_view(%iter_11745) : !memref_gmem_bf16_7
            %iter_11747 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11748 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %lay_11749 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %shape_11750 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11751 = cute.make_layout() : !cute.layout<"1:0">
            %append_11752 = cute.append_to_rank<2> (%lay_11749, %lay_11751) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11753 = cute.make_view(%iter_11718, %append_11752) : !memref_smem_bf16_14
            %iter_11754 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %lay_11755 = cute.get_layout(%view_11753) : !memref_smem_bf16_14
            %3912 = cute.get_shape(%lay_11755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11756, %e1_11757, %e2_11758 = cute.get_leaves(%3912) : !cute.shape<"((8,1),2)">
            %iter_11759 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %view_11760 = cute.make_view(%iter_11759) : !memref_smem_bf16_15
            %iter_11761 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %iter_11762 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11763 = cute.get_layout(%view_11724) : !memref_rmem_i8_2
            %shape_11764 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11765 = cute.make_layout() : !cute.layout<"1:0">
            %append_11766 = cute.append_to_rank<2> (%lay_11763, %lay_11765) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11767 = cute.make_view(%iter_11726, %append_11766) : !memref_rmem_i8_2
            %iter_11768 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %lay_11769 = cute.get_layout(%view_11767) : !memref_rmem_i8_2
            %3913 = cute.get_shape(%lay_11769) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11770, %e1_11771 = cute.get_leaves(%3913) : !cute.shape<"(1,2)">
            %iter_11772 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %view_11773 = cute.make_view(%iter_11772) : !memref_rmem_i8_3
            %iter_11774 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %iter_11775 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11776 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %3914 = cute.get_shape(%lay_11776) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11777, %e1_11778, %e2_11779 = cute.get_leaves(%3914) : !cute.shape<"((8,1),(2))">
            %lay_11780 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %3915 = cute.get_shape(%lay_11780) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11781, %e1_11782, %e2_11783 = cute.get_leaves(%3915) : !cute.shape<"((8,1),(2))">
            %lay_11784 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %sz_11785 = cute.size(%lay_11784) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11786 = cute.get_leaves(%sz_11785) : !cute.int_tuple<"2">
            %lay_11787 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %sz_11788 = cute.size(%lay_11787) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11789 = cute.get_leaves(%sz_11788) : !cute.int_tuple<"2">
            %3916 = cute.static : !cute.layout<"1:0">
            %iter_11790 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11791 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11792 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %lay_11793 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %append_11794 = cute.append_to_rank<2> (%lay_11792, %3916) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11795 = cute.append_to_rank<2> (%lay_11793, %3916) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11797 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11798 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11799 = cute.get_layout(%view_11773) : !memref_rmem_i8_3
            %append_11800 = cute.append_to_rank<2> (%lay_11799, %3916) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11801 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11802 = cute.size(%lay_11796) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3917 = cute.get_scalars(%sz_11802) : !cute.int_tuple<"2">
            %c0_i32_11803 = arith.constant 0 : i32
            %c1_i32_11804 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11803 to %3917 step %c1_i32_11804  : i32 {
              %coord_11805 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3918 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11806 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11807 = cute.crd2idx(%coord_11805, %lay_11796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11808 = cute.add_offset(%iter_11790, %idx_11807) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11809 = cute.make_view(%ptr_11808, %lay_11806) : !memref_gmem_bf16_8
              %3919 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11810 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11811 = cute.crd2idx(%coord_11805, %lay_11797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11812 = cute.add_offset(%iter_11791, %idx_11811) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11813 = cute.make_view(%ptr_11812, %lay_11810) : !memref_smem_bf16_13
              %3920 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11814 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11815 = cute.crd2idx(%coord_11805, %lay_11801) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11816 = cute.add_offset(%iter_11798, %idx_11815) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11817 = cute.make_view(%ptr_11816, %lay_11814) : !memref_rmem_i8_4
              %iter_11818 = cute.get_iter(%view_11809) : !memref_gmem_bf16_8
              %iter_11819 = cute.get_iter(%view_11813) : !memref_smem_bf16_13
              %iter_11820 = cute.get_iter(%view_11817) : !memref_rmem_i8_4
              %3921 = builtin.unrealized_conversion_cast %iter_11820 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3922 = llvm.load %3921 : !llvm.ptr -> i8
              %3923 = llvm.trunc %3922 : i8 to i1
              %iter_11821 = cute.recast_iter(%iter_11818) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11822 = cute.recast_iter(%iter_11819) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11822 : !cute.ptr<i128, smem>, %iter_11821 : !cute.ptr<i128, gmem>, %3923 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11703 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_11704 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_11706 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_smem_bf16_14
            %iter_11709 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %iter_11710 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %lay_11711 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %sz_11712 = cute.size(%lay_11711) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11713 = cute.get_leaves(%sz_11712) : !cute.int_tuple<"16">
            %lay_11714 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %3909 = cute.get_shape(%lay_11714) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11715, %e1_11716, %e2_11717 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %int_tuple_11718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11719 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11720 = cute.get_leaves(%int_tuple_11719) : !cute.int_tuple<"16">
            %cst_11721 = arith.constant 0.000000e+00 : bf16
            %3910 = vector.splat %cst_11721 : vector<16xbf16>
            %int_tuple_11722 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11723 = cute.size(%int_tuple_11722) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11724 = cute.get_leaves(%sz_11723) : !cute.int_tuple<"16">
            %int_tuple_11725 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11726 = cute.size(%int_tuple_11725) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11727 = cute.get_leaves(%sz_11726) : !cute.int_tuple<"16">
            cute.memref.store_vec %3910, %view_11708 : !memref_smem_bf16_14
          }
          %coord_11604 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_11605 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11606 = cute.crd2idx(%coord_11604, %lay_11605) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_11607 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11608 = cute.add_offset(%iter_11607, %idx_11606) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11609 = cute.make_view(%tup_11608) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11610 = cute.get_iter(%view_11609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11611, %e1_11612, %e2_11613, %e3_11614 = cute.get_leaves(%iter_11610) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3846 = cute.get_scalars(%e0_11611) : !cute.int_tuple<"?">
          %3847 = cute.get_scalars(%e1_11612) : !cute.int_tuple<"?">
          %3848 = cute.get_scalars(%e2_11613) : !cute.int_tuple<"?">
          %3849 = cute.get_scalars(%e3_11614) : !cute.int_tuple<"?{div=8}">
          %iter_11615 = cute.get_iter(%view_11609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11616, %e1_11617, %e2_11618, %e3_11619 = cute.get_leaves(%iter_11615) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3850 = cute.get_scalars(%e0_11616) : !cute.int_tuple<"?">
          %3851 = cute.get_scalars(%e1_11617) : !cute.int_tuple<"?">
          %3852 = cute.get_scalars(%e2_11618) : !cute.int_tuple<"?">
          %3853 = cute.get_scalars(%e3_11619) : !cute.int_tuple<"?{div=8}">
          %iter_11620 = cute.get_iter(%view_11609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11621, %e1_11622, %e2_11623, %e3_11624 = cute.get_leaves(%iter_11620) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3854 = cute.get_scalars(%e0_11621) : !cute.int_tuple<"?">
          %3855 = cute.get_scalars(%e1_11622) : !cute.int_tuple<"?">
          %3856 = cute.get_scalars(%e2_11623) : !cute.int_tuple<"?">
          %3857 = cute.get_scalars(%e3_11624) : !cute.int_tuple<"?{div=8}">
          %lay_11625 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3858 = cute.get_shape(%lay_11625) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11626, %e1_11627, %e2_11628, %e3_11629 = cute.get_leaves(%3858) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11630 = cute.to_int_tuple(%e0_11626) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3859 = cute.get_scalars(%itup_11630) : !cute.int_tuple<"?">
          %itup_11631 = cute.to_int_tuple(%e1_11627) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3860 = cute.get_scalars(%itup_11631) : !cute.int_tuple<"?">
          %itup_11632 = cute.to_int_tuple(%e2_11628) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3861 = cute.get_scalars(%itup_11632) : !cute.int_tuple<"?">
          %itup_11633 = cute.to_int_tuple(%e3_11629) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3862 = cute.get_scalars(%itup_11633) : !cute.int_tuple<"?{div=8}">
          %coord_11634 = cute.make_coord(%e1_11622) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11635 = cute.make_coord(%itup_11631) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3863 = cute.get_scalars(%coord_11634) : !cute.coord<"?">
          %3864 = cute.get_scalars(%coord_11635) : !cute.coord<"?">
          %true_11636 = arith.constant true
          %3865 = arith.cmpi slt, %3863, %3864 : i32
          %3866 = arith.andi %true_11636, %3865 : i1
          scf.if %3866 {
            %coord_11703 = cute.make_coord(%3397) : (i32) -> !cute.coord<"(_,1,_,?)">
            %lay_11704 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_11706 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_gmem_bf16_6
            %iter_11709 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %iter_11710 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %coord_11711 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11712 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11713 = cute.crd2idx(%coord_11711, %lay_11712) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_11714 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11715 = cute.add_offset(%iter_11714, %idx_11713) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11716 = cute.make_view(%ptr_11715) : !memref_smem_bf16_14
            %iter_11717 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %iter_11718 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %coord_11719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11720 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
            %idx_11721 = cute.crd2idx(%coord_11719, %lay_11720) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11722 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
            %ptr_11723 = cute.add_offset(%iter_11722, %idx_11721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11724 = cute.make_view(%ptr_11723) : !memref_rmem_i8_2
            %iter_11725 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %iter_11726 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %lay_11727 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %3909 = cute.get_shape(%lay_11727) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11728, %e1_11729, %e2_11730 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %lay_11731 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %3910 = cute.get_shape(%lay_11731) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11732, %e1_11733, %e2_11734 = cute.get_leaves(%3910) : !cute.shape<"((8,1),2)">
            %lay_11735 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %shape_11736 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11737 = cute.make_layout() : !cute.layout<"1:0">
            %append_11738 = cute.append_to_rank<2> (%lay_11735, %lay_11737) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11739 = cute.make_view(%iter_11710, %append_11738) : !memref_gmem_bf16_6
            %iter_11740 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %lay_11741 = cute.get_layout(%view_11739) : !memref_gmem_bf16_6
            %3911 = cute.get_shape(%lay_11741) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11742, %e1_11743, %e2_11744 = cute.get_leaves(%3911) : !cute.shape<"((8,1),2)">
            %iter_11745 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %view_11746 = cute.make_view(%iter_11745) : !memref_gmem_bf16_7
            %iter_11747 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11748 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %lay_11749 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %shape_11750 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11751 = cute.make_layout() : !cute.layout<"1:0">
            %append_11752 = cute.append_to_rank<2> (%lay_11749, %lay_11751) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11753 = cute.make_view(%iter_11718, %append_11752) : !memref_smem_bf16_14
            %iter_11754 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %lay_11755 = cute.get_layout(%view_11753) : !memref_smem_bf16_14
            %3912 = cute.get_shape(%lay_11755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11756, %e1_11757, %e2_11758 = cute.get_leaves(%3912) : !cute.shape<"((8,1),2)">
            %iter_11759 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %view_11760 = cute.make_view(%iter_11759) : !memref_smem_bf16_15
            %iter_11761 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %iter_11762 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11763 = cute.get_layout(%view_11724) : !memref_rmem_i8_2
            %shape_11764 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11765 = cute.make_layout() : !cute.layout<"1:0">
            %append_11766 = cute.append_to_rank<2> (%lay_11763, %lay_11765) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11767 = cute.make_view(%iter_11726, %append_11766) : !memref_rmem_i8_2
            %iter_11768 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %lay_11769 = cute.get_layout(%view_11767) : !memref_rmem_i8_2
            %3913 = cute.get_shape(%lay_11769) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11770, %e1_11771 = cute.get_leaves(%3913) : !cute.shape<"(1,2)">
            %iter_11772 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %view_11773 = cute.make_view(%iter_11772) : !memref_rmem_i8_3
            %iter_11774 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %iter_11775 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11776 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %3914 = cute.get_shape(%lay_11776) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11777, %e1_11778, %e2_11779 = cute.get_leaves(%3914) : !cute.shape<"((8,1),(2))">
            %lay_11780 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %3915 = cute.get_shape(%lay_11780) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11781, %e1_11782, %e2_11783 = cute.get_leaves(%3915) : !cute.shape<"((8,1),(2))">
            %lay_11784 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %sz_11785 = cute.size(%lay_11784) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11786 = cute.get_leaves(%sz_11785) : !cute.int_tuple<"2">
            %lay_11787 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %sz_11788 = cute.size(%lay_11787) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11789 = cute.get_leaves(%sz_11788) : !cute.int_tuple<"2">
            %3916 = cute.static : !cute.layout<"1:0">
            %iter_11790 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11791 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11792 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %lay_11793 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %append_11794 = cute.append_to_rank<2> (%lay_11792, %3916) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11795 = cute.append_to_rank<2> (%lay_11793, %3916) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11797 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11798 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11799 = cute.get_layout(%view_11773) : !memref_rmem_i8_3
            %append_11800 = cute.append_to_rank<2> (%lay_11799, %3916) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11801 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11802 = cute.size(%lay_11796) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3917 = cute.get_scalars(%sz_11802) : !cute.int_tuple<"2">
            %c0_i32_11803 = arith.constant 0 : i32
            %c1_i32_11804 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11803 to %3917 step %c1_i32_11804  : i32 {
              %coord_11805 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3918 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11806 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11807 = cute.crd2idx(%coord_11805, %lay_11796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11808 = cute.add_offset(%iter_11790, %idx_11807) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11809 = cute.make_view(%ptr_11808, %lay_11806) : !memref_gmem_bf16_8
              %3919 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11810 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11811 = cute.crd2idx(%coord_11805, %lay_11797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11812 = cute.add_offset(%iter_11791, %idx_11811) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11813 = cute.make_view(%ptr_11812, %lay_11810) : !memref_smem_bf16_13
              %3920 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11814 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11815 = cute.crd2idx(%coord_11805, %lay_11801) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11816 = cute.add_offset(%iter_11798, %idx_11815) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11817 = cute.make_view(%ptr_11816, %lay_11814) : !memref_rmem_i8_4
              %iter_11818 = cute.get_iter(%view_11809) : !memref_gmem_bf16_8
              %iter_11819 = cute.get_iter(%view_11813) : !memref_smem_bf16_13
              %iter_11820 = cute.get_iter(%view_11817) : !memref_rmem_i8_4
              %3921 = builtin.unrealized_conversion_cast %iter_11820 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3922 = llvm.load %3921 : !llvm.ptr -> i8
              %3923 = llvm.trunc %3922 : i8 to i1
              %iter_11821 = cute.recast_iter(%iter_11818) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11822 = cute.recast_iter(%iter_11819) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11822 : !cute.ptr<i128, smem>, %iter_11821 : !cute.ptr<i128, gmem>, %3923 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11703 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_11704 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_11706 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_smem_bf16_14
            %iter_11709 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %iter_11710 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %lay_11711 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %sz_11712 = cute.size(%lay_11711) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11713 = cute.get_leaves(%sz_11712) : !cute.int_tuple<"16">
            %lay_11714 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %3909 = cute.get_shape(%lay_11714) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11715, %e1_11716, %e2_11717 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %int_tuple_11718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11719 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11720 = cute.get_leaves(%int_tuple_11719) : !cute.int_tuple<"16">
            %cst_11721 = arith.constant 0.000000e+00 : bf16
            %3910 = vector.splat %cst_11721 : vector<16xbf16>
            %int_tuple_11722 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11723 = cute.size(%int_tuple_11722) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11724 = cute.get_leaves(%sz_11723) : !cute.int_tuple<"16">
            %int_tuple_11725 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11726 = cute.size(%int_tuple_11725) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11727 = cute.get_leaves(%sz_11726) : !cute.int_tuple<"16">
            cute.memref.store_vec %3910, %view_11708 : !memref_smem_bf16_14
          }
          %coord_11637 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_11638 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11639 = cute.crd2idx(%coord_11637, %lay_11638) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_11640 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11641 = cute.add_offset(%iter_11640, %idx_11639) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11642 = cute.make_view(%tup_11641) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11643 = cute.get_iter(%view_11642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11644, %e1_11645, %e2_11646, %e3_11647 = cute.get_leaves(%iter_11643) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3867 = cute.get_scalars(%e0_11644) : !cute.int_tuple<"?">
          %3868 = cute.get_scalars(%e1_11645) : !cute.int_tuple<"?">
          %3869 = cute.get_scalars(%e2_11646) : !cute.int_tuple<"?">
          %3870 = cute.get_scalars(%e3_11647) : !cute.int_tuple<"?{div=8}">
          %iter_11648 = cute.get_iter(%view_11642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11649, %e1_11650, %e2_11651, %e3_11652 = cute.get_leaves(%iter_11648) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3871 = cute.get_scalars(%e0_11649) : !cute.int_tuple<"?">
          %3872 = cute.get_scalars(%e1_11650) : !cute.int_tuple<"?">
          %3873 = cute.get_scalars(%e2_11651) : !cute.int_tuple<"?">
          %3874 = cute.get_scalars(%e3_11652) : !cute.int_tuple<"?{div=8}">
          %iter_11653 = cute.get_iter(%view_11642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11654, %e1_11655, %e2_11656, %e3_11657 = cute.get_leaves(%iter_11653) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3875 = cute.get_scalars(%e0_11654) : !cute.int_tuple<"?">
          %3876 = cute.get_scalars(%e1_11655) : !cute.int_tuple<"?">
          %3877 = cute.get_scalars(%e2_11656) : !cute.int_tuple<"?">
          %3878 = cute.get_scalars(%e3_11657) : !cute.int_tuple<"?{div=8}">
          %lay_11658 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3879 = cute.get_shape(%lay_11658) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11659, %e1_11660, %e2_11661, %e3_11662 = cute.get_leaves(%3879) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11663 = cute.to_int_tuple(%e0_11659) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3880 = cute.get_scalars(%itup_11663) : !cute.int_tuple<"?">
          %itup_11664 = cute.to_int_tuple(%e1_11660) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3881 = cute.get_scalars(%itup_11664) : !cute.int_tuple<"?">
          %itup_11665 = cute.to_int_tuple(%e2_11661) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3882 = cute.get_scalars(%itup_11665) : !cute.int_tuple<"?">
          %itup_11666 = cute.to_int_tuple(%e3_11662) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3883 = cute.get_scalars(%itup_11666) : !cute.int_tuple<"?{div=8}">
          %coord_11667 = cute.make_coord(%e1_11655) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11668 = cute.make_coord(%itup_11664) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3884 = cute.get_scalars(%coord_11667) : !cute.coord<"?">
          %3885 = cute.get_scalars(%coord_11668) : !cute.coord<"?">
          %true_11669 = arith.constant true
          %3886 = arith.cmpi slt, %3884, %3885 : i32
          %3887 = arith.andi %true_11669, %3886 : i1
          scf.if %3887 {
            %coord_11703 = cute.make_coord(%3397) : (i32) -> !cute.coord<"(_,2,_,?)">
            %lay_11704 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_11706 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_gmem_bf16_6
            %iter_11709 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %iter_11710 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %coord_11711 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11712 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11713 = cute.crd2idx(%coord_11711, %lay_11712) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_11714 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11715 = cute.add_offset(%iter_11714, %idx_11713) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11716 = cute.make_view(%ptr_11715) : !memref_smem_bf16_14
            %iter_11717 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %iter_11718 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %coord_11719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11720 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
            %idx_11721 = cute.crd2idx(%coord_11719, %lay_11720) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11722 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
            %ptr_11723 = cute.add_offset(%iter_11722, %idx_11721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11724 = cute.make_view(%ptr_11723) : !memref_rmem_i8_2
            %iter_11725 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %iter_11726 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %lay_11727 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %3909 = cute.get_shape(%lay_11727) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11728, %e1_11729, %e2_11730 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %lay_11731 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %3910 = cute.get_shape(%lay_11731) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11732, %e1_11733, %e2_11734 = cute.get_leaves(%3910) : !cute.shape<"((8,1),2)">
            %lay_11735 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %shape_11736 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11737 = cute.make_layout() : !cute.layout<"1:0">
            %append_11738 = cute.append_to_rank<2> (%lay_11735, %lay_11737) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11739 = cute.make_view(%iter_11710, %append_11738) : !memref_gmem_bf16_6
            %iter_11740 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %lay_11741 = cute.get_layout(%view_11739) : !memref_gmem_bf16_6
            %3911 = cute.get_shape(%lay_11741) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11742, %e1_11743, %e2_11744 = cute.get_leaves(%3911) : !cute.shape<"((8,1),2)">
            %iter_11745 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %view_11746 = cute.make_view(%iter_11745) : !memref_gmem_bf16_7
            %iter_11747 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11748 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %lay_11749 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %shape_11750 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11751 = cute.make_layout() : !cute.layout<"1:0">
            %append_11752 = cute.append_to_rank<2> (%lay_11749, %lay_11751) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11753 = cute.make_view(%iter_11718, %append_11752) : !memref_smem_bf16_14
            %iter_11754 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %lay_11755 = cute.get_layout(%view_11753) : !memref_smem_bf16_14
            %3912 = cute.get_shape(%lay_11755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11756, %e1_11757, %e2_11758 = cute.get_leaves(%3912) : !cute.shape<"((8,1),2)">
            %iter_11759 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %view_11760 = cute.make_view(%iter_11759) : !memref_smem_bf16_15
            %iter_11761 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %iter_11762 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11763 = cute.get_layout(%view_11724) : !memref_rmem_i8_2
            %shape_11764 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11765 = cute.make_layout() : !cute.layout<"1:0">
            %append_11766 = cute.append_to_rank<2> (%lay_11763, %lay_11765) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11767 = cute.make_view(%iter_11726, %append_11766) : !memref_rmem_i8_2
            %iter_11768 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %lay_11769 = cute.get_layout(%view_11767) : !memref_rmem_i8_2
            %3913 = cute.get_shape(%lay_11769) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11770, %e1_11771 = cute.get_leaves(%3913) : !cute.shape<"(1,2)">
            %iter_11772 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %view_11773 = cute.make_view(%iter_11772) : !memref_rmem_i8_3
            %iter_11774 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %iter_11775 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11776 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %3914 = cute.get_shape(%lay_11776) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11777, %e1_11778, %e2_11779 = cute.get_leaves(%3914) : !cute.shape<"((8,1),(2))">
            %lay_11780 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %3915 = cute.get_shape(%lay_11780) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11781, %e1_11782, %e2_11783 = cute.get_leaves(%3915) : !cute.shape<"((8,1),(2))">
            %lay_11784 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %sz_11785 = cute.size(%lay_11784) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11786 = cute.get_leaves(%sz_11785) : !cute.int_tuple<"2">
            %lay_11787 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %sz_11788 = cute.size(%lay_11787) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11789 = cute.get_leaves(%sz_11788) : !cute.int_tuple<"2">
            %3916 = cute.static : !cute.layout<"1:0">
            %iter_11790 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11791 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11792 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %lay_11793 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %append_11794 = cute.append_to_rank<2> (%lay_11792, %3916) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11795 = cute.append_to_rank<2> (%lay_11793, %3916) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11797 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11798 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11799 = cute.get_layout(%view_11773) : !memref_rmem_i8_3
            %append_11800 = cute.append_to_rank<2> (%lay_11799, %3916) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11801 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11802 = cute.size(%lay_11796) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3917 = cute.get_scalars(%sz_11802) : !cute.int_tuple<"2">
            %c0_i32_11803 = arith.constant 0 : i32
            %c1_i32_11804 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11803 to %3917 step %c1_i32_11804  : i32 {
              %coord_11805 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3918 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11806 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11807 = cute.crd2idx(%coord_11805, %lay_11796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11808 = cute.add_offset(%iter_11790, %idx_11807) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11809 = cute.make_view(%ptr_11808, %lay_11806) : !memref_gmem_bf16_8
              %3919 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11810 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11811 = cute.crd2idx(%coord_11805, %lay_11797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11812 = cute.add_offset(%iter_11791, %idx_11811) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11813 = cute.make_view(%ptr_11812, %lay_11810) : !memref_smem_bf16_13
              %3920 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11814 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11815 = cute.crd2idx(%coord_11805, %lay_11801) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11816 = cute.add_offset(%iter_11798, %idx_11815) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11817 = cute.make_view(%ptr_11816, %lay_11814) : !memref_rmem_i8_4
              %iter_11818 = cute.get_iter(%view_11809) : !memref_gmem_bf16_8
              %iter_11819 = cute.get_iter(%view_11813) : !memref_smem_bf16_13
              %iter_11820 = cute.get_iter(%view_11817) : !memref_rmem_i8_4
              %3921 = builtin.unrealized_conversion_cast %iter_11820 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3922 = llvm.load %3921 : !llvm.ptr -> i8
              %3923 = llvm.trunc %3922 : i8 to i1
              %iter_11821 = cute.recast_iter(%iter_11818) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11822 = cute.recast_iter(%iter_11819) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11822 : !cute.ptr<i128, smem>, %iter_11821 : !cute.ptr<i128, gmem>, %3923 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11703 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_11704 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_11706 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_smem_bf16_14
            %iter_11709 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %iter_11710 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %lay_11711 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %sz_11712 = cute.size(%lay_11711) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11713 = cute.get_leaves(%sz_11712) : !cute.int_tuple<"16">
            %lay_11714 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %3909 = cute.get_shape(%lay_11714) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11715, %e1_11716, %e2_11717 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %int_tuple_11718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11719 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11720 = cute.get_leaves(%int_tuple_11719) : !cute.int_tuple<"16">
            %cst_11721 = arith.constant 0.000000e+00 : bf16
            %3910 = vector.splat %cst_11721 : vector<16xbf16>
            %int_tuple_11722 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11723 = cute.size(%int_tuple_11722) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11724 = cute.get_leaves(%sz_11723) : !cute.int_tuple<"16">
            %int_tuple_11725 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11726 = cute.size(%int_tuple_11725) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11727 = cute.get_leaves(%sz_11726) : !cute.int_tuple<"16">
            cute.memref.store_vec %3910, %view_11708 : !memref_smem_bf16_14
          }
          %coord_11670 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_11671 = cute.get_layout(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_11672 = cute.crd2idx(%coord_11670, %lay_11671) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_11673 = cute.get_iter(%view_1002) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_11674 = cute.add_offset(%iter_11673, %idx_11672) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_11675 = cute.make_view(%tup_11674) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_11676 = cute.get_iter(%view_11675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11677, %e1_11678, %e2_11679, %e3_11680 = cute.get_leaves(%iter_11676) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3888 = cute.get_scalars(%e0_11677) : !cute.int_tuple<"?">
          %3889 = cute.get_scalars(%e1_11678) : !cute.int_tuple<"?">
          %3890 = cute.get_scalars(%e2_11679) : !cute.int_tuple<"?">
          %3891 = cute.get_scalars(%e3_11680) : !cute.int_tuple<"?{div=8}">
          %iter_11681 = cute.get_iter(%view_11675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11682, %e1_11683, %e2_11684, %e3_11685 = cute.get_leaves(%iter_11681) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3892 = cute.get_scalars(%e0_11682) : !cute.int_tuple<"?">
          %3893 = cute.get_scalars(%e1_11683) : !cute.int_tuple<"?">
          %3894 = cute.get_scalars(%e2_11684) : !cute.int_tuple<"?">
          %3895 = cute.get_scalars(%e3_11685) : !cute.int_tuple<"?{div=8}">
          %iter_11686 = cute.get_iter(%view_11675) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_11687, %e1_11688, %e2_11689, %e3_11690 = cute.get_leaves(%iter_11686) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3896 = cute.get_scalars(%e0_11687) : !cute.int_tuple<"?">
          %3897 = cute.get_scalars(%e1_11688) : !cute.int_tuple<"?">
          %3898 = cute.get_scalars(%e2_11689) : !cute.int_tuple<"?">
          %3899 = cute.get_scalars(%e3_11690) : !cute.int_tuple<"?{div=8}">
          %lay_11691 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3900 = cute.get_shape(%lay_11691) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_11692, %e1_11693, %e2_11694, %e3_11695 = cute.get_leaves(%3900) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_11696 = cute.to_int_tuple(%e0_11692) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3901 = cute.get_scalars(%itup_11696) : !cute.int_tuple<"?">
          %itup_11697 = cute.to_int_tuple(%e1_11693) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3902 = cute.get_scalars(%itup_11697) : !cute.int_tuple<"?">
          %itup_11698 = cute.to_int_tuple(%e2_11694) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3903 = cute.get_scalars(%itup_11698) : !cute.int_tuple<"?">
          %itup_11699 = cute.to_int_tuple(%e3_11695) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3904 = cute.get_scalars(%itup_11699) : !cute.int_tuple<"?{div=8}">
          %coord_11700 = cute.make_coord(%e1_11688) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_11701 = cute.make_coord(%itup_11697) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3905 = cute.get_scalars(%coord_11700) : !cute.coord<"?">
          %3906 = cute.get_scalars(%coord_11701) : !cute.coord<"?">
          %true_11702 = arith.constant true
          %3907 = arith.cmpi slt, %3905, %3906 : i32
          %3908 = arith.andi %true_11702, %3907 : i1
          scf.if %3908 {
            %coord_11703 = cute.make_coord(%3397) : (i32) -> !cute.coord<"(_,3,_,?)">
            %lay_11704 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_11706 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_gmem_bf16_6
            %iter_11709 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %iter_11710 = cute.get_iter(%view_11708) : !memref_gmem_bf16_6
            %coord_11711 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11712 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11713 = cute.crd2idx(%coord_11711, %lay_11712) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_11714 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11715 = cute.add_offset(%iter_11714, %idx_11713) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11716 = cute.make_view(%ptr_11715) : !memref_smem_bf16_14
            %iter_11717 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %iter_11718 = cute.get_iter(%view_11716) : !memref_smem_bf16_14
            %coord_11719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11720 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
            %idx_11721 = cute.crd2idx(%coord_11719, %lay_11720) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_11722 = cute.get_iter(%rmem_1045) : !memref_rmem_i8_1
            %ptr_11723 = cute.add_offset(%iter_11722, %idx_11721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_11724 = cute.make_view(%ptr_11723) : !memref_rmem_i8_2
            %iter_11725 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %iter_11726 = cute.get_iter(%view_11724) : !memref_rmem_i8_2
            %lay_11727 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %3909 = cute.get_shape(%lay_11727) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11728, %e1_11729, %e2_11730 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %lay_11731 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %3910 = cute.get_shape(%lay_11731) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11732, %e1_11733, %e2_11734 = cute.get_leaves(%3910) : !cute.shape<"((8,1),2)">
            %lay_11735 = cute.get_layout(%view_11708) : !memref_gmem_bf16_6
            %shape_11736 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11737 = cute.make_layout() : !cute.layout<"1:0">
            %append_11738 = cute.append_to_rank<2> (%lay_11735, %lay_11737) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_11739 = cute.make_view(%iter_11710, %append_11738) : !memref_gmem_bf16_6
            %iter_11740 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %lay_11741 = cute.get_layout(%view_11739) : !memref_gmem_bf16_6
            %3911 = cute.get_shape(%lay_11741) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_11742, %e1_11743, %e2_11744 = cute.get_leaves(%3911) : !cute.shape<"((8,1),2)">
            %iter_11745 = cute.get_iter(%view_11739) : !memref_gmem_bf16_6
            %view_11746 = cute.make_view(%iter_11745) : !memref_gmem_bf16_7
            %iter_11747 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11748 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %lay_11749 = cute.get_layout(%view_11716) : !memref_smem_bf16_14
            %shape_11750 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11751 = cute.make_layout() : !cute.layout<"1:0">
            %append_11752 = cute.append_to_rank<2> (%lay_11749, %lay_11751) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_11753 = cute.make_view(%iter_11718, %append_11752) : !memref_smem_bf16_14
            %iter_11754 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %lay_11755 = cute.get_layout(%view_11753) : !memref_smem_bf16_14
            %3912 = cute.get_shape(%lay_11755) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11756, %e1_11757, %e2_11758 = cute.get_leaves(%3912) : !cute.shape<"((8,1),2)">
            %iter_11759 = cute.get_iter(%view_11753) : !memref_smem_bf16_14
            %view_11760 = cute.make_view(%iter_11759) : !memref_smem_bf16_15
            %iter_11761 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %iter_11762 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11763 = cute.get_layout(%view_11724) : !memref_rmem_i8_2
            %shape_11764 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_11765 = cute.make_layout() : !cute.layout<"1:0">
            %append_11766 = cute.append_to_rank<2> (%lay_11763, %lay_11765) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_11767 = cute.make_view(%iter_11726, %append_11766) : !memref_rmem_i8_2
            %iter_11768 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %lay_11769 = cute.get_layout(%view_11767) : !memref_rmem_i8_2
            %3913 = cute.get_shape(%lay_11769) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_11770, %e1_11771 = cute.get_leaves(%3913) : !cute.shape<"(1,2)">
            %iter_11772 = cute.get_iter(%view_11767) : !memref_rmem_i8_2
            %view_11773 = cute.make_view(%iter_11772) : !memref_rmem_i8_3
            %iter_11774 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %iter_11775 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11776 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %3914 = cute.get_shape(%lay_11776) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_11777, %e1_11778, %e2_11779 = cute.get_leaves(%3914) : !cute.shape<"((8,1),(2))">
            %lay_11780 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %3915 = cute.get_shape(%lay_11780) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_11781, %e1_11782, %e2_11783 = cute.get_leaves(%3915) : !cute.shape<"((8,1),(2))">
            %lay_11784 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %sz_11785 = cute.size(%lay_11784) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_11786 = cute.get_leaves(%sz_11785) : !cute.int_tuple<"2">
            %lay_11787 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %sz_11788 = cute.size(%lay_11787) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_11789 = cute.get_leaves(%sz_11788) : !cute.int_tuple<"2">
            %3916 = cute.static : !cute.layout<"1:0">
            %iter_11790 = cute.get_iter(%view_11746) : !memref_gmem_bf16_7
            %iter_11791 = cute.get_iter(%view_11760) : !memref_smem_bf16_15
            %lay_11792 = cute.get_layout(%view_11746) : !memref_gmem_bf16_7
            %lay_11793 = cute.get_layout(%view_11760) : !memref_smem_bf16_15
            %append_11794 = cute.append_to_rank<2> (%lay_11792, %3916) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_11795 = cute.append_to_rank<2> (%lay_11793, %3916) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_11796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_11797 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_11798 = cute.get_iter(%view_11773) : !memref_rmem_i8_3
            %lay_11799 = cute.get_layout(%view_11773) : !memref_rmem_i8_3
            %append_11800 = cute.append_to_rank<2> (%lay_11799, %3916) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_11801 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11802 = cute.size(%lay_11796) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3917 = cute.get_scalars(%sz_11802) : !cute.int_tuple<"2">
            %c0_i32_11803 = arith.constant 0 : i32
            %c1_i32_11804 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11803 to %3917 step %c1_i32_11804  : i32 {
              %coord_11805 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %3918 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11806 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11807 = cute.crd2idx(%coord_11805, %lay_11796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11808 = cute.add_offset(%iter_11790, %idx_11807) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11809 = cute.make_view(%ptr_11808, %lay_11806) : !memref_gmem_bf16_8
              %3919 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11810 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
              %idx_11811 = cute.crd2idx(%coord_11805, %lay_11797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11812 = cute.add_offset(%iter_11791, %idx_11811) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11813 = cute.make_view(%ptr_11812, %lay_11810) : !memref_smem_bf16_13
              %3920 = cute.get_scalars(%coord_11805) <{only_dynamic}> : !cute.coord<"(_,?)">
              %lay_11814 = cute.make_layout() : !cute.layout<"(1):(2)">
              %idx_11815 = cute.crd2idx(%coord_11805, %lay_11801) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11816 = cute.add_offset(%iter_11798, %idx_11815) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11817 = cute.make_view(%ptr_11816, %lay_11814) : !memref_rmem_i8_4
              %iter_11818 = cute.get_iter(%view_11809) : !memref_gmem_bf16_8
              %iter_11819 = cute.get_iter(%view_11813) : !memref_smem_bf16_13
              %iter_11820 = cute.get_iter(%view_11817) : !memref_rmem_i8_4
              %3921 = builtin.unrealized_conversion_cast %iter_11820 : !cute.ptr<i8, rmem> to !llvm.ptr
              %3922 = llvm.load %3921 : !llvm.ptr -> i8
              %3923 = llvm.trunc %3922 : i8 to i1
              %iter_11821 = cute.recast_iter(%iter_11818) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
              %iter_11822 = cute.recast_iter(%iter_11819) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
              cute_nvgpu.arch.copy.SM80.cp_async(%iter_11822 : !cute.ptr<i128, smem>, %iter_11821 : !cute.ptr<i128, gmem>, %3923 : i1) {cache_mode = <global>}
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_11703 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_11704 = cute.get_layout(%view_489) : !memref_smem_bf16_4
            %idx_11705 = cute.crd2idx(%coord_11703, %lay_11704) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_11706 = cute.get_iter(%view_489) : !memref_smem_bf16_4
            %ptr_11707 = cute.add_offset(%iter_11706, %idx_11705) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11708 = cute.make_view(%ptr_11707) : !memref_smem_bf16_14
            %iter_11709 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %iter_11710 = cute.get_iter(%view_11708) : !memref_smem_bf16_14
            %lay_11711 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %sz_11712 = cute.size(%lay_11711) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_11713 = cute.get_leaves(%sz_11712) : !cute.int_tuple<"16">
            %lay_11714 = cute.get_layout(%view_11708) : !memref_smem_bf16_14
            %3909 = cute.get_shape(%lay_11714) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_11715, %e1_11716, %e2_11717 = cute.get_leaves(%3909) : !cute.shape<"((8,1),2)">
            %int_tuple_11718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %int_tuple_11719 = cute.make_int_tuple() : () -> !cute.int_tuple<"16">
            %e0_11720 = cute.get_leaves(%int_tuple_11719) : !cute.int_tuple<"16">
            %cst_11721 = arith.constant 0.000000e+00 : bf16
            %3910 = vector.splat %cst_11721 : vector<16xbf16>
            %int_tuple_11722 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11723 = cute.size(%int_tuple_11722) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11724 = cute.get_leaves(%sz_11723) : !cute.int_tuple<"16">
            %int_tuple_11725 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_11726 = cute.size(%int_tuple_11725) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_11727 = cute.get_leaves(%sz_11726) : !cute.int_tuple<"16">
            cute.memref.store_vec %3910, %view_11708 : !memref_smem_bf16_14
          }
        } else {
          %coord_11563 = cute.make_coord(%3397) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_11564 = cute.get_layout(%view_444) : !memref_gmem_bf16_5
          %3824:3 = cute.get_scalars(%lay_11564) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_11565 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_11566 = cute.assume(%3824#1) : (i64) -> !cute.i64<divby 128>
          %stride_11567 = cute.make_stride(%iv_11566) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_11568 = cute.make_layout(%shape_11565, %stride_11567) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_11564) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_11570 = cute.get_iter(%view_444) : !memref_gmem_bf16_5
          %ptr_11571 = cute.add_offset(%iter_11570, %idx_11569) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_11572 = cute.make_view(%ptr_11571, %lay_11568) : !memref_gmem_bf16_9
          %iter_11573 = cute.get_iter(%view_11572) : !memref_gmem_bf16_9
          %iter_11574 = cute.get_iter(%view_11572) : !memref_gmem_bf16_9
          %lay_11575 = cute.get_layout(%view_11572) : !memref_gmem_bf16_9
          %3826 = cute.get_shape(%lay_11575) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11576, %e1_11577, %e2_11578, %e3_11579 = cute.get_leaves(%3826) : !cute.shape<"((8,1),4,2)">
          %lay_11580 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %3827 = cute.get_shape(%lay_11580) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11581, %e1_11582, %e2_11583, %e3_11584 = cute.get_leaves(%3827) : !cute.shape<"((8,1),4,2)">
          %lay_11585 = cute.get_layout(%view_11572) : !memref_gmem_bf16_9
          %shape_11586 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11587 = cute.make_layout() : !cute.layout<"1:0">
          %append_11588 = cute.append_to_rank<2> (%lay_11585, %lay_11587) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_11589 = cute.make_view(%iter_11574, %append_11588) : !memref_gmem_bf16_9
          %iter_11590 = cute.get_iter(%view_11589) : !memref_gmem_bf16_9
          %lay_11591 = cute.get_layout(%view_11589) : !memref_gmem_bf16_9
          %3828 = cute.get_shape(%lay_11591) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11592, %e1_11593, %e2_11594, %e3_11595 = cute.get_leaves(%3828) : !cute.shape<"((8,1),4,2)">
          %iter_11596 = cute.get_iter(%view_11589) : !memref_gmem_bf16_9
          %lay_11597 = cute.get_layout(%view_11589) : !memref_gmem_bf16_9
          %3829 = cute.get_scalars(%lay_11597) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_11598 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_11599 = cute.assume(%3829) : (i64) -> !cute.i64<divby 128>
          %stride_11600 = cute.make_stride(%iv_11599) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_11601 = cute.make_layout(%shape_11598, %stride_11600) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_11602 = cute.make_view(%iter_11596, %lay_11601) : !memref_gmem_bf16_10
          %iter_11603 = cute.get_iter(%view_11602) : !memref_gmem_bf16_10
          %iter_11604 = cute.get_iter(%view_11602) : !memref_gmem_bf16_10
          %lay_11605 = cute.get_layout(%view_489) : !memref_smem_bf16_4
          %shape_11606 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11607 = cute.make_layout() : !cute.layout<"1:0">
          %append_11608 = cute.append_to_rank<2> (%lay_11605, %lay_11607) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_11609 = cute.make_view(%iter_490, %append_11608) : !memref_smem_bf16_4
          %iter_11610 = cute.get_iter(%view_11609) : !memref_smem_bf16_4
          %lay_11611 = cute.get_layout(%view_11609) : !memref_smem_bf16_4
          %3830 = cute.get_shape(%lay_11611) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11612, %e1_11613, %e2_11614, %e3_11615 = cute.get_leaves(%3830) : !cute.shape<"((8,1),4,2)">
          %iter_11616 = cute.get_iter(%view_11609) : !memref_smem_bf16_4
          %view_11617 = cute.make_view(%iter_11616) : !memref_smem_bf16_16
          %iter_11618 = cute.get_iter(%view_11617) : !memref_smem_bf16_16
          %iter_11619 = cute.get_iter(%view_11617) : !memref_smem_bf16_16
          %lay_11620 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %shape_11621 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11622 = cute.make_layout() : !cute.layout<"1:0">
          %append_11623 = cute.append_to_rank<2> (%lay_11620, %lay_11622) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_11624 = cute.make_view(%iter_1047, %append_11623) : !memref_rmem_i8_1
          %iter_11625 = cute.get_iter(%view_11624) : !memref_rmem_i8_1
          %lay_11626 = cute.get_layout(%view_11624) : !memref_rmem_i8_1
          %3831 = cute.get_shape(%lay_11626) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_11627, %e1_11628, %e2_11629 = cute.get_leaves(%3831) : !cute.shape<"(1,4,2)">
          %iter_11630 = cute.get_iter(%view_11624) : !memref_rmem_i8_1
          %view_11631 = cute.make_view(%iter_11630) : !memref_rmem_i8_5
          %iter_11632 = cute.get_iter(%view_11631) : !memref_rmem_i8_5
          %iter_11633 = cute.get_iter(%view_11631) : !memref_rmem_i8_5
          %lay_11634 = cute.get_layout(%view_11602) : !memref_gmem_bf16_10
          %3832 = cute.get_shape(%lay_11634) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11635, %e1_11636, %e2_11637, %e3_11638 = cute.get_leaves(%3832) : !cute.shape<"((8,1),(4,2))">
          %lay_11639 = cute.get_layout(%view_11617) : !memref_smem_bf16_16
          %3833 = cute.get_shape(%lay_11639) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11640, %e1_11641, %e2_11642, %e3_11643 = cute.get_leaves(%3833) : !cute.shape<"((8,1),(4,2))">
          %lay_11644 = cute.get_layout(%view_11602) : !memref_gmem_bf16_10
          %sz_11645 = cute.size(%lay_11644) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_11646 = cute.get_leaves(%sz_11645) : !cute.int_tuple<"8">
          %lay_11647 = cute.get_layout(%view_11617) : !memref_smem_bf16_16
          %sz_11648 = cute.size(%lay_11647) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_11649 = cute.get_leaves(%sz_11648) : !cute.int_tuple<"8">
          %3834 = cute.static : !cute.layout<"1:0">
          %iter_11650 = cute.get_iter(%view_11602) : !memref_gmem_bf16_10
          %iter_11651 = cute.get_iter(%view_11617) : !memref_smem_bf16_16
          %lay_11652 = cute.get_layout(%view_11602) : !memref_gmem_bf16_10
          %lay_11653 = cute.get_layout(%view_11617) : !memref_smem_bf16_16
          %append_11654 = cute.append_to_rank<2> (%lay_11652, %3834) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_11655 = cute.append_to_rank<2> (%lay_11653, %3834) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %3835 = cute.get_scalars(%append_11654) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_11656 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_11657 = cute.assume(%3835) : (i64) -> !cute.i64<divby 128>
          %stride_11658 = cute.make_stride(%iv_11657) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_11659 = cute.make_layout(%shape_11656, %stride_11658) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_11660 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_11661 = cute.get_iter(%view_11631) : !memref_rmem_i8_5
          %lay_11662 = cute.get_layout(%view_11631) : !memref_rmem_i8_5
          %append_11663 = cute.append_to_rank<2> (%lay_11662, %3834) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_11664 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_11665 = cute.size(%lay_11659) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %3836 = cute.get_scalars(%sz_11665) : !cute.int_tuple<"8">
          %c0_i32_11666 = arith.constant 0 : i32
          %c1_i32_11667 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_11666 to %3836 step %c1_i32_11667  : i32 {
            %coord_11668 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %3837 = cute.get_scalars(%lay_11659) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %3838 = cute.get_scalars(%coord_11668) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11669 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11670 = cute.crd2idx(%coord_11668, %lay_11659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_11671 = cute.add_offset(%iter_11650, %idx_11670) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11672 = cute.make_view(%ptr_11671, %lay_11669) : !memref_gmem_bf16_8
            %3839 = cute.get_scalars(%coord_11668) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11673 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11674 = cute.crd2idx(%coord_11668, %lay_11660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_11675 = cute.add_offset(%iter_11651, %idx_11674) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11676 = cute.make_view(%ptr_11675, %lay_11673) : !memref_smem_bf16_13
            %3840 = cute.get_scalars(%coord_11668) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11677 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_11678 = cute.crd2idx(%coord_11668, %lay_11664) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_11679 = cute.add_offset(%iter_11661, %idx_11678) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_11680 = cute.make_view(%ptr_11679, %lay_11677) : !memref_rmem_i8_4
            %iter_11681 = cute.get_iter(%view_11672) : !memref_gmem_bf16_8
            %iter_11682 = cute.get_iter(%view_11676) : !memref_smem_bf16_13
            %iter_11683 = cute.get_iter(%view_11680) : !memref_rmem_i8_4
            %3841 = builtin.unrealized_conversion_cast %iter_11683 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3842 = llvm.load %3841 : !llvm.ptr -> i8
            %3843 = llvm.trunc %3842 : i8 to i1
            %iter_11684 = cute.recast_iter(%iter_11681) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_11685 = cute.recast_iter(%iter_11682) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_11685 : !cute.ptr<i128, smem>, %iter_11684 : !cute.ptr<i128, gmem>, %3843 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %coord_8673 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8674 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_8675 = cute.crd2idx(%coord_8673, %lay_8674) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_8676 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_8677 = cute.add_offset(%iter_8676, %idx_8675) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8678 = cute.make_view(%ptr_8677) : !memref_smem_bf16_14
        %iter_8679 = cute.get_iter(%view_8678) : !memref_smem_bf16_14
        %iter_8680 = cute.get_iter(%view_8678) : !memref_smem_bf16_14
        %coord_8681 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8682 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_8683 = cute.crd2idx(%coord_8681, %lay_8682) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_8684 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_8685 = cute.add_offset(%iter_8684, %idx_8683) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8686 = cute.make_view(%ptr_8685) : !memref_rmem_bf16_6
        %iter_8687 = cute.get_iter(%view_8686) : !memref_rmem_bf16_6
        %iter_8688 = cute.get_iter(%view_8686) : !memref_rmem_bf16_6
        %lay_8689 = cute.get_layout(%view_8678) : !memref_smem_bf16_14
        %3400 = cute.get_shape(%lay_8689) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8690, %e1_8691, %e2_8692 = cute.get_leaves(%3400) : !cute.shape<"((8,1),2)">
        %lay_8693 = cute.get_layout(%view_8686) : !memref_rmem_bf16_6
        %3401 = cute.get_shape(%lay_8693) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8694, %e1_8695, %e2_8696 = cute.get_leaves(%3401) : !cute.shape<"((8,1),2)">
        %lay_8697 = cute.get_layout(%view_8678) : !memref_smem_bf16_14
        %shape_8698 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8699 = cute.make_layout() : !cute.layout<"1:0">
        %append_8700 = cute.append_to_rank<2> (%lay_8697, %lay_8699) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8701 = cute.make_view(%iter_8680, %append_8700) : !memref_smem_bf16_14
        %iter_8702 = cute.get_iter(%view_8701) : !memref_smem_bf16_14
        %lay_8703 = cute.get_layout(%view_8701) : !memref_smem_bf16_14
        %3402 = cute.get_shape(%lay_8703) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8704, %e1_8705, %e2_8706 = cute.get_leaves(%3402) : !cute.shape<"((8,1),2)">
        %iter_8707 = cute.get_iter(%view_8701) : !memref_smem_bf16_14
        %view_8708 = cute.make_view(%iter_8707) : !memref_smem_bf16_15
        %iter_8709 = cute.get_iter(%view_8708) : !memref_smem_bf16_15
        %iter_8710 = cute.get_iter(%view_8708) : !memref_smem_bf16_15
        %lay_8711 = cute.get_layout(%view_8686) : !memref_rmem_bf16_6
        %shape_8712 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8713 = cute.make_layout() : !cute.layout<"1:0">
        %append_8714 = cute.append_to_rank<2> (%lay_8711, %lay_8713) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8715 = cute.make_view(%iter_8688, %append_8714) : !memref_rmem_bf16_6
        %iter_8716 = cute.get_iter(%view_8715) : !memref_rmem_bf16_6
        %lay_8717 = cute.get_layout(%view_8715) : !memref_rmem_bf16_6
        %3403 = cute.get_shape(%lay_8717) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8718, %e1_8719, %e2_8720 = cute.get_leaves(%3403) : !cute.shape<"((8,1),2)">
        %iter_8721 = cute.get_iter(%view_8715) : !memref_rmem_bf16_6
        %view_8722 = cute.make_view(%iter_8721) : !memref_rmem_bf16_7
        %iter_8723 = cute.get_iter(%view_8722) : !memref_rmem_bf16_7
        %iter_8724 = cute.get_iter(%view_8722) : !memref_rmem_bf16_7
        %lay_8725 = cute.get_layout(%view_8708) : !memref_smem_bf16_15
        %3404 = cute.get_shape(%lay_8725) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8726, %e1_8727, %e2_8728 = cute.get_leaves(%3404) : !cute.shape<"((8,1),(2))">
        %lay_8729 = cute.get_layout(%view_8722) : !memref_rmem_bf16_7
        %3405 = cute.get_shape(%lay_8729) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8730, %e1_8731, %e2_8732 = cute.get_leaves(%3405) : !cute.shape<"((8,1),(2))">
        %lay_8733 = cute.get_layout(%view_8708) : !memref_smem_bf16_15
        %sz_8734 = cute.size(%lay_8733) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8735 = cute.get_leaves(%sz_8734) : !cute.int_tuple<"2">
        %lay_8736 = cute.get_layout(%view_8722) : !memref_rmem_bf16_7
        %sz_8737 = cute.size(%lay_8736) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8738 = cute.get_leaves(%sz_8737) : !cute.int_tuple<"2">
        %3406 = cute.static : !cute.layout<"1:0">
        %iter_8739 = cute.get_iter(%view_8708) : !memref_smem_bf16_15
        %iter_8740 = cute.get_iter(%view_8722) : !memref_rmem_bf16_7
        %lay_8741 = cute.get_layout(%view_8708) : !memref_smem_bf16_15
        %lay_8742 = cute.get_layout(%view_8722) : !memref_rmem_bf16_7
        %append_8743 = cute.append_to_rank<2> (%lay_8741, %3406) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8744 = cute.append_to_rank<2> (%lay_8742, %3406) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8745 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8746 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8747 = cute.size(%lay_8745) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3407 = cute.get_scalars(%sz_8747) : !cute.int_tuple<"2">
        %c0_i32_8748 = arith.constant 0 : i32
        %c1_i32_8749 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8748 to %3407 step %c1_i32_8749  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_8745) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_8739, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_8746) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_8740, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8750 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8751 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_8752 = cute.crd2idx(%coord_8750, %lay_8751) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_8753 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_8754 = cute.add_offset(%iter_8753, %idx_8752) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8755 = cute.make_view(%ptr_8754) : !memref_smem_bf16_17
        %iter_8756 = cute.get_iter(%view_8755) : !memref_smem_bf16_17
        %iter_8757 = cute.get_iter(%view_8755) : !memref_smem_bf16_17
        %coord_8758 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8759 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_8760 = cute.crd2idx(%coord_8758, %lay_8759) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_8761 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_8762 = cute.add_offset(%iter_8761, %idx_8760) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8763 = cute.make_view(%ptr_8762) : !memref_rmem_bf16_9
        %iter_8764 = cute.get_iter(%view_8763) : !memref_rmem_bf16_9
        %iter_8765 = cute.get_iter(%view_8763) : !memref_rmem_bf16_9
        %lay_8766 = cute.get_layout(%view_8755) : !memref_smem_bf16_17
        %3408 = cute.get_shape(%lay_8766) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8767, %e1_8768, %e2_8769 = cute.get_leaves(%3408) : !cute.shape<"((8,1),4)">
        %lay_8770 = cute.get_layout(%view_8763) : !memref_rmem_bf16_9
        %3409 = cute.get_shape(%lay_8770) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8771, %e1_8772, %e2_8773 = cute.get_leaves(%3409) : !cute.shape<"((8,1),4)">
        %lay_8774 = cute.get_layout(%view_8755) : !memref_smem_bf16_17
        %shape_8775 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8776 = cute.make_layout() : !cute.layout<"1:0">
        %append_8777 = cute.append_to_rank<2> (%lay_8774, %lay_8776) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8778 = cute.make_view(%iter_8757, %append_8777) : !memref_smem_bf16_17
        %iter_8779 = cute.get_iter(%view_8778) : !memref_smem_bf16_17
        %lay_8780 = cute.get_layout(%view_8778) : !memref_smem_bf16_17
        %3410 = cute.get_shape(%lay_8780) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8781, %e1_8782, %e2_8783 = cute.get_leaves(%3410) : !cute.shape<"((8,1),4)">
        %iter_8784 = cute.get_iter(%view_8778) : !memref_smem_bf16_17
        %view_8785 = cute.make_view(%iter_8784) : !memref_smem_bf16_18
        %iter_8786 = cute.get_iter(%view_8785) : !memref_smem_bf16_18
        %iter_8787 = cute.get_iter(%view_8785) : !memref_smem_bf16_18
        %lay_8788 = cute.get_layout(%view_8763) : !memref_rmem_bf16_9
        %shape_8789 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8790 = cute.make_layout() : !cute.layout<"1:0">
        %append_8791 = cute.append_to_rank<2> (%lay_8788, %lay_8790) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8792 = cute.make_view(%iter_8765, %append_8791) : !memref_rmem_bf16_9
        %iter_8793 = cute.get_iter(%view_8792) : !memref_rmem_bf16_9
        %lay_8794 = cute.get_layout(%view_8792) : !memref_rmem_bf16_9
        %3411 = cute.get_shape(%lay_8794) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8795, %e1_8796, %e2_8797 = cute.get_leaves(%3411) : !cute.shape<"((8,1),4)">
        %iter_8798 = cute.get_iter(%view_8792) : !memref_rmem_bf16_9
        %view_8799 = cute.make_view(%iter_8798) : !memref_rmem_bf16_10
        %iter_8800 = cute.get_iter(%view_8799) : !memref_rmem_bf16_10
        %iter_8801 = cute.get_iter(%view_8799) : !memref_rmem_bf16_10
        %lay_8802 = cute.get_layout(%view_8785) : !memref_smem_bf16_18
        %3412 = cute.get_shape(%lay_8802) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8803, %e1_8804, %e2_8805 = cute.get_leaves(%3412) : !cute.shape<"((8,1),(4))">
        %lay_8806 = cute.get_layout(%view_8799) : !memref_rmem_bf16_10
        %3413 = cute.get_shape(%lay_8806) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8807, %e1_8808, %e2_8809 = cute.get_leaves(%3413) : !cute.shape<"((8,1),(4))">
        %lay_8810 = cute.get_layout(%view_8785) : !memref_smem_bf16_18
        %sz_8811 = cute.size(%lay_8810) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8812 = cute.get_leaves(%sz_8811) : !cute.int_tuple<"4">
        %lay_8813 = cute.get_layout(%view_8799) : !memref_rmem_bf16_10
        %sz_8814 = cute.size(%lay_8813) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8815 = cute.get_leaves(%sz_8814) : !cute.int_tuple<"4">
        %3414 = cute.static : !cute.layout<"1:0">
        %iter_8816 = cute.get_iter(%view_8785) : !memref_smem_bf16_18
        %iter_8817 = cute.get_iter(%view_8799) : !memref_rmem_bf16_10
        %lay_8818 = cute.get_layout(%view_8785) : !memref_smem_bf16_18
        %lay_8819 = cute.get_layout(%view_8799) : !memref_rmem_bf16_10
        %append_8820 = cute.append_to_rank<2> (%lay_8818, %3414) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8821 = cute.append_to_rank<2> (%lay_8819, %3414) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8822 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8823 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8824 = cute.size(%lay_8822) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3415 = cute.get_scalars(%sz_8824) : !cute.int_tuple<"4">
        %c0_i32_8825 = arith.constant 0 : i32
        %c1_i32_8826 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8825 to %3415 step %c1_i32_8826  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_8822) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_8816, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_8823) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_8817, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_8827 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %3416 = cute.get_shape(%lay_8827) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
        %e0_8828, %e1_8829, %e2_8830, %e3_8831, %e4_8832, %e5_8833 = cute.get_leaves(%3416) : !cute.shape<"((8,1),2,((2,2),2))">
        %int_tuple_8834 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8835 = cute.size(%int_tuple_8834) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8836 = cute.get_leaves(%sz_8835) : !cute.int_tuple<"8">
        %int_tuple_8837 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8838 = cute.size(%int_tuple_8837) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8839 = cute.get_leaves(%sz_8838) : !cute.int_tuple<"8">
        %coord_8840 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8841 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_8842 = cute.crd2idx(%coord_8840, %lay_8841) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8843 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_8844 = cute.add_offset(%iter_8843, %idx_8842) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8845 = cute.make_view(%ptr_8844) : !memref_smem_bf16_14
        %iter_8846 = cute.get_iter(%view_8845) : !memref_smem_bf16_14
        %iter_8847 = cute.get_iter(%view_8845) : !memref_smem_bf16_14
        %coord_8848 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8849 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_8850 = cute.crd2idx(%coord_8848, %lay_8849) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
        %iter_8851 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_8852 = cute.add_offset(%iter_8851, %idx_8850) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8853 = cute.make_view(%ptr_8852) : !memref_rmem_bf16_6
        %iter_8854 = cute.get_iter(%view_8853) : !memref_rmem_bf16_6
        %iter_8855 = cute.get_iter(%view_8853) : !memref_rmem_bf16_6
        %lay_8856 = cute.get_layout(%view_8845) : !memref_smem_bf16_14
        %3417 = cute.get_shape(%lay_8856) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8857, %e1_8858, %e2_8859 = cute.get_leaves(%3417) : !cute.shape<"((8,1),2)">
        %lay_8860 = cute.get_layout(%view_8853) : !memref_rmem_bf16_6
        %3418 = cute.get_shape(%lay_8860) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8861, %e1_8862, %e2_8863 = cute.get_leaves(%3418) : !cute.shape<"((8,1),2)">
        %lay_8864 = cute.get_layout(%view_8845) : !memref_smem_bf16_14
        %shape_8865 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8866 = cute.make_layout() : !cute.layout<"1:0">
        %append_8867 = cute.append_to_rank<2> (%lay_8864, %lay_8866) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8868 = cute.make_view(%iter_8847, %append_8867) : !memref_smem_bf16_14
        %iter_8869 = cute.get_iter(%view_8868) : !memref_smem_bf16_14
        %lay_8870 = cute.get_layout(%view_8868) : !memref_smem_bf16_14
        %3419 = cute.get_shape(%lay_8870) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8871, %e1_8872, %e2_8873 = cute.get_leaves(%3419) : !cute.shape<"((8,1),2)">
        %iter_8874 = cute.get_iter(%view_8868) : !memref_smem_bf16_14
        %view_8875 = cute.make_view(%iter_8874) : !memref_smem_bf16_15
        %iter_8876 = cute.get_iter(%view_8875) : !memref_smem_bf16_15
        %iter_8877 = cute.get_iter(%view_8875) : !memref_smem_bf16_15
        %lay_8878 = cute.get_layout(%view_8853) : !memref_rmem_bf16_6
        %shape_8879 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8880 = cute.make_layout() : !cute.layout<"1:0">
        %append_8881 = cute.append_to_rank<2> (%lay_8878, %lay_8880) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8882 = cute.make_view(%iter_8855, %append_8881) : !memref_rmem_bf16_6
        %iter_8883 = cute.get_iter(%view_8882) : !memref_rmem_bf16_6
        %lay_8884 = cute.get_layout(%view_8882) : !memref_rmem_bf16_6
        %3420 = cute.get_shape(%lay_8884) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8885, %e1_8886, %e2_8887 = cute.get_leaves(%3420) : !cute.shape<"((8,1),2)">
        %iter_8888 = cute.get_iter(%view_8882) : !memref_rmem_bf16_6
        %view_8889 = cute.make_view(%iter_8888) : !memref_rmem_bf16_7
        %iter_8890 = cute.get_iter(%view_8889) : !memref_rmem_bf16_7
        %iter_8891 = cute.get_iter(%view_8889) : !memref_rmem_bf16_7
        %lay_8892 = cute.get_layout(%view_8875) : !memref_smem_bf16_15
        %3421 = cute.get_shape(%lay_8892) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8893, %e1_8894, %e2_8895 = cute.get_leaves(%3421) : !cute.shape<"((8,1),(2))">
        %lay_8896 = cute.get_layout(%view_8889) : !memref_rmem_bf16_7
        %3422 = cute.get_shape(%lay_8896) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8897, %e1_8898, %e2_8899 = cute.get_leaves(%3422) : !cute.shape<"((8,1),(2))">
        %lay_8900 = cute.get_layout(%view_8875) : !memref_smem_bf16_15
        %sz_8901 = cute.size(%lay_8900) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8902 = cute.get_leaves(%sz_8901) : !cute.int_tuple<"2">
        %lay_8903 = cute.get_layout(%view_8889) : !memref_rmem_bf16_7
        %sz_8904 = cute.size(%lay_8903) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8905 = cute.get_leaves(%sz_8904) : !cute.int_tuple<"2">
        %3423 = cute.static : !cute.layout<"1:0">
        %iter_8906 = cute.get_iter(%view_8875) : !memref_smem_bf16_15
        %iter_8907 = cute.get_iter(%view_8889) : !memref_rmem_bf16_7
        %lay_8908 = cute.get_layout(%view_8875) : !memref_smem_bf16_15
        %lay_8909 = cute.get_layout(%view_8889) : !memref_rmem_bf16_7
        %append_8910 = cute.append_to_rank<2> (%lay_8908, %3423) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8911 = cute.append_to_rank<2> (%lay_8909, %3423) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8912 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8913 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8914 = cute.size(%lay_8912) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3424 = cute.get_scalars(%sz_8914) : !cute.int_tuple<"2">
        %c0_i32_8915 = arith.constant 0 : i32
        %c1_i32_8916 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8915 to %3424 step %c1_i32_8916  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_8912) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_8906, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_8913) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_8907, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8917 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8918 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_8919 = cute.crd2idx(%coord_8917, %lay_8918) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8920 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_8921 = cute.add_offset(%iter_8920, %idx_8919) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8922 = cute.make_view(%ptr_8921) : !memref_smem_bf16_17
        %iter_8923 = cute.get_iter(%view_8922) : !memref_smem_bf16_17
        %iter_8924 = cute.get_iter(%view_8922) : !memref_smem_bf16_17
        %coord_8925 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8926 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_8927 = cute.crd2idx(%coord_8925, %lay_8926) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
        %iter_8928 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_8929 = cute.add_offset(%iter_8928, %idx_8927) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8930 = cute.make_view(%ptr_8929) : !memref_rmem_bf16_9
        %iter_8931 = cute.get_iter(%view_8930) : !memref_rmem_bf16_9
        %iter_8932 = cute.get_iter(%view_8930) : !memref_rmem_bf16_9
        %lay_8933 = cute.get_layout(%view_8922) : !memref_smem_bf16_17
        %3425 = cute.get_shape(%lay_8933) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8934, %e1_8935, %e2_8936 = cute.get_leaves(%3425) : !cute.shape<"((8,1),4)">
        %lay_8937 = cute.get_layout(%view_8930) : !memref_rmem_bf16_9
        %3426 = cute.get_shape(%lay_8937) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8938, %e1_8939, %e2_8940 = cute.get_leaves(%3426) : !cute.shape<"((8,1),4)">
        %lay_8941 = cute.get_layout(%view_8922) : !memref_smem_bf16_17
        %shape_8942 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8943 = cute.make_layout() : !cute.layout<"1:0">
        %append_8944 = cute.append_to_rank<2> (%lay_8941, %lay_8943) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8945 = cute.make_view(%iter_8924, %append_8944) : !memref_smem_bf16_17
        %iter_8946 = cute.get_iter(%view_8945) : !memref_smem_bf16_17
        %lay_8947 = cute.get_layout(%view_8945) : !memref_smem_bf16_17
        %3427 = cute.get_shape(%lay_8947) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8948, %e1_8949, %e2_8950 = cute.get_leaves(%3427) : !cute.shape<"((8,1),4)">
        %iter_8951 = cute.get_iter(%view_8945) : !memref_smem_bf16_17
        %view_8952 = cute.make_view(%iter_8951) : !memref_smem_bf16_18
        %iter_8953 = cute.get_iter(%view_8952) : !memref_smem_bf16_18
        %iter_8954 = cute.get_iter(%view_8952) : !memref_smem_bf16_18
        %lay_8955 = cute.get_layout(%view_8930) : !memref_rmem_bf16_9
        %shape_8956 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8957 = cute.make_layout() : !cute.layout<"1:0">
        %append_8958 = cute.append_to_rank<2> (%lay_8955, %lay_8957) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8959 = cute.make_view(%iter_8932, %append_8958) : !memref_rmem_bf16_9
        %iter_8960 = cute.get_iter(%view_8959) : !memref_rmem_bf16_9
        %lay_8961 = cute.get_layout(%view_8959) : !memref_rmem_bf16_9
        %3428 = cute.get_shape(%lay_8961) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8962, %e1_8963, %e2_8964 = cute.get_leaves(%3428) : !cute.shape<"((8,1),4)">
        %iter_8965 = cute.get_iter(%view_8959) : !memref_rmem_bf16_9
        %view_8966 = cute.make_view(%iter_8965) : !memref_rmem_bf16_10
        %iter_8967 = cute.get_iter(%view_8966) : !memref_rmem_bf16_10
        %iter_8968 = cute.get_iter(%view_8966) : !memref_rmem_bf16_10
        %lay_8969 = cute.get_layout(%view_8952) : !memref_smem_bf16_18
        %3429 = cute.get_shape(%lay_8969) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8970, %e1_8971, %e2_8972 = cute.get_leaves(%3429) : !cute.shape<"((8,1),(4))">
        %lay_8973 = cute.get_layout(%view_8966) : !memref_rmem_bf16_10
        %3430 = cute.get_shape(%lay_8973) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8974, %e1_8975, %e2_8976 = cute.get_leaves(%3430) : !cute.shape<"((8,1),(4))">
        %lay_8977 = cute.get_layout(%view_8952) : !memref_smem_bf16_18
        %sz_8978 = cute.size(%lay_8977) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8979 = cute.get_leaves(%sz_8978) : !cute.int_tuple<"4">
        %lay_8980 = cute.get_layout(%view_8966) : !memref_rmem_bf16_10
        %sz_8981 = cute.size(%lay_8980) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8982 = cute.get_leaves(%sz_8981) : !cute.int_tuple<"4">
        %3431 = cute.static : !cute.layout<"1:0">
        %iter_8983 = cute.get_iter(%view_8952) : !memref_smem_bf16_18
        %iter_8984 = cute.get_iter(%view_8966) : !memref_rmem_bf16_10
        %lay_8985 = cute.get_layout(%view_8952) : !memref_smem_bf16_18
        %lay_8986 = cute.get_layout(%view_8966) : !memref_rmem_bf16_10
        %append_8987 = cute.append_to_rank<2> (%lay_8985, %3431) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8988 = cute.append_to_rank<2> (%lay_8986, %3431) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8989 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8990 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8991 = cute.size(%lay_8989) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3432 = cute.get_scalars(%sz_8991) : !cute.int_tuple<"4">
        %c0_i32_8992 = arith.constant 0 : i32
        %c1_i32_8993 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8992 to %3432 step %c1_i32_8993  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_8989) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_8983, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_8990) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_8984, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8994 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8995 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_8996 = cute.crd2idx(%coord_8994, %lay_8995) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
        %iter_8997 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_8998 = cute.add_offset(%iter_8997, %idx_8996) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8999 = cute.make_view(%ptr_8998) : !memref_rmem_bf16_12
        %iter_9000 = cute.get_iter(%view_8999) : !memref_rmem_bf16_12
        %iter_9001 = cute.get_iter(%view_8999) : !memref_rmem_bf16_12
        %coord_9002 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9003 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9004 = cute.crd2idx(%coord_9002, %lay_9003) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
        %iter_9005 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9006 = cute.add_offset(%iter_9005, %idx_9004) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9007 = cute.make_view(%ptr_9006) : !memref_rmem_bf16_13
        %iter_9008 = cute.get_iter(%view_9007) : !memref_rmem_bf16_13
        %iter_9009 = cute.get_iter(%view_9007) : !memref_rmem_bf16_13
        %lay_9010 = cute.get_layout(%view_8999) : !memref_rmem_bf16_12
        %3433 = cute.get_shape(%lay_9010) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9011, %e1_9012, %e2_9013, %e3_9014 = cute.get_leaves(%3433) : !cute.shape<"((2,2,2),2)">
        %lay_9015 = cute.get_layout(%view_9007) : !memref_rmem_bf16_13
        %3434 = cute.get_shape(%lay_9015) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9016, %e1_9017, %e2_9018 = cute.get_leaves(%3434) : !cute.shape<"((2,2),8)">
        %iter_9019 = cute.get_iter(%view_8999) : !memref_rmem_bf16_12
        %iter_9020 = cute.get_iter(%view_9007) : !memref_rmem_bf16_13
        %iter_9021 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_9022 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_9023 = cute.get_layout(%view_8999) : !memref_rmem_bf16_12
        %lay_9024 = cute.get_layout(%view_9007) : !memref_rmem_bf16_13
        %lay_9025 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_9026 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3435 = cute.static : !cute.layout<"1:0">
        %append_9027 = cute.append_to_rank<3> (%lay_9023, %3435) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9028 = cute.append_to_rank<3> (%lay_9024, %3435) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9029 = cute.size(%append_9027) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9030 = cute.size(%append_9027) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9031 = cute.size(%append_9028) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3436 = cute.get_scalars(%sz_9029) : !cute.int_tuple<"1">
        %3437 = cute.get_scalars(%sz_9030) : !cute.int_tuple<"2">
        %3438 = cute.get_scalars(%sz_9031) : !cute.int_tuple<"8">
        %c0_i32_9032 = arith.constant 0 : i32
        %c1_i32_9033 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9032 to %3436 step %c1_i32_9033  : i32 {
          scf.for %arg14 = %c0_i32_9032 to %3437 step %c1_i32_9033  : i32 {
            scf.for %arg15 = %c0_i32_9032 to %3438 step %c1_i32_9033  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_9027) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_9019, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_9028) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_9020, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_9025) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_9021, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_9026) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_9022, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9034 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9035 = cute.size(%int_tuple_9034) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9036 = cute.get_leaves(%sz_9035) : !cute.int_tuple<"8">
        %coord_9037 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9038 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_9039 = cute.crd2idx(%coord_9037, %lay_9038) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9040 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_9041 = cute.add_offset(%iter_9040, %idx_9039) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9042 = cute.make_view(%ptr_9041) : !memref_smem_bf16_14
        %iter_9043 = cute.get_iter(%view_9042) : !memref_smem_bf16_14
        %iter_9044 = cute.get_iter(%view_9042) : !memref_smem_bf16_14
        %coord_9045 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9046 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_9047 = cute.crd2idx(%coord_9045, %lay_9046) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
        %iter_9048 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_9049 = cute.add_offset(%iter_9048, %idx_9047) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9050 = cute.make_view(%ptr_9049) : !memref_rmem_bf16_6
        %iter_9051 = cute.get_iter(%view_9050) : !memref_rmem_bf16_6
        %iter_9052 = cute.get_iter(%view_9050) : !memref_rmem_bf16_6
        %lay_9053 = cute.get_layout(%view_9042) : !memref_smem_bf16_14
        %3439 = cute.get_shape(%lay_9053) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9054, %e1_9055, %e2_9056 = cute.get_leaves(%3439) : !cute.shape<"((8,1),2)">
        %lay_9057 = cute.get_layout(%view_9050) : !memref_rmem_bf16_6
        %3440 = cute.get_shape(%lay_9057) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9058, %e1_9059, %e2_9060 = cute.get_leaves(%3440) : !cute.shape<"((8,1),2)">
        %lay_9061 = cute.get_layout(%view_9042) : !memref_smem_bf16_14
        %shape_9062 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9063 = cute.make_layout() : !cute.layout<"1:0">
        %append_9064 = cute.append_to_rank<2> (%lay_9061, %lay_9063) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9065 = cute.make_view(%iter_9044, %append_9064) : !memref_smem_bf16_14
        %iter_9066 = cute.get_iter(%view_9065) : !memref_smem_bf16_14
        %lay_9067 = cute.get_layout(%view_9065) : !memref_smem_bf16_14
        %3441 = cute.get_shape(%lay_9067) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9068, %e1_9069, %e2_9070 = cute.get_leaves(%3441) : !cute.shape<"((8,1),2)">
        %iter_9071 = cute.get_iter(%view_9065) : !memref_smem_bf16_14
        %view_9072 = cute.make_view(%iter_9071) : !memref_smem_bf16_15
        %iter_9073 = cute.get_iter(%view_9072) : !memref_smem_bf16_15
        %iter_9074 = cute.get_iter(%view_9072) : !memref_smem_bf16_15
        %lay_9075 = cute.get_layout(%view_9050) : !memref_rmem_bf16_6
        %shape_9076 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9077 = cute.make_layout() : !cute.layout<"1:0">
        %append_9078 = cute.append_to_rank<2> (%lay_9075, %lay_9077) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9079 = cute.make_view(%iter_9052, %append_9078) : !memref_rmem_bf16_6
        %iter_9080 = cute.get_iter(%view_9079) : !memref_rmem_bf16_6
        %lay_9081 = cute.get_layout(%view_9079) : !memref_rmem_bf16_6
        %3442 = cute.get_shape(%lay_9081) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9082, %e1_9083, %e2_9084 = cute.get_leaves(%3442) : !cute.shape<"((8,1),2)">
        %iter_9085 = cute.get_iter(%view_9079) : !memref_rmem_bf16_6
        %view_9086 = cute.make_view(%iter_9085) : !memref_rmem_bf16_7
        %iter_9087 = cute.get_iter(%view_9086) : !memref_rmem_bf16_7
        %iter_9088 = cute.get_iter(%view_9086) : !memref_rmem_bf16_7
        %lay_9089 = cute.get_layout(%view_9072) : !memref_smem_bf16_15
        %3443 = cute.get_shape(%lay_9089) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9090, %e1_9091, %e2_9092 = cute.get_leaves(%3443) : !cute.shape<"((8,1),(2))">
        %lay_9093 = cute.get_layout(%view_9086) : !memref_rmem_bf16_7
        %3444 = cute.get_shape(%lay_9093) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9094, %e1_9095, %e2_9096 = cute.get_leaves(%3444) : !cute.shape<"((8,1),(2))">
        %lay_9097 = cute.get_layout(%view_9072) : !memref_smem_bf16_15
        %sz_9098 = cute.size(%lay_9097) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9099 = cute.get_leaves(%sz_9098) : !cute.int_tuple<"2">
        %lay_9100 = cute.get_layout(%view_9086) : !memref_rmem_bf16_7
        %sz_9101 = cute.size(%lay_9100) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9102 = cute.get_leaves(%sz_9101) : !cute.int_tuple<"2">
        %3445 = cute.static : !cute.layout<"1:0">
        %iter_9103 = cute.get_iter(%view_9072) : !memref_smem_bf16_15
        %iter_9104 = cute.get_iter(%view_9086) : !memref_rmem_bf16_7
        %lay_9105 = cute.get_layout(%view_9072) : !memref_smem_bf16_15
        %lay_9106 = cute.get_layout(%view_9086) : !memref_rmem_bf16_7
        %append_9107 = cute.append_to_rank<2> (%lay_9105, %3445) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9108 = cute.append_to_rank<2> (%lay_9106, %3445) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9109 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9110 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9111 = cute.size(%lay_9109) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3446 = cute.get_scalars(%sz_9111) : !cute.int_tuple<"2">
        %c0_i32_9112 = arith.constant 0 : i32
        %c1_i32_9113 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9112 to %3446 step %c1_i32_9113  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9109) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_9103, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9104, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9114 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9115 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_9116 = cute.crd2idx(%coord_9114, %lay_9115) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9117 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_9118 = cute.add_offset(%iter_9117, %idx_9116) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9119 = cute.make_view(%ptr_9118) : !memref_smem_bf16_17
        %iter_9120 = cute.get_iter(%view_9119) : !memref_smem_bf16_17
        %iter_9121 = cute.get_iter(%view_9119) : !memref_smem_bf16_17
        %coord_9122 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9123 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_9124 = cute.crd2idx(%coord_9122, %lay_9123) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
        %iter_9125 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_9126 = cute.add_offset(%iter_9125, %idx_9124) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9127 = cute.make_view(%ptr_9126) : !memref_rmem_bf16_9
        %iter_9128 = cute.get_iter(%view_9127) : !memref_rmem_bf16_9
        %iter_9129 = cute.get_iter(%view_9127) : !memref_rmem_bf16_9
        %lay_9130 = cute.get_layout(%view_9119) : !memref_smem_bf16_17
        %3447 = cute.get_shape(%lay_9130) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9131, %e1_9132, %e2_9133 = cute.get_leaves(%3447) : !cute.shape<"((8,1),4)">
        %lay_9134 = cute.get_layout(%view_9127) : !memref_rmem_bf16_9
        %3448 = cute.get_shape(%lay_9134) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9135, %e1_9136, %e2_9137 = cute.get_leaves(%3448) : !cute.shape<"((8,1),4)">
        %lay_9138 = cute.get_layout(%view_9119) : !memref_smem_bf16_17
        %shape_9139 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9140 = cute.make_layout() : !cute.layout<"1:0">
        %append_9141 = cute.append_to_rank<2> (%lay_9138, %lay_9140) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9142 = cute.make_view(%iter_9121, %append_9141) : !memref_smem_bf16_17
        %iter_9143 = cute.get_iter(%view_9142) : !memref_smem_bf16_17
        %lay_9144 = cute.get_layout(%view_9142) : !memref_smem_bf16_17
        %3449 = cute.get_shape(%lay_9144) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9145, %e1_9146, %e2_9147 = cute.get_leaves(%3449) : !cute.shape<"((8,1),4)">
        %iter_9148 = cute.get_iter(%view_9142) : !memref_smem_bf16_17
        %view_9149 = cute.make_view(%iter_9148) : !memref_smem_bf16_18
        %iter_9150 = cute.get_iter(%view_9149) : !memref_smem_bf16_18
        %iter_9151 = cute.get_iter(%view_9149) : !memref_smem_bf16_18
        %lay_9152 = cute.get_layout(%view_9127) : !memref_rmem_bf16_9
        %shape_9153 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9154 = cute.make_layout() : !cute.layout<"1:0">
        %append_9155 = cute.append_to_rank<2> (%lay_9152, %lay_9154) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9156 = cute.make_view(%iter_9129, %append_9155) : !memref_rmem_bf16_9
        %iter_9157 = cute.get_iter(%view_9156) : !memref_rmem_bf16_9
        %lay_9158 = cute.get_layout(%view_9156) : !memref_rmem_bf16_9
        %3450 = cute.get_shape(%lay_9158) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9159, %e1_9160, %e2_9161 = cute.get_leaves(%3450) : !cute.shape<"((8,1),4)">
        %iter_9162 = cute.get_iter(%view_9156) : !memref_rmem_bf16_9
        %view_9163 = cute.make_view(%iter_9162) : !memref_rmem_bf16_10
        %iter_9164 = cute.get_iter(%view_9163) : !memref_rmem_bf16_10
        %iter_9165 = cute.get_iter(%view_9163) : !memref_rmem_bf16_10
        %lay_9166 = cute.get_layout(%view_9149) : !memref_smem_bf16_18
        %3451 = cute.get_shape(%lay_9166) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9167, %e1_9168, %e2_9169 = cute.get_leaves(%3451) : !cute.shape<"((8,1),(4))">
        %lay_9170 = cute.get_layout(%view_9163) : !memref_rmem_bf16_10
        %3452 = cute.get_shape(%lay_9170) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9171, %e1_9172, %e2_9173 = cute.get_leaves(%3452) : !cute.shape<"((8,1),(4))">
        %lay_9174 = cute.get_layout(%view_9149) : !memref_smem_bf16_18
        %sz_9175 = cute.size(%lay_9174) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9176 = cute.get_leaves(%sz_9175) : !cute.int_tuple<"4">
        %lay_9177 = cute.get_layout(%view_9163) : !memref_rmem_bf16_10
        %sz_9178 = cute.size(%lay_9177) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9179 = cute.get_leaves(%sz_9178) : !cute.int_tuple<"4">
        %3453 = cute.static : !cute.layout<"1:0">
        %iter_9180 = cute.get_iter(%view_9149) : !memref_smem_bf16_18
        %iter_9181 = cute.get_iter(%view_9163) : !memref_rmem_bf16_10
        %lay_9182 = cute.get_layout(%view_9149) : !memref_smem_bf16_18
        %lay_9183 = cute.get_layout(%view_9163) : !memref_rmem_bf16_10
        %append_9184 = cute.append_to_rank<2> (%lay_9182, %3453) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9185 = cute.append_to_rank<2> (%lay_9183, %3453) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9186 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9187 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9188 = cute.size(%lay_9186) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3454 = cute.get_scalars(%sz_9188) : !cute.int_tuple<"4">
        %c0_i32_9189 = arith.constant 0 : i32
        %c1_i32_9190 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9189 to %3454 step %c1_i32_9190  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9186) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_9180, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9187) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9181, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9191 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_9192 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9193 = cute.crd2idx(%coord_9191, %lay_9192) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
        %iter_9194 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9195 = cute.add_offset(%iter_9194, %idx_9193) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9196 = cute.make_view(%ptr_9195) : !memref_rmem_bf16_12
        %iter_9197 = cute.get_iter(%view_9196) : !memref_rmem_bf16_12
        %iter_9198 = cute.get_iter(%view_9196) : !memref_rmem_bf16_12
        %coord_9199 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_9200 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9201 = cute.crd2idx(%coord_9199, %lay_9200) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
        %iter_9202 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9203 = cute.add_offset(%iter_9202, %idx_9201) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9204 = cute.make_view(%ptr_9203) : !memref_rmem_bf16_13
        %iter_9205 = cute.get_iter(%view_9204) : !memref_rmem_bf16_13
        %iter_9206 = cute.get_iter(%view_9204) : !memref_rmem_bf16_13
        %lay_9207 = cute.get_layout(%view_9196) : !memref_rmem_bf16_12
        %3455 = cute.get_shape(%lay_9207) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9208, %e1_9209, %e2_9210, %e3_9211 = cute.get_leaves(%3455) : !cute.shape<"((2,2,2),2)">
        %lay_9212 = cute.get_layout(%view_9204) : !memref_rmem_bf16_13
        %3456 = cute.get_shape(%lay_9212) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9213, %e1_9214, %e2_9215 = cute.get_leaves(%3456) : !cute.shape<"((2,2),8)">
        %iter_9216 = cute.get_iter(%view_9196) : !memref_rmem_bf16_12
        %iter_9217 = cute.get_iter(%view_9204) : !memref_rmem_bf16_13
        %iter_9218 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_9219 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_9220 = cute.get_layout(%view_9196) : !memref_rmem_bf16_12
        %lay_9221 = cute.get_layout(%view_9204) : !memref_rmem_bf16_13
        %lay_9222 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_9223 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3457 = cute.static : !cute.layout<"1:0">
        %append_9224 = cute.append_to_rank<3> (%lay_9220, %3457) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9225 = cute.append_to_rank<3> (%lay_9221, %3457) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9226 = cute.size(%append_9224) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9227 = cute.size(%append_9224) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9228 = cute.size(%append_9225) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3458 = cute.get_scalars(%sz_9226) : !cute.int_tuple<"1">
        %3459 = cute.get_scalars(%sz_9227) : !cute.int_tuple<"2">
        %3460 = cute.get_scalars(%sz_9228) : !cute.int_tuple<"8">
        %c0_i32_9229 = arith.constant 0 : i32
        %c1_i32_9230 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9229 to %3458 step %c1_i32_9230  : i32 {
          scf.for %arg14 = %c0_i32_9229 to %3459 step %c1_i32_9230  : i32 {
            scf.for %arg15 = %c0_i32_9229 to %3460 step %c1_i32_9230  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_9224) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_9216, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_9225) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_9217, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_9222) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_9218, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_9223) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_9219, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9231 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9232 = cute.size(%int_tuple_9231) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9233 = cute.get_leaves(%sz_9232) : !cute.int_tuple<"8">
        %coord_9234 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9235 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_9236 = cute.crd2idx(%coord_9234, %lay_9235) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9237 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_9238 = cute.add_offset(%iter_9237, %idx_9236) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9239 = cute.make_view(%ptr_9238) : !memref_smem_bf16_14
        %iter_9240 = cute.get_iter(%view_9239) : !memref_smem_bf16_14
        %iter_9241 = cute.get_iter(%view_9239) : !memref_smem_bf16_14
        %coord_9242 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9243 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_9244 = cute.crd2idx(%coord_9242, %lay_9243) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
        %iter_9245 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_9246 = cute.add_offset(%iter_9245, %idx_9244) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9247 = cute.make_view(%ptr_9246) : !memref_rmem_bf16_6
        %iter_9248 = cute.get_iter(%view_9247) : !memref_rmem_bf16_6
        %iter_9249 = cute.get_iter(%view_9247) : !memref_rmem_bf16_6
        %lay_9250 = cute.get_layout(%view_9239) : !memref_smem_bf16_14
        %3461 = cute.get_shape(%lay_9250) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9251, %e1_9252, %e2_9253 = cute.get_leaves(%3461) : !cute.shape<"((8,1),2)">
        %lay_9254 = cute.get_layout(%view_9247) : !memref_rmem_bf16_6
        %3462 = cute.get_shape(%lay_9254) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9255, %e1_9256, %e2_9257 = cute.get_leaves(%3462) : !cute.shape<"((8,1),2)">
        %lay_9258 = cute.get_layout(%view_9239) : !memref_smem_bf16_14
        %shape_9259 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9260 = cute.make_layout() : !cute.layout<"1:0">
        %append_9261 = cute.append_to_rank<2> (%lay_9258, %lay_9260) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9262 = cute.make_view(%iter_9241, %append_9261) : !memref_smem_bf16_14
        %iter_9263 = cute.get_iter(%view_9262) : !memref_smem_bf16_14
        %lay_9264 = cute.get_layout(%view_9262) : !memref_smem_bf16_14
        %3463 = cute.get_shape(%lay_9264) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9265, %e1_9266, %e2_9267 = cute.get_leaves(%3463) : !cute.shape<"((8,1),2)">
        %iter_9268 = cute.get_iter(%view_9262) : !memref_smem_bf16_14
        %view_9269 = cute.make_view(%iter_9268) : !memref_smem_bf16_15
        %iter_9270 = cute.get_iter(%view_9269) : !memref_smem_bf16_15
        %iter_9271 = cute.get_iter(%view_9269) : !memref_smem_bf16_15
        %lay_9272 = cute.get_layout(%view_9247) : !memref_rmem_bf16_6
        %shape_9273 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9274 = cute.make_layout() : !cute.layout<"1:0">
        %append_9275 = cute.append_to_rank<2> (%lay_9272, %lay_9274) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9276 = cute.make_view(%iter_9249, %append_9275) : !memref_rmem_bf16_6
        %iter_9277 = cute.get_iter(%view_9276) : !memref_rmem_bf16_6
        %lay_9278 = cute.get_layout(%view_9276) : !memref_rmem_bf16_6
        %3464 = cute.get_shape(%lay_9278) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9279, %e1_9280, %e2_9281 = cute.get_leaves(%3464) : !cute.shape<"((8,1),2)">
        %iter_9282 = cute.get_iter(%view_9276) : !memref_rmem_bf16_6
        %view_9283 = cute.make_view(%iter_9282) : !memref_rmem_bf16_7
        %iter_9284 = cute.get_iter(%view_9283) : !memref_rmem_bf16_7
        %iter_9285 = cute.get_iter(%view_9283) : !memref_rmem_bf16_7
        %lay_9286 = cute.get_layout(%view_9269) : !memref_smem_bf16_15
        %3465 = cute.get_shape(%lay_9286) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9287, %e1_9288, %e2_9289 = cute.get_leaves(%3465) : !cute.shape<"((8,1),(2))">
        %lay_9290 = cute.get_layout(%view_9283) : !memref_rmem_bf16_7
        %3466 = cute.get_shape(%lay_9290) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9291, %e1_9292, %e2_9293 = cute.get_leaves(%3466) : !cute.shape<"((8,1),(2))">
        %lay_9294 = cute.get_layout(%view_9269) : !memref_smem_bf16_15
        %sz_9295 = cute.size(%lay_9294) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9296 = cute.get_leaves(%sz_9295) : !cute.int_tuple<"2">
        %lay_9297 = cute.get_layout(%view_9283) : !memref_rmem_bf16_7
        %sz_9298 = cute.size(%lay_9297) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9299 = cute.get_leaves(%sz_9298) : !cute.int_tuple<"2">
        %3467 = cute.static : !cute.layout<"1:0">
        %iter_9300 = cute.get_iter(%view_9269) : !memref_smem_bf16_15
        %iter_9301 = cute.get_iter(%view_9283) : !memref_rmem_bf16_7
        %lay_9302 = cute.get_layout(%view_9269) : !memref_smem_bf16_15
        %lay_9303 = cute.get_layout(%view_9283) : !memref_rmem_bf16_7
        %append_9304 = cute.append_to_rank<2> (%lay_9302, %3467) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9305 = cute.append_to_rank<2> (%lay_9303, %3467) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9306 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9307 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9308 = cute.size(%lay_9306) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3468 = cute.get_scalars(%sz_9308) : !cute.int_tuple<"2">
        %c0_i32_9309 = arith.constant 0 : i32
        %c1_i32_9310 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9309 to %3468 step %c1_i32_9310  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9306) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_9300, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9307) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9301, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9311 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9312 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_9313 = cute.crd2idx(%coord_9311, %lay_9312) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9314 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_9315 = cute.add_offset(%iter_9314, %idx_9313) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9316 = cute.make_view(%ptr_9315) : !memref_smem_bf16_17
        %iter_9317 = cute.get_iter(%view_9316) : !memref_smem_bf16_17
        %iter_9318 = cute.get_iter(%view_9316) : !memref_smem_bf16_17
        %coord_9319 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9320 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_9321 = cute.crd2idx(%coord_9319, %lay_9320) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
        %iter_9322 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_9323 = cute.add_offset(%iter_9322, %idx_9321) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9324 = cute.make_view(%ptr_9323) : !memref_rmem_bf16_9
        %iter_9325 = cute.get_iter(%view_9324) : !memref_rmem_bf16_9
        %iter_9326 = cute.get_iter(%view_9324) : !memref_rmem_bf16_9
        %lay_9327 = cute.get_layout(%view_9316) : !memref_smem_bf16_17
        %3469 = cute.get_shape(%lay_9327) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9328, %e1_9329, %e2_9330 = cute.get_leaves(%3469) : !cute.shape<"((8,1),4)">
        %lay_9331 = cute.get_layout(%view_9324) : !memref_rmem_bf16_9
        %3470 = cute.get_shape(%lay_9331) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9332, %e1_9333, %e2_9334 = cute.get_leaves(%3470) : !cute.shape<"((8,1),4)">
        %lay_9335 = cute.get_layout(%view_9316) : !memref_smem_bf16_17
        %shape_9336 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9337 = cute.make_layout() : !cute.layout<"1:0">
        %append_9338 = cute.append_to_rank<2> (%lay_9335, %lay_9337) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9339 = cute.make_view(%iter_9318, %append_9338) : !memref_smem_bf16_17
        %iter_9340 = cute.get_iter(%view_9339) : !memref_smem_bf16_17
        %lay_9341 = cute.get_layout(%view_9339) : !memref_smem_bf16_17
        %3471 = cute.get_shape(%lay_9341) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9342, %e1_9343, %e2_9344 = cute.get_leaves(%3471) : !cute.shape<"((8,1),4)">
        %iter_9345 = cute.get_iter(%view_9339) : !memref_smem_bf16_17
        %view_9346 = cute.make_view(%iter_9345) : !memref_smem_bf16_18
        %iter_9347 = cute.get_iter(%view_9346) : !memref_smem_bf16_18
        %iter_9348 = cute.get_iter(%view_9346) : !memref_smem_bf16_18
        %lay_9349 = cute.get_layout(%view_9324) : !memref_rmem_bf16_9
        %shape_9350 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9351 = cute.make_layout() : !cute.layout<"1:0">
        %append_9352 = cute.append_to_rank<2> (%lay_9349, %lay_9351) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9353 = cute.make_view(%iter_9326, %append_9352) : !memref_rmem_bf16_9
        %iter_9354 = cute.get_iter(%view_9353) : !memref_rmem_bf16_9
        %lay_9355 = cute.get_layout(%view_9353) : !memref_rmem_bf16_9
        %3472 = cute.get_shape(%lay_9355) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9356, %e1_9357, %e2_9358 = cute.get_leaves(%3472) : !cute.shape<"((8,1),4)">
        %iter_9359 = cute.get_iter(%view_9353) : !memref_rmem_bf16_9
        %view_9360 = cute.make_view(%iter_9359) : !memref_rmem_bf16_10
        %iter_9361 = cute.get_iter(%view_9360) : !memref_rmem_bf16_10
        %iter_9362 = cute.get_iter(%view_9360) : !memref_rmem_bf16_10
        %lay_9363 = cute.get_layout(%view_9346) : !memref_smem_bf16_18
        %3473 = cute.get_shape(%lay_9363) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9364, %e1_9365, %e2_9366 = cute.get_leaves(%3473) : !cute.shape<"((8,1),(4))">
        %lay_9367 = cute.get_layout(%view_9360) : !memref_rmem_bf16_10
        %3474 = cute.get_shape(%lay_9367) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9368, %e1_9369, %e2_9370 = cute.get_leaves(%3474) : !cute.shape<"((8,1),(4))">
        %lay_9371 = cute.get_layout(%view_9346) : !memref_smem_bf16_18
        %sz_9372 = cute.size(%lay_9371) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9373 = cute.get_leaves(%sz_9372) : !cute.int_tuple<"4">
        %lay_9374 = cute.get_layout(%view_9360) : !memref_rmem_bf16_10
        %sz_9375 = cute.size(%lay_9374) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9376 = cute.get_leaves(%sz_9375) : !cute.int_tuple<"4">
        %3475 = cute.static : !cute.layout<"1:0">
        %iter_9377 = cute.get_iter(%view_9346) : !memref_smem_bf16_18
        %iter_9378 = cute.get_iter(%view_9360) : !memref_rmem_bf16_10
        %lay_9379 = cute.get_layout(%view_9346) : !memref_smem_bf16_18
        %lay_9380 = cute.get_layout(%view_9360) : !memref_rmem_bf16_10
        %append_9381 = cute.append_to_rank<2> (%lay_9379, %3475) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9382 = cute.append_to_rank<2> (%lay_9380, %3475) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9383 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9384 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9385 = cute.size(%lay_9383) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3476 = cute.get_scalars(%sz_9385) : !cute.int_tuple<"4">
        %c0_i32_9386 = arith.constant 0 : i32
        %c1_i32_9387 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9386 to %3476 step %c1_i32_9387  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9383) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_9377, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9384) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9378, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9388 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9389 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9390 = cute.crd2idx(%coord_9388, %lay_9389) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
        %iter_9391 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9392 = cute.add_offset(%iter_9391, %idx_9390) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9393 = cute.make_view(%ptr_9392) : !memref_rmem_bf16_12
        %iter_9394 = cute.get_iter(%view_9393) : !memref_rmem_bf16_12
        %iter_9395 = cute.get_iter(%view_9393) : !memref_rmem_bf16_12
        %coord_9396 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_9397 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9398 = cute.crd2idx(%coord_9396, %lay_9397) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
        %iter_9399 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9400 = cute.add_offset(%iter_9399, %idx_9398) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9401 = cute.make_view(%ptr_9400) : !memref_rmem_bf16_13
        %iter_9402 = cute.get_iter(%view_9401) : !memref_rmem_bf16_13
        %iter_9403 = cute.get_iter(%view_9401) : !memref_rmem_bf16_13
        %lay_9404 = cute.get_layout(%view_9393) : !memref_rmem_bf16_12
        %3477 = cute.get_shape(%lay_9404) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9405, %e1_9406, %e2_9407, %e3_9408 = cute.get_leaves(%3477) : !cute.shape<"((2,2,2),2)">
        %lay_9409 = cute.get_layout(%view_9401) : !memref_rmem_bf16_13
        %3478 = cute.get_shape(%lay_9409) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9410, %e1_9411, %e2_9412 = cute.get_leaves(%3478) : !cute.shape<"((2,2),8)">
        %iter_9413 = cute.get_iter(%view_9393) : !memref_rmem_bf16_12
        %iter_9414 = cute.get_iter(%view_9401) : !memref_rmem_bf16_13
        %iter_9415 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_9416 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_9417 = cute.get_layout(%view_9393) : !memref_rmem_bf16_12
        %lay_9418 = cute.get_layout(%view_9401) : !memref_rmem_bf16_13
        %lay_9419 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_9420 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3479 = cute.static : !cute.layout<"1:0">
        %append_9421 = cute.append_to_rank<3> (%lay_9417, %3479) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9422 = cute.append_to_rank<3> (%lay_9418, %3479) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9423 = cute.size(%append_9421) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9424 = cute.size(%append_9421) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9425 = cute.size(%append_9422) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3480 = cute.get_scalars(%sz_9423) : !cute.int_tuple<"1">
        %3481 = cute.get_scalars(%sz_9424) : !cute.int_tuple<"2">
        %3482 = cute.get_scalars(%sz_9425) : !cute.int_tuple<"8">
        %c0_i32_9426 = arith.constant 0 : i32
        %c1_i32_9427 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9426 to %3480 step %c1_i32_9427  : i32 {
          scf.for %arg14 = %c0_i32_9426 to %3481 step %c1_i32_9427  : i32 {
            scf.for %arg15 = %c0_i32_9426 to %3482 step %c1_i32_9427  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_9421) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_9413, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_9422) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_9414, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_9419) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_9415, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_9420) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_9416, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9428 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9429 = cute.size(%int_tuple_9428) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9430 = cute.get_leaves(%sz_9429) : !cute.int_tuple<"8">
        %coord_9431 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9432 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_9433 = cute.crd2idx(%coord_9431, %lay_9432) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
        %iter_9434 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_9435 = cute.add_offset(%iter_9434, %idx_9433) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9436 = cute.make_view(%ptr_9435) : !memref_smem_bf16_14
        %iter_9437 = cute.get_iter(%view_9436) : !memref_smem_bf16_14
        %iter_9438 = cute.get_iter(%view_9436) : !memref_smem_bf16_14
        %coord_9439 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9440 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_9441 = cute.crd2idx(%coord_9439, %lay_9440) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
        %iter_9442 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_9443 = cute.add_offset(%iter_9442, %idx_9441) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9444 = cute.make_view(%ptr_9443) : !memref_rmem_bf16_6
        %iter_9445 = cute.get_iter(%view_9444) : !memref_rmem_bf16_6
        %iter_9446 = cute.get_iter(%view_9444) : !memref_rmem_bf16_6
        %lay_9447 = cute.get_layout(%view_9436) : !memref_smem_bf16_14
        %3483 = cute.get_shape(%lay_9447) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9448, %e1_9449, %e2_9450 = cute.get_leaves(%3483) : !cute.shape<"((8,1),2)">
        %lay_9451 = cute.get_layout(%view_9444) : !memref_rmem_bf16_6
        %3484 = cute.get_shape(%lay_9451) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9452, %e1_9453, %e2_9454 = cute.get_leaves(%3484) : !cute.shape<"((8,1),2)">
        %lay_9455 = cute.get_layout(%view_9436) : !memref_smem_bf16_14
        %shape_9456 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9457 = cute.make_layout() : !cute.layout<"1:0">
        %append_9458 = cute.append_to_rank<2> (%lay_9455, %lay_9457) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9459 = cute.make_view(%iter_9438, %append_9458) : !memref_smem_bf16_14
        %iter_9460 = cute.get_iter(%view_9459) : !memref_smem_bf16_14
        %lay_9461 = cute.get_layout(%view_9459) : !memref_smem_bf16_14
        %3485 = cute.get_shape(%lay_9461) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9462, %e1_9463, %e2_9464 = cute.get_leaves(%3485) : !cute.shape<"((8,1),2)">
        %iter_9465 = cute.get_iter(%view_9459) : !memref_smem_bf16_14
        %view_9466 = cute.make_view(%iter_9465) : !memref_smem_bf16_15
        %iter_9467 = cute.get_iter(%view_9466) : !memref_smem_bf16_15
        %iter_9468 = cute.get_iter(%view_9466) : !memref_smem_bf16_15
        %lay_9469 = cute.get_layout(%view_9444) : !memref_rmem_bf16_6
        %shape_9470 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9471 = cute.make_layout() : !cute.layout<"1:0">
        %append_9472 = cute.append_to_rank<2> (%lay_9469, %lay_9471) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9473 = cute.make_view(%iter_9446, %append_9472) : !memref_rmem_bf16_6
        %iter_9474 = cute.get_iter(%view_9473) : !memref_rmem_bf16_6
        %lay_9475 = cute.get_layout(%view_9473) : !memref_rmem_bf16_6
        %3486 = cute.get_shape(%lay_9475) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9476, %e1_9477, %e2_9478 = cute.get_leaves(%3486) : !cute.shape<"((8,1),2)">
        %iter_9479 = cute.get_iter(%view_9473) : !memref_rmem_bf16_6
        %view_9480 = cute.make_view(%iter_9479) : !memref_rmem_bf16_7
        %iter_9481 = cute.get_iter(%view_9480) : !memref_rmem_bf16_7
        %iter_9482 = cute.get_iter(%view_9480) : !memref_rmem_bf16_7
        %lay_9483 = cute.get_layout(%view_9466) : !memref_smem_bf16_15
        %3487 = cute.get_shape(%lay_9483) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9484, %e1_9485, %e2_9486 = cute.get_leaves(%3487) : !cute.shape<"((8,1),(2))">
        %lay_9487 = cute.get_layout(%view_9480) : !memref_rmem_bf16_7
        %3488 = cute.get_shape(%lay_9487) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9488, %e1_9489, %e2_9490 = cute.get_leaves(%3488) : !cute.shape<"((8,1),(2))">
        %lay_9491 = cute.get_layout(%view_9466) : !memref_smem_bf16_15
        %sz_9492 = cute.size(%lay_9491) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9493 = cute.get_leaves(%sz_9492) : !cute.int_tuple<"2">
        %lay_9494 = cute.get_layout(%view_9480) : !memref_rmem_bf16_7
        %sz_9495 = cute.size(%lay_9494) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9496 = cute.get_leaves(%sz_9495) : !cute.int_tuple<"2">
        %3489 = cute.static : !cute.layout<"1:0">
        %iter_9497 = cute.get_iter(%view_9466) : !memref_smem_bf16_15
        %iter_9498 = cute.get_iter(%view_9480) : !memref_rmem_bf16_7
        %lay_9499 = cute.get_layout(%view_9466) : !memref_smem_bf16_15
        %lay_9500 = cute.get_layout(%view_9480) : !memref_rmem_bf16_7
        %append_9501 = cute.append_to_rank<2> (%lay_9499, %3489) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9502 = cute.append_to_rank<2> (%lay_9500, %3489) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9503 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9504 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9505 = cute.size(%lay_9503) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3490 = cute.get_scalars(%sz_9505) : !cute.int_tuple<"2">
        %c0_i32_9506 = arith.constant 0 : i32
        %c1_i32_9507 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9506 to %3490 step %c1_i32_9507  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9503) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_9497, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9504) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9498, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9508 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9509 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_9510 = cute.crd2idx(%coord_9508, %lay_9509) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
        %iter_9511 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_9512 = cute.add_offset(%iter_9511, %idx_9510) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9513 = cute.make_view(%ptr_9512) : !memref_smem_bf16_17
        %iter_9514 = cute.get_iter(%view_9513) : !memref_smem_bf16_17
        %iter_9515 = cute.get_iter(%view_9513) : !memref_smem_bf16_17
        %coord_9516 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9517 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_9518 = cute.crd2idx(%coord_9516, %lay_9517) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
        %iter_9519 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_9520 = cute.add_offset(%iter_9519, %idx_9518) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9521 = cute.make_view(%ptr_9520) : !memref_rmem_bf16_9
        %iter_9522 = cute.get_iter(%view_9521) : !memref_rmem_bf16_9
        %iter_9523 = cute.get_iter(%view_9521) : !memref_rmem_bf16_9
        %lay_9524 = cute.get_layout(%view_9513) : !memref_smem_bf16_17
        %3491 = cute.get_shape(%lay_9524) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9525, %e1_9526, %e2_9527 = cute.get_leaves(%3491) : !cute.shape<"((8,1),4)">
        %lay_9528 = cute.get_layout(%view_9521) : !memref_rmem_bf16_9
        %3492 = cute.get_shape(%lay_9528) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9529, %e1_9530, %e2_9531 = cute.get_leaves(%3492) : !cute.shape<"((8,1),4)">
        %lay_9532 = cute.get_layout(%view_9513) : !memref_smem_bf16_17
        %shape_9533 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9534 = cute.make_layout() : !cute.layout<"1:0">
        %append_9535 = cute.append_to_rank<2> (%lay_9532, %lay_9534) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9536 = cute.make_view(%iter_9515, %append_9535) : !memref_smem_bf16_17
        %iter_9537 = cute.get_iter(%view_9536) : !memref_smem_bf16_17
        %lay_9538 = cute.get_layout(%view_9536) : !memref_smem_bf16_17
        %3493 = cute.get_shape(%lay_9538) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9539, %e1_9540, %e2_9541 = cute.get_leaves(%3493) : !cute.shape<"((8,1),4)">
        %iter_9542 = cute.get_iter(%view_9536) : !memref_smem_bf16_17
        %view_9543 = cute.make_view(%iter_9542) : !memref_smem_bf16_18
        %iter_9544 = cute.get_iter(%view_9543) : !memref_smem_bf16_18
        %iter_9545 = cute.get_iter(%view_9543) : !memref_smem_bf16_18
        %lay_9546 = cute.get_layout(%view_9521) : !memref_rmem_bf16_9
        %shape_9547 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9548 = cute.make_layout() : !cute.layout<"1:0">
        %append_9549 = cute.append_to_rank<2> (%lay_9546, %lay_9548) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9550 = cute.make_view(%iter_9523, %append_9549) : !memref_rmem_bf16_9
        %iter_9551 = cute.get_iter(%view_9550) : !memref_rmem_bf16_9
        %lay_9552 = cute.get_layout(%view_9550) : !memref_rmem_bf16_9
        %3494 = cute.get_shape(%lay_9552) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9553, %e1_9554, %e2_9555 = cute.get_leaves(%3494) : !cute.shape<"((8,1),4)">
        %iter_9556 = cute.get_iter(%view_9550) : !memref_rmem_bf16_9
        %view_9557 = cute.make_view(%iter_9556) : !memref_rmem_bf16_10
        %iter_9558 = cute.get_iter(%view_9557) : !memref_rmem_bf16_10
        %iter_9559 = cute.get_iter(%view_9557) : !memref_rmem_bf16_10
        %lay_9560 = cute.get_layout(%view_9543) : !memref_smem_bf16_18
        %3495 = cute.get_shape(%lay_9560) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9561, %e1_9562, %e2_9563 = cute.get_leaves(%3495) : !cute.shape<"((8,1),(4))">
        %lay_9564 = cute.get_layout(%view_9557) : !memref_rmem_bf16_10
        %3496 = cute.get_shape(%lay_9564) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9565, %e1_9566, %e2_9567 = cute.get_leaves(%3496) : !cute.shape<"((8,1),(4))">
        %lay_9568 = cute.get_layout(%view_9543) : !memref_smem_bf16_18
        %sz_9569 = cute.size(%lay_9568) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9570 = cute.get_leaves(%sz_9569) : !cute.int_tuple<"4">
        %lay_9571 = cute.get_layout(%view_9557) : !memref_rmem_bf16_10
        %sz_9572 = cute.size(%lay_9571) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9573 = cute.get_leaves(%sz_9572) : !cute.int_tuple<"4">
        %3497 = cute.static : !cute.layout<"1:0">
        %iter_9574 = cute.get_iter(%view_9543) : !memref_smem_bf16_18
        %iter_9575 = cute.get_iter(%view_9557) : !memref_rmem_bf16_10
        %lay_9576 = cute.get_layout(%view_9543) : !memref_smem_bf16_18
        %lay_9577 = cute.get_layout(%view_9557) : !memref_rmem_bf16_10
        %append_9578 = cute.append_to_rank<2> (%lay_9576, %3497) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9579 = cute.append_to_rank<2> (%lay_9577, %3497) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9580 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9581 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9582 = cute.size(%lay_9580) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3498 = cute.get_scalars(%sz_9582) : !cute.int_tuple<"4">
        %c0_i32_9583 = arith.constant 0 : i32
        %c1_i32_9584 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9583 to %3498 step %c1_i32_9584  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9580) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_9574, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9581) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9575, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9585 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9586 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9587 = cute.crd2idx(%coord_9585, %lay_9586) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
        %iter_9588 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9589 = cute.add_offset(%iter_9588, %idx_9587) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9590 = cute.make_view(%ptr_9589) : !memref_rmem_bf16_12
        %iter_9591 = cute.get_iter(%view_9590) : !memref_rmem_bf16_12
        %iter_9592 = cute.get_iter(%view_9590) : !memref_rmem_bf16_12
        %coord_9593 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_9594 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9595 = cute.crd2idx(%coord_9593, %lay_9594) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
        %iter_9596 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9597 = cute.add_offset(%iter_9596, %idx_9595) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9598 = cute.make_view(%ptr_9597) : !memref_rmem_bf16_13
        %iter_9599 = cute.get_iter(%view_9598) : !memref_rmem_bf16_13
        %iter_9600 = cute.get_iter(%view_9598) : !memref_rmem_bf16_13
        %lay_9601 = cute.get_layout(%view_9590) : !memref_rmem_bf16_12
        %3499 = cute.get_shape(%lay_9601) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9602, %e1_9603, %e2_9604, %e3_9605 = cute.get_leaves(%3499) : !cute.shape<"((2,2,2),2)">
        %lay_9606 = cute.get_layout(%view_9598) : !memref_rmem_bf16_13
        %3500 = cute.get_shape(%lay_9606) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9607, %e1_9608, %e2_9609 = cute.get_leaves(%3500) : !cute.shape<"((2,2),8)">
        %iter_9610 = cute.get_iter(%view_9590) : !memref_rmem_bf16_12
        %iter_9611 = cute.get_iter(%view_9598) : !memref_rmem_bf16_13
        %iter_9612 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_9613 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_9614 = cute.get_layout(%view_9590) : !memref_rmem_bf16_12
        %lay_9615 = cute.get_layout(%view_9598) : !memref_rmem_bf16_13
        %lay_9616 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_9617 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3501 = cute.static : !cute.layout<"1:0">
        %append_9618 = cute.append_to_rank<3> (%lay_9614, %3501) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9619 = cute.append_to_rank<3> (%lay_9615, %3501) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9620 = cute.size(%append_9618) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9621 = cute.size(%append_9618) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9622 = cute.size(%append_9619) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3502 = cute.get_scalars(%sz_9620) : !cute.int_tuple<"1">
        %3503 = cute.get_scalars(%sz_9621) : !cute.int_tuple<"2">
        %3504 = cute.get_scalars(%sz_9622) : !cute.int_tuple<"8">
        %c0_i32_9623 = arith.constant 0 : i32
        %c1_i32_9624 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9623 to %3502 step %c1_i32_9624  : i32 {
          scf.for %arg14 = %c0_i32_9623 to %3503 step %c1_i32_9624  : i32 {
            scf.for %arg15 = %c0_i32_9623 to %3504 step %c1_i32_9624  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_9618) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_9610, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_9619) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_9611, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_9616) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_9612, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_9617) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_9613, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9625 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9626 = cute.size(%int_tuple_9625) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9627 = cute.get_leaves(%sz_9626) : !cute.int_tuple<"8">
        %coord_9628 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9629 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_9630 = cute.crd2idx(%coord_9628, %lay_9629) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9631 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_9632 = cute.add_offset(%iter_9631, %idx_9630) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9633 = cute.make_view(%ptr_9632) : !memref_smem_bf16_14
        %iter_9634 = cute.get_iter(%view_9633) : !memref_smem_bf16_14
        %iter_9635 = cute.get_iter(%view_9633) : !memref_smem_bf16_14
        %coord_9636 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9637 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_9638 = cute.crd2idx(%coord_9636, %lay_9637) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
        %iter_9639 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_9640 = cute.add_offset(%iter_9639, %idx_9638) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9641 = cute.make_view(%ptr_9640) : !memref_rmem_bf16_6
        %iter_9642 = cute.get_iter(%view_9641) : !memref_rmem_bf16_6
        %iter_9643 = cute.get_iter(%view_9641) : !memref_rmem_bf16_6
        %lay_9644 = cute.get_layout(%view_9633) : !memref_smem_bf16_14
        %3505 = cute.get_shape(%lay_9644) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9645, %e1_9646, %e2_9647 = cute.get_leaves(%3505) : !cute.shape<"((8,1),2)">
        %lay_9648 = cute.get_layout(%view_9641) : !memref_rmem_bf16_6
        %3506 = cute.get_shape(%lay_9648) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9649, %e1_9650, %e2_9651 = cute.get_leaves(%3506) : !cute.shape<"((8,1),2)">
        %lay_9652 = cute.get_layout(%view_9633) : !memref_smem_bf16_14
        %shape_9653 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9654 = cute.make_layout() : !cute.layout<"1:0">
        %append_9655 = cute.append_to_rank<2> (%lay_9652, %lay_9654) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9656 = cute.make_view(%iter_9635, %append_9655) : !memref_smem_bf16_14
        %iter_9657 = cute.get_iter(%view_9656) : !memref_smem_bf16_14
        %lay_9658 = cute.get_layout(%view_9656) : !memref_smem_bf16_14
        %3507 = cute.get_shape(%lay_9658) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9659, %e1_9660, %e2_9661 = cute.get_leaves(%3507) : !cute.shape<"((8,1),2)">
        %iter_9662 = cute.get_iter(%view_9656) : !memref_smem_bf16_14
        %view_9663 = cute.make_view(%iter_9662) : !memref_smem_bf16_15
        %iter_9664 = cute.get_iter(%view_9663) : !memref_smem_bf16_15
        %iter_9665 = cute.get_iter(%view_9663) : !memref_smem_bf16_15
        %lay_9666 = cute.get_layout(%view_9641) : !memref_rmem_bf16_6
        %shape_9667 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9668 = cute.make_layout() : !cute.layout<"1:0">
        %append_9669 = cute.append_to_rank<2> (%lay_9666, %lay_9668) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9670 = cute.make_view(%iter_9643, %append_9669) : !memref_rmem_bf16_6
        %iter_9671 = cute.get_iter(%view_9670) : !memref_rmem_bf16_6
        %lay_9672 = cute.get_layout(%view_9670) : !memref_rmem_bf16_6
        %3508 = cute.get_shape(%lay_9672) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9673, %e1_9674, %e2_9675 = cute.get_leaves(%3508) : !cute.shape<"((8,1),2)">
        %iter_9676 = cute.get_iter(%view_9670) : !memref_rmem_bf16_6
        %view_9677 = cute.make_view(%iter_9676) : !memref_rmem_bf16_7
        %iter_9678 = cute.get_iter(%view_9677) : !memref_rmem_bf16_7
        %iter_9679 = cute.get_iter(%view_9677) : !memref_rmem_bf16_7
        %lay_9680 = cute.get_layout(%view_9663) : !memref_smem_bf16_15
        %3509 = cute.get_shape(%lay_9680) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9681, %e1_9682, %e2_9683 = cute.get_leaves(%3509) : !cute.shape<"((8,1),(2))">
        %lay_9684 = cute.get_layout(%view_9677) : !memref_rmem_bf16_7
        %3510 = cute.get_shape(%lay_9684) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9685, %e1_9686, %e2_9687 = cute.get_leaves(%3510) : !cute.shape<"((8,1),(2))">
        %lay_9688 = cute.get_layout(%view_9663) : !memref_smem_bf16_15
        %sz_9689 = cute.size(%lay_9688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9690 = cute.get_leaves(%sz_9689) : !cute.int_tuple<"2">
        %lay_9691 = cute.get_layout(%view_9677) : !memref_rmem_bf16_7
        %sz_9692 = cute.size(%lay_9691) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9693 = cute.get_leaves(%sz_9692) : !cute.int_tuple<"2">
        %3511 = cute.static : !cute.layout<"1:0">
        %iter_9694 = cute.get_iter(%view_9663) : !memref_smem_bf16_15
        %iter_9695 = cute.get_iter(%view_9677) : !memref_rmem_bf16_7
        %lay_9696 = cute.get_layout(%view_9663) : !memref_smem_bf16_15
        %lay_9697 = cute.get_layout(%view_9677) : !memref_rmem_bf16_7
        %append_9698 = cute.append_to_rank<2> (%lay_9696, %3511) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9699 = cute.append_to_rank<2> (%lay_9697, %3511) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9700 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9701 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9702 = cute.size(%lay_9700) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3512 = cute.get_scalars(%sz_9702) : !cute.int_tuple<"2">
        %c0_i32_9703 = arith.constant 0 : i32
        %c1_i32_9704 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9703 to %3512 step %c1_i32_9704  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9700) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_9694, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9701) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9695, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9705 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9706 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_9707 = cute.crd2idx(%coord_9705, %lay_9706) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9708 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_9709 = cute.add_offset(%iter_9708, %idx_9707) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9710 = cute.make_view(%ptr_9709) : !memref_smem_bf16_17
        %iter_9711 = cute.get_iter(%view_9710) : !memref_smem_bf16_17
        %iter_9712 = cute.get_iter(%view_9710) : !memref_smem_bf16_17
        %coord_9713 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9714 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_9715 = cute.crd2idx(%coord_9713, %lay_9714) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
        %iter_9716 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_9717 = cute.add_offset(%iter_9716, %idx_9715) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9718 = cute.make_view(%ptr_9717) : !memref_rmem_bf16_9
        %iter_9719 = cute.get_iter(%view_9718) : !memref_rmem_bf16_9
        %iter_9720 = cute.get_iter(%view_9718) : !memref_rmem_bf16_9
        %lay_9721 = cute.get_layout(%view_9710) : !memref_smem_bf16_17
        %3513 = cute.get_shape(%lay_9721) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9722, %e1_9723, %e2_9724 = cute.get_leaves(%3513) : !cute.shape<"((8,1),4)">
        %lay_9725 = cute.get_layout(%view_9718) : !memref_rmem_bf16_9
        %3514 = cute.get_shape(%lay_9725) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9726, %e1_9727, %e2_9728 = cute.get_leaves(%3514) : !cute.shape<"((8,1),4)">
        %lay_9729 = cute.get_layout(%view_9710) : !memref_smem_bf16_17
        %shape_9730 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9731 = cute.make_layout() : !cute.layout<"1:0">
        %append_9732 = cute.append_to_rank<2> (%lay_9729, %lay_9731) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9733 = cute.make_view(%iter_9712, %append_9732) : !memref_smem_bf16_17
        %iter_9734 = cute.get_iter(%view_9733) : !memref_smem_bf16_17
        %lay_9735 = cute.get_layout(%view_9733) : !memref_smem_bf16_17
        %3515 = cute.get_shape(%lay_9735) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9736, %e1_9737, %e2_9738 = cute.get_leaves(%3515) : !cute.shape<"((8,1),4)">
        %iter_9739 = cute.get_iter(%view_9733) : !memref_smem_bf16_17
        %view_9740 = cute.make_view(%iter_9739) : !memref_smem_bf16_18
        %iter_9741 = cute.get_iter(%view_9740) : !memref_smem_bf16_18
        %iter_9742 = cute.get_iter(%view_9740) : !memref_smem_bf16_18
        %lay_9743 = cute.get_layout(%view_9718) : !memref_rmem_bf16_9
        %shape_9744 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9745 = cute.make_layout() : !cute.layout<"1:0">
        %append_9746 = cute.append_to_rank<2> (%lay_9743, %lay_9745) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9747 = cute.make_view(%iter_9720, %append_9746) : !memref_rmem_bf16_9
        %iter_9748 = cute.get_iter(%view_9747) : !memref_rmem_bf16_9
        %lay_9749 = cute.get_layout(%view_9747) : !memref_rmem_bf16_9
        %3516 = cute.get_shape(%lay_9749) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9750, %e1_9751, %e2_9752 = cute.get_leaves(%3516) : !cute.shape<"((8,1),4)">
        %iter_9753 = cute.get_iter(%view_9747) : !memref_rmem_bf16_9
        %view_9754 = cute.make_view(%iter_9753) : !memref_rmem_bf16_10
        %iter_9755 = cute.get_iter(%view_9754) : !memref_rmem_bf16_10
        %iter_9756 = cute.get_iter(%view_9754) : !memref_rmem_bf16_10
        %lay_9757 = cute.get_layout(%view_9740) : !memref_smem_bf16_18
        %3517 = cute.get_shape(%lay_9757) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9758, %e1_9759, %e2_9760 = cute.get_leaves(%3517) : !cute.shape<"((8,1),(4))">
        %lay_9761 = cute.get_layout(%view_9754) : !memref_rmem_bf16_10
        %3518 = cute.get_shape(%lay_9761) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9762, %e1_9763, %e2_9764 = cute.get_leaves(%3518) : !cute.shape<"((8,1),(4))">
        %lay_9765 = cute.get_layout(%view_9740) : !memref_smem_bf16_18
        %sz_9766 = cute.size(%lay_9765) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9767 = cute.get_leaves(%sz_9766) : !cute.int_tuple<"4">
        %lay_9768 = cute.get_layout(%view_9754) : !memref_rmem_bf16_10
        %sz_9769 = cute.size(%lay_9768) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9770 = cute.get_leaves(%sz_9769) : !cute.int_tuple<"4">
        %3519 = cute.static : !cute.layout<"1:0">
        %iter_9771 = cute.get_iter(%view_9740) : !memref_smem_bf16_18
        %iter_9772 = cute.get_iter(%view_9754) : !memref_rmem_bf16_10
        %lay_9773 = cute.get_layout(%view_9740) : !memref_smem_bf16_18
        %lay_9774 = cute.get_layout(%view_9754) : !memref_rmem_bf16_10
        %append_9775 = cute.append_to_rank<2> (%lay_9773, %3519) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9776 = cute.append_to_rank<2> (%lay_9774, %3519) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9777 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9778 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9779 = cute.size(%lay_9777) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3520 = cute.get_scalars(%sz_9779) : !cute.int_tuple<"4">
        %c0_i32_9780 = arith.constant 0 : i32
        %c1_i32_9781 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9780 to %3520 step %c1_i32_9781  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9777) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_9771, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9778) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9772, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9782 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9783 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9784 = cute.crd2idx(%coord_9782, %lay_9783) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
        %iter_9785 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9786 = cute.add_offset(%iter_9785, %idx_9784) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9787 = cute.make_view(%ptr_9786) : !memref_rmem_bf16_12
        %iter_9788 = cute.get_iter(%view_9787) : !memref_rmem_bf16_12
        %iter_9789 = cute.get_iter(%view_9787) : !memref_rmem_bf16_12
        %coord_9790 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9791 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9792 = cute.crd2idx(%coord_9790, %lay_9791) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
        %iter_9793 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9794 = cute.add_offset(%iter_9793, %idx_9792) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9795 = cute.make_view(%ptr_9794) : !memref_rmem_bf16_13
        %iter_9796 = cute.get_iter(%view_9795) : !memref_rmem_bf16_13
        %iter_9797 = cute.get_iter(%view_9795) : !memref_rmem_bf16_13
        %lay_9798 = cute.get_layout(%view_9787) : !memref_rmem_bf16_12
        %3521 = cute.get_shape(%lay_9798) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9799, %e1_9800, %e2_9801, %e3_9802 = cute.get_leaves(%3521) : !cute.shape<"((2,2,2),2)">
        %lay_9803 = cute.get_layout(%view_9795) : !memref_rmem_bf16_13
        %3522 = cute.get_shape(%lay_9803) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9804, %e1_9805, %e2_9806 = cute.get_leaves(%3522) : !cute.shape<"((2,2),8)">
        %iter_9807 = cute.get_iter(%view_9787) : !memref_rmem_bf16_12
        %iter_9808 = cute.get_iter(%view_9795) : !memref_rmem_bf16_13
        %iter_9809 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_9810 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_9811 = cute.get_layout(%view_9787) : !memref_rmem_bf16_12
        %lay_9812 = cute.get_layout(%view_9795) : !memref_rmem_bf16_13
        %lay_9813 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_9814 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3523 = cute.static : !cute.layout<"1:0">
        %append_9815 = cute.append_to_rank<3> (%lay_9811, %3523) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9816 = cute.append_to_rank<3> (%lay_9812, %3523) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9817 = cute.size(%append_9815) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9818 = cute.size(%append_9815) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9819 = cute.size(%append_9816) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3524 = cute.get_scalars(%sz_9817) : !cute.int_tuple<"1">
        %3525 = cute.get_scalars(%sz_9818) : !cute.int_tuple<"2">
        %3526 = cute.get_scalars(%sz_9819) : !cute.int_tuple<"8">
        %c0_i32_9820 = arith.constant 0 : i32
        %c1_i32_9821 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9820 to %3524 step %c1_i32_9821  : i32 {
          scf.for %arg14 = %c0_i32_9820 to %3525 step %c1_i32_9821  : i32 {
            scf.for %arg15 = %c0_i32_9820 to %3526 step %c1_i32_9821  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_9815) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_9807, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_9816) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_9808, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_9813) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_9809, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_9814) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_9810, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9822 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9823 = cute.size(%int_tuple_9822) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9824 = cute.get_leaves(%sz_9823) : !cute.int_tuple<"8">
        %coord_9825 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9826 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_9827 = cute.crd2idx(%coord_9825, %lay_9826) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9828 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_9829 = cute.add_offset(%iter_9828, %idx_9827) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9830 = cute.make_view(%ptr_9829) : !memref_smem_bf16_14
        %iter_9831 = cute.get_iter(%view_9830) : !memref_smem_bf16_14
        %iter_9832 = cute.get_iter(%view_9830) : !memref_smem_bf16_14
        %coord_9833 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9834 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_9835 = cute.crd2idx(%coord_9833, %lay_9834) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
        %iter_9836 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_9837 = cute.add_offset(%iter_9836, %idx_9835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9838 = cute.make_view(%ptr_9837) : !memref_rmem_bf16_6
        %iter_9839 = cute.get_iter(%view_9838) : !memref_rmem_bf16_6
        %iter_9840 = cute.get_iter(%view_9838) : !memref_rmem_bf16_6
        %lay_9841 = cute.get_layout(%view_9830) : !memref_smem_bf16_14
        %3527 = cute.get_shape(%lay_9841) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9842, %e1_9843, %e2_9844 = cute.get_leaves(%3527) : !cute.shape<"((8,1),2)">
        %lay_9845 = cute.get_layout(%view_9838) : !memref_rmem_bf16_6
        %3528 = cute.get_shape(%lay_9845) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9846, %e1_9847, %e2_9848 = cute.get_leaves(%3528) : !cute.shape<"((8,1),2)">
        %lay_9849 = cute.get_layout(%view_9830) : !memref_smem_bf16_14
        %shape_9850 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9851 = cute.make_layout() : !cute.layout<"1:0">
        %append_9852 = cute.append_to_rank<2> (%lay_9849, %lay_9851) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9853 = cute.make_view(%iter_9832, %append_9852) : !memref_smem_bf16_14
        %iter_9854 = cute.get_iter(%view_9853) : !memref_smem_bf16_14
        %lay_9855 = cute.get_layout(%view_9853) : !memref_smem_bf16_14
        %3529 = cute.get_shape(%lay_9855) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9856, %e1_9857, %e2_9858 = cute.get_leaves(%3529) : !cute.shape<"((8,1),2)">
        %iter_9859 = cute.get_iter(%view_9853) : !memref_smem_bf16_14
        %view_9860 = cute.make_view(%iter_9859) : !memref_smem_bf16_15
        %iter_9861 = cute.get_iter(%view_9860) : !memref_smem_bf16_15
        %iter_9862 = cute.get_iter(%view_9860) : !memref_smem_bf16_15
        %lay_9863 = cute.get_layout(%view_9838) : !memref_rmem_bf16_6
        %shape_9864 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9865 = cute.make_layout() : !cute.layout<"1:0">
        %append_9866 = cute.append_to_rank<2> (%lay_9863, %lay_9865) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9867 = cute.make_view(%iter_9840, %append_9866) : !memref_rmem_bf16_6
        %iter_9868 = cute.get_iter(%view_9867) : !memref_rmem_bf16_6
        %lay_9869 = cute.get_layout(%view_9867) : !memref_rmem_bf16_6
        %3530 = cute.get_shape(%lay_9869) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9870, %e1_9871, %e2_9872 = cute.get_leaves(%3530) : !cute.shape<"((8,1),2)">
        %iter_9873 = cute.get_iter(%view_9867) : !memref_rmem_bf16_6
        %view_9874 = cute.make_view(%iter_9873) : !memref_rmem_bf16_7
        %iter_9875 = cute.get_iter(%view_9874) : !memref_rmem_bf16_7
        %iter_9876 = cute.get_iter(%view_9874) : !memref_rmem_bf16_7
        %lay_9877 = cute.get_layout(%view_9860) : !memref_smem_bf16_15
        %3531 = cute.get_shape(%lay_9877) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9878, %e1_9879, %e2_9880 = cute.get_leaves(%3531) : !cute.shape<"((8,1),(2))">
        %lay_9881 = cute.get_layout(%view_9874) : !memref_rmem_bf16_7
        %3532 = cute.get_shape(%lay_9881) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9882, %e1_9883, %e2_9884 = cute.get_leaves(%3532) : !cute.shape<"((8,1),(2))">
        %lay_9885 = cute.get_layout(%view_9860) : !memref_smem_bf16_15
        %sz_9886 = cute.size(%lay_9885) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9887 = cute.get_leaves(%sz_9886) : !cute.int_tuple<"2">
        %lay_9888 = cute.get_layout(%view_9874) : !memref_rmem_bf16_7
        %sz_9889 = cute.size(%lay_9888) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9890 = cute.get_leaves(%sz_9889) : !cute.int_tuple<"2">
        %3533 = cute.static : !cute.layout<"1:0">
        %iter_9891 = cute.get_iter(%view_9860) : !memref_smem_bf16_15
        %iter_9892 = cute.get_iter(%view_9874) : !memref_rmem_bf16_7
        %lay_9893 = cute.get_layout(%view_9860) : !memref_smem_bf16_15
        %lay_9894 = cute.get_layout(%view_9874) : !memref_rmem_bf16_7
        %append_9895 = cute.append_to_rank<2> (%lay_9893, %3533) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9896 = cute.append_to_rank<2> (%lay_9894, %3533) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9897 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9898 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9899 = cute.size(%lay_9897) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3534 = cute.get_scalars(%sz_9899) : !cute.int_tuple<"2">
        %c0_i32_9900 = arith.constant 0 : i32
        %c1_i32_9901 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9900 to %3534 step %c1_i32_9901  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9897) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_9891, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9898) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9892, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9902 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9903 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_9904 = cute.crd2idx(%coord_9902, %lay_9903) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9905 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_9906 = cute.add_offset(%iter_9905, %idx_9904) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9907 = cute.make_view(%ptr_9906) : !memref_smem_bf16_17
        %iter_9908 = cute.get_iter(%view_9907) : !memref_smem_bf16_17
        %iter_9909 = cute.get_iter(%view_9907) : !memref_smem_bf16_17
        %coord_9910 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9911 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_9912 = cute.crd2idx(%coord_9910, %lay_9911) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
        %iter_9913 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_9914 = cute.add_offset(%iter_9913, %idx_9912) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9915 = cute.make_view(%ptr_9914) : !memref_rmem_bf16_9
        %iter_9916 = cute.get_iter(%view_9915) : !memref_rmem_bf16_9
        %iter_9917 = cute.get_iter(%view_9915) : !memref_rmem_bf16_9
        %lay_9918 = cute.get_layout(%view_9907) : !memref_smem_bf16_17
        %3535 = cute.get_shape(%lay_9918) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9919, %e1_9920, %e2_9921 = cute.get_leaves(%3535) : !cute.shape<"((8,1),4)">
        %lay_9922 = cute.get_layout(%view_9915) : !memref_rmem_bf16_9
        %3536 = cute.get_shape(%lay_9922) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9923, %e1_9924, %e2_9925 = cute.get_leaves(%3536) : !cute.shape<"((8,1),4)">
        %lay_9926 = cute.get_layout(%view_9907) : !memref_smem_bf16_17
        %shape_9927 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9928 = cute.make_layout() : !cute.layout<"1:0">
        %append_9929 = cute.append_to_rank<2> (%lay_9926, %lay_9928) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9930 = cute.make_view(%iter_9909, %append_9929) : !memref_smem_bf16_17
        %iter_9931 = cute.get_iter(%view_9930) : !memref_smem_bf16_17
        %lay_9932 = cute.get_layout(%view_9930) : !memref_smem_bf16_17
        %3537 = cute.get_shape(%lay_9932) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9933, %e1_9934, %e2_9935 = cute.get_leaves(%3537) : !cute.shape<"((8,1),4)">
        %iter_9936 = cute.get_iter(%view_9930) : !memref_smem_bf16_17
        %view_9937 = cute.make_view(%iter_9936) : !memref_smem_bf16_18
        %iter_9938 = cute.get_iter(%view_9937) : !memref_smem_bf16_18
        %iter_9939 = cute.get_iter(%view_9937) : !memref_smem_bf16_18
        %lay_9940 = cute.get_layout(%view_9915) : !memref_rmem_bf16_9
        %shape_9941 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9942 = cute.make_layout() : !cute.layout<"1:0">
        %append_9943 = cute.append_to_rank<2> (%lay_9940, %lay_9942) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9944 = cute.make_view(%iter_9917, %append_9943) : !memref_rmem_bf16_9
        %iter_9945 = cute.get_iter(%view_9944) : !memref_rmem_bf16_9
        %lay_9946 = cute.get_layout(%view_9944) : !memref_rmem_bf16_9
        %3538 = cute.get_shape(%lay_9946) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9947, %e1_9948, %e2_9949 = cute.get_leaves(%3538) : !cute.shape<"((8,1),4)">
        %iter_9950 = cute.get_iter(%view_9944) : !memref_rmem_bf16_9
        %view_9951 = cute.make_view(%iter_9950) : !memref_rmem_bf16_10
        %iter_9952 = cute.get_iter(%view_9951) : !memref_rmem_bf16_10
        %iter_9953 = cute.get_iter(%view_9951) : !memref_rmem_bf16_10
        %lay_9954 = cute.get_layout(%view_9937) : !memref_smem_bf16_18
        %3539 = cute.get_shape(%lay_9954) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9955, %e1_9956, %e2_9957 = cute.get_leaves(%3539) : !cute.shape<"((8,1),(4))">
        %lay_9958 = cute.get_layout(%view_9951) : !memref_rmem_bf16_10
        %3540 = cute.get_shape(%lay_9958) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9959, %e1_9960, %e2_9961 = cute.get_leaves(%3540) : !cute.shape<"((8,1),(4))">
        %lay_9962 = cute.get_layout(%view_9937) : !memref_smem_bf16_18
        %sz_9963 = cute.size(%lay_9962) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9964 = cute.get_leaves(%sz_9963) : !cute.int_tuple<"4">
        %lay_9965 = cute.get_layout(%view_9951) : !memref_rmem_bf16_10
        %sz_9966 = cute.size(%lay_9965) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9967 = cute.get_leaves(%sz_9966) : !cute.int_tuple<"4">
        %3541 = cute.static : !cute.layout<"1:0">
        %iter_9968 = cute.get_iter(%view_9937) : !memref_smem_bf16_18
        %iter_9969 = cute.get_iter(%view_9951) : !memref_rmem_bf16_10
        %lay_9970 = cute.get_layout(%view_9937) : !memref_smem_bf16_18
        %lay_9971 = cute.get_layout(%view_9951) : !memref_rmem_bf16_10
        %append_9972 = cute.append_to_rank<2> (%lay_9970, %3541) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9973 = cute.append_to_rank<2> (%lay_9971, %3541) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9974 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9975 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9976 = cute.size(%lay_9974) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3542 = cute.get_scalars(%sz_9976) : !cute.int_tuple<"4">
        %c0_i32_9977 = arith.constant 0 : i32
        %c1_i32_9978 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9977 to %3542 step %c1_i32_9978  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_9974) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_9968, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_9975) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_9969, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9979 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9980 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_9981 = cute.crd2idx(%coord_9979, %lay_9980) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
        %iter_9982 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_9983 = cute.add_offset(%iter_9982, %idx_9981) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9984 = cute.make_view(%ptr_9983) : !memref_rmem_bf16_12
        %iter_9985 = cute.get_iter(%view_9984) : !memref_rmem_bf16_12
        %iter_9986 = cute.get_iter(%view_9984) : !memref_rmem_bf16_12
        %coord_9987 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9988 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_9989 = cute.crd2idx(%coord_9987, %lay_9988) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
        %iter_9990 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_9991 = cute.add_offset(%iter_9990, %idx_9989) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9992 = cute.make_view(%ptr_9991) : !memref_rmem_bf16_13
        %iter_9993 = cute.get_iter(%view_9992) : !memref_rmem_bf16_13
        %iter_9994 = cute.get_iter(%view_9992) : !memref_rmem_bf16_13
        %lay_9995 = cute.get_layout(%view_9984) : !memref_rmem_bf16_12
        %3543 = cute.get_shape(%lay_9995) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9996, %e1_9997, %e2_9998, %e3_9999 = cute.get_leaves(%3543) : !cute.shape<"((2,2,2),2)">
        %lay_10000 = cute.get_layout(%view_9992) : !memref_rmem_bf16_13
        %3544 = cute.get_shape(%lay_10000) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_10001, %e1_10002, %e2_10003 = cute.get_leaves(%3544) : !cute.shape<"((2,2),8)">
        %iter_10004 = cute.get_iter(%view_9984) : !memref_rmem_bf16_12
        %iter_10005 = cute.get_iter(%view_9992) : !memref_rmem_bf16_13
        %iter_10006 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_10007 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_10008 = cute.get_layout(%view_9984) : !memref_rmem_bf16_12
        %lay_10009 = cute.get_layout(%view_9992) : !memref_rmem_bf16_13
        %lay_10010 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_10011 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3545 = cute.static : !cute.layout<"1:0">
        %append_10012 = cute.append_to_rank<3> (%lay_10008, %3545) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_10013 = cute.append_to_rank<3> (%lay_10009, %3545) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_10014 = cute.size(%append_10012) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_10015 = cute.size(%append_10012) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_10016 = cute.size(%append_10013) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3546 = cute.get_scalars(%sz_10014) : !cute.int_tuple<"1">
        %3547 = cute.get_scalars(%sz_10015) : !cute.int_tuple<"2">
        %3548 = cute.get_scalars(%sz_10016) : !cute.int_tuple<"8">
        %c0_i32_10017 = arith.constant 0 : i32
        %c1_i32_10018 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10017 to %3546 step %c1_i32_10018  : i32 {
          scf.for %arg14 = %c0_i32_10017 to %3547 step %c1_i32_10018  : i32 {
            scf.for %arg15 = %c0_i32_10017 to %3548 step %c1_i32_10018  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_10012) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_10004, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_10013) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_10005, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_10010) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_10006, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_10011) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_10007, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10019 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_10020 = cute.size(%int_tuple_10019) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_10021 = cute.get_leaves(%sz_10020) : !cute.int_tuple<"8">
        %coord_10022 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10023 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_10024 = cute.crd2idx(%coord_10022, %lay_10023) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_10025 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_10026 = cute.add_offset(%iter_10025, %idx_10024) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10027 = cute.make_view(%ptr_10026) : !memref_smem_bf16_14
        %iter_10028 = cute.get_iter(%view_10027) : !memref_smem_bf16_14
        %iter_10029 = cute.get_iter(%view_10027) : !memref_smem_bf16_14
        %coord_10030 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10031 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_10032 = cute.crd2idx(%coord_10030, %lay_10031) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
        %iter_10033 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_10034 = cute.add_offset(%iter_10033, %idx_10032) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10035 = cute.make_view(%ptr_10034) : !memref_rmem_bf16_6
        %iter_10036 = cute.get_iter(%view_10035) : !memref_rmem_bf16_6
        %iter_10037 = cute.get_iter(%view_10035) : !memref_rmem_bf16_6
        %lay_10038 = cute.get_layout(%view_10027) : !memref_smem_bf16_14
        %3549 = cute.get_shape(%lay_10038) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10039, %e1_10040, %e2_10041 = cute.get_leaves(%3549) : !cute.shape<"((8,1),2)">
        %lay_10042 = cute.get_layout(%view_10035) : !memref_rmem_bf16_6
        %3550 = cute.get_shape(%lay_10042) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10043, %e1_10044, %e2_10045 = cute.get_leaves(%3550) : !cute.shape<"((8,1),2)">
        %lay_10046 = cute.get_layout(%view_10027) : !memref_smem_bf16_14
        %shape_10047 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10048 = cute.make_layout() : !cute.layout<"1:0">
        %append_10049 = cute.append_to_rank<2> (%lay_10046, %lay_10048) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_10050 = cute.make_view(%iter_10029, %append_10049) : !memref_smem_bf16_14
        %iter_10051 = cute.get_iter(%view_10050) : !memref_smem_bf16_14
        %lay_10052 = cute.get_layout(%view_10050) : !memref_smem_bf16_14
        %3551 = cute.get_shape(%lay_10052) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10053, %e1_10054, %e2_10055 = cute.get_leaves(%3551) : !cute.shape<"((8,1),2)">
        %iter_10056 = cute.get_iter(%view_10050) : !memref_smem_bf16_14
        %view_10057 = cute.make_view(%iter_10056) : !memref_smem_bf16_15
        %iter_10058 = cute.get_iter(%view_10057) : !memref_smem_bf16_15
        %iter_10059 = cute.get_iter(%view_10057) : !memref_smem_bf16_15
        %lay_10060 = cute.get_layout(%view_10035) : !memref_rmem_bf16_6
        %shape_10061 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10062 = cute.make_layout() : !cute.layout<"1:0">
        %append_10063 = cute.append_to_rank<2> (%lay_10060, %lay_10062) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_10064 = cute.make_view(%iter_10037, %append_10063) : !memref_rmem_bf16_6
        %iter_10065 = cute.get_iter(%view_10064) : !memref_rmem_bf16_6
        %lay_10066 = cute.get_layout(%view_10064) : !memref_rmem_bf16_6
        %3552 = cute.get_shape(%lay_10066) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10067, %e1_10068, %e2_10069 = cute.get_leaves(%3552) : !cute.shape<"((8,1),2)">
        %iter_10070 = cute.get_iter(%view_10064) : !memref_rmem_bf16_6
        %view_10071 = cute.make_view(%iter_10070) : !memref_rmem_bf16_7
        %iter_10072 = cute.get_iter(%view_10071) : !memref_rmem_bf16_7
        %iter_10073 = cute.get_iter(%view_10071) : !memref_rmem_bf16_7
        %lay_10074 = cute.get_layout(%view_10057) : !memref_smem_bf16_15
        %3553 = cute.get_shape(%lay_10074) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_10075, %e1_10076, %e2_10077 = cute.get_leaves(%3553) : !cute.shape<"((8,1),(2))">
        %lay_10078 = cute.get_layout(%view_10071) : !memref_rmem_bf16_7
        %3554 = cute.get_shape(%lay_10078) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_10079, %e1_10080, %e2_10081 = cute.get_leaves(%3554) : !cute.shape<"((8,1),(2))">
        %lay_10082 = cute.get_layout(%view_10057) : !memref_smem_bf16_15
        %sz_10083 = cute.size(%lay_10082) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_10084 = cute.get_leaves(%sz_10083) : !cute.int_tuple<"2">
        %lay_10085 = cute.get_layout(%view_10071) : !memref_rmem_bf16_7
        %sz_10086 = cute.size(%lay_10085) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_10087 = cute.get_leaves(%sz_10086) : !cute.int_tuple<"2">
        %3555 = cute.static : !cute.layout<"1:0">
        %iter_10088 = cute.get_iter(%view_10057) : !memref_smem_bf16_15
        %iter_10089 = cute.get_iter(%view_10071) : !memref_rmem_bf16_7
        %lay_10090 = cute.get_layout(%view_10057) : !memref_smem_bf16_15
        %lay_10091 = cute.get_layout(%view_10071) : !memref_rmem_bf16_7
        %append_10092 = cute.append_to_rank<2> (%lay_10090, %3555) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_10093 = cute.append_to_rank<2> (%lay_10091, %3555) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10094 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_10095 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_10096 = cute.size(%lay_10094) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3556 = cute.get_scalars(%sz_10096) : !cute.int_tuple<"2">
        %c0_i32_10097 = arith.constant 0 : i32
        %c1_i32_10098 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10097 to %3556 step %c1_i32_10098  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10094) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_10088, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10095) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_10089, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10099 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10100 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_10101 = cute.crd2idx(%coord_10099, %lay_10100) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_10102 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_10103 = cute.add_offset(%iter_10102, %idx_10101) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10104 = cute.make_view(%ptr_10103) : !memref_smem_bf16_17
        %iter_10105 = cute.get_iter(%view_10104) : !memref_smem_bf16_17
        %iter_10106 = cute.get_iter(%view_10104) : !memref_smem_bf16_17
        %coord_10107 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10108 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_10109 = cute.crd2idx(%coord_10107, %lay_10108) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
        %iter_10110 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_10111 = cute.add_offset(%iter_10110, %idx_10109) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10112 = cute.make_view(%ptr_10111) : !memref_rmem_bf16_9
        %iter_10113 = cute.get_iter(%view_10112) : !memref_rmem_bf16_9
        %iter_10114 = cute.get_iter(%view_10112) : !memref_rmem_bf16_9
        %lay_10115 = cute.get_layout(%view_10104) : !memref_smem_bf16_17
        %3557 = cute.get_shape(%lay_10115) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10116, %e1_10117, %e2_10118 = cute.get_leaves(%3557) : !cute.shape<"((8,1),4)">
        %lay_10119 = cute.get_layout(%view_10112) : !memref_rmem_bf16_9
        %3558 = cute.get_shape(%lay_10119) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10120, %e1_10121, %e2_10122 = cute.get_leaves(%3558) : !cute.shape<"((8,1),4)">
        %lay_10123 = cute.get_layout(%view_10104) : !memref_smem_bf16_17
        %shape_10124 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10125 = cute.make_layout() : !cute.layout<"1:0">
        %append_10126 = cute.append_to_rank<2> (%lay_10123, %lay_10125) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_10127 = cute.make_view(%iter_10106, %append_10126) : !memref_smem_bf16_17
        %iter_10128 = cute.get_iter(%view_10127) : !memref_smem_bf16_17
        %lay_10129 = cute.get_layout(%view_10127) : !memref_smem_bf16_17
        %3559 = cute.get_shape(%lay_10129) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10130, %e1_10131, %e2_10132 = cute.get_leaves(%3559) : !cute.shape<"((8,1),4)">
        %iter_10133 = cute.get_iter(%view_10127) : !memref_smem_bf16_17
        %view_10134 = cute.make_view(%iter_10133) : !memref_smem_bf16_18
        %iter_10135 = cute.get_iter(%view_10134) : !memref_smem_bf16_18
        %iter_10136 = cute.get_iter(%view_10134) : !memref_smem_bf16_18
        %lay_10137 = cute.get_layout(%view_10112) : !memref_rmem_bf16_9
        %shape_10138 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10139 = cute.make_layout() : !cute.layout<"1:0">
        %append_10140 = cute.append_to_rank<2> (%lay_10137, %lay_10139) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_10141 = cute.make_view(%iter_10114, %append_10140) : !memref_rmem_bf16_9
        %iter_10142 = cute.get_iter(%view_10141) : !memref_rmem_bf16_9
        %lay_10143 = cute.get_layout(%view_10141) : !memref_rmem_bf16_9
        %3560 = cute.get_shape(%lay_10143) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10144, %e1_10145, %e2_10146 = cute.get_leaves(%3560) : !cute.shape<"((8,1),4)">
        %iter_10147 = cute.get_iter(%view_10141) : !memref_rmem_bf16_9
        %view_10148 = cute.make_view(%iter_10147) : !memref_rmem_bf16_10
        %iter_10149 = cute.get_iter(%view_10148) : !memref_rmem_bf16_10
        %iter_10150 = cute.get_iter(%view_10148) : !memref_rmem_bf16_10
        %lay_10151 = cute.get_layout(%view_10134) : !memref_smem_bf16_18
        %3561 = cute.get_shape(%lay_10151) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_10152, %e1_10153, %e2_10154 = cute.get_leaves(%3561) : !cute.shape<"((8,1),(4))">
        %lay_10155 = cute.get_layout(%view_10148) : !memref_rmem_bf16_10
        %3562 = cute.get_shape(%lay_10155) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_10156, %e1_10157, %e2_10158 = cute.get_leaves(%3562) : !cute.shape<"((8,1),(4))">
        %lay_10159 = cute.get_layout(%view_10134) : !memref_smem_bf16_18
        %sz_10160 = cute.size(%lay_10159) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_10161 = cute.get_leaves(%sz_10160) : !cute.int_tuple<"4">
        %lay_10162 = cute.get_layout(%view_10148) : !memref_rmem_bf16_10
        %sz_10163 = cute.size(%lay_10162) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_10164 = cute.get_leaves(%sz_10163) : !cute.int_tuple<"4">
        %3563 = cute.static : !cute.layout<"1:0">
        %iter_10165 = cute.get_iter(%view_10134) : !memref_smem_bf16_18
        %iter_10166 = cute.get_iter(%view_10148) : !memref_rmem_bf16_10
        %lay_10167 = cute.get_layout(%view_10134) : !memref_smem_bf16_18
        %lay_10168 = cute.get_layout(%view_10148) : !memref_rmem_bf16_10
        %append_10169 = cute.append_to_rank<2> (%lay_10167, %3563) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_10170 = cute.append_to_rank<2> (%lay_10168, %3563) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10171 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_10172 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_10173 = cute.size(%lay_10171) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3564 = cute.get_scalars(%sz_10173) : !cute.int_tuple<"4">
        %c0_i32_10174 = arith.constant 0 : i32
        %c1_i32_10175 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10174 to %3564 step %c1_i32_10175  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10171) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_10165, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10172) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_10166, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10176 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_10177 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_10178 = cute.crd2idx(%coord_10176, %lay_10177) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
        %iter_10179 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_10180 = cute.add_offset(%iter_10179, %idx_10178) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10181 = cute.make_view(%ptr_10180) : !memref_rmem_bf16_12
        %iter_10182 = cute.get_iter(%view_10181) : !memref_rmem_bf16_12
        %iter_10183 = cute.get_iter(%view_10181) : !memref_rmem_bf16_12
        %coord_10184 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_10185 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_10186 = cute.crd2idx(%coord_10184, %lay_10185) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
        %iter_10187 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_10188 = cute.add_offset(%iter_10187, %idx_10186) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10189 = cute.make_view(%ptr_10188) : !memref_rmem_bf16_13
        %iter_10190 = cute.get_iter(%view_10189) : !memref_rmem_bf16_13
        %iter_10191 = cute.get_iter(%view_10189) : !memref_rmem_bf16_13
        %lay_10192 = cute.get_layout(%view_10181) : !memref_rmem_bf16_12
        %3565 = cute.get_shape(%lay_10192) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_10193, %e1_10194, %e2_10195, %e3_10196 = cute.get_leaves(%3565) : !cute.shape<"((2,2,2),2)">
        %lay_10197 = cute.get_layout(%view_10189) : !memref_rmem_bf16_13
        %3566 = cute.get_shape(%lay_10197) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_10198, %e1_10199, %e2_10200 = cute.get_leaves(%3566) : !cute.shape<"((2,2),8)">
        %iter_10201 = cute.get_iter(%view_10181) : !memref_rmem_bf16_12
        %iter_10202 = cute.get_iter(%view_10189) : !memref_rmem_bf16_13
        %iter_10203 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_10204 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_10205 = cute.get_layout(%view_10181) : !memref_rmem_bf16_12
        %lay_10206 = cute.get_layout(%view_10189) : !memref_rmem_bf16_13
        %lay_10207 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_10208 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3567 = cute.static : !cute.layout<"1:0">
        %append_10209 = cute.append_to_rank<3> (%lay_10205, %3567) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_10210 = cute.append_to_rank<3> (%lay_10206, %3567) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_10211 = cute.size(%append_10209) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_10212 = cute.size(%append_10209) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_10213 = cute.size(%append_10210) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3568 = cute.get_scalars(%sz_10211) : !cute.int_tuple<"1">
        %3569 = cute.get_scalars(%sz_10212) : !cute.int_tuple<"2">
        %3570 = cute.get_scalars(%sz_10213) : !cute.int_tuple<"8">
        %c0_i32_10214 = arith.constant 0 : i32
        %c1_i32_10215 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10214 to %3568 step %c1_i32_10215  : i32 {
          scf.for %arg14 = %c0_i32_10214 to %3569 step %c1_i32_10215  : i32 {
            scf.for %arg15 = %c0_i32_10214 to %3570 step %c1_i32_10215  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_10209) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_10201, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_10210) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_10202, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_10207) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_10203, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_10208) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_10204, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10216 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_10217 = cute.size(%int_tuple_10216) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_10218 = cute.get_leaves(%sz_10217) : !cute.int_tuple<"8">
        %coord_10219 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10220 = cute.get_layout(%view_746) : !memref_smem_bf16_8
        %idx_10221 = cute.crd2idx(%coord_10219, %lay_10220) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_10222 = cute.get_iter(%view_746) : !memref_smem_bf16_8
        %ptr_10223 = cute.add_offset(%iter_10222, %idx_10221) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10224 = cute.make_view(%ptr_10223) : !memref_smem_bf16_14
        %iter_10225 = cute.get_iter(%view_10224) : !memref_smem_bf16_14
        %iter_10226 = cute.get_iter(%view_10224) : !memref_smem_bf16_14
        %coord_10227 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10228 = cute.get_layout(%view_749) : !memref_rmem_bf16_3
        %idx_10229 = cute.crd2idx(%coord_10227, %lay_10228) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_10230 = cute.get_iter(%view_749) : !memref_rmem_bf16_3
        %ptr_10231 = cute.add_offset(%iter_10230, %idx_10229) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10232 = cute.make_view(%ptr_10231) : !memref_rmem_bf16_6
        %iter_10233 = cute.get_iter(%view_10232) : !memref_rmem_bf16_6
        %iter_10234 = cute.get_iter(%view_10232) : !memref_rmem_bf16_6
        %lay_10235 = cute.get_layout(%view_10224) : !memref_smem_bf16_14
        %3571 = cute.get_shape(%lay_10235) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10236, %e1_10237, %e2_10238 = cute.get_leaves(%3571) : !cute.shape<"((8,1),2)">
        %lay_10239 = cute.get_layout(%view_10232) : !memref_rmem_bf16_6
        %3572 = cute.get_shape(%lay_10239) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10240, %e1_10241, %e2_10242 = cute.get_leaves(%3572) : !cute.shape<"((8,1),2)">
        %lay_10243 = cute.get_layout(%view_10224) : !memref_smem_bf16_14
        %shape_10244 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10245 = cute.make_layout() : !cute.layout<"1:0">
        %append_10246 = cute.append_to_rank<2> (%lay_10243, %lay_10245) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_10247 = cute.make_view(%iter_10226, %append_10246) : !memref_smem_bf16_14
        %iter_10248 = cute.get_iter(%view_10247) : !memref_smem_bf16_14
        %lay_10249 = cute.get_layout(%view_10247) : !memref_smem_bf16_14
        %3573 = cute.get_shape(%lay_10249) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_10250, %e1_10251, %e2_10252 = cute.get_leaves(%3573) : !cute.shape<"((8,1),2)">
        %iter_10253 = cute.get_iter(%view_10247) : !memref_smem_bf16_14
        %view_10254 = cute.make_view(%iter_10253) : !memref_smem_bf16_15
        %iter_10255 = cute.get_iter(%view_10254) : !memref_smem_bf16_15
        %iter_10256 = cute.get_iter(%view_10254) : !memref_smem_bf16_15
        %lay_10257 = cute.get_layout(%view_10232) : !memref_rmem_bf16_6
        %shape_10258 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10259 = cute.make_layout() : !cute.layout<"1:0">
        %append_10260 = cute.append_to_rank<2> (%lay_10257, %lay_10259) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_10261 = cute.make_view(%iter_10234, %append_10260) : !memref_rmem_bf16_6
        %iter_10262 = cute.get_iter(%view_10261) : !memref_rmem_bf16_6
        %lay_10263 = cute.get_layout(%view_10261) : !memref_rmem_bf16_6
        %3574 = cute.get_shape(%lay_10263) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_10264, %e1_10265, %e2_10266 = cute.get_leaves(%3574) : !cute.shape<"((8,1),2)">
        %iter_10267 = cute.get_iter(%view_10261) : !memref_rmem_bf16_6
        %view_10268 = cute.make_view(%iter_10267) : !memref_rmem_bf16_7
        %iter_10269 = cute.get_iter(%view_10268) : !memref_rmem_bf16_7
        %iter_10270 = cute.get_iter(%view_10268) : !memref_rmem_bf16_7
        %lay_10271 = cute.get_layout(%view_10254) : !memref_smem_bf16_15
        %3575 = cute.get_shape(%lay_10271) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_10272, %e1_10273, %e2_10274 = cute.get_leaves(%3575) : !cute.shape<"((8,1),(2))">
        %lay_10275 = cute.get_layout(%view_10268) : !memref_rmem_bf16_7
        %3576 = cute.get_shape(%lay_10275) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_10276, %e1_10277, %e2_10278 = cute.get_leaves(%3576) : !cute.shape<"((8,1),(2))">
        %lay_10279 = cute.get_layout(%view_10254) : !memref_smem_bf16_15
        %sz_10280 = cute.size(%lay_10279) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_10281 = cute.get_leaves(%sz_10280) : !cute.int_tuple<"2">
        %lay_10282 = cute.get_layout(%view_10268) : !memref_rmem_bf16_7
        %sz_10283 = cute.size(%lay_10282) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_10284 = cute.get_leaves(%sz_10283) : !cute.int_tuple<"2">
        %3577 = cute.static : !cute.layout<"1:0">
        %iter_10285 = cute.get_iter(%view_10254) : !memref_smem_bf16_15
        %iter_10286 = cute.get_iter(%view_10268) : !memref_rmem_bf16_7
        %lay_10287 = cute.get_layout(%view_10254) : !memref_smem_bf16_15
        %lay_10288 = cute.get_layout(%view_10268) : !memref_rmem_bf16_7
        %append_10289 = cute.append_to_rank<2> (%lay_10287, %3577) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_10290 = cute.append_to_rank<2> (%lay_10288, %3577) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10291 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_10292 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_10293 = cute.size(%lay_10291) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %3578 = cute.get_scalars(%sz_10293) : !cute.int_tuple<"2">
        %c0_i32_10294 = arith.constant 0 : i32
        %c1_i32_10295 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10294 to %3578 step %c1_i32_10295  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10291) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_11566 = cute.add_offset(%iter_10285, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10292) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_10286, %idx_11569) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_8
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_8
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10296 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10297 = cute.get_layout(%view_804) : !memref_smem_bf16_9
        %idx_10298 = cute.crd2idx(%coord_10296, %lay_10297) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_10299 = cute.get_iter(%view_804) : !memref_smem_bf16_9
        %ptr_10300 = cute.add_offset(%iter_10299, %idx_10298) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10301 = cute.make_view(%ptr_10300) : !memref_smem_bf16_17
        %iter_10302 = cute.get_iter(%view_10301) : !memref_smem_bf16_17
        %iter_10303 = cute.get_iter(%view_10301) : !memref_smem_bf16_17
        %coord_10304 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10305 = cute.get_layout(%view_807) : !memref_rmem_bf16_4
        %idx_10306 = cute.crd2idx(%coord_10304, %lay_10305) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_10307 = cute.get_iter(%view_807) : !memref_rmem_bf16_4
        %ptr_10308 = cute.add_offset(%iter_10307, %idx_10306) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10309 = cute.make_view(%ptr_10308) : !memref_rmem_bf16_9
        %iter_10310 = cute.get_iter(%view_10309) : !memref_rmem_bf16_9
        %iter_10311 = cute.get_iter(%view_10309) : !memref_rmem_bf16_9
        %lay_10312 = cute.get_layout(%view_10301) : !memref_smem_bf16_17
        %3579 = cute.get_shape(%lay_10312) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10313, %e1_10314, %e2_10315 = cute.get_leaves(%3579) : !cute.shape<"((8,1),4)">
        %lay_10316 = cute.get_layout(%view_10309) : !memref_rmem_bf16_9
        %3580 = cute.get_shape(%lay_10316) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10317, %e1_10318, %e2_10319 = cute.get_leaves(%3580) : !cute.shape<"((8,1),4)">
        %lay_10320 = cute.get_layout(%view_10301) : !memref_smem_bf16_17
        %shape_10321 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10322 = cute.make_layout() : !cute.layout<"1:0">
        %append_10323 = cute.append_to_rank<2> (%lay_10320, %lay_10322) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_10324 = cute.make_view(%iter_10303, %append_10323) : !memref_smem_bf16_17
        %iter_10325 = cute.get_iter(%view_10324) : !memref_smem_bf16_17
        %lay_10326 = cute.get_layout(%view_10324) : !memref_smem_bf16_17
        %3581 = cute.get_shape(%lay_10326) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_10327, %e1_10328, %e2_10329 = cute.get_leaves(%3581) : !cute.shape<"((8,1),4)">
        %iter_10330 = cute.get_iter(%view_10324) : !memref_smem_bf16_17
        %view_10331 = cute.make_view(%iter_10330) : !memref_smem_bf16_18
        %iter_10332 = cute.get_iter(%view_10331) : !memref_smem_bf16_18
        %iter_10333 = cute.get_iter(%view_10331) : !memref_smem_bf16_18
        %lay_10334 = cute.get_layout(%view_10309) : !memref_rmem_bf16_9
        %shape_10335 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10336 = cute.make_layout() : !cute.layout<"1:0">
        %append_10337 = cute.append_to_rank<2> (%lay_10334, %lay_10336) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_10338 = cute.make_view(%iter_10311, %append_10337) : !memref_rmem_bf16_9
        %iter_10339 = cute.get_iter(%view_10338) : !memref_rmem_bf16_9
        %lay_10340 = cute.get_layout(%view_10338) : !memref_rmem_bf16_9
        %3582 = cute.get_shape(%lay_10340) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_10341, %e1_10342, %e2_10343 = cute.get_leaves(%3582) : !cute.shape<"((8,1),4)">
        %iter_10344 = cute.get_iter(%view_10338) : !memref_rmem_bf16_9
        %view_10345 = cute.make_view(%iter_10344) : !memref_rmem_bf16_10
        %iter_10346 = cute.get_iter(%view_10345) : !memref_rmem_bf16_10
        %iter_10347 = cute.get_iter(%view_10345) : !memref_rmem_bf16_10
        %lay_10348 = cute.get_layout(%view_10331) : !memref_smem_bf16_18
        %3583 = cute.get_shape(%lay_10348) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_10349, %e1_10350, %e2_10351 = cute.get_leaves(%3583) : !cute.shape<"((8,1),(4))">
        %lay_10352 = cute.get_layout(%view_10345) : !memref_rmem_bf16_10
        %3584 = cute.get_shape(%lay_10352) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_10353, %e1_10354, %e2_10355 = cute.get_leaves(%3584) : !cute.shape<"((8,1),(4))">
        %lay_10356 = cute.get_layout(%view_10331) : !memref_smem_bf16_18
        %sz_10357 = cute.size(%lay_10356) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_10358 = cute.get_leaves(%sz_10357) : !cute.int_tuple<"4">
        %lay_10359 = cute.get_layout(%view_10345) : !memref_rmem_bf16_10
        %sz_10360 = cute.size(%lay_10359) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_10361 = cute.get_leaves(%sz_10360) : !cute.int_tuple<"4">
        %3585 = cute.static : !cute.layout<"1:0">
        %iter_10362 = cute.get_iter(%view_10331) : !memref_smem_bf16_18
        %iter_10363 = cute.get_iter(%view_10345) : !memref_rmem_bf16_10
        %lay_10364 = cute.get_layout(%view_10331) : !memref_smem_bf16_18
        %lay_10365 = cute.get_layout(%view_10345) : !memref_rmem_bf16_10
        %append_10366 = cute.append_to_rank<2> (%lay_10364, %3585) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_10367 = cute.append_to_rank<2> (%lay_10365, %3585) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_10368 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_10369 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_10370 = cute.size(%lay_10368) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %3586 = cute.get_scalars(%sz_10370) : !cute.int_tuple<"4">
        %c0_i32_10371 = arith.constant 0 : i32
        %c1_i32_10372 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10371 to %3586 step %c1_i32_10372  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10368) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_11566 = cute.add_offset(%iter_10362, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10369) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_10363, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3826 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32} : <bf16, smem, align<16>> -> vector<4xi32>
          %3827 = llvm.mlir.constant(0 : i32) : i32
          %3828 = vector.extractelement %3826[%3827 : i32] : vector<4xi32>
          %3829 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3828, %3829 : i32, !llvm.ptr
          %3830 = llvm.mlir.constant(1 : i32) : i32
          %3831 = vector.extractelement %3826[%3830 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3831, %3832 : i32, !llvm.ptr
          %3833 = llvm.mlir.constant(2 : i32) : i32
          %3834 = vector.extractelement %3826[%3833 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3835 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3834, %3835 : i32, !llvm.ptr
          %3836 = llvm.mlir.constant(3 : i32) : i32
          %3837 = vector.extractelement %3826[%3836 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3838 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3837, %3838 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10373 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10374 = cute.get_layout(%rmem) : !memref_rmem_bf16_
        %idx_10375 = cute.crd2idx(%coord_10373, %lay_10374) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
        %iter_10376 = cute.get_iter(%rmem) : !memref_rmem_bf16_
        %ptr_10377 = cute.add_offset(%iter_10376, %idx_10375) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_10378 = cute.make_view(%ptr_10377) : !memref_rmem_bf16_12
        %iter_10379 = cute.get_iter(%view_10378) : !memref_rmem_bf16_12
        %iter_10380 = cute.get_iter(%view_10378) : !memref_rmem_bf16_12
        %coord_10381 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_10382 = cute.get_layout(%rmem_602) : !memref_rmem_bf16_1
        %idx_10383 = cute.crd2idx(%coord_10381, %lay_10382) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
        %iter_10384 = cute.get_iter(%rmem_602) : !memref_rmem_bf16_1
        %ptr_10385 = cute.add_offset(%iter_10384, %idx_10383) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10386 = cute.make_view(%ptr_10385) : !memref_rmem_bf16_13
        %iter_10387 = cute.get_iter(%view_10386) : !memref_rmem_bf16_13
        %iter_10388 = cute.get_iter(%view_10386) : !memref_rmem_bf16_13
        %lay_10389 = cute.get_layout(%view_10378) : !memref_rmem_bf16_12
        %3587 = cute.get_shape(%lay_10389) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_10390, %e1_10391, %e2_10392, %e3_10393 = cute.get_leaves(%3587) : !cute.shape<"((2,2,2),2)">
        %lay_10394 = cute.get_layout(%view_10386) : !memref_rmem_bf16_13
        %3588 = cute.get_shape(%lay_10394) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_10395, %e1_10396, %e2_10397 = cute.get_leaves(%3588) : !cute.shape<"((2,2),8)">
        %iter_10398 = cute.get_iter(%view_10378) : !memref_rmem_bf16_12
        %iter_10399 = cute.get_iter(%view_10386) : !memref_rmem_bf16_13
        %iter_10400 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %iter_10401 = cute.get_iter(%rmem_8649) : !memref_rmem_f32_2
        %lay_10402 = cute.get_layout(%view_10378) : !memref_rmem_bf16_12
        %lay_10403 = cute.get_layout(%view_10386) : !memref_rmem_bf16_13
        %lay_10404 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_10405 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3589 = cute.static : !cute.layout<"1:0">
        %append_10406 = cute.append_to_rank<3> (%lay_10402, %3589) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_10407 = cute.append_to_rank<3> (%lay_10403, %3589) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_10408 = cute.size(%append_10406) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_10409 = cute.size(%append_10406) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_10410 = cute.size(%append_10407) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %3590 = cute.get_scalars(%sz_10408) : !cute.int_tuple<"1">
        %3591 = cute.get_scalars(%sz_10409) : !cute.int_tuple<"2">
        %3592 = cute.get_scalars(%sz_10410) : !cute.int_tuple<"8">
        %c0_i32_10411 = arith.constant 0 : i32
        %c1_i32_10412 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10411 to %3590 step %c1_i32_10412  : i32 {
          scf.for %arg14 = %c0_i32_10411 to %3591 step %c1_i32_10412  : i32 {
            scf.for %arg15 = %c0_i32_10411 to %3592 step %c1_i32_10412  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"((2,2,2)):((1,2,4))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_10406) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_11568 = cute.add_offset(%iter_10398, %idx_11567) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_14
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_10407) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_10399, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_10404) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_10400, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_10405) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_10401, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_14
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[2] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[3] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_10413 = arith.constant 1 : i32
        %c128_i32_10414 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_10413 number_of_threads = %c128_i32_10414
        %c0_i32_10415 = arith.constant 0 : i32
        %3593 = arith.cmpi sgt, %3397, %c0_i32_10415 : i32
        scf.if %3593 {
          %c1_i32_11563 = arith.constant 1 : i32
          %3824 = arith.subi %3397, %c1_i32_11563 : i32
          %coord_11564 = cute.make_coord(%3824) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_11565 = cute.get_layout(%view_380) : !memref_gmem_bf16_5
          %3825:3 = cute.get_scalars(%lay_11565) <{only_dynamic}> : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
          %3826 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,_,_,?)">
          %shape_11566 = cute.make_shape() : () -> !cute.shape<"((8,1),4,2)">
          %iv_11567 = cute.assume(%3825#1) : (i64) -> !cute.i64<divby 128>
          %stride_11568 = cute.make_stride(%iv_11567) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
          %lay_11569 = cute.make_layout(%shape_11566, %stride_11568) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %idx_11570 = cute.crd2idx(%coord_11564, %lay_11565) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_11571 = cute.get_iter(%view_380) : !memref_gmem_bf16_5
          %ptr_11572 = cute.add_offset(%iter_11571, %idx_11570) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_11573 = cute.make_view(%ptr_11572, %lay_11569) : !memref_gmem_bf16_9
          %iter_11574 = cute.get_iter(%view_11573) : !memref_gmem_bf16_9
          %iter_11575 = cute.get_iter(%view_11573) : !memref_gmem_bf16_9
          %lay_11576 = cute.get_layout(%view_11573) : !memref_gmem_bf16_9
          %3827 = cute.get_shape(%lay_11576) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11577, %e1_11578, %e2_11579, %e3_11580 = cute.get_leaves(%3827) : !cute.shape<"((8,1),4,2)">
          %lay_11581 = cute.get_layout(%view_425) : !memref_smem_bf16_4
          %3828 = cute.get_shape(%lay_11581) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11582, %e1_11583, %e2_11584, %e3_11585 = cute.get_leaves(%3828) : !cute.shape<"((8,1),4,2)">
          %lay_11586 = cute.get_layout(%view_11573) : !memref_gmem_bf16_9
          %shape_11587 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11588 = cute.make_layout() : !cute.layout<"1:0">
          %append_11589 = cute.append_to_rank<2> (%lay_11586, %lay_11588) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_11590 = cute.make_view(%iter_11575, %append_11589) : !memref_gmem_bf16_9
          %iter_11591 = cute.get_iter(%view_11590) : !memref_gmem_bf16_9
          %lay_11592 = cute.get_layout(%view_11590) : !memref_gmem_bf16_9
          %3829 = cute.get_shape(%lay_11592) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11593, %e1_11594, %e2_11595, %e3_11596 = cute.get_leaves(%3829) : !cute.shape<"((8,1),4,2)">
          %iter_11597 = cute.get_iter(%view_11590) : !memref_gmem_bf16_9
          %lay_11598 = cute.get_layout(%view_11590) : !memref_gmem_bf16_9
          %3830 = cute.get_scalars(%lay_11598) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_11599 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_11600 = cute.assume(%3830) : (i64) -> !cute.i64<divby 128>
          %stride_11601 = cute.make_stride(%iv_11600) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_11602 = cute.make_layout(%shape_11599, %stride_11601) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_11603 = cute.make_view(%iter_11597, %lay_11602) : !memref_gmem_bf16_10
          %iter_11604 = cute.get_iter(%view_11603) : !memref_gmem_bf16_10
          %iter_11605 = cute.get_iter(%view_11603) : !memref_gmem_bf16_10
          %lay_11606 = cute.get_layout(%view_425) : !memref_smem_bf16_4
          %shape_11607 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11608 = cute.make_layout() : !cute.layout<"1:0">
          %append_11609 = cute.append_to_rank<2> (%lay_11606, %lay_11608) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_11610 = cute.make_view(%iter_426, %append_11609) : !memref_smem_bf16_4
          %iter_11611 = cute.get_iter(%view_11610) : !memref_smem_bf16_4
          %lay_11612 = cute.get_layout(%view_11610) : !memref_smem_bf16_4
          %3831 = cute.get_shape(%lay_11612) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_11613, %e1_11614, %e2_11615, %e3_11616 = cute.get_leaves(%3831) : !cute.shape<"((8,1),4,2)">
          %iter_11617 = cute.get_iter(%view_11610) : !memref_smem_bf16_4
          %view_11618 = cute.make_view(%iter_11617) : !memref_smem_bf16_16
          %iter_11619 = cute.get_iter(%view_11618) : !memref_smem_bf16_16
          %iter_11620 = cute.get_iter(%view_11618) : !memref_smem_bf16_16
          %lay_11621 = cute.get_layout(%rmem_1045) : !memref_rmem_i8_1
          %shape_11622 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_11623 = cute.make_layout() : !cute.layout<"1:0">
          %append_11624 = cute.append_to_rank<2> (%lay_11621, %lay_11623) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_11625 = cute.make_view(%iter_1047, %append_11624) : !memref_rmem_i8_1
          %iter_11626 = cute.get_iter(%view_11625) : !memref_rmem_i8_1
          %lay_11627 = cute.get_layout(%view_11625) : !memref_rmem_i8_1
          %3832 = cute.get_shape(%lay_11627) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_11628, %e1_11629, %e2_11630 = cute.get_leaves(%3832) : !cute.shape<"(1,4,2)">
          %iter_11631 = cute.get_iter(%view_11625) : !memref_rmem_i8_1
          %view_11632 = cute.make_view(%iter_11631) : !memref_rmem_i8_5
          %iter_11633 = cute.get_iter(%view_11632) : !memref_rmem_i8_5
          %iter_11634 = cute.get_iter(%view_11632) : !memref_rmem_i8_5
          %lay_11635 = cute.get_layout(%view_11603) : !memref_gmem_bf16_10
          %3833 = cute.get_shape(%lay_11635) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11636, %e1_11637, %e2_11638, %e3_11639 = cute.get_leaves(%3833) : !cute.shape<"((8,1),(4,2))">
          %lay_11640 = cute.get_layout(%view_11618) : !memref_smem_bf16_16
          %3834 = cute.get_shape(%lay_11640) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_11641, %e1_11642, %e2_11643, %e3_11644 = cute.get_leaves(%3834) : !cute.shape<"((8,1),(4,2))">
          %lay_11645 = cute.get_layout(%view_11603) : !memref_gmem_bf16_10
          %sz_11646 = cute.size(%lay_11645) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_11647 = cute.get_leaves(%sz_11646) : !cute.int_tuple<"8">
          %lay_11648 = cute.get_layout(%view_11618) : !memref_smem_bf16_16
          %sz_11649 = cute.size(%lay_11648) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_11650 = cute.get_leaves(%sz_11649) : !cute.int_tuple<"8">
          %3835 = cute.static : !cute.layout<"1:0">
          %iter_11651 = cute.get_iter(%view_11603) : !memref_gmem_bf16_10
          %iter_11652 = cute.get_iter(%view_11618) : !memref_smem_bf16_16
          %lay_11653 = cute.get_layout(%view_11603) : !memref_gmem_bf16_10
          %lay_11654 = cute.get_layout(%view_11618) : !memref_smem_bf16_16
          %append_11655 = cute.append_to_rank<2> (%lay_11653, %3835) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_11656 = cute.append_to_rank<2> (%lay_11654, %3835) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %3836 = cute.get_scalars(%append_11655) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_11657 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_11658 = cute.assume(%3836) : (i64) -> !cute.i64<divby 128>
          %stride_11659 = cute.make_stride(%iv_11658) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_11660 = cute.make_layout(%shape_11657, %stride_11659) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_11661 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_11662 = cute.get_iter(%view_11632) : !memref_rmem_i8_5
          %lay_11663 = cute.get_layout(%view_11632) : !memref_rmem_i8_5
          %append_11664 = cute.append_to_rank<2> (%lay_11663, %3835) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_11665 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_11666 = cute.size(%lay_11660) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %3837 = cute.get_scalars(%sz_11666) : !cute.int_tuple<"8">
          %c0_i32_11667 = arith.constant 0 : i32
          %c1_i32_11668 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_11667 to %3837 step %c1_i32_11668  : i32 {
            %coord_11669 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %3838 = cute.get_scalars(%lay_11660) <{only_dynamic}> : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
            %3839 = cute.get_scalars(%coord_11669) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11670 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11671 = cute.crd2idx(%coord_11669, %lay_11660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_11672 = cute.add_offset(%iter_11651, %idx_11671) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_11673 = cute.make_view(%ptr_11672, %lay_11670) : !memref_gmem_bf16_8
            %3840 = cute.get_scalars(%coord_11669) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11674 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
            %idx_11675 = cute.crd2idx(%coord_11669, %lay_11661) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_11676 = cute.add_offset(%iter_11652, %idx_11675) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_11677 = cute.make_view(%ptr_11676, %lay_11674) : !memref_smem_bf16_13
            %3841 = cute.get_scalars(%coord_11669) <{only_dynamic}> : !cute.coord<"(_,?)">
            %lay_11678 = cute.make_layout() : !cute.layout<"(1):(2)">
            %idx_11679 = cute.crd2idx(%coord_11669, %lay_11665) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_11680 = cute.add_offset(%iter_11662, %idx_11679) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_11681 = cute.make_view(%ptr_11680, %lay_11678) : !memref_rmem_i8_4
            %iter_11682 = cute.get_iter(%view_11673) : !memref_gmem_bf16_8
            %iter_11683 = cute.get_iter(%view_11677) : !memref_smem_bf16_13
            %iter_11684 = cute.get_iter(%view_11681) : !memref_rmem_i8_4
            %3842 = builtin.unrealized_conversion_cast %iter_11684 : !cute.ptr<i8, rmem> to !llvm.ptr
            %3843 = llvm.load %3842 : !llvm.ptr -> i8
            %3844 = llvm.trunc %3843 : i8 to i1
            %iter_11685 = cute.recast_iter(%iter_11682) : !cute.ptr<bf16, gmem, align<16>> to !cute.ptr<i128, gmem>
            %iter_11686 = cute.recast_iter(%iter_11683) : !cute.ptr<bf16, smem, align<16>> to !cute.ptr<i128, smem>
            cute_nvgpu.arch.copy.SM80.cp_async(%iter_11686 : !cute.ptr<i128, smem>, %iter_11685 : !cute.ptr<i128, gmem>, %3844 : i1) {cache_mode = <global>}
          } {llvm.loop_annotation = #loop_annotation}
          nvvm.cp.async.commit.group
        }
        %lay_10416 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %3594 = cute.get_shape(%lay_10416) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10417, %e1_10418, %e2_10419, %e3_10420 = cute.get_leaves(%3594) : !cute.shape<"((2,2),2,8)">
        %shape_10421 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_10422 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %3595 = cute.get_shape(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10423, %e1_10424, %e2_10425, %e3_10426 = cute.get_leaves(%3595) : !cute.shape<"((2,2),2,8)">
        %3596 = cute.get_shape(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10427, %e1_10428, %e2_10429, %e3_10430 = cute.get_leaves(%3596) : !cute.shape<"((2,2),2,8)">
        %3597 = cute.get_shape(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10431, %e1_10432, %e2_10433, %e3_10434 = cute.get_leaves(%3597) : !cute.shape<"((2,2),2,8)">
        %3598 = cute.get_shape(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10435, %e1_10436, %e2_10437, %e3_10438 = cute.get_leaves(%3598) : !cute.shape<"((2,2),2,8)">
        %3599 = cute.get_stride(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10439, %e1_10440, %e2_10441, %e3_10442 = cute.get_leaves(%3599) : !cute.stride<"((1,2),4,8)">
        %3600 = cute.get_stride(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10443, %e1_10444, %e2_10445, %e3_10446 = cute.get_leaves(%3600) : !cute.stride<"((1,2),4,8)">
        %3601 = cute.get_stride(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10447, %e1_10448, %e2_10449, %e3_10450 = cute.get_leaves(%3601) : !cute.stride<"((1,2),4,8)">
        %3602 = cute.get_stride(%lay_10422) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10451, %e1_10452, %e2_10453, %e3_10454 = cute.get_leaves(%3602) : !cute.stride<"((1,2),4,8)">
        %shape_10455 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
        %stride_10456 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_10457 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %lay_10458 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_10459 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %view_10460 = cute.make_view(%iter_8651, %lay_10459) : !memref_rmem_f32_4
        %iter_10461 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %lay_10462 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3603 = cute.get_shape(%lay_10462) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10463, %e1_10464, %e2_10465, %e3_10466 = cute.get_leaves(%3603) : !cute.shape<"((2,2),2,16)">
        %shape_10467 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
        %lay_10468 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
        %3604 = cute.get_shape(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10469, %e1_10470, %e2_10471, %e3_10472 = cute.get_leaves(%3604) : !cute.shape<"((2,2),2,16)">
        %3605 = cute.get_shape(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10473, %e1_10474, %e2_10475, %e3_10476 = cute.get_leaves(%3605) : !cute.shape<"((2,2),2,16)">
        %3606 = cute.get_shape(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10477, %e1_10478, %e2_10479, %e3_10480 = cute.get_leaves(%3606) : !cute.shape<"((2,2),2,16)">
        %3607 = cute.get_shape(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10481, %e1_10482, %e2_10483, %e3_10484 = cute.get_leaves(%3607) : !cute.shape<"((2,2),2,16)">
        %3608 = cute.get_stride(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10485, %e1_10486, %e2_10487, %e3_10488 = cute.get_leaves(%3608) : !cute.stride<"((1,2),4,8)">
        %3609 = cute.get_stride(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10489, %e1_10490, %e2_10491, %e3_10492 = cute.get_leaves(%3609) : !cute.stride<"((1,2),4,8)">
        %3610 = cute.get_stride(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10493, %e1_10494, %e2_10495, %e3_10496 = cute.get_leaves(%3610) : !cute.stride<"((1,2),4,8)">
        %3611 = cute.get_stride(%lay_10468) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_10497, %e1_10498, %e2_10499, %e3_10500 = cute.get_leaves(%3611) : !cute.stride<"((1,2),4,8)">
        %shape_10501 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
        %stride_10502 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_10503 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %lay_10504 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %lay_10505 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %view_10506 = cute.make_view(%iter_637, %lay_10505) : !memref_rmem_f32_5
        %iter_10507 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %lay_10508 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
        %lay_10509 = cute.make_layout() : !cute.layout<"4:1">
        %rmem_10510 = cute.memref.alloca(%lay_10509) : !memref_rmem_f32_1
        %iter_10511 = cute.get_iter(%rmem_10510) : !memref_rmem_f32_1
        %iter_10512 = cute.get_iter(%rmem_10510) : !memref_rmem_f32_1
        %lay_10513 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
        %3612 = cute.get_shape(%lay_10513) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_10514 = cute.get_leaves(%3612) : !cute.shape<"4">
        %lay_10515 = cute.get_layout(%rmem_10510) : !memref_rmem_f32_1
        %3613 = cute.get_shape(%lay_10515) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_10516 = cute.get_leaves(%3613) : !cute.shape<"4">
        %atom_10517 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b>
        %3614 = cute.static : !cute.layout<"1:0">
        %iter_10518 = cute.get_iter(%rmem_1595) : !memref_rmem_f32_1
        %iter_10519 = cute.get_iter(%rmem_10510) : !memref_rmem_f32_1
        %lay_10520 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
        %lay_10521 = cute.get_layout(%rmem_10510) : !memref_rmem_f32_1
        %append_10522 = cute.append_to_rank<2> (%lay_10520, %3614) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %append_10523 = cute.append_to_rank<2> (%lay_10521, %3614) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %lay_10524 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %lay_10525 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %sz_10526 = cute.size(%lay_10524) <{mode = [1]}> : (!cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"1">
        %3615 = cute.get_scalars(%sz_10526) : !cute.int_tuple<"1">
        %c0_i32_10527 = arith.constant 0 : i32
        %c1_i32_10528 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10527 to %3615 step %c1_i32_10528  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"(4):(1)">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10524) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_11566 = cute.add_offset(%iter_10518, %idx_11565) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_rmem_f32_9
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"(4):(1)">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10525) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_11570 = cute.add_offset(%iter_10519, %idx_11569) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_f32_9
          %iter_11572 = cute.get_iter(%view_11567) : !memref_rmem_f32_9
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_f32_9
          %3826 = builtin.unrealized_conversion_cast %iter_11572 : !cute.ptr<f32, rmem, align<32>> to !llvm.ptr
          %3827 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<f32, rmem, align<32>> to !llvm.ptr
          %3828 = llvm.load %3826 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3828, %3827 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %ptr_11575 = cute.add_offset(%iter_11572, %int_tuple_11574) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"1">) -> !cute.ptr<f32, rmem>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"1">) -> !cute.ptr<f32, rmem>
          %3829 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3830 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3831 = llvm.load %3829 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3831, %3830 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11579 = cute.add_offset(%iter_11572, %int_tuple_11578) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
          %int_tuple_11580 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11581 = cute.add_offset(%iter_11573, %int_tuple_11580) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
          %3832 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<f32, rmem, align<8>> to !llvm.ptr
          %3833 = builtin.unrealized_conversion_cast %ptr_11581 : !cute.ptr<f32, rmem, align<8>> to !llvm.ptr
          %3834 = llvm.load %3832 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3834, %3833 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
          %int_tuple_11582 = cute.make_int_tuple() : () -> !cute.int_tuple<"3">
          %ptr_11583 = cute.add_offset(%iter_11572, %int_tuple_11582) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"3">) -> !cute.ptr<f32, rmem>
          %int_tuple_11584 = cute.make_int_tuple() : () -> !cute.int_tuple<"3">
          %ptr_11585 = cute.add_offset(%iter_11573, %int_tuple_11584) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"3">) -> !cute.ptr<f32, rmem>
          %3835 = builtin.unrealized_conversion_cast %ptr_11583 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3836 = builtin.unrealized_conversion_cast %ptr_11585 : !cute.ptr<f32, rmem> to !llvm.ptr
          %3837 = llvm.load %3835 {alignment = 16 : i64} : !llvm.ptr -> vector<1xf32>
          llvm.store %3837, %3836 {alignment = 16 : i64} : vector<1xf32>, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10529 = cute.get_layout(%rmem_1595) : !memref_rmem_f32_1
        %sz_10530 = cute.size(%lay_10529) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
        %e0_10531 = cute.get_leaves(%sz_10530) : !cute.int_tuple<"4">
        %coord_10532 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10533 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10534 = cute.crd2idx(%coord_10532, %lay_10533) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10535 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10536 = cute.add_offset(%iter_10535, %idx_10534) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10537 = cute.make_view(%ptr_10536) : !memref_rmem_f32_6
        %iter_10538 = cute.get_iter(%view_10537) : !memref_rmem_f32_6
        %iter_10539 = cute.get_iter(%view_10537) : !memref_rmem_f32_6
        %lay_10540 = cute.get_layout(%view_10537) : !memref_rmem_f32_6
        %3616 = cute.get_shape(%lay_10540) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10541, %e1_10542 = cute.get_leaves(%3616) : !cute.shape<"((2,8))">
        %3617 = cute.memref.load_vec %view_10537 : !memref_rmem_f32_6
        %cst_10543 = arith.constant 0xFF800000 : f32
        %3618 = vector.reduction <maximumf>, %3617, %cst_10543 : vector<16xf32> into f32
        %c-1_i32_10544 = arith.constant -1 : i32
        %c2_i32_10545 = arith.constant 2 : i32
        %c31_i32_10546 = arith.constant 31 : i32
        %3619 = nvvm.shfl.sync  bfly %c-1_i32_10544, %3618, %c2_i32_10545, %c31_i32_10546 : f32 -> f32
        %3620 = nvvm.fmax %3618, %3619
        %c-1_i32_10547 = arith.constant -1 : i32
        %c1_i32_10548 = arith.constant 1 : i32
        %c31_i32_10549 = arith.constant 31 : i32
        %3621 = nvvm.shfl.sync  bfly %c-1_i32_10547, %3620, %c1_i32_10548, %c31_i32_10549 : f32 -> f32
        %3622 = nvvm.fmax %3620, %3621
        %coord_10550 = cute.make_coord() : () -> !cute.coord<"0">
        %3623 = cute.memref.load(%rmem_10510, %coord_10550) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %3624 = nvvm.fmax %3623, %3622
        %3625 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3626 = arith.mulf %3617, %3625 : vector<16xf32>
        %3627 = arith.mulf %3624, %arg4 : f32
        %3628 = vector.broadcast %3627 : f32 to vector<16xf32>
        %3629 = arith.subf %3626, %3628 : vector<16xf32>
        %3630 = math.exp2 %3629 fastmath<fast> : vector<16xf32>
        %cst_10551 = arith.constant 0.000000e+00 : f32
        %3631 = vector.reduction <add>, %3630, %cst_10551 : vector<16xf32> into f32
        %3632 = arith.mulf %3623, %arg4 : f32
        %3633 = arith.mulf %3624, %arg4 : f32
        %3634 = arith.subf %3632, %3633 : f32
        %3635 = math.exp2 %3634 fastmath<fast> : f32
        %coord_10552 = cute.make_coord() : () -> !cute.coord<"0">
        %3636 = cute.memref.load(%rmem_1600, %coord_10552) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %3637 = arith.mulf %3636, %3635 : f32
        %3638 = arith.addf %3637, %3631 : f32
        %coord_10553 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10554 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10555 = cute.crd2idx(%coord_10553, %lay_10554) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10556 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10557 = cute.add_offset(%iter_10556, %idx_10555) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10558 = cute.make_view(%ptr_10557) : !memref_rmem_f32_10
        %iter_10559 = cute.get_iter(%view_10558) : !memref_rmem_f32_10
        %iter_10560 = cute.get_iter(%view_10558) : !memref_rmem_f32_10
        %lay_10561 = cute.get_layout(%view_10558) : !memref_rmem_f32_10
        %3639 = cute.get_shape(%lay_10561) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10562, %e1_10563 = cute.get_leaves(%3639) : !cute.shape<"((2,16))">
        %3640 = cute.memref.load_vec %view_10558 : !memref_rmem_f32_10
        %3641 = vector.broadcast %3635 : f32 to vector<32xf32>
        %3642 = arith.mulf %3640, %3641 : vector<32xf32>
        %coord_10564 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10565 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10566 = cute.crd2idx(%coord_10564, %lay_10565) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10567 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10568 = cute.add_offset(%iter_10567, %idx_10566) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10569 = cute.make_view(%ptr_10568) : !memref_rmem_f32_10
        %iter_10570 = cute.get_iter(%view_10569) : !memref_rmem_f32_10
        %iter_10571 = cute.get_iter(%view_10569) : !memref_rmem_f32_10
        %lay_10572 = cute.get_layout(%view_10569) : !memref_rmem_f32_10
        %3643 = cute.get_shape(%lay_10572) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10573, %e1_10574 = cute.get_leaves(%3643) : !cute.shape<"((2,16))">
        %int_tuple_10575 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10576 = cute.size(%int_tuple_10575) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10577 = cute.get_leaves(%sz_10576) : !cute.int_tuple<"32">
        %int_tuple_10578 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10579 = cute.size(%int_tuple_10578) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10580 = cute.get_leaves(%sz_10579) : !cute.int_tuple<"32">
        cute.memref.store_vec %3642, %view_10569 : !memref_rmem_f32_10
        %coord_10581 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1595, %coord_10581, %3624) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_10582 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1600, %coord_10582, %3638) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_10583 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_10584 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10585 = cute.crd2idx(%coord_10583, %lay_10584) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_10586 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10587 = cute.add_offset(%iter_10586, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_10588 = cute.make_view(%ptr_10587) : !memref_rmem_f32_6
        %iter_10589 = cute.get_iter(%view_10588) : !memref_rmem_f32_6
        %iter_10590 = cute.get_iter(%view_10588) : !memref_rmem_f32_6
        %lay_10591 = cute.get_layout(%view_10588) : !memref_rmem_f32_6
        %3644 = cute.get_shape(%lay_10591) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10592, %e1_10593 = cute.get_leaves(%3644) : !cute.shape<"((2,8))">
        %int_tuple_10594 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10595 = cute.size(%int_tuple_10594) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10596 = cute.get_leaves(%sz_10595) : !cute.int_tuple<"16">
        %int_tuple_10597 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10598 = cute.size(%int_tuple_10597) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10599 = cute.get_leaves(%sz_10598) : !cute.int_tuple<"16">
        cute.memref.store_vec %3630, %view_10588 : !memref_rmem_f32_6
        %coord_10600 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10601 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10602 = cute.crd2idx(%coord_10600, %lay_10601) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10603 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10604 = cute.add_offset(%iter_10603, %idx_10602) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10605 = cute.make_view(%ptr_10604) : !memref_rmem_f32_7
        %iter_10606 = cute.get_iter(%view_10605) : !memref_rmem_f32_7
        %iter_10607 = cute.get_iter(%view_10605) : !memref_rmem_f32_7
        %lay_10608 = cute.get_layout(%view_10605) : !memref_rmem_f32_7
        %3645 = cute.get_shape(%lay_10608) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10609, %e1_10610 = cute.get_leaves(%3645) : !cute.shape<"((2,8))">
        %3646 = cute.memref.load_vec %view_10605 : !memref_rmem_f32_7
        %cst_10611 = arith.constant 0xFF800000 : f32
        %3647 = vector.reduction <maximumf>, %3646, %cst_10611 : vector<16xf32> into f32
        %c-1_i32_10612 = arith.constant -1 : i32
        %c2_i32_10613 = arith.constant 2 : i32
        %c31_i32_10614 = arith.constant 31 : i32
        %3648 = nvvm.shfl.sync  bfly %c-1_i32_10612, %3647, %c2_i32_10613, %c31_i32_10614 : f32 -> f32
        %3649 = nvvm.fmax %3647, %3648
        %c-1_i32_10615 = arith.constant -1 : i32
        %c1_i32_10616 = arith.constant 1 : i32
        %c31_i32_10617 = arith.constant 31 : i32
        %3650 = nvvm.shfl.sync  bfly %c-1_i32_10615, %3649, %c1_i32_10616, %c31_i32_10617 : f32 -> f32
        %3651 = nvvm.fmax %3649, %3650
        %coord_10618 = cute.make_coord() : () -> !cute.coord<"1">
        %3652 = cute.memref.load(%rmem_10510, %coord_10618) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %3653 = nvvm.fmax %3652, %3651
        %3654 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3655 = arith.mulf %3646, %3654 : vector<16xf32>
        %3656 = arith.mulf %3653, %arg4 : f32
        %3657 = vector.broadcast %3656 : f32 to vector<16xf32>
        %3658 = arith.subf %3655, %3657 : vector<16xf32>
        %3659 = math.exp2 %3658 fastmath<fast> : vector<16xf32>
        %cst_10619 = arith.constant 0.000000e+00 : f32
        %3660 = vector.reduction <add>, %3659, %cst_10619 : vector<16xf32> into f32
        %3661 = arith.mulf %3652, %arg4 : f32
        %3662 = arith.mulf %3653, %arg4 : f32
        %3663 = arith.subf %3661, %3662 : f32
        %3664 = math.exp2 %3663 fastmath<fast> : f32
        %coord_10620 = cute.make_coord() : () -> !cute.coord<"1">
        %3665 = cute.memref.load(%rmem_1600, %coord_10620) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %3666 = arith.mulf %3665, %3664 : f32
        %3667 = arith.addf %3666, %3660 : f32
        %coord_10621 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10622 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10623 = cute.crd2idx(%coord_10621, %lay_10622) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10624 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10625 = cute.add_offset(%iter_10624, %idx_10623) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10626 = cute.make_view(%ptr_10625) : !memref_rmem_f32_11
        %iter_10627 = cute.get_iter(%view_10626) : !memref_rmem_f32_11
        %iter_10628 = cute.get_iter(%view_10626) : !memref_rmem_f32_11
        %lay_10629 = cute.get_layout(%view_10626) : !memref_rmem_f32_11
        %3668 = cute.get_shape(%lay_10629) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10630, %e1_10631 = cute.get_leaves(%3668) : !cute.shape<"((2,16))">
        %3669 = cute.memref.load_vec %view_10626 : !memref_rmem_f32_11
        %3670 = vector.broadcast %3664 : f32 to vector<32xf32>
        %3671 = arith.mulf %3669, %3670 : vector<32xf32>
        %coord_10632 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10633 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10634 = cute.crd2idx(%coord_10632, %lay_10633) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10635 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10636 = cute.add_offset(%iter_10635, %idx_10634) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10637 = cute.make_view(%ptr_10636) : !memref_rmem_f32_11
        %iter_10638 = cute.get_iter(%view_10637) : !memref_rmem_f32_11
        %iter_10639 = cute.get_iter(%view_10637) : !memref_rmem_f32_11
        %lay_10640 = cute.get_layout(%view_10637) : !memref_rmem_f32_11
        %3672 = cute.get_shape(%lay_10640) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10641, %e1_10642 = cute.get_leaves(%3672) : !cute.shape<"((2,16))">
        %int_tuple_10643 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10644 = cute.size(%int_tuple_10643) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10645 = cute.get_leaves(%sz_10644) : !cute.int_tuple<"32">
        %int_tuple_10646 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10647 = cute.size(%int_tuple_10646) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10648 = cute.get_leaves(%sz_10647) : !cute.int_tuple<"32">
        cute.memref.store_vec %3671, %view_10637 : !memref_rmem_f32_11
        %coord_10649 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1595, %coord_10649, %3653) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_10650 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1600, %coord_10650, %3667) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_10651 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_10652 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10653 = cute.crd2idx(%coord_10651, %lay_10652) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_10654 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10655 = cute.add_offset(%iter_10654, %idx_10653) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10656 = cute.make_view(%ptr_10655) : !memref_rmem_f32_7
        %iter_10657 = cute.get_iter(%view_10656) : !memref_rmem_f32_7
        %iter_10658 = cute.get_iter(%view_10656) : !memref_rmem_f32_7
        %lay_10659 = cute.get_layout(%view_10656) : !memref_rmem_f32_7
        %3673 = cute.get_shape(%lay_10659) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10660, %e1_10661 = cute.get_leaves(%3673) : !cute.shape<"((2,8))">
        %int_tuple_10662 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10663 = cute.size(%int_tuple_10662) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10664 = cute.get_leaves(%sz_10663) : !cute.int_tuple<"16">
        %int_tuple_10665 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10666 = cute.size(%int_tuple_10665) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10667 = cute.get_leaves(%sz_10666) : !cute.int_tuple<"16">
        cute.memref.store_vec %3659, %view_10656 : !memref_rmem_f32_7
        %coord_10668 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10669 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10670 = cute.crd2idx(%coord_10668, %lay_10669) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10671 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10672 = cute.add_offset(%iter_10671, %idx_10670) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10673 = cute.make_view(%ptr_10672) : !memref_rmem_f32_8
        %iter_10674 = cute.get_iter(%view_10673) : !memref_rmem_f32_8
        %iter_10675 = cute.get_iter(%view_10673) : !memref_rmem_f32_8
        %lay_10676 = cute.get_layout(%view_10673) : !memref_rmem_f32_8
        %3674 = cute.get_shape(%lay_10676) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10677, %e1_10678 = cute.get_leaves(%3674) : !cute.shape<"((2,8))">
        %3675 = cute.memref.load_vec %view_10673 : !memref_rmem_f32_8
        %cst_10679 = arith.constant 0xFF800000 : f32
        %3676 = vector.reduction <maximumf>, %3675, %cst_10679 : vector<16xf32> into f32
        %c-1_i32_10680 = arith.constant -1 : i32
        %c2_i32_10681 = arith.constant 2 : i32
        %c31_i32_10682 = arith.constant 31 : i32
        %3677 = nvvm.shfl.sync  bfly %c-1_i32_10680, %3676, %c2_i32_10681, %c31_i32_10682 : f32 -> f32
        %3678 = nvvm.fmax %3676, %3677
        %c-1_i32_10683 = arith.constant -1 : i32
        %c1_i32_10684 = arith.constant 1 : i32
        %c31_i32_10685 = arith.constant 31 : i32
        %3679 = nvvm.shfl.sync  bfly %c-1_i32_10683, %3678, %c1_i32_10684, %c31_i32_10685 : f32 -> f32
        %3680 = nvvm.fmax %3678, %3679
        %coord_10686 = cute.make_coord() : () -> !cute.coord<"2">
        %3681 = cute.memref.load(%rmem_10510, %coord_10686) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %3682 = nvvm.fmax %3681, %3680
        %3683 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3684 = arith.mulf %3675, %3683 : vector<16xf32>
        %3685 = arith.mulf %3682, %arg4 : f32
        %3686 = vector.broadcast %3685 : f32 to vector<16xf32>
        %3687 = arith.subf %3684, %3686 : vector<16xf32>
        %3688 = math.exp2 %3687 fastmath<fast> : vector<16xf32>
        %cst_10687 = arith.constant 0.000000e+00 : f32
        %3689 = vector.reduction <add>, %3688, %cst_10687 : vector<16xf32> into f32
        %3690 = arith.mulf %3681, %arg4 : f32
        %3691 = arith.mulf %3682, %arg4 : f32
        %3692 = arith.subf %3690, %3691 : f32
        %3693 = math.exp2 %3692 fastmath<fast> : f32
        %coord_10688 = cute.make_coord() : () -> !cute.coord<"2">
        %3694 = cute.memref.load(%rmem_1600, %coord_10688) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %3695 = arith.mulf %3694, %3693 : f32
        %3696 = arith.addf %3695, %3689 : f32
        %coord_10689 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10690 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10691 = cute.crd2idx(%coord_10689, %lay_10690) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10692 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10693 = cute.add_offset(%iter_10692, %idx_10691) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10694 = cute.make_view(%ptr_10693) : !memref_rmem_f32_12
        %iter_10695 = cute.get_iter(%view_10694) : !memref_rmem_f32_12
        %iter_10696 = cute.get_iter(%view_10694) : !memref_rmem_f32_12
        %lay_10697 = cute.get_layout(%view_10694) : !memref_rmem_f32_12
        %3697 = cute.get_shape(%lay_10697) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10698, %e1_10699 = cute.get_leaves(%3697) : !cute.shape<"((2,16))">
        %3698 = cute.memref.load_vec %view_10694 : !memref_rmem_f32_12
        %3699 = vector.broadcast %3693 : f32 to vector<32xf32>
        %3700 = arith.mulf %3698, %3699 : vector<32xf32>
        %coord_10700 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10701 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10702 = cute.crd2idx(%coord_10700, %lay_10701) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10703 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10704 = cute.add_offset(%iter_10703, %idx_10702) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10705 = cute.make_view(%ptr_10704) : !memref_rmem_f32_12
        %iter_10706 = cute.get_iter(%view_10705) : !memref_rmem_f32_12
        %iter_10707 = cute.get_iter(%view_10705) : !memref_rmem_f32_12
        %lay_10708 = cute.get_layout(%view_10705) : !memref_rmem_f32_12
        %3701 = cute.get_shape(%lay_10708) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10709, %e1_10710 = cute.get_leaves(%3701) : !cute.shape<"((2,16))">
        %int_tuple_10711 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10712 = cute.size(%int_tuple_10711) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10713 = cute.get_leaves(%sz_10712) : !cute.int_tuple<"32">
        %int_tuple_10714 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10715 = cute.size(%int_tuple_10714) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10716 = cute.get_leaves(%sz_10715) : !cute.int_tuple<"32">
        cute.memref.store_vec %3700, %view_10705 : !memref_rmem_f32_12
        %coord_10717 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1595, %coord_10717, %3682) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_10718 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1600, %coord_10718, %3696) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_10719 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_10720 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10721 = cute.crd2idx(%coord_10719, %lay_10720) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_10722 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10723 = cute.add_offset(%iter_10722, %idx_10721) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_10724 = cute.make_view(%ptr_10723) : !memref_rmem_f32_8
        %iter_10725 = cute.get_iter(%view_10724) : !memref_rmem_f32_8
        %iter_10726 = cute.get_iter(%view_10724) : !memref_rmem_f32_8
        %lay_10727 = cute.get_layout(%view_10724) : !memref_rmem_f32_8
        %3702 = cute.get_shape(%lay_10727) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10728, %e1_10729 = cute.get_leaves(%3702) : !cute.shape<"((2,8))">
        %int_tuple_10730 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10731 = cute.size(%int_tuple_10730) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10732 = cute.get_leaves(%sz_10731) : !cute.int_tuple<"16">
        %int_tuple_10733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10734 = cute.size(%int_tuple_10733) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10735 = cute.get_leaves(%sz_10734) : !cute.int_tuple<"16">
        cute.memref.store_vec %3688, %view_10724 : !memref_rmem_f32_8
        %coord_10736 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10737 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10738 = cute.crd2idx(%coord_10736, %lay_10737) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10739 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10740 = cute.add_offset(%iter_10739, %idx_10738) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10741 = cute.make_view(%ptr_10740) : !memref_rmem_f32_7
        %iter_10742 = cute.get_iter(%view_10741) : !memref_rmem_f32_7
        %iter_10743 = cute.get_iter(%view_10741) : !memref_rmem_f32_7
        %lay_10744 = cute.get_layout(%view_10741) : !memref_rmem_f32_7
        %3703 = cute.get_shape(%lay_10744) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10745, %e1_10746 = cute.get_leaves(%3703) : !cute.shape<"((2,8))">
        %3704 = cute.memref.load_vec %view_10741 : !memref_rmem_f32_7
        %cst_10747 = arith.constant 0xFF800000 : f32
        %3705 = vector.reduction <maximumf>, %3704, %cst_10747 : vector<16xf32> into f32
        %c-1_i32_10748 = arith.constant -1 : i32
        %c2_i32_10749 = arith.constant 2 : i32
        %c31_i32_10750 = arith.constant 31 : i32
        %3706 = nvvm.shfl.sync  bfly %c-1_i32_10748, %3705, %c2_i32_10749, %c31_i32_10750 : f32 -> f32
        %3707 = nvvm.fmax %3705, %3706
        %c-1_i32_10751 = arith.constant -1 : i32
        %c1_i32_10752 = arith.constant 1 : i32
        %c31_i32_10753 = arith.constant 31 : i32
        %3708 = nvvm.shfl.sync  bfly %c-1_i32_10751, %3707, %c1_i32_10752, %c31_i32_10753 : f32 -> f32
        %3709 = nvvm.fmax %3707, %3708
        %coord_10754 = cute.make_coord() : () -> !cute.coord<"3">
        %3710 = cute.memref.load(%rmem_10510, %coord_10754) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %3711 = nvvm.fmax %3710, %3709
        %3712 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %3713 = arith.mulf %3704, %3712 : vector<16xf32>
        %3714 = arith.mulf %3711, %arg4 : f32
        %3715 = vector.broadcast %3714 : f32 to vector<16xf32>
        %3716 = arith.subf %3713, %3715 : vector<16xf32>
        %3717 = math.exp2 %3716 fastmath<fast> : vector<16xf32>
        %cst_10755 = arith.constant 0.000000e+00 : f32
        %3718 = vector.reduction <add>, %3717, %cst_10755 : vector<16xf32> into f32
        %3719 = arith.mulf %3710, %arg4 : f32
        %3720 = arith.mulf %3711, %arg4 : f32
        %3721 = arith.subf %3719, %3720 : f32
        %3722 = math.exp2 %3721 fastmath<fast> : f32
        %coord_10756 = cute.make_coord() : () -> !cute.coord<"3">
        %3723 = cute.memref.load(%rmem_1600, %coord_10756) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %3724 = arith.mulf %3723, %3722 : f32
        %3725 = arith.addf %3724, %3718 : f32
        %coord_10757 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10758 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10759 = cute.crd2idx(%coord_10757, %lay_10758) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10760 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10761 = cute.add_offset(%iter_10760, %idx_10759) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10762 = cute.make_view(%ptr_10761) : !memref_rmem_f32_11
        %iter_10763 = cute.get_iter(%view_10762) : !memref_rmem_f32_11
        %iter_10764 = cute.get_iter(%view_10762) : !memref_rmem_f32_11
        %lay_10765 = cute.get_layout(%view_10762) : !memref_rmem_f32_11
        %3726 = cute.get_shape(%lay_10765) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10766, %e1_10767 = cute.get_leaves(%3726) : !cute.shape<"((2,16))">
        %3727 = cute.memref.load_vec %view_10762 : !memref_rmem_f32_11
        %3728 = vector.broadcast %3722 : f32 to vector<32xf32>
        %3729 = arith.mulf %3727, %3728 : vector<32xf32>
        %coord_10768 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10769 = cute.get_layout(%view_10506) : !memref_rmem_f32_5
        %idx_10770 = cute.crd2idx(%coord_10768, %lay_10769) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10771 = cute.get_iter(%view_10506) : !memref_rmem_f32_5
        %ptr_10772 = cute.add_offset(%iter_10771, %idx_10770) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10773 = cute.make_view(%ptr_10772) : !memref_rmem_f32_11
        %iter_10774 = cute.get_iter(%view_10773) : !memref_rmem_f32_11
        %iter_10775 = cute.get_iter(%view_10773) : !memref_rmem_f32_11
        %lay_10776 = cute.get_layout(%view_10773) : !memref_rmem_f32_11
        %3730 = cute.get_shape(%lay_10776) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10777, %e1_10778 = cute.get_leaves(%3730) : !cute.shape<"((2,16))">
        %int_tuple_10779 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10780 = cute.size(%int_tuple_10779) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10781 = cute.get_leaves(%sz_10780) : !cute.int_tuple<"32">
        %int_tuple_10782 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10783 = cute.size(%int_tuple_10782) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10784 = cute.get_leaves(%sz_10783) : !cute.int_tuple<"32">
        cute.memref.store_vec %3729, %view_10773 : !memref_rmem_f32_11
        %coord_10785 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1595, %coord_10785, %3711) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10786 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1600, %coord_10786, %3725) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10787 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10788 = cute.get_layout(%view_10460) : !memref_rmem_f32_4
        %idx_10789 = cute.crd2idx(%coord_10787, %lay_10788) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10790 = cute.get_iter(%view_10460) : !memref_rmem_f32_4
        %ptr_10791 = cute.add_offset(%iter_10790, %idx_10789) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10792 = cute.make_view(%ptr_10791) : !memref_rmem_f32_7
        %iter_10793 = cute.get_iter(%view_10792) : !memref_rmem_f32_7
        %iter_10794 = cute.get_iter(%view_10792) : !memref_rmem_f32_7
        %lay_10795 = cute.get_layout(%view_10792) : !memref_rmem_f32_7
        %3731 = cute.get_shape(%lay_10795) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10796, %e1_10797 = cute.get_leaves(%3731) : !cute.shape<"((2,8))">
        %int_tuple_10798 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10799 = cute.size(%int_tuple_10798) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10800 = cute.get_leaves(%sz_10799) : !cute.int_tuple<"16">
        %int_tuple_10801 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10802 = cute.size(%int_tuple_10801) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10803 = cute.get_leaves(%sz_10802) : !cute.int_tuple<"16">
        cute.memref.store_vec %3717, %view_10792 : !memref_rmem_f32_7
        %lay_10804 = cute.get_layout(%rmem_8649) : !memref_rmem_f32_2
        %lay_10805 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_10806 = cute.memref.alloca(%lay_10805) : !memref_rmem_bf16_16
        %iter_10807 = cute.get_iter(%rmem_10806) : !memref_rmem_bf16_16
        %iter_10808 = cute.get_iter(%rmem_10806) : !memref_rmem_bf16_16
        %3732 = cute.memref.load_vec %rmem_8649 : !memref_rmem_f32_2
        %3733 = arith.truncf %3732 : vector<64xf32> to vector<64xbf16>
        %lay_10809 = cute.get_layout(%rmem_10806) : !memref_rmem_bf16_16
        %3734 = cute.get_shape(%lay_10809) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10810, %e1_10811, %e2_10812, %e3_10813 = cute.get_leaves(%3734) : !cute.shape<"((2,2),2,8)">
        %int_tuple_10814 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10815 = cute.size(%int_tuple_10814) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10816 = cute.get_leaves(%sz_10815) : !cute.int_tuple<"64">
        %int_tuple_10817 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10818 = cute.size(%int_tuple_10817) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10819 = cute.get_leaves(%sz_10818) : !cute.int_tuple<"64">
        cute.memref.store_vec %3733, %rmem_10806 : !memref_rmem_bf16_16
        %lay_10820 = cute.get_layout(%rmem_10806) : !memref_rmem_bf16_16
        %tile_10821 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_10822 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
        %3735 = cute.get_shape(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10823, %e1_10824, %e2_10825, %e3_10826, %e4_10827 = cute.get_leaves(%3735) : !cute.shape<"((2,2),2,(2,4))">
        %3736 = cute.get_shape(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10828, %e1_10829, %e2_10830, %e3_10831, %e4_10832 = cute.get_leaves(%3736) : !cute.shape<"((2,2),2,(2,4))">
        %3737 = cute.get_shape(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10833, %e1_10834, %e2_10835, %e3_10836, %e4_10837 = cute.get_leaves(%3737) : !cute.shape<"((2,2),2,(2,4))">
        %3738 = cute.get_shape(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10838, %e1_10839, %e2_10840, %e3_10841, %e4_10842 = cute.get_leaves(%3738) : !cute.shape<"((2,2),2,(2,4))">
        %3739 = cute.get_stride(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10843, %e1_10844, %e2_10845, %e3_10846, %e4_10847 = cute.get_leaves(%3739) : !cute.stride<"((1,2),4,(8,16))">
        %3740 = cute.get_stride(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10848, %e1_10849, %e2_10850, %e3_10851, %e4_10852 = cute.get_leaves(%3740) : !cute.stride<"((1,2),4,(8,16))">
        %3741 = cute.get_stride(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10853, %e1_10854, %e2_10855, %e3_10856, %e4_10857 = cute.get_leaves(%3741) : !cute.stride<"((1,2),4,(8,16))">
        %3742 = cute.get_stride(%lay_10822) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10858, %e1_10859, %e2_10860, %e3_10861, %e4_10862 = cute.get_leaves(%3742) : !cute.stride<"((1,2),4,(8,16))">
        %shape_10863 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
        %stride_10864 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
        %lay_10865 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
        %view_10866 = cute.make_view(%iter_10808, %lay_10865) : !memref_rmem_bf16_17
        %iter_10867 = cute.get_iter(%view_10866) : !memref_rmem_bf16_17
        %coord_10868 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10869 = cute.get_layout(%view_862) : !memref_smem_bf16_10
        %3743:2 = cute.get_scalars(%lay_10869) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_10870 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_10871 = cute.assume(%3743#0) : (i32) -> !cute.i32<divby 16>
        %iv_10872 = cute.assume(%3743#1) : (i32) -> !cute.i32<divby 32>
        %stride_10873 = cute.make_stride(%iv_10871, %iv_10872) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_10874 = cute.make_layout(%shape_10870, %stride_10873) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_10875 = cute.crd2idx(%coord_10868, %lay_10869) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_10876 = cute.get_iter(%view_862) : !memref_smem_bf16_10
        %ptr_10877 = cute.add_offset(%iter_10876, %idx_10875) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10878 = cute.make_view(%ptr_10877, %lay_10874) : !memref_smem_bf16_19
        %iter_10879 = cute.get_iter(%view_10878) : !memref_smem_bf16_19
        %iter_10880 = cute.get_iter(%view_10878) : !memref_smem_bf16_19
        %coord_10881 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10882 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
        %idx_10883 = cute.crd2idx(%coord_10881, %lay_10882) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_10884 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
        %ptr_10885 = cute.add_offset(%iter_10884, %idx_10883) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10886 = cute.make_view(%ptr_10885) : !memref_rmem_bf16_18
        %iter_10887 = cute.get_iter(%view_10886) : !memref_rmem_bf16_18
        %iter_10888 = cute.get_iter(%view_10886) : !memref_rmem_bf16_18
        %lay_10889 = cute.get_layout(%view_10878) : !memref_smem_bf16_19
        %3744 = cute.get_shape(%lay_10889) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10890, %e1_10891, %e2_10892, %e3_10893, %e4_10894 = cute.get_leaves(%3744) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10895 = cute.get_layout(%view_10886) : !memref_rmem_bf16_18
        %3745 = cute.get_shape(%lay_10895) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10896, %e1_10897, %e2_10898, %e3_10899 = cute.get_leaves(%3745) : !cute.shape<"((8,1),(4,2))">
        %lay_10900 = cute.get_layout(%view_10878) : !memref_smem_bf16_19
        %shape_10901 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10902 = cute.make_layout() : !cute.layout<"1:0">
        %append_10903 = cute.append_to_rank<2> (%lay_10900, %lay_10902) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10904 = cute.make_view(%iter_10880, %append_10903) : !memref_smem_bf16_19
        %iter_10905 = cute.get_iter(%view_10904) : !memref_smem_bf16_19
        %lay_10906 = cute.get_layout(%view_10904) : !memref_smem_bf16_19
        %3746 = cute.get_shape(%lay_10906) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10907, %e1_10908, %e2_10909, %e3_10910, %e4_10911 = cute.get_leaves(%3746) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10912 = cute.get_iter(%view_10904) : !memref_smem_bf16_19
        %lay_10913 = cute.get_layout(%view_10904) : !memref_smem_bf16_19
        %3747:2 = cute.get_scalars(%lay_10913) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10914 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10915 = cute.assume(%3747#0) : (i32) -> !cute.i32<divby 16>
        %iv_10916 = cute.assume(%3747#1) : (i32) -> !cute.i32<divby 32>
        %stride_10917 = cute.make_stride(%iv_10915, %iv_10916) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10918 = cute.make_layout(%shape_10914, %stride_10917) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10919 = cute.make_view(%iter_10912, %lay_10918) : !memref_smem_bf16_20
        %iter_10920 = cute.get_iter(%view_10919) : !memref_smem_bf16_20
        %iter_10921 = cute.get_iter(%view_10919) : !memref_smem_bf16_20
        %lay_10922 = cute.get_layout(%view_10886) : !memref_rmem_bf16_18
        %shape_10923 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10924 = cute.make_layout() : !cute.layout<"1:0">
        %append_10925 = cute.append_to_rank<2> (%lay_10922, %lay_10924) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10926 = cute.make_view(%iter_10888, %append_10925) : !memref_rmem_bf16_18
        %iter_10927 = cute.get_iter(%view_10926) : !memref_rmem_bf16_18
        %lay_10928 = cute.get_layout(%view_10926) : !memref_rmem_bf16_18
        %3748 = cute.get_shape(%lay_10928) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10929, %e1_10930, %e2_10931, %e3_10932 = cute.get_leaves(%3748) : !cute.shape<"((8,1),(4,2))">
        %iter_10933 = cute.get_iter(%view_10926) : !memref_rmem_bf16_18
        %view_10934 = cute.make_view(%iter_10933) : !memref_rmem_bf16_19
        %iter_10935 = cute.get_iter(%view_10934) : !memref_rmem_bf16_19
        %iter_10936 = cute.get_iter(%view_10934) : !memref_rmem_bf16_19
        %lay_10937 = cute.get_layout(%view_10919) : !memref_smem_bf16_20
        %3749 = cute.get_shape(%lay_10937) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10938, %e1_10939, %e2_10940, %e3_10941, %e4_10942 = cute.get_leaves(%3749) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10943 = cute.get_layout(%view_10934) : !memref_rmem_bf16_19
        %3750 = cute.get_shape(%lay_10943) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10944, %e1_10945, %e2_10946, %e3_10947 = cute.get_leaves(%3750) : !cute.shape<"((8,1),((4,2)))">
        %lay_10948 = cute.get_layout(%view_10919) : !memref_smem_bf16_20
        %sz_10949 = cute.size(%lay_10948) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10950 = cute.get_leaves(%sz_10949) : !cute.int_tuple<"8">
        %lay_10951 = cute.get_layout(%view_10934) : !memref_rmem_bf16_19
        %sz_10952 = cute.size(%lay_10951) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10953 = cute.get_leaves(%sz_10952) : !cute.int_tuple<"8">
        %3751 = cute.static : !cute.layout<"1:0">
        %iter_10954 = cute.get_iter(%view_10919) : !memref_smem_bf16_20
        %iter_10955 = cute.get_iter(%view_10934) : !memref_rmem_bf16_19
        %lay_10956 = cute.get_layout(%view_10919) : !memref_smem_bf16_20
        %lay_10957 = cute.get_layout(%view_10934) : !memref_rmem_bf16_19
        %append_10958 = cute.append_to_rank<2> (%lay_10956, %3751) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10959 = cute.append_to_rank<2> (%lay_10957, %3751) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3752:2 = cute.get_scalars(%append_10958) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10960 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10961 = cute.assume(%3752#0) : (i32) -> !cute.i32<divby 16>
        %iv_10962 = cute.assume(%3752#1) : (i32) -> !cute.i32<divby 32>
        %stride_10963 = cute.make_stride(%iv_10961, %iv_10962) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10964 = cute.make_layout(%shape_10960, %stride_10963) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10965 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10966 = cute.size(%lay_10964) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3753 = cute.get_scalars(%sz_10966) : !cute.int_tuple<"8">
        %c0_i32_10967 = arith.constant 0 : i32
        %c1_i32_10968 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10967 to %3753 step %c1_i32_10968  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824:2 = cute.get_scalars(%lay_10964) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_10964) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11566 = cute.add_offset(%iter_10954, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3826 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_10965) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_10955, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3828 = llvm.mlir.constant(0 : i32) : i32
          %3829 = vector.extractelement %3827[%3828 : i32] : vector<4xi32>
          %3830 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
          %3831 = llvm.mlir.constant(1 : i32) : i32
          %3832 = vector.extractelement %3827[%3831 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3833 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3832, %3833 : i32, !llvm.ptr
          %3834 = llvm.mlir.constant(2 : i32) : i32
          %3835 = vector.extractelement %3827[%3834 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3836 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3835, %3836 : i32, !llvm.ptr
          %3837 = llvm.mlir.constant(3 : i32) : i32
          %3838 = vector.extractelement %3827[%3837 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3839 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3838, %3839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10969 = cute.get_layout(%view_10866) : !memref_rmem_bf16_17
        %3754 = cute.get_shape(%lay_10969) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
        %e0_10970, %e1_10971, %e2_10972, %e3_10973, %e4_10974 = cute.get_leaves(%3754) : !cute.shape<"(((2,2),2),2,4)">
        %int_tuple_10975 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10976 = cute.size(%int_tuple_10975) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10977 = cute.get_leaves(%sz_10976) : !cute.int_tuple<"4">
        %int_tuple_10978 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10979 = cute.size(%int_tuple_10978) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10980 = cute.get_leaves(%sz_10979) : !cute.int_tuple<"4">
        %coord_10981 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10982 = cute.get_layout(%view_862) : !memref_smem_bf16_10
        %3755:2 = cute.get_scalars(%lay_10982) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_10983 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_10984 = cute.assume(%3755#0) : (i32) -> !cute.i32<divby 16>
        %iv_10985 = cute.assume(%3755#1) : (i32) -> !cute.i32<divby 32>
        %stride_10986 = cute.make_stride(%iv_10984, %iv_10985) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_10987 = cute.make_layout(%shape_10983, %stride_10986) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_10988 = cute.crd2idx(%coord_10981, %lay_10982) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
        %iter_10989 = cute.get_iter(%view_862) : !memref_smem_bf16_10
        %ptr_10990 = cute.add_offset(%iter_10989, %idx_10988) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10991 = cute.make_view(%ptr_10990, %lay_10987) : !memref_smem_bf16_19
        %iter_10992 = cute.get_iter(%view_10991) : !memref_smem_bf16_19
        %iter_10993 = cute.get_iter(%view_10991) : !memref_smem_bf16_19
        %coord_10994 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10995 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
        %idx_10996 = cute.crd2idx(%coord_10994, %lay_10995) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
        %iter_10997 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
        %ptr_10998 = cute.add_offset(%iter_10997, %idx_10996) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10999 = cute.make_view(%ptr_10998) : !memref_rmem_bf16_18
        %iter_11000 = cute.get_iter(%view_10999) : !memref_rmem_bf16_18
        %iter_11001 = cute.get_iter(%view_10999) : !memref_rmem_bf16_18
        %lay_11002 = cute.get_layout(%view_10991) : !memref_smem_bf16_19
        %3756 = cute.get_shape(%lay_11002) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11003, %e1_11004, %e2_11005, %e3_11006, %e4_11007 = cute.get_leaves(%3756) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11008 = cute.get_layout(%view_10999) : !memref_rmem_bf16_18
        %3757 = cute.get_shape(%lay_11008) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11009, %e1_11010, %e2_11011, %e3_11012 = cute.get_leaves(%3757) : !cute.shape<"((8,1),(4,2))">
        %lay_11013 = cute.get_layout(%view_10991) : !memref_smem_bf16_19
        %shape_11014 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11015 = cute.make_layout() : !cute.layout<"1:0">
        %append_11016 = cute.append_to_rank<2> (%lay_11013, %lay_11015) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11017 = cute.make_view(%iter_10993, %append_11016) : !memref_smem_bf16_19
        %iter_11018 = cute.get_iter(%view_11017) : !memref_smem_bf16_19
        %lay_11019 = cute.get_layout(%view_11017) : !memref_smem_bf16_19
        %3758 = cute.get_shape(%lay_11019) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11020, %e1_11021, %e2_11022, %e3_11023, %e4_11024 = cute.get_leaves(%3758) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11025 = cute.get_iter(%view_11017) : !memref_smem_bf16_19
        %lay_11026 = cute.get_layout(%view_11017) : !memref_smem_bf16_19
        %3759:2 = cute.get_scalars(%lay_11026) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11027 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11028 = cute.assume(%3759#0) : (i32) -> !cute.i32<divby 16>
        %iv_11029 = cute.assume(%3759#1) : (i32) -> !cute.i32<divby 32>
        %stride_11030 = cute.make_stride(%iv_11028, %iv_11029) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11031 = cute.make_layout(%shape_11027, %stride_11030) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11032 = cute.make_view(%iter_11025, %lay_11031) : !memref_smem_bf16_20
        %iter_11033 = cute.get_iter(%view_11032) : !memref_smem_bf16_20
        %iter_11034 = cute.get_iter(%view_11032) : !memref_smem_bf16_20
        %lay_11035 = cute.get_layout(%view_10999) : !memref_rmem_bf16_18
        %shape_11036 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11037 = cute.make_layout() : !cute.layout<"1:0">
        %append_11038 = cute.append_to_rank<2> (%lay_11035, %lay_11037) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11039 = cute.make_view(%iter_11001, %append_11038) : !memref_rmem_bf16_18
        %iter_11040 = cute.get_iter(%view_11039) : !memref_rmem_bf16_18
        %lay_11041 = cute.get_layout(%view_11039) : !memref_rmem_bf16_18
        %3760 = cute.get_shape(%lay_11041) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11042, %e1_11043, %e2_11044, %e3_11045 = cute.get_leaves(%3760) : !cute.shape<"((8,1),(4,2))">
        %iter_11046 = cute.get_iter(%view_11039) : !memref_rmem_bf16_18
        %view_11047 = cute.make_view(%iter_11046) : !memref_rmem_bf16_19
        %iter_11048 = cute.get_iter(%view_11047) : !memref_rmem_bf16_19
        %iter_11049 = cute.get_iter(%view_11047) : !memref_rmem_bf16_19
        %lay_11050 = cute.get_layout(%view_11032) : !memref_smem_bf16_20
        %3761 = cute.get_shape(%lay_11050) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11051, %e1_11052, %e2_11053, %e3_11054, %e4_11055 = cute.get_leaves(%3761) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11056 = cute.get_layout(%view_11047) : !memref_rmem_bf16_19
        %3762 = cute.get_shape(%lay_11056) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11057, %e1_11058, %e2_11059, %e3_11060 = cute.get_leaves(%3762) : !cute.shape<"((8,1),((4,2)))">
        %lay_11061 = cute.get_layout(%view_11032) : !memref_smem_bf16_20
        %sz_11062 = cute.size(%lay_11061) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11063 = cute.get_leaves(%sz_11062) : !cute.int_tuple<"8">
        %lay_11064 = cute.get_layout(%view_11047) : !memref_rmem_bf16_19
        %sz_11065 = cute.size(%lay_11064) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11066 = cute.get_leaves(%sz_11065) : !cute.int_tuple<"8">
        %3763 = cute.static : !cute.layout<"1:0">
        %iter_11067 = cute.get_iter(%view_11032) : !memref_smem_bf16_20
        %iter_11068 = cute.get_iter(%view_11047) : !memref_rmem_bf16_19
        %lay_11069 = cute.get_layout(%view_11032) : !memref_smem_bf16_20
        %lay_11070 = cute.get_layout(%view_11047) : !memref_rmem_bf16_19
        %append_11071 = cute.append_to_rank<2> (%lay_11069, %3763) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11072 = cute.append_to_rank<2> (%lay_11070, %3763) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3764:2 = cute.get_scalars(%append_11071) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11073 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11074 = cute.assume(%3764#0) : (i32) -> !cute.i32<divby 16>
        %iv_11075 = cute.assume(%3764#1) : (i32) -> !cute.i32<divby 32>
        %stride_11076 = cute.make_stride(%iv_11074, %iv_11075) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11077 = cute.make_layout(%shape_11073, %stride_11076) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11078 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11079 = cute.size(%lay_11077) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3765 = cute.get_scalars(%sz_11079) : !cute.int_tuple<"8">
        %c0_i32_11080 = arith.constant 0 : i32
        %c1_i32_11081 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11080 to %3765 step %c1_i32_11081  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824:2 = cute.get_scalars(%lay_11077) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_11077) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11566 = cute.add_offset(%iter_11067, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3826 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_11078) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_11068, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3828 = llvm.mlir.constant(0 : i32) : i32
          %3829 = vector.extractelement %3827[%3828 : i32] : vector<4xi32>
          %3830 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
          %3831 = llvm.mlir.constant(1 : i32) : i32
          %3832 = vector.extractelement %3827[%3831 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3833 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3832, %3833 : i32, !llvm.ptr
          %3834 = llvm.mlir.constant(2 : i32) : i32
          %3835 = vector.extractelement %3827[%3834 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3836 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3835, %3836 : i32, !llvm.ptr
          %3837 = llvm.mlir.constant(3 : i32) : i32
          %3838 = vector.extractelement %3827[%3837 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3839 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3838, %3839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11082 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11083 = cute.get_layout(%view_10866) : !memref_rmem_bf16_17
        %idx_11084 = cute.crd2idx(%coord_11082, %lay_11083) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
        %iter_11085 = cute.get_iter(%view_10866) : !memref_rmem_bf16_17
        %ptr_11086 = cute.add_offset(%iter_11085, %idx_11084) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11087 = cute.make_view(%ptr_11086) : !memref_rmem_bf16_20
        %iter_11088 = cute.get_iter(%view_11087) : !memref_rmem_bf16_20
        %iter_11089 = cute.get_iter(%view_11087) : !memref_rmem_bf16_20
        %coord_11090 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11091 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
        %idx_11092 = cute.crd2idx(%coord_11090, %lay_11091) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_11093 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
        %ptr_11094 = cute.add_offset(%iter_11093, %idx_11092) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11095 = cute.make_view(%ptr_11094) : !memref_rmem_bf16_21
        %iter_11096 = cute.get_iter(%view_11095) : !memref_rmem_bf16_21
        %iter_11097 = cute.get_iter(%view_11095) : !memref_rmem_bf16_21
        %lay_11098 = cute.get_layout(%view_11087) : !memref_rmem_bf16_20
        %3766 = cute.get_shape(%lay_11098) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11099, %e1_11100, %e2_11101, %e3_11102 = cute.get_leaves(%3766) : !cute.shape<"(((2,2),2),2)">
        %lay_11103 = cute.get_layout(%view_11095) : !memref_rmem_bf16_21
        %3767 = cute.get_shape(%lay_11103) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11104, %e1_11105, %e2_11106, %e3_11107 = cute.get_leaves(%3767) : !cute.shape<"((2,2),(8,2))">
        %lay_11108 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3768 = cute.get_shape(%lay_11108) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_11109, %e1_11110, %e2_11111, %e3_11112 = cute.get_leaves(%3768) : !cute.shape<"((2,2),2,16)">
        %iter_11113 = cute.get_iter(%view_11087) : !memref_rmem_bf16_20
        %iter_11114 = cute.get_iter(%view_11095) : !memref_rmem_bf16_21
        %iter_11115 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %iter_11116 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %lay_11117 = cute.get_layout(%view_11087) : !memref_rmem_bf16_20
        %lay_11118 = cute.get_layout(%view_11095) : !memref_rmem_bf16_21
        %lay_11119 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %lay_11120 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3769 = cute.static : !cute.layout<"1:0">
        %append_11121 = cute.append_to_rank<3> (%lay_11117, %3769) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11122 = cute.append_to_rank<3> (%lay_11118, %3769) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11123 = cute.size(%append_11121) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11124 = cute.size(%append_11121) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11125 = cute.size(%append_11122) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3770 = cute.get_scalars(%sz_11123) : !cute.int_tuple<"1">
        %3771 = cute.get_scalars(%sz_11124) : !cute.int_tuple<"2">
        %3772 = cute.get_scalars(%sz_11125) : !cute.int_tuple<"16">
        %c0_i32_11126 = arith.constant 0 : i32
        %c1_i32_11127 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11126 to %3770 step %c1_i32_11127  : i32 {
          scf.for %arg14 = %c0_i32_11126 to %3771 step %c1_i32_11127  : i32 {
            scf.for %arg15 = %c0_i32_11126 to %3772 step %c1_i32_11127  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_11121) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11568 = cute.add_offset(%iter_11113, %idx_11567) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_22
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_11122) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_11114, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_11119) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_11115, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_11120) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_11116, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_22
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_11128 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_11129 = cute.size(%int_tuple_11128) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_11130 = cute.get_leaves(%sz_11129) : !cute.int_tuple<"4">
        %coord_11131 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11132 = cute.get_layout(%view_862) : !memref_smem_bf16_10
        %3773:2 = cute.get_scalars(%lay_11132) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_11133 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_11134 = cute.assume(%3773#0) : (i32) -> !cute.i32<divby 16>
        %iv_11135 = cute.assume(%3773#1) : (i32) -> !cute.i32<divby 32>
        %stride_11136 = cute.make_stride(%iv_11134, %iv_11135) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_11137 = cute.make_layout(%shape_11133, %stride_11136) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_11138 = cute.crd2idx(%coord_11131, %lay_11132) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
        %iter_11139 = cute.get_iter(%view_862) : !memref_smem_bf16_10
        %ptr_11140 = cute.add_offset(%iter_11139, %idx_11138) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_11141 = cute.make_view(%ptr_11140, %lay_11137) : !memref_smem_bf16_19
        %iter_11142 = cute.get_iter(%view_11141) : !memref_smem_bf16_19
        %iter_11143 = cute.get_iter(%view_11141) : !memref_smem_bf16_19
        %coord_11144 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11145 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
        %idx_11146 = cute.crd2idx(%coord_11144, %lay_11145) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
        %iter_11147 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
        %ptr_11148 = cute.add_offset(%iter_11147, %idx_11146) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11149 = cute.make_view(%ptr_11148) : !memref_rmem_bf16_18
        %iter_11150 = cute.get_iter(%view_11149) : !memref_rmem_bf16_18
        %iter_11151 = cute.get_iter(%view_11149) : !memref_rmem_bf16_18
        %lay_11152 = cute.get_layout(%view_11141) : !memref_smem_bf16_19
        %3774 = cute.get_shape(%lay_11152) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11153, %e1_11154, %e2_11155, %e3_11156, %e4_11157 = cute.get_leaves(%3774) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11158 = cute.get_layout(%view_11149) : !memref_rmem_bf16_18
        %3775 = cute.get_shape(%lay_11158) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11159, %e1_11160, %e2_11161, %e3_11162 = cute.get_leaves(%3775) : !cute.shape<"((8,1),(4,2))">
        %lay_11163 = cute.get_layout(%view_11141) : !memref_smem_bf16_19
        %shape_11164 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11165 = cute.make_layout() : !cute.layout<"1:0">
        %append_11166 = cute.append_to_rank<2> (%lay_11163, %lay_11165) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11167 = cute.make_view(%iter_11143, %append_11166) : !memref_smem_bf16_19
        %iter_11168 = cute.get_iter(%view_11167) : !memref_smem_bf16_19
        %lay_11169 = cute.get_layout(%view_11167) : !memref_smem_bf16_19
        %3776 = cute.get_shape(%lay_11169) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11170, %e1_11171, %e2_11172, %e3_11173, %e4_11174 = cute.get_leaves(%3776) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11175 = cute.get_iter(%view_11167) : !memref_smem_bf16_19
        %lay_11176 = cute.get_layout(%view_11167) : !memref_smem_bf16_19
        %3777:2 = cute.get_scalars(%lay_11176) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11177 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11178 = cute.assume(%3777#0) : (i32) -> !cute.i32<divby 16>
        %iv_11179 = cute.assume(%3777#1) : (i32) -> !cute.i32<divby 32>
        %stride_11180 = cute.make_stride(%iv_11178, %iv_11179) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11181 = cute.make_layout(%shape_11177, %stride_11180) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11182 = cute.make_view(%iter_11175, %lay_11181) : !memref_smem_bf16_20
        %iter_11183 = cute.get_iter(%view_11182) : !memref_smem_bf16_20
        %iter_11184 = cute.get_iter(%view_11182) : !memref_smem_bf16_20
        %lay_11185 = cute.get_layout(%view_11149) : !memref_rmem_bf16_18
        %shape_11186 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11187 = cute.make_layout() : !cute.layout<"1:0">
        %append_11188 = cute.append_to_rank<2> (%lay_11185, %lay_11187) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11189 = cute.make_view(%iter_11151, %append_11188) : !memref_rmem_bf16_18
        %iter_11190 = cute.get_iter(%view_11189) : !memref_rmem_bf16_18
        %lay_11191 = cute.get_layout(%view_11189) : !memref_rmem_bf16_18
        %3778 = cute.get_shape(%lay_11191) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11192, %e1_11193, %e2_11194, %e3_11195 = cute.get_leaves(%3778) : !cute.shape<"((8,1),(4,2))">
        %iter_11196 = cute.get_iter(%view_11189) : !memref_rmem_bf16_18
        %view_11197 = cute.make_view(%iter_11196) : !memref_rmem_bf16_19
        %iter_11198 = cute.get_iter(%view_11197) : !memref_rmem_bf16_19
        %iter_11199 = cute.get_iter(%view_11197) : !memref_rmem_bf16_19
        %lay_11200 = cute.get_layout(%view_11182) : !memref_smem_bf16_20
        %3779 = cute.get_shape(%lay_11200) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11201, %e1_11202, %e2_11203, %e3_11204, %e4_11205 = cute.get_leaves(%3779) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11206 = cute.get_layout(%view_11197) : !memref_rmem_bf16_19
        %3780 = cute.get_shape(%lay_11206) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11207, %e1_11208, %e2_11209, %e3_11210 = cute.get_leaves(%3780) : !cute.shape<"((8,1),((4,2)))">
        %lay_11211 = cute.get_layout(%view_11182) : !memref_smem_bf16_20
        %sz_11212 = cute.size(%lay_11211) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11213 = cute.get_leaves(%sz_11212) : !cute.int_tuple<"8">
        %lay_11214 = cute.get_layout(%view_11197) : !memref_rmem_bf16_19
        %sz_11215 = cute.size(%lay_11214) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11216 = cute.get_leaves(%sz_11215) : !cute.int_tuple<"8">
        %3781 = cute.static : !cute.layout<"1:0">
        %iter_11217 = cute.get_iter(%view_11182) : !memref_smem_bf16_20
        %iter_11218 = cute.get_iter(%view_11197) : !memref_rmem_bf16_19
        %lay_11219 = cute.get_layout(%view_11182) : !memref_smem_bf16_20
        %lay_11220 = cute.get_layout(%view_11197) : !memref_rmem_bf16_19
        %append_11221 = cute.append_to_rank<2> (%lay_11219, %3781) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11222 = cute.append_to_rank<2> (%lay_11220, %3781) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3782:2 = cute.get_scalars(%append_11221) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11223 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11224 = cute.assume(%3782#0) : (i32) -> !cute.i32<divby 16>
        %iv_11225 = cute.assume(%3782#1) : (i32) -> !cute.i32<divby 32>
        %stride_11226 = cute.make_stride(%iv_11224, %iv_11225) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11227 = cute.make_layout(%shape_11223, %stride_11226) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11228 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11229 = cute.size(%lay_11227) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3783 = cute.get_scalars(%sz_11229) : !cute.int_tuple<"8">
        %c0_i32_11230 = arith.constant 0 : i32
        %c1_i32_11231 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11230 to %3783 step %c1_i32_11231  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824:2 = cute.get_scalars(%lay_11227) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_11227) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11566 = cute.add_offset(%iter_11217, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3826 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_11228) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_11218, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3828 = llvm.mlir.constant(0 : i32) : i32
          %3829 = vector.extractelement %3827[%3828 : i32] : vector<4xi32>
          %3830 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
          %3831 = llvm.mlir.constant(1 : i32) : i32
          %3832 = vector.extractelement %3827[%3831 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3833 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3832, %3833 : i32, !llvm.ptr
          %3834 = llvm.mlir.constant(2 : i32) : i32
          %3835 = vector.extractelement %3827[%3834 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3836 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3835, %3836 : i32, !llvm.ptr
          %3837 = llvm.mlir.constant(3 : i32) : i32
          %3838 = vector.extractelement %3827[%3837 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3839 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3838, %3839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11232 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_11233 = cute.get_layout(%view_10866) : !memref_rmem_bf16_17
        %idx_11234 = cute.crd2idx(%coord_11232, %lay_11233) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
        %iter_11235 = cute.get_iter(%view_10866) : !memref_rmem_bf16_17
        %ptr_11236 = cute.add_offset(%iter_11235, %idx_11234) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11237 = cute.make_view(%ptr_11236) : !memref_rmem_bf16_20
        %iter_11238 = cute.get_iter(%view_11237) : !memref_rmem_bf16_20
        %iter_11239 = cute.get_iter(%view_11237) : !memref_rmem_bf16_20
        %coord_11240 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_11241 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
        %idx_11242 = cute.crd2idx(%coord_11240, %lay_11241) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_11243 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
        %ptr_11244 = cute.add_offset(%iter_11243, %idx_11242) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11245 = cute.make_view(%ptr_11244) : !memref_rmem_bf16_21
        %iter_11246 = cute.get_iter(%view_11245) : !memref_rmem_bf16_21
        %iter_11247 = cute.get_iter(%view_11245) : !memref_rmem_bf16_21
        %lay_11248 = cute.get_layout(%view_11237) : !memref_rmem_bf16_20
        %3784 = cute.get_shape(%lay_11248) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11249, %e1_11250, %e2_11251, %e3_11252 = cute.get_leaves(%3784) : !cute.shape<"(((2,2),2),2)">
        %lay_11253 = cute.get_layout(%view_11245) : !memref_rmem_bf16_21
        %3785 = cute.get_shape(%lay_11253) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11254, %e1_11255, %e2_11256, %e3_11257 = cute.get_leaves(%3785) : !cute.shape<"((2,2),(8,2))">
        %iter_11258 = cute.get_iter(%view_11237) : !memref_rmem_bf16_20
        %iter_11259 = cute.get_iter(%view_11245) : !memref_rmem_bf16_21
        %iter_11260 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %iter_11261 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %lay_11262 = cute.get_layout(%view_11237) : !memref_rmem_bf16_20
        %lay_11263 = cute.get_layout(%view_11245) : !memref_rmem_bf16_21
        %lay_11264 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %lay_11265 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3786 = cute.static : !cute.layout<"1:0">
        %append_11266 = cute.append_to_rank<3> (%lay_11262, %3786) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11267 = cute.append_to_rank<3> (%lay_11263, %3786) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11268 = cute.size(%append_11266) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11269 = cute.size(%append_11266) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11270 = cute.size(%append_11267) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3787 = cute.get_scalars(%sz_11268) : !cute.int_tuple<"1">
        %3788 = cute.get_scalars(%sz_11269) : !cute.int_tuple<"2">
        %3789 = cute.get_scalars(%sz_11270) : !cute.int_tuple<"16">
        %c0_i32_11271 = arith.constant 0 : i32
        %c1_i32_11272 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11271 to %3787 step %c1_i32_11272  : i32 {
          scf.for %arg14 = %c0_i32_11271 to %3788 step %c1_i32_11272  : i32 {
            scf.for %arg15 = %c0_i32_11271 to %3789 step %c1_i32_11272  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_11266) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11568 = cute.add_offset(%iter_11258, %idx_11567) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_22
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_11267) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_11259, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_11264) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_11260, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_11265) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_11261, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_22
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_11273 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_11274 = cute.size(%int_tuple_11273) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_11275 = cute.get_leaves(%sz_11274) : !cute.int_tuple<"4">
        %coord_11276 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11277 = cute.get_layout(%view_862) : !memref_smem_bf16_10
        %3790:2 = cute.get_scalars(%lay_11277) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_11278 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_11279 = cute.assume(%3790#0) : (i32) -> !cute.i32<divby 16>
        %iv_11280 = cute.assume(%3790#1) : (i32) -> !cute.i32<divby 32>
        %stride_11281 = cute.make_stride(%iv_11279, %iv_11280) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_11282 = cute.make_layout(%shape_11278, %stride_11281) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_11283 = cute.crd2idx(%coord_11276, %lay_11277) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
        %iter_11284 = cute.get_iter(%view_862) : !memref_smem_bf16_10
        %ptr_11285 = cute.add_offset(%iter_11284, %idx_11283) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_11286 = cute.make_view(%ptr_11285, %lay_11282) : !memref_smem_bf16_19
        %iter_11287 = cute.get_iter(%view_11286) : !memref_smem_bf16_19
        %iter_11288 = cute.get_iter(%view_11286) : !memref_smem_bf16_19
        %coord_11289 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11290 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
        %idx_11291 = cute.crd2idx(%coord_11289, %lay_11290) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
        %iter_11292 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
        %ptr_11293 = cute.add_offset(%iter_11292, %idx_11291) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11294 = cute.make_view(%ptr_11293) : !memref_rmem_bf16_18
        %iter_11295 = cute.get_iter(%view_11294) : !memref_rmem_bf16_18
        %iter_11296 = cute.get_iter(%view_11294) : !memref_rmem_bf16_18
        %lay_11297 = cute.get_layout(%view_11286) : !memref_smem_bf16_19
        %3791 = cute.get_shape(%lay_11297) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11298, %e1_11299, %e2_11300, %e3_11301, %e4_11302 = cute.get_leaves(%3791) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11303 = cute.get_layout(%view_11294) : !memref_rmem_bf16_18
        %3792 = cute.get_shape(%lay_11303) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11304, %e1_11305, %e2_11306, %e3_11307 = cute.get_leaves(%3792) : !cute.shape<"((8,1),(4,2))">
        %lay_11308 = cute.get_layout(%view_11286) : !memref_smem_bf16_19
        %shape_11309 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11310 = cute.make_layout() : !cute.layout<"1:0">
        %append_11311 = cute.append_to_rank<2> (%lay_11308, %lay_11310) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11312 = cute.make_view(%iter_11288, %append_11311) : !memref_smem_bf16_19
        %iter_11313 = cute.get_iter(%view_11312) : !memref_smem_bf16_19
        %lay_11314 = cute.get_layout(%view_11312) : !memref_smem_bf16_19
        %3793 = cute.get_shape(%lay_11314) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11315, %e1_11316, %e2_11317, %e3_11318, %e4_11319 = cute.get_leaves(%3793) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11320 = cute.get_iter(%view_11312) : !memref_smem_bf16_19
        %lay_11321 = cute.get_layout(%view_11312) : !memref_smem_bf16_19
        %3794:2 = cute.get_scalars(%lay_11321) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11322 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11323 = cute.assume(%3794#0) : (i32) -> !cute.i32<divby 16>
        %iv_11324 = cute.assume(%3794#1) : (i32) -> !cute.i32<divby 32>
        %stride_11325 = cute.make_stride(%iv_11323, %iv_11324) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11326 = cute.make_layout(%shape_11322, %stride_11325) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11327 = cute.make_view(%iter_11320, %lay_11326) : !memref_smem_bf16_20
        %iter_11328 = cute.get_iter(%view_11327) : !memref_smem_bf16_20
        %iter_11329 = cute.get_iter(%view_11327) : !memref_smem_bf16_20
        %lay_11330 = cute.get_layout(%view_11294) : !memref_rmem_bf16_18
        %shape_11331 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11332 = cute.make_layout() : !cute.layout<"1:0">
        %append_11333 = cute.append_to_rank<2> (%lay_11330, %lay_11332) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11334 = cute.make_view(%iter_11296, %append_11333) : !memref_rmem_bf16_18
        %iter_11335 = cute.get_iter(%view_11334) : !memref_rmem_bf16_18
        %lay_11336 = cute.get_layout(%view_11334) : !memref_rmem_bf16_18
        %3795 = cute.get_shape(%lay_11336) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11337, %e1_11338, %e2_11339, %e3_11340 = cute.get_leaves(%3795) : !cute.shape<"((8,1),(4,2))">
        %iter_11341 = cute.get_iter(%view_11334) : !memref_rmem_bf16_18
        %view_11342 = cute.make_view(%iter_11341) : !memref_rmem_bf16_19
        %iter_11343 = cute.get_iter(%view_11342) : !memref_rmem_bf16_19
        %iter_11344 = cute.get_iter(%view_11342) : !memref_rmem_bf16_19
        %lay_11345 = cute.get_layout(%view_11327) : !memref_smem_bf16_20
        %3796 = cute.get_shape(%lay_11345) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11346, %e1_11347, %e2_11348, %e3_11349, %e4_11350 = cute.get_leaves(%3796) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11351 = cute.get_layout(%view_11342) : !memref_rmem_bf16_19
        %3797 = cute.get_shape(%lay_11351) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11352, %e1_11353, %e2_11354, %e3_11355 = cute.get_leaves(%3797) : !cute.shape<"((8,1),((4,2)))">
        %lay_11356 = cute.get_layout(%view_11327) : !memref_smem_bf16_20
        %sz_11357 = cute.size(%lay_11356) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11358 = cute.get_leaves(%sz_11357) : !cute.int_tuple<"8">
        %lay_11359 = cute.get_layout(%view_11342) : !memref_rmem_bf16_19
        %sz_11360 = cute.size(%lay_11359) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11361 = cute.get_leaves(%sz_11360) : !cute.int_tuple<"8">
        %3798 = cute.static : !cute.layout<"1:0">
        %iter_11362 = cute.get_iter(%view_11327) : !memref_smem_bf16_20
        %iter_11363 = cute.get_iter(%view_11342) : !memref_rmem_bf16_19
        %lay_11364 = cute.get_layout(%view_11327) : !memref_smem_bf16_20
        %lay_11365 = cute.get_layout(%view_11342) : !memref_rmem_bf16_19
        %append_11366 = cute.append_to_rank<2> (%lay_11364, %3798) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11367 = cute.append_to_rank<2> (%lay_11365, %3798) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3799:2 = cute.get_scalars(%append_11366) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11368 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11369 = cute.assume(%3799#0) : (i32) -> !cute.i32<divby 16>
        %iv_11370 = cute.assume(%3799#1) : (i32) -> !cute.i32<divby 32>
        %stride_11371 = cute.make_stride(%iv_11369, %iv_11370) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11372 = cute.make_layout(%shape_11368, %stride_11371) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11373 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11374 = cute.size(%lay_11372) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3800 = cute.get_scalars(%sz_11374) : !cute.int_tuple<"8">
        %c0_i32_11375 = arith.constant 0 : i32
        %c1_i32_11376 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11375 to %3800 step %c1_i32_11376  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824:2 = cute.get_scalars(%lay_11372) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_11372) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11566 = cute.add_offset(%iter_11362, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3826 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_11373) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_11363, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3828 = llvm.mlir.constant(0 : i32) : i32
          %3829 = vector.extractelement %3827[%3828 : i32] : vector<4xi32>
          %3830 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
          %3831 = llvm.mlir.constant(1 : i32) : i32
          %3832 = vector.extractelement %3827[%3831 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3833 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3832, %3833 : i32, !llvm.ptr
          %3834 = llvm.mlir.constant(2 : i32) : i32
          %3835 = vector.extractelement %3827[%3834 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3836 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3835, %3836 : i32, !llvm.ptr
          %3837 = llvm.mlir.constant(3 : i32) : i32
          %3838 = vector.extractelement %3827[%3837 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3839 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3838, %3839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11377 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11378 = cute.get_layout(%view_10866) : !memref_rmem_bf16_17
        %idx_11379 = cute.crd2idx(%coord_11377, %lay_11378) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
        %iter_11380 = cute.get_iter(%view_10866) : !memref_rmem_bf16_17
        %ptr_11381 = cute.add_offset(%iter_11380, %idx_11379) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11382 = cute.make_view(%ptr_11381) : !memref_rmem_bf16_20
        %iter_11383 = cute.get_iter(%view_11382) : !memref_rmem_bf16_20
        %iter_11384 = cute.get_iter(%view_11382) : !memref_rmem_bf16_20
        %coord_11385 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_11386 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
        %idx_11387 = cute.crd2idx(%coord_11385, %lay_11386) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_11388 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
        %ptr_11389 = cute.add_offset(%iter_11388, %idx_11387) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11390 = cute.make_view(%ptr_11389) : !memref_rmem_bf16_21
        %iter_11391 = cute.get_iter(%view_11390) : !memref_rmem_bf16_21
        %iter_11392 = cute.get_iter(%view_11390) : !memref_rmem_bf16_21
        %lay_11393 = cute.get_layout(%view_11382) : !memref_rmem_bf16_20
        %3801 = cute.get_shape(%lay_11393) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11394, %e1_11395, %e2_11396, %e3_11397 = cute.get_leaves(%3801) : !cute.shape<"(((2,2),2),2)">
        %lay_11398 = cute.get_layout(%view_11390) : !memref_rmem_bf16_21
        %3802 = cute.get_shape(%lay_11398) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11399, %e1_11400, %e2_11401, %e3_11402 = cute.get_leaves(%3802) : !cute.shape<"((2,2),(8,2))">
        %iter_11403 = cute.get_iter(%view_11382) : !memref_rmem_bf16_20
        %iter_11404 = cute.get_iter(%view_11390) : !memref_rmem_bf16_21
        %iter_11405 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %iter_11406 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %lay_11407 = cute.get_layout(%view_11382) : !memref_rmem_bf16_20
        %lay_11408 = cute.get_layout(%view_11390) : !memref_rmem_bf16_21
        %lay_11409 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %lay_11410 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3803 = cute.static : !cute.layout<"1:0">
        %append_11411 = cute.append_to_rank<3> (%lay_11407, %3803) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11412 = cute.append_to_rank<3> (%lay_11408, %3803) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11413 = cute.size(%append_11411) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11414 = cute.size(%append_11411) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11415 = cute.size(%append_11412) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3804 = cute.get_scalars(%sz_11413) : !cute.int_tuple<"1">
        %3805 = cute.get_scalars(%sz_11414) : !cute.int_tuple<"2">
        %3806 = cute.get_scalars(%sz_11415) : !cute.int_tuple<"16">
        %c0_i32_11416 = arith.constant 0 : i32
        %c1_i32_11417 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11416 to %3804 step %c1_i32_11417  : i32 {
          scf.for %arg14 = %c0_i32_11416 to %3805 step %c1_i32_11417  : i32 {
            scf.for %arg15 = %c0_i32_11416 to %3806 step %c1_i32_11417  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_11411) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11568 = cute.add_offset(%iter_11403, %idx_11567) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_22
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_11412) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_11404, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_11409) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_11405, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_11410) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_11406, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_22
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_11418 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_11419 = cute.size(%int_tuple_11418) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_11420 = cute.get_leaves(%sz_11419) : !cute.int_tuple<"4">
        %coord_11421 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11422 = cute.get_layout(%view_862) : !memref_smem_bf16_10
        %3807:2 = cute.get_scalars(%lay_11422) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
        %shape_11423 = cute.make_shape() : () -> !cute.shape<"((8,1),((2,2),2))">
        %iv_11424 = cute.assume(%3807#0) : (i32) -> !cute.i32<divby 16>
        %iv_11425 = cute.assume(%3807#1) : (i32) -> !cute.i32<divby 32>
        %stride_11426 = cute.make_stride(%iv_11424, %iv_11425) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((?{div=16},?{div=32}),4096))">
        %lay_11427 = cute.make_layout(%shape_11423, %stride_11426) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %idx_11428 = cute.crd2idx(%coord_11421, %lay_11422) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_11429 = cute.get_iter(%view_862) : !memref_smem_bf16_10
        %ptr_11430 = cute.add_offset(%iter_11429, %idx_11428) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_11431 = cute.make_view(%ptr_11430, %lay_11427) : !memref_smem_bf16_19
        %iter_11432 = cute.get_iter(%view_11431) : !memref_smem_bf16_19
        %iter_11433 = cute.get_iter(%view_11431) : !memref_smem_bf16_19
        %coord_11434 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_11435 = cute.get_layout(%view_865) : !memref_rmem_bf16_5
        %idx_11436 = cute.crd2idx(%coord_11434, %lay_11435) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_11437 = cute.get_iter(%view_865) : !memref_rmem_bf16_5
        %ptr_11438 = cute.add_offset(%iter_11437, %idx_11436) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11439 = cute.make_view(%ptr_11438) : !memref_rmem_bf16_18
        %iter_11440 = cute.get_iter(%view_11439) : !memref_rmem_bf16_18
        %iter_11441 = cute.get_iter(%view_11439) : !memref_rmem_bf16_18
        %lay_11442 = cute.get_layout(%view_11431) : !memref_smem_bf16_19
        %3808 = cute.get_shape(%lay_11442) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11443, %e1_11444, %e2_11445, %e3_11446, %e4_11447 = cute.get_leaves(%3808) : !cute.shape<"((8,1),((2,2),2))">
        %lay_11448 = cute.get_layout(%view_11439) : !memref_rmem_bf16_18
        %3809 = cute.get_shape(%lay_11448) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11449, %e1_11450, %e2_11451, %e3_11452 = cute.get_leaves(%3809) : !cute.shape<"((8,1),(4,2))">
        %lay_11453 = cute.get_layout(%view_11431) : !memref_smem_bf16_19
        %shape_11454 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11455 = cute.make_layout() : !cute.layout<"1:0">
        %append_11456 = cute.append_to_rank<2> (%lay_11453, %lay_11455) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_11457 = cute.make_view(%iter_11433, %append_11456) : !memref_smem_bf16_19
        %iter_11458 = cute.get_iter(%view_11457) : !memref_smem_bf16_19
        %lay_11459 = cute.get_layout(%view_11457) : !memref_smem_bf16_19
        %3810 = cute.get_shape(%lay_11459) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_11460, %e1_11461, %e2_11462, %e3_11463, %e4_11464 = cute.get_leaves(%3810) : !cute.shape<"((8,1),((2,2),2))">
        %iter_11465 = cute.get_iter(%view_11457) : !memref_smem_bf16_19
        %lay_11466 = cute.get_layout(%view_11457) : !memref_smem_bf16_19
        %3811:2 = cute.get_scalars(%lay_11466) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_11467 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_11468 = cute.assume(%3811#0) : (i32) -> !cute.i32<divby 16>
        %iv_11469 = cute.assume(%3811#1) : (i32) -> !cute.i32<divby 32>
        %stride_11470 = cute.make_stride(%iv_11468, %iv_11469) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_11471 = cute.make_layout(%shape_11467, %stride_11470) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_11472 = cute.make_view(%iter_11465, %lay_11471) : !memref_smem_bf16_20
        %iter_11473 = cute.get_iter(%view_11472) : !memref_smem_bf16_20
        %iter_11474 = cute.get_iter(%view_11472) : !memref_smem_bf16_20
        %lay_11475 = cute.get_layout(%view_11439) : !memref_rmem_bf16_18
        %shape_11476 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_11477 = cute.make_layout() : !cute.layout<"1:0">
        %append_11478 = cute.append_to_rank<2> (%lay_11475, %lay_11477) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_11479 = cute.make_view(%iter_11441, %append_11478) : !memref_rmem_bf16_18
        %iter_11480 = cute.get_iter(%view_11479) : !memref_rmem_bf16_18
        %lay_11481 = cute.get_layout(%view_11479) : !memref_rmem_bf16_18
        %3812 = cute.get_shape(%lay_11481) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_11482, %e1_11483, %e2_11484, %e3_11485 = cute.get_leaves(%3812) : !cute.shape<"((8,1),(4,2))">
        %iter_11486 = cute.get_iter(%view_11479) : !memref_rmem_bf16_18
        %view_11487 = cute.make_view(%iter_11486) : !memref_rmem_bf16_19
        %iter_11488 = cute.get_iter(%view_11487) : !memref_rmem_bf16_19
        %iter_11489 = cute.get_iter(%view_11487) : !memref_rmem_bf16_19
        %lay_11490 = cute.get_layout(%view_11472) : !memref_smem_bf16_20
        %3813 = cute.get_shape(%lay_11490) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_11491, %e1_11492, %e2_11493, %e3_11494, %e4_11495 = cute.get_leaves(%3813) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_11496 = cute.get_layout(%view_11487) : !memref_rmem_bf16_19
        %3814 = cute.get_shape(%lay_11496) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_11497, %e1_11498, %e2_11499, %e3_11500 = cute.get_leaves(%3814) : !cute.shape<"((8,1),((4,2)))">
        %lay_11501 = cute.get_layout(%view_11472) : !memref_smem_bf16_20
        %sz_11502 = cute.size(%lay_11501) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_11503 = cute.get_leaves(%sz_11502) : !cute.int_tuple<"8">
        %lay_11504 = cute.get_layout(%view_11487) : !memref_rmem_bf16_19
        %sz_11505 = cute.size(%lay_11504) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_11506 = cute.get_leaves(%sz_11505) : !cute.int_tuple<"8">
        %3815 = cute.static : !cute.layout<"1:0">
        %iter_11507 = cute.get_iter(%view_11472) : !memref_smem_bf16_20
        %iter_11508 = cute.get_iter(%view_11487) : !memref_rmem_bf16_19
        %lay_11509 = cute.get_layout(%view_11472) : !memref_smem_bf16_20
        %lay_11510 = cute.get_layout(%view_11487) : !memref_rmem_bf16_19
        %append_11511 = cute.append_to_rank<2> (%lay_11509, %3815) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_11512 = cute.append_to_rank<2> (%lay_11510, %3815) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %3816:2 = cute.get_scalars(%append_11511) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_11513 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_11514 = cute.assume(%3816#0) : (i32) -> !cute.i32<divby 16>
        %iv_11515 = cute.assume(%3816#1) : (i32) -> !cute.i32<divby 32>
        %stride_11516 = cute.make_stride(%iv_11514, %iv_11515) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11517 = cute.make_layout(%shape_11513, %stride_11516) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_11518 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_11519 = cute.size(%lay_11517) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %3817 = cute.get_scalars(%sz_11519) : !cute.int_tuple<"8">
        %c0_i32_11520 = arith.constant 0 : i32
        %c1_i32_11521 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11520 to %3817 step %c1_i32_11521  : i32 {
          %coord_11563 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %3824:2 = cute.get_scalars(%lay_11517) <{only_dynamic}> : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
          %3825 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11564 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11565 = cute.crd2idx(%coord_11563, %lay_11517) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_11566 = cute.add_offset(%iter_11507, %idx_11565) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_11567 = cute.make_view(%ptr_11566, %lay_11564) : !memref_smem_bf16_13
          %3826 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_11568 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_11569 = cute.crd2idx(%coord_11563, %lay_11518) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_11570 = cute.add_offset(%iter_11508, %idx_11569) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_11571 = cute.make_view(%ptr_11570, %lay_11568) : !memref_rmem_bf16_11
          %iter_11572 = cute.get_iter(%view_11567) : !memref_smem_bf16_13
          %iter_11573 = cute.get_iter(%view_11571) : !memref_rmem_bf16_11
          %swizzled = cute.apply_swizzle(%iter_11572) : !cute.ptr<bf16, smem, align<16>>
          %3827 = cute_nvgpu.arch.copy.ldsm %swizzled{matrix_shape = <"(8,8)">, sz_pattern = <u16>, num_matrices = 4 : i32, transpose} : <bf16, smem, align<16>> -> vector<4xi32>
          %3828 = llvm.mlir.constant(0 : i32) : i32
          %3829 = vector.extractelement %3827[%3828 : i32] : vector<4xi32>
          %3830 = builtin.unrealized_conversion_cast %iter_11573 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3829, %3830 : i32, !llvm.ptr
          %3831 = llvm.mlir.constant(1 : i32) : i32
          %3832 = vector.extractelement %3827[%3831 : i32] : vector<4xi32>
          %int_tuple_11574 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
          %ptr_11575 = cute.add_offset(%iter_11573, %int_tuple_11574) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
          %3833 = builtin.unrealized_conversion_cast %ptr_11575 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3832, %3833 : i32, !llvm.ptr
          %3834 = llvm.mlir.constant(2 : i32) : i32
          %3835 = vector.extractelement %3827[%3834 : i32] : vector<4xi32>
          %int_tuple_11576 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %ptr_11577 = cute.add_offset(%iter_11573, %int_tuple_11576) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"4">) -> !cute.ptr<bf16, rmem, align<8>>
          %3836 = builtin.unrealized_conversion_cast %ptr_11577 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
          llvm.store %3835, %3836 : i32, !llvm.ptr
          %3837 = llvm.mlir.constant(3 : i32) : i32
          %3838 = vector.extractelement %3827[%3837 : i32] : vector<4xi32>
          %int_tuple_11578 = cute.make_int_tuple() : () -> !cute.int_tuple<"6">
          %ptr_11579 = cute.add_offset(%iter_11573, %int_tuple_11578) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"6">) -> !cute.ptr<bf16, rmem, align<4>>
          %3839 = builtin.unrealized_conversion_cast %ptr_11579 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
          llvm.store %3838, %3839 : i32, !llvm.ptr
        } {llvm.loop_annotation = #loop_annotation}
        %coord_11522 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11523 = cute.get_layout(%view_10866) : !memref_rmem_bf16_17
        %idx_11524 = cute.crd2idx(%coord_11522, %lay_11523) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
        %iter_11525 = cute.get_iter(%view_10866) : !memref_rmem_bf16_17
        %ptr_11526 = cute.add_offset(%iter_11525, %idx_11524) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_11527 = cute.make_view(%ptr_11526) : !memref_rmem_bf16_20
        %iter_11528 = cute.get_iter(%view_11527) : !memref_rmem_bf16_20
        %iter_11529 = cute.get_iter(%view_11527) : !memref_rmem_bf16_20
        %coord_11530 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_11531 = cute.get_layout(%rmem_625) : !memref_rmem_bf16_2
        %idx_11532 = cute.crd2idx(%coord_11530, %lay_11531) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_11533 = cute.get_iter(%rmem_625) : !memref_rmem_bf16_2
        %ptr_11534 = cute.add_offset(%iter_11533, %idx_11532) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_11535 = cute.make_view(%ptr_11534) : !memref_rmem_bf16_21
        %iter_11536 = cute.get_iter(%view_11535) : !memref_rmem_bf16_21
        %iter_11537 = cute.get_iter(%view_11535) : !memref_rmem_bf16_21
        %lay_11538 = cute.get_layout(%view_11527) : !memref_rmem_bf16_20
        %3818 = cute.get_shape(%lay_11538) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_11539, %e1_11540, %e2_11541, %e3_11542 = cute.get_leaves(%3818) : !cute.shape<"(((2,2),2),2)">
        %lay_11543 = cute.get_layout(%view_11535) : !memref_rmem_bf16_21
        %3819 = cute.get_shape(%lay_11543) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_11544, %e1_11545, %e2_11546, %e3_11547 = cute.get_leaves(%3819) : !cute.shape<"((2,2),(8,2))">
        %iter_11548 = cute.get_iter(%view_11527) : !memref_rmem_bf16_20
        %iter_11549 = cute.get_iter(%view_11535) : !memref_rmem_bf16_21
        %iter_11550 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %iter_11551 = cute.get_iter(%rmem_635) : !memref_rmem_f32_
        %lay_11552 = cute.get_layout(%view_11527) : !memref_rmem_bf16_20
        %lay_11553 = cute.get_layout(%view_11535) : !memref_rmem_bf16_21
        %lay_11554 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %lay_11555 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
        %3820 = cute.static : !cute.layout<"1:0">
        %append_11556 = cute.append_to_rank<3> (%lay_11552, %3820) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_11557 = cute.append_to_rank<3> (%lay_11553, %3820) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_11558 = cute.size(%append_11556) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_11559 = cute.size(%append_11556) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_11560 = cute.size(%append_11557) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %3821 = cute.get_scalars(%sz_11558) : !cute.int_tuple<"1">
        %3822 = cute.get_scalars(%sz_11559) : !cute.int_tuple<"2">
        %3823 = cute.get_scalars(%sz_11560) : !cute.int_tuple<"16">
        %c0_i32_11561 = arith.constant 0 : i32
        %c1_i32_11562 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_11561 to %3821 step %c1_i32_11562  : i32 {
          scf.for %arg14 = %c0_i32_11561 to %3822 step %c1_i32_11562  : i32 {
            scf.for %arg15 = %c0_i32_11561 to %3823 step %c1_i32_11562  : i32 {
              %coord_11563 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11564 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_11565 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %3824:2 = cute.get_scalars(%coord_11563) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11566 = cute.make_layout() : !cute.layout<"(((2,2),2)):(((1,2),8))">
              %idx_11567 = cute.crd2idx(%coord_11563, %append_11556) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11568 = cute.add_offset(%iter_11548, %idx_11567) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11569 = cute.make_view(%ptr_11568, %lay_11566) : !memref_rmem_bf16_22
              %3825:2 = cute.get_scalars(%coord_11564) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11570 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11571 = cute.crd2idx(%coord_11564, %append_11557) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11572 = cute.add_offset(%iter_11549, %idx_11571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_11573 = cute.make_view(%ptr_11572, %lay_11570) : !memref_rmem_bf16_15
              %3826:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11574 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11575 = cute.crd2idx(%coord_11565, %lay_11554) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11576 = cute.add_offset(%iter_11550, %idx_11575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11577 = cute.make_view(%ptr_11576, %lay_11574) : !memref_rmem_f32_3
              %3827:2 = cute.get_scalars(%coord_11565) <{only_dynamic}> : !cute.coord<"(_,?,?)">
              %lay_11578 = cute.make_layout() : !cute.layout<"((2,2)):((1,2))">
              %idx_11579 = cute.crd2idx(%coord_11565, %lay_11555) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_11580 = cute.add_offset(%iter_11551, %idx_11579) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_11581 = cute.make_view(%ptr_11580, %lay_11578) : !memref_rmem_f32_3
              %iter_11582 = cute.get_iter(%view_11569) : !memref_rmem_bf16_22
              %iter_11583 = cute.get_iter(%view_11573) : !memref_rmem_bf16_15
              %iter_11584 = cute.get_iter(%view_11577) : !memref_rmem_f32_3
              %iter_11585 = cute.get_iter(%view_11581) : !memref_rmem_f32_3
              %3828 = builtin.unrealized_conversion_cast %iter_11582 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3829 = llvm.load %3828 : !llvm.ptr -> i32
              %3830 = llvm.getelementptr %3828[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3831 = llvm.load %3830 : !llvm.ptr -> i32
              %3832 = llvm.getelementptr %3828[4] : (!llvm.ptr) -> !llvm.ptr, i32
              %3833 = llvm.load %3832 : !llvm.ptr -> i32
              %3834 = llvm.getelementptr %3828[5] : (!llvm.ptr) -> !llvm.ptr, i32
              %3835 = llvm.load %3834 : !llvm.ptr -> i32
              %3836 = builtin.unrealized_conversion_cast %iter_11583 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
              %3837 = llvm.load %3836 : !llvm.ptr -> i32
              %3838 = llvm.getelementptr %3836[1] : (!llvm.ptr) -> !llvm.ptr, i32
              %3839 = llvm.load %3838 : !llvm.ptr -> i32
              %3840 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              %3841 = llvm.load %3840 : !llvm.ptr -> f32
              %3842 = llvm.getelementptr %3840[1] : (!llvm.ptr) -> !llvm.ptr, f32
              %3843 = llvm.load %3842 : !llvm.ptr -> f32
              %3844 = llvm.getelementptr %3840[2] : (!llvm.ptr) -> !llvm.ptr, f32
              %3845 = llvm.load %3844 : !llvm.ptr -> f32
              %3846 = llvm.getelementptr %3840[3] : (!llvm.ptr) -> !llvm.ptr, f32
              %3847 = llvm.load %3846 : !llvm.ptr -> f32
              %3848:4 = cute_nvgpu.arch.mma.SM80 A[%3829, %3831, %3833, %3835]  B[%3837, %3839]  C[%3841, %3843, %3845, %3847] < {a_type = bf16, b_type = bf16, shape_MNK = #cute.shape<"(16,8,16)">}> : (i32, i32, f32) -> (f32, f32, f32, f32)
              %3849 = builtin.unrealized_conversion_cast %iter_11584 : !cute.ptr<f32, rmem, align<16>> to !llvm.ptr
              llvm.store %3848#0, %3849 : f32, !llvm.ptr
              %3850 = llvm.getelementptr %3849[1] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#1, %3850 : f32, !llvm.ptr
              %3851 = llvm.getelementptr %3849[2] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#2, %3851 : f32, !llvm.ptr
              %3852 = llvm.getelementptr %3849[3] : (!llvm.ptr) -> !llvm.ptr, f32
              llvm.store %3848#3, %3852 : f32, !llvm.ptr
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        scf.yield %3397, %arg7, %3397, %arg9, %arg10, %arg11, %arg12 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32
      }
      %iter_7566 = cute.get_iter(%2855#3) : !memref_gmem_bf16_
      %lay_7567 = cute.get_layout(%2855#3) : !memref_gmem_bf16_
      %2856 = cute.get_shape(%lay_7567) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7568, %e1_7569, %e2_7570, %e3_7571 = cute.get_leaves(%2856) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7572 = cute.to_int_tuple(%e0_7568) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2857 = cute.get_scalars(%itup_7572) : !cute.int_tuple<"?">
      %itup_7573 = cute.to_int_tuple(%e1_7569) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2858 = cute.get_scalars(%itup_7573) : !cute.int_tuple<"?">
      %itup_7574 = cute.to_int_tuple(%e2_7570) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2859 = cute.get_scalars(%itup_7574) : !cute.int_tuple<"?">
      %itup_7575 = cute.to_int_tuple(%e3_7571) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2860 = cute.get_scalars(%itup_7575) : !cute.int_tuple<"?{div=8}">
      %2861 = cute.get_stride(%lay_7567) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_7576, %e1_7577, %e2_7578, %e3_7579 = cute.get_leaves(%2861) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_7580 = cute.to_int_tuple(%e0_7576) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2862 = cute.get_scalars(%itup_7580) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7581 = cute.to_int_tuple(%e1_7577) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2863 = cute.get_scalars(%itup_7581) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7582 = cute.to_int_tuple(%e2_7578) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2864 = cute.get_scalars(%itup_7582) : !cute.int_tuple<"?{i64 div=8}">
      %iter_7583 = cute.get_iter(%2855#4) : !memref_gmem_bf16_
      %lay_7584 = cute.get_layout(%2855#4) : !memref_gmem_bf16_
      %2865 = cute.get_shape(%lay_7584) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7585, %e1_7586, %e2_7587, %e3_7588 = cute.get_leaves(%2865) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7589 = cute.to_int_tuple(%e0_7585) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2866 = cute.get_scalars(%itup_7589) : !cute.int_tuple<"?">
      %itup_7590 = cute.to_int_tuple(%e1_7586) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2867 = cute.get_scalars(%itup_7590) : !cute.int_tuple<"?">
      %itup_7591 = cute.to_int_tuple(%e2_7587) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2868 = cute.get_scalars(%itup_7591) : !cute.int_tuple<"?">
      %itup_7592 = cute.to_int_tuple(%e3_7588) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2869 = cute.get_scalars(%itup_7592) : !cute.int_tuple<"?{div=8}">
      %2870 = cute.get_stride(%lay_7584) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_7593, %e1_7594, %e2_7595, %e3_7596 = cute.get_leaves(%2870) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_7597 = cute.to_int_tuple(%e0_7593) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2871 = cute.get_scalars(%itup_7597) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7598 = cute.to_int_tuple(%e1_7594) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2872 = cute.get_scalars(%itup_7598) : !cute.int_tuple<"?{i64 div=8}">
      %itup_7599 = cute.to_int_tuple(%e2_7595) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2873 = cute.get_scalars(%itup_7599) : !cute.int_tuple<"?{i64 div=8}">
      %iter_7600 = cute.get_iter(%2855#3) : !memref_gmem_bf16_
      %iter_7601 = cute.get_iter(%2855#3) : !memref_gmem_bf16_
      %iter_7602 = cute.get_iter(%2855#4) : !memref_gmem_bf16_
      %iter_7603 = cute.get_iter(%2855#4) : !memref_gmem_bf16_
      %lay_7604 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2874 = cute.get_shape(%lay_7604) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7605, %e1_7606, %e2_7607, %e3_7608 = cute.get_leaves(%2874) : !cute.shape<"((2,2),2,16)">
      %shape_7609 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_7610 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %2875 = cute.get_shape(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7611, %e1_7612, %e2_7613, %e3_7614 = cute.get_leaves(%2875) : !cute.shape<"((2,2),2,16)">
      %2876 = cute.get_shape(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7615, %e1_7616, %e2_7617, %e3_7618 = cute.get_leaves(%2876) : !cute.shape<"((2,2),2,16)">
      %2877 = cute.get_shape(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7619, %e1_7620, %e2_7621, %e3_7622 = cute.get_leaves(%2877) : !cute.shape<"((2,2),2,16)">
      %2878 = cute.get_shape(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7623, %e1_7624, %e2_7625, %e3_7626 = cute.get_leaves(%2878) : !cute.shape<"((2,2),2,16)">
      %2879 = cute.get_stride(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7627, %e1_7628, %e2_7629, %e3_7630 = cute.get_leaves(%2879) : !cute.stride<"((1,2),4,8)">
      %2880 = cute.get_stride(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7631, %e1_7632, %e2_7633, %e3_7634 = cute.get_leaves(%2880) : !cute.stride<"((1,2),4,8)">
      %2881 = cute.get_stride(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7635, %e1_7636, %e2_7637, %e3_7638 = cute.get_leaves(%2881) : !cute.stride<"((1,2),4,8)">
      %2882 = cute.get_stride(%lay_7610) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7639, %e1_7640, %e2_7641, %e3_7642 = cute.get_leaves(%2882) : !cute.stride<"((1,2),4,8)">
      %shape_7643 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_7644 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_7645 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_7646 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7647 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_7648 = cute.make_view(%iter_637, %lay_7647) : !memref_rmem_f32_5
      %iter_7649 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %lay_7650 = cute.get_layout(%rmem_1600) : !memref_rmem_f32_1
      %sz_7651 = cute.size(%lay_7650) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_7652 = cute.get_leaves(%sz_7651) : !cute.int_tuple<"4">
      %coord_7653 = cute.make_coord() : () -> !cute.coord<"0">
      %2883 = cute.memref.load(%rmem_1600, %coord_7653) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %c-1_i32_7654 = arith.constant -1 : i32
      %c2_i32_7655 = arith.constant 2 : i32
      %c31_i32_7656 = arith.constant 31 : i32
      %2884 = nvvm.shfl.sync  bfly %c-1_i32_7654, %2883, %c2_i32_7655, %c31_i32_7656 : f32 -> f32
      %2885 = arith.addf %2883, %2884 : f32
      %c-1_i32_7657 = arith.constant -1 : i32
      %c1_i32_7658 = arith.constant 1 : i32
      %c31_i32_7659 = arith.constant 31 : i32
      %2886 = nvvm.shfl.sync  bfly %c-1_i32_7657, %2885, %c1_i32_7658, %c31_i32_7659 : f32 -> f32
      %2887 = arith.addf %2885, %2886 : f32
      %coord_7660 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1600, %coord_7660, %2887) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_7661 = cute.make_coord() : () -> !cute.coord<"0">
      %2888 = cute.memref.load(%rmem_1600, %coord_7661) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %cst_7662 = arith.constant 0.000000e+00 : f32
      %2889 = arith.cmpf oeq, %2888, %cst_7662 : f32
      %coord_7663 = cute.make_coord() : () -> !cute.coord<"0">
      %2890 = cute.memref.load(%rmem_1600, %coord_7663) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2891 = arith.cmpf oeq, %2890, %cst_7662 : f32
      %coord_7664 = cute.make_coord() : () -> !cute.coord<"0">
      %2892 = cute.memref.load(%rmem_1600, %coord_7664) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %coord_7665 = cute.make_coord() : () -> !cute.coord<"0">
      %2893 = cute.memref.load(%rmem_1600, %coord_7665) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2894 = arith.cmpf une, %2892, %2893 : f32
      %2895 = arith.extui %2891 : i1 to i32
      %c0_i32_7666 = arith.constant 0 : i32
      %2896 = arith.cmpi ne, %2895, %c0_i32_7666 : i32
      %2897 = arith.extui %2891 : i1 to i32
      %2898 = arith.extui %2894 : i1 to i32
      %2899 = arith.select %2896, %2897, %2898 : i32
      %c0_i32_7667 = arith.constant 0 : i32
      %2900 = arith.cmpi ne, %2899, %c0_i32_7667 : i32
      %coord_7668 = cute.make_coord() : () -> !cute.coord<"0">
      %2901 = cute.memref.load(%rmem_1600, %coord_7668) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2902 = nvvm.rcp.approx.ftz.f %2901 : f32
      %cst_7669 = arith.constant 1.000000e+00 : f32
      %2903 = arith.select %2900, %cst_7669, %2902 : f32
      %coord_7670 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7671 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7672 = cute.crd2idx(%coord_7670, %lay_7671) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7673 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7674 = cute.add_offset(%iter_7673, %idx_7672) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7675 = cute.make_view(%ptr_7674) : !memref_rmem_f32_10
      %iter_7676 = cute.get_iter(%view_7675) : !memref_rmem_f32_10
      %iter_7677 = cute.get_iter(%view_7675) : !memref_rmem_f32_10
      %lay_7678 = cute.get_layout(%view_7675) : !memref_rmem_f32_10
      %2904 = cute.get_shape(%lay_7678) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7679, %e1_7680 = cute.get_leaves(%2904) : !cute.shape<"((2,16))">
      %2905 = cute.memref.load_vec %view_7675 : !memref_rmem_f32_10
      %2906 = vector.broadcast %2903 : f32 to vector<32xf32>
      %2907 = arith.mulf %2905, %2906 : vector<32xf32>
      %coord_7681 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7682 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7683 = cute.crd2idx(%coord_7681, %lay_7682) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7684 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7685 = cute.add_offset(%iter_7684, %idx_7683) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7686 = cute.make_view(%ptr_7685) : !memref_rmem_f32_10
      %iter_7687 = cute.get_iter(%view_7686) : !memref_rmem_f32_10
      %iter_7688 = cute.get_iter(%view_7686) : !memref_rmem_f32_10
      %lay_7689 = cute.get_layout(%view_7686) : !memref_rmem_f32_10
      %2908 = cute.get_shape(%lay_7689) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7690, %e1_7691 = cute.get_leaves(%2908) : !cute.shape<"((2,16))">
      %int_tuple_7692 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7693 = cute.size(%int_tuple_7692) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7694 = cute.get_leaves(%sz_7693) : !cute.int_tuple<"32">
      %int_tuple_7695 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7696 = cute.size(%int_tuple_7695) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7697 = cute.get_leaves(%sz_7696) : !cute.int_tuple<"32">
      cute.memref.store_vec %2907, %view_7686 : !memref_rmem_f32_10
      %coord_7698 = cute.make_coord() : () -> !cute.coord<"1">
      %2909 = cute.memref.load(%rmem_1600, %coord_7698) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %c-1_i32_7699 = arith.constant -1 : i32
      %c2_i32_7700 = arith.constant 2 : i32
      %c31_i32_7701 = arith.constant 31 : i32
      %2910 = nvvm.shfl.sync  bfly %c-1_i32_7699, %2909, %c2_i32_7700, %c31_i32_7701 : f32 -> f32
      %2911 = arith.addf %2909, %2910 : f32
      %c-1_i32_7702 = arith.constant -1 : i32
      %c1_i32_7703 = arith.constant 1 : i32
      %c31_i32_7704 = arith.constant 31 : i32
      %2912 = nvvm.shfl.sync  bfly %c-1_i32_7702, %2911, %c1_i32_7703, %c31_i32_7704 : f32 -> f32
      %2913 = arith.addf %2911, %2912 : f32
      %coord_7705 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1600, %coord_7705, %2913) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_7706 = cute.make_coord() : () -> !cute.coord<"1">
      %2914 = cute.memref.load(%rmem_1600, %coord_7706) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2915 = arith.cmpf oeq, %2914, %cst_7662 : f32
      %coord_7707 = cute.make_coord() : () -> !cute.coord<"1">
      %2916 = cute.memref.load(%rmem_1600, %coord_7707) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2917 = arith.cmpf oeq, %2916, %cst_7662 : f32
      %coord_7708 = cute.make_coord() : () -> !cute.coord<"1">
      %2918 = cute.memref.load(%rmem_1600, %coord_7708) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %coord_7709 = cute.make_coord() : () -> !cute.coord<"1">
      %2919 = cute.memref.load(%rmem_1600, %coord_7709) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2920 = arith.cmpf une, %2918, %2919 : f32
      %2921 = arith.extui %2917 : i1 to i32
      %2922 = arith.cmpi ne, %2921, %c0_i32_7666 : i32
      %2923 = arith.extui %2917 : i1 to i32
      %2924 = arith.extui %2920 : i1 to i32
      %2925 = arith.select %2922, %2923, %2924 : i32
      %2926 = arith.cmpi ne, %2925, %c0_i32_7667 : i32
      %coord_7710 = cute.make_coord() : () -> !cute.coord<"1">
      %2927 = cute.memref.load(%rmem_1600, %coord_7710) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2928 = nvvm.rcp.approx.ftz.f %2927 : f32
      %2929 = arith.select %2926, %cst_7669, %2928 : f32
      %coord_7711 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7712 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7713 = cute.crd2idx(%coord_7711, %lay_7712) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7714 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7715 = cute.add_offset(%iter_7714, %idx_7713) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7716 = cute.make_view(%ptr_7715) : !memref_rmem_f32_11
      %iter_7717 = cute.get_iter(%view_7716) : !memref_rmem_f32_11
      %iter_7718 = cute.get_iter(%view_7716) : !memref_rmem_f32_11
      %lay_7719 = cute.get_layout(%view_7716) : !memref_rmem_f32_11
      %2930 = cute.get_shape(%lay_7719) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7720, %e1_7721 = cute.get_leaves(%2930) : !cute.shape<"((2,16))">
      %2931 = cute.memref.load_vec %view_7716 : !memref_rmem_f32_11
      %2932 = vector.broadcast %2929 : f32 to vector<32xf32>
      %2933 = arith.mulf %2931, %2932 : vector<32xf32>
      %coord_7722 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7723 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7724 = cute.crd2idx(%coord_7722, %lay_7723) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7725 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7726 = cute.add_offset(%iter_7725, %idx_7724) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7727 = cute.make_view(%ptr_7726) : !memref_rmem_f32_11
      %iter_7728 = cute.get_iter(%view_7727) : !memref_rmem_f32_11
      %iter_7729 = cute.get_iter(%view_7727) : !memref_rmem_f32_11
      %lay_7730 = cute.get_layout(%view_7727) : !memref_rmem_f32_11
      %2934 = cute.get_shape(%lay_7730) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7731, %e1_7732 = cute.get_leaves(%2934) : !cute.shape<"((2,16))">
      %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7734 = cute.size(%int_tuple_7733) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7735 = cute.get_leaves(%sz_7734) : !cute.int_tuple<"32">
      %int_tuple_7736 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7737 = cute.size(%int_tuple_7736) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7738 = cute.get_leaves(%sz_7737) : !cute.int_tuple<"32">
      cute.memref.store_vec %2933, %view_7727 : !memref_rmem_f32_11
      %coord_7739 = cute.make_coord() : () -> !cute.coord<"2">
      %2935 = cute.memref.load(%rmem_1600, %coord_7739) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %c-1_i32_7740 = arith.constant -1 : i32
      %c2_i32_7741 = arith.constant 2 : i32
      %c31_i32_7742 = arith.constant 31 : i32
      %2936 = nvvm.shfl.sync  bfly %c-1_i32_7740, %2935, %c2_i32_7741, %c31_i32_7742 : f32 -> f32
      %2937 = arith.addf %2935, %2936 : f32
      %c-1_i32_7743 = arith.constant -1 : i32
      %c1_i32_7744 = arith.constant 1 : i32
      %c31_i32_7745 = arith.constant 31 : i32
      %2938 = nvvm.shfl.sync  bfly %c-1_i32_7743, %2937, %c1_i32_7744, %c31_i32_7745 : f32 -> f32
      %2939 = arith.addf %2937, %2938 : f32
      %coord_7746 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1600, %coord_7746, %2939) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_7747 = cute.make_coord() : () -> !cute.coord<"2">
      %2940 = cute.memref.load(%rmem_1600, %coord_7747) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2941 = arith.cmpf oeq, %2940, %cst_7662 : f32
      %coord_7748 = cute.make_coord() : () -> !cute.coord<"2">
      %2942 = cute.memref.load(%rmem_1600, %coord_7748) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2943 = arith.cmpf oeq, %2942, %cst_7662 : f32
      %coord_7749 = cute.make_coord() : () -> !cute.coord<"2">
      %2944 = cute.memref.load(%rmem_1600, %coord_7749) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %coord_7750 = cute.make_coord() : () -> !cute.coord<"2">
      %2945 = cute.memref.load(%rmem_1600, %coord_7750) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2946 = arith.cmpf une, %2944, %2945 : f32
      %2947 = arith.extui %2943 : i1 to i32
      %2948 = arith.cmpi ne, %2947, %c0_i32_7666 : i32
      %2949 = arith.extui %2943 : i1 to i32
      %2950 = arith.extui %2946 : i1 to i32
      %2951 = arith.select %2948, %2949, %2950 : i32
      %2952 = arith.cmpi ne, %2951, %c0_i32_7667 : i32
      %coord_7751 = cute.make_coord() : () -> !cute.coord<"2">
      %2953 = cute.memref.load(%rmem_1600, %coord_7751) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2954 = nvvm.rcp.approx.ftz.f %2953 : f32
      %2955 = arith.select %2952, %cst_7669, %2954 : f32
      %coord_7752 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7753 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7754 = cute.crd2idx(%coord_7752, %lay_7753) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7755 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7756 = cute.add_offset(%iter_7755, %idx_7754) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7757 = cute.make_view(%ptr_7756) : !memref_rmem_f32_12
      %iter_7758 = cute.get_iter(%view_7757) : !memref_rmem_f32_12
      %iter_7759 = cute.get_iter(%view_7757) : !memref_rmem_f32_12
      %lay_7760 = cute.get_layout(%view_7757) : !memref_rmem_f32_12
      %2956 = cute.get_shape(%lay_7760) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7761, %e1_7762 = cute.get_leaves(%2956) : !cute.shape<"((2,16))">
      %2957 = cute.memref.load_vec %view_7757 : !memref_rmem_f32_12
      %2958 = vector.broadcast %2955 : f32 to vector<32xf32>
      %2959 = arith.mulf %2957, %2958 : vector<32xf32>
      %coord_7763 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7764 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7765 = cute.crd2idx(%coord_7763, %lay_7764) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7766 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7767 = cute.add_offset(%iter_7766, %idx_7765) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7768 = cute.make_view(%ptr_7767) : !memref_rmem_f32_12
      %iter_7769 = cute.get_iter(%view_7768) : !memref_rmem_f32_12
      %iter_7770 = cute.get_iter(%view_7768) : !memref_rmem_f32_12
      %lay_7771 = cute.get_layout(%view_7768) : !memref_rmem_f32_12
      %2960 = cute.get_shape(%lay_7771) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7772, %e1_7773 = cute.get_leaves(%2960) : !cute.shape<"((2,16))">
      %int_tuple_7774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7775 = cute.size(%int_tuple_7774) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7776 = cute.get_leaves(%sz_7775) : !cute.int_tuple<"32">
      %int_tuple_7777 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7778 = cute.size(%int_tuple_7777) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7779 = cute.get_leaves(%sz_7778) : !cute.int_tuple<"32">
      cute.memref.store_vec %2959, %view_7768 : !memref_rmem_f32_12
      %coord_7780 = cute.make_coord() : () -> !cute.coord<"3">
      %2961 = cute.memref.load(%rmem_1600, %coord_7780) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %c-1_i32_7781 = arith.constant -1 : i32
      %c2_i32_7782 = arith.constant 2 : i32
      %c31_i32_7783 = arith.constant 31 : i32
      %2962 = nvvm.shfl.sync  bfly %c-1_i32_7781, %2961, %c2_i32_7782, %c31_i32_7783 : f32 -> f32
      %2963 = arith.addf %2961, %2962 : f32
      %c-1_i32_7784 = arith.constant -1 : i32
      %c1_i32_7785 = arith.constant 1 : i32
      %c31_i32_7786 = arith.constant 31 : i32
      %2964 = nvvm.shfl.sync  bfly %c-1_i32_7784, %2963, %c1_i32_7785, %c31_i32_7786 : f32 -> f32
      %2965 = arith.addf %2963, %2964 : f32
      %coord_7787 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1600, %coord_7787, %2965) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_7788 = cute.make_coord() : () -> !cute.coord<"3">
      %2966 = cute.memref.load(%rmem_1600, %coord_7788) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2967 = arith.cmpf oeq, %2966, %cst_7662 : f32
      %coord_7789 = cute.make_coord() : () -> !cute.coord<"3">
      %2968 = cute.memref.load(%rmem_1600, %coord_7789) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2969 = arith.cmpf oeq, %2968, %cst_7662 : f32
      %coord_7790 = cute.make_coord() : () -> !cute.coord<"3">
      %2970 = cute.memref.load(%rmem_1600, %coord_7790) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %coord_7791 = cute.make_coord() : () -> !cute.coord<"3">
      %2971 = cute.memref.load(%rmem_1600, %coord_7791) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2972 = arith.cmpf une, %2970, %2971 : f32
      %2973 = arith.extui %2969 : i1 to i32
      %2974 = arith.cmpi ne, %2973, %c0_i32_7666 : i32
      %2975 = arith.extui %2969 : i1 to i32
      %2976 = arith.extui %2972 : i1 to i32
      %2977 = arith.select %2974, %2975, %2976 : i32
      %2978 = arith.cmpi ne, %2977, %c0_i32_7667 : i32
      %coord_7792 = cute.make_coord() : () -> !cute.coord<"3">
      %2979 = cute.memref.load(%rmem_1600, %coord_7792) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2980 = nvvm.rcp.approx.ftz.f %2979 : f32
      %2981 = arith.select %2978, %cst_7669, %2980 : f32
      %coord_7793 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7794 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7795 = cute.crd2idx(%coord_7793, %lay_7794) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7796 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7797 = cute.add_offset(%iter_7796, %idx_7795) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7798 = cute.make_view(%ptr_7797) : !memref_rmem_f32_11
      %iter_7799 = cute.get_iter(%view_7798) : !memref_rmem_f32_11
      %iter_7800 = cute.get_iter(%view_7798) : !memref_rmem_f32_11
      %lay_7801 = cute.get_layout(%view_7798) : !memref_rmem_f32_11
      %2982 = cute.get_shape(%lay_7801) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7802, %e1_7803 = cute.get_leaves(%2982) : !cute.shape<"((2,16))">
      %2983 = cute.memref.load_vec %view_7798 : !memref_rmem_f32_11
      %2984 = vector.broadcast %2981 : f32 to vector<32xf32>
      %2985 = arith.mulf %2983, %2984 : vector<32xf32>
      %coord_7804 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7805 = cute.get_layout(%view_7648) : !memref_rmem_f32_5
      %idx_7806 = cute.crd2idx(%coord_7804, %lay_7805) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7807 = cute.get_iter(%view_7648) : !memref_rmem_f32_5
      %ptr_7808 = cute.add_offset(%iter_7807, %idx_7806) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7809 = cute.make_view(%ptr_7808) : !memref_rmem_f32_11
      %iter_7810 = cute.get_iter(%view_7809) : !memref_rmem_f32_11
      %iter_7811 = cute.get_iter(%view_7809) : !memref_rmem_f32_11
      %lay_7812 = cute.get_layout(%view_7809) : !memref_rmem_f32_11
      %2986 = cute.get_shape(%lay_7812) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7813, %e1_7814 = cute.get_leaves(%2986) : !cute.shape<"((2,16))">
      %int_tuple_7815 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7816 = cute.size(%int_tuple_7815) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7817 = cute.get_leaves(%sz_7816) : !cute.int_tuple<"32">
      %int_tuple_7818 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7819 = cute.size(%int_tuple_7818) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7820 = cute.get_leaves(%sz_7819) : !cute.int_tuple<"32">
      cute.memref.store_vec %2985, %view_7809 : !memref_rmem_f32_11
      %lay_7821 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %lay_7822 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_7823 = cute.memref.alloca(%lay_7822) : !memref_rmem_bf16_23
      %iter_7824 = cute.get_iter(%rmem_7823) : !memref_rmem_bf16_23
      %iter_7825 = cute.get_iter(%rmem_7823) : !memref_rmem_bf16_23
      %lay_7826 = cute.get_layout(%rmem_635) : !memref_rmem_f32_
      %2987 = cute.get_shape(%lay_7826) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7827, %e1_7828, %e2_7829, %e3_7830 = cute.get_leaves(%2987) : !cute.shape<"((2,2),2,16)">
      %2988 = cute.memref.load_vec %rmem_635 : !memref_rmem_f32_
      %2989 = arith.truncf %2988 : vector<128xf32> to vector<128xbf16>
      %lay_7831 = cute.get_layout(%rmem_7823) : !memref_rmem_bf16_23
      %2990 = cute.get_shape(%lay_7831) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7832, %e1_7833, %e2_7834, %e3_7835 = cute.get_leaves(%2990) : !cute.shape<"((2,2),2,16)">
      %int_tuple_7836 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7837 = cute.size(%int_tuple_7836) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7838 = cute.get_leaves(%sz_7837) : !cute.int_tuple<"128">
      %int_tuple_7839 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7840 = cute.size(%int_tuple_7839) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7841 = cute.get_leaves(%sz_7840) : !cute.int_tuple<"128">
      cute.memref.store_vec %2989, %rmem_7823 : !memref_rmem_bf16_23
      %view_7842 = cute.make_view(%iter_298, %2) : !memref_smem_bf16_
      %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_
      %atom_7844 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %2991 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %2992 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7845, %e1_7846, %e2_7847 = cute.get_leaves(%2992) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7848 = cute.size(%e0_7845) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_7849 = cute.get_leaves(%sz_7848) : !cute.int_tuple<"64">
      %2993 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7850, %e1_7851, %e2_7852 = cute.get_leaves(%2993) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7853 = cute.size(%e1_7851) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_7854 = cute.get_leaves(%sz_7853) : !cute.int_tuple<"16">
      %tile_7855 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %2994 = cute.make_tiled_copy(%atom_7844) : !copy_simt1
      %iter_7856 = cute.get_iter(%rmem_7823) : !memref_rmem_bf16_23
      %view_7857 = cute.make_view(%iter_7856) : !memref_rmem_bf16_24
      %iter_7858 = cute.get_iter(%view_7857) : !memref_rmem_bf16_24
      %coord_7859 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_7860 = cute.get_iter(%view_7842) : !memref_smem_bf16_
      %2995 = cute.get_scalars(%coord_7859) <{only_dynamic}> : !cute.coord<"?">
      %c4_i32_7861 = arith.constant 4 : i32
      %2996 = arith.divsi %2995, %c4_i32_7861 : i32
      %c4_i32_7862 = arith.constant 4 : i32
      %2997 = arith.remsi %2995, %c4_i32_7862 : i32
      %c8_i32_7863 = arith.constant 8 : i32
      %2998 = arith.divsi %2996, %c8_i32_7863 : i32
      %c8_i32_7864 = arith.constant 8 : i32
      %2999 = arith.remsi %2996, %c8_i32_7864 : i32
      %c64_i32_7865 = arith.constant 64 : i32
      %3000 = arith.muli %2999, %c64_i32_7865 : i32
      %c0_i32_7866 = arith.constant 0 : i32
      %3001 = arith.xori %3000, %c0_i32_7866 : i32
      %c4_i32_7867 = arith.constant 4 : i32
      %3002 = arith.divsi %2995, %c4_i32_7867 : i32
      %c4_i32_7868 = arith.constant 4 : i32
      %3003 = arith.remsi %2995, %c4_i32_7868 : i32
      %c2_i32_7869 = arith.constant 2 : i32
      %3004 = arith.muli %3003, %c2_i32_7869 : i32
      %c8_i32_7870 = arith.constant 8 : i32
      %3005 = arith.divsi %3002, %c8_i32_7870 : i32
      %c8_i32_7871 = arith.constant 8 : i32
      %3006 = arith.remsi %3002, %c8_i32_7871 : i32
      %c1024_i32_7872 = arith.constant 1024 : i32
      %3007 = arith.muli %3005, %c1024_i32_7872 : i32
      %3008 = arith.addi %3004, %3007 : i32
      %c64_i32_7873 = arith.constant 64 : i32
      %3009 = arith.andi %3001, %c64_i32_7873 : i32
      %c0_i32_7874 = arith.constant 0 : i32
      %3010 = arith.cmpi eq, %3009, %c0_i32_7874 : i32
      %3011 = scf.if %3010 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_7875 = arith.constant 128 : i32
      %3012 = arith.andi %3001, %c128_i32_7875 : i32
      %c0_i32_7876 = arith.constant 0 : i32
      %3013 = arith.cmpi eq, %3012, %c0_i32_7876 : i32
      %3014 = scf.if %3013 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_7877 = arith.constant 256 : i32
      %3015 = arith.andi %3001, %c256_i32_7877 : i32
      %c0_i32_7878 = arith.constant 0 : i32
      %3016 = arith.cmpi eq, %3015, %c0_i32_7878 : i32
      %3017 = scf.if %3016 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_7879 = arith.constant 8 : i32
      %3018 = arith.andi %3001, %c8_i32_7879 : i32
      %c0_i32_7880 = arith.constant 0 : i32
      %3019 = arith.cmpi eq, %3018, %c0_i32_7880 : i32
      %3020 = scf.if %3019 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_7881 = arith.constant 16 : i32
      %3021 = arith.andi %3001, %c16_i32_7881 : i32
      %c0_i32_7882 = arith.constant 0 : i32
      %3022 = arith.cmpi eq, %3021, %c0_i32_7882 : i32
      %3023 = scf.if %3022 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_7883 = arith.constant 32 : i32
      %3024 = arith.andi %3001, %c32_i32_7883 : i32
      %c0_i32_7884 = arith.constant 0 : i32
      %3025 = arith.cmpi eq, %3024, %c0_i32_7884 : i32
      %3026 = scf.if %3025 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_7885 = arith.constant 448 : i32
      %3027 = arith.andi %3001, %c448_i32_7885 : i32
      %c3_i32_7886 = arith.constant 3 : i32
      %3028 = arith.shrsi %3027, %c3_i32_7886 : i32
      %3029 = arith.xori %3001, %3028 : i32
      %3030 = arith.addi %3029, %3008 : i32
      %c64_i32_7887 = arith.constant 64 : i32
      %3031 = arith.muli %3011, %c64_i32_7887 : i32
      %c32_i32_7888 = arith.constant 32 : i32
      %3032 = arith.muli %3014, %c32_i32_7888 : i32
      %c16_i32_7889 = arith.constant 16 : i32
      %3033 = arith.muli %3017, %c16_i32_7889 : i32
      %c8_i32_7890 = arith.constant 8 : i32
      %3034 = arith.muli %3020, %c8_i32_7890 : i32
      %c4_i32_7891 = arith.constant 4 : i32
      %3035 = arith.muli %3023, %c4_i32_7891 : i32
      %c2_i32_7892 = arith.constant 2 : i32
      %3036 = arith.muli %3026, %c2_i32_7892 : i32
      %c512_i32_7893 = arith.constant 512 : i32
      %3037 = arith.muli %3011, %c512_i32_7893 : i32
      %c256_i32_7894 = arith.constant 256 : i32
      %3038 = arith.muli %3014, %c256_i32_7894 : i32
      %c128_i32_7895 = arith.constant 128 : i32
      %3039 = arith.muli %3017, %c128_i32_7895 : i32
      %c64_i32_7896 = arith.constant 64 : i32
      %3040 = arith.muli %3020, %c64_i32_7896 : i32
      %c32_i32_7897 = arith.constant 32 : i32
      %3041 = arith.muli %3023, %c32_i32_7897 : i32
      %c16_i32_7898 = arith.constant 16 : i32
      %3042 = arith.muli %3026, %c16_i32_7898 : i32
      %c2_i32_7899 = arith.constant 2 : i32
      %3043 = arith.muli %3011, %c2_i32_7899 : i32
      %c1024_i32_7900 = arith.constant 1024 : i32
      %3044 = arith.muli %3011, %c1024_i32_7900 : i32
      %c512_i32_7901 = arith.constant 512 : i32
      %3045 = arith.muli %3014, %c512_i32_7901 : i32
      %c256_i32_7902 = arith.constant 256 : i32
      %3046 = arith.muli %3017, %c256_i32_7902 : i32
      %c128_i32_7903 = arith.constant 128 : i32
      %3047 = arith.muli %3020, %c128_i32_7903 : i32
      %c64_i32_7904 = arith.constant 64 : i32
      %3048 = arith.muli %3023, %c64_i32_7904 : i32
      %c32_i32_7905 = arith.constant 32 : i32
      %3049 = arith.muli %3026, %c32_i32_7905 : i32
      %iv_7906 = cute.assume(%3030) : (i32) -> !cute.i32<divby 2>
      %int_tuple_7907 = cute.make_int_tuple(%iv_7906) : (!cute.i32<divby 2>) -> !cute.int_tuple<"?{div=2}">
      %ptr_7908 = cute.add_offset(%iter_7860, %int_tuple_7907) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=2}">) -> !cute.ptr<bf16, smem, align<4>>
      %shape_7909 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iv_7910 = cute.assume(%3011) : (i32) -> !cute.i32<divby 8>
      %iv_7911 = cute.assume(%3014) : (i32) -> !cute.i32<divby 16>
      %iv_7912 = cute.assume(%3017) : (i32) -> !cute.i32<divby 32>
      %stride_7913 = cute.make_stride(%iv_7910, %iv_7911, %iv_7912) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %lay_7914 = cute.make_layout(%shape_7909, %stride_7913) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %view_7915 = cute.make_view(%ptr_7908, %lay_7914) : !memref_smem_bf16_21
      %iter_7916 = cute.get_iter(%view_7915) : !memref_smem_bf16_21
      %lay_7917 = cute.get_layout(%view_7857) : !memref_rmem_bf16_24
      %3050 = cute.get_shape(%lay_7917) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7918, %e1_7919, %e2_7920, %e3_7921, %e4_7922 = cute.get_leaves(%3050) : !cute.shape<"((1,(4,2)),2,8)">
      %lay_7923 = cute.get_layout(%view_7915) : !memref_smem_bf16_21
      %3051 = cute.get_shape(%lay_7923) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7924, %e1_7925, %e2_7926, %e3_7927, %e4_7928, %e5_7929, %e6, %e7 = cute.get_leaves(%3051) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %lay_7930 = cute.get_layout(%view_7857) : !memref_rmem_bf16_24
      %shape_7931 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7932 = cute.make_layout() : !cute.layout<"1:0">
      %append_7933 = cute.append_to_rank<2> (%lay_7930, %lay_7932) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0">
      %view_7934 = cute.make_view(%iter_7858, %append_7933) : !memref_rmem_bf16_24
      %iter_7935 = cute.get_iter(%view_7934) : !memref_rmem_bf16_24
      %lay_7936 = cute.get_layout(%view_7934) : !memref_rmem_bf16_24
      %3052 = cute.get_shape(%lay_7936) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7937, %e1_7938, %e2_7939, %e3_7940, %e4_7941 = cute.get_leaves(%3052) : !cute.shape<"((1,(4,2)),2,8)">
      %iter_7942 = cute.get_iter(%view_7934) : !memref_rmem_bf16_24
      %view_7943 = cute.make_view(%iter_7942) : !memref_rmem_bf16_25
      %iter_7944 = cute.get_iter(%view_7943) : !memref_rmem_bf16_25
      %iter_7945 = cute.get_iter(%view_7943) : !memref_rmem_bf16_25
      %lay_7946 = cute.get_layout(%view_7915) : !memref_smem_bf16_21
      %shape_7947 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7948 = cute.make_layout() : !cute.layout<"1:0">
      %append_7949 = cute.append_to_rank<2> (%lay_7946, %lay_7948) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0">
      %view_7950 = cute.make_view(%iter_7916, %append_7949) : !memref_smem_bf16_21
      %iter_7951 = cute.get_iter(%view_7950) : !memref_smem_bf16_21
      %lay_7952 = cute.get_layout(%view_7950) : !memref_smem_bf16_21
      %3053 = cute.get_shape(%lay_7952) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7953, %e1_7954, %e2_7955, %e3_7956, %e4_7957, %e5_7958, %e6_7959, %e7_7960 = cute.get_leaves(%3053) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iter_7961 = cute.get_iter(%view_7950) : !memref_smem_bf16_21
      %lay_7962 = cute.get_layout(%view_7950) : !memref_smem_bf16_21
      %3054:3 = cute.get_scalars(%lay_7962) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %shape_7963 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %iv_7964 = cute.assume(%3054#0) : (i32) -> !cute.i32<divby 8>
      %iv_7965 = cute.assume(%3054#1) : (i32) -> !cute.i32<divby 16>
      %iv_7966 = cute.assume(%3054#2) : (i32) -> !cute.i32<divby 32>
      %stride_7967 = cute.make_stride(%iv_7964, %iv_7965, %iv_7966) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %lay_7968 = cute.make_layout(%shape_7963, %stride_7967) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %view_7969 = cute.make_view(%iter_7961, %lay_7968) : !memref_smem_bf16_22
      %iter_7970 = cute.get_iter(%view_7969) : !memref_smem_bf16_22
      %iter_7971 = cute.get_iter(%view_7969) : !memref_smem_bf16_22
      %lay_7972 = cute.get_layout(%view_7943) : !memref_rmem_bf16_25
      %3055 = cute.get_shape(%lay_7972) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))">
      %e0_7973, %e1_7974, %e2_7975, %e3_7976, %e4_7977 = cute.get_leaves(%3055) : !cute.shape<"((1,(4,2)),(2,8))">
      %lay_7978 = cute.get_layout(%view_7969) : !memref_smem_bf16_22
      %3056 = cute.get_shape(%lay_7978) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %e0_7979, %e1_7980, %e2_7981, %e3_7982, %e4_7983, %e5_7984, %e6_7985, %e7_7986 = cute.get_leaves(%3056) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %lay_7987 = cute.get_layout(%view_7943) : !memref_rmem_bf16_25
      %sz_7988 = cute.size(%lay_7987) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.int_tuple<"16">
      %e0_7989 = cute.get_leaves(%sz_7988) : !cute.int_tuple<"16">
      %lay_7990 = cute.get_layout(%view_7969) : !memref_smem_bf16_22
      %sz_7991 = cute.size(%lay_7990) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.int_tuple<"16">
      %e0_7992 = cute.get_leaves(%sz_7991) : !cute.int_tuple<"16">
      %3057 = cute.static : !cute.layout<"1:0">
      %iter_7993 = cute.get_iter(%view_7943) : !memref_rmem_bf16_25
      %iter_7994 = cute.get_iter(%view_7969) : !memref_smem_bf16_22
      %lay_7995 = cute.get_layout(%view_7943) : !memref_rmem_bf16_25
      %lay_7996 = cute.get_layout(%view_7969) : !memref_smem_bf16_22
      %append_7997 = cute.append_to_rank<2> (%lay_7995, %3057) : !cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">, !cute.layout<"1:0">
      %append_7998 = cute.append_to_rank<2> (%lay_7996, %3057) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">, !cute.layout<"1:0">
      %lay_7999 = cute.make_layout() : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">
      %3058:3 = cute.get_scalars(%append_7998) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %shape_8000 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),((2,((2,2),2))))">
      %iv_8001 = cute.assume(%3058#0) : (i32) -> !cute.i32<divby 8>
      %iv_8002 = cute.assume(%3058#1) : (i32) -> !cute.i32<divby 16>
      %iv_8003 = cute.assume(%3058#2) : (i32) -> !cute.i32<divby 32>
      %stride_8004 = cute.make_stride(%iv_8001, %iv_8002, %iv_8003) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %lay_8005 = cute.make_layout(%shape_8000, %stride_8004) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %sz_8006 = cute.size(%lay_7999) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"16">
      %3059 = cute.get_scalars(%sz_8006) : !cute.int_tuple<"16">
      %c0_i32_8007 = arith.constant 0 : i32
      %c1_i32_8008 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_8007 to %3059 step %c1_i32_8008  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((1,(4,2))):((0,(1,8)))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_7999) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"?{div=4}">
        %ptr_8607 = cute.add_offset(%iter_7993, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_rmem_bf16_26
        %3379:3 = cute.get_scalars(%lay_8005) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
        %3380 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %shape_8609 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)))">
        %iv_8610 = cute.assume(%3379#0) : (i32) -> !cute.i32<divby 8>
        %stride_8611 = cute.make_stride(%iv_8610) : (!cute.i32<divby 8>) -> !cute.stride<"((0,(1,512,?{div=8})))">
        %lay_8612 = cute.make_layout(%shape_8609, %stride_8611) : !cute.layout<"((1,(2,2,2))):((0,(1,512,?{div=8})))">
        %idx_8613 = cute.crd2idx(%coord_8604, %lay_8005) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_8614 = cute.add_offset(%iter_7994, %idx_8613) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>>
        %view_8615 = cute.make_view(%ptr_8614, %lay_8612) : !memref_smem_bf16_23
        %iter_8616 = cute.get_iter(%view_8608) : !memref_rmem_bf16_26
        %iter_8617 = cute.get_iter(%view_8615) : !memref_smem_bf16_23
        %lay_8618 = cute.get_layout(%view_8615) : !memref_smem_bf16_23
        %3381 = cute.get_scalars(%lay_8618) <{only_dynamic}> : !cute.layout<"((1,(2,2,2))):((0,(1,512,?{div=8})))">
        %3382 = builtin.unrealized_conversion_cast %iter_8616 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %3383 = builtin.unrealized_conversion_cast %iter_8617 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3384 = llvm.load %3382 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3384, %3383 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8619 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
        %ptr_8620 = cute.add_offset(%iter_8616, %int_tuple_8619) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"2">) -> !cute.ptr<bf16, rmem, align<4>>
        %int_tuple_8621 = cute.make_int_tuple() : () -> !cute.int_tuple<"512">
        %ptr_8622 = cute.add_offset(%iter_8617, %int_tuple_8621) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"512">) -> !cute.ptr<bf16, smem, align<4>>
        %3385 = builtin.unrealized_conversion_cast %ptr_8620 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %3386 = builtin.unrealized_conversion_cast %ptr_8622 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3387 = llvm.load %3385 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3387, %3386 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8623 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
        %ptr_8624 = cute.add_offset(%iter_8616, %int_tuple_8623) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"8">) -> !cute.ptr<bf16, rmem, align<8>>
        %iv_8625 = cute.assume(%3381) : (i32) -> !cute.i32<divby 8>
        %int_tuple_8626 = cute.make_int_tuple(%iv_8625) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
        %ptr_8627 = cute.add_offset(%iter_8617, %int_tuple_8626) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<4>>
        %3388 = builtin.unrealized_conversion_cast %ptr_8624 : !cute.ptr<bf16, rmem, align<8>> to !llvm.ptr
        %3389 = builtin.unrealized_conversion_cast %ptr_8627 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3390 = llvm.load %3388 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3390, %3389 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
        %int_tuple_8628 = cute.make_int_tuple() : () -> !cute.int_tuple<"10">
        %ptr_8629 = cute.add_offset(%iter_8616, %int_tuple_8628) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"10">) -> !cute.ptr<bf16, rmem, align<4>>
        %c512_i32_8630 = arith.constant 512 : i32
        %3391 = arith.addi %3381, %c512_i32_8630 : i32
        %iv_8631 = cute.assume(%3391) : (i32) -> !cute.i32<divby 8>
        %int_tuple_8632 = cute.make_int_tuple(%iv_8631) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
        %ptr_8633 = cute.add_offset(%iter_8617, %int_tuple_8632) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<4>>
        %3392 = builtin.unrealized_conversion_cast %ptr_8629 : !cute.ptr<bf16, rmem, align<4>> to !llvm.ptr
        %3393 = builtin.unrealized_conversion_cast %ptr_8633 : !cute.ptr<bf16, smem, align<4>> to !llvm.ptr<3>
        %3394 = llvm.load %3392 {alignment = 4 : i64} : !llvm.ptr -> vector<2xbf16>
        llvm.store %3394, %3393 {alignment = 4 : i64} : vector<2xbf16>, !llvm.ptr<3>
      } {llvm.loop_annotation = #loop_annotation}
      %coord_8009 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_8010 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3060:7 = cute.get_scalars(%lay_8010) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %3061:2 = cute.get_scalars(%coord_8009) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_8011 = cute.assume(%3060#3) : (i32) -> !cute.i32<divby 8>
      %shape_8012 = cute.make_shape(%3060#1, %iv_8011) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %iv_8013 = cute.assume(%3060#5) : (i64) -> !cute.i64<divby 8>
      %stride_8014 = cute.make_stride(%iv_8013) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_8015 = cute.make_layout(%shape_8012, %stride_8014) : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %idx_8016 = cute.crd2idx(%coord_8009, %lay_8010) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_8017 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_8018 = cute.add_offset(%iter_8017, %idx_8016) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_8019 = cute.make_view(%ptr_8018, %lay_8015) : !memref_gmem_bf16_1
      %iter_8020 = cute.get_iter(%view_8019) : !memref_gmem_bf16_1
      %iter_8021 = cute.get_iter(%view_8019) : !memref_gmem_bf16_1
      %tile_8022 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_8023 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %3062 = cute.get_scalars(%coord_8023) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_8024 = cute.make_coord(%3062) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_8025 = cute.get_layout(%view_8019) : !memref_gmem_bf16_1
      %3063:3 = cute.get_scalars(%lay_8025) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32_8026 = arith.constant 128 : i32
      %3064 = arith.ceildivsi %3063#0, %c128_i32_8026 : i32
      %c128_i64_8027 = arith.constant 128 : i64
      %3065 = arith.muli %3063#2, %c128_i64_8027 : i64
      %c128_i32_8028 = arith.constant 128 : i32
      %3066 = arith.ceildivsi %3063#1, %c128_i32_8028 : i32
      %shape_8029 = cute.make_shape(%3064, %3066) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_8030 = cute.assume(%3063#2) : (i64) -> !cute.i64<divby 8>
      %iv_8031 = cute.assume(%3065) : (i64) -> !cute.i64<divby 1024>
      %stride_8032 = cute.make_stride(%iv_8030, %iv_8031) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_8033 = cute.make_layout(%shape_8029, %stride_8032) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %3067:4 = cute.get_scalars(%lay_8033) <{only_dynamic}> : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %3068 = cute.get_scalars(%coord_8024) <{only_dynamic}> : !cute.coord<"((_,_),(?,0))">
      %shape_8034 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %iv_8035 = cute.assume(%3067#2) : (i64) -> !cute.i64<divby 8>
      %stride_8036 = cute.make_stride(%iv_8035) : (!cute.i64<divby 8>) -> !cute.stride<"(?{i64 div=8},1)">
      %lay_8037 = cute.make_layout(%shape_8034, %stride_8036) : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %idx_8038 = cute.crd2idx(%coord_8024, %lay_8033) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_8039 = cute.get_iter(%view_8019) : !memref_gmem_bf16_1
      %ptr_8040 = cute.add_offset(%iter_8039, %idx_8038) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_8041 = cute.make_view(%ptr_8040, %lay_8037) : !memref_gmem_bf16_2
      %iter_8042 = cute.get_iter(%view_8041) : !memref_gmem_bf16_2
      %coord_8043 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_8044 = cute.get_iter(%view_7842) : !memref_smem_bf16_
      %3069 = cute.get_scalars(%coord_8043) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_8045 = arith.constant 8 : i32
      %3070 = arith.divsi %3069, %c8_i32_8045 : i32
      %c8_i32_8046 = arith.constant 8 : i32
      %3071 = arith.remsi %3069, %c8_i32_8046 : i32
      %c8_i32_8047 = arith.constant 8 : i32
      %3072 = arith.muli %3071, %c8_i32_8047 : i32
      %c8_i32_8048 = arith.constant 8 : i32
      %3073 = arith.divsi %3070, %c8_i32_8048 : i32
      %c8_i32_8049 = arith.constant 8 : i32
      %3074 = arith.remsi %3070, %c8_i32_8049 : i32
      %c64_i32_8050 = arith.constant 64 : i32
      %3075 = arith.muli %3074, %c64_i32_8050 : i32
      %3076 = arith.addi %3072, %3075 : i32
      %c0_i32_8051 = arith.constant 0 : i32
      %3077 = arith.xori %3076, %c0_i32_8051 : i32
      %c8_i32_8052 = arith.constant 8 : i32
      %3078 = arith.divsi %3069, %c8_i32_8052 : i32
      %c8_i32_8053 = arith.constant 8 : i32
      %3079 = arith.remsi %3069, %c8_i32_8053 : i32
      %c8_i32_8054 = arith.constant 8 : i32
      %3080 = arith.divsi %3078, %c8_i32_8054 : i32
      %c8_i32_8055 = arith.constant 8 : i32
      %3081 = arith.remsi %3078, %c8_i32_8055 : i32
      %c512_i32_8056 = arith.constant 512 : i32
      %3082 = arith.muli %3080, %c512_i32_8056 : i32
      %c64_i32_8057 = arith.constant 64 : i32
      %3083 = arith.andi %3077, %c64_i32_8057 : i32
      %c0_i32_8058 = arith.constant 0 : i32
      %3084 = arith.cmpi eq, %3083, %c0_i32_8058 : i32
      %3085 = scf.if %3084 -> (i32) {
        %c8_i32_8604 = arith.constant 8 : i32
        scf.yield %c8_i32_8604 : i32
      } else {
        %c-8_i32 = arith.constant -8 : i32
        scf.yield %c-8_i32 : i32
      }
      %c128_i32_8059 = arith.constant 128 : i32
      %3086 = arith.andi %3077, %c128_i32_8059 : i32
      %c0_i32_8060 = arith.constant 0 : i32
      %3087 = arith.cmpi eq, %3086, %c0_i32_8060 : i32
      %3088 = scf.if %3087 -> (i32) {
        %c16_i32_8604 = arith.constant 16 : i32
        scf.yield %c16_i32_8604 : i32
      } else {
        %c-16_i32 = arith.constant -16 : i32
        scf.yield %c-16_i32 : i32
      }
      %c256_i32_8061 = arith.constant 256 : i32
      %3089 = arith.andi %3077, %c256_i32_8061 : i32
      %c0_i32_8062 = arith.constant 0 : i32
      %3090 = arith.cmpi eq, %3089, %c0_i32_8062 : i32
      %3091 = scf.if %3090 -> (i32) {
        %c32_i32_8604 = arith.constant 32 : i32
        scf.yield %c32_i32_8604 : i32
      } else {
        %c-32_i32 = arith.constant -32 : i32
        scf.yield %c-32_i32 : i32
      }
      %c8_i32_8063 = arith.constant 8 : i32
      %3092 = arith.andi %3077, %c8_i32_8063 : i32
      %c0_i32_8064 = arith.constant 0 : i32
      %3093 = arith.cmpi eq, %3092, %c0_i32_8064 : i32
      %3094 = scf.if %3093 -> (i32) {
        %c72_i32 = arith.constant 72 : i32
        scf.yield %c72_i32 : i32
      } else {
        %c56_i32 = arith.constant 56 : i32
        scf.yield %c56_i32 : i32
      }
      %c16_i32_8065 = arith.constant 16 : i32
      %3095 = arith.andi %3077, %c16_i32_8065 : i32
      %c0_i32_8066 = arith.constant 0 : i32
      %3096 = arith.cmpi eq, %3095, %c0_i32_8066 : i32
      %3097 = scf.if %3096 -> (i32) {
        %c144_i32 = arith.constant 144 : i32
        scf.yield %c144_i32 : i32
      } else {
        %c112_i32 = arith.constant 112 : i32
        scf.yield %c112_i32 : i32
      }
      %c32_i32_8067 = arith.constant 32 : i32
      %3098 = arith.andi %3077, %c32_i32_8067 : i32
      %c0_i32_8068 = arith.constant 0 : i32
      %3099 = arith.cmpi eq, %3098, %c0_i32_8068 : i32
      %3100 = scf.if %3099 -> (i32) {
        %c288_i32 = arith.constant 288 : i32
        scf.yield %c288_i32 : i32
      } else {
        %c224_i32 = arith.constant 224 : i32
        scf.yield %c224_i32 : i32
      }
      %c448_i32_8069 = arith.constant 448 : i32
      %3101 = arith.andi %3077, %c448_i32_8069 : i32
      %c3_i32_8070 = arith.constant 3 : i32
      %3102 = arith.shrsi %3101, %c3_i32_8070 : i32
      %3103 = arith.xori %3077, %3102 : i32
      %3104 = arith.addi %3103, %3082 : i32
      %c128_i32_8071 = arith.constant 128 : i32
      %3105 = arith.muli %3085, %c128_i32_8071 : i32
      %c64_i32_8072 = arith.constant 64 : i32
      %3106 = arith.muli %3088, %c64_i32_8072 : i32
      %c32_i32_8073 = arith.constant 32 : i32
      %3107 = arith.muli %3091, %c32_i32_8073 : i32
      %c16_i32_8074 = arith.constant 16 : i32
      %3108 = arith.muli %3094, %c16_i32_8074 : i32
      %c8_i32_8075 = arith.constant 8 : i32
      %3109 = arith.muli %3097, %c8_i32_8075 : i32
      %c4_i32_8076 = arith.constant 4 : i32
      %3110 = arith.muli %3100, %c4_i32_8076 : i32
      %c1024_i32_8077 = arith.constant 1024 : i32
      %3111 = arith.muli %3085, %c1024_i32_8077 : i32
      %c512_i32_8078 = arith.constant 512 : i32
      %3112 = arith.muli %3088, %c512_i32_8078 : i32
      %c256_i32_8079 = arith.constant 256 : i32
      %3113 = arith.muli %3091, %c256_i32_8079 : i32
      %c128_i32_8080 = arith.constant 128 : i32
      %3114 = arith.muli %3094, %c128_i32_8080 : i32
      %c64_i32_8081 = arith.constant 64 : i32
      %3115 = arith.muli %3097, %c64_i32_8081 : i32
      %c32_i32_8082 = arith.constant 32 : i32
      %3116 = arith.muli %3100, %c32_i32_8082 : i32
      %iv_8083 = cute.assume(%3104) : (i32) -> !cute.i32<divby 8>
      %int_tuple_8084 = cute.make_int_tuple(%iv_8083) : (!cute.i32<divby 8>) -> !cute.int_tuple<"?{div=8}">
      %ptr_8085 = cute.add_offset(%iter_8044, %int_tuple_8084) : (!cute.ptr<bf16, smem, align<1024>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_8086 = cute.make_view(%ptr_8085) : !memref_smem_bf16_3
      %iter_8087 = cute.get_iter(%view_8086) : !memref_smem_bf16_3
      %coord_8088 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_8089 = cute.get_iter(%view_8041) : !memref_gmem_bf16_2
      %lay_8090 = cute.get_layout(%view_8041) : !memref_gmem_bf16_2
      %3117 = cute.get_scalars(%lay_8090) <{only_dynamic}> : !cute.layout<"(128,128):(?{i64 div=8},1)">
      %3118 = cute.get_scalars(%coord_8088) <{only_dynamic}> : !cute.coord<"?">
      %c16_i64_8091 = arith.constant 16 : i64
      %3119 = arith.muli %3117, %c16_i64_8091 : i64
      %c128_i64_8092 = arith.constant 128 : i64
      %3120 = arith.muli %3117, %c128_i64_8092 : i64
      %c16_i64_8093 = arith.constant 16 : i64
      %3121 = arith.muli %3117, %c16_i64_8093 : i64
      %c8_i32_8094 = arith.constant 8 : i32
      %3122 = arith.divsi %3118, %c8_i32_8094 : i32
      %c8_i32_8095 = arith.constant 8 : i32
      %3123 = arith.remsi %3118, %c8_i32_8095 : i32
      %c8_i32_8096 = arith.constant 8 : i32
      %3124 = arith.muli %3123, %c8_i32_8096 : i32
      %3125 = arith.extsi %3122 : i32 to i64
      %3126 = arith.muli %3125, %3117 : i64
      %3127 = arith.extsi %3124 : i32 to i64
      %3128 = arith.addi %3127, %3126 : i64
      %iv_8097 = cute.assume(%3128) : (i64) -> !cute.i64<divby 8>
      %int_tuple_8098 = cute.make_int_tuple(%iv_8097) : (!cute.i64<divby 8>) -> !cute.int_tuple<"?{i64 div=8}">
      %ptr_8099 = cute.add_offset(%iter_8089, %int_tuple_8098) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %shape_8100 = cute.make_shape() : () -> !cute.shape<"((8,1),8,2)">
      %iv_8101 = cute.assume(%3119) : (i64) -> !cute.i64<divby 128>
      %stride_8102 = cute.make_stride(%iv_8101) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),?{i64 div=128},64)">
      %lay_8103 = cute.make_layout(%shape_8100, %stride_8102) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %view_8104 = cute.make_view(%ptr_8099, %lay_8103) : !memref_gmem_bf16_4
      %iter_8105 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
      %lay_8106 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
      %3129 = cute.get_scalars(%lay_8106) <{only_dynamic}> : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">
      %lay_8107 = cute.make_layout() : !cute.layout<"((8,1),8,2):((1,0),16,8)">
      %rmem_8108 = cute.memref.alloca(%lay_8107) : !memref_rmem_bf16_27
      %iter_8109 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
      %iter_8110 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
      %c1_i32_8111 = arith.constant 1 : i32
      %c128_i32_8112 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_8111 number_of_threads = %c128_i32_8112
      %lay_8113 = cute.get_layout(%view_8086) : !memref_smem_bf16_3
      %3130 = cute.get_shape(%lay_8113) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8114, %e1_8115, %e2_8116, %e3_8117 = cute.get_leaves(%3130) : !cute.shape<"((8,1),8,2)">
      %lay_8118 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
      %3131 = cute.get_shape(%lay_8118) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8119, %e1_8120, %e2_8121, %e3_8122 = cute.get_leaves(%3131) : !cute.shape<"((8,1),8,2)">
      %lay_8123 = cute.get_layout(%view_8086) : !memref_smem_bf16_3
      %shape_8124 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_8125 = cute.make_layout() : !cute.layout<"1:0">
      %append_8126 = cute.append_to_rank<2> (%lay_8123, %lay_8125) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0">
      %view_8127 = cute.make_view(%iter_8087, %append_8126) : !memref_smem_bf16_3
      %iter_8128 = cute.get_iter(%view_8127) : !memref_smem_bf16_3
      %lay_8129 = cute.get_layout(%view_8127) : !memref_smem_bf16_3
      %3132 = cute.get_shape(%lay_8129) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8130, %e1_8131, %e2_8132, %e3_8133 = cute.get_leaves(%3132) : !cute.shape<"((8,1),8,2)">
      %iter_8134 = cute.get_iter(%view_8127) : !memref_smem_bf16_3
      %view_8135 = cute.make_view(%iter_8134) : !memref_smem_bf16_24
      %iter_8136 = cute.get_iter(%view_8135) : !memref_smem_bf16_24
      %iter_8137 = cute.get_iter(%view_8135) : !memref_smem_bf16_24
      %lay_8138 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
      %shape_8139 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_8140 = cute.make_layout() : !cute.layout<"1:0">
      %append_8141 = cute.append_to_rank<2> (%lay_8138, %lay_8140) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_8142 = cute.make_view(%iter_8110, %append_8141) : !memref_rmem_bf16_27
      %iter_8143 = cute.get_iter(%view_8142) : !memref_rmem_bf16_27
      %lay_8144 = cute.get_layout(%view_8142) : !memref_rmem_bf16_27
      %3133 = cute.get_shape(%lay_8144) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8145, %e1_8146, %e2_8147, %e3_8148 = cute.get_leaves(%3133) : !cute.shape<"((8,1),8,2)">
      %iter_8149 = cute.get_iter(%view_8142) : !memref_rmem_bf16_27
      %view_8150 = cute.make_view(%iter_8149) : !memref_rmem_bf16_28
      %iter_8151 = cute.get_iter(%view_8150) : !memref_rmem_bf16_28
      %iter_8152 = cute.get_iter(%view_8150) : !memref_rmem_bf16_28
      %lay_8153 = cute.get_layout(%view_8135) : !memref_smem_bf16_24
      %3134 = cute.get_shape(%lay_8153) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_8154, %e1_8155, %e2_8156, %e3_8157 = cute.get_leaves(%3134) : !cute.shape<"((8,1),(8,2))">
      %lay_8158 = cute.get_layout(%view_8150) : !memref_rmem_bf16_28
      %3135 = cute.get_shape(%lay_8158) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_8159, %e1_8160, %e2_8161, %e3_8162 = cute.get_leaves(%3135) : !cute.shape<"((8,1),(8,2))">
      %lay_8163 = cute.get_layout(%view_8135) : !memref_smem_bf16_24
      %sz_8164 = cute.size(%lay_8163) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.int_tuple<"16">
      %e0_8165 = cute.get_leaves(%sz_8164) : !cute.int_tuple<"16">
      %lay_8166 = cute.get_layout(%view_8150) : !memref_rmem_bf16_28
      %sz_8167 = cute.size(%lay_8166) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.int_tuple<"16">
      %e0_8168 = cute.get_leaves(%sz_8167) : !cute.int_tuple<"16">
      %3136 = cute.static : !cute.layout<"1:0">
      %iter_8169 = cute.get_iter(%view_8135) : !memref_smem_bf16_24
      %iter_8170 = cute.get_iter(%view_8150) : !memref_rmem_bf16_28
      %lay_8171 = cute.get_layout(%view_8135) : !memref_smem_bf16_24
      %lay_8172 = cute.get_layout(%view_8150) : !memref_rmem_bf16_28
      %append_8173 = cute.append_to_rank<2> (%lay_8171, %3136) : !cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">, !cute.layout<"1:0">
      %append_8174 = cute.append_to_rank<2> (%lay_8172, %3136) : !cute.layout<"((8,1),(8,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_8175 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">
      %lay_8176 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">
      %sz_8177 = cute.size(%lay_8175) <{mode = [1]}> : (!cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"16">
      %3137 = cute.get_scalars(%sz_8177) : !cute.int_tuple<"16">
      %c0_i32_8178 = arith.constant 0 : i32
      %c1_i32_8179 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_8178 to %3137 step %c1_i32_8179  : i32 {
        %coord_8604 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %3378 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8605 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8175) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_8607 = cute.add_offset(%iter_8169, %idx_8606) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8608 = cute.make_view(%ptr_8607, %lay_8605) : !memref_smem_bf16_13
        %3379 = cute.get_scalars(%coord_8604) <{only_dynamic}> : !cute.coord<"(_,?)">
        %lay_8609 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
        %idx_8610 = cute.crd2idx(%coord_8604, %lay_8176) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_8611 = cute.add_offset(%iter_8170, %idx_8610) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8612 = cute.make_view(%ptr_8611, %lay_8609) : !memref_rmem_bf16_8
        %iter_8613 = cute.get_iter(%view_8608) : !memref_smem_bf16_13
        %iter_8614 = cute.get_iter(%view_8612) : !memref_rmem_bf16_8
        %3380 = builtin.unrealized_conversion_cast %iter_8613 : !cute.ptr<bf16, smem, align<16>> to !llvm.ptr<3>
        %3381 = builtin.unrealized_conversion_cast %iter_8614 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
        %3382 = llvm.load %3380 {alignment = 16 : i64} : !llvm.ptr<3> -> vector<8xbf16>
        llvm.store %3382, %3381 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr
      } {llvm.loop_annotation = #loop_annotation}
      %lay_8180 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3138 = cute.get_shape(%lay_8180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8181, %e1_8182, %e2_8183, %e3_8184 = cute.get_leaves(%3138) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8185 = cute.to_int_tuple(%e0_8181) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3139 = cute.get_scalars(%itup_8185) : !cute.int_tuple<"?">
      %itup_8186 = cute.to_int_tuple(%e1_8182) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3140 = cute.get_scalars(%itup_8186) : !cute.int_tuple<"?">
      %itup_8187 = cute.to_int_tuple(%e2_8183) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3141 = cute.get_scalars(%itup_8187) : !cute.int_tuple<"?">
      %itup_8188 = cute.to_int_tuple(%e3_8184) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3142 = cute.get_scalars(%itup_8188) : !cute.int_tuple<"?{div=8}">
      %shape_8189 = cute.make_shape(%itup_8185, %itup_8186, %itup_8187, %itup_8188) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %int_tuple_8190 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,0,0,0)">
      %stride_8191 = cute.make_stride() : () -> !cute.stride<"(1@0,1@1,1@2,1@3)">
      %lay_8192 = cute.make_layout(%shape_8189, %stride_8191) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %view_8193 = cute.make_view(%int_tuple_8190, %lay_8192) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_8194 = cute.get_iter(%view_8193) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_8195, %e1_8196, %e2_8197, %e3_8198 = cute.get_leaves(%iter_8194) : !cute.int_tuple<"(0,0,0,0)">
      %coord_8199 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_8200 = cute.get_layout(%view_8193) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %3143:4 = cute.get_scalars(%lay_8200) <{only_dynamic}> : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %3144:2 = cute.get_scalars(%coord_8199) <{only_dynamic}> : !cute.coord<"(?,_,?,_)">
      %iv_8201 = cute.assume(%3143#3) : (i32) -> !cute.i32<divby 8>
      %shape_8202 = cute.make_shape(%3143#1, %iv_8201) : (i32, !cute.i32<divby 8>) -> !cute.shape<"(?,?{div=8})">
      %stride_8203 = cute.make_stride() : () -> !cute.stride<"(1@1,1@3)">
      %lay_8204 = cute.make_layout(%shape_8202, %stride_8203) : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %idx_8205 = cute.crd2idx(%coord_8199, %lay_8200) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_8206 = cute.get_iter(%view_8193) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_8207 = cute.add_offset(%iter_8206, %idx_8205) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_8208 = cute.make_view(%tup_8207, %lay_8204) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_8209 = cute.get_iter(%view_8208) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_8210, %e1_8211, %e2_8212, %e3_8213 = cute.get_leaves(%iter_8209) : !cute.int_tuple<"(?,0,?,0)">
      %3145 = cute.get_scalars(%e0_8210) : !cute.int_tuple<"?">
      %3146 = cute.get_scalars(%e2_8212) : !cute.int_tuple<"?">
      %iter_8214 = cute.get_iter(%view_8208) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_8215, %e1_8216, %e2_8217, %e3_8218 = cute.get_leaves(%iter_8214) : !cute.int_tuple<"(?,0,?,0)">
      %3147 = cute.get_scalars(%e0_8215) : !cute.int_tuple<"?">
      %3148 = cute.get_scalars(%e2_8217) : !cute.int_tuple<"?">
      %tile_8219 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_8220 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %3149 = cute.get_scalars(%coord_8220) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_8221 = cute.make_coord(%3149) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_8222 = cute.get_layout(%view_8208) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %3150:2 = cute.get_scalars(%lay_8222) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_8223 = arith.constant 128 : i32
      %3151 = arith.ceildivsi %3150#0, %c128_i32_8223 : i32
      %c128_i32_8224 = arith.constant 128 : i32
      %3152 = arith.ceildivsi %3150#1, %c128_i32_8224 : i32
      %shape_8225 = cute.make_shape(%3151, %3152) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_8226 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_8227 = cute.make_layout(%shape_8225, %stride_8226) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_8228 = cute.crd2idx(%coord_8221, %lay_8227) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_8229 = cute.get_iter(%view_8208) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_8230 = cute.add_offset(%iter_8229, %idx_8228) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_8231 = cute.make_view(%tup_8230) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_8232 = cute.get_iter(%view_8231) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_8233, %e1_8234, %e2_8235, %e3_8236 = cute.get_leaves(%iter_8232) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %3153 = cute.get_scalars(%e0_8233) : !cute.int_tuple<"?">
      %3154 = cute.get_scalars(%e1_8234) : !cute.int_tuple<"?{div=128}">
      %3155 = cute.get_scalars(%e2_8235) : !cute.int_tuple<"?">
      %coord_8237 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %iter_8238 = cute.get_iter(%view_8231) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %3156 = cute.get_scalars(%coord_8237) <{only_dynamic}> : !cute.coord<"?">
      %c8_i32_8239 = arith.constant 8 : i32
      %3157 = arith.divsi %3156, %c8_i32_8239 : i32
      %c8_i32_8240 = arith.constant 8 : i32
      %3158 = arith.remsi %3156, %c8_i32_8240 : i32
      %c8_i32_8241 = arith.constant 8 : i32
      %3159 = arith.muli %3158, %c8_i32_8241 : i32
      %iv_8242 = cute.assume(%3159) : (i32) -> !cute.i32<divby 8>
      %int_tuple_8243 = cute.make_int_tuple(%3157, %iv_8242) : (i32, !cute.i32<divby 8>) -> !cute.int_tuple<"(0,?,0,?{div=8})">
      %tup_8244 = cute.add_offset(%iter_8238, %int_tuple_8243) : (!cute.int_tuple<"(?,?{div=128},?,0)">, !cute.int_tuple<"(0,?,0,?{div=8})">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8245 = cute.make_view(%tup_8244) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_8246 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_8247, %e1_8248, %e2_8249, %e3_8250 = cute.get_leaves(%iter_8246) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3160 = cute.get_scalars(%e0_8247) : !cute.int_tuple<"?">
      %3161 = cute.get_scalars(%e1_8248) : !cute.int_tuple<"?">
      %3162 = cute.get_scalars(%e2_8249) : !cute.int_tuple<"?">
      %3163 = cute.get_scalars(%e3_8250) : !cute.int_tuple<"?{div=8}">
      %lay_8251 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
      %3164 = cute.get_shape(%lay_8251) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)">
      %e0_8252, %e1_8253, %e2_8254, %e3_8255 = cute.get_leaves(%3164) : !cute.shape<"((8,1),8,2)">
      %shape_8256 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_8257 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_8258 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_8259 = cute.memref.alloca(%lay_8258) : !memref_rmem_i8_
      %iter_8260 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
      %iter_8261 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
      %lay_8262 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
      %3165 = cute.get_shape(%lay_8262) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_8263, %e1_8264, %e2_8265 = cute.get_leaves(%3165) : !cute.shape<"(1,8,2)">
      %int_tuple_8266 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_8267 = cute.size(%int_tuple_8266) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_8268 = cute.get_leaves(%sz_8267) : !cute.int_tuple<"2">
      %coord_8269 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_8270 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8271 = cute.crd2idx(%coord_8269, %lay_8270) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_8272 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8273 = cute.add_offset(%iter_8272, %idx_8271) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8274 = cute.make_view(%tup_8273) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8275 = cute.get_iter(%view_8274) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8276, %e1_8277, %e2_8278, %e3_8279 = cute.get_leaves(%iter_8275) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3166 = cute.get_scalars(%e0_8276) : !cute.int_tuple<"?">
      %3167 = cute.get_scalars(%e1_8277) : !cute.int_tuple<"?">
      %3168 = cute.get_scalars(%e2_8278) : !cute.int_tuple<"?">
      %3169 = cute.get_scalars(%e3_8279) : !cute.int_tuple<"?{div=8}">
      %iter_8280 = cute.get_iter(%view_8274) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8281, %e1_8282, %e2_8283, %e3_8284 = cute.get_leaves(%iter_8280) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3170 = cute.get_scalars(%e0_8281) : !cute.int_tuple<"?">
      %3171 = cute.get_scalars(%e1_8282) : !cute.int_tuple<"?">
      %3172 = cute.get_scalars(%e2_8283) : !cute.int_tuple<"?">
      %3173 = cute.get_scalars(%e3_8284) : !cute.int_tuple<"?{div=8}">
      %iter_8285 = cute.get_iter(%view_8274) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8286, %e1_8287, %e2_8288, %e3_8289 = cute.get_leaves(%iter_8285) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3174 = cute.get_scalars(%e0_8286) : !cute.int_tuple<"?">
      %3175 = cute.get_scalars(%e1_8287) : !cute.int_tuple<"?">
      %3176 = cute.get_scalars(%e2_8288) : !cute.int_tuple<"?">
      %3177 = cute.get_scalars(%e3_8289) : !cute.int_tuple<"?{div=8}">
      %lay_8290 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3178 = cute.get_shape(%lay_8290) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8291, %e1_8292, %e2_8293, %e3_8294 = cute.get_leaves(%3178) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8295 = cute.to_int_tuple(%e0_8291) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3179 = cute.get_scalars(%itup_8295) : !cute.int_tuple<"?">
      %itup_8296 = cute.to_int_tuple(%e1_8292) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3180 = cute.get_scalars(%itup_8296) : !cute.int_tuple<"?">
      %itup_8297 = cute.to_int_tuple(%e2_8293) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3181 = cute.get_scalars(%itup_8297) : !cute.int_tuple<"?">
      %itup_8298 = cute.to_int_tuple(%e3_8294) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3182 = cute.get_scalars(%itup_8298) : !cute.int_tuple<"?{div=8}">
      %coord_8299 = cute.make_coord(%e3_8289) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_8300 = cute.make_coord(%itup_8298) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %3183 = cute.get_scalars(%coord_8299) : !cute.coord<"?{div=8}">
      %3184 = cute.get_scalars(%coord_8300) : !cute.coord<"?{div=8}">
      %true_8301 = arith.constant true
      %3185 = arith.cmpi slt, %3183, %3184 : i32
      %3186 = arith.andi %true_8301, %3185 : i1
      %3187 = arith.extui %3186 : i1 to i8
      %coord_8302 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_8259, %coord_8302, %3187) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_8303 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_8304 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8305 = cute.crd2idx(%coord_8303, %lay_8304) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_8306 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8307 = cute.add_offset(%iter_8306, %idx_8305) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8308 = cute.make_view(%tup_8307) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8309 = cute.get_iter(%view_8308) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8310, %e1_8311, %e2_8312, %e3_8313 = cute.get_leaves(%iter_8309) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3188 = cute.get_scalars(%e0_8310) : !cute.int_tuple<"?">
      %3189 = cute.get_scalars(%e1_8311) : !cute.int_tuple<"?">
      %3190 = cute.get_scalars(%e2_8312) : !cute.int_tuple<"?">
      %3191 = cute.get_scalars(%e3_8313) : !cute.int_tuple<"?{div=8}">
      %iter_8314 = cute.get_iter(%view_8308) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8315, %e1_8316, %e2_8317, %e3_8318 = cute.get_leaves(%iter_8314) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3192 = cute.get_scalars(%e0_8315) : !cute.int_tuple<"?">
      %3193 = cute.get_scalars(%e1_8316) : !cute.int_tuple<"?">
      %3194 = cute.get_scalars(%e2_8317) : !cute.int_tuple<"?">
      %3195 = cute.get_scalars(%e3_8318) : !cute.int_tuple<"?{div=8}">
      %iter_8319 = cute.get_iter(%view_8308) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8320, %e1_8321, %e2_8322, %e3_8323 = cute.get_leaves(%iter_8319) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3196 = cute.get_scalars(%e0_8320) : !cute.int_tuple<"?">
      %3197 = cute.get_scalars(%e1_8321) : !cute.int_tuple<"?">
      %3198 = cute.get_scalars(%e2_8322) : !cute.int_tuple<"?">
      %3199 = cute.get_scalars(%e3_8323) : !cute.int_tuple<"?{div=8}">
      %lay_8324 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3200 = cute.get_shape(%lay_8324) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8325, %e1_8326, %e2_8327, %e3_8328 = cute.get_leaves(%3200) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8329 = cute.to_int_tuple(%e0_8325) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3201 = cute.get_scalars(%itup_8329) : !cute.int_tuple<"?">
      %itup_8330 = cute.to_int_tuple(%e1_8326) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3202 = cute.get_scalars(%itup_8330) : !cute.int_tuple<"?">
      %itup_8331 = cute.to_int_tuple(%e2_8327) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3203 = cute.get_scalars(%itup_8331) : !cute.int_tuple<"?">
      %itup_8332 = cute.to_int_tuple(%e3_8328) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3204 = cute.get_scalars(%itup_8332) : !cute.int_tuple<"?{div=8}">
      %coord_8333 = cute.make_coord(%e3_8323) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_8334 = cute.make_coord(%itup_8332) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %3205 = cute.get_scalars(%coord_8333) : !cute.coord<"?{div=8}">
      %3206 = cute.get_scalars(%coord_8334) : !cute.coord<"?{div=8}">
      %true_8335 = arith.constant true
      %3207 = arith.cmpi slt, %3205, %3206 : i32
      %3208 = arith.andi %true_8335, %3207 : i1
      %3209 = arith.extui %3208 : i1 to i8
      %coord_8336 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_8259, %coord_8336, %3209) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_8337 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_8338 = cute.size(%int_tuple_8337) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_8339 = cute.get_leaves(%sz_8338) : !cute.int_tuple<"8">
      %coord_8340 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_8341 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8342 = cute.crd2idx(%coord_8340, %lay_8341) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_8343 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8344 = cute.add_offset(%iter_8343, %idx_8342) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8345 = cute.make_view(%tup_8344) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8346 = cute.get_iter(%view_8345) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8347, %e1_8348, %e2_8349, %e3_8350 = cute.get_leaves(%iter_8346) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3210 = cute.get_scalars(%e0_8347) : !cute.int_tuple<"?">
      %3211 = cute.get_scalars(%e1_8348) : !cute.int_tuple<"?">
      %3212 = cute.get_scalars(%e2_8349) : !cute.int_tuple<"?">
      %3213 = cute.get_scalars(%e3_8350) : !cute.int_tuple<"?{div=8}">
      %iter_8351 = cute.get_iter(%view_8345) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8352, %e1_8353, %e2_8354, %e3_8355 = cute.get_leaves(%iter_8351) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3214 = cute.get_scalars(%e0_8352) : !cute.int_tuple<"?">
      %3215 = cute.get_scalars(%e1_8353) : !cute.int_tuple<"?">
      %3216 = cute.get_scalars(%e2_8354) : !cute.int_tuple<"?">
      %3217 = cute.get_scalars(%e3_8355) : !cute.int_tuple<"?{div=8}">
      %iter_8356 = cute.get_iter(%view_8345) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8357, %e1_8358, %e2_8359, %e3_8360 = cute.get_leaves(%iter_8356) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3218 = cute.get_scalars(%e0_8357) : !cute.int_tuple<"?">
      %3219 = cute.get_scalars(%e1_8358) : !cute.int_tuple<"?">
      %3220 = cute.get_scalars(%e2_8359) : !cute.int_tuple<"?">
      %3221 = cute.get_scalars(%e3_8360) : !cute.int_tuple<"?{div=8}">
      %lay_8361 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3222 = cute.get_shape(%lay_8361) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8362, %e1_8363, %e2_8364, %e3_8365 = cute.get_leaves(%3222) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8366 = cute.to_int_tuple(%e0_8362) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3223 = cute.get_scalars(%itup_8366) : !cute.int_tuple<"?">
      %itup_8367 = cute.to_int_tuple(%e1_8363) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3224 = cute.get_scalars(%itup_8367) : !cute.int_tuple<"?">
      %itup_8368 = cute.to_int_tuple(%e2_8364) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3225 = cute.get_scalars(%itup_8368) : !cute.int_tuple<"?">
      %itup_8369 = cute.to_int_tuple(%e3_8365) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3226 = cute.get_scalars(%itup_8369) : !cute.int_tuple<"?{div=8}">
      %coord_8370 = cute.make_coord(%e1_8358) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8371 = cute.make_coord(%itup_8367) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3227 = cute.get_scalars(%coord_8370) : !cute.coord<"?">
      %3228 = cute.get_scalars(%coord_8371) : !cute.coord<"?">
      %true_8372 = arith.constant true
      %3229 = arith.cmpi slt, %3227, %3228 : i32
      %3230 = arith.andi %true_8372, %3229 : i1
      scf.if %3230 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8373 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_8374 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8375 = cute.crd2idx(%coord_8373, %lay_8374) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_8376 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8377 = cute.add_offset(%iter_8376, %idx_8375) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8378 = cute.make_view(%tup_8377) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8379 = cute.get_iter(%view_8378) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8380, %e1_8381, %e2_8382, %e3_8383 = cute.get_leaves(%iter_8379) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3231 = cute.get_scalars(%e0_8380) : !cute.int_tuple<"?">
      %3232 = cute.get_scalars(%e1_8381) : !cute.int_tuple<"?">
      %3233 = cute.get_scalars(%e2_8382) : !cute.int_tuple<"?">
      %3234 = cute.get_scalars(%e3_8383) : !cute.int_tuple<"?{div=8}">
      %iter_8384 = cute.get_iter(%view_8378) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8385, %e1_8386, %e2_8387, %e3_8388 = cute.get_leaves(%iter_8384) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3235 = cute.get_scalars(%e0_8385) : !cute.int_tuple<"?">
      %3236 = cute.get_scalars(%e1_8386) : !cute.int_tuple<"?">
      %3237 = cute.get_scalars(%e2_8387) : !cute.int_tuple<"?">
      %3238 = cute.get_scalars(%e3_8388) : !cute.int_tuple<"?{div=8}">
      %iter_8389 = cute.get_iter(%view_8378) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8390, %e1_8391, %e2_8392, %e3_8393 = cute.get_leaves(%iter_8389) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3239 = cute.get_scalars(%e0_8390) : !cute.int_tuple<"?">
      %3240 = cute.get_scalars(%e1_8391) : !cute.int_tuple<"?">
      %3241 = cute.get_scalars(%e2_8392) : !cute.int_tuple<"?">
      %3242 = cute.get_scalars(%e3_8393) : !cute.int_tuple<"?{div=8}">
      %lay_8394 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3243 = cute.get_shape(%lay_8394) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8395, %e1_8396, %e2_8397, %e3_8398 = cute.get_leaves(%3243) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8399 = cute.to_int_tuple(%e0_8395) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3244 = cute.get_scalars(%itup_8399) : !cute.int_tuple<"?">
      %itup_8400 = cute.to_int_tuple(%e1_8396) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3245 = cute.get_scalars(%itup_8400) : !cute.int_tuple<"?">
      %itup_8401 = cute.to_int_tuple(%e2_8397) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3246 = cute.get_scalars(%itup_8401) : !cute.int_tuple<"?">
      %itup_8402 = cute.to_int_tuple(%e3_8398) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3247 = cute.get_scalars(%itup_8402) : !cute.int_tuple<"?{div=8}">
      %coord_8403 = cute.make_coord(%e1_8391) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8404 = cute.make_coord(%itup_8400) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3248 = cute.get_scalars(%coord_8403) : !cute.coord<"?">
      %3249 = cute.get_scalars(%coord_8404) : !cute.coord<"?">
      %true_8405 = arith.constant true
      %3250 = arith.cmpi slt, %3248, %3249 : i32
      %3251 = arith.andi %true_8405, %3250 : i1
      scf.if %3251 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8406 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_8407 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8408 = cute.crd2idx(%coord_8406, %lay_8407) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_8409 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8410 = cute.add_offset(%iter_8409, %idx_8408) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8411 = cute.make_view(%tup_8410) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8412 = cute.get_iter(%view_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8413, %e1_8414, %e2_8415, %e3_8416 = cute.get_leaves(%iter_8412) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3252 = cute.get_scalars(%e0_8413) : !cute.int_tuple<"?">
      %3253 = cute.get_scalars(%e1_8414) : !cute.int_tuple<"?">
      %3254 = cute.get_scalars(%e2_8415) : !cute.int_tuple<"?">
      %3255 = cute.get_scalars(%e3_8416) : !cute.int_tuple<"?{div=8}">
      %iter_8417 = cute.get_iter(%view_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8418, %e1_8419, %e2_8420, %e3_8421 = cute.get_leaves(%iter_8417) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3256 = cute.get_scalars(%e0_8418) : !cute.int_tuple<"?">
      %3257 = cute.get_scalars(%e1_8419) : !cute.int_tuple<"?">
      %3258 = cute.get_scalars(%e2_8420) : !cute.int_tuple<"?">
      %3259 = cute.get_scalars(%e3_8421) : !cute.int_tuple<"?{div=8}">
      %iter_8422 = cute.get_iter(%view_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8423, %e1_8424, %e2_8425, %e3_8426 = cute.get_leaves(%iter_8422) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3260 = cute.get_scalars(%e0_8423) : !cute.int_tuple<"?">
      %3261 = cute.get_scalars(%e1_8424) : !cute.int_tuple<"?">
      %3262 = cute.get_scalars(%e2_8425) : !cute.int_tuple<"?">
      %3263 = cute.get_scalars(%e3_8426) : !cute.int_tuple<"?{div=8}">
      %lay_8427 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3264 = cute.get_shape(%lay_8427) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8428, %e1_8429, %e2_8430, %e3_8431 = cute.get_leaves(%3264) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8432 = cute.to_int_tuple(%e0_8428) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3265 = cute.get_scalars(%itup_8432) : !cute.int_tuple<"?">
      %itup_8433 = cute.to_int_tuple(%e1_8429) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3266 = cute.get_scalars(%itup_8433) : !cute.int_tuple<"?">
      %itup_8434 = cute.to_int_tuple(%e2_8430) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3267 = cute.get_scalars(%itup_8434) : !cute.int_tuple<"?">
      %itup_8435 = cute.to_int_tuple(%e3_8431) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3268 = cute.get_scalars(%itup_8435) : !cute.int_tuple<"?{div=8}">
      %coord_8436 = cute.make_coord(%e1_8424) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8437 = cute.make_coord(%itup_8433) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3269 = cute.get_scalars(%coord_8436) : !cute.coord<"?">
      %3270 = cute.get_scalars(%coord_8437) : !cute.coord<"?">
      %true_8438 = arith.constant true
      %3271 = arith.cmpi slt, %3269, %3270 : i32
      %3272 = arith.andi %true_8438, %3271 : i1
      scf.if %3272 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8439 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_8440 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8441 = cute.crd2idx(%coord_8439, %lay_8440) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_8442 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8443 = cute.add_offset(%iter_8442, %idx_8441) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8444 = cute.make_view(%tup_8443) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8445 = cute.get_iter(%view_8444) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8446, %e1_8447, %e2_8448, %e3_8449 = cute.get_leaves(%iter_8445) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3273 = cute.get_scalars(%e0_8446) : !cute.int_tuple<"?">
      %3274 = cute.get_scalars(%e1_8447) : !cute.int_tuple<"?">
      %3275 = cute.get_scalars(%e2_8448) : !cute.int_tuple<"?">
      %3276 = cute.get_scalars(%e3_8449) : !cute.int_tuple<"?{div=8}">
      %iter_8450 = cute.get_iter(%view_8444) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8451, %e1_8452, %e2_8453, %e3_8454 = cute.get_leaves(%iter_8450) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3277 = cute.get_scalars(%e0_8451) : !cute.int_tuple<"?">
      %3278 = cute.get_scalars(%e1_8452) : !cute.int_tuple<"?">
      %3279 = cute.get_scalars(%e2_8453) : !cute.int_tuple<"?">
      %3280 = cute.get_scalars(%e3_8454) : !cute.int_tuple<"?{div=8}">
      %iter_8455 = cute.get_iter(%view_8444) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8456, %e1_8457, %e2_8458, %e3_8459 = cute.get_leaves(%iter_8455) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3281 = cute.get_scalars(%e0_8456) : !cute.int_tuple<"?">
      %3282 = cute.get_scalars(%e1_8457) : !cute.int_tuple<"?">
      %3283 = cute.get_scalars(%e2_8458) : !cute.int_tuple<"?">
      %3284 = cute.get_scalars(%e3_8459) : !cute.int_tuple<"?{div=8}">
      %lay_8460 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3285 = cute.get_shape(%lay_8460) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8461, %e1_8462, %e2_8463, %e3_8464 = cute.get_leaves(%3285) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8465 = cute.to_int_tuple(%e0_8461) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3286 = cute.get_scalars(%itup_8465) : !cute.int_tuple<"?">
      %itup_8466 = cute.to_int_tuple(%e1_8462) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3287 = cute.get_scalars(%itup_8466) : !cute.int_tuple<"?">
      %itup_8467 = cute.to_int_tuple(%e2_8463) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3288 = cute.get_scalars(%itup_8467) : !cute.int_tuple<"?">
      %itup_8468 = cute.to_int_tuple(%e3_8464) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3289 = cute.get_scalars(%itup_8468) : !cute.int_tuple<"?{div=8}">
      %coord_8469 = cute.make_coord(%e1_8457) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8470 = cute.make_coord(%itup_8466) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3290 = cute.get_scalars(%coord_8469) : !cute.coord<"?">
      %3291 = cute.get_scalars(%coord_8470) : !cute.coord<"?">
      %true_8471 = arith.constant true
      %3292 = arith.cmpi slt, %3290, %3291 : i32
      %3293 = arith.andi %true_8471, %3292 : i1
      scf.if %3293 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8472 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_8473 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8474 = cute.crd2idx(%coord_8472, %lay_8473) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_8475 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8476 = cute.add_offset(%iter_8475, %idx_8474) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8477 = cute.make_view(%tup_8476) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8478 = cute.get_iter(%view_8477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8479, %e1_8480, %e2_8481, %e3_8482 = cute.get_leaves(%iter_8478) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3294 = cute.get_scalars(%e0_8479) : !cute.int_tuple<"?">
      %3295 = cute.get_scalars(%e1_8480) : !cute.int_tuple<"?">
      %3296 = cute.get_scalars(%e2_8481) : !cute.int_tuple<"?">
      %3297 = cute.get_scalars(%e3_8482) : !cute.int_tuple<"?{div=8}">
      %iter_8483 = cute.get_iter(%view_8477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8484, %e1_8485, %e2_8486, %e3_8487 = cute.get_leaves(%iter_8483) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3298 = cute.get_scalars(%e0_8484) : !cute.int_tuple<"?">
      %3299 = cute.get_scalars(%e1_8485) : !cute.int_tuple<"?">
      %3300 = cute.get_scalars(%e2_8486) : !cute.int_tuple<"?">
      %3301 = cute.get_scalars(%e3_8487) : !cute.int_tuple<"?{div=8}">
      %iter_8488 = cute.get_iter(%view_8477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8489, %e1_8490, %e2_8491, %e3_8492 = cute.get_leaves(%iter_8488) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3302 = cute.get_scalars(%e0_8489) : !cute.int_tuple<"?">
      %3303 = cute.get_scalars(%e1_8490) : !cute.int_tuple<"?">
      %3304 = cute.get_scalars(%e2_8491) : !cute.int_tuple<"?">
      %3305 = cute.get_scalars(%e3_8492) : !cute.int_tuple<"?{div=8}">
      %lay_8493 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3306 = cute.get_shape(%lay_8493) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8494, %e1_8495, %e2_8496, %e3_8497 = cute.get_leaves(%3306) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8498 = cute.to_int_tuple(%e0_8494) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3307 = cute.get_scalars(%itup_8498) : !cute.int_tuple<"?">
      %itup_8499 = cute.to_int_tuple(%e1_8495) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3308 = cute.get_scalars(%itup_8499) : !cute.int_tuple<"?">
      %itup_8500 = cute.to_int_tuple(%e2_8496) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3309 = cute.get_scalars(%itup_8500) : !cute.int_tuple<"?">
      %itup_8501 = cute.to_int_tuple(%e3_8497) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3310 = cute.get_scalars(%itup_8501) : !cute.int_tuple<"?{div=8}">
      %coord_8502 = cute.make_coord(%e1_8490) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8503 = cute.make_coord(%itup_8499) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3311 = cute.get_scalars(%coord_8502) : !cute.coord<"?">
      %3312 = cute.get_scalars(%coord_8503) : !cute.coord<"?">
      %true_8504 = arith.constant true
      %3313 = arith.cmpi slt, %3311, %3312 : i32
      %3314 = arith.andi %true_8504, %3313 : i1
      scf.if %3314 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"64">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8505 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_8506 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8507 = cute.crd2idx(%coord_8505, %lay_8506) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_8508 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8509 = cute.add_offset(%iter_8508, %idx_8507) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8510 = cute.make_view(%tup_8509) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8511 = cute.get_iter(%view_8510) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8512, %e1_8513, %e2_8514, %e3_8515 = cute.get_leaves(%iter_8511) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3315 = cute.get_scalars(%e0_8512) : !cute.int_tuple<"?">
      %3316 = cute.get_scalars(%e1_8513) : !cute.int_tuple<"?">
      %3317 = cute.get_scalars(%e2_8514) : !cute.int_tuple<"?">
      %3318 = cute.get_scalars(%e3_8515) : !cute.int_tuple<"?{div=8}">
      %iter_8516 = cute.get_iter(%view_8510) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8517, %e1_8518, %e2_8519, %e3_8520 = cute.get_leaves(%iter_8516) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3319 = cute.get_scalars(%e0_8517) : !cute.int_tuple<"?">
      %3320 = cute.get_scalars(%e1_8518) : !cute.int_tuple<"?">
      %3321 = cute.get_scalars(%e2_8519) : !cute.int_tuple<"?">
      %3322 = cute.get_scalars(%e3_8520) : !cute.int_tuple<"?{div=8}">
      %iter_8521 = cute.get_iter(%view_8510) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8522, %e1_8523, %e2_8524, %e3_8525 = cute.get_leaves(%iter_8521) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3323 = cute.get_scalars(%e0_8522) : !cute.int_tuple<"?">
      %3324 = cute.get_scalars(%e1_8523) : !cute.int_tuple<"?">
      %3325 = cute.get_scalars(%e2_8524) : !cute.int_tuple<"?">
      %3326 = cute.get_scalars(%e3_8525) : !cute.int_tuple<"?{div=8}">
      %lay_8526 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3327 = cute.get_shape(%lay_8526) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8527, %e1_8528, %e2_8529, %e3_8530 = cute.get_leaves(%3327) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8531 = cute.to_int_tuple(%e0_8527) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3328 = cute.get_scalars(%itup_8531) : !cute.int_tuple<"?">
      %itup_8532 = cute.to_int_tuple(%e1_8528) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3329 = cute.get_scalars(%itup_8532) : !cute.int_tuple<"?">
      %itup_8533 = cute.to_int_tuple(%e2_8529) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3330 = cute.get_scalars(%itup_8533) : !cute.int_tuple<"?">
      %itup_8534 = cute.to_int_tuple(%e3_8530) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3331 = cute.get_scalars(%itup_8534) : !cute.int_tuple<"?{div=8}">
      %coord_8535 = cute.make_coord(%e1_8523) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8536 = cute.make_coord(%itup_8532) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3332 = cute.get_scalars(%coord_8535) : !cute.coord<"?">
      %3333 = cute.get_scalars(%coord_8536) : !cute.coord<"?">
      %true_8537 = arith.constant true
      %3334 = arith.cmpi slt, %3332, %3333 : i32
      %3335 = arith.andi %true_8537, %3334 : i1
      scf.if %3335 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"80">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8538 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_8539 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8540 = cute.crd2idx(%coord_8538, %lay_8539) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_8541 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8542 = cute.add_offset(%iter_8541, %idx_8540) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8543 = cute.make_view(%tup_8542) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8544 = cute.get_iter(%view_8543) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8545, %e1_8546, %e2_8547, %e3_8548 = cute.get_leaves(%iter_8544) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3336 = cute.get_scalars(%e0_8545) : !cute.int_tuple<"?">
      %3337 = cute.get_scalars(%e1_8546) : !cute.int_tuple<"?">
      %3338 = cute.get_scalars(%e2_8547) : !cute.int_tuple<"?">
      %3339 = cute.get_scalars(%e3_8548) : !cute.int_tuple<"?{div=8}">
      %iter_8549 = cute.get_iter(%view_8543) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8550, %e1_8551, %e2_8552, %e3_8553 = cute.get_leaves(%iter_8549) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3340 = cute.get_scalars(%e0_8550) : !cute.int_tuple<"?">
      %3341 = cute.get_scalars(%e1_8551) : !cute.int_tuple<"?">
      %3342 = cute.get_scalars(%e2_8552) : !cute.int_tuple<"?">
      %3343 = cute.get_scalars(%e3_8553) : !cute.int_tuple<"?{div=8}">
      %iter_8554 = cute.get_iter(%view_8543) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8555, %e1_8556, %e2_8557, %e3_8558 = cute.get_leaves(%iter_8554) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3344 = cute.get_scalars(%e0_8555) : !cute.int_tuple<"?">
      %3345 = cute.get_scalars(%e1_8556) : !cute.int_tuple<"?">
      %3346 = cute.get_scalars(%e2_8557) : !cute.int_tuple<"?">
      %3347 = cute.get_scalars(%e3_8558) : !cute.int_tuple<"?{div=8}">
      %lay_8559 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3348 = cute.get_shape(%lay_8559) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8560, %e1_8561, %e2_8562, %e3_8563 = cute.get_leaves(%3348) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8564 = cute.to_int_tuple(%e0_8560) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3349 = cute.get_scalars(%itup_8564) : !cute.int_tuple<"?">
      %itup_8565 = cute.to_int_tuple(%e1_8561) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3350 = cute.get_scalars(%itup_8565) : !cute.int_tuple<"?">
      %itup_8566 = cute.to_int_tuple(%e2_8562) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3351 = cute.get_scalars(%itup_8566) : !cute.int_tuple<"?">
      %itup_8567 = cute.to_int_tuple(%e3_8563) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3352 = cute.get_scalars(%itup_8567) : !cute.int_tuple<"?{div=8}">
      %coord_8568 = cute.make_coord(%e1_8556) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8569 = cute.make_coord(%itup_8565) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3353 = cute.get_scalars(%coord_8568) : !cute.coord<"?">
      %3354 = cute.get_scalars(%coord_8569) : !cute.coord<"?">
      %true_8570 = arith.constant true
      %3355 = arith.cmpi slt, %3353, %3354 : i32
      %3356 = arith.andi %true_8570, %3355 : i1
      scf.if %3356 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"96">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_8571 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_8572 = cute.get_layout(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_8573 = cute.crd2idx(%coord_8571, %lay_8572) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_8574 = cute.get_iter(%view_8245) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_8575 = cute.add_offset(%iter_8574, %idx_8573) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_8576 = cute.make_view(%tup_8575) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_8577 = cute.get_iter(%view_8576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8578, %e1_8579, %e2_8580, %e3_8581 = cute.get_leaves(%iter_8577) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3357 = cute.get_scalars(%e0_8578) : !cute.int_tuple<"?">
      %3358 = cute.get_scalars(%e1_8579) : !cute.int_tuple<"?">
      %3359 = cute.get_scalars(%e2_8580) : !cute.int_tuple<"?">
      %3360 = cute.get_scalars(%e3_8581) : !cute.int_tuple<"?{div=8}">
      %iter_8582 = cute.get_iter(%view_8576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8583, %e1_8584, %e2_8585, %e3_8586 = cute.get_leaves(%iter_8582) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3361 = cute.get_scalars(%e0_8583) : !cute.int_tuple<"?">
      %3362 = cute.get_scalars(%e1_8584) : !cute.int_tuple<"?">
      %3363 = cute.get_scalars(%e2_8585) : !cute.int_tuple<"?">
      %3364 = cute.get_scalars(%e3_8586) : !cute.int_tuple<"?{div=8}">
      %iter_8587 = cute.get_iter(%view_8576) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_8588, %e1_8589, %e2_8590, %e3_8591 = cute.get_leaves(%iter_8587) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %3365 = cute.get_scalars(%e0_8588) : !cute.int_tuple<"?">
      %3366 = cute.get_scalars(%e1_8589) : !cute.int_tuple<"?">
      %3367 = cute.get_scalars(%e2_8590) : !cute.int_tuple<"?">
      %3368 = cute.get_scalars(%e3_8591) : !cute.int_tuple<"?{div=8}">
      %lay_8592 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %3369 = cute.get_shape(%lay_8592) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_8593, %e1_8594, %e2_8595, %e3_8596 = cute.get_leaves(%3369) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_8597 = cute.to_int_tuple(%e0_8593) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3370 = cute.get_scalars(%itup_8597) : !cute.int_tuple<"?">
      %itup_8598 = cute.to_int_tuple(%e1_8594) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3371 = cute.get_scalars(%itup_8598) : !cute.int_tuple<"?">
      %itup_8599 = cute.to_int_tuple(%e2_8595) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %3372 = cute.get_scalars(%itup_8599) : !cute.int_tuple<"?">
      %itup_8600 = cute.to_int_tuple(%e3_8596) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %3373 = cute.get_scalars(%itup_8600) : !cute.int_tuple<"?{div=8}">
      %coord_8601 = cute.make_coord(%e1_8589) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_8602 = cute.make_coord(%itup_8598) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %3374 = cute.get_scalars(%coord_8601) : !cute.coord<"?">
      %3375 = cute.get_scalars(%coord_8602) : !cute.coord<"?">
      %true_8603 = arith.constant true
      %3376 = arith.cmpi slt, %3374, %3375 : i32
      %3377 = arith.andi %true_8603, %3376 : i1
      scf.if %3377 {
        %coord_8604 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8605 = cute.get_layout(%rmem_8108) : !memref_rmem_bf16_27
        %idx_8606 = cute.crd2idx(%coord_8604, %lay_8605) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"112">
        %iter_8607 = cute.get_iter(%rmem_8108) : !memref_rmem_bf16_27
        %ptr_8608 = cute.add_offset(%iter_8607, %idx_8606) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_8609 = cute.make_view(%ptr_8608) : !memref_rmem_bf16_29
        %iter_8610 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %iter_8611 = cute.get_iter(%view_8609) : !memref_rmem_bf16_29
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8613 = cute.get_layout(%view_8104) : !memref_gmem_bf16_4
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_8615 = cute.get_iter(%view_8104) : !memref_gmem_bf16_4
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_gmem_bf16_6
        %iter_8618 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %iter_8619 = cute.get_iter(%view_8617) : !memref_gmem_bf16_6
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_8621 = cute.get_layout(%rmem_8259) : !memref_rmem_i8_
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_8623 = cute.get_iter(%rmem_8259) : !memref_rmem_i8_
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_i8_2
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_i8_2
        %lay_8628 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %3378 = cute.get_shape(%lay_8628) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8629, %e1_8630, %e2_8631 = cute.get_leaves(%3378) : !cute.shape<"((8,1),2)">
        %lay_8632 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %3379 = cute.get_shape(%lay_8632) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8633, %e1_8634, %e2_8635 = cute.get_leaves(%3379) : !cute.shape<"((8,1),2)">
        %lay_8636 = cute.get_layout(%view_8609) : !memref_rmem_bf16_29
        %shape_8637 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8638 = cute.make_layout() : !cute.layout<"1:0">
        %append_8639 = cute.append_to_rank<2> (%lay_8636, %lay_8638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8640 = cute.make_view(%iter_8611, %append_8639) : !memref_rmem_bf16_29
        %iter_8641 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %lay_8642 = cute.get_layout(%view_8640) : !memref_rmem_bf16_29
        %3380 = cute.get_shape(%lay_8642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8643, %e1_8644, %e2_8645 = cute.get_leaves(%3380) : !cute.shape<"((8,1),2)">
        %iter_8646 = cute.get_iter(%view_8640) : !memref_rmem_bf16_29
        %view_8647 = cute.make_view(%iter_8646) : !memref_rmem_bf16_30
        %iter_8648 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8649 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %lay_8650 = cute.get_layout(%view_8617) : !memref_gmem_bf16_6
        %shape_8651 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8652 = cute.make_layout() : !cute.layout<"1:0">
        %append_8653 = cute.append_to_rank<2> (%lay_8650, %lay_8652) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_8654 = cute.make_view(%iter_8619, %append_8653) : !memref_gmem_bf16_6
        %iter_8655 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %lay_8656 = cute.get_layout(%view_8654) : !memref_gmem_bf16_6
        %3381 = cute.get_shape(%lay_8656) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_8657, %e1_8658, %e2_8659 = cute.get_leaves(%3381) : !cute.shape<"((8,1),2)">
        %iter_8660 = cute.get_iter(%view_8654) : !memref_gmem_bf16_6
        %view_8661 = cute.make_view(%iter_8660) : !memref_gmem_bf16_7
        %iter_8662 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %iter_8663 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8664 = cute.get_layout(%view_8625) : !memref_rmem_i8_2
        %shape_8665 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8666 = cute.make_layout() : !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8664, %lay_8666) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_8668 = cute.make_view(%iter_8627, %append_8667) : !memref_rmem_i8_2
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %lay_8670 = cute.get_layout(%view_8668) : !memref_rmem_i8_2
        %3382 = cute.get_shape(%lay_8670) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_8671, %e1_8672 = cute.get_leaves(%3382) : !cute.shape<"(1,2)">
        %iter_8673 = cute.get_iter(%view_8668) : !memref_rmem_i8_2
        %view_8674 = cute.make_view(%iter_8673) : !memref_rmem_i8_3
        %iter_8675 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %iter_8676 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8677 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %3383 = cute.get_shape(%lay_8677) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8678, %e1_8679, %e2_8680 = cute.get_leaves(%3383) : !cute.shape<"((8,1),(2))">
        %lay_8681 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %3384 = cute.get_shape(%lay_8681) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_8682, %e1_8683, %e2_8684 = cute.get_leaves(%3384) : !cute.shape<"((8,1),(2))">
        %lay_8685 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %sz_8686 = cute.size(%lay_8685) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8687 = cute.get_leaves(%sz_8686) : !cute.int_tuple<"2">
        %lay_8688 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %sz_8689 = cute.size(%lay_8688) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_8690 = cute.get_leaves(%sz_8689) : !cute.int_tuple<"2">
        %3385 = cute.static : !cute.layout<"1:0">
        %iter_8691 = cute.get_iter(%view_8647) : !memref_rmem_bf16_30
        %iter_8692 = cute.get_iter(%view_8661) : !memref_gmem_bf16_7
        %lay_8693 = cute.get_layout(%view_8647) : !memref_rmem_bf16_30
        %lay_8694 = cute.get_layout(%view_8661) : !memref_gmem_bf16_7
        %append_8695 = cute.append_to_rank<2> (%lay_8693, %3385) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8694, %3385) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_8697 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_8698 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_8699 = cute.get_iter(%view_8674) : !memref_rmem_i8_3
        %lay_8700 = cute.get_layout(%view_8674) : !memref_rmem_i8_3
        %append_8701 = cute.append_to_rank<2> (%lay_8700, %3385) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_8702 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_8703 = cute.size(%lay_8697) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %3386 = cute.get_scalars(%sz_8703) : !cute.int_tuple<"2">
        %c0_i32_8704 = arith.constant 0 : i32
        %c1_i32_8705 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_8704 to %3386 step %c1_i32_8705  : i32 {
          %coord_8706 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %3387 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8707 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8708 = cute.crd2idx(%coord_8706, %lay_8697) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_8709 = cute.add_offset(%iter_8691, %idx_8708) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_8710 = cute.make_view(%ptr_8709, %lay_8707) : !memref_rmem_bf16_8
          %3388 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8711 = cute.make_layout() : !cute.layout<"((8,1)):((1,0))">
          %idx_8712 = cute.crd2idx(%coord_8706, %lay_8698) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_8713 = cute.add_offset(%iter_8692, %idx_8712) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_8714 = cute.make_view(%ptr_8713, %lay_8711) : !memref_gmem_bf16_8
          %3389 = cute.get_scalars(%coord_8706) <{only_dynamic}> : !cute.coord<"(_,?)">
          %lay_8715 = cute.make_layout() : !cute.layout<"(1):(2)">
          %idx_8716 = cute.crd2idx(%coord_8706, %lay_8702) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_8717 = cute.add_offset(%iter_8699, %idx_8716) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_8718 = cute.make_view(%ptr_8717, %lay_8715) : !memref_rmem_i8_4
          %iter_8719 = cute.get_iter(%view_8710) : !memref_rmem_bf16_8
          %iter_8720 = cute.get_iter(%view_8714) : !memref_gmem_bf16_8
          %iter_8721 = cute.get_iter(%view_8718) : !memref_rmem_i8_4
          %3390 = builtin.unrealized_conversion_cast %iter_8721 : !cute.ptr<i8, rmem> to !llvm.ptr
          %3391 = llvm.load %3390 : !llvm.ptr -> i8
          %3392 = llvm.mlir.constant(0 : i8) : i8
          %3393 = llvm.icmp "ne" %3391, %3392 : i8
          scf.if %3393 {
            %3394 = builtin.unrealized_conversion_cast %iter_8719 : !cute.ptr<bf16, rmem, align<16>> to !llvm.ptr
            %3395 = builtin.unrealized_conversion_cast %iter_8720 : !cute.ptr<bf16, gmem, align<16>> to !llvm.ptr<1>
            %3396 = llvm.load %3394 {alignment = 16 : i64} : !llvm.ptr -> vector<8xbf16>
            llvm.store %3396, %3395 {alignment = 16 : i64} : vector<8xbf16>, !llvm.ptr<1>
          }
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32, %arg5: !cuda.stream) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %36 = cute.static : !cute.swizzle<"S<3,3,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_65 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)">
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %38 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %39 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %cosz = cute.cosize(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384">
    %e0_73 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384">
    %cosz_74 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_75 = cute.get_leaves(%cosz_74) : !cute.int_tuple<"8192">
    %cosz_76 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_77 = cute.get_leaves(%cosz_76) : !cute.int_tuple<"8192">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>
    %atom_78 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %40 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %41 = cute.get_shape(%40) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_79, %e1_80 = cute.get_leaves(%41) : !cute.shape<"(8,64)">
    %shape_81 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_82 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_84 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_85 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %lay_86 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_87 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_88 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_89 = cute.get_leaves(%sz_88) : !cute.int_tuple<"8">
    %shape_90 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_91 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%lay_86) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_92 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %42 = cute.get_shape(%lay_86) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_93, %e1_94, %e2_95 = cute.get_leaves(%42) : !cute.shape<"(16,(8,8))">
    %int_tuple_96 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_97 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_98, %e1_99 = cute.get_leaves(%int_tuple_97) : !cute.int_tuple<"(16,64)">
    %int_tuple_100 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_101 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_102, %e1_103 = cute.get_leaves(%int_tuple_101) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %43 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %lay_104 = cute.make_layout() : !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_105 = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"128">
    %sz_107 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_108 = cute.get_leaves(%sz_107) : !cute.int_tuple<"8">
    %shape_109 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_110 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_111 = cute.right_inverse(%lay_104) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_112 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %44 = cute.get_shape(%lay_104) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_113, %e1_114, %e2_115 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))">
    %int_tuple_116 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_118, %e1_119 = cute.get_leaves(%int_tuple_117) : !cute.int_tuple<"(16,64)">
    %int_tuple_120 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %int_tuple_121 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %e0_122, %e1_123 = cute.get_leaves(%int_tuple_121) : !cute.int_tuple<"(16,64)">
    %tile_124 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %45 = cute.make_tiled_copy(%atom_78) : !copy_simt
    %shape_125 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_126 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_127 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_128 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %46 = cute.get_shape(%lay_128) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_129, %e1_130, %e2_131 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)">
    %tile_132 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %47 = cute.make_tiled_mma(%atom_126) : !mma_bf16_bf16_f32_16x8x16_
    %lay_133 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %48 = cute.get_shape(%lay_133) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_134, %e1_135, %e2_136, %e3_137 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_138 = cute.to_int_tuple(%e0_134) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %49 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?">
    %itup_139 = cute.to_int_tuple(%e1_135) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %50 = cute.get_scalars(%itup_139) : !cute.int_tuple<"?">
    %itup_140 = cute.to_int_tuple(%e2_136) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %51 = cute.get_scalars(%itup_140) : !cute.int_tuple<"?">
    %itup_141 = cute.to_int_tuple(%e3_137) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %52 = cute.get_scalars(%itup_141) : !cute.int_tuple<"?{div=8}">
    %int_tuple_142 = cute.make_int_tuple(%itup_139) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_143 = cute.make_tile() : () -> !cute.tile<"128:1">
    %53 = cute.get_scalars(%int_tuple_142) <{only_dynamic}> : !cute.int_tuple<"?">
    %c128_i32 = arith.constant 128 : i32
    %54 = arith.ceildivsi %53, %c128_i32 : i32
    %int_tuple_144 = cute.make_int_tuple(%54) : (i32) -> !cute.int_tuple<"?">
    %e0_145 = cute.get_leaves(%int_tuple_144) : !cute.int_tuple<"?">
    %55 = cute.get_scalars(%e0_145) : !cute.int_tuple<"?">
    %int_tuple_146 = cute.make_int_tuple(%itup_138) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_147 = cute.size(%int_tuple_146) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_148 = cute.get_leaves(%sz_147) : !cute.int_tuple<"?">
    %56 = cute.get_scalars(%e0_148) : !cute.int_tuple<"?">
    %int_tuple_149 = cute.make_int_tuple(%itup_140) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_150 = cute.size(%int_tuple_149) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_151 = cute.get_leaves(%sz_150) : !cute.int_tuple<"?">
    %57 = cute.get_scalars(%e0_151) : !cute.int_tuple<"?">
    %cst = arith.constant 1.44269502 : f32
    %58 = arith.mulf %arg4, %cst : f32
    %lay_152 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %59 = cute.get_shape(%lay_152) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_153, %e1_154, %e2_155, %e3_156 = cute.get_leaves(%59) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_157 = cute.to_int_tuple(%e0_153) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_157) : !cute.int_tuple<"?">
    %itup_158 = cute.to_int_tuple(%e1_154) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?">
    %itup_159 = cute.to_int_tuple(%e2_155) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %62 = cute.get_scalars(%itup_159) : !cute.int_tuple<"?">
    %itup_160 = cute.to_int_tuple(%e3_156) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %63 = cute.get_scalars(%itup_160) : !cute.int_tuple<"?{div=8}">
    %64 = cute.get_stride(%lay_152) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_161, %e1_162, %e2_163, %e3_164 = cute.get_leaves(%64) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_165 = cute.to_int_tuple(%e0_161) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %65 = cute.get_scalars(%itup_165) : !cute.int_tuple<"?{i64 div=8}">
    %itup_166 = cute.to_int_tuple(%e1_162) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %66 = cute.get_scalars(%itup_166) : !cute.int_tuple<"?{i64 div=8}">
    %itup_167 = cute.to_int_tuple(%e2_163) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %67 = cute.get_scalars(%itup_167) : !cute.int_tuple<"?{i64 div=8}">
    %lay_168 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %68 = cute.get_shape(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_169, %e1_170, %e2_171, %e3_172 = cute.get_leaves(%68) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_173 = cute.to_int_tuple(%e0_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e1_170) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %70 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?">
    %itup_175 = cute.to_int_tuple(%e2_171) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %71 = cute.get_scalars(%itup_175) : !cute.int_tuple<"?">
    %itup_176 = cute.to_int_tuple(%e3_172) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %72 = cute.get_scalars(%itup_176) : !cute.int_tuple<"?{div=8}">
    %73 = cute.get_stride(%lay_168) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_177, %e1_178, %e2_179, %e3_180 = cute.get_leaves(%73) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_181 = cute.to_int_tuple(%e0_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %itup_182 = cute.to_int_tuple(%e1_178) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %75 = cute.get_scalars(%itup_182) : !cute.int_tuple<"?{i64 div=8}">
    %itup_183 = cute.to_int_tuple(%e2_179) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %76 = cute.get_scalars(%itup_183) : !cute.int_tuple<"?{i64 div=8}">
    %lay_184 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %77 = cute.get_shape(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_185, %e1_186, %e2_187, %e3_188 = cute.get_leaves(%77) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_189 = cute.to_int_tuple(%e0_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e1_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %79 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
    %itup_191 = cute.to_int_tuple(%e2_187) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %80 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?">
    %itup_192 = cute.to_int_tuple(%e3_188) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %81 = cute.get_scalars(%itup_192) : !cute.int_tuple<"?{div=8}">
    %82 = cute.get_stride(%lay_184) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_193, %e1_194, %e2_195, %e3_196 = cute.get_leaves(%82) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_197 = cute.to_int_tuple(%e0_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %itup_198 = cute.to_int_tuple(%e1_194) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %84 = cute.get_scalars(%itup_198) : !cute.int_tuple<"?{i64 div=8}">
    %itup_199 = cute.to_int_tuple(%e2_195) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %85 = cute.get_scalars(%itup_199) : !cute.int_tuple<"?{i64 div=8}">
    %lay_200 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %86 = cute.get_shape(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_201, %e1_202, %e2_203, %e3_204 = cute.get_leaves(%86) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_205 = cute.to_int_tuple(%e0_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e1_202) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %88 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?">
    %itup_207 = cute.to_int_tuple(%e2_203) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %89 = cute.get_scalars(%itup_207) : !cute.int_tuple<"?">
    %itup_208 = cute.to_int_tuple(%e3_204) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %90 = cute.get_scalars(%itup_208) : !cute.int_tuple<"?{div=8}">
    %91 = cute.get_stride(%lay_200) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_209, %e1_210, %e2_211, %e3_212 = cute.get_leaves(%91) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_213 = cute.to_int_tuple(%e0_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %itup_214 = cute.to_int_tuple(%e1_210) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %93 = cute.get_scalars(%itup_214) : !cute.int_tuple<"?{i64 div=8}">
    %itup_215 = cute.to_int_tuple(%e2_211) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %94 = cute.get_scalars(%itup_215) : !cute.int_tuple<"?{i64 div=8}">
    %95 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %96 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_216 = cute.get_leaves(%96) : !cute.int_tuple<"0">
    %97 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %98 = cute.get_shape(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%98) : !cute.shape<"((8,16),(64,2))">
    %99 = cute.get_stride(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_221, %e1_222, %e2_223, %e3_224 = cute.get_leaves(%99) : !cute.stride<"((64,512),(1,8192))">
    %100 = cute.composed_get_inner(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
    %101 = cute.composed_get_offset(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_225 = cute.get_leaves(%101) : !cute.int_tuple<"0">
    %102 = cute.composed_get_outer(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %103 = cute.get_shape(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_226, %e1_227, %e2_228, %e3_229 = cute.get_leaves(%103) : !cute.shape<"((8,8),(64,2))">
    %104 = cute.get_stride(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_230, %e1_231, %e2_232, %e3_233 = cute.get_leaves(%104) : !cute.stride<"((64,512),(1,4096))">
    %105 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %106 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_234 = cute.get_leaves(%106) : !cute.int_tuple<"0">
    %107 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %108 = cute.get_shape(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_235, %e1_236, %e2_237, %e3_238 = cute.get_leaves(%108) : !cute.shape<"((8,16),(64,2))">
    %109 = cute.get_stride(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_239, %e1_240, %e2_241, %e3_242 = cute.get_leaves(%109) : !cute.stride<"((64,512),(1,8192))">
    %110 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_243, %e1_244 = cute.get_leaves(%110) : !cute.tile<"[16:1;64:1]">
    %111 = cute.get_shape(%e0_243) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_245 = cute.get_leaves(%111) : !cute.shape<"16">
    %112 = cute.get_stride(%e0_243) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_246 = cute.get_leaves(%112) : !cute.stride<"1">
    %113 = cute.get_shape(%e1_244) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_247 = cute.get_leaves(%113) : !cute.shape<"64">
    %114 = cute.get_stride(%e1_244) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_248 = cute.get_leaves(%114) : !cute.stride<"1">
    %115 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %116 = cute.get_shape(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_249, %e1_250, %e2_251 = cute.get_leaves(%116) : !cute.shape<"((8,16),8)">
    %117 = cute.get_stride(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_252, %e1_253, %e2_254 = cute.get_leaves(%117) : !cute.stride<"((128,1),16)">
    %118 = cute.static : !cute.layout<"1:0">
    %119 = cute.get_shape(%118) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_255 = cute.get_leaves(%119) : !cute.shape<"1">
    %120 = cute.get_stride(%118) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_256 = cute.get_leaves(%120) : !cute.stride<"0">
    %121 = cute.static : !cute.layout<"(1,8):(0,1)">
    %122 = cute.get_shape(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_257, %e1_258 = cute.get_leaves(%122) : !cute.shape<"(1,8)">
    %123 = cute.get_stride(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_259, %e1_260 = cute.get_leaves(%123) : !cute.stride<"(0,1)">
    %124 = cute.static : !cute.layout<"(1,8):(0,1)">
    %125 = cute.get_shape(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_261, %e1_262 = cute.get_leaves(%125) : !cute.shape<"(1,8)">
    %126 = cute.get_stride(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_263, %e1_264 = cute.get_leaves(%126) : !cute.stride<"(0,1)">
    %127 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_265, %e1_266 = cute.get_leaves(%127) : !cute.tile<"[16:1;64:1]">
    %128 = cute.get_shape(%e0_265) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_267 = cute.get_leaves(%128) : !cute.shape<"16">
    %129 = cute.get_stride(%e0_265) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_268 = cute.get_leaves(%129) : !cute.stride<"1">
    %130 = cute.get_shape(%e1_266) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_269 = cute.get_leaves(%130) : !cute.shape<"64">
    %131 = cute.get_stride(%e1_266) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_270 = cute.get_leaves(%131) : !cute.stride<"1">
    %132 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %133 = cute.get_shape(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_271, %e1_272, %e2_273 = cute.get_leaves(%133) : !cute.shape<"((8,16),8)">
    %134 = cute.get_stride(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_274, %e1_275, %e2_276 = cute.get_leaves(%134) : !cute.stride<"((128,1),16)">
    %135 = cute.static : !cute.layout<"1:0">
    %136 = cute.get_shape(%135) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_277 = cute.get_leaves(%136) : !cute.shape<"1">
    %137 = cute.get_stride(%135) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_278 = cute.get_leaves(%137) : !cute.stride<"0">
    %138 = cute.static : !cute.layout<"(1,8):(0,1)">
    %139 = cute.get_shape(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_279, %e1_280 = cute.get_leaves(%139) : !cute.shape<"(1,8)">
    %140 = cute.get_stride(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_281, %e1_282 = cute.get_leaves(%140) : !cute.stride<"(0,1)">
    %141 = cute.static : !cute.layout<"(1,8):(0,1)">
    %142 = cute.get_shape(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_283, %e1_284 = cute.get_leaves(%142) : !cute.shape<"(1,8)">
    %143 = cute.get_stride(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_285, %e1_286 = cute.get_leaves(%143) : !cute.stride<"(0,1)">
    %144 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %145 = cute.get_shape(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_287, %e1_288, %e2_289, %e3_290 = cute.get_leaves(%145) : !cute.shape<"(32,4,1,1)">
    %146 = cute.get_stride(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_291, %e1_292, %e2_293, %e3_294 = cute.get_leaves(%146) : !cute.stride<"(1,32,0,0)">
    %147 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_295, %e1_296, %e2_297 = cute.get_leaves(%147) : !cute.tile<"[64:1;16:1;16:1]">
    %148 = cute.get_shape(%e0_295) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_298 = cute.get_leaves(%148) : !cute.shape<"64">
    %149 = cute.get_stride(%e0_295) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_299 = cute.get_leaves(%149) : !cute.stride<"1">
    %150 = cute.get_shape(%e1_296) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_300 = cute.get_leaves(%150) : !cute.shape<"16">
    %151 = cute.get_stride(%e1_296) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_301 = cute.get_leaves(%151) : !cute.stride<"1">
    %152 = cute.get_shape(%e2_297) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_302 = cute.get_leaves(%152) : !cute.shape<"16">
    %153 = cute.get_stride(%e2_297) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_303 = cute.get_leaves(%153) : !cute.stride<"1">
    %154 = cute.static : !cute.layout<"32:1">
    %155 = cute.get_shape(%154) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_304 = cute.get_leaves(%155) : !cute.shape<"32">
    %156 = cute.get_stride(%154) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_305 = cute.get_leaves(%156) : !cute.stride<"1">
    %157 = cute.static : !cute.shape<"(16,8,16)">
    %e0_306, %e1_307, %e2_308 = cute.get_leaves(%157) : !cute.shape<"(16,8,16)">
    %158 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %159 = cute.get_shape(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_309, %e1_310, %e2_311, %e3_312, %e4 = cute.get_leaves(%159) : !cute.shape<"((4,8),(2,2,2))">
    %160 = cute.get_stride(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_313, %e1_314, %e2_315, %e3_316, %e4_317 = cute.get_leaves(%160) : !cute.stride<"((32,1),(16,8,128))">
    %161 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %162 = cute.get_shape(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_318, %e1_319, %e2_320, %e3_321 = cute.get_leaves(%162) : !cute.shape<"((4,8),(2,2))">
    %163 = cute.get_stride(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_322, %e1_323, %e2_324, %e3_325 = cute.get_leaves(%163) : !cute.stride<"((16,1),(8,64))">
    %164 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %165 = cute.get_shape(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%165) : !cute.shape<"((4,8),(2,2))">
    %166 = cute.get_stride(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_330, %e1_331, %e2_332, %e3_333 = cute.get_leaves(%166) : !cute.stride<"((32,1),(16,8))">
    %c65536_i32 = arith.constant 65536 : i32
    %167 = arith.extsi %c65536_i32 : i32 to i64
    %c128_i32_334 = arith.constant 128 : i32
    %c1_i32 = arith.constant 1 : i32
    %168 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32_334, %c1_i32, %c1_i32), dynamicSmemBytes = %167, gridDim = (%55, %56, %57), stream = %arg5) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2>
    %169 = cuda.launch_ex @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0<%168> (%arg0, %arg1, %arg2, %arg3, %58) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, f32) -> !cuda.result
    %170 = cuda.cast %169 : !cuda.result -> i32
    cuda.return_if_error %170 : i32
    %c0_i32 = arith.constant 0 : i32
    return %c0_i32 : i32
  }
}
