!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "(((2,2),2)):(((1,2),8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<8>, "((1,(4,2))):((0,(1,8)))">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<32>, "(4):(1)">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_11 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_12 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_5 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2))):((0,(1,512,?{div=8})))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %1 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %3 = cute.static : !copy_ldgsts
      %4 = cute.static : !copy_simt
      %5 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %6 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%6) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %7 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %10 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
      %11 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%11) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %12 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %15 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%15) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %16 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %19 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
      %20 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%20) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %21 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %24 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%24) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %25 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %28 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
      %29 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%29) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %30 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %33 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%33) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %34 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %37 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
      %38 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%38) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %39 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %43 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_65 = cute.get_leaves(%43) : !cute.int_tuple<"0">
      %44 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %45 = cute.get_shape(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%45) : !cute.shape<"((8,16),(64,2))">
      %46 = cute.get_stride(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%46) : !cute.stride<"((64,512),(1,8192))">
      %47 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
      %48 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_74 = cute.get_leaves(%48) : !cute.int_tuple<"0">
      %49 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %50 = cute.get_shape(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%50) : !cute.shape<"((8,8),(64,2))">
      %51 = cute.get_stride(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%51) : !cute.stride<"((64,512),(1,4096))">
      %52 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %53 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,16),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,8192))">
      %57 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_92, %e1_93 = cute.get_leaves(%57) : !cute.tile<"[16:1;64:1]">
      %58 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_94 = cute.get_leaves(%58) : !cute.shape<"16">
      %59 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_95 = cute.get_leaves(%59) : !cute.stride<"1">
      %60 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_96 = cute.get_leaves(%60) : !cute.shape<"64">
      %61 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_97 = cute.get_leaves(%61) : !cute.stride<"1">
      %62 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %63 = cute.get_shape(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%63) : !cute.shape<"((8,16),8)">
      %64 = cute.get_stride(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%64) : !cute.stride<"((128,1),16)">
      %65 = cute.static : !cute.layout<"1:0">
      %66 = cute.get_shape(%65) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_104 = cute.get_leaves(%66) : !cute.shape<"1">
      %67 = cute.get_stride(%65) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_105 = cute.get_leaves(%67) : !cute.stride<"0">
      %68 = cute.static : !cute.layout<"(1,8):(0,1)">
      %69 = cute.get_shape(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_106, %e1_107 = cute.get_leaves(%69) : !cute.shape<"(1,8)">
      %70 = cute.get_stride(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_108, %e1_109 = cute.get_leaves(%70) : !cute.stride<"(0,1)">
      %71 = cute.static : !cute.layout<"(1,8):(0,1)">
      %72 = cute.get_shape(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_110, %e1_111 = cute.get_leaves(%72) : !cute.shape<"(1,8)">
      %73 = cute.get_stride(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_112, %e1_113 = cute.get_leaves(%73) : !cute.stride<"(0,1)">
      %74 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_114, %e1_115 = cute.get_leaves(%74) : !cute.tile<"[16:1;64:1]">
      %75 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_116 = cute.get_leaves(%75) : !cute.shape<"16">
      %76 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_117 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_118 = cute.get_leaves(%77) : !cute.shape<"64">
      %78 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_119 = cute.get_leaves(%78) : !cute.stride<"1">
      %79 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %80 = cute.get_shape(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%80) : !cute.shape<"((8,16),8)">
      %81 = cute.get_stride(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%81) : !cute.stride<"((128,1),16)">
      %82 = cute.static : !cute.layout<"1:0">
      %83 = cute.get_shape(%82) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_126 = cute.get_leaves(%83) : !cute.shape<"1">
      %84 = cute.get_stride(%82) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_127 = cute.get_leaves(%84) : !cute.stride<"0">
      %85 = cute.static : !cute.layout<"(1,8):(0,1)">
      %86 = cute.get_shape(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_128, %e1_129 = cute.get_leaves(%86) : !cute.shape<"(1,8)">
      %87 = cute.get_stride(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_130, %e1_131 = cute.get_leaves(%87) : !cute.stride<"(0,1)">
      %88 = cute.static : !cute.layout<"(1,8):(0,1)">
      %89 = cute.get_shape(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_132, %e1_133 = cute.get_leaves(%89) : !cute.shape<"(1,8)">
      %90 = cute.get_stride(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_134, %e1_135 = cute.get_leaves(%90) : !cute.stride<"(0,1)">
      %91 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %92 = cute.get_shape(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%92) : !cute.shape<"(32,4,1,1)">
      %93 = cute.get_stride(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%93) : !cute.stride<"(1,32,0,0)">
      %94 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%94) : !cute.tile<"[64:1;16:1;16:1]">
      %95 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_147 = cute.get_leaves(%95) : !cute.shape<"64">
      %96 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_148 = cute.get_leaves(%96) : !cute.stride<"1">
      %97 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_149 = cute.get_leaves(%97) : !cute.shape<"16">
      %98 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_150 = cute.get_leaves(%98) : !cute.stride<"1">
      %99 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_151 = cute.get_leaves(%99) : !cute.shape<"16">
      %100 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_152 = cute.get_leaves(%100) : !cute.stride<"1">
      %101 = cute.static : !cute.layout<"32:1">
      %102 = cute.get_shape(%101) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_153 = cute.get_leaves(%102) : !cute.shape<"32">
      %103 = cute.get_stride(%101) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_154 = cute.get_leaves(%103) : !cute.stride<"1">
      %104 = cute.static : !cute.shape<"(16,8,16)">
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%104) : !cute.shape<"(16,8,16)">
      %105 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2,2))">
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8,128))">
      %108 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %109 = cute.get_shape(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%109) : !cute.shape<"((4,8),(2,2))">
      %110 = cute.get_stride(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%110) : !cute.stride<"((16,1),(8,64))">
      %111 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %112 = cute.get_shape(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%112) : !cute.shape<"((4,8),(2,2))">
      %113 = cute.get_stride(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%113) : !cute.stride<"((32,1),(16,8))">
      %114 = nvvm.read.ptx.sreg.tid.x : i32
      %115 = nvvm.read.ptx.sreg.tid.y : i32
      %116 = nvvm.read.ptx.sreg.tid.z : i32
      %117 = nvvm.read.ptx.sreg.ctaid.x : i32
      %118 = nvvm.read.ptx.sreg.ctaid.y : i32
      %119 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %120 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%120) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %121 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %122 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %123 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %124 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %125 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %126 = arith.ceildivsi %125, %c64_i32 : i32
      %int_tuple_192 = cute.make_int_tuple(%126) : (i32) -> !cute.int_tuple<"?">
      %e0_193 = cute.get_leaves(%int_tuple_192) : !cute.int_tuple<"?">
      %127 = cute.get_scalars(%e0_193) : !cute.int_tuple<"?">
      %false = arith.constant false
      %128 = scf.if %false -> (i32) {
        %c1_i32_7829 = arith.constant 1 : i32
        %2493 = arith.addi %117, %c1_i32_7829 : i32
        %c128_i32_7830 = arith.constant 128 : i32
        %2494 = arith.muli %2493, %c128_i32_7830 : i32
        %int_tuple_7831 = cute.make_int_tuple(%2494) : (i32) -> !cute.int_tuple<"?">
        %tile_7832 = cute.make_tile() : () -> !cute.tile<"64:1">
        %2495 = cute.get_scalars(%int_tuple_7831) <{only_dynamic}> : !cute.int_tuple<"?">
        %c64_i32_7833 = arith.constant 64 : i32
        %2496 = arith.ceildivsi %2495, %c64_i32_7833 : i32
        %int_tuple_7834 = cute.make_int_tuple(%2496) : (i32) -> !cute.int_tuple<"?">
        %e0_7835 = cute.get_leaves(%int_tuple_7834) : !cute.int_tuple<"?">
        %2497 = cute.get_scalars(%e0_7835) : !cute.int_tuple<"?">
        %2498 = arith.minsi %2497, %127 : i32
        scf.yield %2498 : i32
      } else {
        scf.yield %127 : i32
      }
      %c1_i32 = arith.constant 1 : i32
      %129 = arith.subi %128, %c1_i32 : i32
      %coord = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_194 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %slice = cute.slice(%lay_194, %coord) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx = cute.crd2idx(%coord, %lay_194) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_195 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_195, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %slice) : !memref_gmem_bf16_1
      %iter_196 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %iter_197 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_198 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_199 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %130 = cute.get_scalars(%coord_199) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_200 = cute.make_coord(%130) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_201 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %131:3 = cute.get_scalars(%lay_201) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32 = arith.constant 128 : i32
      %132 = arith.ceildivsi %131#0, %c128_i32 : i32
      %c128_i64 = arith.constant 128 : i64
      %133 = arith.muli %131#2, %c128_i64 : i64
      %c128_i32_202 = arith.constant 128 : i32
      %134 = arith.ceildivsi %131#1, %c128_i32_202 : i32
      %shape = cute.make_shape(%132, %134) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv = cute.assume(%131#2) : (i64) -> !cute.i64<divby 8>
      %iv_203 = cute.assume(%133) : (i64) -> !cute.i64<divby 1024>
      %stride = cute.make_stride(%iv, %iv_203) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_204 = cute.make_layout(%shape, %stride) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %slice_205 = cute.slice(%lay_204, %coord_200) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_206 = cute.crd2idx(%coord_200, %lay_204) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_207 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_208 = cute.add_offset(%iter_207, %idx_206) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_209 = cute.make_view(%ptr_208, %slice_205) : !memref_gmem_bf16_2
      %iter_210 = cute.get_iter(%view_209) : !memref_gmem_bf16_2
      %coord_211 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_212 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %slice_213 = cute.slice(%lay_212, %coord_211) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_214 = cute.crd2idx(%coord_211, %lay_212) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_215 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_216 = cute.add_offset(%iter_215, %idx_214) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_217 = cute.make_view(%ptr_216, %slice_213) : !memref_gmem_bf16_1
      %iter_218 = cute.get_iter(%view_217) : !memref_gmem_bf16_1
      %iter_219 = cute.get_iter(%view_217) : !memref_gmem_bf16_1
      %tile_220 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_221 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_222 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_223 = cute.get_layout(%view_217) : !memref_gmem_bf16_1
      %135:3 = cute.get_scalars(%lay_223) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_224 = arith.constant 64 : i32
      %136 = arith.ceildivsi %135#0, %c64_i32_224 : i32
      %c64_i64 = arith.constant 64 : i64
      %137 = arith.muli %135#2, %c64_i64 : i64
      %c128_i32_225 = arith.constant 128 : i32
      %138 = arith.ceildivsi %135#1, %c128_i32_225 : i32
      %shape_226 = cute.make_shape(%136, %138) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_227 = cute.assume(%135#2) : (i64) -> !cute.i64<divby 8>
      %iv_228 = cute.assume(%137) : (i64) -> !cute.i64<divby 512>
      %stride_229 = cute.make_stride(%iv_227, %iv_228) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_230 = cute.make_layout(%shape_226, %stride_229) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_231 = cute.slice(%lay_230, %coord_222) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_232 = cute.crd2idx(%coord_222, %lay_230) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_233 = cute.get_iter(%view_217) : !memref_gmem_bf16_1
      %ptr_234 = cute.add_offset(%iter_233, %idx_232) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_235 = cute.make_view(%ptr_234, %slice_231) : !memref_gmem_bf16_3
      %iter_236 = cute.get_iter(%view_235) : !memref_gmem_bf16_3
      %coord_237 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_238 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %slice_239 = cute.slice(%lay_238, %coord_237) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_240 = cute.crd2idx(%coord_237, %lay_238) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_241 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_242 = cute.add_offset(%iter_241, %idx_240) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_243 = cute.make_view(%ptr_242, %slice_239) : !memref_gmem_bf16_1
      %iter_244 = cute.get_iter(%view_243) : !memref_gmem_bf16_1
      %iter_245 = cute.get_iter(%view_243) : !memref_gmem_bf16_1
      %tile_246 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_247 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_248 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_249 = cute.get_layout(%view_243) : !memref_gmem_bf16_1
      %139:3 = cute.get_scalars(%lay_249) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_250 = arith.constant 64 : i32
      %140 = arith.ceildivsi %139#0, %c64_i32_250 : i32
      %c64_i64_251 = arith.constant 64 : i64
      %141 = arith.muli %139#2, %c64_i64_251 : i64
      %c128_i32_252 = arith.constant 128 : i32
      %142 = arith.ceildivsi %139#1, %c128_i32_252 : i32
      %shape_253 = cute.make_shape(%140, %142) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_254 = cute.assume(%139#2) : (i64) -> !cute.i64<divby 8>
      %iv_255 = cute.assume(%141) : (i64) -> !cute.i64<divby 512>
      %stride_256 = cute.make_stride(%iv_254, %iv_255) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_257 = cute.make_layout(%shape_253, %stride_256) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_258 = cute.slice(%lay_257, %coord_248) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_259 = cute.crd2idx(%coord_248, %lay_257) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_260 = cute.get_iter(%view_243) : !memref_gmem_bf16_1
      %ptr_261 = cute.add_offset(%iter_260, %idx_259) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_262 = cute.make_view(%ptr_261, %slice_258) : !memref_gmem_bf16_3
      %iter_263 = cute.get_iter(%view_262) : !memref_gmem_bf16_3
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_264 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536">
      %ptr_265 = cute.add_offset(%smem_ptr, %int_tuple_264) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c65536_i32 = arith.constant 65536 : i32
      %143 = arith.cmpi sge, %smem_size, %c65536_i32 : i32
      cf.assert %143, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 65536 bytes. Please reduce the allocation or set a larger smem size in kernel launch."
      %int_tuple_266 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_267 = cute.add_offset(%smem_ptr, %int_tuple_266) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_268 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_269 = cute.add_offset(%smem_ptr, %int_tuple_268) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_270 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_271 = cute.add_offset(%smem_ptr, %int_tuple_270) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_272 = cute.recast_iter(%ptr_267) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_273 = cute.make_view(%iter_272, %0) : !memref_smem_bf16_
      %iter_274 = cute.get_iter(%view_273) : !memref_smem_bf16_
      %iter_275 = cute.recast_iter(%ptr_269) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_276 = cute.make_view(%iter_275, %1) : !memref_smem_bf16_1
      %iter_277 = cute.get_iter(%view_276) : !memref_smem_bf16_1
      %iter_278 = cute.recast_iter(%ptr_271) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_279 = cute.make_view(%iter_278, %1) : !memref_smem_bf16_1
      %iter_280 = cute.get_iter(%view_279) : !memref_smem_bf16_1
      %shape_281 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_282 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_283 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_284 = cute.get_iter(%view_279) : !memref_smem_bf16_1
      %view_285 = cute.make_view(%iter_284) : !memref_smem_bf16_2
      %iter_286 = cute.get_iter(%view_285) : !memref_smem_bf16_2
      %coord_287 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned = cute.tiled.copy.partition_S(%3, %view_209, %coord_287) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_288 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
      %coord_289 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned = cute.tiled.copy.partition_D(%3, %view_273, %coord_289) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_290 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
      %coord_291 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_292 = cute.tiled.copy.partition_S(%3, %view_235, %coord_291) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_293 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
      %coord_294 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_295 = cute.tiled.copy.partition_D(%3, %view_276, %coord_294) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_296 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
      %coord_297 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_298 = cute.tiled.copy.partition_S(%3, %view_262, %coord_297) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_299 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
      %coord_300 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_301 = cute.tiled.copy.partition_D(%3, %view_279, %coord_300) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_302 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
      %coord_303 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_A = cute.tiled.mma.partition A (%5, %view_273, %coord_303) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5
      %iter_304 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5
      %frg_A = cute.mma.make_fragment A (%5, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_
      %iter_305 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %coord_306 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B = cute.tiled.mma.partition B (%5, %view_276, %coord_306) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_6
      %iter_307 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6
      %frg_B = cute.mma.make_fragment B (%5, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1
      %iter_308 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %coord_309 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B_310 = cute.tiled.mma.partition B (%5, %view_285, %coord_309) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7
      %iter_311 = cute.get_iter(%ptn_B_310) : !memref_smem_bf16_7
      %frg_B_312 = cute.mma.make_fragment B (%5, %ptn_B_310) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2
      %iter_313 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
      %shape_314 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %144 = cute.tiled.mma.partition_shape C (%5, %shape_314) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,128)">) -> !cute.shape<"((2,2),2,16)">
      %e0_315, %e1_316, %e2_317, %e3_318 = cute.get_leaves(%144) : !cute.shape<"((2,2),2,16)">
      %shape_319 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_320 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem = cute.memref.alloca(%lay_320) : !memref_rmem_f32_
      %iter_321 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_322 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_323 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %sz = cute.size(%lay_323) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"128">
      %e0_324 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
      %lay_325 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %145 = cute.get_shape(%lay_325) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%145) : !cute.shape<"((2,2),2,16)">
      %int_tuple_330 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %res = cute.tuple.product(%int_tuple_330) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_331 = cute.get_leaves(%res) : !cute.int_tuple<"128">
      %cst = arith.constant 0.000000e+00 : f32
      %146 = vector.splat %cst : vector<128xf32>
      %int_tuple_332 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_333 = cute.size(%int_tuple_332) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_334 = cute.get_leaves(%sz_333) : !cute.int_tuple<"128">
      %int_tuple_335 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_336 = cute.size(%int_tuple_335) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_337 = cute.get_leaves(%sz_336) : !cute.int_tuple<"128">
      cute.memref.store_vec %146, %rmem : !memref_rmem_f32_
      %shape_338 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_339 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_340 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_341 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_342 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %147 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %148 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_343, %e1_344, %e2_345 = cute.get_leaves(%148) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_346 = cute.size(%e0_343) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_347 = cute.get_leaves(%sz_346) : !cute.int_tuple<"64">
      %149 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_348, %e1_349, %e2_350 = cute.get_leaves(%149) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_351 = cute.size(%e2_350) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_352 = cute.get_leaves(%sz_351) : !cute.int_tuple<"16">
      %tile_353 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %150 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %151 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %152 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_354, %e1_355, %e2_356 = cute.get_leaves(%152) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_357 = cute.size(%e1_355) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_358 = cute.get_leaves(%sz_357) : !cute.int_tuple<"16">
      %153 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_359, %e1_360, %e2_361 = cute.get_leaves(%153) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_362 = cute.size(%e2_361) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_363 = cute.get_leaves(%sz_362) : !cute.int_tuple<"16">
      %tile_364 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %154 = cute.make_tiled_copy(%atom_340) : !copy_ldsm_4_1
      %155 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %156 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_365, %e1_366, %e2_367 = cute.get_leaves(%156) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_368 = cute.size(%e1_366) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_369 = cute.get_leaves(%sz_368) : !cute.int_tuple<"16">
      %157 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_370, %e1_371, %e2_372 = cute.get_leaves(%157) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_373 = cute.size(%e2_372) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_374 = cute.get_leaves(%sz_373) : !cute.int_tuple<"16">
      %tile_375 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %158 = cute.make_tiled_copy(%atom_342) : !copy_ldsm_4_2
      %coord_376 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_377 = cute.tiled.copy.partition_S(%150, %view_273, %coord_376) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8
      %iter_378 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %retiled = cute.tiled.copy.retile(%150, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3
      %iter_379 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %coord_380 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_381 = cute.tiled.copy.partition_S(%154, %view_276, %coord_380) : (!copy_ldsm_4_1, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_9
      %iter_382 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %retiled_383 = cute.tiled.copy.retile(%154, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4
      %iter_384 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %coord_385 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_386 = cute.tiled.copy.partition_S(%158, %view_285, %coord_385) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10
      %iter_387 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %retiled_388 = cute.tiled.copy.retile(%158, %frg_B_312) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5
      %iter_389 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %lay_390 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %159 = cute.get_shape(%lay_390) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_391, %e1_392, %e2_393, %e3_394 = cute.get_leaves(%159) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_395 = cute.to_int_tuple(%e0_391) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %160 = cute.get_scalars(%itup_395) : !cute.int_tuple<"?">
      %itup_396 = cute.to_int_tuple(%e1_392) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %161 = cute.get_scalars(%itup_396) : !cute.int_tuple<"?">
      %itup_397 = cute.to_int_tuple(%e2_393) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %162 = cute.get_scalars(%itup_397) : !cute.int_tuple<"?">
      %itup_398 = cute.to_int_tuple(%e3_394) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %163 = cute.get_scalars(%itup_398) : !cute.int_tuple<"?{div=8}">
      %shape_399 = cute.make_shape(%itup_395, %itup_396, %itup_397, %itup_398) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %164 = cute.make_identity_tensor(%shape_399) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_400 = cute.get_iter(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_401, %e1_402, %e2_403, %e3_404 = cute.get_leaves(%iter_400) : !cute.int_tuple<"(0,0,0,0)">
      %lay_405 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %165 = cute.get_shape(%lay_405) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_406, %e1_407, %e2_408, %e3_409 = cute.get_leaves(%165) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_410 = cute.to_int_tuple(%e0_406) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %166 = cute.get_scalars(%itup_410) : !cute.int_tuple<"?">
      %itup_411 = cute.to_int_tuple(%e1_407) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %167 = cute.get_scalars(%itup_411) : !cute.int_tuple<"?">
      %itup_412 = cute.to_int_tuple(%e2_408) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %168 = cute.get_scalars(%itup_412) : !cute.int_tuple<"?">
      %itup_413 = cute.to_int_tuple(%e3_409) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %169 = cute.get_scalars(%itup_413) : !cute.int_tuple<"?{div=8}">
      %shape_414 = cute.make_shape(%itup_410, %itup_411, %itup_412, %itup_413) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %170 = cute.make_identity_tensor(%shape_414) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_415 = cute.get_iter(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_416, %e1_417, %e2_418, %e3_419 = cute.get_leaves(%iter_415) : !cute.int_tuple<"(0,0,0,0)">
      %coord_420 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_421 = cute.get_layout(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_422 = cute.slice(%lay_421, %coord_420) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_423 = cute.crd2idx(%coord_420, %lay_421) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_424 = cute.get_iter(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_424, %idx_423) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_425 = cute.make_view(%tup, %slice_422) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_426 = cute.get_iter(%view_425) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_427, %e1_428, %e2_429, %e3_430 = cute.get_leaves(%iter_426) : !cute.int_tuple<"(?,0,?,0)">
      %171 = cute.get_scalars(%e0_427) : !cute.int_tuple<"?">
      %172 = cute.get_scalars(%e2_429) : !cute.int_tuple<"?">
      %iter_431 = cute.get_iter(%view_425) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_432, %e1_433, %e2_434, %e3_435 = cute.get_leaves(%iter_431) : !cute.int_tuple<"(?,0,?,0)">
      %173 = cute.get_scalars(%e0_432) : !cute.int_tuple<"?">
      %174 = cute.get_scalars(%e2_434) : !cute.int_tuple<"?">
      %tile_436 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_437 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %175 = cute.get_scalars(%coord_437) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_438 = cute.make_coord(%175) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_439 = cute.get_layout(%view_425) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %176:2 = cute.get_scalars(%lay_439) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_440 = arith.constant 128 : i32
      %177 = arith.ceildivsi %176#0, %c128_i32_440 : i32
      %c128_i32_441 = arith.constant 128 : i32
      %178 = arith.ceildivsi %176#1, %c128_i32_441 : i32
      %shape_442 = cute.make_shape(%177, %178) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_443 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_444 = cute.make_layout(%shape_442, %stride_443) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_445 = cute.crd2idx(%coord_438, %lay_444) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_446 = cute.get_iter(%view_425) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_447 = cute.add_offset(%iter_446, %idx_445) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_448 = cute.make_view(%tup_447) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_449 = cute.get_iter(%view_448) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_450, %e1_451, %e2_452, %e3_453 = cute.get_leaves(%iter_449) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %179 = cute.get_scalars(%e0_450) : !cute.int_tuple<"?">
      %180 = cute.get_scalars(%e1_451) : !cute.int_tuple<"?{div=128}">
      %181 = cute.get_scalars(%e2_452) : !cute.int_tuple<"?">
      %coord_454 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_455 = cute.get_layout(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_456 = cute.slice(%lay_455, %coord_454) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_457 = cute.crd2idx(%coord_454, %lay_455) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_458 = cute.get_iter(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_459 = cute.add_offset(%iter_458, %idx_457) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_460 = cute.make_view(%tup_459, %slice_456) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_461 = cute.get_iter(%view_460) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_462, %e1_463, %e2_464, %e3_465 = cute.get_leaves(%iter_461) : !cute.int_tuple<"(?,0,?,0)">
      %182 = cute.get_scalars(%e0_462) : !cute.int_tuple<"?">
      %183 = cute.get_scalars(%e2_464) : !cute.int_tuple<"?">
      %iter_466 = cute.get_iter(%view_460) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_467, %e1_468, %e2_469, %e3_470 = cute.get_leaves(%iter_466) : !cute.int_tuple<"(?,0,?,0)">
      %184 = cute.get_scalars(%e0_467) : !cute.int_tuple<"?">
      %185 = cute.get_scalars(%e2_469) : !cute.int_tuple<"?">
      %tile_471 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_472 = cute.make_coord(%129) : (i32) -> !cute.coord<"(?,0)">
      %186 = cute.get_scalars(%coord_472) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_473 = cute.make_coord(%186) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_474 = cute.get_layout(%view_460) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %187:2 = cute.get_scalars(%lay_474) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_475 = arith.constant 64 : i32
      %188 = arith.ceildivsi %187#0, %c64_i32_475 : i32
      %c128_i32_476 = arith.constant 128 : i32
      %189 = arith.ceildivsi %187#1, %c128_i32_476 : i32
      %shape_477 = cute.make_shape(%188, %189) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_478 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_479 = cute.make_layout(%shape_477, %stride_478) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_480 = cute.crd2idx(%coord_473, %lay_479) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_481 = cute.get_iter(%view_460) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_482 = cute.add_offset(%iter_481, %idx_480) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_483 = cute.make_view(%tup_482) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_484 = cute.get_iter(%view_483) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_485, %e1_486, %e2_487, %e3_488 = cute.get_leaves(%iter_484) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %190 = cute.get_scalars(%e0_485) : !cute.int_tuple<"?">
      %191 = cute.get_scalars(%e1_486) : !cute.int_tuple<"?{div=64}">
      %192 = cute.get_scalars(%e2_487) : !cute.int_tuple<"?">
      %coord_489 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_490 = cute.tiled.copy.partition_S(%3, %view_448, %coord_489) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_491 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_492, %e1_493, %e2_494, %e3_495 = cute.get_leaves(%iter_491) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %193 = cute.get_scalars(%e0_492) : !cute.int_tuple<"?">
      %194 = cute.get_scalars(%e1_493) : !cute.int_tuple<"?">
      %195 = cute.get_scalars(%e2_494) : !cute.int_tuple<"?">
      %196 = cute.get_scalars(%e3_495) : !cute.int_tuple<"?{div=8}">
      %coord_496 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_497 = cute.tiled.copy.partition_S(%3, %view_483, %coord_496) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_498 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_499, %e1_500, %e2_501, %e3_502 = cute.get_leaves(%iter_498) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %197 = cute.get_scalars(%e0_499) : !cute.int_tuple<"?">
      %198 = cute.get_scalars(%e1_500) : !cute.int_tuple<"?">
      %199 = cute.get_scalars(%e2_501) : !cute.int_tuple<"?">
      %200 = cute.get_scalars(%e3_502) : !cute.int_tuple<"?{div=8}">
      %lay_503 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %201 = cute.get_shape(%lay_503) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_504, %e1_505, %e2_506, %e3_507 = cute.get_leaves(%201) : !cute.shape<"((8,1),8,2)">
      %lay_508 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_509 = cute.size(%lay_508) <{mode = [1]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"8">
      %e0_510 = cute.get_leaves(%sz_509) : !cute.int_tuple<"8">
      %lay_511 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_512 = cute.size(%lay_511) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_513 = cute.get_leaves(%sz_512) : !cute.int_tuple<"2">
      %lay_514 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_515 = cute.size(%lay_514) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_516 = cute.get_leaves(%sz_515) : !cute.int_tuple<"2">
      %shape_517 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_518 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_519 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_520 = cute.memref.alloca(%lay_519) : !memref_rmem_i8_
      %iter_521 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
      %iter_522 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
      %lay_523 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
      %202 = cute.get_shape(%lay_523) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_524, %e1_525, %e2_526, %e3_527 = cute.get_leaves(%202) : !cute.shape<"((8,1),4,2)">
      %lay_528 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
      %sz_529 = cute.size(%lay_528) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_530 = cute.get_leaves(%sz_529) : !cute.int_tuple<"4">
      %lay_531 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
      %sz_532 = cute.size(%lay_531) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_533 = cute.get_leaves(%sz_532) : !cute.int_tuple<"2">
      %lay_534 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
      %sz_535 = cute.size(%lay_534) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_536 = cute.get_leaves(%sz_535) : !cute.int_tuple<"2">
      %shape_537 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_538 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_539 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_540 = cute.memref.alloca(%lay_539) : !memref_rmem_i8_1
      %iter_541 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
      %iter_542 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
      %lay_543 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
      %203 = cute.get_shape(%lay_543) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_544, %e1_545, %e2_546 = cute.get_leaves(%203) : !cute.shape<"(1,8,2)">
      %coord_547 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_548 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_549 = cute.crd2idx(%coord_547, %lay_548) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_550 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_551 = cute.add_offset(%iter_550, %idx_549) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_552 = cute.make_view(%tup_551) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_553 = cute.get_iter(%view_552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_554, %e1_555, %e2_556, %e3_557 = cute.get_leaves(%iter_553) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %204 = cute.get_scalars(%e0_554) : !cute.int_tuple<"?">
      %205 = cute.get_scalars(%e1_555) : !cute.int_tuple<"?">
      %206 = cute.get_scalars(%e2_556) : !cute.int_tuple<"?">
      %207 = cute.get_scalars(%e3_557) : !cute.int_tuple<"?{div=8}">
      %iter_558 = cute.get_iter(%view_552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_559, %e1_560, %e2_561, %e3_562 = cute.get_leaves(%iter_558) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %208 = cute.get_scalars(%e0_559) : !cute.int_tuple<"?">
      %209 = cute.get_scalars(%e1_560) : !cute.int_tuple<"?">
      %210 = cute.get_scalars(%e2_561) : !cute.int_tuple<"?">
      %211 = cute.get_scalars(%e3_562) : !cute.int_tuple<"?{div=8}">
      %iter_563 = cute.get_iter(%view_552) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_564, %e1_565, %e2_566, %e3_567 = cute.get_leaves(%iter_563) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %212 = cute.get_scalars(%e0_564) : !cute.int_tuple<"?">
      %213 = cute.get_scalars(%e1_565) : !cute.int_tuple<"?">
      %214 = cute.get_scalars(%e2_566) : !cute.int_tuple<"?">
      %215 = cute.get_scalars(%e3_567) : !cute.int_tuple<"?{div=8}">
      %lay_568 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %216 = cute.get_shape(%lay_568) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_569, %e1_570, %e2_571, %e3_572 = cute.get_leaves(%216) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_573 = cute.to_int_tuple(%e0_569) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %217 = cute.get_scalars(%itup_573) : !cute.int_tuple<"?">
      %itup_574 = cute.to_int_tuple(%e1_570) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %218 = cute.get_scalars(%itup_574) : !cute.int_tuple<"?">
      %itup_575 = cute.to_int_tuple(%e2_571) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %219 = cute.get_scalars(%itup_575) : !cute.int_tuple<"?">
      %itup_576 = cute.to_int_tuple(%e3_572) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %220 = cute.get_scalars(%itup_576) : !cute.int_tuple<"?{div=8}">
      %coord_577 = cute.make_coord(%e3_567) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_578 = cute.make_coord(%itup_576) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %221 = cute.elem_less(%coord_577, %coord_578) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %222 = arith.extui %221 : i1 to i8
      %coord_579 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_520, %coord_579, %222) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_580 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_581 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_582 = cute.crd2idx(%coord_580, %lay_581) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_583 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_584 = cute.add_offset(%iter_583, %idx_582) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_585 = cute.make_view(%tup_584) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_586 = cute.get_iter(%view_585) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_587, %e1_588, %e2_589, %e3_590 = cute.get_leaves(%iter_586) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %223 = cute.get_scalars(%e0_587) : !cute.int_tuple<"?">
      %224 = cute.get_scalars(%e1_588) : !cute.int_tuple<"?">
      %225 = cute.get_scalars(%e2_589) : !cute.int_tuple<"?">
      %226 = cute.get_scalars(%e3_590) : !cute.int_tuple<"?{div=8}">
      %iter_591 = cute.get_iter(%view_585) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_592, %e1_593, %e2_594, %e3_595 = cute.get_leaves(%iter_591) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %227 = cute.get_scalars(%e0_592) : !cute.int_tuple<"?">
      %228 = cute.get_scalars(%e1_593) : !cute.int_tuple<"?">
      %229 = cute.get_scalars(%e2_594) : !cute.int_tuple<"?">
      %230 = cute.get_scalars(%e3_595) : !cute.int_tuple<"?{div=8}">
      %iter_596 = cute.get_iter(%view_585) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_597, %e1_598, %e2_599, %e3_600 = cute.get_leaves(%iter_596) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %231 = cute.get_scalars(%e0_597) : !cute.int_tuple<"?">
      %232 = cute.get_scalars(%e1_598) : !cute.int_tuple<"?">
      %233 = cute.get_scalars(%e2_599) : !cute.int_tuple<"?">
      %234 = cute.get_scalars(%e3_600) : !cute.int_tuple<"?{div=8}">
      %lay_601 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %235 = cute.get_shape(%lay_601) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_602, %e1_603, %e2_604, %e3_605 = cute.get_leaves(%235) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_606 = cute.to_int_tuple(%e0_602) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %236 = cute.get_scalars(%itup_606) : !cute.int_tuple<"?">
      %itup_607 = cute.to_int_tuple(%e1_603) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %237 = cute.get_scalars(%itup_607) : !cute.int_tuple<"?">
      %itup_608 = cute.to_int_tuple(%e2_604) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %238 = cute.get_scalars(%itup_608) : !cute.int_tuple<"?">
      %itup_609 = cute.to_int_tuple(%e3_605) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %239 = cute.get_scalars(%itup_609) : !cute.int_tuple<"?{div=8}">
      %coord_610 = cute.make_coord(%e3_600) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_611 = cute.make_coord(%itup_609) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %240 = cute.elem_less(%coord_610, %coord_611) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %241 = arith.extui %240 : i1 to i8
      %coord_612 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_520, %coord_612, %241) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_613 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
      %242 = cute.get_shape(%lay_613) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_614, %e1_615, %e2_616 = cute.get_leaves(%242) : !cute.shape<"(1,4,2)">
      %coord_617 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_618 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_619 = cute.crd2idx(%coord_617, %lay_618) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_620 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_621 = cute.add_offset(%iter_620, %idx_619) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_622 = cute.make_view(%tup_621) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_623 = cute.get_iter(%view_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_624, %e1_625, %e2_626, %e3_627 = cute.get_leaves(%iter_623) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %243 = cute.get_scalars(%e0_624) : !cute.int_tuple<"?">
      %244 = cute.get_scalars(%e1_625) : !cute.int_tuple<"?">
      %245 = cute.get_scalars(%e2_626) : !cute.int_tuple<"?">
      %246 = cute.get_scalars(%e3_627) : !cute.int_tuple<"?{div=8}">
      %iter_628 = cute.get_iter(%view_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_629, %e1_630, %e2_631, %e3_632 = cute.get_leaves(%iter_628) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %247 = cute.get_scalars(%e0_629) : !cute.int_tuple<"?">
      %248 = cute.get_scalars(%e1_630) : !cute.int_tuple<"?">
      %249 = cute.get_scalars(%e2_631) : !cute.int_tuple<"?">
      %250 = cute.get_scalars(%e3_632) : !cute.int_tuple<"?{div=8}">
      %iter_633 = cute.get_iter(%view_622) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_634, %e1_635, %e2_636, %e3_637 = cute.get_leaves(%iter_633) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %251 = cute.get_scalars(%e0_634) : !cute.int_tuple<"?">
      %252 = cute.get_scalars(%e1_635) : !cute.int_tuple<"?">
      %253 = cute.get_scalars(%e2_636) : !cute.int_tuple<"?">
      %254 = cute.get_scalars(%e3_637) : !cute.int_tuple<"?{div=8}">
      %lay_638 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %255 = cute.get_shape(%lay_638) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_639, %e1_640, %e2_641, %e3_642 = cute.get_leaves(%255) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_643 = cute.to_int_tuple(%e0_639) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %256 = cute.get_scalars(%itup_643) : !cute.int_tuple<"?">
      %itup_644 = cute.to_int_tuple(%e1_640) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %257 = cute.get_scalars(%itup_644) : !cute.int_tuple<"?">
      %itup_645 = cute.to_int_tuple(%e2_641) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %258 = cute.get_scalars(%itup_645) : !cute.int_tuple<"?">
      %itup_646 = cute.to_int_tuple(%e3_642) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %259 = cute.get_scalars(%itup_646) : !cute.int_tuple<"?{div=8}">
      %coord_647 = cute.make_coord(%e3_637) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_648 = cute.make_coord(%itup_646) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %260 = cute.elem_less(%coord_647, %coord_648) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %261 = arith.extui %260 : i1 to i8
      %coord_649 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_540, %coord_649, %261) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_650 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_651 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_652 = cute.crd2idx(%coord_650, %lay_651) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_653 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_654 = cute.add_offset(%iter_653, %idx_652) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_655 = cute.make_view(%tup_654) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_656 = cute.get_iter(%view_655) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_657, %e1_658, %e2_659, %e3_660 = cute.get_leaves(%iter_656) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %262 = cute.get_scalars(%e0_657) : !cute.int_tuple<"?">
      %263 = cute.get_scalars(%e1_658) : !cute.int_tuple<"?">
      %264 = cute.get_scalars(%e2_659) : !cute.int_tuple<"?">
      %265 = cute.get_scalars(%e3_660) : !cute.int_tuple<"?{div=8}">
      %iter_661 = cute.get_iter(%view_655) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_662, %e1_663, %e2_664, %e3_665 = cute.get_leaves(%iter_661) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %266 = cute.get_scalars(%e0_662) : !cute.int_tuple<"?">
      %267 = cute.get_scalars(%e1_663) : !cute.int_tuple<"?">
      %268 = cute.get_scalars(%e2_664) : !cute.int_tuple<"?">
      %269 = cute.get_scalars(%e3_665) : !cute.int_tuple<"?{div=8}">
      %iter_666 = cute.get_iter(%view_655) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_667, %e1_668, %e2_669, %e3_670 = cute.get_leaves(%iter_666) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %270 = cute.get_scalars(%e0_667) : !cute.int_tuple<"?">
      %271 = cute.get_scalars(%e1_668) : !cute.int_tuple<"?">
      %272 = cute.get_scalars(%e2_669) : !cute.int_tuple<"?">
      %273 = cute.get_scalars(%e3_670) : !cute.int_tuple<"?{div=8}">
      %lay_671 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %274 = cute.get_shape(%lay_671) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_672, %e1_673, %e2_674, %e3_675 = cute.get_leaves(%274) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_676 = cute.to_int_tuple(%e0_672) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %275 = cute.get_scalars(%itup_676) : !cute.int_tuple<"?">
      %itup_677 = cute.to_int_tuple(%e1_673) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %276 = cute.get_scalars(%itup_677) : !cute.int_tuple<"?">
      %itup_678 = cute.to_int_tuple(%e2_674) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %277 = cute.get_scalars(%itup_678) : !cute.int_tuple<"?">
      %itup_679 = cute.to_int_tuple(%e3_675) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %278 = cute.get_scalars(%itup_679) : !cute.int_tuple<"?{div=8}">
      %coord_680 = cute.make_coord(%e3_670) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_681 = cute.make_coord(%itup_679) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %279 = cute.elem_less(%coord_680, %coord_681) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %280 = arith.extui %279 : i1 to i8
      %coord_682 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_540, %coord_682, %280) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_683 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_684 = cute.size(%int_tuple_683) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_685 = cute.get_leaves(%sz_684) : !cute.int_tuple<"8">
      %coord_686 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_687 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_688 = cute.crd2idx(%coord_686, %lay_687) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_689 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_690 = cute.add_offset(%iter_689, %idx_688) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_691 = cute.make_view(%tup_690) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_692 = cute.get_iter(%view_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_693, %e1_694, %e2_695, %e3_696 = cute.get_leaves(%iter_692) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %281 = cute.get_scalars(%e0_693) : !cute.int_tuple<"?">
      %282 = cute.get_scalars(%e1_694) : !cute.int_tuple<"?">
      %283 = cute.get_scalars(%e2_695) : !cute.int_tuple<"?">
      %284 = cute.get_scalars(%e3_696) : !cute.int_tuple<"?{div=8}">
      %iter_697 = cute.get_iter(%view_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_698, %e1_699, %e2_700, %e3_701 = cute.get_leaves(%iter_697) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %285 = cute.get_scalars(%e0_698) : !cute.int_tuple<"?">
      %286 = cute.get_scalars(%e1_699) : !cute.int_tuple<"?">
      %287 = cute.get_scalars(%e2_700) : !cute.int_tuple<"?">
      %288 = cute.get_scalars(%e3_701) : !cute.int_tuple<"?{div=8}">
      %iter_702 = cute.get_iter(%view_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_703, %e1_704, %e2_705, %e3_706 = cute.get_leaves(%iter_702) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %289 = cute.get_scalars(%e0_703) : !cute.int_tuple<"?">
      %290 = cute.get_scalars(%e1_704) : !cute.int_tuple<"?">
      %291 = cute.get_scalars(%e2_705) : !cute.int_tuple<"?">
      %292 = cute.get_scalars(%e3_706) : !cute.int_tuple<"?{div=8}">
      %lay_707 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %293 = cute.get_shape(%lay_707) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_708, %e1_709, %e2_710, %e3_711 = cute.get_leaves(%293) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_712 = cute.to_int_tuple(%e0_708) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %294 = cute.get_scalars(%itup_712) : !cute.int_tuple<"?">
      %itup_713 = cute.to_int_tuple(%e1_709) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %295 = cute.get_scalars(%itup_713) : !cute.int_tuple<"?">
      %itup_714 = cute.to_int_tuple(%e2_710) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %296 = cute.get_scalars(%itup_714) : !cute.int_tuple<"?">
      %itup_715 = cute.to_int_tuple(%e3_711) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %297 = cute.get_scalars(%itup_715) : !cute.int_tuple<"?{div=8}">
      %coord_716 = cute.make_coord(%e1_704) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_717 = cute.make_coord(%itup_713) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %298 = cute.elem_less(%coord_716, %coord_717) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %298 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_718 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_719 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_720 = cute.crd2idx(%coord_718, %lay_719) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_721 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_722 = cute.add_offset(%iter_721, %idx_720) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_723 = cute.make_view(%tup_722) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_724 = cute.get_iter(%view_723) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_725, %e1_726, %e2_727, %e3_728 = cute.get_leaves(%iter_724) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %299 = cute.get_scalars(%e0_725) : !cute.int_tuple<"?">
      %300 = cute.get_scalars(%e1_726) : !cute.int_tuple<"?">
      %301 = cute.get_scalars(%e2_727) : !cute.int_tuple<"?">
      %302 = cute.get_scalars(%e3_728) : !cute.int_tuple<"?{div=8}">
      %iter_729 = cute.get_iter(%view_723) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_730, %e1_731, %e2_732, %e3_733 = cute.get_leaves(%iter_729) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %303 = cute.get_scalars(%e0_730) : !cute.int_tuple<"?">
      %304 = cute.get_scalars(%e1_731) : !cute.int_tuple<"?">
      %305 = cute.get_scalars(%e2_732) : !cute.int_tuple<"?">
      %306 = cute.get_scalars(%e3_733) : !cute.int_tuple<"?{div=8}">
      %iter_734 = cute.get_iter(%view_723) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_735, %e1_736, %e2_737, %e3_738 = cute.get_leaves(%iter_734) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %307 = cute.get_scalars(%e0_735) : !cute.int_tuple<"?">
      %308 = cute.get_scalars(%e1_736) : !cute.int_tuple<"?">
      %309 = cute.get_scalars(%e2_737) : !cute.int_tuple<"?">
      %310 = cute.get_scalars(%e3_738) : !cute.int_tuple<"?{div=8}">
      %lay_739 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %311 = cute.get_shape(%lay_739) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_740, %e1_741, %e2_742, %e3_743 = cute.get_leaves(%311) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_744 = cute.to_int_tuple(%e0_740) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %312 = cute.get_scalars(%itup_744) : !cute.int_tuple<"?">
      %itup_745 = cute.to_int_tuple(%e1_741) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %313 = cute.get_scalars(%itup_745) : !cute.int_tuple<"?">
      %itup_746 = cute.to_int_tuple(%e2_742) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %314 = cute.get_scalars(%itup_746) : !cute.int_tuple<"?">
      %itup_747 = cute.to_int_tuple(%e3_743) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %315 = cute.get_scalars(%itup_747) : !cute.int_tuple<"?{div=8}">
      %coord_748 = cute.make_coord(%e1_736) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_749 = cute.make_coord(%itup_745) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %316 = cute.elem_less(%coord_748, %coord_749) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %316 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_750 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_751 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_752 = cute.crd2idx(%coord_750, %lay_751) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_753 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_754 = cute.add_offset(%iter_753, %idx_752) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_755 = cute.make_view(%tup_754) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_756 = cute.get_iter(%view_755) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_757, %e1_758, %e2_759, %e3_760 = cute.get_leaves(%iter_756) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %317 = cute.get_scalars(%e0_757) : !cute.int_tuple<"?">
      %318 = cute.get_scalars(%e1_758) : !cute.int_tuple<"?">
      %319 = cute.get_scalars(%e2_759) : !cute.int_tuple<"?">
      %320 = cute.get_scalars(%e3_760) : !cute.int_tuple<"?{div=8}">
      %iter_761 = cute.get_iter(%view_755) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_762, %e1_763, %e2_764, %e3_765 = cute.get_leaves(%iter_761) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %321 = cute.get_scalars(%e0_762) : !cute.int_tuple<"?">
      %322 = cute.get_scalars(%e1_763) : !cute.int_tuple<"?">
      %323 = cute.get_scalars(%e2_764) : !cute.int_tuple<"?">
      %324 = cute.get_scalars(%e3_765) : !cute.int_tuple<"?{div=8}">
      %iter_766 = cute.get_iter(%view_755) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_767, %e1_768, %e2_769, %e3_770 = cute.get_leaves(%iter_766) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %325 = cute.get_scalars(%e0_767) : !cute.int_tuple<"?">
      %326 = cute.get_scalars(%e1_768) : !cute.int_tuple<"?">
      %327 = cute.get_scalars(%e2_769) : !cute.int_tuple<"?">
      %328 = cute.get_scalars(%e3_770) : !cute.int_tuple<"?{div=8}">
      %lay_771 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %329 = cute.get_shape(%lay_771) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_772, %e1_773, %e2_774, %e3_775 = cute.get_leaves(%329) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_776 = cute.to_int_tuple(%e0_772) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %330 = cute.get_scalars(%itup_776) : !cute.int_tuple<"?">
      %itup_777 = cute.to_int_tuple(%e1_773) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %331 = cute.get_scalars(%itup_777) : !cute.int_tuple<"?">
      %itup_778 = cute.to_int_tuple(%e2_774) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %332 = cute.get_scalars(%itup_778) : !cute.int_tuple<"?">
      %itup_779 = cute.to_int_tuple(%e3_775) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %333 = cute.get_scalars(%itup_779) : !cute.int_tuple<"?{div=8}">
      %coord_780 = cute.make_coord(%e1_768) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_781 = cute.make_coord(%itup_777) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %334 = cute.elem_less(%coord_780, %coord_781) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %334 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_782 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_783 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_784 = cute.crd2idx(%coord_782, %lay_783) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_785 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_786 = cute.add_offset(%iter_785, %idx_784) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_787 = cute.make_view(%tup_786) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_788 = cute.get_iter(%view_787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_789, %e1_790, %e2_791, %e3_792 = cute.get_leaves(%iter_788) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %335 = cute.get_scalars(%e0_789) : !cute.int_tuple<"?">
      %336 = cute.get_scalars(%e1_790) : !cute.int_tuple<"?">
      %337 = cute.get_scalars(%e2_791) : !cute.int_tuple<"?">
      %338 = cute.get_scalars(%e3_792) : !cute.int_tuple<"?{div=8}">
      %iter_793 = cute.get_iter(%view_787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_794, %e1_795, %e2_796, %e3_797 = cute.get_leaves(%iter_793) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %339 = cute.get_scalars(%e0_794) : !cute.int_tuple<"?">
      %340 = cute.get_scalars(%e1_795) : !cute.int_tuple<"?">
      %341 = cute.get_scalars(%e2_796) : !cute.int_tuple<"?">
      %342 = cute.get_scalars(%e3_797) : !cute.int_tuple<"?{div=8}">
      %iter_798 = cute.get_iter(%view_787) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_799, %e1_800, %e2_801, %e3_802 = cute.get_leaves(%iter_798) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %343 = cute.get_scalars(%e0_799) : !cute.int_tuple<"?">
      %344 = cute.get_scalars(%e1_800) : !cute.int_tuple<"?">
      %345 = cute.get_scalars(%e2_801) : !cute.int_tuple<"?">
      %346 = cute.get_scalars(%e3_802) : !cute.int_tuple<"?{div=8}">
      %lay_803 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %347 = cute.get_shape(%lay_803) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_804, %e1_805, %e2_806, %e3_807 = cute.get_leaves(%347) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_808 = cute.to_int_tuple(%e0_804) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %348 = cute.get_scalars(%itup_808) : !cute.int_tuple<"?">
      %itup_809 = cute.to_int_tuple(%e1_805) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %349 = cute.get_scalars(%itup_809) : !cute.int_tuple<"?">
      %itup_810 = cute.to_int_tuple(%e2_806) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %350 = cute.get_scalars(%itup_810) : !cute.int_tuple<"?">
      %itup_811 = cute.to_int_tuple(%e3_807) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %351 = cute.get_scalars(%itup_811) : !cute.int_tuple<"?{div=8}">
      %coord_812 = cute.make_coord(%e1_800) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_813 = cute.make_coord(%itup_809) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %352 = cute.elem_less(%coord_812, %coord_813) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %352 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_814 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_815 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_816 = cute.crd2idx(%coord_814, %lay_815) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_817 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_818 = cute.add_offset(%iter_817, %idx_816) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_819 = cute.make_view(%tup_818) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_820 = cute.get_iter(%view_819) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_821, %e1_822, %e2_823, %e3_824 = cute.get_leaves(%iter_820) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %353 = cute.get_scalars(%e0_821) : !cute.int_tuple<"?">
      %354 = cute.get_scalars(%e1_822) : !cute.int_tuple<"?">
      %355 = cute.get_scalars(%e2_823) : !cute.int_tuple<"?">
      %356 = cute.get_scalars(%e3_824) : !cute.int_tuple<"?{div=8}">
      %iter_825 = cute.get_iter(%view_819) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_826, %e1_827, %e2_828, %e3_829 = cute.get_leaves(%iter_825) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %357 = cute.get_scalars(%e0_826) : !cute.int_tuple<"?">
      %358 = cute.get_scalars(%e1_827) : !cute.int_tuple<"?">
      %359 = cute.get_scalars(%e2_828) : !cute.int_tuple<"?">
      %360 = cute.get_scalars(%e3_829) : !cute.int_tuple<"?{div=8}">
      %iter_830 = cute.get_iter(%view_819) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_831, %e1_832, %e2_833, %e3_834 = cute.get_leaves(%iter_830) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %361 = cute.get_scalars(%e0_831) : !cute.int_tuple<"?">
      %362 = cute.get_scalars(%e1_832) : !cute.int_tuple<"?">
      %363 = cute.get_scalars(%e2_833) : !cute.int_tuple<"?">
      %364 = cute.get_scalars(%e3_834) : !cute.int_tuple<"?{div=8}">
      %lay_835 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %365 = cute.get_shape(%lay_835) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_836, %e1_837, %e2_838, %e3_839 = cute.get_leaves(%365) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_840 = cute.to_int_tuple(%e0_836) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %366 = cute.get_scalars(%itup_840) : !cute.int_tuple<"?">
      %itup_841 = cute.to_int_tuple(%e1_837) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %367 = cute.get_scalars(%itup_841) : !cute.int_tuple<"?">
      %itup_842 = cute.to_int_tuple(%e2_838) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %368 = cute.get_scalars(%itup_842) : !cute.int_tuple<"?">
      %itup_843 = cute.to_int_tuple(%e3_839) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %369 = cute.get_scalars(%itup_843) : !cute.int_tuple<"?{div=8}">
      %coord_844 = cute.make_coord(%e1_832) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_845 = cute.make_coord(%itup_841) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %370 = cute.elem_less(%coord_844, %coord_845) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %370 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_846 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_847 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_848 = cute.crd2idx(%coord_846, %lay_847) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_849 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_850 = cute.add_offset(%iter_849, %idx_848) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_851 = cute.make_view(%tup_850) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_852 = cute.get_iter(%view_851) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_853, %e1_854, %e2_855, %e3_856 = cute.get_leaves(%iter_852) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %371 = cute.get_scalars(%e0_853) : !cute.int_tuple<"?">
      %372 = cute.get_scalars(%e1_854) : !cute.int_tuple<"?">
      %373 = cute.get_scalars(%e2_855) : !cute.int_tuple<"?">
      %374 = cute.get_scalars(%e3_856) : !cute.int_tuple<"?{div=8}">
      %iter_857 = cute.get_iter(%view_851) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_858, %e1_859, %e2_860, %e3_861 = cute.get_leaves(%iter_857) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %375 = cute.get_scalars(%e0_858) : !cute.int_tuple<"?">
      %376 = cute.get_scalars(%e1_859) : !cute.int_tuple<"?">
      %377 = cute.get_scalars(%e2_860) : !cute.int_tuple<"?">
      %378 = cute.get_scalars(%e3_861) : !cute.int_tuple<"?{div=8}">
      %iter_862 = cute.get_iter(%view_851) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_863, %e1_864, %e2_865, %e3_866 = cute.get_leaves(%iter_862) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %379 = cute.get_scalars(%e0_863) : !cute.int_tuple<"?">
      %380 = cute.get_scalars(%e1_864) : !cute.int_tuple<"?">
      %381 = cute.get_scalars(%e2_865) : !cute.int_tuple<"?">
      %382 = cute.get_scalars(%e3_866) : !cute.int_tuple<"?{div=8}">
      %lay_867 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %383 = cute.get_shape(%lay_867) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_868, %e1_869, %e2_870, %e3_871 = cute.get_leaves(%383) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_872 = cute.to_int_tuple(%e0_868) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %384 = cute.get_scalars(%itup_872) : !cute.int_tuple<"?">
      %itup_873 = cute.to_int_tuple(%e1_869) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %385 = cute.get_scalars(%itup_873) : !cute.int_tuple<"?">
      %itup_874 = cute.to_int_tuple(%e2_870) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %386 = cute.get_scalars(%itup_874) : !cute.int_tuple<"?">
      %itup_875 = cute.to_int_tuple(%e3_871) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %387 = cute.get_scalars(%itup_875) : !cute.int_tuple<"?{div=8}">
      %coord_876 = cute.make_coord(%e1_864) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_877 = cute.make_coord(%itup_873) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %388 = cute.elem_less(%coord_876, %coord_877) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %388 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_878 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_879 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_880 = cute.crd2idx(%coord_878, %lay_879) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_881 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_882 = cute.add_offset(%iter_881, %idx_880) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_883 = cute.make_view(%tup_882) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_884 = cute.get_iter(%view_883) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_885, %e1_886, %e2_887, %e3_888 = cute.get_leaves(%iter_884) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %389 = cute.get_scalars(%e0_885) : !cute.int_tuple<"?">
      %390 = cute.get_scalars(%e1_886) : !cute.int_tuple<"?">
      %391 = cute.get_scalars(%e2_887) : !cute.int_tuple<"?">
      %392 = cute.get_scalars(%e3_888) : !cute.int_tuple<"?{div=8}">
      %iter_889 = cute.get_iter(%view_883) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_890, %e1_891, %e2_892, %e3_893 = cute.get_leaves(%iter_889) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %393 = cute.get_scalars(%e0_890) : !cute.int_tuple<"?">
      %394 = cute.get_scalars(%e1_891) : !cute.int_tuple<"?">
      %395 = cute.get_scalars(%e2_892) : !cute.int_tuple<"?">
      %396 = cute.get_scalars(%e3_893) : !cute.int_tuple<"?{div=8}">
      %iter_894 = cute.get_iter(%view_883) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_895, %e1_896, %e2_897, %e3_898 = cute.get_leaves(%iter_894) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %397 = cute.get_scalars(%e0_895) : !cute.int_tuple<"?">
      %398 = cute.get_scalars(%e1_896) : !cute.int_tuple<"?">
      %399 = cute.get_scalars(%e2_897) : !cute.int_tuple<"?">
      %400 = cute.get_scalars(%e3_898) : !cute.int_tuple<"?{div=8}">
      %lay_899 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %401 = cute.get_shape(%lay_899) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_900, %e1_901, %e2_902, %e3_903 = cute.get_leaves(%401) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_904 = cute.to_int_tuple(%e0_900) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %402 = cute.get_scalars(%itup_904) : !cute.int_tuple<"?">
      %itup_905 = cute.to_int_tuple(%e1_901) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %403 = cute.get_scalars(%itup_905) : !cute.int_tuple<"?">
      %itup_906 = cute.to_int_tuple(%e2_902) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %404 = cute.get_scalars(%itup_906) : !cute.int_tuple<"?">
      %itup_907 = cute.to_int_tuple(%e3_903) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %405 = cute.get_scalars(%itup_907) : !cute.int_tuple<"?{div=8}">
      %coord_908 = cute.make_coord(%e1_896) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_909 = cute.make_coord(%itup_905) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %406 = cute.elem_less(%coord_908, %coord_909) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %406 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %coord_910 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_911 = cute.get_layout(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_912 = cute.crd2idx(%coord_910, %lay_911) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_913 = cute.get_iter(%src_partitioned_490) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_914 = cute.add_offset(%iter_913, %idx_912) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_915 = cute.make_view(%tup_914) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_916 = cute.get_iter(%view_915) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_917, %e1_918, %e2_919, %e3_920 = cute.get_leaves(%iter_916) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %407 = cute.get_scalars(%e0_917) : !cute.int_tuple<"?">
      %408 = cute.get_scalars(%e1_918) : !cute.int_tuple<"?">
      %409 = cute.get_scalars(%e2_919) : !cute.int_tuple<"?">
      %410 = cute.get_scalars(%e3_920) : !cute.int_tuple<"?{div=8}">
      %iter_921 = cute.get_iter(%view_915) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_922, %e1_923, %e2_924, %e3_925 = cute.get_leaves(%iter_921) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %411 = cute.get_scalars(%e0_922) : !cute.int_tuple<"?">
      %412 = cute.get_scalars(%e1_923) : !cute.int_tuple<"?">
      %413 = cute.get_scalars(%e2_924) : !cute.int_tuple<"?">
      %414 = cute.get_scalars(%e3_925) : !cute.int_tuple<"?{div=8}">
      %iter_926 = cute.get_iter(%view_915) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_927, %e1_928, %e2_929, %e3_930 = cute.get_leaves(%iter_926) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %415 = cute.get_scalars(%e0_927) : !cute.int_tuple<"?">
      %416 = cute.get_scalars(%e1_928) : !cute.int_tuple<"?">
      %417 = cute.get_scalars(%e2_929) : !cute.int_tuple<"?">
      %418 = cute.get_scalars(%e3_930) : !cute.int_tuple<"?{div=8}">
      %lay_931 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %419 = cute.get_shape(%lay_931) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_932, %e1_933, %e2_934, %e3_935 = cute.get_leaves(%419) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_936 = cute.to_int_tuple(%e0_932) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %420 = cute.get_scalars(%itup_936) : !cute.int_tuple<"?">
      %itup_937 = cute.to_int_tuple(%e1_933) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %421 = cute.get_scalars(%itup_937) : !cute.int_tuple<"?">
      %itup_938 = cute.to_int_tuple(%e2_934) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %422 = cute.get_scalars(%itup_938) : !cute.int_tuple<"?">
      %itup_939 = cute.to_int_tuple(%e3_935) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %423 = cute.get_scalars(%itup_939) : !cute.int_tuple<"?{div=8}">
      %coord_940 = cute.make_coord(%e1_928) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_941 = cute.make_coord(%itup_937) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %424 = cute.elem_less(%coord_940, %coord_941) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %424 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7830 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_7832 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_7840 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_11
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_11
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7846 = cute.get_layout(%rmem_520) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_520) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_11
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_11
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_11
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_11
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_12
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_12
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_12
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_7832 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_11
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_11
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_11
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_11
      }
      %int_tuple_942 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_943 = cute.size(%int_tuple_942) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_944 = cute.get_leaves(%sz_943) : !cute.int_tuple<"4">
      %coord_945 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_946 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_947 = cute.crd2idx(%coord_945, %lay_946) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_948 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_949 = cute.add_offset(%iter_948, %idx_947) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_950 = cute.make_view(%tup_949) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_951 = cute.get_iter(%view_950) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_952, %e1_953, %e2_954, %e3_955 = cute.get_leaves(%iter_951) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %425 = cute.get_scalars(%e0_952) : !cute.int_tuple<"?">
      %426 = cute.get_scalars(%e1_953) : !cute.int_tuple<"?">
      %427 = cute.get_scalars(%e2_954) : !cute.int_tuple<"?">
      %428 = cute.get_scalars(%e3_955) : !cute.int_tuple<"?{div=8}">
      %iter_956 = cute.get_iter(%view_950) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_957, %e1_958, %e2_959, %e3_960 = cute.get_leaves(%iter_956) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %429 = cute.get_scalars(%e0_957) : !cute.int_tuple<"?">
      %430 = cute.get_scalars(%e1_958) : !cute.int_tuple<"?">
      %431 = cute.get_scalars(%e2_959) : !cute.int_tuple<"?">
      %432 = cute.get_scalars(%e3_960) : !cute.int_tuple<"?{div=8}">
      %iter_961 = cute.get_iter(%view_950) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_962, %e1_963, %e2_964, %e3_965 = cute.get_leaves(%iter_961) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %433 = cute.get_scalars(%e0_962) : !cute.int_tuple<"?">
      %434 = cute.get_scalars(%e1_963) : !cute.int_tuple<"?">
      %435 = cute.get_scalars(%e2_964) : !cute.int_tuple<"?">
      %436 = cute.get_scalars(%e3_965) : !cute.int_tuple<"?{div=8}">
      %lay_966 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %437 = cute.get_shape(%lay_966) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_967, %e1_968, %e2_969, %e3_970 = cute.get_leaves(%437) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_971 = cute.to_int_tuple(%e0_967) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %438 = cute.get_scalars(%itup_971) : !cute.int_tuple<"?">
      %itup_972 = cute.to_int_tuple(%e1_968) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %439 = cute.get_scalars(%itup_972) : !cute.int_tuple<"?">
      %itup_973 = cute.to_int_tuple(%e2_969) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %440 = cute.get_scalars(%itup_973) : !cute.int_tuple<"?">
      %itup_974 = cute.to_int_tuple(%e3_970) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %441 = cute.get_scalars(%itup_974) : !cute.int_tuple<"?{div=8}">
      %coord_975 = cute.make_coord(%e1_963) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_976 = cute.make_coord(%itup_972) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %442 = cute.elem_less(%coord_975, %coord_976) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %442 {
        %coord_7829 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,0,_,?)">
        %lay_7830 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7832 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_7840 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_14
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7846 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_14
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_14
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_15
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_7832 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_14
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_14
      }
      %coord_977 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_978 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_979 = cute.crd2idx(%coord_977, %lay_978) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_980 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_981 = cute.add_offset(%iter_980, %idx_979) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_982 = cute.make_view(%tup_981) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_983 = cute.get_iter(%view_982) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_984, %e1_985, %e2_986, %e3_987 = cute.get_leaves(%iter_983) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %443 = cute.get_scalars(%e0_984) : !cute.int_tuple<"?">
      %444 = cute.get_scalars(%e1_985) : !cute.int_tuple<"?">
      %445 = cute.get_scalars(%e2_986) : !cute.int_tuple<"?">
      %446 = cute.get_scalars(%e3_987) : !cute.int_tuple<"?{div=8}">
      %iter_988 = cute.get_iter(%view_982) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_989, %e1_990, %e2_991, %e3_992 = cute.get_leaves(%iter_988) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %447 = cute.get_scalars(%e0_989) : !cute.int_tuple<"?">
      %448 = cute.get_scalars(%e1_990) : !cute.int_tuple<"?">
      %449 = cute.get_scalars(%e2_991) : !cute.int_tuple<"?">
      %450 = cute.get_scalars(%e3_992) : !cute.int_tuple<"?{div=8}">
      %iter_993 = cute.get_iter(%view_982) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_994, %e1_995, %e2_996, %e3_997 = cute.get_leaves(%iter_993) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %451 = cute.get_scalars(%e0_994) : !cute.int_tuple<"?">
      %452 = cute.get_scalars(%e1_995) : !cute.int_tuple<"?">
      %453 = cute.get_scalars(%e2_996) : !cute.int_tuple<"?">
      %454 = cute.get_scalars(%e3_997) : !cute.int_tuple<"?{div=8}">
      %lay_998 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %455 = cute.get_shape(%lay_998) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_999, %e1_1000, %e2_1001, %e3_1002 = cute.get_leaves(%455) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1003 = cute.to_int_tuple(%e0_999) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %456 = cute.get_scalars(%itup_1003) : !cute.int_tuple<"?">
      %itup_1004 = cute.to_int_tuple(%e1_1000) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %457 = cute.get_scalars(%itup_1004) : !cute.int_tuple<"?">
      %itup_1005 = cute.to_int_tuple(%e2_1001) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %458 = cute.get_scalars(%itup_1005) : !cute.int_tuple<"?">
      %itup_1006 = cute.to_int_tuple(%e3_1002) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %459 = cute.get_scalars(%itup_1006) : !cute.int_tuple<"?{div=8}">
      %coord_1007 = cute.make_coord(%e1_995) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1008 = cute.make_coord(%itup_1004) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %460 = cute.elem_less(%coord_1007, %coord_1008) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %460 {
        %coord_7829 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,1,_,?)">
        %lay_7830 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7832 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_7840 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_14
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7846 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_14
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_14
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_15
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_7832 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_14
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_14
      }
      %coord_1009 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_1010 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1011 = cute.crd2idx(%coord_1009, %lay_1010) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_1012 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1013 = cute.add_offset(%iter_1012, %idx_1011) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1014 = cute.make_view(%tup_1013) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1015 = cute.get_iter(%view_1014) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1016, %e1_1017, %e2_1018, %e3_1019 = cute.get_leaves(%iter_1015) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %461 = cute.get_scalars(%e0_1016) : !cute.int_tuple<"?">
      %462 = cute.get_scalars(%e1_1017) : !cute.int_tuple<"?">
      %463 = cute.get_scalars(%e2_1018) : !cute.int_tuple<"?">
      %464 = cute.get_scalars(%e3_1019) : !cute.int_tuple<"?{div=8}">
      %iter_1020 = cute.get_iter(%view_1014) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1021, %e1_1022, %e2_1023, %e3_1024 = cute.get_leaves(%iter_1020) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %465 = cute.get_scalars(%e0_1021) : !cute.int_tuple<"?">
      %466 = cute.get_scalars(%e1_1022) : !cute.int_tuple<"?">
      %467 = cute.get_scalars(%e2_1023) : !cute.int_tuple<"?">
      %468 = cute.get_scalars(%e3_1024) : !cute.int_tuple<"?{div=8}">
      %iter_1025 = cute.get_iter(%view_1014) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1026, %e1_1027, %e2_1028, %e3_1029 = cute.get_leaves(%iter_1025) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %469 = cute.get_scalars(%e0_1026) : !cute.int_tuple<"?">
      %470 = cute.get_scalars(%e1_1027) : !cute.int_tuple<"?">
      %471 = cute.get_scalars(%e2_1028) : !cute.int_tuple<"?">
      %472 = cute.get_scalars(%e3_1029) : !cute.int_tuple<"?{div=8}">
      %lay_1030 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %473 = cute.get_shape(%lay_1030) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1031, %e1_1032, %e2_1033, %e3_1034 = cute.get_leaves(%473) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1035 = cute.to_int_tuple(%e0_1031) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %474 = cute.get_scalars(%itup_1035) : !cute.int_tuple<"?">
      %itup_1036 = cute.to_int_tuple(%e1_1032) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %475 = cute.get_scalars(%itup_1036) : !cute.int_tuple<"?">
      %itup_1037 = cute.to_int_tuple(%e2_1033) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %476 = cute.get_scalars(%itup_1037) : !cute.int_tuple<"?">
      %itup_1038 = cute.to_int_tuple(%e3_1034) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %477 = cute.get_scalars(%itup_1038) : !cute.int_tuple<"?{div=8}">
      %coord_1039 = cute.make_coord(%e1_1027) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1040 = cute.make_coord(%itup_1036) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %478 = cute.elem_less(%coord_1039, %coord_1040) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %478 {
        %coord_7829 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,2,_,?)">
        %lay_7830 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7832 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_7840 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_14
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7846 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_14
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_14
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_15
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_7832 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_14
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_14
      }
      %coord_1041 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1042 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1043 = cute.crd2idx(%coord_1041, %lay_1042) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1044 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1045 = cute.add_offset(%iter_1044, %idx_1043) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1046 = cute.make_view(%tup_1045) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1047 = cute.get_iter(%view_1046) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1048, %e1_1049, %e2_1050, %e3_1051 = cute.get_leaves(%iter_1047) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %479 = cute.get_scalars(%e0_1048) : !cute.int_tuple<"?">
      %480 = cute.get_scalars(%e1_1049) : !cute.int_tuple<"?">
      %481 = cute.get_scalars(%e2_1050) : !cute.int_tuple<"?">
      %482 = cute.get_scalars(%e3_1051) : !cute.int_tuple<"?{div=8}">
      %iter_1052 = cute.get_iter(%view_1046) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1053, %e1_1054, %e2_1055, %e3_1056 = cute.get_leaves(%iter_1052) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %483 = cute.get_scalars(%e0_1053) : !cute.int_tuple<"?">
      %484 = cute.get_scalars(%e1_1054) : !cute.int_tuple<"?">
      %485 = cute.get_scalars(%e2_1055) : !cute.int_tuple<"?">
      %486 = cute.get_scalars(%e3_1056) : !cute.int_tuple<"?{div=8}">
      %iter_1057 = cute.get_iter(%view_1046) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1058, %e1_1059, %e2_1060, %e3_1061 = cute.get_leaves(%iter_1057) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %487 = cute.get_scalars(%e0_1058) : !cute.int_tuple<"?">
      %488 = cute.get_scalars(%e1_1059) : !cute.int_tuple<"?">
      %489 = cute.get_scalars(%e2_1060) : !cute.int_tuple<"?">
      %490 = cute.get_scalars(%e3_1061) : !cute.int_tuple<"?{div=8}">
      %lay_1062 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %491 = cute.get_shape(%lay_1062) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1063, %e1_1064, %e2_1065, %e3_1066 = cute.get_leaves(%491) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1067 = cute.to_int_tuple(%e0_1063) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %492 = cute.get_scalars(%itup_1067) : !cute.int_tuple<"?">
      %itup_1068 = cute.to_int_tuple(%e1_1064) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %493 = cute.get_scalars(%itup_1068) : !cute.int_tuple<"?">
      %itup_1069 = cute.to_int_tuple(%e2_1065) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %494 = cute.get_scalars(%itup_1069) : !cute.int_tuple<"?">
      %itup_1070 = cute.to_int_tuple(%e3_1066) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %495 = cute.get_scalars(%itup_1070) : !cute.int_tuple<"?{div=8}">
      %coord_1071 = cute.make_coord(%e1_1059) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1072 = cute.make_coord(%itup_1068) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %496 = cute.elem_less(%coord_1071, %coord_1072) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %496 {
        %coord_7829 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,3,_,?)">
        %lay_7830 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7832 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_gmem_bf16_6
        %iter_7835 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %iter_7836 = cute.get_iter(%view_7834) : !memref_gmem_bf16_6
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_7840 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_smem_bf16_14
        %iter_7843 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %iter_7844 = cute.get_iter(%view_7842) : !memref_smem_bf16_14
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7846 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_gmem_bf16_6
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_gmem_bf16_6
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %lay_7867 = cute.get_layout(%view_7865) : !memref_gmem_bf16_6
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_gmem_bf16_6
        %view_7872 = cute.make_view(%iter_7871) : !memref_gmem_bf16_7
        %iter_7873 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7874 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %lay_7875 = cute.get_layout(%view_7842) : !memref_smem_bf16_14
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_smem_bf16_14
        %iter_7880 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %lay_7881 = cute.get_layout(%view_7879) : !memref_smem_bf16_14
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_smem_bf16_14
        %view_7886 = cute.make_view(%iter_7885) : !memref_smem_bf16_15
        %iter_7887 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %iter_7888 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_gmem_bf16_7
        %iter_7917 = cute.get_iter(%view_7886) : !memref_smem_bf16_15
        %lay_7918 = cute.get_layout(%view_7872) : !memref_gmem_bf16_7
        %lay_7919 = cute.get_layout(%view_7886) : !memref_smem_bf16_15
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7830 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_7832 = cute.get_iter(%dst_partitioned_295) : !memref_smem_bf16_4
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_smem_bf16_14
        %iter_7835 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %iter_7836 = cute.get_iter(%view_7834) : !memref_smem_bf16_14
        %lay_7837 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %sz_7838 = cute.size(%lay_7837) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7839 = cute.get_leaves(%sz_7838) : !cute.int_tuple<"16">
        %lay_7840 = cute.get_layout(%view_7834) : !memref_smem_bf16_14
        %2493 = cute.get_shape(%lay_7840) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7841, %e1_7842, %e2_7843 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %int_tuple_7844 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7845 = cute.tuple.product(%int_tuple_7844) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7846 = cute.get_leaves(%res_7845) : !cute.int_tuple<"16">
        %cst_7847 = arith.constant 0.000000e+00 : bf16
        %2494 = vector.splat %cst_7847 : vector<16xbf16>
        %int_tuple_7848 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7849 = cute.size(%int_tuple_7848) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"16">
        %int_tuple_7851 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7852 = cute.size(%int_tuple_7851) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7853 = cute.get_leaves(%sz_7852) : !cute.int_tuple<"16">
        cute.memref.store_vec %2494, %view_7834 : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %shape_1073 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1074 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1075 = cute.memref.alloca(%lay_1074) : !memref_rmem_f32_1
      %iter_1076 = cute.get_iter(%rmem_1075) : !memref_rmem_f32_1
      %iter_1077 = cute.get_iter(%rmem_1075) : !memref_rmem_f32_1
      %shape_1078 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1079 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1080 = cute.memref.alloca(%lay_1079) : !memref_rmem_f32_1
      %iter_1081 = cute.get_iter(%rmem_1080) : !memref_rmem_f32_1
      %iter_1082 = cute.get_iter(%rmem_1080) : !memref_rmem_f32_1
      %lay_1083 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
      %sz_1084 = cute.size(%lay_1083) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1085 = cute.get_leaves(%sz_1084) : !cute.int_tuple<"4">
      %lay_1086 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
      %497 = cute.get_shape(%lay_1086) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1087 = cute.get_leaves(%497) : !cute.shape<"4">
      %cst_1088 = arith.constant 0xFF800000 : f32
      %498 = vector.splat %cst_1088 : vector<4xf32>
      %int_tuple_1089 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1090 = cute.size(%int_tuple_1089) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1091 = cute.get_leaves(%sz_1090) : !cute.int_tuple<"4">
      %int_tuple_1092 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1093 = cute.size(%int_tuple_1092) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1094 = cute.get_leaves(%sz_1093) : !cute.int_tuple<"4">
      cute.memref.store_vec %498, %rmem_1075 : !memref_rmem_f32_1
      %lay_1095 = cute.get_layout(%rmem_1080) : !memref_rmem_f32_1
      %sz_1096 = cute.size(%lay_1095) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1097 = cute.get_leaves(%sz_1096) : !cute.int_tuple<"4">
      %lay_1098 = cute.get_layout(%rmem_1080) : !memref_rmem_f32_1
      %499 = cute.get_shape(%lay_1098) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1099 = cute.get_leaves(%499) : !cute.shape<"4">
      %cst_1100 = arith.constant 0.000000e+00 : f32
      %500 = vector.splat %cst_1100 : vector<4xf32>
      %int_tuple_1101 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1102 = cute.size(%int_tuple_1101) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1103 = cute.get_leaves(%sz_1102) : !cute.int_tuple<"4">
      %int_tuple_1104 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1105 = cute.size(%int_tuple_1104) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1106 = cute.get_leaves(%sz_1105) : !cute.int_tuple<"4">
      cute.memref.store_vec %500, %rmem_1080 : !memref_rmem_f32_1
      %c0_i32 = arith.constant 0 : i32
      %501 = arith.subi %128, %c0_i32 : i32
      %502 = arith.subi %501, %c1_i32 : i32
      %shape_1107 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %503 = cute.tiled.mma.partition_shape C (%5, %shape_1107) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1108, %e1_1109, %e2_1110, %e3_1111 = cute.get_leaves(%503) : !cute.shape<"((2,2),2,8)">
      %shape_1112 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_1113 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_1114 = cute.memref.alloca(%lay_1113) : !memref_rmem_f32_2
      %iter_1115 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_1116 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_1117 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %sz_1118 = cute.size(%lay_1117) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
      %e0_1119 = cute.get_leaves(%sz_1118) : !cute.int_tuple<"64">
      %lay_1120 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %504 = cute.get_shape(%lay_1120) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1121, %e1_1122, %e2_1123, %e3_1124 = cute.get_leaves(%504) : !cute.shape<"((2,2),2,8)">
      %int_tuple_1125 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %res_1126 = cute.tuple.product(%int_tuple_1125) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1127 = cute.get_leaves(%res_1126) : !cute.int_tuple<"64">
      %cst_1128 = arith.constant 0.000000e+00 : f32
      %505 = vector.splat %cst_1128 : vector<64xf32>
      %int_tuple_1129 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1130 = cute.size(%int_tuple_1129) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1131 = cute.get_leaves(%sz_1130) : !cute.int_tuple<"64">
      %int_tuple_1132 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1133 = cute.size(%int_tuple_1132) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1134 = cute.get_leaves(%sz_1133) : !cute.int_tuple<"64">
      cute.memref.store_vec %505, %rmem_1114 : !memref_rmem_f32_2
      nvvm.cp.async.wait.group 0
      %c1_i32_1135 = arith.constant 1 : i32
      %c128_i32_1136 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1135 number_of_threads = %c128_i32_1136
      %true = arith.constant true
      scf.if %true {
        %lay_7829 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
        %2493 = cute.get_shape(%lay_7829) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7830, %e1_7831, %e2_7832, %e3_7833 = cute.get_leaves(%2493) : !cute.shape<"((8,1),4,2)">
        %int_tuple_7834 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7835 = cute.size(%int_tuple_7834) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7836 = cute.get_leaves(%sz_7835) : !cute.int_tuple<"4">
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
        %lay_7838 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
        %iter_7840 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7842 = cute.make_view(%tup_7841) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7843 = cute.get_iter(%view_7842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7844, %e1_7845, %e2_7846, %e3_7847 = cute.get_leaves(%iter_7843) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2494 = cute.get_scalars(%e0_7844) : !cute.int_tuple<"?">
        %2495 = cute.get_scalars(%e1_7845) : !cute.int_tuple<"?">
        %2496 = cute.get_scalars(%e2_7846) : !cute.int_tuple<"?">
        %2497 = cute.get_scalars(%e3_7847) : !cute.int_tuple<"?{div=8}">
        %iter_7848 = cute.get_iter(%view_7842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7849, %e1_7850, %e2_7851, %e3_7852 = cute.get_leaves(%iter_7848) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2498 = cute.get_scalars(%e0_7849) : !cute.int_tuple<"?">
        %2499 = cute.get_scalars(%e1_7850) : !cute.int_tuple<"?">
        %2500 = cute.get_scalars(%e2_7851) : !cute.int_tuple<"?">
        %2501 = cute.get_scalars(%e3_7852) : !cute.int_tuple<"?{div=8}">
        %iter_7853 = cute.get_iter(%view_7842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7854, %e1_7855, %e2_7856, %e3_7857 = cute.get_leaves(%iter_7853) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2502 = cute.get_scalars(%e0_7854) : !cute.int_tuple<"?">
        %2503 = cute.get_scalars(%e1_7855) : !cute.int_tuple<"?">
        %2504 = cute.get_scalars(%e2_7856) : !cute.int_tuple<"?">
        %2505 = cute.get_scalars(%e3_7857) : !cute.int_tuple<"?{div=8}">
        %lay_7858 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2506 = cute.get_shape(%lay_7858) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7859, %e1_7860, %e2_7861, %e3_7862 = cute.get_leaves(%2506) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7863 = cute.to_int_tuple(%e0_7859) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2507 = cute.get_scalars(%itup_7863) : !cute.int_tuple<"?">
        %itup_7864 = cute.to_int_tuple(%e1_7860) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2508 = cute.get_scalars(%itup_7864) : !cute.int_tuple<"?">
        %itup_7865 = cute.to_int_tuple(%e2_7861) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2509 = cute.get_scalars(%itup_7865) : !cute.int_tuple<"?">
        %itup_7866 = cute.to_int_tuple(%e3_7862) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2510 = cute.get_scalars(%itup_7866) : !cute.int_tuple<"?{div=8}">
        %coord_7867 = cute.make_coord(%e1_7855) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7868 = cute.make_coord(%itup_7864) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2511 = cute.elem_less(%coord_7867, %coord_7868) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2511 {
          %coord_7965 = cute.make_coord(%502) : (i32) -> !cute.coord<"(_,0,_,?)">
          %lay_7966 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_7968 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_gmem_bf16_6
          %iter_7971 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %iter_7972 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %coord_7973 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7974 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7975 = cute.crd2idx(%coord_7973, %lay_7974) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_7976 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7977 = cute.add_offset(%iter_7976, %idx_7975) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7978 = cute.make_view(%ptr_7977) : !memref_smem_bf16_14
          %iter_7979 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %iter_7980 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %coord_7981 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7982 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %idx_7983 = cute.crd2idx(%coord_7981, %lay_7982) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7984 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
          %ptr_7985 = cute.add_offset(%iter_7984, %idx_7983) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7986 = cute.make_view(%ptr_7985) : !memref_rmem_i8_2
          %iter_7987 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %iter_7988 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %lay_7989 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %2566 = cute.get_shape(%lay_7989) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7990, %e1_7991, %e2_7992 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %lay_7993 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %2567 = cute.get_shape(%lay_7993) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7994, %e1_7995, %e2_7996 = cute.get_leaves(%2567) : !cute.shape<"((8,1),2)">
          %lay_7997 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %shape_7998 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7999 = cute.make_layout() : !cute.layout<"1:0">
          %append_8000 = cute.append_to_rank<2> (%lay_7997, %lay_7999) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8001 = cute.make_view(%iter_7972, %append_8000) : !memref_gmem_bf16_6
          %iter_8002 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %lay_8003 = cute.get_layout(%view_8001) : !memref_gmem_bf16_6
          %2568 = cute.get_shape(%lay_8003) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8004, %e1_8005, %e2_8006 = cute.get_leaves(%2568) : !cute.shape<"((8,1),2)">
          %iter_8007 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %view_8008 = cute.make_view(%iter_8007) : !memref_gmem_bf16_7
          %iter_8009 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8010 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %lay_8011 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %shape_8012 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8013 = cute.make_layout() : !cute.layout<"1:0">
          %append_8014 = cute.append_to_rank<2> (%lay_8011, %lay_8013) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8015 = cute.make_view(%iter_7980, %append_8014) : !memref_smem_bf16_14
          %iter_8016 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %lay_8017 = cute.get_layout(%view_8015) : !memref_smem_bf16_14
          %2569 = cute.get_shape(%lay_8017) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8018, %e1_8019, %e2_8020 = cute.get_leaves(%2569) : !cute.shape<"((8,1),2)">
          %iter_8021 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %view_8022 = cute.make_view(%iter_8021) : !memref_smem_bf16_15
          %iter_8023 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %iter_8024 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8025 = cute.get_layout(%view_7986) : !memref_rmem_i8_2
          %shape_8026 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8027 = cute.make_layout() : !cute.layout<"1:0">
          %append_8028 = cute.append_to_rank<2> (%lay_8025, %lay_8027) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8029 = cute.make_view(%iter_7988, %append_8028) : !memref_rmem_i8_2
          %iter_8030 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %lay_8031 = cute.get_layout(%view_8029) : !memref_rmem_i8_2
          %2570 = cute.get_shape(%lay_8031) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8032, %e1_8033 = cute.get_leaves(%2570) : !cute.shape<"(1,2)">
          %iter_8034 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %view_8035 = cute.make_view(%iter_8034) : !memref_rmem_i8_3
          %iter_8036 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %iter_8037 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8038 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %2571 = cute.get_shape(%lay_8038) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8039, %e1_8040, %e2_8041 = cute.get_leaves(%2571) : !cute.shape<"((8,1),(2))">
          %lay_8042 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %2572 = cute.get_shape(%lay_8042) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8043, %e1_8044, %e2_8045 = cute.get_leaves(%2572) : !cute.shape<"((8,1),(2))">
          %lay_8046 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %sz_8047 = cute.size(%lay_8046) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8048 = cute.get_leaves(%sz_8047) : !cute.int_tuple<"2">
          %lay_8049 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %sz_8050 = cute.size(%lay_8049) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8051 = cute.get_leaves(%sz_8050) : !cute.int_tuple<"2">
          %2573 = cute.static : !cute.layout<"1:0">
          %iter_8052 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8053 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8054 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %lay_8055 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %append_8056 = cute.append_to_rank<2> (%lay_8054, %2573) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8057 = cute.append_to_rank<2> (%lay_8055, %2573) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8058 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8059 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8060 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8061 = cute.get_layout(%view_8035) : !memref_rmem_i8_3
          %append_8062 = cute.append_to_rank<2> (%lay_8061, %2573) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8063 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8064 = cute.size(%lay_8058) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2574 = cute.get_scalars(%sz_8064) : !cute.int_tuple<"2">
          %c0_i32_8065 = arith.constant 0 : i32
          %c1_i32_8066 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8065 to %2574 step %c1_i32_8066  : i32 {
            %coord_8067 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_8068 = cute.slice(%lay_8058, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_8069 = cute.crd2idx(%coord_8067, %lay_8058) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8070 = cute.add_offset(%iter_8052, %idx_8069) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8071 = cute.make_view(%ptr_8070, %slice_8068) : !memref_gmem_bf16_8
            %slice_8072 = cute.slice(%lay_8059, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_8073 = cute.crd2idx(%coord_8067, %lay_8059) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8074 = cute.add_offset(%iter_8053, %idx_8073) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8075 = cute.make_view(%ptr_8074, %slice_8072) : !memref_smem_bf16_13
            %slice_8076 = cute.slice(%lay_8063, %coord_8067) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_8077 = cute.crd2idx(%coord_8067, %lay_8063) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8078 = cute.add_offset(%iter_8060, %idx_8077) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8079 = cute.make_view(%ptr_8078, %slice_8076) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_8071, %view_8075, %view_8079) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7965 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7966 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_7968 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_smem_bf16_14
          %iter_7971 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %iter_7972 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %lay_7973 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %sz_7974 = cute.size(%lay_7973) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7975 = cute.get_leaves(%sz_7974) : !cute.int_tuple<"16">
          %lay_7976 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %2566 = cute.get_shape(%lay_7976) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7977, %e1_7978, %e2_7979 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %int_tuple_7980 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7981 = cute.tuple.product(%int_tuple_7980) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7982 = cute.get_leaves(%res_7981) : !cute.int_tuple<"16">
          %cst_7983 = arith.constant 0.000000e+00 : bf16
          %2567 = vector.splat %cst_7983 : vector<16xbf16>
          %int_tuple_7984 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7985 = cute.size(%int_tuple_7984) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7986 = cute.get_leaves(%sz_7985) : !cute.int_tuple<"16">
          %int_tuple_7987 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7988 = cute.size(%int_tuple_7987) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7989 = cute.get_leaves(%sz_7988) : !cute.int_tuple<"16">
          cute.memref.store_vec %2567, %view_7970 : !memref_smem_bf16_14
        }
        %coord_7869 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
        %lay_7870 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
        %iter_7872 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7874 = cute.make_view(%tup_7873) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7875 = cute.get_iter(%view_7874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7876, %e1_7877, %e2_7878, %e3_7879 = cute.get_leaves(%iter_7875) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2512 = cute.get_scalars(%e0_7876) : !cute.int_tuple<"?">
        %2513 = cute.get_scalars(%e1_7877) : !cute.int_tuple<"?">
        %2514 = cute.get_scalars(%e2_7878) : !cute.int_tuple<"?">
        %2515 = cute.get_scalars(%e3_7879) : !cute.int_tuple<"?{div=8}">
        %iter_7880 = cute.get_iter(%view_7874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7881, %e1_7882, %e2_7883, %e3_7884 = cute.get_leaves(%iter_7880) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2516 = cute.get_scalars(%e0_7881) : !cute.int_tuple<"?">
        %2517 = cute.get_scalars(%e1_7882) : !cute.int_tuple<"?">
        %2518 = cute.get_scalars(%e2_7883) : !cute.int_tuple<"?">
        %2519 = cute.get_scalars(%e3_7884) : !cute.int_tuple<"?{div=8}">
        %iter_7885 = cute.get_iter(%view_7874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7886, %e1_7887, %e2_7888, %e3_7889 = cute.get_leaves(%iter_7885) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2520 = cute.get_scalars(%e0_7886) : !cute.int_tuple<"?">
        %2521 = cute.get_scalars(%e1_7887) : !cute.int_tuple<"?">
        %2522 = cute.get_scalars(%e2_7888) : !cute.int_tuple<"?">
        %2523 = cute.get_scalars(%e3_7889) : !cute.int_tuple<"?{div=8}">
        %lay_7890 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2524 = cute.get_shape(%lay_7890) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7891, %e1_7892, %e2_7893, %e3_7894 = cute.get_leaves(%2524) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7895 = cute.to_int_tuple(%e0_7891) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2525 = cute.get_scalars(%itup_7895) : !cute.int_tuple<"?">
        %itup_7896 = cute.to_int_tuple(%e1_7892) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2526 = cute.get_scalars(%itup_7896) : !cute.int_tuple<"?">
        %itup_7897 = cute.to_int_tuple(%e2_7893) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2527 = cute.get_scalars(%itup_7897) : !cute.int_tuple<"?">
        %itup_7898 = cute.to_int_tuple(%e3_7894) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2528 = cute.get_scalars(%itup_7898) : !cute.int_tuple<"?{div=8}">
        %coord_7899 = cute.make_coord(%e1_7887) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7900 = cute.make_coord(%itup_7896) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2529 = cute.elem_less(%coord_7899, %coord_7900) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2529 {
          %coord_7965 = cute.make_coord(%502) : (i32) -> !cute.coord<"(_,1,_,?)">
          %lay_7966 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_7968 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_gmem_bf16_6
          %iter_7971 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %iter_7972 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %coord_7973 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7974 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7975 = cute.crd2idx(%coord_7973, %lay_7974) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_7976 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7977 = cute.add_offset(%iter_7976, %idx_7975) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7978 = cute.make_view(%ptr_7977) : !memref_smem_bf16_14
          %iter_7979 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %iter_7980 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %coord_7981 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7982 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %idx_7983 = cute.crd2idx(%coord_7981, %lay_7982) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7984 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
          %ptr_7985 = cute.add_offset(%iter_7984, %idx_7983) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7986 = cute.make_view(%ptr_7985) : !memref_rmem_i8_2
          %iter_7987 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %iter_7988 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %lay_7989 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %2566 = cute.get_shape(%lay_7989) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7990, %e1_7991, %e2_7992 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %lay_7993 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %2567 = cute.get_shape(%lay_7993) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7994, %e1_7995, %e2_7996 = cute.get_leaves(%2567) : !cute.shape<"((8,1),2)">
          %lay_7997 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %shape_7998 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7999 = cute.make_layout() : !cute.layout<"1:0">
          %append_8000 = cute.append_to_rank<2> (%lay_7997, %lay_7999) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8001 = cute.make_view(%iter_7972, %append_8000) : !memref_gmem_bf16_6
          %iter_8002 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %lay_8003 = cute.get_layout(%view_8001) : !memref_gmem_bf16_6
          %2568 = cute.get_shape(%lay_8003) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8004, %e1_8005, %e2_8006 = cute.get_leaves(%2568) : !cute.shape<"((8,1),2)">
          %iter_8007 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %view_8008 = cute.make_view(%iter_8007) : !memref_gmem_bf16_7
          %iter_8009 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8010 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %lay_8011 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %shape_8012 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8013 = cute.make_layout() : !cute.layout<"1:0">
          %append_8014 = cute.append_to_rank<2> (%lay_8011, %lay_8013) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8015 = cute.make_view(%iter_7980, %append_8014) : !memref_smem_bf16_14
          %iter_8016 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %lay_8017 = cute.get_layout(%view_8015) : !memref_smem_bf16_14
          %2569 = cute.get_shape(%lay_8017) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8018, %e1_8019, %e2_8020 = cute.get_leaves(%2569) : !cute.shape<"((8,1),2)">
          %iter_8021 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %view_8022 = cute.make_view(%iter_8021) : !memref_smem_bf16_15
          %iter_8023 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %iter_8024 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8025 = cute.get_layout(%view_7986) : !memref_rmem_i8_2
          %shape_8026 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8027 = cute.make_layout() : !cute.layout<"1:0">
          %append_8028 = cute.append_to_rank<2> (%lay_8025, %lay_8027) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8029 = cute.make_view(%iter_7988, %append_8028) : !memref_rmem_i8_2
          %iter_8030 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %lay_8031 = cute.get_layout(%view_8029) : !memref_rmem_i8_2
          %2570 = cute.get_shape(%lay_8031) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8032, %e1_8033 = cute.get_leaves(%2570) : !cute.shape<"(1,2)">
          %iter_8034 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %view_8035 = cute.make_view(%iter_8034) : !memref_rmem_i8_3
          %iter_8036 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %iter_8037 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8038 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %2571 = cute.get_shape(%lay_8038) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8039, %e1_8040, %e2_8041 = cute.get_leaves(%2571) : !cute.shape<"((8,1),(2))">
          %lay_8042 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %2572 = cute.get_shape(%lay_8042) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8043, %e1_8044, %e2_8045 = cute.get_leaves(%2572) : !cute.shape<"((8,1),(2))">
          %lay_8046 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %sz_8047 = cute.size(%lay_8046) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8048 = cute.get_leaves(%sz_8047) : !cute.int_tuple<"2">
          %lay_8049 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %sz_8050 = cute.size(%lay_8049) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8051 = cute.get_leaves(%sz_8050) : !cute.int_tuple<"2">
          %2573 = cute.static : !cute.layout<"1:0">
          %iter_8052 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8053 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8054 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %lay_8055 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %append_8056 = cute.append_to_rank<2> (%lay_8054, %2573) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8057 = cute.append_to_rank<2> (%lay_8055, %2573) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8058 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8059 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8060 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8061 = cute.get_layout(%view_8035) : !memref_rmem_i8_3
          %append_8062 = cute.append_to_rank<2> (%lay_8061, %2573) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8063 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8064 = cute.size(%lay_8058) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2574 = cute.get_scalars(%sz_8064) : !cute.int_tuple<"2">
          %c0_i32_8065 = arith.constant 0 : i32
          %c1_i32_8066 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8065 to %2574 step %c1_i32_8066  : i32 {
            %coord_8067 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_8068 = cute.slice(%lay_8058, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_8069 = cute.crd2idx(%coord_8067, %lay_8058) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8070 = cute.add_offset(%iter_8052, %idx_8069) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8071 = cute.make_view(%ptr_8070, %slice_8068) : !memref_gmem_bf16_8
            %slice_8072 = cute.slice(%lay_8059, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_8073 = cute.crd2idx(%coord_8067, %lay_8059) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8074 = cute.add_offset(%iter_8053, %idx_8073) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8075 = cute.make_view(%ptr_8074, %slice_8072) : !memref_smem_bf16_13
            %slice_8076 = cute.slice(%lay_8063, %coord_8067) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_8077 = cute.crd2idx(%coord_8067, %lay_8063) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8078 = cute.add_offset(%iter_8060, %idx_8077) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8079 = cute.make_view(%ptr_8078, %slice_8076) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_8071, %view_8075, %view_8079) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7965 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7966 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_7968 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_smem_bf16_14
          %iter_7971 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %iter_7972 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %lay_7973 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %sz_7974 = cute.size(%lay_7973) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7975 = cute.get_leaves(%sz_7974) : !cute.int_tuple<"16">
          %lay_7976 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %2566 = cute.get_shape(%lay_7976) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7977, %e1_7978, %e2_7979 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %int_tuple_7980 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7981 = cute.tuple.product(%int_tuple_7980) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7982 = cute.get_leaves(%res_7981) : !cute.int_tuple<"16">
          %cst_7983 = arith.constant 0.000000e+00 : bf16
          %2567 = vector.splat %cst_7983 : vector<16xbf16>
          %int_tuple_7984 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7985 = cute.size(%int_tuple_7984) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7986 = cute.get_leaves(%sz_7985) : !cute.int_tuple<"16">
          %int_tuple_7987 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7988 = cute.size(%int_tuple_7987) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7989 = cute.get_leaves(%sz_7988) : !cute.int_tuple<"16">
          cute.memref.store_vec %2567, %view_7970 : !memref_smem_bf16_14
        }
        %coord_7901 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
        %lay_7902 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7903 = cute.crd2idx(%coord_7901, %lay_7902) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
        %iter_7904 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7905 = cute.add_offset(%iter_7904, %idx_7903) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7906 = cute.make_view(%tup_7905) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7907 = cute.get_iter(%view_7906) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7908, %e1_7909, %e2_7910, %e3_7911 = cute.get_leaves(%iter_7907) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2530 = cute.get_scalars(%e0_7908) : !cute.int_tuple<"?">
        %2531 = cute.get_scalars(%e1_7909) : !cute.int_tuple<"?">
        %2532 = cute.get_scalars(%e2_7910) : !cute.int_tuple<"?">
        %2533 = cute.get_scalars(%e3_7911) : !cute.int_tuple<"?{div=8}">
        %iter_7912 = cute.get_iter(%view_7906) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7913, %e1_7914, %e2_7915, %e3_7916 = cute.get_leaves(%iter_7912) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2534 = cute.get_scalars(%e0_7913) : !cute.int_tuple<"?">
        %2535 = cute.get_scalars(%e1_7914) : !cute.int_tuple<"?">
        %2536 = cute.get_scalars(%e2_7915) : !cute.int_tuple<"?">
        %2537 = cute.get_scalars(%e3_7916) : !cute.int_tuple<"?{div=8}">
        %iter_7917 = cute.get_iter(%view_7906) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7918, %e1_7919, %e2_7920, %e3_7921 = cute.get_leaves(%iter_7917) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2538 = cute.get_scalars(%e0_7918) : !cute.int_tuple<"?">
        %2539 = cute.get_scalars(%e1_7919) : !cute.int_tuple<"?">
        %2540 = cute.get_scalars(%e2_7920) : !cute.int_tuple<"?">
        %2541 = cute.get_scalars(%e3_7921) : !cute.int_tuple<"?{div=8}">
        %lay_7922 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2542 = cute.get_shape(%lay_7922) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7923, %e1_7924, %e2_7925, %e3_7926 = cute.get_leaves(%2542) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7927 = cute.to_int_tuple(%e0_7923) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2543 = cute.get_scalars(%itup_7927) : !cute.int_tuple<"?">
        %itup_7928 = cute.to_int_tuple(%e1_7924) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2544 = cute.get_scalars(%itup_7928) : !cute.int_tuple<"?">
        %itup_7929 = cute.to_int_tuple(%e2_7925) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2545 = cute.get_scalars(%itup_7929) : !cute.int_tuple<"?">
        %itup_7930 = cute.to_int_tuple(%e3_7926) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2546 = cute.get_scalars(%itup_7930) : !cute.int_tuple<"?{div=8}">
        %coord_7931 = cute.make_coord(%e1_7919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7932 = cute.make_coord(%itup_7928) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2547 = cute.elem_less(%coord_7931, %coord_7932) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2547 {
          %coord_7965 = cute.make_coord(%502) : (i32) -> !cute.coord<"(_,2,_,?)">
          %lay_7966 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
          %iter_7968 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_gmem_bf16_6
          %iter_7971 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %iter_7972 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %coord_7973 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7974 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7975 = cute.crd2idx(%coord_7973, %lay_7974) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_7976 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7977 = cute.add_offset(%iter_7976, %idx_7975) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7978 = cute.make_view(%ptr_7977) : !memref_smem_bf16_14
          %iter_7979 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %iter_7980 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %coord_7981 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7982 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %idx_7983 = cute.crd2idx(%coord_7981, %lay_7982) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7984 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
          %ptr_7985 = cute.add_offset(%iter_7984, %idx_7983) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7986 = cute.make_view(%ptr_7985) : !memref_rmem_i8_2
          %iter_7987 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %iter_7988 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %lay_7989 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %2566 = cute.get_shape(%lay_7989) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7990, %e1_7991, %e2_7992 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %lay_7993 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %2567 = cute.get_shape(%lay_7993) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7994, %e1_7995, %e2_7996 = cute.get_leaves(%2567) : !cute.shape<"((8,1),2)">
          %lay_7997 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %shape_7998 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7999 = cute.make_layout() : !cute.layout<"1:0">
          %append_8000 = cute.append_to_rank<2> (%lay_7997, %lay_7999) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8001 = cute.make_view(%iter_7972, %append_8000) : !memref_gmem_bf16_6
          %iter_8002 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %lay_8003 = cute.get_layout(%view_8001) : !memref_gmem_bf16_6
          %2568 = cute.get_shape(%lay_8003) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8004, %e1_8005, %e2_8006 = cute.get_leaves(%2568) : !cute.shape<"((8,1),2)">
          %iter_8007 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %view_8008 = cute.make_view(%iter_8007) : !memref_gmem_bf16_7
          %iter_8009 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8010 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %lay_8011 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %shape_8012 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8013 = cute.make_layout() : !cute.layout<"1:0">
          %append_8014 = cute.append_to_rank<2> (%lay_8011, %lay_8013) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8015 = cute.make_view(%iter_7980, %append_8014) : !memref_smem_bf16_14
          %iter_8016 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %lay_8017 = cute.get_layout(%view_8015) : !memref_smem_bf16_14
          %2569 = cute.get_shape(%lay_8017) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8018, %e1_8019, %e2_8020 = cute.get_leaves(%2569) : !cute.shape<"((8,1),2)">
          %iter_8021 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %view_8022 = cute.make_view(%iter_8021) : !memref_smem_bf16_15
          %iter_8023 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %iter_8024 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8025 = cute.get_layout(%view_7986) : !memref_rmem_i8_2
          %shape_8026 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8027 = cute.make_layout() : !cute.layout<"1:0">
          %append_8028 = cute.append_to_rank<2> (%lay_8025, %lay_8027) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8029 = cute.make_view(%iter_7988, %append_8028) : !memref_rmem_i8_2
          %iter_8030 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %lay_8031 = cute.get_layout(%view_8029) : !memref_rmem_i8_2
          %2570 = cute.get_shape(%lay_8031) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8032, %e1_8033 = cute.get_leaves(%2570) : !cute.shape<"(1,2)">
          %iter_8034 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %view_8035 = cute.make_view(%iter_8034) : !memref_rmem_i8_3
          %iter_8036 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %iter_8037 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8038 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %2571 = cute.get_shape(%lay_8038) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8039, %e1_8040, %e2_8041 = cute.get_leaves(%2571) : !cute.shape<"((8,1),(2))">
          %lay_8042 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %2572 = cute.get_shape(%lay_8042) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8043, %e1_8044, %e2_8045 = cute.get_leaves(%2572) : !cute.shape<"((8,1),(2))">
          %lay_8046 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %sz_8047 = cute.size(%lay_8046) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8048 = cute.get_leaves(%sz_8047) : !cute.int_tuple<"2">
          %lay_8049 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %sz_8050 = cute.size(%lay_8049) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8051 = cute.get_leaves(%sz_8050) : !cute.int_tuple<"2">
          %2573 = cute.static : !cute.layout<"1:0">
          %iter_8052 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8053 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8054 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %lay_8055 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %append_8056 = cute.append_to_rank<2> (%lay_8054, %2573) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8057 = cute.append_to_rank<2> (%lay_8055, %2573) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8058 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8059 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8060 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8061 = cute.get_layout(%view_8035) : !memref_rmem_i8_3
          %append_8062 = cute.append_to_rank<2> (%lay_8061, %2573) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8063 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8064 = cute.size(%lay_8058) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2574 = cute.get_scalars(%sz_8064) : !cute.int_tuple<"2">
          %c0_i32_8065 = arith.constant 0 : i32
          %c1_i32_8066 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8065 to %2574 step %c1_i32_8066  : i32 {
            %coord_8067 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_8068 = cute.slice(%lay_8058, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_8069 = cute.crd2idx(%coord_8067, %lay_8058) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8070 = cute.add_offset(%iter_8052, %idx_8069) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8071 = cute.make_view(%ptr_8070, %slice_8068) : !memref_gmem_bf16_8
            %slice_8072 = cute.slice(%lay_8059, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_8073 = cute.crd2idx(%coord_8067, %lay_8059) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8074 = cute.add_offset(%iter_8053, %idx_8073) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8075 = cute.make_view(%ptr_8074, %slice_8072) : !memref_smem_bf16_13
            %slice_8076 = cute.slice(%lay_8063, %coord_8067) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_8077 = cute.crd2idx(%coord_8067, %lay_8063) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8078 = cute.add_offset(%iter_8060, %idx_8077) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8079 = cute.make_view(%ptr_8078, %slice_8076) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_8071, %view_8075, %view_8079) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7965 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7966 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_7968 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_smem_bf16_14
          %iter_7971 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %iter_7972 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %lay_7973 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %sz_7974 = cute.size(%lay_7973) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7975 = cute.get_leaves(%sz_7974) : !cute.int_tuple<"16">
          %lay_7976 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %2566 = cute.get_shape(%lay_7976) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7977, %e1_7978, %e2_7979 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %int_tuple_7980 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7981 = cute.tuple.product(%int_tuple_7980) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7982 = cute.get_leaves(%res_7981) : !cute.int_tuple<"16">
          %cst_7983 = arith.constant 0.000000e+00 : bf16
          %2567 = vector.splat %cst_7983 : vector<16xbf16>
          %int_tuple_7984 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7985 = cute.size(%int_tuple_7984) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7986 = cute.get_leaves(%sz_7985) : !cute.int_tuple<"16">
          %int_tuple_7987 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7988 = cute.size(%int_tuple_7987) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7989 = cute.get_leaves(%sz_7988) : !cute.int_tuple<"16">
          cute.memref.store_vec %2567, %view_7970 : !memref_smem_bf16_14
        }
        %coord_7933 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
        %lay_7934 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7935 = cute.crd2idx(%coord_7933, %lay_7934) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
        %iter_7936 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7937 = cute.add_offset(%iter_7936, %idx_7935) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7938 = cute.make_view(%tup_7937) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7939 = cute.get_iter(%view_7938) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7940, %e1_7941, %e2_7942, %e3_7943 = cute.get_leaves(%iter_7939) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2548 = cute.get_scalars(%e0_7940) : !cute.int_tuple<"?">
        %2549 = cute.get_scalars(%e1_7941) : !cute.int_tuple<"?">
        %2550 = cute.get_scalars(%e2_7942) : !cute.int_tuple<"?">
        %2551 = cute.get_scalars(%e3_7943) : !cute.int_tuple<"?{div=8}">
        %iter_7944 = cute.get_iter(%view_7938) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7945, %e1_7946, %e2_7947, %e3_7948 = cute.get_leaves(%iter_7944) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2552 = cute.get_scalars(%e0_7945) : !cute.int_tuple<"?">
        %2553 = cute.get_scalars(%e1_7946) : !cute.int_tuple<"?">
        %2554 = cute.get_scalars(%e2_7947) : !cute.int_tuple<"?">
        %2555 = cute.get_scalars(%e3_7948) : !cute.int_tuple<"?{div=8}">
        %iter_7949 = cute.get_iter(%view_7938) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7950, %e1_7951, %e2_7952, %e3_7953 = cute.get_leaves(%iter_7949) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2556 = cute.get_scalars(%e0_7950) : !cute.int_tuple<"?">
        %2557 = cute.get_scalars(%e1_7951) : !cute.int_tuple<"?">
        %2558 = cute.get_scalars(%e2_7952) : !cute.int_tuple<"?">
        %2559 = cute.get_scalars(%e3_7953) : !cute.int_tuple<"?{div=8}">
        %lay_7954 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2560 = cute.get_shape(%lay_7954) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7955, %e1_7956, %e2_7957, %e3_7958 = cute.get_leaves(%2560) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7959 = cute.to_int_tuple(%e0_7955) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2561 = cute.get_scalars(%itup_7959) : !cute.int_tuple<"?">
        %itup_7960 = cute.to_int_tuple(%e1_7956) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2562 = cute.get_scalars(%itup_7960) : !cute.int_tuple<"?">
        %itup_7961 = cute.to_int_tuple(%e2_7957) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2563 = cute.get_scalars(%itup_7961) : !cute.int_tuple<"?">
        %itup_7962 = cute.to_int_tuple(%e3_7958) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2564 = cute.get_scalars(%itup_7962) : !cute.int_tuple<"?{div=8}">
        %coord_7963 = cute.make_coord(%e1_7951) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7964 = cute.make_coord(%itup_7960) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2565 = cute.elem_less(%coord_7963, %coord_7964) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2565 {
          %coord_7965 = cute.make_coord(%502) : (i32) -> !cute.coord<"(_,3,_,?)">
          %lay_7966 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_7968 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_gmem_bf16_6
          %iter_7971 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %iter_7972 = cute.get_iter(%view_7970) : !memref_gmem_bf16_6
          %coord_7973 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7974 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7975 = cute.crd2idx(%coord_7973, %lay_7974) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_7976 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7977 = cute.add_offset(%iter_7976, %idx_7975) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7978 = cute.make_view(%ptr_7977) : !memref_smem_bf16_14
          %iter_7979 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %iter_7980 = cute.get_iter(%view_7978) : !memref_smem_bf16_14
          %coord_7981 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7982 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %idx_7983 = cute.crd2idx(%coord_7981, %lay_7982) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7984 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
          %ptr_7985 = cute.add_offset(%iter_7984, %idx_7983) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7986 = cute.make_view(%ptr_7985) : !memref_rmem_i8_2
          %iter_7987 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %iter_7988 = cute.get_iter(%view_7986) : !memref_rmem_i8_2
          %lay_7989 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %2566 = cute.get_shape(%lay_7989) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7990, %e1_7991, %e2_7992 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %lay_7993 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %2567 = cute.get_shape(%lay_7993) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7994, %e1_7995, %e2_7996 = cute.get_leaves(%2567) : !cute.shape<"((8,1),2)">
          %lay_7997 = cute.get_layout(%view_7970) : !memref_gmem_bf16_6
          %shape_7998 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7999 = cute.make_layout() : !cute.layout<"1:0">
          %append_8000 = cute.append_to_rank<2> (%lay_7997, %lay_7999) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_8001 = cute.make_view(%iter_7972, %append_8000) : !memref_gmem_bf16_6
          %iter_8002 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %lay_8003 = cute.get_layout(%view_8001) : !memref_gmem_bf16_6
          %2568 = cute.get_shape(%lay_8003) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_8004, %e1_8005, %e2_8006 = cute.get_leaves(%2568) : !cute.shape<"((8,1),2)">
          %iter_8007 = cute.get_iter(%view_8001) : !memref_gmem_bf16_6
          %view_8008 = cute.make_view(%iter_8007) : !memref_gmem_bf16_7
          %iter_8009 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8010 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %lay_8011 = cute.get_layout(%view_7978) : !memref_smem_bf16_14
          %shape_8012 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8013 = cute.make_layout() : !cute.layout<"1:0">
          %append_8014 = cute.append_to_rank<2> (%lay_8011, %lay_8013) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_8015 = cute.make_view(%iter_7980, %append_8014) : !memref_smem_bf16_14
          %iter_8016 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %lay_8017 = cute.get_layout(%view_8015) : !memref_smem_bf16_14
          %2569 = cute.get_shape(%lay_8017) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_8018, %e1_8019, %e2_8020 = cute.get_leaves(%2569) : !cute.shape<"((8,1),2)">
          %iter_8021 = cute.get_iter(%view_8015) : !memref_smem_bf16_14
          %view_8022 = cute.make_view(%iter_8021) : !memref_smem_bf16_15
          %iter_8023 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %iter_8024 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8025 = cute.get_layout(%view_7986) : !memref_rmem_i8_2
          %shape_8026 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_8027 = cute.make_layout() : !cute.layout<"1:0">
          %append_8028 = cute.append_to_rank<2> (%lay_8025, %lay_8027) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_8029 = cute.make_view(%iter_7988, %append_8028) : !memref_rmem_i8_2
          %iter_8030 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %lay_8031 = cute.get_layout(%view_8029) : !memref_rmem_i8_2
          %2570 = cute.get_shape(%lay_8031) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_8032, %e1_8033 = cute.get_leaves(%2570) : !cute.shape<"(1,2)">
          %iter_8034 = cute.get_iter(%view_8029) : !memref_rmem_i8_2
          %view_8035 = cute.make_view(%iter_8034) : !memref_rmem_i8_3
          %iter_8036 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %iter_8037 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8038 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %2571 = cute.get_shape(%lay_8038) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_8039, %e1_8040, %e2_8041 = cute.get_leaves(%2571) : !cute.shape<"((8,1),(2))">
          %lay_8042 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %2572 = cute.get_shape(%lay_8042) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_8043, %e1_8044, %e2_8045 = cute.get_leaves(%2572) : !cute.shape<"((8,1),(2))">
          %lay_8046 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %sz_8047 = cute.size(%lay_8046) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_8048 = cute.get_leaves(%sz_8047) : !cute.int_tuple<"2">
          %lay_8049 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %sz_8050 = cute.size(%lay_8049) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_8051 = cute.get_leaves(%sz_8050) : !cute.int_tuple<"2">
          %2573 = cute.static : !cute.layout<"1:0">
          %iter_8052 = cute.get_iter(%view_8008) : !memref_gmem_bf16_7
          %iter_8053 = cute.get_iter(%view_8022) : !memref_smem_bf16_15
          %lay_8054 = cute.get_layout(%view_8008) : !memref_gmem_bf16_7
          %lay_8055 = cute.get_layout(%view_8022) : !memref_smem_bf16_15
          %append_8056 = cute.append_to_rank<2> (%lay_8054, %2573) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_8057 = cute.append_to_rank<2> (%lay_8055, %2573) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_8058 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_8059 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_8060 = cute.get_iter(%view_8035) : !memref_rmem_i8_3
          %lay_8061 = cute.get_layout(%view_8035) : !memref_rmem_i8_3
          %append_8062 = cute.append_to_rank<2> (%lay_8061, %2573) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_8063 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_8064 = cute.size(%lay_8058) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2574 = cute.get_scalars(%sz_8064) : !cute.int_tuple<"2">
          %c0_i32_8065 = arith.constant 0 : i32
          %c1_i32_8066 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_8065 to %2574 step %c1_i32_8066  : i32 {
            %coord_8067 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_8068 = cute.slice(%lay_8058, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_8069 = cute.crd2idx(%coord_8067, %lay_8058) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_8070 = cute.add_offset(%iter_8052, %idx_8069) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_8071 = cute.make_view(%ptr_8070, %slice_8068) : !memref_gmem_bf16_8
            %slice_8072 = cute.slice(%lay_8059, %coord_8067) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_8073 = cute.crd2idx(%coord_8067, %lay_8059) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_8074 = cute.add_offset(%iter_8053, %idx_8073) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_8075 = cute.make_view(%ptr_8074, %slice_8072) : !memref_smem_bf16_13
            %slice_8076 = cute.slice(%lay_8063, %coord_8067) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_8077 = cute.crd2idx(%coord_8067, %lay_8063) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_8078 = cute.add_offset(%iter_8060, %idx_8077) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_8079 = cute.make_view(%ptr_8078, %slice_8076) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_8071, %view_8075, %view_8079) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7965 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7966 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %idx_7967 = cute.crd2idx(%coord_7965, %lay_7966) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_7968 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
          %ptr_7969 = cute.add_offset(%iter_7968, %idx_7967) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7970 = cute.make_view(%ptr_7969) : !memref_smem_bf16_14
          %iter_7971 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %iter_7972 = cute.get_iter(%view_7970) : !memref_smem_bf16_14
          %lay_7973 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %sz_7974 = cute.size(%lay_7973) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7975 = cute.get_leaves(%sz_7974) : !cute.int_tuple<"16">
          %lay_7976 = cute.get_layout(%view_7970) : !memref_smem_bf16_14
          %2566 = cute.get_shape(%lay_7976) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7977, %e1_7978, %e2_7979 = cute.get_leaves(%2566) : !cute.shape<"((8,1),2)">
          %int_tuple_7980 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7981 = cute.tuple.product(%int_tuple_7980) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7982 = cute.get_leaves(%res_7981) : !cute.int_tuple<"16">
          %cst_7983 = arith.constant 0.000000e+00 : bf16
          %2567 = vector.splat %cst_7983 : vector<16xbf16>
          %int_tuple_7984 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7985 = cute.size(%int_tuple_7984) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7986 = cute.get_leaves(%sz_7985) : !cute.int_tuple<"16">
          %int_tuple_7987 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7988 = cute.size(%int_tuple_7987) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7989 = cute.get_leaves(%sz_7988) : !cute.int_tuple<"16">
          cute.memref.store_vec %2567, %view_7970 : !memref_smem_bf16_14
        }
      } else {
        %coord_7829 = cute.make_coord(%502) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_7830 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
        %slice_7831 = cute.slice(%lay_7830, %coord_7829) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
        %idx_7832 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7833 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
        %ptr_7834 = cute.add_offset(%iter_7833, %idx_7832) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7835 = cute.make_view(%ptr_7834, %slice_7831) : !memref_gmem_bf16_9
        %iter_7836 = cute.get_iter(%view_7835) : !memref_gmem_bf16_9
        %iter_7837 = cute.get_iter(%view_7835) : !memref_gmem_bf16_9
        %lay_7838 = cute.get_layout(%view_7835) : !memref_gmem_bf16_9
        %2493 = cute.get_shape(%lay_7838) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7839, %e1_7840, %e2_7841, %e3_7842 = cute.get_leaves(%2493) : !cute.shape<"((8,1),4,2)">
        %lay_7843 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
        %2494 = cute.get_shape(%lay_7843) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7844, %e1_7845, %e2_7846, %e3_7847 = cute.get_leaves(%2494) : !cute.shape<"((8,1),4,2)">
        %lay_7848 = cute.get_layout(%view_7835) : !memref_gmem_bf16_9
        %shape_7849 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7850 = cute.make_layout() : !cute.layout<"1:0">
        %append_7851 = cute.append_to_rank<2> (%lay_7848, %lay_7850) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_7852 = cute.make_view(%iter_7837, %append_7851) : !memref_gmem_bf16_9
        %iter_7853 = cute.get_iter(%view_7852) : !memref_gmem_bf16_9
        %lay_7854 = cute.get_layout(%view_7852) : !memref_gmem_bf16_9
        %2495 = cute.get_shape(%lay_7854) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7855, %e1_7856, %e2_7857, %e3_7858 = cute.get_leaves(%2495) : !cute.shape<"((8,1),4,2)">
        %iter_7859 = cute.get_iter(%view_7852) : !memref_gmem_bf16_9
        %lay_7860 = cute.get_layout(%view_7852) : !memref_gmem_bf16_9
        %2496 = cute.get_scalars(%lay_7860) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_7861 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_7862 = cute.assume(%2496) : (i64) -> !cute.i64<divby 128>
        %stride_7863 = cute.make_stride(%iv_7862) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_7864 = cute.make_layout(%shape_7861, %stride_7863) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_7865 = cute.make_view(%iter_7859, %lay_7864) : !memref_gmem_bf16_10
        %iter_7866 = cute.get_iter(%view_7865) : !memref_gmem_bf16_10
        %iter_7867 = cute.get_iter(%view_7865) : !memref_gmem_bf16_10
        %lay_7868 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
        %shape_7869 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7870 = cute.make_layout() : !cute.layout<"1:0">
        %append_7871 = cute.append_to_rank<2> (%lay_7868, %lay_7870) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_7872 = cute.make_view(%iter_302, %append_7871) : !memref_smem_bf16_4
        %iter_7873 = cute.get_iter(%view_7872) : !memref_smem_bf16_4
        %lay_7874 = cute.get_layout(%view_7872) : !memref_smem_bf16_4
        %2497 = cute.get_shape(%lay_7874) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7875, %e1_7876, %e2_7877, %e3_7878 = cute.get_leaves(%2497) : !cute.shape<"((8,1),4,2)">
        %iter_7879 = cute.get_iter(%view_7872) : !memref_smem_bf16_4
        %view_7880 = cute.make_view(%iter_7879) : !memref_smem_bf16_16
        %iter_7881 = cute.get_iter(%view_7880) : !memref_smem_bf16_16
        %iter_7882 = cute.get_iter(%view_7880) : !memref_smem_bf16_16
        %lay_7883 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %shape_7884 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7885 = cute.make_layout() : !cute.layout<"1:0">
        %append_7886 = cute.append_to_rank<2> (%lay_7883, %lay_7885) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_7887 = cute.make_view(%iter_542, %append_7886) : !memref_rmem_i8_1
        %iter_7888 = cute.get_iter(%view_7887) : !memref_rmem_i8_1
        %lay_7889 = cute.get_layout(%view_7887) : !memref_rmem_i8_1
        %2498 = cute.get_shape(%lay_7889) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_7890, %e1_7891, %e2_7892 = cute.get_leaves(%2498) : !cute.shape<"(1,4,2)">
        %iter_7893 = cute.get_iter(%view_7887) : !memref_rmem_i8_1
        %view_7894 = cute.make_view(%iter_7893) : !memref_rmem_i8_5
        %iter_7895 = cute.get_iter(%view_7894) : !memref_rmem_i8_5
        %iter_7896 = cute.get_iter(%view_7894) : !memref_rmem_i8_5
        %lay_7897 = cute.get_layout(%view_7865) : !memref_gmem_bf16_10
        %2499 = cute.get_shape(%lay_7897) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7898, %e1_7899, %e2_7900, %e3_7901 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(4,2))">
        %lay_7902 = cute.get_layout(%view_7880) : !memref_smem_bf16_16
        %2500 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7903, %e1_7904, %e2_7905, %e3_7906 = cute.get_leaves(%2500) : !cute.shape<"((8,1),(4,2))">
        %lay_7907 = cute.get_layout(%view_7865) : !memref_gmem_bf16_10
        %sz_7908 = cute.size(%lay_7907) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_7909 = cute.get_leaves(%sz_7908) : !cute.int_tuple<"8">
        %lay_7910 = cute.get_layout(%view_7880) : !memref_smem_bf16_16
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"8">
        %2501 = cute.static : !cute.layout<"1:0">
        %iter_7913 = cute.get_iter(%view_7865) : !memref_gmem_bf16_10
        %iter_7914 = cute.get_iter(%view_7880) : !memref_smem_bf16_16
        %lay_7915 = cute.get_layout(%view_7865) : !memref_gmem_bf16_10
        %lay_7916 = cute.get_layout(%view_7880) : !memref_smem_bf16_16
        %append_7917 = cute.append_to_rank<2> (%lay_7915, %2501) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_7918 = cute.append_to_rank<2> (%lay_7916, %2501) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %2502 = cute.get_scalars(%append_7917) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_7919 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_7920 = cute.assume(%2502) : (i64) -> !cute.i64<divby 128>
        %stride_7921 = cute.make_stride(%iv_7920) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_7922 = cute.make_layout(%shape_7919, %stride_7921) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_7924 = cute.get_iter(%view_7894) : !memref_rmem_i8_5
        %lay_7925 = cute.get_layout(%view_7894) : !memref_rmem_i8_5
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2501) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %2503 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"8">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2503 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_7934 = cute.add_offset(%iter_7913, %idx_7933) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_gmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_7938 = cute.add_offset(%iter_7914, %idx_7937) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_smem_bf16_13
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7935, %view_7939, %view_7943) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      nvvm.cp.async.commit.group
      %coord_1137 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1138 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_1139 = cute.crd2idx(%coord_1137, %lay_1138) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_1140 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_1141 = cute.add_offset(%iter_1140, %idx_1139) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1142 = cute.make_view(%ptr_1141) : !memref_smem_bf16_14
      %iter_1143 = cute.get_iter(%view_1142) : !memref_smem_bf16_14
      %iter_1144 = cute.get_iter(%view_1142) : !memref_smem_bf16_14
      %coord_1145 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1146 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1147 = cute.crd2idx(%coord_1145, %lay_1146) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_1148 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1149 = cute.add_offset(%iter_1148, %idx_1147) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1150 = cute.make_view(%ptr_1149) : !memref_rmem_bf16_6
      %iter_1151 = cute.get_iter(%view_1150) : !memref_rmem_bf16_6
      %iter_1152 = cute.get_iter(%view_1150) : !memref_rmem_bf16_6
      %lay_1153 = cute.get_layout(%view_1142) : !memref_smem_bf16_14
      %506 = cute.get_shape(%lay_1153) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1154, %e1_1155, %e2_1156 = cute.get_leaves(%506) : !cute.shape<"((8,1),2)">
      %lay_1157 = cute.get_layout(%view_1150) : !memref_rmem_bf16_6
      %507 = cute.get_shape(%lay_1157) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1158, %e1_1159, %e2_1160 = cute.get_leaves(%507) : !cute.shape<"((8,1),2)">
      %lay_1161 = cute.get_layout(%view_1142) : !memref_smem_bf16_14
      %shape_1162 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1163 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1161, %lay_1163) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1164 = cute.make_view(%iter_1144, %append) : !memref_smem_bf16_14
      %iter_1165 = cute.get_iter(%view_1164) : !memref_smem_bf16_14
      %lay_1166 = cute.get_layout(%view_1164) : !memref_smem_bf16_14
      %508 = cute.get_shape(%lay_1166) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1167, %e1_1168, %e2_1169 = cute.get_leaves(%508) : !cute.shape<"((8,1),2)">
      %iter_1170 = cute.get_iter(%view_1164) : !memref_smem_bf16_14
      %view_1171 = cute.make_view(%iter_1170) : !memref_smem_bf16_15
      %iter_1172 = cute.get_iter(%view_1171) : !memref_smem_bf16_15
      %iter_1173 = cute.get_iter(%view_1171) : !memref_smem_bf16_15
      %lay_1174 = cute.get_layout(%view_1150) : !memref_rmem_bf16_6
      %shape_1175 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1176 = cute.make_layout() : !cute.layout<"1:0">
      %append_1177 = cute.append_to_rank<2> (%lay_1174, %lay_1176) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1178 = cute.make_view(%iter_1152, %append_1177) : !memref_rmem_bf16_6
      %iter_1179 = cute.get_iter(%view_1178) : !memref_rmem_bf16_6
      %lay_1180 = cute.get_layout(%view_1178) : !memref_rmem_bf16_6
      %509 = cute.get_shape(%lay_1180) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1181, %e1_1182, %e2_1183 = cute.get_leaves(%509) : !cute.shape<"((8,1),2)">
      %iter_1184 = cute.get_iter(%view_1178) : !memref_rmem_bf16_6
      %view_1185 = cute.make_view(%iter_1184) : !memref_rmem_bf16_7
      %iter_1186 = cute.get_iter(%view_1185) : !memref_rmem_bf16_7
      %iter_1187 = cute.get_iter(%view_1185) : !memref_rmem_bf16_7
      %lay_1188 = cute.get_layout(%view_1171) : !memref_smem_bf16_15
      %510 = cute.get_shape(%lay_1188) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1189, %e1_1190, %e2_1191 = cute.get_leaves(%510) : !cute.shape<"((8,1),(2))">
      %lay_1192 = cute.get_layout(%view_1185) : !memref_rmem_bf16_7
      %511 = cute.get_shape(%lay_1192) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1193, %e1_1194, %e2_1195 = cute.get_leaves(%511) : !cute.shape<"((8,1),(2))">
      %lay_1196 = cute.get_layout(%view_1171) : !memref_smem_bf16_15
      %sz_1197 = cute.size(%lay_1196) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1198 = cute.get_leaves(%sz_1197) : !cute.int_tuple<"2">
      %lay_1199 = cute.get_layout(%view_1185) : !memref_rmem_bf16_7
      %sz_1200 = cute.size(%lay_1199) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1201 = cute.get_leaves(%sz_1200) : !cute.int_tuple<"2">
      %512 = cute.static : !cute.layout<"1:0">
      %iter_1202 = cute.get_iter(%view_1171) : !memref_smem_bf16_15
      %iter_1203 = cute.get_iter(%view_1185) : !memref_rmem_bf16_7
      %lay_1204 = cute.get_layout(%view_1171) : !memref_smem_bf16_15
      %lay_1205 = cute.get_layout(%view_1185) : !memref_rmem_bf16_7
      %append_1206 = cute.append_to_rank<2> (%lay_1204, %512) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1207 = cute.append_to_rank<2> (%lay_1205, %512) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1208 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1209 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1210 = cute.size(%lay_1208) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %513 = cute.get_scalars(%sz_1210) : !cute.int_tuple<"2">
      %c0_i32_1211 = arith.constant 0 : i32
      %c1_i32_1212 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1211 to %513 step %c1_i32_1212  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1208, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1208) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_1202, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1209, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1209) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1203, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1213 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1214 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_1215 = cute.crd2idx(%coord_1213, %lay_1214) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_1216 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_1217 = cute.add_offset(%iter_1216, %idx_1215) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1218 = cute.make_view(%ptr_1217) : !memref_smem_bf16_17
      %iter_1219 = cute.get_iter(%view_1218) : !memref_smem_bf16_17
      %iter_1220 = cute.get_iter(%view_1218) : !memref_smem_bf16_17
      %coord_1221 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1222 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_1223 = cute.crd2idx(%coord_1221, %lay_1222) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_1224 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_1225 = cute.add_offset(%iter_1224, %idx_1223) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1226 = cute.make_view(%ptr_1225) : !memref_rmem_bf16_9
      %iter_1227 = cute.get_iter(%view_1226) : !memref_rmem_bf16_9
      %iter_1228 = cute.get_iter(%view_1226) : !memref_rmem_bf16_9
      %lay_1229 = cute.get_layout(%view_1218) : !memref_smem_bf16_17
      %514 = cute.get_shape(%lay_1229) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1230, %e1_1231, %e2_1232 = cute.get_leaves(%514) : !cute.shape<"((8,1),4)">
      %lay_1233 = cute.get_layout(%view_1226) : !memref_rmem_bf16_9
      %515 = cute.get_shape(%lay_1233) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1234, %e1_1235, %e2_1236 = cute.get_leaves(%515) : !cute.shape<"((8,1),4)">
      %lay_1237 = cute.get_layout(%view_1218) : !memref_smem_bf16_17
      %shape_1238 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1239 = cute.make_layout() : !cute.layout<"1:0">
      %append_1240 = cute.append_to_rank<2> (%lay_1237, %lay_1239) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1241 = cute.make_view(%iter_1220, %append_1240) : !memref_smem_bf16_17
      %iter_1242 = cute.get_iter(%view_1241) : !memref_smem_bf16_17
      %lay_1243 = cute.get_layout(%view_1241) : !memref_smem_bf16_17
      %516 = cute.get_shape(%lay_1243) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1244, %e1_1245, %e2_1246 = cute.get_leaves(%516) : !cute.shape<"((8,1),4)">
      %iter_1247 = cute.get_iter(%view_1241) : !memref_smem_bf16_17
      %view_1248 = cute.make_view(%iter_1247) : !memref_smem_bf16_18
      %iter_1249 = cute.get_iter(%view_1248) : !memref_smem_bf16_18
      %iter_1250 = cute.get_iter(%view_1248) : !memref_smem_bf16_18
      %lay_1251 = cute.get_layout(%view_1226) : !memref_rmem_bf16_9
      %shape_1252 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1253 = cute.make_layout() : !cute.layout<"1:0">
      %append_1254 = cute.append_to_rank<2> (%lay_1251, %lay_1253) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1255 = cute.make_view(%iter_1228, %append_1254) : !memref_rmem_bf16_9
      %iter_1256 = cute.get_iter(%view_1255) : !memref_rmem_bf16_9
      %lay_1257 = cute.get_layout(%view_1255) : !memref_rmem_bf16_9
      %517 = cute.get_shape(%lay_1257) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1258, %e1_1259, %e2_1260 = cute.get_leaves(%517) : !cute.shape<"((8,1),4)">
      %iter_1261 = cute.get_iter(%view_1255) : !memref_rmem_bf16_9
      %view_1262 = cute.make_view(%iter_1261) : !memref_rmem_bf16_10
      %iter_1263 = cute.get_iter(%view_1262) : !memref_rmem_bf16_10
      %iter_1264 = cute.get_iter(%view_1262) : !memref_rmem_bf16_10
      %lay_1265 = cute.get_layout(%view_1248) : !memref_smem_bf16_18
      %518 = cute.get_shape(%lay_1265) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1266, %e1_1267, %e2_1268 = cute.get_leaves(%518) : !cute.shape<"((8,1),(4))">
      %lay_1269 = cute.get_layout(%view_1262) : !memref_rmem_bf16_10
      %519 = cute.get_shape(%lay_1269) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1270, %e1_1271, %e2_1272 = cute.get_leaves(%519) : !cute.shape<"((8,1),(4))">
      %lay_1273 = cute.get_layout(%view_1248) : !memref_smem_bf16_18
      %sz_1274 = cute.size(%lay_1273) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1275 = cute.get_leaves(%sz_1274) : !cute.int_tuple<"4">
      %lay_1276 = cute.get_layout(%view_1262) : !memref_rmem_bf16_10
      %sz_1277 = cute.size(%lay_1276) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1278 = cute.get_leaves(%sz_1277) : !cute.int_tuple<"4">
      %520 = cute.static : !cute.layout<"1:0">
      %iter_1279 = cute.get_iter(%view_1248) : !memref_smem_bf16_18
      %iter_1280 = cute.get_iter(%view_1262) : !memref_rmem_bf16_10
      %lay_1281 = cute.get_layout(%view_1248) : !memref_smem_bf16_18
      %lay_1282 = cute.get_layout(%view_1262) : !memref_rmem_bf16_10
      %append_1283 = cute.append_to_rank<2> (%lay_1281, %520) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1284 = cute.append_to_rank<2> (%lay_1282, %520) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1285 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1286 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1287 = cute.size(%lay_1285) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %521 = cute.get_scalars(%sz_1287) : !cute.int_tuple<"4">
      %c0_i32_1288 = arith.constant 0 : i32
      %c1_i32_1289 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1288 to %521 step %c1_i32_1289  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1285, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1285) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_1279, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1286, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1286) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1280, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1290 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %522 = cute.get_shape(%lay_1290) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
      %e0_1291, %e1_1292, %e2_1293, %e3_1294, %e4_1295, %e5 = cute.get_leaves(%522) : !cute.shape<"((8,1),2,((2,2),2))">
      %int_tuple_1296 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1297 = cute.size(%int_tuple_1296) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1298 = cute.get_leaves(%sz_1297) : !cute.int_tuple<"8">
      %int_tuple_1299 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1300 = cute.size(%int_tuple_1299) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1301 = cute.get_leaves(%sz_1300) : !cute.int_tuple<"8">
      %coord_1302 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1303 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_1304 = cute.crd2idx(%coord_1302, %lay_1303) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1305 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_1306 = cute.add_offset(%iter_1305, %idx_1304) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1307 = cute.make_view(%ptr_1306) : !memref_smem_bf16_14
      %iter_1308 = cute.get_iter(%view_1307) : !memref_smem_bf16_14
      %iter_1309 = cute.get_iter(%view_1307) : !memref_smem_bf16_14
      %coord_1310 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1311 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1312 = cute.crd2idx(%coord_1310, %lay_1311) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
      %iter_1313 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1314 = cute.add_offset(%iter_1313, %idx_1312) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1315 = cute.make_view(%ptr_1314) : !memref_rmem_bf16_6
      %iter_1316 = cute.get_iter(%view_1315) : !memref_rmem_bf16_6
      %iter_1317 = cute.get_iter(%view_1315) : !memref_rmem_bf16_6
      %lay_1318 = cute.get_layout(%view_1307) : !memref_smem_bf16_14
      %523 = cute.get_shape(%lay_1318) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1319, %e1_1320, %e2_1321 = cute.get_leaves(%523) : !cute.shape<"((8,1),2)">
      %lay_1322 = cute.get_layout(%view_1315) : !memref_rmem_bf16_6
      %524 = cute.get_shape(%lay_1322) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1323, %e1_1324, %e2_1325 = cute.get_leaves(%524) : !cute.shape<"((8,1),2)">
      %lay_1326 = cute.get_layout(%view_1307) : !memref_smem_bf16_14
      %shape_1327 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1328 = cute.make_layout() : !cute.layout<"1:0">
      %append_1329 = cute.append_to_rank<2> (%lay_1326, %lay_1328) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1330 = cute.make_view(%iter_1309, %append_1329) : !memref_smem_bf16_14
      %iter_1331 = cute.get_iter(%view_1330) : !memref_smem_bf16_14
      %lay_1332 = cute.get_layout(%view_1330) : !memref_smem_bf16_14
      %525 = cute.get_shape(%lay_1332) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1333, %e1_1334, %e2_1335 = cute.get_leaves(%525) : !cute.shape<"((8,1),2)">
      %iter_1336 = cute.get_iter(%view_1330) : !memref_smem_bf16_14
      %view_1337 = cute.make_view(%iter_1336) : !memref_smem_bf16_15
      %iter_1338 = cute.get_iter(%view_1337) : !memref_smem_bf16_15
      %iter_1339 = cute.get_iter(%view_1337) : !memref_smem_bf16_15
      %lay_1340 = cute.get_layout(%view_1315) : !memref_rmem_bf16_6
      %shape_1341 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1342 = cute.make_layout() : !cute.layout<"1:0">
      %append_1343 = cute.append_to_rank<2> (%lay_1340, %lay_1342) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1344 = cute.make_view(%iter_1317, %append_1343) : !memref_rmem_bf16_6
      %iter_1345 = cute.get_iter(%view_1344) : !memref_rmem_bf16_6
      %lay_1346 = cute.get_layout(%view_1344) : !memref_rmem_bf16_6
      %526 = cute.get_shape(%lay_1346) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1347, %e1_1348, %e2_1349 = cute.get_leaves(%526) : !cute.shape<"((8,1),2)">
      %iter_1350 = cute.get_iter(%view_1344) : !memref_rmem_bf16_6
      %view_1351 = cute.make_view(%iter_1350) : !memref_rmem_bf16_7
      %iter_1352 = cute.get_iter(%view_1351) : !memref_rmem_bf16_7
      %iter_1353 = cute.get_iter(%view_1351) : !memref_rmem_bf16_7
      %lay_1354 = cute.get_layout(%view_1337) : !memref_smem_bf16_15
      %527 = cute.get_shape(%lay_1354) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1355, %e1_1356, %e2_1357 = cute.get_leaves(%527) : !cute.shape<"((8,1),(2))">
      %lay_1358 = cute.get_layout(%view_1351) : !memref_rmem_bf16_7
      %528 = cute.get_shape(%lay_1358) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1359, %e1_1360, %e2_1361 = cute.get_leaves(%528) : !cute.shape<"((8,1),(2))">
      %lay_1362 = cute.get_layout(%view_1337) : !memref_smem_bf16_15
      %sz_1363 = cute.size(%lay_1362) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1364 = cute.get_leaves(%sz_1363) : !cute.int_tuple<"2">
      %lay_1365 = cute.get_layout(%view_1351) : !memref_rmem_bf16_7
      %sz_1366 = cute.size(%lay_1365) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1367 = cute.get_leaves(%sz_1366) : !cute.int_tuple<"2">
      %529 = cute.static : !cute.layout<"1:0">
      %iter_1368 = cute.get_iter(%view_1337) : !memref_smem_bf16_15
      %iter_1369 = cute.get_iter(%view_1351) : !memref_rmem_bf16_7
      %lay_1370 = cute.get_layout(%view_1337) : !memref_smem_bf16_15
      %lay_1371 = cute.get_layout(%view_1351) : !memref_rmem_bf16_7
      %append_1372 = cute.append_to_rank<2> (%lay_1370, %529) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1373 = cute.append_to_rank<2> (%lay_1371, %529) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1374 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1375 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1376 = cute.size(%lay_1374) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %530 = cute.get_scalars(%sz_1376) : !cute.int_tuple<"2">
      %c0_i32_1377 = arith.constant 0 : i32
      %c1_i32_1378 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1377 to %530 step %c1_i32_1378  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1374, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1374) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_1368, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1375, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1375) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1369, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1379 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1380 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_1381 = cute.crd2idx(%coord_1379, %lay_1380) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1382 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_1383 = cute.add_offset(%iter_1382, %idx_1381) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1384 = cute.make_view(%ptr_1383) : !memref_smem_bf16_17
      %iter_1385 = cute.get_iter(%view_1384) : !memref_smem_bf16_17
      %iter_1386 = cute.get_iter(%view_1384) : !memref_smem_bf16_17
      %coord_1387 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1388 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_1389 = cute.crd2idx(%coord_1387, %lay_1388) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
      %iter_1390 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_1391 = cute.add_offset(%iter_1390, %idx_1389) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1392 = cute.make_view(%ptr_1391) : !memref_rmem_bf16_9
      %iter_1393 = cute.get_iter(%view_1392) : !memref_rmem_bf16_9
      %iter_1394 = cute.get_iter(%view_1392) : !memref_rmem_bf16_9
      %lay_1395 = cute.get_layout(%view_1384) : !memref_smem_bf16_17
      %531 = cute.get_shape(%lay_1395) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1396, %e1_1397, %e2_1398 = cute.get_leaves(%531) : !cute.shape<"((8,1),4)">
      %lay_1399 = cute.get_layout(%view_1392) : !memref_rmem_bf16_9
      %532 = cute.get_shape(%lay_1399) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1400, %e1_1401, %e2_1402 = cute.get_leaves(%532) : !cute.shape<"((8,1),4)">
      %lay_1403 = cute.get_layout(%view_1384) : !memref_smem_bf16_17
      %shape_1404 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1405 = cute.make_layout() : !cute.layout<"1:0">
      %append_1406 = cute.append_to_rank<2> (%lay_1403, %lay_1405) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1407 = cute.make_view(%iter_1386, %append_1406) : !memref_smem_bf16_17
      %iter_1408 = cute.get_iter(%view_1407) : !memref_smem_bf16_17
      %lay_1409 = cute.get_layout(%view_1407) : !memref_smem_bf16_17
      %533 = cute.get_shape(%lay_1409) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1410, %e1_1411, %e2_1412 = cute.get_leaves(%533) : !cute.shape<"((8,1),4)">
      %iter_1413 = cute.get_iter(%view_1407) : !memref_smem_bf16_17
      %view_1414 = cute.make_view(%iter_1413) : !memref_smem_bf16_18
      %iter_1415 = cute.get_iter(%view_1414) : !memref_smem_bf16_18
      %iter_1416 = cute.get_iter(%view_1414) : !memref_smem_bf16_18
      %lay_1417 = cute.get_layout(%view_1392) : !memref_rmem_bf16_9
      %shape_1418 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1419 = cute.make_layout() : !cute.layout<"1:0">
      %append_1420 = cute.append_to_rank<2> (%lay_1417, %lay_1419) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1421 = cute.make_view(%iter_1394, %append_1420) : !memref_rmem_bf16_9
      %iter_1422 = cute.get_iter(%view_1421) : !memref_rmem_bf16_9
      %lay_1423 = cute.get_layout(%view_1421) : !memref_rmem_bf16_9
      %534 = cute.get_shape(%lay_1423) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1424, %e1_1425, %e2_1426 = cute.get_leaves(%534) : !cute.shape<"((8,1),4)">
      %iter_1427 = cute.get_iter(%view_1421) : !memref_rmem_bf16_9
      %view_1428 = cute.make_view(%iter_1427) : !memref_rmem_bf16_10
      %iter_1429 = cute.get_iter(%view_1428) : !memref_rmem_bf16_10
      %iter_1430 = cute.get_iter(%view_1428) : !memref_rmem_bf16_10
      %lay_1431 = cute.get_layout(%view_1414) : !memref_smem_bf16_18
      %535 = cute.get_shape(%lay_1431) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1432, %e1_1433, %e2_1434 = cute.get_leaves(%535) : !cute.shape<"((8,1),(4))">
      %lay_1435 = cute.get_layout(%view_1428) : !memref_rmem_bf16_10
      %536 = cute.get_shape(%lay_1435) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1436, %e1_1437, %e2_1438 = cute.get_leaves(%536) : !cute.shape<"((8,1),(4))">
      %lay_1439 = cute.get_layout(%view_1414) : !memref_smem_bf16_18
      %sz_1440 = cute.size(%lay_1439) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1441 = cute.get_leaves(%sz_1440) : !cute.int_tuple<"4">
      %lay_1442 = cute.get_layout(%view_1428) : !memref_rmem_bf16_10
      %sz_1443 = cute.size(%lay_1442) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1444 = cute.get_leaves(%sz_1443) : !cute.int_tuple<"4">
      %537 = cute.static : !cute.layout<"1:0">
      %iter_1445 = cute.get_iter(%view_1414) : !memref_smem_bf16_18
      %iter_1446 = cute.get_iter(%view_1428) : !memref_rmem_bf16_10
      %lay_1447 = cute.get_layout(%view_1414) : !memref_smem_bf16_18
      %lay_1448 = cute.get_layout(%view_1428) : !memref_rmem_bf16_10
      %append_1449 = cute.append_to_rank<2> (%lay_1447, %537) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1450 = cute.append_to_rank<2> (%lay_1448, %537) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1451 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1452 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1453 = cute.size(%lay_1451) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %538 = cute.get_scalars(%sz_1453) : !cute.int_tuple<"4">
      %c0_i32_1454 = arith.constant 0 : i32
      %c1_i32_1455 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1454 to %538 step %c1_i32_1455  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1451, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1451) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_1445, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1452, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1452) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1446, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1456 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1457 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1458 = cute.crd2idx(%coord_1456, %lay_1457) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
      %iter_1459 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1460 = cute.add_offset(%iter_1459, %idx_1458) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1461 = cute.make_view(%ptr_1460) : !memref_rmem_bf16_12
      %iter_1462 = cute.get_iter(%view_1461) : !memref_rmem_bf16_12
      %iter_1463 = cute.get_iter(%view_1461) : !memref_rmem_bf16_12
      %coord_1464 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1465 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1466 = cute.crd2idx(%coord_1464, %lay_1465) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
      %iter_1467 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1468 = cute.add_offset(%iter_1467, %idx_1466) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1469 = cute.make_view(%ptr_1468) : !memref_rmem_bf16_13
      %iter_1470 = cute.get_iter(%view_1469) : !memref_rmem_bf16_13
      %iter_1471 = cute.get_iter(%view_1469) : !memref_rmem_bf16_13
      %lay_1472 = cute.get_layout(%view_1461) : !memref_rmem_bf16_12
      %539 = cute.get_shape(%lay_1472) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1473, %e1_1474, %e2_1475, %e3_1476 = cute.get_leaves(%539) : !cute.shape<"((2,2,2),2)">
      %lay_1477 = cute.get_layout(%view_1469) : !memref_rmem_bf16_13
      %540 = cute.get_shape(%lay_1477) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1478, %e1_1479, %e2_1480 = cute.get_leaves(%540) : !cute.shape<"((2,2),8)">
      %iter_1481 = cute.get_iter(%view_1461) : !memref_rmem_bf16_12
      %iter_1482 = cute.get_iter(%view_1469) : !memref_rmem_bf16_13
      %iter_1483 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_1484 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_1485 = cute.get_layout(%view_1461) : !memref_rmem_bf16_12
      %lay_1486 = cute.get_layout(%view_1469) : !memref_rmem_bf16_13
      %lay_1487 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_1488 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %541 = cute.static : !cute.layout<"1:0">
      %append_1489 = cute.append_to_rank<3> (%lay_1485, %541) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1490 = cute.append_to_rank<3> (%lay_1486, %541) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1491 = cute.size(%append_1489) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1492 = cute.size(%append_1489) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1493 = cute.size(%append_1490) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %542 = cute.get_scalars(%sz_1491) : !cute.int_tuple<"1">
      %543 = cute.get_scalars(%sz_1492) : !cute.int_tuple<"2">
      %544 = cute.get_scalars(%sz_1493) : !cute.int_tuple<"8">
      %c0_i32_1494 = arith.constant 0 : i32
      %c1_i32_1495 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1494 to %542 step %c1_i32_1495  : i32 {
        scf.for %arg6 = %c0_i32_1494 to %543 step %c1_i32_1495  : i32 {
          scf.for %arg7 = %c0_i32_1494 to %544 step %c1_i32_1495  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_1489, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_1489) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_1481, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_1490, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_1490) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_1482, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_1487, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_1487) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_1483, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_1488, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_1488) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_1484, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1496 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1497 = cute.size(%int_tuple_1496) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1498 = cute.get_leaves(%sz_1497) : !cute.int_tuple<"8">
      %coord_1499 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1500 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_1501 = cute.crd2idx(%coord_1499, %lay_1500) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_1502 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_1503 = cute.add_offset(%iter_1502, %idx_1501) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1504 = cute.make_view(%ptr_1503) : !memref_smem_bf16_14
      %iter_1505 = cute.get_iter(%view_1504) : !memref_smem_bf16_14
      %iter_1506 = cute.get_iter(%view_1504) : !memref_smem_bf16_14
      %coord_1507 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1508 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1509 = cute.crd2idx(%coord_1507, %lay_1508) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
      %iter_1510 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1511 = cute.add_offset(%iter_1510, %idx_1509) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1512 = cute.make_view(%ptr_1511) : !memref_rmem_bf16_6
      %iter_1513 = cute.get_iter(%view_1512) : !memref_rmem_bf16_6
      %iter_1514 = cute.get_iter(%view_1512) : !memref_rmem_bf16_6
      %lay_1515 = cute.get_layout(%view_1504) : !memref_smem_bf16_14
      %545 = cute.get_shape(%lay_1515) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1516, %e1_1517, %e2_1518 = cute.get_leaves(%545) : !cute.shape<"((8,1),2)">
      %lay_1519 = cute.get_layout(%view_1512) : !memref_rmem_bf16_6
      %546 = cute.get_shape(%lay_1519) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1520, %e1_1521, %e2_1522 = cute.get_leaves(%546) : !cute.shape<"((8,1),2)">
      %lay_1523 = cute.get_layout(%view_1504) : !memref_smem_bf16_14
      %shape_1524 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1525 = cute.make_layout() : !cute.layout<"1:0">
      %append_1526 = cute.append_to_rank<2> (%lay_1523, %lay_1525) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1527 = cute.make_view(%iter_1506, %append_1526) : !memref_smem_bf16_14
      %iter_1528 = cute.get_iter(%view_1527) : !memref_smem_bf16_14
      %lay_1529 = cute.get_layout(%view_1527) : !memref_smem_bf16_14
      %547 = cute.get_shape(%lay_1529) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1530, %e1_1531, %e2_1532 = cute.get_leaves(%547) : !cute.shape<"((8,1),2)">
      %iter_1533 = cute.get_iter(%view_1527) : !memref_smem_bf16_14
      %view_1534 = cute.make_view(%iter_1533) : !memref_smem_bf16_15
      %iter_1535 = cute.get_iter(%view_1534) : !memref_smem_bf16_15
      %iter_1536 = cute.get_iter(%view_1534) : !memref_smem_bf16_15
      %lay_1537 = cute.get_layout(%view_1512) : !memref_rmem_bf16_6
      %shape_1538 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1539 = cute.make_layout() : !cute.layout<"1:0">
      %append_1540 = cute.append_to_rank<2> (%lay_1537, %lay_1539) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1541 = cute.make_view(%iter_1514, %append_1540) : !memref_rmem_bf16_6
      %iter_1542 = cute.get_iter(%view_1541) : !memref_rmem_bf16_6
      %lay_1543 = cute.get_layout(%view_1541) : !memref_rmem_bf16_6
      %548 = cute.get_shape(%lay_1543) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1544, %e1_1545, %e2_1546 = cute.get_leaves(%548) : !cute.shape<"((8,1),2)">
      %iter_1547 = cute.get_iter(%view_1541) : !memref_rmem_bf16_6
      %view_1548 = cute.make_view(%iter_1547) : !memref_rmem_bf16_7
      %iter_1549 = cute.get_iter(%view_1548) : !memref_rmem_bf16_7
      %iter_1550 = cute.get_iter(%view_1548) : !memref_rmem_bf16_7
      %lay_1551 = cute.get_layout(%view_1534) : !memref_smem_bf16_15
      %549 = cute.get_shape(%lay_1551) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1552, %e1_1553, %e2_1554 = cute.get_leaves(%549) : !cute.shape<"((8,1),(2))">
      %lay_1555 = cute.get_layout(%view_1548) : !memref_rmem_bf16_7
      %550 = cute.get_shape(%lay_1555) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1556, %e1_1557, %e2_1558 = cute.get_leaves(%550) : !cute.shape<"((8,1),(2))">
      %lay_1559 = cute.get_layout(%view_1534) : !memref_smem_bf16_15
      %sz_1560 = cute.size(%lay_1559) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1561 = cute.get_leaves(%sz_1560) : !cute.int_tuple<"2">
      %lay_1562 = cute.get_layout(%view_1548) : !memref_rmem_bf16_7
      %sz_1563 = cute.size(%lay_1562) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1564 = cute.get_leaves(%sz_1563) : !cute.int_tuple<"2">
      %551 = cute.static : !cute.layout<"1:0">
      %iter_1565 = cute.get_iter(%view_1534) : !memref_smem_bf16_15
      %iter_1566 = cute.get_iter(%view_1548) : !memref_rmem_bf16_7
      %lay_1567 = cute.get_layout(%view_1534) : !memref_smem_bf16_15
      %lay_1568 = cute.get_layout(%view_1548) : !memref_rmem_bf16_7
      %append_1569 = cute.append_to_rank<2> (%lay_1567, %551) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1570 = cute.append_to_rank<2> (%lay_1568, %551) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1571 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1572 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1573 = cute.size(%lay_1571) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %552 = cute.get_scalars(%sz_1573) : !cute.int_tuple<"2">
      %c0_i32_1574 = arith.constant 0 : i32
      %c1_i32_1575 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1574 to %552 step %c1_i32_1575  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1571, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1571) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_1565, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1572, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1572) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1566, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1576 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1577 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_1578 = cute.crd2idx(%coord_1576, %lay_1577) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_1579 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_1580 = cute.add_offset(%iter_1579, %idx_1578) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1581 = cute.make_view(%ptr_1580) : !memref_smem_bf16_17
      %iter_1582 = cute.get_iter(%view_1581) : !memref_smem_bf16_17
      %iter_1583 = cute.get_iter(%view_1581) : !memref_smem_bf16_17
      %coord_1584 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1585 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_1586 = cute.crd2idx(%coord_1584, %lay_1585) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
      %iter_1587 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_1588 = cute.add_offset(%iter_1587, %idx_1586) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1589 = cute.make_view(%ptr_1588) : !memref_rmem_bf16_9
      %iter_1590 = cute.get_iter(%view_1589) : !memref_rmem_bf16_9
      %iter_1591 = cute.get_iter(%view_1589) : !memref_rmem_bf16_9
      %lay_1592 = cute.get_layout(%view_1581) : !memref_smem_bf16_17
      %553 = cute.get_shape(%lay_1592) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1593, %e1_1594, %e2_1595 = cute.get_leaves(%553) : !cute.shape<"((8,1),4)">
      %lay_1596 = cute.get_layout(%view_1589) : !memref_rmem_bf16_9
      %554 = cute.get_shape(%lay_1596) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1597, %e1_1598, %e2_1599 = cute.get_leaves(%554) : !cute.shape<"((8,1),4)">
      %lay_1600 = cute.get_layout(%view_1581) : !memref_smem_bf16_17
      %shape_1601 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1602 = cute.make_layout() : !cute.layout<"1:0">
      %append_1603 = cute.append_to_rank<2> (%lay_1600, %lay_1602) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1604 = cute.make_view(%iter_1583, %append_1603) : !memref_smem_bf16_17
      %iter_1605 = cute.get_iter(%view_1604) : !memref_smem_bf16_17
      %lay_1606 = cute.get_layout(%view_1604) : !memref_smem_bf16_17
      %555 = cute.get_shape(%lay_1606) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1607, %e1_1608, %e2_1609 = cute.get_leaves(%555) : !cute.shape<"((8,1),4)">
      %iter_1610 = cute.get_iter(%view_1604) : !memref_smem_bf16_17
      %view_1611 = cute.make_view(%iter_1610) : !memref_smem_bf16_18
      %iter_1612 = cute.get_iter(%view_1611) : !memref_smem_bf16_18
      %iter_1613 = cute.get_iter(%view_1611) : !memref_smem_bf16_18
      %lay_1614 = cute.get_layout(%view_1589) : !memref_rmem_bf16_9
      %shape_1615 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1616 = cute.make_layout() : !cute.layout<"1:0">
      %append_1617 = cute.append_to_rank<2> (%lay_1614, %lay_1616) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1618 = cute.make_view(%iter_1591, %append_1617) : !memref_rmem_bf16_9
      %iter_1619 = cute.get_iter(%view_1618) : !memref_rmem_bf16_9
      %lay_1620 = cute.get_layout(%view_1618) : !memref_rmem_bf16_9
      %556 = cute.get_shape(%lay_1620) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1621, %e1_1622, %e2_1623 = cute.get_leaves(%556) : !cute.shape<"((8,1),4)">
      %iter_1624 = cute.get_iter(%view_1618) : !memref_rmem_bf16_9
      %view_1625 = cute.make_view(%iter_1624) : !memref_rmem_bf16_10
      %iter_1626 = cute.get_iter(%view_1625) : !memref_rmem_bf16_10
      %iter_1627 = cute.get_iter(%view_1625) : !memref_rmem_bf16_10
      %lay_1628 = cute.get_layout(%view_1611) : !memref_smem_bf16_18
      %557 = cute.get_shape(%lay_1628) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1629, %e1_1630, %e2_1631 = cute.get_leaves(%557) : !cute.shape<"((8,1),(4))">
      %lay_1632 = cute.get_layout(%view_1625) : !memref_rmem_bf16_10
      %558 = cute.get_shape(%lay_1632) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1633, %e1_1634, %e2_1635 = cute.get_leaves(%558) : !cute.shape<"((8,1),(4))">
      %lay_1636 = cute.get_layout(%view_1611) : !memref_smem_bf16_18
      %sz_1637 = cute.size(%lay_1636) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1638 = cute.get_leaves(%sz_1637) : !cute.int_tuple<"4">
      %lay_1639 = cute.get_layout(%view_1625) : !memref_rmem_bf16_10
      %sz_1640 = cute.size(%lay_1639) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1641 = cute.get_leaves(%sz_1640) : !cute.int_tuple<"4">
      %559 = cute.static : !cute.layout<"1:0">
      %iter_1642 = cute.get_iter(%view_1611) : !memref_smem_bf16_18
      %iter_1643 = cute.get_iter(%view_1625) : !memref_rmem_bf16_10
      %lay_1644 = cute.get_layout(%view_1611) : !memref_smem_bf16_18
      %lay_1645 = cute.get_layout(%view_1625) : !memref_rmem_bf16_10
      %append_1646 = cute.append_to_rank<2> (%lay_1644, %559) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1647 = cute.append_to_rank<2> (%lay_1645, %559) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1648 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1649 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1650 = cute.size(%lay_1648) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %560 = cute.get_scalars(%sz_1650) : !cute.int_tuple<"4">
      %c0_i32_1651 = arith.constant 0 : i32
      %c1_i32_1652 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1651 to %560 step %c1_i32_1652  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1648, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1648) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_1642, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1649, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1649) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1643, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1653 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1654 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1655 = cute.crd2idx(%coord_1653, %lay_1654) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
      %iter_1656 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1657 = cute.add_offset(%iter_1656, %idx_1655) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1658 = cute.make_view(%ptr_1657) : !memref_rmem_bf16_12
      %iter_1659 = cute.get_iter(%view_1658) : !memref_rmem_bf16_12
      %iter_1660 = cute.get_iter(%view_1658) : !memref_rmem_bf16_12
      %coord_1661 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1662 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1663 = cute.crd2idx(%coord_1661, %lay_1662) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
      %iter_1664 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1665 = cute.add_offset(%iter_1664, %idx_1663) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1666 = cute.make_view(%ptr_1665) : !memref_rmem_bf16_13
      %iter_1667 = cute.get_iter(%view_1666) : !memref_rmem_bf16_13
      %iter_1668 = cute.get_iter(%view_1666) : !memref_rmem_bf16_13
      %lay_1669 = cute.get_layout(%view_1658) : !memref_rmem_bf16_12
      %561 = cute.get_shape(%lay_1669) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1670, %e1_1671, %e2_1672, %e3_1673 = cute.get_leaves(%561) : !cute.shape<"((2,2,2),2)">
      %lay_1674 = cute.get_layout(%view_1666) : !memref_rmem_bf16_13
      %562 = cute.get_shape(%lay_1674) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1675, %e1_1676, %e2_1677 = cute.get_leaves(%562) : !cute.shape<"((2,2),8)">
      %iter_1678 = cute.get_iter(%view_1658) : !memref_rmem_bf16_12
      %iter_1679 = cute.get_iter(%view_1666) : !memref_rmem_bf16_13
      %iter_1680 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_1681 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_1682 = cute.get_layout(%view_1658) : !memref_rmem_bf16_12
      %lay_1683 = cute.get_layout(%view_1666) : !memref_rmem_bf16_13
      %lay_1684 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_1685 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %563 = cute.static : !cute.layout<"1:0">
      %append_1686 = cute.append_to_rank<3> (%lay_1682, %563) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1687 = cute.append_to_rank<3> (%lay_1683, %563) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1688 = cute.size(%append_1686) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1689 = cute.size(%append_1686) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1690 = cute.size(%append_1687) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %564 = cute.get_scalars(%sz_1688) : !cute.int_tuple<"1">
      %565 = cute.get_scalars(%sz_1689) : !cute.int_tuple<"2">
      %566 = cute.get_scalars(%sz_1690) : !cute.int_tuple<"8">
      %c0_i32_1691 = arith.constant 0 : i32
      %c1_i32_1692 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1691 to %564 step %c1_i32_1692  : i32 {
        scf.for %arg6 = %c0_i32_1691 to %565 step %c1_i32_1692  : i32 {
          scf.for %arg7 = %c0_i32_1691 to %566 step %c1_i32_1692  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_1686, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_1686) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_1678, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_1687, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_1687) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_1679, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_1684, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_1684) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_1680, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_1685, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_1685) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_1681, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1693 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1694 = cute.size(%int_tuple_1693) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1695 = cute.get_leaves(%sz_1694) : !cute.int_tuple<"8">
      %coord_1696 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1697 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_1698 = cute.crd2idx(%coord_1696, %lay_1697) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1699 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_1700 = cute.add_offset(%iter_1699, %idx_1698) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1701 = cute.make_view(%ptr_1700) : !memref_smem_bf16_14
      %iter_1702 = cute.get_iter(%view_1701) : !memref_smem_bf16_14
      %iter_1703 = cute.get_iter(%view_1701) : !memref_smem_bf16_14
      %coord_1704 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1705 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1706 = cute.crd2idx(%coord_1704, %lay_1705) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
      %iter_1707 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1708 = cute.add_offset(%iter_1707, %idx_1706) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1709 = cute.make_view(%ptr_1708) : !memref_rmem_bf16_6
      %iter_1710 = cute.get_iter(%view_1709) : !memref_rmem_bf16_6
      %iter_1711 = cute.get_iter(%view_1709) : !memref_rmem_bf16_6
      %lay_1712 = cute.get_layout(%view_1701) : !memref_smem_bf16_14
      %567 = cute.get_shape(%lay_1712) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1713, %e1_1714, %e2_1715 = cute.get_leaves(%567) : !cute.shape<"((8,1),2)">
      %lay_1716 = cute.get_layout(%view_1709) : !memref_rmem_bf16_6
      %568 = cute.get_shape(%lay_1716) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1717, %e1_1718, %e2_1719 = cute.get_leaves(%568) : !cute.shape<"((8,1),2)">
      %lay_1720 = cute.get_layout(%view_1701) : !memref_smem_bf16_14
      %shape_1721 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1722 = cute.make_layout() : !cute.layout<"1:0">
      %append_1723 = cute.append_to_rank<2> (%lay_1720, %lay_1722) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1724 = cute.make_view(%iter_1703, %append_1723) : !memref_smem_bf16_14
      %iter_1725 = cute.get_iter(%view_1724) : !memref_smem_bf16_14
      %lay_1726 = cute.get_layout(%view_1724) : !memref_smem_bf16_14
      %569 = cute.get_shape(%lay_1726) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1727, %e1_1728, %e2_1729 = cute.get_leaves(%569) : !cute.shape<"((8,1),2)">
      %iter_1730 = cute.get_iter(%view_1724) : !memref_smem_bf16_14
      %view_1731 = cute.make_view(%iter_1730) : !memref_smem_bf16_15
      %iter_1732 = cute.get_iter(%view_1731) : !memref_smem_bf16_15
      %iter_1733 = cute.get_iter(%view_1731) : !memref_smem_bf16_15
      %lay_1734 = cute.get_layout(%view_1709) : !memref_rmem_bf16_6
      %shape_1735 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1736 = cute.make_layout() : !cute.layout<"1:0">
      %append_1737 = cute.append_to_rank<2> (%lay_1734, %lay_1736) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1738 = cute.make_view(%iter_1711, %append_1737) : !memref_rmem_bf16_6
      %iter_1739 = cute.get_iter(%view_1738) : !memref_rmem_bf16_6
      %lay_1740 = cute.get_layout(%view_1738) : !memref_rmem_bf16_6
      %570 = cute.get_shape(%lay_1740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1741, %e1_1742, %e2_1743 = cute.get_leaves(%570) : !cute.shape<"((8,1),2)">
      %iter_1744 = cute.get_iter(%view_1738) : !memref_rmem_bf16_6
      %view_1745 = cute.make_view(%iter_1744) : !memref_rmem_bf16_7
      %iter_1746 = cute.get_iter(%view_1745) : !memref_rmem_bf16_7
      %iter_1747 = cute.get_iter(%view_1745) : !memref_rmem_bf16_7
      %lay_1748 = cute.get_layout(%view_1731) : !memref_smem_bf16_15
      %571 = cute.get_shape(%lay_1748) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1749, %e1_1750, %e2_1751 = cute.get_leaves(%571) : !cute.shape<"((8,1),(2))">
      %lay_1752 = cute.get_layout(%view_1745) : !memref_rmem_bf16_7
      %572 = cute.get_shape(%lay_1752) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1753, %e1_1754, %e2_1755 = cute.get_leaves(%572) : !cute.shape<"((8,1),(2))">
      %lay_1756 = cute.get_layout(%view_1731) : !memref_smem_bf16_15
      %sz_1757 = cute.size(%lay_1756) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1758 = cute.get_leaves(%sz_1757) : !cute.int_tuple<"2">
      %lay_1759 = cute.get_layout(%view_1745) : !memref_rmem_bf16_7
      %sz_1760 = cute.size(%lay_1759) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1761 = cute.get_leaves(%sz_1760) : !cute.int_tuple<"2">
      %573 = cute.static : !cute.layout<"1:0">
      %iter_1762 = cute.get_iter(%view_1731) : !memref_smem_bf16_15
      %iter_1763 = cute.get_iter(%view_1745) : !memref_rmem_bf16_7
      %lay_1764 = cute.get_layout(%view_1731) : !memref_smem_bf16_15
      %lay_1765 = cute.get_layout(%view_1745) : !memref_rmem_bf16_7
      %append_1766 = cute.append_to_rank<2> (%lay_1764, %573) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1767 = cute.append_to_rank<2> (%lay_1765, %573) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1768 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1769 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1770 = cute.size(%lay_1768) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %574 = cute.get_scalars(%sz_1770) : !cute.int_tuple<"2">
      %c0_i32_1771 = arith.constant 0 : i32
      %c1_i32_1772 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1771 to %574 step %c1_i32_1772  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1768, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1768) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_1762, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1769, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1769) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1763, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1773 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1774 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_1775 = cute.crd2idx(%coord_1773, %lay_1774) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1776 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_1777 = cute.add_offset(%iter_1776, %idx_1775) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1778 = cute.make_view(%ptr_1777) : !memref_smem_bf16_17
      %iter_1779 = cute.get_iter(%view_1778) : !memref_smem_bf16_17
      %iter_1780 = cute.get_iter(%view_1778) : !memref_smem_bf16_17
      %coord_1781 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1782 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_1783 = cute.crd2idx(%coord_1781, %lay_1782) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
      %iter_1784 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_1785 = cute.add_offset(%iter_1784, %idx_1783) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1786 = cute.make_view(%ptr_1785) : !memref_rmem_bf16_9
      %iter_1787 = cute.get_iter(%view_1786) : !memref_rmem_bf16_9
      %iter_1788 = cute.get_iter(%view_1786) : !memref_rmem_bf16_9
      %lay_1789 = cute.get_layout(%view_1778) : !memref_smem_bf16_17
      %575 = cute.get_shape(%lay_1789) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1790, %e1_1791, %e2_1792 = cute.get_leaves(%575) : !cute.shape<"((8,1),4)">
      %lay_1793 = cute.get_layout(%view_1786) : !memref_rmem_bf16_9
      %576 = cute.get_shape(%lay_1793) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1794, %e1_1795, %e2_1796 = cute.get_leaves(%576) : !cute.shape<"((8,1),4)">
      %lay_1797 = cute.get_layout(%view_1778) : !memref_smem_bf16_17
      %shape_1798 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1799 = cute.make_layout() : !cute.layout<"1:0">
      %append_1800 = cute.append_to_rank<2> (%lay_1797, %lay_1799) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1801 = cute.make_view(%iter_1780, %append_1800) : !memref_smem_bf16_17
      %iter_1802 = cute.get_iter(%view_1801) : !memref_smem_bf16_17
      %lay_1803 = cute.get_layout(%view_1801) : !memref_smem_bf16_17
      %577 = cute.get_shape(%lay_1803) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1804, %e1_1805, %e2_1806 = cute.get_leaves(%577) : !cute.shape<"((8,1),4)">
      %iter_1807 = cute.get_iter(%view_1801) : !memref_smem_bf16_17
      %view_1808 = cute.make_view(%iter_1807) : !memref_smem_bf16_18
      %iter_1809 = cute.get_iter(%view_1808) : !memref_smem_bf16_18
      %iter_1810 = cute.get_iter(%view_1808) : !memref_smem_bf16_18
      %lay_1811 = cute.get_layout(%view_1786) : !memref_rmem_bf16_9
      %shape_1812 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1813 = cute.make_layout() : !cute.layout<"1:0">
      %append_1814 = cute.append_to_rank<2> (%lay_1811, %lay_1813) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1815 = cute.make_view(%iter_1788, %append_1814) : !memref_rmem_bf16_9
      %iter_1816 = cute.get_iter(%view_1815) : !memref_rmem_bf16_9
      %lay_1817 = cute.get_layout(%view_1815) : !memref_rmem_bf16_9
      %578 = cute.get_shape(%lay_1817) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1818, %e1_1819, %e2_1820 = cute.get_leaves(%578) : !cute.shape<"((8,1),4)">
      %iter_1821 = cute.get_iter(%view_1815) : !memref_rmem_bf16_9
      %view_1822 = cute.make_view(%iter_1821) : !memref_rmem_bf16_10
      %iter_1823 = cute.get_iter(%view_1822) : !memref_rmem_bf16_10
      %iter_1824 = cute.get_iter(%view_1822) : !memref_rmem_bf16_10
      %lay_1825 = cute.get_layout(%view_1808) : !memref_smem_bf16_18
      %579 = cute.get_shape(%lay_1825) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1826, %e1_1827, %e2_1828 = cute.get_leaves(%579) : !cute.shape<"((8,1),(4))">
      %lay_1829 = cute.get_layout(%view_1822) : !memref_rmem_bf16_10
      %580 = cute.get_shape(%lay_1829) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1830, %e1_1831, %e2_1832 = cute.get_leaves(%580) : !cute.shape<"((8,1),(4))">
      %lay_1833 = cute.get_layout(%view_1808) : !memref_smem_bf16_18
      %sz_1834 = cute.size(%lay_1833) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1835 = cute.get_leaves(%sz_1834) : !cute.int_tuple<"4">
      %lay_1836 = cute.get_layout(%view_1822) : !memref_rmem_bf16_10
      %sz_1837 = cute.size(%lay_1836) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1838 = cute.get_leaves(%sz_1837) : !cute.int_tuple<"4">
      %581 = cute.static : !cute.layout<"1:0">
      %iter_1839 = cute.get_iter(%view_1808) : !memref_smem_bf16_18
      %iter_1840 = cute.get_iter(%view_1822) : !memref_rmem_bf16_10
      %lay_1841 = cute.get_layout(%view_1808) : !memref_smem_bf16_18
      %lay_1842 = cute.get_layout(%view_1822) : !memref_rmem_bf16_10
      %append_1843 = cute.append_to_rank<2> (%lay_1841, %581) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1844 = cute.append_to_rank<2> (%lay_1842, %581) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1845 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1846 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1847 = cute.size(%lay_1845) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %582 = cute.get_scalars(%sz_1847) : !cute.int_tuple<"4">
      %c0_i32_1848 = arith.constant 0 : i32
      %c1_i32_1849 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1848 to %582 step %c1_i32_1849  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1845, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1845) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_1839, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1846, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1846) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1840, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1850 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1851 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1852 = cute.crd2idx(%coord_1850, %lay_1851) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
      %iter_1853 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1854 = cute.add_offset(%iter_1853, %idx_1852) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1855 = cute.make_view(%ptr_1854) : !memref_rmem_bf16_12
      %iter_1856 = cute.get_iter(%view_1855) : !memref_rmem_bf16_12
      %iter_1857 = cute.get_iter(%view_1855) : !memref_rmem_bf16_12
      %coord_1858 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1859 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1860 = cute.crd2idx(%coord_1858, %lay_1859) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
      %iter_1861 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1862 = cute.add_offset(%iter_1861, %idx_1860) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1863 = cute.make_view(%ptr_1862) : !memref_rmem_bf16_13
      %iter_1864 = cute.get_iter(%view_1863) : !memref_rmem_bf16_13
      %iter_1865 = cute.get_iter(%view_1863) : !memref_rmem_bf16_13
      %lay_1866 = cute.get_layout(%view_1855) : !memref_rmem_bf16_12
      %583 = cute.get_shape(%lay_1866) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1867, %e1_1868, %e2_1869, %e3_1870 = cute.get_leaves(%583) : !cute.shape<"((2,2,2),2)">
      %lay_1871 = cute.get_layout(%view_1863) : !memref_rmem_bf16_13
      %584 = cute.get_shape(%lay_1871) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1872, %e1_1873, %e2_1874 = cute.get_leaves(%584) : !cute.shape<"((2,2),8)">
      %iter_1875 = cute.get_iter(%view_1855) : !memref_rmem_bf16_12
      %iter_1876 = cute.get_iter(%view_1863) : !memref_rmem_bf16_13
      %iter_1877 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_1878 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_1879 = cute.get_layout(%view_1855) : !memref_rmem_bf16_12
      %lay_1880 = cute.get_layout(%view_1863) : !memref_rmem_bf16_13
      %lay_1881 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_1882 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %585 = cute.static : !cute.layout<"1:0">
      %append_1883 = cute.append_to_rank<3> (%lay_1879, %585) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1884 = cute.append_to_rank<3> (%lay_1880, %585) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1885 = cute.size(%append_1883) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1886 = cute.size(%append_1883) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1887 = cute.size(%append_1884) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %586 = cute.get_scalars(%sz_1885) : !cute.int_tuple<"1">
      %587 = cute.get_scalars(%sz_1886) : !cute.int_tuple<"2">
      %588 = cute.get_scalars(%sz_1887) : !cute.int_tuple<"8">
      %c0_i32_1888 = arith.constant 0 : i32
      %c1_i32_1889 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1888 to %586 step %c1_i32_1889  : i32 {
        scf.for %arg6 = %c0_i32_1888 to %587 step %c1_i32_1889  : i32 {
          scf.for %arg7 = %c0_i32_1888 to %588 step %c1_i32_1889  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_1883, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_1883) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_1875, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_1884, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_1884) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_1876, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_1881, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_1881) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_1877, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_1882, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_1882) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_1878, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1890 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1891 = cute.size(%int_tuple_1890) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1892 = cute.get_leaves(%sz_1891) : !cute.int_tuple<"8">
      %coord_1893 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1894 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_1895 = cute.crd2idx(%coord_1893, %lay_1894) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
      %iter_1896 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_1897 = cute.add_offset(%iter_1896, %idx_1895) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1898 = cute.make_view(%ptr_1897) : !memref_smem_bf16_14
      %iter_1899 = cute.get_iter(%view_1898) : !memref_smem_bf16_14
      %iter_1900 = cute.get_iter(%view_1898) : !memref_smem_bf16_14
      %coord_1901 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1902 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1903 = cute.crd2idx(%coord_1901, %lay_1902) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
      %iter_1904 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1905 = cute.add_offset(%iter_1904, %idx_1903) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1906 = cute.make_view(%ptr_1905) : !memref_rmem_bf16_6
      %iter_1907 = cute.get_iter(%view_1906) : !memref_rmem_bf16_6
      %iter_1908 = cute.get_iter(%view_1906) : !memref_rmem_bf16_6
      %lay_1909 = cute.get_layout(%view_1898) : !memref_smem_bf16_14
      %589 = cute.get_shape(%lay_1909) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1910, %e1_1911, %e2_1912 = cute.get_leaves(%589) : !cute.shape<"((8,1),2)">
      %lay_1913 = cute.get_layout(%view_1906) : !memref_rmem_bf16_6
      %590 = cute.get_shape(%lay_1913) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1914, %e1_1915, %e2_1916 = cute.get_leaves(%590) : !cute.shape<"((8,1),2)">
      %lay_1917 = cute.get_layout(%view_1898) : !memref_smem_bf16_14
      %shape_1918 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1919 = cute.make_layout() : !cute.layout<"1:0">
      %append_1920 = cute.append_to_rank<2> (%lay_1917, %lay_1919) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1921 = cute.make_view(%iter_1900, %append_1920) : !memref_smem_bf16_14
      %iter_1922 = cute.get_iter(%view_1921) : !memref_smem_bf16_14
      %lay_1923 = cute.get_layout(%view_1921) : !memref_smem_bf16_14
      %591 = cute.get_shape(%lay_1923) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1924, %e1_1925, %e2_1926 = cute.get_leaves(%591) : !cute.shape<"((8,1),2)">
      %iter_1927 = cute.get_iter(%view_1921) : !memref_smem_bf16_14
      %view_1928 = cute.make_view(%iter_1927) : !memref_smem_bf16_15
      %iter_1929 = cute.get_iter(%view_1928) : !memref_smem_bf16_15
      %iter_1930 = cute.get_iter(%view_1928) : !memref_smem_bf16_15
      %lay_1931 = cute.get_layout(%view_1906) : !memref_rmem_bf16_6
      %shape_1932 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1933 = cute.make_layout() : !cute.layout<"1:0">
      %append_1934 = cute.append_to_rank<2> (%lay_1931, %lay_1933) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1935 = cute.make_view(%iter_1908, %append_1934) : !memref_rmem_bf16_6
      %iter_1936 = cute.get_iter(%view_1935) : !memref_rmem_bf16_6
      %lay_1937 = cute.get_layout(%view_1935) : !memref_rmem_bf16_6
      %592 = cute.get_shape(%lay_1937) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1938, %e1_1939, %e2_1940 = cute.get_leaves(%592) : !cute.shape<"((8,1),2)">
      %iter_1941 = cute.get_iter(%view_1935) : !memref_rmem_bf16_6
      %view_1942 = cute.make_view(%iter_1941) : !memref_rmem_bf16_7
      %iter_1943 = cute.get_iter(%view_1942) : !memref_rmem_bf16_7
      %iter_1944 = cute.get_iter(%view_1942) : !memref_rmem_bf16_7
      %lay_1945 = cute.get_layout(%view_1928) : !memref_smem_bf16_15
      %593 = cute.get_shape(%lay_1945) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1946, %e1_1947, %e2_1948 = cute.get_leaves(%593) : !cute.shape<"((8,1),(2))">
      %lay_1949 = cute.get_layout(%view_1942) : !memref_rmem_bf16_7
      %594 = cute.get_shape(%lay_1949) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1950, %e1_1951, %e2_1952 = cute.get_leaves(%594) : !cute.shape<"((8,1),(2))">
      %lay_1953 = cute.get_layout(%view_1928) : !memref_smem_bf16_15
      %sz_1954 = cute.size(%lay_1953) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1955 = cute.get_leaves(%sz_1954) : !cute.int_tuple<"2">
      %lay_1956 = cute.get_layout(%view_1942) : !memref_rmem_bf16_7
      %sz_1957 = cute.size(%lay_1956) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1958 = cute.get_leaves(%sz_1957) : !cute.int_tuple<"2">
      %595 = cute.static : !cute.layout<"1:0">
      %iter_1959 = cute.get_iter(%view_1928) : !memref_smem_bf16_15
      %iter_1960 = cute.get_iter(%view_1942) : !memref_rmem_bf16_7
      %lay_1961 = cute.get_layout(%view_1928) : !memref_smem_bf16_15
      %lay_1962 = cute.get_layout(%view_1942) : !memref_rmem_bf16_7
      %append_1963 = cute.append_to_rank<2> (%lay_1961, %595) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1964 = cute.append_to_rank<2> (%lay_1962, %595) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1965 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1966 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1967 = cute.size(%lay_1965) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %596 = cute.get_scalars(%sz_1967) : !cute.int_tuple<"2">
      %c0_i32_1968 = arith.constant 0 : i32
      %c1_i32_1969 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1968 to %596 step %c1_i32_1969  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_1965, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_1965) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_1959, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_1966, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_1966) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_1960, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1970 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1971 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_1972 = cute.crd2idx(%coord_1970, %lay_1971) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
      %iter_1973 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_1974 = cute.add_offset(%iter_1973, %idx_1972) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1975 = cute.make_view(%ptr_1974) : !memref_smem_bf16_17
      %iter_1976 = cute.get_iter(%view_1975) : !memref_smem_bf16_17
      %iter_1977 = cute.get_iter(%view_1975) : !memref_smem_bf16_17
      %coord_1978 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1979 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_1980 = cute.crd2idx(%coord_1978, %lay_1979) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
      %iter_1981 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_1982 = cute.add_offset(%iter_1981, %idx_1980) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1983 = cute.make_view(%ptr_1982) : !memref_rmem_bf16_9
      %iter_1984 = cute.get_iter(%view_1983) : !memref_rmem_bf16_9
      %iter_1985 = cute.get_iter(%view_1983) : !memref_rmem_bf16_9
      %lay_1986 = cute.get_layout(%view_1975) : !memref_smem_bf16_17
      %597 = cute.get_shape(%lay_1986) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1987, %e1_1988, %e2_1989 = cute.get_leaves(%597) : !cute.shape<"((8,1),4)">
      %lay_1990 = cute.get_layout(%view_1983) : !memref_rmem_bf16_9
      %598 = cute.get_shape(%lay_1990) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1991, %e1_1992, %e2_1993 = cute.get_leaves(%598) : !cute.shape<"((8,1),4)">
      %lay_1994 = cute.get_layout(%view_1975) : !memref_smem_bf16_17
      %shape_1995 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1996 = cute.make_layout() : !cute.layout<"1:0">
      %append_1997 = cute.append_to_rank<2> (%lay_1994, %lay_1996) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1998 = cute.make_view(%iter_1977, %append_1997) : !memref_smem_bf16_17
      %iter_1999 = cute.get_iter(%view_1998) : !memref_smem_bf16_17
      %lay_2000 = cute.get_layout(%view_1998) : !memref_smem_bf16_17
      %599 = cute.get_shape(%lay_2000) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2001, %e1_2002, %e2_2003 = cute.get_leaves(%599) : !cute.shape<"((8,1),4)">
      %iter_2004 = cute.get_iter(%view_1998) : !memref_smem_bf16_17
      %view_2005 = cute.make_view(%iter_2004) : !memref_smem_bf16_18
      %iter_2006 = cute.get_iter(%view_2005) : !memref_smem_bf16_18
      %iter_2007 = cute.get_iter(%view_2005) : !memref_smem_bf16_18
      %lay_2008 = cute.get_layout(%view_1983) : !memref_rmem_bf16_9
      %shape_2009 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2010 = cute.make_layout() : !cute.layout<"1:0">
      %append_2011 = cute.append_to_rank<2> (%lay_2008, %lay_2010) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2012 = cute.make_view(%iter_1985, %append_2011) : !memref_rmem_bf16_9
      %iter_2013 = cute.get_iter(%view_2012) : !memref_rmem_bf16_9
      %lay_2014 = cute.get_layout(%view_2012) : !memref_rmem_bf16_9
      %600 = cute.get_shape(%lay_2014) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2015, %e1_2016, %e2_2017 = cute.get_leaves(%600) : !cute.shape<"((8,1),4)">
      %iter_2018 = cute.get_iter(%view_2012) : !memref_rmem_bf16_9
      %view_2019 = cute.make_view(%iter_2018) : !memref_rmem_bf16_10
      %iter_2020 = cute.get_iter(%view_2019) : !memref_rmem_bf16_10
      %iter_2021 = cute.get_iter(%view_2019) : !memref_rmem_bf16_10
      %lay_2022 = cute.get_layout(%view_2005) : !memref_smem_bf16_18
      %601 = cute.get_shape(%lay_2022) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2023, %e1_2024, %e2_2025 = cute.get_leaves(%601) : !cute.shape<"((8,1),(4))">
      %lay_2026 = cute.get_layout(%view_2019) : !memref_rmem_bf16_10
      %602 = cute.get_shape(%lay_2026) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2027, %e1_2028, %e2_2029 = cute.get_leaves(%602) : !cute.shape<"((8,1),(4))">
      %lay_2030 = cute.get_layout(%view_2005) : !memref_smem_bf16_18
      %sz_2031 = cute.size(%lay_2030) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2032 = cute.get_leaves(%sz_2031) : !cute.int_tuple<"4">
      %lay_2033 = cute.get_layout(%view_2019) : !memref_rmem_bf16_10
      %sz_2034 = cute.size(%lay_2033) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2035 = cute.get_leaves(%sz_2034) : !cute.int_tuple<"4">
      %603 = cute.static : !cute.layout<"1:0">
      %iter_2036 = cute.get_iter(%view_2005) : !memref_smem_bf16_18
      %iter_2037 = cute.get_iter(%view_2019) : !memref_rmem_bf16_10
      %lay_2038 = cute.get_layout(%view_2005) : !memref_smem_bf16_18
      %lay_2039 = cute.get_layout(%view_2019) : !memref_rmem_bf16_10
      %append_2040 = cute.append_to_rank<2> (%lay_2038, %603) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2041 = cute.append_to_rank<2> (%lay_2039, %603) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2042 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2043 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2044 = cute.size(%lay_2042) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %604 = cute.get_scalars(%sz_2044) : !cute.int_tuple<"4">
      %c0_i32_2045 = arith.constant 0 : i32
      %c1_i32_2046 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2045 to %604 step %c1_i32_2046  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2042, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2042) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_2036, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2043, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2043) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2037, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2047 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2048 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2049 = cute.crd2idx(%coord_2047, %lay_2048) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
      %iter_2050 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2051 = cute.add_offset(%iter_2050, %idx_2049) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2052 = cute.make_view(%ptr_2051) : !memref_rmem_bf16_12
      %iter_2053 = cute.get_iter(%view_2052) : !memref_rmem_bf16_12
      %iter_2054 = cute.get_iter(%view_2052) : !memref_rmem_bf16_12
      %coord_2055 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2056 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2057 = cute.crd2idx(%coord_2055, %lay_2056) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
      %iter_2058 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2059 = cute.add_offset(%iter_2058, %idx_2057) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2060 = cute.make_view(%ptr_2059) : !memref_rmem_bf16_13
      %iter_2061 = cute.get_iter(%view_2060) : !memref_rmem_bf16_13
      %iter_2062 = cute.get_iter(%view_2060) : !memref_rmem_bf16_13
      %lay_2063 = cute.get_layout(%view_2052) : !memref_rmem_bf16_12
      %605 = cute.get_shape(%lay_2063) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2064, %e1_2065, %e2_2066, %e3_2067 = cute.get_leaves(%605) : !cute.shape<"((2,2,2),2)">
      %lay_2068 = cute.get_layout(%view_2060) : !memref_rmem_bf16_13
      %606 = cute.get_shape(%lay_2068) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2069, %e1_2070, %e2_2071 = cute.get_leaves(%606) : !cute.shape<"((2,2),8)">
      %iter_2072 = cute.get_iter(%view_2052) : !memref_rmem_bf16_12
      %iter_2073 = cute.get_iter(%view_2060) : !memref_rmem_bf16_13
      %iter_2074 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_2075 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_2076 = cute.get_layout(%view_2052) : !memref_rmem_bf16_12
      %lay_2077 = cute.get_layout(%view_2060) : !memref_rmem_bf16_13
      %lay_2078 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2079 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %607 = cute.static : !cute.layout<"1:0">
      %append_2080 = cute.append_to_rank<3> (%lay_2076, %607) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2081 = cute.append_to_rank<3> (%lay_2077, %607) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2082 = cute.size(%append_2080) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2083 = cute.size(%append_2080) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2084 = cute.size(%append_2081) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %608 = cute.get_scalars(%sz_2082) : !cute.int_tuple<"1">
      %609 = cute.get_scalars(%sz_2083) : !cute.int_tuple<"2">
      %610 = cute.get_scalars(%sz_2084) : !cute.int_tuple<"8">
      %c0_i32_2085 = arith.constant 0 : i32
      %c1_i32_2086 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2085 to %608 step %c1_i32_2086  : i32 {
        scf.for %arg6 = %c0_i32_2085 to %609 step %c1_i32_2086  : i32 {
          scf.for %arg7 = %c0_i32_2085 to %610 step %c1_i32_2086  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_2080, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_2080) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_2072, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_2081, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_2081) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_2073, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_2078, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_2078) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_2074, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_2079, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_2079) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_2075, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2087 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2088 = cute.size(%int_tuple_2087) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2089 = cute.get_leaves(%sz_2088) : !cute.int_tuple<"8">
      %coord_2090 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2091 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_2092 = cute.crd2idx(%coord_2090, %lay_2091) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2093 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_2094 = cute.add_offset(%iter_2093, %idx_2092) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2095 = cute.make_view(%ptr_2094) : !memref_smem_bf16_14
      %iter_2096 = cute.get_iter(%view_2095) : !memref_smem_bf16_14
      %iter_2097 = cute.get_iter(%view_2095) : !memref_smem_bf16_14
      %coord_2098 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2099 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2100 = cute.crd2idx(%coord_2098, %lay_2099) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
      %iter_2101 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2102 = cute.add_offset(%iter_2101, %idx_2100) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2103 = cute.make_view(%ptr_2102) : !memref_rmem_bf16_6
      %iter_2104 = cute.get_iter(%view_2103) : !memref_rmem_bf16_6
      %iter_2105 = cute.get_iter(%view_2103) : !memref_rmem_bf16_6
      %lay_2106 = cute.get_layout(%view_2095) : !memref_smem_bf16_14
      %611 = cute.get_shape(%lay_2106) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2107, %e1_2108, %e2_2109 = cute.get_leaves(%611) : !cute.shape<"((8,1),2)">
      %lay_2110 = cute.get_layout(%view_2103) : !memref_rmem_bf16_6
      %612 = cute.get_shape(%lay_2110) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2111, %e1_2112, %e2_2113 = cute.get_leaves(%612) : !cute.shape<"((8,1),2)">
      %lay_2114 = cute.get_layout(%view_2095) : !memref_smem_bf16_14
      %shape_2115 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2116 = cute.make_layout() : !cute.layout<"1:0">
      %append_2117 = cute.append_to_rank<2> (%lay_2114, %lay_2116) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2118 = cute.make_view(%iter_2097, %append_2117) : !memref_smem_bf16_14
      %iter_2119 = cute.get_iter(%view_2118) : !memref_smem_bf16_14
      %lay_2120 = cute.get_layout(%view_2118) : !memref_smem_bf16_14
      %613 = cute.get_shape(%lay_2120) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2121, %e1_2122, %e2_2123 = cute.get_leaves(%613) : !cute.shape<"((8,1),2)">
      %iter_2124 = cute.get_iter(%view_2118) : !memref_smem_bf16_14
      %view_2125 = cute.make_view(%iter_2124) : !memref_smem_bf16_15
      %iter_2126 = cute.get_iter(%view_2125) : !memref_smem_bf16_15
      %iter_2127 = cute.get_iter(%view_2125) : !memref_smem_bf16_15
      %lay_2128 = cute.get_layout(%view_2103) : !memref_rmem_bf16_6
      %shape_2129 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2130 = cute.make_layout() : !cute.layout<"1:0">
      %append_2131 = cute.append_to_rank<2> (%lay_2128, %lay_2130) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2132 = cute.make_view(%iter_2105, %append_2131) : !memref_rmem_bf16_6
      %iter_2133 = cute.get_iter(%view_2132) : !memref_rmem_bf16_6
      %lay_2134 = cute.get_layout(%view_2132) : !memref_rmem_bf16_6
      %614 = cute.get_shape(%lay_2134) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2135, %e1_2136, %e2_2137 = cute.get_leaves(%614) : !cute.shape<"((8,1),2)">
      %iter_2138 = cute.get_iter(%view_2132) : !memref_rmem_bf16_6
      %view_2139 = cute.make_view(%iter_2138) : !memref_rmem_bf16_7
      %iter_2140 = cute.get_iter(%view_2139) : !memref_rmem_bf16_7
      %iter_2141 = cute.get_iter(%view_2139) : !memref_rmem_bf16_7
      %lay_2142 = cute.get_layout(%view_2125) : !memref_smem_bf16_15
      %615 = cute.get_shape(%lay_2142) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2143, %e1_2144, %e2_2145 = cute.get_leaves(%615) : !cute.shape<"((8,1),(2))">
      %lay_2146 = cute.get_layout(%view_2139) : !memref_rmem_bf16_7
      %616 = cute.get_shape(%lay_2146) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2147, %e1_2148, %e2_2149 = cute.get_leaves(%616) : !cute.shape<"((8,1),(2))">
      %lay_2150 = cute.get_layout(%view_2125) : !memref_smem_bf16_15
      %sz_2151 = cute.size(%lay_2150) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2152 = cute.get_leaves(%sz_2151) : !cute.int_tuple<"2">
      %lay_2153 = cute.get_layout(%view_2139) : !memref_rmem_bf16_7
      %sz_2154 = cute.size(%lay_2153) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2155 = cute.get_leaves(%sz_2154) : !cute.int_tuple<"2">
      %617 = cute.static : !cute.layout<"1:0">
      %iter_2156 = cute.get_iter(%view_2125) : !memref_smem_bf16_15
      %iter_2157 = cute.get_iter(%view_2139) : !memref_rmem_bf16_7
      %lay_2158 = cute.get_layout(%view_2125) : !memref_smem_bf16_15
      %lay_2159 = cute.get_layout(%view_2139) : !memref_rmem_bf16_7
      %append_2160 = cute.append_to_rank<2> (%lay_2158, %617) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2161 = cute.append_to_rank<2> (%lay_2159, %617) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2162 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2163 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2164 = cute.size(%lay_2162) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %618 = cute.get_scalars(%sz_2164) : !cute.int_tuple<"2">
      %c0_i32_2165 = arith.constant 0 : i32
      %c1_i32_2166 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2165 to %618 step %c1_i32_2166  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2162, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2162) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_2156, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2163, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2163) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2157, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2167 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2168 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_2169 = cute.crd2idx(%coord_2167, %lay_2168) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2170 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_2171 = cute.add_offset(%iter_2170, %idx_2169) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2172 = cute.make_view(%ptr_2171) : !memref_smem_bf16_17
      %iter_2173 = cute.get_iter(%view_2172) : !memref_smem_bf16_17
      %iter_2174 = cute.get_iter(%view_2172) : !memref_smem_bf16_17
      %coord_2175 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2176 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_2177 = cute.crd2idx(%coord_2175, %lay_2176) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
      %iter_2178 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_2179 = cute.add_offset(%iter_2178, %idx_2177) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2180 = cute.make_view(%ptr_2179) : !memref_rmem_bf16_9
      %iter_2181 = cute.get_iter(%view_2180) : !memref_rmem_bf16_9
      %iter_2182 = cute.get_iter(%view_2180) : !memref_rmem_bf16_9
      %lay_2183 = cute.get_layout(%view_2172) : !memref_smem_bf16_17
      %619 = cute.get_shape(%lay_2183) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2184, %e1_2185, %e2_2186 = cute.get_leaves(%619) : !cute.shape<"((8,1),4)">
      %lay_2187 = cute.get_layout(%view_2180) : !memref_rmem_bf16_9
      %620 = cute.get_shape(%lay_2187) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2188, %e1_2189, %e2_2190 = cute.get_leaves(%620) : !cute.shape<"((8,1),4)">
      %lay_2191 = cute.get_layout(%view_2172) : !memref_smem_bf16_17
      %shape_2192 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2193 = cute.make_layout() : !cute.layout<"1:0">
      %append_2194 = cute.append_to_rank<2> (%lay_2191, %lay_2193) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2195 = cute.make_view(%iter_2174, %append_2194) : !memref_smem_bf16_17
      %iter_2196 = cute.get_iter(%view_2195) : !memref_smem_bf16_17
      %lay_2197 = cute.get_layout(%view_2195) : !memref_smem_bf16_17
      %621 = cute.get_shape(%lay_2197) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2198, %e1_2199, %e2_2200 = cute.get_leaves(%621) : !cute.shape<"((8,1),4)">
      %iter_2201 = cute.get_iter(%view_2195) : !memref_smem_bf16_17
      %view_2202 = cute.make_view(%iter_2201) : !memref_smem_bf16_18
      %iter_2203 = cute.get_iter(%view_2202) : !memref_smem_bf16_18
      %iter_2204 = cute.get_iter(%view_2202) : !memref_smem_bf16_18
      %lay_2205 = cute.get_layout(%view_2180) : !memref_rmem_bf16_9
      %shape_2206 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2207 = cute.make_layout() : !cute.layout<"1:0">
      %append_2208 = cute.append_to_rank<2> (%lay_2205, %lay_2207) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2209 = cute.make_view(%iter_2182, %append_2208) : !memref_rmem_bf16_9
      %iter_2210 = cute.get_iter(%view_2209) : !memref_rmem_bf16_9
      %lay_2211 = cute.get_layout(%view_2209) : !memref_rmem_bf16_9
      %622 = cute.get_shape(%lay_2211) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2212, %e1_2213, %e2_2214 = cute.get_leaves(%622) : !cute.shape<"((8,1),4)">
      %iter_2215 = cute.get_iter(%view_2209) : !memref_rmem_bf16_9
      %view_2216 = cute.make_view(%iter_2215) : !memref_rmem_bf16_10
      %iter_2217 = cute.get_iter(%view_2216) : !memref_rmem_bf16_10
      %iter_2218 = cute.get_iter(%view_2216) : !memref_rmem_bf16_10
      %lay_2219 = cute.get_layout(%view_2202) : !memref_smem_bf16_18
      %623 = cute.get_shape(%lay_2219) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2220, %e1_2221, %e2_2222 = cute.get_leaves(%623) : !cute.shape<"((8,1),(4))">
      %lay_2223 = cute.get_layout(%view_2216) : !memref_rmem_bf16_10
      %624 = cute.get_shape(%lay_2223) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2224, %e1_2225, %e2_2226 = cute.get_leaves(%624) : !cute.shape<"((8,1),(4))">
      %lay_2227 = cute.get_layout(%view_2202) : !memref_smem_bf16_18
      %sz_2228 = cute.size(%lay_2227) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2229 = cute.get_leaves(%sz_2228) : !cute.int_tuple<"4">
      %lay_2230 = cute.get_layout(%view_2216) : !memref_rmem_bf16_10
      %sz_2231 = cute.size(%lay_2230) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2232 = cute.get_leaves(%sz_2231) : !cute.int_tuple<"4">
      %625 = cute.static : !cute.layout<"1:0">
      %iter_2233 = cute.get_iter(%view_2202) : !memref_smem_bf16_18
      %iter_2234 = cute.get_iter(%view_2216) : !memref_rmem_bf16_10
      %lay_2235 = cute.get_layout(%view_2202) : !memref_smem_bf16_18
      %lay_2236 = cute.get_layout(%view_2216) : !memref_rmem_bf16_10
      %append_2237 = cute.append_to_rank<2> (%lay_2235, %625) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2238 = cute.append_to_rank<2> (%lay_2236, %625) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2239 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2240 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2241 = cute.size(%lay_2239) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %626 = cute.get_scalars(%sz_2241) : !cute.int_tuple<"4">
      %c0_i32_2242 = arith.constant 0 : i32
      %c1_i32_2243 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2242 to %626 step %c1_i32_2243  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2239, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2239) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_2233, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2240, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2240) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2234, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2244 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2245 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2246 = cute.crd2idx(%coord_2244, %lay_2245) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
      %iter_2247 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2248 = cute.add_offset(%iter_2247, %idx_2246) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2249 = cute.make_view(%ptr_2248) : !memref_rmem_bf16_12
      %iter_2250 = cute.get_iter(%view_2249) : !memref_rmem_bf16_12
      %iter_2251 = cute.get_iter(%view_2249) : !memref_rmem_bf16_12
      %coord_2252 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2253 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2254 = cute.crd2idx(%coord_2252, %lay_2253) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
      %iter_2255 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2256 = cute.add_offset(%iter_2255, %idx_2254) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2257 = cute.make_view(%ptr_2256) : !memref_rmem_bf16_13
      %iter_2258 = cute.get_iter(%view_2257) : !memref_rmem_bf16_13
      %iter_2259 = cute.get_iter(%view_2257) : !memref_rmem_bf16_13
      %lay_2260 = cute.get_layout(%view_2249) : !memref_rmem_bf16_12
      %627 = cute.get_shape(%lay_2260) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2261, %e1_2262, %e2_2263, %e3_2264 = cute.get_leaves(%627) : !cute.shape<"((2,2,2),2)">
      %lay_2265 = cute.get_layout(%view_2257) : !memref_rmem_bf16_13
      %628 = cute.get_shape(%lay_2265) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2266, %e1_2267, %e2_2268 = cute.get_leaves(%628) : !cute.shape<"((2,2),8)">
      %iter_2269 = cute.get_iter(%view_2249) : !memref_rmem_bf16_12
      %iter_2270 = cute.get_iter(%view_2257) : !memref_rmem_bf16_13
      %iter_2271 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_2272 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_2273 = cute.get_layout(%view_2249) : !memref_rmem_bf16_12
      %lay_2274 = cute.get_layout(%view_2257) : !memref_rmem_bf16_13
      %lay_2275 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2276 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %629 = cute.static : !cute.layout<"1:0">
      %append_2277 = cute.append_to_rank<3> (%lay_2273, %629) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2278 = cute.append_to_rank<3> (%lay_2274, %629) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2279 = cute.size(%append_2277) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2280 = cute.size(%append_2277) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2281 = cute.size(%append_2278) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %630 = cute.get_scalars(%sz_2279) : !cute.int_tuple<"1">
      %631 = cute.get_scalars(%sz_2280) : !cute.int_tuple<"2">
      %632 = cute.get_scalars(%sz_2281) : !cute.int_tuple<"8">
      %c0_i32_2282 = arith.constant 0 : i32
      %c1_i32_2283 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2282 to %630 step %c1_i32_2283  : i32 {
        scf.for %arg6 = %c0_i32_2282 to %631 step %c1_i32_2283  : i32 {
          scf.for %arg7 = %c0_i32_2282 to %632 step %c1_i32_2283  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_2277, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_2277) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_2269, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_2278, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_2278) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_2270, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_2275, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_2275) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_2271, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_2276, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_2276) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_2272, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2284 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2285 = cute.size(%int_tuple_2284) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2286 = cute.get_leaves(%sz_2285) : !cute.int_tuple<"8">
      %coord_2287 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2288 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_2289 = cute.crd2idx(%coord_2287, %lay_2288) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2290 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_2291 = cute.add_offset(%iter_2290, %idx_2289) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2292 = cute.make_view(%ptr_2291) : !memref_smem_bf16_14
      %iter_2293 = cute.get_iter(%view_2292) : !memref_smem_bf16_14
      %iter_2294 = cute.get_iter(%view_2292) : !memref_smem_bf16_14
      %coord_2295 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2296 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2297 = cute.crd2idx(%coord_2295, %lay_2296) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
      %iter_2298 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2299 = cute.add_offset(%iter_2298, %idx_2297) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2300 = cute.make_view(%ptr_2299) : !memref_rmem_bf16_6
      %iter_2301 = cute.get_iter(%view_2300) : !memref_rmem_bf16_6
      %iter_2302 = cute.get_iter(%view_2300) : !memref_rmem_bf16_6
      %lay_2303 = cute.get_layout(%view_2292) : !memref_smem_bf16_14
      %633 = cute.get_shape(%lay_2303) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2304, %e1_2305, %e2_2306 = cute.get_leaves(%633) : !cute.shape<"((8,1),2)">
      %lay_2307 = cute.get_layout(%view_2300) : !memref_rmem_bf16_6
      %634 = cute.get_shape(%lay_2307) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2308, %e1_2309, %e2_2310 = cute.get_leaves(%634) : !cute.shape<"((8,1),2)">
      %lay_2311 = cute.get_layout(%view_2292) : !memref_smem_bf16_14
      %shape_2312 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2313 = cute.make_layout() : !cute.layout<"1:0">
      %append_2314 = cute.append_to_rank<2> (%lay_2311, %lay_2313) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2315 = cute.make_view(%iter_2294, %append_2314) : !memref_smem_bf16_14
      %iter_2316 = cute.get_iter(%view_2315) : !memref_smem_bf16_14
      %lay_2317 = cute.get_layout(%view_2315) : !memref_smem_bf16_14
      %635 = cute.get_shape(%lay_2317) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2318, %e1_2319, %e2_2320 = cute.get_leaves(%635) : !cute.shape<"((8,1),2)">
      %iter_2321 = cute.get_iter(%view_2315) : !memref_smem_bf16_14
      %view_2322 = cute.make_view(%iter_2321) : !memref_smem_bf16_15
      %iter_2323 = cute.get_iter(%view_2322) : !memref_smem_bf16_15
      %iter_2324 = cute.get_iter(%view_2322) : !memref_smem_bf16_15
      %lay_2325 = cute.get_layout(%view_2300) : !memref_rmem_bf16_6
      %shape_2326 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2327 = cute.make_layout() : !cute.layout<"1:0">
      %append_2328 = cute.append_to_rank<2> (%lay_2325, %lay_2327) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2329 = cute.make_view(%iter_2302, %append_2328) : !memref_rmem_bf16_6
      %iter_2330 = cute.get_iter(%view_2329) : !memref_rmem_bf16_6
      %lay_2331 = cute.get_layout(%view_2329) : !memref_rmem_bf16_6
      %636 = cute.get_shape(%lay_2331) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2332, %e1_2333, %e2_2334 = cute.get_leaves(%636) : !cute.shape<"((8,1),2)">
      %iter_2335 = cute.get_iter(%view_2329) : !memref_rmem_bf16_6
      %view_2336 = cute.make_view(%iter_2335) : !memref_rmem_bf16_7
      %iter_2337 = cute.get_iter(%view_2336) : !memref_rmem_bf16_7
      %iter_2338 = cute.get_iter(%view_2336) : !memref_rmem_bf16_7
      %lay_2339 = cute.get_layout(%view_2322) : !memref_smem_bf16_15
      %637 = cute.get_shape(%lay_2339) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2340, %e1_2341, %e2_2342 = cute.get_leaves(%637) : !cute.shape<"((8,1),(2))">
      %lay_2343 = cute.get_layout(%view_2336) : !memref_rmem_bf16_7
      %638 = cute.get_shape(%lay_2343) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2344, %e1_2345, %e2_2346 = cute.get_leaves(%638) : !cute.shape<"((8,1),(2))">
      %lay_2347 = cute.get_layout(%view_2322) : !memref_smem_bf16_15
      %sz_2348 = cute.size(%lay_2347) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2349 = cute.get_leaves(%sz_2348) : !cute.int_tuple<"2">
      %lay_2350 = cute.get_layout(%view_2336) : !memref_rmem_bf16_7
      %sz_2351 = cute.size(%lay_2350) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2352 = cute.get_leaves(%sz_2351) : !cute.int_tuple<"2">
      %639 = cute.static : !cute.layout<"1:0">
      %iter_2353 = cute.get_iter(%view_2322) : !memref_smem_bf16_15
      %iter_2354 = cute.get_iter(%view_2336) : !memref_rmem_bf16_7
      %lay_2355 = cute.get_layout(%view_2322) : !memref_smem_bf16_15
      %lay_2356 = cute.get_layout(%view_2336) : !memref_rmem_bf16_7
      %append_2357 = cute.append_to_rank<2> (%lay_2355, %639) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2358 = cute.append_to_rank<2> (%lay_2356, %639) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2359 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2360 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2361 = cute.size(%lay_2359) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %640 = cute.get_scalars(%sz_2361) : !cute.int_tuple<"2">
      %c0_i32_2362 = arith.constant 0 : i32
      %c1_i32_2363 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2362 to %640 step %c1_i32_2363  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2359, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2359) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_2353, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2360, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2360) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2354, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2364 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2365 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_2366 = cute.crd2idx(%coord_2364, %lay_2365) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2367 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_2368 = cute.add_offset(%iter_2367, %idx_2366) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2369 = cute.make_view(%ptr_2368) : !memref_smem_bf16_17
      %iter_2370 = cute.get_iter(%view_2369) : !memref_smem_bf16_17
      %iter_2371 = cute.get_iter(%view_2369) : !memref_smem_bf16_17
      %coord_2372 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2373 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_2374 = cute.crd2idx(%coord_2372, %lay_2373) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
      %iter_2375 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_2376 = cute.add_offset(%iter_2375, %idx_2374) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2377 = cute.make_view(%ptr_2376) : !memref_rmem_bf16_9
      %iter_2378 = cute.get_iter(%view_2377) : !memref_rmem_bf16_9
      %iter_2379 = cute.get_iter(%view_2377) : !memref_rmem_bf16_9
      %lay_2380 = cute.get_layout(%view_2369) : !memref_smem_bf16_17
      %641 = cute.get_shape(%lay_2380) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2381, %e1_2382, %e2_2383 = cute.get_leaves(%641) : !cute.shape<"((8,1),4)">
      %lay_2384 = cute.get_layout(%view_2377) : !memref_rmem_bf16_9
      %642 = cute.get_shape(%lay_2384) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2385, %e1_2386, %e2_2387 = cute.get_leaves(%642) : !cute.shape<"((8,1),4)">
      %lay_2388 = cute.get_layout(%view_2369) : !memref_smem_bf16_17
      %shape_2389 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2390 = cute.make_layout() : !cute.layout<"1:0">
      %append_2391 = cute.append_to_rank<2> (%lay_2388, %lay_2390) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2392 = cute.make_view(%iter_2371, %append_2391) : !memref_smem_bf16_17
      %iter_2393 = cute.get_iter(%view_2392) : !memref_smem_bf16_17
      %lay_2394 = cute.get_layout(%view_2392) : !memref_smem_bf16_17
      %643 = cute.get_shape(%lay_2394) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2395, %e1_2396, %e2_2397 = cute.get_leaves(%643) : !cute.shape<"((8,1),4)">
      %iter_2398 = cute.get_iter(%view_2392) : !memref_smem_bf16_17
      %view_2399 = cute.make_view(%iter_2398) : !memref_smem_bf16_18
      %iter_2400 = cute.get_iter(%view_2399) : !memref_smem_bf16_18
      %iter_2401 = cute.get_iter(%view_2399) : !memref_smem_bf16_18
      %lay_2402 = cute.get_layout(%view_2377) : !memref_rmem_bf16_9
      %shape_2403 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2404 = cute.make_layout() : !cute.layout<"1:0">
      %append_2405 = cute.append_to_rank<2> (%lay_2402, %lay_2404) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2406 = cute.make_view(%iter_2379, %append_2405) : !memref_rmem_bf16_9
      %iter_2407 = cute.get_iter(%view_2406) : !memref_rmem_bf16_9
      %lay_2408 = cute.get_layout(%view_2406) : !memref_rmem_bf16_9
      %644 = cute.get_shape(%lay_2408) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2409, %e1_2410, %e2_2411 = cute.get_leaves(%644) : !cute.shape<"((8,1),4)">
      %iter_2412 = cute.get_iter(%view_2406) : !memref_rmem_bf16_9
      %view_2413 = cute.make_view(%iter_2412) : !memref_rmem_bf16_10
      %iter_2414 = cute.get_iter(%view_2413) : !memref_rmem_bf16_10
      %iter_2415 = cute.get_iter(%view_2413) : !memref_rmem_bf16_10
      %lay_2416 = cute.get_layout(%view_2399) : !memref_smem_bf16_18
      %645 = cute.get_shape(%lay_2416) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2417, %e1_2418, %e2_2419 = cute.get_leaves(%645) : !cute.shape<"((8,1),(4))">
      %lay_2420 = cute.get_layout(%view_2413) : !memref_rmem_bf16_10
      %646 = cute.get_shape(%lay_2420) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2421, %e1_2422, %e2_2423 = cute.get_leaves(%646) : !cute.shape<"((8,1),(4))">
      %lay_2424 = cute.get_layout(%view_2399) : !memref_smem_bf16_18
      %sz_2425 = cute.size(%lay_2424) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2426 = cute.get_leaves(%sz_2425) : !cute.int_tuple<"4">
      %lay_2427 = cute.get_layout(%view_2413) : !memref_rmem_bf16_10
      %sz_2428 = cute.size(%lay_2427) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2429 = cute.get_leaves(%sz_2428) : !cute.int_tuple<"4">
      %647 = cute.static : !cute.layout<"1:0">
      %iter_2430 = cute.get_iter(%view_2399) : !memref_smem_bf16_18
      %iter_2431 = cute.get_iter(%view_2413) : !memref_rmem_bf16_10
      %lay_2432 = cute.get_layout(%view_2399) : !memref_smem_bf16_18
      %lay_2433 = cute.get_layout(%view_2413) : !memref_rmem_bf16_10
      %append_2434 = cute.append_to_rank<2> (%lay_2432, %647) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2435 = cute.append_to_rank<2> (%lay_2433, %647) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2436 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2437 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2438 = cute.size(%lay_2436) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %648 = cute.get_scalars(%sz_2438) : !cute.int_tuple<"4">
      %c0_i32_2439 = arith.constant 0 : i32
      %c1_i32_2440 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2439 to %648 step %c1_i32_2440  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2436, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2436) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_2430, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2437, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2437) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2431, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2441 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2442 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2443 = cute.crd2idx(%coord_2441, %lay_2442) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
      %iter_2444 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2445 = cute.add_offset(%iter_2444, %idx_2443) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2446 = cute.make_view(%ptr_2445) : !memref_rmem_bf16_12
      %iter_2447 = cute.get_iter(%view_2446) : !memref_rmem_bf16_12
      %iter_2448 = cute.get_iter(%view_2446) : !memref_rmem_bf16_12
      %coord_2449 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2450 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2451 = cute.crd2idx(%coord_2449, %lay_2450) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
      %iter_2452 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2453 = cute.add_offset(%iter_2452, %idx_2451) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2454 = cute.make_view(%ptr_2453) : !memref_rmem_bf16_13
      %iter_2455 = cute.get_iter(%view_2454) : !memref_rmem_bf16_13
      %iter_2456 = cute.get_iter(%view_2454) : !memref_rmem_bf16_13
      %lay_2457 = cute.get_layout(%view_2446) : !memref_rmem_bf16_12
      %649 = cute.get_shape(%lay_2457) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2458, %e1_2459, %e2_2460, %e3_2461 = cute.get_leaves(%649) : !cute.shape<"((2,2,2),2)">
      %lay_2462 = cute.get_layout(%view_2454) : !memref_rmem_bf16_13
      %650 = cute.get_shape(%lay_2462) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2463, %e1_2464, %e2_2465 = cute.get_leaves(%650) : !cute.shape<"((2,2),8)">
      %iter_2466 = cute.get_iter(%view_2446) : !memref_rmem_bf16_12
      %iter_2467 = cute.get_iter(%view_2454) : !memref_rmem_bf16_13
      %iter_2468 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_2469 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_2470 = cute.get_layout(%view_2446) : !memref_rmem_bf16_12
      %lay_2471 = cute.get_layout(%view_2454) : !memref_rmem_bf16_13
      %lay_2472 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2473 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %651 = cute.static : !cute.layout<"1:0">
      %append_2474 = cute.append_to_rank<3> (%lay_2470, %651) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2475 = cute.append_to_rank<3> (%lay_2471, %651) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2476 = cute.size(%append_2474) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2477 = cute.size(%append_2474) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2478 = cute.size(%append_2475) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %652 = cute.get_scalars(%sz_2476) : !cute.int_tuple<"1">
      %653 = cute.get_scalars(%sz_2477) : !cute.int_tuple<"2">
      %654 = cute.get_scalars(%sz_2478) : !cute.int_tuple<"8">
      %c0_i32_2479 = arith.constant 0 : i32
      %c1_i32_2480 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2479 to %652 step %c1_i32_2480  : i32 {
        scf.for %arg6 = %c0_i32_2479 to %653 step %c1_i32_2480  : i32 {
          scf.for %arg7 = %c0_i32_2479 to %654 step %c1_i32_2480  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_2474, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_2474) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_2466, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_2475, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_2475) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_2467, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_2472, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_2472) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_2468, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_2473, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_2473) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_2469, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2481 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2482 = cute.size(%int_tuple_2481) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2483 = cute.get_leaves(%sz_2482) : !cute.int_tuple<"8">
      %coord_2484 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2485 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_2486 = cute.crd2idx(%coord_2484, %lay_2485) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2487 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_2488 = cute.add_offset(%iter_2487, %idx_2486) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2489 = cute.make_view(%ptr_2488) : !memref_smem_bf16_14
      %iter_2490 = cute.get_iter(%view_2489) : !memref_smem_bf16_14
      %iter_2491 = cute.get_iter(%view_2489) : !memref_smem_bf16_14
      %coord_2492 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2493 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2494 = cute.crd2idx(%coord_2492, %lay_2493) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
      %iter_2495 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2496 = cute.add_offset(%iter_2495, %idx_2494) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2497 = cute.make_view(%ptr_2496) : !memref_rmem_bf16_6
      %iter_2498 = cute.get_iter(%view_2497) : !memref_rmem_bf16_6
      %iter_2499 = cute.get_iter(%view_2497) : !memref_rmem_bf16_6
      %lay_2500 = cute.get_layout(%view_2489) : !memref_smem_bf16_14
      %655 = cute.get_shape(%lay_2500) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2501, %e1_2502, %e2_2503 = cute.get_leaves(%655) : !cute.shape<"((8,1),2)">
      %lay_2504 = cute.get_layout(%view_2497) : !memref_rmem_bf16_6
      %656 = cute.get_shape(%lay_2504) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2505, %e1_2506, %e2_2507 = cute.get_leaves(%656) : !cute.shape<"((8,1),2)">
      %lay_2508 = cute.get_layout(%view_2489) : !memref_smem_bf16_14
      %shape_2509 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2510 = cute.make_layout() : !cute.layout<"1:0">
      %append_2511 = cute.append_to_rank<2> (%lay_2508, %lay_2510) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2512 = cute.make_view(%iter_2491, %append_2511) : !memref_smem_bf16_14
      %iter_2513 = cute.get_iter(%view_2512) : !memref_smem_bf16_14
      %lay_2514 = cute.get_layout(%view_2512) : !memref_smem_bf16_14
      %657 = cute.get_shape(%lay_2514) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2515, %e1_2516, %e2_2517 = cute.get_leaves(%657) : !cute.shape<"((8,1),2)">
      %iter_2518 = cute.get_iter(%view_2512) : !memref_smem_bf16_14
      %view_2519 = cute.make_view(%iter_2518) : !memref_smem_bf16_15
      %iter_2520 = cute.get_iter(%view_2519) : !memref_smem_bf16_15
      %iter_2521 = cute.get_iter(%view_2519) : !memref_smem_bf16_15
      %lay_2522 = cute.get_layout(%view_2497) : !memref_rmem_bf16_6
      %shape_2523 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2524 = cute.make_layout() : !cute.layout<"1:0">
      %append_2525 = cute.append_to_rank<2> (%lay_2522, %lay_2524) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2526 = cute.make_view(%iter_2499, %append_2525) : !memref_rmem_bf16_6
      %iter_2527 = cute.get_iter(%view_2526) : !memref_rmem_bf16_6
      %lay_2528 = cute.get_layout(%view_2526) : !memref_rmem_bf16_6
      %658 = cute.get_shape(%lay_2528) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2529, %e1_2530, %e2_2531 = cute.get_leaves(%658) : !cute.shape<"((8,1),2)">
      %iter_2532 = cute.get_iter(%view_2526) : !memref_rmem_bf16_6
      %view_2533 = cute.make_view(%iter_2532) : !memref_rmem_bf16_7
      %iter_2534 = cute.get_iter(%view_2533) : !memref_rmem_bf16_7
      %iter_2535 = cute.get_iter(%view_2533) : !memref_rmem_bf16_7
      %lay_2536 = cute.get_layout(%view_2519) : !memref_smem_bf16_15
      %659 = cute.get_shape(%lay_2536) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2537, %e1_2538, %e2_2539 = cute.get_leaves(%659) : !cute.shape<"((8,1),(2))">
      %lay_2540 = cute.get_layout(%view_2533) : !memref_rmem_bf16_7
      %660 = cute.get_shape(%lay_2540) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2541, %e1_2542, %e2_2543 = cute.get_leaves(%660) : !cute.shape<"((8,1),(2))">
      %lay_2544 = cute.get_layout(%view_2519) : !memref_smem_bf16_15
      %sz_2545 = cute.size(%lay_2544) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2546 = cute.get_leaves(%sz_2545) : !cute.int_tuple<"2">
      %lay_2547 = cute.get_layout(%view_2533) : !memref_rmem_bf16_7
      %sz_2548 = cute.size(%lay_2547) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2549 = cute.get_leaves(%sz_2548) : !cute.int_tuple<"2">
      %661 = cute.static : !cute.layout<"1:0">
      %iter_2550 = cute.get_iter(%view_2519) : !memref_smem_bf16_15
      %iter_2551 = cute.get_iter(%view_2533) : !memref_rmem_bf16_7
      %lay_2552 = cute.get_layout(%view_2519) : !memref_smem_bf16_15
      %lay_2553 = cute.get_layout(%view_2533) : !memref_rmem_bf16_7
      %append_2554 = cute.append_to_rank<2> (%lay_2552, %661) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2555 = cute.append_to_rank<2> (%lay_2553, %661) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2556 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2557 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2558 = cute.size(%lay_2556) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %662 = cute.get_scalars(%sz_2558) : !cute.int_tuple<"2">
      %c0_i32_2559 = arith.constant 0 : i32
      %c1_i32_2560 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2559 to %662 step %c1_i32_2560  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2556, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2556) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_2550, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2557, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2557) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2551, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2561 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2562 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_2563 = cute.crd2idx(%coord_2561, %lay_2562) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2564 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_2565 = cute.add_offset(%iter_2564, %idx_2563) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2566 = cute.make_view(%ptr_2565) : !memref_smem_bf16_17
      %iter_2567 = cute.get_iter(%view_2566) : !memref_smem_bf16_17
      %iter_2568 = cute.get_iter(%view_2566) : !memref_smem_bf16_17
      %coord_2569 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2570 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_2571 = cute.crd2idx(%coord_2569, %lay_2570) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
      %iter_2572 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_2573 = cute.add_offset(%iter_2572, %idx_2571) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2574 = cute.make_view(%ptr_2573) : !memref_rmem_bf16_9
      %iter_2575 = cute.get_iter(%view_2574) : !memref_rmem_bf16_9
      %iter_2576 = cute.get_iter(%view_2574) : !memref_rmem_bf16_9
      %lay_2577 = cute.get_layout(%view_2566) : !memref_smem_bf16_17
      %663 = cute.get_shape(%lay_2577) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2578, %e1_2579, %e2_2580 = cute.get_leaves(%663) : !cute.shape<"((8,1),4)">
      %lay_2581 = cute.get_layout(%view_2574) : !memref_rmem_bf16_9
      %664 = cute.get_shape(%lay_2581) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2582, %e1_2583, %e2_2584 = cute.get_leaves(%664) : !cute.shape<"((8,1),4)">
      %lay_2585 = cute.get_layout(%view_2566) : !memref_smem_bf16_17
      %shape_2586 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2587 = cute.make_layout() : !cute.layout<"1:0">
      %append_2588 = cute.append_to_rank<2> (%lay_2585, %lay_2587) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2589 = cute.make_view(%iter_2568, %append_2588) : !memref_smem_bf16_17
      %iter_2590 = cute.get_iter(%view_2589) : !memref_smem_bf16_17
      %lay_2591 = cute.get_layout(%view_2589) : !memref_smem_bf16_17
      %665 = cute.get_shape(%lay_2591) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2592, %e1_2593, %e2_2594 = cute.get_leaves(%665) : !cute.shape<"((8,1),4)">
      %iter_2595 = cute.get_iter(%view_2589) : !memref_smem_bf16_17
      %view_2596 = cute.make_view(%iter_2595) : !memref_smem_bf16_18
      %iter_2597 = cute.get_iter(%view_2596) : !memref_smem_bf16_18
      %iter_2598 = cute.get_iter(%view_2596) : !memref_smem_bf16_18
      %lay_2599 = cute.get_layout(%view_2574) : !memref_rmem_bf16_9
      %shape_2600 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2601 = cute.make_layout() : !cute.layout<"1:0">
      %append_2602 = cute.append_to_rank<2> (%lay_2599, %lay_2601) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2603 = cute.make_view(%iter_2576, %append_2602) : !memref_rmem_bf16_9
      %iter_2604 = cute.get_iter(%view_2603) : !memref_rmem_bf16_9
      %lay_2605 = cute.get_layout(%view_2603) : !memref_rmem_bf16_9
      %666 = cute.get_shape(%lay_2605) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2606, %e1_2607, %e2_2608 = cute.get_leaves(%666) : !cute.shape<"((8,1),4)">
      %iter_2609 = cute.get_iter(%view_2603) : !memref_rmem_bf16_9
      %view_2610 = cute.make_view(%iter_2609) : !memref_rmem_bf16_10
      %iter_2611 = cute.get_iter(%view_2610) : !memref_rmem_bf16_10
      %iter_2612 = cute.get_iter(%view_2610) : !memref_rmem_bf16_10
      %lay_2613 = cute.get_layout(%view_2596) : !memref_smem_bf16_18
      %667 = cute.get_shape(%lay_2613) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2614, %e1_2615, %e2_2616 = cute.get_leaves(%667) : !cute.shape<"((8,1),(4))">
      %lay_2617 = cute.get_layout(%view_2610) : !memref_rmem_bf16_10
      %668 = cute.get_shape(%lay_2617) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2618, %e1_2619, %e2_2620 = cute.get_leaves(%668) : !cute.shape<"((8,1),(4))">
      %lay_2621 = cute.get_layout(%view_2596) : !memref_smem_bf16_18
      %sz_2622 = cute.size(%lay_2621) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2623 = cute.get_leaves(%sz_2622) : !cute.int_tuple<"4">
      %lay_2624 = cute.get_layout(%view_2610) : !memref_rmem_bf16_10
      %sz_2625 = cute.size(%lay_2624) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2626 = cute.get_leaves(%sz_2625) : !cute.int_tuple<"4">
      %669 = cute.static : !cute.layout<"1:0">
      %iter_2627 = cute.get_iter(%view_2596) : !memref_smem_bf16_18
      %iter_2628 = cute.get_iter(%view_2610) : !memref_rmem_bf16_10
      %lay_2629 = cute.get_layout(%view_2596) : !memref_smem_bf16_18
      %lay_2630 = cute.get_layout(%view_2610) : !memref_rmem_bf16_10
      %append_2631 = cute.append_to_rank<2> (%lay_2629, %669) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2632 = cute.append_to_rank<2> (%lay_2630, %669) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2633 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2634 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2635 = cute.size(%lay_2633) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %670 = cute.get_scalars(%sz_2635) : !cute.int_tuple<"4">
      %c0_i32_2636 = arith.constant 0 : i32
      %c1_i32_2637 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2636 to %670 step %c1_i32_2637  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2633, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2633) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_2627, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2634, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2634) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2628, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2638 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2639 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2640 = cute.crd2idx(%coord_2638, %lay_2639) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
      %iter_2641 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2642 = cute.add_offset(%iter_2641, %idx_2640) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2643 = cute.make_view(%ptr_2642) : !memref_rmem_bf16_12
      %iter_2644 = cute.get_iter(%view_2643) : !memref_rmem_bf16_12
      %iter_2645 = cute.get_iter(%view_2643) : !memref_rmem_bf16_12
      %coord_2646 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2647 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2648 = cute.crd2idx(%coord_2646, %lay_2647) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
      %iter_2649 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2650 = cute.add_offset(%iter_2649, %idx_2648) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2651 = cute.make_view(%ptr_2650) : !memref_rmem_bf16_13
      %iter_2652 = cute.get_iter(%view_2651) : !memref_rmem_bf16_13
      %iter_2653 = cute.get_iter(%view_2651) : !memref_rmem_bf16_13
      %lay_2654 = cute.get_layout(%view_2643) : !memref_rmem_bf16_12
      %671 = cute.get_shape(%lay_2654) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2655, %e1_2656, %e2_2657, %e3_2658 = cute.get_leaves(%671) : !cute.shape<"((2,2,2),2)">
      %lay_2659 = cute.get_layout(%view_2651) : !memref_rmem_bf16_13
      %672 = cute.get_shape(%lay_2659) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2660, %e1_2661, %e2_2662 = cute.get_leaves(%672) : !cute.shape<"((2,2),8)">
      %iter_2663 = cute.get_iter(%view_2643) : !memref_rmem_bf16_12
      %iter_2664 = cute.get_iter(%view_2651) : !memref_rmem_bf16_13
      %iter_2665 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_2666 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_2667 = cute.get_layout(%view_2643) : !memref_rmem_bf16_12
      %lay_2668 = cute.get_layout(%view_2651) : !memref_rmem_bf16_13
      %lay_2669 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2670 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %673 = cute.static : !cute.layout<"1:0">
      %append_2671 = cute.append_to_rank<3> (%lay_2667, %673) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2672 = cute.append_to_rank<3> (%lay_2668, %673) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2673 = cute.size(%append_2671) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2674 = cute.size(%append_2671) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2675 = cute.size(%append_2672) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %674 = cute.get_scalars(%sz_2673) : !cute.int_tuple<"1">
      %675 = cute.get_scalars(%sz_2674) : !cute.int_tuple<"2">
      %676 = cute.get_scalars(%sz_2675) : !cute.int_tuple<"8">
      %c0_i32_2676 = arith.constant 0 : i32
      %c1_i32_2677 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2676 to %674 step %c1_i32_2677  : i32 {
        scf.for %arg6 = %c0_i32_2676 to %675 step %c1_i32_2677  : i32 {
          scf.for %arg7 = %c0_i32_2676 to %676 step %c1_i32_2677  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_2671, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_2671) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_2663, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_2672, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_2672) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_2664, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_2669, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_2669) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_2665, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_2670, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_2670) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_2666, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2678 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2679 = cute.size(%int_tuple_2678) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2680 = cute.get_leaves(%sz_2679) : !cute.int_tuple<"8">
      %coord_2681 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2682 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
      %idx_2683 = cute.crd2idx(%coord_2681, %lay_2682) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_2684 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
      %ptr_2685 = cute.add_offset(%iter_2684, %idx_2683) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2686 = cute.make_view(%ptr_2685) : !memref_smem_bf16_14
      %iter_2687 = cute.get_iter(%view_2686) : !memref_smem_bf16_14
      %iter_2688 = cute.get_iter(%view_2686) : !memref_smem_bf16_14
      %coord_2689 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2690 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2691 = cute.crd2idx(%coord_2689, %lay_2690) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_2692 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2693 = cute.add_offset(%iter_2692, %idx_2691) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2694 = cute.make_view(%ptr_2693) : !memref_rmem_bf16_6
      %iter_2695 = cute.get_iter(%view_2694) : !memref_rmem_bf16_6
      %iter_2696 = cute.get_iter(%view_2694) : !memref_rmem_bf16_6
      %lay_2697 = cute.get_layout(%view_2686) : !memref_smem_bf16_14
      %677 = cute.get_shape(%lay_2697) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2698, %e1_2699, %e2_2700 = cute.get_leaves(%677) : !cute.shape<"((8,1),2)">
      %lay_2701 = cute.get_layout(%view_2694) : !memref_rmem_bf16_6
      %678 = cute.get_shape(%lay_2701) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2702, %e1_2703, %e2_2704 = cute.get_leaves(%678) : !cute.shape<"((8,1),2)">
      %lay_2705 = cute.get_layout(%view_2686) : !memref_smem_bf16_14
      %shape_2706 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2707 = cute.make_layout() : !cute.layout<"1:0">
      %append_2708 = cute.append_to_rank<2> (%lay_2705, %lay_2707) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2709 = cute.make_view(%iter_2688, %append_2708) : !memref_smem_bf16_14
      %iter_2710 = cute.get_iter(%view_2709) : !memref_smem_bf16_14
      %lay_2711 = cute.get_layout(%view_2709) : !memref_smem_bf16_14
      %679 = cute.get_shape(%lay_2711) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2712, %e1_2713, %e2_2714 = cute.get_leaves(%679) : !cute.shape<"((8,1),2)">
      %iter_2715 = cute.get_iter(%view_2709) : !memref_smem_bf16_14
      %view_2716 = cute.make_view(%iter_2715) : !memref_smem_bf16_15
      %iter_2717 = cute.get_iter(%view_2716) : !memref_smem_bf16_15
      %iter_2718 = cute.get_iter(%view_2716) : !memref_smem_bf16_15
      %lay_2719 = cute.get_layout(%view_2694) : !memref_rmem_bf16_6
      %shape_2720 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2721 = cute.make_layout() : !cute.layout<"1:0">
      %append_2722 = cute.append_to_rank<2> (%lay_2719, %lay_2721) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2723 = cute.make_view(%iter_2696, %append_2722) : !memref_rmem_bf16_6
      %iter_2724 = cute.get_iter(%view_2723) : !memref_rmem_bf16_6
      %lay_2725 = cute.get_layout(%view_2723) : !memref_rmem_bf16_6
      %680 = cute.get_shape(%lay_2725) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2726, %e1_2727, %e2_2728 = cute.get_leaves(%680) : !cute.shape<"((8,1),2)">
      %iter_2729 = cute.get_iter(%view_2723) : !memref_rmem_bf16_6
      %view_2730 = cute.make_view(%iter_2729) : !memref_rmem_bf16_7
      %iter_2731 = cute.get_iter(%view_2730) : !memref_rmem_bf16_7
      %iter_2732 = cute.get_iter(%view_2730) : !memref_rmem_bf16_7
      %lay_2733 = cute.get_layout(%view_2716) : !memref_smem_bf16_15
      %681 = cute.get_shape(%lay_2733) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2734, %e1_2735, %e2_2736 = cute.get_leaves(%681) : !cute.shape<"((8,1),(2))">
      %lay_2737 = cute.get_layout(%view_2730) : !memref_rmem_bf16_7
      %682 = cute.get_shape(%lay_2737) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2738, %e1_2739, %e2_2740 = cute.get_leaves(%682) : !cute.shape<"((8,1),(2))">
      %lay_2741 = cute.get_layout(%view_2716) : !memref_smem_bf16_15
      %sz_2742 = cute.size(%lay_2741) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2743 = cute.get_leaves(%sz_2742) : !cute.int_tuple<"2">
      %lay_2744 = cute.get_layout(%view_2730) : !memref_rmem_bf16_7
      %sz_2745 = cute.size(%lay_2744) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2746 = cute.get_leaves(%sz_2745) : !cute.int_tuple<"2">
      %683 = cute.static : !cute.layout<"1:0">
      %iter_2747 = cute.get_iter(%view_2716) : !memref_smem_bf16_15
      %iter_2748 = cute.get_iter(%view_2730) : !memref_rmem_bf16_7
      %lay_2749 = cute.get_layout(%view_2716) : !memref_smem_bf16_15
      %lay_2750 = cute.get_layout(%view_2730) : !memref_rmem_bf16_7
      %append_2751 = cute.append_to_rank<2> (%lay_2749, %683) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2752 = cute.append_to_rank<2> (%lay_2750, %683) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2753 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2754 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2755 = cute.size(%lay_2753) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %684 = cute.get_scalars(%sz_2755) : !cute.int_tuple<"2">
      %c0_i32_2756 = arith.constant 0 : i32
      %c1_i32_2757 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2756 to %684 step %c1_i32_2757  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2753, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2753) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7832 = cute.add_offset(%iter_2747, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2754, %coord_7829) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2754) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2748, %idx_7835) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7833, %view_7837) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2758 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2759 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
      %idx_2760 = cute.crd2idx(%coord_2758, %lay_2759) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_2761 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
      %ptr_2762 = cute.add_offset(%iter_2761, %idx_2760) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2763 = cute.make_view(%ptr_2762) : !memref_smem_bf16_17
      %iter_2764 = cute.get_iter(%view_2763) : !memref_smem_bf16_17
      %iter_2765 = cute.get_iter(%view_2763) : !memref_smem_bf16_17
      %coord_2766 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2767 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
      %idx_2768 = cute.crd2idx(%coord_2766, %lay_2767) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_2769 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
      %ptr_2770 = cute.add_offset(%iter_2769, %idx_2768) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2771 = cute.make_view(%ptr_2770) : !memref_rmem_bf16_9
      %iter_2772 = cute.get_iter(%view_2771) : !memref_rmem_bf16_9
      %iter_2773 = cute.get_iter(%view_2771) : !memref_rmem_bf16_9
      %lay_2774 = cute.get_layout(%view_2763) : !memref_smem_bf16_17
      %685 = cute.get_shape(%lay_2774) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2775, %e1_2776, %e2_2777 = cute.get_leaves(%685) : !cute.shape<"((8,1),4)">
      %lay_2778 = cute.get_layout(%view_2771) : !memref_rmem_bf16_9
      %686 = cute.get_shape(%lay_2778) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2779, %e1_2780, %e2_2781 = cute.get_leaves(%686) : !cute.shape<"((8,1),4)">
      %lay_2782 = cute.get_layout(%view_2763) : !memref_smem_bf16_17
      %shape_2783 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2784 = cute.make_layout() : !cute.layout<"1:0">
      %append_2785 = cute.append_to_rank<2> (%lay_2782, %lay_2784) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2786 = cute.make_view(%iter_2765, %append_2785) : !memref_smem_bf16_17
      %iter_2787 = cute.get_iter(%view_2786) : !memref_smem_bf16_17
      %lay_2788 = cute.get_layout(%view_2786) : !memref_smem_bf16_17
      %687 = cute.get_shape(%lay_2788) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2789, %e1_2790, %e2_2791 = cute.get_leaves(%687) : !cute.shape<"((8,1),4)">
      %iter_2792 = cute.get_iter(%view_2786) : !memref_smem_bf16_17
      %view_2793 = cute.make_view(%iter_2792) : !memref_smem_bf16_18
      %iter_2794 = cute.get_iter(%view_2793) : !memref_smem_bf16_18
      %iter_2795 = cute.get_iter(%view_2793) : !memref_smem_bf16_18
      %lay_2796 = cute.get_layout(%view_2771) : !memref_rmem_bf16_9
      %shape_2797 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2798 = cute.make_layout() : !cute.layout<"1:0">
      %append_2799 = cute.append_to_rank<2> (%lay_2796, %lay_2798) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2800 = cute.make_view(%iter_2773, %append_2799) : !memref_rmem_bf16_9
      %iter_2801 = cute.get_iter(%view_2800) : !memref_rmem_bf16_9
      %lay_2802 = cute.get_layout(%view_2800) : !memref_rmem_bf16_9
      %688 = cute.get_shape(%lay_2802) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2803, %e1_2804, %e2_2805 = cute.get_leaves(%688) : !cute.shape<"((8,1),4)">
      %iter_2806 = cute.get_iter(%view_2800) : !memref_rmem_bf16_9
      %view_2807 = cute.make_view(%iter_2806) : !memref_rmem_bf16_10
      %iter_2808 = cute.get_iter(%view_2807) : !memref_rmem_bf16_10
      %iter_2809 = cute.get_iter(%view_2807) : !memref_rmem_bf16_10
      %lay_2810 = cute.get_layout(%view_2793) : !memref_smem_bf16_18
      %689 = cute.get_shape(%lay_2810) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2811, %e1_2812, %e2_2813 = cute.get_leaves(%689) : !cute.shape<"((8,1),(4))">
      %lay_2814 = cute.get_layout(%view_2807) : !memref_rmem_bf16_10
      %690 = cute.get_shape(%lay_2814) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2815, %e1_2816, %e2_2817 = cute.get_leaves(%690) : !cute.shape<"((8,1),(4))">
      %lay_2818 = cute.get_layout(%view_2793) : !memref_smem_bf16_18
      %sz_2819 = cute.size(%lay_2818) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2820 = cute.get_leaves(%sz_2819) : !cute.int_tuple<"4">
      %lay_2821 = cute.get_layout(%view_2807) : !memref_rmem_bf16_10
      %sz_2822 = cute.size(%lay_2821) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2823 = cute.get_leaves(%sz_2822) : !cute.int_tuple<"4">
      %691 = cute.static : !cute.layout<"1:0">
      %iter_2824 = cute.get_iter(%view_2793) : !memref_smem_bf16_18
      %iter_2825 = cute.get_iter(%view_2807) : !memref_rmem_bf16_10
      %lay_2826 = cute.get_layout(%view_2793) : !memref_smem_bf16_18
      %lay_2827 = cute.get_layout(%view_2807) : !memref_rmem_bf16_10
      %append_2828 = cute.append_to_rank<2> (%lay_2826, %691) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2829 = cute.append_to_rank<2> (%lay_2827, %691) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2830 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2831 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2832 = cute.size(%lay_2830) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %692 = cute.get_scalars(%sz_2832) : !cute.int_tuple<"4">
      %c0_i32_2833 = arith.constant 0 : i32
      %c1_i32_2834 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2833 to %692 step %c1_i32_2834  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_2830, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_2830) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_2824, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_2831, %coord_7829) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_2831) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_2825, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7833, %view_7837) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2835 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2836 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2837 = cute.crd2idx(%coord_2835, %lay_2836) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
      %iter_2838 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2839 = cute.add_offset(%iter_2838, %idx_2837) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2840 = cute.make_view(%ptr_2839) : !memref_rmem_bf16_12
      %iter_2841 = cute.get_iter(%view_2840) : !memref_rmem_bf16_12
      %iter_2842 = cute.get_iter(%view_2840) : !memref_rmem_bf16_12
      %coord_2843 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2844 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2845 = cute.crd2idx(%coord_2843, %lay_2844) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
      %iter_2846 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2847 = cute.add_offset(%iter_2846, %idx_2845) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2848 = cute.make_view(%ptr_2847) : !memref_rmem_bf16_13
      %iter_2849 = cute.get_iter(%view_2848) : !memref_rmem_bf16_13
      %iter_2850 = cute.get_iter(%view_2848) : !memref_rmem_bf16_13
      %lay_2851 = cute.get_layout(%view_2840) : !memref_rmem_bf16_12
      %693 = cute.get_shape(%lay_2851) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2852, %e1_2853, %e2_2854, %e3_2855 = cute.get_leaves(%693) : !cute.shape<"((2,2,2),2)">
      %lay_2856 = cute.get_layout(%view_2848) : !memref_rmem_bf16_13
      %694 = cute.get_shape(%lay_2856) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2857, %e1_2858, %e2_2859 = cute.get_leaves(%694) : !cute.shape<"((2,2),8)">
      %iter_2860 = cute.get_iter(%view_2840) : !memref_rmem_bf16_12
      %iter_2861 = cute.get_iter(%view_2848) : !memref_rmem_bf16_13
      %iter_2862 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %iter_2863 = cute.get_iter(%rmem_1114) : !memref_rmem_f32_2
      %lay_2864 = cute.get_layout(%view_2840) : !memref_rmem_bf16_12
      %lay_2865 = cute.get_layout(%view_2848) : !memref_rmem_bf16_13
      %lay_2866 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2867 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %695 = cute.static : !cute.layout<"1:0">
      %append_2868 = cute.append_to_rank<3> (%lay_2864, %695) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2869 = cute.append_to_rank<3> (%lay_2865, %695) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2870 = cute.size(%append_2868) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2871 = cute.size(%append_2868) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2872 = cute.size(%append_2869) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %696 = cute.get_scalars(%sz_2870) : !cute.int_tuple<"1">
      %697 = cute.get_scalars(%sz_2871) : !cute.int_tuple<"2">
      %698 = cute.get_scalars(%sz_2872) : !cute.int_tuple<"8">
      %c0_i32_2873 = arith.constant 0 : i32
      %c1_i32_2874 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2873 to %696 step %c1_i32_2874  : i32 {
        scf.for %arg6 = %c0_i32_2873 to %697 step %c1_i32_2874  : i32 {
          scf.for %arg7 = %c0_i32_2873 to %698 step %c1_i32_2874  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_2868, %coord_7829) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_2868) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7834 = cute.add_offset(%iter_2860, %idx_7833) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_14
            %slice_7836 = cute.slice(%append_2869, %coord_7830) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_2869) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_2861, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_2866, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_2866) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_2862, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_2867, %coord_7831) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_2867) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_2863, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      nvvm.cp.async.wait.group 0
      %c1_i32_2875 = arith.constant 1 : i32
      %c128_i32_2876 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_2875 number_of_threads = %c128_i32_2876
      %699 = arith.cmpi sgt, %502, %c0_i32 : i32
      scf.if %699 {
        %c1_i32_7829 = arith.constant 1 : i32
        %2493 = arith.subi %502, %c1_i32_7829 : i32
        %coord_7830 = cute.make_coord(%2493) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_7831 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
        %slice_7832 = cute.slice(%lay_7831, %coord_7830) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
        %idx_7833 = cute.crd2idx(%coord_7830, %lay_7831) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7834 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
        %ptr_7835 = cute.add_offset(%iter_7834, %idx_7833) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7836 = cute.make_view(%ptr_7835, %slice_7832) : !memref_gmem_bf16_9
        %iter_7837 = cute.get_iter(%view_7836) : !memref_gmem_bf16_9
        %iter_7838 = cute.get_iter(%view_7836) : !memref_gmem_bf16_9
        %lay_7839 = cute.get_layout(%view_7836) : !memref_gmem_bf16_9
        %2494 = cute.get_shape(%lay_7839) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7840, %e1_7841, %e2_7842, %e3_7843 = cute.get_leaves(%2494) : !cute.shape<"((8,1),4,2)">
        %lay_7844 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %2495 = cute.get_shape(%lay_7844) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7845, %e1_7846, %e2_7847, %e3_7848 = cute.get_leaves(%2495) : !cute.shape<"((8,1),4,2)">
        %lay_7849 = cute.get_layout(%view_7836) : !memref_gmem_bf16_9
        %shape_7850 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7851 = cute.make_layout() : !cute.layout<"1:0">
        %append_7852 = cute.append_to_rank<2> (%lay_7849, %lay_7851) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_7853 = cute.make_view(%iter_7838, %append_7852) : !memref_gmem_bf16_9
        %iter_7854 = cute.get_iter(%view_7853) : !memref_gmem_bf16_9
        %lay_7855 = cute.get_layout(%view_7853) : !memref_gmem_bf16_9
        %2496 = cute.get_shape(%lay_7855) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7856, %e1_7857, %e2_7858, %e3_7859 = cute.get_leaves(%2496) : !cute.shape<"((8,1),4,2)">
        %iter_7860 = cute.get_iter(%view_7853) : !memref_gmem_bf16_9
        %lay_7861 = cute.get_layout(%view_7853) : !memref_gmem_bf16_9
        %2497 = cute.get_scalars(%lay_7861) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_7863 = cute.assume(%2497) : (i64) -> !cute.i64<divby 128>
        %stride_7864 = cute.make_stride(%iv_7863) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_7865 = cute.make_layout(%shape_7862, %stride_7864) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_7866 = cute.make_view(%iter_7860, %lay_7865) : !memref_gmem_bf16_10
        %iter_7867 = cute.get_iter(%view_7866) : !memref_gmem_bf16_10
        %iter_7868 = cute.get_iter(%view_7866) : !memref_gmem_bf16_10
        %lay_7869 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
        %shape_7870 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7871 = cute.make_layout() : !cute.layout<"1:0">
        %append_7872 = cute.append_to_rank<2> (%lay_7869, %lay_7871) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_7873 = cute.make_view(%iter_296, %append_7872) : !memref_smem_bf16_4
        %iter_7874 = cute.get_iter(%view_7873) : !memref_smem_bf16_4
        %lay_7875 = cute.get_layout(%view_7873) : !memref_smem_bf16_4
        %2498 = cute.get_shape(%lay_7875) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7876, %e1_7877, %e2_7878, %e3_7879 = cute.get_leaves(%2498) : !cute.shape<"((8,1),4,2)">
        %iter_7880 = cute.get_iter(%view_7873) : !memref_smem_bf16_4
        %view_7881 = cute.make_view(%iter_7880) : !memref_smem_bf16_16
        %iter_7882 = cute.get_iter(%view_7881) : !memref_smem_bf16_16
        %iter_7883 = cute.get_iter(%view_7881) : !memref_smem_bf16_16
        %lay_7884 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
        %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
        %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_7888 = cute.make_view(%iter_542, %append_7887) : !memref_rmem_i8_1
        %iter_7889 = cute.get_iter(%view_7888) : !memref_rmem_i8_1
        %lay_7890 = cute.get_layout(%view_7888) : !memref_rmem_i8_1
        %2499 = cute.get_shape(%lay_7890) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2499) : !cute.shape<"(1,4,2)">
        %iter_7894 = cute.get_iter(%view_7888) : !memref_rmem_i8_1
        %view_7895 = cute.make_view(%iter_7894) : !memref_rmem_i8_5
        %iter_7896 = cute.get_iter(%view_7895) : !memref_rmem_i8_5
        %iter_7897 = cute.get_iter(%view_7895) : !memref_rmem_i8_5
        %lay_7898 = cute.get_layout(%view_7866) : !memref_gmem_bf16_10
        %2500 = cute.get_shape(%lay_7898) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7899, %e1_7900, %e2_7901, %e3_7902 = cute.get_leaves(%2500) : !cute.shape<"((8,1),(4,2))">
        %lay_7903 = cute.get_layout(%view_7881) : !memref_smem_bf16_16
        %2501 = cute.get_shape(%lay_7903) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7904, %e1_7905, %e2_7906, %e3_7907 = cute.get_leaves(%2501) : !cute.shape<"((8,1),(4,2))">
        %lay_7908 = cute.get_layout(%view_7866) : !memref_gmem_bf16_10
        %sz_7909 = cute.size(%lay_7908) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_7910 = cute.get_leaves(%sz_7909) : !cute.int_tuple<"8">
        %lay_7911 = cute.get_layout(%view_7881) : !memref_smem_bf16_16
        %sz_7912 = cute.size(%lay_7911) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_7913 = cute.get_leaves(%sz_7912) : !cute.int_tuple<"8">
        %2502 = cute.static : !cute.layout<"1:0">
        %iter_7914 = cute.get_iter(%view_7866) : !memref_gmem_bf16_10
        %iter_7915 = cute.get_iter(%view_7881) : !memref_smem_bf16_16
        %lay_7916 = cute.get_layout(%view_7866) : !memref_gmem_bf16_10
        %lay_7917 = cute.get_layout(%view_7881) : !memref_smem_bf16_16
        %append_7918 = cute.append_to_rank<2> (%lay_7916, %2502) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_7919 = cute.append_to_rank<2> (%lay_7917, %2502) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %2503 = cute.get_scalars(%append_7918) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_7920 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_7921 = cute.assume(%2503) : (i64) -> !cute.i64<divby 128>
        %stride_7922 = cute.make_stride(%iv_7921) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_7923 = cute.make_layout(%shape_7920, %stride_7922) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_7924 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_7925 = cute.get_iter(%view_7895) : !memref_rmem_i8_5
        %lay_7926 = cute.get_layout(%view_7895) : !memref_rmem_i8_5
        %append_7927 = cute.append_to_rank<2> (%lay_7926, %2502) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_7928 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_7929 = cute.size(%lay_7923) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %2504 = cute.get_scalars(%sz_7929) : !cute.int_tuple<"8">
        %c0_i32_7930 = arith.constant 0 : i32
        %c1_i32_7931 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7930 to %2504 step %c1_i32_7931  : i32 {
          %coord_7932 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7933 = cute.slice(%lay_7923, %coord_7932) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
          %idx_7934 = cute.crd2idx(%coord_7932, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_7935 = cute.add_offset(%iter_7914, %idx_7934) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7936 = cute.make_view(%ptr_7935, %slice_7933) : !memref_gmem_bf16_8
          %slice_7937 = cute.slice(%lay_7924, %coord_7932) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
          %idx_7938 = cute.crd2idx(%coord_7932, %lay_7924) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_7939 = cute.add_offset(%iter_7915, %idx_7938) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7940 = cute.make_view(%ptr_7939, %slice_7937) : !memref_smem_bf16_13
          %slice_7941 = cute.slice(%lay_7928, %coord_7932) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
          %idx_7942 = cute.crd2idx(%coord_7932, %lay_7928) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_7943 = cute.add_offset(%iter_7925, %idx_7942) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7944 = cute.make_view(%ptr_7943, %slice_7941) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7936, %view_7940, %view_7944) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.commit.group
      }
      %lay_2877 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %700 = cute.get_shape(%lay_2877) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2878, %e1_2879, %e2_2880, %e3_2881 = cute.get_leaves(%700) : !cute.shape<"((2,2),2,8)">
      %shape_2882 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_2883 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %701 = cute.get_shape(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2884, %e1_2885, %e2_2886, %e3_2887 = cute.get_leaves(%701) : !cute.shape<"((2,2),2,8)">
      %702 = cute.get_shape(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2888, %e1_2889, %e2_2890, %e3_2891 = cute.get_leaves(%702) : !cute.shape<"((2,2),2,8)">
      %703 = cute.get_shape(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2892, %e1_2893, %e2_2894, %e3_2895 = cute.get_leaves(%703) : !cute.shape<"((2,2),2,8)">
      %704 = cute.get_shape(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2896, %e1_2897, %e2_2898, %e3_2899 = cute.get_leaves(%704) : !cute.shape<"((2,2),2,8)">
      %705 = cute.get_stride(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2900, %e1_2901, %e2_2902, %e3_2903 = cute.get_leaves(%705) : !cute.stride<"((1,2),4,8)">
      %706 = cute.get_stride(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2904, %e1_2905, %e2_2906, %e3_2907 = cute.get_leaves(%706) : !cute.stride<"((1,2),4,8)">
      %707 = cute.get_stride(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2908, %e1_2909, %e2_2910, %e3_2911 = cute.get_leaves(%707) : !cute.stride<"((1,2),4,8)">
      %708 = cute.get_stride(%lay_2883) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2912, %e1_2913, %e2_2914, %e3_2915 = cute.get_leaves(%708) : !cute.stride<"((1,2),4,8)">
      %shape_2916 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_2917 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2918 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_2919 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %lay_2920 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %view_2921 = cute.make_view(%iter_1116, %lay_2920) : !memref_rmem_f32_4
      %iter_2922 = cute.get_iter(%view_2921) : !memref_rmem_f32_4
      %lay_2923 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %709 = cute.get_shape(%lay_2923) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2924, %e1_2925, %e2_2926, %e3_2927 = cute.get_leaves(%709) : !cute.shape<"((2,2),2,16)">
      %shape_2928 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_2929 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %710 = cute.get_shape(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2930, %e1_2931, %e2_2932, %e3_2933 = cute.get_leaves(%710) : !cute.shape<"((2,2),2,16)">
      %711 = cute.get_shape(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2934, %e1_2935, %e2_2936, %e3_2937 = cute.get_leaves(%711) : !cute.shape<"((2,2),2,16)">
      %712 = cute.get_shape(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2938, %e1_2939, %e2_2940, %e3_2941 = cute.get_leaves(%712) : !cute.shape<"((2,2),2,16)">
      %713 = cute.get_shape(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2942, %e1_2943, %e2_2944, %e3_2945 = cute.get_leaves(%713) : !cute.shape<"((2,2),2,16)">
      %714 = cute.get_stride(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2946, %e1_2947, %e2_2948, %e3_2949 = cute.get_leaves(%714) : !cute.stride<"((1,2),4,8)">
      %715 = cute.get_stride(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2950, %e1_2951, %e2_2952, %e3_2953 = cute.get_leaves(%715) : !cute.stride<"((1,2),4,8)">
      %716 = cute.get_stride(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2954, %e1_2955, %e2_2956, %e3_2957 = cute.get_leaves(%716) : !cute.stride<"((1,2),4,8)">
      %717 = cute.get_stride(%lay_2929) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2958, %e1_2959, %e2_2960, %e3_2961 = cute.get_leaves(%717) : !cute.stride<"((1,2),4,8)">
      %shape_2962 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_2963 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2964 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_2965 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_2966 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_2967 = cute.make_view(%iter_322, %lay_2966) : !memref_rmem_f32_5
      %iter_2968 = cute.get_iter(%view_2967) : !memref_rmem_f32_5
      %lay_2969 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %718 = cute.get_shape(%lay_2969) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2970, %e1_2971, %e2_2972, %e3_2973 = cute.get_leaves(%718) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2974 = cute.to_int_tuple(%e0_2970) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %719 = cute.get_scalars(%itup_2974) : !cute.int_tuple<"?">
      %itup_2975 = cute.to_int_tuple(%e1_2971) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %720 = cute.get_scalars(%itup_2975) : !cute.int_tuple<"?">
      %itup_2976 = cute.to_int_tuple(%e2_2972) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %721 = cute.get_scalars(%itup_2976) : !cute.int_tuple<"?">
      %itup_2977 = cute.to_int_tuple(%e3_2973) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %722 = cute.get_scalars(%itup_2977) : !cute.int_tuple<"?{div=8}">
      %lay_2978 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %723 = cute.get_shape(%lay_2978) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2979, %e1_2980, %e2_2981, %e3_2982 = cute.get_leaves(%723) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2983 = cute.to_int_tuple(%e0_2979) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %724 = cute.get_scalars(%itup_2983) : !cute.int_tuple<"?">
      %itup_2984 = cute.to_int_tuple(%e1_2980) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %725 = cute.get_scalars(%itup_2984) : !cute.int_tuple<"?">
      %itup_2985 = cute.to_int_tuple(%e2_2981) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %726 = cute.get_scalars(%itup_2985) : !cute.int_tuple<"?">
      %itup_2986 = cute.to_int_tuple(%e3_2982) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %727 = cute.get_scalars(%itup_2986) : !cute.int_tuple<"?{div=8}">
      %shape_2987 = cute.make_shape(%itup_2974, %itup_2975, %itup_2976, %itup_2984) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)">
      %728 = cute.make_identity_tensor(%shape_2987) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %iter_2988 = cute.get_iter(%728) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %e0_2989, %e1_2990, %e2_2991, %e3_2992 = cute.get_leaves(%iter_2988) : !cute.int_tuple<"(0,0,0,0)">
      %coord_2993 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2994 = cute.get_layout(%728) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %slice_2995 = cute.slice(%lay_2994, %coord_2993) : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_2996 = cute.crd2idx(%coord_2993, %lay_2994) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_2997 = cute.get_iter(%728) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %tup_2998 = cute.add_offset(%iter_2997, %idx_2996) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_2999 = cute.make_view(%tup_2998, %slice_2995) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %iter_3000 = cute.get_iter(%view_2999) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_3001, %e1_3002, %e2_3003, %e3_3004 = cute.get_leaves(%iter_3000) : !cute.int_tuple<"(?,0,?,0)">
      %729 = cute.get_scalars(%e0_3001) : !cute.int_tuple<"?">
      %730 = cute.get_scalars(%e2_3003) : !cute.int_tuple<"?">
      %iter_3005 = cute.get_iter(%view_2999) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_3006, %e1_3007, %e2_3008, %e3_3009 = cute.get_leaves(%iter_3005) : !cute.int_tuple<"(?,0,?,0)">
      %731 = cute.get_scalars(%e0_3006) : !cute.int_tuple<"?">
      %732 = cute.get_scalars(%e2_3008) : !cute.int_tuple<"?">
      %tile_3010 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]">
      %coord_3011 = cute.make_coord(%117, %502) : (i32, i32) -> !cute.coord<"(?,?)">
      %733:2 = cute.get_scalars(%coord_3011) <{only_dynamic}> : !cute.coord<"(?,?)">
      %coord_3012 = cute.make_coord(%733#0, %733#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
      %lay_3013 = cute.get_layout(%view_2999) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %734:2 = cute.get_scalars(%lay_3013) <{only_dynamic}> : !cute.layout<"(?,?):(1@1,1@3)">
      %c128_i32_3014 = arith.constant 128 : i32
      %735 = arith.ceildivsi %734#0, %c128_i32_3014 : i32
      %c64_i32_3015 = arith.constant 64 : i32
      %736 = arith.ceildivsi %734#1, %c64_i32_3015 : i32
      %shape_3016 = cute.make_shape(%735, %736) : (i32, i32) -> !cute.shape<"((128,64),(?,?))">
      %stride_3017 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,64@3))">
      %lay_3018 = cute.make_layout(%shape_3016, %stride_3017) : !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">
      %idx_3019 = cute.crd2idx(%coord_3012, %lay_3018) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">) -> !cute.int_tuple<"(0,?{div=128},0,?{div=64})">
      %iter_3020 = cute.get_iter(%view_2999) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %tup_3021 = cute.add_offset(%iter_3020, %idx_3019) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,?{div=64})">) -> !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %view_3022 = cute.make_view(%tup_3021) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %iter_3023 = cute.get_iter(%view_3022) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %e0_3024, %e1_3025, %e2_3026, %e3_3027 = cute.get_leaves(%iter_3023) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %737 = cute.get_scalars(%e0_3024) : !cute.int_tuple<"?">
      %738 = cute.get_scalars(%e1_3025) : !cute.int_tuple<"?{div=128}">
      %739 = cute.get_scalars(%e2_3026) : !cute.int_tuple<"?">
      %740 = cute.get_scalars(%e3_3027) : !cute.int_tuple<"?{div=64}">
      %coord_3028 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_C = cute.tiled.mma.partition C (%5, %view_3022, %coord_3028) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %iter_3029 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %e0_3030, %e1_3031, %e2_3032, %e3_3033 = cute.get_leaves(%iter_3029) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %741 = cute.get_scalars(%e0_3030) : !cute.int_tuple<"?">
      %742 = cute.get_scalars(%e1_3031) : !cute.int_tuple<"?">
      %743 = cute.get_scalars(%e2_3032) : !cute.int_tuple<"?">
      %744 = cute.get_scalars(%e3_3033) : !cute.int_tuple<"?{div=2}">
      %lay_3034 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %745 = cute.get_shape(%lay_3034) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3035, %e1_3036, %e2_3037, %e3_3038 = cute.get_leaves(%745) : !cute.shape<"((2,2),2,8)">
      %shape_3039 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_3040 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %746 = cute.get_shape(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3041, %e1_3042, %e2_3043, %e3_3044 = cute.get_leaves(%746) : !cute.shape<"((2,2),2,8)">
      %747 = cute.get_shape(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3045, %e1_3046, %e2_3047, %e3_3048 = cute.get_leaves(%747) : !cute.shape<"((2,2),2,8)">
      %748 = cute.get_shape(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3049, %e1_3050, %e2_3051, %e3_3052 = cute.get_leaves(%748) : !cute.shape<"((2,2),2,8)">
      %749 = cute.get_shape(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_3053, %e1_3054, %e2_3055, %e3_3056 = cute.get_leaves(%749) : !cute.shape<"((2,2),2,8)">
      %750 = cute.get_stride(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3057, %e1_3058, %e2_3059, %e3_3060 = cute.get_leaves(%750) : !cute.stride<"((1,2),4,8)">
      %751 = cute.get_stride(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3061, %e1_3062, %e2_3063, %e3_3064 = cute.get_leaves(%751) : !cute.stride<"((1,2),4,8)">
      %752 = cute.get_stride(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3065, %e1_3066, %e2_3067, %e3_3068 = cute.get_leaves(%752) : !cute.stride<"((1,2),4,8)">
      %753 = cute.get_stride(%lay_3040) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_3069, %e1_3070, %e2_3071, %e3_3072 = cute.get_leaves(%753) : !cute.stride<"((1,2),4,8)">
      %shape_3073 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3074 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3075 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3076 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %lay_3077 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %int_tuple_3078 = cute.make_int_tuple(%e0_3030, %e1_3031, %e2_3032, %e3_3033) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3079 = cute.make_view(%int_tuple_3078, %lay_3077) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %iter_3080 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %e0_3081, %e1_3082, %e2_3083, %e3_3084 = cute.get_leaves(%iter_3080) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %754 = cute.get_scalars(%e0_3081) : !cute.int_tuple<"?">
      %755 = cute.get_scalars(%e1_3082) : !cute.int_tuple<"?">
      %756 = cute.get_scalars(%e2_3083) : !cute.int_tuple<"?">
      %757 = cute.get_scalars(%e3_3084) : !cute.int_tuple<"?{div=2}">
      %lay_3085 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
      %sz_3086 = cute.size(%lay_3085) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_3087 = cute.get_leaves(%sz_3086) : !cute.int_tuple<"4">
      %lay_3088 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %758 = cute.get_shape(%lay_3088) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3089, %e1_3090, %e2_3091, %e3_3092 = cute.get_leaves(%758) : !cute.shape<"((2,2),(2,8))">
      %int_tuple_3093 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3094 = cute.size(%int_tuple_3093) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3095 = cute.get_leaves(%sz_3094) : !cute.int_tuple<"16">
      %coord_3096 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3097 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3098 = cute.crd2idx(%coord_3096, %lay_3097) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3099 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3100 = cute.add_offset(%iter_3099, %idx_3098) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3101 = cute.make_view(%tup_3100) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3102 = cute.get_iter(%view_3101) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3103, %e1_3104, %e2_3105, %e3_3106 = cute.get_leaves(%iter_3102) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %759 = cute.get_scalars(%e0_3103) : !cute.int_tuple<"?">
      %760 = cute.get_scalars(%e1_3104) : !cute.int_tuple<"?">
      %761 = cute.get_scalars(%e2_3105) : !cute.int_tuple<"?">
      %762 = cute.get_scalars(%e3_3106) : !cute.int_tuple<"?{div=2}">
      %iter_3107 = cute.get_iter(%view_3101) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3108, %e1_3109, %e2_3110, %e3_3111 = cute.get_leaves(%iter_3107) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %763 = cute.get_scalars(%e0_3108) : !cute.int_tuple<"?">
      %764 = cute.get_scalars(%e1_3109) : !cute.int_tuple<"?">
      %765 = cute.get_scalars(%e2_3110) : !cute.int_tuple<"?">
      %766 = cute.get_scalars(%e3_3111) : !cute.int_tuple<"?{div=2}">
      %iter_3112 = cute.get_iter(%view_3101) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3113, %e1_3114, %e2_3115, %e3_3116 = cute.get_leaves(%iter_3112) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %767 = cute.get_scalars(%e0_3113) : !cute.int_tuple<"?">
      %768 = cute.get_scalars(%e1_3114) : !cute.int_tuple<"?">
      %769 = cute.get_scalars(%e2_3115) : !cute.int_tuple<"?">
      %770 = cute.get_scalars(%e3_3116) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3117 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3118 = cute.add_offset(%e3_3116, %int_tuple_3117) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %771 = cute.get_scalars(%tup_3118) : !cute.int_tuple<"?">
      %coord_3119 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3120 = cute.make_coord(%tup_3118) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %772 = cute.elem_less(%coord_3119, %coord_3120) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3121 = cute.get_layout(%view_2921) : !memref_rmem_f32_4
      %773 = cute.get_shape(%lay_3121) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3122, %e1_3123, %e2_3124, %e3_3125 = cute.get_leaves(%773) : !cute.shape<"((2,2),(2,8))">
      %774 = cute.get_stride(%lay_3121) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3126, %e1_3127, %e2_3128, %e3_3129 = cute.get_leaves(%774) : !cute.stride<"((2,4),(1,8))">
      %775 = scf.if %772 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%view_2921) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,0)">
        cute.memref.store(%view_2921, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,0)">, f32) -> ()
        %lay_7832 = cute.get_layout(%view_2921) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2921 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%view_2921) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%view_2921) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2921 : !memref_rmem_f32_4
      }
      %iter_3130 = cute.get_iter(%775) : !memref_rmem_f32_4
      %lay_3131 = cute.get_layout(%775) : !memref_rmem_f32_4
      %776 = cute.get_shape(%lay_3131) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3132, %e1_3133, %e2_3134, %e3_3135 = cute.get_leaves(%776) : !cute.shape<"((2,2),(2,8))">
      %777 = cute.get_stride(%lay_3131) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3136, %e1_3137, %e2_3138, %e3_3139 = cute.get_leaves(%777) : !cute.stride<"((2,4),(1,8))">
      %iter_3140 = cute.get_iter(%775) : !memref_rmem_f32_4
      %iter_3141 = cute.get_iter(%775) : !memref_rmem_f32_4
      %coord_3142 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3143 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3144 = cute.crd2idx(%coord_3142, %lay_3143) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3145 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3146 = cute.add_offset(%iter_3145, %idx_3144) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3147 = cute.make_view(%tup_3146) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3148 = cute.get_iter(%view_3147) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3149, %e1_3150, %e2_3151, %e3_3152 = cute.get_leaves(%iter_3148) : !cute.int_tuple<"(?,?,?,?)">
      %778 = cute.get_scalars(%e0_3149) : !cute.int_tuple<"?">
      %779 = cute.get_scalars(%e1_3150) : !cute.int_tuple<"?">
      %780 = cute.get_scalars(%e2_3151) : !cute.int_tuple<"?">
      %781 = cute.get_scalars(%e3_3152) : !cute.int_tuple<"?">
      %iter_3153 = cute.get_iter(%view_3147) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3154, %e1_3155, %e2_3156, %e3_3157 = cute.get_leaves(%iter_3153) : !cute.int_tuple<"(?,?,?,?)">
      %782 = cute.get_scalars(%e0_3154) : !cute.int_tuple<"?">
      %783 = cute.get_scalars(%e1_3155) : !cute.int_tuple<"?">
      %784 = cute.get_scalars(%e2_3156) : !cute.int_tuple<"?">
      %785 = cute.get_scalars(%e3_3157) : !cute.int_tuple<"?">
      %iter_3158 = cute.get_iter(%view_3147) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3159, %e1_3160, %e2_3161, %e3_3162 = cute.get_leaves(%iter_3158) : !cute.int_tuple<"(?,?,?,?)">
      %786 = cute.get_scalars(%e0_3159) : !cute.int_tuple<"?">
      %787 = cute.get_scalars(%e1_3160) : !cute.int_tuple<"?">
      %788 = cute.get_scalars(%e2_3161) : !cute.int_tuple<"?">
      %789 = cute.get_scalars(%e3_3162) : !cute.int_tuple<"?">
      %int_tuple_3163 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3164 = cute.add_offset(%e3_3162, %int_tuple_3163) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %790 = cute.get_scalars(%tup_3164) : !cute.int_tuple<"?">
      %coord_3165 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3166 = cute.make_coord(%tup_3164) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %791 = cute.elem_less(%coord_3165, %coord_3166) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3167 = cute.get_layout(%775) : !memref_rmem_f32_4
      %792 = cute.get_shape(%lay_3167) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3168, %e1_3169, %e2_3170, %e3_3171 = cute.get_leaves(%792) : !cute.shape<"((2,2),(2,8))">
      %793 = cute.get_stride(%lay_3167) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3172, %e1_3173, %e2_3174, %e3_3175 = cute.get_leaves(%793) : !cute.stride<"((2,4),(1,8))">
      %794 = scf.if %791 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%775) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,1)">
        cute.memref.store(%775, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,1)">, f32) -> ()
        %lay_7832 = cute.get_layout(%775) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %775 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%775) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%775) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %775 : !memref_rmem_f32_4
      }
      %iter_3176 = cute.get_iter(%794) : !memref_rmem_f32_4
      %lay_3177 = cute.get_layout(%794) : !memref_rmem_f32_4
      %795 = cute.get_shape(%lay_3177) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3178, %e1_3179, %e2_3180, %e3_3181 = cute.get_leaves(%795) : !cute.shape<"((2,2),(2,8))">
      %796 = cute.get_stride(%lay_3177) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3182, %e1_3183, %e2_3184, %e3_3185 = cute.get_leaves(%796) : !cute.stride<"((2,4),(1,8))">
      %iter_3186 = cute.get_iter(%794) : !memref_rmem_f32_4
      %iter_3187 = cute.get_iter(%794) : !memref_rmem_f32_4
      %coord_3188 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3189 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3190 = cute.crd2idx(%coord_3188, %lay_3189) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3191 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3192 = cute.add_offset(%iter_3191, %idx_3190) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3193 = cute.make_view(%tup_3192) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3194 = cute.get_iter(%view_3193) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3195, %e1_3196, %e2_3197, %e3_3198 = cute.get_leaves(%iter_3194) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %797 = cute.get_scalars(%e0_3195) : !cute.int_tuple<"?">
      %798 = cute.get_scalars(%e1_3196) : !cute.int_tuple<"?">
      %799 = cute.get_scalars(%e2_3197) : !cute.int_tuple<"?">
      %800 = cute.get_scalars(%e3_3198) : !cute.int_tuple<"?{div=2}">
      %iter_3199 = cute.get_iter(%view_3193) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3200, %e1_3201, %e2_3202, %e3_3203 = cute.get_leaves(%iter_3199) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %801 = cute.get_scalars(%e0_3200) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e1_3201) : !cute.int_tuple<"?">
      %803 = cute.get_scalars(%e2_3202) : !cute.int_tuple<"?">
      %804 = cute.get_scalars(%e3_3203) : !cute.int_tuple<"?{div=2}">
      %iter_3204 = cute.get_iter(%view_3193) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3205, %e1_3206, %e2_3207, %e3_3208 = cute.get_leaves(%iter_3204) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %805 = cute.get_scalars(%e0_3205) : !cute.int_tuple<"?">
      %806 = cute.get_scalars(%e1_3206) : !cute.int_tuple<"?">
      %807 = cute.get_scalars(%e2_3207) : !cute.int_tuple<"?">
      %808 = cute.get_scalars(%e3_3208) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3209 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3210 = cute.add_offset(%e3_3208, %int_tuple_3209) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %809 = cute.get_scalars(%tup_3210) : !cute.int_tuple<"?">
      %coord_3211 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3212 = cute.make_coord(%tup_3210) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %810 = cute.elem_less(%coord_3211, %coord_3212) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3213 = cute.get_layout(%794) : !memref_rmem_f32_4
      %811 = cute.get_shape(%lay_3213) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3214, %e1_3215, %e2_3216, %e3_3217 = cute.get_leaves(%811) : !cute.shape<"((2,2),(2,8))">
      %812 = cute.get_stride(%lay_3213) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3218, %e1_3219, %e2_3220, %e3_3221 = cute.get_leaves(%812) : !cute.stride<"((2,4),(1,8))">
      %813 = scf.if %810 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%794) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,2)">
        cute.memref.store(%794, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,2)">, f32) -> ()
        %lay_7832 = cute.get_layout(%794) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %794 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%794) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%794) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %794 : !memref_rmem_f32_4
      }
      %iter_3222 = cute.get_iter(%813) : !memref_rmem_f32_4
      %lay_3223 = cute.get_layout(%813) : !memref_rmem_f32_4
      %814 = cute.get_shape(%lay_3223) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3224, %e1_3225, %e2_3226, %e3_3227 = cute.get_leaves(%814) : !cute.shape<"((2,2),(2,8))">
      %815 = cute.get_stride(%lay_3223) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3228, %e1_3229, %e2_3230, %e3_3231 = cute.get_leaves(%815) : !cute.stride<"((2,4),(1,8))">
      %iter_3232 = cute.get_iter(%813) : !memref_rmem_f32_4
      %iter_3233 = cute.get_iter(%813) : !memref_rmem_f32_4
      %coord_3234 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_3235 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3236 = cute.crd2idx(%coord_3234, %lay_3235) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_3237 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3238 = cute.add_offset(%iter_3237, %idx_3236) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3239 = cute.make_view(%tup_3238) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3240 = cute.get_iter(%view_3239) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3241, %e1_3242, %e2_3243, %e3_3244 = cute.get_leaves(%iter_3240) : !cute.int_tuple<"(?,?,?,?)">
      %816 = cute.get_scalars(%e0_3241) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e1_3242) : !cute.int_tuple<"?">
      %818 = cute.get_scalars(%e2_3243) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e3_3244) : !cute.int_tuple<"?">
      %iter_3245 = cute.get_iter(%view_3239) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3246, %e1_3247, %e2_3248, %e3_3249 = cute.get_leaves(%iter_3245) : !cute.int_tuple<"(?,?,?,?)">
      %820 = cute.get_scalars(%e0_3246) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e1_3247) : !cute.int_tuple<"?">
      %822 = cute.get_scalars(%e2_3248) : !cute.int_tuple<"?">
      %823 = cute.get_scalars(%e3_3249) : !cute.int_tuple<"?">
      %iter_3250 = cute.get_iter(%view_3239) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3251, %e1_3252, %e2_3253, %e3_3254 = cute.get_leaves(%iter_3250) : !cute.int_tuple<"(?,?,?,?)">
      %824 = cute.get_scalars(%e0_3251) : !cute.int_tuple<"?">
      %825 = cute.get_scalars(%e1_3252) : !cute.int_tuple<"?">
      %826 = cute.get_scalars(%e2_3253) : !cute.int_tuple<"?">
      %827 = cute.get_scalars(%e3_3254) : !cute.int_tuple<"?">
      %int_tuple_3255 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3256 = cute.add_offset(%e3_3254, %int_tuple_3255) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %828 = cute.get_scalars(%tup_3256) : !cute.int_tuple<"?">
      %coord_3257 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3258 = cute.make_coord(%tup_3256) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %829 = cute.elem_less(%coord_3257, %coord_3258) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3259 = cute.get_layout(%813) : !memref_rmem_f32_4
      %830 = cute.get_shape(%lay_3259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3260, %e1_3261, %e2_3262, %e3_3263 = cute.get_leaves(%830) : !cute.shape<"((2,2),(2,8))">
      %831 = cute.get_stride(%lay_3259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3264, %e1_3265, %e2_3266, %e3_3267 = cute.get_leaves(%831) : !cute.stride<"((2,4),(1,8))">
      %832 = scf.if %829 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%813) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,3)">
        cute.memref.store(%813, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,3)">, f32) -> ()
        %lay_7832 = cute.get_layout(%813) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %813 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%813) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%813) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %813 : !memref_rmem_f32_4
      }
      %iter_3268 = cute.get_iter(%832) : !memref_rmem_f32_4
      %lay_3269 = cute.get_layout(%832) : !memref_rmem_f32_4
      %833 = cute.get_shape(%lay_3269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3270, %e1_3271, %e2_3272, %e3_3273 = cute.get_leaves(%833) : !cute.shape<"((2,2),(2,8))">
      %834 = cute.get_stride(%lay_3269) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3274, %e1_3275, %e2_3276, %e3_3277 = cute.get_leaves(%834) : !cute.stride<"((2,4),(1,8))">
      %iter_3278 = cute.get_iter(%832) : !memref_rmem_f32_4
      %iter_3279 = cute.get_iter(%832) : !memref_rmem_f32_4
      %coord_3280 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_3281 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3282 = cute.crd2idx(%coord_3280, %lay_3281) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_3283 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3284 = cute.add_offset(%iter_3283, %idx_3282) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3285 = cute.make_view(%tup_3284) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3286 = cute.get_iter(%view_3285) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3287, %e1_3288, %e2_3289, %e3_3290 = cute.get_leaves(%iter_3286) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %835 = cute.get_scalars(%e0_3287) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e1_3288) : !cute.int_tuple<"?">
      %837 = cute.get_scalars(%e2_3289) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e3_3290) : !cute.int_tuple<"?{div=2}">
      %iter_3291 = cute.get_iter(%view_3285) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3292, %e1_3293, %e2_3294, %e3_3295 = cute.get_leaves(%iter_3291) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %839 = cute.get_scalars(%e0_3292) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e1_3293) : !cute.int_tuple<"?">
      %841 = cute.get_scalars(%e2_3294) : !cute.int_tuple<"?">
      %842 = cute.get_scalars(%e3_3295) : !cute.int_tuple<"?{div=2}">
      %iter_3296 = cute.get_iter(%view_3285) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3297, %e1_3298, %e2_3299, %e3_3300 = cute.get_leaves(%iter_3296) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %843 = cute.get_scalars(%e0_3297) : !cute.int_tuple<"?">
      %844 = cute.get_scalars(%e1_3298) : !cute.int_tuple<"?">
      %845 = cute.get_scalars(%e2_3299) : !cute.int_tuple<"?">
      %846 = cute.get_scalars(%e3_3300) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3301 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3302 = cute.add_offset(%e3_3300, %int_tuple_3301) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %847 = cute.get_scalars(%tup_3302) : !cute.int_tuple<"?">
      %coord_3303 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3304 = cute.make_coord(%tup_3302) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %848 = cute.elem_less(%coord_3303, %coord_3304) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3305 = cute.get_layout(%832) : !memref_rmem_f32_4
      %849 = cute.get_shape(%lay_3305) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3306, %e1_3307, %e2_3308, %e3_3309 = cute.get_leaves(%849) : !cute.shape<"((2,2),(2,8))">
      %850 = cute.get_stride(%lay_3305) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3310, %e1_3311, %e2_3312, %e3_3313 = cute.get_leaves(%850) : !cute.stride<"((2,4),(1,8))">
      %851 = scf.if %848 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%832) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,4)">
        cute.memref.store(%832, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,4)">, f32) -> ()
        %lay_7832 = cute.get_layout(%832) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %832 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%832) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%832) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %832 : !memref_rmem_f32_4
      }
      %iter_3314 = cute.get_iter(%851) : !memref_rmem_f32_4
      %lay_3315 = cute.get_layout(%851) : !memref_rmem_f32_4
      %852 = cute.get_shape(%lay_3315) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3316, %e1_3317, %e2_3318, %e3_3319 = cute.get_leaves(%852) : !cute.shape<"((2,2),(2,8))">
      %853 = cute.get_stride(%lay_3315) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3320, %e1_3321, %e2_3322, %e3_3323 = cute.get_leaves(%853) : !cute.stride<"((2,4),(1,8))">
      %iter_3324 = cute.get_iter(%851) : !memref_rmem_f32_4
      %iter_3325 = cute.get_iter(%851) : !memref_rmem_f32_4
      %coord_3326 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_3327 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3328 = cute.crd2idx(%coord_3326, %lay_3327) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_3329 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3330 = cute.add_offset(%iter_3329, %idx_3328) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3331 = cute.make_view(%tup_3330) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3332 = cute.get_iter(%view_3331) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3333, %e1_3334, %e2_3335, %e3_3336 = cute.get_leaves(%iter_3332) : !cute.int_tuple<"(?,?,?,?)">
      %854 = cute.get_scalars(%e0_3333) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e1_3334) : !cute.int_tuple<"?">
      %856 = cute.get_scalars(%e2_3335) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e3_3336) : !cute.int_tuple<"?">
      %iter_3337 = cute.get_iter(%view_3331) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3338, %e1_3339, %e2_3340, %e3_3341 = cute.get_leaves(%iter_3337) : !cute.int_tuple<"(?,?,?,?)">
      %858 = cute.get_scalars(%e0_3338) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e1_3339) : !cute.int_tuple<"?">
      %860 = cute.get_scalars(%e2_3340) : !cute.int_tuple<"?">
      %861 = cute.get_scalars(%e3_3341) : !cute.int_tuple<"?">
      %iter_3342 = cute.get_iter(%view_3331) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3343, %e1_3344, %e2_3345, %e3_3346 = cute.get_leaves(%iter_3342) : !cute.int_tuple<"(?,?,?,?)">
      %862 = cute.get_scalars(%e0_3343) : !cute.int_tuple<"?">
      %863 = cute.get_scalars(%e1_3344) : !cute.int_tuple<"?">
      %864 = cute.get_scalars(%e2_3345) : !cute.int_tuple<"?">
      %865 = cute.get_scalars(%e3_3346) : !cute.int_tuple<"?">
      %int_tuple_3347 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3348 = cute.add_offset(%e3_3346, %int_tuple_3347) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %866 = cute.get_scalars(%tup_3348) : !cute.int_tuple<"?">
      %coord_3349 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3350 = cute.make_coord(%tup_3348) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %867 = cute.elem_less(%coord_3349, %coord_3350) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3351 = cute.get_layout(%851) : !memref_rmem_f32_4
      %868 = cute.get_shape(%lay_3351) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3352, %e1_3353, %e2_3354, %e3_3355 = cute.get_leaves(%868) : !cute.shape<"((2,2),(2,8))">
      %869 = cute.get_stride(%lay_3351) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3356, %e1_3357, %e2_3358, %e3_3359 = cute.get_leaves(%869) : !cute.stride<"((2,4),(1,8))">
      %870 = scf.if %867 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%851) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,5)">
        cute.memref.store(%851, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,5)">, f32) -> ()
        %lay_7832 = cute.get_layout(%851) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %851 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%851) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%851) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %851 : !memref_rmem_f32_4
      }
      %iter_3360 = cute.get_iter(%870) : !memref_rmem_f32_4
      %lay_3361 = cute.get_layout(%870) : !memref_rmem_f32_4
      %871 = cute.get_shape(%lay_3361) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3362, %e1_3363, %e2_3364, %e3_3365 = cute.get_leaves(%871) : !cute.shape<"((2,2),(2,8))">
      %872 = cute.get_stride(%lay_3361) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3366, %e1_3367, %e2_3368, %e3_3369 = cute.get_leaves(%872) : !cute.stride<"((2,4),(1,8))">
      %iter_3370 = cute.get_iter(%870) : !memref_rmem_f32_4
      %iter_3371 = cute.get_iter(%870) : !memref_rmem_f32_4
      %coord_3372 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_3373 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3374 = cute.crd2idx(%coord_3372, %lay_3373) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_3375 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3376 = cute.add_offset(%iter_3375, %idx_3374) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3377 = cute.make_view(%tup_3376) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3378 = cute.get_iter(%view_3377) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3379, %e1_3380, %e2_3381, %e3_3382 = cute.get_leaves(%iter_3378) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %873 = cute.get_scalars(%e0_3379) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e1_3380) : !cute.int_tuple<"?">
      %875 = cute.get_scalars(%e2_3381) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e3_3382) : !cute.int_tuple<"?{div=2}">
      %iter_3383 = cute.get_iter(%view_3377) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3384, %e1_3385, %e2_3386, %e3_3387 = cute.get_leaves(%iter_3383) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %877 = cute.get_scalars(%e0_3384) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e1_3385) : !cute.int_tuple<"?">
      %879 = cute.get_scalars(%e2_3386) : !cute.int_tuple<"?">
      %880 = cute.get_scalars(%e3_3387) : !cute.int_tuple<"?{div=2}">
      %iter_3388 = cute.get_iter(%view_3377) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3389, %e1_3390, %e2_3391, %e3_3392 = cute.get_leaves(%iter_3388) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %881 = cute.get_scalars(%e0_3389) : !cute.int_tuple<"?">
      %882 = cute.get_scalars(%e1_3390) : !cute.int_tuple<"?">
      %883 = cute.get_scalars(%e2_3391) : !cute.int_tuple<"?">
      %884 = cute.get_scalars(%e3_3392) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3393 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3394 = cute.add_offset(%e3_3392, %int_tuple_3393) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %885 = cute.get_scalars(%tup_3394) : !cute.int_tuple<"?">
      %coord_3395 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3396 = cute.make_coord(%tup_3394) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %886 = cute.elem_less(%coord_3395, %coord_3396) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3397 = cute.get_layout(%870) : !memref_rmem_f32_4
      %887 = cute.get_shape(%lay_3397) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3398, %e1_3399, %e2_3400, %e3_3401 = cute.get_leaves(%887) : !cute.shape<"((2,2),(2,8))">
      %888 = cute.get_stride(%lay_3397) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3402, %e1_3403, %e2_3404, %e3_3405 = cute.get_leaves(%888) : !cute.stride<"((2,4),(1,8))">
      %889 = scf.if %886 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%870) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,6)">
        cute.memref.store(%870, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,6)">, f32) -> ()
        %lay_7832 = cute.get_layout(%870) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %870 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%870) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%870) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %870 : !memref_rmem_f32_4
      }
      %iter_3406 = cute.get_iter(%889) : !memref_rmem_f32_4
      %lay_3407 = cute.get_layout(%889) : !memref_rmem_f32_4
      %890 = cute.get_shape(%lay_3407) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3408, %e1_3409, %e2_3410, %e3_3411 = cute.get_leaves(%890) : !cute.shape<"((2,2),(2,8))">
      %891 = cute.get_stride(%lay_3407) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3412, %e1_3413, %e2_3414, %e3_3415 = cute.get_leaves(%891) : !cute.stride<"((2,4),(1,8))">
      %iter_3416 = cute.get_iter(%889) : !memref_rmem_f32_4
      %iter_3417 = cute.get_iter(%889) : !memref_rmem_f32_4
      %coord_3418 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_3419 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3420 = cute.crd2idx(%coord_3418, %lay_3419) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_3421 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3422 = cute.add_offset(%iter_3421, %idx_3420) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3423 = cute.make_view(%tup_3422) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3424 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3425, %e1_3426, %e2_3427, %e3_3428 = cute.get_leaves(%iter_3424) : !cute.int_tuple<"(?,?,?,?)">
      %892 = cute.get_scalars(%e0_3425) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e1_3426) : !cute.int_tuple<"?">
      %894 = cute.get_scalars(%e2_3427) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e3_3428) : !cute.int_tuple<"?">
      %iter_3429 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3430, %e1_3431, %e2_3432, %e3_3433 = cute.get_leaves(%iter_3429) : !cute.int_tuple<"(?,?,?,?)">
      %896 = cute.get_scalars(%e0_3430) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e1_3431) : !cute.int_tuple<"?">
      %898 = cute.get_scalars(%e2_3432) : !cute.int_tuple<"?">
      %899 = cute.get_scalars(%e3_3433) : !cute.int_tuple<"?">
      %iter_3434 = cute.get_iter(%view_3423) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3435, %e1_3436, %e2_3437, %e3_3438 = cute.get_leaves(%iter_3434) : !cute.int_tuple<"(?,?,?,?)">
      %900 = cute.get_scalars(%e0_3435) : !cute.int_tuple<"?">
      %901 = cute.get_scalars(%e1_3436) : !cute.int_tuple<"?">
      %902 = cute.get_scalars(%e2_3437) : !cute.int_tuple<"?">
      %903 = cute.get_scalars(%e3_3438) : !cute.int_tuple<"?">
      %int_tuple_3439 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3440 = cute.add_offset(%e3_3438, %int_tuple_3439) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %904 = cute.get_scalars(%tup_3440) : !cute.int_tuple<"?">
      %coord_3441 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3442 = cute.make_coord(%tup_3440) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %905 = cute.elem_less(%coord_3441, %coord_3442) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3443 = cute.get_layout(%889) : !memref_rmem_f32_4
      %906 = cute.get_shape(%lay_3443) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3444, %e1_3445, %e2_3446, %e3_3447 = cute.get_leaves(%906) : !cute.shape<"((2,2),(2,8))">
      %907 = cute.get_stride(%lay_3443) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3448, %e1_3449, %e2_3450, %e3_3451 = cute.get_leaves(%907) : !cute.stride<"((2,4),(1,8))">
      %908 = scf.if %905 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%889) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,7)">
        cute.memref.store(%889, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,7)">, f32) -> ()
        %lay_7832 = cute.get_layout(%889) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %889 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%889) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%889) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %889 : !memref_rmem_f32_4
      }
      %iter_3452 = cute.get_iter(%908) : !memref_rmem_f32_4
      %lay_3453 = cute.get_layout(%908) : !memref_rmem_f32_4
      %909 = cute.get_shape(%lay_3453) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3454, %e1_3455, %e2_3456, %e3_3457 = cute.get_leaves(%909) : !cute.shape<"((2,2),(2,8))">
      %910 = cute.get_stride(%lay_3453) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3458, %e1_3459, %e2_3460, %e3_3461 = cute.get_leaves(%910) : !cute.stride<"((2,4),(1,8))">
      %iter_3462 = cute.get_iter(%908) : !memref_rmem_f32_4
      %iter_3463 = cute.get_iter(%908) : !memref_rmem_f32_4
      %coord_3464 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_3465 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3466 = cute.crd2idx(%coord_3464, %lay_3465) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_3467 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3468 = cute.add_offset(%iter_3467, %idx_3466) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3469 = cute.make_view(%tup_3468) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3470 = cute.get_iter(%view_3469) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3471, %e1_3472, %e2_3473, %e3_3474 = cute.get_leaves(%iter_3470) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %911 = cute.get_scalars(%e0_3471) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e1_3472) : !cute.int_tuple<"?">
      %913 = cute.get_scalars(%e2_3473) : !cute.int_tuple<"?">
      %914 = cute.get_scalars(%e3_3474) : !cute.int_tuple<"?{div=2}">
      %iter_3475 = cute.get_iter(%view_3469) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3476, %e1_3477, %e2_3478, %e3_3479 = cute.get_leaves(%iter_3475) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %915 = cute.get_scalars(%e0_3476) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e1_3477) : !cute.int_tuple<"?">
      %917 = cute.get_scalars(%e2_3478) : !cute.int_tuple<"?">
      %918 = cute.get_scalars(%e3_3479) : !cute.int_tuple<"?{div=2}">
      %iter_3480 = cute.get_iter(%view_3469) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3481, %e1_3482, %e2_3483, %e3_3484 = cute.get_leaves(%iter_3480) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %919 = cute.get_scalars(%e0_3481) : !cute.int_tuple<"?">
      %920 = cute.get_scalars(%e1_3482) : !cute.int_tuple<"?">
      %921 = cute.get_scalars(%e2_3483) : !cute.int_tuple<"?">
      %922 = cute.get_scalars(%e3_3484) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3485 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3486 = cute.add_offset(%e3_3484, %int_tuple_3485) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %923 = cute.get_scalars(%tup_3486) : !cute.int_tuple<"?">
      %coord_3487 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3488 = cute.make_coord(%tup_3486) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %924 = cute.elem_less(%coord_3487, %coord_3488) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3489 = cute.get_layout(%908) : !memref_rmem_f32_4
      %925 = cute.get_shape(%lay_3489) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3490, %e1_3491, %e2_3492, %e3_3493 = cute.get_leaves(%925) : !cute.shape<"((2,2),(2,8))">
      %926 = cute.get_stride(%lay_3489) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3494, %e1_3495, %e2_3496, %e3_3497 = cute.get_leaves(%926) : !cute.stride<"((2,4),(1,8))">
      %927 = scf.if %924 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%908) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,8)">
        cute.memref.store(%908, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,8)">, f32) -> ()
        %lay_7832 = cute.get_layout(%908) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %908 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%908) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%908) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %908 : !memref_rmem_f32_4
      }
      %iter_3498 = cute.get_iter(%927) : !memref_rmem_f32_4
      %lay_3499 = cute.get_layout(%927) : !memref_rmem_f32_4
      %928 = cute.get_shape(%lay_3499) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3500, %e1_3501, %e2_3502, %e3_3503 = cute.get_leaves(%928) : !cute.shape<"((2,2),(2,8))">
      %929 = cute.get_stride(%lay_3499) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3504, %e1_3505, %e2_3506, %e3_3507 = cute.get_leaves(%929) : !cute.stride<"((2,4),(1,8))">
      %iter_3508 = cute.get_iter(%927) : !memref_rmem_f32_4
      %iter_3509 = cute.get_iter(%927) : !memref_rmem_f32_4
      %coord_3510 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_3511 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3512 = cute.crd2idx(%coord_3510, %lay_3511) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_3513 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3514 = cute.add_offset(%iter_3513, %idx_3512) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3515 = cute.make_view(%tup_3514) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3516 = cute.get_iter(%view_3515) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3517, %e1_3518, %e2_3519, %e3_3520 = cute.get_leaves(%iter_3516) : !cute.int_tuple<"(?,?,?,?)">
      %930 = cute.get_scalars(%e0_3517) : !cute.int_tuple<"?">
      %931 = cute.get_scalars(%e1_3518) : !cute.int_tuple<"?">
      %932 = cute.get_scalars(%e2_3519) : !cute.int_tuple<"?">
      %933 = cute.get_scalars(%e3_3520) : !cute.int_tuple<"?">
      %iter_3521 = cute.get_iter(%view_3515) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3522, %e1_3523, %e2_3524, %e3_3525 = cute.get_leaves(%iter_3521) : !cute.int_tuple<"(?,?,?,?)">
      %934 = cute.get_scalars(%e0_3522) : !cute.int_tuple<"?">
      %935 = cute.get_scalars(%e1_3523) : !cute.int_tuple<"?">
      %936 = cute.get_scalars(%e2_3524) : !cute.int_tuple<"?">
      %937 = cute.get_scalars(%e3_3525) : !cute.int_tuple<"?">
      %iter_3526 = cute.get_iter(%view_3515) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3527, %e1_3528, %e2_3529, %e3_3530 = cute.get_leaves(%iter_3526) : !cute.int_tuple<"(?,?,?,?)">
      %938 = cute.get_scalars(%e0_3527) : !cute.int_tuple<"?">
      %939 = cute.get_scalars(%e1_3528) : !cute.int_tuple<"?">
      %940 = cute.get_scalars(%e2_3529) : !cute.int_tuple<"?">
      %941 = cute.get_scalars(%e3_3530) : !cute.int_tuple<"?">
      %int_tuple_3531 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3532 = cute.add_offset(%e3_3530, %int_tuple_3531) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %942 = cute.get_scalars(%tup_3532) : !cute.int_tuple<"?">
      %coord_3533 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3534 = cute.make_coord(%tup_3532) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %943 = cute.elem_less(%coord_3533, %coord_3534) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3535 = cute.get_layout(%927) : !memref_rmem_f32_4
      %944 = cute.get_shape(%lay_3535) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3536, %e1_3537, %e2_3538, %e3_3539 = cute.get_leaves(%944) : !cute.shape<"((2,2),(2,8))">
      %945 = cute.get_stride(%lay_3535) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3540, %e1_3541, %e2_3542, %e3_3543 = cute.get_leaves(%945) : !cute.stride<"((2,4),(1,8))">
      %946 = scf.if %943 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%927) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,9)">
        cute.memref.store(%927, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,9)">, f32) -> ()
        %lay_7832 = cute.get_layout(%927) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %927 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%927) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%927) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %927 : !memref_rmem_f32_4
      }
      %iter_3544 = cute.get_iter(%946) : !memref_rmem_f32_4
      %lay_3545 = cute.get_layout(%946) : !memref_rmem_f32_4
      %947 = cute.get_shape(%lay_3545) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3546, %e1_3547, %e2_3548, %e3_3549 = cute.get_leaves(%947) : !cute.shape<"((2,2),(2,8))">
      %948 = cute.get_stride(%lay_3545) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3550, %e1_3551, %e2_3552, %e3_3553 = cute.get_leaves(%948) : !cute.stride<"((2,4),(1,8))">
      %iter_3554 = cute.get_iter(%946) : !memref_rmem_f32_4
      %iter_3555 = cute.get_iter(%946) : !memref_rmem_f32_4
      %coord_3556 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_3557 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3558 = cute.crd2idx(%coord_3556, %lay_3557) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_3559 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3560 = cute.add_offset(%iter_3559, %idx_3558) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3561 = cute.make_view(%tup_3560) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3562 = cute.get_iter(%view_3561) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3563, %e1_3564, %e2_3565, %e3_3566 = cute.get_leaves(%iter_3562) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %949 = cute.get_scalars(%e0_3563) : !cute.int_tuple<"?">
      %950 = cute.get_scalars(%e1_3564) : !cute.int_tuple<"?">
      %951 = cute.get_scalars(%e2_3565) : !cute.int_tuple<"?">
      %952 = cute.get_scalars(%e3_3566) : !cute.int_tuple<"?{div=2}">
      %iter_3567 = cute.get_iter(%view_3561) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3568, %e1_3569, %e2_3570, %e3_3571 = cute.get_leaves(%iter_3567) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %953 = cute.get_scalars(%e0_3568) : !cute.int_tuple<"?">
      %954 = cute.get_scalars(%e1_3569) : !cute.int_tuple<"?">
      %955 = cute.get_scalars(%e2_3570) : !cute.int_tuple<"?">
      %956 = cute.get_scalars(%e3_3571) : !cute.int_tuple<"?{div=2}">
      %iter_3572 = cute.get_iter(%view_3561) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3573, %e1_3574, %e2_3575, %e3_3576 = cute.get_leaves(%iter_3572) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %957 = cute.get_scalars(%e0_3573) : !cute.int_tuple<"?">
      %958 = cute.get_scalars(%e1_3574) : !cute.int_tuple<"?">
      %959 = cute.get_scalars(%e2_3575) : !cute.int_tuple<"?">
      %960 = cute.get_scalars(%e3_3576) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3577 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3578 = cute.add_offset(%e3_3576, %int_tuple_3577) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %961 = cute.get_scalars(%tup_3578) : !cute.int_tuple<"?">
      %coord_3579 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3580 = cute.make_coord(%tup_3578) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %962 = cute.elem_less(%coord_3579, %coord_3580) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3581 = cute.get_layout(%946) : !memref_rmem_f32_4
      %963 = cute.get_shape(%lay_3581) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3582, %e1_3583, %e2_3584, %e3_3585 = cute.get_leaves(%963) : !cute.shape<"((2,2),(2,8))">
      %964 = cute.get_stride(%lay_3581) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3586, %e1_3587, %e2_3588, %e3_3589 = cute.get_leaves(%964) : !cute.stride<"((2,4),(1,8))">
      %965 = scf.if %962 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%946) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,10)">
        cute.memref.store(%946, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,10)">, f32) -> ()
        %lay_7832 = cute.get_layout(%946) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %946 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%946) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%946) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %946 : !memref_rmem_f32_4
      }
      %iter_3590 = cute.get_iter(%965) : !memref_rmem_f32_4
      %lay_3591 = cute.get_layout(%965) : !memref_rmem_f32_4
      %966 = cute.get_shape(%lay_3591) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3592, %e1_3593, %e2_3594, %e3_3595 = cute.get_leaves(%966) : !cute.shape<"((2,2),(2,8))">
      %967 = cute.get_stride(%lay_3591) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3596, %e1_3597, %e2_3598, %e3_3599 = cute.get_leaves(%967) : !cute.stride<"((2,4),(1,8))">
      %iter_3600 = cute.get_iter(%965) : !memref_rmem_f32_4
      %iter_3601 = cute.get_iter(%965) : !memref_rmem_f32_4
      %coord_3602 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_3603 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3604 = cute.crd2idx(%coord_3602, %lay_3603) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_3605 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3606 = cute.add_offset(%iter_3605, %idx_3604) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3607 = cute.make_view(%tup_3606) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3608 = cute.get_iter(%view_3607) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3609, %e1_3610, %e2_3611, %e3_3612 = cute.get_leaves(%iter_3608) : !cute.int_tuple<"(?,?,?,?)">
      %968 = cute.get_scalars(%e0_3609) : !cute.int_tuple<"?">
      %969 = cute.get_scalars(%e1_3610) : !cute.int_tuple<"?">
      %970 = cute.get_scalars(%e2_3611) : !cute.int_tuple<"?">
      %971 = cute.get_scalars(%e3_3612) : !cute.int_tuple<"?">
      %iter_3613 = cute.get_iter(%view_3607) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3614, %e1_3615, %e2_3616, %e3_3617 = cute.get_leaves(%iter_3613) : !cute.int_tuple<"(?,?,?,?)">
      %972 = cute.get_scalars(%e0_3614) : !cute.int_tuple<"?">
      %973 = cute.get_scalars(%e1_3615) : !cute.int_tuple<"?">
      %974 = cute.get_scalars(%e2_3616) : !cute.int_tuple<"?">
      %975 = cute.get_scalars(%e3_3617) : !cute.int_tuple<"?">
      %iter_3618 = cute.get_iter(%view_3607) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3619, %e1_3620, %e2_3621, %e3_3622 = cute.get_leaves(%iter_3618) : !cute.int_tuple<"(?,?,?,?)">
      %976 = cute.get_scalars(%e0_3619) : !cute.int_tuple<"?">
      %977 = cute.get_scalars(%e1_3620) : !cute.int_tuple<"?">
      %978 = cute.get_scalars(%e2_3621) : !cute.int_tuple<"?">
      %979 = cute.get_scalars(%e3_3622) : !cute.int_tuple<"?">
      %int_tuple_3623 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3624 = cute.add_offset(%e3_3622, %int_tuple_3623) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %980 = cute.get_scalars(%tup_3624) : !cute.int_tuple<"?">
      %coord_3625 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3626 = cute.make_coord(%tup_3624) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %981 = cute.elem_less(%coord_3625, %coord_3626) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3627 = cute.get_layout(%965) : !memref_rmem_f32_4
      %982 = cute.get_shape(%lay_3627) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3628, %e1_3629, %e2_3630, %e3_3631 = cute.get_leaves(%982) : !cute.shape<"((2,2),(2,8))">
      %983 = cute.get_stride(%lay_3627) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3632, %e1_3633, %e2_3634, %e3_3635 = cute.get_leaves(%983) : !cute.stride<"((2,4),(1,8))">
      %984 = scf.if %981 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%965) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,11)">
        cute.memref.store(%965, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,11)">, f32) -> ()
        %lay_7832 = cute.get_layout(%965) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %965 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%965) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%965) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %965 : !memref_rmem_f32_4
      }
      %iter_3636 = cute.get_iter(%984) : !memref_rmem_f32_4
      %lay_3637 = cute.get_layout(%984) : !memref_rmem_f32_4
      %985 = cute.get_shape(%lay_3637) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3638, %e1_3639, %e2_3640, %e3_3641 = cute.get_leaves(%985) : !cute.shape<"((2,2),(2,8))">
      %986 = cute.get_stride(%lay_3637) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3642, %e1_3643, %e2_3644, %e3_3645 = cute.get_leaves(%986) : !cute.stride<"((2,4),(1,8))">
      %iter_3646 = cute.get_iter(%984) : !memref_rmem_f32_4
      %iter_3647 = cute.get_iter(%984) : !memref_rmem_f32_4
      %coord_3648 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_3649 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3650 = cute.crd2idx(%coord_3648, %lay_3649) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_3651 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3652 = cute.add_offset(%iter_3651, %idx_3650) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3653 = cute.make_view(%tup_3652) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3654 = cute.get_iter(%view_3653) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3655, %e1_3656, %e2_3657, %e3_3658 = cute.get_leaves(%iter_3654) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %987 = cute.get_scalars(%e0_3655) : !cute.int_tuple<"?">
      %988 = cute.get_scalars(%e1_3656) : !cute.int_tuple<"?">
      %989 = cute.get_scalars(%e2_3657) : !cute.int_tuple<"?">
      %990 = cute.get_scalars(%e3_3658) : !cute.int_tuple<"?{div=2}">
      %iter_3659 = cute.get_iter(%view_3653) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3660, %e1_3661, %e2_3662, %e3_3663 = cute.get_leaves(%iter_3659) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %991 = cute.get_scalars(%e0_3660) : !cute.int_tuple<"?">
      %992 = cute.get_scalars(%e1_3661) : !cute.int_tuple<"?">
      %993 = cute.get_scalars(%e2_3662) : !cute.int_tuple<"?">
      %994 = cute.get_scalars(%e3_3663) : !cute.int_tuple<"?{div=2}">
      %iter_3664 = cute.get_iter(%view_3653) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3665, %e1_3666, %e2_3667, %e3_3668 = cute.get_leaves(%iter_3664) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %995 = cute.get_scalars(%e0_3665) : !cute.int_tuple<"?">
      %996 = cute.get_scalars(%e1_3666) : !cute.int_tuple<"?">
      %997 = cute.get_scalars(%e2_3667) : !cute.int_tuple<"?">
      %998 = cute.get_scalars(%e3_3668) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3669 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3670 = cute.add_offset(%e3_3668, %int_tuple_3669) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %999 = cute.get_scalars(%tup_3670) : !cute.int_tuple<"?">
      %coord_3671 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3672 = cute.make_coord(%tup_3670) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1000 = cute.elem_less(%coord_3671, %coord_3672) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3673 = cute.get_layout(%984) : !memref_rmem_f32_4
      %1001 = cute.get_shape(%lay_3673) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3674, %e1_3675, %e2_3676, %e3_3677 = cute.get_leaves(%1001) : !cute.shape<"((2,2),(2,8))">
      %1002 = cute.get_stride(%lay_3673) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3678, %e1_3679, %e2_3680, %e3_3681 = cute.get_leaves(%1002) : !cute.stride<"((2,4),(1,8))">
      %1003 = scf.if %1000 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%984) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,12)">
        cute.memref.store(%984, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,12)">, f32) -> ()
        %lay_7832 = cute.get_layout(%984) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %984 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%984) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%984) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %984 : !memref_rmem_f32_4
      }
      %iter_3682 = cute.get_iter(%1003) : !memref_rmem_f32_4
      %lay_3683 = cute.get_layout(%1003) : !memref_rmem_f32_4
      %1004 = cute.get_shape(%lay_3683) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3684, %e1_3685, %e2_3686, %e3_3687 = cute.get_leaves(%1004) : !cute.shape<"((2,2),(2,8))">
      %1005 = cute.get_stride(%lay_3683) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3688, %e1_3689, %e2_3690, %e3_3691 = cute.get_leaves(%1005) : !cute.stride<"((2,4),(1,8))">
      %iter_3692 = cute.get_iter(%1003) : !memref_rmem_f32_4
      %iter_3693 = cute.get_iter(%1003) : !memref_rmem_f32_4
      %coord_3694 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_3695 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3696 = cute.crd2idx(%coord_3694, %lay_3695) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_3697 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3698 = cute.add_offset(%iter_3697, %idx_3696) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3699 = cute.make_view(%tup_3698) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3700 = cute.get_iter(%view_3699) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3701, %e1_3702, %e2_3703, %e3_3704 = cute.get_leaves(%iter_3700) : !cute.int_tuple<"(?,?,?,?)">
      %1006 = cute.get_scalars(%e0_3701) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e1_3702) : !cute.int_tuple<"?">
      %1008 = cute.get_scalars(%e2_3703) : !cute.int_tuple<"?">
      %1009 = cute.get_scalars(%e3_3704) : !cute.int_tuple<"?">
      %iter_3705 = cute.get_iter(%view_3699) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3706, %e1_3707, %e2_3708, %e3_3709 = cute.get_leaves(%iter_3705) : !cute.int_tuple<"(?,?,?,?)">
      %1010 = cute.get_scalars(%e0_3706) : !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%e1_3707) : !cute.int_tuple<"?">
      %1012 = cute.get_scalars(%e2_3708) : !cute.int_tuple<"?">
      %1013 = cute.get_scalars(%e3_3709) : !cute.int_tuple<"?">
      %iter_3710 = cute.get_iter(%view_3699) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3711, %e1_3712, %e2_3713, %e3_3714 = cute.get_leaves(%iter_3710) : !cute.int_tuple<"(?,?,?,?)">
      %1014 = cute.get_scalars(%e0_3711) : !cute.int_tuple<"?">
      %1015 = cute.get_scalars(%e1_3712) : !cute.int_tuple<"?">
      %1016 = cute.get_scalars(%e2_3713) : !cute.int_tuple<"?">
      %1017 = cute.get_scalars(%e3_3714) : !cute.int_tuple<"?">
      %int_tuple_3715 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3716 = cute.add_offset(%e3_3714, %int_tuple_3715) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1018 = cute.get_scalars(%tup_3716) : !cute.int_tuple<"?">
      %coord_3717 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3718 = cute.make_coord(%tup_3716) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1019 = cute.elem_less(%coord_3717, %coord_3718) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3719 = cute.get_layout(%1003) : !memref_rmem_f32_4
      %1020 = cute.get_shape(%lay_3719) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3720, %e1_3721, %e2_3722, %e3_3723 = cute.get_leaves(%1020) : !cute.shape<"((2,2),(2,8))">
      %1021 = cute.get_stride(%lay_3719) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3724, %e1_3725, %e2_3726, %e3_3727 = cute.get_leaves(%1021) : !cute.stride<"((2,4),(1,8))">
      %1022 = scf.if %1019 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1003) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,13)">
        cute.memref.store(%1003, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,13)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1003) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1003 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1003) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1003) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1003 : !memref_rmem_f32_4
      }
      %iter_3728 = cute.get_iter(%1022) : !memref_rmem_f32_4
      %lay_3729 = cute.get_layout(%1022) : !memref_rmem_f32_4
      %1023 = cute.get_shape(%lay_3729) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3730, %e1_3731, %e2_3732, %e3_3733 = cute.get_leaves(%1023) : !cute.shape<"((2,2),(2,8))">
      %1024 = cute.get_stride(%lay_3729) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3734, %e1_3735, %e2_3736, %e3_3737 = cute.get_leaves(%1024) : !cute.stride<"((2,4),(1,8))">
      %iter_3738 = cute.get_iter(%1022) : !memref_rmem_f32_4
      %iter_3739 = cute.get_iter(%1022) : !memref_rmem_f32_4
      %coord_3740 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_3741 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3742 = cute.crd2idx(%coord_3740, %lay_3741) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_3743 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3744 = cute.add_offset(%iter_3743, %idx_3742) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3745 = cute.make_view(%tup_3744) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3746 = cute.get_iter(%view_3745) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3747, %e1_3748, %e2_3749, %e3_3750 = cute.get_leaves(%iter_3746) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1025 = cute.get_scalars(%e0_3747) : !cute.int_tuple<"?">
      %1026 = cute.get_scalars(%e1_3748) : !cute.int_tuple<"?">
      %1027 = cute.get_scalars(%e2_3749) : !cute.int_tuple<"?">
      %1028 = cute.get_scalars(%e3_3750) : !cute.int_tuple<"?{div=2}">
      %iter_3751 = cute.get_iter(%view_3745) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3752, %e1_3753, %e2_3754, %e3_3755 = cute.get_leaves(%iter_3751) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1029 = cute.get_scalars(%e0_3752) : !cute.int_tuple<"?">
      %1030 = cute.get_scalars(%e1_3753) : !cute.int_tuple<"?">
      %1031 = cute.get_scalars(%e2_3754) : !cute.int_tuple<"?">
      %1032 = cute.get_scalars(%e3_3755) : !cute.int_tuple<"?{div=2}">
      %iter_3756 = cute.get_iter(%view_3745) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3757, %e1_3758, %e2_3759, %e3_3760 = cute.get_leaves(%iter_3756) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1033 = cute.get_scalars(%e0_3757) : !cute.int_tuple<"?">
      %1034 = cute.get_scalars(%e1_3758) : !cute.int_tuple<"?">
      %1035 = cute.get_scalars(%e2_3759) : !cute.int_tuple<"?">
      %1036 = cute.get_scalars(%e3_3760) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3761 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3762 = cute.add_offset(%e3_3760, %int_tuple_3761) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1037 = cute.get_scalars(%tup_3762) : !cute.int_tuple<"?">
      %coord_3763 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3764 = cute.make_coord(%tup_3762) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1038 = cute.elem_less(%coord_3763, %coord_3764) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3765 = cute.get_layout(%1022) : !memref_rmem_f32_4
      %1039 = cute.get_shape(%lay_3765) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3766, %e1_3767, %e2_3768, %e3_3769 = cute.get_leaves(%1039) : !cute.shape<"((2,2),(2,8))">
      %1040 = cute.get_stride(%lay_3765) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3770, %e1_3771, %e2_3772, %e3_3773 = cute.get_leaves(%1040) : !cute.stride<"((2,4),(1,8))">
      %1041 = scf.if %1038 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1022) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,14)">
        cute.memref.store(%1022, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,14)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1022) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1022 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1022) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1022) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1022 : !memref_rmem_f32_4
      }
      %iter_3774 = cute.get_iter(%1041) : !memref_rmem_f32_4
      %lay_3775 = cute.get_layout(%1041) : !memref_rmem_f32_4
      %1042 = cute.get_shape(%lay_3775) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3776, %e1_3777, %e2_3778, %e3_3779 = cute.get_leaves(%1042) : !cute.shape<"((2,2),(2,8))">
      %1043 = cute.get_stride(%lay_3775) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3780, %e1_3781, %e2_3782, %e3_3783 = cute.get_leaves(%1043) : !cute.stride<"((2,4),(1,8))">
      %iter_3784 = cute.get_iter(%1041) : !memref_rmem_f32_4
      %iter_3785 = cute.get_iter(%1041) : !memref_rmem_f32_4
      %coord_3786 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_3787 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3788 = cute.crd2idx(%coord_3786, %lay_3787) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_3789 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3790 = cute.add_offset(%iter_3789, %idx_3788) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3791 = cute.make_view(%tup_3790) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3792 = cute.get_iter(%view_3791) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3793, %e1_3794, %e2_3795, %e3_3796 = cute.get_leaves(%iter_3792) : !cute.int_tuple<"(?,?,?,?)">
      %1044 = cute.get_scalars(%e0_3793) : !cute.int_tuple<"?">
      %1045 = cute.get_scalars(%e1_3794) : !cute.int_tuple<"?">
      %1046 = cute.get_scalars(%e2_3795) : !cute.int_tuple<"?">
      %1047 = cute.get_scalars(%e3_3796) : !cute.int_tuple<"?">
      %iter_3797 = cute.get_iter(%view_3791) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3798, %e1_3799, %e2_3800, %e3_3801 = cute.get_leaves(%iter_3797) : !cute.int_tuple<"(?,?,?,?)">
      %1048 = cute.get_scalars(%e0_3798) : !cute.int_tuple<"?">
      %1049 = cute.get_scalars(%e1_3799) : !cute.int_tuple<"?">
      %1050 = cute.get_scalars(%e2_3800) : !cute.int_tuple<"?">
      %1051 = cute.get_scalars(%e3_3801) : !cute.int_tuple<"?">
      %iter_3802 = cute.get_iter(%view_3791) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3803, %e1_3804, %e2_3805, %e3_3806 = cute.get_leaves(%iter_3802) : !cute.int_tuple<"(?,?,?,?)">
      %1052 = cute.get_scalars(%e0_3803) : !cute.int_tuple<"?">
      %1053 = cute.get_scalars(%e1_3804) : !cute.int_tuple<"?">
      %1054 = cute.get_scalars(%e2_3805) : !cute.int_tuple<"?">
      %1055 = cute.get_scalars(%e3_3806) : !cute.int_tuple<"?">
      %int_tuple_3807 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3808 = cute.add_offset(%e3_3806, %int_tuple_3807) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1056 = cute.get_scalars(%tup_3808) : !cute.int_tuple<"?">
      %coord_3809 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3810 = cute.make_coord(%tup_3808) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1057 = cute.elem_less(%coord_3809, %coord_3810) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3811 = cute.get_layout(%1041) : !memref_rmem_f32_4
      %1058 = cute.get_shape(%lay_3811) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3812, %e1_3813, %e2_3814, %e3_3815 = cute.get_leaves(%1058) : !cute.shape<"((2,2),(2,8))">
      %1059 = cute.get_stride(%lay_3811) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3816, %e1_3817, %e2_3818, %e3_3819 = cute.get_leaves(%1059) : !cute.stride<"((2,4),(1,8))">
      %1060 = scf.if %1057 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1041) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(0,15)">
        cute.memref.store(%1041, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(0,15)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1041) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1041 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1041) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1041) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1041 : !memref_rmem_f32_4
      }
      %iter_3820 = cute.get_iter(%1060) : !memref_rmem_f32_4
      %lay_3821 = cute.get_layout(%1060) : !memref_rmem_f32_4
      %1061 = cute.get_shape(%lay_3821) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3822, %e1_3823, %e2_3824, %e3_3825 = cute.get_leaves(%1061) : !cute.shape<"((2,2),(2,8))">
      %1062 = cute.get_stride(%lay_3821) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3826, %e1_3827, %e2_3828, %e3_3829 = cute.get_leaves(%1062) : !cute.stride<"((2,4),(1,8))">
      %iter_3830 = cute.get_iter(%1060) : !memref_rmem_f32_4
      %iter_3831 = cute.get_iter(%1060) : !memref_rmem_f32_4
      %coord_3832 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_3833 = cute.get_layout(%1060) : !memref_rmem_f32_4
      %idx_3834 = cute.crd2idx(%coord_3832, %lay_3833) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_3835 = cute.get_iter(%1060) : !memref_rmem_f32_4
      %ptr_3836 = cute.add_offset(%iter_3835, %idx_3834) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_3837 = cute.make_view(%ptr_3836) : !memref_rmem_f32_6
      %iter_3838 = cute.get_iter(%view_3837) : !memref_rmem_f32_6
      %iter_3839 = cute.get_iter(%view_3837) : !memref_rmem_f32_6
      %lay_3840 = cute.get_layout(%view_3837) : !memref_rmem_f32_6
      %1063 = cute.get_shape(%lay_3840) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3841, %e1_3842 = cute.get_leaves(%1063) : !cute.shape<"((2,8))">
      %1064 = cute.memref.load_vec %view_3837 : !memref_rmem_f32_6
      %cst_3843 = arith.constant 0xFF800000 : f32
      %1065 = vector.reduction <maximumf>, %1064, %cst_3843 : vector<16xf32> into f32
      %c-1_i32 = arith.constant -1 : i32
      %c2_i32 = arith.constant 2 : i32
      %c31_i32 = arith.constant 31 : i32
      %1066 = nvvm.shfl.sync  bfly %c-1_i32, %1065, %c2_i32, %c31_i32 : f32 -> f32
      %1067 = nvvm.fmax %1065, %1066
      %c-1_i32_3844 = arith.constant -1 : i32
      %c1_i32_3845 = arith.constant 1 : i32
      %c31_i32_3846 = arith.constant 31 : i32
      %1068 = nvvm.shfl.sync  bfly %c-1_i32_3844, %1067, %c1_i32_3845, %c31_i32_3846 : f32 -> f32
      %1069 = nvvm.fmax %1067, %1068
      %1070 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1071 = arith.mulf %1064, %1070 : vector<16xf32>
      %1072 = arith.mulf %1069, %arg4 : f32
      %1073 = vector.broadcast %1072 : f32 to vector<16xf32>
      %1074 = arith.subf %1071, %1073 : vector<16xf32>
      %1075 = math.exp2 %1074 fastmath<fast> : vector<16xf32>
      %cst_3847 = arith.constant 0.000000e+00 : f32
      %1076 = vector.reduction <add>, %1075, %cst_3847 : vector<16xf32> into f32
      %coord_3848 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1075, %coord_3848, %1069) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_3849 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1080, %coord_3849, %1076) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_3850 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_3851 = cute.get_layout(%1060) : !memref_rmem_f32_4
      %idx_3852 = cute.crd2idx(%coord_3850, %lay_3851) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_3853 = cute.get_iter(%1060) : !memref_rmem_f32_4
      %ptr_3854 = cute.add_offset(%iter_3853, %idx_3852) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_3855 = cute.make_view(%ptr_3854) : !memref_rmem_f32_6
      %iter_3856 = cute.get_iter(%view_3855) : !memref_rmem_f32_6
      %iter_3857 = cute.get_iter(%view_3855) : !memref_rmem_f32_6
      %lay_3858 = cute.get_layout(%view_3855) : !memref_rmem_f32_6
      %1077 = cute.get_shape(%lay_3858) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3859, %e1_3860 = cute.get_leaves(%1077) : !cute.shape<"((2,8))">
      %int_tuple_3861 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3862 = cute.size(%int_tuple_3861) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3863 = cute.get_leaves(%sz_3862) : !cute.int_tuple<"16">
      %int_tuple_3864 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3865 = cute.size(%int_tuple_3864) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3866 = cute.get_leaves(%sz_3865) : !cute.int_tuple<"16">
      cute.memref.store_vec %1075, %view_3855 : !memref_rmem_f32_6
      %int_tuple_3867 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3868 = cute.size(%int_tuple_3867) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3869 = cute.get_leaves(%sz_3868) : !cute.int_tuple<"16">
      %coord_3870 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3871 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3872 = cute.crd2idx(%coord_3870, %lay_3871) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3873 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3874 = cute.add_offset(%iter_3873, %idx_3872) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3875 = cute.make_view(%tup_3874) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3876 = cute.get_iter(%view_3875) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3877, %e1_3878, %e2_3879, %e3_3880 = cute.get_leaves(%iter_3876) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1078 = cute.get_scalars(%e0_3877) : !cute.int_tuple<"?">
      %1079 = cute.get_scalars(%e1_3878) : !cute.int_tuple<"?">
      %1080 = cute.get_scalars(%e2_3879) : !cute.int_tuple<"?">
      %1081 = cute.get_scalars(%e3_3880) : !cute.int_tuple<"?{div=2}">
      %iter_3881 = cute.get_iter(%view_3875) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3882, %e1_3883, %e2_3884, %e3_3885 = cute.get_leaves(%iter_3881) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1082 = cute.get_scalars(%e0_3882) : !cute.int_tuple<"?">
      %1083 = cute.get_scalars(%e1_3883) : !cute.int_tuple<"?">
      %1084 = cute.get_scalars(%e2_3884) : !cute.int_tuple<"?">
      %1085 = cute.get_scalars(%e3_3885) : !cute.int_tuple<"?{div=2}">
      %iter_3886 = cute.get_iter(%view_3875) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3887, %e1_3888, %e2_3889, %e3_3890 = cute.get_leaves(%iter_3886) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1086 = cute.get_scalars(%e0_3887) : !cute.int_tuple<"?">
      %1087 = cute.get_scalars(%e1_3888) : !cute.int_tuple<"?">
      %1088 = cute.get_scalars(%e2_3889) : !cute.int_tuple<"?">
      %1089 = cute.get_scalars(%e3_3890) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3891 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3892 = cute.add_offset(%e3_3890, %int_tuple_3891) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1090 = cute.get_scalars(%tup_3892) : !cute.int_tuple<"?">
      %coord_3893 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3894 = cute.make_coord(%tup_3892) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1091 = cute.elem_less(%coord_3893, %coord_3894) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3895 = cute.get_layout(%1060) : !memref_rmem_f32_4
      %1092 = cute.get_shape(%lay_3895) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3896, %e1_3897, %e2_3898, %e3_3899 = cute.get_leaves(%1092) : !cute.shape<"((2,2),(2,8))">
      %1093 = cute.get_stride(%lay_3895) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3900, %e1_3901, %e2_3902, %e3_3903 = cute.get_leaves(%1093) : !cute.stride<"((2,4),(1,8))">
      %1094 = scf.if %1091 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1060) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,0)">
        cute.memref.store(%1060, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,0)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1060) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1060 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1060) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1060) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1060 : !memref_rmem_f32_4
      }
      %iter_3904 = cute.get_iter(%1094) : !memref_rmem_f32_4
      %lay_3905 = cute.get_layout(%1094) : !memref_rmem_f32_4
      %1095 = cute.get_shape(%lay_3905) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3906, %e1_3907, %e2_3908, %e3_3909 = cute.get_leaves(%1095) : !cute.shape<"((2,2),(2,8))">
      %1096 = cute.get_stride(%lay_3905) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3910, %e1_3911, %e2_3912, %e3_3913 = cute.get_leaves(%1096) : !cute.stride<"((2,4),(1,8))">
      %iter_3914 = cute.get_iter(%1094) : !memref_rmem_f32_4
      %iter_3915 = cute.get_iter(%1094) : !memref_rmem_f32_4
      %coord_3916 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3917 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3918 = cute.crd2idx(%coord_3916, %lay_3917) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3919 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3920 = cute.add_offset(%iter_3919, %idx_3918) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3921 = cute.make_view(%tup_3920) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3922 = cute.get_iter(%view_3921) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3923, %e1_3924, %e2_3925, %e3_3926 = cute.get_leaves(%iter_3922) : !cute.int_tuple<"(?,?,?,?)">
      %1097 = cute.get_scalars(%e0_3923) : !cute.int_tuple<"?">
      %1098 = cute.get_scalars(%e1_3924) : !cute.int_tuple<"?">
      %1099 = cute.get_scalars(%e2_3925) : !cute.int_tuple<"?">
      %1100 = cute.get_scalars(%e3_3926) : !cute.int_tuple<"?">
      %iter_3927 = cute.get_iter(%view_3921) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3928, %e1_3929, %e2_3930, %e3_3931 = cute.get_leaves(%iter_3927) : !cute.int_tuple<"(?,?,?,?)">
      %1101 = cute.get_scalars(%e0_3928) : !cute.int_tuple<"?">
      %1102 = cute.get_scalars(%e1_3929) : !cute.int_tuple<"?">
      %1103 = cute.get_scalars(%e2_3930) : !cute.int_tuple<"?">
      %1104 = cute.get_scalars(%e3_3931) : !cute.int_tuple<"?">
      %iter_3932 = cute.get_iter(%view_3921) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3933, %e1_3934, %e2_3935, %e3_3936 = cute.get_leaves(%iter_3932) : !cute.int_tuple<"(?,?,?,?)">
      %1105 = cute.get_scalars(%e0_3933) : !cute.int_tuple<"?">
      %1106 = cute.get_scalars(%e1_3934) : !cute.int_tuple<"?">
      %1107 = cute.get_scalars(%e2_3935) : !cute.int_tuple<"?">
      %1108 = cute.get_scalars(%e3_3936) : !cute.int_tuple<"?">
      %int_tuple_3937 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3938 = cute.add_offset(%e3_3936, %int_tuple_3937) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1109 = cute.get_scalars(%tup_3938) : !cute.int_tuple<"?">
      %coord_3939 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3940 = cute.make_coord(%tup_3938) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1110 = cute.elem_less(%coord_3939, %coord_3940) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3941 = cute.get_layout(%1094) : !memref_rmem_f32_4
      %1111 = cute.get_shape(%lay_3941) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3942, %e1_3943, %e2_3944, %e3_3945 = cute.get_leaves(%1111) : !cute.shape<"((2,2),(2,8))">
      %1112 = cute.get_stride(%lay_3941) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3946, %e1_3947, %e2_3948, %e3_3949 = cute.get_leaves(%1112) : !cute.stride<"((2,4),(1,8))">
      %1113 = scf.if %1110 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1094) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,1)">
        cute.memref.store(%1094, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,1)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1094) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1094 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1094) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1094) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1094 : !memref_rmem_f32_4
      }
      %iter_3950 = cute.get_iter(%1113) : !memref_rmem_f32_4
      %lay_3951 = cute.get_layout(%1113) : !memref_rmem_f32_4
      %1114 = cute.get_shape(%lay_3951) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3952, %e1_3953, %e2_3954, %e3_3955 = cute.get_leaves(%1114) : !cute.shape<"((2,2),(2,8))">
      %1115 = cute.get_stride(%lay_3951) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3956, %e1_3957, %e2_3958, %e3_3959 = cute.get_leaves(%1115) : !cute.stride<"((2,4),(1,8))">
      %iter_3960 = cute.get_iter(%1113) : !memref_rmem_f32_4
      %iter_3961 = cute.get_iter(%1113) : !memref_rmem_f32_4
      %coord_3962 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3963 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3964 = cute.crd2idx(%coord_3962, %lay_3963) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3965 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3966 = cute.add_offset(%iter_3965, %idx_3964) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3967 = cute.make_view(%tup_3966) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3968 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3969, %e1_3970, %e2_3971, %e3_3972 = cute.get_leaves(%iter_3968) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1116 = cute.get_scalars(%e0_3969) : !cute.int_tuple<"?">
      %1117 = cute.get_scalars(%e1_3970) : !cute.int_tuple<"?">
      %1118 = cute.get_scalars(%e2_3971) : !cute.int_tuple<"?">
      %1119 = cute.get_scalars(%e3_3972) : !cute.int_tuple<"?{div=2}">
      %iter_3973 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3974, %e1_3975, %e2_3976, %e3_3977 = cute.get_leaves(%iter_3973) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1120 = cute.get_scalars(%e0_3974) : !cute.int_tuple<"?">
      %1121 = cute.get_scalars(%e1_3975) : !cute.int_tuple<"?">
      %1122 = cute.get_scalars(%e2_3976) : !cute.int_tuple<"?">
      %1123 = cute.get_scalars(%e3_3977) : !cute.int_tuple<"?{div=2}">
      %iter_3978 = cute.get_iter(%view_3967) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3979, %e1_3980, %e2_3981, %e3_3982 = cute.get_leaves(%iter_3978) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1124 = cute.get_scalars(%e0_3979) : !cute.int_tuple<"?">
      %1125 = cute.get_scalars(%e1_3980) : !cute.int_tuple<"?">
      %1126 = cute.get_scalars(%e2_3981) : !cute.int_tuple<"?">
      %1127 = cute.get_scalars(%e3_3982) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3983 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3984 = cute.add_offset(%e3_3982, %int_tuple_3983) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1128 = cute.get_scalars(%tup_3984) : !cute.int_tuple<"?">
      %coord_3985 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3986 = cute.make_coord(%tup_3984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1129 = cute.elem_less(%coord_3985, %coord_3986) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3987 = cute.get_layout(%1113) : !memref_rmem_f32_4
      %1130 = cute.get_shape(%lay_3987) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3988, %e1_3989, %e2_3990, %e3_3991 = cute.get_leaves(%1130) : !cute.shape<"((2,2),(2,8))">
      %1131 = cute.get_stride(%lay_3987) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3992, %e1_3993, %e2_3994, %e3_3995 = cute.get_leaves(%1131) : !cute.stride<"((2,4),(1,8))">
      %1132 = scf.if %1129 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1113) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,2)">
        cute.memref.store(%1113, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,2)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1113) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1113 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1113) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1113) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1113 : !memref_rmem_f32_4
      }
      %iter_3996 = cute.get_iter(%1132) : !memref_rmem_f32_4
      %lay_3997 = cute.get_layout(%1132) : !memref_rmem_f32_4
      %1133 = cute.get_shape(%lay_3997) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3998, %e1_3999, %e2_4000, %e3_4001 = cute.get_leaves(%1133) : !cute.shape<"((2,2),(2,8))">
      %1134 = cute.get_stride(%lay_3997) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4002, %e1_4003, %e2_4004, %e3_4005 = cute.get_leaves(%1134) : !cute.stride<"((2,4),(1,8))">
      %iter_4006 = cute.get_iter(%1132) : !memref_rmem_f32_4
      %iter_4007 = cute.get_iter(%1132) : !memref_rmem_f32_4
      %coord_4008 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_4009 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4010 = cute.crd2idx(%coord_4008, %lay_4009) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_4011 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4012 = cute.add_offset(%iter_4011, %idx_4010) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4013 = cute.make_view(%tup_4012) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4014 = cute.get_iter(%view_4013) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4015, %e1_4016, %e2_4017, %e3_4018 = cute.get_leaves(%iter_4014) : !cute.int_tuple<"(?,?,?,?)">
      %1135 = cute.get_scalars(%e0_4015) : !cute.int_tuple<"?">
      %1136 = cute.get_scalars(%e1_4016) : !cute.int_tuple<"?">
      %1137 = cute.get_scalars(%e2_4017) : !cute.int_tuple<"?">
      %1138 = cute.get_scalars(%e3_4018) : !cute.int_tuple<"?">
      %iter_4019 = cute.get_iter(%view_4013) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4020, %e1_4021, %e2_4022, %e3_4023 = cute.get_leaves(%iter_4019) : !cute.int_tuple<"(?,?,?,?)">
      %1139 = cute.get_scalars(%e0_4020) : !cute.int_tuple<"?">
      %1140 = cute.get_scalars(%e1_4021) : !cute.int_tuple<"?">
      %1141 = cute.get_scalars(%e2_4022) : !cute.int_tuple<"?">
      %1142 = cute.get_scalars(%e3_4023) : !cute.int_tuple<"?">
      %iter_4024 = cute.get_iter(%view_4013) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4025, %e1_4026, %e2_4027, %e3_4028 = cute.get_leaves(%iter_4024) : !cute.int_tuple<"(?,?,?,?)">
      %1143 = cute.get_scalars(%e0_4025) : !cute.int_tuple<"?">
      %1144 = cute.get_scalars(%e1_4026) : !cute.int_tuple<"?">
      %1145 = cute.get_scalars(%e2_4027) : !cute.int_tuple<"?">
      %1146 = cute.get_scalars(%e3_4028) : !cute.int_tuple<"?">
      %int_tuple_4029 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4030 = cute.add_offset(%e3_4028, %int_tuple_4029) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1147 = cute.get_scalars(%tup_4030) : !cute.int_tuple<"?">
      %coord_4031 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4032 = cute.make_coord(%tup_4030) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1148 = cute.elem_less(%coord_4031, %coord_4032) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4033 = cute.get_layout(%1132) : !memref_rmem_f32_4
      %1149 = cute.get_shape(%lay_4033) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4034, %e1_4035, %e2_4036, %e3_4037 = cute.get_leaves(%1149) : !cute.shape<"((2,2),(2,8))">
      %1150 = cute.get_stride(%lay_4033) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4038, %e1_4039, %e2_4040, %e3_4041 = cute.get_leaves(%1150) : !cute.stride<"((2,4),(1,8))">
      %1151 = scf.if %1148 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1132) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,3)">
        cute.memref.store(%1132, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,3)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1132) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1132 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1132) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1132) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1132 : !memref_rmem_f32_4
      }
      %iter_4042 = cute.get_iter(%1151) : !memref_rmem_f32_4
      %lay_4043 = cute.get_layout(%1151) : !memref_rmem_f32_4
      %1152 = cute.get_shape(%lay_4043) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4044, %e1_4045, %e2_4046, %e3_4047 = cute.get_leaves(%1152) : !cute.shape<"((2,2),(2,8))">
      %1153 = cute.get_stride(%lay_4043) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4048, %e1_4049, %e2_4050, %e3_4051 = cute.get_leaves(%1153) : !cute.stride<"((2,4),(1,8))">
      %iter_4052 = cute.get_iter(%1151) : !memref_rmem_f32_4
      %iter_4053 = cute.get_iter(%1151) : !memref_rmem_f32_4
      %coord_4054 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_4055 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4056 = cute.crd2idx(%coord_4054, %lay_4055) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_4057 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4058 = cute.add_offset(%iter_4057, %idx_4056) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4059 = cute.make_view(%tup_4058) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4060 = cute.get_iter(%view_4059) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4061, %e1_4062, %e2_4063, %e3_4064 = cute.get_leaves(%iter_4060) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1154 = cute.get_scalars(%e0_4061) : !cute.int_tuple<"?">
      %1155 = cute.get_scalars(%e1_4062) : !cute.int_tuple<"?">
      %1156 = cute.get_scalars(%e2_4063) : !cute.int_tuple<"?">
      %1157 = cute.get_scalars(%e3_4064) : !cute.int_tuple<"?{div=2}">
      %iter_4065 = cute.get_iter(%view_4059) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4066, %e1_4067, %e2_4068, %e3_4069 = cute.get_leaves(%iter_4065) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1158 = cute.get_scalars(%e0_4066) : !cute.int_tuple<"?">
      %1159 = cute.get_scalars(%e1_4067) : !cute.int_tuple<"?">
      %1160 = cute.get_scalars(%e2_4068) : !cute.int_tuple<"?">
      %1161 = cute.get_scalars(%e3_4069) : !cute.int_tuple<"?{div=2}">
      %iter_4070 = cute.get_iter(%view_4059) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4071, %e1_4072, %e2_4073, %e3_4074 = cute.get_leaves(%iter_4070) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1162 = cute.get_scalars(%e0_4071) : !cute.int_tuple<"?">
      %1163 = cute.get_scalars(%e1_4072) : !cute.int_tuple<"?">
      %1164 = cute.get_scalars(%e2_4073) : !cute.int_tuple<"?">
      %1165 = cute.get_scalars(%e3_4074) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4075 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4076 = cute.add_offset(%e3_4074, %int_tuple_4075) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1166 = cute.get_scalars(%tup_4076) : !cute.int_tuple<"?">
      %coord_4077 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4078 = cute.make_coord(%tup_4076) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1167 = cute.elem_less(%coord_4077, %coord_4078) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4079 = cute.get_layout(%1151) : !memref_rmem_f32_4
      %1168 = cute.get_shape(%lay_4079) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4080, %e1_4081, %e2_4082, %e3_4083 = cute.get_leaves(%1168) : !cute.shape<"((2,2),(2,8))">
      %1169 = cute.get_stride(%lay_4079) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4084, %e1_4085, %e2_4086, %e3_4087 = cute.get_leaves(%1169) : !cute.stride<"((2,4),(1,8))">
      %1170 = scf.if %1167 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1151) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,4)">
        cute.memref.store(%1151, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,4)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1151) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1151 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1151) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1151) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1151 : !memref_rmem_f32_4
      }
      %iter_4088 = cute.get_iter(%1170) : !memref_rmem_f32_4
      %lay_4089 = cute.get_layout(%1170) : !memref_rmem_f32_4
      %1171 = cute.get_shape(%lay_4089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4090, %e1_4091, %e2_4092, %e3_4093 = cute.get_leaves(%1171) : !cute.shape<"((2,2),(2,8))">
      %1172 = cute.get_stride(%lay_4089) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4094, %e1_4095, %e2_4096, %e3_4097 = cute.get_leaves(%1172) : !cute.stride<"((2,4),(1,8))">
      %iter_4098 = cute.get_iter(%1170) : !memref_rmem_f32_4
      %iter_4099 = cute.get_iter(%1170) : !memref_rmem_f32_4
      %coord_4100 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4101 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4102 = cute.crd2idx(%coord_4100, %lay_4101) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4103 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4104 = cute.add_offset(%iter_4103, %idx_4102) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4105 = cute.make_view(%tup_4104) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4106 = cute.get_iter(%view_4105) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4107, %e1_4108, %e2_4109, %e3_4110 = cute.get_leaves(%iter_4106) : !cute.int_tuple<"(?,?,?,?)">
      %1173 = cute.get_scalars(%e0_4107) : !cute.int_tuple<"?">
      %1174 = cute.get_scalars(%e1_4108) : !cute.int_tuple<"?">
      %1175 = cute.get_scalars(%e2_4109) : !cute.int_tuple<"?">
      %1176 = cute.get_scalars(%e3_4110) : !cute.int_tuple<"?">
      %iter_4111 = cute.get_iter(%view_4105) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4112, %e1_4113, %e2_4114, %e3_4115 = cute.get_leaves(%iter_4111) : !cute.int_tuple<"(?,?,?,?)">
      %1177 = cute.get_scalars(%e0_4112) : !cute.int_tuple<"?">
      %1178 = cute.get_scalars(%e1_4113) : !cute.int_tuple<"?">
      %1179 = cute.get_scalars(%e2_4114) : !cute.int_tuple<"?">
      %1180 = cute.get_scalars(%e3_4115) : !cute.int_tuple<"?">
      %iter_4116 = cute.get_iter(%view_4105) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4117, %e1_4118, %e2_4119, %e3_4120 = cute.get_leaves(%iter_4116) : !cute.int_tuple<"(?,?,?,?)">
      %1181 = cute.get_scalars(%e0_4117) : !cute.int_tuple<"?">
      %1182 = cute.get_scalars(%e1_4118) : !cute.int_tuple<"?">
      %1183 = cute.get_scalars(%e2_4119) : !cute.int_tuple<"?">
      %1184 = cute.get_scalars(%e3_4120) : !cute.int_tuple<"?">
      %int_tuple_4121 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4122 = cute.add_offset(%e3_4120, %int_tuple_4121) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1185 = cute.get_scalars(%tup_4122) : !cute.int_tuple<"?">
      %coord_4123 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4124 = cute.make_coord(%tup_4122) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1186 = cute.elem_less(%coord_4123, %coord_4124) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4125 = cute.get_layout(%1170) : !memref_rmem_f32_4
      %1187 = cute.get_shape(%lay_4125) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4126, %e1_4127, %e2_4128, %e3_4129 = cute.get_leaves(%1187) : !cute.shape<"((2,2),(2,8))">
      %1188 = cute.get_stride(%lay_4125) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4130, %e1_4131, %e2_4132, %e3_4133 = cute.get_leaves(%1188) : !cute.stride<"((2,4),(1,8))">
      %1189 = scf.if %1186 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1170) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,5)">
        cute.memref.store(%1170, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,5)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1170) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1170 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1170) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1170) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1170 : !memref_rmem_f32_4
      }
      %iter_4134 = cute.get_iter(%1189) : !memref_rmem_f32_4
      %lay_4135 = cute.get_layout(%1189) : !memref_rmem_f32_4
      %1190 = cute.get_shape(%lay_4135) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4136, %e1_4137, %e2_4138, %e3_4139 = cute.get_leaves(%1190) : !cute.shape<"((2,2),(2,8))">
      %1191 = cute.get_stride(%lay_4135) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4140, %e1_4141, %e2_4142, %e3_4143 = cute.get_leaves(%1191) : !cute.stride<"((2,4),(1,8))">
      %iter_4144 = cute.get_iter(%1189) : !memref_rmem_f32_4
      %iter_4145 = cute.get_iter(%1189) : !memref_rmem_f32_4
      %coord_4146 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4147 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4148 = cute.crd2idx(%coord_4146, %lay_4147) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4149 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4150 = cute.add_offset(%iter_4149, %idx_4148) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4151 = cute.make_view(%tup_4150) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4152 = cute.get_iter(%view_4151) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4153, %e1_4154, %e2_4155, %e3_4156 = cute.get_leaves(%iter_4152) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1192 = cute.get_scalars(%e0_4153) : !cute.int_tuple<"?">
      %1193 = cute.get_scalars(%e1_4154) : !cute.int_tuple<"?">
      %1194 = cute.get_scalars(%e2_4155) : !cute.int_tuple<"?">
      %1195 = cute.get_scalars(%e3_4156) : !cute.int_tuple<"?{div=2}">
      %iter_4157 = cute.get_iter(%view_4151) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4158, %e1_4159, %e2_4160, %e3_4161 = cute.get_leaves(%iter_4157) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1196 = cute.get_scalars(%e0_4158) : !cute.int_tuple<"?">
      %1197 = cute.get_scalars(%e1_4159) : !cute.int_tuple<"?">
      %1198 = cute.get_scalars(%e2_4160) : !cute.int_tuple<"?">
      %1199 = cute.get_scalars(%e3_4161) : !cute.int_tuple<"?{div=2}">
      %iter_4162 = cute.get_iter(%view_4151) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4163, %e1_4164, %e2_4165, %e3_4166 = cute.get_leaves(%iter_4162) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1200 = cute.get_scalars(%e0_4163) : !cute.int_tuple<"?">
      %1201 = cute.get_scalars(%e1_4164) : !cute.int_tuple<"?">
      %1202 = cute.get_scalars(%e2_4165) : !cute.int_tuple<"?">
      %1203 = cute.get_scalars(%e3_4166) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4167 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4168 = cute.add_offset(%e3_4166, %int_tuple_4167) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1204 = cute.get_scalars(%tup_4168) : !cute.int_tuple<"?">
      %coord_4169 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4170 = cute.make_coord(%tup_4168) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1205 = cute.elem_less(%coord_4169, %coord_4170) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4171 = cute.get_layout(%1189) : !memref_rmem_f32_4
      %1206 = cute.get_shape(%lay_4171) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4172, %e1_4173, %e2_4174, %e3_4175 = cute.get_leaves(%1206) : !cute.shape<"((2,2),(2,8))">
      %1207 = cute.get_stride(%lay_4171) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4176, %e1_4177, %e2_4178, %e3_4179 = cute.get_leaves(%1207) : !cute.stride<"((2,4),(1,8))">
      %1208 = scf.if %1205 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1189) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,6)">
        cute.memref.store(%1189, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,6)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1189) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1189 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1189) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1189) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1189 : !memref_rmem_f32_4
      }
      %iter_4180 = cute.get_iter(%1208) : !memref_rmem_f32_4
      %lay_4181 = cute.get_layout(%1208) : !memref_rmem_f32_4
      %1209 = cute.get_shape(%lay_4181) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4182, %e1_4183, %e2_4184, %e3_4185 = cute.get_leaves(%1209) : !cute.shape<"((2,2),(2,8))">
      %1210 = cute.get_stride(%lay_4181) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4186, %e1_4187, %e2_4188, %e3_4189 = cute.get_leaves(%1210) : !cute.stride<"((2,4),(1,8))">
      %iter_4190 = cute.get_iter(%1208) : !memref_rmem_f32_4
      %iter_4191 = cute.get_iter(%1208) : !memref_rmem_f32_4
      %coord_4192 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4193 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4194 = cute.crd2idx(%coord_4192, %lay_4193) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4195 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4196 = cute.add_offset(%iter_4195, %idx_4194) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4197 = cute.make_view(%tup_4196) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4198 = cute.get_iter(%view_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4199, %e1_4200, %e2_4201, %e3_4202 = cute.get_leaves(%iter_4198) : !cute.int_tuple<"(?,?,?,?)">
      %1211 = cute.get_scalars(%e0_4199) : !cute.int_tuple<"?">
      %1212 = cute.get_scalars(%e1_4200) : !cute.int_tuple<"?">
      %1213 = cute.get_scalars(%e2_4201) : !cute.int_tuple<"?">
      %1214 = cute.get_scalars(%e3_4202) : !cute.int_tuple<"?">
      %iter_4203 = cute.get_iter(%view_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4204, %e1_4205, %e2_4206, %e3_4207 = cute.get_leaves(%iter_4203) : !cute.int_tuple<"(?,?,?,?)">
      %1215 = cute.get_scalars(%e0_4204) : !cute.int_tuple<"?">
      %1216 = cute.get_scalars(%e1_4205) : !cute.int_tuple<"?">
      %1217 = cute.get_scalars(%e2_4206) : !cute.int_tuple<"?">
      %1218 = cute.get_scalars(%e3_4207) : !cute.int_tuple<"?">
      %iter_4208 = cute.get_iter(%view_4197) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4209, %e1_4210, %e2_4211, %e3_4212 = cute.get_leaves(%iter_4208) : !cute.int_tuple<"(?,?,?,?)">
      %1219 = cute.get_scalars(%e0_4209) : !cute.int_tuple<"?">
      %1220 = cute.get_scalars(%e1_4210) : !cute.int_tuple<"?">
      %1221 = cute.get_scalars(%e2_4211) : !cute.int_tuple<"?">
      %1222 = cute.get_scalars(%e3_4212) : !cute.int_tuple<"?">
      %int_tuple_4213 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4214 = cute.add_offset(%e3_4212, %int_tuple_4213) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1223 = cute.get_scalars(%tup_4214) : !cute.int_tuple<"?">
      %coord_4215 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4216 = cute.make_coord(%tup_4214) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1224 = cute.elem_less(%coord_4215, %coord_4216) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4217 = cute.get_layout(%1208) : !memref_rmem_f32_4
      %1225 = cute.get_shape(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4218, %e1_4219, %e2_4220, %e3_4221 = cute.get_leaves(%1225) : !cute.shape<"((2,2),(2,8))">
      %1226 = cute.get_stride(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4222, %e1_4223, %e2_4224, %e3_4225 = cute.get_leaves(%1226) : !cute.stride<"((2,4),(1,8))">
      %1227 = scf.if %1224 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1208) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,7)">
        cute.memref.store(%1208, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,7)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1208) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1208 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1208) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1208) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1208 : !memref_rmem_f32_4
      }
      %iter_4226 = cute.get_iter(%1227) : !memref_rmem_f32_4
      %lay_4227 = cute.get_layout(%1227) : !memref_rmem_f32_4
      %1228 = cute.get_shape(%lay_4227) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4228, %e1_4229, %e2_4230, %e3_4231 = cute.get_leaves(%1228) : !cute.shape<"((2,2),(2,8))">
      %1229 = cute.get_stride(%lay_4227) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4232, %e1_4233, %e2_4234, %e3_4235 = cute.get_leaves(%1229) : !cute.stride<"((2,4),(1,8))">
      %iter_4236 = cute.get_iter(%1227) : !memref_rmem_f32_4
      %iter_4237 = cute.get_iter(%1227) : !memref_rmem_f32_4
      %coord_4238 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4239 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4240 = cute.crd2idx(%coord_4238, %lay_4239) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4241 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4242 = cute.add_offset(%iter_4241, %idx_4240) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4243 = cute.make_view(%tup_4242) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4244 = cute.get_iter(%view_4243) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4245, %e1_4246, %e2_4247, %e3_4248 = cute.get_leaves(%iter_4244) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1230 = cute.get_scalars(%e0_4245) : !cute.int_tuple<"?">
      %1231 = cute.get_scalars(%e1_4246) : !cute.int_tuple<"?">
      %1232 = cute.get_scalars(%e2_4247) : !cute.int_tuple<"?">
      %1233 = cute.get_scalars(%e3_4248) : !cute.int_tuple<"?{div=2}">
      %iter_4249 = cute.get_iter(%view_4243) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4250, %e1_4251, %e2_4252, %e3_4253 = cute.get_leaves(%iter_4249) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1234 = cute.get_scalars(%e0_4250) : !cute.int_tuple<"?">
      %1235 = cute.get_scalars(%e1_4251) : !cute.int_tuple<"?">
      %1236 = cute.get_scalars(%e2_4252) : !cute.int_tuple<"?">
      %1237 = cute.get_scalars(%e3_4253) : !cute.int_tuple<"?{div=2}">
      %iter_4254 = cute.get_iter(%view_4243) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4255, %e1_4256, %e2_4257, %e3_4258 = cute.get_leaves(%iter_4254) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1238 = cute.get_scalars(%e0_4255) : !cute.int_tuple<"?">
      %1239 = cute.get_scalars(%e1_4256) : !cute.int_tuple<"?">
      %1240 = cute.get_scalars(%e2_4257) : !cute.int_tuple<"?">
      %1241 = cute.get_scalars(%e3_4258) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4259 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4260 = cute.add_offset(%e3_4258, %int_tuple_4259) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1242 = cute.get_scalars(%tup_4260) : !cute.int_tuple<"?">
      %coord_4261 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4262 = cute.make_coord(%tup_4260) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1243 = cute.elem_less(%coord_4261, %coord_4262) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4263 = cute.get_layout(%1227) : !memref_rmem_f32_4
      %1244 = cute.get_shape(%lay_4263) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4264, %e1_4265, %e2_4266, %e3_4267 = cute.get_leaves(%1244) : !cute.shape<"((2,2),(2,8))">
      %1245 = cute.get_stride(%lay_4263) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4268, %e1_4269, %e2_4270, %e3_4271 = cute.get_leaves(%1245) : !cute.stride<"((2,4),(1,8))">
      %1246 = scf.if %1243 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1227) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,8)">
        cute.memref.store(%1227, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,8)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1227) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1227 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1227) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1227) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1227 : !memref_rmem_f32_4
      }
      %iter_4272 = cute.get_iter(%1246) : !memref_rmem_f32_4
      %lay_4273 = cute.get_layout(%1246) : !memref_rmem_f32_4
      %1247 = cute.get_shape(%lay_4273) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4274, %e1_4275, %e2_4276, %e3_4277 = cute.get_leaves(%1247) : !cute.shape<"((2,2),(2,8))">
      %1248 = cute.get_stride(%lay_4273) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4278, %e1_4279, %e2_4280, %e3_4281 = cute.get_leaves(%1248) : !cute.stride<"((2,4),(1,8))">
      %iter_4282 = cute.get_iter(%1246) : !memref_rmem_f32_4
      %iter_4283 = cute.get_iter(%1246) : !memref_rmem_f32_4
      %coord_4284 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4285 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4286 = cute.crd2idx(%coord_4284, %lay_4285) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4287 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4288 = cute.add_offset(%iter_4287, %idx_4286) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4289 = cute.make_view(%tup_4288) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4290 = cute.get_iter(%view_4289) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4291, %e1_4292, %e2_4293, %e3_4294 = cute.get_leaves(%iter_4290) : !cute.int_tuple<"(?,?,?,?)">
      %1249 = cute.get_scalars(%e0_4291) : !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%e1_4292) : !cute.int_tuple<"?">
      %1251 = cute.get_scalars(%e2_4293) : !cute.int_tuple<"?">
      %1252 = cute.get_scalars(%e3_4294) : !cute.int_tuple<"?">
      %iter_4295 = cute.get_iter(%view_4289) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4296, %e1_4297, %e2_4298, %e3_4299 = cute.get_leaves(%iter_4295) : !cute.int_tuple<"(?,?,?,?)">
      %1253 = cute.get_scalars(%e0_4296) : !cute.int_tuple<"?">
      %1254 = cute.get_scalars(%e1_4297) : !cute.int_tuple<"?">
      %1255 = cute.get_scalars(%e2_4298) : !cute.int_tuple<"?">
      %1256 = cute.get_scalars(%e3_4299) : !cute.int_tuple<"?">
      %iter_4300 = cute.get_iter(%view_4289) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4301, %e1_4302, %e2_4303, %e3_4304 = cute.get_leaves(%iter_4300) : !cute.int_tuple<"(?,?,?,?)">
      %1257 = cute.get_scalars(%e0_4301) : !cute.int_tuple<"?">
      %1258 = cute.get_scalars(%e1_4302) : !cute.int_tuple<"?">
      %1259 = cute.get_scalars(%e2_4303) : !cute.int_tuple<"?">
      %1260 = cute.get_scalars(%e3_4304) : !cute.int_tuple<"?">
      %int_tuple_4305 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4306 = cute.add_offset(%e3_4304, %int_tuple_4305) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1261 = cute.get_scalars(%tup_4306) : !cute.int_tuple<"?">
      %coord_4307 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4308 = cute.make_coord(%tup_4306) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1262 = cute.elem_less(%coord_4307, %coord_4308) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4309 = cute.get_layout(%1246) : !memref_rmem_f32_4
      %1263 = cute.get_shape(%lay_4309) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4310, %e1_4311, %e2_4312, %e3_4313 = cute.get_leaves(%1263) : !cute.shape<"((2,2),(2,8))">
      %1264 = cute.get_stride(%lay_4309) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4314, %e1_4315, %e2_4316, %e3_4317 = cute.get_leaves(%1264) : !cute.stride<"((2,4),(1,8))">
      %1265 = scf.if %1262 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1246) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,9)">
        cute.memref.store(%1246, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,9)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1246) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1246 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1246) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1246) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1246 : !memref_rmem_f32_4
      }
      %iter_4318 = cute.get_iter(%1265) : !memref_rmem_f32_4
      %lay_4319 = cute.get_layout(%1265) : !memref_rmem_f32_4
      %1266 = cute.get_shape(%lay_4319) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4320, %e1_4321, %e2_4322, %e3_4323 = cute.get_leaves(%1266) : !cute.shape<"((2,2),(2,8))">
      %1267 = cute.get_stride(%lay_4319) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4324, %e1_4325, %e2_4326, %e3_4327 = cute.get_leaves(%1267) : !cute.stride<"((2,4),(1,8))">
      %iter_4328 = cute.get_iter(%1265) : !memref_rmem_f32_4
      %iter_4329 = cute.get_iter(%1265) : !memref_rmem_f32_4
      %coord_4330 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4331 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4332 = cute.crd2idx(%coord_4330, %lay_4331) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4333 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4334 = cute.add_offset(%iter_4333, %idx_4332) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4335 = cute.make_view(%tup_4334) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4336 = cute.get_iter(%view_4335) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4337, %e1_4338, %e2_4339, %e3_4340 = cute.get_leaves(%iter_4336) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1268 = cute.get_scalars(%e0_4337) : !cute.int_tuple<"?">
      %1269 = cute.get_scalars(%e1_4338) : !cute.int_tuple<"?">
      %1270 = cute.get_scalars(%e2_4339) : !cute.int_tuple<"?">
      %1271 = cute.get_scalars(%e3_4340) : !cute.int_tuple<"?{div=2}">
      %iter_4341 = cute.get_iter(%view_4335) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4342, %e1_4343, %e2_4344, %e3_4345 = cute.get_leaves(%iter_4341) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1272 = cute.get_scalars(%e0_4342) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e1_4343) : !cute.int_tuple<"?">
      %1274 = cute.get_scalars(%e2_4344) : !cute.int_tuple<"?">
      %1275 = cute.get_scalars(%e3_4345) : !cute.int_tuple<"?{div=2}">
      %iter_4346 = cute.get_iter(%view_4335) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4347, %e1_4348, %e2_4349, %e3_4350 = cute.get_leaves(%iter_4346) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1276 = cute.get_scalars(%e0_4347) : !cute.int_tuple<"?">
      %1277 = cute.get_scalars(%e1_4348) : !cute.int_tuple<"?">
      %1278 = cute.get_scalars(%e2_4349) : !cute.int_tuple<"?">
      %1279 = cute.get_scalars(%e3_4350) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4351 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4352 = cute.add_offset(%e3_4350, %int_tuple_4351) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1280 = cute.get_scalars(%tup_4352) : !cute.int_tuple<"?">
      %coord_4353 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4354 = cute.make_coord(%tup_4352) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1281 = cute.elem_less(%coord_4353, %coord_4354) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4355 = cute.get_layout(%1265) : !memref_rmem_f32_4
      %1282 = cute.get_shape(%lay_4355) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4356, %e1_4357, %e2_4358, %e3_4359 = cute.get_leaves(%1282) : !cute.shape<"((2,2),(2,8))">
      %1283 = cute.get_stride(%lay_4355) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4360, %e1_4361, %e2_4362, %e3_4363 = cute.get_leaves(%1283) : !cute.stride<"((2,4),(1,8))">
      %1284 = scf.if %1281 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1265) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,10)">
        cute.memref.store(%1265, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,10)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1265) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1265 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1265) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1265) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1265 : !memref_rmem_f32_4
      }
      %iter_4364 = cute.get_iter(%1284) : !memref_rmem_f32_4
      %lay_4365 = cute.get_layout(%1284) : !memref_rmem_f32_4
      %1285 = cute.get_shape(%lay_4365) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4366, %e1_4367, %e2_4368, %e3_4369 = cute.get_leaves(%1285) : !cute.shape<"((2,2),(2,8))">
      %1286 = cute.get_stride(%lay_4365) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4370, %e1_4371, %e2_4372, %e3_4373 = cute.get_leaves(%1286) : !cute.stride<"((2,4),(1,8))">
      %iter_4374 = cute.get_iter(%1284) : !memref_rmem_f32_4
      %iter_4375 = cute.get_iter(%1284) : !memref_rmem_f32_4
      %coord_4376 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4377 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4378 = cute.crd2idx(%coord_4376, %lay_4377) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4379 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4380 = cute.add_offset(%iter_4379, %idx_4378) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4381 = cute.make_view(%tup_4380) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4382 = cute.get_iter(%view_4381) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4383, %e1_4384, %e2_4385, %e3_4386 = cute.get_leaves(%iter_4382) : !cute.int_tuple<"(?,?,?,?)">
      %1287 = cute.get_scalars(%e0_4383) : !cute.int_tuple<"?">
      %1288 = cute.get_scalars(%e1_4384) : !cute.int_tuple<"?">
      %1289 = cute.get_scalars(%e2_4385) : !cute.int_tuple<"?">
      %1290 = cute.get_scalars(%e3_4386) : !cute.int_tuple<"?">
      %iter_4387 = cute.get_iter(%view_4381) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4388, %e1_4389, %e2_4390, %e3_4391 = cute.get_leaves(%iter_4387) : !cute.int_tuple<"(?,?,?,?)">
      %1291 = cute.get_scalars(%e0_4388) : !cute.int_tuple<"?">
      %1292 = cute.get_scalars(%e1_4389) : !cute.int_tuple<"?">
      %1293 = cute.get_scalars(%e2_4390) : !cute.int_tuple<"?">
      %1294 = cute.get_scalars(%e3_4391) : !cute.int_tuple<"?">
      %iter_4392 = cute.get_iter(%view_4381) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4393, %e1_4394, %e2_4395, %e3_4396 = cute.get_leaves(%iter_4392) : !cute.int_tuple<"(?,?,?,?)">
      %1295 = cute.get_scalars(%e0_4393) : !cute.int_tuple<"?">
      %1296 = cute.get_scalars(%e1_4394) : !cute.int_tuple<"?">
      %1297 = cute.get_scalars(%e2_4395) : !cute.int_tuple<"?">
      %1298 = cute.get_scalars(%e3_4396) : !cute.int_tuple<"?">
      %int_tuple_4397 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4398 = cute.add_offset(%e3_4396, %int_tuple_4397) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1299 = cute.get_scalars(%tup_4398) : !cute.int_tuple<"?">
      %coord_4399 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4400 = cute.make_coord(%tup_4398) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1300 = cute.elem_less(%coord_4399, %coord_4400) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4401 = cute.get_layout(%1284) : !memref_rmem_f32_4
      %1301 = cute.get_shape(%lay_4401) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4402, %e1_4403, %e2_4404, %e3_4405 = cute.get_leaves(%1301) : !cute.shape<"((2,2),(2,8))">
      %1302 = cute.get_stride(%lay_4401) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4406, %e1_4407, %e2_4408, %e3_4409 = cute.get_leaves(%1302) : !cute.stride<"((2,4),(1,8))">
      %1303 = scf.if %1300 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1284) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,11)">
        cute.memref.store(%1284, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,11)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1284) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1284 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1284) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1284) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1284 : !memref_rmem_f32_4
      }
      %iter_4410 = cute.get_iter(%1303) : !memref_rmem_f32_4
      %lay_4411 = cute.get_layout(%1303) : !memref_rmem_f32_4
      %1304 = cute.get_shape(%lay_4411) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4412, %e1_4413, %e2_4414, %e3_4415 = cute.get_leaves(%1304) : !cute.shape<"((2,2),(2,8))">
      %1305 = cute.get_stride(%lay_4411) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4416, %e1_4417, %e2_4418, %e3_4419 = cute.get_leaves(%1305) : !cute.stride<"((2,4),(1,8))">
      %iter_4420 = cute.get_iter(%1303) : !memref_rmem_f32_4
      %iter_4421 = cute.get_iter(%1303) : !memref_rmem_f32_4
      %coord_4422 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4423 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4424 = cute.crd2idx(%coord_4422, %lay_4423) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4425 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4426 = cute.add_offset(%iter_4425, %idx_4424) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4427 = cute.make_view(%tup_4426) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4428 = cute.get_iter(%view_4427) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4429, %e1_4430, %e2_4431, %e3_4432 = cute.get_leaves(%iter_4428) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1306 = cute.get_scalars(%e0_4429) : !cute.int_tuple<"?">
      %1307 = cute.get_scalars(%e1_4430) : !cute.int_tuple<"?">
      %1308 = cute.get_scalars(%e2_4431) : !cute.int_tuple<"?">
      %1309 = cute.get_scalars(%e3_4432) : !cute.int_tuple<"?{div=2}">
      %iter_4433 = cute.get_iter(%view_4427) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4434, %e1_4435, %e2_4436, %e3_4437 = cute.get_leaves(%iter_4433) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1310 = cute.get_scalars(%e0_4434) : !cute.int_tuple<"?">
      %1311 = cute.get_scalars(%e1_4435) : !cute.int_tuple<"?">
      %1312 = cute.get_scalars(%e2_4436) : !cute.int_tuple<"?">
      %1313 = cute.get_scalars(%e3_4437) : !cute.int_tuple<"?{div=2}">
      %iter_4438 = cute.get_iter(%view_4427) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4439, %e1_4440, %e2_4441, %e3_4442 = cute.get_leaves(%iter_4438) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1314 = cute.get_scalars(%e0_4439) : !cute.int_tuple<"?">
      %1315 = cute.get_scalars(%e1_4440) : !cute.int_tuple<"?">
      %1316 = cute.get_scalars(%e2_4441) : !cute.int_tuple<"?">
      %1317 = cute.get_scalars(%e3_4442) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4443 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4444 = cute.add_offset(%e3_4442, %int_tuple_4443) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1318 = cute.get_scalars(%tup_4444) : !cute.int_tuple<"?">
      %coord_4445 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4446 = cute.make_coord(%tup_4444) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1319 = cute.elem_less(%coord_4445, %coord_4446) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4447 = cute.get_layout(%1303) : !memref_rmem_f32_4
      %1320 = cute.get_shape(%lay_4447) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4448, %e1_4449, %e2_4450, %e3_4451 = cute.get_leaves(%1320) : !cute.shape<"((2,2),(2,8))">
      %1321 = cute.get_stride(%lay_4447) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4452, %e1_4453, %e2_4454, %e3_4455 = cute.get_leaves(%1321) : !cute.stride<"((2,4),(1,8))">
      %1322 = scf.if %1319 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1303) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,12)">
        cute.memref.store(%1303, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,12)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1303) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1303 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1303) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1303) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1303 : !memref_rmem_f32_4
      }
      %iter_4456 = cute.get_iter(%1322) : !memref_rmem_f32_4
      %lay_4457 = cute.get_layout(%1322) : !memref_rmem_f32_4
      %1323 = cute.get_shape(%lay_4457) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4458, %e1_4459, %e2_4460, %e3_4461 = cute.get_leaves(%1323) : !cute.shape<"((2,2),(2,8))">
      %1324 = cute.get_stride(%lay_4457) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4462, %e1_4463, %e2_4464, %e3_4465 = cute.get_leaves(%1324) : !cute.stride<"((2,4),(1,8))">
      %iter_4466 = cute.get_iter(%1322) : !memref_rmem_f32_4
      %iter_4467 = cute.get_iter(%1322) : !memref_rmem_f32_4
      %coord_4468 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_4469 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4470 = cute.crd2idx(%coord_4468, %lay_4469) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_4471 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4472 = cute.add_offset(%iter_4471, %idx_4470) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4473 = cute.make_view(%tup_4472) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4474 = cute.get_iter(%view_4473) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4475, %e1_4476, %e2_4477, %e3_4478 = cute.get_leaves(%iter_4474) : !cute.int_tuple<"(?,?,?,?)">
      %1325 = cute.get_scalars(%e0_4475) : !cute.int_tuple<"?">
      %1326 = cute.get_scalars(%e1_4476) : !cute.int_tuple<"?">
      %1327 = cute.get_scalars(%e2_4477) : !cute.int_tuple<"?">
      %1328 = cute.get_scalars(%e3_4478) : !cute.int_tuple<"?">
      %iter_4479 = cute.get_iter(%view_4473) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4480, %e1_4481, %e2_4482, %e3_4483 = cute.get_leaves(%iter_4479) : !cute.int_tuple<"(?,?,?,?)">
      %1329 = cute.get_scalars(%e0_4480) : !cute.int_tuple<"?">
      %1330 = cute.get_scalars(%e1_4481) : !cute.int_tuple<"?">
      %1331 = cute.get_scalars(%e2_4482) : !cute.int_tuple<"?">
      %1332 = cute.get_scalars(%e3_4483) : !cute.int_tuple<"?">
      %iter_4484 = cute.get_iter(%view_4473) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4485, %e1_4486, %e2_4487, %e3_4488 = cute.get_leaves(%iter_4484) : !cute.int_tuple<"(?,?,?,?)">
      %1333 = cute.get_scalars(%e0_4485) : !cute.int_tuple<"?">
      %1334 = cute.get_scalars(%e1_4486) : !cute.int_tuple<"?">
      %1335 = cute.get_scalars(%e2_4487) : !cute.int_tuple<"?">
      %1336 = cute.get_scalars(%e3_4488) : !cute.int_tuple<"?">
      %int_tuple_4489 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4490 = cute.add_offset(%e3_4488, %int_tuple_4489) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1337 = cute.get_scalars(%tup_4490) : !cute.int_tuple<"?">
      %coord_4491 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4492 = cute.make_coord(%tup_4490) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1338 = cute.elem_less(%coord_4491, %coord_4492) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4493 = cute.get_layout(%1322) : !memref_rmem_f32_4
      %1339 = cute.get_shape(%lay_4493) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4494, %e1_4495, %e2_4496, %e3_4497 = cute.get_leaves(%1339) : !cute.shape<"((2,2),(2,8))">
      %1340 = cute.get_stride(%lay_4493) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4498, %e1_4499, %e2_4500, %e3_4501 = cute.get_leaves(%1340) : !cute.stride<"((2,4),(1,8))">
      %1341 = scf.if %1338 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1322) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,13)">
        cute.memref.store(%1322, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,13)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1322) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1322 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1322) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1322) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1322 : !memref_rmem_f32_4
      }
      %iter_4502 = cute.get_iter(%1341) : !memref_rmem_f32_4
      %lay_4503 = cute.get_layout(%1341) : !memref_rmem_f32_4
      %1342 = cute.get_shape(%lay_4503) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4504, %e1_4505, %e2_4506, %e3_4507 = cute.get_leaves(%1342) : !cute.shape<"((2,2),(2,8))">
      %1343 = cute.get_stride(%lay_4503) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4508, %e1_4509, %e2_4510, %e3_4511 = cute.get_leaves(%1343) : !cute.stride<"((2,4),(1,8))">
      %iter_4512 = cute.get_iter(%1341) : !memref_rmem_f32_4
      %iter_4513 = cute.get_iter(%1341) : !memref_rmem_f32_4
      %coord_4514 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_4515 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4516 = cute.crd2idx(%coord_4514, %lay_4515) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_4517 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4518 = cute.add_offset(%iter_4517, %idx_4516) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4519 = cute.make_view(%tup_4518) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4520 = cute.get_iter(%view_4519) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4521, %e1_4522, %e2_4523, %e3_4524 = cute.get_leaves(%iter_4520) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1344 = cute.get_scalars(%e0_4521) : !cute.int_tuple<"?">
      %1345 = cute.get_scalars(%e1_4522) : !cute.int_tuple<"?">
      %1346 = cute.get_scalars(%e2_4523) : !cute.int_tuple<"?">
      %1347 = cute.get_scalars(%e3_4524) : !cute.int_tuple<"?{div=2}">
      %iter_4525 = cute.get_iter(%view_4519) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4526, %e1_4527, %e2_4528, %e3_4529 = cute.get_leaves(%iter_4525) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1348 = cute.get_scalars(%e0_4526) : !cute.int_tuple<"?">
      %1349 = cute.get_scalars(%e1_4527) : !cute.int_tuple<"?">
      %1350 = cute.get_scalars(%e2_4528) : !cute.int_tuple<"?">
      %1351 = cute.get_scalars(%e3_4529) : !cute.int_tuple<"?{div=2}">
      %iter_4530 = cute.get_iter(%view_4519) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4531, %e1_4532, %e2_4533, %e3_4534 = cute.get_leaves(%iter_4530) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1352 = cute.get_scalars(%e0_4531) : !cute.int_tuple<"?">
      %1353 = cute.get_scalars(%e1_4532) : !cute.int_tuple<"?">
      %1354 = cute.get_scalars(%e2_4533) : !cute.int_tuple<"?">
      %1355 = cute.get_scalars(%e3_4534) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4535 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4536 = cute.add_offset(%e3_4534, %int_tuple_4535) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1356 = cute.get_scalars(%tup_4536) : !cute.int_tuple<"?">
      %coord_4537 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4538 = cute.make_coord(%tup_4536) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1357 = cute.elem_less(%coord_4537, %coord_4538) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4539 = cute.get_layout(%1341) : !memref_rmem_f32_4
      %1358 = cute.get_shape(%lay_4539) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4540, %e1_4541, %e2_4542, %e3_4543 = cute.get_leaves(%1358) : !cute.shape<"((2,2),(2,8))">
      %1359 = cute.get_stride(%lay_4539) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4544, %e1_4545, %e2_4546, %e3_4547 = cute.get_leaves(%1359) : !cute.stride<"((2,4),(1,8))">
      %1360 = scf.if %1357 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1341) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,14)">
        cute.memref.store(%1341, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,14)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1341) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1341 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1341) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1341) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1341 : !memref_rmem_f32_4
      }
      %iter_4548 = cute.get_iter(%1360) : !memref_rmem_f32_4
      %lay_4549 = cute.get_layout(%1360) : !memref_rmem_f32_4
      %1361 = cute.get_shape(%lay_4549) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4550, %e1_4551, %e2_4552, %e3_4553 = cute.get_leaves(%1361) : !cute.shape<"((2,2),(2,8))">
      %1362 = cute.get_stride(%lay_4549) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4554, %e1_4555, %e2_4556, %e3_4557 = cute.get_leaves(%1362) : !cute.stride<"((2,4),(1,8))">
      %iter_4558 = cute.get_iter(%1360) : !memref_rmem_f32_4
      %iter_4559 = cute.get_iter(%1360) : !memref_rmem_f32_4
      %coord_4560 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_4561 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4562 = cute.crd2idx(%coord_4560, %lay_4561) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_4563 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4564 = cute.add_offset(%iter_4563, %idx_4562) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4565 = cute.make_view(%tup_4564) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4566 = cute.get_iter(%view_4565) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4567, %e1_4568, %e2_4569, %e3_4570 = cute.get_leaves(%iter_4566) : !cute.int_tuple<"(?,?,?,?)">
      %1363 = cute.get_scalars(%e0_4567) : !cute.int_tuple<"?">
      %1364 = cute.get_scalars(%e1_4568) : !cute.int_tuple<"?">
      %1365 = cute.get_scalars(%e2_4569) : !cute.int_tuple<"?">
      %1366 = cute.get_scalars(%e3_4570) : !cute.int_tuple<"?">
      %iter_4571 = cute.get_iter(%view_4565) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4572, %e1_4573, %e2_4574, %e3_4575 = cute.get_leaves(%iter_4571) : !cute.int_tuple<"(?,?,?,?)">
      %1367 = cute.get_scalars(%e0_4572) : !cute.int_tuple<"?">
      %1368 = cute.get_scalars(%e1_4573) : !cute.int_tuple<"?">
      %1369 = cute.get_scalars(%e2_4574) : !cute.int_tuple<"?">
      %1370 = cute.get_scalars(%e3_4575) : !cute.int_tuple<"?">
      %iter_4576 = cute.get_iter(%view_4565) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4577, %e1_4578, %e2_4579, %e3_4580 = cute.get_leaves(%iter_4576) : !cute.int_tuple<"(?,?,?,?)">
      %1371 = cute.get_scalars(%e0_4577) : !cute.int_tuple<"?">
      %1372 = cute.get_scalars(%e1_4578) : !cute.int_tuple<"?">
      %1373 = cute.get_scalars(%e2_4579) : !cute.int_tuple<"?">
      %1374 = cute.get_scalars(%e3_4580) : !cute.int_tuple<"?">
      %int_tuple_4581 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4582 = cute.add_offset(%e3_4580, %int_tuple_4581) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1375 = cute.get_scalars(%tup_4582) : !cute.int_tuple<"?">
      %coord_4583 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4584 = cute.make_coord(%tup_4582) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1376 = cute.elem_less(%coord_4583, %coord_4584) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4585 = cute.get_layout(%1360) : !memref_rmem_f32_4
      %1377 = cute.get_shape(%lay_4585) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4586, %e1_4587, %e2_4588, %e3_4589 = cute.get_leaves(%1377) : !cute.shape<"((2,2),(2,8))">
      %1378 = cute.get_stride(%lay_4585) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4590, %e1_4591, %e2_4592, %e3_4593 = cute.get_leaves(%1378) : !cute.stride<"((2,4),(1,8))">
      %1379 = scf.if %1376 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1360) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(1,15)">
        cute.memref.store(%1360, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(1,15)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1360) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1360 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1360) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1360) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1360 : !memref_rmem_f32_4
      }
      %iter_4594 = cute.get_iter(%1379) : !memref_rmem_f32_4
      %lay_4595 = cute.get_layout(%1379) : !memref_rmem_f32_4
      %1380 = cute.get_shape(%lay_4595) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4596, %e1_4597, %e2_4598, %e3_4599 = cute.get_leaves(%1380) : !cute.shape<"((2,2),(2,8))">
      %1381 = cute.get_stride(%lay_4595) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4600, %e1_4601, %e2_4602, %e3_4603 = cute.get_leaves(%1381) : !cute.stride<"((2,4),(1,8))">
      %iter_4604 = cute.get_iter(%1379) : !memref_rmem_f32_4
      %iter_4605 = cute.get_iter(%1379) : !memref_rmem_f32_4
      %coord_4606 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_4607 = cute.get_layout(%1379) : !memref_rmem_f32_4
      %idx_4608 = cute.crd2idx(%coord_4606, %lay_4607) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_4609 = cute.get_iter(%1379) : !memref_rmem_f32_4
      %ptr_4610 = cute.add_offset(%iter_4609, %idx_4608) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_4611 = cute.make_view(%ptr_4610) : !memref_rmem_f32_7
      %iter_4612 = cute.get_iter(%view_4611) : !memref_rmem_f32_7
      %iter_4613 = cute.get_iter(%view_4611) : !memref_rmem_f32_7
      %lay_4614 = cute.get_layout(%view_4611) : !memref_rmem_f32_7
      %1382 = cute.get_shape(%lay_4614) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4615, %e1_4616 = cute.get_leaves(%1382) : !cute.shape<"((2,8))">
      %1383 = cute.memref.load_vec %view_4611 : !memref_rmem_f32_7
      %cst_4617 = arith.constant 0xFF800000 : f32
      %1384 = vector.reduction <maximumf>, %1383, %cst_4617 : vector<16xf32> into f32
      %c-1_i32_4618 = arith.constant -1 : i32
      %c2_i32_4619 = arith.constant 2 : i32
      %c31_i32_4620 = arith.constant 31 : i32
      %1385 = nvvm.shfl.sync  bfly %c-1_i32_4618, %1384, %c2_i32_4619, %c31_i32_4620 : f32 -> f32
      %1386 = nvvm.fmax %1384, %1385
      %c-1_i32_4621 = arith.constant -1 : i32
      %c1_i32_4622 = arith.constant 1 : i32
      %c31_i32_4623 = arith.constant 31 : i32
      %1387 = nvvm.shfl.sync  bfly %c-1_i32_4621, %1386, %c1_i32_4622, %c31_i32_4623 : f32 -> f32
      %1388 = nvvm.fmax %1386, %1387
      %1389 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1390 = arith.mulf %1383, %1389 : vector<16xf32>
      %1391 = arith.mulf %1388, %arg4 : f32
      %1392 = vector.broadcast %1391 : f32 to vector<16xf32>
      %1393 = arith.subf %1390, %1392 : vector<16xf32>
      %1394 = math.exp2 %1393 fastmath<fast> : vector<16xf32>
      %cst_4624 = arith.constant 0.000000e+00 : f32
      %1395 = vector.reduction <add>, %1394, %cst_4624 : vector<16xf32> into f32
      %coord_4625 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1075, %coord_4625, %1388) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_4626 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1080, %coord_4626, %1395) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_4627 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_4628 = cute.get_layout(%1379) : !memref_rmem_f32_4
      %idx_4629 = cute.crd2idx(%coord_4627, %lay_4628) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_4630 = cute.get_iter(%1379) : !memref_rmem_f32_4
      %ptr_4631 = cute.add_offset(%iter_4630, %idx_4629) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_4632 = cute.make_view(%ptr_4631) : !memref_rmem_f32_7
      %iter_4633 = cute.get_iter(%view_4632) : !memref_rmem_f32_7
      %iter_4634 = cute.get_iter(%view_4632) : !memref_rmem_f32_7
      %lay_4635 = cute.get_layout(%view_4632) : !memref_rmem_f32_7
      %1396 = cute.get_shape(%lay_4635) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4636, %e1_4637 = cute.get_leaves(%1396) : !cute.shape<"((2,8))">
      %int_tuple_4638 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4639 = cute.size(%int_tuple_4638) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4640 = cute.get_leaves(%sz_4639) : !cute.int_tuple<"16">
      %int_tuple_4641 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4642 = cute.size(%int_tuple_4641) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4643 = cute.get_leaves(%sz_4642) : !cute.int_tuple<"16">
      cute.memref.store_vec %1394, %view_4632 : !memref_rmem_f32_7
      %int_tuple_4644 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_4645 = cute.size(%int_tuple_4644) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_4646 = cute.get_leaves(%sz_4645) : !cute.int_tuple<"16">
      %coord_4647 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_4648 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4649 = cute.crd2idx(%coord_4647, %lay_4648) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_4650 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4651 = cute.add_offset(%iter_4650, %idx_4649) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4652 = cute.make_view(%tup_4651) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4653 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4654, %e1_4655, %e2_4656, %e3_4657 = cute.get_leaves(%iter_4653) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1397 = cute.get_scalars(%e0_4654) : !cute.int_tuple<"?">
      %1398 = cute.get_scalars(%e1_4655) : !cute.int_tuple<"?">
      %1399 = cute.get_scalars(%e2_4656) : !cute.int_tuple<"?">
      %1400 = cute.get_scalars(%e3_4657) : !cute.int_tuple<"?{div=2}">
      %iter_4658 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4659, %e1_4660, %e2_4661, %e3_4662 = cute.get_leaves(%iter_4658) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1401 = cute.get_scalars(%e0_4659) : !cute.int_tuple<"?">
      %1402 = cute.get_scalars(%e1_4660) : !cute.int_tuple<"?">
      %1403 = cute.get_scalars(%e2_4661) : !cute.int_tuple<"?">
      %1404 = cute.get_scalars(%e3_4662) : !cute.int_tuple<"?{div=2}">
      %iter_4663 = cute.get_iter(%view_4652) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4664, %e1_4665, %e2_4666, %e3_4667 = cute.get_leaves(%iter_4663) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1405 = cute.get_scalars(%e0_4664) : !cute.int_tuple<"?">
      %1406 = cute.get_scalars(%e1_4665) : !cute.int_tuple<"?">
      %1407 = cute.get_scalars(%e2_4666) : !cute.int_tuple<"?">
      %1408 = cute.get_scalars(%e3_4667) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4668 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4669 = cute.add_offset(%e3_4667, %int_tuple_4668) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1409 = cute.get_scalars(%tup_4669) : !cute.int_tuple<"?">
      %coord_4670 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4671 = cute.make_coord(%tup_4669) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1410 = cute.elem_less(%coord_4670, %coord_4671) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4672 = cute.get_layout(%1379) : !memref_rmem_f32_4
      %1411 = cute.get_shape(%lay_4672) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4673, %e1_4674, %e2_4675, %e3_4676 = cute.get_leaves(%1411) : !cute.shape<"((2,2),(2,8))">
      %1412 = cute.get_stride(%lay_4672) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4677, %e1_4678, %e2_4679, %e3_4680 = cute.get_leaves(%1412) : !cute.stride<"((2,4),(1,8))">
      %1413 = scf.if %1410 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1379) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,0)">
        cute.memref.store(%1379, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,0)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1379) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1379 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1379) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1379) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1379 : !memref_rmem_f32_4
      }
      %iter_4681 = cute.get_iter(%1413) : !memref_rmem_f32_4
      %lay_4682 = cute.get_layout(%1413) : !memref_rmem_f32_4
      %1414 = cute.get_shape(%lay_4682) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4683, %e1_4684, %e2_4685, %e3_4686 = cute.get_leaves(%1414) : !cute.shape<"((2,2),(2,8))">
      %1415 = cute.get_stride(%lay_4682) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4687, %e1_4688, %e2_4689, %e3_4690 = cute.get_leaves(%1415) : !cute.stride<"((2,4),(1,8))">
      %iter_4691 = cute.get_iter(%1413) : !memref_rmem_f32_4
      %iter_4692 = cute.get_iter(%1413) : !memref_rmem_f32_4
      %coord_4693 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_4694 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4695 = cute.crd2idx(%coord_4693, %lay_4694) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_4696 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4697 = cute.add_offset(%iter_4696, %idx_4695) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4698 = cute.make_view(%tup_4697) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4699 = cute.get_iter(%view_4698) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4700, %e1_4701, %e2_4702, %e3_4703 = cute.get_leaves(%iter_4699) : !cute.int_tuple<"(?,?,?,?)">
      %1416 = cute.get_scalars(%e0_4700) : !cute.int_tuple<"?">
      %1417 = cute.get_scalars(%e1_4701) : !cute.int_tuple<"?">
      %1418 = cute.get_scalars(%e2_4702) : !cute.int_tuple<"?">
      %1419 = cute.get_scalars(%e3_4703) : !cute.int_tuple<"?">
      %iter_4704 = cute.get_iter(%view_4698) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4705, %e1_4706, %e2_4707, %e3_4708 = cute.get_leaves(%iter_4704) : !cute.int_tuple<"(?,?,?,?)">
      %1420 = cute.get_scalars(%e0_4705) : !cute.int_tuple<"?">
      %1421 = cute.get_scalars(%e1_4706) : !cute.int_tuple<"?">
      %1422 = cute.get_scalars(%e2_4707) : !cute.int_tuple<"?">
      %1423 = cute.get_scalars(%e3_4708) : !cute.int_tuple<"?">
      %iter_4709 = cute.get_iter(%view_4698) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4710, %e1_4711, %e2_4712, %e3_4713 = cute.get_leaves(%iter_4709) : !cute.int_tuple<"(?,?,?,?)">
      %1424 = cute.get_scalars(%e0_4710) : !cute.int_tuple<"?">
      %1425 = cute.get_scalars(%e1_4711) : !cute.int_tuple<"?">
      %1426 = cute.get_scalars(%e2_4712) : !cute.int_tuple<"?">
      %1427 = cute.get_scalars(%e3_4713) : !cute.int_tuple<"?">
      %int_tuple_4714 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4715 = cute.add_offset(%e3_4713, %int_tuple_4714) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1428 = cute.get_scalars(%tup_4715) : !cute.int_tuple<"?">
      %coord_4716 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4717 = cute.make_coord(%tup_4715) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1429 = cute.elem_less(%coord_4716, %coord_4717) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4718 = cute.get_layout(%1413) : !memref_rmem_f32_4
      %1430 = cute.get_shape(%lay_4718) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4719, %e1_4720, %e2_4721, %e3_4722 = cute.get_leaves(%1430) : !cute.shape<"((2,2),(2,8))">
      %1431 = cute.get_stride(%lay_4718) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4723, %e1_4724, %e2_4725, %e3_4726 = cute.get_leaves(%1431) : !cute.stride<"((2,4),(1,8))">
      %1432 = scf.if %1429 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1413) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,1)">
        cute.memref.store(%1413, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,1)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1413) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1413 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1413) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1413) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1413 : !memref_rmem_f32_4
      }
      %iter_4727 = cute.get_iter(%1432) : !memref_rmem_f32_4
      %lay_4728 = cute.get_layout(%1432) : !memref_rmem_f32_4
      %1433 = cute.get_shape(%lay_4728) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4729, %e1_4730, %e2_4731, %e3_4732 = cute.get_leaves(%1433) : !cute.shape<"((2,2),(2,8))">
      %1434 = cute.get_stride(%lay_4728) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4733, %e1_4734, %e2_4735, %e3_4736 = cute.get_leaves(%1434) : !cute.stride<"((2,4),(1,8))">
      %iter_4737 = cute.get_iter(%1432) : !memref_rmem_f32_4
      %iter_4738 = cute.get_iter(%1432) : !memref_rmem_f32_4
      %coord_4739 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_4740 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4741 = cute.crd2idx(%coord_4739, %lay_4740) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_4742 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4743 = cute.add_offset(%iter_4742, %idx_4741) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4744 = cute.make_view(%tup_4743) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4745 = cute.get_iter(%view_4744) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4746, %e1_4747, %e2_4748, %e3_4749 = cute.get_leaves(%iter_4745) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1435 = cute.get_scalars(%e0_4746) : !cute.int_tuple<"?">
      %1436 = cute.get_scalars(%e1_4747) : !cute.int_tuple<"?">
      %1437 = cute.get_scalars(%e2_4748) : !cute.int_tuple<"?">
      %1438 = cute.get_scalars(%e3_4749) : !cute.int_tuple<"?{div=2}">
      %iter_4750 = cute.get_iter(%view_4744) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4751, %e1_4752, %e2_4753, %e3_4754 = cute.get_leaves(%iter_4750) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1439 = cute.get_scalars(%e0_4751) : !cute.int_tuple<"?">
      %1440 = cute.get_scalars(%e1_4752) : !cute.int_tuple<"?">
      %1441 = cute.get_scalars(%e2_4753) : !cute.int_tuple<"?">
      %1442 = cute.get_scalars(%e3_4754) : !cute.int_tuple<"?{div=2}">
      %iter_4755 = cute.get_iter(%view_4744) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4756, %e1_4757, %e2_4758, %e3_4759 = cute.get_leaves(%iter_4755) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1443 = cute.get_scalars(%e0_4756) : !cute.int_tuple<"?">
      %1444 = cute.get_scalars(%e1_4757) : !cute.int_tuple<"?">
      %1445 = cute.get_scalars(%e2_4758) : !cute.int_tuple<"?">
      %1446 = cute.get_scalars(%e3_4759) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4760 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4761 = cute.add_offset(%e3_4759, %int_tuple_4760) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1447 = cute.get_scalars(%tup_4761) : !cute.int_tuple<"?">
      %coord_4762 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4763 = cute.make_coord(%tup_4761) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1448 = cute.elem_less(%coord_4762, %coord_4763) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4764 = cute.get_layout(%1432) : !memref_rmem_f32_4
      %1449 = cute.get_shape(%lay_4764) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4765, %e1_4766, %e2_4767, %e3_4768 = cute.get_leaves(%1449) : !cute.shape<"((2,2),(2,8))">
      %1450 = cute.get_stride(%lay_4764) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4769, %e1_4770, %e2_4771, %e3_4772 = cute.get_leaves(%1450) : !cute.stride<"((2,4),(1,8))">
      %1451 = scf.if %1448 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1432) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,2)">
        cute.memref.store(%1432, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,2)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1432) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1432 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1432) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1432) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1432 : !memref_rmem_f32_4
      }
      %iter_4773 = cute.get_iter(%1451) : !memref_rmem_f32_4
      %lay_4774 = cute.get_layout(%1451) : !memref_rmem_f32_4
      %1452 = cute.get_shape(%lay_4774) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4775, %e1_4776, %e2_4777, %e3_4778 = cute.get_leaves(%1452) : !cute.shape<"((2,2),(2,8))">
      %1453 = cute.get_stride(%lay_4774) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4779, %e1_4780, %e2_4781, %e3_4782 = cute.get_leaves(%1453) : !cute.stride<"((2,4),(1,8))">
      %iter_4783 = cute.get_iter(%1451) : !memref_rmem_f32_4
      %iter_4784 = cute.get_iter(%1451) : !memref_rmem_f32_4
      %coord_4785 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_4786 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4787 = cute.crd2idx(%coord_4785, %lay_4786) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_4788 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4789 = cute.add_offset(%iter_4788, %idx_4787) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4790 = cute.make_view(%tup_4789) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4791 = cute.get_iter(%view_4790) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4792, %e1_4793, %e2_4794, %e3_4795 = cute.get_leaves(%iter_4791) : !cute.int_tuple<"(?,?,?,?)">
      %1454 = cute.get_scalars(%e0_4792) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e1_4793) : !cute.int_tuple<"?">
      %1456 = cute.get_scalars(%e2_4794) : !cute.int_tuple<"?">
      %1457 = cute.get_scalars(%e3_4795) : !cute.int_tuple<"?">
      %iter_4796 = cute.get_iter(%view_4790) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4797, %e1_4798, %e2_4799, %e3_4800 = cute.get_leaves(%iter_4796) : !cute.int_tuple<"(?,?,?,?)">
      %1458 = cute.get_scalars(%e0_4797) : !cute.int_tuple<"?">
      %1459 = cute.get_scalars(%e1_4798) : !cute.int_tuple<"?">
      %1460 = cute.get_scalars(%e2_4799) : !cute.int_tuple<"?">
      %1461 = cute.get_scalars(%e3_4800) : !cute.int_tuple<"?">
      %iter_4801 = cute.get_iter(%view_4790) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4802, %e1_4803, %e2_4804, %e3_4805 = cute.get_leaves(%iter_4801) : !cute.int_tuple<"(?,?,?,?)">
      %1462 = cute.get_scalars(%e0_4802) : !cute.int_tuple<"?">
      %1463 = cute.get_scalars(%e1_4803) : !cute.int_tuple<"?">
      %1464 = cute.get_scalars(%e2_4804) : !cute.int_tuple<"?">
      %1465 = cute.get_scalars(%e3_4805) : !cute.int_tuple<"?">
      %int_tuple_4806 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4807 = cute.add_offset(%e3_4805, %int_tuple_4806) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1466 = cute.get_scalars(%tup_4807) : !cute.int_tuple<"?">
      %coord_4808 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4809 = cute.make_coord(%tup_4807) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1467 = cute.elem_less(%coord_4808, %coord_4809) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4810 = cute.get_layout(%1451) : !memref_rmem_f32_4
      %1468 = cute.get_shape(%lay_4810) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4811, %e1_4812, %e2_4813, %e3_4814 = cute.get_leaves(%1468) : !cute.shape<"((2,2),(2,8))">
      %1469 = cute.get_stride(%lay_4810) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4815, %e1_4816, %e2_4817, %e3_4818 = cute.get_leaves(%1469) : !cute.stride<"((2,4),(1,8))">
      %1470 = scf.if %1467 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1451) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,3)">
        cute.memref.store(%1451, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,3)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1451) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1451 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1451) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1451) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1451 : !memref_rmem_f32_4
      }
      %iter_4819 = cute.get_iter(%1470) : !memref_rmem_f32_4
      %lay_4820 = cute.get_layout(%1470) : !memref_rmem_f32_4
      %1471 = cute.get_shape(%lay_4820) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4821, %e1_4822, %e2_4823, %e3_4824 = cute.get_leaves(%1471) : !cute.shape<"((2,2),(2,8))">
      %1472 = cute.get_stride(%lay_4820) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4825, %e1_4826, %e2_4827, %e3_4828 = cute.get_leaves(%1472) : !cute.stride<"((2,4),(1,8))">
      %iter_4829 = cute.get_iter(%1470) : !memref_rmem_f32_4
      %iter_4830 = cute.get_iter(%1470) : !memref_rmem_f32_4
      %coord_4831 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_4832 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4833 = cute.crd2idx(%coord_4831, %lay_4832) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_4834 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4835 = cute.add_offset(%iter_4834, %idx_4833) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4836 = cute.make_view(%tup_4835) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4837 = cute.get_iter(%view_4836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4838, %e1_4839, %e2_4840, %e3_4841 = cute.get_leaves(%iter_4837) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1473 = cute.get_scalars(%e0_4838) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e1_4839) : !cute.int_tuple<"?">
      %1475 = cute.get_scalars(%e2_4840) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e3_4841) : !cute.int_tuple<"?{div=2}">
      %iter_4842 = cute.get_iter(%view_4836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4843, %e1_4844, %e2_4845, %e3_4846 = cute.get_leaves(%iter_4842) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1477 = cute.get_scalars(%e0_4843) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e1_4844) : !cute.int_tuple<"?">
      %1479 = cute.get_scalars(%e2_4845) : !cute.int_tuple<"?">
      %1480 = cute.get_scalars(%e3_4846) : !cute.int_tuple<"?{div=2}">
      %iter_4847 = cute.get_iter(%view_4836) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4848, %e1_4849, %e2_4850, %e3_4851 = cute.get_leaves(%iter_4847) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1481 = cute.get_scalars(%e0_4848) : !cute.int_tuple<"?">
      %1482 = cute.get_scalars(%e1_4849) : !cute.int_tuple<"?">
      %1483 = cute.get_scalars(%e2_4850) : !cute.int_tuple<"?">
      %1484 = cute.get_scalars(%e3_4851) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4852 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4853 = cute.add_offset(%e3_4851, %int_tuple_4852) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1485 = cute.get_scalars(%tup_4853) : !cute.int_tuple<"?">
      %coord_4854 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4855 = cute.make_coord(%tup_4853) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1486 = cute.elem_less(%coord_4854, %coord_4855) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4856 = cute.get_layout(%1470) : !memref_rmem_f32_4
      %1487 = cute.get_shape(%lay_4856) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4857, %e1_4858, %e2_4859, %e3_4860 = cute.get_leaves(%1487) : !cute.shape<"((2,2),(2,8))">
      %1488 = cute.get_stride(%lay_4856) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4861, %e1_4862, %e2_4863, %e3_4864 = cute.get_leaves(%1488) : !cute.stride<"((2,4),(1,8))">
      %1489 = scf.if %1486 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1470) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,4)">
        cute.memref.store(%1470, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,4)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1470) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1470 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1470) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1470) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1470 : !memref_rmem_f32_4
      }
      %iter_4865 = cute.get_iter(%1489) : !memref_rmem_f32_4
      %lay_4866 = cute.get_layout(%1489) : !memref_rmem_f32_4
      %1490 = cute.get_shape(%lay_4866) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4867, %e1_4868, %e2_4869, %e3_4870 = cute.get_leaves(%1490) : !cute.shape<"((2,2),(2,8))">
      %1491 = cute.get_stride(%lay_4866) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4871, %e1_4872, %e2_4873, %e3_4874 = cute.get_leaves(%1491) : !cute.stride<"((2,4),(1,8))">
      %iter_4875 = cute.get_iter(%1489) : !memref_rmem_f32_4
      %iter_4876 = cute.get_iter(%1489) : !memref_rmem_f32_4
      %coord_4877 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4878 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4879 = cute.crd2idx(%coord_4877, %lay_4878) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4880 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4881 = cute.add_offset(%iter_4880, %idx_4879) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4882 = cute.make_view(%tup_4881) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4883 = cute.get_iter(%view_4882) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4884, %e1_4885, %e2_4886, %e3_4887 = cute.get_leaves(%iter_4883) : !cute.int_tuple<"(?,?,?,?)">
      %1492 = cute.get_scalars(%e0_4884) : !cute.int_tuple<"?">
      %1493 = cute.get_scalars(%e1_4885) : !cute.int_tuple<"?">
      %1494 = cute.get_scalars(%e2_4886) : !cute.int_tuple<"?">
      %1495 = cute.get_scalars(%e3_4887) : !cute.int_tuple<"?">
      %iter_4888 = cute.get_iter(%view_4882) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4889, %e1_4890, %e2_4891, %e3_4892 = cute.get_leaves(%iter_4888) : !cute.int_tuple<"(?,?,?,?)">
      %1496 = cute.get_scalars(%e0_4889) : !cute.int_tuple<"?">
      %1497 = cute.get_scalars(%e1_4890) : !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%e2_4891) : !cute.int_tuple<"?">
      %1499 = cute.get_scalars(%e3_4892) : !cute.int_tuple<"?">
      %iter_4893 = cute.get_iter(%view_4882) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4894, %e1_4895, %e2_4896, %e3_4897 = cute.get_leaves(%iter_4893) : !cute.int_tuple<"(?,?,?,?)">
      %1500 = cute.get_scalars(%e0_4894) : !cute.int_tuple<"?">
      %1501 = cute.get_scalars(%e1_4895) : !cute.int_tuple<"?">
      %1502 = cute.get_scalars(%e2_4896) : !cute.int_tuple<"?">
      %1503 = cute.get_scalars(%e3_4897) : !cute.int_tuple<"?">
      %int_tuple_4898 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4899 = cute.add_offset(%e3_4897, %int_tuple_4898) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1504 = cute.get_scalars(%tup_4899) : !cute.int_tuple<"?">
      %coord_4900 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4901 = cute.make_coord(%tup_4899) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1505 = cute.elem_less(%coord_4900, %coord_4901) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4902 = cute.get_layout(%1489) : !memref_rmem_f32_4
      %1506 = cute.get_shape(%lay_4902) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4903, %e1_4904, %e2_4905, %e3_4906 = cute.get_leaves(%1506) : !cute.shape<"((2,2),(2,8))">
      %1507 = cute.get_stride(%lay_4902) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%1507) : !cute.stride<"((2,4),(1,8))">
      %1508 = scf.if %1505 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1489) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,5)">
        cute.memref.store(%1489, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,5)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1489) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1489 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1489) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1489) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1489 : !memref_rmem_f32_4
      }
      %iter_4911 = cute.get_iter(%1508) : !memref_rmem_f32_4
      %lay_4912 = cute.get_layout(%1508) : !memref_rmem_f32_4
      %1509 = cute.get_shape(%lay_4912) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4913, %e1_4914, %e2_4915, %e3_4916 = cute.get_leaves(%1509) : !cute.shape<"((2,2),(2,8))">
      %1510 = cute.get_stride(%lay_4912) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4917, %e1_4918, %e2_4919, %e3_4920 = cute.get_leaves(%1510) : !cute.stride<"((2,4),(1,8))">
      %iter_4921 = cute.get_iter(%1508) : !memref_rmem_f32_4
      %iter_4922 = cute.get_iter(%1508) : !memref_rmem_f32_4
      %coord_4923 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4924 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4925 = cute.crd2idx(%coord_4923, %lay_4924) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4926 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4927 = cute.add_offset(%iter_4926, %idx_4925) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4928 = cute.make_view(%tup_4927) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4929 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4930, %e1_4931, %e2_4932, %e3_4933 = cute.get_leaves(%iter_4929) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1511 = cute.get_scalars(%e0_4930) : !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%e1_4931) : !cute.int_tuple<"?">
      %1513 = cute.get_scalars(%e2_4932) : !cute.int_tuple<"?">
      %1514 = cute.get_scalars(%e3_4933) : !cute.int_tuple<"?{div=2}">
      %iter_4934 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4935, %e1_4936, %e2_4937, %e3_4938 = cute.get_leaves(%iter_4934) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1515 = cute.get_scalars(%e0_4935) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e1_4936) : !cute.int_tuple<"?">
      %1517 = cute.get_scalars(%e2_4937) : !cute.int_tuple<"?">
      %1518 = cute.get_scalars(%e3_4938) : !cute.int_tuple<"?{div=2}">
      %iter_4939 = cute.get_iter(%view_4928) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4940, %e1_4941, %e2_4942, %e3_4943 = cute.get_leaves(%iter_4939) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1519 = cute.get_scalars(%e0_4940) : !cute.int_tuple<"?">
      %1520 = cute.get_scalars(%e1_4941) : !cute.int_tuple<"?">
      %1521 = cute.get_scalars(%e2_4942) : !cute.int_tuple<"?">
      %1522 = cute.get_scalars(%e3_4943) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4944 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4945 = cute.add_offset(%e3_4943, %int_tuple_4944) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1523 = cute.get_scalars(%tup_4945) : !cute.int_tuple<"?">
      %coord_4946 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4947 = cute.make_coord(%tup_4945) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1524 = cute.elem_less(%coord_4946, %coord_4947) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4948 = cute.get_layout(%1508) : !memref_rmem_f32_4
      %1525 = cute.get_shape(%lay_4948) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4949, %e1_4950, %e2_4951, %e3_4952 = cute.get_leaves(%1525) : !cute.shape<"((2,2),(2,8))">
      %1526 = cute.get_stride(%lay_4948) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4953, %e1_4954, %e2_4955, %e3_4956 = cute.get_leaves(%1526) : !cute.stride<"((2,4),(1,8))">
      %1527 = scf.if %1524 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1508) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,6)">
        cute.memref.store(%1508, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,6)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1508) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1508 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1508) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1508) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1508 : !memref_rmem_f32_4
      }
      %iter_4957 = cute.get_iter(%1527) : !memref_rmem_f32_4
      %lay_4958 = cute.get_layout(%1527) : !memref_rmem_f32_4
      %1528 = cute.get_shape(%lay_4958) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4959, %e1_4960, %e2_4961, %e3_4962 = cute.get_leaves(%1528) : !cute.shape<"((2,2),(2,8))">
      %1529 = cute.get_stride(%lay_4958) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4963, %e1_4964, %e2_4965, %e3_4966 = cute.get_leaves(%1529) : !cute.stride<"((2,4),(1,8))">
      %iter_4967 = cute.get_iter(%1527) : !memref_rmem_f32_4
      %iter_4968 = cute.get_iter(%1527) : !memref_rmem_f32_4
      %coord_4969 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4970 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4971 = cute.crd2idx(%coord_4969, %lay_4970) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4972 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4973 = cute.add_offset(%iter_4972, %idx_4971) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4974 = cute.make_view(%tup_4973) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4975 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4976, %e1_4977, %e2_4978, %e3_4979 = cute.get_leaves(%iter_4975) : !cute.int_tuple<"(?,?,?,?)">
      %1530 = cute.get_scalars(%e0_4976) : !cute.int_tuple<"?">
      %1531 = cute.get_scalars(%e1_4977) : !cute.int_tuple<"?">
      %1532 = cute.get_scalars(%e2_4978) : !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%e3_4979) : !cute.int_tuple<"?">
      %iter_4980 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4981, %e1_4982, %e2_4983, %e3_4984 = cute.get_leaves(%iter_4980) : !cute.int_tuple<"(?,?,?,?)">
      %1534 = cute.get_scalars(%e0_4981) : !cute.int_tuple<"?">
      %1535 = cute.get_scalars(%e1_4982) : !cute.int_tuple<"?">
      %1536 = cute.get_scalars(%e2_4983) : !cute.int_tuple<"?">
      %1537 = cute.get_scalars(%e3_4984) : !cute.int_tuple<"?">
      %iter_4985 = cute.get_iter(%view_4974) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4986, %e1_4987, %e2_4988, %e3_4989 = cute.get_leaves(%iter_4985) : !cute.int_tuple<"(?,?,?,?)">
      %1538 = cute.get_scalars(%e0_4986) : !cute.int_tuple<"?">
      %1539 = cute.get_scalars(%e1_4987) : !cute.int_tuple<"?">
      %1540 = cute.get_scalars(%e2_4988) : !cute.int_tuple<"?">
      %1541 = cute.get_scalars(%e3_4989) : !cute.int_tuple<"?">
      %int_tuple_4990 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4991 = cute.add_offset(%e3_4989, %int_tuple_4990) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1542 = cute.get_scalars(%tup_4991) : !cute.int_tuple<"?">
      %coord_4992 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4993 = cute.make_coord(%tup_4991) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1543 = cute.elem_less(%coord_4992, %coord_4993) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4994 = cute.get_layout(%1527) : !memref_rmem_f32_4
      %1544 = cute.get_shape(%lay_4994) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4995, %e1_4996, %e2_4997, %e3_4998 = cute.get_leaves(%1544) : !cute.shape<"((2,2),(2,8))">
      %1545 = cute.get_stride(%lay_4994) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4999, %e1_5000, %e2_5001, %e3_5002 = cute.get_leaves(%1545) : !cute.stride<"((2,4),(1,8))">
      %1546 = scf.if %1543 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1527) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,7)">
        cute.memref.store(%1527, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,7)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1527) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1527 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1527) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1527) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1527 : !memref_rmem_f32_4
      }
      %iter_5003 = cute.get_iter(%1546) : !memref_rmem_f32_4
      %lay_5004 = cute.get_layout(%1546) : !memref_rmem_f32_4
      %1547 = cute.get_shape(%lay_5004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5005, %e1_5006, %e2_5007, %e3_5008 = cute.get_leaves(%1547) : !cute.shape<"((2,2),(2,8))">
      %1548 = cute.get_stride(%lay_5004) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5009, %e1_5010, %e2_5011, %e3_5012 = cute.get_leaves(%1548) : !cute.stride<"((2,4),(1,8))">
      %iter_5013 = cute.get_iter(%1546) : !memref_rmem_f32_4
      %iter_5014 = cute.get_iter(%1546) : !memref_rmem_f32_4
      %coord_5015 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_5016 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5017 = cute.crd2idx(%coord_5015, %lay_5016) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_5018 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5019 = cute.add_offset(%iter_5018, %idx_5017) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5020 = cute.make_view(%tup_5019) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5021 = cute.get_iter(%view_5020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5022, %e1_5023, %e2_5024, %e3_5025 = cute.get_leaves(%iter_5021) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1549 = cute.get_scalars(%e0_5022) : !cute.int_tuple<"?">
      %1550 = cute.get_scalars(%e1_5023) : !cute.int_tuple<"?">
      %1551 = cute.get_scalars(%e2_5024) : !cute.int_tuple<"?">
      %1552 = cute.get_scalars(%e3_5025) : !cute.int_tuple<"?{div=2}">
      %iter_5026 = cute.get_iter(%view_5020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5027, %e1_5028, %e2_5029, %e3_5030 = cute.get_leaves(%iter_5026) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1553 = cute.get_scalars(%e0_5027) : !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%e1_5028) : !cute.int_tuple<"?">
      %1555 = cute.get_scalars(%e2_5029) : !cute.int_tuple<"?">
      %1556 = cute.get_scalars(%e3_5030) : !cute.int_tuple<"?{div=2}">
      %iter_5031 = cute.get_iter(%view_5020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5032, %e1_5033, %e2_5034, %e3_5035 = cute.get_leaves(%iter_5031) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1557 = cute.get_scalars(%e0_5032) : !cute.int_tuple<"?">
      %1558 = cute.get_scalars(%e1_5033) : !cute.int_tuple<"?">
      %1559 = cute.get_scalars(%e2_5034) : !cute.int_tuple<"?">
      %1560 = cute.get_scalars(%e3_5035) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5036 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5037 = cute.add_offset(%e3_5035, %int_tuple_5036) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1561 = cute.get_scalars(%tup_5037) : !cute.int_tuple<"?">
      %coord_5038 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5039 = cute.make_coord(%tup_5037) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1562 = cute.elem_less(%coord_5038, %coord_5039) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5040 = cute.get_layout(%1546) : !memref_rmem_f32_4
      %1563 = cute.get_shape(%lay_5040) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5041, %e1_5042, %e2_5043, %e3_5044 = cute.get_leaves(%1563) : !cute.shape<"((2,2),(2,8))">
      %1564 = cute.get_stride(%lay_5040) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5045, %e1_5046, %e2_5047, %e3_5048 = cute.get_leaves(%1564) : !cute.stride<"((2,4),(1,8))">
      %1565 = scf.if %1562 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1546) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,8)">
        cute.memref.store(%1546, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,8)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1546) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1546 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1546) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1546) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1546 : !memref_rmem_f32_4
      }
      %iter_5049 = cute.get_iter(%1565) : !memref_rmem_f32_4
      %lay_5050 = cute.get_layout(%1565) : !memref_rmem_f32_4
      %1566 = cute.get_shape(%lay_5050) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5051, %e1_5052, %e2_5053, %e3_5054 = cute.get_leaves(%1566) : !cute.shape<"((2,2),(2,8))">
      %1567 = cute.get_stride(%lay_5050) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5055, %e1_5056, %e2_5057, %e3_5058 = cute.get_leaves(%1567) : !cute.stride<"((2,4),(1,8))">
      %iter_5059 = cute.get_iter(%1565) : !memref_rmem_f32_4
      %iter_5060 = cute.get_iter(%1565) : !memref_rmem_f32_4
      %coord_5061 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_5062 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5063 = cute.crd2idx(%coord_5061, %lay_5062) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_5064 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5065 = cute.add_offset(%iter_5064, %idx_5063) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5066 = cute.make_view(%tup_5065) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5067 = cute.get_iter(%view_5066) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5068, %e1_5069, %e2_5070, %e3_5071 = cute.get_leaves(%iter_5067) : !cute.int_tuple<"(?,?,?,?)">
      %1568 = cute.get_scalars(%e0_5068) : !cute.int_tuple<"?">
      %1569 = cute.get_scalars(%e1_5069) : !cute.int_tuple<"?">
      %1570 = cute.get_scalars(%e2_5070) : !cute.int_tuple<"?">
      %1571 = cute.get_scalars(%e3_5071) : !cute.int_tuple<"?">
      %iter_5072 = cute.get_iter(%view_5066) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5073, %e1_5074, %e2_5075, %e3_5076 = cute.get_leaves(%iter_5072) : !cute.int_tuple<"(?,?,?,?)">
      %1572 = cute.get_scalars(%e0_5073) : !cute.int_tuple<"?">
      %1573 = cute.get_scalars(%e1_5074) : !cute.int_tuple<"?">
      %1574 = cute.get_scalars(%e2_5075) : !cute.int_tuple<"?">
      %1575 = cute.get_scalars(%e3_5076) : !cute.int_tuple<"?">
      %iter_5077 = cute.get_iter(%view_5066) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5078, %e1_5079, %e2_5080, %e3_5081 = cute.get_leaves(%iter_5077) : !cute.int_tuple<"(?,?,?,?)">
      %1576 = cute.get_scalars(%e0_5078) : !cute.int_tuple<"?">
      %1577 = cute.get_scalars(%e1_5079) : !cute.int_tuple<"?">
      %1578 = cute.get_scalars(%e2_5080) : !cute.int_tuple<"?">
      %1579 = cute.get_scalars(%e3_5081) : !cute.int_tuple<"?">
      %int_tuple_5082 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5083 = cute.add_offset(%e3_5081, %int_tuple_5082) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1580 = cute.get_scalars(%tup_5083) : !cute.int_tuple<"?">
      %coord_5084 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5085 = cute.make_coord(%tup_5083) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1581 = cute.elem_less(%coord_5084, %coord_5085) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5086 = cute.get_layout(%1565) : !memref_rmem_f32_4
      %1582 = cute.get_shape(%lay_5086) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5087, %e1_5088, %e2_5089, %e3_5090 = cute.get_leaves(%1582) : !cute.shape<"((2,2),(2,8))">
      %1583 = cute.get_stride(%lay_5086) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5091, %e1_5092, %e2_5093, %e3_5094 = cute.get_leaves(%1583) : !cute.stride<"((2,4),(1,8))">
      %1584 = scf.if %1581 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1565) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,9)">
        cute.memref.store(%1565, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,9)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1565) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1565 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1565) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1565) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1565 : !memref_rmem_f32_4
      }
      %iter_5095 = cute.get_iter(%1584) : !memref_rmem_f32_4
      %lay_5096 = cute.get_layout(%1584) : !memref_rmem_f32_4
      %1585 = cute.get_shape(%lay_5096) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5097, %e1_5098, %e2_5099, %e3_5100 = cute.get_leaves(%1585) : !cute.shape<"((2,2),(2,8))">
      %1586 = cute.get_stride(%lay_5096) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5101, %e1_5102, %e2_5103, %e3_5104 = cute.get_leaves(%1586) : !cute.stride<"((2,4),(1,8))">
      %iter_5105 = cute.get_iter(%1584) : !memref_rmem_f32_4
      %iter_5106 = cute.get_iter(%1584) : !memref_rmem_f32_4
      %coord_5107 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5108 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5109 = cute.crd2idx(%coord_5107, %lay_5108) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5110 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5111 = cute.add_offset(%iter_5110, %idx_5109) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5112 = cute.make_view(%tup_5111) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5113 = cute.get_iter(%view_5112) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5114, %e1_5115, %e2_5116, %e3_5117 = cute.get_leaves(%iter_5113) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1587 = cute.get_scalars(%e0_5114) : !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%e1_5115) : !cute.int_tuple<"?">
      %1589 = cute.get_scalars(%e2_5116) : !cute.int_tuple<"?">
      %1590 = cute.get_scalars(%e3_5117) : !cute.int_tuple<"?{div=2}">
      %iter_5118 = cute.get_iter(%view_5112) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5119, %e1_5120, %e2_5121, %e3_5122 = cute.get_leaves(%iter_5118) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1591 = cute.get_scalars(%e0_5119) : !cute.int_tuple<"?">
      %1592 = cute.get_scalars(%e1_5120) : !cute.int_tuple<"?">
      %1593 = cute.get_scalars(%e2_5121) : !cute.int_tuple<"?">
      %1594 = cute.get_scalars(%e3_5122) : !cute.int_tuple<"?{div=2}">
      %iter_5123 = cute.get_iter(%view_5112) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5124, %e1_5125, %e2_5126, %e3_5127 = cute.get_leaves(%iter_5123) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1595 = cute.get_scalars(%e0_5124) : !cute.int_tuple<"?">
      %1596 = cute.get_scalars(%e1_5125) : !cute.int_tuple<"?">
      %1597 = cute.get_scalars(%e2_5126) : !cute.int_tuple<"?">
      %1598 = cute.get_scalars(%e3_5127) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5128 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5129 = cute.add_offset(%e3_5127, %int_tuple_5128) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1599 = cute.get_scalars(%tup_5129) : !cute.int_tuple<"?">
      %coord_5130 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5131 = cute.make_coord(%tup_5129) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1600 = cute.elem_less(%coord_5130, %coord_5131) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5132 = cute.get_layout(%1584) : !memref_rmem_f32_4
      %1601 = cute.get_shape(%lay_5132) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5133, %e1_5134, %e2_5135, %e3_5136 = cute.get_leaves(%1601) : !cute.shape<"((2,2),(2,8))">
      %1602 = cute.get_stride(%lay_5132) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5137, %e1_5138, %e2_5139, %e3_5140 = cute.get_leaves(%1602) : !cute.stride<"((2,4),(1,8))">
      %1603 = scf.if %1600 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1584) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,10)">
        cute.memref.store(%1584, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,10)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1584) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1584 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1584) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1584) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1584 : !memref_rmem_f32_4
      }
      %iter_5141 = cute.get_iter(%1603) : !memref_rmem_f32_4
      %lay_5142 = cute.get_layout(%1603) : !memref_rmem_f32_4
      %1604 = cute.get_shape(%lay_5142) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5143, %e1_5144, %e2_5145, %e3_5146 = cute.get_leaves(%1604) : !cute.shape<"((2,2),(2,8))">
      %1605 = cute.get_stride(%lay_5142) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5147, %e1_5148, %e2_5149, %e3_5150 = cute.get_leaves(%1605) : !cute.stride<"((2,4),(1,8))">
      %iter_5151 = cute.get_iter(%1603) : !memref_rmem_f32_4
      %iter_5152 = cute.get_iter(%1603) : !memref_rmem_f32_4
      %coord_5153 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5154 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5155 = cute.crd2idx(%coord_5153, %lay_5154) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5156 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5157 = cute.add_offset(%iter_5156, %idx_5155) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5158 = cute.make_view(%tup_5157) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5159 = cute.get_iter(%view_5158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5160, %e1_5161, %e2_5162, %e3_5163 = cute.get_leaves(%iter_5159) : !cute.int_tuple<"(?,?,?,?)">
      %1606 = cute.get_scalars(%e0_5160) : !cute.int_tuple<"?">
      %1607 = cute.get_scalars(%e1_5161) : !cute.int_tuple<"?">
      %1608 = cute.get_scalars(%e2_5162) : !cute.int_tuple<"?">
      %1609 = cute.get_scalars(%e3_5163) : !cute.int_tuple<"?">
      %iter_5164 = cute.get_iter(%view_5158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5165, %e1_5166, %e2_5167, %e3_5168 = cute.get_leaves(%iter_5164) : !cute.int_tuple<"(?,?,?,?)">
      %1610 = cute.get_scalars(%e0_5165) : !cute.int_tuple<"?">
      %1611 = cute.get_scalars(%e1_5166) : !cute.int_tuple<"?">
      %1612 = cute.get_scalars(%e2_5167) : !cute.int_tuple<"?">
      %1613 = cute.get_scalars(%e3_5168) : !cute.int_tuple<"?">
      %iter_5169 = cute.get_iter(%view_5158) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5170, %e1_5171, %e2_5172, %e3_5173 = cute.get_leaves(%iter_5169) : !cute.int_tuple<"(?,?,?,?)">
      %1614 = cute.get_scalars(%e0_5170) : !cute.int_tuple<"?">
      %1615 = cute.get_scalars(%e1_5171) : !cute.int_tuple<"?">
      %1616 = cute.get_scalars(%e2_5172) : !cute.int_tuple<"?">
      %1617 = cute.get_scalars(%e3_5173) : !cute.int_tuple<"?">
      %int_tuple_5174 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5175 = cute.add_offset(%e3_5173, %int_tuple_5174) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1618 = cute.get_scalars(%tup_5175) : !cute.int_tuple<"?">
      %coord_5176 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5177 = cute.make_coord(%tup_5175) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1619 = cute.elem_less(%coord_5176, %coord_5177) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5178 = cute.get_layout(%1603) : !memref_rmem_f32_4
      %1620 = cute.get_shape(%lay_5178) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5179, %e1_5180, %e2_5181, %e3_5182 = cute.get_leaves(%1620) : !cute.shape<"((2,2),(2,8))">
      %1621 = cute.get_stride(%lay_5178) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5183, %e1_5184, %e2_5185, %e3_5186 = cute.get_leaves(%1621) : !cute.stride<"((2,4),(1,8))">
      %1622 = scf.if %1619 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1603) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,11)">
        cute.memref.store(%1603, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,11)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1603) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1603 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1603) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1603) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1603 : !memref_rmem_f32_4
      }
      %iter_5187 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %lay_5188 = cute.get_layout(%1622) : !memref_rmem_f32_4
      %1623 = cute.get_shape(%lay_5188) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5189, %e1_5190, %e2_5191, %e3_5192 = cute.get_leaves(%1623) : !cute.shape<"((2,2),(2,8))">
      %1624 = cute.get_stride(%lay_5188) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5193, %e1_5194, %e2_5195, %e3_5196 = cute.get_leaves(%1624) : !cute.stride<"((2,4),(1,8))">
      %iter_5197 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %iter_5198 = cute.get_iter(%1622) : !memref_rmem_f32_4
      %coord_5199 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5200 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5201 = cute.crd2idx(%coord_5199, %lay_5200) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5202 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5203 = cute.add_offset(%iter_5202, %idx_5201) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5204 = cute.make_view(%tup_5203) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5205 = cute.get_iter(%view_5204) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5206, %e1_5207, %e2_5208, %e3_5209 = cute.get_leaves(%iter_5205) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1625 = cute.get_scalars(%e0_5206) : !cute.int_tuple<"?">
      %1626 = cute.get_scalars(%e1_5207) : !cute.int_tuple<"?">
      %1627 = cute.get_scalars(%e2_5208) : !cute.int_tuple<"?">
      %1628 = cute.get_scalars(%e3_5209) : !cute.int_tuple<"?{div=2}">
      %iter_5210 = cute.get_iter(%view_5204) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5211, %e1_5212, %e2_5213, %e3_5214 = cute.get_leaves(%iter_5210) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1629 = cute.get_scalars(%e0_5211) : !cute.int_tuple<"?">
      %1630 = cute.get_scalars(%e1_5212) : !cute.int_tuple<"?">
      %1631 = cute.get_scalars(%e2_5213) : !cute.int_tuple<"?">
      %1632 = cute.get_scalars(%e3_5214) : !cute.int_tuple<"?{div=2}">
      %iter_5215 = cute.get_iter(%view_5204) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5216, %e1_5217, %e2_5218, %e3_5219 = cute.get_leaves(%iter_5215) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1633 = cute.get_scalars(%e0_5216) : !cute.int_tuple<"?">
      %1634 = cute.get_scalars(%e1_5217) : !cute.int_tuple<"?">
      %1635 = cute.get_scalars(%e2_5218) : !cute.int_tuple<"?">
      %1636 = cute.get_scalars(%e3_5219) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5220 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5221 = cute.add_offset(%e3_5219, %int_tuple_5220) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1637 = cute.get_scalars(%tup_5221) : !cute.int_tuple<"?">
      %coord_5222 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5223 = cute.make_coord(%tup_5221) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1638 = cute.elem_less(%coord_5222, %coord_5223) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5224 = cute.get_layout(%1622) : !memref_rmem_f32_4
      %1639 = cute.get_shape(%lay_5224) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5225, %e1_5226, %e2_5227, %e3_5228 = cute.get_leaves(%1639) : !cute.shape<"((2,2),(2,8))">
      %1640 = cute.get_stride(%lay_5224) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5229, %e1_5230, %e2_5231, %e3_5232 = cute.get_leaves(%1640) : !cute.stride<"((2,4),(1,8))">
      %1641 = scf.if %1638 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1622) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,12)">
        cute.memref.store(%1622, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,12)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1622) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1622 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1622) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1622) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1622 : !memref_rmem_f32_4
      }
      %iter_5233 = cute.get_iter(%1641) : !memref_rmem_f32_4
      %lay_5234 = cute.get_layout(%1641) : !memref_rmem_f32_4
      %1642 = cute.get_shape(%lay_5234) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5235, %e1_5236, %e2_5237, %e3_5238 = cute.get_leaves(%1642) : !cute.shape<"((2,2),(2,8))">
      %1643 = cute.get_stride(%lay_5234) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5239, %e1_5240, %e2_5241, %e3_5242 = cute.get_leaves(%1643) : !cute.stride<"((2,4),(1,8))">
      %iter_5243 = cute.get_iter(%1641) : !memref_rmem_f32_4
      %iter_5244 = cute.get_iter(%1641) : !memref_rmem_f32_4
      %coord_5245 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5246 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5247 = cute.crd2idx(%coord_5245, %lay_5246) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5248 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5249 = cute.add_offset(%iter_5248, %idx_5247) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5250 = cute.make_view(%tup_5249) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5251 = cute.get_iter(%view_5250) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5252, %e1_5253, %e2_5254, %e3_5255 = cute.get_leaves(%iter_5251) : !cute.int_tuple<"(?,?,?,?)">
      %1644 = cute.get_scalars(%e0_5252) : !cute.int_tuple<"?">
      %1645 = cute.get_scalars(%e1_5253) : !cute.int_tuple<"?">
      %1646 = cute.get_scalars(%e2_5254) : !cute.int_tuple<"?">
      %1647 = cute.get_scalars(%e3_5255) : !cute.int_tuple<"?">
      %iter_5256 = cute.get_iter(%view_5250) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5257, %e1_5258, %e2_5259, %e3_5260 = cute.get_leaves(%iter_5256) : !cute.int_tuple<"(?,?,?,?)">
      %1648 = cute.get_scalars(%e0_5257) : !cute.int_tuple<"?">
      %1649 = cute.get_scalars(%e1_5258) : !cute.int_tuple<"?">
      %1650 = cute.get_scalars(%e2_5259) : !cute.int_tuple<"?">
      %1651 = cute.get_scalars(%e3_5260) : !cute.int_tuple<"?">
      %iter_5261 = cute.get_iter(%view_5250) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5262, %e1_5263, %e2_5264, %e3_5265 = cute.get_leaves(%iter_5261) : !cute.int_tuple<"(?,?,?,?)">
      %1652 = cute.get_scalars(%e0_5262) : !cute.int_tuple<"?">
      %1653 = cute.get_scalars(%e1_5263) : !cute.int_tuple<"?">
      %1654 = cute.get_scalars(%e2_5264) : !cute.int_tuple<"?">
      %1655 = cute.get_scalars(%e3_5265) : !cute.int_tuple<"?">
      %int_tuple_5266 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5267 = cute.add_offset(%e3_5265, %int_tuple_5266) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1656 = cute.get_scalars(%tup_5267) : !cute.int_tuple<"?">
      %coord_5268 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5269 = cute.make_coord(%tup_5267) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1657 = cute.elem_less(%coord_5268, %coord_5269) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5270 = cute.get_layout(%1641) : !memref_rmem_f32_4
      %1658 = cute.get_shape(%lay_5270) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5271, %e1_5272, %e2_5273, %e3_5274 = cute.get_leaves(%1658) : !cute.shape<"((2,2),(2,8))">
      %1659 = cute.get_stride(%lay_5270) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5275, %e1_5276, %e2_5277, %e3_5278 = cute.get_leaves(%1659) : !cute.stride<"((2,4),(1,8))">
      %1660 = scf.if %1657 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1641) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,13)">
        cute.memref.store(%1641, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,13)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1641) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1641 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1641) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1641) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1641 : !memref_rmem_f32_4
      }
      %iter_5279 = cute.get_iter(%1660) : !memref_rmem_f32_4
      %lay_5280 = cute.get_layout(%1660) : !memref_rmem_f32_4
      %1661 = cute.get_shape(%lay_5280) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5281, %e1_5282, %e2_5283, %e3_5284 = cute.get_leaves(%1661) : !cute.shape<"((2,2),(2,8))">
      %1662 = cute.get_stride(%lay_5280) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5285, %e1_5286, %e2_5287, %e3_5288 = cute.get_leaves(%1662) : !cute.stride<"((2,4),(1,8))">
      %iter_5289 = cute.get_iter(%1660) : !memref_rmem_f32_4
      %iter_5290 = cute.get_iter(%1660) : !memref_rmem_f32_4
      %coord_5291 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5292 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5293 = cute.crd2idx(%coord_5291, %lay_5292) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5294 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5295 = cute.add_offset(%iter_5294, %idx_5293) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5296 = cute.make_view(%tup_5295) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5297 = cute.get_iter(%view_5296) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5298, %e1_5299, %e2_5300, %e3_5301 = cute.get_leaves(%iter_5297) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1663 = cute.get_scalars(%e0_5298) : !cute.int_tuple<"?">
      %1664 = cute.get_scalars(%e1_5299) : !cute.int_tuple<"?">
      %1665 = cute.get_scalars(%e2_5300) : !cute.int_tuple<"?">
      %1666 = cute.get_scalars(%e3_5301) : !cute.int_tuple<"?{div=2}">
      %iter_5302 = cute.get_iter(%view_5296) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5303, %e1_5304, %e2_5305, %e3_5306 = cute.get_leaves(%iter_5302) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1667 = cute.get_scalars(%e0_5303) : !cute.int_tuple<"?">
      %1668 = cute.get_scalars(%e1_5304) : !cute.int_tuple<"?">
      %1669 = cute.get_scalars(%e2_5305) : !cute.int_tuple<"?">
      %1670 = cute.get_scalars(%e3_5306) : !cute.int_tuple<"?{div=2}">
      %iter_5307 = cute.get_iter(%view_5296) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5308, %e1_5309, %e2_5310, %e3_5311 = cute.get_leaves(%iter_5307) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1671 = cute.get_scalars(%e0_5308) : !cute.int_tuple<"?">
      %1672 = cute.get_scalars(%e1_5309) : !cute.int_tuple<"?">
      %1673 = cute.get_scalars(%e2_5310) : !cute.int_tuple<"?">
      %1674 = cute.get_scalars(%e3_5311) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5312 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5313 = cute.add_offset(%e3_5311, %int_tuple_5312) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1675 = cute.get_scalars(%tup_5313) : !cute.int_tuple<"?">
      %coord_5314 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5315 = cute.make_coord(%tup_5313) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1676 = cute.elem_less(%coord_5314, %coord_5315) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5316 = cute.get_layout(%1660) : !memref_rmem_f32_4
      %1677 = cute.get_shape(%lay_5316) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5317, %e1_5318, %e2_5319, %e3_5320 = cute.get_leaves(%1677) : !cute.shape<"((2,2),(2,8))">
      %1678 = cute.get_stride(%lay_5316) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5321, %e1_5322, %e2_5323, %e3_5324 = cute.get_leaves(%1678) : !cute.stride<"((2,4),(1,8))">
      %1679 = scf.if %1676 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1660) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,14)">
        cute.memref.store(%1660, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,14)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1660) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1660 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1660) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1660) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1660 : !memref_rmem_f32_4
      }
      %iter_5325 = cute.get_iter(%1679) : !memref_rmem_f32_4
      %lay_5326 = cute.get_layout(%1679) : !memref_rmem_f32_4
      %1680 = cute.get_shape(%lay_5326) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5327, %e1_5328, %e2_5329, %e3_5330 = cute.get_leaves(%1680) : !cute.shape<"((2,2),(2,8))">
      %1681 = cute.get_stride(%lay_5326) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5331, %e1_5332, %e2_5333, %e3_5334 = cute.get_leaves(%1681) : !cute.stride<"((2,4),(1,8))">
      %iter_5335 = cute.get_iter(%1679) : !memref_rmem_f32_4
      %iter_5336 = cute.get_iter(%1679) : !memref_rmem_f32_4
      %coord_5337 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5338 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5339 = cute.crd2idx(%coord_5337, %lay_5338) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5340 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5341 = cute.add_offset(%iter_5340, %idx_5339) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5342 = cute.make_view(%tup_5341) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5343 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5344, %e1_5345, %e2_5346, %e3_5347 = cute.get_leaves(%iter_5343) : !cute.int_tuple<"(?,?,?,?)">
      %1682 = cute.get_scalars(%e0_5344) : !cute.int_tuple<"?">
      %1683 = cute.get_scalars(%e1_5345) : !cute.int_tuple<"?">
      %1684 = cute.get_scalars(%e2_5346) : !cute.int_tuple<"?">
      %1685 = cute.get_scalars(%e3_5347) : !cute.int_tuple<"?">
      %iter_5348 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5349, %e1_5350, %e2_5351, %e3_5352 = cute.get_leaves(%iter_5348) : !cute.int_tuple<"(?,?,?,?)">
      %1686 = cute.get_scalars(%e0_5349) : !cute.int_tuple<"?">
      %1687 = cute.get_scalars(%e1_5350) : !cute.int_tuple<"?">
      %1688 = cute.get_scalars(%e2_5351) : !cute.int_tuple<"?">
      %1689 = cute.get_scalars(%e3_5352) : !cute.int_tuple<"?">
      %iter_5353 = cute.get_iter(%view_5342) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5354, %e1_5355, %e2_5356, %e3_5357 = cute.get_leaves(%iter_5353) : !cute.int_tuple<"(?,?,?,?)">
      %1690 = cute.get_scalars(%e0_5354) : !cute.int_tuple<"?">
      %1691 = cute.get_scalars(%e1_5355) : !cute.int_tuple<"?">
      %1692 = cute.get_scalars(%e2_5356) : !cute.int_tuple<"?">
      %1693 = cute.get_scalars(%e3_5357) : !cute.int_tuple<"?">
      %int_tuple_5358 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5359 = cute.add_offset(%e3_5357, %int_tuple_5358) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1694 = cute.get_scalars(%tup_5359) : !cute.int_tuple<"?">
      %coord_5360 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5361 = cute.make_coord(%tup_5359) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1695 = cute.elem_less(%coord_5360, %coord_5361) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5362 = cute.get_layout(%1679) : !memref_rmem_f32_4
      %1696 = cute.get_shape(%lay_5362) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5363, %e1_5364, %e2_5365, %e3_5366 = cute.get_leaves(%1696) : !cute.shape<"((2,2),(2,8))">
      %1697 = cute.get_stride(%lay_5362) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5367, %e1_5368, %e2_5369, %e3_5370 = cute.get_leaves(%1697) : !cute.stride<"((2,4),(1,8))">
      %1698 = scf.if %1695 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1679) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(2,15)">
        cute.memref.store(%1679, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(2,15)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1679) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1679 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1679) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1679) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1679 : !memref_rmem_f32_4
      }
      %iter_5371 = cute.get_iter(%1698) : !memref_rmem_f32_4
      %lay_5372 = cute.get_layout(%1698) : !memref_rmem_f32_4
      %1699 = cute.get_shape(%lay_5372) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5373, %e1_5374, %e2_5375, %e3_5376 = cute.get_leaves(%1699) : !cute.shape<"((2,2),(2,8))">
      %1700 = cute.get_stride(%lay_5372) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5377, %e1_5378, %e2_5379, %e3_5380 = cute.get_leaves(%1700) : !cute.stride<"((2,4),(1,8))">
      %iter_5381 = cute.get_iter(%1698) : !memref_rmem_f32_4
      %iter_5382 = cute.get_iter(%1698) : !memref_rmem_f32_4
      %coord_5383 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5384 = cute.get_layout(%1698) : !memref_rmem_f32_4
      %idx_5385 = cute.crd2idx(%coord_5383, %lay_5384) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5386 = cute.get_iter(%1698) : !memref_rmem_f32_4
      %ptr_5387 = cute.add_offset(%iter_5386, %idx_5385) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5388 = cute.make_view(%ptr_5387) : !memref_rmem_f32_8
      %iter_5389 = cute.get_iter(%view_5388) : !memref_rmem_f32_8
      %iter_5390 = cute.get_iter(%view_5388) : !memref_rmem_f32_8
      %lay_5391 = cute.get_layout(%view_5388) : !memref_rmem_f32_8
      %1701 = cute.get_shape(%lay_5391) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5392, %e1_5393 = cute.get_leaves(%1701) : !cute.shape<"((2,8))">
      %1702 = cute.memref.load_vec %view_5388 : !memref_rmem_f32_8
      %cst_5394 = arith.constant 0xFF800000 : f32
      %1703 = vector.reduction <maximumf>, %1702, %cst_5394 : vector<16xf32> into f32
      %c-1_i32_5395 = arith.constant -1 : i32
      %c2_i32_5396 = arith.constant 2 : i32
      %c31_i32_5397 = arith.constant 31 : i32
      %1704 = nvvm.shfl.sync  bfly %c-1_i32_5395, %1703, %c2_i32_5396, %c31_i32_5397 : f32 -> f32
      %1705 = nvvm.fmax %1703, %1704
      %c-1_i32_5398 = arith.constant -1 : i32
      %c1_i32_5399 = arith.constant 1 : i32
      %c31_i32_5400 = arith.constant 31 : i32
      %1706 = nvvm.shfl.sync  bfly %c-1_i32_5398, %1705, %c1_i32_5399, %c31_i32_5400 : f32 -> f32
      %1707 = nvvm.fmax %1705, %1706
      %1708 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1709 = arith.mulf %1702, %1708 : vector<16xf32>
      %1710 = arith.mulf %1707, %arg4 : f32
      %1711 = vector.broadcast %1710 : f32 to vector<16xf32>
      %1712 = arith.subf %1709, %1711 : vector<16xf32>
      %1713 = math.exp2 %1712 fastmath<fast> : vector<16xf32>
      %cst_5401 = arith.constant 0.000000e+00 : f32
      %1714 = vector.reduction <add>, %1713, %cst_5401 : vector<16xf32> into f32
      %coord_5402 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1075, %coord_5402, %1707) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5403 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1080, %coord_5403, %1714) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5404 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5405 = cute.get_layout(%1698) : !memref_rmem_f32_4
      %idx_5406 = cute.crd2idx(%coord_5404, %lay_5405) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5407 = cute.get_iter(%1698) : !memref_rmem_f32_4
      %ptr_5408 = cute.add_offset(%iter_5407, %idx_5406) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5409 = cute.make_view(%ptr_5408) : !memref_rmem_f32_8
      %iter_5410 = cute.get_iter(%view_5409) : !memref_rmem_f32_8
      %iter_5411 = cute.get_iter(%view_5409) : !memref_rmem_f32_8
      %lay_5412 = cute.get_layout(%view_5409) : !memref_rmem_f32_8
      %1715 = cute.get_shape(%lay_5412) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5413, %e1_5414 = cute.get_leaves(%1715) : !cute.shape<"((2,8))">
      %int_tuple_5415 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5416 = cute.size(%int_tuple_5415) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5417 = cute.get_leaves(%sz_5416) : !cute.int_tuple<"16">
      %int_tuple_5418 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5419 = cute.size(%int_tuple_5418) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5420 = cute.get_leaves(%sz_5419) : !cute.int_tuple<"16">
      cute.memref.store_vec %1713, %view_5409 : !memref_rmem_f32_8
      %int_tuple_5421 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_5422 = cute.size(%int_tuple_5421) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_5423 = cute.get_leaves(%sz_5422) : !cute.int_tuple<"16">
      %coord_5424 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_5425 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5426 = cute.crd2idx(%coord_5424, %lay_5425) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_5427 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5428 = cute.add_offset(%iter_5427, %idx_5426) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5429 = cute.make_view(%tup_5428) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5430 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5431, %e1_5432, %e2_5433, %e3_5434 = cute.get_leaves(%iter_5430) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1716 = cute.get_scalars(%e0_5431) : !cute.int_tuple<"?">
      %1717 = cute.get_scalars(%e1_5432) : !cute.int_tuple<"?">
      %1718 = cute.get_scalars(%e2_5433) : !cute.int_tuple<"?">
      %1719 = cute.get_scalars(%e3_5434) : !cute.int_tuple<"?{div=2}">
      %iter_5435 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5436, %e1_5437, %e2_5438, %e3_5439 = cute.get_leaves(%iter_5435) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1720 = cute.get_scalars(%e0_5436) : !cute.int_tuple<"?">
      %1721 = cute.get_scalars(%e1_5437) : !cute.int_tuple<"?">
      %1722 = cute.get_scalars(%e2_5438) : !cute.int_tuple<"?">
      %1723 = cute.get_scalars(%e3_5439) : !cute.int_tuple<"?{div=2}">
      %iter_5440 = cute.get_iter(%view_5429) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5441, %e1_5442, %e2_5443, %e3_5444 = cute.get_leaves(%iter_5440) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1724 = cute.get_scalars(%e0_5441) : !cute.int_tuple<"?">
      %1725 = cute.get_scalars(%e1_5442) : !cute.int_tuple<"?">
      %1726 = cute.get_scalars(%e2_5443) : !cute.int_tuple<"?">
      %1727 = cute.get_scalars(%e3_5444) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5445 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5446 = cute.add_offset(%e3_5444, %int_tuple_5445) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1728 = cute.get_scalars(%tup_5446) : !cute.int_tuple<"?">
      %coord_5447 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5448 = cute.make_coord(%tup_5446) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1729 = cute.elem_less(%coord_5447, %coord_5448) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5449 = cute.get_layout(%1698) : !memref_rmem_f32_4
      %1730 = cute.get_shape(%lay_5449) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5450, %e1_5451, %e2_5452, %e3_5453 = cute.get_leaves(%1730) : !cute.shape<"((2,2),(2,8))">
      %1731 = cute.get_stride(%lay_5449) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5454, %e1_5455, %e2_5456, %e3_5457 = cute.get_leaves(%1731) : !cute.stride<"((2,4),(1,8))">
      %1732 = scf.if %1729 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1698) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,0)">
        cute.memref.store(%1698, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,0)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1698) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1698 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1698) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1698) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1698 : !memref_rmem_f32_4
      }
      %iter_5458 = cute.get_iter(%1732) : !memref_rmem_f32_4
      %lay_5459 = cute.get_layout(%1732) : !memref_rmem_f32_4
      %1733 = cute.get_shape(%lay_5459) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5460, %e1_5461, %e2_5462, %e3_5463 = cute.get_leaves(%1733) : !cute.shape<"((2,2),(2,8))">
      %1734 = cute.get_stride(%lay_5459) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5464, %e1_5465, %e2_5466, %e3_5467 = cute.get_leaves(%1734) : !cute.stride<"((2,4),(1,8))">
      %iter_5468 = cute.get_iter(%1732) : !memref_rmem_f32_4
      %iter_5469 = cute.get_iter(%1732) : !memref_rmem_f32_4
      %coord_5470 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_5471 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5472 = cute.crd2idx(%coord_5470, %lay_5471) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_5473 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5474 = cute.add_offset(%iter_5473, %idx_5472) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5475 = cute.make_view(%tup_5474) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5476 = cute.get_iter(%view_5475) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5477, %e1_5478, %e2_5479, %e3_5480 = cute.get_leaves(%iter_5476) : !cute.int_tuple<"(?,?,?,?)">
      %1735 = cute.get_scalars(%e0_5477) : !cute.int_tuple<"?">
      %1736 = cute.get_scalars(%e1_5478) : !cute.int_tuple<"?">
      %1737 = cute.get_scalars(%e2_5479) : !cute.int_tuple<"?">
      %1738 = cute.get_scalars(%e3_5480) : !cute.int_tuple<"?">
      %iter_5481 = cute.get_iter(%view_5475) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5482, %e1_5483, %e2_5484, %e3_5485 = cute.get_leaves(%iter_5481) : !cute.int_tuple<"(?,?,?,?)">
      %1739 = cute.get_scalars(%e0_5482) : !cute.int_tuple<"?">
      %1740 = cute.get_scalars(%e1_5483) : !cute.int_tuple<"?">
      %1741 = cute.get_scalars(%e2_5484) : !cute.int_tuple<"?">
      %1742 = cute.get_scalars(%e3_5485) : !cute.int_tuple<"?">
      %iter_5486 = cute.get_iter(%view_5475) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5487, %e1_5488, %e2_5489, %e3_5490 = cute.get_leaves(%iter_5486) : !cute.int_tuple<"(?,?,?,?)">
      %1743 = cute.get_scalars(%e0_5487) : !cute.int_tuple<"?">
      %1744 = cute.get_scalars(%e1_5488) : !cute.int_tuple<"?">
      %1745 = cute.get_scalars(%e2_5489) : !cute.int_tuple<"?">
      %1746 = cute.get_scalars(%e3_5490) : !cute.int_tuple<"?">
      %int_tuple_5491 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5492 = cute.add_offset(%e3_5490, %int_tuple_5491) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1747 = cute.get_scalars(%tup_5492) : !cute.int_tuple<"?">
      %coord_5493 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5494 = cute.make_coord(%tup_5492) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1748 = cute.elem_less(%coord_5493, %coord_5494) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5495 = cute.get_layout(%1732) : !memref_rmem_f32_4
      %1749 = cute.get_shape(%lay_5495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5496, %e1_5497, %e2_5498, %e3_5499 = cute.get_leaves(%1749) : !cute.shape<"((2,2),(2,8))">
      %1750 = cute.get_stride(%lay_5495) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5500, %e1_5501, %e2_5502, %e3_5503 = cute.get_leaves(%1750) : !cute.stride<"((2,4),(1,8))">
      %1751 = scf.if %1748 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1732) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,1)">
        cute.memref.store(%1732, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,1)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1732) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1732 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1732) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1732) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1732 : !memref_rmem_f32_4
      }
      %iter_5504 = cute.get_iter(%1751) : !memref_rmem_f32_4
      %lay_5505 = cute.get_layout(%1751) : !memref_rmem_f32_4
      %1752 = cute.get_shape(%lay_5505) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5506, %e1_5507, %e2_5508, %e3_5509 = cute.get_leaves(%1752) : !cute.shape<"((2,2),(2,8))">
      %1753 = cute.get_stride(%lay_5505) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5510, %e1_5511, %e2_5512, %e3_5513 = cute.get_leaves(%1753) : !cute.stride<"((2,4),(1,8))">
      %iter_5514 = cute.get_iter(%1751) : !memref_rmem_f32_4
      %iter_5515 = cute.get_iter(%1751) : !memref_rmem_f32_4
      %coord_5516 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_5517 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5518 = cute.crd2idx(%coord_5516, %lay_5517) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_5519 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5520 = cute.add_offset(%iter_5519, %idx_5518) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5521 = cute.make_view(%tup_5520) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5522 = cute.get_iter(%view_5521) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5523, %e1_5524, %e2_5525, %e3_5526 = cute.get_leaves(%iter_5522) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1754 = cute.get_scalars(%e0_5523) : !cute.int_tuple<"?">
      %1755 = cute.get_scalars(%e1_5524) : !cute.int_tuple<"?">
      %1756 = cute.get_scalars(%e2_5525) : !cute.int_tuple<"?">
      %1757 = cute.get_scalars(%e3_5526) : !cute.int_tuple<"?{div=2}">
      %iter_5527 = cute.get_iter(%view_5521) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5528, %e1_5529, %e2_5530, %e3_5531 = cute.get_leaves(%iter_5527) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1758 = cute.get_scalars(%e0_5528) : !cute.int_tuple<"?">
      %1759 = cute.get_scalars(%e1_5529) : !cute.int_tuple<"?">
      %1760 = cute.get_scalars(%e2_5530) : !cute.int_tuple<"?">
      %1761 = cute.get_scalars(%e3_5531) : !cute.int_tuple<"?{div=2}">
      %iter_5532 = cute.get_iter(%view_5521) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5533, %e1_5534, %e2_5535, %e3_5536 = cute.get_leaves(%iter_5532) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1762 = cute.get_scalars(%e0_5533) : !cute.int_tuple<"?">
      %1763 = cute.get_scalars(%e1_5534) : !cute.int_tuple<"?">
      %1764 = cute.get_scalars(%e2_5535) : !cute.int_tuple<"?">
      %1765 = cute.get_scalars(%e3_5536) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5537 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5538 = cute.add_offset(%e3_5536, %int_tuple_5537) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1766 = cute.get_scalars(%tup_5538) : !cute.int_tuple<"?">
      %coord_5539 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5540 = cute.make_coord(%tup_5538) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1767 = cute.elem_less(%coord_5539, %coord_5540) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5541 = cute.get_layout(%1751) : !memref_rmem_f32_4
      %1768 = cute.get_shape(%lay_5541) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5542, %e1_5543, %e2_5544, %e3_5545 = cute.get_leaves(%1768) : !cute.shape<"((2,2),(2,8))">
      %1769 = cute.get_stride(%lay_5541) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5546, %e1_5547, %e2_5548, %e3_5549 = cute.get_leaves(%1769) : !cute.stride<"((2,4),(1,8))">
      %1770 = scf.if %1767 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1751) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,2)">
        cute.memref.store(%1751, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,2)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1751) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1751 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1751) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1751) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1751 : !memref_rmem_f32_4
      }
      %iter_5550 = cute.get_iter(%1770) : !memref_rmem_f32_4
      %lay_5551 = cute.get_layout(%1770) : !memref_rmem_f32_4
      %1771 = cute.get_shape(%lay_5551) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5552, %e1_5553, %e2_5554, %e3_5555 = cute.get_leaves(%1771) : !cute.shape<"((2,2),(2,8))">
      %1772 = cute.get_stride(%lay_5551) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5556, %e1_5557, %e2_5558, %e3_5559 = cute.get_leaves(%1772) : !cute.stride<"((2,4),(1,8))">
      %iter_5560 = cute.get_iter(%1770) : !memref_rmem_f32_4
      %iter_5561 = cute.get_iter(%1770) : !memref_rmem_f32_4
      %coord_5562 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_5563 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5564 = cute.crd2idx(%coord_5562, %lay_5563) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_5565 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5566 = cute.add_offset(%iter_5565, %idx_5564) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5567 = cute.make_view(%tup_5566) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5568 = cute.get_iter(%view_5567) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5569, %e1_5570, %e2_5571, %e3_5572 = cute.get_leaves(%iter_5568) : !cute.int_tuple<"(?,?,?,?)">
      %1773 = cute.get_scalars(%e0_5569) : !cute.int_tuple<"?">
      %1774 = cute.get_scalars(%e1_5570) : !cute.int_tuple<"?">
      %1775 = cute.get_scalars(%e2_5571) : !cute.int_tuple<"?">
      %1776 = cute.get_scalars(%e3_5572) : !cute.int_tuple<"?">
      %iter_5573 = cute.get_iter(%view_5567) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5574, %e1_5575, %e2_5576, %e3_5577 = cute.get_leaves(%iter_5573) : !cute.int_tuple<"(?,?,?,?)">
      %1777 = cute.get_scalars(%e0_5574) : !cute.int_tuple<"?">
      %1778 = cute.get_scalars(%e1_5575) : !cute.int_tuple<"?">
      %1779 = cute.get_scalars(%e2_5576) : !cute.int_tuple<"?">
      %1780 = cute.get_scalars(%e3_5577) : !cute.int_tuple<"?">
      %iter_5578 = cute.get_iter(%view_5567) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5579, %e1_5580, %e2_5581, %e3_5582 = cute.get_leaves(%iter_5578) : !cute.int_tuple<"(?,?,?,?)">
      %1781 = cute.get_scalars(%e0_5579) : !cute.int_tuple<"?">
      %1782 = cute.get_scalars(%e1_5580) : !cute.int_tuple<"?">
      %1783 = cute.get_scalars(%e2_5581) : !cute.int_tuple<"?">
      %1784 = cute.get_scalars(%e3_5582) : !cute.int_tuple<"?">
      %int_tuple_5583 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5584 = cute.add_offset(%e3_5582, %int_tuple_5583) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1785 = cute.get_scalars(%tup_5584) : !cute.int_tuple<"?">
      %coord_5585 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5586 = cute.make_coord(%tup_5584) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1786 = cute.elem_less(%coord_5585, %coord_5586) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5587 = cute.get_layout(%1770) : !memref_rmem_f32_4
      %1787 = cute.get_shape(%lay_5587) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5588, %e1_5589, %e2_5590, %e3_5591 = cute.get_leaves(%1787) : !cute.shape<"((2,2),(2,8))">
      %1788 = cute.get_stride(%lay_5587) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5592, %e1_5593, %e2_5594, %e3_5595 = cute.get_leaves(%1788) : !cute.stride<"((2,4),(1,8))">
      %1789 = scf.if %1786 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1770) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,3)">
        cute.memref.store(%1770, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,3)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1770) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1770 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1770) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1770) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1770 : !memref_rmem_f32_4
      }
      %iter_5596 = cute.get_iter(%1789) : !memref_rmem_f32_4
      %lay_5597 = cute.get_layout(%1789) : !memref_rmem_f32_4
      %1790 = cute.get_shape(%lay_5597) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5598, %e1_5599, %e2_5600, %e3_5601 = cute.get_leaves(%1790) : !cute.shape<"((2,2),(2,8))">
      %1791 = cute.get_stride(%lay_5597) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5602, %e1_5603, %e2_5604, %e3_5605 = cute.get_leaves(%1791) : !cute.stride<"((2,4),(1,8))">
      %iter_5606 = cute.get_iter(%1789) : !memref_rmem_f32_4
      %iter_5607 = cute.get_iter(%1789) : !memref_rmem_f32_4
      %coord_5608 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_5609 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5610 = cute.crd2idx(%coord_5608, %lay_5609) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_5611 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5612 = cute.add_offset(%iter_5611, %idx_5610) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5613 = cute.make_view(%tup_5612) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5614 = cute.get_iter(%view_5613) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5615, %e1_5616, %e2_5617, %e3_5618 = cute.get_leaves(%iter_5614) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1792 = cute.get_scalars(%e0_5615) : !cute.int_tuple<"?">
      %1793 = cute.get_scalars(%e1_5616) : !cute.int_tuple<"?">
      %1794 = cute.get_scalars(%e2_5617) : !cute.int_tuple<"?">
      %1795 = cute.get_scalars(%e3_5618) : !cute.int_tuple<"?{div=2}">
      %iter_5619 = cute.get_iter(%view_5613) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5620, %e1_5621, %e2_5622, %e3_5623 = cute.get_leaves(%iter_5619) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1796 = cute.get_scalars(%e0_5620) : !cute.int_tuple<"?">
      %1797 = cute.get_scalars(%e1_5621) : !cute.int_tuple<"?">
      %1798 = cute.get_scalars(%e2_5622) : !cute.int_tuple<"?">
      %1799 = cute.get_scalars(%e3_5623) : !cute.int_tuple<"?{div=2}">
      %iter_5624 = cute.get_iter(%view_5613) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5625, %e1_5626, %e2_5627, %e3_5628 = cute.get_leaves(%iter_5624) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1800 = cute.get_scalars(%e0_5625) : !cute.int_tuple<"?">
      %1801 = cute.get_scalars(%e1_5626) : !cute.int_tuple<"?">
      %1802 = cute.get_scalars(%e2_5627) : !cute.int_tuple<"?">
      %1803 = cute.get_scalars(%e3_5628) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5629 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5630 = cute.add_offset(%e3_5628, %int_tuple_5629) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1804 = cute.get_scalars(%tup_5630) : !cute.int_tuple<"?">
      %coord_5631 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5632 = cute.make_coord(%tup_5630) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1805 = cute.elem_less(%coord_5631, %coord_5632) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5633 = cute.get_layout(%1789) : !memref_rmem_f32_4
      %1806 = cute.get_shape(%lay_5633) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5634, %e1_5635, %e2_5636, %e3_5637 = cute.get_leaves(%1806) : !cute.shape<"((2,2),(2,8))">
      %1807 = cute.get_stride(%lay_5633) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5638, %e1_5639, %e2_5640, %e3_5641 = cute.get_leaves(%1807) : !cute.stride<"((2,4),(1,8))">
      %1808 = scf.if %1805 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1789) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,4)">
        cute.memref.store(%1789, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,4)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1789) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1789 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1789) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1789) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1789 : !memref_rmem_f32_4
      }
      %iter_5642 = cute.get_iter(%1808) : !memref_rmem_f32_4
      %lay_5643 = cute.get_layout(%1808) : !memref_rmem_f32_4
      %1809 = cute.get_shape(%lay_5643) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5644, %e1_5645, %e2_5646, %e3_5647 = cute.get_leaves(%1809) : !cute.shape<"((2,2),(2,8))">
      %1810 = cute.get_stride(%lay_5643) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5648, %e1_5649, %e2_5650, %e3_5651 = cute.get_leaves(%1810) : !cute.stride<"((2,4),(1,8))">
      %iter_5652 = cute.get_iter(%1808) : !memref_rmem_f32_4
      %iter_5653 = cute.get_iter(%1808) : !memref_rmem_f32_4
      %coord_5654 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_5655 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5656 = cute.crd2idx(%coord_5654, %lay_5655) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_5657 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5658 = cute.add_offset(%iter_5657, %idx_5656) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5659 = cute.make_view(%tup_5658) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5660 = cute.get_iter(%view_5659) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5661, %e1_5662, %e2_5663, %e3_5664 = cute.get_leaves(%iter_5660) : !cute.int_tuple<"(?,?,?,?)">
      %1811 = cute.get_scalars(%e0_5661) : !cute.int_tuple<"?">
      %1812 = cute.get_scalars(%e1_5662) : !cute.int_tuple<"?">
      %1813 = cute.get_scalars(%e2_5663) : !cute.int_tuple<"?">
      %1814 = cute.get_scalars(%e3_5664) : !cute.int_tuple<"?">
      %iter_5665 = cute.get_iter(%view_5659) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5666, %e1_5667, %e2_5668, %e3_5669 = cute.get_leaves(%iter_5665) : !cute.int_tuple<"(?,?,?,?)">
      %1815 = cute.get_scalars(%e0_5666) : !cute.int_tuple<"?">
      %1816 = cute.get_scalars(%e1_5667) : !cute.int_tuple<"?">
      %1817 = cute.get_scalars(%e2_5668) : !cute.int_tuple<"?">
      %1818 = cute.get_scalars(%e3_5669) : !cute.int_tuple<"?">
      %iter_5670 = cute.get_iter(%view_5659) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5671, %e1_5672, %e2_5673, %e3_5674 = cute.get_leaves(%iter_5670) : !cute.int_tuple<"(?,?,?,?)">
      %1819 = cute.get_scalars(%e0_5671) : !cute.int_tuple<"?">
      %1820 = cute.get_scalars(%e1_5672) : !cute.int_tuple<"?">
      %1821 = cute.get_scalars(%e2_5673) : !cute.int_tuple<"?">
      %1822 = cute.get_scalars(%e3_5674) : !cute.int_tuple<"?">
      %int_tuple_5675 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5676 = cute.add_offset(%e3_5674, %int_tuple_5675) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1823 = cute.get_scalars(%tup_5676) : !cute.int_tuple<"?">
      %coord_5677 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5678 = cute.make_coord(%tup_5676) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1824 = cute.elem_less(%coord_5677, %coord_5678) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5679 = cute.get_layout(%1808) : !memref_rmem_f32_4
      %1825 = cute.get_shape(%lay_5679) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5680, %e1_5681, %e2_5682, %e3_5683 = cute.get_leaves(%1825) : !cute.shape<"((2,2),(2,8))">
      %1826 = cute.get_stride(%lay_5679) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5684, %e1_5685, %e2_5686, %e3_5687 = cute.get_leaves(%1826) : !cute.stride<"((2,4),(1,8))">
      %1827 = scf.if %1824 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1808) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,5)">
        cute.memref.store(%1808, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,5)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1808) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1808 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1808) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1808) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1808 : !memref_rmem_f32_4
      }
      %iter_5688 = cute.get_iter(%1827) : !memref_rmem_f32_4
      %lay_5689 = cute.get_layout(%1827) : !memref_rmem_f32_4
      %1828 = cute.get_shape(%lay_5689) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5690, %e1_5691, %e2_5692, %e3_5693 = cute.get_leaves(%1828) : !cute.shape<"((2,2),(2,8))">
      %1829 = cute.get_stride(%lay_5689) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5694, %e1_5695, %e2_5696, %e3_5697 = cute.get_leaves(%1829) : !cute.stride<"((2,4),(1,8))">
      %iter_5698 = cute.get_iter(%1827) : !memref_rmem_f32_4
      %iter_5699 = cute.get_iter(%1827) : !memref_rmem_f32_4
      %coord_5700 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_5701 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5702 = cute.crd2idx(%coord_5700, %lay_5701) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_5703 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5704 = cute.add_offset(%iter_5703, %idx_5702) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5705 = cute.make_view(%tup_5704) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5706 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5707, %e1_5708, %e2_5709, %e3_5710 = cute.get_leaves(%iter_5706) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1830 = cute.get_scalars(%e0_5707) : !cute.int_tuple<"?">
      %1831 = cute.get_scalars(%e1_5708) : !cute.int_tuple<"?">
      %1832 = cute.get_scalars(%e2_5709) : !cute.int_tuple<"?">
      %1833 = cute.get_scalars(%e3_5710) : !cute.int_tuple<"?{div=2}">
      %iter_5711 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5712, %e1_5713, %e2_5714, %e3_5715 = cute.get_leaves(%iter_5711) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1834 = cute.get_scalars(%e0_5712) : !cute.int_tuple<"?">
      %1835 = cute.get_scalars(%e1_5713) : !cute.int_tuple<"?">
      %1836 = cute.get_scalars(%e2_5714) : !cute.int_tuple<"?">
      %1837 = cute.get_scalars(%e3_5715) : !cute.int_tuple<"?{div=2}">
      %iter_5716 = cute.get_iter(%view_5705) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5717, %e1_5718, %e2_5719, %e3_5720 = cute.get_leaves(%iter_5716) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1838 = cute.get_scalars(%e0_5717) : !cute.int_tuple<"?">
      %1839 = cute.get_scalars(%e1_5718) : !cute.int_tuple<"?">
      %1840 = cute.get_scalars(%e2_5719) : !cute.int_tuple<"?">
      %1841 = cute.get_scalars(%e3_5720) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5721 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5722 = cute.add_offset(%e3_5720, %int_tuple_5721) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1842 = cute.get_scalars(%tup_5722) : !cute.int_tuple<"?">
      %coord_5723 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5724 = cute.make_coord(%tup_5722) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1843 = cute.elem_less(%coord_5723, %coord_5724) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5725 = cute.get_layout(%1827) : !memref_rmem_f32_4
      %1844 = cute.get_shape(%lay_5725) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5726, %e1_5727, %e2_5728, %e3_5729 = cute.get_leaves(%1844) : !cute.shape<"((2,2),(2,8))">
      %1845 = cute.get_stride(%lay_5725) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5730, %e1_5731, %e2_5732, %e3_5733 = cute.get_leaves(%1845) : !cute.stride<"((2,4),(1,8))">
      %1846 = scf.if %1843 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1827) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,6)">
        cute.memref.store(%1827, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,6)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1827) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1827 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1827) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1827) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1827 : !memref_rmem_f32_4
      }
      %iter_5734 = cute.get_iter(%1846) : !memref_rmem_f32_4
      %lay_5735 = cute.get_layout(%1846) : !memref_rmem_f32_4
      %1847 = cute.get_shape(%lay_5735) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5736, %e1_5737, %e2_5738, %e3_5739 = cute.get_leaves(%1847) : !cute.shape<"((2,2),(2,8))">
      %1848 = cute.get_stride(%lay_5735) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5740, %e1_5741, %e2_5742, %e3_5743 = cute.get_leaves(%1848) : !cute.stride<"((2,4),(1,8))">
      %iter_5744 = cute.get_iter(%1846) : !memref_rmem_f32_4
      %iter_5745 = cute.get_iter(%1846) : !memref_rmem_f32_4
      %coord_5746 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_5747 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5748 = cute.crd2idx(%coord_5746, %lay_5747) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_5749 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5750 = cute.add_offset(%iter_5749, %idx_5748) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5751 = cute.make_view(%tup_5750) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5752 = cute.get_iter(%view_5751) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5753, %e1_5754, %e2_5755, %e3_5756 = cute.get_leaves(%iter_5752) : !cute.int_tuple<"(?,?,?,?)">
      %1849 = cute.get_scalars(%e0_5753) : !cute.int_tuple<"?">
      %1850 = cute.get_scalars(%e1_5754) : !cute.int_tuple<"?">
      %1851 = cute.get_scalars(%e2_5755) : !cute.int_tuple<"?">
      %1852 = cute.get_scalars(%e3_5756) : !cute.int_tuple<"?">
      %iter_5757 = cute.get_iter(%view_5751) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5758, %e1_5759, %e2_5760, %e3_5761 = cute.get_leaves(%iter_5757) : !cute.int_tuple<"(?,?,?,?)">
      %1853 = cute.get_scalars(%e0_5758) : !cute.int_tuple<"?">
      %1854 = cute.get_scalars(%e1_5759) : !cute.int_tuple<"?">
      %1855 = cute.get_scalars(%e2_5760) : !cute.int_tuple<"?">
      %1856 = cute.get_scalars(%e3_5761) : !cute.int_tuple<"?">
      %iter_5762 = cute.get_iter(%view_5751) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5763, %e1_5764, %e2_5765, %e3_5766 = cute.get_leaves(%iter_5762) : !cute.int_tuple<"(?,?,?,?)">
      %1857 = cute.get_scalars(%e0_5763) : !cute.int_tuple<"?">
      %1858 = cute.get_scalars(%e1_5764) : !cute.int_tuple<"?">
      %1859 = cute.get_scalars(%e2_5765) : !cute.int_tuple<"?">
      %1860 = cute.get_scalars(%e3_5766) : !cute.int_tuple<"?">
      %int_tuple_5767 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5768 = cute.add_offset(%e3_5766, %int_tuple_5767) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1861 = cute.get_scalars(%tup_5768) : !cute.int_tuple<"?">
      %coord_5769 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5770 = cute.make_coord(%tup_5768) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1862 = cute.elem_less(%coord_5769, %coord_5770) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5771 = cute.get_layout(%1846) : !memref_rmem_f32_4
      %1863 = cute.get_shape(%lay_5771) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5772, %e1_5773, %e2_5774, %e3_5775 = cute.get_leaves(%1863) : !cute.shape<"((2,2),(2,8))">
      %1864 = cute.get_stride(%lay_5771) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5776, %e1_5777, %e2_5778, %e3_5779 = cute.get_leaves(%1864) : !cute.stride<"((2,4),(1,8))">
      %1865 = scf.if %1862 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1846) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,7)">
        cute.memref.store(%1846, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,7)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1846) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1846 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1846) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1846) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1846 : !memref_rmem_f32_4
      }
      %iter_5780 = cute.get_iter(%1865) : !memref_rmem_f32_4
      %lay_5781 = cute.get_layout(%1865) : !memref_rmem_f32_4
      %1866 = cute.get_shape(%lay_5781) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5782, %e1_5783, %e2_5784, %e3_5785 = cute.get_leaves(%1866) : !cute.shape<"((2,2),(2,8))">
      %1867 = cute.get_stride(%lay_5781) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5786, %e1_5787, %e2_5788, %e3_5789 = cute.get_leaves(%1867) : !cute.stride<"((2,4),(1,8))">
      %iter_5790 = cute.get_iter(%1865) : !memref_rmem_f32_4
      %iter_5791 = cute.get_iter(%1865) : !memref_rmem_f32_4
      %coord_5792 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_5793 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5794 = cute.crd2idx(%coord_5792, %lay_5793) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_5795 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5796 = cute.add_offset(%iter_5795, %idx_5794) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5797 = cute.make_view(%tup_5796) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5798 = cute.get_iter(%view_5797) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5799, %e1_5800, %e2_5801, %e3_5802 = cute.get_leaves(%iter_5798) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1868 = cute.get_scalars(%e0_5799) : !cute.int_tuple<"?">
      %1869 = cute.get_scalars(%e1_5800) : !cute.int_tuple<"?">
      %1870 = cute.get_scalars(%e2_5801) : !cute.int_tuple<"?">
      %1871 = cute.get_scalars(%e3_5802) : !cute.int_tuple<"?{div=2}">
      %iter_5803 = cute.get_iter(%view_5797) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5804, %e1_5805, %e2_5806, %e3_5807 = cute.get_leaves(%iter_5803) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1872 = cute.get_scalars(%e0_5804) : !cute.int_tuple<"?">
      %1873 = cute.get_scalars(%e1_5805) : !cute.int_tuple<"?">
      %1874 = cute.get_scalars(%e2_5806) : !cute.int_tuple<"?">
      %1875 = cute.get_scalars(%e3_5807) : !cute.int_tuple<"?{div=2}">
      %iter_5808 = cute.get_iter(%view_5797) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5809, %e1_5810, %e2_5811, %e3_5812 = cute.get_leaves(%iter_5808) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1876 = cute.get_scalars(%e0_5809) : !cute.int_tuple<"?">
      %1877 = cute.get_scalars(%e1_5810) : !cute.int_tuple<"?">
      %1878 = cute.get_scalars(%e2_5811) : !cute.int_tuple<"?">
      %1879 = cute.get_scalars(%e3_5812) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5813 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5814 = cute.add_offset(%e3_5812, %int_tuple_5813) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1880 = cute.get_scalars(%tup_5814) : !cute.int_tuple<"?">
      %coord_5815 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5816 = cute.make_coord(%tup_5814) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1881 = cute.elem_less(%coord_5815, %coord_5816) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5817 = cute.get_layout(%1865) : !memref_rmem_f32_4
      %1882 = cute.get_shape(%lay_5817) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5818, %e1_5819, %e2_5820, %e3_5821 = cute.get_leaves(%1882) : !cute.shape<"((2,2),(2,8))">
      %1883 = cute.get_stride(%lay_5817) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5822, %e1_5823, %e2_5824, %e3_5825 = cute.get_leaves(%1883) : !cute.stride<"((2,4),(1,8))">
      %1884 = scf.if %1881 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1865) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,8)">
        cute.memref.store(%1865, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,8)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1865) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1865 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1865) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1865) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1865 : !memref_rmem_f32_4
      }
      %iter_5826 = cute.get_iter(%1884) : !memref_rmem_f32_4
      %lay_5827 = cute.get_layout(%1884) : !memref_rmem_f32_4
      %1885 = cute.get_shape(%lay_5827) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5828, %e1_5829, %e2_5830, %e3_5831 = cute.get_leaves(%1885) : !cute.shape<"((2,2),(2,8))">
      %1886 = cute.get_stride(%lay_5827) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5832, %e1_5833, %e2_5834, %e3_5835 = cute.get_leaves(%1886) : !cute.stride<"((2,4),(1,8))">
      %iter_5836 = cute.get_iter(%1884) : !memref_rmem_f32_4
      %iter_5837 = cute.get_iter(%1884) : !memref_rmem_f32_4
      %coord_5838 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_5839 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5840 = cute.crd2idx(%coord_5838, %lay_5839) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_5841 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5842 = cute.add_offset(%iter_5841, %idx_5840) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5843 = cute.make_view(%tup_5842) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5844 = cute.get_iter(%view_5843) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5845, %e1_5846, %e2_5847, %e3_5848 = cute.get_leaves(%iter_5844) : !cute.int_tuple<"(?,?,?,?)">
      %1887 = cute.get_scalars(%e0_5845) : !cute.int_tuple<"?">
      %1888 = cute.get_scalars(%e1_5846) : !cute.int_tuple<"?">
      %1889 = cute.get_scalars(%e2_5847) : !cute.int_tuple<"?">
      %1890 = cute.get_scalars(%e3_5848) : !cute.int_tuple<"?">
      %iter_5849 = cute.get_iter(%view_5843) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5850, %e1_5851, %e2_5852, %e3_5853 = cute.get_leaves(%iter_5849) : !cute.int_tuple<"(?,?,?,?)">
      %1891 = cute.get_scalars(%e0_5850) : !cute.int_tuple<"?">
      %1892 = cute.get_scalars(%e1_5851) : !cute.int_tuple<"?">
      %1893 = cute.get_scalars(%e2_5852) : !cute.int_tuple<"?">
      %1894 = cute.get_scalars(%e3_5853) : !cute.int_tuple<"?">
      %iter_5854 = cute.get_iter(%view_5843) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5855, %e1_5856, %e2_5857, %e3_5858 = cute.get_leaves(%iter_5854) : !cute.int_tuple<"(?,?,?,?)">
      %1895 = cute.get_scalars(%e0_5855) : !cute.int_tuple<"?">
      %1896 = cute.get_scalars(%e1_5856) : !cute.int_tuple<"?">
      %1897 = cute.get_scalars(%e2_5857) : !cute.int_tuple<"?">
      %1898 = cute.get_scalars(%e3_5858) : !cute.int_tuple<"?">
      %int_tuple_5859 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5860 = cute.add_offset(%e3_5858, %int_tuple_5859) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1899 = cute.get_scalars(%tup_5860) : !cute.int_tuple<"?">
      %coord_5861 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5862 = cute.make_coord(%tup_5860) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1900 = cute.elem_less(%coord_5861, %coord_5862) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5863 = cute.get_layout(%1884) : !memref_rmem_f32_4
      %1901 = cute.get_shape(%lay_5863) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5864, %e1_5865, %e2_5866, %e3_5867 = cute.get_leaves(%1901) : !cute.shape<"((2,2),(2,8))">
      %1902 = cute.get_stride(%lay_5863) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5868, %e1_5869, %e2_5870, %e3_5871 = cute.get_leaves(%1902) : !cute.stride<"((2,4),(1,8))">
      %1903 = scf.if %1900 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1884) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,9)">
        cute.memref.store(%1884, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,9)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1884) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1884 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1884) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1884) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1884 : !memref_rmem_f32_4
      }
      %iter_5872 = cute.get_iter(%1903) : !memref_rmem_f32_4
      %lay_5873 = cute.get_layout(%1903) : !memref_rmem_f32_4
      %1904 = cute.get_shape(%lay_5873) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5874, %e1_5875, %e2_5876, %e3_5877 = cute.get_leaves(%1904) : !cute.shape<"((2,2),(2,8))">
      %1905 = cute.get_stride(%lay_5873) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5878, %e1_5879, %e2_5880, %e3_5881 = cute.get_leaves(%1905) : !cute.stride<"((2,4),(1,8))">
      %iter_5882 = cute.get_iter(%1903) : !memref_rmem_f32_4
      %iter_5883 = cute.get_iter(%1903) : !memref_rmem_f32_4
      %coord_5884 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5885 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5886 = cute.crd2idx(%coord_5884, %lay_5885) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5887 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5888 = cute.add_offset(%iter_5887, %idx_5886) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5889 = cute.make_view(%tup_5888) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5890 = cute.get_iter(%view_5889) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5891, %e1_5892, %e2_5893, %e3_5894 = cute.get_leaves(%iter_5890) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1906 = cute.get_scalars(%e0_5891) : !cute.int_tuple<"?">
      %1907 = cute.get_scalars(%e1_5892) : !cute.int_tuple<"?">
      %1908 = cute.get_scalars(%e2_5893) : !cute.int_tuple<"?">
      %1909 = cute.get_scalars(%e3_5894) : !cute.int_tuple<"?{div=2}">
      %iter_5895 = cute.get_iter(%view_5889) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5896, %e1_5897, %e2_5898, %e3_5899 = cute.get_leaves(%iter_5895) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1910 = cute.get_scalars(%e0_5896) : !cute.int_tuple<"?">
      %1911 = cute.get_scalars(%e1_5897) : !cute.int_tuple<"?">
      %1912 = cute.get_scalars(%e2_5898) : !cute.int_tuple<"?">
      %1913 = cute.get_scalars(%e3_5899) : !cute.int_tuple<"?{div=2}">
      %iter_5900 = cute.get_iter(%view_5889) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5901, %e1_5902, %e2_5903, %e3_5904 = cute.get_leaves(%iter_5900) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1914 = cute.get_scalars(%e0_5901) : !cute.int_tuple<"?">
      %1915 = cute.get_scalars(%e1_5902) : !cute.int_tuple<"?">
      %1916 = cute.get_scalars(%e2_5903) : !cute.int_tuple<"?">
      %1917 = cute.get_scalars(%e3_5904) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5905 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5906 = cute.add_offset(%e3_5904, %int_tuple_5905) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1918 = cute.get_scalars(%tup_5906) : !cute.int_tuple<"?">
      %coord_5907 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5908 = cute.make_coord(%tup_5906) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1919 = cute.elem_less(%coord_5907, %coord_5908) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5909 = cute.get_layout(%1903) : !memref_rmem_f32_4
      %1920 = cute.get_shape(%lay_5909) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5910, %e1_5911, %e2_5912, %e3_5913 = cute.get_leaves(%1920) : !cute.shape<"((2,2),(2,8))">
      %1921 = cute.get_stride(%lay_5909) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5914, %e1_5915, %e2_5916, %e3_5917 = cute.get_leaves(%1921) : !cute.stride<"((2,4),(1,8))">
      %1922 = scf.if %1919 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1903) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,10)">
        cute.memref.store(%1903, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,10)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1903) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1903 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1903) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1903) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1903 : !memref_rmem_f32_4
      }
      %iter_5918 = cute.get_iter(%1922) : !memref_rmem_f32_4
      %lay_5919 = cute.get_layout(%1922) : !memref_rmem_f32_4
      %1923 = cute.get_shape(%lay_5919) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5920, %e1_5921, %e2_5922, %e3_5923 = cute.get_leaves(%1923) : !cute.shape<"((2,2),(2,8))">
      %1924 = cute.get_stride(%lay_5919) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5924, %e1_5925, %e2_5926, %e3_5927 = cute.get_leaves(%1924) : !cute.stride<"((2,4),(1,8))">
      %iter_5928 = cute.get_iter(%1922) : !memref_rmem_f32_4
      %iter_5929 = cute.get_iter(%1922) : !memref_rmem_f32_4
      %coord_5930 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5931 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5932 = cute.crd2idx(%coord_5930, %lay_5931) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5933 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5934 = cute.add_offset(%iter_5933, %idx_5932) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5935 = cute.make_view(%tup_5934) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5936 = cute.get_iter(%view_5935) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5937, %e1_5938, %e2_5939, %e3_5940 = cute.get_leaves(%iter_5936) : !cute.int_tuple<"(?,?,?,?)">
      %1925 = cute.get_scalars(%e0_5937) : !cute.int_tuple<"?">
      %1926 = cute.get_scalars(%e1_5938) : !cute.int_tuple<"?">
      %1927 = cute.get_scalars(%e2_5939) : !cute.int_tuple<"?">
      %1928 = cute.get_scalars(%e3_5940) : !cute.int_tuple<"?">
      %iter_5941 = cute.get_iter(%view_5935) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5942, %e1_5943, %e2_5944, %e3_5945 = cute.get_leaves(%iter_5941) : !cute.int_tuple<"(?,?,?,?)">
      %1929 = cute.get_scalars(%e0_5942) : !cute.int_tuple<"?">
      %1930 = cute.get_scalars(%e1_5943) : !cute.int_tuple<"?">
      %1931 = cute.get_scalars(%e2_5944) : !cute.int_tuple<"?">
      %1932 = cute.get_scalars(%e3_5945) : !cute.int_tuple<"?">
      %iter_5946 = cute.get_iter(%view_5935) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5947, %e1_5948, %e2_5949, %e3_5950 = cute.get_leaves(%iter_5946) : !cute.int_tuple<"(?,?,?,?)">
      %1933 = cute.get_scalars(%e0_5947) : !cute.int_tuple<"?">
      %1934 = cute.get_scalars(%e1_5948) : !cute.int_tuple<"?">
      %1935 = cute.get_scalars(%e2_5949) : !cute.int_tuple<"?">
      %1936 = cute.get_scalars(%e3_5950) : !cute.int_tuple<"?">
      %int_tuple_5951 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5952 = cute.add_offset(%e3_5950, %int_tuple_5951) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1937 = cute.get_scalars(%tup_5952) : !cute.int_tuple<"?">
      %coord_5953 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5954 = cute.make_coord(%tup_5952) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1938 = cute.elem_less(%coord_5953, %coord_5954) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5955 = cute.get_layout(%1922) : !memref_rmem_f32_4
      %1939 = cute.get_shape(%lay_5955) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5956, %e1_5957, %e2_5958, %e3_5959 = cute.get_leaves(%1939) : !cute.shape<"((2,2),(2,8))">
      %1940 = cute.get_stride(%lay_5955) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5960, %e1_5961, %e2_5962, %e3_5963 = cute.get_leaves(%1940) : !cute.stride<"((2,4),(1,8))">
      %1941 = scf.if %1938 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1922) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,11)">
        cute.memref.store(%1922, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,11)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1922) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1922 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1922) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1922) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1922 : !memref_rmem_f32_4
      }
      %iter_5964 = cute.get_iter(%1941) : !memref_rmem_f32_4
      %lay_5965 = cute.get_layout(%1941) : !memref_rmem_f32_4
      %1942 = cute.get_shape(%lay_5965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5966, %e1_5967, %e2_5968, %e3_5969 = cute.get_leaves(%1942) : !cute.shape<"((2,2),(2,8))">
      %1943 = cute.get_stride(%lay_5965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5970, %e1_5971, %e2_5972, %e3_5973 = cute.get_leaves(%1943) : !cute.stride<"((2,4),(1,8))">
      %iter_5974 = cute.get_iter(%1941) : !memref_rmem_f32_4
      %iter_5975 = cute.get_iter(%1941) : !memref_rmem_f32_4
      %coord_5976 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5977 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5978 = cute.crd2idx(%coord_5976, %lay_5977) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5979 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5980 = cute.add_offset(%iter_5979, %idx_5978) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5981 = cute.make_view(%tup_5980) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5982 = cute.get_iter(%view_5981) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5983, %e1_5984, %e2_5985, %e3_5986 = cute.get_leaves(%iter_5982) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1944 = cute.get_scalars(%e0_5983) : !cute.int_tuple<"?">
      %1945 = cute.get_scalars(%e1_5984) : !cute.int_tuple<"?">
      %1946 = cute.get_scalars(%e2_5985) : !cute.int_tuple<"?">
      %1947 = cute.get_scalars(%e3_5986) : !cute.int_tuple<"?{div=2}">
      %iter_5987 = cute.get_iter(%view_5981) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5988, %e1_5989, %e2_5990, %e3_5991 = cute.get_leaves(%iter_5987) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1948 = cute.get_scalars(%e0_5988) : !cute.int_tuple<"?">
      %1949 = cute.get_scalars(%e1_5989) : !cute.int_tuple<"?">
      %1950 = cute.get_scalars(%e2_5990) : !cute.int_tuple<"?">
      %1951 = cute.get_scalars(%e3_5991) : !cute.int_tuple<"?{div=2}">
      %iter_5992 = cute.get_iter(%view_5981) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5993, %e1_5994, %e2_5995, %e3_5996 = cute.get_leaves(%iter_5992) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1952 = cute.get_scalars(%e0_5993) : !cute.int_tuple<"?">
      %1953 = cute.get_scalars(%e1_5994) : !cute.int_tuple<"?">
      %1954 = cute.get_scalars(%e2_5995) : !cute.int_tuple<"?">
      %1955 = cute.get_scalars(%e3_5996) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5997 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5998 = cute.add_offset(%e3_5996, %int_tuple_5997) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1956 = cute.get_scalars(%tup_5998) : !cute.int_tuple<"?">
      %coord_5999 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6000 = cute.make_coord(%tup_5998) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1957 = cute.elem_less(%coord_5999, %coord_6000) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6001 = cute.get_layout(%1941) : !memref_rmem_f32_4
      %1958 = cute.get_shape(%lay_6001) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6002, %e1_6003, %e2_6004, %e3_6005 = cute.get_leaves(%1958) : !cute.shape<"((2,2),(2,8))">
      %1959 = cute.get_stride(%lay_6001) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6006, %e1_6007, %e2_6008, %e3_6009 = cute.get_leaves(%1959) : !cute.stride<"((2,4),(1,8))">
      %1960 = scf.if %1957 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1941) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,12)">
        cute.memref.store(%1941, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,12)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1941) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1941 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1941) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1941) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1941 : !memref_rmem_f32_4
      }
      %iter_6010 = cute.get_iter(%1960) : !memref_rmem_f32_4
      %lay_6011 = cute.get_layout(%1960) : !memref_rmem_f32_4
      %1961 = cute.get_shape(%lay_6011) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6012, %e1_6013, %e2_6014, %e3_6015 = cute.get_leaves(%1961) : !cute.shape<"((2,2),(2,8))">
      %1962 = cute.get_stride(%lay_6011) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6016, %e1_6017, %e2_6018, %e3_6019 = cute.get_leaves(%1962) : !cute.stride<"((2,4),(1,8))">
      %iter_6020 = cute.get_iter(%1960) : !memref_rmem_f32_4
      %iter_6021 = cute.get_iter(%1960) : !memref_rmem_f32_4
      %coord_6022 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_6023 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6024 = cute.crd2idx(%coord_6022, %lay_6023) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_6025 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6026 = cute.add_offset(%iter_6025, %idx_6024) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6027 = cute.make_view(%tup_6026) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6028 = cute.get_iter(%view_6027) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6029, %e1_6030, %e2_6031, %e3_6032 = cute.get_leaves(%iter_6028) : !cute.int_tuple<"(?,?,?,?)">
      %1963 = cute.get_scalars(%e0_6029) : !cute.int_tuple<"?">
      %1964 = cute.get_scalars(%e1_6030) : !cute.int_tuple<"?">
      %1965 = cute.get_scalars(%e2_6031) : !cute.int_tuple<"?">
      %1966 = cute.get_scalars(%e3_6032) : !cute.int_tuple<"?">
      %iter_6033 = cute.get_iter(%view_6027) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6034, %e1_6035, %e2_6036, %e3_6037 = cute.get_leaves(%iter_6033) : !cute.int_tuple<"(?,?,?,?)">
      %1967 = cute.get_scalars(%e0_6034) : !cute.int_tuple<"?">
      %1968 = cute.get_scalars(%e1_6035) : !cute.int_tuple<"?">
      %1969 = cute.get_scalars(%e2_6036) : !cute.int_tuple<"?">
      %1970 = cute.get_scalars(%e3_6037) : !cute.int_tuple<"?">
      %iter_6038 = cute.get_iter(%view_6027) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6039, %e1_6040, %e2_6041, %e3_6042 = cute.get_leaves(%iter_6038) : !cute.int_tuple<"(?,?,?,?)">
      %1971 = cute.get_scalars(%e0_6039) : !cute.int_tuple<"?">
      %1972 = cute.get_scalars(%e1_6040) : !cute.int_tuple<"?">
      %1973 = cute.get_scalars(%e2_6041) : !cute.int_tuple<"?">
      %1974 = cute.get_scalars(%e3_6042) : !cute.int_tuple<"?">
      %int_tuple_6043 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6044 = cute.add_offset(%e3_6042, %int_tuple_6043) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1975 = cute.get_scalars(%tup_6044) : !cute.int_tuple<"?">
      %coord_6045 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6046 = cute.make_coord(%tup_6044) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1976 = cute.elem_less(%coord_6045, %coord_6046) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6047 = cute.get_layout(%1960) : !memref_rmem_f32_4
      %1977 = cute.get_shape(%lay_6047) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6048, %e1_6049, %e2_6050, %e3_6051 = cute.get_leaves(%1977) : !cute.shape<"((2,2),(2,8))">
      %1978 = cute.get_stride(%lay_6047) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6052, %e1_6053, %e2_6054, %e3_6055 = cute.get_leaves(%1978) : !cute.stride<"((2,4),(1,8))">
      %1979 = scf.if %1976 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1960) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,13)">
        cute.memref.store(%1960, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,13)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1960) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1960 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1960) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1960) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1960 : !memref_rmem_f32_4
      }
      %iter_6056 = cute.get_iter(%1979) : !memref_rmem_f32_4
      %lay_6057 = cute.get_layout(%1979) : !memref_rmem_f32_4
      %1980 = cute.get_shape(%lay_6057) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6058, %e1_6059, %e2_6060, %e3_6061 = cute.get_leaves(%1980) : !cute.shape<"((2,2),(2,8))">
      %1981 = cute.get_stride(%lay_6057) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6062, %e1_6063, %e2_6064, %e3_6065 = cute.get_leaves(%1981) : !cute.stride<"((2,4),(1,8))">
      %iter_6066 = cute.get_iter(%1979) : !memref_rmem_f32_4
      %iter_6067 = cute.get_iter(%1979) : !memref_rmem_f32_4
      %coord_6068 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_6069 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6070 = cute.crd2idx(%coord_6068, %lay_6069) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_6071 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6072 = cute.add_offset(%iter_6071, %idx_6070) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_6073 = cute.make_view(%tup_6072) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_6074 = cute.get_iter(%view_6073) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6075, %e1_6076, %e2_6077, %e3_6078 = cute.get_leaves(%iter_6074) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1982 = cute.get_scalars(%e0_6075) : !cute.int_tuple<"?">
      %1983 = cute.get_scalars(%e1_6076) : !cute.int_tuple<"?">
      %1984 = cute.get_scalars(%e2_6077) : !cute.int_tuple<"?">
      %1985 = cute.get_scalars(%e3_6078) : !cute.int_tuple<"?{div=2}">
      %iter_6079 = cute.get_iter(%view_6073) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6080, %e1_6081, %e2_6082, %e3_6083 = cute.get_leaves(%iter_6079) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1986 = cute.get_scalars(%e0_6080) : !cute.int_tuple<"?">
      %1987 = cute.get_scalars(%e1_6081) : !cute.int_tuple<"?">
      %1988 = cute.get_scalars(%e2_6082) : !cute.int_tuple<"?">
      %1989 = cute.get_scalars(%e3_6083) : !cute.int_tuple<"?{div=2}">
      %iter_6084 = cute.get_iter(%view_6073) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6085, %e1_6086, %e2_6087, %e3_6088 = cute.get_leaves(%iter_6084) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1990 = cute.get_scalars(%e0_6085) : !cute.int_tuple<"?">
      %1991 = cute.get_scalars(%e1_6086) : !cute.int_tuple<"?">
      %1992 = cute.get_scalars(%e2_6087) : !cute.int_tuple<"?">
      %1993 = cute.get_scalars(%e3_6088) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6089 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6090 = cute.add_offset(%e3_6088, %int_tuple_6089) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1994 = cute.get_scalars(%tup_6090) : !cute.int_tuple<"?">
      %coord_6091 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6092 = cute.make_coord(%tup_6090) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1995 = cute.elem_less(%coord_6091, %coord_6092) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6093 = cute.get_layout(%1979) : !memref_rmem_f32_4
      %1996 = cute.get_shape(%lay_6093) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6094, %e1_6095, %e2_6096, %e3_6097 = cute.get_leaves(%1996) : !cute.shape<"((2,2),(2,8))">
      %1997 = cute.get_stride(%lay_6093) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6098, %e1_6099, %e2_6100, %e3_6101 = cute.get_leaves(%1997) : !cute.stride<"((2,4),(1,8))">
      %1998 = scf.if %1995 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1979) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,14)">
        cute.memref.store(%1979, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,14)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1979) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1979 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1979) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1979) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1979 : !memref_rmem_f32_4
      }
      %iter_6102 = cute.get_iter(%1998) : !memref_rmem_f32_4
      %lay_6103 = cute.get_layout(%1998) : !memref_rmem_f32_4
      %1999 = cute.get_shape(%lay_6103) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6104, %e1_6105, %e2_6106, %e3_6107 = cute.get_leaves(%1999) : !cute.shape<"((2,2),(2,8))">
      %2000 = cute.get_stride(%lay_6103) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6108, %e1_6109, %e2_6110, %e3_6111 = cute.get_leaves(%2000) : !cute.stride<"((2,4),(1,8))">
      %iter_6112 = cute.get_iter(%1998) : !memref_rmem_f32_4
      %iter_6113 = cute.get_iter(%1998) : !memref_rmem_f32_4
      %coord_6114 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_6115 = cute.get_layout(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6116 = cute.crd2idx(%coord_6114, %lay_6115) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_6117 = cute.get_iter(%view_3079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6118 = cute.add_offset(%iter_6117, %idx_6116) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6119 = cute.make_view(%tup_6118) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6120 = cute.get_iter(%view_6119) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6121, %e1_6122, %e2_6123, %e3_6124 = cute.get_leaves(%iter_6120) : !cute.int_tuple<"(?,?,?,?)">
      %2001 = cute.get_scalars(%e0_6121) : !cute.int_tuple<"?">
      %2002 = cute.get_scalars(%e1_6122) : !cute.int_tuple<"?">
      %2003 = cute.get_scalars(%e2_6123) : !cute.int_tuple<"?">
      %2004 = cute.get_scalars(%e3_6124) : !cute.int_tuple<"?">
      %iter_6125 = cute.get_iter(%view_6119) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6126, %e1_6127, %e2_6128, %e3_6129 = cute.get_leaves(%iter_6125) : !cute.int_tuple<"(?,?,?,?)">
      %2005 = cute.get_scalars(%e0_6126) : !cute.int_tuple<"?">
      %2006 = cute.get_scalars(%e1_6127) : !cute.int_tuple<"?">
      %2007 = cute.get_scalars(%e2_6128) : !cute.int_tuple<"?">
      %2008 = cute.get_scalars(%e3_6129) : !cute.int_tuple<"?">
      %iter_6130 = cute.get_iter(%view_6119) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6131, %e1_6132, %e2_6133, %e3_6134 = cute.get_leaves(%iter_6130) : !cute.int_tuple<"(?,?,?,?)">
      %2009 = cute.get_scalars(%e0_6131) : !cute.int_tuple<"?">
      %2010 = cute.get_scalars(%e1_6132) : !cute.int_tuple<"?">
      %2011 = cute.get_scalars(%e2_6133) : !cute.int_tuple<"?">
      %2012 = cute.get_scalars(%e3_6134) : !cute.int_tuple<"?">
      %int_tuple_6135 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6136 = cute.add_offset(%e3_6134, %int_tuple_6135) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2013 = cute.get_scalars(%tup_6136) : !cute.int_tuple<"?">
      %coord_6137 = cute.make_coord(%itup_2984) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6138 = cute.make_coord(%tup_6136) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2014 = cute.elem_less(%coord_6137, %coord_6138) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6139 = cute.get_layout(%1998) : !memref_rmem_f32_4
      %2015 = cute.get_shape(%lay_6139) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6140, %e1_6141, %e2_6142, %e3_6143 = cute.get_leaves(%2015) : !cute.shape<"((2,2),(2,8))">
      %2016 = cute.get_stride(%lay_6139) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6144, %e1_6145, %e2_6146, %e3_6147 = cute.get_leaves(%2016) : !cute.stride<"((2,4),(1,8))">
      %2017 = scf.if %2014 -> (!memref_rmem_f32_4) {
        %iter_7829 = cute.get_iter(%1998) : !memref_rmem_f32_4
        %cst_7830 = arith.constant 0xFF800000 : f32
        %coord_7831 = cute.make_coord() : () -> !cute.coord<"(3,15)">
        cute.memref.store(%1998, %coord_7831, %cst_7830) : (!memref_rmem_f32_4, !cute.coord<"(3,15)">, f32) -> ()
        %lay_7832 = cute.get_layout(%1998) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7833, %e1_7834, %e2_7835, %e3_7836 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7832) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7837, %e1_7838, %e2_7839, %e3_7840 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1998 : !memref_rmem_f32_4
      } else {
        %iter_7829 = cute.get_iter(%1998) : !memref_rmem_f32_4
        %lay_7830 = cute.get_layout(%1998) : !memref_rmem_f32_4
        %2493 = cute.get_shape(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7831, %e1_7832, %e2_7833, %e3_7834 = cute.get_leaves(%2493) : !cute.shape<"((2,2),(2,8))">
        %2494 = cute.get_stride(%lay_7830) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%2494) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1998 : !memref_rmem_f32_4
      }
      %iter_6148 = cute.get_iter(%2017) : !memref_rmem_f32_4
      %lay_6149 = cute.get_layout(%2017) : !memref_rmem_f32_4
      %2018 = cute.get_shape(%lay_6149) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6150, %e1_6151, %e2_6152, %e3_6153 = cute.get_leaves(%2018) : !cute.shape<"((2,2),(2,8))">
      %2019 = cute.get_stride(%lay_6149) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6154, %e1_6155, %e2_6156, %e3_6157 = cute.get_leaves(%2019) : !cute.stride<"((2,4),(1,8))">
      %iter_6158 = cute.get_iter(%2017) : !memref_rmem_f32_4
      %iter_6159 = cute.get_iter(%2017) : !memref_rmem_f32_4
      %coord_6160 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6161 = cute.get_layout(%2017) : !memref_rmem_f32_4
      %idx_6162 = cute.crd2idx(%coord_6160, %lay_6161) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6163 = cute.get_iter(%2017) : !memref_rmem_f32_4
      %ptr_6164 = cute.add_offset(%iter_6163, %idx_6162) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6165 = cute.make_view(%ptr_6164) : !memref_rmem_f32_7
      %iter_6166 = cute.get_iter(%view_6165) : !memref_rmem_f32_7
      %iter_6167 = cute.get_iter(%view_6165) : !memref_rmem_f32_7
      %lay_6168 = cute.get_layout(%view_6165) : !memref_rmem_f32_7
      %2020 = cute.get_shape(%lay_6168) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6169, %e1_6170 = cute.get_leaves(%2020) : !cute.shape<"((2,8))">
      %2021 = cute.memref.load_vec %view_6165 : !memref_rmem_f32_7
      %cst_6171 = arith.constant 0xFF800000 : f32
      %2022 = vector.reduction <maximumf>, %2021, %cst_6171 : vector<16xf32> into f32
      %c-1_i32_6172 = arith.constant -1 : i32
      %c2_i32_6173 = arith.constant 2 : i32
      %c31_i32_6174 = arith.constant 31 : i32
      %2023 = nvvm.shfl.sync  bfly %c-1_i32_6172, %2022, %c2_i32_6173, %c31_i32_6174 : f32 -> f32
      %2024 = nvvm.fmax %2022, %2023
      %c-1_i32_6175 = arith.constant -1 : i32
      %c1_i32_6176 = arith.constant 1 : i32
      %c31_i32_6177 = arith.constant 31 : i32
      %2025 = nvvm.shfl.sync  bfly %c-1_i32_6175, %2024, %c1_i32_6176, %c31_i32_6177 : f32 -> f32
      %2026 = nvvm.fmax %2024, %2025
      %2027 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2028 = arith.mulf %2021, %2027 : vector<16xf32>
      %2029 = arith.mulf %2026, %arg4 : f32
      %2030 = vector.broadcast %2029 : f32 to vector<16xf32>
      %2031 = arith.subf %2028, %2030 : vector<16xf32>
      %2032 = math.exp2 %2031 fastmath<fast> : vector<16xf32>
      %cst_6178 = arith.constant 0.000000e+00 : f32
      %2033 = vector.reduction <add>, %2032, %cst_6178 : vector<16xf32> into f32
      %coord_6179 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1075, %coord_6179, %2026) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6180 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1080, %coord_6180, %2033) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6181 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6182 = cute.get_layout(%2017) : !memref_rmem_f32_4
      %idx_6183 = cute.crd2idx(%coord_6181, %lay_6182) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6184 = cute.get_iter(%2017) : !memref_rmem_f32_4
      %ptr_6185 = cute.add_offset(%iter_6184, %idx_6183) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6186 = cute.make_view(%ptr_6185) : !memref_rmem_f32_7
      %iter_6187 = cute.get_iter(%view_6186) : !memref_rmem_f32_7
      %iter_6188 = cute.get_iter(%view_6186) : !memref_rmem_f32_7
      %lay_6189 = cute.get_layout(%view_6186) : !memref_rmem_f32_7
      %2034 = cute.get_shape(%lay_6189) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6190, %e1_6191 = cute.get_leaves(%2034) : !cute.shape<"((2,8))">
      %int_tuple_6192 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6193 = cute.size(%int_tuple_6192) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6194 = cute.get_leaves(%sz_6193) : !cute.int_tuple<"16">
      %int_tuple_6195 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6196 = cute.size(%int_tuple_6195) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6197 = cute.get_leaves(%sz_6196) : !cute.int_tuple<"16">
      cute.memref.store_vec %2032, %view_6186 : !memref_rmem_f32_7
      %lay_6198 = cute.get_layout(%rmem_1114) : !memref_rmem_f32_2
      %2035 = cute.make_layout_like(%lay_6198) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_6199 = cute.memref.alloca(%2035) : !memref_rmem_bf16_16
      %iter_6200 = cute.get_iter(%rmem_6199) : !memref_rmem_bf16_16
      %iter_6201 = cute.get_iter(%rmem_6199) : !memref_rmem_bf16_16
      %2036 = cute.memref.load_vec %rmem_1114 : !memref_rmem_f32_2
      %2037 = arith.truncf %2036 : vector<64xf32> to vector<64xbf16>
      %lay_6202 = cute.get_layout(%rmem_6199) : !memref_rmem_bf16_16
      %2038 = cute.get_shape(%lay_6202) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_6203, %e1_6204, %e2_6205, %e3_6206 = cute.get_leaves(%2038) : !cute.shape<"((2,2),2,8)">
      %int_tuple_6207 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6208 = cute.size(%int_tuple_6207) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6209 = cute.get_leaves(%sz_6208) : !cute.int_tuple<"64">
      %int_tuple_6210 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6211 = cute.size(%int_tuple_6210) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6212 = cute.get_leaves(%sz_6211) : !cute.int_tuple<"64">
      cute.memref.store_vec %2037, %rmem_6199 : !memref_rmem_bf16_16
      %lay_6213 = cute.get_layout(%rmem_6199) : !memref_rmem_bf16_16
      %tile_6214 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
      %lay_6215 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
      %2039 = cute.get_shape(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6216, %e1_6217, %e2_6218, %e3_6219, %e4_6220 = cute.get_leaves(%2039) : !cute.shape<"((2,2),2,(2,4))">
      %2040 = cute.get_shape(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6221, %e1_6222, %e2_6223, %e3_6224, %e4_6225 = cute.get_leaves(%2040) : !cute.shape<"((2,2),2,(2,4))">
      %2041 = cute.get_shape(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6226, %e1_6227, %e2_6228, %e3_6229, %e4_6230 = cute.get_leaves(%2041) : !cute.shape<"((2,2),2,(2,4))">
      %2042 = cute.get_shape(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6231, %e1_6232, %e2_6233, %e3_6234, %e4_6235 = cute.get_leaves(%2042) : !cute.shape<"((2,2),2,(2,4))">
      %2043 = cute.get_stride(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6236, %e1_6237, %e2_6238, %e3_6239, %e4_6240 = cute.get_leaves(%2043) : !cute.stride<"((1,2),4,(8,16))">
      %2044 = cute.get_stride(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6241, %e1_6242, %e2_6243, %e3_6244, %e4_6245 = cute.get_leaves(%2044) : !cute.stride<"((1,2),4,(8,16))">
      %2045 = cute.get_stride(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6246, %e1_6247, %e2_6248, %e3_6249, %e4_6250 = cute.get_leaves(%2045) : !cute.stride<"((1,2),4,(8,16))">
      %2046 = cute.get_stride(%lay_6215) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6251, %e1_6252, %e2_6253, %e3_6254, %e4_6255 = cute.get_leaves(%2046) : !cute.stride<"((1,2),4,(8,16))">
      %shape_6256 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
      %stride_6257 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
      %lay_6258 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
      %view_6259 = cute.make_view(%iter_6201, %lay_6258) : !memref_rmem_bf16_17
      %iter_6260 = cute.get_iter(%view_6259) : !memref_rmem_bf16_17
      %coord_6261 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6262 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
      %slice_6263 = cute.slice(%lay_6262, %coord_6261) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
      %idx_6264 = cute.crd2idx(%coord_6261, %lay_6262) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6265 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %ptr_6266 = cute.add_offset(%iter_6265, %idx_6264) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6267 = cute.make_view(%ptr_6266, %slice_6263) : !memref_smem_bf16_19
      %iter_6268 = cute.get_iter(%view_6267) : !memref_smem_bf16_19
      %iter_6269 = cute.get_iter(%view_6267) : !memref_smem_bf16_19
      %coord_6270 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6271 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
      %idx_6272 = cute.crd2idx(%coord_6270, %lay_6271) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6273 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %ptr_6274 = cute.add_offset(%iter_6273, %idx_6272) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6275 = cute.make_view(%ptr_6274) : !memref_rmem_bf16_18
      %iter_6276 = cute.get_iter(%view_6275) : !memref_rmem_bf16_18
      %iter_6277 = cute.get_iter(%view_6275) : !memref_rmem_bf16_18
      %lay_6278 = cute.get_layout(%view_6267) : !memref_smem_bf16_19
      %2047 = cute.get_shape(%lay_6278) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6279, %e1_6280, %e2_6281, %e3_6282, %e4_6283 = cute.get_leaves(%2047) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6284 = cute.get_layout(%view_6275) : !memref_rmem_bf16_18
      %2048 = cute.get_shape(%lay_6284) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6285, %e1_6286, %e2_6287, %e3_6288 = cute.get_leaves(%2048) : !cute.shape<"((8,1),(4,2))">
      %lay_6289 = cute.get_layout(%view_6267) : !memref_smem_bf16_19
      %shape_6290 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6291 = cute.make_layout() : !cute.layout<"1:0">
      %append_6292 = cute.append_to_rank<2> (%lay_6289, %lay_6291) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6293 = cute.make_view(%iter_6269, %append_6292) : !memref_smem_bf16_19
      %iter_6294 = cute.get_iter(%view_6293) : !memref_smem_bf16_19
      %lay_6295 = cute.get_layout(%view_6293) : !memref_smem_bf16_19
      %2049 = cute.get_shape(%lay_6295) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6296, %e1_6297, %e2_6298, %e3_6299, %e4_6300 = cute.get_leaves(%2049) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6301 = cute.get_iter(%view_6293) : !memref_smem_bf16_19
      %lay_6302 = cute.get_layout(%view_6293) : !memref_smem_bf16_19
      %2050:2 = cute.get_scalars(%lay_6302) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6303 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6304 = cute.assume(%2050#0) : (i32) -> !cute.i32<divby 16>
      %iv_6305 = cute.assume(%2050#1) : (i32) -> !cute.i32<divby 32>
      %stride_6306 = cute.make_stride(%iv_6304, %iv_6305) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6307 = cute.make_layout(%shape_6303, %stride_6306) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6308 = cute.make_view(%iter_6301, %lay_6307) : !memref_smem_bf16_20
      %iter_6309 = cute.get_iter(%view_6308) : !memref_smem_bf16_20
      %iter_6310 = cute.get_iter(%view_6308) : !memref_smem_bf16_20
      %lay_6311 = cute.get_layout(%view_6275) : !memref_rmem_bf16_18
      %shape_6312 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6313 = cute.make_layout() : !cute.layout<"1:0">
      %append_6314 = cute.append_to_rank<2> (%lay_6311, %lay_6313) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6315 = cute.make_view(%iter_6277, %append_6314) : !memref_rmem_bf16_18
      %iter_6316 = cute.get_iter(%view_6315) : !memref_rmem_bf16_18
      %lay_6317 = cute.get_layout(%view_6315) : !memref_rmem_bf16_18
      %2051 = cute.get_shape(%lay_6317) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6318, %e1_6319, %e2_6320, %e3_6321 = cute.get_leaves(%2051) : !cute.shape<"((8,1),(4,2))">
      %iter_6322 = cute.get_iter(%view_6315) : !memref_rmem_bf16_18
      %view_6323 = cute.make_view(%iter_6322) : !memref_rmem_bf16_19
      %iter_6324 = cute.get_iter(%view_6323) : !memref_rmem_bf16_19
      %iter_6325 = cute.get_iter(%view_6323) : !memref_rmem_bf16_19
      %lay_6326 = cute.get_layout(%view_6308) : !memref_smem_bf16_20
      %2052 = cute.get_shape(%lay_6326) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6327, %e1_6328, %e2_6329, %e3_6330, %e4_6331 = cute.get_leaves(%2052) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6332 = cute.get_layout(%view_6323) : !memref_rmem_bf16_19
      %2053 = cute.get_shape(%lay_6332) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6333, %e1_6334, %e2_6335, %e3_6336 = cute.get_leaves(%2053) : !cute.shape<"((8,1),((4,2)))">
      %lay_6337 = cute.get_layout(%view_6308) : !memref_smem_bf16_20
      %sz_6338 = cute.size(%lay_6337) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6339 = cute.get_leaves(%sz_6338) : !cute.int_tuple<"8">
      %lay_6340 = cute.get_layout(%view_6323) : !memref_rmem_bf16_19
      %sz_6341 = cute.size(%lay_6340) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6342 = cute.get_leaves(%sz_6341) : !cute.int_tuple<"8">
      %2054 = cute.static : !cute.layout<"1:0">
      %iter_6343 = cute.get_iter(%view_6308) : !memref_smem_bf16_20
      %iter_6344 = cute.get_iter(%view_6323) : !memref_rmem_bf16_19
      %lay_6345 = cute.get_layout(%view_6308) : !memref_smem_bf16_20
      %lay_6346 = cute.get_layout(%view_6323) : !memref_rmem_bf16_19
      %append_6347 = cute.append_to_rank<2> (%lay_6345, %2054) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6348 = cute.append_to_rank<2> (%lay_6346, %2054) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2055:2 = cute.get_scalars(%append_6347) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6349 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6350 = cute.assume(%2055#0) : (i32) -> !cute.i32<divby 16>
      %iv_6351 = cute.assume(%2055#1) : (i32) -> !cute.i32<divby 32>
      %stride_6352 = cute.make_stride(%iv_6350, %iv_6351) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6353 = cute.make_layout(%shape_6349, %stride_6352) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6354 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6355 = cute.size(%lay_6353) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2056 = cute.get_scalars(%sz_6355) : !cute.int_tuple<"8">
      %c0_i32_6356 = arith.constant 0 : i32
      %c1_i32_6357 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6356 to %2056 step %c1_i32_6357  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_6353, %coord_7829) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_6353) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7832 = cute.add_offset(%iter_6343, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_6354, %coord_7829) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_6354) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_6344, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7833, %view_7837) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_6358 = cute.get_layout(%view_6259) : !memref_rmem_bf16_17
      %2057 = cute.get_shape(%lay_6358) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
      %e0_6359, %e1_6360, %e2_6361, %e3_6362, %e4_6363 = cute.get_leaves(%2057) : !cute.shape<"(((2,2),2),2,4)">
      %int_tuple_6364 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6365 = cute.size(%int_tuple_6364) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6366 = cute.get_leaves(%sz_6365) : !cute.int_tuple<"4">
      %int_tuple_6367 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6368 = cute.size(%int_tuple_6367) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6369 = cute.get_leaves(%sz_6368) : !cute.int_tuple<"4">
      %coord_6370 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6371 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
      %slice_6372 = cute.slice(%lay_6371, %coord_6370) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
      %idx_6373 = cute.crd2idx(%coord_6370, %lay_6371) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
      %iter_6374 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %ptr_6375 = cute.add_offset(%iter_6374, %idx_6373) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6376 = cute.make_view(%ptr_6375, %slice_6372) : !memref_smem_bf16_19
      %iter_6377 = cute.get_iter(%view_6376) : !memref_smem_bf16_19
      %iter_6378 = cute.get_iter(%view_6376) : !memref_smem_bf16_19
      %coord_6379 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6380 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
      %idx_6381 = cute.crd2idx(%coord_6379, %lay_6380) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
      %iter_6382 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %ptr_6383 = cute.add_offset(%iter_6382, %idx_6381) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6384 = cute.make_view(%ptr_6383) : !memref_rmem_bf16_18
      %iter_6385 = cute.get_iter(%view_6384) : !memref_rmem_bf16_18
      %iter_6386 = cute.get_iter(%view_6384) : !memref_rmem_bf16_18
      %lay_6387 = cute.get_layout(%view_6376) : !memref_smem_bf16_19
      %2058 = cute.get_shape(%lay_6387) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6388, %e1_6389, %e2_6390, %e3_6391, %e4_6392 = cute.get_leaves(%2058) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6393 = cute.get_layout(%view_6384) : !memref_rmem_bf16_18
      %2059 = cute.get_shape(%lay_6393) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6394, %e1_6395, %e2_6396, %e3_6397 = cute.get_leaves(%2059) : !cute.shape<"((8,1),(4,2))">
      %lay_6398 = cute.get_layout(%view_6376) : !memref_smem_bf16_19
      %shape_6399 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6400 = cute.make_layout() : !cute.layout<"1:0">
      %append_6401 = cute.append_to_rank<2> (%lay_6398, %lay_6400) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6402 = cute.make_view(%iter_6378, %append_6401) : !memref_smem_bf16_19
      %iter_6403 = cute.get_iter(%view_6402) : !memref_smem_bf16_19
      %lay_6404 = cute.get_layout(%view_6402) : !memref_smem_bf16_19
      %2060 = cute.get_shape(%lay_6404) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6405, %e1_6406, %e2_6407, %e3_6408, %e4_6409 = cute.get_leaves(%2060) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6410 = cute.get_iter(%view_6402) : !memref_smem_bf16_19
      %lay_6411 = cute.get_layout(%view_6402) : !memref_smem_bf16_19
      %2061:2 = cute.get_scalars(%lay_6411) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6412 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6413 = cute.assume(%2061#0) : (i32) -> !cute.i32<divby 16>
      %iv_6414 = cute.assume(%2061#1) : (i32) -> !cute.i32<divby 32>
      %stride_6415 = cute.make_stride(%iv_6413, %iv_6414) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6416 = cute.make_layout(%shape_6412, %stride_6415) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6417 = cute.make_view(%iter_6410, %lay_6416) : !memref_smem_bf16_20
      %iter_6418 = cute.get_iter(%view_6417) : !memref_smem_bf16_20
      %iter_6419 = cute.get_iter(%view_6417) : !memref_smem_bf16_20
      %lay_6420 = cute.get_layout(%view_6384) : !memref_rmem_bf16_18
      %shape_6421 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6422 = cute.make_layout() : !cute.layout<"1:0">
      %append_6423 = cute.append_to_rank<2> (%lay_6420, %lay_6422) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6424 = cute.make_view(%iter_6386, %append_6423) : !memref_rmem_bf16_18
      %iter_6425 = cute.get_iter(%view_6424) : !memref_rmem_bf16_18
      %lay_6426 = cute.get_layout(%view_6424) : !memref_rmem_bf16_18
      %2062 = cute.get_shape(%lay_6426) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6427, %e1_6428, %e2_6429, %e3_6430 = cute.get_leaves(%2062) : !cute.shape<"((8,1),(4,2))">
      %iter_6431 = cute.get_iter(%view_6424) : !memref_rmem_bf16_18
      %view_6432 = cute.make_view(%iter_6431) : !memref_rmem_bf16_19
      %iter_6433 = cute.get_iter(%view_6432) : !memref_rmem_bf16_19
      %iter_6434 = cute.get_iter(%view_6432) : !memref_rmem_bf16_19
      %lay_6435 = cute.get_layout(%view_6417) : !memref_smem_bf16_20
      %2063 = cute.get_shape(%lay_6435) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6436, %e1_6437, %e2_6438, %e3_6439, %e4_6440 = cute.get_leaves(%2063) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6441 = cute.get_layout(%view_6432) : !memref_rmem_bf16_19
      %2064 = cute.get_shape(%lay_6441) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6442, %e1_6443, %e2_6444, %e3_6445 = cute.get_leaves(%2064) : !cute.shape<"((8,1),((4,2)))">
      %lay_6446 = cute.get_layout(%view_6417) : !memref_smem_bf16_20
      %sz_6447 = cute.size(%lay_6446) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6448 = cute.get_leaves(%sz_6447) : !cute.int_tuple<"8">
      %lay_6449 = cute.get_layout(%view_6432) : !memref_rmem_bf16_19
      %sz_6450 = cute.size(%lay_6449) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6451 = cute.get_leaves(%sz_6450) : !cute.int_tuple<"8">
      %2065 = cute.static : !cute.layout<"1:0">
      %iter_6452 = cute.get_iter(%view_6417) : !memref_smem_bf16_20
      %iter_6453 = cute.get_iter(%view_6432) : !memref_rmem_bf16_19
      %lay_6454 = cute.get_layout(%view_6417) : !memref_smem_bf16_20
      %lay_6455 = cute.get_layout(%view_6432) : !memref_rmem_bf16_19
      %append_6456 = cute.append_to_rank<2> (%lay_6454, %2065) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6457 = cute.append_to_rank<2> (%lay_6455, %2065) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2066:2 = cute.get_scalars(%append_6456) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6458 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6459 = cute.assume(%2066#0) : (i32) -> !cute.i32<divby 16>
      %iv_6460 = cute.assume(%2066#1) : (i32) -> !cute.i32<divby 32>
      %stride_6461 = cute.make_stride(%iv_6459, %iv_6460) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6462 = cute.make_layout(%shape_6458, %stride_6461) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6463 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6464 = cute.size(%lay_6462) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2067 = cute.get_scalars(%sz_6464) : !cute.int_tuple<"8">
      %c0_i32_6465 = arith.constant 0 : i32
      %c1_i32_6466 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6465 to %2067 step %c1_i32_6466  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_6462, %coord_7829) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_6462) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7832 = cute.add_offset(%iter_6452, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_6463, %coord_7829) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_6463) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_6453, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7833, %view_7837) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6467 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6468 = cute.get_layout(%view_6259) : !memref_rmem_bf16_17
      %idx_6469 = cute.crd2idx(%coord_6467, %lay_6468) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
      %iter_6470 = cute.get_iter(%view_6259) : !memref_rmem_bf16_17
      %ptr_6471 = cute.add_offset(%iter_6470, %idx_6469) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6472 = cute.make_view(%ptr_6471) : !memref_rmem_bf16_20
      %iter_6473 = cute.get_iter(%view_6472) : !memref_rmem_bf16_20
      %iter_6474 = cute.get_iter(%view_6472) : !memref_rmem_bf16_20
      %coord_6475 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6476 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
      %idx_6477 = cute.crd2idx(%coord_6475, %lay_6476) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
      %iter_6478 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
      %ptr_6479 = cute.add_offset(%iter_6478, %idx_6477) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6480 = cute.make_view(%ptr_6479) : !memref_rmem_bf16_21
      %iter_6481 = cute.get_iter(%view_6480) : !memref_rmem_bf16_21
      %iter_6482 = cute.get_iter(%view_6480) : !memref_rmem_bf16_21
      %lay_6483 = cute.get_layout(%view_6472) : !memref_rmem_bf16_20
      %2068 = cute.get_shape(%lay_6483) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6484, %e1_6485, %e2_6486, %e3_6487 = cute.get_leaves(%2068) : !cute.shape<"(((2,2),2),2)">
      %lay_6488 = cute.get_layout(%view_6480) : !memref_rmem_bf16_21
      %2069 = cute.get_shape(%lay_6488) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6489, %e1_6490, %e2_6491, %e3_6492 = cute.get_leaves(%2069) : !cute.shape<"((2,2),(8,2))">
      %lay_6493 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2070 = cute.get_shape(%lay_6493) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6494, %e1_6495, %e2_6496, %e3_6497 = cute.get_leaves(%2070) : !cute.shape<"((2,2),2,16)">
      %iter_6498 = cute.get_iter(%view_6472) : !memref_rmem_bf16_20
      %iter_6499 = cute.get_iter(%view_6480) : !memref_rmem_bf16_21
      %iter_6500 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6501 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6502 = cute.get_layout(%view_6472) : !memref_rmem_bf16_20
      %lay_6503 = cute.get_layout(%view_6480) : !memref_rmem_bf16_21
      %lay_6504 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6505 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2071 = cute.static : !cute.layout<"1:0">
      %append_6506 = cute.append_to_rank<3> (%lay_6502, %2071) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6507 = cute.append_to_rank<3> (%lay_6503, %2071) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6508 = cute.size(%append_6506) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6509 = cute.size(%append_6506) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6510 = cute.size(%append_6507) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2072 = cute.get_scalars(%sz_6508) : !cute.int_tuple<"1">
      %2073 = cute.get_scalars(%sz_6509) : !cute.int_tuple<"2">
      %2074 = cute.get_scalars(%sz_6510) : !cute.int_tuple<"16">
      %c0_i32_6511 = arith.constant 0 : i32
      %c1_i32_6512 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6511 to %2072 step %c1_i32_6512  : i32 {
        scf.for %arg6 = %c0_i32_6511 to %2073 step %c1_i32_6512  : i32 {
          scf.for %arg7 = %c0_i32_6511 to %2074 step %c1_i32_6512  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_6506, %coord_7829) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_6506) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7834 = cute.add_offset(%iter_6498, %idx_7833) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_22
            %slice_7836 = cute.slice(%append_6507, %coord_7830) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_6507) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_6499, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_6504, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_6504) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_6500, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_6505, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_6505) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_6501, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6513 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6514 = cute.size(%int_tuple_6513) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6515 = cute.get_leaves(%sz_6514) : !cute.int_tuple<"4">
      %coord_6516 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6517 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
      %slice_6518 = cute.slice(%lay_6517, %coord_6516) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
      %idx_6519 = cute.crd2idx(%coord_6516, %lay_6517) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
      %iter_6520 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %ptr_6521 = cute.add_offset(%iter_6520, %idx_6519) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6522 = cute.make_view(%ptr_6521, %slice_6518) : !memref_smem_bf16_19
      %iter_6523 = cute.get_iter(%view_6522) : !memref_smem_bf16_19
      %iter_6524 = cute.get_iter(%view_6522) : !memref_smem_bf16_19
      %coord_6525 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6526 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
      %idx_6527 = cute.crd2idx(%coord_6525, %lay_6526) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
      %iter_6528 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %ptr_6529 = cute.add_offset(%iter_6528, %idx_6527) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6530 = cute.make_view(%ptr_6529) : !memref_rmem_bf16_18
      %iter_6531 = cute.get_iter(%view_6530) : !memref_rmem_bf16_18
      %iter_6532 = cute.get_iter(%view_6530) : !memref_rmem_bf16_18
      %lay_6533 = cute.get_layout(%view_6522) : !memref_smem_bf16_19
      %2075 = cute.get_shape(%lay_6533) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6534, %e1_6535, %e2_6536, %e3_6537, %e4_6538 = cute.get_leaves(%2075) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6539 = cute.get_layout(%view_6530) : !memref_rmem_bf16_18
      %2076 = cute.get_shape(%lay_6539) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6540, %e1_6541, %e2_6542, %e3_6543 = cute.get_leaves(%2076) : !cute.shape<"((8,1),(4,2))">
      %lay_6544 = cute.get_layout(%view_6522) : !memref_smem_bf16_19
      %shape_6545 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6546 = cute.make_layout() : !cute.layout<"1:0">
      %append_6547 = cute.append_to_rank<2> (%lay_6544, %lay_6546) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6548 = cute.make_view(%iter_6524, %append_6547) : !memref_smem_bf16_19
      %iter_6549 = cute.get_iter(%view_6548) : !memref_smem_bf16_19
      %lay_6550 = cute.get_layout(%view_6548) : !memref_smem_bf16_19
      %2077 = cute.get_shape(%lay_6550) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6551, %e1_6552, %e2_6553, %e3_6554, %e4_6555 = cute.get_leaves(%2077) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6556 = cute.get_iter(%view_6548) : !memref_smem_bf16_19
      %lay_6557 = cute.get_layout(%view_6548) : !memref_smem_bf16_19
      %2078:2 = cute.get_scalars(%lay_6557) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6558 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6559 = cute.assume(%2078#0) : (i32) -> !cute.i32<divby 16>
      %iv_6560 = cute.assume(%2078#1) : (i32) -> !cute.i32<divby 32>
      %stride_6561 = cute.make_stride(%iv_6559, %iv_6560) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6562 = cute.make_layout(%shape_6558, %stride_6561) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6563 = cute.make_view(%iter_6556, %lay_6562) : !memref_smem_bf16_20
      %iter_6564 = cute.get_iter(%view_6563) : !memref_smem_bf16_20
      %iter_6565 = cute.get_iter(%view_6563) : !memref_smem_bf16_20
      %lay_6566 = cute.get_layout(%view_6530) : !memref_rmem_bf16_18
      %shape_6567 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6568 = cute.make_layout() : !cute.layout<"1:0">
      %append_6569 = cute.append_to_rank<2> (%lay_6566, %lay_6568) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6570 = cute.make_view(%iter_6532, %append_6569) : !memref_rmem_bf16_18
      %iter_6571 = cute.get_iter(%view_6570) : !memref_rmem_bf16_18
      %lay_6572 = cute.get_layout(%view_6570) : !memref_rmem_bf16_18
      %2079 = cute.get_shape(%lay_6572) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6573, %e1_6574, %e2_6575, %e3_6576 = cute.get_leaves(%2079) : !cute.shape<"((8,1),(4,2))">
      %iter_6577 = cute.get_iter(%view_6570) : !memref_rmem_bf16_18
      %view_6578 = cute.make_view(%iter_6577) : !memref_rmem_bf16_19
      %iter_6579 = cute.get_iter(%view_6578) : !memref_rmem_bf16_19
      %iter_6580 = cute.get_iter(%view_6578) : !memref_rmem_bf16_19
      %lay_6581 = cute.get_layout(%view_6563) : !memref_smem_bf16_20
      %2080 = cute.get_shape(%lay_6581) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6582, %e1_6583, %e2_6584, %e3_6585, %e4_6586 = cute.get_leaves(%2080) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6587 = cute.get_layout(%view_6578) : !memref_rmem_bf16_19
      %2081 = cute.get_shape(%lay_6587) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6588, %e1_6589, %e2_6590, %e3_6591 = cute.get_leaves(%2081) : !cute.shape<"((8,1),((4,2)))">
      %lay_6592 = cute.get_layout(%view_6563) : !memref_smem_bf16_20
      %sz_6593 = cute.size(%lay_6592) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6594 = cute.get_leaves(%sz_6593) : !cute.int_tuple<"8">
      %lay_6595 = cute.get_layout(%view_6578) : !memref_rmem_bf16_19
      %sz_6596 = cute.size(%lay_6595) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6597 = cute.get_leaves(%sz_6596) : !cute.int_tuple<"8">
      %2082 = cute.static : !cute.layout<"1:0">
      %iter_6598 = cute.get_iter(%view_6563) : !memref_smem_bf16_20
      %iter_6599 = cute.get_iter(%view_6578) : !memref_rmem_bf16_19
      %lay_6600 = cute.get_layout(%view_6563) : !memref_smem_bf16_20
      %lay_6601 = cute.get_layout(%view_6578) : !memref_rmem_bf16_19
      %append_6602 = cute.append_to_rank<2> (%lay_6600, %2082) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6603 = cute.append_to_rank<2> (%lay_6601, %2082) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2083:2 = cute.get_scalars(%append_6602) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6604 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6605 = cute.assume(%2083#0) : (i32) -> !cute.i32<divby 16>
      %iv_6606 = cute.assume(%2083#1) : (i32) -> !cute.i32<divby 32>
      %stride_6607 = cute.make_stride(%iv_6605, %iv_6606) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6608 = cute.make_layout(%shape_6604, %stride_6607) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6609 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6610 = cute.size(%lay_6608) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2084 = cute.get_scalars(%sz_6610) : !cute.int_tuple<"8">
      %c0_i32_6611 = arith.constant 0 : i32
      %c1_i32_6612 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6611 to %2084 step %c1_i32_6612  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_6608, %coord_7829) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_6608) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7832 = cute.add_offset(%iter_6598, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_6609, %coord_7829) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_6609) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_6599, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7833, %view_7837) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6613 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6614 = cute.get_layout(%view_6259) : !memref_rmem_bf16_17
      %idx_6615 = cute.crd2idx(%coord_6613, %lay_6614) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
      %iter_6616 = cute.get_iter(%view_6259) : !memref_rmem_bf16_17
      %ptr_6617 = cute.add_offset(%iter_6616, %idx_6615) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6618 = cute.make_view(%ptr_6617) : !memref_rmem_bf16_20
      %iter_6619 = cute.get_iter(%view_6618) : !memref_rmem_bf16_20
      %iter_6620 = cute.get_iter(%view_6618) : !memref_rmem_bf16_20
      %coord_6621 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6622 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
      %idx_6623 = cute.crd2idx(%coord_6621, %lay_6622) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
      %iter_6624 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
      %ptr_6625 = cute.add_offset(%iter_6624, %idx_6623) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6626 = cute.make_view(%ptr_6625) : !memref_rmem_bf16_21
      %iter_6627 = cute.get_iter(%view_6626) : !memref_rmem_bf16_21
      %iter_6628 = cute.get_iter(%view_6626) : !memref_rmem_bf16_21
      %lay_6629 = cute.get_layout(%view_6618) : !memref_rmem_bf16_20
      %2085 = cute.get_shape(%lay_6629) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6630, %e1_6631, %e2_6632, %e3_6633 = cute.get_leaves(%2085) : !cute.shape<"(((2,2),2),2)">
      %lay_6634 = cute.get_layout(%view_6626) : !memref_rmem_bf16_21
      %2086 = cute.get_shape(%lay_6634) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6635, %e1_6636, %e2_6637, %e3_6638 = cute.get_leaves(%2086) : !cute.shape<"((2,2),(8,2))">
      %iter_6639 = cute.get_iter(%view_6618) : !memref_rmem_bf16_20
      %iter_6640 = cute.get_iter(%view_6626) : !memref_rmem_bf16_21
      %iter_6641 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6642 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6643 = cute.get_layout(%view_6618) : !memref_rmem_bf16_20
      %lay_6644 = cute.get_layout(%view_6626) : !memref_rmem_bf16_21
      %lay_6645 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6646 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2087 = cute.static : !cute.layout<"1:0">
      %append_6647 = cute.append_to_rank<3> (%lay_6643, %2087) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6648 = cute.append_to_rank<3> (%lay_6644, %2087) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6649 = cute.size(%append_6647) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6650 = cute.size(%append_6647) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6651 = cute.size(%append_6648) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2088 = cute.get_scalars(%sz_6649) : !cute.int_tuple<"1">
      %2089 = cute.get_scalars(%sz_6650) : !cute.int_tuple<"2">
      %2090 = cute.get_scalars(%sz_6651) : !cute.int_tuple<"16">
      %c0_i32_6652 = arith.constant 0 : i32
      %c1_i32_6653 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6652 to %2088 step %c1_i32_6653  : i32 {
        scf.for %arg6 = %c0_i32_6652 to %2089 step %c1_i32_6653  : i32 {
          scf.for %arg7 = %c0_i32_6652 to %2090 step %c1_i32_6653  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_6647, %coord_7829) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_6647) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7834 = cute.add_offset(%iter_6639, %idx_7833) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_22
            %slice_7836 = cute.slice(%append_6648, %coord_7830) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_6648) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_6640, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_6645, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_6645) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_6641, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_6646, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_6646) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_6642, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6654 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6655 = cute.size(%int_tuple_6654) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6656 = cute.get_leaves(%sz_6655) : !cute.int_tuple<"4">
      %coord_6657 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6658 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
      %slice_6659 = cute.slice(%lay_6658, %coord_6657) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
      %idx_6660 = cute.crd2idx(%coord_6657, %lay_6658) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
      %iter_6661 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %ptr_6662 = cute.add_offset(%iter_6661, %idx_6660) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6663 = cute.make_view(%ptr_6662, %slice_6659) : !memref_smem_bf16_19
      %iter_6664 = cute.get_iter(%view_6663) : !memref_smem_bf16_19
      %iter_6665 = cute.get_iter(%view_6663) : !memref_smem_bf16_19
      %coord_6666 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6667 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
      %idx_6668 = cute.crd2idx(%coord_6666, %lay_6667) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
      %iter_6669 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %ptr_6670 = cute.add_offset(%iter_6669, %idx_6668) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6671 = cute.make_view(%ptr_6670) : !memref_rmem_bf16_18
      %iter_6672 = cute.get_iter(%view_6671) : !memref_rmem_bf16_18
      %iter_6673 = cute.get_iter(%view_6671) : !memref_rmem_bf16_18
      %lay_6674 = cute.get_layout(%view_6663) : !memref_smem_bf16_19
      %2091 = cute.get_shape(%lay_6674) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6675, %e1_6676, %e2_6677, %e3_6678, %e4_6679 = cute.get_leaves(%2091) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6680 = cute.get_layout(%view_6671) : !memref_rmem_bf16_18
      %2092 = cute.get_shape(%lay_6680) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6681, %e1_6682, %e2_6683, %e3_6684 = cute.get_leaves(%2092) : !cute.shape<"((8,1),(4,2))">
      %lay_6685 = cute.get_layout(%view_6663) : !memref_smem_bf16_19
      %shape_6686 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6687 = cute.make_layout() : !cute.layout<"1:0">
      %append_6688 = cute.append_to_rank<2> (%lay_6685, %lay_6687) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6689 = cute.make_view(%iter_6665, %append_6688) : !memref_smem_bf16_19
      %iter_6690 = cute.get_iter(%view_6689) : !memref_smem_bf16_19
      %lay_6691 = cute.get_layout(%view_6689) : !memref_smem_bf16_19
      %2093 = cute.get_shape(%lay_6691) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6692, %e1_6693, %e2_6694, %e3_6695, %e4_6696 = cute.get_leaves(%2093) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6697 = cute.get_iter(%view_6689) : !memref_smem_bf16_19
      %lay_6698 = cute.get_layout(%view_6689) : !memref_smem_bf16_19
      %2094:2 = cute.get_scalars(%lay_6698) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6699 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6700 = cute.assume(%2094#0) : (i32) -> !cute.i32<divby 16>
      %iv_6701 = cute.assume(%2094#1) : (i32) -> !cute.i32<divby 32>
      %stride_6702 = cute.make_stride(%iv_6700, %iv_6701) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6703 = cute.make_layout(%shape_6699, %stride_6702) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6704 = cute.make_view(%iter_6697, %lay_6703) : !memref_smem_bf16_20
      %iter_6705 = cute.get_iter(%view_6704) : !memref_smem_bf16_20
      %iter_6706 = cute.get_iter(%view_6704) : !memref_smem_bf16_20
      %lay_6707 = cute.get_layout(%view_6671) : !memref_rmem_bf16_18
      %shape_6708 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6709 = cute.make_layout() : !cute.layout<"1:0">
      %append_6710 = cute.append_to_rank<2> (%lay_6707, %lay_6709) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6711 = cute.make_view(%iter_6673, %append_6710) : !memref_rmem_bf16_18
      %iter_6712 = cute.get_iter(%view_6711) : !memref_rmem_bf16_18
      %lay_6713 = cute.get_layout(%view_6711) : !memref_rmem_bf16_18
      %2095 = cute.get_shape(%lay_6713) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6714, %e1_6715, %e2_6716, %e3_6717 = cute.get_leaves(%2095) : !cute.shape<"((8,1),(4,2))">
      %iter_6718 = cute.get_iter(%view_6711) : !memref_rmem_bf16_18
      %view_6719 = cute.make_view(%iter_6718) : !memref_rmem_bf16_19
      %iter_6720 = cute.get_iter(%view_6719) : !memref_rmem_bf16_19
      %iter_6721 = cute.get_iter(%view_6719) : !memref_rmem_bf16_19
      %lay_6722 = cute.get_layout(%view_6704) : !memref_smem_bf16_20
      %2096 = cute.get_shape(%lay_6722) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6723, %e1_6724, %e2_6725, %e3_6726, %e4_6727 = cute.get_leaves(%2096) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6728 = cute.get_layout(%view_6719) : !memref_rmem_bf16_19
      %2097 = cute.get_shape(%lay_6728) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6729, %e1_6730, %e2_6731, %e3_6732 = cute.get_leaves(%2097) : !cute.shape<"((8,1),((4,2)))">
      %lay_6733 = cute.get_layout(%view_6704) : !memref_smem_bf16_20
      %sz_6734 = cute.size(%lay_6733) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6735 = cute.get_leaves(%sz_6734) : !cute.int_tuple<"8">
      %lay_6736 = cute.get_layout(%view_6719) : !memref_rmem_bf16_19
      %sz_6737 = cute.size(%lay_6736) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6738 = cute.get_leaves(%sz_6737) : !cute.int_tuple<"8">
      %2098 = cute.static : !cute.layout<"1:0">
      %iter_6739 = cute.get_iter(%view_6704) : !memref_smem_bf16_20
      %iter_6740 = cute.get_iter(%view_6719) : !memref_rmem_bf16_19
      %lay_6741 = cute.get_layout(%view_6704) : !memref_smem_bf16_20
      %lay_6742 = cute.get_layout(%view_6719) : !memref_rmem_bf16_19
      %append_6743 = cute.append_to_rank<2> (%lay_6741, %2098) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6744 = cute.append_to_rank<2> (%lay_6742, %2098) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2099:2 = cute.get_scalars(%append_6743) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6745 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6746 = cute.assume(%2099#0) : (i32) -> !cute.i32<divby 16>
      %iv_6747 = cute.assume(%2099#1) : (i32) -> !cute.i32<divby 32>
      %stride_6748 = cute.make_stride(%iv_6746, %iv_6747) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6749 = cute.make_layout(%shape_6745, %stride_6748) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6750 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6751 = cute.size(%lay_6749) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2100 = cute.get_scalars(%sz_6751) : !cute.int_tuple<"8">
      %c0_i32_6752 = arith.constant 0 : i32
      %c1_i32_6753 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6752 to %2100 step %c1_i32_6753  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_6749, %coord_7829) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_6749) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7832 = cute.add_offset(%iter_6739, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_6750, %coord_7829) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_6750) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_6740, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7833, %view_7837) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6754 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6755 = cute.get_layout(%view_6259) : !memref_rmem_bf16_17
      %idx_6756 = cute.crd2idx(%coord_6754, %lay_6755) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
      %iter_6757 = cute.get_iter(%view_6259) : !memref_rmem_bf16_17
      %ptr_6758 = cute.add_offset(%iter_6757, %idx_6756) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6759 = cute.make_view(%ptr_6758) : !memref_rmem_bf16_20
      %iter_6760 = cute.get_iter(%view_6759) : !memref_rmem_bf16_20
      %iter_6761 = cute.get_iter(%view_6759) : !memref_rmem_bf16_20
      %coord_6762 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6763 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
      %idx_6764 = cute.crd2idx(%coord_6762, %lay_6763) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
      %iter_6765 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
      %ptr_6766 = cute.add_offset(%iter_6765, %idx_6764) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6767 = cute.make_view(%ptr_6766) : !memref_rmem_bf16_21
      %iter_6768 = cute.get_iter(%view_6767) : !memref_rmem_bf16_21
      %iter_6769 = cute.get_iter(%view_6767) : !memref_rmem_bf16_21
      %lay_6770 = cute.get_layout(%view_6759) : !memref_rmem_bf16_20
      %2101 = cute.get_shape(%lay_6770) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6771, %e1_6772, %e2_6773, %e3_6774 = cute.get_leaves(%2101) : !cute.shape<"(((2,2),2),2)">
      %lay_6775 = cute.get_layout(%view_6767) : !memref_rmem_bf16_21
      %2102 = cute.get_shape(%lay_6775) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6776, %e1_6777, %e2_6778, %e3_6779 = cute.get_leaves(%2102) : !cute.shape<"((2,2),(8,2))">
      %iter_6780 = cute.get_iter(%view_6759) : !memref_rmem_bf16_20
      %iter_6781 = cute.get_iter(%view_6767) : !memref_rmem_bf16_21
      %iter_6782 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6783 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6784 = cute.get_layout(%view_6759) : !memref_rmem_bf16_20
      %lay_6785 = cute.get_layout(%view_6767) : !memref_rmem_bf16_21
      %lay_6786 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6787 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2103 = cute.static : !cute.layout<"1:0">
      %append_6788 = cute.append_to_rank<3> (%lay_6784, %2103) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6789 = cute.append_to_rank<3> (%lay_6785, %2103) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6790 = cute.size(%append_6788) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6791 = cute.size(%append_6788) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6792 = cute.size(%append_6789) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2104 = cute.get_scalars(%sz_6790) : !cute.int_tuple<"1">
      %2105 = cute.get_scalars(%sz_6791) : !cute.int_tuple<"2">
      %2106 = cute.get_scalars(%sz_6792) : !cute.int_tuple<"16">
      %c0_i32_6793 = arith.constant 0 : i32
      %c1_i32_6794 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6793 to %2104 step %c1_i32_6794  : i32 {
        scf.for %arg6 = %c0_i32_6793 to %2105 step %c1_i32_6794  : i32 {
          scf.for %arg7 = %c0_i32_6793 to %2106 step %c1_i32_6794  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_6788, %coord_7829) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_6788) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7834 = cute.add_offset(%iter_6780, %idx_7833) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_22
            %slice_7836 = cute.slice(%append_6789, %coord_7830) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_6789) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_6781, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_6786, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_6786) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_6782, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_6787, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_6787) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_6783, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6795 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6796 = cute.size(%int_tuple_6795) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6797 = cute.get_leaves(%sz_6796) : !cute.int_tuple<"4">
      %coord_6798 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6799 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
      %slice_6800 = cute.slice(%lay_6799, %coord_6798) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
      %idx_6801 = cute.crd2idx(%coord_6798, %lay_6799) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6802 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
      %ptr_6803 = cute.add_offset(%iter_6802, %idx_6801) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6804 = cute.make_view(%ptr_6803, %slice_6800) : !memref_smem_bf16_19
      %iter_6805 = cute.get_iter(%view_6804) : !memref_smem_bf16_19
      %iter_6806 = cute.get_iter(%view_6804) : !memref_smem_bf16_19
      %coord_6807 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6808 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
      %idx_6809 = cute.crd2idx(%coord_6807, %lay_6808) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6810 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
      %ptr_6811 = cute.add_offset(%iter_6810, %idx_6809) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6812 = cute.make_view(%ptr_6811) : !memref_rmem_bf16_18
      %iter_6813 = cute.get_iter(%view_6812) : !memref_rmem_bf16_18
      %iter_6814 = cute.get_iter(%view_6812) : !memref_rmem_bf16_18
      %lay_6815 = cute.get_layout(%view_6804) : !memref_smem_bf16_19
      %2107 = cute.get_shape(%lay_6815) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6816, %e1_6817, %e2_6818, %e3_6819, %e4_6820 = cute.get_leaves(%2107) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6821 = cute.get_layout(%view_6812) : !memref_rmem_bf16_18
      %2108 = cute.get_shape(%lay_6821) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6822, %e1_6823, %e2_6824, %e3_6825 = cute.get_leaves(%2108) : !cute.shape<"((8,1),(4,2))">
      %lay_6826 = cute.get_layout(%view_6804) : !memref_smem_bf16_19
      %shape_6827 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6828 = cute.make_layout() : !cute.layout<"1:0">
      %append_6829 = cute.append_to_rank<2> (%lay_6826, %lay_6828) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6830 = cute.make_view(%iter_6806, %append_6829) : !memref_smem_bf16_19
      %iter_6831 = cute.get_iter(%view_6830) : !memref_smem_bf16_19
      %lay_6832 = cute.get_layout(%view_6830) : !memref_smem_bf16_19
      %2109 = cute.get_shape(%lay_6832) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6833, %e1_6834, %e2_6835, %e3_6836, %e4_6837 = cute.get_leaves(%2109) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6838 = cute.get_iter(%view_6830) : !memref_smem_bf16_19
      %lay_6839 = cute.get_layout(%view_6830) : !memref_smem_bf16_19
      %2110:2 = cute.get_scalars(%lay_6839) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6840 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6841 = cute.assume(%2110#0) : (i32) -> !cute.i32<divby 16>
      %iv_6842 = cute.assume(%2110#1) : (i32) -> !cute.i32<divby 32>
      %stride_6843 = cute.make_stride(%iv_6841, %iv_6842) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6844 = cute.make_layout(%shape_6840, %stride_6843) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6845 = cute.make_view(%iter_6838, %lay_6844) : !memref_smem_bf16_20
      %iter_6846 = cute.get_iter(%view_6845) : !memref_smem_bf16_20
      %iter_6847 = cute.get_iter(%view_6845) : !memref_smem_bf16_20
      %lay_6848 = cute.get_layout(%view_6812) : !memref_rmem_bf16_18
      %shape_6849 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6850 = cute.make_layout() : !cute.layout<"1:0">
      %append_6851 = cute.append_to_rank<2> (%lay_6848, %lay_6850) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6852 = cute.make_view(%iter_6814, %append_6851) : !memref_rmem_bf16_18
      %iter_6853 = cute.get_iter(%view_6852) : !memref_rmem_bf16_18
      %lay_6854 = cute.get_layout(%view_6852) : !memref_rmem_bf16_18
      %2111 = cute.get_shape(%lay_6854) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6855, %e1_6856, %e2_6857, %e3_6858 = cute.get_leaves(%2111) : !cute.shape<"((8,1),(4,2))">
      %iter_6859 = cute.get_iter(%view_6852) : !memref_rmem_bf16_18
      %view_6860 = cute.make_view(%iter_6859) : !memref_rmem_bf16_19
      %iter_6861 = cute.get_iter(%view_6860) : !memref_rmem_bf16_19
      %iter_6862 = cute.get_iter(%view_6860) : !memref_rmem_bf16_19
      %lay_6863 = cute.get_layout(%view_6845) : !memref_smem_bf16_20
      %2112 = cute.get_shape(%lay_6863) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6864, %e1_6865, %e2_6866, %e3_6867, %e4_6868 = cute.get_leaves(%2112) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6869 = cute.get_layout(%view_6860) : !memref_rmem_bf16_19
      %2113 = cute.get_shape(%lay_6869) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6870, %e1_6871, %e2_6872, %e3_6873 = cute.get_leaves(%2113) : !cute.shape<"((8,1),((4,2)))">
      %lay_6874 = cute.get_layout(%view_6845) : !memref_smem_bf16_20
      %sz_6875 = cute.size(%lay_6874) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6876 = cute.get_leaves(%sz_6875) : !cute.int_tuple<"8">
      %lay_6877 = cute.get_layout(%view_6860) : !memref_rmem_bf16_19
      %sz_6878 = cute.size(%lay_6877) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6879 = cute.get_leaves(%sz_6878) : !cute.int_tuple<"8">
      %2114 = cute.static : !cute.layout<"1:0">
      %iter_6880 = cute.get_iter(%view_6845) : !memref_smem_bf16_20
      %iter_6881 = cute.get_iter(%view_6860) : !memref_rmem_bf16_19
      %lay_6882 = cute.get_layout(%view_6845) : !memref_smem_bf16_20
      %lay_6883 = cute.get_layout(%view_6860) : !memref_rmem_bf16_19
      %append_6884 = cute.append_to_rank<2> (%lay_6882, %2114) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6885 = cute.append_to_rank<2> (%lay_6883, %2114) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2115:2 = cute.get_scalars(%append_6884) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6886 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6887 = cute.assume(%2115#0) : (i32) -> !cute.i32<divby 16>
      %iv_6888 = cute.assume(%2115#1) : (i32) -> !cute.i32<divby 32>
      %stride_6889 = cute.make_stride(%iv_6887, %iv_6888) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6890 = cute.make_layout(%shape_6886, %stride_6889) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6891 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6892 = cute.size(%lay_6890) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2116 = cute.get_scalars(%sz_6892) : !cute.int_tuple<"8">
      %c0_i32_6893 = arith.constant 0 : i32
      %c1_i32_6894 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6893 to %2116 step %c1_i32_6894  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_6890, %coord_7829) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_6890) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7832 = cute.add_offset(%iter_6880, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_6891, %coord_7829) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_6891) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_6881, %idx_7835) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7833, %view_7837) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6895 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6896 = cute.get_layout(%view_6259) : !memref_rmem_bf16_17
      %idx_6897 = cute.crd2idx(%coord_6895, %lay_6896) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
      %iter_6898 = cute.get_iter(%view_6259) : !memref_rmem_bf16_17
      %ptr_6899 = cute.add_offset(%iter_6898, %idx_6897) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6900 = cute.make_view(%ptr_6899) : !memref_rmem_bf16_20
      %iter_6901 = cute.get_iter(%view_6900) : !memref_rmem_bf16_20
      %iter_6902 = cute.get_iter(%view_6900) : !memref_rmem_bf16_20
      %coord_6903 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6904 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
      %idx_6905 = cute.crd2idx(%coord_6903, %lay_6904) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
      %iter_6906 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
      %ptr_6907 = cute.add_offset(%iter_6906, %idx_6905) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6908 = cute.make_view(%ptr_6907) : !memref_rmem_bf16_21
      %iter_6909 = cute.get_iter(%view_6908) : !memref_rmem_bf16_21
      %iter_6910 = cute.get_iter(%view_6908) : !memref_rmem_bf16_21
      %lay_6911 = cute.get_layout(%view_6900) : !memref_rmem_bf16_20
      %2117 = cute.get_shape(%lay_6911) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6912, %e1_6913, %e2_6914, %e3_6915 = cute.get_leaves(%2117) : !cute.shape<"(((2,2),2),2)">
      %lay_6916 = cute.get_layout(%view_6908) : !memref_rmem_bf16_21
      %2118 = cute.get_shape(%lay_6916) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6917, %e1_6918, %e2_6919, %e3_6920 = cute.get_leaves(%2118) : !cute.shape<"((2,2),(8,2))">
      %iter_6921 = cute.get_iter(%view_6900) : !memref_rmem_bf16_20
      %iter_6922 = cute.get_iter(%view_6908) : !memref_rmem_bf16_21
      %iter_6923 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6924 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6925 = cute.get_layout(%view_6900) : !memref_rmem_bf16_20
      %lay_6926 = cute.get_layout(%view_6908) : !memref_rmem_bf16_21
      %lay_6927 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6928 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2119 = cute.static : !cute.layout<"1:0">
      %append_6929 = cute.append_to_rank<3> (%lay_6925, %2119) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6930 = cute.append_to_rank<3> (%lay_6926, %2119) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6931 = cute.size(%append_6929) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6932 = cute.size(%append_6929) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6933 = cute.size(%append_6930) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2120 = cute.get_scalars(%sz_6931) : !cute.int_tuple<"1">
      %2121 = cute.get_scalars(%sz_6932) : !cute.int_tuple<"2">
      %2122 = cute.get_scalars(%sz_6933) : !cute.int_tuple<"16">
      %c0_i32_6934 = arith.constant 0 : i32
      %c1_i32_6935 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6934 to %2120 step %c1_i32_6935  : i32 {
        scf.for %arg6 = %c0_i32_6934 to %2121 step %c1_i32_6935  : i32 {
          scf.for %arg7 = %c0_i32_6934 to %2122 step %c1_i32_6935  : i32 {
            %coord_7829 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7830 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7831 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7832 = cute.slice(%append_6929, %coord_7829) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7833 = cute.crd2idx(%coord_7829, %append_6929) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7834 = cute.add_offset(%iter_6921, %idx_7833) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7835 = cute.make_view(%ptr_7834, %slice_7832) : !memref_rmem_bf16_22
            %slice_7836 = cute.slice(%append_6930, %coord_7830) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7837 = cute.crd2idx(%coord_7830, %append_6930) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7838 = cute.add_offset(%iter_6922, %idx_7837) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7839 = cute.make_view(%ptr_7838, %slice_7836) : !memref_rmem_bf16_15
            %slice_7840 = cute.slice(%lay_6927, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7841 = cute.crd2idx(%coord_7831, %lay_6927) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7842 = cute.add_offset(%iter_6923, %idx_7841) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7843 = cute.make_view(%ptr_7842, %slice_7840) : !memref_rmem_f32_3
            %slice_7844 = cute.slice(%lay_6928, %coord_7831) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7845 = cute.crd2idx(%coord_7831, %lay_6928) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7846 = cute.add_offset(%iter_6924, %idx_7845) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7847 = cute.make_view(%ptr_7846, %slice_7844) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7847, %view_7835, %view_7839, %view_7843) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %c1_i32_6936 = arith.constant 1 : i32
      %2123:7 = scf.for %arg5 = %c1_i32_6936 to %128 step %c1_i32_6936 iter_args(%arg6 = %502, %arg7 = %117, %arg8 = %502, %arg9 = %arg0, %arg10 = %arg1, %arg11 = %118, %arg12 = %119) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_7829 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_7830 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %lay_7831 = cute.get_layout(%arg9) : !memref_gmem_bf16_
        %2493 = cute.get_shape(%lay_7831) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7832, %e1_7833, %e2_7834, %e3_7835 = cute.get_leaves(%2493) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7836 = cute.to_int_tuple(%e0_7832) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2494 = cute.get_scalars(%itup_7836) : !cute.int_tuple<"?">
        %itup_7837 = cute.to_int_tuple(%e1_7833) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2495 = cute.get_scalars(%itup_7837) : !cute.int_tuple<"?">
        %itup_7838 = cute.to_int_tuple(%e2_7834) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2496 = cute.get_scalars(%itup_7838) : !cute.int_tuple<"?">
        %itup_7839 = cute.to_int_tuple(%e3_7835) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2497 = cute.get_scalars(%itup_7839) : !cute.int_tuple<"?{div=8}">
        %2498 = cute.get_stride(%lay_7831) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_7840, %e1_7841, %e2_7842, %e3_7843 = cute.get_leaves(%2498) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_7844 = cute.to_int_tuple(%e0_7840) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2499 = cute.get_scalars(%itup_7844) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7845 = cute.to_int_tuple(%e1_7841) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2500 = cute.get_scalars(%itup_7845) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7846 = cute.to_int_tuple(%e2_7842) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2501 = cute.get_scalars(%itup_7846) : !cute.int_tuple<"?{i64 div=8}">
        %lay_7847 = cute.get_layout(%arg10) : !memref_gmem_bf16_
        %2502 = cute.get_shape(%lay_7847) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7848, %e1_7849, %e2_7850, %e3_7851 = cute.get_leaves(%2502) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7852 = cute.to_int_tuple(%e0_7848) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2503 = cute.get_scalars(%itup_7852) : !cute.int_tuple<"?">
        %itup_7853 = cute.to_int_tuple(%e1_7849) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2504 = cute.get_scalars(%itup_7853) : !cute.int_tuple<"?">
        %itup_7854 = cute.to_int_tuple(%e2_7850) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2505 = cute.get_scalars(%itup_7854) : !cute.int_tuple<"?">
        %itup_7855 = cute.to_int_tuple(%e3_7851) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2506 = cute.get_scalars(%itup_7855) : !cute.int_tuple<"?{div=8}">
        %2507 = cute.get_stride(%lay_7847) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_7856, %e1_7857, %e2_7858, %e3_7859 = cute.get_leaves(%2507) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_7860 = cute.to_int_tuple(%e0_7856) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2508 = cute.get_scalars(%itup_7860) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7861 = cute.to_int_tuple(%e1_7857) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2509 = cute.get_scalars(%itup_7861) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7862 = cute.to_int_tuple(%e2_7858) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2510 = cute.get_scalars(%itup_7862) : !cute.int_tuple<"?{i64 div=8}">
        %iter_7863 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_7864 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %2511 = arith.subi %128, %arg5 : i32
        %c1_i32_7865 = arith.constant 1 : i32
        %2512 = arith.subi %2511, %c1_i32_7865 : i32
        %shape_7866 = cute.make_shape() : () -> !cute.shape<"(128,64)">
        %2513 = cute.tiled.mma.partition_shape C (%5, %shape_7866) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7867, %e1_7868, %e2_7869, %e3_7870 = cute.get_leaves(%2513) : !cute.shape<"((2,2),2,8)">
        %shape_7871 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_7872 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_7873 = cute.memref.alloca(%lay_7872) : !memref_rmem_f32_2
        %iter_7874 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_7875 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_7876 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %sz_7877 = cute.size(%lay_7876) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
        %e0_7878 = cute.get_leaves(%sz_7877) : !cute.int_tuple<"64">
        %lay_7879 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2514 = cute.get_shape(%lay_7879) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7880, %e1_7881, %e2_7882, %e3_7883 = cute.get_leaves(%2514) : !cute.shape<"((2,2),2,8)">
        %int_tuple_7884 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %res_7885 = cute.tuple.product(%int_tuple_7884) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7886 = cute.get_leaves(%res_7885) : !cute.int_tuple<"64">
        %cst_7887 = arith.constant 0.000000e+00 : f32
        %2515 = vector.splat %cst_7887 : vector<64xf32>
        %int_tuple_7888 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7889 = cute.size(%int_tuple_7888) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7890 = cute.get_leaves(%sz_7889) : !cute.int_tuple<"64">
        %int_tuple_7891 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7892 = cute.size(%int_tuple_7891) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7893 = cute.get_leaves(%sz_7892) : !cute.int_tuple<"64">
        cute.memref.store_vec %2515, %rmem_7873 : !memref_rmem_f32_2
        nvvm.cp.async.wait.group 0
        %c1_i32_7894 = arith.constant 1 : i32
        %c128_i32_7895 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_7894 number_of_threads = %c128_i32_7895
        %false_7896 = arith.constant false
        scf.if %false_7896 {
          %lay_10765 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %2937 = cute.get_shape(%lay_10765) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10766, %e1_10767, %e2_10768, %e3_10769 = cute.get_leaves(%2937) : !cute.shape<"((8,1),4,2)">
          %int_tuple_10770 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_10771 = cute.size(%int_tuple_10770) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_10772 = cute.get_leaves(%sz_10771) : !cute.int_tuple<"4">
          %coord_10773 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_10774 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10775 = cute.crd2idx(%coord_10773, %lay_10774) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_10776 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10777 = cute.add_offset(%iter_10776, %idx_10775) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10778 = cute.make_view(%tup_10777) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10779 = cute.get_iter(%view_10778) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10780, %e1_10781, %e2_10782, %e3_10783 = cute.get_leaves(%iter_10779) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2938 = cute.get_scalars(%e0_10780) : !cute.int_tuple<"?">
          %2939 = cute.get_scalars(%e1_10781) : !cute.int_tuple<"?">
          %2940 = cute.get_scalars(%e2_10782) : !cute.int_tuple<"?">
          %2941 = cute.get_scalars(%e3_10783) : !cute.int_tuple<"?{div=8}">
          %iter_10784 = cute.get_iter(%view_10778) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10785, %e1_10786, %e2_10787, %e3_10788 = cute.get_leaves(%iter_10784) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2942 = cute.get_scalars(%e0_10785) : !cute.int_tuple<"?">
          %2943 = cute.get_scalars(%e1_10786) : !cute.int_tuple<"?">
          %2944 = cute.get_scalars(%e2_10787) : !cute.int_tuple<"?">
          %2945 = cute.get_scalars(%e3_10788) : !cute.int_tuple<"?{div=8}">
          %iter_10789 = cute.get_iter(%view_10778) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10790, %e1_10791, %e2_10792, %e3_10793 = cute.get_leaves(%iter_10789) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2946 = cute.get_scalars(%e0_10790) : !cute.int_tuple<"?">
          %2947 = cute.get_scalars(%e1_10791) : !cute.int_tuple<"?">
          %2948 = cute.get_scalars(%e2_10792) : !cute.int_tuple<"?">
          %2949 = cute.get_scalars(%e3_10793) : !cute.int_tuple<"?{div=8}">
          %lay_10794 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2950 = cute.get_shape(%lay_10794) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10795, %e1_10796, %e2_10797, %e3_10798 = cute.get_leaves(%2950) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10799 = cute.to_int_tuple(%e0_10795) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2951 = cute.get_scalars(%itup_10799) : !cute.int_tuple<"?">
          %itup_10800 = cute.to_int_tuple(%e1_10796) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2952 = cute.get_scalars(%itup_10800) : !cute.int_tuple<"?">
          %itup_10801 = cute.to_int_tuple(%e2_10797) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2953 = cute.get_scalars(%itup_10801) : !cute.int_tuple<"?">
          %itup_10802 = cute.to_int_tuple(%e3_10798) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2954 = cute.get_scalars(%itup_10802) : !cute.int_tuple<"?{div=8}">
          %coord_10803 = cute.make_coord(%e1_10791) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10804 = cute.make_coord(%itup_10800) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2955 = cute.elem_less(%coord_10803, %coord_10804) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2955 {
            %coord_10901 = cute.make_coord(%2512) : (i32) -> !cute.coord<"(_,0,_,?)">
            %lay_10902 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_10904 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_gmem_bf16_6
            %iter_10907 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %iter_10908 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %coord_10909 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10910 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10911 = cute.crd2idx(%coord_10909, %lay_10910) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_10912 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10913 = cute.add_offset(%iter_10912, %idx_10911) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10914 = cute.make_view(%ptr_10913) : !memref_smem_bf16_14
            %iter_10915 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %iter_10916 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %coord_10917 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10918 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
            %idx_10919 = cute.crd2idx(%coord_10917, %lay_10918) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10920 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
            %ptr_10921 = cute.add_offset(%iter_10920, %idx_10919) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10922 = cute.make_view(%ptr_10921) : !memref_rmem_i8_2
            %iter_10923 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %iter_10924 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %lay_10925 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %3010 = cute.get_shape(%lay_10925) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10926, %e1_10927, %e2_10928 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %lay_10929 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %3011 = cute.get_shape(%lay_10929) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10930, %e1_10931, %e2_10932 = cute.get_leaves(%3011) : !cute.shape<"((8,1),2)">
            %lay_10933 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %shape_10934 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10935 = cute.make_layout() : !cute.layout<"1:0">
            %append_10936 = cute.append_to_rank<2> (%lay_10933, %lay_10935) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10937 = cute.make_view(%iter_10908, %append_10936) : !memref_gmem_bf16_6
            %iter_10938 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %lay_10939 = cute.get_layout(%view_10937) : !memref_gmem_bf16_6
            %3012 = cute.get_shape(%lay_10939) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10940, %e1_10941, %e2_10942 = cute.get_leaves(%3012) : !cute.shape<"((8,1),2)">
            %iter_10943 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %view_10944 = cute.make_view(%iter_10943) : !memref_gmem_bf16_7
            %iter_10945 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10946 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %lay_10947 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %shape_10948 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10949 = cute.make_layout() : !cute.layout<"1:0">
            %append_10950 = cute.append_to_rank<2> (%lay_10947, %lay_10949) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10951 = cute.make_view(%iter_10916, %append_10950) : !memref_smem_bf16_14
            %iter_10952 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %lay_10953 = cute.get_layout(%view_10951) : !memref_smem_bf16_14
            %3013 = cute.get_shape(%lay_10953) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10954, %e1_10955, %e2_10956 = cute.get_leaves(%3013) : !cute.shape<"((8,1),2)">
            %iter_10957 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %view_10958 = cute.make_view(%iter_10957) : !memref_smem_bf16_15
            %iter_10959 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %iter_10960 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10961 = cute.get_layout(%view_10922) : !memref_rmem_i8_2
            %shape_10962 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10963 = cute.make_layout() : !cute.layout<"1:0">
            %append_10964 = cute.append_to_rank<2> (%lay_10961, %lay_10963) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10965 = cute.make_view(%iter_10924, %append_10964) : !memref_rmem_i8_2
            %iter_10966 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %lay_10967 = cute.get_layout(%view_10965) : !memref_rmem_i8_2
            %3014 = cute.get_shape(%lay_10967) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10968, %e1_10969 = cute.get_leaves(%3014) : !cute.shape<"(1,2)">
            %iter_10970 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %view_10971 = cute.make_view(%iter_10970) : !memref_rmem_i8_3
            %iter_10972 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %iter_10973 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10974 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %3015 = cute.get_shape(%lay_10974) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10975, %e1_10976, %e2_10977 = cute.get_leaves(%3015) : !cute.shape<"((8,1),(2))">
            %lay_10978 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %3016 = cute.get_shape(%lay_10978) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10979, %e1_10980, %e2_10981 = cute.get_leaves(%3016) : !cute.shape<"((8,1),(2))">
            %lay_10982 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %sz_10983 = cute.size(%lay_10982) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10984 = cute.get_leaves(%sz_10983) : !cute.int_tuple<"2">
            %lay_10985 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %sz_10986 = cute.size(%lay_10985) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10987 = cute.get_leaves(%sz_10986) : !cute.int_tuple<"2">
            %3017 = cute.static : !cute.layout<"1:0">
            %iter_10988 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10989 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10990 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %lay_10991 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %append_10992 = cute.append_to_rank<2> (%lay_10990, %3017) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10993 = cute.append_to_rank<2> (%lay_10991, %3017) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10994 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10995 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10996 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10997 = cute.get_layout(%view_10971) : !memref_rmem_i8_3
            %append_10998 = cute.append_to_rank<2> (%lay_10997, %3017) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10999 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11000 = cute.size(%lay_10994) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3018 = cute.get_scalars(%sz_11000) : !cute.int_tuple<"2">
            %c0_i32_11001 = arith.constant 0 : i32
            %c1_i32_11002 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11001 to %3018 step %c1_i32_11002  : i32 {
              %coord_11003 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_11004 = cute.slice(%lay_10994, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_11005 = cute.crd2idx(%coord_11003, %lay_10994) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11006 = cute.add_offset(%iter_10988, %idx_11005) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11007 = cute.make_view(%ptr_11006, %slice_11004) : !memref_gmem_bf16_8
              %slice_11008 = cute.slice(%lay_10995, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_11009 = cute.crd2idx(%coord_11003, %lay_10995) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11010 = cute.add_offset(%iter_10989, %idx_11009) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11011 = cute.make_view(%ptr_11010, %slice_11008) : !memref_smem_bf16_13
              %slice_11012 = cute.slice(%lay_10999, %coord_11003) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_11013 = cute.crd2idx(%coord_11003, %lay_10999) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11014 = cute.add_offset(%iter_10996, %idx_11013) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11015 = cute.make_view(%ptr_11014, %slice_11012) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_11007, %view_11011, %view_11015) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10901 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10902 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_10904 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_smem_bf16_14
            %iter_10907 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %iter_10908 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %lay_10909 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %sz_10910 = cute.size(%lay_10909) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10911 = cute.get_leaves(%sz_10910) : !cute.int_tuple<"16">
            %lay_10912 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %3010 = cute.get_shape(%lay_10912) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10913, %e1_10914, %e2_10915 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %int_tuple_10916 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10917 = cute.tuple.product(%int_tuple_10916) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10918 = cute.get_leaves(%res_10917) : !cute.int_tuple<"16">
            %cst_10919 = arith.constant 0.000000e+00 : bf16
            %3011 = vector.splat %cst_10919 : vector<16xbf16>
            %int_tuple_10920 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10921 = cute.size(%int_tuple_10920) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10922 = cute.get_leaves(%sz_10921) : !cute.int_tuple<"16">
            %int_tuple_10923 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10924 = cute.size(%int_tuple_10923) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10925 = cute.get_leaves(%sz_10924) : !cute.int_tuple<"16">
            cute.memref.store_vec %3011, %view_10906 : !memref_smem_bf16_14
          }
          %coord_10805 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_10806 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10807 = cute.crd2idx(%coord_10805, %lay_10806) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_10808 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10809 = cute.add_offset(%iter_10808, %idx_10807) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10810 = cute.make_view(%tup_10809) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10811 = cute.get_iter(%view_10810) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10812, %e1_10813, %e2_10814, %e3_10815 = cute.get_leaves(%iter_10811) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2956 = cute.get_scalars(%e0_10812) : !cute.int_tuple<"?">
          %2957 = cute.get_scalars(%e1_10813) : !cute.int_tuple<"?">
          %2958 = cute.get_scalars(%e2_10814) : !cute.int_tuple<"?">
          %2959 = cute.get_scalars(%e3_10815) : !cute.int_tuple<"?{div=8}">
          %iter_10816 = cute.get_iter(%view_10810) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10817, %e1_10818, %e2_10819, %e3_10820 = cute.get_leaves(%iter_10816) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2960 = cute.get_scalars(%e0_10817) : !cute.int_tuple<"?">
          %2961 = cute.get_scalars(%e1_10818) : !cute.int_tuple<"?">
          %2962 = cute.get_scalars(%e2_10819) : !cute.int_tuple<"?">
          %2963 = cute.get_scalars(%e3_10820) : !cute.int_tuple<"?{div=8}">
          %iter_10821 = cute.get_iter(%view_10810) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10822, %e1_10823, %e2_10824, %e3_10825 = cute.get_leaves(%iter_10821) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2964 = cute.get_scalars(%e0_10822) : !cute.int_tuple<"?">
          %2965 = cute.get_scalars(%e1_10823) : !cute.int_tuple<"?">
          %2966 = cute.get_scalars(%e2_10824) : !cute.int_tuple<"?">
          %2967 = cute.get_scalars(%e3_10825) : !cute.int_tuple<"?{div=8}">
          %lay_10826 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2968 = cute.get_shape(%lay_10826) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10827, %e1_10828, %e2_10829, %e3_10830 = cute.get_leaves(%2968) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10831 = cute.to_int_tuple(%e0_10827) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2969 = cute.get_scalars(%itup_10831) : !cute.int_tuple<"?">
          %itup_10832 = cute.to_int_tuple(%e1_10828) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2970 = cute.get_scalars(%itup_10832) : !cute.int_tuple<"?">
          %itup_10833 = cute.to_int_tuple(%e2_10829) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2971 = cute.get_scalars(%itup_10833) : !cute.int_tuple<"?">
          %itup_10834 = cute.to_int_tuple(%e3_10830) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2972 = cute.get_scalars(%itup_10834) : !cute.int_tuple<"?{div=8}">
          %coord_10835 = cute.make_coord(%e1_10823) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10836 = cute.make_coord(%itup_10832) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2973 = cute.elem_less(%coord_10835, %coord_10836) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2973 {
            %coord_10901 = cute.make_coord(%2512) : (i32) -> !cute.coord<"(_,1,_,?)">
            %lay_10902 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_10904 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_gmem_bf16_6
            %iter_10907 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %iter_10908 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %coord_10909 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10910 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10911 = cute.crd2idx(%coord_10909, %lay_10910) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_10912 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10913 = cute.add_offset(%iter_10912, %idx_10911) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10914 = cute.make_view(%ptr_10913) : !memref_smem_bf16_14
            %iter_10915 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %iter_10916 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %coord_10917 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10918 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
            %idx_10919 = cute.crd2idx(%coord_10917, %lay_10918) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10920 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
            %ptr_10921 = cute.add_offset(%iter_10920, %idx_10919) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10922 = cute.make_view(%ptr_10921) : !memref_rmem_i8_2
            %iter_10923 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %iter_10924 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %lay_10925 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %3010 = cute.get_shape(%lay_10925) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10926, %e1_10927, %e2_10928 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %lay_10929 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %3011 = cute.get_shape(%lay_10929) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10930, %e1_10931, %e2_10932 = cute.get_leaves(%3011) : !cute.shape<"((8,1),2)">
            %lay_10933 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %shape_10934 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10935 = cute.make_layout() : !cute.layout<"1:0">
            %append_10936 = cute.append_to_rank<2> (%lay_10933, %lay_10935) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10937 = cute.make_view(%iter_10908, %append_10936) : !memref_gmem_bf16_6
            %iter_10938 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %lay_10939 = cute.get_layout(%view_10937) : !memref_gmem_bf16_6
            %3012 = cute.get_shape(%lay_10939) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10940, %e1_10941, %e2_10942 = cute.get_leaves(%3012) : !cute.shape<"((8,1),2)">
            %iter_10943 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %view_10944 = cute.make_view(%iter_10943) : !memref_gmem_bf16_7
            %iter_10945 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10946 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %lay_10947 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %shape_10948 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10949 = cute.make_layout() : !cute.layout<"1:0">
            %append_10950 = cute.append_to_rank<2> (%lay_10947, %lay_10949) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10951 = cute.make_view(%iter_10916, %append_10950) : !memref_smem_bf16_14
            %iter_10952 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %lay_10953 = cute.get_layout(%view_10951) : !memref_smem_bf16_14
            %3013 = cute.get_shape(%lay_10953) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10954, %e1_10955, %e2_10956 = cute.get_leaves(%3013) : !cute.shape<"((8,1),2)">
            %iter_10957 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %view_10958 = cute.make_view(%iter_10957) : !memref_smem_bf16_15
            %iter_10959 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %iter_10960 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10961 = cute.get_layout(%view_10922) : !memref_rmem_i8_2
            %shape_10962 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10963 = cute.make_layout() : !cute.layout<"1:0">
            %append_10964 = cute.append_to_rank<2> (%lay_10961, %lay_10963) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10965 = cute.make_view(%iter_10924, %append_10964) : !memref_rmem_i8_2
            %iter_10966 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %lay_10967 = cute.get_layout(%view_10965) : !memref_rmem_i8_2
            %3014 = cute.get_shape(%lay_10967) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10968, %e1_10969 = cute.get_leaves(%3014) : !cute.shape<"(1,2)">
            %iter_10970 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %view_10971 = cute.make_view(%iter_10970) : !memref_rmem_i8_3
            %iter_10972 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %iter_10973 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10974 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %3015 = cute.get_shape(%lay_10974) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10975, %e1_10976, %e2_10977 = cute.get_leaves(%3015) : !cute.shape<"((8,1),(2))">
            %lay_10978 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %3016 = cute.get_shape(%lay_10978) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10979, %e1_10980, %e2_10981 = cute.get_leaves(%3016) : !cute.shape<"((8,1),(2))">
            %lay_10982 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %sz_10983 = cute.size(%lay_10982) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10984 = cute.get_leaves(%sz_10983) : !cute.int_tuple<"2">
            %lay_10985 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %sz_10986 = cute.size(%lay_10985) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10987 = cute.get_leaves(%sz_10986) : !cute.int_tuple<"2">
            %3017 = cute.static : !cute.layout<"1:0">
            %iter_10988 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10989 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10990 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %lay_10991 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %append_10992 = cute.append_to_rank<2> (%lay_10990, %3017) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10993 = cute.append_to_rank<2> (%lay_10991, %3017) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10994 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10995 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10996 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10997 = cute.get_layout(%view_10971) : !memref_rmem_i8_3
            %append_10998 = cute.append_to_rank<2> (%lay_10997, %3017) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10999 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11000 = cute.size(%lay_10994) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3018 = cute.get_scalars(%sz_11000) : !cute.int_tuple<"2">
            %c0_i32_11001 = arith.constant 0 : i32
            %c1_i32_11002 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11001 to %3018 step %c1_i32_11002  : i32 {
              %coord_11003 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_11004 = cute.slice(%lay_10994, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_11005 = cute.crd2idx(%coord_11003, %lay_10994) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11006 = cute.add_offset(%iter_10988, %idx_11005) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11007 = cute.make_view(%ptr_11006, %slice_11004) : !memref_gmem_bf16_8
              %slice_11008 = cute.slice(%lay_10995, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_11009 = cute.crd2idx(%coord_11003, %lay_10995) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11010 = cute.add_offset(%iter_10989, %idx_11009) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11011 = cute.make_view(%ptr_11010, %slice_11008) : !memref_smem_bf16_13
              %slice_11012 = cute.slice(%lay_10999, %coord_11003) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_11013 = cute.crd2idx(%coord_11003, %lay_10999) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11014 = cute.add_offset(%iter_10996, %idx_11013) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11015 = cute.make_view(%ptr_11014, %slice_11012) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_11007, %view_11011, %view_11015) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10901 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10902 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_10904 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_smem_bf16_14
            %iter_10907 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %iter_10908 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %lay_10909 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %sz_10910 = cute.size(%lay_10909) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10911 = cute.get_leaves(%sz_10910) : !cute.int_tuple<"16">
            %lay_10912 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %3010 = cute.get_shape(%lay_10912) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10913, %e1_10914, %e2_10915 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %int_tuple_10916 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10917 = cute.tuple.product(%int_tuple_10916) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10918 = cute.get_leaves(%res_10917) : !cute.int_tuple<"16">
            %cst_10919 = arith.constant 0.000000e+00 : bf16
            %3011 = vector.splat %cst_10919 : vector<16xbf16>
            %int_tuple_10920 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10921 = cute.size(%int_tuple_10920) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10922 = cute.get_leaves(%sz_10921) : !cute.int_tuple<"16">
            %int_tuple_10923 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10924 = cute.size(%int_tuple_10923) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10925 = cute.get_leaves(%sz_10924) : !cute.int_tuple<"16">
            cute.memref.store_vec %3011, %view_10906 : !memref_smem_bf16_14
          }
          %coord_10837 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_10838 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10839 = cute.crd2idx(%coord_10837, %lay_10838) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_10840 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10841 = cute.add_offset(%iter_10840, %idx_10839) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10842 = cute.make_view(%tup_10841) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10843 = cute.get_iter(%view_10842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10844, %e1_10845, %e2_10846, %e3_10847 = cute.get_leaves(%iter_10843) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2974 = cute.get_scalars(%e0_10844) : !cute.int_tuple<"?">
          %2975 = cute.get_scalars(%e1_10845) : !cute.int_tuple<"?">
          %2976 = cute.get_scalars(%e2_10846) : !cute.int_tuple<"?">
          %2977 = cute.get_scalars(%e3_10847) : !cute.int_tuple<"?{div=8}">
          %iter_10848 = cute.get_iter(%view_10842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10849, %e1_10850, %e2_10851, %e3_10852 = cute.get_leaves(%iter_10848) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2978 = cute.get_scalars(%e0_10849) : !cute.int_tuple<"?">
          %2979 = cute.get_scalars(%e1_10850) : !cute.int_tuple<"?">
          %2980 = cute.get_scalars(%e2_10851) : !cute.int_tuple<"?">
          %2981 = cute.get_scalars(%e3_10852) : !cute.int_tuple<"?{div=8}">
          %iter_10853 = cute.get_iter(%view_10842) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10854, %e1_10855, %e2_10856, %e3_10857 = cute.get_leaves(%iter_10853) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2982 = cute.get_scalars(%e0_10854) : !cute.int_tuple<"?">
          %2983 = cute.get_scalars(%e1_10855) : !cute.int_tuple<"?">
          %2984 = cute.get_scalars(%e2_10856) : !cute.int_tuple<"?">
          %2985 = cute.get_scalars(%e3_10857) : !cute.int_tuple<"?{div=8}">
          %lay_10858 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2986 = cute.get_shape(%lay_10858) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10859, %e1_10860, %e2_10861, %e3_10862 = cute.get_leaves(%2986) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10863 = cute.to_int_tuple(%e0_10859) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2987 = cute.get_scalars(%itup_10863) : !cute.int_tuple<"?">
          %itup_10864 = cute.to_int_tuple(%e1_10860) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2988 = cute.get_scalars(%itup_10864) : !cute.int_tuple<"?">
          %itup_10865 = cute.to_int_tuple(%e2_10861) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2989 = cute.get_scalars(%itup_10865) : !cute.int_tuple<"?">
          %itup_10866 = cute.to_int_tuple(%e3_10862) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2990 = cute.get_scalars(%itup_10866) : !cute.int_tuple<"?{div=8}">
          %coord_10867 = cute.make_coord(%e1_10855) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10868 = cute.make_coord(%itup_10864) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2991 = cute.elem_less(%coord_10867, %coord_10868) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2991 {
            %coord_10901 = cute.make_coord(%2512) : (i32) -> !cute.coord<"(_,2,_,?)">
            %lay_10902 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_10904 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_gmem_bf16_6
            %iter_10907 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %iter_10908 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %coord_10909 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10910 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10911 = cute.crd2idx(%coord_10909, %lay_10910) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_10912 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10913 = cute.add_offset(%iter_10912, %idx_10911) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10914 = cute.make_view(%ptr_10913) : !memref_smem_bf16_14
            %iter_10915 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %iter_10916 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %coord_10917 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10918 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
            %idx_10919 = cute.crd2idx(%coord_10917, %lay_10918) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10920 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
            %ptr_10921 = cute.add_offset(%iter_10920, %idx_10919) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10922 = cute.make_view(%ptr_10921) : !memref_rmem_i8_2
            %iter_10923 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %iter_10924 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %lay_10925 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %3010 = cute.get_shape(%lay_10925) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10926, %e1_10927, %e2_10928 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %lay_10929 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %3011 = cute.get_shape(%lay_10929) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10930, %e1_10931, %e2_10932 = cute.get_leaves(%3011) : !cute.shape<"((8,1),2)">
            %lay_10933 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %shape_10934 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10935 = cute.make_layout() : !cute.layout<"1:0">
            %append_10936 = cute.append_to_rank<2> (%lay_10933, %lay_10935) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10937 = cute.make_view(%iter_10908, %append_10936) : !memref_gmem_bf16_6
            %iter_10938 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %lay_10939 = cute.get_layout(%view_10937) : !memref_gmem_bf16_6
            %3012 = cute.get_shape(%lay_10939) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10940, %e1_10941, %e2_10942 = cute.get_leaves(%3012) : !cute.shape<"((8,1),2)">
            %iter_10943 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %view_10944 = cute.make_view(%iter_10943) : !memref_gmem_bf16_7
            %iter_10945 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10946 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %lay_10947 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %shape_10948 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10949 = cute.make_layout() : !cute.layout<"1:0">
            %append_10950 = cute.append_to_rank<2> (%lay_10947, %lay_10949) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10951 = cute.make_view(%iter_10916, %append_10950) : !memref_smem_bf16_14
            %iter_10952 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %lay_10953 = cute.get_layout(%view_10951) : !memref_smem_bf16_14
            %3013 = cute.get_shape(%lay_10953) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10954, %e1_10955, %e2_10956 = cute.get_leaves(%3013) : !cute.shape<"((8,1),2)">
            %iter_10957 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %view_10958 = cute.make_view(%iter_10957) : !memref_smem_bf16_15
            %iter_10959 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %iter_10960 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10961 = cute.get_layout(%view_10922) : !memref_rmem_i8_2
            %shape_10962 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10963 = cute.make_layout() : !cute.layout<"1:0">
            %append_10964 = cute.append_to_rank<2> (%lay_10961, %lay_10963) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10965 = cute.make_view(%iter_10924, %append_10964) : !memref_rmem_i8_2
            %iter_10966 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %lay_10967 = cute.get_layout(%view_10965) : !memref_rmem_i8_2
            %3014 = cute.get_shape(%lay_10967) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10968, %e1_10969 = cute.get_leaves(%3014) : !cute.shape<"(1,2)">
            %iter_10970 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %view_10971 = cute.make_view(%iter_10970) : !memref_rmem_i8_3
            %iter_10972 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %iter_10973 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10974 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %3015 = cute.get_shape(%lay_10974) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10975, %e1_10976, %e2_10977 = cute.get_leaves(%3015) : !cute.shape<"((8,1),(2))">
            %lay_10978 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %3016 = cute.get_shape(%lay_10978) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10979, %e1_10980, %e2_10981 = cute.get_leaves(%3016) : !cute.shape<"((8,1),(2))">
            %lay_10982 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %sz_10983 = cute.size(%lay_10982) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10984 = cute.get_leaves(%sz_10983) : !cute.int_tuple<"2">
            %lay_10985 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %sz_10986 = cute.size(%lay_10985) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10987 = cute.get_leaves(%sz_10986) : !cute.int_tuple<"2">
            %3017 = cute.static : !cute.layout<"1:0">
            %iter_10988 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10989 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10990 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %lay_10991 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %append_10992 = cute.append_to_rank<2> (%lay_10990, %3017) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10993 = cute.append_to_rank<2> (%lay_10991, %3017) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10994 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10995 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10996 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10997 = cute.get_layout(%view_10971) : !memref_rmem_i8_3
            %append_10998 = cute.append_to_rank<2> (%lay_10997, %3017) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10999 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11000 = cute.size(%lay_10994) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3018 = cute.get_scalars(%sz_11000) : !cute.int_tuple<"2">
            %c0_i32_11001 = arith.constant 0 : i32
            %c1_i32_11002 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11001 to %3018 step %c1_i32_11002  : i32 {
              %coord_11003 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_11004 = cute.slice(%lay_10994, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_11005 = cute.crd2idx(%coord_11003, %lay_10994) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11006 = cute.add_offset(%iter_10988, %idx_11005) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11007 = cute.make_view(%ptr_11006, %slice_11004) : !memref_gmem_bf16_8
              %slice_11008 = cute.slice(%lay_10995, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_11009 = cute.crd2idx(%coord_11003, %lay_10995) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11010 = cute.add_offset(%iter_10989, %idx_11009) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11011 = cute.make_view(%ptr_11010, %slice_11008) : !memref_smem_bf16_13
              %slice_11012 = cute.slice(%lay_10999, %coord_11003) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_11013 = cute.crd2idx(%coord_11003, %lay_10999) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11014 = cute.add_offset(%iter_10996, %idx_11013) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11015 = cute.make_view(%ptr_11014, %slice_11012) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_11007, %view_11011, %view_11015) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10901 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10902 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_10904 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_smem_bf16_14
            %iter_10907 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %iter_10908 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %lay_10909 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %sz_10910 = cute.size(%lay_10909) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10911 = cute.get_leaves(%sz_10910) : !cute.int_tuple<"16">
            %lay_10912 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %3010 = cute.get_shape(%lay_10912) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10913, %e1_10914, %e2_10915 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %int_tuple_10916 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10917 = cute.tuple.product(%int_tuple_10916) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10918 = cute.get_leaves(%res_10917) : !cute.int_tuple<"16">
            %cst_10919 = arith.constant 0.000000e+00 : bf16
            %3011 = vector.splat %cst_10919 : vector<16xbf16>
            %int_tuple_10920 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10921 = cute.size(%int_tuple_10920) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10922 = cute.get_leaves(%sz_10921) : !cute.int_tuple<"16">
            %int_tuple_10923 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10924 = cute.size(%int_tuple_10923) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10925 = cute.get_leaves(%sz_10924) : !cute.int_tuple<"16">
            cute.memref.store_vec %3011, %view_10906 : !memref_smem_bf16_14
          }
          %coord_10869 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_10870 = cute.get_layout(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10871 = cute.crd2idx(%coord_10869, %lay_10870) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_10872 = cute.get_iter(%src_partitioned_497) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10873 = cute.add_offset(%iter_10872, %idx_10871) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10874 = cute.make_view(%tup_10873) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10875 = cute.get_iter(%view_10874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10876, %e1_10877, %e2_10878, %e3_10879 = cute.get_leaves(%iter_10875) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2992 = cute.get_scalars(%e0_10876) : !cute.int_tuple<"?">
          %2993 = cute.get_scalars(%e1_10877) : !cute.int_tuple<"?">
          %2994 = cute.get_scalars(%e2_10878) : !cute.int_tuple<"?">
          %2995 = cute.get_scalars(%e3_10879) : !cute.int_tuple<"?{div=8}">
          %iter_10880 = cute.get_iter(%view_10874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10881, %e1_10882, %e2_10883, %e3_10884 = cute.get_leaves(%iter_10880) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2996 = cute.get_scalars(%e0_10881) : !cute.int_tuple<"?">
          %2997 = cute.get_scalars(%e1_10882) : !cute.int_tuple<"?">
          %2998 = cute.get_scalars(%e2_10883) : !cute.int_tuple<"?">
          %2999 = cute.get_scalars(%e3_10884) : !cute.int_tuple<"?{div=8}">
          %iter_10885 = cute.get_iter(%view_10874) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10886, %e1_10887, %e2_10888, %e3_10889 = cute.get_leaves(%iter_10885) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %3000 = cute.get_scalars(%e0_10886) : !cute.int_tuple<"?">
          %3001 = cute.get_scalars(%e1_10887) : !cute.int_tuple<"?">
          %3002 = cute.get_scalars(%e2_10888) : !cute.int_tuple<"?">
          %3003 = cute.get_scalars(%e3_10889) : !cute.int_tuple<"?{div=8}">
          %lay_10890 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %3004 = cute.get_shape(%lay_10890) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10891, %e1_10892, %e2_10893, %e3_10894 = cute.get_leaves(%3004) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10895 = cute.to_int_tuple(%e0_10891) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3005 = cute.get_scalars(%itup_10895) : !cute.int_tuple<"?">
          %itup_10896 = cute.to_int_tuple(%e1_10892) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3006 = cute.get_scalars(%itup_10896) : !cute.int_tuple<"?">
          %itup_10897 = cute.to_int_tuple(%e2_10893) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %3007 = cute.get_scalars(%itup_10897) : !cute.int_tuple<"?">
          %itup_10898 = cute.to_int_tuple(%e3_10894) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3008 = cute.get_scalars(%itup_10898) : !cute.int_tuple<"?{div=8}">
          %coord_10899 = cute.make_coord(%e1_10887) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10900 = cute.make_coord(%itup_10896) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3009 = cute.elem_less(%coord_10899, %coord_10900) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %3009 {
            %coord_10901 = cute.make_coord(%2512) : (i32) -> !cute.coord<"(_,3,_,?)">
            %lay_10902 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_10904 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_gmem_bf16_6
            %iter_10907 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %iter_10908 = cute.get_iter(%view_10906) : !memref_gmem_bf16_6
            %coord_10909 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10910 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10911 = cute.crd2idx(%coord_10909, %lay_10910) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_10912 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10913 = cute.add_offset(%iter_10912, %idx_10911) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10914 = cute.make_view(%ptr_10913) : !memref_smem_bf16_14
            %iter_10915 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %iter_10916 = cute.get_iter(%view_10914) : !memref_smem_bf16_14
            %coord_10917 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10918 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
            %idx_10919 = cute.crd2idx(%coord_10917, %lay_10918) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10920 = cute.get_iter(%rmem_540) : !memref_rmem_i8_1
            %ptr_10921 = cute.add_offset(%iter_10920, %idx_10919) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10922 = cute.make_view(%ptr_10921) : !memref_rmem_i8_2
            %iter_10923 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %iter_10924 = cute.get_iter(%view_10922) : !memref_rmem_i8_2
            %lay_10925 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %3010 = cute.get_shape(%lay_10925) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10926, %e1_10927, %e2_10928 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %lay_10929 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %3011 = cute.get_shape(%lay_10929) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10930, %e1_10931, %e2_10932 = cute.get_leaves(%3011) : !cute.shape<"((8,1),2)">
            %lay_10933 = cute.get_layout(%view_10906) : !memref_gmem_bf16_6
            %shape_10934 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10935 = cute.make_layout() : !cute.layout<"1:0">
            %append_10936 = cute.append_to_rank<2> (%lay_10933, %lay_10935) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10937 = cute.make_view(%iter_10908, %append_10936) : !memref_gmem_bf16_6
            %iter_10938 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %lay_10939 = cute.get_layout(%view_10937) : !memref_gmem_bf16_6
            %3012 = cute.get_shape(%lay_10939) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10940, %e1_10941, %e2_10942 = cute.get_leaves(%3012) : !cute.shape<"((8,1),2)">
            %iter_10943 = cute.get_iter(%view_10937) : !memref_gmem_bf16_6
            %view_10944 = cute.make_view(%iter_10943) : !memref_gmem_bf16_7
            %iter_10945 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10946 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %lay_10947 = cute.get_layout(%view_10914) : !memref_smem_bf16_14
            %shape_10948 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10949 = cute.make_layout() : !cute.layout<"1:0">
            %append_10950 = cute.append_to_rank<2> (%lay_10947, %lay_10949) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10951 = cute.make_view(%iter_10916, %append_10950) : !memref_smem_bf16_14
            %iter_10952 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %lay_10953 = cute.get_layout(%view_10951) : !memref_smem_bf16_14
            %3013 = cute.get_shape(%lay_10953) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10954, %e1_10955, %e2_10956 = cute.get_leaves(%3013) : !cute.shape<"((8,1),2)">
            %iter_10957 = cute.get_iter(%view_10951) : !memref_smem_bf16_14
            %view_10958 = cute.make_view(%iter_10957) : !memref_smem_bf16_15
            %iter_10959 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %iter_10960 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10961 = cute.get_layout(%view_10922) : !memref_rmem_i8_2
            %shape_10962 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10963 = cute.make_layout() : !cute.layout<"1:0">
            %append_10964 = cute.append_to_rank<2> (%lay_10961, %lay_10963) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10965 = cute.make_view(%iter_10924, %append_10964) : !memref_rmem_i8_2
            %iter_10966 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %lay_10967 = cute.get_layout(%view_10965) : !memref_rmem_i8_2
            %3014 = cute.get_shape(%lay_10967) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10968, %e1_10969 = cute.get_leaves(%3014) : !cute.shape<"(1,2)">
            %iter_10970 = cute.get_iter(%view_10965) : !memref_rmem_i8_2
            %view_10971 = cute.make_view(%iter_10970) : !memref_rmem_i8_3
            %iter_10972 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %iter_10973 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10974 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %3015 = cute.get_shape(%lay_10974) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10975, %e1_10976, %e2_10977 = cute.get_leaves(%3015) : !cute.shape<"((8,1),(2))">
            %lay_10978 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %3016 = cute.get_shape(%lay_10978) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10979, %e1_10980, %e2_10981 = cute.get_leaves(%3016) : !cute.shape<"((8,1),(2))">
            %lay_10982 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %sz_10983 = cute.size(%lay_10982) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10984 = cute.get_leaves(%sz_10983) : !cute.int_tuple<"2">
            %lay_10985 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %sz_10986 = cute.size(%lay_10985) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10987 = cute.get_leaves(%sz_10986) : !cute.int_tuple<"2">
            %3017 = cute.static : !cute.layout<"1:0">
            %iter_10988 = cute.get_iter(%view_10944) : !memref_gmem_bf16_7
            %iter_10989 = cute.get_iter(%view_10958) : !memref_smem_bf16_15
            %lay_10990 = cute.get_layout(%view_10944) : !memref_gmem_bf16_7
            %lay_10991 = cute.get_layout(%view_10958) : !memref_smem_bf16_15
            %append_10992 = cute.append_to_rank<2> (%lay_10990, %3017) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10993 = cute.append_to_rank<2> (%lay_10991, %3017) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10994 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10995 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10996 = cute.get_iter(%view_10971) : !memref_rmem_i8_3
            %lay_10997 = cute.get_layout(%view_10971) : !memref_rmem_i8_3
            %append_10998 = cute.append_to_rank<2> (%lay_10997, %3017) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10999 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_11000 = cute.size(%lay_10994) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3018 = cute.get_scalars(%sz_11000) : !cute.int_tuple<"2">
            %c0_i32_11001 = arith.constant 0 : i32
            %c1_i32_11002 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_11001 to %3018 step %c1_i32_11002  : i32 {
              %coord_11003 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_11004 = cute.slice(%lay_10994, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_11005 = cute.crd2idx(%coord_11003, %lay_10994) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_11006 = cute.add_offset(%iter_10988, %idx_11005) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_11007 = cute.make_view(%ptr_11006, %slice_11004) : !memref_gmem_bf16_8
              %slice_11008 = cute.slice(%lay_10995, %coord_11003) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_11009 = cute.crd2idx(%coord_11003, %lay_10995) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_11010 = cute.add_offset(%iter_10989, %idx_11009) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_11011 = cute.make_view(%ptr_11010, %slice_11008) : !memref_smem_bf16_13
              %slice_11012 = cute.slice(%lay_10999, %coord_11003) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_11013 = cute.crd2idx(%coord_11003, %lay_10999) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_11014 = cute.add_offset(%iter_10996, %idx_11013) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_11015 = cute.make_view(%ptr_11014, %slice_11012) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_11007, %view_11011, %view_11015) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10901 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10902 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
            %idx_10903 = cute.crd2idx(%coord_10901, %lay_10902) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_10904 = cute.get_iter(%dst_partitioned_301) : !memref_smem_bf16_4
            %ptr_10905 = cute.add_offset(%iter_10904, %idx_10903) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10906 = cute.make_view(%ptr_10905) : !memref_smem_bf16_14
            %iter_10907 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %iter_10908 = cute.get_iter(%view_10906) : !memref_smem_bf16_14
            %lay_10909 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %sz_10910 = cute.size(%lay_10909) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10911 = cute.get_leaves(%sz_10910) : !cute.int_tuple<"16">
            %lay_10912 = cute.get_layout(%view_10906) : !memref_smem_bf16_14
            %3010 = cute.get_shape(%lay_10912) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10913, %e1_10914, %e2_10915 = cute.get_leaves(%3010) : !cute.shape<"((8,1),2)">
            %int_tuple_10916 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10917 = cute.tuple.product(%int_tuple_10916) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10918 = cute.get_leaves(%res_10917) : !cute.int_tuple<"16">
            %cst_10919 = arith.constant 0.000000e+00 : bf16
            %3011 = vector.splat %cst_10919 : vector<16xbf16>
            %int_tuple_10920 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10921 = cute.size(%int_tuple_10920) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10922 = cute.get_leaves(%sz_10921) : !cute.int_tuple<"16">
            %int_tuple_10923 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10924 = cute.size(%int_tuple_10923) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10925 = cute.get_leaves(%sz_10924) : !cute.int_tuple<"16">
            cute.memref.store_vec %3011, %view_10906 : !memref_smem_bf16_14
          }
        } else {
          %coord_10765 = cute.make_coord(%2512) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_10766 = cute.get_layout(%src_partitioned_298) : !memref_gmem_bf16_5
          %slice_10767 = cute.slice(%lay_10766, %coord_10765) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_10768 = cute.crd2idx(%coord_10765, %lay_10766) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_10769 = cute.get_iter(%src_partitioned_298) : !memref_gmem_bf16_5
          %ptr_10770 = cute.add_offset(%iter_10769, %idx_10768) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_10771 = cute.make_view(%ptr_10770, %slice_10767) : !memref_gmem_bf16_9
          %iter_10772 = cute.get_iter(%view_10771) : !memref_gmem_bf16_9
          %iter_10773 = cute.get_iter(%view_10771) : !memref_gmem_bf16_9
          %lay_10774 = cute.get_layout(%view_10771) : !memref_gmem_bf16_9
          %2937 = cute.get_shape(%lay_10774) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10775, %e1_10776, %e2_10777, %e3_10778 = cute.get_leaves(%2937) : !cute.shape<"((8,1),4,2)">
          %lay_10779 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %2938 = cute.get_shape(%lay_10779) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10780, %e1_10781, %e2_10782, %e3_10783 = cute.get_leaves(%2938) : !cute.shape<"((8,1),4,2)">
          %lay_10784 = cute.get_layout(%view_10771) : !memref_gmem_bf16_9
          %shape_10785 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10786 = cute.make_layout() : !cute.layout<"1:0">
          %append_10787 = cute.append_to_rank<2> (%lay_10784, %lay_10786) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_10788 = cute.make_view(%iter_10773, %append_10787) : !memref_gmem_bf16_9
          %iter_10789 = cute.get_iter(%view_10788) : !memref_gmem_bf16_9
          %lay_10790 = cute.get_layout(%view_10788) : !memref_gmem_bf16_9
          %2939 = cute.get_shape(%lay_10790) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10791, %e1_10792, %e2_10793, %e3_10794 = cute.get_leaves(%2939) : !cute.shape<"((8,1),4,2)">
          %iter_10795 = cute.get_iter(%view_10788) : !memref_gmem_bf16_9
          %lay_10796 = cute.get_layout(%view_10788) : !memref_gmem_bf16_9
          %2940 = cute.get_scalars(%lay_10796) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_10797 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_10798 = cute.assume(%2940) : (i64) -> !cute.i64<divby 128>
          %stride_10799 = cute.make_stride(%iv_10798) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_10800 = cute.make_layout(%shape_10797, %stride_10799) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_10801 = cute.make_view(%iter_10795, %lay_10800) : !memref_gmem_bf16_10
          %iter_10802 = cute.get_iter(%view_10801) : !memref_gmem_bf16_10
          %iter_10803 = cute.get_iter(%view_10801) : !memref_gmem_bf16_10
          %lay_10804 = cute.get_layout(%dst_partitioned_301) : !memref_smem_bf16_4
          %shape_10805 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10806 = cute.make_layout() : !cute.layout<"1:0">
          %append_10807 = cute.append_to_rank<2> (%lay_10804, %lay_10806) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_10808 = cute.make_view(%iter_302, %append_10807) : !memref_smem_bf16_4
          %iter_10809 = cute.get_iter(%view_10808) : !memref_smem_bf16_4
          %lay_10810 = cute.get_layout(%view_10808) : !memref_smem_bf16_4
          %2941 = cute.get_shape(%lay_10810) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10811, %e1_10812, %e2_10813, %e3_10814 = cute.get_leaves(%2941) : !cute.shape<"((8,1),4,2)">
          %iter_10815 = cute.get_iter(%view_10808) : !memref_smem_bf16_4
          %view_10816 = cute.make_view(%iter_10815) : !memref_smem_bf16_16
          %iter_10817 = cute.get_iter(%view_10816) : !memref_smem_bf16_16
          %iter_10818 = cute.get_iter(%view_10816) : !memref_smem_bf16_16
          %lay_10819 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %shape_10820 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10821 = cute.make_layout() : !cute.layout<"1:0">
          %append_10822 = cute.append_to_rank<2> (%lay_10819, %lay_10821) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_10823 = cute.make_view(%iter_542, %append_10822) : !memref_rmem_i8_1
          %iter_10824 = cute.get_iter(%view_10823) : !memref_rmem_i8_1
          %lay_10825 = cute.get_layout(%view_10823) : !memref_rmem_i8_1
          %2942 = cute.get_shape(%lay_10825) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_10826, %e1_10827, %e2_10828 = cute.get_leaves(%2942) : !cute.shape<"(1,4,2)">
          %iter_10829 = cute.get_iter(%view_10823) : !memref_rmem_i8_1
          %view_10830 = cute.make_view(%iter_10829) : !memref_rmem_i8_5
          %iter_10831 = cute.get_iter(%view_10830) : !memref_rmem_i8_5
          %iter_10832 = cute.get_iter(%view_10830) : !memref_rmem_i8_5
          %lay_10833 = cute.get_layout(%view_10801) : !memref_gmem_bf16_10
          %2943 = cute.get_shape(%lay_10833) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10834, %e1_10835, %e2_10836, %e3_10837 = cute.get_leaves(%2943) : !cute.shape<"((8,1),(4,2))">
          %lay_10838 = cute.get_layout(%view_10816) : !memref_smem_bf16_16
          %2944 = cute.get_shape(%lay_10838) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10839, %e1_10840, %e2_10841, %e3_10842 = cute.get_leaves(%2944) : !cute.shape<"((8,1),(4,2))">
          %lay_10843 = cute.get_layout(%view_10801) : !memref_gmem_bf16_10
          %sz_10844 = cute.size(%lay_10843) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_10845 = cute.get_leaves(%sz_10844) : !cute.int_tuple<"8">
          %lay_10846 = cute.get_layout(%view_10816) : !memref_smem_bf16_16
          %sz_10847 = cute.size(%lay_10846) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_10848 = cute.get_leaves(%sz_10847) : !cute.int_tuple<"8">
          %2945 = cute.static : !cute.layout<"1:0">
          %iter_10849 = cute.get_iter(%view_10801) : !memref_gmem_bf16_10
          %iter_10850 = cute.get_iter(%view_10816) : !memref_smem_bf16_16
          %lay_10851 = cute.get_layout(%view_10801) : !memref_gmem_bf16_10
          %lay_10852 = cute.get_layout(%view_10816) : !memref_smem_bf16_16
          %append_10853 = cute.append_to_rank<2> (%lay_10851, %2945) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_10854 = cute.append_to_rank<2> (%lay_10852, %2945) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %2946 = cute.get_scalars(%append_10853) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_10855 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_10856 = cute.assume(%2946) : (i64) -> !cute.i64<divby 128>
          %stride_10857 = cute.make_stride(%iv_10856) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_10858 = cute.make_layout(%shape_10855, %stride_10857) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_10859 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_10860 = cute.get_iter(%view_10830) : !memref_rmem_i8_5
          %lay_10861 = cute.get_layout(%view_10830) : !memref_rmem_i8_5
          %append_10862 = cute.append_to_rank<2> (%lay_10861, %2945) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_10863 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_10864 = cute.size(%lay_10858) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %2947 = cute.get_scalars(%sz_10864) : !cute.int_tuple<"8">
          %c0_i32_10865 = arith.constant 0 : i32
          %c1_i32_10866 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_10865 to %2947 step %c1_i32_10866  : i32 {
            %coord_10867 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %slice_10868 = cute.slice(%lay_10858, %coord_10867) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_10869 = cute.crd2idx(%coord_10867, %lay_10858) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_10870 = cute.add_offset(%iter_10849, %idx_10869) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10871 = cute.make_view(%ptr_10870, %slice_10868) : !memref_gmem_bf16_8
            %slice_10872 = cute.slice(%lay_10859, %coord_10867) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_10873 = cute.crd2idx(%coord_10867, %lay_10859) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_10874 = cute.add_offset(%iter_10850, %idx_10873) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10875 = cute.make_view(%ptr_10874, %slice_10872) : !memref_smem_bf16_13
            %slice_10876 = cute.slice(%lay_10863, %coord_10867) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_10877 = cute.crd2idx(%coord_10867, %lay_10863) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_10878 = cute.add_offset(%iter_10860, %idx_10877) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_10879 = cute.make_view(%ptr_10878, %slice_10876) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_10871, %view_10875, %view_10879) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %coord_7897 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7898 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_7899 = cute.crd2idx(%coord_7897, %lay_7898) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_7900 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_7901 = cute.add_offset(%iter_7900, %idx_7899) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7902 = cute.make_view(%ptr_7901) : !memref_smem_bf16_14
        %iter_7903 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
        %iter_7904 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
        %coord_7905 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7906 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_7907 = cute.crd2idx(%coord_7905, %lay_7906) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_7908 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_7909 = cute.add_offset(%iter_7908, %idx_7907) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7910 = cute.make_view(%ptr_7909) : !memref_rmem_bf16_6
        %iter_7911 = cute.get_iter(%view_7910) : !memref_rmem_bf16_6
        %iter_7912 = cute.get_iter(%view_7910) : !memref_rmem_bf16_6
        %lay_7913 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
        %2516 = cute.get_shape(%lay_7913) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7914, %e1_7915, %e2_7916 = cute.get_leaves(%2516) : !cute.shape<"((8,1),2)">
        %lay_7917 = cute.get_layout(%view_7910) : !memref_rmem_bf16_6
        %2517 = cute.get_shape(%lay_7917) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7918, %e1_7919, %e2_7920 = cute.get_leaves(%2517) : !cute.shape<"((8,1),2)">
        %lay_7921 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
        %shape_7922 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7923 = cute.make_layout() : !cute.layout<"1:0">
        %append_7924 = cute.append_to_rank<2> (%lay_7921, %lay_7923) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7925 = cute.make_view(%iter_7904, %append_7924) : !memref_smem_bf16_14
        %iter_7926 = cute.get_iter(%view_7925) : !memref_smem_bf16_14
        %lay_7927 = cute.get_layout(%view_7925) : !memref_smem_bf16_14
        %2518 = cute.get_shape(%lay_7927) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7928, %e1_7929, %e2_7930 = cute.get_leaves(%2518) : !cute.shape<"((8,1),2)">
        %iter_7931 = cute.get_iter(%view_7925) : !memref_smem_bf16_14
        %view_7932 = cute.make_view(%iter_7931) : !memref_smem_bf16_15
        %iter_7933 = cute.get_iter(%view_7932) : !memref_smem_bf16_15
        %iter_7934 = cute.get_iter(%view_7932) : !memref_smem_bf16_15
        %lay_7935 = cute.get_layout(%view_7910) : !memref_rmem_bf16_6
        %shape_7936 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7937 = cute.make_layout() : !cute.layout<"1:0">
        %append_7938 = cute.append_to_rank<2> (%lay_7935, %lay_7937) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7939 = cute.make_view(%iter_7912, %append_7938) : !memref_rmem_bf16_6
        %iter_7940 = cute.get_iter(%view_7939) : !memref_rmem_bf16_6
        %lay_7941 = cute.get_layout(%view_7939) : !memref_rmem_bf16_6
        %2519 = cute.get_shape(%lay_7941) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7942, %e1_7943, %e2_7944 = cute.get_leaves(%2519) : !cute.shape<"((8,1),2)">
        %iter_7945 = cute.get_iter(%view_7939) : !memref_rmem_bf16_6
        %view_7946 = cute.make_view(%iter_7945) : !memref_rmem_bf16_7
        %iter_7947 = cute.get_iter(%view_7946) : !memref_rmem_bf16_7
        %iter_7948 = cute.get_iter(%view_7946) : !memref_rmem_bf16_7
        %lay_7949 = cute.get_layout(%view_7932) : !memref_smem_bf16_15
        %2520 = cute.get_shape(%lay_7949) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7950, %e1_7951, %e2_7952 = cute.get_leaves(%2520) : !cute.shape<"((8,1),(2))">
        %lay_7953 = cute.get_layout(%view_7946) : !memref_rmem_bf16_7
        %2521 = cute.get_shape(%lay_7953) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7954, %e1_7955, %e2_7956 = cute.get_leaves(%2521) : !cute.shape<"((8,1),(2))">
        %lay_7957 = cute.get_layout(%view_7932) : !memref_smem_bf16_15
        %sz_7958 = cute.size(%lay_7957) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7959 = cute.get_leaves(%sz_7958) : !cute.int_tuple<"2">
        %lay_7960 = cute.get_layout(%view_7946) : !memref_rmem_bf16_7
        %sz_7961 = cute.size(%lay_7960) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7962 = cute.get_leaves(%sz_7961) : !cute.int_tuple<"2">
        %2522 = cute.static : !cute.layout<"1:0">
        %iter_7963 = cute.get_iter(%view_7932) : !memref_smem_bf16_15
        %iter_7964 = cute.get_iter(%view_7946) : !memref_rmem_bf16_7
        %lay_7965 = cute.get_layout(%view_7932) : !memref_smem_bf16_15
        %lay_7966 = cute.get_layout(%view_7946) : !memref_rmem_bf16_7
        %append_7967 = cute.append_to_rank<2> (%lay_7965, %2522) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_7968 = cute.append_to_rank<2> (%lay_7966, %2522) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_7969 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_7970 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_7971 = cute.size(%lay_7969) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2523 = cute.get_scalars(%sz_7971) : !cute.int_tuple<"2">
        %c0_i32_7972 = arith.constant 0 : i32
        %c1_i32_7973 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_7972 to %2523 step %c1_i32_7973  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_7969, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_7969) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_7963, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_7970, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_7970) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_7964, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_7974 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7975 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_7976 = cute.crd2idx(%coord_7974, %lay_7975) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_7977 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_7978 = cute.add_offset(%iter_7977, %idx_7976) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7979 = cute.make_view(%ptr_7978) : !memref_smem_bf16_17
        %iter_7980 = cute.get_iter(%view_7979) : !memref_smem_bf16_17
        %iter_7981 = cute.get_iter(%view_7979) : !memref_smem_bf16_17
        %coord_7982 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7983 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_7984 = cute.crd2idx(%coord_7982, %lay_7983) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_7985 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_7986 = cute.add_offset(%iter_7985, %idx_7984) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7987 = cute.make_view(%ptr_7986) : !memref_rmem_bf16_9
        %iter_7988 = cute.get_iter(%view_7987) : !memref_rmem_bf16_9
        %iter_7989 = cute.get_iter(%view_7987) : !memref_rmem_bf16_9
        %lay_7990 = cute.get_layout(%view_7979) : !memref_smem_bf16_17
        %2524 = cute.get_shape(%lay_7990) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7991, %e1_7992, %e2_7993 = cute.get_leaves(%2524) : !cute.shape<"((8,1),4)">
        %lay_7994 = cute.get_layout(%view_7987) : !memref_rmem_bf16_9
        %2525 = cute.get_shape(%lay_7994) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7995, %e1_7996, %e2_7997 = cute.get_leaves(%2525) : !cute.shape<"((8,1),4)">
        %lay_7998 = cute.get_layout(%view_7979) : !memref_smem_bf16_17
        %shape_7999 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8000 = cute.make_layout() : !cute.layout<"1:0">
        %append_8001 = cute.append_to_rank<2> (%lay_7998, %lay_8000) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8002 = cute.make_view(%iter_7981, %append_8001) : !memref_smem_bf16_17
        %iter_8003 = cute.get_iter(%view_8002) : !memref_smem_bf16_17
        %lay_8004 = cute.get_layout(%view_8002) : !memref_smem_bf16_17
        %2526 = cute.get_shape(%lay_8004) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8005, %e1_8006, %e2_8007 = cute.get_leaves(%2526) : !cute.shape<"((8,1),4)">
        %iter_8008 = cute.get_iter(%view_8002) : !memref_smem_bf16_17
        %view_8009 = cute.make_view(%iter_8008) : !memref_smem_bf16_18
        %iter_8010 = cute.get_iter(%view_8009) : !memref_smem_bf16_18
        %iter_8011 = cute.get_iter(%view_8009) : !memref_smem_bf16_18
        %lay_8012 = cute.get_layout(%view_7987) : !memref_rmem_bf16_9
        %shape_8013 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8014 = cute.make_layout() : !cute.layout<"1:0">
        %append_8015 = cute.append_to_rank<2> (%lay_8012, %lay_8014) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8016 = cute.make_view(%iter_7989, %append_8015) : !memref_rmem_bf16_9
        %iter_8017 = cute.get_iter(%view_8016) : !memref_rmem_bf16_9
        %lay_8018 = cute.get_layout(%view_8016) : !memref_rmem_bf16_9
        %2527 = cute.get_shape(%lay_8018) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8019, %e1_8020, %e2_8021 = cute.get_leaves(%2527) : !cute.shape<"((8,1),4)">
        %iter_8022 = cute.get_iter(%view_8016) : !memref_rmem_bf16_9
        %view_8023 = cute.make_view(%iter_8022) : !memref_rmem_bf16_10
        %iter_8024 = cute.get_iter(%view_8023) : !memref_rmem_bf16_10
        %iter_8025 = cute.get_iter(%view_8023) : !memref_rmem_bf16_10
        %lay_8026 = cute.get_layout(%view_8009) : !memref_smem_bf16_18
        %2528 = cute.get_shape(%lay_8026) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8027, %e1_8028, %e2_8029 = cute.get_leaves(%2528) : !cute.shape<"((8,1),(4))">
        %lay_8030 = cute.get_layout(%view_8023) : !memref_rmem_bf16_10
        %2529 = cute.get_shape(%lay_8030) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8031, %e1_8032, %e2_8033 = cute.get_leaves(%2529) : !cute.shape<"((8,1),(4))">
        %lay_8034 = cute.get_layout(%view_8009) : !memref_smem_bf16_18
        %sz_8035 = cute.size(%lay_8034) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8036 = cute.get_leaves(%sz_8035) : !cute.int_tuple<"4">
        %lay_8037 = cute.get_layout(%view_8023) : !memref_rmem_bf16_10
        %sz_8038 = cute.size(%lay_8037) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8039 = cute.get_leaves(%sz_8038) : !cute.int_tuple<"4">
        %2530 = cute.static : !cute.layout<"1:0">
        %iter_8040 = cute.get_iter(%view_8009) : !memref_smem_bf16_18
        %iter_8041 = cute.get_iter(%view_8023) : !memref_rmem_bf16_10
        %lay_8042 = cute.get_layout(%view_8009) : !memref_smem_bf16_18
        %lay_8043 = cute.get_layout(%view_8023) : !memref_rmem_bf16_10
        %append_8044 = cute.append_to_rank<2> (%lay_8042, %2530) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8045 = cute.append_to_rank<2> (%lay_8043, %2530) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8046 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8047 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8048 = cute.size(%lay_8046) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2531 = cute.get_scalars(%sz_8048) : !cute.int_tuple<"4">
        %c0_i32_8049 = arith.constant 0 : i32
        %c1_i32_8050 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8049 to %2531 step %c1_i32_8050  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8046, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8046) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8040, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8047, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8047) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8041, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_8051 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %2532 = cute.get_shape(%lay_8051) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
        %e0_8052, %e1_8053, %e2_8054, %e3_8055, %e4_8056, %e5_8057 = cute.get_leaves(%2532) : !cute.shape<"((8,1),2,((2,2),2))">
        %int_tuple_8058 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8059 = cute.size(%int_tuple_8058) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8060 = cute.get_leaves(%sz_8059) : !cute.int_tuple<"8">
        %int_tuple_8061 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8062 = cute.size(%int_tuple_8061) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8063 = cute.get_leaves(%sz_8062) : !cute.int_tuple<"8">
        %coord_8064 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8065 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_8066 = cute.crd2idx(%coord_8064, %lay_8065) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8067 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_8068 = cute.add_offset(%iter_8067, %idx_8066) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8069 = cute.make_view(%ptr_8068) : !memref_smem_bf16_14
        %iter_8070 = cute.get_iter(%view_8069) : !memref_smem_bf16_14
        %iter_8071 = cute.get_iter(%view_8069) : !memref_smem_bf16_14
        %coord_8072 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8073 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8074 = cute.crd2idx(%coord_8072, %lay_8073) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
        %iter_8075 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8076 = cute.add_offset(%iter_8075, %idx_8074) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8077 = cute.make_view(%ptr_8076) : !memref_rmem_bf16_6
        %iter_8078 = cute.get_iter(%view_8077) : !memref_rmem_bf16_6
        %iter_8079 = cute.get_iter(%view_8077) : !memref_rmem_bf16_6
        %lay_8080 = cute.get_layout(%view_8069) : !memref_smem_bf16_14
        %2533 = cute.get_shape(%lay_8080) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8081, %e1_8082, %e2_8083 = cute.get_leaves(%2533) : !cute.shape<"((8,1),2)">
        %lay_8084 = cute.get_layout(%view_8077) : !memref_rmem_bf16_6
        %2534 = cute.get_shape(%lay_8084) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8085, %e1_8086, %e2_8087 = cute.get_leaves(%2534) : !cute.shape<"((8,1),2)">
        %lay_8088 = cute.get_layout(%view_8069) : !memref_smem_bf16_14
        %shape_8089 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8090 = cute.make_layout() : !cute.layout<"1:0">
        %append_8091 = cute.append_to_rank<2> (%lay_8088, %lay_8090) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8092 = cute.make_view(%iter_8071, %append_8091) : !memref_smem_bf16_14
        %iter_8093 = cute.get_iter(%view_8092) : !memref_smem_bf16_14
        %lay_8094 = cute.get_layout(%view_8092) : !memref_smem_bf16_14
        %2535 = cute.get_shape(%lay_8094) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8095, %e1_8096, %e2_8097 = cute.get_leaves(%2535) : !cute.shape<"((8,1),2)">
        %iter_8098 = cute.get_iter(%view_8092) : !memref_smem_bf16_14
        %view_8099 = cute.make_view(%iter_8098) : !memref_smem_bf16_15
        %iter_8100 = cute.get_iter(%view_8099) : !memref_smem_bf16_15
        %iter_8101 = cute.get_iter(%view_8099) : !memref_smem_bf16_15
        %lay_8102 = cute.get_layout(%view_8077) : !memref_rmem_bf16_6
        %shape_8103 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8104 = cute.make_layout() : !cute.layout<"1:0">
        %append_8105 = cute.append_to_rank<2> (%lay_8102, %lay_8104) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8106 = cute.make_view(%iter_8079, %append_8105) : !memref_rmem_bf16_6
        %iter_8107 = cute.get_iter(%view_8106) : !memref_rmem_bf16_6
        %lay_8108 = cute.get_layout(%view_8106) : !memref_rmem_bf16_6
        %2536 = cute.get_shape(%lay_8108) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8109, %e1_8110, %e2_8111 = cute.get_leaves(%2536) : !cute.shape<"((8,1),2)">
        %iter_8112 = cute.get_iter(%view_8106) : !memref_rmem_bf16_6
        %view_8113 = cute.make_view(%iter_8112) : !memref_rmem_bf16_7
        %iter_8114 = cute.get_iter(%view_8113) : !memref_rmem_bf16_7
        %iter_8115 = cute.get_iter(%view_8113) : !memref_rmem_bf16_7
        %lay_8116 = cute.get_layout(%view_8099) : !memref_smem_bf16_15
        %2537 = cute.get_shape(%lay_8116) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8117, %e1_8118, %e2_8119 = cute.get_leaves(%2537) : !cute.shape<"((8,1),(2))">
        %lay_8120 = cute.get_layout(%view_8113) : !memref_rmem_bf16_7
        %2538 = cute.get_shape(%lay_8120) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8121, %e1_8122, %e2_8123 = cute.get_leaves(%2538) : !cute.shape<"((8,1),(2))">
        %lay_8124 = cute.get_layout(%view_8099) : !memref_smem_bf16_15
        %sz_8125 = cute.size(%lay_8124) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8126 = cute.get_leaves(%sz_8125) : !cute.int_tuple<"2">
        %lay_8127 = cute.get_layout(%view_8113) : !memref_rmem_bf16_7
        %sz_8128 = cute.size(%lay_8127) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8129 = cute.get_leaves(%sz_8128) : !cute.int_tuple<"2">
        %2539 = cute.static : !cute.layout<"1:0">
        %iter_8130 = cute.get_iter(%view_8099) : !memref_smem_bf16_15
        %iter_8131 = cute.get_iter(%view_8113) : !memref_rmem_bf16_7
        %lay_8132 = cute.get_layout(%view_8099) : !memref_smem_bf16_15
        %lay_8133 = cute.get_layout(%view_8113) : !memref_rmem_bf16_7
        %append_8134 = cute.append_to_rank<2> (%lay_8132, %2539) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8135 = cute.append_to_rank<2> (%lay_8133, %2539) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8136 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8137 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8138 = cute.size(%lay_8136) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2540 = cute.get_scalars(%sz_8138) : !cute.int_tuple<"2">
        %c0_i32_8139 = arith.constant 0 : i32
        %c1_i32_8140 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8139 to %2540 step %c1_i32_8140  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8136, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8136) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_8130, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8137, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8137) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8131, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8141 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8142 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_8143 = cute.crd2idx(%coord_8141, %lay_8142) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8144 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_8145 = cute.add_offset(%iter_8144, %idx_8143) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8146 = cute.make_view(%ptr_8145) : !memref_smem_bf16_17
        %iter_8147 = cute.get_iter(%view_8146) : !memref_smem_bf16_17
        %iter_8148 = cute.get_iter(%view_8146) : !memref_smem_bf16_17
        %coord_8149 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8150 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_8151 = cute.crd2idx(%coord_8149, %lay_8150) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
        %iter_8152 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_8153 = cute.add_offset(%iter_8152, %idx_8151) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8154 = cute.make_view(%ptr_8153) : !memref_rmem_bf16_9
        %iter_8155 = cute.get_iter(%view_8154) : !memref_rmem_bf16_9
        %iter_8156 = cute.get_iter(%view_8154) : !memref_rmem_bf16_9
        %lay_8157 = cute.get_layout(%view_8146) : !memref_smem_bf16_17
        %2541 = cute.get_shape(%lay_8157) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8158, %e1_8159, %e2_8160 = cute.get_leaves(%2541) : !cute.shape<"((8,1),4)">
        %lay_8161 = cute.get_layout(%view_8154) : !memref_rmem_bf16_9
        %2542 = cute.get_shape(%lay_8161) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8162, %e1_8163, %e2_8164 = cute.get_leaves(%2542) : !cute.shape<"((8,1),4)">
        %lay_8165 = cute.get_layout(%view_8146) : !memref_smem_bf16_17
        %shape_8166 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8167 = cute.make_layout() : !cute.layout<"1:0">
        %append_8168 = cute.append_to_rank<2> (%lay_8165, %lay_8167) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8169 = cute.make_view(%iter_8148, %append_8168) : !memref_smem_bf16_17
        %iter_8170 = cute.get_iter(%view_8169) : !memref_smem_bf16_17
        %lay_8171 = cute.get_layout(%view_8169) : !memref_smem_bf16_17
        %2543 = cute.get_shape(%lay_8171) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8172, %e1_8173, %e2_8174 = cute.get_leaves(%2543) : !cute.shape<"((8,1),4)">
        %iter_8175 = cute.get_iter(%view_8169) : !memref_smem_bf16_17
        %view_8176 = cute.make_view(%iter_8175) : !memref_smem_bf16_18
        %iter_8177 = cute.get_iter(%view_8176) : !memref_smem_bf16_18
        %iter_8178 = cute.get_iter(%view_8176) : !memref_smem_bf16_18
        %lay_8179 = cute.get_layout(%view_8154) : !memref_rmem_bf16_9
        %shape_8180 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8181 = cute.make_layout() : !cute.layout<"1:0">
        %append_8182 = cute.append_to_rank<2> (%lay_8179, %lay_8181) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8183 = cute.make_view(%iter_8156, %append_8182) : !memref_rmem_bf16_9
        %iter_8184 = cute.get_iter(%view_8183) : !memref_rmem_bf16_9
        %lay_8185 = cute.get_layout(%view_8183) : !memref_rmem_bf16_9
        %2544 = cute.get_shape(%lay_8185) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8186, %e1_8187, %e2_8188 = cute.get_leaves(%2544) : !cute.shape<"((8,1),4)">
        %iter_8189 = cute.get_iter(%view_8183) : !memref_rmem_bf16_9
        %view_8190 = cute.make_view(%iter_8189) : !memref_rmem_bf16_10
        %iter_8191 = cute.get_iter(%view_8190) : !memref_rmem_bf16_10
        %iter_8192 = cute.get_iter(%view_8190) : !memref_rmem_bf16_10
        %lay_8193 = cute.get_layout(%view_8176) : !memref_smem_bf16_18
        %2545 = cute.get_shape(%lay_8193) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8194, %e1_8195, %e2_8196 = cute.get_leaves(%2545) : !cute.shape<"((8,1),(4))">
        %lay_8197 = cute.get_layout(%view_8190) : !memref_rmem_bf16_10
        %2546 = cute.get_shape(%lay_8197) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8198, %e1_8199, %e2_8200 = cute.get_leaves(%2546) : !cute.shape<"((8,1),(4))">
        %lay_8201 = cute.get_layout(%view_8176) : !memref_smem_bf16_18
        %sz_8202 = cute.size(%lay_8201) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8203 = cute.get_leaves(%sz_8202) : !cute.int_tuple<"4">
        %lay_8204 = cute.get_layout(%view_8190) : !memref_rmem_bf16_10
        %sz_8205 = cute.size(%lay_8204) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8206 = cute.get_leaves(%sz_8205) : !cute.int_tuple<"4">
        %2547 = cute.static : !cute.layout<"1:0">
        %iter_8207 = cute.get_iter(%view_8176) : !memref_smem_bf16_18
        %iter_8208 = cute.get_iter(%view_8190) : !memref_rmem_bf16_10
        %lay_8209 = cute.get_layout(%view_8176) : !memref_smem_bf16_18
        %lay_8210 = cute.get_layout(%view_8190) : !memref_rmem_bf16_10
        %append_8211 = cute.append_to_rank<2> (%lay_8209, %2547) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8212 = cute.append_to_rank<2> (%lay_8210, %2547) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8213 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8214 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8215 = cute.size(%lay_8213) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2548 = cute.get_scalars(%sz_8215) : !cute.int_tuple<"4">
        %c0_i32_8216 = arith.constant 0 : i32
        %c1_i32_8217 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8216 to %2548 step %c1_i32_8217  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8213, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8213) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8207, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8214, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8214) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8208, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8218 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8219 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8220 = cute.crd2idx(%coord_8218, %lay_8219) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
        %iter_8221 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8222 = cute.add_offset(%iter_8221, %idx_8220) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8223 = cute.make_view(%ptr_8222) : !memref_rmem_bf16_12
        %iter_8224 = cute.get_iter(%view_8223) : !memref_rmem_bf16_12
        %iter_8225 = cute.get_iter(%view_8223) : !memref_rmem_bf16_12
        %coord_8226 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8227 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8228 = cute.crd2idx(%coord_8226, %lay_8227) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
        %iter_8229 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8230 = cute.add_offset(%iter_8229, %idx_8228) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8231 = cute.make_view(%ptr_8230) : !memref_rmem_bf16_13
        %iter_8232 = cute.get_iter(%view_8231) : !memref_rmem_bf16_13
        %iter_8233 = cute.get_iter(%view_8231) : !memref_rmem_bf16_13
        %lay_8234 = cute.get_layout(%view_8223) : !memref_rmem_bf16_12
        %2549 = cute.get_shape(%lay_8234) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8235, %e1_8236, %e2_8237, %e3_8238 = cute.get_leaves(%2549) : !cute.shape<"((2,2,2),2)">
        %lay_8239 = cute.get_layout(%view_8231) : !memref_rmem_bf16_13
        %2550 = cute.get_shape(%lay_8239) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8240, %e1_8241, %e2_8242 = cute.get_leaves(%2550) : !cute.shape<"((2,2),8)">
        %iter_8243 = cute.get_iter(%view_8223) : !memref_rmem_bf16_12
        %iter_8244 = cute.get_iter(%view_8231) : !memref_rmem_bf16_13
        %iter_8245 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_8246 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_8247 = cute.get_layout(%view_8223) : !memref_rmem_bf16_12
        %lay_8248 = cute.get_layout(%view_8231) : !memref_rmem_bf16_13
        %lay_8249 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_8250 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2551 = cute.static : !cute.layout<"1:0">
        %append_8251 = cute.append_to_rank<3> (%lay_8247, %2551) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8252 = cute.append_to_rank<3> (%lay_8248, %2551) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8253 = cute.size(%append_8251) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8254 = cute.size(%append_8251) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8255 = cute.size(%append_8252) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2552 = cute.get_scalars(%sz_8253) : !cute.int_tuple<"1">
        %2553 = cute.get_scalars(%sz_8254) : !cute.int_tuple<"2">
        %2554 = cute.get_scalars(%sz_8255) : !cute.int_tuple<"8">
        %c0_i32_8256 = arith.constant 0 : i32
        %c1_i32_8257 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8256 to %2552 step %c1_i32_8257  : i32 {
          scf.for %arg14 = %c0_i32_8256 to %2553 step %c1_i32_8257  : i32 {
            scf.for %arg15 = %c0_i32_8256 to %2554 step %c1_i32_8257  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_8251, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_8251) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_8243, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_8252, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_8252) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_8244, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_8249, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_8249) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_8245, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_8250, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_8250) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_8246, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8258 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8259 = cute.size(%int_tuple_8258) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8260 = cute.get_leaves(%sz_8259) : !cute.int_tuple<"8">
        %coord_8261 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8262 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_8263 = cute.crd2idx(%coord_8261, %lay_8262) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8264 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_8265 = cute.add_offset(%iter_8264, %idx_8263) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8266 = cute.make_view(%ptr_8265) : !memref_smem_bf16_14
        %iter_8267 = cute.get_iter(%view_8266) : !memref_smem_bf16_14
        %iter_8268 = cute.get_iter(%view_8266) : !memref_smem_bf16_14
        %coord_8269 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8270 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8271 = cute.crd2idx(%coord_8269, %lay_8270) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
        %iter_8272 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8273 = cute.add_offset(%iter_8272, %idx_8271) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8274 = cute.make_view(%ptr_8273) : !memref_rmem_bf16_6
        %iter_8275 = cute.get_iter(%view_8274) : !memref_rmem_bf16_6
        %iter_8276 = cute.get_iter(%view_8274) : !memref_rmem_bf16_6
        %lay_8277 = cute.get_layout(%view_8266) : !memref_smem_bf16_14
        %2555 = cute.get_shape(%lay_8277) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8278, %e1_8279, %e2_8280 = cute.get_leaves(%2555) : !cute.shape<"((8,1),2)">
        %lay_8281 = cute.get_layout(%view_8274) : !memref_rmem_bf16_6
        %2556 = cute.get_shape(%lay_8281) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8282, %e1_8283, %e2_8284 = cute.get_leaves(%2556) : !cute.shape<"((8,1),2)">
        %lay_8285 = cute.get_layout(%view_8266) : !memref_smem_bf16_14
        %shape_8286 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8287 = cute.make_layout() : !cute.layout<"1:0">
        %append_8288 = cute.append_to_rank<2> (%lay_8285, %lay_8287) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8289 = cute.make_view(%iter_8268, %append_8288) : !memref_smem_bf16_14
        %iter_8290 = cute.get_iter(%view_8289) : !memref_smem_bf16_14
        %lay_8291 = cute.get_layout(%view_8289) : !memref_smem_bf16_14
        %2557 = cute.get_shape(%lay_8291) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8292, %e1_8293, %e2_8294 = cute.get_leaves(%2557) : !cute.shape<"((8,1),2)">
        %iter_8295 = cute.get_iter(%view_8289) : !memref_smem_bf16_14
        %view_8296 = cute.make_view(%iter_8295) : !memref_smem_bf16_15
        %iter_8297 = cute.get_iter(%view_8296) : !memref_smem_bf16_15
        %iter_8298 = cute.get_iter(%view_8296) : !memref_smem_bf16_15
        %lay_8299 = cute.get_layout(%view_8274) : !memref_rmem_bf16_6
        %shape_8300 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8301 = cute.make_layout() : !cute.layout<"1:0">
        %append_8302 = cute.append_to_rank<2> (%lay_8299, %lay_8301) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8303 = cute.make_view(%iter_8276, %append_8302) : !memref_rmem_bf16_6
        %iter_8304 = cute.get_iter(%view_8303) : !memref_rmem_bf16_6
        %lay_8305 = cute.get_layout(%view_8303) : !memref_rmem_bf16_6
        %2558 = cute.get_shape(%lay_8305) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8306, %e1_8307, %e2_8308 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
        %iter_8309 = cute.get_iter(%view_8303) : !memref_rmem_bf16_6
        %view_8310 = cute.make_view(%iter_8309) : !memref_rmem_bf16_7
        %iter_8311 = cute.get_iter(%view_8310) : !memref_rmem_bf16_7
        %iter_8312 = cute.get_iter(%view_8310) : !memref_rmem_bf16_7
        %lay_8313 = cute.get_layout(%view_8296) : !memref_smem_bf16_15
        %2559 = cute.get_shape(%lay_8313) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8314, %e1_8315, %e2_8316 = cute.get_leaves(%2559) : !cute.shape<"((8,1),(2))">
        %lay_8317 = cute.get_layout(%view_8310) : !memref_rmem_bf16_7
        %2560 = cute.get_shape(%lay_8317) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8318, %e1_8319, %e2_8320 = cute.get_leaves(%2560) : !cute.shape<"((8,1),(2))">
        %lay_8321 = cute.get_layout(%view_8296) : !memref_smem_bf16_15
        %sz_8322 = cute.size(%lay_8321) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8323 = cute.get_leaves(%sz_8322) : !cute.int_tuple<"2">
        %lay_8324 = cute.get_layout(%view_8310) : !memref_rmem_bf16_7
        %sz_8325 = cute.size(%lay_8324) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8326 = cute.get_leaves(%sz_8325) : !cute.int_tuple<"2">
        %2561 = cute.static : !cute.layout<"1:0">
        %iter_8327 = cute.get_iter(%view_8296) : !memref_smem_bf16_15
        %iter_8328 = cute.get_iter(%view_8310) : !memref_rmem_bf16_7
        %lay_8329 = cute.get_layout(%view_8296) : !memref_smem_bf16_15
        %lay_8330 = cute.get_layout(%view_8310) : !memref_rmem_bf16_7
        %append_8331 = cute.append_to_rank<2> (%lay_8329, %2561) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8332 = cute.append_to_rank<2> (%lay_8330, %2561) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8333 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8334 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8335 = cute.size(%lay_8333) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2562 = cute.get_scalars(%sz_8335) : !cute.int_tuple<"2">
        %c0_i32_8336 = arith.constant 0 : i32
        %c1_i32_8337 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8336 to %2562 step %c1_i32_8337  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8333, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8333) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_8327, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8334, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8334) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8328, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8338 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8339 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_8340 = cute.crd2idx(%coord_8338, %lay_8339) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8341 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_8342 = cute.add_offset(%iter_8341, %idx_8340) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8343 = cute.make_view(%ptr_8342) : !memref_smem_bf16_17
        %iter_8344 = cute.get_iter(%view_8343) : !memref_smem_bf16_17
        %iter_8345 = cute.get_iter(%view_8343) : !memref_smem_bf16_17
        %coord_8346 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8347 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_8348 = cute.crd2idx(%coord_8346, %lay_8347) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
        %iter_8349 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_8350 = cute.add_offset(%iter_8349, %idx_8348) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8351 = cute.make_view(%ptr_8350) : !memref_rmem_bf16_9
        %iter_8352 = cute.get_iter(%view_8351) : !memref_rmem_bf16_9
        %iter_8353 = cute.get_iter(%view_8351) : !memref_rmem_bf16_9
        %lay_8354 = cute.get_layout(%view_8343) : !memref_smem_bf16_17
        %2563 = cute.get_shape(%lay_8354) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8355, %e1_8356, %e2_8357 = cute.get_leaves(%2563) : !cute.shape<"((8,1),4)">
        %lay_8358 = cute.get_layout(%view_8351) : !memref_rmem_bf16_9
        %2564 = cute.get_shape(%lay_8358) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8359, %e1_8360, %e2_8361 = cute.get_leaves(%2564) : !cute.shape<"((8,1),4)">
        %lay_8362 = cute.get_layout(%view_8343) : !memref_smem_bf16_17
        %shape_8363 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8364 = cute.make_layout() : !cute.layout<"1:0">
        %append_8365 = cute.append_to_rank<2> (%lay_8362, %lay_8364) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8366 = cute.make_view(%iter_8345, %append_8365) : !memref_smem_bf16_17
        %iter_8367 = cute.get_iter(%view_8366) : !memref_smem_bf16_17
        %lay_8368 = cute.get_layout(%view_8366) : !memref_smem_bf16_17
        %2565 = cute.get_shape(%lay_8368) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8369, %e1_8370, %e2_8371 = cute.get_leaves(%2565) : !cute.shape<"((8,1),4)">
        %iter_8372 = cute.get_iter(%view_8366) : !memref_smem_bf16_17
        %view_8373 = cute.make_view(%iter_8372) : !memref_smem_bf16_18
        %iter_8374 = cute.get_iter(%view_8373) : !memref_smem_bf16_18
        %iter_8375 = cute.get_iter(%view_8373) : !memref_smem_bf16_18
        %lay_8376 = cute.get_layout(%view_8351) : !memref_rmem_bf16_9
        %shape_8377 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8378 = cute.make_layout() : !cute.layout<"1:0">
        %append_8379 = cute.append_to_rank<2> (%lay_8376, %lay_8378) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8380 = cute.make_view(%iter_8353, %append_8379) : !memref_rmem_bf16_9
        %iter_8381 = cute.get_iter(%view_8380) : !memref_rmem_bf16_9
        %lay_8382 = cute.get_layout(%view_8380) : !memref_rmem_bf16_9
        %2566 = cute.get_shape(%lay_8382) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8383, %e1_8384, %e2_8385 = cute.get_leaves(%2566) : !cute.shape<"((8,1),4)">
        %iter_8386 = cute.get_iter(%view_8380) : !memref_rmem_bf16_9
        %view_8387 = cute.make_view(%iter_8386) : !memref_rmem_bf16_10
        %iter_8388 = cute.get_iter(%view_8387) : !memref_rmem_bf16_10
        %iter_8389 = cute.get_iter(%view_8387) : !memref_rmem_bf16_10
        %lay_8390 = cute.get_layout(%view_8373) : !memref_smem_bf16_18
        %2567 = cute.get_shape(%lay_8390) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8391, %e1_8392, %e2_8393 = cute.get_leaves(%2567) : !cute.shape<"((8,1),(4))">
        %lay_8394 = cute.get_layout(%view_8387) : !memref_rmem_bf16_10
        %2568 = cute.get_shape(%lay_8394) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8395, %e1_8396, %e2_8397 = cute.get_leaves(%2568) : !cute.shape<"((8,1),(4))">
        %lay_8398 = cute.get_layout(%view_8373) : !memref_smem_bf16_18
        %sz_8399 = cute.size(%lay_8398) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8400 = cute.get_leaves(%sz_8399) : !cute.int_tuple<"4">
        %lay_8401 = cute.get_layout(%view_8387) : !memref_rmem_bf16_10
        %sz_8402 = cute.size(%lay_8401) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8403 = cute.get_leaves(%sz_8402) : !cute.int_tuple<"4">
        %2569 = cute.static : !cute.layout<"1:0">
        %iter_8404 = cute.get_iter(%view_8373) : !memref_smem_bf16_18
        %iter_8405 = cute.get_iter(%view_8387) : !memref_rmem_bf16_10
        %lay_8406 = cute.get_layout(%view_8373) : !memref_smem_bf16_18
        %lay_8407 = cute.get_layout(%view_8387) : !memref_rmem_bf16_10
        %append_8408 = cute.append_to_rank<2> (%lay_8406, %2569) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8409 = cute.append_to_rank<2> (%lay_8407, %2569) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8410 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8411 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8412 = cute.size(%lay_8410) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2570 = cute.get_scalars(%sz_8412) : !cute.int_tuple<"4">
        %c0_i32_8413 = arith.constant 0 : i32
        %c1_i32_8414 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8413 to %2570 step %c1_i32_8414  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8410, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8410) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8404, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8411, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8411) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8405, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8415 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8416 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8417 = cute.crd2idx(%coord_8415, %lay_8416) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
        %iter_8418 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8419 = cute.add_offset(%iter_8418, %idx_8417) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8420 = cute.make_view(%ptr_8419) : !memref_rmem_bf16_12
        %iter_8421 = cute.get_iter(%view_8420) : !memref_rmem_bf16_12
        %iter_8422 = cute.get_iter(%view_8420) : !memref_rmem_bf16_12
        %coord_8423 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8424 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8425 = cute.crd2idx(%coord_8423, %lay_8424) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
        %iter_8426 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8427 = cute.add_offset(%iter_8426, %idx_8425) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8428 = cute.make_view(%ptr_8427) : !memref_rmem_bf16_13
        %iter_8429 = cute.get_iter(%view_8428) : !memref_rmem_bf16_13
        %iter_8430 = cute.get_iter(%view_8428) : !memref_rmem_bf16_13
        %lay_8431 = cute.get_layout(%view_8420) : !memref_rmem_bf16_12
        %2571 = cute.get_shape(%lay_8431) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8432, %e1_8433, %e2_8434, %e3_8435 = cute.get_leaves(%2571) : !cute.shape<"((2,2,2),2)">
        %lay_8436 = cute.get_layout(%view_8428) : !memref_rmem_bf16_13
        %2572 = cute.get_shape(%lay_8436) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8437, %e1_8438, %e2_8439 = cute.get_leaves(%2572) : !cute.shape<"((2,2),8)">
        %iter_8440 = cute.get_iter(%view_8420) : !memref_rmem_bf16_12
        %iter_8441 = cute.get_iter(%view_8428) : !memref_rmem_bf16_13
        %iter_8442 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_8443 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_8444 = cute.get_layout(%view_8420) : !memref_rmem_bf16_12
        %lay_8445 = cute.get_layout(%view_8428) : !memref_rmem_bf16_13
        %lay_8446 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_8447 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2573 = cute.static : !cute.layout<"1:0">
        %append_8448 = cute.append_to_rank<3> (%lay_8444, %2573) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8449 = cute.append_to_rank<3> (%lay_8445, %2573) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8450 = cute.size(%append_8448) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8451 = cute.size(%append_8448) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8452 = cute.size(%append_8449) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2574 = cute.get_scalars(%sz_8450) : !cute.int_tuple<"1">
        %2575 = cute.get_scalars(%sz_8451) : !cute.int_tuple<"2">
        %2576 = cute.get_scalars(%sz_8452) : !cute.int_tuple<"8">
        %c0_i32_8453 = arith.constant 0 : i32
        %c1_i32_8454 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8453 to %2574 step %c1_i32_8454  : i32 {
          scf.for %arg14 = %c0_i32_8453 to %2575 step %c1_i32_8454  : i32 {
            scf.for %arg15 = %c0_i32_8453 to %2576 step %c1_i32_8454  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_8448, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_8448) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_8440, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_8449, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_8449) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_8441, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_8446, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_8446) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_8442, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_8447, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_8447) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_8443, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8455 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8456 = cute.size(%int_tuple_8455) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8457 = cute.get_leaves(%sz_8456) : !cute.int_tuple<"8">
        %coord_8458 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8459 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_8460 = cute.crd2idx(%coord_8458, %lay_8459) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8461 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_8462 = cute.add_offset(%iter_8461, %idx_8460) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8463 = cute.make_view(%ptr_8462) : !memref_smem_bf16_14
        %iter_8464 = cute.get_iter(%view_8463) : !memref_smem_bf16_14
        %iter_8465 = cute.get_iter(%view_8463) : !memref_smem_bf16_14
        %coord_8466 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8467 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8468 = cute.crd2idx(%coord_8466, %lay_8467) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
        %iter_8469 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8470 = cute.add_offset(%iter_8469, %idx_8468) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8471 = cute.make_view(%ptr_8470) : !memref_rmem_bf16_6
        %iter_8472 = cute.get_iter(%view_8471) : !memref_rmem_bf16_6
        %iter_8473 = cute.get_iter(%view_8471) : !memref_rmem_bf16_6
        %lay_8474 = cute.get_layout(%view_8463) : !memref_smem_bf16_14
        %2577 = cute.get_shape(%lay_8474) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8475, %e1_8476, %e2_8477 = cute.get_leaves(%2577) : !cute.shape<"((8,1),2)">
        %lay_8478 = cute.get_layout(%view_8471) : !memref_rmem_bf16_6
        %2578 = cute.get_shape(%lay_8478) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8479, %e1_8480, %e2_8481 = cute.get_leaves(%2578) : !cute.shape<"((8,1),2)">
        %lay_8482 = cute.get_layout(%view_8463) : !memref_smem_bf16_14
        %shape_8483 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8484 = cute.make_layout() : !cute.layout<"1:0">
        %append_8485 = cute.append_to_rank<2> (%lay_8482, %lay_8484) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8486 = cute.make_view(%iter_8465, %append_8485) : !memref_smem_bf16_14
        %iter_8487 = cute.get_iter(%view_8486) : !memref_smem_bf16_14
        %lay_8488 = cute.get_layout(%view_8486) : !memref_smem_bf16_14
        %2579 = cute.get_shape(%lay_8488) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8489, %e1_8490, %e2_8491 = cute.get_leaves(%2579) : !cute.shape<"((8,1),2)">
        %iter_8492 = cute.get_iter(%view_8486) : !memref_smem_bf16_14
        %view_8493 = cute.make_view(%iter_8492) : !memref_smem_bf16_15
        %iter_8494 = cute.get_iter(%view_8493) : !memref_smem_bf16_15
        %iter_8495 = cute.get_iter(%view_8493) : !memref_smem_bf16_15
        %lay_8496 = cute.get_layout(%view_8471) : !memref_rmem_bf16_6
        %shape_8497 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8498 = cute.make_layout() : !cute.layout<"1:0">
        %append_8499 = cute.append_to_rank<2> (%lay_8496, %lay_8498) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8500 = cute.make_view(%iter_8473, %append_8499) : !memref_rmem_bf16_6
        %iter_8501 = cute.get_iter(%view_8500) : !memref_rmem_bf16_6
        %lay_8502 = cute.get_layout(%view_8500) : !memref_rmem_bf16_6
        %2580 = cute.get_shape(%lay_8502) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8503, %e1_8504, %e2_8505 = cute.get_leaves(%2580) : !cute.shape<"((8,1),2)">
        %iter_8506 = cute.get_iter(%view_8500) : !memref_rmem_bf16_6
        %view_8507 = cute.make_view(%iter_8506) : !memref_rmem_bf16_7
        %iter_8508 = cute.get_iter(%view_8507) : !memref_rmem_bf16_7
        %iter_8509 = cute.get_iter(%view_8507) : !memref_rmem_bf16_7
        %lay_8510 = cute.get_layout(%view_8493) : !memref_smem_bf16_15
        %2581 = cute.get_shape(%lay_8510) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8511, %e1_8512, %e2_8513 = cute.get_leaves(%2581) : !cute.shape<"((8,1),(2))">
        %lay_8514 = cute.get_layout(%view_8507) : !memref_rmem_bf16_7
        %2582 = cute.get_shape(%lay_8514) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8515, %e1_8516, %e2_8517 = cute.get_leaves(%2582) : !cute.shape<"((8,1),(2))">
        %lay_8518 = cute.get_layout(%view_8493) : !memref_smem_bf16_15
        %sz_8519 = cute.size(%lay_8518) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8520 = cute.get_leaves(%sz_8519) : !cute.int_tuple<"2">
        %lay_8521 = cute.get_layout(%view_8507) : !memref_rmem_bf16_7
        %sz_8522 = cute.size(%lay_8521) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8523 = cute.get_leaves(%sz_8522) : !cute.int_tuple<"2">
        %2583 = cute.static : !cute.layout<"1:0">
        %iter_8524 = cute.get_iter(%view_8493) : !memref_smem_bf16_15
        %iter_8525 = cute.get_iter(%view_8507) : !memref_rmem_bf16_7
        %lay_8526 = cute.get_layout(%view_8493) : !memref_smem_bf16_15
        %lay_8527 = cute.get_layout(%view_8507) : !memref_rmem_bf16_7
        %append_8528 = cute.append_to_rank<2> (%lay_8526, %2583) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8529 = cute.append_to_rank<2> (%lay_8527, %2583) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8530 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8531 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8532 = cute.size(%lay_8530) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2584 = cute.get_scalars(%sz_8532) : !cute.int_tuple<"2">
        %c0_i32_8533 = arith.constant 0 : i32
        %c1_i32_8534 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8533 to %2584 step %c1_i32_8534  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8530, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8530) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_8524, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8531, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8531) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8525, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8535 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8536 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_8537 = cute.crd2idx(%coord_8535, %lay_8536) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8538 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_8539 = cute.add_offset(%iter_8538, %idx_8537) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8540 = cute.make_view(%ptr_8539) : !memref_smem_bf16_17
        %iter_8541 = cute.get_iter(%view_8540) : !memref_smem_bf16_17
        %iter_8542 = cute.get_iter(%view_8540) : !memref_smem_bf16_17
        %coord_8543 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8544 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_8545 = cute.crd2idx(%coord_8543, %lay_8544) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
        %iter_8546 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_8547 = cute.add_offset(%iter_8546, %idx_8545) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8548 = cute.make_view(%ptr_8547) : !memref_rmem_bf16_9
        %iter_8549 = cute.get_iter(%view_8548) : !memref_rmem_bf16_9
        %iter_8550 = cute.get_iter(%view_8548) : !memref_rmem_bf16_9
        %lay_8551 = cute.get_layout(%view_8540) : !memref_smem_bf16_17
        %2585 = cute.get_shape(%lay_8551) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8552, %e1_8553, %e2_8554 = cute.get_leaves(%2585) : !cute.shape<"((8,1),4)">
        %lay_8555 = cute.get_layout(%view_8548) : !memref_rmem_bf16_9
        %2586 = cute.get_shape(%lay_8555) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8556, %e1_8557, %e2_8558 = cute.get_leaves(%2586) : !cute.shape<"((8,1),4)">
        %lay_8559 = cute.get_layout(%view_8540) : !memref_smem_bf16_17
        %shape_8560 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8561 = cute.make_layout() : !cute.layout<"1:0">
        %append_8562 = cute.append_to_rank<2> (%lay_8559, %lay_8561) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8563 = cute.make_view(%iter_8542, %append_8562) : !memref_smem_bf16_17
        %iter_8564 = cute.get_iter(%view_8563) : !memref_smem_bf16_17
        %lay_8565 = cute.get_layout(%view_8563) : !memref_smem_bf16_17
        %2587 = cute.get_shape(%lay_8565) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8566, %e1_8567, %e2_8568 = cute.get_leaves(%2587) : !cute.shape<"((8,1),4)">
        %iter_8569 = cute.get_iter(%view_8563) : !memref_smem_bf16_17
        %view_8570 = cute.make_view(%iter_8569) : !memref_smem_bf16_18
        %iter_8571 = cute.get_iter(%view_8570) : !memref_smem_bf16_18
        %iter_8572 = cute.get_iter(%view_8570) : !memref_smem_bf16_18
        %lay_8573 = cute.get_layout(%view_8548) : !memref_rmem_bf16_9
        %shape_8574 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8575 = cute.make_layout() : !cute.layout<"1:0">
        %append_8576 = cute.append_to_rank<2> (%lay_8573, %lay_8575) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8577 = cute.make_view(%iter_8550, %append_8576) : !memref_rmem_bf16_9
        %iter_8578 = cute.get_iter(%view_8577) : !memref_rmem_bf16_9
        %lay_8579 = cute.get_layout(%view_8577) : !memref_rmem_bf16_9
        %2588 = cute.get_shape(%lay_8579) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8580, %e1_8581, %e2_8582 = cute.get_leaves(%2588) : !cute.shape<"((8,1),4)">
        %iter_8583 = cute.get_iter(%view_8577) : !memref_rmem_bf16_9
        %view_8584 = cute.make_view(%iter_8583) : !memref_rmem_bf16_10
        %iter_8585 = cute.get_iter(%view_8584) : !memref_rmem_bf16_10
        %iter_8586 = cute.get_iter(%view_8584) : !memref_rmem_bf16_10
        %lay_8587 = cute.get_layout(%view_8570) : !memref_smem_bf16_18
        %2589 = cute.get_shape(%lay_8587) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8588, %e1_8589, %e2_8590 = cute.get_leaves(%2589) : !cute.shape<"((8,1),(4))">
        %lay_8591 = cute.get_layout(%view_8584) : !memref_rmem_bf16_10
        %2590 = cute.get_shape(%lay_8591) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8592, %e1_8593, %e2_8594 = cute.get_leaves(%2590) : !cute.shape<"((8,1),(4))">
        %lay_8595 = cute.get_layout(%view_8570) : !memref_smem_bf16_18
        %sz_8596 = cute.size(%lay_8595) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8597 = cute.get_leaves(%sz_8596) : !cute.int_tuple<"4">
        %lay_8598 = cute.get_layout(%view_8584) : !memref_rmem_bf16_10
        %sz_8599 = cute.size(%lay_8598) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8600 = cute.get_leaves(%sz_8599) : !cute.int_tuple<"4">
        %2591 = cute.static : !cute.layout<"1:0">
        %iter_8601 = cute.get_iter(%view_8570) : !memref_smem_bf16_18
        %iter_8602 = cute.get_iter(%view_8584) : !memref_rmem_bf16_10
        %lay_8603 = cute.get_layout(%view_8570) : !memref_smem_bf16_18
        %lay_8604 = cute.get_layout(%view_8584) : !memref_rmem_bf16_10
        %append_8605 = cute.append_to_rank<2> (%lay_8603, %2591) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8606 = cute.append_to_rank<2> (%lay_8604, %2591) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8607 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8608 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8609 = cute.size(%lay_8607) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2592 = cute.get_scalars(%sz_8609) : !cute.int_tuple<"4">
        %c0_i32_8610 = arith.constant 0 : i32
        %c1_i32_8611 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8610 to %2592 step %c1_i32_8611  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8607, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8607) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8601, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8608, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8608) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8602, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8612 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8613 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8614 = cute.crd2idx(%coord_8612, %lay_8613) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
        %iter_8615 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8616 = cute.add_offset(%iter_8615, %idx_8614) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8617 = cute.make_view(%ptr_8616) : !memref_rmem_bf16_12
        %iter_8618 = cute.get_iter(%view_8617) : !memref_rmem_bf16_12
        %iter_8619 = cute.get_iter(%view_8617) : !memref_rmem_bf16_12
        %coord_8620 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8621 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8622 = cute.crd2idx(%coord_8620, %lay_8621) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
        %iter_8623 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8624 = cute.add_offset(%iter_8623, %idx_8622) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8625 = cute.make_view(%ptr_8624) : !memref_rmem_bf16_13
        %iter_8626 = cute.get_iter(%view_8625) : !memref_rmem_bf16_13
        %iter_8627 = cute.get_iter(%view_8625) : !memref_rmem_bf16_13
        %lay_8628 = cute.get_layout(%view_8617) : !memref_rmem_bf16_12
        %2593 = cute.get_shape(%lay_8628) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8629, %e1_8630, %e2_8631, %e3_8632 = cute.get_leaves(%2593) : !cute.shape<"((2,2,2),2)">
        %lay_8633 = cute.get_layout(%view_8625) : !memref_rmem_bf16_13
        %2594 = cute.get_shape(%lay_8633) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8634, %e1_8635, %e2_8636 = cute.get_leaves(%2594) : !cute.shape<"((2,2),8)">
        %iter_8637 = cute.get_iter(%view_8617) : !memref_rmem_bf16_12
        %iter_8638 = cute.get_iter(%view_8625) : !memref_rmem_bf16_13
        %iter_8639 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_8640 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_8641 = cute.get_layout(%view_8617) : !memref_rmem_bf16_12
        %lay_8642 = cute.get_layout(%view_8625) : !memref_rmem_bf16_13
        %lay_8643 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_8644 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2595 = cute.static : !cute.layout<"1:0">
        %append_8645 = cute.append_to_rank<3> (%lay_8641, %2595) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8646 = cute.append_to_rank<3> (%lay_8642, %2595) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8647 = cute.size(%append_8645) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8648 = cute.size(%append_8645) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8649 = cute.size(%append_8646) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2596 = cute.get_scalars(%sz_8647) : !cute.int_tuple<"1">
        %2597 = cute.get_scalars(%sz_8648) : !cute.int_tuple<"2">
        %2598 = cute.get_scalars(%sz_8649) : !cute.int_tuple<"8">
        %c0_i32_8650 = arith.constant 0 : i32
        %c1_i32_8651 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8650 to %2596 step %c1_i32_8651  : i32 {
          scf.for %arg14 = %c0_i32_8650 to %2597 step %c1_i32_8651  : i32 {
            scf.for %arg15 = %c0_i32_8650 to %2598 step %c1_i32_8651  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_8645, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_8645) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_8637, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_8646, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_8646) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_8638, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_8643, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_8643) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_8639, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_8644, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_8644) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_8640, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8652 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8653 = cute.size(%int_tuple_8652) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8654 = cute.get_leaves(%sz_8653) : !cute.int_tuple<"8">
        %coord_8655 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8656 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_8657 = cute.crd2idx(%coord_8655, %lay_8656) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
        %iter_8658 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_8659 = cute.add_offset(%iter_8658, %idx_8657) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8660 = cute.make_view(%ptr_8659) : !memref_smem_bf16_14
        %iter_8661 = cute.get_iter(%view_8660) : !memref_smem_bf16_14
        %iter_8662 = cute.get_iter(%view_8660) : !memref_smem_bf16_14
        %coord_8663 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8664 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8665 = cute.crd2idx(%coord_8663, %lay_8664) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
        %iter_8666 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8667 = cute.add_offset(%iter_8666, %idx_8665) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8668 = cute.make_view(%ptr_8667) : !memref_rmem_bf16_6
        %iter_8669 = cute.get_iter(%view_8668) : !memref_rmem_bf16_6
        %iter_8670 = cute.get_iter(%view_8668) : !memref_rmem_bf16_6
        %lay_8671 = cute.get_layout(%view_8660) : !memref_smem_bf16_14
        %2599 = cute.get_shape(%lay_8671) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8672, %e1_8673, %e2_8674 = cute.get_leaves(%2599) : !cute.shape<"((8,1),2)">
        %lay_8675 = cute.get_layout(%view_8668) : !memref_rmem_bf16_6
        %2600 = cute.get_shape(%lay_8675) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8676, %e1_8677, %e2_8678 = cute.get_leaves(%2600) : !cute.shape<"((8,1),2)">
        %lay_8679 = cute.get_layout(%view_8660) : !memref_smem_bf16_14
        %shape_8680 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8681 = cute.make_layout() : !cute.layout<"1:0">
        %append_8682 = cute.append_to_rank<2> (%lay_8679, %lay_8681) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8683 = cute.make_view(%iter_8662, %append_8682) : !memref_smem_bf16_14
        %iter_8684 = cute.get_iter(%view_8683) : !memref_smem_bf16_14
        %lay_8685 = cute.get_layout(%view_8683) : !memref_smem_bf16_14
        %2601 = cute.get_shape(%lay_8685) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8686, %e1_8687, %e2_8688 = cute.get_leaves(%2601) : !cute.shape<"((8,1),2)">
        %iter_8689 = cute.get_iter(%view_8683) : !memref_smem_bf16_14
        %view_8690 = cute.make_view(%iter_8689) : !memref_smem_bf16_15
        %iter_8691 = cute.get_iter(%view_8690) : !memref_smem_bf16_15
        %iter_8692 = cute.get_iter(%view_8690) : !memref_smem_bf16_15
        %lay_8693 = cute.get_layout(%view_8668) : !memref_rmem_bf16_6
        %shape_8694 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8695 = cute.make_layout() : !cute.layout<"1:0">
        %append_8696 = cute.append_to_rank<2> (%lay_8693, %lay_8695) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8697 = cute.make_view(%iter_8670, %append_8696) : !memref_rmem_bf16_6
        %iter_8698 = cute.get_iter(%view_8697) : !memref_rmem_bf16_6
        %lay_8699 = cute.get_layout(%view_8697) : !memref_rmem_bf16_6
        %2602 = cute.get_shape(%lay_8699) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8700, %e1_8701, %e2_8702 = cute.get_leaves(%2602) : !cute.shape<"((8,1),2)">
        %iter_8703 = cute.get_iter(%view_8697) : !memref_rmem_bf16_6
        %view_8704 = cute.make_view(%iter_8703) : !memref_rmem_bf16_7
        %iter_8705 = cute.get_iter(%view_8704) : !memref_rmem_bf16_7
        %iter_8706 = cute.get_iter(%view_8704) : !memref_rmem_bf16_7
        %lay_8707 = cute.get_layout(%view_8690) : !memref_smem_bf16_15
        %2603 = cute.get_shape(%lay_8707) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8708, %e1_8709, %e2_8710 = cute.get_leaves(%2603) : !cute.shape<"((8,1),(2))">
        %lay_8711 = cute.get_layout(%view_8704) : !memref_rmem_bf16_7
        %2604 = cute.get_shape(%lay_8711) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8712, %e1_8713, %e2_8714 = cute.get_leaves(%2604) : !cute.shape<"((8,1),(2))">
        %lay_8715 = cute.get_layout(%view_8690) : !memref_smem_bf16_15
        %sz_8716 = cute.size(%lay_8715) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8717 = cute.get_leaves(%sz_8716) : !cute.int_tuple<"2">
        %lay_8718 = cute.get_layout(%view_8704) : !memref_rmem_bf16_7
        %sz_8719 = cute.size(%lay_8718) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8720 = cute.get_leaves(%sz_8719) : !cute.int_tuple<"2">
        %2605 = cute.static : !cute.layout<"1:0">
        %iter_8721 = cute.get_iter(%view_8690) : !memref_smem_bf16_15
        %iter_8722 = cute.get_iter(%view_8704) : !memref_rmem_bf16_7
        %lay_8723 = cute.get_layout(%view_8690) : !memref_smem_bf16_15
        %lay_8724 = cute.get_layout(%view_8704) : !memref_rmem_bf16_7
        %append_8725 = cute.append_to_rank<2> (%lay_8723, %2605) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8726 = cute.append_to_rank<2> (%lay_8724, %2605) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8727 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8728 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8729 = cute.size(%lay_8727) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2606 = cute.get_scalars(%sz_8729) : !cute.int_tuple<"2">
        %c0_i32_8730 = arith.constant 0 : i32
        %c1_i32_8731 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8730 to %2606 step %c1_i32_8731  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8727, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8727) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_8721, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8728, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8728) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8722, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8732 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8733 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_8734 = cute.crd2idx(%coord_8732, %lay_8733) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
        %iter_8735 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_8736 = cute.add_offset(%iter_8735, %idx_8734) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8737 = cute.make_view(%ptr_8736) : !memref_smem_bf16_17
        %iter_8738 = cute.get_iter(%view_8737) : !memref_smem_bf16_17
        %iter_8739 = cute.get_iter(%view_8737) : !memref_smem_bf16_17
        %coord_8740 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8741 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_8742 = cute.crd2idx(%coord_8740, %lay_8741) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
        %iter_8743 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_8744 = cute.add_offset(%iter_8743, %idx_8742) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8745 = cute.make_view(%ptr_8744) : !memref_rmem_bf16_9
        %iter_8746 = cute.get_iter(%view_8745) : !memref_rmem_bf16_9
        %iter_8747 = cute.get_iter(%view_8745) : !memref_rmem_bf16_9
        %lay_8748 = cute.get_layout(%view_8737) : !memref_smem_bf16_17
        %2607 = cute.get_shape(%lay_8748) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8749, %e1_8750, %e2_8751 = cute.get_leaves(%2607) : !cute.shape<"((8,1),4)">
        %lay_8752 = cute.get_layout(%view_8745) : !memref_rmem_bf16_9
        %2608 = cute.get_shape(%lay_8752) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8753, %e1_8754, %e2_8755 = cute.get_leaves(%2608) : !cute.shape<"((8,1),4)">
        %lay_8756 = cute.get_layout(%view_8737) : !memref_smem_bf16_17
        %shape_8757 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8758 = cute.make_layout() : !cute.layout<"1:0">
        %append_8759 = cute.append_to_rank<2> (%lay_8756, %lay_8758) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8760 = cute.make_view(%iter_8739, %append_8759) : !memref_smem_bf16_17
        %iter_8761 = cute.get_iter(%view_8760) : !memref_smem_bf16_17
        %lay_8762 = cute.get_layout(%view_8760) : !memref_smem_bf16_17
        %2609 = cute.get_shape(%lay_8762) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8763, %e1_8764, %e2_8765 = cute.get_leaves(%2609) : !cute.shape<"((8,1),4)">
        %iter_8766 = cute.get_iter(%view_8760) : !memref_smem_bf16_17
        %view_8767 = cute.make_view(%iter_8766) : !memref_smem_bf16_18
        %iter_8768 = cute.get_iter(%view_8767) : !memref_smem_bf16_18
        %iter_8769 = cute.get_iter(%view_8767) : !memref_smem_bf16_18
        %lay_8770 = cute.get_layout(%view_8745) : !memref_rmem_bf16_9
        %shape_8771 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8772 = cute.make_layout() : !cute.layout<"1:0">
        %append_8773 = cute.append_to_rank<2> (%lay_8770, %lay_8772) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8774 = cute.make_view(%iter_8747, %append_8773) : !memref_rmem_bf16_9
        %iter_8775 = cute.get_iter(%view_8774) : !memref_rmem_bf16_9
        %lay_8776 = cute.get_layout(%view_8774) : !memref_rmem_bf16_9
        %2610 = cute.get_shape(%lay_8776) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8777, %e1_8778, %e2_8779 = cute.get_leaves(%2610) : !cute.shape<"((8,1),4)">
        %iter_8780 = cute.get_iter(%view_8774) : !memref_rmem_bf16_9
        %view_8781 = cute.make_view(%iter_8780) : !memref_rmem_bf16_10
        %iter_8782 = cute.get_iter(%view_8781) : !memref_rmem_bf16_10
        %iter_8783 = cute.get_iter(%view_8781) : !memref_rmem_bf16_10
        %lay_8784 = cute.get_layout(%view_8767) : !memref_smem_bf16_18
        %2611 = cute.get_shape(%lay_8784) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8785, %e1_8786, %e2_8787 = cute.get_leaves(%2611) : !cute.shape<"((8,1),(4))">
        %lay_8788 = cute.get_layout(%view_8781) : !memref_rmem_bf16_10
        %2612 = cute.get_shape(%lay_8788) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8789, %e1_8790, %e2_8791 = cute.get_leaves(%2612) : !cute.shape<"((8,1),(4))">
        %lay_8792 = cute.get_layout(%view_8767) : !memref_smem_bf16_18
        %sz_8793 = cute.size(%lay_8792) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8794 = cute.get_leaves(%sz_8793) : !cute.int_tuple<"4">
        %lay_8795 = cute.get_layout(%view_8781) : !memref_rmem_bf16_10
        %sz_8796 = cute.size(%lay_8795) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8797 = cute.get_leaves(%sz_8796) : !cute.int_tuple<"4">
        %2613 = cute.static : !cute.layout<"1:0">
        %iter_8798 = cute.get_iter(%view_8767) : !memref_smem_bf16_18
        %iter_8799 = cute.get_iter(%view_8781) : !memref_rmem_bf16_10
        %lay_8800 = cute.get_layout(%view_8767) : !memref_smem_bf16_18
        %lay_8801 = cute.get_layout(%view_8781) : !memref_rmem_bf16_10
        %append_8802 = cute.append_to_rank<2> (%lay_8800, %2613) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8803 = cute.append_to_rank<2> (%lay_8801, %2613) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8804 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8805 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8806 = cute.size(%lay_8804) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2614 = cute.get_scalars(%sz_8806) : !cute.int_tuple<"4">
        %c0_i32_8807 = arith.constant 0 : i32
        %c1_i32_8808 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8807 to %2614 step %c1_i32_8808  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8804, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8804) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8798, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8805, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8805) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8799, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8809 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8810 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8811 = cute.crd2idx(%coord_8809, %lay_8810) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
        %iter_8812 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8813 = cute.add_offset(%iter_8812, %idx_8811) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8814 = cute.make_view(%ptr_8813) : !memref_rmem_bf16_12
        %iter_8815 = cute.get_iter(%view_8814) : !memref_rmem_bf16_12
        %iter_8816 = cute.get_iter(%view_8814) : !memref_rmem_bf16_12
        %coord_8817 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8818 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8819 = cute.crd2idx(%coord_8817, %lay_8818) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
        %iter_8820 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8821 = cute.add_offset(%iter_8820, %idx_8819) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8822 = cute.make_view(%ptr_8821) : !memref_rmem_bf16_13
        %iter_8823 = cute.get_iter(%view_8822) : !memref_rmem_bf16_13
        %iter_8824 = cute.get_iter(%view_8822) : !memref_rmem_bf16_13
        %lay_8825 = cute.get_layout(%view_8814) : !memref_rmem_bf16_12
        %2615 = cute.get_shape(%lay_8825) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8826, %e1_8827, %e2_8828, %e3_8829 = cute.get_leaves(%2615) : !cute.shape<"((2,2,2),2)">
        %lay_8830 = cute.get_layout(%view_8822) : !memref_rmem_bf16_13
        %2616 = cute.get_shape(%lay_8830) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8831, %e1_8832, %e2_8833 = cute.get_leaves(%2616) : !cute.shape<"((2,2),8)">
        %iter_8834 = cute.get_iter(%view_8814) : !memref_rmem_bf16_12
        %iter_8835 = cute.get_iter(%view_8822) : !memref_rmem_bf16_13
        %iter_8836 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_8837 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_8838 = cute.get_layout(%view_8814) : !memref_rmem_bf16_12
        %lay_8839 = cute.get_layout(%view_8822) : !memref_rmem_bf16_13
        %lay_8840 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_8841 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2617 = cute.static : !cute.layout<"1:0">
        %append_8842 = cute.append_to_rank<3> (%lay_8838, %2617) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8843 = cute.append_to_rank<3> (%lay_8839, %2617) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8844 = cute.size(%append_8842) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8845 = cute.size(%append_8842) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8846 = cute.size(%append_8843) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2618 = cute.get_scalars(%sz_8844) : !cute.int_tuple<"1">
        %2619 = cute.get_scalars(%sz_8845) : !cute.int_tuple<"2">
        %2620 = cute.get_scalars(%sz_8846) : !cute.int_tuple<"8">
        %c0_i32_8847 = arith.constant 0 : i32
        %c1_i32_8848 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8847 to %2618 step %c1_i32_8848  : i32 {
          scf.for %arg14 = %c0_i32_8847 to %2619 step %c1_i32_8848  : i32 {
            scf.for %arg15 = %c0_i32_8847 to %2620 step %c1_i32_8848  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_8842, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_8842) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_8834, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_8843, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_8843) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_8835, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_8840, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_8840) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_8836, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_8841, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_8841) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_8837, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8849 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8850 = cute.size(%int_tuple_8849) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8851 = cute.get_leaves(%sz_8850) : !cute.int_tuple<"8">
        %coord_8852 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8853 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_8854 = cute.crd2idx(%coord_8852, %lay_8853) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8855 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_8856 = cute.add_offset(%iter_8855, %idx_8854) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8857 = cute.make_view(%ptr_8856) : !memref_smem_bf16_14
        %iter_8858 = cute.get_iter(%view_8857) : !memref_smem_bf16_14
        %iter_8859 = cute.get_iter(%view_8857) : !memref_smem_bf16_14
        %coord_8860 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8861 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8862 = cute.crd2idx(%coord_8860, %lay_8861) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
        %iter_8863 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8864 = cute.add_offset(%iter_8863, %idx_8862) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8865 = cute.make_view(%ptr_8864) : !memref_rmem_bf16_6
        %iter_8866 = cute.get_iter(%view_8865) : !memref_rmem_bf16_6
        %iter_8867 = cute.get_iter(%view_8865) : !memref_rmem_bf16_6
        %lay_8868 = cute.get_layout(%view_8857) : !memref_smem_bf16_14
        %2621 = cute.get_shape(%lay_8868) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8869, %e1_8870, %e2_8871 = cute.get_leaves(%2621) : !cute.shape<"((8,1),2)">
        %lay_8872 = cute.get_layout(%view_8865) : !memref_rmem_bf16_6
        %2622 = cute.get_shape(%lay_8872) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8873, %e1_8874, %e2_8875 = cute.get_leaves(%2622) : !cute.shape<"((8,1),2)">
        %lay_8876 = cute.get_layout(%view_8857) : !memref_smem_bf16_14
        %shape_8877 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8878 = cute.make_layout() : !cute.layout<"1:0">
        %append_8879 = cute.append_to_rank<2> (%lay_8876, %lay_8878) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8880 = cute.make_view(%iter_8859, %append_8879) : !memref_smem_bf16_14
        %iter_8881 = cute.get_iter(%view_8880) : !memref_smem_bf16_14
        %lay_8882 = cute.get_layout(%view_8880) : !memref_smem_bf16_14
        %2623 = cute.get_shape(%lay_8882) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8883, %e1_8884, %e2_8885 = cute.get_leaves(%2623) : !cute.shape<"((8,1),2)">
        %iter_8886 = cute.get_iter(%view_8880) : !memref_smem_bf16_14
        %view_8887 = cute.make_view(%iter_8886) : !memref_smem_bf16_15
        %iter_8888 = cute.get_iter(%view_8887) : !memref_smem_bf16_15
        %iter_8889 = cute.get_iter(%view_8887) : !memref_smem_bf16_15
        %lay_8890 = cute.get_layout(%view_8865) : !memref_rmem_bf16_6
        %shape_8891 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8892 = cute.make_layout() : !cute.layout<"1:0">
        %append_8893 = cute.append_to_rank<2> (%lay_8890, %lay_8892) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8894 = cute.make_view(%iter_8867, %append_8893) : !memref_rmem_bf16_6
        %iter_8895 = cute.get_iter(%view_8894) : !memref_rmem_bf16_6
        %lay_8896 = cute.get_layout(%view_8894) : !memref_rmem_bf16_6
        %2624 = cute.get_shape(%lay_8896) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8897, %e1_8898, %e2_8899 = cute.get_leaves(%2624) : !cute.shape<"((8,1),2)">
        %iter_8900 = cute.get_iter(%view_8894) : !memref_rmem_bf16_6
        %view_8901 = cute.make_view(%iter_8900) : !memref_rmem_bf16_7
        %iter_8902 = cute.get_iter(%view_8901) : !memref_rmem_bf16_7
        %iter_8903 = cute.get_iter(%view_8901) : !memref_rmem_bf16_7
        %lay_8904 = cute.get_layout(%view_8887) : !memref_smem_bf16_15
        %2625 = cute.get_shape(%lay_8904) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8905, %e1_8906, %e2_8907 = cute.get_leaves(%2625) : !cute.shape<"((8,1),(2))">
        %lay_8908 = cute.get_layout(%view_8901) : !memref_rmem_bf16_7
        %2626 = cute.get_shape(%lay_8908) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8909, %e1_8910, %e2_8911 = cute.get_leaves(%2626) : !cute.shape<"((8,1),(2))">
        %lay_8912 = cute.get_layout(%view_8887) : !memref_smem_bf16_15
        %sz_8913 = cute.size(%lay_8912) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8914 = cute.get_leaves(%sz_8913) : !cute.int_tuple<"2">
        %lay_8915 = cute.get_layout(%view_8901) : !memref_rmem_bf16_7
        %sz_8916 = cute.size(%lay_8915) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8917 = cute.get_leaves(%sz_8916) : !cute.int_tuple<"2">
        %2627 = cute.static : !cute.layout<"1:0">
        %iter_8918 = cute.get_iter(%view_8887) : !memref_smem_bf16_15
        %iter_8919 = cute.get_iter(%view_8901) : !memref_rmem_bf16_7
        %lay_8920 = cute.get_layout(%view_8887) : !memref_smem_bf16_15
        %lay_8921 = cute.get_layout(%view_8901) : !memref_rmem_bf16_7
        %append_8922 = cute.append_to_rank<2> (%lay_8920, %2627) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8923 = cute.append_to_rank<2> (%lay_8921, %2627) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8924 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8925 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8926 = cute.size(%lay_8924) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2628 = cute.get_scalars(%sz_8926) : !cute.int_tuple<"2">
        %c0_i32_8927 = arith.constant 0 : i32
        %c1_i32_8928 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8927 to %2628 step %c1_i32_8928  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_8924, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_8924) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_8918, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_8925, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_8925) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8919, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8929 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8930 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_8931 = cute.crd2idx(%coord_8929, %lay_8930) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8932 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_8933 = cute.add_offset(%iter_8932, %idx_8931) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8934 = cute.make_view(%ptr_8933) : !memref_smem_bf16_17
        %iter_8935 = cute.get_iter(%view_8934) : !memref_smem_bf16_17
        %iter_8936 = cute.get_iter(%view_8934) : !memref_smem_bf16_17
        %coord_8937 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8938 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_8939 = cute.crd2idx(%coord_8937, %lay_8938) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
        %iter_8940 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_8941 = cute.add_offset(%iter_8940, %idx_8939) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8942 = cute.make_view(%ptr_8941) : !memref_rmem_bf16_9
        %iter_8943 = cute.get_iter(%view_8942) : !memref_rmem_bf16_9
        %iter_8944 = cute.get_iter(%view_8942) : !memref_rmem_bf16_9
        %lay_8945 = cute.get_layout(%view_8934) : !memref_smem_bf16_17
        %2629 = cute.get_shape(%lay_8945) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8946, %e1_8947, %e2_8948 = cute.get_leaves(%2629) : !cute.shape<"((8,1),4)">
        %lay_8949 = cute.get_layout(%view_8942) : !memref_rmem_bf16_9
        %2630 = cute.get_shape(%lay_8949) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8950, %e1_8951, %e2_8952 = cute.get_leaves(%2630) : !cute.shape<"((8,1),4)">
        %lay_8953 = cute.get_layout(%view_8934) : !memref_smem_bf16_17
        %shape_8954 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8955 = cute.make_layout() : !cute.layout<"1:0">
        %append_8956 = cute.append_to_rank<2> (%lay_8953, %lay_8955) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8957 = cute.make_view(%iter_8936, %append_8956) : !memref_smem_bf16_17
        %iter_8958 = cute.get_iter(%view_8957) : !memref_smem_bf16_17
        %lay_8959 = cute.get_layout(%view_8957) : !memref_smem_bf16_17
        %2631 = cute.get_shape(%lay_8959) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8960, %e1_8961, %e2_8962 = cute.get_leaves(%2631) : !cute.shape<"((8,1),4)">
        %iter_8963 = cute.get_iter(%view_8957) : !memref_smem_bf16_17
        %view_8964 = cute.make_view(%iter_8963) : !memref_smem_bf16_18
        %iter_8965 = cute.get_iter(%view_8964) : !memref_smem_bf16_18
        %iter_8966 = cute.get_iter(%view_8964) : !memref_smem_bf16_18
        %lay_8967 = cute.get_layout(%view_8942) : !memref_rmem_bf16_9
        %shape_8968 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8969 = cute.make_layout() : !cute.layout<"1:0">
        %append_8970 = cute.append_to_rank<2> (%lay_8967, %lay_8969) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8971 = cute.make_view(%iter_8944, %append_8970) : !memref_rmem_bf16_9
        %iter_8972 = cute.get_iter(%view_8971) : !memref_rmem_bf16_9
        %lay_8973 = cute.get_layout(%view_8971) : !memref_rmem_bf16_9
        %2632 = cute.get_shape(%lay_8973) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8974, %e1_8975, %e2_8976 = cute.get_leaves(%2632) : !cute.shape<"((8,1),4)">
        %iter_8977 = cute.get_iter(%view_8971) : !memref_rmem_bf16_9
        %view_8978 = cute.make_view(%iter_8977) : !memref_rmem_bf16_10
        %iter_8979 = cute.get_iter(%view_8978) : !memref_rmem_bf16_10
        %iter_8980 = cute.get_iter(%view_8978) : !memref_rmem_bf16_10
        %lay_8981 = cute.get_layout(%view_8964) : !memref_smem_bf16_18
        %2633 = cute.get_shape(%lay_8981) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8982, %e1_8983, %e2_8984 = cute.get_leaves(%2633) : !cute.shape<"((8,1),(4))">
        %lay_8985 = cute.get_layout(%view_8978) : !memref_rmem_bf16_10
        %2634 = cute.get_shape(%lay_8985) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8986, %e1_8987, %e2_8988 = cute.get_leaves(%2634) : !cute.shape<"((8,1),(4))">
        %lay_8989 = cute.get_layout(%view_8964) : !memref_smem_bf16_18
        %sz_8990 = cute.size(%lay_8989) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8991 = cute.get_leaves(%sz_8990) : !cute.int_tuple<"4">
        %lay_8992 = cute.get_layout(%view_8978) : !memref_rmem_bf16_10
        %sz_8993 = cute.size(%lay_8992) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8994 = cute.get_leaves(%sz_8993) : !cute.int_tuple<"4">
        %2635 = cute.static : !cute.layout<"1:0">
        %iter_8995 = cute.get_iter(%view_8964) : !memref_smem_bf16_18
        %iter_8996 = cute.get_iter(%view_8978) : !memref_rmem_bf16_10
        %lay_8997 = cute.get_layout(%view_8964) : !memref_smem_bf16_18
        %lay_8998 = cute.get_layout(%view_8978) : !memref_rmem_bf16_10
        %append_8999 = cute.append_to_rank<2> (%lay_8997, %2635) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9000 = cute.append_to_rank<2> (%lay_8998, %2635) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9001 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9002 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9003 = cute.size(%lay_9001) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2636 = cute.get_scalars(%sz_9003) : !cute.int_tuple<"4">
        %c0_i32_9004 = arith.constant 0 : i32
        %c1_i32_9005 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9004 to %2636 step %c1_i32_9005  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9001, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9001) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_8995, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9002, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9002) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_8996, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9006 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9007 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9008 = cute.crd2idx(%coord_9006, %lay_9007) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
        %iter_9009 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9010 = cute.add_offset(%iter_9009, %idx_9008) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9011 = cute.make_view(%ptr_9010) : !memref_rmem_bf16_12
        %iter_9012 = cute.get_iter(%view_9011) : !memref_rmem_bf16_12
        %iter_9013 = cute.get_iter(%view_9011) : !memref_rmem_bf16_12
        %coord_9014 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_9015 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9016 = cute.crd2idx(%coord_9014, %lay_9015) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
        %iter_9017 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9018 = cute.add_offset(%iter_9017, %idx_9016) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9019 = cute.make_view(%ptr_9018) : !memref_rmem_bf16_13
        %iter_9020 = cute.get_iter(%view_9019) : !memref_rmem_bf16_13
        %iter_9021 = cute.get_iter(%view_9019) : !memref_rmem_bf16_13
        %lay_9022 = cute.get_layout(%view_9011) : !memref_rmem_bf16_12
        %2637 = cute.get_shape(%lay_9022) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9023, %e1_9024, %e2_9025, %e3_9026 = cute.get_leaves(%2637) : !cute.shape<"((2,2,2),2)">
        %lay_9027 = cute.get_layout(%view_9019) : !memref_rmem_bf16_13
        %2638 = cute.get_shape(%lay_9027) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9028, %e1_9029, %e2_9030 = cute.get_leaves(%2638) : !cute.shape<"((2,2),8)">
        %iter_9031 = cute.get_iter(%view_9011) : !memref_rmem_bf16_12
        %iter_9032 = cute.get_iter(%view_9019) : !memref_rmem_bf16_13
        %iter_9033 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_9034 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_9035 = cute.get_layout(%view_9011) : !memref_rmem_bf16_12
        %lay_9036 = cute.get_layout(%view_9019) : !memref_rmem_bf16_13
        %lay_9037 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_9038 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2639 = cute.static : !cute.layout<"1:0">
        %append_9039 = cute.append_to_rank<3> (%lay_9035, %2639) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9040 = cute.append_to_rank<3> (%lay_9036, %2639) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9041 = cute.size(%append_9039) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9042 = cute.size(%append_9039) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9043 = cute.size(%append_9040) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2640 = cute.get_scalars(%sz_9041) : !cute.int_tuple<"1">
        %2641 = cute.get_scalars(%sz_9042) : !cute.int_tuple<"2">
        %2642 = cute.get_scalars(%sz_9043) : !cute.int_tuple<"8">
        %c0_i32_9044 = arith.constant 0 : i32
        %c1_i32_9045 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9044 to %2640 step %c1_i32_9045  : i32 {
          scf.for %arg14 = %c0_i32_9044 to %2641 step %c1_i32_9045  : i32 {
            scf.for %arg15 = %c0_i32_9044 to %2642 step %c1_i32_9045  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_9039, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_9039) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_9031, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_9040, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_9040) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_9032, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_9037, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_9037) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_9033, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_9038, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_9038) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_9034, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9046 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9047 = cute.size(%int_tuple_9046) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9048 = cute.get_leaves(%sz_9047) : !cute.int_tuple<"8">
        %coord_9049 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9050 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_9051 = cute.crd2idx(%coord_9049, %lay_9050) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9052 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_9053 = cute.add_offset(%iter_9052, %idx_9051) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9054 = cute.make_view(%ptr_9053) : !memref_smem_bf16_14
        %iter_9055 = cute.get_iter(%view_9054) : !memref_smem_bf16_14
        %iter_9056 = cute.get_iter(%view_9054) : !memref_smem_bf16_14
        %coord_9057 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9058 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_9059 = cute.crd2idx(%coord_9057, %lay_9058) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
        %iter_9060 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_9061 = cute.add_offset(%iter_9060, %idx_9059) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9062 = cute.make_view(%ptr_9061) : !memref_rmem_bf16_6
        %iter_9063 = cute.get_iter(%view_9062) : !memref_rmem_bf16_6
        %iter_9064 = cute.get_iter(%view_9062) : !memref_rmem_bf16_6
        %lay_9065 = cute.get_layout(%view_9054) : !memref_smem_bf16_14
        %2643 = cute.get_shape(%lay_9065) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9066, %e1_9067, %e2_9068 = cute.get_leaves(%2643) : !cute.shape<"((8,1),2)">
        %lay_9069 = cute.get_layout(%view_9062) : !memref_rmem_bf16_6
        %2644 = cute.get_shape(%lay_9069) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9070, %e1_9071, %e2_9072 = cute.get_leaves(%2644) : !cute.shape<"((8,1),2)">
        %lay_9073 = cute.get_layout(%view_9054) : !memref_smem_bf16_14
        %shape_9074 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9075 = cute.make_layout() : !cute.layout<"1:0">
        %append_9076 = cute.append_to_rank<2> (%lay_9073, %lay_9075) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9077 = cute.make_view(%iter_9056, %append_9076) : !memref_smem_bf16_14
        %iter_9078 = cute.get_iter(%view_9077) : !memref_smem_bf16_14
        %lay_9079 = cute.get_layout(%view_9077) : !memref_smem_bf16_14
        %2645 = cute.get_shape(%lay_9079) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9080, %e1_9081, %e2_9082 = cute.get_leaves(%2645) : !cute.shape<"((8,1),2)">
        %iter_9083 = cute.get_iter(%view_9077) : !memref_smem_bf16_14
        %view_9084 = cute.make_view(%iter_9083) : !memref_smem_bf16_15
        %iter_9085 = cute.get_iter(%view_9084) : !memref_smem_bf16_15
        %iter_9086 = cute.get_iter(%view_9084) : !memref_smem_bf16_15
        %lay_9087 = cute.get_layout(%view_9062) : !memref_rmem_bf16_6
        %shape_9088 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9089 = cute.make_layout() : !cute.layout<"1:0">
        %append_9090 = cute.append_to_rank<2> (%lay_9087, %lay_9089) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9091 = cute.make_view(%iter_9064, %append_9090) : !memref_rmem_bf16_6
        %iter_9092 = cute.get_iter(%view_9091) : !memref_rmem_bf16_6
        %lay_9093 = cute.get_layout(%view_9091) : !memref_rmem_bf16_6
        %2646 = cute.get_shape(%lay_9093) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9094, %e1_9095, %e2_9096 = cute.get_leaves(%2646) : !cute.shape<"((8,1),2)">
        %iter_9097 = cute.get_iter(%view_9091) : !memref_rmem_bf16_6
        %view_9098 = cute.make_view(%iter_9097) : !memref_rmem_bf16_7
        %iter_9099 = cute.get_iter(%view_9098) : !memref_rmem_bf16_7
        %iter_9100 = cute.get_iter(%view_9098) : !memref_rmem_bf16_7
        %lay_9101 = cute.get_layout(%view_9084) : !memref_smem_bf16_15
        %2647 = cute.get_shape(%lay_9101) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9102, %e1_9103, %e2_9104 = cute.get_leaves(%2647) : !cute.shape<"((8,1),(2))">
        %lay_9105 = cute.get_layout(%view_9098) : !memref_rmem_bf16_7
        %2648 = cute.get_shape(%lay_9105) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9106, %e1_9107, %e2_9108 = cute.get_leaves(%2648) : !cute.shape<"((8,1),(2))">
        %lay_9109 = cute.get_layout(%view_9084) : !memref_smem_bf16_15
        %sz_9110 = cute.size(%lay_9109) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9111 = cute.get_leaves(%sz_9110) : !cute.int_tuple<"2">
        %lay_9112 = cute.get_layout(%view_9098) : !memref_rmem_bf16_7
        %sz_9113 = cute.size(%lay_9112) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9114 = cute.get_leaves(%sz_9113) : !cute.int_tuple<"2">
        %2649 = cute.static : !cute.layout<"1:0">
        %iter_9115 = cute.get_iter(%view_9084) : !memref_smem_bf16_15
        %iter_9116 = cute.get_iter(%view_9098) : !memref_rmem_bf16_7
        %lay_9117 = cute.get_layout(%view_9084) : !memref_smem_bf16_15
        %lay_9118 = cute.get_layout(%view_9098) : !memref_rmem_bf16_7
        %append_9119 = cute.append_to_rank<2> (%lay_9117, %2649) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9120 = cute.append_to_rank<2> (%lay_9118, %2649) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9121 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9122 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9123 = cute.size(%lay_9121) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2650 = cute.get_scalars(%sz_9123) : !cute.int_tuple<"2">
        %c0_i32_9124 = arith.constant 0 : i32
        %c1_i32_9125 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9124 to %2650 step %c1_i32_9125  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9121, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9121) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_9115, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9122, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9122) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9116, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9126 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9127 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_9128 = cute.crd2idx(%coord_9126, %lay_9127) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_9129 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_9130 = cute.add_offset(%iter_9129, %idx_9128) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9131 = cute.make_view(%ptr_9130) : !memref_smem_bf16_17
        %iter_9132 = cute.get_iter(%view_9131) : !memref_smem_bf16_17
        %iter_9133 = cute.get_iter(%view_9131) : !memref_smem_bf16_17
        %coord_9134 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9135 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_9136 = cute.crd2idx(%coord_9134, %lay_9135) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
        %iter_9137 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_9138 = cute.add_offset(%iter_9137, %idx_9136) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9139 = cute.make_view(%ptr_9138) : !memref_rmem_bf16_9
        %iter_9140 = cute.get_iter(%view_9139) : !memref_rmem_bf16_9
        %iter_9141 = cute.get_iter(%view_9139) : !memref_rmem_bf16_9
        %lay_9142 = cute.get_layout(%view_9131) : !memref_smem_bf16_17
        %2651 = cute.get_shape(%lay_9142) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9143, %e1_9144, %e2_9145 = cute.get_leaves(%2651) : !cute.shape<"((8,1),4)">
        %lay_9146 = cute.get_layout(%view_9139) : !memref_rmem_bf16_9
        %2652 = cute.get_shape(%lay_9146) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9147, %e1_9148, %e2_9149 = cute.get_leaves(%2652) : !cute.shape<"((8,1),4)">
        %lay_9150 = cute.get_layout(%view_9131) : !memref_smem_bf16_17
        %shape_9151 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9152 = cute.make_layout() : !cute.layout<"1:0">
        %append_9153 = cute.append_to_rank<2> (%lay_9150, %lay_9152) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9154 = cute.make_view(%iter_9133, %append_9153) : !memref_smem_bf16_17
        %iter_9155 = cute.get_iter(%view_9154) : !memref_smem_bf16_17
        %lay_9156 = cute.get_layout(%view_9154) : !memref_smem_bf16_17
        %2653 = cute.get_shape(%lay_9156) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9157, %e1_9158, %e2_9159 = cute.get_leaves(%2653) : !cute.shape<"((8,1),4)">
        %iter_9160 = cute.get_iter(%view_9154) : !memref_smem_bf16_17
        %view_9161 = cute.make_view(%iter_9160) : !memref_smem_bf16_18
        %iter_9162 = cute.get_iter(%view_9161) : !memref_smem_bf16_18
        %iter_9163 = cute.get_iter(%view_9161) : !memref_smem_bf16_18
        %lay_9164 = cute.get_layout(%view_9139) : !memref_rmem_bf16_9
        %shape_9165 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9166 = cute.make_layout() : !cute.layout<"1:0">
        %append_9167 = cute.append_to_rank<2> (%lay_9164, %lay_9166) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9168 = cute.make_view(%iter_9141, %append_9167) : !memref_rmem_bf16_9
        %iter_9169 = cute.get_iter(%view_9168) : !memref_rmem_bf16_9
        %lay_9170 = cute.get_layout(%view_9168) : !memref_rmem_bf16_9
        %2654 = cute.get_shape(%lay_9170) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9171, %e1_9172, %e2_9173 = cute.get_leaves(%2654) : !cute.shape<"((8,1),4)">
        %iter_9174 = cute.get_iter(%view_9168) : !memref_rmem_bf16_9
        %view_9175 = cute.make_view(%iter_9174) : !memref_rmem_bf16_10
        %iter_9176 = cute.get_iter(%view_9175) : !memref_rmem_bf16_10
        %iter_9177 = cute.get_iter(%view_9175) : !memref_rmem_bf16_10
        %lay_9178 = cute.get_layout(%view_9161) : !memref_smem_bf16_18
        %2655 = cute.get_shape(%lay_9178) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9179, %e1_9180, %e2_9181 = cute.get_leaves(%2655) : !cute.shape<"((8,1),(4))">
        %lay_9182 = cute.get_layout(%view_9175) : !memref_rmem_bf16_10
        %2656 = cute.get_shape(%lay_9182) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9183, %e1_9184, %e2_9185 = cute.get_leaves(%2656) : !cute.shape<"((8,1),(4))">
        %lay_9186 = cute.get_layout(%view_9161) : !memref_smem_bf16_18
        %sz_9187 = cute.size(%lay_9186) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9188 = cute.get_leaves(%sz_9187) : !cute.int_tuple<"4">
        %lay_9189 = cute.get_layout(%view_9175) : !memref_rmem_bf16_10
        %sz_9190 = cute.size(%lay_9189) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9191 = cute.get_leaves(%sz_9190) : !cute.int_tuple<"4">
        %2657 = cute.static : !cute.layout<"1:0">
        %iter_9192 = cute.get_iter(%view_9161) : !memref_smem_bf16_18
        %iter_9193 = cute.get_iter(%view_9175) : !memref_rmem_bf16_10
        %lay_9194 = cute.get_layout(%view_9161) : !memref_smem_bf16_18
        %lay_9195 = cute.get_layout(%view_9175) : !memref_rmem_bf16_10
        %append_9196 = cute.append_to_rank<2> (%lay_9194, %2657) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9197 = cute.append_to_rank<2> (%lay_9195, %2657) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9198 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9199 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9200 = cute.size(%lay_9198) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2658 = cute.get_scalars(%sz_9200) : !cute.int_tuple<"4">
        %c0_i32_9201 = arith.constant 0 : i32
        %c1_i32_9202 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9201 to %2658 step %c1_i32_9202  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9198, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9198) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_9192, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9199, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9199) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9193, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9203 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9204 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9205 = cute.crd2idx(%coord_9203, %lay_9204) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
        %iter_9206 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9207 = cute.add_offset(%iter_9206, %idx_9205) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9208 = cute.make_view(%ptr_9207) : !memref_rmem_bf16_12
        %iter_9209 = cute.get_iter(%view_9208) : !memref_rmem_bf16_12
        %iter_9210 = cute.get_iter(%view_9208) : !memref_rmem_bf16_12
        %coord_9211 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9212 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9213 = cute.crd2idx(%coord_9211, %lay_9212) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
        %iter_9214 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9215 = cute.add_offset(%iter_9214, %idx_9213) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9216 = cute.make_view(%ptr_9215) : !memref_rmem_bf16_13
        %iter_9217 = cute.get_iter(%view_9216) : !memref_rmem_bf16_13
        %iter_9218 = cute.get_iter(%view_9216) : !memref_rmem_bf16_13
        %lay_9219 = cute.get_layout(%view_9208) : !memref_rmem_bf16_12
        %2659 = cute.get_shape(%lay_9219) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9220, %e1_9221, %e2_9222, %e3_9223 = cute.get_leaves(%2659) : !cute.shape<"((2,2,2),2)">
        %lay_9224 = cute.get_layout(%view_9216) : !memref_rmem_bf16_13
        %2660 = cute.get_shape(%lay_9224) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9225, %e1_9226, %e2_9227 = cute.get_leaves(%2660) : !cute.shape<"((2,2),8)">
        %iter_9228 = cute.get_iter(%view_9208) : !memref_rmem_bf16_12
        %iter_9229 = cute.get_iter(%view_9216) : !memref_rmem_bf16_13
        %iter_9230 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_9231 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_9232 = cute.get_layout(%view_9208) : !memref_rmem_bf16_12
        %lay_9233 = cute.get_layout(%view_9216) : !memref_rmem_bf16_13
        %lay_9234 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_9235 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2661 = cute.static : !cute.layout<"1:0">
        %append_9236 = cute.append_to_rank<3> (%lay_9232, %2661) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9237 = cute.append_to_rank<3> (%lay_9233, %2661) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9238 = cute.size(%append_9236) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9239 = cute.size(%append_9236) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9240 = cute.size(%append_9237) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2662 = cute.get_scalars(%sz_9238) : !cute.int_tuple<"1">
        %2663 = cute.get_scalars(%sz_9239) : !cute.int_tuple<"2">
        %2664 = cute.get_scalars(%sz_9240) : !cute.int_tuple<"8">
        %c0_i32_9241 = arith.constant 0 : i32
        %c1_i32_9242 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9241 to %2662 step %c1_i32_9242  : i32 {
          scf.for %arg14 = %c0_i32_9241 to %2663 step %c1_i32_9242  : i32 {
            scf.for %arg15 = %c0_i32_9241 to %2664 step %c1_i32_9242  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_9236, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_9236) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_9228, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_9237, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_9237) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_9229, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_9234, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_9234) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_9230, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_9235, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_9235) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_9231, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9243 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9244 = cute.size(%int_tuple_9243) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9245 = cute.get_leaves(%sz_9244) : !cute.int_tuple<"8">
        %coord_9246 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9247 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_9248 = cute.crd2idx(%coord_9246, %lay_9247) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9249 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_9250 = cute.add_offset(%iter_9249, %idx_9248) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9251 = cute.make_view(%ptr_9250) : !memref_smem_bf16_14
        %iter_9252 = cute.get_iter(%view_9251) : !memref_smem_bf16_14
        %iter_9253 = cute.get_iter(%view_9251) : !memref_smem_bf16_14
        %coord_9254 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9255 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_9256 = cute.crd2idx(%coord_9254, %lay_9255) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
        %iter_9257 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_9258 = cute.add_offset(%iter_9257, %idx_9256) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9259 = cute.make_view(%ptr_9258) : !memref_rmem_bf16_6
        %iter_9260 = cute.get_iter(%view_9259) : !memref_rmem_bf16_6
        %iter_9261 = cute.get_iter(%view_9259) : !memref_rmem_bf16_6
        %lay_9262 = cute.get_layout(%view_9251) : !memref_smem_bf16_14
        %2665 = cute.get_shape(%lay_9262) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9263, %e1_9264, %e2_9265 = cute.get_leaves(%2665) : !cute.shape<"((8,1),2)">
        %lay_9266 = cute.get_layout(%view_9259) : !memref_rmem_bf16_6
        %2666 = cute.get_shape(%lay_9266) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9267, %e1_9268, %e2_9269 = cute.get_leaves(%2666) : !cute.shape<"((8,1),2)">
        %lay_9270 = cute.get_layout(%view_9251) : !memref_smem_bf16_14
        %shape_9271 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9272 = cute.make_layout() : !cute.layout<"1:0">
        %append_9273 = cute.append_to_rank<2> (%lay_9270, %lay_9272) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9274 = cute.make_view(%iter_9253, %append_9273) : !memref_smem_bf16_14
        %iter_9275 = cute.get_iter(%view_9274) : !memref_smem_bf16_14
        %lay_9276 = cute.get_layout(%view_9274) : !memref_smem_bf16_14
        %2667 = cute.get_shape(%lay_9276) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9277, %e1_9278, %e2_9279 = cute.get_leaves(%2667) : !cute.shape<"((8,1),2)">
        %iter_9280 = cute.get_iter(%view_9274) : !memref_smem_bf16_14
        %view_9281 = cute.make_view(%iter_9280) : !memref_smem_bf16_15
        %iter_9282 = cute.get_iter(%view_9281) : !memref_smem_bf16_15
        %iter_9283 = cute.get_iter(%view_9281) : !memref_smem_bf16_15
        %lay_9284 = cute.get_layout(%view_9259) : !memref_rmem_bf16_6
        %shape_9285 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9286 = cute.make_layout() : !cute.layout<"1:0">
        %append_9287 = cute.append_to_rank<2> (%lay_9284, %lay_9286) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9288 = cute.make_view(%iter_9261, %append_9287) : !memref_rmem_bf16_6
        %iter_9289 = cute.get_iter(%view_9288) : !memref_rmem_bf16_6
        %lay_9290 = cute.get_layout(%view_9288) : !memref_rmem_bf16_6
        %2668 = cute.get_shape(%lay_9290) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9291, %e1_9292, %e2_9293 = cute.get_leaves(%2668) : !cute.shape<"((8,1),2)">
        %iter_9294 = cute.get_iter(%view_9288) : !memref_rmem_bf16_6
        %view_9295 = cute.make_view(%iter_9294) : !memref_rmem_bf16_7
        %iter_9296 = cute.get_iter(%view_9295) : !memref_rmem_bf16_7
        %iter_9297 = cute.get_iter(%view_9295) : !memref_rmem_bf16_7
        %lay_9298 = cute.get_layout(%view_9281) : !memref_smem_bf16_15
        %2669 = cute.get_shape(%lay_9298) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9299, %e1_9300, %e2_9301 = cute.get_leaves(%2669) : !cute.shape<"((8,1),(2))">
        %lay_9302 = cute.get_layout(%view_9295) : !memref_rmem_bf16_7
        %2670 = cute.get_shape(%lay_9302) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9303, %e1_9304, %e2_9305 = cute.get_leaves(%2670) : !cute.shape<"((8,1),(2))">
        %lay_9306 = cute.get_layout(%view_9281) : !memref_smem_bf16_15
        %sz_9307 = cute.size(%lay_9306) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9308 = cute.get_leaves(%sz_9307) : !cute.int_tuple<"2">
        %lay_9309 = cute.get_layout(%view_9295) : !memref_rmem_bf16_7
        %sz_9310 = cute.size(%lay_9309) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9311 = cute.get_leaves(%sz_9310) : !cute.int_tuple<"2">
        %2671 = cute.static : !cute.layout<"1:0">
        %iter_9312 = cute.get_iter(%view_9281) : !memref_smem_bf16_15
        %iter_9313 = cute.get_iter(%view_9295) : !memref_rmem_bf16_7
        %lay_9314 = cute.get_layout(%view_9281) : !memref_smem_bf16_15
        %lay_9315 = cute.get_layout(%view_9295) : !memref_rmem_bf16_7
        %append_9316 = cute.append_to_rank<2> (%lay_9314, %2671) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9317 = cute.append_to_rank<2> (%lay_9315, %2671) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9318 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9319 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9320 = cute.size(%lay_9318) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2672 = cute.get_scalars(%sz_9320) : !cute.int_tuple<"2">
        %c0_i32_9321 = arith.constant 0 : i32
        %c1_i32_9322 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9321 to %2672 step %c1_i32_9322  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9318, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9318) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_9312, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9319, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9319) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9313, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9323 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9324 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_9325 = cute.crd2idx(%coord_9323, %lay_9324) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9326 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_9327 = cute.add_offset(%iter_9326, %idx_9325) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9328 = cute.make_view(%ptr_9327) : !memref_smem_bf16_17
        %iter_9329 = cute.get_iter(%view_9328) : !memref_smem_bf16_17
        %iter_9330 = cute.get_iter(%view_9328) : !memref_smem_bf16_17
        %coord_9331 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9332 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_9333 = cute.crd2idx(%coord_9331, %lay_9332) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
        %iter_9334 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_9335 = cute.add_offset(%iter_9334, %idx_9333) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9336 = cute.make_view(%ptr_9335) : !memref_rmem_bf16_9
        %iter_9337 = cute.get_iter(%view_9336) : !memref_rmem_bf16_9
        %iter_9338 = cute.get_iter(%view_9336) : !memref_rmem_bf16_9
        %lay_9339 = cute.get_layout(%view_9328) : !memref_smem_bf16_17
        %2673 = cute.get_shape(%lay_9339) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9340, %e1_9341, %e2_9342 = cute.get_leaves(%2673) : !cute.shape<"((8,1),4)">
        %lay_9343 = cute.get_layout(%view_9336) : !memref_rmem_bf16_9
        %2674 = cute.get_shape(%lay_9343) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9344, %e1_9345, %e2_9346 = cute.get_leaves(%2674) : !cute.shape<"((8,1),4)">
        %lay_9347 = cute.get_layout(%view_9328) : !memref_smem_bf16_17
        %shape_9348 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9349 = cute.make_layout() : !cute.layout<"1:0">
        %append_9350 = cute.append_to_rank<2> (%lay_9347, %lay_9349) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9351 = cute.make_view(%iter_9330, %append_9350) : !memref_smem_bf16_17
        %iter_9352 = cute.get_iter(%view_9351) : !memref_smem_bf16_17
        %lay_9353 = cute.get_layout(%view_9351) : !memref_smem_bf16_17
        %2675 = cute.get_shape(%lay_9353) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9354, %e1_9355, %e2_9356 = cute.get_leaves(%2675) : !cute.shape<"((8,1),4)">
        %iter_9357 = cute.get_iter(%view_9351) : !memref_smem_bf16_17
        %view_9358 = cute.make_view(%iter_9357) : !memref_smem_bf16_18
        %iter_9359 = cute.get_iter(%view_9358) : !memref_smem_bf16_18
        %iter_9360 = cute.get_iter(%view_9358) : !memref_smem_bf16_18
        %lay_9361 = cute.get_layout(%view_9336) : !memref_rmem_bf16_9
        %shape_9362 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9363 = cute.make_layout() : !cute.layout<"1:0">
        %append_9364 = cute.append_to_rank<2> (%lay_9361, %lay_9363) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9365 = cute.make_view(%iter_9338, %append_9364) : !memref_rmem_bf16_9
        %iter_9366 = cute.get_iter(%view_9365) : !memref_rmem_bf16_9
        %lay_9367 = cute.get_layout(%view_9365) : !memref_rmem_bf16_9
        %2676 = cute.get_shape(%lay_9367) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9368, %e1_9369, %e2_9370 = cute.get_leaves(%2676) : !cute.shape<"((8,1),4)">
        %iter_9371 = cute.get_iter(%view_9365) : !memref_rmem_bf16_9
        %view_9372 = cute.make_view(%iter_9371) : !memref_rmem_bf16_10
        %iter_9373 = cute.get_iter(%view_9372) : !memref_rmem_bf16_10
        %iter_9374 = cute.get_iter(%view_9372) : !memref_rmem_bf16_10
        %lay_9375 = cute.get_layout(%view_9358) : !memref_smem_bf16_18
        %2677 = cute.get_shape(%lay_9375) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9376, %e1_9377, %e2_9378 = cute.get_leaves(%2677) : !cute.shape<"((8,1),(4))">
        %lay_9379 = cute.get_layout(%view_9372) : !memref_rmem_bf16_10
        %2678 = cute.get_shape(%lay_9379) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9380, %e1_9381, %e2_9382 = cute.get_leaves(%2678) : !cute.shape<"((8,1),(4))">
        %lay_9383 = cute.get_layout(%view_9358) : !memref_smem_bf16_18
        %sz_9384 = cute.size(%lay_9383) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9385 = cute.get_leaves(%sz_9384) : !cute.int_tuple<"4">
        %lay_9386 = cute.get_layout(%view_9372) : !memref_rmem_bf16_10
        %sz_9387 = cute.size(%lay_9386) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9388 = cute.get_leaves(%sz_9387) : !cute.int_tuple<"4">
        %2679 = cute.static : !cute.layout<"1:0">
        %iter_9389 = cute.get_iter(%view_9358) : !memref_smem_bf16_18
        %iter_9390 = cute.get_iter(%view_9372) : !memref_rmem_bf16_10
        %lay_9391 = cute.get_layout(%view_9358) : !memref_smem_bf16_18
        %lay_9392 = cute.get_layout(%view_9372) : !memref_rmem_bf16_10
        %append_9393 = cute.append_to_rank<2> (%lay_9391, %2679) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9394 = cute.append_to_rank<2> (%lay_9392, %2679) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9395 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9396 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9397 = cute.size(%lay_9395) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2680 = cute.get_scalars(%sz_9397) : !cute.int_tuple<"4">
        %c0_i32_9398 = arith.constant 0 : i32
        %c1_i32_9399 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9398 to %2680 step %c1_i32_9399  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9395, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9395) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_9389, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9396, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9396) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9390, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9400 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9401 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9402 = cute.crd2idx(%coord_9400, %lay_9401) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
        %iter_9403 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9404 = cute.add_offset(%iter_9403, %idx_9402) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9405 = cute.make_view(%ptr_9404) : !memref_rmem_bf16_12
        %iter_9406 = cute.get_iter(%view_9405) : !memref_rmem_bf16_12
        %iter_9407 = cute.get_iter(%view_9405) : !memref_rmem_bf16_12
        %coord_9408 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9409 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9410 = cute.crd2idx(%coord_9408, %lay_9409) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
        %iter_9411 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9412 = cute.add_offset(%iter_9411, %idx_9410) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9413 = cute.make_view(%ptr_9412) : !memref_rmem_bf16_13
        %iter_9414 = cute.get_iter(%view_9413) : !memref_rmem_bf16_13
        %iter_9415 = cute.get_iter(%view_9413) : !memref_rmem_bf16_13
        %lay_9416 = cute.get_layout(%view_9405) : !memref_rmem_bf16_12
        %2681 = cute.get_shape(%lay_9416) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9417, %e1_9418, %e2_9419, %e3_9420 = cute.get_leaves(%2681) : !cute.shape<"((2,2,2),2)">
        %lay_9421 = cute.get_layout(%view_9413) : !memref_rmem_bf16_13
        %2682 = cute.get_shape(%lay_9421) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9422, %e1_9423, %e2_9424 = cute.get_leaves(%2682) : !cute.shape<"((2,2),8)">
        %iter_9425 = cute.get_iter(%view_9405) : !memref_rmem_bf16_12
        %iter_9426 = cute.get_iter(%view_9413) : !memref_rmem_bf16_13
        %iter_9427 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_9428 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_9429 = cute.get_layout(%view_9405) : !memref_rmem_bf16_12
        %lay_9430 = cute.get_layout(%view_9413) : !memref_rmem_bf16_13
        %lay_9431 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_9432 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2683 = cute.static : !cute.layout<"1:0">
        %append_9433 = cute.append_to_rank<3> (%lay_9429, %2683) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9434 = cute.append_to_rank<3> (%lay_9430, %2683) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9435 = cute.size(%append_9433) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9436 = cute.size(%append_9433) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9437 = cute.size(%append_9434) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2684 = cute.get_scalars(%sz_9435) : !cute.int_tuple<"1">
        %2685 = cute.get_scalars(%sz_9436) : !cute.int_tuple<"2">
        %2686 = cute.get_scalars(%sz_9437) : !cute.int_tuple<"8">
        %c0_i32_9438 = arith.constant 0 : i32
        %c1_i32_9439 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9438 to %2684 step %c1_i32_9439  : i32 {
          scf.for %arg14 = %c0_i32_9438 to %2685 step %c1_i32_9439  : i32 {
            scf.for %arg15 = %c0_i32_9438 to %2686 step %c1_i32_9439  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_9433, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_9433) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_9425, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_9434, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_9434) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_9426, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_9431, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_9431) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_9427, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_9432, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_9432) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_9428, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9440 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9441 = cute.size(%int_tuple_9440) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9442 = cute.get_leaves(%sz_9441) : !cute.int_tuple<"8">
        %coord_9443 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9444 = cute.get_layout(%src_partitioned_377) : !memref_smem_bf16_8
        %idx_9445 = cute.crd2idx(%coord_9443, %lay_9444) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_9446 = cute.get_iter(%src_partitioned_377) : !memref_smem_bf16_8
        %ptr_9447 = cute.add_offset(%iter_9446, %idx_9445) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9448 = cute.make_view(%ptr_9447) : !memref_smem_bf16_14
        %iter_9449 = cute.get_iter(%view_9448) : !memref_smem_bf16_14
        %iter_9450 = cute.get_iter(%view_9448) : !memref_smem_bf16_14
        %coord_9451 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9452 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_9453 = cute.crd2idx(%coord_9451, %lay_9452) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_9454 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_9455 = cute.add_offset(%iter_9454, %idx_9453) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9456 = cute.make_view(%ptr_9455) : !memref_rmem_bf16_6
        %iter_9457 = cute.get_iter(%view_9456) : !memref_rmem_bf16_6
        %iter_9458 = cute.get_iter(%view_9456) : !memref_rmem_bf16_6
        %lay_9459 = cute.get_layout(%view_9448) : !memref_smem_bf16_14
        %2687 = cute.get_shape(%lay_9459) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9460, %e1_9461, %e2_9462 = cute.get_leaves(%2687) : !cute.shape<"((8,1),2)">
        %lay_9463 = cute.get_layout(%view_9456) : !memref_rmem_bf16_6
        %2688 = cute.get_shape(%lay_9463) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9464, %e1_9465, %e2_9466 = cute.get_leaves(%2688) : !cute.shape<"((8,1),2)">
        %lay_9467 = cute.get_layout(%view_9448) : !memref_smem_bf16_14
        %shape_9468 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9469 = cute.make_layout() : !cute.layout<"1:0">
        %append_9470 = cute.append_to_rank<2> (%lay_9467, %lay_9469) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9471 = cute.make_view(%iter_9450, %append_9470) : !memref_smem_bf16_14
        %iter_9472 = cute.get_iter(%view_9471) : !memref_smem_bf16_14
        %lay_9473 = cute.get_layout(%view_9471) : !memref_smem_bf16_14
        %2689 = cute.get_shape(%lay_9473) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9474, %e1_9475, %e2_9476 = cute.get_leaves(%2689) : !cute.shape<"((8,1),2)">
        %iter_9477 = cute.get_iter(%view_9471) : !memref_smem_bf16_14
        %view_9478 = cute.make_view(%iter_9477) : !memref_smem_bf16_15
        %iter_9479 = cute.get_iter(%view_9478) : !memref_smem_bf16_15
        %iter_9480 = cute.get_iter(%view_9478) : !memref_smem_bf16_15
        %lay_9481 = cute.get_layout(%view_9456) : !memref_rmem_bf16_6
        %shape_9482 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9483 = cute.make_layout() : !cute.layout<"1:0">
        %append_9484 = cute.append_to_rank<2> (%lay_9481, %lay_9483) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9485 = cute.make_view(%iter_9458, %append_9484) : !memref_rmem_bf16_6
        %iter_9486 = cute.get_iter(%view_9485) : !memref_rmem_bf16_6
        %lay_9487 = cute.get_layout(%view_9485) : !memref_rmem_bf16_6
        %2690 = cute.get_shape(%lay_9487) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9488, %e1_9489, %e2_9490 = cute.get_leaves(%2690) : !cute.shape<"((8,1),2)">
        %iter_9491 = cute.get_iter(%view_9485) : !memref_rmem_bf16_6
        %view_9492 = cute.make_view(%iter_9491) : !memref_rmem_bf16_7
        %iter_9493 = cute.get_iter(%view_9492) : !memref_rmem_bf16_7
        %iter_9494 = cute.get_iter(%view_9492) : !memref_rmem_bf16_7
        %lay_9495 = cute.get_layout(%view_9478) : !memref_smem_bf16_15
        %2691 = cute.get_shape(%lay_9495) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9496, %e1_9497, %e2_9498 = cute.get_leaves(%2691) : !cute.shape<"((8,1),(2))">
        %lay_9499 = cute.get_layout(%view_9492) : !memref_rmem_bf16_7
        %2692 = cute.get_shape(%lay_9499) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9500, %e1_9501, %e2_9502 = cute.get_leaves(%2692) : !cute.shape<"((8,1),(2))">
        %lay_9503 = cute.get_layout(%view_9478) : !memref_smem_bf16_15
        %sz_9504 = cute.size(%lay_9503) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9505 = cute.get_leaves(%sz_9504) : !cute.int_tuple<"2">
        %lay_9506 = cute.get_layout(%view_9492) : !memref_rmem_bf16_7
        %sz_9507 = cute.size(%lay_9506) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9508 = cute.get_leaves(%sz_9507) : !cute.int_tuple<"2">
        %2693 = cute.static : !cute.layout<"1:0">
        %iter_9509 = cute.get_iter(%view_9478) : !memref_smem_bf16_15
        %iter_9510 = cute.get_iter(%view_9492) : !memref_rmem_bf16_7
        %lay_9511 = cute.get_layout(%view_9478) : !memref_smem_bf16_15
        %lay_9512 = cute.get_layout(%view_9492) : !memref_rmem_bf16_7
        %append_9513 = cute.append_to_rank<2> (%lay_9511, %2693) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9514 = cute.append_to_rank<2> (%lay_9512, %2693) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9515 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9516 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9517 = cute.size(%lay_9515) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2694 = cute.get_scalars(%sz_9517) : !cute.int_tuple<"2">
        %c0_i32_9518 = arith.constant 0 : i32
        %c1_i32_9519 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9518 to %2694 step %c1_i32_9519  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9515, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9515) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10768 = cute.add_offset(%iter_9509, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9516, %coord_10765) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9516) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9510, %idx_10771) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10769, %view_10773) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9520 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9521 = cute.get_layout(%src_partitioned_381) : !memref_smem_bf16_9
        %idx_9522 = cute.crd2idx(%coord_9520, %lay_9521) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_9523 = cute.get_iter(%src_partitioned_381) : !memref_smem_bf16_9
        %ptr_9524 = cute.add_offset(%iter_9523, %idx_9522) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9525 = cute.make_view(%ptr_9524) : !memref_smem_bf16_17
        %iter_9526 = cute.get_iter(%view_9525) : !memref_smem_bf16_17
        %iter_9527 = cute.get_iter(%view_9525) : !memref_smem_bf16_17
        %coord_9528 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9529 = cute.get_layout(%retiled_383) : !memref_rmem_bf16_4
        %idx_9530 = cute.crd2idx(%coord_9528, %lay_9529) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_9531 = cute.get_iter(%retiled_383) : !memref_rmem_bf16_4
        %ptr_9532 = cute.add_offset(%iter_9531, %idx_9530) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9533 = cute.make_view(%ptr_9532) : !memref_rmem_bf16_9
        %iter_9534 = cute.get_iter(%view_9533) : !memref_rmem_bf16_9
        %iter_9535 = cute.get_iter(%view_9533) : !memref_rmem_bf16_9
        %lay_9536 = cute.get_layout(%view_9525) : !memref_smem_bf16_17
        %2695 = cute.get_shape(%lay_9536) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9537, %e1_9538, %e2_9539 = cute.get_leaves(%2695) : !cute.shape<"((8,1),4)">
        %lay_9540 = cute.get_layout(%view_9533) : !memref_rmem_bf16_9
        %2696 = cute.get_shape(%lay_9540) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9541, %e1_9542, %e2_9543 = cute.get_leaves(%2696) : !cute.shape<"((8,1),4)">
        %lay_9544 = cute.get_layout(%view_9525) : !memref_smem_bf16_17
        %shape_9545 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9546 = cute.make_layout() : !cute.layout<"1:0">
        %append_9547 = cute.append_to_rank<2> (%lay_9544, %lay_9546) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9548 = cute.make_view(%iter_9527, %append_9547) : !memref_smem_bf16_17
        %iter_9549 = cute.get_iter(%view_9548) : !memref_smem_bf16_17
        %lay_9550 = cute.get_layout(%view_9548) : !memref_smem_bf16_17
        %2697 = cute.get_shape(%lay_9550) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9551, %e1_9552, %e2_9553 = cute.get_leaves(%2697) : !cute.shape<"((8,1),4)">
        %iter_9554 = cute.get_iter(%view_9548) : !memref_smem_bf16_17
        %view_9555 = cute.make_view(%iter_9554) : !memref_smem_bf16_18
        %iter_9556 = cute.get_iter(%view_9555) : !memref_smem_bf16_18
        %iter_9557 = cute.get_iter(%view_9555) : !memref_smem_bf16_18
        %lay_9558 = cute.get_layout(%view_9533) : !memref_rmem_bf16_9
        %shape_9559 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9560 = cute.make_layout() : !cute.layout<"1:0">
        %append_9561 = cute.append_to_rank<2> (%lay_9558, %lay_9560) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9562 = cute.make_view(%iter_9535, %append_9561) : !memref_rmem_bf16_9
        %iter_9563 = cute.get_iter(%view_9562) : !memref_rmem_bf16_9
        %lay_9564 = cute.get_layout(%view_9562) : !memref_rmem_bf16_9
        %2698 = cute.get_shape(%lay_9564) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9565, %e1_9566, %e2_9567 = cute.get_leaves(%2698) : !cute.shape<"((8,1),4)">
        %iter_9568 = cute.get_iter(%view_9562) : !memref_rmem_bf16_9
        %view_9569 = cute.make_view(%iter_9568) : !memref_rmem_bf16_10
        %iter_9570 = cute.get_iter(%view_9569) : !memref_rmem_bf16_10
        %iter_9571 = cute.get_iter(%view_9569) : !memref_rmem_bf16_10
        %lay_9572 = cute.get_layout(%view_9555) : !memref_smem_bf16_18
        %2699 = cute.get_shape(%lay_9572) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9573, %e1_9574, %e2_9575 = cute.get_leaves(%2699) : !cute.shape<"((8,1),(4))">
        %lay_9576 = cute.get_layout(%view_9569) : !memref_rmem_bf16_10
        %2700 = cute.get_shape(%lay_9576) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9577, %e1_9578, %e2_9579 = cute.get_leaves(%2700) : !cute.shape<"((8,1),(4))">
        %lay_9580 = cute.get_layout(%view_9555) : !memref_smem_bf16_18
        %sz_9581 = cute.size(%lay_9580) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9582 = cute.get_leaves(%sz_9581) : !cute.int_tuple<"4">
        %lay_9583 = cute.get_layout(%view_9569) : !memref_rmem_bf16_10
        %sz_9584 = cute.size(%lay_9583) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9585 = cute.get_leaves(%sz_9584) : !cute.int_tuple<"4">
        %2701 = cute.static : !cute.layout<"1:0">
        %iter_9586 = cute.get_iter(%view_9555) : !memref_smem_bf16_18
        %iter_9587 = cute.get_iter(%view_9569) : !memref_rmem_bf16_10
        %lay_9588 = cute.get_layout(%view_9555) : !memref_smem_bf16_18
        %lay_9589 = cute.get_layout(%view_9569) : !memref_rmem_bf16_10
        %append_9590 = cute.append_to_rank<2> (%lay_9588, %2701) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9591 = cute.append_to_rank<2> (%lay_9589, %2701) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9592 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9593 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9594 = cute.size(%lay_9592) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2702 = cute.get_scalars(%sz_9594) : !cute.int_tuple<"4">
        %c0_i32_9595 = arith.constant 0 : i32
        %c1_i32_9596 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9595 to %2702 step %c1_i32_9596  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9592, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9592) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10768 = cute.add_offset(%iter_9586, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_9593, %coord_10765) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9593) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_9587, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10769, %view_10773) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9597 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9598 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9599 = cute.crd2idx(%coord_9597, %lay_9598) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
        %iter_9600 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9601 = cute.add_offset(%iter_9600, %idx_9599) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9602 = cute.make_view(%ptr_9601) : !memref_rmem_bf16_12
        %iter_9603 = cute.get_iter(%view_9602) : !memref_rmem_bf16_12
        %iter_9604 = cute.get_iter(%view_9602) : !memref_rmem_bf16_12
        %coord_9605 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9606 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9607 = cute.crd2idx(%coord_9605, %lay_9606) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
        %iter_9608 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9609 = cute.add_offset(%iter_9608, %idx_9607) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9610 = cute.make_view(%ptr_9609) : !memref_rmem_bf16_13
        %iter_9611 = cute.get_iter(%view_9610) : !memref_rmem_bf16_13
        %iter_9612 = cute.get_iter(%view_9610) : !memref_rmem_bf16_13
        %lay_9613 = cute.get_layout(%view_9602) : !memref_rmem_bf16_12
        %2703 = cute.get_shape(%lay_9613) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9614, %e1_9615, %e2_9616, %e3_9617 = cute.get_leaves(%2703) : !cute.shape<"((2,2,2),2)">
        %lay_9618 = cute.get_layout(%view_9610) : !memref_rmem_bf16_13
        %2704 = cute.get_shape(%lay_9618) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9619, %e1_9620, %e2_9621 = cute.get_leaves(%2704) : !cute.shape<"((2,2),8)">
        %iter_9622 = cute.get_iter(%view_9602) : !memref_rmem_bf16_12
        %iter_9623 = cute.get_iter(%view_9610) : !memref_rmem_bf16_13
        %iter_9624 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %iter_9625 = cute.get_iter(%rmem_7873) : !memref_rmem_f32_2
        %lay_9626 = cute.get_layout(%view_9602) : !memref_rmem_bf16_12
        %lay_9627 = cute.get_layout(%view_9610) : !memref_rmem_bf16_13
        %lay_9628 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_9629 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2705 = cute.static : !cute.layout<"1:0">
        %append_9630 = cute.append_to_rank<3> (%lay_9626, %2705) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9631 = cute.append_to_rank<3> (%lay_9627, %2705) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9632 = cute.size(%append_9630) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9633 = cute.size(%append_9630) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9634 = cute.size(%append_9631) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2706 = cute.get_scalars(%sz_9632) : !cute.int_tuple<"1">
        %2707 = cute.get_scalars(%sz_9633) : !cute.int_tuple<"2">
        %2708 = cute.get_scalars(%sz_9634) : !cute.int_tuple<"8">
        %c0_i32_9635 = arith.constant 0 : i32
        %c1_i32_9636 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9635 to %2706 step %c1_i32_9636  : i32 {
          scf.for %arg14 = %c0_i32_9635 to %2707 step %c1_i32_9636  : i32 {
            scf.for %arg15 = %c0_i32_9635 to %2708 step %c1_i32_9636  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_9630, %coord_10765) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_9630) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10770 = cute.add_offset(%iter_9622, %idx_10769) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_14
              %slice_10772 = cute.slice(%append_9631, %coord_10766) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_9631) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_9623, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_9628, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_9628) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_9624, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_9629, %coord_10767) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_9629) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_9625, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_9637 = arith.constant 1 : i32
        %c128_i32_9638 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_9637 number_of_threads = %c128_i32_9638
        %c0_i32_9639 = arith.constant 0 : i32
        %2709 = arith.cmpi sgt, %2512, %c0_i32_9639 : i32
        scf.if %2709 {
          %c1_i32_10765 = arith.constant 1 : i32
          %2937 = arith.subi %2512, %c1_i32_10765 : i32
          %coord_10766 = cute.make_coord(%2937) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_10767 = cute.get_layout(%src_partitioned_292) : !memref_gmem_bf16_5
          %slice_10768 = cute.slice(%lay_10767, %coord_10766) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_10769 = cute.crd2idx(%coord_10766, %lay_10767) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_10770 = cute.get_iter(%src_partitioned_292) : !memref_gmem_bf16_5
          %ptr_10771 = cute.add_offset(%iter_10770, %idx_10769) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_10772 = cute.make_view(%ptr_10771, %slice_10768) : !memref_gmem_bf16_9
          %iter_10773 = cute.get_iter(%view_10772) : !memref_gmem_bf16_9
          %iter_10774 = cute.get_iter(%view_10772) : !memref_gmem_bf16_9
          %lay_10775 = cute.get_layout(%view_10772) : !memref_gmem_bf16_9
          %2938 = cute.get_shape(%lay_10775) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10776, %e1_10777, %e2_10778, %e3_10779 = cute.get_leaves(%2938) : !cute.shape<"((8,1),4,2)">
          %lay_10780 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
          %2939 = cute.get_shape(%lay_10780) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10781, %e1_10782, %e2_10783, %e3_10784 = cute.get_leaves(%2939) : !cute.shape<"((8,1),4,2)">
          %lay_10785 = cute.get_layout(%view_10772) : !memref_gmem_bf16_9
          %shape_10786 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10787 = cute.make_layout() : !cute.layout<"1:0">
          %append_10788 = cute.append_to_rank<2> (%lay_10785, %lay_10787) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_10789 = cute.make_view(%iter_10774, %append_10788) : !memref_gmem_bf16_9
          %iter_10790 = cute.get_iter(%view_10789) : !memref_gmem_bf16_9
          %lay_10791 = cute.get_layout(%view_10789) : !memref_gmem_bf16_9
          %2940 = cute.get_shape(%lay_10791) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10792, %e1_10793, %e2_10794, %e3_10795 = cute.get_leaves(%2940) : !cute.shape<"((8,1),4,2)">
          %iter_10796 = cute.get_iter(%view_10789) : !memref_gmem_bf16_9
          %lay_10797 = cute.get_layout(%view_10789) : !memref_gmem_bf16_9
          %2941 = cute.get_scalars(%lay_10797) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_10798 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_10799 = cute.assume(%2941) : (i64) -> !cute.i64<divby 128>
          %stride_10800 = cute.make_stride(%iv_10799) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_10801 = cute.make_layout(%shape_10798, %stride_10800) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_10802 = cute.make_view(%iter_10796, %lay_10801) : !memref_gmem_bf16_10
          %iter_10803 = cute.get_iter(%view_10802) : !memref_gmem_bf16_10
          %iter_10804 = cute.get_iter(%view_10802) : !memref_gmem_bf16_10
          %lay_10805 = cute.get_layout(%dst_partitioned_295) : !memref_smem_bf16_4
          %shape_10806 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10807 = cute.make_layout() : !cute.layout<"1:0">
          %append_10808 = cute.append_to_rank<2> (%lay_10805, %lay_10807) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_10809 = cute.make_view(%iter_296, %append_10808) : !memref_smem_bf16_4
          %iter_10810 = cute.get_iter(%view_10809) : !memref_smem_bf16_4
          %lay_10811 = cute.get_layout(%view_10809) : !memref_smem_bf16_4
          %2942 = cute.get_shape(%lay_10811) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10812, %e1_10813, %e2_10814, %e3_10815 = cute.get_leaves(%2942) : !cute.shape<"((8,1),4,2)">
          %iter_10816 = cute.get_iter(%view_10809) : !memref_smem_bf16_4
          %view_10817 = cute.make_view(%iter_10816) : !memref_smem_bf16_16
          %iter_10818 = cute.get_iter(%view_10817) : !memref_smem_bf16_16
          %iter_10819 = cute.get_iter(%view_10817) : !memref_smem_bf16_16
          %lay_10820 = cute.get_layout(%rmem_540) : !memref_rmem_i8_1
          %shape_10821 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10822 = cute.make_layout() : !cute.layout<"1:0">
          %append_10823 = cute.append_to_rank<2> (%lay_10820, %lay_10822) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_10824 = cute.make_view(%iter_542, %append_10823) : !memref_rmem_i8_1
          %iter_10825 = cute.get_iter(%view_10824) : !memref_rmem_i8_1
          %lay_10826 = cute.get_layout(%view_10824) : !memref_rmem_i8_1
          %2943 = cute.get_shape(%lay_10826) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_10827, %e1_10828, %e2_10829 = cute.get_leaves(%2943) : !cute.shape<"(1,4,2)">
          %iter_10830 = cute.get_iter(%view_10824) : !memref_rmem_i8_1
          %view_10831 = cute.make_view(%iter_10830) : !memref_rmem_i8_5
          %iter_10832 = cute.get_iter(%view_10831) : !memref_rmem_i8_5
          %iter_10833 = cute.get_iter(%view_10831) : !memref_rmem_i8_5
          %lay_10834 = cute.get_layout(%view_10802) : !memref_gmem_bf16_10
          %2944 = cute.get_shape(%lay_10834) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10835, %e1_10836, %e2_10837, %e3_10838 = cute.get_leaves(%2944) : !cute.shape<"((8,1),(4,2))">
          %lay_10839 = cute.get_layout(%view_10817) : !memref_smem_bf16_16
          %2945 = cute.get_shape(%lay_10839) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10840, %e1_10841, %e2_10842, %e3_10843 = cute.get_leaves(%2945) : !cute.shape<"((8,1),(4,2))">
          %lay_10844 = cute.get_layout(%view_10802) : !memref_gmem_bf16_10
          %sz_10845 = cute.size(%lay_10844) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_10846 = cute.get_leaves(%sz_10845) : !cute.int_tuple<"8">
          %lay_10847 = cute.get_layout(%view_10817) : !memref_smem_bf16_16
          %sz_10848 = cute.size(%lay_10847) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_10849 = cute.get_leaves(%sz_10848) : !cute.int_tuple<"8">
          %2946 = cute.static : !cute.layout<"1:0">
          %iter_10850 = cute.get_iter(%view_10802) : !memref_gmem_bf16_10
          %iter_10851 = cute.get_iter(%view_10817) : !memref_smem_bf16_16
          %lay_10852 = cute.get_layout(%view_10802) : !memref_gmem_bf16_10
          %lay_10853 = cute.get_layout(%view_10817) : !memref_smem_bf16_16
          %append_10854 = cute.append_to_rank<2> (%lay_10852, %2946) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_10855 = cute.append_to_rank<2> (%lay_10853, %2946) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %2947 = cute.get_scalars(%append_10854) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_10856 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_10857 = cute.assume(%2947) : (i64) -> !cute.i64<divby 128>
          %stride_10858 = cute.make_stride(%iv_10857) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_10859 = cute.make_layout(%shape_10856, %stride_10858) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_10860 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_10861 = cute.get_iter(%view_10831) : !memref_rmem_i8_5
          %lay_10862 = cute.get_layout(%view_10831) : !memref_rmem_i8_5
          %append_10863 = cute.append_to_rank<2> (%lay_10862, %2946) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_10864 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_10865 = cute.size(%lay_10859) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %2948 = cute.get_scalars(%sz_10865) : !cute.int_tuple<"8">
          %c0_i32_10866 = arith.constant 0 : i32
          %c1_i32_10867 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_10866 to %2948 step %c1_i32_10867  : i32 {
            %coord_10868 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %slice_10869 = cute.slice(%lay_10859, %coord_10868) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_10870 = cute.crd2idx(%coord_10868, %lay_10859) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_10871 = cute.add_offset(%iter_10850, %idx_10870) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10872 = cute.make_view(%ptr_10871, %slice_10869) : !memref_gmem_bf16_8
            %slice_10873 = cute.slice(%lay_10860, %coord_10868) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_10874 = cute.crd2idx(%coord_10868, %lay_10860) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_10875 = cute.add_offset(%iter_10851, %idx_10874) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10876 = cute.make_view(%ptr_10875, %slice_10873) : !memref_smem_bf16_13
            %slice_10877 = cute.slice(%lay_10864, %coord_10868) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_10878 = cute.crd2idx(%coord_10868, %lay_10864) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_10879 = cute.add_offset(%iter_10861, %idx_10878) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_10880 = cute.make_view(%ptr_10879, %slice_10877) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_10872, %view_10876, %view_10880) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          nvvm.cp.async.commit.group
        }
        %lay_9640 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2710 = cute.get_shape(%lay_9640) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9641, %e1_9642, %e2_9643, %e3_9644 = cute.get_leaves(%2710) : !cute.shape<"((2,2),2,8)">
        %shape_9645 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_9646 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %2711 = cute.get_shape(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9647, %e1_9648, %e2_9649, %e3_9650 = cute.get_leaves(%2711) : !cute.shape<"((2,2),2,8)">
        %2712 = cute.get_shape(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9651, %e1_9652, %e2_9653, %e3_9654 = cute.get_leaves(%2712) : !cute.shape<"((2,2),2,8)">
        %2713 = cute.get_shape(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9655, %e1_9656, %e2_9657, %e3_9658 = cute.get_leaves(%2713) : !cute.shape<"((2,2),2,8)">
        %2714 = cute.get_shape(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9659, %e1_9660, %e2_9661, %e3_9662 = cute.get_leaves(%2714) : !cute.shape<"((2,2),2,8)">
        %2715 = cute.get_stride(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9663, %e1_9664, %e2_9665, %e3_9666 = cute.get_leaves(%2715) : !cute.stride<"((1,2),4,8)">
        %2716 = cute.get_stride(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9667, %e1_9668, %e2_9669, %e3_9670 = cute.get_leaves(%2716) : !cute.stride<"((1,2),4,8)">
        %2717 = cute.get_stride(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9671, %e1_9672, %e2_9673, %e3_9674 = cute.get_leaves(%2717) : !cute.stride<"((1,2),4,8)">
        %2718 = cute.get_stride(%lay_9646) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9675, %e1_9676, %e2_9677, %e3_9678 = cute.get_leaves(%2718) : !cute.stride<"((1,2),4,8)">
        %shape_9679 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
        %stride_9680 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_9681 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %lay_9682 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %lay_9683 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %view_9684 = cute.make_view(%iter_7875, %lay_9683) : !memref_rmem_f32_4
        %iter_9685 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %lay_9686 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2719 = cute.get_shape(%lay_9686) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9687, %e1_9688, %e2_9689, %e3_9690 = cute.get_leaves(%2719) : !cute.shape<"((2,2),2,16)">
        %shape_9691 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
        %lay_9692 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
        %2720 = cute.get_shape(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9693, %e1_9694, %e2_9695, %e3_9696 = cute.get_leaves(%2720) : !cute.shape<"((2,2),2,16)">
        %2721 = cute.get_shape(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9697, %e1_9698, %e2_9699, %e3_9700 = cute.get_leaves(%2721) : !cute.shape<"((2,2),2,16)">
        %2722 = cute.get_shape(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9701, %e1_9702, %e2_9703, %e3_9704 = cute.get_leaves(%2722) : !cute.shape<"((2,2),2,16)">
        %2723 = cute.get_shape(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9705, %e1_9706, %e2_9707, %e3_9708 = cute.get_leaves(%2723) : !cute.shape<"((2,2),2,16)">
        %2724 = cute.get_stride(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9709, %e1_9710, %e2_9711, %e3_9712 = cute.get_leaves(%2724) : !cute.stride<"((1,2),4,8)">
        %2725 = cute.get_stride(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9713, %e1_9714, %e2_9715, %e3_9716 = cute.get_leaves(%2725) : !cute.stride<"((1,2),4,8)">
        %2726 = cute.get_stride(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9717, %e1_9718, %e2_9719, %e3_9720 = cute.get_leaves(%2726) : !cute.stride<"((1,2),4,8)">
        %2727 = cute.get_stride(%lay_9692) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9721, %e1_9722, %e2_9723, %e3_9724 = cute.get_leaves(%2727) : !cute.stride<"((1,2),4,8)">
        %shape_9725 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
        %stride_9726 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_9727 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %lay_9728 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_9729 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %view_9730 = cute.make_view(%iter_322, %lay_9729) : !memref_rmem_f32_5
        %iter_9731 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %lay_9732 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
        %2728 = cute.make_layout_like(%lay_9732) : !cute.layout<"4:1"> to !cute.layout<"4:1">
        %rmem_9733 = cute.memref.alloca(%2728) : !memref_rmem_f32_1
        %iter_9734 = cute.get_iter(%rmem_9733) : !memref_rmem_f32_1
        %iter_9735 = cute.get_iter(%rmem_9733) : !memref_rmem_f32_1
        %lay_9736 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
        %2729 = cute.get_shape(%lay_9736) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_9737 = cute.get_leaves(%2729) : !cute.shape<"4">
        %lay_9738 = cute.get_layout(%rmem_9733) : !memref_rmem_f32_1
        %2730 = cute.get_shape(%lay_9738) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_9739 = cute.get_leaves(%2730) : !cute.shape<"4">
        %atom_9740 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b>
        %2731 = cute.static : !cute.layout<"1:0">
        %iter_9741 = cute.get_iter(%rmem_1075) : !memref_rmem_f32_1
        %iter_9742 = cute.get_iter(%rmem_9733) : !memref_rmem_f32_1
        %lay_9743 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
        %lay_9744 = cute.get_layout(%rmem_9733) : !memref_rmem_f32_1
        %append_9745 = cute.append_to_rank<2> (%lay_9743, %2731) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %append_9746 = cute.append_to_rank<2> (%lay_9744, %2731) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %lay_9747 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %lay_9748 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %sz_9749 = cute.size(%lay_9747) <{mode = [1]}> : (!cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"1">
        %2732 = cute.get_scalars(%sz_9749) : !cute.int_tuple<"1">
        %c0_i32_9750 = arith.constant 0 : i32
        %c1_i32_9751 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9750 to %2732 step %c1_i32_9751  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_9747, %coord_10765) : !cute.layout<"(4,(1)):(1,(0))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_9747) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_10768 = cute.add_offset(%iter_9741, %idx_10767) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_rmem_f32_9
          %slice_10770 = cute.slice(%lay_9748, %coord_10765) : !cute.layout<"(4,(1)):(1,(0))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_9748) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_10772 = cute.add_offset(%iter_9742, %idx_10771) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_f32_9
          cute.copy_atom_call(%atom_9740, %view_10769, %view_10773) : (!cute_nvgpu.atom.universal_copy<f32, 32 b>, !memref_rmem_f32_9, !memref_rmem_f32_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_9752 = cute.get_layout(%rmem_1075) : !memref_rmem_f32_1
        %sz_9753 = cute.size(%lay_9752) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
        %e0_9754 = cute.get_leaves(%sz_9753) : !cute.int_tuple<"4">
        %coord_9755 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9756 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9757 = cute.crd2idx(%coord_9755, %lay_9756) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9758 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9759 = cute.add_offset(%iter_9758, %idx_9757) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9760 = cute.make_view(%ptr_9759) : !memref_rmem_f32_6
        %iter_9761 = cute.get_iter(%view_9760) : !memref_rmem_f32_6
        %iter_9762 = cute.get_iter(%view_9760) : !memref_rmem_f32_6
        %lay_9763 = cute.get_layout(%view_9760) : !memref_rmem_f32_6
        %2733 = cute.get_shape(%lay_9763) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9764, %e1_9765 = cute.get_leaves(%2733) : !cute.shape<"((2,8))">
        %2734 = cute.memref.load_vec %view_9760 : !memref_rmem_f32_6
        %cst_9766 = arith.constant 0xFF800000 : f32
        %2735 = vector.reduction <maximumf>, %2734, %cst_9766 : vector<16xf32> into f32
        %c-1_i32_9767 = arith.constant -1 : i32
        %c2_i32_9768 = arith.constant 2 : i32
        %c31_i32_9769 = arith.constant 31 : i32
        %2736 = nvvm.shfl.sync  bfly %c-1_i32_9767, %2735, %c2_i32_9768, %c31_i32_9769 : f32 -> f32
        %2737 = nvvm.fmax %2735, %2736
        %c-1_i32_9770 = arith.constant -1 : i32
        %c1_i32_9771 = arith.constant 1 : i32
        %c31_i32_9772 = arith.constant 31 : i32
        %2738 = nvvm.shfl.sync  bfly %c-1_i32_9770, %2737, %c1_i32_9771, %c31_i32_9772 : f32 -> f32
        %2739 = nvvm.fmax %2737, %2738
        %coord_9773 = cute.make_coord() : () -> !cute.coord<"0">
        %2740 = cute.memref.load(%rmem_9733, %coord_9773) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2741 = nvvm.fmax %2740, %2739
        %2742 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2743 = arith.mulf %2734, %2742 : vector<16xf32>
        %2744 = arith.mulf %2741, %arg4 : f32
        %2745 = vector.broadcast %2744 : f32 to vector<16xf32>
        %2746 = arith.subf %2743, %2745 : vector<16xf32>
        %2747 = math.exp2 %2746 fastmath<fast> : vector<16xf32>
        %cst_9774 = arith.constant 0.000000e+00 : f32
        %2748 = vector.reduction <add>, %2747, %cst_9774 : vector<16xf32> into f32
        %2749 = arith.mulf %2740, %arg4 : f32
        %2750 = arith.mulf %2741, %arg4 : f32
        %2751 = arith.subf %2749, %2750 : f32
        %2752 = math.exp2 %2751 fastmath<fast> : f32
        %coord_9775 = cute.make_coord() : () -> !cute.coord<"0">
        %2753 = cute.memref.load(%rmem_1080, %coord_9775) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2754 = arith.mulf %2753, %2752 : f32
        %2755 = arith.addf %2754, %2748 : f32
        %coord_9776 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9777 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9778 = cute.crd2idx(%coord_9776, %lay_9777) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9779 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9780 = cute.add_offset(%iter_9779, %idx_9778) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9781 = cute.make_view(%ptr_9780) : !memref_rmem_f32_10
        %iter_9782 = cute.get_iter(%view_9781) : !memref_rmem_f32_10
        %iter_9783 = cute.get_iter(%view_9781) : !memref_rmem_f32_10
        %lay_9784 = cute.get_layout(%view_9781) : !memref_rmem_f32_10
        %2756 = cute.get_shape(%lay_9784) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9785, %e1_9786 = cute.get_leaves(%2756) : !cute.shape<"((2,16))">
        %2757 = cute.memref.load_vec %view_9781 : !memref_rmem_f32_10
        %2758 = vector.broadcast %2752 : f32 to vector<32xf32>
        %2759 = arith.mulf %2757, %2758 : vector<32xf32>
        %coord_9787 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9788 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9789 = cute.crd2idx(%coord_9787, %lay_9788) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9790 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9791 = cute.add_offset(%iter_9790, %idx_9789) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9792 = cute.make_view(%ptr_9791) : !memref_rmem_f32_10
        %iter_9793 = cute.get_iter(%view_9792) : !memref_rmem_f32_10
        %iter_9794 = cute.get_iter(%view_9792) : !memref_rmem_f32_10
        %lay_9795 = cute.get_layout(%view_9792) : !memref_rmem_f32_10
        %2760 = cute.get_shape(%lay_9795) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9796, %e1_9797 = cute.get_leaves(%2760) : !cute.shape<"((2,16))">
        %int_tuple_9798 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9799 = cute.size(%int_tuple_9798) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9800 = cute.get_leaves(%sz_9799) : !cute.int_tuple<"32">
        %int_tuple_9801 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9802 = cute.size(%int_tuple_9801) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9803 = cute.get_leaves(%sz_9802) : !cute.int_tuple<"32">
        cute.memref.store_vec %2759, %view_9792 : !memref_rmem_f32_10
        %coord_9804 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1075, %coord_9804, %2741) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_9805 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1080, %coord_9805, %2755) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_9806 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9807 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9808 = cute.crd2idx(%coord_9806, %lay_9807) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9809 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9810 = cute.add_offset(%iter_9809, %idx_9808) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9811 = cute.make_view(%ptr_9810) : !memref_rmem_f32_6
        %iter_9812 = cute.get_iter(%view_9811) : !memref_rmem_f32_6
        %iter_9813 = cute.get_iter(%view_9811) : !memref_rmem_f32_6
        %lay_9814 = cute.get_layout(%view_9811) : !memref_rmem_f32_6
        %2761 = cute.get_shape(%lay_9814) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9815, %e1_9816 = cute.get_leaves(%2761) : !cute.shape<"((2,8))">
        %int_tuple_9817 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9818 = cute.size(%int_tuple_9817) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9819 = cute.get_leaves(%sz_9818) : !cute.int_tuple<"16">
        %int_tuple_9820 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9821 = cute.size(%int_tuple_9820) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9822 = cute.get_leaves(%sz_9821) : !cute.int_tuple<"16">
        cute.memref.store_vec %2747, %view_9811 : !memref_rmem_f32_6
        %coord_9823 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9824 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9825 = cute.crd2idx(%coord_9823, %lay_9824) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9826 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9827 = cute.add_offset(%iter_9826, %idx_9825) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9828 = cute.make_view(%ptr_9827) : !memref_rmem_f32_7
        %iter_9829 = cute.get_iter(%view_9828) : !memref_rmem_f32_7
        %iter_9830 = cute.get_iter(%view_9828) : !memref_rmem_f32_7
        %lay_9831 = cute.get_layout(%view_9828) : !memref_rmem_f32_7
        %2762 = cute.get_shape(%lay_9831) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9832, %e1_9833 = cute.get_leaves(%2762) : !cute.shape<"((2,8))">
        %2763 = cute.memref.load_vec %view_9828 : !memref_rmem_f32_7
        %cst_9834 = arith.constant 0xFF800000 : f32
        %2764 = vector.reduction <maximumf>, %2763, %cst_9834 : vector<16xf32> into f32
        %c-1_i32_9835 = arith.constant -1 : i32
        %c2_i32_9836 = arith.constant 2 : i32
        %c31_i32_9837 = arith.constant 31 : i32
        %2765 = nvvm.shfl.sync  bfly %c-1_i32_9835, %2764, %c2_i32_9836, %c31_i32_9837 : f32 -> f32
        %2766 = nvvm.fmax %2764, %2765
        %c-1_i32_9838 = arith.constant -1 : i32
        %c1_i32_9839 = arith.constant 1 : i32
        %c31_i32_9840 = arith.constant 31 : i32
        %2767 = nvvm.shfl.sync  bfly %c-1_i32_9838, %2766, %c1_i32_9839, %c31_i32_9840 : f32 -> f32
        %2768 = nvvm.fmax %2766, %2767
        %coord_9841 = cute.make_coord() : () -> !cute.coord<"1">
        %2769 = cute.memref.load(%rmem_9733, %coord_9841) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2770 = nvvm.fmax %2769, %2768
        %2771 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2772 = arith.mulf %2763, %2771 : vector<16xf32>
        %2773 = arith.mulf %2770, %arg4 : f32
        %2774 = vector.broadcast %2773 : f32 to vector<16xf32>
        %2775 = arith.subf %2772, %2774 : vector<16xf32>
        %2776 = math.exp2 %2775 fastmath<fast> : vector<16xf32>
        %cst_9842 = arith.constant 0.000000e+00 : f32
        %2777 = vector.reduction <add>, %2776, %cst_9842 : vector<16xf32> into f32
        %2778 = arith.mulf %2769, %arg4 : f32
        %2779 = arith.mulf %2770, %arg4 : f32
        %2780 = arith.subf %2778, %2779 : f32
        %2781 = math.exp2 %2780 fastmath<fast> : f32
        %coord_9843 = cute.make_coord() : () -> !cute.coord<"1">
        %2782 = cute.memref.load(%rmem_1080, %coord_9843) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2783 = arith.mulf %2782, %2781 : f32
        %2784 = arith.addf %2783, %2777 : f32
        %coord_9844 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9845 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9846 = cute.crd2idx(%coord_9844, %lay_9845) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9847 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9848 = cute.add_offset(%iter_9847, %idx_9846) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9849 = cute.make_view(%ptr_9848) : !memref_rmem_f32_11
        %iter_9850 = cute.get_iter(%view_9849) : !memref_rmem_f32_11
        %iter_9851 = cute.get_iter(%view_9849) : !memref_rmem_f32_11
        %lay_9852 = cute.get_layout(%view_9849) : !memref_rmem_f32_11
        %2785 = cute.get_shape(%lay_9852) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9853, %e1_9854 = cute.get_leaves(%2785) : !cute.shape<"((2,16))">
        %2786 = cute.memref.load_vec %view_9849 : !memref_rmem_f32_11
        %2787 = vector.broadcast %2781 : f32 to vector<32xf32>
        %2788 = arith.mulf %2786, %2787 : vector<32xf32>
        %coord_9855 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9856 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9857 = cute.crd2idx(%coord_9855, %lay_9856) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9858 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9859 = cute.add_offset(%iter_9858, %idx_9857) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9860 = cute.make_view(%ptr_9859) : !memref_rmem_f32_11
        %iter_9861 = cute.get_iter(%view_9860) : !memref_rmem_f32_11
        %iter_9862 = cute.get_iter(%view_9860) : !memref_rmem_f32_11
        %lay_9863 = cute.get_layout(%view_9860) : !memref_rmem_f32_11
        %2789 = cute.get_shape(%lay_9863) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9864, %e1_9865 = cute.get_leaves(%2789) : !cute.shape<"((2,16))">
        %int_tuple_9866 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9867 = cute.size(%int_tuple_9866) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9868 = cute.get_leaves(%sz_9867) : !cute.int_tuple<"32">
        %int_tuple_9869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9870 = cute.size(%int_tuple_9869) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9871 = cute.get_leaves(%sz_9870) : !cute.int_tuple<"32">
        cute.memref.store_vec %2788, %view_9860 : !memref_rmem_f32_11
        %coord_9872 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1075, %coord_9872, %2770) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_9873 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1080, %coord_9873, %2784) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_9874 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9875 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9876 = cute.crd2idx(%coord_9874, %lay_9875) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9877 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9878 = cute.add_offset(%iter_9877, %idx_9876) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9879 = cute.make_view(%ptr_9878) : !memref_rmem_f32_7
        %iter_9880 = cute.get_iter(%view_9879) : !memref_rmem_f32_7
        %iter_9881 = cute.get_iter(%view_9879) : !memref_rmem_f32_7
        %lay_9882 = cute.get_layout(%view_9879) : !memref_rmem_f32_7
        %2790 = cute.get_shape(%lay_9882) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9883, %e1_9884 = cute.get_leaves(%2790) : !cute.shape<"((2,8))">
        %int_tuple_9885 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9886 = cute.size(%int_tuple_9885) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9887 = cute.get_leaves(%sz_9886) : !cute.int_tuple<"16">
        %int_tuple_9888 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9889 = cute.size(%int_tuple_9888) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9890 = cute.get_leaves(%sz_9889) : !cute.int_tuple<"16">
        cute.memref.store_vec %2776, %view_9879 : !memref_rmem_f32_7
        %coord_9891 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9892 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9893 = cute.crd2idx(%coord_9891, %lay_9892) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9894 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9895 = cute.add_offset(%iter_9894, %idx_9893) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9896 = cute.make_view(%ptr_9895) : !memref_rmem_f32_8
        %iter_9897 = cute.get_iter(%view_9896) : !memref_rmem_f32_8
        %iter_9898 = cute.get_iter(%view_9896) : !memref_rmem_f32_8
        %lay_9899 = cute.get_layout(%view_9896) : !memref_rmem_f32_8
        %2791 = cute.get_shape(%lay_9899) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9900, %e1_9901 = cute.get_leaves(%2791) : !cute.shape<"((2,8))">
        %2792 = cute.memref.load_vec %view_9896 : !memref_rmem_f32_8
        %cst_9902 = arith.constant 0xFF800000 : f32
        %2793 = vector.reduction <maximumf>, %2792, %cst_9902 : vector<16xf32> into f32
        %c-1_i32_9903 = arith.constant -1 : i32
        %c2_i32_9904 = arith.constant 2 : i32
        %c31_i32_9905 = arith.constant 31 : i32
        %2794 = nvvm.shfl.sync  bfly %c-1_i32_9903, %2793, %c2_i32_9904, %c31_i32_9905 : f32 -> f32
        %2795 = nvvm.fmax %2793, %2794
        %c-1_i32_9906 = arith.constant -1 : i32
        %c1_i32_9907 = arith.constant 1 : i32
        %c31_i32_9908 = arith.constant 31 : i32
        %2796 = nvvm.shfl.sync  bfly %c-1_i32_9906, %2795, %c1_i32_9907, %c31_i32_9908 : f32 -> f32
        %2797 = nvvm.fmax %2795, %2796
        %coord_9909 = cute.make_coord() : () -> !cute.coord<"2">
        %2798 = cute.memref.load(%rmem_9733, %coord_9909) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2799 = nvvm.fmax %2798, %2797
        %2800 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2801 = arith.mulf %2792, %2800 : vector<16xf32>
        %2802 = arith.mulf %2799, %arg4 : f32
        %2803 = vector.broadcast %2802 : f32 to vector<16xf32>
        %2804 = arith.subf %2801, %2803 : vector<16xf32>
        %2805 = math.exp2 %2804 fastmath<fast> : vector<16xf32>
        %cst_9910 = arith.constant 0.000000e+00 : f32
        %2806 = vector.reduction <add>, %2805, %cst_9910 : vector<16xf32> into f32
        %2807 = arith.mulf %2798, %arg4 : f32
        %2808 = arith.mulf %2799, %arg4 : f32
        %2809 = arith.subf %2807, %2808 : f32
        %2810 = math.exp2 %2809 fastmath<fast> : f32
        %coord_9911 = cute.make_coord() : () -> !cute.coord<"2">
        %2811 = cute.memref.load(%rmem_1080, %coord_9911) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2812 = arith.mulf %2811, %2810 : f32
        %2813 = arith.addf %2812, %2806 : f32
        %coord_9912 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9913 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9914 = cute.crd2idx(%coord_9912, %lay_9913) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9915 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9916 = cute.add_offset(%iter_9915, %idx_9914) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9917 = cute.make_view(%ptr_9916) : !memref_rmem_f32_12
        %iter_9918 = cute.get_iter(%view_9917) : !memref_rmem_f32_12
        %iter_9919 = cute.get_iter(%view_9917) : !memref_rmem_f32_12
        %lay_9920 = cute.get_layout(%view_9917) : !memref_rmem_f32_12
        %2814 = cute.get_shape(%lay_9920) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9921, %e1_9922 = cute.get_leaves(%2814) : !cute.shape<"((2,16))">
        %2815 = cute.memref.load_vec %view_9917 : !memref_rmem_f32_12
        %2816 = vector.broadcast %2810 : f32 to vector<32xf32>
        %2817 = arith.mulf %2815, %2816 : vector<32xf32>
        %coord_9923 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9924 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9925 = cute.crd2idx(%coord_9923, %lay_9924) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9926 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9927 = cute.add_offset(%iter_9926, %idx_9925) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9928 = cute.make_view(%ptr_9927) : !memref_rmem_f32_12
        %iter_9929 = cute.get_iter(%view_9928) : !memref_rmem_f32_12
        %iter_9930 = cute.get_iter(%view_9928) : !memref_rmem_f32_12
        %lay_9931 = cute.get_layout(%view_9928) : !memref_rmem_f32_12
        %2818 = cute.get_shape(%lay_9931) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9932, %e1_9933 = cute.get_leaves(%2818) : !cute.shape<"((2,16))">
        %int_tuple_9934 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9935 = cute.size(%int_tuple_9934) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9936 = cute.get_leaves(%sz_9935) : !cute.int_tuple<"32">
        %int_tuple_9937 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9938 = cute.size(%int_tuple_9937) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9939 = cute.get_leaves(%sz_9938) : !cute.int_tuple<"32">
        cute.memref.store_vec %2817, %view_9928 : !memref_rmem_f32_12
        %coord_9940 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1075, %coord_9940, %2799) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_9941 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1080, %coord_9941, %2813) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_9942 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9943 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9944 = cute.crd2idx(%coord_9942, %lay_9943) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9945 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9946 = cute.add_offset(%iter_9945, %idx_9944) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9947 = cute.make_view(%ptr_9946) : !memref_rmem_f32_8
        %iter_9948 = cute.get_iter(%view_9947) : !memref_rmem_f32_8
        %iter_9949 = cute.get_iter(%view_9947) : !memref_rmem_f32_8
        %lay_9950 = cute.get_layout(%view_9947) : !memref_rmem_f32_8
        %2819 = cute.get_shape(%lay_9950) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9951, %e1_9952 = cute.get_leaves(%2819) : !cute.shape<"((2,8))">
        %int_tuple_9953 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9954 = cute.size(%int_tuple_9953) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9955 = cute.get_leaves(%sz_9954) : !cute.int_tuple<"16">
        %int_tuple_9956 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9957 = cute.size(%int_tuple_9956) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9958 = cute.get_leaves(%sz_9957) : !cute.int_tuple<"16">
        cute.memref.store_vec %2805, %view_9947 : !memref_rmem_f32_8
        %coord_9959 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9960 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_9961 = cute.crd2idx(%coord_9959, %lay_9960) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9962 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_9963 = cute.add_offset(%iter_9962, %idx_9961) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9964 = cute.make_view(%ptr_9963) : !memref_rmem_f32_7
        %iter_9965 = cute.get_iter(%view_9964) : !memref_rmem_f32_7
        %iter_9966 = cute.get_iter(%view_9964) : !memref_rmem_f32_7
        %lay_9967 = cute.get_layout(%view_9964) : !memref_rmem_f32_7
        %2820 = cute.get_shape(%lay_9967) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9968, %e1_9969 = cute.get_leaves(%2820) : !cute.shape<"((2,8))">
        %2821 = cute.memref.load_vec %view_9964 : !memref_rmem_f32_7
        %cst_9970 = arith.constant 0xFF800000 : f32
        %2822 = vector.reduction <maximumf>, %2821, %cst_9970 : vector<16xf32> into f32
        %c-1_i32_9971 = arith.constant -1 : i32
        %c2_i32_9972 = arith.constant 2 : i32
        %c31_i32_9973 = arith.constant 31 : i32
        %2823 = nvvm.shfl.sync  bfly %c-1_i32_9971, %2822, %c2_i32_9972, %c31_i32_9973 : f32 -> f32
        %2824 = nvvm.fmax %2822, %2823
        %c-1_i32_9974 = arith.constant -1 : i32
        %c1_i32_9975 = arith.constant 1 : i32
        %c31_i32_9976 = arith.constant 31 : i32
        %2825 = nvvm.shfl.sync  bfly %c-1_i32_9974, %2824, %c1_i32_9975, %c31_i32_9976 : f32 -> f32
        %2826 = nvvm.fmax %2824, %2825
        %coord_9977 = cute.make_coord() : () -> !cute.coord<"3">
        %2827 = cute.memref.load(%rmem_9733, %coord_9977) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2828 = nvvm.fmax %2827, %2826
        %2829 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2830 = arith.mulf %2821, %2829 : vector<16xf32>
        %2831 = arith.mulf %2828, %arg4 : f32
        %2832 = vector.broadcast %2831 : f32 to vector<16xf32>
        %2833 = arith.subf %2830, %2832 : vector<16xf32>
        %2834 = math.exp2 %2833 fastmath<fast> : vector<16xf32>
        %cst_9978 = arith.constant 0.000000e+00 : f32
        %2835 = vector.reduction <add>, %2834, %cst_9978 : vector<16xf32> into f32
        %2836 = arith.mulf %2827, %arg4 : f32
        %2837 = arith.mulf %2828, %arg4 : f32
        %2838 = arith.subf %2836, %2837 : f32
        %2839 = math.exp2 %2838 fastmath<fast> : f32
        %coord_9979 = cute.make_coord() : () -> !cute.coord<"3">
        %2840 = cute.memref.load(%rmem_1080, %coord_9979) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2841 = arith.mulf %2840, %2839 : f32
        %2842 = arith.addf %2841, %2835 : f32
        %coord_9980 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9981 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9982 = cute.crd2idx(%coord_9980, %lay_9981) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9983 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9984 = cute.add_offset(%iter_9983, %idx_9982) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9985 = cute.make_view(%ptr_9984) : !memref_rmem_f32_11
        %iter_9986 = cute.get_iter(%view_9985) : !memref_rmem_f32_11
        %iter_9987 = cute.get_iter(%view_9985) : !memref_rmem_f32_11
        %lay_9988 = cute.get_layout(%view_9985) : !memref_rmem_f32_11
        %2843 = cute.get_shape(%lay_9988) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9989, %e1_9990 = cute.get_leaves(%2843) : !cute.shape<"((2,16))">
        %2844 = cute.memref.load_vec %view_9985 : !memref_rmem_f32_11
        %2845 = vector.broadcast %2839 : f32 to vector<32xf32>
        %2846 = arith.mulf %2844, %2845 : vector<32xf32>
        %coord_9991 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9992 = cute.get_layout(%view_9730) : !memref_rmem_f32_5
        %idx_9993 = cute.crd2idx(%coord_9991, %lay_9992) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9994 = cute.get_iter(%view_9730) : !memref_rmem_f32_5
        %ptr_9995 = cute.add_offset(%iter_9994, %idx_9993) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9996 = cute.make_view(%ptr_9995) : !memref_rmem_f32_11
        %iter_9997 = cute.get_iter(%view_9996) : !memref_rmem_f32_11
        %iter_9998 = cute.get_iter(%view_9996) : !memref_rmem_f32_11
        %lay_9999 = cute.get_layout(%view_9996) : !memref_rmem_f32_11
        %2847 = cute.get_shape(%lay_9999) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_10000, %e1_10001 = cute.get_leaves(%2847) : !cute.shape<"((2,16))">
        %int_tuple_10002 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10003 = cute.size(%int_tuple_10002) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10004 = cute.get_leaves(%sz_10003) : !cute.int_tuple<"32">
        %int_tuple_10005 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_10006 = cute.size(%int_tuple_10005) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_10007 = cute.get_leaves(%sz_10006) : !cute.int_tuple<"32">
        cute.memref.store_vec %2846, %view_9996 : !memref_rmem_f32_11
        %coord_10008 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1075, %coord_10008, %2828) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10009 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1080, %coord_10009, %2842) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_10010 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_10011 = cute.get_layout(%view_9684) : !memref_rmem_f32_4
        %idx_10012 = cute.crd2idx(%coord_10010, %lay_10011) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_10013 = cute.get_iter(%view_9684) : !memref_rmem_f32_4
        %ptr_10014 = cute.add_offset(%iter_10013, %idx_10012) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_10015 = cute.make_view(%ptr_10014) : !memref_rmem_f32_7
        %iter_10016 = cute.get_iter(%view_10015) : !memref_rmem_f32_7
        %iter_10017 = cute.get_iter(%view_10015) : !memref_rmem_f32_7
        %lay_10018 = cute.get_layout(%view_10015) : !memref_rmem_f32_7
        %2848 = cute.get_shape(%lay_10018) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_10019, %e1_10020 = cute.get_leaves(%2848) : !cute.shape<"((2,8))">
        %int_tuple_10021 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10022 = cute.size(%int_tuple_10021) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10023 = cute.get_leaves(%sz_10022) : !cute.int_tuple<"16">
        %int_tuple_10024 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_10025 = cute.size(%int_tuple_10024) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_10026 = cute.get_leaves(%sz_10025) : !cute.int_tuple<"16">
        cute.memref.store_vec %2834, %view_10015 : !memref_rmem_f32_7
        %lay_10027 = cute.get_layout(%rmem_7873) : !memref_rmem_f32_2
        %2849 = cute.make_layout_like(%lay_10027) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_10028 = cute.memref.alloca(%2849) : !memref_rmem_bf16_16
        %iter_10029 = cute.get_iter(%rmem_10028) : !memref_rmem_bf16_16
        %iter_10030 = cute.get_iter(%rmem_10028) : !memref_rmem_bf16_16
        %2850 = cute.memref.load_vec %rmem_7873 : !memref_rmem_f32_2
        %2851 = arith.truncf %2850 : vector<64xf32> to vector<64xbf16>
        %lay_10031 = cute.get_layout(%rmem_10028) : !memref_rmem_bf16_16
        %2852 = cute.get_shape(%lay_10031) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_10032, %e1_10033, %e2_10034, %e3_10035 = cute.get_leaves(%2852) : !cute.shape<"((2,2),2,8)">
        %int_tuple_10036 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10037 = cute.size(%int_tuple_10036) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10038 = cute.get_leaves(%sz_10037) : !cute.int_tuple<"64">
        %int_tuple_10039 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_10040 = cute.size(%int_tuple_10039) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_10041 = cute.get_leaves(%sz_10040) : !cute.int_tuple<"64">
        cute.memref.store_vec %2851, %rmem_10028 : !memref_rmem_bf16_16
        %lay_10042 = cute.get_layout(%rmem_10028) : !memref_rmem_bf16_16
        %tile_10043 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_10044 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
        %2853 = cute.get_shape(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10045, %e1_10046, %e2_10047, %e3_10048, %e4_10049 = cute.get_leaves(%2853) : !cute.shape<"((2,2),2,(2,4))">
        %2854 = cute.get_shape(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10050, %e1_10051, %e2_10052, %e3_10053, %e4_10054 = cute.get_leaves(%2854) : !cute.shape<"((2,2),2,(2,4))">
        %2855 = cute.get_shape(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10055, %e1_10056, %e2_10057, %e3_10058, %e4_10059 = cute.get_leaves(%2855) : !cute.shape<"((2,2),2,(2,4))">
        %2856 = cute.get_shape(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_10060, %e1_10061, %e2_10062, %e3_10063, %e4_10064 = cute.get_leaves(%2856) : !cute.shape<"((2,2),2,(2,4))">
        %2857 = cute.get_stride(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10065, %e1_10066, %e2_10067, %e3_10068, %e4_10069 = cute.get_leaves(%2857) : !cute.stride<"((1,2),4,(8,16))">
        %2858 = cute.get_stride(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10070, %e1_10071, %e2_10072, %e3_10073, %e4_10074 = cute.get_leaves(%2858) : !cute.stride<"((1,2),4,(8,16))">
        %2859 = cute.get_stride(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10075, %e1_10076, %e2_10077, %e3_10078, %e4_10079 = cute.get_leaves(%2859) : !cute.stride<"((1,2),4,(8,16))">
        %2860 = cute.get_stride(%lay_10044) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_10080, %e1_10081, %e2_10082, %e3_10083, %e4_10084 = cute.get_leaves(%2860) : !cute.stride<"((1,2),4,(8,16))">
        %shape_10085 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
        %stride_10086 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
        %lay_10087 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
        %view_10088 = cute.make_view(%iter_10030, %lay_10087) : !memref_rmem_bf16_17
        %iter_10089 = cute.get_iter(%view_10088) : !memref_rmem_bf16_17
        %coord_10090 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10091 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
        %slice_10092 = cute.slice(%lay_10091, %coord_10090) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_10093 = cute.crd2idx(%coord_10090, %lay_10091) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_10094 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
        %ptr_10095 = cute.add_offset(%iter_10094, %idx_10093) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10096 = cute.make_view(%ptr_10095, %slice_10092) : !memref_smem_bf16_19
        %iter_10097 = cute.get_iter(%view_10096) : !memref_smem_bf16_19
        %iter_10098 = cute.get_iter(%view_10096) : !memref_smem_bf16_19
        %coord_10099 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10100 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
        %idx_10101 = cute.crd2idx(%coord_10099, %lay_10100) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_10102 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
        %ptr_10103 = cute.add_offset(%iter_10102, %idx_10101) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10104 = cute.make_view(%ptr_10103) : !memref_rmem_bf16_18
        %iter_10105 = cute.get_iter(%view_10104) : !memref_rmem_bf16_18
        %iter_10106 = cute.get_iter(%view_10104) : !memref_rmem_bf16_18
        %lay_10107 = cute.get_layout(%view_10096) : !memref_smem_bf16_19
        %2861 = cute.get_shape(%lay_10107) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10108, %e1_10109, %e2_10110, %e3_10111, %e4_10112 = cute.get_leaves(%2861) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10113 = cute.get_layout(%view_10104) : !memref_rmem_bf16_18
        %2862 = cute.get_shape(%lay_10113) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10114, %e1_10115, %e2_10116, %e3_10117 = cute.get_leaves(%2862) : !cute.shape<"((8,1),(4,2))">
        %lay_10118 = cute.get_layout(%view_10096) : !memref_smem_bf16_19
        %shape_10119 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10120 = cute.make_layout() : !cute.layout<"1:0">
        %append_10121 = cute.append_to_rank<2> (%lay_10118, %lay_10120) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10122 = cute.make_view(%iter_10098, %append_10121) : !memref_smem_bf16_19
        %iter_10123 = cute.get_iter(%view_10122) : !memref_smem_bf16_19
        %lay_10124 = cute.get_layout(%view_10122) : !memref_smem_bf16_19
        %2863 = cute.get_shape(%lay_10124) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10125, %e1_10126, %e2_10127, %e3_10128, %e4_10129 = cute.get_leaves(%2863) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10130 = cute.get_iter(%view_10122) : !memref_smem_bf16_19
        %lay_10131 = cute.get_layout(%view_10122) : !memref_smem_bf16_19
        %2864:2 = cute.get_scalars(%lay_10131) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10132 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10133 = cute.assume(%2864#0) : (i32) -> !cute.i32<divby 16>
        %iv_10134 = cute.assume(%2864#1) : (i32) -> !cute.i32<divby 32>
        %stride_10135 = cute.make_stride(%iv_10133, %iv_10134) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10136 = cute.make_layout(%shape_10132, %stride_10135) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10137 = cute.make_view(%iter_10130, %lay_10136) : !memref_smem_bf16_20
        %iter_10138 = cute.get_iter(%view_10137) : !memref_smem_bf16_20
        %iter_10139 = cute.get_iter(%view_10137) : !memref_smem_bf16_20
        %lay_10140 = cute.get_layout(%view_10104) : !memref_rmem_bf16_18
        %shape_10141 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10142 = cute.make_layout() : !cute.layout<"1:0">
        %append_10143 = cute.append_to_rank<2> (%lay_10140, %lay_10142) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10144 = cute.make_view(%iter_10106, %append_10143) : !memref_rmem_bf16_18
        %iter_10145 = cute.get_iter(%view_10144) : !memref_rmem_bf16_18
        %lay_10146 = cute.get_layout(%view_10144) : !memref_rmem_bf16_18
        %2865 = cute.get_shape(%lay_10146) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10147, %e1_10148, %e2_10149, %e3_10150 = cute.get_leaves(%2865) : !cute.shape<"((8,1),(4,2))">
        %iter_10151 = cute.get_iter(%view_10144) : !memref_rmem_bf16_18
        %view_10152 = cute.make_view(%iter_10151) : !memref_rmem_bf16_19
        %iter_10153 = cute.get_iter(%view_10152) : !memref_rmem_bf16_19
        %iter_10154 = cute.get_iter(%view_10152) : !memref_rmem_bf16_19
        %lay_10155 = cute.get_layout(%view_10137) : !memref_smem_bf16_20
        %2866 = cute.get_shape(%lay_10155) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10156, %e1_10157, %e2_10158, %e3_10159, %e4_10160 = cute.get_leaves(%2866) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10161 = cute.get_layout(%view_10152) : !memref_rmem_bf16_19
        %2867 = cute.get_shape(%lay_10161) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10162, %e1_10163, %e2_10164, %e3_10165 = cute.get_leaves(%2867) : !cute.shape<"((8,1),((4,2)))">
        %lay_10166 = cute.get_layout(%view_10137) : !memref_smem_bf16_20
        %sz_10167 = cute.size(%lay_10166) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10168 = cute.get_leaves(%sz_10167) : !cute.int_tuple<"8">
        %lay_10169 = cute.get_layout(%view_10152) : !memref_rmem_bf16_19
        %sz_10170 = cute.size(%lay_10169) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10171 = cute.get_leaves(%sz_10170) : !cute.int_tuple<"8">
        %2868 = cute.static : !cute.layout<"1:0">
        %iter_10172 = cute.get_iter(%view_10137) : !memref_smem_bf16_20
        %iter_10173 = cute.get_iter(%view_10152) : !memref_rmem_bf16_19
        %lay_10174 = cute.get_layout(%view_10137) : !memref_smem_bf16_20
        %lay_10175 = cute.get_layout(%view_10152) : !memref_rmem_bf16_19
        %append_10176 = cute.append_to_rank<2> (%lay_10174, %2868) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10177 = cute.append_to_rank<2> (%lay_10175, %2868) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2869:2 = cute.get_scalars(%append_10176) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10178 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10179 = cute.assume(%2869#0) : (i32) -> !cute.i32<divby 16>
        %iv_10180 = cute.assume(%2869#1) : (i32) -> !cute.i32<divby 32>
        %stride_10181 = cute.make_stride(%iv_10179, %iv_10180) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10182 = cute.make_layout(%shape_10178, %stride_10181) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10183 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10184 = cute.size(%lay_10182) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2870 = cute.get_scalars(%sz_10184) : !cute.int_tuple<"8">
        %c0_i32_10185 = arith.constant 0 : i32
        %c1_i32_10186 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10185 to %2870 step %c1_i32_10186  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_10182, %coord_10765) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_10182) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10768 = cute.add_offset(%iter_10172, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_10183, %coord_10765) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_10183) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_10173, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10769, %view_10773) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10187 = cute.get_layout(%view_10088) : !memref_rmem_bf16_17
        %2871 = cute.get_shape(%lay_10187) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
        %e0_10188, %e1_10189, %e2_10190, %e3_10191, %e4_10192 = cute.get_leaves(%2871) : !cute.shape<"(((2,2),2),2,4)">
        %int_tuple_10193 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10194 = cute.size(%int_tuple_10193) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10195 = cute.get_leaves(%sz_10194) : !cute.int_tuple<"4">
        %int_tuple_10196 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10197 = cute.size(%int_tuple_10196) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10198 = cute.get_leaves(%sz_10197) : !cute.int_tuple<"4">
        %coord_10199 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10200 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
        %slice_10201 = cute.slice(%lay_10200, %coord_10199) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
        %idx_10202 = cute.crd2idx(%coord_10199, %lay_10200) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
        %iter_10203 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
        %ptr_10204 = cute.add_offset(%iter_10203, %idx_10202) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10205 = cute.make_view(%ptr_10204, %slice_10201) : !memref_smem_bf16_19
        %iter_10206 = cute.get_iter(%view_10205) : !memref_smem_bf16_19
        %iter_10207 = cute.get_iter(%view_10205) : !memref_smem_bf16_19
        %coord_10208 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10209 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
        %idx_10210 = cute.crd2idx(%coord_10208, %lay_10209) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
        %iter_10211 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
        %ptr_10212 = cute.add_offset(%iter_10211, %idx_10210) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10213 = cute.make_view(%ptr_10212) : !memref_rmem_bf16_18
        %iter_10214 = cute.get_iter(%view_10213) : !memref_rmem_bf16_18
        %iter_10215 = cute.get_iter(%view_10213) : !memref_rmem_bf16_18
        %lay_10216 = cute.get_layout(%view_10205) : !memref_smem_bf16_19
        %2872 = cute.get_shape(%lay_10216) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10217, %e1_10218, %e2_10219, %e3_10220, %e4_10221 = cute.get_leaves(%2872) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10222 = cute.get_layout(%view_10213) : !memref_rmem_bf16_18
        %2873 = cute.get_shape(%lay_10222) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10223, %e1_10224, %e2_10225, %e3_10226 = cute.get_leaves(%2873) : !cute.shape<"((8,1),(4,2))">
        %lay_10227 = cute.get_layout(%view_10205) : !memref_smem_bf16_19
        %shape_10228 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10229 = cute.make_layout() : !cute.layout<"1:0">
        %append_10230 = cute.append_to_rank<2> (%lay_10227, %lay_10229) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10231 = cute.make_view(%iter_10207, %append_10230) : !memref_smem_bf16_19
        %iter_10232 = cute.get_iter(%view_10231) : !memref_smem_bf16_19
        %lay_10233 = cute.get_layout(%view_10231) : !memref_smem_bf16_19
        %2874 = cute.get_shape(%lay_10233) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10234, %e1_10235, %e2_10236, %e3_10237, %e4_10238 = cute.get_leaves(%2874) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10239 = cute.get_iter(%view_10231) : !memref_smem_bf16_19
        %lay_10240 = cute.get_layout(%view_10231) : !memref_smem_bf16_19
        %2875:2 = cute.get_scalars(%lay_10240) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10241 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10242 = cute.assume(%2875#0) : (i32) -> !cute.i32<divby 16>
        %iv_10243 = cute.assume(%2875#1) : (i32) -> !cute.i32<divby 32>
        %stride_10244 = cute.make_stride(%iv_10242, %iv_10243) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10245 = cute.make_layout(%shape_10241, %stride_10244) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10246 = cute.make_view(%iter_10239, %lay_10245) : !memref_smem_bf16_20
        %iter_10247 = cute.get_iter(%view_10246) : !memref_smem_bf16_20
        %iter_10248 = cute.get_iter(%view_10246) : !memref_smem_bf16_20
        %lay_10249 = cute.get_layout(%view_10213) : !memref_rmem_bf16_18
        %shape_10250 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10251 = cute.make_layout() : !cute.layout<"1:0">
        %append_10252 = cute.append_to_rank<2> (%lay_10249, %lay_10251) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10253 = cute.make_view(%iter_10215, %append_10252) : !memref_rmem_bf16_18
        %iter_10254 = cute.get_iter(%view_10253) : !memref_rmem_bf16_18
        %lay_10255 = cute.get_layout(%view_10253) : !memref_rmem_bf16_18
        %2876 = cute.get_shape(%lay_10255) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10256, %e1_10257, %e2_10258, %e3_10259 = cute.get_leaves(%2876) : !cute.shape<"((8,1),(4,2))">
        %iter_10260 = cute.get_iter(%view_10253) : !memref_rmem_bf16_18
        %view_10261 = cute.make_view(%iter_10260) : !memref_rmem_bf16_19
        %iter_10262 = cute.get_iter(%view_10261) : !memref_rmem_bf16_19
        %iter_10263 = cute.get_iter(%view_10261) : !memref_rmem_bf16_19
        %lay_10264 = cute.get_layout(%view_10246) : !memref_smem_bf16_20
        %2877 = cute.get_shape(%lay_10264) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10265, %e1_10266, %e2_10267, %e3_10268, %e4_10269 = cute.get_leaves(%2877) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10270 = cute.get_layout(%view_10261) : !memref_rmem_bf16_19
        %2878 = cute.get_shape(%lay_10270) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10271, %e1_10272, %e2_10273, %e3_10274 = cute.get_leaves(%2878) : !cute.shape<"((8,1),((4,2)))">
        %lay_10275 = cute.get_layout(%view_10246) : !memref_smem_bf16_20
        %sz_10276 = cute.size(%lay_10275) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10277 = cute.get_leaves(%sz_10276) : !cute.int_tuple<"8">
        %lay_10278 = cute.get_layout(%view_10261) : !memref_rmem_bf16_19
        %sz_10279 = cute.size(%lay_10278) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10280 = cute.get_leaves(%sz_10279) : !cute.int_tuple<"8">
        %2879 = cute.static : !cute.layout<"1:0">
        %iter_10281 = cute.get_iter(%view_10246) : !memref_smem_bf16_20
        %iter_10282 = cute.get_iter(%view_10261) : !memref_rmem_bf16_19
        %lay_10283 = cute.get_layout(%view_10246) : !memref_smem_bf16_20
        %lay_10284 = cute.get_layout(%view_10261) : !memref_rmem_bf16_19
        %append_10285 = cute.append_to_rank<2> (%lay_10283, %2879) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10286 = cute.append_to_rank<2> (%lay_10284, %2879) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2880:2 = cute.get_scalars(%append_10285) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10287 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10288 = cute.assume(%2880#0) : (i32) -> !cute.i32<divby 16>
        %iv_10289 = cute.assume(%2880#1) : (i32) -> !cute.i32<divby 32>
        %stride_10290 = cute.make_stride(%iv_10288, %iv_10289) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10291 = cute.make_layout(%shape_10287, %stride_10290) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10292 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10293 = cute.size(%lay_10291) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2881 = cute.get_scalars(%sz_10293) : !cute.int_tuple<"8">
        %c0_i32_10294 = arith.constant 0 : i32
        %c1_i32_10295 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10294 to %2881 step %c1_i32_10295  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_10291, %coord_10765) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_10291) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10768 = cute.add_offset(%iter_10281, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_10292, %coord_10765) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_10292) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_10282, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10769, %view_10773) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10296 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10297 = cute.get_layout(%view_10088) : !memref_rmem_bf16_17
        %idx_10298 = cute.crd2idx(%coord_10296, %lay_10297) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
        %iter_10299 = cute.get_iter(%view_10088) : !memref_rmem_bf16_17
        %ptr_10300 = cute.add_offset(%iter_10299, %idx_10298) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10301 = cute.make_view(%ptr_10300) : !memref_rmem_bf16_20
        %iter_10302 = cute.get_iter(%view_10301) : !memref_rmem_bf16_20
        %iter_10303 = cute.get_iter(%view_10301) : !memref_rmem_bf16_20
        %coord_10304 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10305 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
        %idx_10306 = cute.crd2idx(%coord_10304, %lay_10305) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_10307 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
        %ptr_10308 = cute.add_offset(%iter_10307, %idx_10306) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10309 = cute.make_view(%ptr_10308) : !memref_rmem_bf16_21
        %iter_10310 = cute.get_iter(%view_10309) : !memref_rmem_bf16_21
        %iter_10311 = cute.get_iter(%view_10309) : !memref_rmem_bf16_21
        %lay_10312 = cute.get_layout(%view_10301) : !memref_rmem_bf16_20
        %2882 = cute.get_shape(%lay_10312) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10313, %e1_10314, %e2_10315, %e3_10316 = cute.get_leaves(%2882) : !cute.shape<"(((2,2),2),2)">
        %lay_10317 = cute.get_layout(%view_10309) : !memref_rmem_bf16_21
        %2883 = cute.get_shape(%lay_10317) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10318, %e1_10319, %e2_10320, %e3_10321 = cute.get_leaves(%2883) : !cute.shape<"((2,2),(8,2))">
        %lay_10322 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2884 = cute.get_shape(%lay_10322) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10323, %e1_10324, %e2_10325, %e3_10326 = cute.get_leaves(%2884) : !cute.shape<"((2,2),2,16)">
        %iter_10327 = cute.get_iter(%view_10301) : !memref_rmem_bf16_20
        %iter_10328 = cute.get_iter(%view_10309) : !memref_rmem_bf16_21
        %iter_10329 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10330 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10331 = cute.get_layout(%view_10301) : !memref_rmem_bf16_20
        %lay_10332 = cute.get_layout(%view_10309) : !memref_rmem_bf16_21
        %lay_10333 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10334 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2885 = cute.static : !cute.layout<"1:0">
        %append_10335 = cute.append_to_rank<3> (%lay_10331, %2885) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10336 = cute.append_to_rank<3> (%lay_10332, %2885) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10337 = cute.size(%append_10335) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10338 = cute.size(%append_10335) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10339 = cute.size(%append_10336) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2886 = cute.get_scalars(%sz_10337) : !cute.int_tuple<"1">
        %2887 = cute.get_scalars(%sz_10338) : !cute.int_tuple<"2">
        %2888 = cute.get_scalars(%sz_10339) : !cute.int_tuple<"16">
        %c0_i32_10340 = arith.constant 0 : i32
        %c1_i32_10341 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10340 to %2886 step %c1_i32_10341  : i32 {
          scf.for %arg14 = %c0_i32_10340 to %2887 step %c1_i32_10341  : i32 {
            scf.for %arg15 = %c0_i32_10340 to %2888 step %c1_i32_10341  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_10335, %coord_10765) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_10335) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10770 = cute.add_offset(%iter_10327, %idx_10769) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_22
              %slice_10772 = cute.slice(%append_10336, %coord_10766) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_10336) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_10328, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_10333, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_10333) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_10329, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_10334, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_10334) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_10330, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10342 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10343 = cute.size(%int_tuple_10342) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10344 = cute.get_leaves(%sz_10343) : !cute.int_tuple<"4">
        %coord_10345 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10346 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
        %slice_10347 = cute.slice(%lay_10346, %coord_10345) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
        %idx_10348 = cute.crd2idx(%coord_10345, %lay_10346) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
        %iter_10349 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
        %ptr_10350 = cute.add_offset(%iter_10349, %idx_10348) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10351 = cute.make_view(%ptr_10350, %slice_10347) : !memref_smem_bf16_19
        %iter_10352 = cute.get_iter(%view_10351) : !memref_smem_bf16_19
        %iter_10353 = cute.get_iter(%view_10351) : !memref_smem_bf16_19
        %coord_10354 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10355 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
        %idx_10356 = cute.crd2idx(%coord_10354, %lay_10355) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
        %iter_10357 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
        %ptr_10358 = cute.add_offset(%iter_10357, %idx_10356) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10359 = cute.make_view(%ptr_10358) : !memref_rmem_bf16_18
        %iter_10360 = cute.get_iter(%view_10359) : !memref_rmem_bf16_18
        %iter_10361 = cute.get_iter(%view_10359) : !memref_rmem_bf16_18
        %lay_10362 = cute.get_layout(%view_10351) : !memref_smem_bf16_19
        %2889 = cute.get_shape(%lay_10362) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10363, %e1_10364, %e2_10365, %e3_10366, %e4_10367 = cute.get_leaves(%2889) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10368 = cute.get_layout(%view_10359) : !memref_rmem_bf16_18
        %2890 = cute.get_shape(%lay_10368) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10369, %e1_10370, %e2_10371, %e3_10372 = cute.get_leaves(%2890) : !cute.shape<"((8,1),(4,2))">
        %lay_10373 = cute.get_layout(%view_10351) : !memref_smem_bf16_19
        %shape_10374 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10375 = cute.make_layout() : !cute.layout<"1:0">
        %append_10376 = cute.append_to_rank<2> (%lay_10373, %lay_10375) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10377 = cute.make_view(%iter_10353, %append_10376) : !memref_smem_bf16_19
        %iter_10378 = cute.get_iter(%view_10377) : !memref_smem_bf16_19
        %lay_10379 = cute.get_layout(%view_10377) : !memref_smem_bf16_19
        %2891 = cute.get_shape(%lay_10379) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10380, %e1_10381, %e2_10382, %e3_10383, %e4_10384 = cute.get_leaves(%2891) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10385 = cute.get_iter(%view_10377) : !memref_smem_bf16_19
        %lay_10386 = cute.get_layout(%view_10377) : !memref_smem_bf16_19
        %2892:2 = cute.get_scalars(%lay_10386) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10387 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10388 = cute.assume(%2892#0) : (i32) -> !cute.i32<divby 16>
        %iv_10389 = cute.assume(%2892#1) : (i32) -> !cute.i32<divby 32>
        %stride_10390 = cute.make_stride(%iv_10388, %iv_10389) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10391 = cute.make_layout(%shape_10387, %stride_10390) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10392 = cute.make_view(%iter_10385, %lay_10391) : !memref_smem_bf16_20
        %iter_10393 = cute.get_iter(%view_10392) : !memref_smem_bf16_20
        %iter_10394 = cute.get_iter(%view_10392) : !memref_smem_bf16_20
        %lay_10395 = cute.get_layout(%view_10359) : !memref_rmem_bf16_18
        %shape_10396 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10397 = cute.make_layout() : !cute.layout<"1:0">
        %append_10398 = cute.append_to_rank<2> (%lay_10395, %lay_10397) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10399 = cute.make_view(%iter_10361, %append_10398) : !memref_rmem_bf16_18
        %iter_10400 = cute.get_iter(%view_10399) : !memref_rmem_bf16_18
        %lay_10401 = cute.get_layout(%view_10399) : !memref_rmem_bf16_18
        %2893 = cute.get_shape(%lay_10401) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10402, %e1_10403, %e2_10404, %e3_10405 = cute.get_leaves(%2893) : !cute.shape<"((8,1),(4,2))">
        %iter_10406 = cute.get_iter(%view_10399) : !memref_rmem_bf16_18
        %view_10407 = cute.make_view(%iter_10406) : !memref_rmem_bf16_19
        %iter_10408 = cute.get_iter(%view_10407) : !memref_rmem_bf16_19
        %iter_10409 = cute.get_iter(%view_10407) : !memref_rmem_bf16_19
        %lay_10410 = cute.get_layout(%view_10392) : !memref_smem_bf16_20
        %2894 = cute.get_shape(%lay_10410) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10411, %e1_10412, %e2_10413, %e3_10414, %e4_10415 = cute.get_leaves(%2894) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10416 = cute.get_layout(%view_10407) : !memref_rmem_bf16_19
        %2895 = cute.get_shape(%lay_10416) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10417, %e1_10418, %e2_10419, %e3_10420 = cute.get_leaves(%2895) : !cute.shape<"((8,1),((4,2)))">
        %lay_10421 = cute.get_layout(%view_10392) : !memref_smem_bf16_20
        %sz_10422 = cute.size(%lay_10421) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10423 = cute.get_leaves(%sz_10422) : !cute.int_tuple<"8">
        %lay_10424 = cute.get_layout(%view_10407) : !memref_rmem_bf16_19
        %sz_10425 = cute.size(%lay_10424) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10426 = cute.get_leaves(%sz_10425) : !cute.int_tuple<"8">
        %2896 = cute.static : !cute.layout<"1:0">
        %iter_10427 = cute.get_iter(%view_10392) : !memref_smem_bf16_20
        %iter_10428 = cute.get_iter(%view_10407) : !memref_rmem_bf16_19
        %lay_10429 = cute.get_layout(%view_10392) : !memref_smem_bf16_20
        %lay_10430 = cute.get_layout(%view_10407) : !memref_rmem_bf16_19
        %append_10431 = cute.append_to_rank<2> (%lay_10429, %2896) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10432 = cute.append_to_rank<2> (%lay_10430, %2896) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2897:2 = cute.get_scalars(%append_10431) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10433 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10434 = cute.assume(%2897#0) : (i32) -> !cute.i32<divby 16>
        %iv_10435 = cute.assume(%2897#1) : (i32) -> !cute.i32<divby 32>
        %stride_10436 = cute.make_stride(%iv_10434, %iv_10435) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10437 = cute.make_layout(%shape_10433, %stride_10436) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10438 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10439 = cute.size(%lay_10437) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2898 = cute.get_scalars(%sz_10439) : !cute.int_tuple<"8">
        %c0_i32_10440 = arith.constant 0 : i32
        %c1_i32_10441 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10440 to %2898 step %c1_i32_10441  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_10437, %coord_10765) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_10437) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10768 = cute.add_offset(%iter_10427, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_10438, %coord_10765) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_10438) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_10428, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10769, %view_10773) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10442 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10443 = cute.get_layout(%view_10088) : !memref_rmem_bf16_17
        %idx_10444 = cute.crd2idx(%coord_10442, %lay_10443) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
        %iter_10445 = cute.get_iter(%view_10088) : !memref_rmem_bf16_17
        %ptr_10446 = cute.add_offset(%iter_10445, %idx_10444) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10447 = cute.make_view(%ptr_10446) : !memref_rmem_bf16_20
        %iter_10448 = cute.get_iter(%view_10447) : !memref_rmem_bf16_20
        %iter_10449 = cute.get_iter(%view_10447) : !memref_rmem_bf16_20
        %coord_10450 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10451 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
        %idx_10452 = cute.crd2idx(%coord_10450, %lay_10451) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_10453 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
        %ptr_10454 = cute.add_offset(%iter_10453, %idx_10452) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10455 = cute.make_view(%ptr_10454) : !memref_rmem_bf16_21
        %iter_10456 = cute.get_iter(%view_10455) : !memref_rmem_bf16_21
        %iter_10457 = cute.get_iter(%view_10455) : !memref_rmem_bf16_21
        %lay_10458 = cute.get_layout(%view_10447) : !memref_rmem_bf16_20
        %2899 = cute.get_shape(%lay_10458) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10459, %e1_10460, %e2_10461, %e3_10462 = cute.get_leaves(%2899) : !cute.shape<"(((2,2),2),2)">
        %lay_10463 = cute.get_layout(%view_10455) : !memref_rmem_bf16_21
        %2900 = cute.get_shape(%lay_10463) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10464, %e1_10465, %e2_10466, %e3_10467 = cute.get_leaves(%2900) : !cute.shape<"((2,2),(8,2))">
        %iter_10468 = cute.get_iter(%view_10447) : !memref_rmem_bf16_20
        %iter_10469 = cute.get_iter(%view_10455) : !memref_rmem_bf16_21
        %iter_10470 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10471 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10472 = cute.get_layout(%view_10447) : !memref_rmem_bf16_20
        %lay_10473 = cute.get_layout(%view_10455) : !memref_rmem_bf16_21
        %lay_10474 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10475 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2901 = cute.static : !cute.layout<"1:0">
        %append_10476 = cute.append_to_rank<3> (%lay_10472, %2901) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10477 = cute.append_to_rank<3> (%lay_10473, %2901) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10478 = cute.size(%append_10476) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10479 = cute.size(%append_10476) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10480 = cute.size(%append_10477) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2902 = cute.get_scalars(%sz_10478) : !cute.int_tuple<"1">
        %2903 = cute.get_scalars(%sz_10479) : !cute.int_tuple<"2">
        %2904 = cute.get_scalars(%sz_10480) : !cute.int_tuple<"16">
        %c0_i32_10481 = arith.constant 0 : i32
        %c1_i32_10482 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10481 to %2902 step %c1_i32_10482  : i32 {
          scf.for %arg14 = %c0_i32_10481 to %2903 step %c1_i32_10482  : i32 {
            scf.for %arg15 = %c0_i32_10481 to %2904 step %c1_i32_10482  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_10476, %coord_10765) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_10476) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10770 = cute.add_offset(%iter_10468, %idx_10769) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_22
              %slice_10772 = cute.slice(%append_10477, %coord_10766) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_10477) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_10469, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_10474, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_10474) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_10470, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_10475, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_10475) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_10471, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10483 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10484 = cute.size(%int_tuple_10483) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10485 = cute.get_leaves(%sz_10484) : !cute.int_tuple<"4">
        %coord_10486 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10487 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
        %slice_10488 = cute.slice(%lay_10487, %coord_10486) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
        %idx_10489 = cute.crd2idx(%coord_10486, %lay_10487) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
        %iter_10490 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
        %ptr_10491 = cute.add_offset(%iter_10490, %idx_10489) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10492 = cute.make_view(%ptr_10491, %slice_10488) : !memref_smem_bf16_19
        %iter_10493 = cute.get_iter(%view_10492) : !memref_smem_bf16_19
        %iter_10494 = cute.get_iter(%view_10492) : !memref_smem_bf16_19
        %coord_10495 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10496 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
        %idx_10497 = cute.crd2idx(%coord_10495, %lay_10496) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
        %iter_10498 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
        %ptr_10499 = cute.add_offset(%iter_10498, %idx_10497) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10500 = cute.make_view(%ptr_10499) : !memref_rmem_bf16_18
        %iter_10501 = cute.get_iter(%view_10500) : !memref_rmem_bf16_18
        %iter_10502 = cute.get_iter(%view_10500) : !memref_rmem_bf16_18
        %lay_10503 = cute.get_layout(%view_10492) : !memref_smem_bf16_19
        %2905 = cute.get_shape(%lay_10503) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10504, %e1_10505, %e2_10506, %e3_10507, %e4_10508 = cute.get_leaves(%2905) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10509 = cute.get_layout(%view_10500) : !memref_rmem_bf16_18
        %2906 = cute.get_shape(%lay_10509) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10510, %e1_10511, %e2_10512, %e3_10513 = cute.get_leaves(%2906) : !cute.shape<"((8,1),(4,2))">
        %lay_10514 = cute.get_layout(%view_10492) : !memref_smem_bf16_19
        %shape_10515 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10516 = cute.make_layout() : !cute.layout<"1:0">
        %append_10517 = cute.append_to_rank<2> (%lay_10514, %lay_10516) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10518 = cute.make_view(%iter_10494, %append_10517) : !memref_smem_bf16_19
        %iter_10519 = cute.get_iter(%view_10518) : !memref_smem_bf16_19
        %lay_10520 = cute.get_layout(%view_10518) : !memref_smem_bf16_19
        %2907 = cute.get_shape(%lay_10520) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10521, %e1_10522, %e2_10523, %e3_10524, %e4_10525 = cute.get_leaves(%2907) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10526 = cute.get_iter(%view_10518) : !memref_smem_bf16_19
        %lay_10527 = cute.get_layout(%view_10518) : !memref_smem_bf16_19
        %2908:2 = cute.get_scalars(%lay_10527) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10528 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10529 = cute.assume(%2908#0) : (i32) -> !cute.i32<divby 16>
        %iv_10530 = cute.assume(%2908#1) : (i32) -> !cute.i32<divby 32>
        %stride_10531 = cute.make_stride(%iv_10529, %iv_10530) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10532 = cute.make_layout(%shape_10528, %stride_10531) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10533 = cute.make_view(%iter_10526, %lay_10532) : !memref_smem_bf16_20
        %iter_10534 = cute.get_iter(%view_10533) : !memref_smem_bf16_20
        %iter_10535 = cute.get_iter(%view_10533) : !memref_smem_bf16_20
        %lay_10536 = cute.get_layout(%view_10500) : !memref_rmem_bf16_18
        %shape_10537 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10538 = cute.make_layout() : !cute.layout<"1:0">
        %append_10539 = cute.append_to_rank<2> (%lay_10536, %lay_10538) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10540 = cute.make_view(%iter_10502, %append_10539) : !memref_rmem_bf16_18
        %iter_10541 = cute.get_iter(%view_10540) : !memref_rmem_bf16_18
        %lay_10542 = cute.get_layout(%view_10540) : !memref_rmem_bf16_18
        %2909 = cute.get_shape(%lay_10542) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10543, %e1_10544, %e2_10545, %e3_10546 = cute.get_leaves(%2909) : !cute.shape<"((8,1),(4,2))">
        %iter_10547 = cute.get_iter(%view_10540) : !memref_rmem_bf16_18
        %view_10548 = cute.make_view(%iter_10547) : !memref_rmem_bf16_19
        %iter_10549 = cute.get_iter(%view_10548) : !memref_rmem_bf16_19
        %iter_10550 = cute.get_iter(%view_10548) : !memref_rmem_bf16_19
        %lay_10551 = cute.get_layout(%view_10533) : !memref_smem_bf16_20
        %2910 = cute.get_shape(%lay_10551) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10552, %e1_10553, %e2_10554, %e3_10555, %e4_10556 = cute.get_leaves(%2910) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10557 = cute.get_layout(%view_10548) : !memref_rmem_bf16_19
        %2911 = cute.get_shape(%lay_10557) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10558, %e1_10559, %e2_10560, %e3_10561 = cute.get_leaves(%2911) : !cute.shape<"((8,1),((4,2)))">
        %lay_10562 = cute.get_layout(%view_10533) : !memref_smem_bf16_20
        %sz_10563 = cute.size(%lay_10562) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10564 = cute.get_leaves(%sz_10563) : !cute.int_tuple<"8">
        %lay_10565 = cute.get_layout(%view_10548) : !memref_rmem_bf16_19
        %sz_10566 = cute.size(%lay_10565) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10567 = cute.get_leaves(%sz_10566) : !cute.int_tuple<"8">
        %2912 = cute.static : !cute.layout<"1:0">
        %iter_10568 = cute.get_iter(%view_10533) : !memref_smem_bf16_20
        %iter_10569 = cute.get_iter(%view_10548) : !memref_rmem_bf16_19
        %lay_10570 = cute.get_layout(%view_10533) : !memref_smem_bf16_20
        %lay_10571 = cute.get_layout(%view_10548) : !memref_rmem_bf16_19
        %append_10572 = cute.append_to_rank<2> (%lay_10570, %2912) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10573 = cute.append_to_rank<2> (%lay_10571, %2912) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2913:2 = cute.get_scalars(%append_10572) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10574 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10575 = cute.assume(%2913#0) : (i32) -> !cute.i32<divby 16>
        %iv_10576 = cute.assume(%2913#1) : (i32) -> !cute.i32<divby 32>
        %stride_10577 = cute.make_stride(%iv_10575, %iv_10576) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10578 = cute.make_layout(%shape_10574, %stride_10577) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10579 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10580 = cute.size(%lay_10578) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2914 = cute.get_scalars(%sz_10580) : !cute.int_tuple<"8">
        %c0_i32_10581 = arith.constant 0 : i32
        %c1_i32_10582 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10581 to %2914 step %c1_i32_10582  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_10578, %coord_10765) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_10578) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10768 = cute.add_offset(%iter_10568, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_10579, %coord_10765) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_10579) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_10569, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10769, %view_10773) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10583 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10584 = cute.get_layout(%view_10088) : !memref_rmem_bf16_17
        %idx_10585 = cute.crd2idx(%coord_10583, %lay_10584) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
        %iter_10586 = cute.get_iter(%view_10088) : !memref_rmem_bf16_17
        %ptr_10587 = cute.add_offset(%iter_10586, %idx_10585) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10588 = cute.make_view(%ptr_10587) : !memref_rmem_bf16_20
        %iter_10589 = cute.get_iter(%view_10588) : !memref_rmem_bf16_20
        %iter_10590 = cute.get_iter(%view_10588) : !memref_rmem_bf16_20
        %coord_10591 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10592 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
        %idx_10593 = cute.crd2idx(%coord_10591, %lay_10592) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_10594 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
        %ptr_10595 = cute.add_offset(%iter_10594, %idx_10593) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10596 = cute.make_view(%ptr_10595) : !memref_rmem_bf16_21
        %iter_10597 = cute.get_iter(%view_10596) : !memref_rmem_bf16_21
        %iter_10598 = cute.get_iter(%view_10596) : !memref_rmem_bf16_21
        %lay_10599 = cute.get_layout(%view_10588) : !memref_rmem_bf16_20
        %2915 = cute.get_shape(%lay_10599) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10600, %e1_10601, %e2_10602, %e3_10603 = cute.get_leaves(%2915) : !cute.shape<"(((2,2),2),2)">
        %lay_10604 = cute.get_layout(%view_10596) : !memref_rmem_bf16_21
        %2916 = cute.get_shape(%lay_10604) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10605, %e1_10606, %e2_10607, %e3_10608 = cute.get_leaves(%2916) : !cute.shape<"((2,2),(8,2))">
        %iter_10609 = cute.get_iter(%view_10588) : !memref_rmem_bf16_20
        %iter_10610 = cute.get_iter(%view_10596) : !memref_rmem_bf16_21
        %iter_10611 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10612 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10613 = cute.get_layout(%view_10588) : !memref_rmem_bf16_20
        %lay_10614 = cute.get_layout(%view_10596) : !memref_rmem_bf16_21
        %lay_10615 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10616 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2917 = cute.static : !cute.layout<"1:0">
        %append_10617 = cute.append_to_rank<3> (%lay_10613, %2917) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10618 = cute.append_to_rank<3> (%lay_10614, %2917) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10619 = cute.size(%append_10617) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10620 = cute.size(%append_10617) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10621 = cute.size(%append_10618) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2918 = cute.get_scalars(%sz_10619) : !cute.int_tuple<"1">
        %2919 = cute.get_scalars(%sz_10620) : !cute.int_tuple<"2">
        %2920 = cute.get_scalars(%sz_10621) : !cute.int_tuple<"16">
        %c0_i32_10622 = arith.constant 0 : i32
        %c1_i32_10623 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10622 to %2918 step %c1_i32_10623  : i32 {
          scf.for %arg14 = %c0_i32_10622 to %2919 step %c1_i32_10623  : i32 {
            scf.for %arg15 = %c0_i32_10622 to %2920 step %c1_i32_10623  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_10617, %coord_10765) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_10617) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10770 = cute.add_offset(%iter_10609, %idx_10769) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_22
              %slice_10772 = cute.slice(%append_10618, %coord_10766) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_10618) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_10610, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_10615, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_10615) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_10611, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_10616, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_10616) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_10612, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10624 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10625 = cute.size(%int_tuple_10624) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10626 = cute.get_leaves(%sz_10625) : !cute.int_tuple<"4">
        %coord_10627 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10628 = cute.get_layout(%src_partitioned_386) : !memref_smem_bf16_10
        %slice_10629 = cute.slice(%lay_10628, %coord_10627) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_10630 = cute.crd2idx(%coord_10627, %lay_10628) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_10631 = cute.get_iter(%src_partitioned_386) : !memref_smem_bf16_10
        %ptr_10632 = cute.add_offset(%iter_10631, %idx_10630) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10633 = cute.make_view(%ptr_10632, %slice_10629) : !memref_smem_bf16_19
        %iter_10634 = cute.get_iter(%view_10633) : !memref_smem_bf16_19
        %iter_10635 = cute.get_iter(%view_10633) : !memref_smem_bf16_19
        %coord_10636 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10637 = cute.get_layout(%retiled_388) : !memref_rmem_bf16_5
        %idx_10638 = cute.crd2idx(%coord_10636, %lay_10637) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_10639 = cute.get_iter(%retiled_388) : !memref_rmem_bf16_5
        %ptr_10640 = cute.add_offset(%iter_10639, %idx_10638) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10641 = cute.make_view(%ptr_10640) : !memref_rmem_bf16_18
        %iter_10642 = cute.get_iter(%view_10641) : !memref_rmem_bf16_18
        %iter_10643 = cute.get_iter(%view_10641) : !memref_rmem_bf16_18
        %lay_10644 = cute.get_layout(%view_10633) : !memref_smem_bf16_19
        %2921 = cute.get_shape(%lay_10644) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10645, %e1_10646, %e2_10647, %e3_10648, %e4_10649 = cute.get_leaves(%2921) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10650 = cute.get_layout(%view_10641) : !memref_rmem_bf16_18
        %2922 = cute.get_shape(%lay_10650) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10651, %e1_10652, %e2_10653, %e3_10654 = cute.get_leaves(%2922) : !cute.shape<"((8,1),(4,2))">
        %lay_10655 = cute.get_layout(%view_10633) : !memref_smem_bf16_19
        %shape_10656 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10657 = cute.make_layout() : !cute.layout<"1:0">
        %append_10658 = cute.append_to_rank<2> (%lay_10655, %lay_10657) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10659 = cute.make_view(%iter_10635, %append_10658) : !memref_smem_bf16_19
        %iter_10660 = cute.get_iter(%view_10659) : !memref_smem_bf16_19
        %lay_10661 = cute.get_layout(%view_10659) : !memref_smem_bf16_19
        %2923 = cute.get_shape(%lay_10661) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10662, %e1_10663, %e2_10664, %e3_10665, %e4_10666 = cute.get_leaves(%2923) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10667 = cute.get_iter(%view_10659) : !memref_smem_bf16_19
        %lay_10668 = cute.get_layout(%view_10659) : !memref_smem_bf16_19
        %2924:2 = cute.get_scalars(%lay_10668) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10669 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10670 = cute.assume(%2924#0) : (i32) -> !cute.i32<divby 16>
        %iv_10671 = cute.assume(%2924#1) : (i32) -> !cute.i32<divby 32>
        %stride_10672 = cute.make_stride(%iv_10670, %iv_10671) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10673 = cute.make_layout(%shape_10669, %stride_10672) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10674 = cute.make_view(%iter_10667, %lay_10673) : !memref_smem_bf16_20
        %iter_10675 = cute.get_iter(%view_10674) : !memref_smem_bf16_20
        %iter_10676 = cute.get_iter(%view_10674) : !memref_smem_bf16_20
        %lay_10677 = cute.get_layout(%view_10641) : !memref_rmem_bf16_18
        %shape_10678 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10679 = cute.make_layout() : !cute.layout<"1:0">
        %append_10680 = cute.append_to_rank<2> (%lay_10677, %lay_10679) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10681 = cute.make_view(%iter_10643, %append_10680) : !memref_rmem_bf16_18
        %iter_10682 = cute.get_iter(%view_10681) : !memref_rmem_bf16_18
        %lay_10683 = cute.get_layout(%view_10681) : !memref_rmem_bf16_18
        %2925 = cute.get_shape(%lay_10683) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10684, %e1_10685, %e2_10686, %e3_10687 = cute.get_leaves(%2925) : !cute.shape<"((8,1),(4,2))">
        %iter_10688 = cute.get_iter(%view_10681) : !memref_rmem_bf16_18
        %view_10689 = cute.make_view(%iter_10688) : !memref_rmem_bf16_19
        %iter_10690 = cute.get_iter(%view_10689) : !memref_rmem_bf16_19
        %iter_10691 = cute.get_iter(%view_10689) : !memref_rmem_bf16_19
        %lay_10692 = cute.get_layout(%view_10674) : !memref_smem_bf16_20
        %2926 = cute.get_shape(%lay_10692) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10693, %e1_10694, %e2_10695, %e3_10696, %e4_10697 = cute.get_leaves(%2926) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10698 = cute.get_layout(%view_10689) : !memref_rmem_bf16_19
        %2927 = cute.get_shape(%lay_10698) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10699, %e1_10700, %e2_10701, %e3_10702 = cute.get_leaves(%2927) : !cute.shape<"((8,1),((4,2)))">
        %lay_10703 = cute.get_layout(%view_10674) : !memref_smem_bf16_20
        %sz_10704 = cute.size(%lay_10703) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10705 = cute.get_leaves(%sz_10704) : !cute.int_tuple<"8">
        %lay_10706 = cute.get_layout(%view_10689) : !memref_rmem_bf16_19
        %sz_10707 = cute.size(%lay_10706) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10708 = cute.get_leaves(%sz_10707) : !cute.int_tuple<"8">
        %2928 = cute.static : !cute.layout<"1:0">
        %iter_10709 = cute.get_iter(%view_10674) : !memref_smem_bf16_20
        %iter_10710 = cute.get_iter(%view_10689) : !memref_rmem_bf16_19
        %lay_10711 = cute.get_layout(%view_10674) : !memref_smem_bf16_20
        %lay_10712 = cute.get_layout(%view_10689) : !memref_rmem_bf16_19
        %append_10713 = cute.append_to_rank<2> (%lay_10711, %2928) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10714 = cute.append_to_rank<2> (%lay_10712, %2928) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2929:2 = cute.get_scalars(%append_10713) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10715 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10716 = cute.assume(%2929#0) : (i32) -> !cute.i32<divby 16>
        %iv_10717 = cute.assume(%2929#1) : (i32) -> !cute.i32<divby 32>
        %stride_10718 = cute.make_stride(%iv_10716, %iv_10717) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10719 = cute.make_layout(%shape_10715, %stride_10718) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10720 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10721 = cute.size(%lay_10719) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2930 = cute.get_scalars(%sz_10721) : !cute.int_tuple<"8">
        %c0_i32_10722 = arith.constant 0 : i32
        %c1_i32_10723 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10722 to %2930 step %c1_i32_10723  : i32 {
          %coord_10765 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10766 = cute.slice(%lay_10719, %coord_10765) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10767 = cute.crd2idx(%coord_10765, %lay_10719) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10768 = cute.add_offset(%iter_10709, %idx_10767) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10769 = cute.make_view(%ptr_10768, %slice_10766) : !memref_smem_bf16_13
          %slice_10770 = cute.slice(%lay_10720, %coord_10765) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10771 = cute.crd2idx(%coord_10765, %lay_10720) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10772 = cute.add_offset(%iter_10710, %idx_10771) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10773 = cute.make_view(%ptr_10772, %slice_10770) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10769, %view_10773) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10724 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10725 = cute.get_layout(%view_10088) : !memref_rmem_bf16_17
        %idx_10726 = cute.crd2idx(%coord_10724, %lay_10725) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
        %iter_10727 = cute.get_iter(%view_10088) : !memref_rmem_bf16_17
        %ptr_10728 = cute.add_offset(%iter_10727, %idx_10726) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10729 = cute.make_view(%ptr_10728) : !memref_rmem_bf16_20
        %iter_10730 = cute.get_iter(%view_10729) : !memref_rmem_bf16_20
        %iter_10731 = cute.get_iter(%view_10729) : !memref_rmem_bf16_20
        %coord_10732 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10733 = cute.get_layout(%frg_B_312) : !memref_rmem_bf16_2
        %idx_10734 = cute.crd2idx(%coord_10732, %lay_10733) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_10735 = cute.get_iter(%frg_B_312) : !memref_rmem_bf16_2
        %ptr_10736 = cute.add_offset(%iter_10735, %idx_10734) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10737 = cute.make_view(%ptr_10736) : !memref_rmem_bf16_21
        %iter_10738 = cute.get_iter(%view_10737) : !memref_rmem_bf16_21
        %iter_10739 = cute.get_iter(%view_10737) : !memref_rmem_bf16_21
        %lay_10740 = cute.get_layout(%view_10729) : !memref_rmem_bf16_20
        %2931 = cute.get_shape(%lay_10740) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10741, %e1_10742, %e2_10743, %e3_10744 = cute.get_leaves(%2931) : !cute.shape<"(((2,2),2),2)">
        %lay_10745 = cute.get_layout(%view_10737) : !memref_rmem_bf16_21
        %2932 = cute.get_shape(%lay_10745) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10746, %e1_10747, %e2_10748, %e3_10749 = cute.get_leaves(%2932) : !cute.shape<"((2,2),(8,2))">
        %iter_10750 = cute.get_iter(%view_10729) : !memref_rmem_bf16_20
        %iter_10751 = cute.get_iter(%view_10737) : !memref_rmem_bf16_21
        %iter_10752 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10753 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10754 = cute.get_layout(%view_10729) : !memref_rmem_bf16_20
        %lay_10755 = cute.get_layout(%view_10737) : !memref_rmem_bf16_21
        %lay_10756 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10757 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2933 = cute.static : !cute.layout<"1:0">
        %append_10758 = cute.append_to_rank<3> (%lay_10754, %2933) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10759 = cute.append_to_rank<3> (%lay_10755, %2933) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10760 = cute.size(%append_10758) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10761 = cute.size(%append_10758) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10762 = cute.size(%append_10759) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2934 = cute.get_scalars(%sz_10760) : !cute.int_tuple<"1">
        %2935 = cute.get_scalars(%sz_10761) : !cute.int_tuple<"2">
        %2936 = cute.get_scalars(%sz_10762) : !cute.int_tuple<"16">
        %c0_i32_10763 = arith.constant 0 : i32
        %c1_i32_10764 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10763 to %2934 step %c1_i32_10764  : i32 {
          scf.for %arg14 = %c0_i32_10763 to %2935 step %c1_i32_10764  : i32 {
            scf.for %arg15 = %c0_i32_10763 to %2936 step %c1_i32_10764  : i32 {
              %coord_10765 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10766 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10767 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10768 = cute.slice(%append_10758, %coord_10765) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10769 = cute.crd2idx(%coord_10765, %append_10758) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10770 = cute.add_offset(%iter_10750, %idx_10769) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10771 = cute.make_view(%ptr_10770, %slice_10768) : !memref_rmem_bf16_22
              %slice_10772 = cute.slice(%append_10759, %coord_10766) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10773 = cute.crd2idx(%coord_10766, %append_10759) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10774 = cute.add_offset(%iter_10751, %idx_10773) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10775 = cute.make_view(%ptr_10774, %slice_10772) : !memref_rmem_bf16_15
              %slice_10776 = cute.slice(%lay_10756, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10777 = cute.crd2idx(%coord_10767, %lay_10756) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10778 = cute.add_offset(%iter_10752, %idx_10777) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10779 = cute.make_view(%ptr_10778, %slice_10776) : !memref_rmem_f32_3
              %slice_10780 = cute.slice(%lay_10757, %coord_10767) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10781 = cute.crd2idx(%coord_10767, %lay_10757) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10782 = cute.add_offset(%iter_10753, %idx_10781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10783 = cute.make_view(%ptr_10782, %slice_10780) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10783, %view_10771, %view_10775, %view_10779) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        scf.yield %2512, %arg7, %2512, %arg9, %arg10, %arg11, %arg12 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32
      }
      %iter_6937 = cute.get_iter(%2123#3) : !memref_gmem_bf16_
      %lay_6938 = cute.get_layout(%2123#3) : !memref_gmem_bf16_
      %2124 = cute.get_shape(%lay_6938) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6939, %e1_6940, %e2_6941, %e3_6942 = cute.get_leaves(%2124) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6943 = cute.to_int_tuple(%e0_6939) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2125 = cute.get_scalars(%itup_6943) : !cute.int_tuple<"?">
      %itup_6944 = cute.to_int_tuple(%e1_6940) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2126 = cute.get_scalars(%itup_6944) : !cute.int_tuple<"?">
      %itup_6945 = cute.to_int_tuple(%e2_6941) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2127 = cute.get_scalars(%itup_6945) : !cute.int_tuple<"?">
      %itup_6946 = cute.to_int_tuple(%e3_6942) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2128 = cute.get_scalars(%itup_6946) : !cute.int_tuple<"?{div=8}">
      %2129 = cute.get_stride(%lay_6938) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_6947, %e1_6948, %e2_6949, %e3_6950 = cute.get_leaves(%2129) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_6951 = cute.to_int_tuple(%e0_6947) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2130 = cute.get_scalars(%itup_6951) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6952 = cute.to_int_tuple(%e1_6948) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2131 = cute.get_scalars(%itup_6952) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6953 = cute.to_int_tuple(%e2_6949) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2132 = cute.get_scalars(%itup_6953) : !cute.int_tuple<"?{i64 div=8}">
      %iter_6954 = cute.get_iter(%2123#4) : !memref_gmem_bf16_
      %lay_6955 = cute.get_layout(%2123#4) : !memref_gmem_bf16_
      %2133 = cute.get_shape(%lay_6955) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6956, %e1_6957, %e2_6958, %e3_6959 = cute.get_leaves(%2133) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6960 = cute.to_int_tuple(%e0_6956) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2134 = cute.get_scalars(%itup_6960) : !cute.int_tuple<"?">
      %itup_6961 = cute.to_int_tuple(%e1_6957) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2135 = cute.get_scalars(%itup_6961) : !cute.int_tuple<"?">
      %itup_6962 = cute.to_int_tuple(%e2_6958) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2136 = cute.get_scalars(%itup_6962) : !cute.int_tuple<"?">
      %itup_6963 = cute.to_int_tuple(%e3_6959) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2137 = cute.get_scalars(%itup_6963) : !cute.int_tuple<"?{div=8}">
      %2138 = cute.get_stride(%lay_6955) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_6964, %e1_6965, %e2_6966, %e3_6967 = cute.get_leaves(%2138) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_6968 = cute.to_int_tuple(%e0_6964) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2139 = cute.get_scalars(%itup_6968) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6969 = cute.to_int_tuple(%e1_6965) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2140 = cute.get_scalars(%itup_6969) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6970 = cute.to_int_tuple(%e2_6966) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2141 = cute.get_scalars(%itup_6970) : !cute.int_tuple<"?{i64 div=8}">
      %iter_6971 = cute.get_iter(%2123#3) : !memref_gmem_bf16_
      %iter_6972 = cute.get_iter(%2123#3) : !memref_gmem_bf16_
      %iter_6973 = cute.get_iter(%2123#4) : !memref_gmem_bf16_
      %iter_6974 = cute.get_iter(%2123#4) : !memref_gmem_bf16_
      %lay_6975 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2142 = cute.get_shape(%lay_6975) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6976, %e1_6977, %e2_6978, %e3_6979 = cute.get_leaves(%2142) : !cute.shape<"((2,2),2,16)">
      %shape_6980 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_6981 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %2143 = cute.get_shape(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6982, %e1_6983, %e2_6984, %e3_6985 = cute.get_leaves(%2143) : !cute.shape<"((2,2),2,16)">
      %2144 = cute.get_shape(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6986, %e1_6987, %e2_6988, %e3_6989 = cute.get_leaves(%2144) : !cute.shape<"((2,2),2,16)">
      %2145 = cute.get_shape(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6990, %e1_6991, %e2_6992, %e3_6993 = cute.get_leaves(%2145) : !cute.shape<"((2,2),2,16)">
      %2146 = cute.get_shape(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6994, %e1_6995, %e2_6996, %e3_6997 = cute.get_leaves(%2146) : !cute.shape<"((2,2),2,16)">
      %2147 = cute.get_stride(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_6998, %e1_6999, %e2_7000, %e3_7001 = cute.get_leaves(%2147) : !cute.stride<"((1,2),4,8)">
      %2148 = cute.get_stride(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7002, %e1_7003, %e2_7004, %e3_7005 = cute.get_leaves(%2148) : !cute.stride<"((1,2),4,8)">
      %2149 = cute.get_stride(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7006, %e1_7007, %e2_7008, %e3_7009 = cute.get_leaves(%2149) : !cute.stride<"((1,2),4,8)">
      %2150 = cute.get_stride(%lay_6981) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_7010, %e1_7011, %e2_7012, %e3_7013 = cute.get_leaves(%2150) : !cute.stride<"((1,2),4,8)">
      %shape_7014 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_7015 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_7016 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_7017 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_7018 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_7019 = cute.make_view(%iter_322, %lay_7018) : !memref_rmem_f32_5
      %iter_7020 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %lay_7021 = cute.get_layout(%rmem_1080) : !memref_rmem_f32_1
      %sz_7022 = cute.size(%lay_7021) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_7023 = cute.get_leaves(%sz_7022) : !cute.int_tuple<"4">
      %coord_7024 = cute.make_coord() : () -> !cute.coord<"0">
      %2151 = cute.memref.load(%rmem_1080, %coord_7024) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %c-1_i32_7025 = arith.constant -1 : i32
      %c2_i32_7026 = arith.constant 2 : i32
      %c31_i32_7027 = arith.constant 31 : i32
      %2152 = nvvm.shfl.sync  bfly %c-1_i32_7025, %2151, %c2_i32_7026, %c31_i32_7027 : f32 -> f32
      %2153 = arith.addf %2151, %2152 : f32
      %c-1_i32_7028 = arith.constant -1 : i32
      %c1_i32_7029 = arith.constant 1 : i32
      %c31_i32_7030 = arith.constant 31 : i32
      %2154 = nvvm.shfl.sync  bfly %c-1_i32_7028, %2153, %c1_i32_7029, %c31_i32_7030 : f32 -> f32
      %2155 = arith.addf %2153, %2154 : f32
      %coord_7031 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1080, %coord_7031, %2155) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_7032 = cute.make_coord() : () -> !cute.coord<"0">
      %2156 = cute.memref.load(%rmem_1080, %coord_7032) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %cst_7033 = arith.constant 0.000000e+00 : f32
      %2157 = arith.cmpf oeq, %2156, %cst_7033 : f32
      %coord_7034 = cute.make_coord() : () -> !cute.coord<"0">
      %2158 = cute.memref.load(%rmem_1080, %coord_7034) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2159 = arith.cmpf oeq, %2158, %cst_7033 : f32
      %coord_7035 = cute.make_coord() : () -> !cute.coord<"0">
      %2160 = cute.memref.load(%rmem_1080, %coord_7035) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %coord_7036 = cute.make_coord() : () -> !cute.coord<"0">
      %2161 = cute.memref.load(%rmem_1080, %coord_7036) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2162 = arith.cmpf une, %2160, %2161 : f32
      %2163 = arith.extui %2159 : i1 to i32
      %c0_i32_7037 = arith.constant 0 : i32
      %2164 = arith.cmpi ne, %2163, %c0_i32_7037 : i32
      %2165 = arith.extui %2159 : i1 to i32
      %2166 = arith.extui %2162 : i1 to i32
      %2167 = arith.select %2164, %2165, %2166 : i32
      %c0_i32_7038 = arith.constant 0 : i32
      %2168 = arith.cmpi ne, %2167, %c0_i32_7038 : i32
      %coord_7039 = cute.make_coord() : () -> !cute.coord<"0">
      %2169 = cute.memref.load(%rmem_1080, %coord_7039) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2170 = nvvm.rcp.approx.ftz.f %2169 : f32
      %cst_7040 = arith.constant 1.000000e+00 : f32
      %2171 = arith.select %2168, %cst_7040, %2170 : f32
      %coord_7041 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7042 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7043 = cute.crd2idx(%coord_7041, %lay_7042) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7044 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7045 = cute.add_offset(%iter_7044, %idx_7043) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7046 = cute.make_view(%ptr_7045) : !memref_rmem_f32_10
      %iter_7047 = cute.get_iter(%view_7046) : !memref_rmem_f32_10
      %iter_7048 = cute.get_iter(%view_7046) : !memref_rmem_f32_10
      %lay_7049 = cute.get_layout(%view_7046) : !memref_rmem_f32_10
      %2172 = cute.get_shape(%lay_7049) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7050, %e1_7051 = cute.get_leaves(%2172) : !cute.shape<"((2,16))">
      %2173 = cute.memref.load_vec %view_7046 : !memref_rmem_f32_10
      %2174 = vector.broadcast %2171 : f32 to vector<32xf32>
      %2175 = arith.mulf %2173, %2174 : vector<32xf32>
      %coord_7052 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_7053 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7054 = cute.crd2idx(%coord_7052, %lay_7053) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_7055 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7056 = cute.add_offset(%iter_7055, %idx_7054) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_7057 = cute.make_view(%ptr_7056) : !memref_rmem_f32_10
      %iter_7058 = cute.get_iter(%view_7057) : !memref_rmem_f32_10
      %iter_7059 = cute.get_iter(%view_7057) : !memref_rmem_f32_10
      %lay_7060 = cute.get_layout(%view_7057) : !memref_rmem_f32_10
      %2176 = cute.get_shape(%lay_7060) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7061, %e1_7062 = cute.get_leaves(%2176) : !cute.shape<"((2,16))">
      %int_tuple_7063 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7064 = cute.size(%int_tuple_7063) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7065 = cute.get_leaves(%sz_7064) : !cute.int_tuple<"32">
      %int_tuple_7066 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7067 = cute.size(%int_tuple_7066) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7068 = cute.get_leaves(%sz_7067) : !cute.int_tuple<"32">
      cute.memref.store_vec %2175, %view_7057 : !memref_rmem_f32_10
      %coord_7069 = cute.make_coord() : () -> !cute.coord<"1">
      %2177 = cute.memref.load(%rmem_1080, %coord_7069) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %c-1_i32_7070 = arith.constant -1 : i32
      %c2_i32_7071 = arith.constant 2 : i32
      %c31_i32_7072 = arith.constant 31 : i32
      %2178 = nvvm.shfl.sync  bfly %c-1_i32_7070, %2177, %c2_i32_7071, %c31_i32_7072 : f32 -> f32
      %2179 = arith.addf %2177, %2178 : f32
      %c-1_i32_7073 = arith.constant -1 : i32
      %c1_i32_7074 = arith.constant 1 : i32
      %c31_i32_7075 = arith.constant 31 : i32
      %2180 = nvvm.shfl.sync  bfly %c-1_i32_7073, %2179, %c1_i32_7074, %c31_i32_7075 : f32 -> f32
      %2181 = arith.addf %2179, %2180 : f32
      %coord_7076 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1080, %coord_7076, %2181) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_7077 = cute.make_coord() : () -> !cute.coord<"1">
      %2182 = cute.memref.load(%rmem_1080, %coord_7077) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2183 = arith.cmpf oeq, %2182, %cst_7033 : f32
      %coord_7078 = cute.make_coord() : () -> !cute.coord<"1">
      %2184 = cute.memref.load(%rmem_1080, %coord_7078) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2185 = arith.cmpf oeq, %2184, %cst_7033 : f32
      %coord_7079 = cute.make_coord() : () -> !cute.coord<"1">
      %2186 = cute.memref.load(%rmem_1080, %coord_7079) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %coord_7080 = cute.make_coord() : () -> !cute.coord<"1">
      %2187 = cute.memref.load(%rmem_1080, %coord_7080) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2188 = arith.cmpf une, %2186, %2187 : f32
      %2189 = arith.extui %2185 : i1 to i32
      %2190 = arith.cmpi ne, %2189, %c0_i32_7037 : i32
      %2191 = arith.extui %2185 : i1 to i32
      %2192 = arith.extui %2188 : i1 to i32
      %2193 = arith.select %2190, %2191, %2192 : i32
      %2194 = arith.cmpi ne, %2193, %c0_i32_7038 : i32
      %coord_7081 = cute.make_coord() : () -> !cute.coord<"1">
      %2195 = cute.memref.load(%rmem_1080, %coord_7081) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2196 = nvvm.rcp.approx.ftz.f %2195 : f32
      %2197 = arith.select %2194, %cst_7040, %2196 : f32
      %coord_7082 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7083 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7084 = cute.crd2idx(%coord_7082, %lay_7083) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7085 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7086 = cute.add_offset(%iter_7085, %idx_7084) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7087 = cute.make_view(%ptr_7086) : !memref_rmem_f32_11
      %iter_7088 = cute.get_iter(%view_7087) : !memref_rmem_f32_11
      %iter_7089 = cute.get_iter(%view_7087) : !memref_rmem_f32_11
      %lay_7090 = cute.get_layout(%view_7087) : !memref_rmem_f32_11
      %2198 = cute.get_shape(%lay_7090) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7091, %e1_7092 = cute.get_leaves(%2198) : !cute.shape<"((2,16))">
      %2199 = cute.memref.load_vec %view_7087 : !memref_rmem_f32_11
      %2200 = vector.broadcast %2197 : f32 to vector<32xf32>
      %2201 = arith.mulf %2199, %2200 : vector<32xf32>
      %coord_7093 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_7094 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7095 = cute.crd2idx(%coord_7093, %lay_7094) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_7096 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7097 = cute.add_offset(%iter_7096, %idx_7095) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7098 = cute.make_view(%ptr_7097) : !memref_rmem_f32_11
      %iter_7099 = cute.get_iter(%view_7098) : !memref_rmem_f32_11
      %iter_7100 = cute.get_iter(%view_7098) : !memref_rmem_f32_11
      %lay_7101 = cute.get_layout(%view_7098) : !memref_rmem_f32_11
      %2202 = cute.get_shape(%lay_7101) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7102, %e1_7103 = cute.get_leaves(%2202) : !cute.shape<"((2,16))">
      %int_tuple_7104 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7105 = cute.size(%int_tuple_7104) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7106 = cute.get_leaves(%sz_7105) : !cute.int_tuple<"32">
      %int_tuple_7107 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7108 = cute.size(%int_tuple_7107) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7109 = cute.get_leaves(%sz_7108) : !cute.int_tuple<"32">
      cute.memref.store_vec %2201, %view_7098 : !memref_rmem_f32_11
      %coord_7110 = cute.make_coord() : () -> !cute.coord<"2">
      %2203 = cute.memref.load(%rmem_1080, %coord_7110) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %c-1_i32_7111 = arith.constant -1 : i32
      %c2_i32_7112 = arith.constant 2 : i32
      %c31_i32_7113 = arith.constant 31 : i32
      %2204 = nvvm.shfl.sync  bfly %c-1_i32_7111, %2203, %c2_i32_7112, %c31_i32_7113 : f32 -> f32
      %2205 = arith.addf %2203, %2204 : f32
      %c-1_i32_7114 = arith.constant -1 : i32
      %c1_i32_7115 = arith.constant 1 : i32
      %c31_i32_7116 = arith.constant 31 : i32
      %2206 = nvvm.shfl.sync  bfly %c-1_i32_7114, %2205, %c1_i32_7115, %c31_i32_7116 : f32 -> f32
      %2207 = arith.addf %2205, %2206 : f32
      %coord_7117 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1080, %coord_7117, %2207) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_7118 = cute.make_coord() : () -> !cute.coord<"2">
      %2208 = cute.memref.load(%rmem_1080, %coord_7118) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2209 = arith.cmpf oeq, %2208, %cst_7033 : f32
      %coord_7119 = cute.make_coord() : () -> !cute.coord<"2">
      %2210 = cute.memref.load(%rmem_1080, %coord_7119) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2211 = arith.cmpf oeq, %2210, %cst_7033 : f32
      %coord_7120 = cute.make_coord() : () -> !cute.coord<"2">
      %2212 = cute.memref.load(%rmem_1080, %coord_7120) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %coord_7121 = cute.make_coord() : () -> !cute.coord<"2">
      %2213 = cute.memref.load(%rmem_1080, %coord_7121) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2214 = arith.cmpf une, %2212, %2213 : f32
      %2215 = arith.extui %2211 : i1 to i32
      %2216 = arith.cmpi ne, %2215, %c0_i32_7037 : i32
      %2217 = arith.extui %2211 : i1 to i32
      %2218 = arith.extui %2214 : i1 to i32
      %2219 = arith.select %2216, %2217, %2218 : i32
      %2220 = arith.cmpi ne, %2219, %c0_i32_7038 : i32
      %coord_7122 = cute.make_coord() : () -> !cute.coord<"2">
      %2221 = cute.memref.load(%rmem_1080, %coord_7122) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2222 = nvvm.rcp.approx.ftz.f %2221 : f32
      %2223 = arith.select %2220, %cst_7040, %2222 : f32
      %coord_7123 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7124 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7125 = cute.crd2idx(%coord_7123, %lay_7124) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7126 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7127 = cute.add_offset(%iter_7126, %idx_7125) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7128 = cute.make_view(%ptr_7127) : !memref_rmem_f32_12
      %iter_7129 = cute.get_iter(%view_7128) : !memref_rmem_f32_12
      %iter_7130 = cute.get_iter(%view_7128) : !memref_rmem_f32_12
      %lay_7131 = cute.get_layout(%view_7128) : !memref_rmem_f32_12
      %2224 = cute.get_shape(%lay_7131) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7132, %e1_7133 = cute.get_leaves(%2224) : !cute.shape<"((2,16))">
      %2225 = cute.memref.load_vec %view_7128 : !memref_rmem_f32_12
      %2226 = vector.broadcast %2223 : f32 to vector<32xf32>
      %2227 = arith.mulf %2225, %2226 : vector<32xf32>
      %coord_7134 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7135 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7136 = cute.crd2idx(%coord_7134, %lay_7135) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7137 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7138 = cute.add_offset(%iter_7137, %idx_7136) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7139 = cute.make_view(%ptr_7138) : !memref_rmem_f32_12
      %iter_7140 = cute.get_iter(%view_7139) : !memref_rmem_f32_12
      %iter_7141 = cute.get_iter(%view_7139) : !memref_rmem_f32_12
      %lay_7142 = cute.get_layout(%view_7139) : !memref_rmem_f32_12
      %2228 = cute.get_shape(%lay_7142) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7143, %e1_7144 = cute.get_leaves(%2228) : !cute.shape<"((2,16))">
      %int_tuple_7145 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7146 = cute.size(%int_tuple_7145) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7147 = cute.get_leaves(%sz_7146) : !cute.int_tuple<"32">
      %int_tuple_7148 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7149 = cute.size(%int_tuple_7148) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7150 = cute.get_leaves(%sz_7149) : !cute.int_tuple<"32">
      cute.memref.store_vec %2227, %view_7139 : !memref_rmem_f32_12
      %coord_7151 = cute.make_coord() : () -> !cute.coord<"3">
      %2229 = cute.memref.load(%rmem_1080, %coord_7151) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %c-1_i32_7152 = arith.constant -1 : i32
      %c2_i32_7153 = arith.constant 2 : i32
      %c31_i32_7154 = arith.constant 31 : i32
      %2230 = nvvm.shfl.sync  bfly %c-1_i32_7152, %2229, %c2_i32_7153, %c31_i32_7154 : f32 -> f32
      %2231 = arith.addf %2229, %2230 : f32
      %c-1_i32_7155 = arith.constant -1 : i32
      %c1_i32_7156 = arith.constant 1 : i32
      %c31_i32_7157 = arith.constant 31 : i32
      %2232 = nvvm.shfl.sync  bfly %c-1_i32_7155, %2231, %c1_i32_7156, %c31_i32_7157 : f32 -> f32
      %2233 = arith.addf %2231, %2232 : f32
      %coord_7158 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1080, %coord_7158, %2233) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_7159 = cute.make_coord() : () -> !cute.coord<"3">
      %2234 = cute.memref.load(%rmem_1080, %coord_7159) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2235 = arith.cmpf oeq, %2234, %cst_7033 : f32
      %coord_7160 = cute.make_coord() : () -> !cute.coord<"3">
      %2236 = cute.memref.load(%rmem_1080, %coord_7160) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2237 = arith.cmpf oeq, %2236, %cst_7033 : f32
      %coord_7161 = cute.make_coord() : () -> !cute.coord<"3">
      %2238 = cute.memref.load(%rmem_1080, %coord_7161) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %coord_7162 = cute.make_coord() : () -> !cute.coord<"3">
      %2239 = cute.memref.load(%rmem_1080, %coord_7162) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2240 = arith.cmpf une, %2238, %2239 : f32
      %2241 = arith.extui %2237 : i1 to i32
      %2242 = arith.cmpi ne, %2241, %c0_i32_7037 : i32
      %2243 = arith.extui %2237 : i1 to i32
      %2244 = arith.extui %2240 : i1 to i32
      %2245 = arith.select %2242, %2243, %2244 : i32
      %2246 = arith.cmpi ne, %2245, %c0_i32_7038 : i32
      %coord_7163 = cute.make_coord() : () -> !cute.coord<"3">
      %2247 = cute.memref.load(%rmem_1080, %coord_7163) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2248 = nvvm.rcp.approx.ftz.f %2247 : f32
      %2249 = arith.select %2246, %cst_7040, %2248 : f32
      %coord_7164 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7165 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7166 = cute.crd2idx(%coord_7164, %lay_7165) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7167 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7168 = cute.add_offset(%iter_7167, %idx_7166) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7169 = cute.make_view(%ptr_7168) : !memref_rmem_f32_11
      %iter_7170 = cute.get_iter(%view_7169) : !memref_rmem_f32_11
      %iter_7171 = cute.get_iter(%view_7169) : !memref_rmem_f32_11
      %lay_7172 = cute.get_layout(%view_7169) : !memref_rmem_f32_11
      %2250 = cute.get_shape(%lay_7172) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7173, %e1_7174 = cute.get_leaves(%2250) : !cute.shape<"((2,16))">
      %2251 = cute.memref.load_vec %view_7169 : !memref_rmem_f32_11
      %2252 = vector.broadcast %2249 : f32 to vector<32xf32>
      %2253 = arith.mulf %2251, %2252 : vector<32xf32>
      %coord_7175 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7176 = cute.get_layout(%view_7019) : !memref_rmem_f32_5
      %idx_7177 = cute.crd2idx(%coord_7175, %lay_7176) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7178 = cute.get_iter(%view_7019) : !memref_rmem_f32_5
      %ptr_7179 = cute.add_offset(%iter_7178, %idx_7177) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7180 = cute.make_view(%ptr_7179) : !memref_rmem_f32_11
      %iter_7181 = cute.get_iter(%view_7180) : !memref_rmem_f32_11
      %iter_7182 = cute.get_iter(%view_7180) : !memref_rmem_f32_11
      %lay_7183 = cute.get_layout(%view_7180) : !memref_rmem_f32_11
      %2254 = cute.get_shape(%lay_7183) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7184, %e1_7185 = cute.get_leaves(%2254) : !cute.shape<"((2,16))">
      %int_tuple_7186 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7187 = cute.size(%int_tuple_7186) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7188 = cute.get_leaves(%sz_7187) : !cute.int_tuple<"32">
      %int_tuple_7189 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7190 = cute.size(%int_tuple_7189) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7191 = cute.get_leaves(%sz_7190) : !cute.int_tuple<"32">
      cute.memref.store_vec %2253, %view_7180 : !memref_rmem_f32_11
      %lay_7192 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2255 = cute.make_layout_like(%lay_7192) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> to !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_7193 = cute.memref.alloca(%2255) : !memref_rmem_bf16_23
      %iter_7194 = cute.get_iter(%rmem_7193) : !memref_rmem_bf16_23
      %iter_7195 = cute.get_iter(%rmem_7193) : !memref_rmem_bf16_23
      %lay_7196 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2256 = cute.get_shape(%lay_7196) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7197, %e1_7198, %e2_7199, %e3_7200 = cute.get_leaves(%2256) : !cute.shape<"((2,2),2,16)">
      %2257 = cute.memref.load_vec %rmem : !memref_rmem_f32_
      %2258 = arith.truncf %2257 : vector<128xf32> to vector<128xbf16>
      %lay_7201 = cute.get_layout(%rmem_7193) : !memref_rmem_bf16_23
      %2259 = cute.get_shape(%lay_7201) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7202, %e1_7203, %e2_7204, %e3_7205 = cute.get_leaves(%2259) : !cute.shape<"((2,2),2,16)">
      %int_tuple_7206 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7207 = cute.size(%int_tuple_7206) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7208 = cute.get_leaves(%sz_7207) : !cute.int_tuple<"128">
      %int_tuple_7209 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7210 = cute.size(%int_tuple_7209) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7211 = cute.get_leaves(%sz_7210) : !cute.int_tuple<"128">
      cute.memref.store_vec %2258, %rmem_7193 : !memref_rmem_bf16_23
      %view_7212 = cute.make_view(%iter_274, %2) : !memref_smem_bf16_
      %iter_7213 = cute.get_iter(%view_7212) : !memref_smem_bf16_
      %atom_7214 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %2260 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %2261 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7215, %e1_7216, %e2_7217 = cute.get_leaves(%2261) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7218 = cute.size(%e0_7215) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_7219 = cute.get_leaves(%sz_7218) : !cute.int_tuple<"64">
      %2262 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7220, %e1_7221, %e2_7222 = cute.get_leaves(%2262) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7223 = cute.size(%e1_7221) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_7224 = cute.get_leaves(%sz_7223) : !cute.int_tuple<"16">
      %tile_7225 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %2263 = cute.make_tiled_copy(%atom_7214) : !copy_simt1
      %retiled_7226 = cute.tiled.copy.retile(%2263, %rmem_7193) : (!copy_simt1, !memref_rmem_bf16_23) -> !memref_rmem_bf16_24
      %iter_7227 = cute.get_iter(%retiled_7226) : !memref_rmem_bf16_24
      %coord_7228 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7229 = cute.tiled.copy.partition_D(%2263, %view_7212, %coord_7228) : (!copy_simt1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_21
      %iter_7230 = cute.get_iter(%dst_partitioned_7229) : !memref_smem_bf16_21
      %lay_7231 = cute.get_layout(%retiled_7226) : !memref_rmem_bf16_24
      %2264 = cute.get_shape(%lay_7231) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7232, %e1_7233, %e2_7234, %e3_7235, %e4_7236 = cute.get_leaves(%2264) : !cute.shape<"((1,(4,2)),2,8)">
      %lay_7237 = cute.get_layout(%dst_partitioned_7229) : !memref_smem_bf16_21
      %2265 = cute.get_shape(%lay_7237) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7238, %e1_7239, %e2_7240, %e3_7241, %e4_7242, %e5_7243, %e6, %e7 = cute.get_leaves(%2265) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %lay_7244 = cute.get_layout(%retiled_7226) : !memref_rmem_bf16_24
      %shape_7245 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7246 = cute.make_layout() : !cute.layout<"1:0">
      %append_7247 = cute.append_to_rank<2> (%lay_7244, %lay_7246) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0">
      %view_7248 = cute.make_view(%iter_7227, %append_7247) : !memref_rmem_bf16_24
      %iter_7249 = cute.get_iter(%view_7248) : !memref_rmem_bf16_24
      %lay_7250 = cute.get_layout(%view_7248) : !memref_rmem_bf16_24
      %2266 = cute.get_shape(%lay_7250) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7251, %e1_7252, %e2_7253, %e3_7254, %e4_7255 = cute.get_leaves(%2266) : !cute.shape<"((1,(4,2)),2,8)">
      %iter_7256 = cute.get_iter(%view_7248) : !memref_rmem_bf16_24
      %view_7257 = cute.make_view(%iter_7256) : !memref_rmem_bf16_25
      %iter_7258 = cute.get_iter(%view_7257) : !memref_rmem_bf16_25
      %iter_7259 = cute.get_iter(%view_7257) : !memref_rmem_bf16_25
      %lay_7260 = cute.get_layout(%dst_partitioned_7229) : !memref_smem_bf16_21
      %shape_7261 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7262 = cute.make_layout() : !cute.layout<"1:0">
      %append_7263 = cute.append_to_rank<2> (%lay_7260, %lay_7262) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0">
      %view_7264 = cute.make_view(%iter_7230, %append_7263) : !memref_smem_bf16_21
      %iter_7265 = cute.get_iter(%view_7264) : !memref_smem_bf16_21
      %lay_7266 = cute.get_layout(%view_7264) : !memref_smem_bf16_21
      %2267 = cute.get_shape(%lay_7266) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7267, %e1_7268, %e2_7269, %e3_7270, %e4_7271, %e5_7272, %e6_7273, %e7_7274 = cute.get_leaves(%2267) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iter_7275 = cute.get_iter(%view_7264) : !memref_smem_bf16_21
      %lay_7276 = cute.get_layout(%view_7264) : !memref_smem_bf16_21
      %2268:3 = cute.get_scalars(%lay_7276) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %shape_7277 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %iv_7278 = cute.assume(%2268#0) : (i32) -> !cute.i32<divby 8>
      %iv_7279 = cute.assume(%2268#1) : (i32) -> !cute.i32<divby 16>
      %iv_7280 = cute.assume(%2268#2) : (i32) -> !cute.i32<divby 32>
      %stride_7281 = cute.make_stride(%iv_7278, %iv_7279, %iv_7280) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %lay_7282 = cute.make_layout(%shape_7277, %stride_7281) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %view_7283 = cute.make_view(%iter_7275, %lay_7282) : !memref_smem_bf16_22
      %iter_7284 = cute.get_iter(%view_7283) : !memref_smem_bf16_22
      %iter_7285 = cute.get_iter(%view_7283) : !memref_smem_bf16_22
      %lay_7286 = cute.get_layout(%view_7257) : !memref_rmem_bf16_25
      %2269 = cute.get_shape(%lay_7286) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))">
      %e0_7287, %e1_7288, %e2_7289, %e3_7290, %e4_7291 = cute.get_leaves(%2269) : !cute.shape<"((1,(4,2)),(2,8))">
      %lay_7292 = cute.get_layout(%view_7283) : !memref_smem_bf16_22
      %2270 = cute.get_shape(%lay_7292) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %e0_7293, %e1_7294, %e2_7295, %e3_7296, %e4_7297, %e5_7298, %e6_7299, %e7_7300 = cute.get_leaves(%2270) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %lay_7301 = cute.get_layout(%view_7257) : !memref_rmem_bf16_25
      %sz_7302 = cute.size(%lay_7301) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.int_tuple<"16">
      %e0_7303 = cute.get_leaves(%sz_7302) : !cute.int_tuple<"16">
      %lay_7304 = cute.get_layout(%view_7283) : !memref_smem_bf16_22
      %sz_7305 = cute.size(%lay_7304) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.int_tuple<"16">
      %e0_7306 = cute.get_leaves(%sz_7305) : !cute.int_tuple<"16">
      %2271 = cute.static : !cute.layout<"1:0">
      %iter_7307 = cute.get_iter(%view_7257) : !memref_rmem_bf16_25
      %iter_7308 = cute.get_iter(%view_7283) : !memref_smem_bf16_22
      %lay_7309 = cute.get_layout(%view_7257) : !memref_rmem_bf16_25
      %lay_7310 = cute.get_layout(%view_7283) : !memref_smem_bf16_22
      %append_7311 = cute.append_to_rank<2> (%lay_7309, %2271) : !cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">, !cute.layout<"1:0">
      %append_7312 = cute.append_to_rank<2> (%lay_7310, %2271) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">, !cute.layout<"1:0">
      %lay_7313 = cute.make_layout() : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">
      %2272:3 = cute.get_scalars(%append_7312) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %shape_7314 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),((2,((2,2),2))))">
      %iv_7315 = cute.assume(%2272#0) : (i32) -> !cute.i32<divby 8>
      %iv_7316 = cute.assume(%2272#1) : (i32) -> !cute.i32<divby 16>
      %iv_7317 = cute.assume(%2272#2) : (i32) -> !cute.i32<divby 32>
      %stride_7318 = cute.make_stride(%iv_7315, %iv_7316, %iv_7317) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %lay_7319 = cute.make_layout(%shape_7314, %stride_7318) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %sz_7320 = cute.size(%lay_7313) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"16">
      %2273 = cute.get_scalars(%sz_7320) : !cute.int_tuple<"16">
      %c0_i32_7321 = arith.constant 0 : i32
      %c1_i32_7322 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7321 to %2273 step %c1_i32_7322  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_7313, %coord_7829) : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7313) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"?{div=4}">
        %ptr_7832 = cute.add_offset(%iter_7307, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_rmem_bf16_26
        %slice_7834 = cute.slice(%lay_7319, %coord_7829) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_7319) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7836 = cute.add_offset(%iter_7308, %idx_7835) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_smem_bf16_23
        cute.copy_atom_call(%atom_7214, %view_7833, %view_7837) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_26, !memref_smem_bf16_23) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7323 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_7324 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %slice_7325 = cute.slice(%lay_7324, %coord_7323) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_7326 = cute.crd2idx(%coord_7323, %lay_7324) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_7327 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_7328 = cute.add_offset(%iter_7327, %idx_7326) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7329 = cute.make_view(%ptr_7328, %slice_7325) : !memref_gmem_bf16_1
      %iter_7330 = cute.get_iter(%view_7329) : !memref_gmem_bf16_1
      %iter_7331 = cute.get_iter(%view_7329) : !memref_gmem_bf16_1
      %tile_7332 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_7333 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %2274 = cute.get_scalars(%coord_7333) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_7334 = cute.make_coord(%2274) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_7335 = cute.get_layout(%view_7329) : !memref_gmem_bf16_1
      %2275:3 = cute.get_scalars(%lay_7335) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32_7336 = arith.constant 128 : i32
      %2276 = arith.ceildivsi %2275#0, %c128_i32_7336 : i32
      %c128_i64_7337 = arith.constant 128 : i64
      %2277 = arith.muli %2275#2, %c128_i64_7337 : i64
      %c128_i32_7338 = arith.constant 128 : i32
      %2278 = arith.ceildivsi %2275#1, %c128_i32_7338 : i32
      %shape_7339 = cute.make_shape(%2276, %2278) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_7340 = cute.assume(%2275#2) : (i64) -> !cute.i64<divby 8>
      %iv_7341 = cute.assume(%2277) : (i64) -> !cute.i64<divby 1024>
      %stride_7342 = cute.make_stride(%iv_7340, %iv_7341) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_7343 = cute.make_layout(%shape_7339, %stride_7342) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %slice_7344 = cute.slice(%lay_7343, %coord_7334) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_7345 = cute.crd2idx(%coord_7334, %lay_7343) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_7346 = cute.get_iter(%view_7329) : !memref_gmem_bf16_1
      %ptr_7347 = cute.add_offset(%iter_7346, %idx_7345) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7348 = cute.make_view(%ptr_7347, %slice_7344) : !memref_gmem_bf16_2
      %iter_7349 = cute.get_iter(%view_7348) : !memref_gmem_bf16_2
      %coord_7350 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_7351 = cute.tiled.copy.partition_S(%4, %view_7212, %coord_7350) : (!copy_simt, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_7352 = cute.get_iter(%src_partitioned_7351) : !memref_smem_bf16_3
      %coord_7353 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7354 = cute.tiled.copy.partition_D(%4, %view_7348, %coord_7353) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_7355 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
      %lay_7356 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
      %2279 = cute.make_layout_like(%lay_7356) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),8,2):((1,0),16,8)">
      %rmem_7357 = cute.memref.alloca(%2279) : !memref_rmem_bf16_27
      %iter_7358 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
      %iter_7359 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
      %c1_i32_7360 = arith.constant 1 : i32
      %c128_i32_7361 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_7360 number_of_threads = %c128_i32_7361
      %lay_7362 = cute.get_layout(%src_partitioned_7351) : !memref_smem_bf16_3
      %2280 = cute.get_shape(%lay_7362) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7363, %e1_7364, %e2_7365, %e3_7366 = cute.get_leaves(%2280) : !cute.shape<"((8,1),8,2)">
      %lay_7367 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
      %2281 = cute.get_shape(%lay_7367) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7368, %e1_7369, %e2_7370, %e3_7371 = cute.get_leaves(%2281) : !cute.shape<"((8,1),8,2)">
      %lay_7372 = cute.get_layout(%src_partitioned_7351) : !memref_smem_bf16_3
      %shape_7373 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7374 = cute.make_layout() : !cute.layout<"1:0">
      %append_7375 = cute.append_to_rank<2> (%lay_7372, %lay_7374) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0">
      %view_7376 = cute.make_view(%iter_7352, %append_7375) : !memref_smem_bf16_3
      %iter_7377 = cute.get_iter(%view_7376) : !memref_smem_bf16_3
      %lay_7378 = cute.get_layout(%view_7376) : !memref_smem_bf16_3
      %2282 = cute.get_shape(%lay_7378) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7379, %e1_7380, %e2_7381, %e3_7382 = cute.get_leaves(%2282) : !cute.shape<"((8,1),8,2)">
      %iter_7383 = cute.get_iter(%view_7376) : !memref_smem_bf16_3
      %view_7384 = cute.make_view(%iter_7383) : !memref_smem_bf16_24
      %iter_7385 = cute.get_iter(%view_7384) : !memref_smem_bf16_24
      %iter_7386 = cute.get_iter(%view_7384) : !memref_smem_bf16_24
      %lay_7387 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
      %shape_7388 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7389 = cute.make_layout() : !cute.layout<"1:0">
      %append_7390 = cute.append_to_rank<2> (%lay_7387, %lay_7389) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_7391 = cute.make_view(%iter_7359, %append_7390) : !memref_rmem_bf16_27
      %iter_7392 = cute.get_iter(%view_7391) : !memref_rmem_bf16_27
      %lay_7393 = cute.get_layout(%view_7391) : !memref_rmem_bf16_27
      %2283 = cute.get_shape(%lay_7393) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7394, %e1_7395, %e2_7396, %e3_7397 = cute.get_leaves(%2283) : !cute.shape<"((8,1),8,2)">
      %iter_7398 = cute.get_iter(%view_7391) : !memref_rmem_bf16_27
      %view_7399 = cute.make_view(%iter_7398) : !memref_rmem_bf16_28
      %iter_7400 = cute.get_iter(%view_7399) : !memref_rmem_bf16_28
      %iter_7401 = cute.get_iter(%view_7399) : !memref_rmem_bf16_28
      %lay_7402 = cute.get_layout(%view_7384) : !memref_smem_bf16_24
      %2284 = cute.get_shape(%lay_7402) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_7403, %e1_7404, %e2_7405, %e3_7406 = cute.get_leaves(%2284) : !cute.shape<"((8,1),(8,2))">
      %lay_7407 = cute.get_layout(%view_7399) : !memref_rmem_bf16_28
      %2285 = cute.get_shape(%lay_7407) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_7408, %e1_7409, %e2_7410, %e3_7411 = cute.get_leaves(%2285) : !cute.shape<"((8,1),(8,2))">
      %lay_7412 = cute.get_layout(%view_7384) : !memref_smem_bf16_24
      %sz_7413 = cute.size(%lay_7412) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.int_tuple<"16">
      %e0_7414 = cute.get_leaves(%sz_7413) : !cute.int_tuple<"16">
      %lay_7415 = cute.get_layout(%view_7399) : !memref_rmem_bf16_28
      %sz_7416 = cute.size(%lay_7415) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.int_tuple<"16">
      %e0_7417 = cute.get_leaves(%sz_7416) : !cute.int_tuple<"16">
      %2286 = cute.static : !cute.layout<"1:0">
      %iter_7418 = cute.get_iter(%view_7384) : !memref_smem_bf16_24
      %iter_7419 = cute.get_iter(%view_7399) : !memref_rmem_bf16_28
      %lay_7420 = cute.get_layout(%view_7384) : !memref_smem_bf16_24
      %lay_7421 = cute.get_layout(%view_7399) : !memref_rmem_bf16_28
      %append_7422 = cute.append_to_rank<2> (%lay_7420, %2286) : !cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">, !cute.layout<"1:0">
      %append_7423 = cute.append_to_rank<2> (%lay_7421, %2286) : !cute.layout<"((8,1),(8,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_7424 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">
      %lay_7425 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">
      %sz_7426 = cute.size(%lay_7424) <{mode = [1]}> : (!cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"16">
      %2287 = cute.get_scalars(%sz_7426) : !cute.int_tuple<"16">
      %c0_i32_7427 = arith.constant 0 : i32
      %c1_i32_7428 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7427 to %2287 step %c1_i32_7428  : i32 {
        %coord_7829 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7830 = cute.slice(%lay_7424, %coord_7829) : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">, !cute.coord<"(_,?)">
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7424) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7832 = cute.add_offset(%iter_7418, %idx_7831) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_smem_bf16_13
        %slice_7834 = cute.slice(%lay_7425, %coord_7829) : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">, !cute.coord<"(_,?)">
        %idx_7835 = cute.crd2idx(%coord_7829, %lay_7425) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7836 = cute.add_offset(%iter_7419, %idx_7835) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7837 = cute.make_view(%ptr_7836, %slice_7834) : !memref_rmem_bf16_8
        cute.copy_atom_call(%4, %view_7833, %view_7837) : (!copy_simt, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_7429 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2288 = cute.get_shape(%lay_7429) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7430, %e1_7431, %e2_7432, %e3_7433 = cute.get_leaves(%2288) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7434 = cute.to_int_tuple(%e0_7430) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2289 = cute.get_scalars(%itup_7434) : !cute.int_tuple<"?">
      %itup_7435 = cute.to_int_tuple(%e1_7431) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2290 = cute.get_scalars(%itup_7435) : !cute.int_tuple<"?">
      %itup_7436 = cute.to_int_tuple(%e2_7432) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2291 = cute.get_scalars(%itup_7436) : !cute.int_tuple<"?">
      %itup_7437 = cute.to_int_tuple(%e3_7433) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2292 = cute.get_scalars(%itup_7437) : !cute.int_tuple<"?{div=8}">
      %shape_7438 = cute.make_shape(%itup_7434, %itup_7435, %itup_7436, %itup_7437) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %2293 = cute.make_identity_tensor(%shape_7438) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_7439 = cute.get_iter(%2293) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_7440, %e1_7441, %e2_7442, %e3_7443 = cute.get_leaves(%iter_7439) : !cute.int_tuple<"(0,0,0,0)">
      %coord_7444 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_7445 = cute.get_layout(%2293) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_7446 = cute.slice(%lay_7445, %coord_7444) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_7447 = cute.crd2idx(%coord_7444, %lay_7445) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_7448 = cute.get_iter(%2293) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_7449 = cute.add_offset(%iter_7448, %idx_7447) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_7450 = cute.make_view(%tup_7449, %slice_7446) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_7451 = cute.get_iter(%view_7450) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_7452, %e1_7453, %e2_7454, %e3_7455 = cute.get_leaves(%iter_7451) : !cute.int_tuple<"(?,0,?,0)">
      %2294 = cute.get_scalars(%e0_7452) : !cute.int_tuple<"?">
      %2295 = cute.get_scalars(%e2_7454) : !cute.int_tuple<"?">
      %iter_7456 = cute.get_iter(%view_7450) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_7457, %e1_7458, %e2_7459, %e3_7460 = cute.get_leaves(%iter_7456) : !cute.int_tuple<"(?,0,?,0)">
      %2296 = cute.get_scalars(%e0_7457) : !cute.int_tuple<"?">
      %2297 = cute.get_scalars(%e2_7459) : !cute.int_tuple<"?">
      %tile_7461 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_7462 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %2298 = cute.get_scalars(%coord_7462) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_7463 = cute.make_coord(%2298) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_7464 = cute.get_layout(%view_7450) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %2299:2 = cute.get_scalars(%lay_7464) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_7465 = arith.constant 128 : i32
      %2300 = arith.ceildivsi %2299#0, %c128_i32_7465 : i32
      %c128_i32_7466 = arith.constant 128 : i32
      %2301 = arith.ceildivsi %2299#1, %c128_i32_7466 : i32
      %shape_7467 = cute.make_shape(%2300, %2301) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_7468 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_7469 = cute.make_layout(%shape_7467, %stride_7468) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_7470 = cute.crd2idx(%coord_7463, %lay_7469) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_7471 = cute.get_iter(%view_7450) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_7472 = cute.add_offset(%iter_7471, %idx_7470) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_7473 = cute.make_view(%tup_7472) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_7474 = cute.get_iter(%view_7473) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_7475, %e1_7476, %e2_7477, %e3_7478 = cute.get_leaves(%iter_7474) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %2302 = cute.get_scalars(%e0_7475) : !cute.int_tuple<"?">
      %2303 = cute.get_scalars(%e1_7476) : !cute.int_tuple<"?{div=128}">
      %2304 = cute.get_scalars(%e2_7477) : !cute.int_tuple<"?">
      %coord_7479 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7480 = cute.tiled.copy.partition_D(%4, %view_7473, %coord_7479) : (!copy_simt, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_7481 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_7482, %e1_7483, %e2_7484, %e3_7485 = cute.get_leaves(%iter_7481) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2305 = cute.get_scalars(%e0_7482) : !cute.int_tuple<"?">
      %2306 = cute.get_scalars(%e1_7483) : !cute.int_tuple<"?">
      %2307 = cute.get_scalars(%e2_7484) : !cute.int_tuple<"?">
      %2308 = cute.get_scalars(%e3_7485) : !cute.int_tuple<"?{div=8}">
      %lay_7486 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
      %2309 = cute.get_shape(%lay_7486) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7487, %e1_7488, %e2_7489, %e3_7490 = cute.get_leaves(%2309) : !cute.shape<"((8,1),8,2)">
      %shape_7491 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_7492 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_7493 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_7494 = cute.memref.alloca(%lay_7493) : !memref_rmem_i8_
      %iter_7495 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
      %iter_7496 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
      %lay_7497 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
      %2310 = cute.get_shape(%lay_7497) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_7498, %e1_7499, %e2_7500 = cute.get_leaves(%2310) : !cute.shape<"(1,8,2)">
      %int_tuple_7501 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_7502 = cute.size(%int_tuple_7501) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_7503 = cute.get_leaves(%sz_7502) : !cute.int_tuple<"2">
      %coord_7504 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_7505 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7506 = cute.crd2idx(%coord_7504, %lay_7505) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_7507 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7508 = cute.add_offset(%iter_7507, %idx_7506) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7509 = cute.make_view(%tup_7508) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7510 = cute.get_iter(%view_7509) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7511, %e1_7512, %e2_7513, %e3_7514 = cute.get_leaves(%iter_7510) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2311 = cute.get_scalars(%e0_7511) : !cute.int_tuple<"?">
      %2312 = cute.get_scalars(%e1_7512) : !cute.int_tuple<"?">
      %2313 = cute.get_scalars(%e2_7513) : !cute.int_tuple<"?">
      %2314 = cute.get_scalars(%e3_7514) : !cute.int_tuple<"?{div=8}">
      %iter_7515 = cute.get_iter(%view_7509) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7516, %e1_7517, %e2_7518, %e3_7519 = cute.get_leaves(%iter_7515) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2315 = cute.get_scalars(%e0_7516) : !cute.int_tuple<"?">
      %2316 = cute.get_scalars(%e1_7517) : !cute.int_tuple<"?">
      %2317 = cute.get_scalars(%e2_7518) : !cute.int_tuple<"?">
      %2318 = cute.get_scalars(%e3_7519) : !cute.int_tuple<"?{div=8}">
      %iter_7520 = cute.get_iter(%view_7509) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7521, %e1_7522, %e2_7523, %e3_7524 = cute.get_leaves(%iter_7520) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2319 = cute.get_scalars(%e0_7521) : !cute.int_tuple<"?">
      %2320 = cute.get_scalars(%e1_7522) : !cute.int_tuple<"?">
      %2321 = cute.get_scalars(%e2_7523) : !cute.int_tuple<"?">
      %2322 = cute.get_scalars(%e3_7524) : !cute.int_tuple<"?{div=8}">
      %lay_7525 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2323 = cute.get_shape(%lay_7525) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7526, %e1_7527, %e2_7528, %e3_7529 = cute.get_leaves(%2323) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7530 = cute.to_int_tuple(%e0_7526) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2324 = cute.get_scalars(%itup_7530) : !cute.int_tuple<"?">
      %itup_7531 = cute.to_int_tuple(%e1_7527) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2325 = cute.get_scalars(%itup_7531) : !cute.int_tuple<"?">
      %itup_7532 = cute.to_int_tuple(%e2_7528) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2326 = cute.get_scalars(%itup_7532) : !cute.int_tuple<"?">
      %itup_7533 = cute.to_int_tuple(%e3_7529) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2327 = cute.get_scalars(%itup_7533) : !cute.int_tuple<"?{div=8}">
      %coord_7534 = cute.make_coord(%e3_7524) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_7535 = cute.make_coord(%itup_7533) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2328 = cute.elem_less(%coord_7534, %coord_7535) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2329 = arith.extui %2328 : i1 to i8
      %coord_7536 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_7494, %coord_7536, %2329) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_7537 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_7538 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7539 = cute.crd2idx(%coord_7537, %lay_7538) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_7540 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7541 = cute.add_offset(%iter_7540, %idx_7539) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7542 = cute.make_view(%tup_7541) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7543 = cute.get_iter(%view_7542) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7544, %e1_7545, %e2_7546, %e3_7547 = cute.get_leaves(%iter_7543) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2330 = cute.get_scalars(%e0_7544) : !cute.int_tuple<"?">
      %2331 = cute.get_scalars(%e1_7545) : !cute.int_tuple<"?">
      %2332 = cute.get_scalars(%e2_7546) : !cute.int_tuple<"?">
      %2333 = cute.get_scalars(%e3_7547) : !cute.int_tuple<"?{div=8}">
      %iter_7548 = cute.get_iter(%view_7542) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7549, %e1_7550, %e2_7551, %e3_7552 = cute.get_leaves(%iter_7548) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2334 = cute.get_scalars(%e0_7549) : !cute.int_tuple<"?">
      %2335 = cute.get_scalars(%e1_7550) : !cute.int_tuple<"?">
      %2336 = cute.get_scalars(%e2_7551) : !cute.int_tuple<"?">
      %2337 = cute.get_scalars(%e3_7552) : !cute.int_tuple<"?{div=8}">
      %iter_7553 = cute.get_iter(%view_7542) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7554, %e1_7555, %e2_7556, %e3_7557 = cute.get_leaves(%iter_7553) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2338 = cute.get_scalars(%e0_7554) : !cute.int_tuple<"?">
      %2339 = cute.get_scalars(%e1_7555) : !cute.int_tuple<"?">
      %2340 = cute.get_scalars(%e2_7556) : !cute.int_tuple<"?">
      %2341 = cute.get_scalars(%e3_7557) : !cute.int_tuple<"?{div=8}">
      %lay_7558 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2342 = cute.get_shape(%lay_7558) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7559, %e1_7560, %e2_7561, %e3_7562 = cute.get_leaves(%2342) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7563 = cute.to_int_tuple(%e0_7559) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2343 = cute.get_scalars(%itup_7563) : !cute.int_tuple<"?">
      %itup_7564 = cute.to_int_tuple(%e1_7560) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2344 = cute.get_scalars(%itup_7564) : !cute.int_tuple<"?">
      %itup_7565 = cute.to_int_tuple(%e2_7561) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2345 = cute.get_scalars(%itup_7565) : !cute.int_tuple<"?">
      %itup_7566 = cute.to_int_tuple(%e3_7562) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2346 = cute.get_scalars(%itup_7566) : !cute.int_tuple<"?{div=8}">
      %coord_7567 = cute.make_coord(%e3_7557) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_7568 = cute.make_coord(%itup_7566) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2347 = cute.elem_less(%coord_7567, %coord_7568) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2348 = arith.extui %2347 : i1 to i8
      %coord_7569 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_7494, %coord_7569, %2348) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_7570 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_7571 = cute.size(%int_tuple_7570) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_7572 = cute.get_leaves(%sz_7571) : !cute.int_tuple<"8">
      %coord_7573 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_7574 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7575 = cute.crd2idx(%coord_7573, %lay_7574) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_7576 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7577 = cute.add_offset(%iter_7576, %idx_7575) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7578 = cute.make_view(%tup_7577) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7579 = cute.get_iter(%view_7578) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7580, %e1_7581, %e2_7582, %e3_7583 = cute.get_leaves(%iter_7579) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2349 = cute.get_scalars(%e0_7580) : !cute.int_tuple<"?">
      %2350 = cute.get_scalars(%e1_7581) : !cute.int_tuple<"?">
      %2351 = cute.get_scalars(%e2_7582) : !cute.int_tuple<"?">
      %2352 = cute.get_scalars(%e3_7583) : !cute.int_tuple<"?{div=8}">
      %iter_7584 = cute.get_iter(%view_7578) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7585, %e1_7586, %e2_7587, %e3_7588 = cute.get_leaves(%iter_7584) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2353 = cute.get_scalars(%e0_7585) : !cute.int_tuple<"?">
      %2354 = cute.get_scalars(%e1_7586) : !cute.int_tuple<"?">
      %2355 = cute.get_scalars(%e2_7587) : !cute.int_tuple<"?">
      %2356 = cute.get_scalars(%e3_7588) : !cute.int_tuple<"?{div=8}">
      %iter_7589 = cute.get_iter(%view_7578) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7590, %e1_7591, %e2_7592, %e3_7593 = cute.get_leaves(%iter_7589) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2357 = cute.get_scalars(%e0_7590) : !cute.int_tuple<"?">
      %2358 = cute.get_scalars(%e1_7591) : !cute.int_tuple<"?">
      %2359 = cute.get_scalars(%e2_7592) : !cute.int_tuple<"?">
      %2360 = cute.get_scalars(%e3_7593) : !cute.int_tuple<"?{div=8}">
      %lay_7594 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2361 = cute.get_shape(%lay_7594) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7595, %e1_7596, %e2_7597, %e3_7598 = cute.get_leaves(%2361) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7599 = cute.to_int_tuple(%e0_7595) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2362 = cute.get_scalars(%itup_7599) : !cute.int_tuple<"?">
      %itup_7600 = cute.to_int_tuple(%e1_7596) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2363 = cute.get_scalars(%itup_7600) : !cute.int_tuple<"?">
      %itup_7601 = cute.to_int_tuple(%e2_7597) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2364 = cute.get_scalars(%itup_7601) : !cute.int_tuple<"?">
      %itup_7602 = cute.to_int_tuple(%e3_7598) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2365 = cute.get_scalars(%itup_7602) : !cute.int_tuple<"?{div=8}">
      %coord_7603 = cute.make_coord(%e1_7591) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7604 = cute.make_coord(%itup_7600) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2366 = cute.elem_less(%coord_7603, %coord_7604) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2366 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7605 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_7606 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7607 = cute.crd2idx(%coord_7605, %lay_7606) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_7608 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7609 = cute.add_offset(%iter_7608, %idx_7607) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7610 = cute.make_view(%tup_7609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7611 = cute.get_iter(%view_7610) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7612, %e1_7613, %e2_7614, %e3_7615 = cute.get_leaves(%iter_7611) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2367 = cute.get_scalars(%e0_7612) : !cute.int_tuple<"?">
      %2368 = cute.get_scalars(%e1_7613) : !cute.int_tuple<"?">
      %2369 = cute.get_scalars(%e2_7614) : !cute.int_tuple<"?">
      %2370 = cute.get_scalars(%e3_7615) : !cute.int_tuple<"?{div=8}">
      %iter_7616 = cute.get_iter(%view_7610) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7617, %e1_7618, %e2_7619, %e3_7620 = cute.get_leaves(%iter_7616) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2371 = cute.get_scalars(%e0_7617) : !cute.int_tuple<"?">
      %2372 = cute.get_scalars(%e1_7618) : !cute.int_tuple<"?">
      %2373 = cute.get_scalars(%e2_7619) : !cute.int_tuple<"?">
      %2374 = cute.get_scalars(%e3_7620) : !cute.int_tuple<"?{div=8}">
      %iter_7621 = cute.get_iter(%view_7610) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7622, %e1_7623, %e2_7624, %e3_7625 = cute.get_leaves(%iter_7621) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2375 = cute.get_scalars(%e0_7622) : !cute.int_tuple<"?">
      %2376 = cute.get_scalars(%e1_7623) : !cute.int_tuple<"?">
      %2377 = cute.get_scalars(%e2_7624) : !cute.int_tuple<"?">
      %2378 = cute.get_scalars(%e3_7625) : !cute.int_tuple<"?{div=8}">
      %lay_7626 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2379 = cute.get_shape(%lay_7626) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7627, %e1_7628, %e2_7629, %e3_7630 = cute.get_leaves(%2379) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7631 = cute.to_int_tuple(%e0_7627) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2380 = cute.get_scalars(%itup_7631) : !cute.int_tuple<"?">
      %itup_7632 = cute.to_int_tuple(%e1_7628) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2381 = cute.get_scalars(%itup_7632) : !cute.int_tuple<"?">
      %itup_7633 = cute.to_int_tuple(%e2_7629) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2382 = cute.get_scalars(%itup_7633) : !cute.int_tuple<"?">
      %itup_7634 = cute.to_int_tuple(%e3_7630) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2383 = cute.get_scalars(%itup_7634) : !cute.int_tuple<"?{div=8}">
      %coord_7635 = cute.make_coord(%e1_7623) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7636 = cute.make_coord(%itup_7632) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2384 = cute.elem_less(%coord_7635, %coord_7636) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2384 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7637 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_7638 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7639 = cute.crd2idx(%coord_7637, %lay_7638) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_7640 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7641 = cute.add_offset(%iter_7640, %idx_7639) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7642 = cute.make_view(%tup_7641) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7643 = cute.get_iter(%view_7642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7644, %e1_7645, %e2_7646, %e3_7647 = cute.get_leaves(%iter_7643) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2385 = cute.get_scalars(%e0_7644) : !cute.int_tuple<"?">
      %2386 = cute.get_scalars(%e1_7645) : !cute.int_tuple<"?">
      %2387 = cute.get_scalars(%e2_7646) : !cute.int_tuple<"?">
      %2388 = cute.get_scalars(%e3_7647) : !cute.int_tuple<"?{div=8}">
      %iter_7648 = cute.get_iter(%view_7642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7649, %e1_7650, %e2_7651, %e3_7652 = cute.get_leaves(%iter_7648) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2389 = cute.get_scalars(%e0_7649) : !cute.int_tuple<"?">
      %2390 = cute.get_scalars(%e1_7650) : !cute.int_tuple<"?">
      %2391 = cute.get_scalars(%e2_7651) : !cute.int_tuple<"?">
      %2392 = cute.get_scalars(%e3_7652) : !cute.int_tuple<"?{div=8}">
      %iter_7653 = cute.get_iter(%view_7642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7654, %e1_7655, %e2_7656, %e3_7657 = cute.get_leaves(%iter_7653) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2393 = cute.get_scalars(%e0_7654) : !cute.int_tuple<"?">
      %2394 = cute.get_scalars(%e1_7655) : !cute.int_tuple<"?">
      %2395 = cute.get_scalars(%e2_7656) : !cute.int_tuple<"?">
      %2396 = cute.get_scalars(%e3_7657) : !cute.int_tuple<"?{div=8}">
      %lay_7658 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2397 = cute.get_shape(%lay_7658) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7659, %e1_7660, %e2_7661, %e3_7662 = cute.get_leaves(%2397) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7663 = cute.to_int_tuple(%e0_7659) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2398 = cute.get_scalars(%itup_7663) : !cute.int_tuple<"?">
      %itup_7664 = cute.to_int_tuple(%e1_7660) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2399 = cute.get_scalars(%itup_7664) : !cute.int_tuple<"?">
      %itup_7665 = cute.to_int_tuple(%e2_7661) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2400 = cute.get_scalars(%itup_7665) : !cute.int_tuple<"?">
      %itup_7666 = cute.to_int_tuple(%e3_7662) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2401 = cute.get_scalars(%itup_7666) : !cute.int_tuple<"?{div=8}">
      %coord_7667 = cute.make_coord(%e1_7655) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7668 = cute.make_coord(%itup_7664) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2402 = cute.elem_less(%coord_7667, %coord_7668) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2402 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7669 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_7670 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7671 = cute.crd2idx(%coord_7669, %lay_7670) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_7672 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7673 = cute.add_offset(%iter_7672, %idx_7671) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7674 = cute.make_view(%tup_7673) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7675 = cute.get_iter(%view_7674) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7676, %e1_7677, %e2_7678, %e3_7679 = cute.get_leaves(%iter_7675) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2403 = cute.get_scalars(%e0_7676) : !cute.int_tuple<"?">
      %2404 = cute.get_scalars(%e1_7677) : !cute.int_tuple<"?">
      %2405 = cute.get_scalars(%e2_7678) : !cute.int_tuple<"?">
      %2406 = cute.get_scalars(%e3_7679) : !cute.int_tuple<"?{div=8}">
      %iter_7680 = cute.get_iter(%view_7674) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7681, %e1_7682, %e2_7683, %e3_7684 = cute.get_leaves(%iter_7680) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2407 = cute.get_scalars(%e0_7681) : !cute.int_tuple<"?">
      %2408 = cute.get_scalars(%e1_7682) : !cute.int_tuple<"?">
      %2409 = cute.get_scalars(%e2_7683) : !cute.int_tuple<"?">
      %2410 = cute.get_scalars(%e3_7684) : !cute.int_tuple<"?{div=8}">
      %iter_7685 = cute.get_iter(%view_7674) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7686, %e1_7687, %e2_7688, %e3_7689 = cute.get_leaves(%iter_7685) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2411 = cute.get_scalars(%e0_7686) : !cute.int_tuple<"?">
      %2412 = cute.get_scalars(%e1_7687) : !cute.int_tuple<"?">
      %2413 = cute.get_scalars(%e2_7688) : !cute.int_tuple<"?">
      %2414 = cute.get_scalars(%e3_7689) : !cute.int_tuple<"?{div=8}">
      %lay_7690 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2415 = cute.get_shape(%lay_7690) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7691, %e1_7692, %e2_7693, %e3_7694 = cute.get_leaves(%2415) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7695 = cute.to_int_tuple(%e0_7691) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2416 = cute.get_scalars(%itup_7695) : !cute.int_tuple<"?">
      %itup_7696 = cute.to_int_tuple(%e1_7692) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2417 = cute.get_scalars(%itup_7696) : !cute.int_tuple<"?">
      %itup_7697 = cute.to_int_tuple(%e2_7693) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2418 = cute.get_scalars(%itup_7697) : !cute.int_tuple<"?">
      %itup_7698 = cute.to_int_tuple(%e3_7694) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2419 = cute.get_scalars(%itup_7698) : !cute.int_tuple<"?{div=8}">
      %coord_7699 = cute.make_coord(%e1_7687) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7700 = cute.make_coord(%itup_7696) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2420 = cute.elem_less(%coord_7699, %coord_7700) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2420 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7701 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_7702 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7703 = cute.crd2idx(%coord_7701, %lay_7702) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_7704 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7705 = cute.add_offset(%iter_7704, %idx_7703) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7706 = cute.make_view(%tup_7705) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7707 = cute.get_iter(%view_7706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7708, %e1_7709, %e2_7710, %e3_7711 = cute.get_leaves(%iter_7707) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2421 = cute.get_scalars(%e0_7708) : !cute.int_tuple<"?">
      %2422 = cute.get_scalars(%e1_7709) : !cute.int_tuple<"?">
      %2423 = cute.get_scalars(%e2_7710) : !cute.int_tuple<"?">
      %2424 = cute.get_scalars(%e3_7711) : !cute.int_tuple<"?{div=8}">
      %iter_7712 = cute.get_iter(%view_7706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7713, %e1_7714, %e2_7715, %e3_7716 = cute.get_leaves(%iter_7712) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2425 = cute.get_scalars(%e0_7713) : !cute.int_tuple<"?">
      %2426 = cute.get_scalars(%e1_7714) : !cute.int_tuple<"?">
      %2427 = cute.get_scalars(%e2_7715) : !cute.int_tuple<"?">
      %2428 = cute.get_scalars(%e3_7716) : !cute.int_tuple<"?{div=8}">
      %iter_7717 = cute.get_iter(%view_7706) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7718, %e1_7719, %e2_7720, %e3_7721 = cute.get_leaves(%iter_7717) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2429 = cute.get_scalars(%e0_7718) : !cute.int_tuple<"?">
      %2430 = cute.get_scalars(%e1_7719) : !cute.int_tuple<"?">
      %2431 = cute.get_scalars(%e2_7720) : !cute.int_tuple<"?">
      %2432 = cute.get_scalars(%e3_7721) : !cute.int_tuple<"?{div=8}">
      %lay_7722 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2433 = cute.get_shape(%lay_7722) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2433) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7727 = cute.to_int_tuple(%e0_7723) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2434 = cute.get_scalars(%itup_7727) : !cute.int_tuple<"?">
      %itup_7728 = cute.to_int_tuple(%e1_7724) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2435 = cute.get_scalars(%itup_7728) : !cute.int_tuple<"?">
      %itup_7729 = cute.to_int_tuple(%e2_7725) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2436 = cute.get_scalars(%itup_7729) : !cute.int_tuple<"?">
      %itup_7730 = cute.to_int_tuple(%e3_7726) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2437 = cute.get_scalars(%itup_7730) : !cute.int_tuple<"?{div=8}">
      %coord_7731 = cute.make_coord(%e1_7719) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7732 = cute.make_coord(%itup_7728) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2438 = cute.elem_less(%coord_7731, %coord_7732) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2438 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"64">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7733 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_7734 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_7736 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7738 = cute.make_view(%tup_7737) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7739 = cute.get_iter(%view_7738) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7740, %e1_7741, %e2_7742, %e3_7743 = cute.get_leaves(%iter_7739) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2439 = cute.get_scalars(%e0_7740) : !cute.int_tuple<"?">
      %2440 = cute.get_scalars(%e1_7741) : !cute.int_tuple<"?">
      %2441 = cute.get_scalars(%e2_7742) : !cute.int_tuple<"?">
      %2442 = cute.get_scalars(%e3_7743) : !cute.int_tuple<"?{div=8}">
      %iter_7744 = cute.get_iter(%view_7738) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7745, %e1_7746, %e2_7747, %e3_7748 = cute.get_leaves(%iter_7744) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2443 = cute.get_scalars(%e0_7745) : !cute.int_tuple<"?">
      %2444 = cute.get_scalars(%e1_7746) : !cute.int_tuple<"?">
      %2445 = cute.get_scalars(%e2_7747) : !cute.int_tuple<"?">
      %2446 = cute.get_scalars(%e3_7748) : !cute.int_tuple<"?{div=8}">
      %iter_7749 = cute.get_iter(%view_7738) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7750, %e1_7751, %e2_7752, %e3_7753 = cute.get_leaves(%iter_7749) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2447 = cute.get_scalars(%e0_7750) : !cute.int_tuple<"?">
      %2448 = cute.get_scalars(%e1_7751) : !cute.int_tuple<"?">
      %2449 = cute.get_scalars(%e2_7752) : !cute.int_tuple<"?">
      %2450 = cute.get_scalars(%e3_7753) : !cute.int_tuple<"?{div=8}">
      %lay_7754 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2451 = cute.get_shape(%lay_7754) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7755, %e1_7756, %e2_7757, %e3_7758 = cute.get_leaves(%2451) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7759 = cute.to_int_tuple(%e0_7755) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2452 = cute.get_scalars(%itup_7759) : !cute.int_tuple<"?">
      %itup_7760 = cute.to_int_tuple(%e1_7756) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2453 = cute.get_scalars(%itup_7760) : !cute.int_tuple<"?">
      %itup_7761 = cute.to_int_tuple(%e2_7757) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2454 = cute.get_scalars(%itup_7761) : !cute.int_tuple<"?">
      %itup_7762 = cute.to_int_tuple(%e3_7758) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2455 = cute.get_scalars(%itup_7762) : !cute.int_tuple<"?{div=8}">
      %coord_7763 = cute.make_coord(%e1_7751) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7764 = cute.make_coord(%itup_7760) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2456 = cute.elem_less(%coord_7763, %coord_7764) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2456 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"80">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7765 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_7766 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7767 = cute.crd2idx(%coord_7765, %lay_7766) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_7768 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7769 = cute.add_offset(%iter_7768, %idx_7767) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7770 = cute.make_view(%tup_7769) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7771 = cute.get_iter(%view_7770) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7772, %e1_7773, %e2_7774, %e3_7775 = cute.get_leaves(%iter_7771) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2457 = cute.get_scalars(%e0_7772) : !cute.int_tuple<"?">
      %2458 = cute.get_scalars(%e1_7773) : !cute.int_tuple<"?">
      %2459 = cute.get_scalars(%e2_7774) : !cute.int_tuple<"?">
      %2460 = cute.get_scalars(%e3_7775) : !cute.int_tuple<"?{div=8}">
      %iter_7776 = cute.get_iter(%view_7770) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7777, %e1_7778, %e2_7779, %e3_7780 = cute.get_leaves(%iter_7776) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2461 = cute.get_scalars(%e0_7777) : !cute.int_tuple<"?">
      %2462 = cute.get_scalars(%e1_7778) : !cute.int_tuple<"?">
      %2463 = cute.get_scalars(%e2_7779) : !cute.int_tuple<"?">
      %2464 = cute.get_scalars(%e3_7780) : !cute.int_tuple<"?{div=8}">
      %iter_7781 = cute.get_iter(%view_7770) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7782, %e1_7783, %e2_7784, %e3_7785 = cute.get_leaves(%iter_7781) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2465 = cute.get_scalars(%e0_7782) : !cute.int_tuple<"?">
      %2466 = cute.get_scalars(%e1_7783) : !cute.int_tuple<"?">
      %2467 = cute.get_scalars(%e2_7784) : !cute.int_tuple<"?">
      %2468 = cute.get_scalars(%e3_7785) : !cute.int_tuple<"?{div=8}">
      %lay_7786 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2469 = cute.get_shape(%lay_7786) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7787, %e1_7788, %e2_7789, %e3_7790 = cute.get_leaves(%2469) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7791 = cute.to_int_tuple(%e0_7787) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2470 = cute.get_scalars(%itup_7791) : !cute.int_tuple<"?">
      %itup_7792 = cute.to_int_tuple(%e1_7788) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2471 = cute.get_scalars(%itup_7792) : !cute.int_tuple<"?">
      %itup_7793 = cute.to_int_tuple(%e2_7789) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2472 = cute.get_scalars(%itup_7793) : !cute.int_tuple<"?">
      %itup_7794 = cute.to_int_tuple(%e3_7790) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2473 = cute.get_scalars(%itup_7794) : !cute.int_tuple<"?{div=8}">
      %coord_7795 = cute.make_coord(%e1_7783) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7796 = cute.make_coord(%itup_7792) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2474 = cute.elem_less(%coord_7795, %coord_7796) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2474 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"96">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7797 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_7798 = cute.get_layout(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7799 = cute.crd2idx(%coord_7797, %lay_7798) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_7800 = cute.get_iter(%dst_partitioned_7480) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7801 = cute.add_offset(%iter_7800, %idx_7799) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7802 = cute.make_view(%tup_7801) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7803 = cute.get_iter(%view_7802) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7804, %e1_7805, %e2_7806, %e3_7807 = cute.get_leaves(%iter_7803) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2475 = cute.get_scalars(%e0_7804) : !cute.int_tuple<"?">
      %2476 = cute.get_scalars(%e1_7805) : !cute.int_tuple<"?">
      %2477 = cute.get_scalars(%e2_7806) : !cute.int_tuple<"?">
      %2478 = cute.get_scalars(%e3_7807) : !cute.int_tuple<"?{div=8}">
      %iter_7808 = cute.get_iter(%view_7802) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7809, %e1_7810, %e2_7811, %e3_7812 = cute.get_leaves(%iter_7808) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2479 = cute.get_scalars(%e0_7809) : !cute.int_tuple<"?">
      %2480 = cute.get_scalars(%e1_7810) : !cute.int_tuple<"?">
      %2481 = cute.get_scalars(%e2_7811) : !cute.int_tuple<"?">
      %2482 = cute.get_scalars(%e3_7812) : !cute.int_tuple<"?{div=8}">
      %iter_7813 = cute.get_iter(%view_7802) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7814, %e1_7815, %e2_7816, %e3_7817 = cute.get_leaves(%iter_7813) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2483 = cute.get_scalars(%e0_7814) : !cute.int_tuple<"?">
      %2484 = cute.get_scalars(%e1_7815) : !cute.int_tuple<"?">
      %2485 = cute.get_scalars(%e2_7816) : !cute.int_tuple<"?">
      %2486 = cute.get_scalars(%e3_7817) : !cute.int_tuple<"?{div=8}">
      %lay_7818 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2487 = cute.get_shape(%lay_7818) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7819, %e1_7820, %e2_7821, %e3_7822 = cute.get_leaves(%2487) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7823 = cute.to_int_tuple(%e0_7819) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2488 = cute.get_scalars(%itup_7823) : !cute.int_tuple<"?">
      %itup_7824 = cute.to_int_tuple(%e1_7820) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2489 = cute.get_scalars(%itup_7824) : !cute.int_tuple<"?">
      %itup_7825 = cute.to_int_tuple(%e2_7821) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2490 = cute.get_scalars(%itup_7825) : !cute.int_tuple<"?">
      %itup_7826 = cute.to_int_tuple(%e3_7822) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2491 = cute.get_scalars(%itup_7826) : !cute.int_tuple<"?{div=8}">
      %coord_7827 = cute.make_coord(%e1_7815) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7828 = cute.make_coord(%itup_7824) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2492 = cute.elem_less(%coord_7827, %coord_7828) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2492 {
        %coord_7829 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7830 = cute.get_layout(%rmem_7357) : !memref_rmem_bf16_27
        %idx_7831 = cute.crd2idx(%coord_7829, %lay_7830) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"112">
        %iter_7832 = cute.get_iter(%rmem_7357) : !memref_rmem_bf16_27
        %ptr_7833 = cute.add_offset(%iter_7832, %idx_7831) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7834 = cute.make_view(%ptr_7833) : !memref_rmem_bf16_29
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_29
        %coord_7837 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7838 = cute.get_layout(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %idx_7839 = cute.crd2idx(%coord_7837, %lay_7838) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_7840 = cute.get_iter(%dst_partitioned_7354) : !memref_gmem_bf16_4
        %ptr_7841 = cute.add_offset(%iter_7840, %idx_7839) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7842 = cute.make_view(%ptr_7841) : !memref_gmem_bf16_6
        %iter_7843 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %iter_7844 = cute.get_iter(%view_7842) : !memref_gmem_bf16_6
        %coord_7845 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7846 = cute.get_layout(%rmem_7494) : !memref_rmem_i8_
        %idx_7847 = cute.crd2idx(%coord_7845, %lay_7846) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7848 = cute.get_iter(%rmem_7494) : !memref_rmem_i8_
        %ptr_7849 = cute.add_offset(%iter_7848, %idx_7847) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7850 = cute.make_view(%ptr_7849) : !memref_rmem_i8_2
        %iter_7851 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %iter_7852 = cute.get_iter(%view_7850) : !memref_rmem_i8_2
        %lay_7853 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %2493 = cute.get_shape(%lay_7853) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7854, %e1_7855, %e2_7856 = cute.get_leaves(%2493) : !cute.shape<"((8,1),2)">
        %lay_7857 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %2494 = cute.get_shape(%lay_7857) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7858, %e1_7859, %e2_7860 = cute.get_leaves(%2494) : !cute.shape<"((8,1),2)">
        %lay_7861 = cute.get_layout(%view_7834) : !memref_rmem_bf16_29
        %shape_7862 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7863 = cute.make_layout() : !cute.layout<"1:0">
        %append_7864 = cute.append_to_rank<2> (%lay_7861, %lay_7863) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7865 = cute.make_view(%iter_7836, %append_7864) : !memref_rmem_bf16_29
        %iter_7866 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %lay_7867 = cute.get_layout(%view_7865) : !memref_rmem_bf16_29
        %2495 = cute.get_shape(%lay_7867) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7868, %e1_7869, %e2_7870 = cute.get_leaves(%2495) : !cute.shape<"((8,1),2)">
        %iter_7871 = cute.get_iter(%view_7865) : !memref_rmem_bf16_29
        %view_7872 = cute.make_view(%iter_7871) : !memref_rmem_bf16_30
        %iter_7873 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7874 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %lay_7875 = cute.get_layout(%view_7842) : !memref_gmem_bf16_6
        %shape_7876 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7877 = cute.make_layout() : !cute.layout<"1:0">
        %append_7878 = cute.append_to_rank<2> (%lay_7875, %lay_7877) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7879 = cute.make_view(%iter_7844, %append_7878) : !memref_gmem_bf16_6
        %iter_7880 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %lay_7881 = cute.get_layout(%view_7879) : !memref_gmem_bf16_6
        %2496 = cute.get_shape(%lay_7881) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7882, %e1_7883, %e2_7884 = cute.get_leaves(%2496) : !cute.shape<"((8,1),2)">
        %iter_7885 = cute.get_iter(%view_7879) : !memref_gmem_bf16_6
        %view_7886 = cute.make_view(%iter_7885) : !memref_gmem_bf16_7
        %iter_7887 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %iter_7888 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7889 = cute.get_layout(%view_7850) : !memref_rmem_i8_2
        %shape_7890 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7891 = cute.make_layout() : !cute.layout<"1:0">
        %append_7892 = cute.append_to_rank<2> (%lay_7889, %lay_7891) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7893 = cute.make_view(%iter_7852, %append_7892) : !memref_rmem_i8_2
        %iter_7894 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %lay_7895 = cute.get_layout(%view_7893) : !memref_rmem_i8_2
        %2497 = cute.get_shape(%lay_7895) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7896, %e1_7897 = cute.get_leaves(%2497) : !cute.shape<"(1,2)">
        %iter_7898 = cute.get_iter(%view_7893) : !memref_rmem_i8_2
        %view_7899 = cute.make_view(%iter_7898) : !memref_rmem_i8_3
        %iter_7900 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %iter_7901 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7902 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %2498 = cute.get_shape(%lay_7902) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7903, %e1_7904, %e2_7905 = cute.get_leaves(%2498) : !cute.shape<"((8,1),(2))">
        %lay_7906 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %2499 = cute.get_shape(%lay_7906) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7907, %e1_7908, %e2_7909 = cute.get_leaves(%2499) : !cute.shape<"((8,1),(2))">
        %lay_7910 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %sz_7911 = cute.size(%lay_7910) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7912 = cute.get_leaves(%sz_7911) : !cute.int_tuple<"2">
        %lay_7913 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %sz_7914 = cute.size(%lay_7913) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7915 = cute.get_leaves(%sz_7914) : !cute.int_tuple<"2">
        %2500 = cute.static : !cute.layout<"1:0">
        %iter_7916 = cute.get_iter(%view_7872) : !memref_rmem_bf16_30
        %iter_7917 = cute.get_iter(%view_7886) : !memref_gmem_bf16_7
        %lay_7918 = cute.get_layout(%view_7872) : !memref_rmem_bf16_30
        %lay_7919 = cute.get_layout(%view_7886) : !memref_gmem_bf16_7
        %append_7920 = cute.append_to_rank<2> (%lay_7918, %2500) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7921 = cute.append_to_rank<2> (%lay_7919, %2500) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7922 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7923 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7924 = cute.get_iter(%view_7899) : !memref_rmem_i8_3
        %lay_7925 = cute.get_layout(%view_7899) : !memref_rmem_i8_3
        %append_7926 = cute.append_to_rank<2> (%lay_7925, %2500) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7927 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7928 = cute.size(%lay_7922) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2501 = cute.get_scalars(%sz_7928) : !cute.int_tuple<"2">
        %c0_i32_7929 = arith.constant 0 : i32
        %c1_i32_7930 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7929 to %2501 step %c1_i32_7930  : i32 {
          %coord_7931 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7932 = cute.slice(%lay_7922, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7933 = cute.crd2idx(%coord_7931, %lay_7922) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7934 = cute.add_offset(%iter_7916, %idx_7933) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7935 = cute.make_view(%ptr_7934, %slice_7932) : !memref_rmem_bf16_8
          %slice_7936 = cute.slice(%lay_7923, %coord_7931) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7937 = cute.crd2idx(%coord_7931, %lay_7923) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7938 = cute.add_offset(%iter_7917, %idx_7937) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7939 = cute.make_view(%ptr_7938, %slice_7936) : !memref_gmem_bf16_8
          %slice_7940 = cute.slice(%lay_7927, %coord_7931) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7941 = cute.crd2idx(%coord_7931, %lay_7927) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7942 = cute.add_offset(%iter_7924, %idx_7941) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7943 = cute.make_view(%ptr_7942, %slice_7940) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7935, %view_7939, %view_7943) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32, %arg5: !cuda.stream) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %36 = cute.static : !cute.swizzle<"S<3,3,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_65 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)">
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %38 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %39 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %cosz = cute.cosize(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384">
    %e0_73 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384">
    %cosz_74 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_75 = cute.get_leaves(%cosz_74) : !cute.int_tuple<"8192">
    %cosz_76 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_77 = cute.get_leaves(%cosz_76) : !cute.int_tuple<"8192">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>
    %atom_78 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %40 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %41 = cute.get_shape(%40) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_79, %e1_80 = cute.get_leaves(%41) : !cute.shape<"(8,64)">
    %shape_81 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_82 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_84 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_85 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %prod = cute.raked_product(%lay_83, %lay_85) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_86 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_87 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_88 = cute.get_leaves(%sz_87) : !cute.int_tuple<"8">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_90 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_91 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %42 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_92, %e1_93, %e2_94 = cute.get_leaves(%42) : !cute.shape<"(16,(8,8))">
    %int_tuple_95 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res = cute.tuple.product_each(%int_tuple_95) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_96, %e1_97 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)">
    %int_tuple_98 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_99 = cute.tuple.product_each(%int_tuple_98) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_100, %e1_101 = cute.get_leaves(%res_99) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %43 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %prod_102 = cute.raked_product(%lay_83, %lay_85) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_103 = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_104 = cute.get_leaves(%sz_103) : !cute.int_tuple<"128">
    %sz_105 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"8">
    %shape_107 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_108 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_109 = cute.right_inverse(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_110 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %44 = cute.get_shape(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_111, %e1_112, %e2_113 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))">
    %int_tuple_114 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res_115 = cute.tuple.product_each(%int_tuple_114) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_116, %e1_117 = cute.get_leaves(%res_115) : !cute.int_tuple<"(16,64)">
    %int_tuple_118 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_119 = cute.tuple.product_each(%int_tuple_118) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_120, %e1_121 = cute.get_leaves(%res_119) : !cute.int_tuple<"(16,64)">
    %tile_122 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %45 = cute.make_tiled_copy(%atom_78) : !copy_simt
    %shape_123 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_124 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_125 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_126 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %46 = cute.get_shape(%lay_126) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_127, %e1_128, %e2_129 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)">
    %tile_130 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %47 = cute.make_tiled_mma(%atom_124) : !mma_bf16_bf16_f32_16x8x16_
    %lay_131 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %48 = cute.get_shape(%lay_131) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_132, %e1_133, %e2_134, %e3_135 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_136 = cute.to_int_tuple(%e0_132) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %49 = cute.get_scalars(%itup_136) : !cute.int_tuple<"?">
    %itup_137 = cute.to_int_tuple(%e1_133) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %50 = cute.get_scalars(%itup_137) : !cute.int_tuple<"?">
    %itup_138 = cute.to_int_tuple(%e2_134) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %51 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?">
    %itup_139 = cute.to_int_tuple(%e3_135) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %52 = cute.get_scalars(%itup_139) : !cute.int_tuple<"?{div=8}">
    %int_tuple_140 = cute.make_int_tuple(%itup_137) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_141 = cute.make_tile() : () -> !cute.tile<"128:1">
    %53 = cute.get_scalars(%int_tuple_140) <{only_dynamic}> : !cute.int_tuple<"?">
    %c128_i32 = arith.constant 128 : i32
    %54 = arith.ceildivsi %53, %c128_i32 : i32
    %int_tuple_142 = cute.make_int_tuple(%54) : (i32) -> !cute.int_tuple<"?">
    %e0_143 = cute.get_leaves(%int_tuple_142) : !cute.int_tuple<"?">
    %55 = cute.get_scalars(%e0_143) : !cute.int_tuple<"?">
    %int_tuple_144 = cute.make_int_tuple(%itup_136) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_145 = cute.size(%int_tuple_144) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_146 = cute.get_leaves(%sz_145) : !cute.int_tuple<"?">
    %56 = cute.get_scalars(%e0_146) : !cute.int_tuple<"?">
    %int_tuple_147 = cute.make_int_tuple(%itup_138) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_148 = cute.size(%int_tuple_147) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_149 = cute.get_leaves(%sz_148) : !cute.int_tuple<"?">
    %57 = cute.get_scalars(%e0_149) : !cute.int_tuple<"?">
    %cst = arith.constant 1.44269502 : f32
    %58 = arith.mulf %arg4, %cst : f32
    %lay_150 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %59 = cute.get_shape(%lay_150) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_151, %e1_152, %e2_153, %e3_154 = cute.get_leaves(%59) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_155 = cute.to_int_tuple(%e0_151) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_155) : !cute.int_tuple<"?">
    %itup_156 = cute.to_int_tuple(%e1_152) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_156) : !cute.int_tuple<"?">
    %itup_157 = cute.to_int_tuple(%e2_153) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %62 = cute.get_scalars(%itup_157) : !cute.int_tuple<"?">
    %itup_158 = cute.to_int_tuple(%e3_154) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %63 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?{div=8}">
    %64 = cute.get_stride(%lay_150) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_159, %e1_160, %e2_161, %e3_162 = cute.get_leaves(%64) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_163 = cute.to_int_tuple(%e0_159) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %65 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{i64 div=8}">
    %itup_164 = cute.to_int_tuple(%e1_160) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %66 = cute.get_scalars(%itup_164) : !cute.int_tuple<"?{i64 div=8}">
    %itup_165 = cute.to_int_tuple(%e2_161) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %67 = cute.get_scalars(%itup_165) : !cute.int_tuple<"?{i64 div=8}">
    %lay_166 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %68 = cute.get_shape(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%68) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_171 = cute.to_int_tuple(%e0_167) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?">
    %itup_172 = cute.to_int_tuple(%e1_168) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %70 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?">
    %itup_173 = cute.to_int_tuple(%e2_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %71 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e3_170) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %72 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?{div=8}">
    %73 = cute.get_stride(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%73) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_179 = cute.to_int_tuple(%e0_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}">
    %itup_180 = cute.to_int_tuple(%e1_176) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %75 = cute.get_scalars(%itup_180) : !cute.int_tuple<"?{i64 div=8}">
    %itup_181 = cute.to_int_tuple(%e2_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %76 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %lay_182 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %77 = cute.get_shape(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_183, %e1_184, %e2_185, %e3_186 = cute.get_leaves(%77) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_187 = cute.to_int_tuple(%e0_183) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?">
    %itup_188 = cute.to_int_tuple(%e1_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %79 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
    %itup_189 = cute.to_int_tuple(%e2_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %80 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e3_186) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %81 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?{div=8}">
    %82 = cute.get_stride(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_191, %e1_192, %e2_193, %e3_194 = cute.get_leaves(%82) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_195 = cute.to_int_tuple(%e0_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}">
    %itup_196 = cute.to_int_tuple(%e1_192) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %84 = cute.get_scalars(%itup_196) : !cute.int_tuple<"?{i64 div=8}">
    %itup_197 = cute.to_int_tuple(%e2_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %85 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %lay_198 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %86 = cute.get_shape(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_199, %e1_200, %e2_201, %e3_202 = cute.get_leaves(%86) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_203 = cute.to_int_tuple(%e0_199) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?">
    %itup_204 = cute.to_int_tuple(%e1_200) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %88 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?">
    %itup_205 = cute.to_int_tuple(%e2_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %89 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e3_202) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %90 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?{div=8}">
    %91 = cute.get_stride(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_207, %e1_208, %e2_209, %e3_210 = cute.get_leaves(%91) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_211 = cute.to_int_tuple(%e0_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}">
    %itup_212 = cute.to_int_tuple(%e1_208) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %93 = cute.get_scalars(%itup_212) : !cute.int_tuple<"?{i64 div=8}">
    %itup_213 = cute.to_int_tuple(%e2_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %94 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %95 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %96 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_214 = cute.get_leaves(%96) : !cute.int_tuple<"0">
    %97 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %98 = cute.get_shape(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_215, %e1_216, %e2_217, %e3_218 = cute.get_leaves(%98) : !cute.shape<"((8,16),(64,2))">
    %99 = cute.get_stride(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_219, %e1_220, %e2_221, %e3_222 = cute.get_leaves(%99) : !cute.stride<"((64,512),(1,8192))">
    %100 = cute.composed_get_inner(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
    %101 = cute.composed_get_offset(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_223 = cute.get_leaves(%101) : !cute.int_tuple<"0">
    %102 = cute.composed_get_outer(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %103 = cute.get_shape(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_224, %e1_225, %e2_226, %e3_227 = cute.get_leaves(%103) : !cute.shape<"((8,8),(64,2))">
    %104 = cute.get_stride(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_228, %e1_229, %e2_230, %e3_231 = cute.get_leaves(%104) : !cute.stride<"((64,512),(1,4096))">
    %105 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %106 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_232 = cute.get_leaves(%106) : !cute.int_tuple<"0">
    %107 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %108 = cute.get_shape(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_233, %e1_234, %e2_235, %e3_236 = cute.get_leaves(%108) : !cute.shape<"((8,16),(64,2))">
    %109 = cute.get_stride(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_237, %e1_238, %e2_239, %e3_240 = cute.get_leaves(%109) : !cute.stride<"((64,512),(1,8192))">
    %110 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_241, %e1_242 = cute.get_leaves(%110) : !cute.tile<"[16:1;64:1]">
    %111 = cute.get_shape(%e0_241) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_243 = cute.get_leaves(%111) : !cute.shape<"16">
    %112 = cute.get_stride(%e0_241) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_244 = cute.get_leaves(%112) : !cute.stride<"1">
    %113 = cute.get_shape(%e1_242) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_245 = cute.get_leaves(%113) : !cute.shape<"64">
    %114 = cute.get_stride(%e1_242) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_246 = cute.get_leaves(%114) : !cute.stride<"1">
    %115 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %116 = cute.get_shape(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_247, %e1_248, %e2_249 = cute.get_leaves(%116) : !cute.shape<"((8,16),8)">
    %117 = cute.get_stride(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_250, %e1_251, %e2_252 = cute.get_leaves(%117) : !cute.stride<"((128,1),16)">
    %118 = cute.static : !cute.layout<"1:0">
    %119 = cute.get_shape(%118) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_253 = cute.get_leaves(%119) : !cute.shape<"1">
    %120 = cute.get_stride(%118) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_254 = cute.get_leaves(%120) : !cute.stride<"0">
    %121 = cute.static : !cute.layout<"(1,8):(0,1)">
    %122 = cute.get_shape(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_255, %e1_256 = cute.get_leaves(%122) : !cute.shape<"(1,8)">
    %123 = cute.get_stride(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_257, %e1_258 = cute.get_leaves(%123) : !cute.stride<"(0,1)">
    %124 = cute.static : !cute.layout<"(1,8):(0,1)">
    %125 = cute.get_shape(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_259, %e1_260 = cute.get_leaves(%125) : !cute.shape<"(1,8)">
    %126 = cute.get_stride(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_261, %e1_262 = cute.get_leaves(%126) : !cute.stride<"(0,1)">
    %127 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_263, %e1_264 = cute.get_leaves(%127) : !cute.tile<"[16:1;64:1]">
    %128 = cute.get_shape(%e0_263) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_265 = cute.get_leaves(%128) : !cute.shape<"16">
    %129 = cute.get_stride(%e0_263) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_266 = cute.get_leaves(%129) : !cute.stride<"1">
    %130 = cute.get_shape(%e1_264) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_267 = cute.get_leaves(%130) : !cute.shape<"64">
    %131 = cute.get_stride(%e1_264) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_268 = cute.get_leaves(%131) : !cute.stride<"1">
    %132 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %133 = cute.get_shape(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_269, %e1_270, %e2_271 = cute.get_leaves(%133) : !cute.shape<"((8,16),8)">
    %134 = cute.get_stride(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_272, %e1_273, %e2_274 = cute.get_leaves(%134) : !cute.stride<"((128,1),16)">
    %135 = cute.static : !cute.layout<"1:0">
    %136 = cute.get_shape(%135) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_275 = cute.get_leaves(%136) : !cute.shape<"1">
    %137 = cute.get_stride(%135) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_276 = cute.get_leaves(%137) : !cute.stride<"0">
    %138 = cute.static : !cute.layout<"(1,8):(0,1)">
    %139 = cute.get_shape(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_277, %e1_278 = cute.get_leaves(%139) : !cute.shape<"(1,8)">
    %140 = cute.get_stride(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_279, %e1_280 = cute.get_leaves(%140) : !cute.stride<"(0,1)">
    %141 = cute.static : !cute.layout<"(1,8):(0,1)">
    %142 = cute.get_shape(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_281, %e1_282 = cute.get_leaves(%142) : !cute.shape<"(1,8)">
    %143 = cute.get_stride(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_283, %e1_284 = cute.get_leaves(%143) : !cute.stride<"(0,1)">
    %144 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %145 = cute.get_shape(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_285, %e1_286, %e2_287, %e3_288 = cute.get_leaves(%145) : !cute.shape<"(32,4,1,1)">
    %146 = cute.get_stride(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_289, %e1_290, %e2_291, %e3_292 = cute.get_leaves(%146) : !cute.stride<"(1,32,0,0)">
    %147 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_293, %e1_294, %e2_295 = cute.get_leaves(%147) : !cute.tile<"[64:1;16:1;16:1]">
    %148 = cute.get_shape(%e0_293) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_296 = cute.get_leaves(%148) : !cute.shape<"64">
    %149 = cute.get_stride(%e0_293) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_297 = cute.get_leaves(%149) : !cute.stride<"1">
    %150 = cute.get_shape(%e1_294) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_298 = cute.get_leaves(%150) : !cute.shape<"16">
    %151 = cute.get_stride(%e1_294) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_299 = cute.get_leaves(%151) : !cute.stride<"1">
    %152 = cute.get_shape(%e2_295) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_300 = cute.get_leaves(%152) : !cute.shape<"16">
    %153 = cute.get_stride(%e2_295) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_301 = cute.get_leaves(%153) : !cute.stride<"1">
    %154 = cute.static : !cute.layout<"32:1">
    %155 = cute.get_shape(%154) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_302 = cute.get_leaves(%155) : !cute.shape<"32">
    %156 = cute.get_stride(%154) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_303 = cute.get_leaves(%156) : !cute.stride<"1">
    %157 = cute.static : !cute.shape<"(16,8,16)">
    %e0_304, %e1_305, %e2_306 = cute.get_leaves(%157) : !cute.shape<"(16,8,16)">
    %158 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %159 = cute.get_shape(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_307, %e1_308, %e2_309, %e3_310, %e4 = cute.get_leaves(%159) : !cute.shape<"((4,8),(2,2,2))">
    %160 = cute.get_stride(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_311, %e1_312, %e2_313, %e3_314, %e4_315 = cute.get_leaves(%160) : !cute.stride<"((32,1),(16,8,128))">
    %161 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %162 = cute.get_shape(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_316, %e1_317, %e2_318, %e3_319 = cute.get_leaves(%162) : !cute.shape<"((4,8),(2,2))">
    %163 = cute.get_stride(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_320, %e1_321, %e2_322, %e3_323 = cute.get_leaves(%163) : !cute.stride<"((16,1),(8,64))">
    %164 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %165 = cute.get_shape(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_324, %e1_325, %e2_326, %e3_327 = cute.get_leaves(%165) : !cute.shape<"((4,8),(2,2))">
    %166 = cute.get_stride(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_328, %e1_329, %e2_330, %e3_331 = cute.get_leaves(%166) : !cute.stride<"((32,1),(16,8))">
    %c65536_i32 = arith.constant 65536 : i32
    %167 = arith.extsi %c65536_i32 : i32 to i64
    %c128_i32_332 = arith.constant 128 : i32
    %c1_i32 = arith.constant 1 : i32
    %168 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32_332, %c1_i32, %c1_i32), dynamicSmemBytes = %167, gridDim = (%55, %56, %57), stream = %arg5) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2>
    %169 = cuda.launch_ex @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0<%168> (%arg0, %arg1, %arg2, %arg3, %58) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, f32) -> !cuda.result
    %170 = cuda.cast %169 : !cuda.result -> i32
    cuda.return_if_error %170 : i32
    %c0_i32 = arith.constant 0 : i32
    return %c0_i32 : i32
  }
}
