!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1)):((1,0))">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_10 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<16>, "((8,1)):((1,0))">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((8,1)):((1,0))">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<16>, "((2,2,2)):((1,2,4))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((2,2)):((1,2))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<8>, "(((2,2),2)):(((1,2),8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_25 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_26 = !cute.memref<bf16, rmem, align<8>, "((1,(4,2))):((0,(1,8)))">
!memref_rmem_bf16_27 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_28 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_29 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_30 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<16>, "((2,2)):((1,2))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<32>, "(4):(1)">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_11 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_12 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, "(1):(2)">
!memref_rmem_i8_5 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1)):((1,0))">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_23 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2))):((0,(1,512,?{div=8})))">
!memref_smem_bf16_24 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loop_unroll = #llvm.loop_unroll<disable = false, full = true>
#loop_annotation = #llvm.loop_annotation<unroll = #loop_unroll>
module attributes {gpu.container_module} {
  gpu.module @kernels {
    func.func public @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32) attributes {cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %0 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %1 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
      %2 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
      %3 = cute.static : !copy_ldgsts
      %4 = cute.static : !copy_simt
      %5 = cute.static : !mma_bf16_bf16_f32_16x8x16_
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %6 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0, %e1, %e2, %e3 = cute.get_leaves(%6) : !cute.shape<"(?,?,?,?{div=8})">
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %7 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %8 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %9 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %10 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
      %11 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%11) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %12 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %13 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %14 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %15 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%15) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %16 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %17 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %18 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %19 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
      %20 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%20) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %21 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %22 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %23 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %24 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%24) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %25 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %26 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %27 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %28 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
      %29 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%29) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %30 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %31 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %32 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %33 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%33) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %34 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %35 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %36 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %37 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
      %38 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%38) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %39 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %40 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %41 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
      %42 = cute.composed_get_inner(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %43 = cute.composed_get_offset(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_65 = cute.get_leaves(%43) : !cute.int_tuple<"0">
      %44 = cute.composed_get_outer(%0) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %45 = cute.get_shape(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%45) : !cute.shape<"((8,16),(64,2))">
      %46 = cute.get_stride(%44) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%46) : !cute.stride<"((64,512),(1,8192))">
      %47 = cute.composed_get_inner(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
      %48 = cute.composed_get_offset(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
      %e0_74 = cute.get_leaves(%48) : !cute.int_tuple<"0">
      %49 = cute.composed_get_outer(%1) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
      %50 = cute.get_shape(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%50) : !cute.shape<"((8,8),(64,2))">
      %51 = cute.get_stride(%49) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%51) : !cute.stride<"((64,512),(1,4096))">
      %52 = cute.composed_get_inner(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
      %53 = cute.composed_get_offset(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
      %e0_83 = cute.get_leaves(%53) : !cute.int_tuple<"0">
      %54 = cute.composed_get_outer(%2) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
      %55 = cute.get_shape(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%55) : !cute.shape<"((8,16),(64,2))">
      %56 = cute.get_stride(%54) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%56) : !cute.stride<"((64,512),(1,8192))">
      %57 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_92, %e1_93 = cute.get_leaves(%57) : !cute.tile<"[16:1;64:1]">
      %58 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_94 = cute.get_leaves(%58) : !cute.shape<"16">
      %59 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_95 = cute.get_leaves(%59) : !cute.stride<"1">
      %60 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_96 = cute.get_leaves(%60) : !cute.shape<"64">
      %61 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_97 = cute.get_leaves(%61) : !cute.stride<"1">
      %62 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %63 = cute.get_shape(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%63) : !cute.shape<"((8,16),8)">
      %64 = cute.get_stride(%62) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%64) : !cute.stride<"((128,1),16)">
      %65 = cute.static : !cute.layout<"1:0">
      %66 = cute.get_shape(%65) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_104 = cute.get_leaves(%66) : !cute.shape<"1">
      %67 = cute.get_stride(%65) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_105 = cute.get_leaves(%67) : !cute.stride<"0">
      %68 = cute.static : !cute.layout<"(1,8):(0,1)">
      %69 = cute.get_shape(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_106, %e1_107 = cute.get_leaves(%69) : !cute.shape<"(1,8)">
      %70 = cute.get_stride(%68) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_108, %e1_109 = cute.get_leaves(%70) : !cute.stride<"(0,1)">
      %71 = cute.static : !cute.layout<"(1,8):(0,1)">
      %72 = cute.get_shape(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_110, %e1_111 = cute.get_leaves(%72) : !cute.shape<"(1,8)">
      %73 = cute.get_stride(%71) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_112, %e1_113 = cute.get_leaves(%73) : !cute.stride<"(0,1)">
      %74 = cute.static : !cute.tile<"[16:1;64:1]">
      %e0_114, %e1_115 = cute.get_leaves(%74) : !cute.tile<"[16:1;64:1]">
      %75 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_116 = cute.get_leaves(%75) : !cute.shape<"16">
      %76 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_117 = cute.get_leaves(%76) : !cute.stride<"1">
      %77 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_118 = cute.get_leaves(%77) : !cute.shape<"64">
      %78 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_119 = cute.get_leaves(%78) : !cute.stride<"1">
      %79 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
      %80 = cute.get_shape(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%80) : !cute.shape<"((8,16),8)">
      %81 = cute.get_stride(%79) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%81) : !cute.stride<"((128,1),16)">
      %82 = cute.static : !cute.layout<"1:0">
      %83 = cute.get_shape(%82) : (!cute.layout<"1:0">) -> !cute.shape<"1">
      %e0_126 = cute.get_leaves(%83) : !cute.shape<"1">
      %84 = cute.get_stride(%82) : (!cute.layout<"1:0">) -> !cute.stride<"0">
      %e0_127 = cute.get_leaves(%84) : !cute.stride<"0">
      %85 = cute.static : !cute.layout<"(1,8):(0,1)">
      %86 = cute.get_shape(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_128, %e1_129 = cute.get_leaves(%86) : !cute.shape<"(1,8)">
      %87 = cute.get_stride(%85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_130, %e1_131 = cute.get_leaves(%87) : !cute.stride<"(0,1)">
      %88 = cute.static : !cute.layout<"(1,8):(0,1)">
      %89 = cute.get_shape(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
      %e0_132, %e1_133 = cute.get_leaves(%89) : !cute.shape<"(1,8)">
      %90 = cute.get_stride(%88) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
      %e0_134, %e1_135 = cute.get_leaves(%90) : !cute.stride<"(0,1)">
      %91 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
      %92 = cute.get_shape(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%92) : !cute.shape<"(32,4,1,1)">
      %93 = cute.get_stride(%91) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%93) : !cute.stride<"(1,32,0,0)">
      %94 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%94) : !cute.tile<"[64:1;16:1;16:1]">
      %95 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64">
      %e0_147 = cute.get_leaves(%95) : !cute.shape<"64">
      %96 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1">
      %e0_148 = cute.get_leaves(%96) : !cute.stride<"1">
      %97 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_149 = cute.get_leaves(%97) : !cute.shape<"16">
      %98 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_150 = cute.get_leaves(%98) : !cute.stride<"1">
      %99 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16">
      %e0_151 = cute.get_leaves(%99) : !cute.shape<"16">
      %100 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1">
      %e0_152 = cute.get_leaves(%100) : !cute.stride<"1">
      %101 = cute.static : !cute.layout<"32:1">
      %102 = cute.get_shape(%101) : (!cute.layout<"32:1">) -> !cute.shape<"32">
      %e0_153 = cute.get_leaves(%102) : !cute.shape<"32">
      %103 = cute.get_stride(%101) : (!cute.layout<"32:1">) -> !cute.stride<"1">
      %e0_154 = cute.get_leaves(%103) : !cute.stride<"1">
      %104 = cute.static : !cute.shape<"(16,8,16)">
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%104) : !cute.shape<"(16,8,16)">
      %105 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2,2))">
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8,128))">
      %108 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
      %109 = cute.get_shape(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%109) : !cute.shape<"((4,8),(2,2))">
      %110 = cute.get_stride(%108) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%110) : !cute.stride<"((16,1),(8,64))">
      %111 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
      %112 = cute.get_shape(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%112) : !cute.shape<"((4,8),(2,2))">
      %113 = cute.get_stride(%111) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%113) : !cute.stride<"((32,1),(16,8))">
      %114 = nvvm.read.ptx.sreg.tid.x : i32
      %115 = nvvm.read.ptx.sreg.tid.y : i32
      %116 = nvvm.read.ptx.sreg.tid.z : i32
      %117 = nvvm.read.ptx.sreg.ctaid.x : i32
      %118 = nvvm.read.ptx.sreg.ctaid.y : i32
      %119 = nvvm.read.ptx.sreg.ctaid.z : i32
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %120 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%120) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %121 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %122 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %123 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?">
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %124 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}">
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
      %tile = cute.make_tile() : () -> !cute.tile<"64:1">
      %125 = cute.get_scalars(%int_tuple) <{only_dynamic}> : !cute.int_tuple<"?">
      %c64_i32 = arith.constant 64 : i32
      %126 = arith.ceildivsi %125, %c64_i32 : i32
      %int_tuple_192 = cute.make_int_tuple(%126) : (i32) -> !cute.int_tuple<"?">
      %e0_193 = cute.get_leaves(%int_tuple_192) : !cute.int_tuple<"?">
      %127 = cute.get_scalars(%e0_193) : !cute.int_tuple<"?">
      %false = arith.constant false
      %128 = scf.if %false -> (i32) {
        %c1_i32_7719 = arith.constant 1 : i32
        %2485 = arith.addi %117, %c1_i32_7719 : i32
        %c128_i32_7720 = arith.constant 128 : i32
        %2486 = arith.muli %2485, %c128_i32_7720 : i32
        %int_tuple_7721 = cute.make_int_tuple(%2486) : (i32) -> !cute.int_tuple<"?">
        %tile_7722 = cute.make_tile() : () -> !cute.tile<"64:1">
        %2487 = cute.get_scalars(%int_tuple_7721) <{only_dynamic}> : !cute.int_tuple<"?">
        %c64_i32_7723 = arith.constant 64 : i32
        %2488 = arith.ceildivsi %2487, %c64_i32_7723 : i32
        %int_tuple_7724 = cute.make_int_tuple(%2488) : (i32) -> !cute.int_tuple<"?">
        %e0_7725 = cute.get_leaves(%int_tuple_7724) : !cute.int_tuple<"?">
        %2489 = cute.get_scalars(%e0_7725) : !cute.int_tuple<"?">
        %2490 = arith.minsi %2489, %127 : i32
        scf.yield %2490 : i32
      } else {
        scf.yield %127 : i32
      }
      %c1_i32 = arith.constant 1 : i32
      %129 = arith.subi %128, %c1_i32 : i32
      %coord = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_194 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %slice = cute.slice(%lay_194, %coord) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx = cute.crd2idx(%coord, %lay_194) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_195 = cute.get_iter(%arg0) : !memref_gmem_bf16_
      %ptr = cute.add_offset(%iter_195, %idx) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view = cute.make_view(%ptr, %slice) : !memref_gmem_bf16_1
      %iter_196 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %tile_197 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_198 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %130 = cute.get_scalars(%coord_198) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_199 = cute.make_coord(%130) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_200 = cute.get_layout(%view) : !memref_gmem_bf16_1
      %131:3 = cute.get_scalars(%lay_200) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32 = arith.constant 128 : i32
      %132 = arith.ceildivsi %131#0, %c128_i32 : i32
      %c128_i64 = arith.constant 128 : i64
      %133 = arith.muli %131#2, %c128_i64 : i64
      %c128_i32_201 = arith.constant 128 : i32
      %134 = arith.ceildivsi %131#1, %c128_i32_201 : i32
      %shape = cute.make_shape(%132, %134) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv = cute.assume(%131#2) : (i64) -> !cute.i64<divby 8>
      %iv_202 = cute.assume(%133) : (i64) -> !cute.i64<divby 1024>
      %stride = cute.make_stride(%iv, %iv_202) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_203 = cute.make_layout(%shape, %stride) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %slice_204 = cute.slice(%lay_203, %coord_199) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_205 = cute.crd2idx(%coord_199, %lay_203) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_206 = cute.get_iter(%view) : !memref_gmem_bf16_1
      %ptr_207 = cute.add_offset(%iter_206, %idx_205) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_208 = cute.make_view(%ptr_207, %slice_204) : !memref_gmem_bf16_2
      %iter_209 = cute.get_iter(%view_208) : !memref_gmem_bf16_2
      %coord_210 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_211 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %slice_212 = cute.slice(%lay_211, %coord_210) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_213 = cute.crd2idx(%coord_210, %lay_211) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_214 = cute.get_iter(%arg1) : !memref_gmem_bf16_
      %ptr_215 = cute.add_offset(%iter_214, %idx_213) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_216 = cute.make_view(%ptr_215, %slice_212) : !memref_gmem_bf16_1
      %iter_217 = cute.get_iter(%view_216) : !memref_gmem_bf16_1
      %tile_218 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_219 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_220 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_221 = cute.get_layout(%view_216) : !memref_gmem_bf16_1
      %135:3 = cute.get_scalars(%lay_221) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_222 = arith.constant 64 : i32
      %136 = arith.ceildivsi %135#0, %c64_i32_222 : i32
      %c64_i64 = arith.constant 64 : i64
      %137 = arith.muli %135#2, %c64_i64 : i64
      %c128_i32_223 = arith.constant 128 : i32
      %138 = arith.ceildivsi %135#1, %c128_i32_223 : i32
      %shape_224 = cute.make_shape(%136, %138) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_225 = cute.assume(%135#2) : (i64) -> !cute.i64<divby 8>
      %iv_226 = cute.assume(%137) : (i64) -> !cute.i64<divby 512>
      %stride_227 = cute.make_stride(%iv_225, %iv_226) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_228 = cute.make_layout(%shape_224, %stride_227) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_229 = cute.slice(%lay_228, %coord_220) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_230 = cute.crd2idx(%coord_220, %lay_228) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_231 = cute.get_iter(%view_216) : !memref_gmem_bf16_1
      %ptr_232 = cute.add_offset(%iter_231, %idx_230) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_233 = cute.make_view(%ptr_232, %slice_229) : !memref_gmem_bf16_3
      %iter_234 = cute.get_iter(%view_233) : !memref_gmem_bf16_3
      %coord_235 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_236 = cute.get_layout(%arg2) : !memref_gmem_bf16_
      %slice_237 = cute.slice(%lay_236, %coord_235) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_238 = cute.crd2idx(%coord_235, %lay_236) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_239 = cute.get_iter(%arg2) : !memref_gmem_bf16_
      %ptr_240 = cute.add_offset(%iter_239, %idx_238) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_241 = cute.make_view(%ptr_240, %slice_237) : !memref_gmem_bf16_1
      %iter_242 = cute.get_iter(%view_241) : !memref_gmem_bf16_1
      %tile_243 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_244 = cute.make_coord() : () -> !cute.coord<"(_,0)">
      %coord_245 = cute.make_coord() : () -> !cute.coord<"((_,_),(_,0))">
      %lay_246 = cute.get_layout(%view_241) : !memref_gmem_bf16_1
      %139:3 = cute.get_scalars(%lay_246) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c64_i32_247 = arith.constant 64 : i32
      %140 = arith.ceildivsi %139#0, %c64_i32_247 : i32
      %c64_i64_248 = arith.constant 64 : i64
      %141 = arith.muli %139#2, %c64_i64_248 : i64
      %c128_i32_249 = arith.constant 128 : i32
      %142 = arith.ceildivsi %139#1, %c128_i32_249 : i32
      %shape_250 = cute.make_shape(%140, %142) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %iv_251 = cute.assume(%139#2) : (i64) -> !cute.i64<divby 8>
      %iv_252 = cute.assume(%141) : (i64) -> !cute.i64<divby 512>
      %stride_253 = cute.make_stride(%iv_251, %iv_252) : (!cute.i64<divby 8>, !cute.i64<divby 512>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=512},128))">
      %lay_254 = cute.make_layout(%shape_250, %stride_253) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">
      %slice_255 = cute.slice(%lay_254, %coord_245) : !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">, !cute.coord<"((_,_),(_,0))">
      %idx_256 = cute.crd2idx(%coord_245, %lay_254) : (!cute.coord<"((_,_),(_,0))">, !cute.layout<"((64,128),(?,?)):((?{i64 div=8},1),(?{i64 div=512},128))">) -> !cute.int_tuple<"0">
      %iter_257 = cute.get_iter(%view_241) : !memref_gmem_bf16_1
      %ptr_258 = cute.add_offset(%iter_257, %idx_256) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_259 = cute.make_view(%ptr_258, %slice_255) : !memref_gmem_bf16_3
      %iter_260 = cute.get_iter(%view_259) : !memref_gmem_bf16_3
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>>
      %int_tuple_261 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536">
      %ptr_262 = cute.add_offset(%smem_ptr, %int_tuple_261) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>>
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32
      %c65536_i32 = arith.constant 65536 : i32
      %143 = arith.cmpi sge, %smem_size, %c65536_i32 : i32
      cf.assert %143, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 65536 bytes. Please reduce the allocation or set a larger smem size in kernel launch."
      %int_tuple_263 = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
      %ptr_264 = cute.add_offset(%smem_ptr, %int_tuple_263) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_265 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768">
      %ptr_266 = cute.add_offset(%smem_ptr, %int_tuple_265) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>>
      %int_tuple_267 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152">
      %ptr_268 = cute.add_offset(%smem_ptr, %int_tuple_267) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>>
      %iter_269 = cute.recast_iter(%ptr_264) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_270 = cute.make_view(%iter_269, %0) : !memref_smem_bf16_
      %iter_271 = cute.get_iter(%view_270) : !memref_smem_bf16_
      %iter_272 = cute.recast_iter(%ptr_266) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_273 = cute.make_view(%iter_272, %1) : !memref_smem_bf16_1
      %iter_274 = cute.get_iter(%view_273) : !memref_smem_bf16_1
      %iter_275 = cute.recast_iter(%ptr_268) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>>
      %view_276 = cute.make_view(%iter_275, %1) : !memref_smem_bf16_1
      %iter_277 = cute.get_iter(%view_276) : !memref_smem_bf16_1
      %shape_278 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %stride_279 = cute.make_stride() : () -> !cute.stride<"(64,1)">
      %lay_280 = cute.make_layout() : !cute.layout<"(128,64):(64,1)">
      %iter_281 = cute.get_iter(%view_276) : !memref_smem_bf16_1
      %view_282 = cute.make_view(%iter_281) : !memref_smem_bf16_2
      %iter_283 = cute.get_iter(%view_282) : !memref_smem_bf16_2
      %coord_284 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned = cute.tiled.copy.partition_S(%3, %view_208, %coord_284) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_285 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
      %coord_286 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned = cute.tiled.copy.partition_D(%3, %view_270, %coord_286) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_287 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
      %coord_288 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_289 = cute.tiled.copy.partition_S(%3, %view_233, %coord_288) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_290 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
      %coord_291 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_292 = cute.tiled.copy.partition_D(%3, %view_273, %coord_291) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_293 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
      %coord_294 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_295 = cute.tiled.copy.partition_S(%3, %view_259, %coord_294) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5
      %iter_296 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
      %coord_297 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_298 = cute.tiled.copy.partition_D(%3, %view_276, %coord_297) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4
      %iter_299 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
      %coord_300 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_A = cute.tiled.mma.partition A (%5, %view_270, %coord_300) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5
      %iter_301 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5
      %frg_A = cute.mma.make_fragment A (%5, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_
      %iter_302 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %coord_303 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B = cute.tiled.mma.partition B (%5, %view_273, %coord_303) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_6
      %iter_304 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6
      %frg_B = cute.mma.make_fragment B (%5, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1
      %iter_305 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %coord_306 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_B_307 = cute.tiled.mma.partition B (%5, %view_282, %coord_306) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7
      %iter_308 = cute.get_iter(%ptn_B_307) : !memref_smem_bf16_7
      %frg_B_309 = cute.mma.make_fragment B (%5, %ptn_B_307) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2
      %iter_310 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
      %shape_311 = cute.make_shape() : () -> !cute.shape<"(128,128)">
      %144 = cute.tiled.mma.partition_shape C (%5, %shape_311) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,128)">) -> !cute.shape<"((2,2),2,16)">
      %e0_312, %e1_313, %e2_314, %e3_315 = cute.get_leaves(%144) : !cute.shape<"((2,2),2,16)">
      %shape_316 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_317 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem = cute.memref.alloca(%lay_317) : !memref_rmem_f32_
      %iter_318 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_319 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_320 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %sz = cute.size(%lay_320) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"128">
      %e0_321 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
      %lay_322 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %145 = cute.get_shape(%lay_322) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_323, %e1_324, %e2_325, %e3_326 = cute.get_leaves(%145) : !cute.shape<"((2,2),2,16)">
      %int_tuple_327 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %res = cute.tuple.product(%int_tuple_327) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_328 = cute.get_leaves(%res) : !cute.int_tuple<"128">
      %cst = arith.constant 0.000000e+00 : f32
      %146 = vector.splat %cst : vector<128xf32>
      %int_tuple_329 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_330 = cute.size(%int_tuple_329) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_331 = cute.get_leaves(%sz_330) : !cute.int_tuple<"128">
      %int_tuple_332 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_333 = cute.size(%int_tuple_332) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_334 = cute.get_leaves(%sz_333) : !cute.int_tuple<"128">
      cute.memref.store_vec %146, %rmem, row_major : !memref_rmem_f32_
      %shape_335 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_336 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_337 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>
      %shape_338 = cute.make_shape() : () -> !cute.shape<"(8,8)">
      %atom_339 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>
      %147 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">
      %148 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_340, %e1_341, %e2_342 = cute.get_leaves(%148) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_343 = cute.size(%e0_340) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_344 = cute.get_leaves(%sz_343) : !cute.int_tuple<"64">
      %149 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_345, %e1_346, %e2_347 = cute.get_leaves(%149) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_348 = cute.size(%e2_347) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_349 = cute.get_leaves(%sz_348) : !cute.int_tuple<"16">
      %tile_350 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %150 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_
      %151 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %152 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_351, %e1_352, %e2_353 = cute.get_leaves(%152) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_354 = cute.size(%e1_352) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_355 = cute.get_leaves(%sz_354) : !cute.int_tuple<"16">
      %153 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_356, %e1_357, %e2_358 = cute.get_leaves(%153) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_359 = cute.size(%e2_358) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_360 = cute.get_leaves(%sz_359) : !cute.int_tuple<"16">
      %tile_361 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %154 = cute.make_tiled_copy(%atom_337) : !copy_ldsm_4_1
      %155 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">
      %156 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_362, %e1_363, %e2_364 = cute.get_leaves(%156) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_365 = cute.size(%e1_363) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_366 = cute.get_leaves(%sz_365) : !cute.int_tuple<"16">
      %157 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_367, %e1_368, %e2_369 = cute.get_leaves(%157) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_370 = cute.size(%e2_369) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_371 = cute.get_leaves(%sz_370) : !cute.int_tuple<"16">
      %tile_372 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]">
      %158 = cute.make_tiled_copy(%atom_339) : !copy_ldsm_4_2
      %coord_373 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_374 = cute.tiled.copy.partition_S(%150, %view_270, %coord_373) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8
      %iter_375 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %retiled = cute.tiled.copy.retile(%150, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3
      %iter_376 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %coord_377 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_378 = cute.tiled.copy.partition_S(%154, %view_273, %coord_377) : (!copy_ldsm_4_1, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_9
      %iter_379 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %retiled_380 = cute.tiled.copy.retile(%154, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4
      %iter_381 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %coord_382 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_383 = cute.tiled.copy.partition_S(%158, %view_282, %coord_382) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10
      %iter_384 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %retiled_385 = cute.tiled.copy.retile(%158, %frg_B_309) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5
      %iter_386 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %lay_387 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %159 = cute.get_shape(%lay_387) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_388, %e1_389, %e2_390, %e3_391 = cute.get_leaves(%159) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_392 = cute.to_int_tuple(%e0_388) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %160 = cute.get_scalars(%itup_392) : !cute.int_tuple<"?">
      %itup_393 = cute.to_int_tuple(%e1_389) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %161 = cute.get_scalars(%itup_393) : !cute.int_tuple<"?">
      %itup_394 = cute.to_int_tuple(%e2_390) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %162 = cute.get_scalars(%itup_394) : !cute.int_tuple<"?">
      %itup_395 = cute.to_int_tuple(%e3_391) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %163 = cute.get_scalars(%itup_395) : !cute.int_tuple<"?{div=8}">
      %shape_396 = cute.make_shape(%itup_392, %itup_393, %itup_394, %itup_395) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %164 = cute.make_identity_tensor(%shape_396) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_397 = cute.get_iter(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_398, %e1_399, %e2_400, %e3_401 = cute.get_leaves(%iter_397) : !cute.int_tuple<"(0,0,0,0)">
      %lay_402 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %165 = cute.get_shape(%lay_402) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_403, %e1_404, %e2_405, %e3_406 = cute.get_leaves(%165) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_407 = cute.to_int_tuple(%e0_403) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %166 = cute.get_scalars(%itup_407) : !cute.int_tuple<"?">
      %itup_408 = cute.to_int_tuple(%e1_404) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %167 = cute.get_scalars(%itup_408) : !cute.int_tuple<"?">
      %itup_409 = cute.to_int_tuple(%e2_405) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %168 = cute.get_scalars(%itup_409) : !cute.int_tuple<"?">
      %itup_410 = cute.to_int_tuple(%e3_406) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %169 = cute.get_scalars(%itup_410) : !cute.int_tuple<"?{div=8}">
      %shape_411 = cute.make_shape(%itup_407, %itup_408, %itup_409, %itup_410) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %170 = cute.make_identity_tensor(%shape_411) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_412 = cute.get_iter(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_413, %e1_414, %e2_415, %e3_416 = cute.get_leaves(%iter_412) : !cute.int_tuple<"(0,0,0,0)">
      %coord_417 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_418 = cute.get_layout(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_419 = cute.slice(%lay_418, %coord_417) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_420 = cute.crd2idx(%coord_417, %lay_418) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_421 = cute.get_iter(%164) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup = cute.add_offset(%iter_421, %idx_420) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_422 = cute.make_view(%tup, %slice_419) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_423 = cute.get_iter(%view_422) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_424, %e1_425, %e2_426, %e3_427 = cute.get_leaves(%iter_423) : !cute.int_tuple<"(?,0,?,0)">
      %171 = cute.get_scalars(%e0_424) : !cute.int_tuple<"?">
      %172 = cute.get_scalars(%e2_426) : !cute.int_tuple<"?">
      %tile_428 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_429 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %173 = cute.get_scalars(%coord_429) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_430 = cute.make_coord(%173) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_431 = cute.get_layout(%view_422) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %174:2 = cute.get_scalars(%lay_431) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_432 = arith.constant 128 : i32
      %175 = arith.ceildivsi %174#0, %c128_i32_432 : i32
      %c128_i32_433 = arith.constant 128 : i32
      %176 = arith.ceildivsi %174#1, %c128_i32_433 : i32
      %shape_434 = cute.make_shape(%175, %176) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_435 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_436 = cute.make_layout(%shape_434, %stride_435) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_437 = cute.crd2idx(%coord_430, %lay_436) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_438 = cute.get_iter(%view_422) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_439 = cute.add_offset(%iter_438, %idx_437) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_440 = cute.make_view(%tup_439) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_441 = cute.get_iter(%view_440) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_442, %e1_443, %e2_444, %e3_445 = cute.get_leaves(%iter_441) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %177 = cute.get_scalars(%e0_442) : !cute.int_tuple<"?">
      %178 = cute.get_scalars(%e1_443) : !cute.int_tuple<"?{div=128}">
      %179 = cute.get_scalars(%e2_444) : !cute.int_tuple<"?">
      %coord_446 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_447 = cute.get_layout(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_448 = cute.slice(%lay_447, %coord_446) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_449 = cute.crd2idx(%coord_446, %lay_447) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_450 = cute.get_iter(%170) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_451 = cute.add_offset(%iter_450, %idx_449) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_452 = cute.make_view(%tup_451, %slice_448) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_453 = cute.get_iter(%view_452) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_454, %e1_455, %e2_456, %e3_457 = cute.get_leaves(%iter_453) : !cute.int_tuple<"(?,0,?,0)">
      %180 = cute.get_scalars(%e0_454) : !cute.int_tuple<"?">
      %181 = cute.get_scalars(%e2_456) : !cute.int_tuple<"?">
      %tile_458 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]">
      %coord_459 = cute.make_coord(%129) : (i32) -> !cute.coord<"(?,0)">
      %182 = cute.get_scalars(%coord_459) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_460 = cute.make_coord(%182) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_461 = cute.get_layout(%view_452) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %183:2 = cute.get_scalars(%lay_461) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c64_i32_462 = arith.constant 64 : i32
      %184 = arith.ceildivsi %183#0, %c64_i32_462 : i32
      %c128_i32_463 = arith.constant 128 : i32
      %185 = arith.ceildivsi %183#1, %c128_i32_463 : i32
      %shape_464 = cute.make_shape(%184, %185) : (i32, i32) -> !cute.shape<"((64,128),(?,?))">
      %stride_465 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(64@1,128@3))">
      %lay_466 = cute.make_layout(%shape_464, %stride_465) : !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">
      %idx_467 = cute.crd2idx(%coord_460, %lay_466) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((64,128),(?,?)):((1@1,1@3),(64@1,128@3))">) -> !cute.int_tuple<"(0,?{div=64},0,0)">
      %iter_468 = cute.get_iter(%view_452) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_469 = cute.add_offset(%iter_468, %idx_467) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=64},0,0)">) -> !cute.int_tuple<"(?,?{div=64},?,0)">
      %view_470 = cute.make_view(%tup_469) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %iter_471 = cute.get_iter(%view_470) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">
      %e0_472, %e1_473, %e2_474, %e3_475 = cute.get_leaves(%iter_471) : !cute.int_tuple<"(?,?{div=64},?,0)">
      %186 = cute.get_scalars(%e0_472) : !cute.int_tuple<"?">
      %187 = cute.get_scalars(%e1_473) : !cute.int_tuple<"?{div=64}">
      %188 = cute.get_scalars(%e2_474) : !cute.int_tuple<"?">
      %coord_476 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_477 = cute.tiled.copy.partition_S(%3, %view_440, %coord_476) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_478 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_479, %e1_480, %e2_481, %e3_482 = cute.get_leaves(%iter_478) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %189 = cute.get_scalars(%e0_479) : !cute.int_tuple<"?">
      %190 = cute.get_scalars(%e1_480) : !cute.int_tuple<"?">
      %191 = cute.get_scalars(%e2_481) : !cute.int_tuple<"?">
      %192 = cute.get_scalars(%e3_482) : !cute.int_tuple<"?{div=8}">
      %coord_483 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_484 = cute.tiled.copy.partition_S(%3, %view_470, %coord_483) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %iter_485 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %e0_486, %e1_487, %e2_488, %e3_489 = cute.get_leaves(%iter_485) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %193 = cute.get_scalars(%e0_486) : !cute.int_tuple<"?">
      %194 = cute.get_scalars(%e1_487) : !cute.int_tuple<"?">
      %195 = cute.get_scalars(%e2_488) : !cute.int_tuple<"?">
      %196 = cute.get_scalars(%e3_489) : !cute.int_tuple<"?{div=8}">
      %lay_490 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %197 = cute.get_shape(%lay_490) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_491, %e1_492, %e2_493, %e3_494 = cute.get_leaves(%197) : !cute.shape<"((8,1),8,2)">
      %lay_495 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_496 = cute.size(%lay_495) <{mode = [1]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"8">
      %e0_497 = cute.get_leaves(%sz_496) : !cute.int_tuple<"8">
      %lay_498 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_499 = cute.size(%lay_498) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_500 = cute.get_leaves(%sz_499) : !cute.int_tuple<"2">
      %lay_501 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
      %sz_502 = cute.size(%lay_501) <{mode = [2]}> : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2">
      %e0_503 = cute.get_leaves(%sz_502) : !cute.int_tuple<"2">
      %shape_504 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_505 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_506 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_507 = cute.memref.alloca(%lay_506) : !memref_rmem_i8_
      %iter_508 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
      %iter_509 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
      %lay_510 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
      %198 = cute.get_shape(%lay_510) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
      %e0_511, %e1_512, %e2_513, %e3_514 = cute.get_leaves(%198) : !cute.shape<"((8,1),4,2)">
      %lay_515 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
      %sz_516 = cute.size(%lay_515) <{mode = [1]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"4">
      %e0_517 = cute.get_leaves(%sz_516) : !cute.int_tuple<"4">
      %lay_518 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
      %sz_519 = cute.size(%lay_518) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_520 = cute.get_leaves(%sz_519) : !cute.int_tuple<"2">
      %lay_521 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
      %sz_522 = cute.size(%lay_521) <{mode = [2]}> : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2">
      %e0_523 = cute.get_leaves(%sz_522) : !cute.int_tuple<"2">
      %shape_524 = cute.make_shape() : () -> !cute.shape<"(1,4,2)">
      %stride_525 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_526 = cute.make_layout() : !cute.layout<"(1,4,2):(2,0,1)">
      %rmem_527 = cute.memref.alloca(%lay_526) : !memref_rmem_i8_1
      %iter_528 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
      %iter_529 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
      %lay_530 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
      %199 = cute.get_shape(%lay_530) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_531, %e1_532, %e2_533 = cute.get_leaves(%199) : !cute.shape<"(1,8,2)">
      %coord_534 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_535 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_536 = cute.crd2idx(%coord_534, %lay_535) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_537 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_538 = cute.add_offset(%iter_537, %idx_536) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_539 = cute.make_view(%tup_538) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_540 = cute.get_iter(%view_539) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_541, %e1_542, %e2_543, %e3_544 = cute.get_leaves(%iter_540) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %200 = cute.get_scalars(%e0_541) : !cute.int_tuple<"?">
      %201 = cute.get_scalars(%e1_542) : !cute.int_tuple<"?">
      %202 = cute.get_scalars(%e2_543) : !cute.int_tuple<"?">
      %203 = cute.get_scalars(%e3_544) : !cute.int_tuple<"?{div=8}">
      %iter_545 = cute.get_iter(%view_539) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_546, %e1_547, %e2_548, %e3_549 = cute.get_leaves(%iter_545) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %204 = cute.get_scalars(%e0_546) : !cute.int_tuple<"?">
      %205 = cute.get_scalars(%e1_547) : !cute.int_tuple<"?">
      %206 = cute.get_scalars(%e2_548) : !cute.int_tuple<"?">
      %207 = cute.get_scalars(%e3_549) : !cute.int_tuple<"?{div=8}">
      %iter_550 = cute.get_iter(%view_539) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_551, %e1_552, %e2_553, %e3_554 = cute.get_leaves(%iter_550) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %208 = cute.get_scalars(%e0_551) : !cute.int_tuple<"?">
      %209 = cute.get_scalars(%e1_552) : !cute.int_tuple<"?">
      %210 = cute.get_scalars(%e2_553) : !cute.int_tuple<"?">
      %211 = cute.get_scalars(%e3_554) : !cute.int_tuple<"?{div=8}">
      %lay_555 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %212 = cute.get_shape(%lay_555) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_556, %e1_557, %e2_558, %e3_559 = cute.get_leaves(%212) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_560 = cute.to_int_tuple(%e0_556) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %213 = cute.get_scalars(%itup_560) : !cute.int_tuple<"?">
      %itup_561 = cute.to_int_tuple(%e1_557) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %214 = cute.get_scalars(%itup_561) : !cute.int_tuple<"?">
      %itup_562 = cute.to_int_tuple(%e2_558) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %215 = cute.get_scalars(%itup_562) : !cute.int_tuple<"?">
      %itup_563 = cute.to_int_tuple(%e3_559) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %216 = cute.get_scalars(%itup_563) : !cute.int_tuple<"?{div=8}">
      %coord_564 = cute.make_coord(%e3_554) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_565 = cute.make_coord(%itup_563) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %217 = cute.elem_less(%coord_564, %coord_565) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %218 = arith.extui %217 : i1 to i8
      %coord_566 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_507, %coord_566, %218) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_567 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_568 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_569 = cute.crd2idx(%coord_567, %lay_568) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_570 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_571 = cute.add_offset(%iter_570, %idx_569) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_572 = cute.make_view(%tup_571) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_573 = cute.get_iter(%view_572) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_574, %e1_575, %e2_576, %e3_577 = cute.get_leaves(%iter_573) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %219 = cute.get_scalars(%e0_574) : !cute.int_tuple<"?">
      %220 = cute.get_scalars(%e1_575) : !cute.int_tuple<"?">
      %221 = cute.get_scalars(%e2_576) : !cute.int_tuple<"?">
      %222 = cute.get_scalars(%e3_577) : !cute.int_tuple<"?{div=8}">
      %iter_578 = cute.get_iter(%view_572) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_579, %e1_580, %e2_581, %e3_582 = cute.get_leaves(%iter_578) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %223 = cute.get_scalars(%e0_579) : !cute.int_tuple<"?">
      %224 = cute.get_scalars(%e1_580) : !cute.int_tuple<"?">
      %225 = cute.get_scalars(%e2_581) : !cute.int_tuple<"?">
      %226 = cute.get_scalars(%e3_582) : !cute.int_tuple<"?{div=8}">
      %iter_583 = cute.get_iter(%view_572) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_584, %e1_585, %e2_586, %e3_587 = cute.get_leaves(%iter_583) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %227 = cute.get_scalars(%e0_584) : !cute.int_tuple<"?">
      %228 = cute.get_scalars(%e1_585) : !cute.int_tuple<"?">
      %229 = cute.get_scalars(%e2_586) : !cute.int_tuple<"?">
      %230 = cute.get_scalars(%e3_587) : !cute.int_tuple<"?{div=8}">
      %lay_588 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %231 = cute.get_shape(%lay_588) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_589, %e1_590, %e2_591, %e3_592 = cute.get_leaves(%231) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_593 = cute.to_int_tuple(%e0_589) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %232 = cute.get_scalars(%itup_593) : !cute.int_tuple<"?">
      %itup_594 = cute.to_int_tuple(%e1_590) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %233 = cute.get_scalars(%itup_594) : !cute.int_tuple<"?">
      %itup_595 = cute.to_int_tuple(%e2_591) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %234 = cute.get_scalars(%itup_595) : !cute.int_tuple<"?">
      %itup_596 = cute.to_int_tuple(%e3_592) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %235 = cute.get_scalars(%itup_596) : !cute.int_tuple<"?{div=8}">
      %coord_597 = cute.make_coord(%e3_587) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_598 = cute.make_coord(%itup_596) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %236 = cute.elem_less(%coord_597, %coord_598) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %237 = arith.extui %236 : i1 to i8
      %coord_599 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_507, %coord_599, %237) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %lay_600 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
      %238 = cute.get_shape(%lay_600) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
      %e0_601, %e1_602, %e2_603 = cute.get_leaves(%238) : !cute.shape<"(1,4,2)">
      %coord_604 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_605 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_606 = cute.crd2idx(%coord_604, %lay_605) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_607 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_608 = cute.add_offset(%iter_607, %idx_606) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_609 = cute.make_view(%tup_608) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_610 = cute.get_iter(%view_609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_611, %e1_612, %e2_613, %e3_614 = cute.get_leaves(%iter_610) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %239 = cute.get_scalars(%e0_611) : !cute.int_tuple<"?">
      %240 = cute.get_scalars(%e1_612) : !cute.int_tuple<"?">
      %241 = cute.get_scalars(%e2_613) : !cute.int_tuple<"?">
      %242 = cute.get_scalars(%e3_614) : !cute.int_tuple<"?{div=8}">
      %iter_615 = cute.get_iter(%view_609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_616, %e1_617, %e2_618, %e3_619 = cute.get_leaves(%iter_615) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %243 = cute.get_scalars(%e0_616) : !cute.int_tuple<"?">
      %244 = cute.get_scalars(%e1_617) : !cute.int_tuple<"?">
      %245 = cute.get_scalars(%e2_618) : !cute.int_tuple<"?">
      %246 = cute.get_scalars(%e3_619) : !cute.int_tuple<"?{div=8}">
      %iter_620 = cute.get_iter(%view_609) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_621, %e1_622, %e2_623, %e3_624 = cute.get_leaves(%iter_620) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %247 = cute.get_scalars(%e0_621) : !cute.int_tuple<"?">
      %248 = cute.get_scalars(%e1_622) : !cute.int_tuple<"?">
      %249 = cute.get_scalars(%e2_623) : !cute.int_tuple<"?">
      %250 = cute.get_scalars(%e3_624) : !cute.int_tuple<"?{div=8}">
      %lay_625 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %251 = cute.get_shape(%lay_625) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_626, %e1_627, %e2_628, %e3_629 = cute.get_leaves(%251) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_630 = cute.to_int_tuple(%e0_626) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %252 = cute.get_scalars(%itup_630) : !cute.int_tuple<"?">
      %itup_631 = cute.to_int_tuple(%e1_627) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %253 = cute.get_scalars(%itup_631) : !cute.int_tuple<"?">
      %itup_632 = cute.to_int_tuple(%e2_628) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %254 = cute.get_scalars(%itup_632) : !cute.int_tuple<"?">
      %itup_633 = cute.to_int_tuple(%e3_629) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %255 = cute.get_scalars(%itup_633) : !cute.int_tuple<"?{div=8}">
      %coord_634 = cute.make_coord(%e3_624) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_635 = cute.make_coord(%itup_633) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %256 = cute.elem_less(%coord_634, %coord_635) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %257 = arith.extui %256 : i1 to i8
      %coord_636 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_527, %coord_636, %257) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_637 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_638 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_639 = cute.crd2idx(%coord_637, %lay_638) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_640 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_641 = cute.add_offset(%iter_640, %idx_639) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_642 = cute.make_view(%tup_641) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_643 = cute.get_iter(%view_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_644, %e1_645, %e2_646, %e3_647 = cute.get_leaves(%iter_643) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %258 = cute.get_scalars(%e0_644) : !cute.int_tuple<"?">
      %259 = cute.get_scalars(%e1_645) : !cute.int_tuple<"?">
      %260 = cute.get_scalars(%e2_646) : !cute.int_tuple<"?">
      %261 = cute.get_scalars(%e3_647) : !cute.int_tuple<"?{div=8}">
      %iter_648 = cute.get_iter(%view_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_649, %e1_650, %e2_651, %e3_652 = cute.get_leaves(%iter_648) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %262 = cute.get_scalars(%e0_649) : !cute.int_tuple<"?">
      %263 = cute.get_scalars(%e1_650) : !cute.int_tuple<"?">
      %264 = cute.get_scalars(%e2_651) : !cute.int_tuple<"?">
      %265 = cute.get_scalars(%e3_652) : !cute.int_tuple<"?{div=8}">
      %iter_653 = cute.get_iter(%view_642) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_654, %e1_655, %e2_656, %e3_657 = cute.get_leaves(%iter_653) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %266 = cute.get_scalars(%e0_654) : !cute.int_tuple<"?">
      %267 = cute.get_scalars(%e1_655) : !cute.int_tuple<"?">
      %268 = cute.get_scalars(%e2_656) : !cute.int_tuple<"?">
      %269 = cute.get_scalars(%e3_657) : !cute.int_tuple<"?{div=8}">
      %lay_658 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %270 = cute.get_shape(%lay_658) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_659, %e1_660, %e2_661, %e3_662 = cute.get_leaves(%270) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_663 = cute.to_int_tuple(%e0_659) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %271 = cute.get_scalars(%itup_663) : !cute.int_tuple<"?">
      %itup_664 = cute.to_int_tuple(%e1_660) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %272 = cute.get_scalars(%itup_664) : !cute.int_tuple<"?">
      %itup_665 = cute.to_int_tuple(%e2_661) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %273 = cute.get_scalars(%itup_665) : !cute.int_tuple<"?">
      %itup_666 = cute.to_int_tuple(%e3_662) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %274 = cute.get_scalars(%itup_666) : !cute.int_tuple<"?{div=8}">
      %coord_667 = cute.make_coord(%e3_657) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_668 = cute.make_coord(%itup_666) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %275 = cute.elem_less(%coord_667, %coord_668) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %276 = arith.extui %275 : i1 to i8
      %coord_669 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_527, %coord_669, %276) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_670 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_671 = cute.size(%int_tuple_670) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_672 = cute.get_leaves(%sz_671) : !cute.int_tuple<"8">
      %coord_673 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_674 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_675 = cute.crd2idx(%coord_673, %lay_674) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_676 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_677 = cute.add_offset(%iter_676, %idx_675) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_678 = cute.make_view(%tup_677) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_679 = cute.get_iter(%view_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_680, %e1_681, %e2_682, %e3_683 = cute.get_leaves(%iter_679) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %277 = cute.get_scalars(%e0_680) : !cute.int_tuple<"?">
      %278 = cute.get_scalars(%e1_681) : !cute.int_tuple<"?">
      %279 = cute.get_scalars(%e2_682) : !cute.int_tuple<"?">
      %280 = cute.get_scalars(%e3_683) : !cute.int_tuple<"?{div=8}">
      %iter_684 = cute.get_iter(%view_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_685, %e1_686, %e2_687, %e3_688 = cute.get_leaves(%iter_684) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %281 = cute.get_scalars(%e0_685) : !cute.int_tuple<"?">
      %282 = cute.get_scalars(%e1_686) : !cute.int_tuple<"?">
      %283 = cute.get_scalars(%e2_687) : !cute.int_tuple<"?">
      %284 = cute.get_scalars(%e3_688) : !cute.int_tuple<"?{div=8}">
      %iter_689 = cute.get_iter(%view_678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_690, %e1_691, %e2_692, %e3_693 = cute.get_leaves(%iter_689) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %285 = cute.get_scalars(%e0_690) : !cute.int_tuple<"?">
      %286 = cute.get_scalars(%e1_691) : !cute.int_tuple<"?">
      %287 = cute.get_scalars(%e2_692) : !cute.int_tuple<"?">
      %288 = cute.get_scalars(%e3_693) : !cute.int_tuple<"?{div=8}">
      %lay_694 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %289 = cute.get_shape(%lay_694) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_695, %e1_696, %e2_697, %e3_698 = cute.get_leaves(%289) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_699 = cute.to_int_tuple(%e0_695) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %290 = cute.get_scalars(%itup_699) : !cute.int_tuple<"?">
      %itup_700 = cute.to_int_tuple(%e1_696) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %291 = cute.get_scalars(%itup_700) : !cute.int_tuple<"?">
      %itup_701 = cute.to_int_tuple(%e2_697) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %292 = cute.get_scalars(%itup_701) : !cute.int_tuple<"?">
      %itup_702 = cute.to_int_tuple(%e3_698) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %293 = cute.get_scalars(%itup_702) : !cute.int_tuple<"?{div=8}">
      %coord_703 = cute.make_coord(%e1_691) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_704 = cute.make_coord(%itup_700) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %294 = cute.elem_less(%coord_703, %coord_704) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %294 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"0">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_705 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_706 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_707 = cute.crd2idx(%coord_705, %lay_706) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_708 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_709 = cute.add_offset(%iter_708, %idx_707) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_710 = cute.make_view(%tup_709) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_711 = cute.get_iter(%view_710) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_712, %e1_713, %e2_714, %e3_715 = cute.get_leaves(%iter_711) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %295 = cute.get_scalars(%e0_712) : !cute.int_tuple<"?">
      %296 = cute.get_scalars(%e1_713) : !cute.int_tuple<"?">
      %297 = cute.get_scalars(%e2_714) : !cute.int_tuple<"?">
      %298 = cute.get_scalars(%e3_715) : !cute.int_tuple<"?{div=8}">
      %iter_716 = cute.get_iter(%view_710) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_717, %e1_718, %e2_719, %e3_720 = cute.get_leaves(%iter_716) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %299 = cute.get_scalars(%e0_717) : !cute.int_tuple<"?">
      %300 = cute.get_scalars(%e1_718) : !cute.int_tuple<"?">
      %301 = cute.get_scalars(%e2_719) : !cute.int_tuple<"?">
      %302 = cute.get_scalars(%e3_720) : !cute.int_tuple<"?{div=8}">
      %iter_721 = cute.get_iter(%view_710) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_722, %e1_723, %e2_724, %e3_725 = cute.get_leaves(%iter_721) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %303 = cute.get_scalars(%e0_722) : !cute.int_tuple<"?">
      %304 = cute.get_scalars(%e1_723) : !cute.int_tuple<"?">
      %305 = cute.get_scalars(%e2_724) : !cute.int_tuple<"?">
      %306 = cute.get_scalars(%e3_725) : !cute.int_tuple<"?{div=8}">
      %lay_726 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %307 = cute.get_shape(%lay_726) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_727, %e1_728, %e2_729, %e3_730 = cute.get_leaves(%307) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_731 = cute.to_int_tuple(%e0_727) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %308 = cute.get_scalars(%itup_731) : !cute.int_tuple<"?">
      %itup_732 = cute.to_int_tuple(%e1_728) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %309 = cute.get_scalars(%itup_732) : !cute.int_tuple<"?">
      %itup_733 = cute.to_int_tuple(%e2_729) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %310 = cute.get_scalars(%itup_733) : !cute.int_tuple<"?">
      %itup_734 = cute.to_int_tuple(%e3_730) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %311 = cute.get_scalars(%itup_734) : !cute.int_tuple<"?{div=8}">
      %coord_735 = cute.make_coord(%e1_723) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_736 = cute.make_coord(%itup_732) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %312 = cute.elem_less(%coord_735, %coord_736) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %312 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"1024">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_737 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_738 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_739 = cute.crd2idx(%coord_737, %lay_738) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_740 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_741 = cute.add_offset(%iter_740, %idx_739) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_742 = cute.make_view(%tup_741) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_743 = cute.get_iter(%view_742) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_744, %e1_745, %e2_746, %e3_747 = cute.get_leaves(%iter_743) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %313 = cute.get_scalars(%e0_744) : !cute.int_tuple<"?">
      %314 = cute.get_scalars(%e1_745) : !cute.int_tuple<"?">
      %315 = cute.get_scalars(%e2_746) : !cute.int_tuple<"?">
      %316 = cute.get_scalars(%e3_747) : !cute.int_tuple<"?{div=8}">
      %iter_748 = cute.get_iter(%view_742) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_749, %e1_750, %e2_751, %e3_752 = cute.get_leaves(%iter_748) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %317 = cute.get_scalars(%e0_749) : !cute.int_tuple<"?">
      %318 = cute.get_scalars(%e1_750) : !cute.int_tuple<"?">
      %319 = cute.get_scalars(%e2_751) : !cute.int_tuple<"?">
      %320 = cute.get_scalars(%e3_752) : !cute.int_tuple<"?{div=8}">
      %iter_753 = cute.get_iter(%view_742) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_754, %e1_755, %e2_756, %e3_757 = cute.get_leaves(%iter_753) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %321 = cute.get_scalars(%e0_754) : !cute.int_tuple<"?">
      %322 = cute.get_scalars(%e1_755) : !cute.int_tuple<"?">
      %323 = cute.get_scalars(%e2_756) : !cute.int_tuple<"?">
      %324 = cute.get_scalars(%e3_757) : !cute.int_tuple<"?{div=8}">
      %lay_758 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %325 = cute.get_shape(%lay_758) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_759, %e1_760, %e2_761, %e3_762 = cute.get_leaves(%325) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_763 = cute.to_int_tuple(%e0_759) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %326 = cute.get_scalars(%itup_763) : !cute.int_tuple<"?">
      %itup_764 = cute.to_int_tuple(%e1_760) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %327 = cute.get_scalars(%itup_764) : !cute.int_tuple<"?">
      %itup_765 = cute.to_int_tuple(%e2_761) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %328 = cute.get_scalars(%itup_765) : !cute.int_tuple<"?">
      %itup_766 = cute.to_int_tuple(%e3_762) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %329 = cute.get_scalars(%itup_766) : !cute.int_tuple<"?{div=8}">
      %coord_767 = cute.make_coord(%e1_755) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_768 = cute.make_coord(%itup_764) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %330 = cute.elem_less(%coord_767, %coord_768) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %330 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"2048">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_769 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_770 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_771 = cute.crd2idx(%coord_769, %lay_770) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_772 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_773 = cute.add_offset(%iter_772, %idx_771) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_774 = cute.make_view(%tup_773) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_775 = cute.get_iter(%view_774) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_776, %e1_777, %e2_778, %e3_779 = cute.get_leaves(%iter_775) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %331 = cute.get_scalars(%e0_776) : !cute.int_tuple<"?">
      %332 = cute.get_scalars(%e1_777) : !cute.int_tuple<"?">
      %333 = cute.get_scalars(%e2_778) : !cute.int_tuple<"?">
      %334 = cute.get_scalars(%e3_779) : !cute.int_tuple<"?{div=8}">
      %iter_780 = cute.get_iter(%view_774) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_781, %e1_782, %e2_783, %e3_784 = cute.get_leaves(%iter_780) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %335 = cute.get_scalars(%e0_781) : !cute.int_tuple<"?">
      %336 = cute.get_scalars(%e1_782) : !cute.int_tuple<"?">
      %337 = cute.get_scalars(%e2_783) : !cute.int_tuple<"?">
      %338 = cute.get_scalars(%e3_784) : !cute.int_tuple<"?{div=8}">
      %iter_785 = cute.get_iter(%view_774) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_786, %e1_787, %e2_788, %e3_789 = cute.get_leaves(%iter_785) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %339 = cute.get_scalars(%e0_786) : !cute.int_tuple<"?">
      %340 = cute.get_scalars(%e1_787) : !cute.int_tuple<"?">
      %341 = cute.get_scalars(%e2_788) : !cute.int_tuple<"?">
      %342 = cute.get_scalars(%e3_789) : !cute.int_tuple<"?{div=8}">
      %lay_790 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %343 = cute.get_shape(%lay_790) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_791, %e1_792, %e2_793, %e3_794 = cute.get_leaves(%343) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_795 = cute.to_int_tuple(%e0_791) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %344 = cute.get_scalars(%itup_795) : !cute.int_tuple<"?">
      %itup_796 = cute.to_int_tuple(%e1_792) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %345 = cute.get_scalars(%itup_796) : !cute.int_tuple<"?">
      %itup_797 = cute.to_int_tuple(%e2_793) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %346 = cute.get_scalars(%itup_797) : !cute.int_tuple<"?">
      %itup_798 = cute.to_int_tuple(%e3_794) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %347 = cute.get_scalars(%itup_798) : !cute.int_tuple<"?{div=8}">
      %coord_799 = cute.make_coord(%e1_787) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_800 = cute.make_coord(%itup_796) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %348 = cute.elem_less(%coord_799, %coord_800) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %348 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"3072">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_801 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_802 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_803 = cute.crd2idx(%coord_801, %lay_802) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_804 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_805 = cute.add_offset(%iter_804, %idx_803) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_806 = cute.make_view(%tup_805) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_807 = cute.get_iter(%view_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_808, %e1_809, %e2_810, %e3_811 = cute.get_leaves(%iter_807) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %349 = cute.get_scalars(%e0_808) : !cute.int_tuple<"?">
      %350 = cute.get_scalars(%e1_809) : !cute.int_tuple<"?">
      %351 = cute.get_scalars(%e2_810) : !cute.int_tuple<"?">
      %352 = cute.get_scalars(%e3_811) : !cute.int_tuple<"?{div=8}">
      %iter_812 = cute.get_iter(%view_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_813, %e1_814, %e2_815, %e3_816 = cute.get_leaves(%iter_812) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %353 = cute.get_scalars(%e0_813) : !cute.int_tuple<"?">
      %354 = cute.get_scalars(%e1_814) : !cute.int_tuple<"?">
      %355 = cute.get_scalars(%e2_815) : !cute.int_tuple<"?">
      %356 = cute.get_scalars(%e3_816) : !cute.int_tuple<"?{div=8}">
      %iter_817 = cute.get_iter(%view_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_818, %e1_819, %e2_820, %e3_821 = cute.get_leaves(%iter_817) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %357 = cute.get_scalars(%e0_818) : !cute.int_tuple<"?">
      %358 = cute.get_scalars(%e1_819) : !cute.int_tuple<"?">
      %359 = cute.get_scalars(%e2_820) : !cute.int_tuple<"?">
      %360 = cute.get_scalars(%e3_821) : !cute.int_tuple<"?{div=8}">
      %lay_822 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %361 = cute.get_shape(%lay_822) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_823, %e1_824, %e2_825, %e3_826 = cute.get_leaves(%361) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_827 = cute.to_int_tuple(%e0_823) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %362 = cute.get_scalars(%itup_827) : !cute.int_tuple<"?">
      %itup_828 = cute.to_int_tuple(%e1_824) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %363 = cute.get_scalars(%itup_828) : !cute.int_tuple<"?">
      %itup_829 = cute.to_int_tuple(%e2_825) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %364 = cute.get_scalars(%itup_829) : !cute.int_tuple<"?">
      %itup_830 = cute.to_int_tuple(%e3_826) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %365 = cute.get_scalars(%itup_830) : !cute.int_tuple<"?{div=8}">
      %coord_831 = cute.make_coord(%e1_819) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_832 = cute.make_coord(%itup_828) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %366 = cute.elem_less(%coord_831, %coord_832) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %366 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"4096">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_833 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_834 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_835 = cute.crd2idx(%coord_833, %lay_834) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_836 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_837 = cute.add_offset(%iter_836, %idx_835) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_838 = cute.make_view(%tup_837) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_839 = cute.get_iter(%view_838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_840, %e1_841, %e2_842, %e3_843 = cute.get_leaves(%iter_839) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %367 = cute.get_scalars(%e0_840) : !cute.int_tuple<"?">
      %368 = cute.get_scalars(%e1_841) : !cute.int_tuple<"?">
      %369 = cute.get_scalars(%e2_842) : !cute.int_tuple<"?">
      %370 = cute.get_scalars(%e3_843) : !cute.int_tuple<"?{div=8}">
      %iter_844 = cute.get_iter(%view_838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_845, %e1_846, %e2_847, %e3_848 = cute.get_leaves(%iter_844) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %371 = cute.get_scalars(%e0_845) : !cute.int_tuple<"?">
      %372 = cute.get_scalars(%e1_846) : !cute.int_tuple<"?">
      %373 = cute.get_scalars(%e2_847) : !cute.int_tuple<"?">
      %374 = cute.get_scalars(%e3_848) : !cute.int_tuple<"?{div=8}">
      %iter_849 = cute.get_iter(%view_838) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_850, %e1_851, %e2_852, %e3_853 = cute.get_leaves(%iter_849) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %375 = cute.get_scalars(%e0_850) : !cute.int_tuple<"?">
      %376 = cute.get_scalars(%e1_851) : !cute.int_tuple<"?">
      %377 = cute.get_scalars(%e2_852) : !cute.int_tuple<"?">
      %378 = cute.get_scalars(%e3_853) : !cute.int_tuple<"?{div=8}">
      %lay_854 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %379 = cute.get_shape(%lay_854) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_855, %e1_856, %e2_857, %e3_858 = cute.get_leaves(%379) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_859 = cute.to_int_tuple(%e0_855) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %380 = cute.get_scalars(%itup_859) : !cute.int_tuple<"?">
      %itup_860 = cute.to_int_tuple(%e1_856) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %381 = cute.get_scalars(%itup_860) : !cute.int_tuple<"?">
      %itup_861 = cute.to_int_tuple(%e2_857) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %382 = cute.get_scalars(%itup_861) : !cute.int_tuple<"?">
      %itup_862 = cute.to_int_tuple(%e3_858) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %383 = cute.get_scalars(%itup_862) : !cute.int_tuple<"?{div=8}">
      %coord_863 = cute.make_coord(%e1_851) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_864 = cute.make_coord(%itup_860) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %384 = cute.elem_less(%coord_863, %coord_864) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %384 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"5120">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"5120">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_865 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_866 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_867 = cute.crd2idx(%coord_865, %lay_866) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_868 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_869 = cute.add_offset(%iter_868, %idx_867) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_870 = cute.make_view(%tup_869) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_871 = cute.get_iter(%view_870) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_872, %e1_873, %e2_874, %e3_875 = cute.get_leaves(%iter_871) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %385 = cute.get_scalars(%e0_872) : !cute.int_tuple<"?">
      %386 = cute.get_scalars(%e1_873) : !cute.int_tuple<"?">
      %387 = cute.get_scalars(%e2_874) : !cute.int_tuple<"?">
      %388 = cute.get_scalars(%e3_875) : !cute.int_tuple<"?{div=8}">
      %iter_876 = cute.get_iter(%view_870) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_877, %e1_878, %e2_879, %e3_880 = cute.get_leaves(%iter_876) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %389 = cute.get_scalars(%e0_877) : !cute.int_tuple<"?">
      %390 = cute.get_scalars(%e1_878) : !cute.int_tuple<"?">
      %391 = cute.get_scalars(%e2_879) : !cute.int_tuple<"?">
      %392 = cute.get_scalars(%e3_880) : !cute.int_tuple<"?{div=8}">
      %iter_881 = cute.get_iter(%view_870) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_882, %e1_883, %e2_884, %e3_885 = cute.get_leaves(%iter_881) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %393 = cute.get_scalars(%e0_882) : !cute.int_tuple<"?">
      %394 = cute.get_scalars(%e1_883) : !cute.int_tuple<"?">
      %395 = cute.get_scalars(%e2_884) : !cute.int_tuple<"?">
      %396 = cute.get_scalars(%e3_885) : !cute.int_tuple<"?{div=8}">
      %lay_886 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %397 = cute.get_shape(%lay_886) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_887, %e1_888, %e2_889, %e3_890 = cute.get_leaves(%397) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_891 = cute.to_int_tuple(%e0_887) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %398 = cute.get_scalars(%itup_891) : !cute.int_tuple<"?">
      %itup_892 = cute.to_int_tuple(%e1_888) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %399 = cute.get_scalars(%itup_892) : !cute.int_tuple<"?">
      %itup_893 = cute.to_int_tuple(%e2_889) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %400 = cute.get_scalars(%itup_893) : !cute.int_tuple<"?">
      %itup_894 = cute.to_int_tuple(%e3_890) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %401 = cute.get_scalars(%itup_894) : !cute.int_tuple<"?{div=8}">
      %coord_895 = cute.make_coord(%e1_883) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_896 = cute.make_coord(%itup_892) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %402 = cute.elem_less(%coord_895, %coord_896) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %402 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"6144">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"6144">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %coord_897 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_898 = cute.get_layout(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_899 = cute.crd2idx(%coord_897, %lay_898) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_900 = cute.get_iter(%src_partitioned_477) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_901 = cute.add_offset(%iter_900, %idx_899) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_902 = cute.make_view(%tup_901) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_903 = cute.get_iter(%view_902) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_904, %e1_905, %e2_906, %e3_907 = cute.get_leaves(%iter_903) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %403 = cute.get_scalars(%e0_904) : !cute.int_tuple<"?">
      %404 = cute.get_scalars(%e1_905) : !cute.int_tuple<"?">
      %405 = cute.get_scalars(%e2_906) : !cute.int_tuple<"?">
      %406 = cute.get_scalars(%e3_907) : !cute.int_tuple<"?{div=8}">
      %iter_908 = cute.get_iter(%view_902) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_909, %e1_910, %e2_911, %e3_912 = cute.get_leaves(%iter_908) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %407 = cute.get_scalars(%e0_909) : !cute.int_tuple<"?">
      %408 = cute.get_scalars(%e1_910) : !cute.int_tuple<"?">
      %409 = cute.get_scalars(%e2_911) : !cute.int_tuple<"?">
      %410 = cute.get_scalars(%e3_912) : !cute.int_tuple<"?{div=8}">
      %iter_913 = cute.get_iter(%view_902) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_914, %e1_915, %e2_916, %e3_917 = cute.get_leaves(%iter_913) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %411 = cute.get_scalars(%e0_914) : !cute.int_tuple<"?">
      %412 = cute.get_scalars(%e1_915) : !cute.int_tuple<"?">
      %413 = cute.get_scalars(%e2_916) : !cute.int_tuple<"?">
      %414 = cute.get_scalars(%e3_917) : !cute.int_tuple<"?{div=8}">
      %lay_918 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %415 = cute.get_shape(%lay_918) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_919, %e1_920, %e2_921, %e3_922 = cute.get_leaves(%415) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_923 = cute.to_int_tuple(%e0_919) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %416 = cute.get_scalars(%itup_923) : !cute.int_tuple<"?">
      %itup_924 = cute.to_int_tuple(%e1_920) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %417 = cute.get_scalars(%itup_924) : !cute.int_tuple<"?">
      %itup_925 = cute.to_int_tuple(%e2_921) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %418 = cute.get_scalars(%itup_925) : !cute.int_tuple<"?">
      %itup_926 = cute.to_int_tuple(%e3_922) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %419 = cute.get_scalars(%itup_926) : !cute.int_tuple<"?{div=8}">
      %coord_927 = cute.make_coord(%e1_915) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_928 = cute.make_coord(%itup_924) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %420 = cute.elem_less(%coord_927, %coord_928) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %420 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7720 = cute.get_layout(%src_partitioned) : !memref_gmem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_7722 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_7729 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_11
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_11
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7734 = cute.get_layout(%rmem_507) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_507) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_11
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_11
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_11
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_11
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_12
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_12
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_12
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8192))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8192)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8192)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8192)))">) -> !cute.int_tuple<"?{div=8192}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=8192}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.int_tuple<"7168">
        %iter_7722 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"7168">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_11
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_11
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_11
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_11
      }
      %int_tuple_929 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_930 = cute.size(%int_tuple_929) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_931 = cute.get_leaves(%sz_930) : !cute.int_tuple<"4">
      %coord_932 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_933 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_934 = cute.crd2idx(%coord_932, %lay_933) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_935 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_936 = cute.add_offset(%iter_935, %idx_934) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_937 = cute.make_view(%tup_936) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_938 = cute.get_iter(%view_937) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_939, %e1_940, %e2_941, %e3_942 = cute.get_leaves(%iter_938) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %421 = cute.get_scalars(%e0_939) : !cute.int_tuple<"?">
      %422 = cute.get_scalars(%e1_940) : !cute.int_tuple<"?">
      %423 = cute.get_scalars(%e2_941) : !cute.int_tuple<"?">
      %424 = cute.get_scalars(%e3_942) : !cute.int_tuple<"?{div=8}">
      %iter_943 = cute.get_iter(%view_937) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_944, %e1_945, %e2_946, %e3_947 = cute.get_leaves(%iter_943) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %425 = cute.get_scalars(%e0_944) : !cute.int_tuple<"?">
      %426 = cute.get_scalars(%e1_945) : !cute.int_tuple<"?">
      %427 = cute.get_scalars(%e2_946) : !cute.int_tuple<"?">
      %428 = cute.get_scalars(%e3_947) : !cute.int_tuple<"?{div=8}">
      %iter_948 = cute.get_iter(%view_937) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_949, %e1_950, %e2_951, %e3_952 = cute.get_leaves(%iter_948) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %429 = cute.get_scalars(%e0_949) : !cute.int_tuple<"?">
      %430 = cute.get_scalars(%e1_950) : !cute.int_tuple<"?">
      %431 = cute.get_scalars(%e2_951) : !cute.int_tuple<"?">
      %432 = cute.get_scalars(%e3_952) : !cute.int_tuple<"?{div=8}">
      %lay_953 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %433 = cute.get_shape(%lay_953) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_954, %e1_955, %e2_956, %e3_957 = cute.get_leaves(%433) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_958 = cute.to_int_tuple(%e0_954) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %434 = cute.get_scalars(%itup_958) : !cute.int_tuple<"?">
      %itup_959 = cute.to_int_tuple(%e1_955) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %435 = cute.get_scalars(%itup_959) : !cute.int_tuple<"?">
      %itup_960 = cute.to_int_tuple(%e2_956) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %436 = cute.get_scalars(%itup_960) : !cute.int_tuple<"?">
      %itup_961 = cute.to_int_tuple(%e3_957) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %437 = cute.get_scalars(%itup_961) : !cute.int_tuple<"?{div=8}">
      %coord_962 = cute.make_coord(%e1_950) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_963 = cute.make_coord(%itup_959) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %438 = cute.elem_less(%coord_962, %coord_963) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %438 {
        %coord_7719 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,0,_,?)">
        %lay_7720 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7722 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_7729 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_14
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_14
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7734 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_14
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_14
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_15
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
        %iter_7722 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_14
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_14
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_14
      }
      %coord_964 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_965 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_966 = cute.crd2idx(%coord_964, %lay_965) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_967 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_968 = cute.add_offset(%iter_967, %idx_966) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_969 = cute.make_view(%tup_968) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_970 = cute.get_iter(%view_969) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_971, %e1_972, %e2_973, %e3_974 = cute.get_leaves(%iter_970) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %439 = cute.get_scalars(%e0_971) : !cute.int_tuple<"?">
      %440 = cute.get_scalars(%e1_972) : !cute.int_tuple<"?">
      %441 = cute.get_scalars(%e2_973) : !cute.int_tuple<"?">
      %442 = cute.get_scalars(%e3_974) : !cute.int_tuple<"?{div=8}">
      %iter_975 = cute.get_iter(%view_969) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_976, %e1_977, %e2_978, %e3_979 = cute.get_leaves(%iter_975) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %443 = cute.get_scalars(%e0_976) : !cute.int_tuple<"?">
      %444 = cute.get_scalars(%e1_977) : !cute.int_tuple<"?">
      %445 = cute.get_scalars(%e2_978) : !cute.int_tuple<"?">
      %446 = cute.get_scalars(%e3_979) : !cute.int_tuple<"?{div=8}">
      %iter_980 = cute.get_iter(%view_969) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_981, %e1_982, %e2_983, %e3_984 = cute.get_leaves(%iter_980) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %447 = cute.get_scalars(%e0_981) : !cute.int_tuple<"?">
      %448 = cute.get_scalars(%e1_982) : !cute.int_tuple<"?">
      %449 = cute.get_scalars(%e2_983) : !cute.int_tuple<"?">
      %450 = cute.get_scalars(%e3_984) : !cute.int_tuple<"?{div=8}">
      %lay_985 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %451 = cute.get_shape(%lay_985) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_986, %e1_987, %e2_988, %e3_989 = cute.get_leaves(%451) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_990 = cute.to_int_tuple(%e0_986) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %452 = cute.get_scalars(%itup_990) : !cute.int_tuple<"?">
      %itup_991 = cute.to_int_tuple(%e1_987) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %453 = cute.get_scalars(%itup_991) : !cute.int_tuple<"?">
      %itup_992 = cute.to_int_tuple(%e2_988) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %454 = cute.get_scalars(%itup_992) : !cute.int_tuple<"?">
      %itup_993 = cute.to_int_tuple(%e3_989) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %455 = cute.get_scalars(%itup_993) : !cute.int_tuple<"?{div=8}">
      %coord_994 = cute.make_coord(%e1_982) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_995 = cute.make_coord(%itup_991) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %456 = cute.elem_less(%coord_994, %coord_995) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %456 {
        %coord_7719 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,1,_,?)">
        %lay_7720 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7722 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_7729 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_14
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_14
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7734 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_14
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_14
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_15
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
        %iter_7722 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_14
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_14
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_14
      }
      %coord_996 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_997 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_998 = cute.crd2idx(%coord_996, %lay_997) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_999 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1000 = cute.add_offset(%iter_999, %idx_998) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1001 = cute.make_view(%tup_1000) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1002 = cute.get_iter(%view_1001) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1003, %e1_1004, %e2_1005, %e3_1006 = cute.get_leaves(%iter_1002) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %457 = cute.get_scalars(%e0_1003) : !cute.int_tuple<"?">
      %458 = cute.get_scalars(%e1_1004) : !cute.int_tuple<"?">
      %459 = cute.get_scalars(%e2_1005) : !cute.int_tuple<"?">
      %460 = cute.get_scalars(%e3_1006) : !cute.int_tuple<"?{div=8}">
      %iter_1007 = cute.get_iter(%view_1001) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1008, %e1_1009, %e2_1010, %e3_1011 = cute.get_leaves(%iter_1007) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %461 = cute.get_scalars(%e0_1008) : !cute.int_tuple<"?">
      %462 = cute.get_scalars(%e1_1009) : !cute.int_tuple<"?">
      %463 = cute.get_scalars(%e2_1010) : !cute.int_tuple<"?">
      %464 = cute.get_scalars(%e3_1011) : !cute.int_tuple<"?{div=8}">
      %iter_1012 = cute.get_iter(%view_1001) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1013, %e1_1014, %e2_1015, %e3_1016 = cute.get_leaves(%iter_1012) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %465 = cute.get_scalars(%e0_1013) : !cute.int_tuple<"?">
      %466 = cute.get_scalars(%e1_1014) : !cute.int_tuple<"?">
      %467 = cute.get_scalars(%e2_1015) : !cute.int_tuple<"?">
      %468 = cute.get_scalars(%e3_1016) : !cute.int_tuple<"?{div=8}">
      %lay_1017 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %469 = cute.get_shape(%lay_1017) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1018, %e1_1019, %e2_1020, %e3_1021 = cute.get_leaves(%469) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1022 = cute.to_int_tuple(%e0_1018) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %470 = cute.get_scalars(%itup_1022) : !cute.int_tuple<"?">
      %itup_1023 = cute.to_int_tuple(%e1_1019) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %471 = cute.get_scalars(%itup_1023) : !cute.int_tuple<"?">
      %itup_1024 = cute.to_int_tuple(%e2_1020) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %472 = cute.get_scalars(%itup_1024) : !cute.int_tuple<"?">
      %itup_1025 = cute.to_int_tuple(%e3_1021) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %473 = cute.get_scalars(%itup_1025) : !cute.int_tuple<"?{div=8}">
      %coord_1026 = cute.make_coord(%e1_1014) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1027 = cute.make_coord(%itup_1023) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %474 = cute.elem_less(%coord_1026, %coord_1027) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %474 {
        %coord_7719 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,2,_,?)">
        %lay_7720 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7722 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_7729 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_14
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_14
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7734 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_14
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_14
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_15
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
        %iter_7722 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_14
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_14
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_14
      }
      %coord_1028 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_1029 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %idx_1030 = cute.crd2idx(%coord_1028, %lay_1029) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_1031 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
      %tup_1032 = cute.add_offset(%iter_1031, %idx_1030) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_1033 = cute.make_view(%tup_1032) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_1034 = cute.get_iter(%view_1033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1035, %e1_1036, %e2_1037, %e3_1038 = cute.get_leaves(%iter_1034) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %475 = cute.get_scalars(%e0_1035) : !cute.int_tuple<"?">
      %476 = cute.get_scalars(%e1_1036) : !cute.int_tuple<"?">
      %477 = cute.get_scalars(%e2_1037) : !cute.int_tuple<"?">
      %478 = cute.get_scalars(%e3_1038) : !cute.int_tuple<"?{div=8}">
      %iter_1039 = cute.get_iter(%view_1033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1040, %e1_1041, %e2_1042, %e3_1043 = cute.get_leaves(%iter_1039) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %479 = cute.get_scalars(%e0_1040) : !cute.int_tuple<"?">
      %480 = cute.get_scalars(%e1_1041) : !cute.int_tuple<"?">
      %481 = cute.get_scalars(%e2_1042) : !cute.int_tuple<"?">
      %482 = cute.get_scalars(%e3_1043) : !cute.int_tuple<"?{div=8}">
      %iter_1044 = cute.get_iter(%view_1033) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_1045, %e1_1046, %e2_1047, %e3_1048 = cute.get_leaves(%iter_1044) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %483 = cute.get_scalars(%e0_1045) : !cute.int_tuple<"?">
      %484 = cute.get_scalars(%e1_1046) : !cute.int_tuple<"?">
      %485 = cute.get_scalars(%e2_1047) : !cute.int_tuple<"?">
      %486 = cute.get_scalars(%e3_1048) : !cute.int_tuple<"?{div=8}">
      %lay_1049 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %487 = cute.get_shape(%lay_1049) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_1050, %e1_1051, %e2_1052, %e3_1053 = cute.get_leaves(%487) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_1054 = cute.to_int_tuple(%e0_1050) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %488 = cute.get_scalars(%itup_1054) : !cute.int_tuple<"?">
      %itup_1055 = cute.to_int_tuple(%e1_1051) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %489 = cute.get_scalars(%itup_1055) : !cute.int_tuple<"?">
      %itup_1056 = cute.to_int_tuple(%e2_1052) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %490 = cute.get_scalars(%itup_1056) : !cute.int_tuple<"?">
      %itup_1057 = cute.to_int_tuple(%e3_1053) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %491 = cute.get_scalars(%itup_1057) : !cute.int_tuple<"?{div=8}">
      %coord_1058 = cute.make_coord(%e1_1046) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_1059 = cute.make_coord(%itup_1055) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %492 = cute.elem_less(%coord_1058, %coord_1059) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %492 {
        %coord_7719 = cute.make_coord(%129) : (i32) -> !cute.coord<"(_,3,_,?)">
        %lay_7720 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7722 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_gmem_bf16_6
        %iter_7725 = cute.get_iter(%view_7724) : !memref_gmem_bf16_6
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_7729 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_smem_bf16_14
        %iter_7732 = cute.get_iter(%view_7731) : !memref_smem_bf16_14
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7734 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_gmem_bf16_6
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_gmem_bf16_6
        %iter_7753 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %lay_7754 = cute.get_layout(%view_7752) : !memref_gmem_bf16_6
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_gmem_bf16_6
        %view_7759 = cute.make_view(%iter_7758) : !memref_gmem_bf16_7
        %iter_7760 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7761 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %lay_7762 = cute.get_layout(%view_7731) : !memref_smem_bf16_14
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_smem_bf16_14
        %iter_7767 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %lay_7768 = cute.get_layout(%view_7766) : !memref_smem_bf16_14
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_smem_bf16_14
        %view_7773 = cute.make_view(%iter_7772) : !memref_smem_bf16_15
        %iter_7774 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %iter_7775 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_gmem_bf16_7
        %iter_7804 = cute.get_iter(%view_7773) : !memref_smem_bf16_15
        %lay_7805 = cute.get_layout(%view_7759) : !memref_gmem_bf16_7
        %lay_7806 = cute.get_layout(%view_7773) : !memref_smem_bf16_15
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_gmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_smem_bf16_13
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7822, %view_7826, %view_7830) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      } else {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7720 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
        %iter_7722 = cute.get_iter(%dst_partitioned_292) : !memref_smem_bf16_4
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_smem_bf16_14
        %iter_7725 = cute.get_iter(%view_7724) : !memref_smem_bf16_14
        %lay_7726 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %sz_7727 = cute.size(%lay_7726) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
        %e0_7728 = cute.get_leaves(%sz_7727) : !cute.int_tuple<"16">
        %lay_7729 = cute.get_layout(%view_7724) : !memref_smem_bf16_14
        %2485 = cute.get_shape(%lay_7729) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7730, %e1_7731, %e2_7732 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %int_tuple_7733 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %res_7734 = cute.tuple.product(%int_tuple_7733) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7735 = cute.get_leaves(%res_7734) : !cute.int_tuple<"16">
        %cst_7736 = arith.constant 0.000000e+00 : bf16
        %2486 = vector.splat %cst_7736 : vector<16xbf16>
        %int_tuple_7737 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7738 = cute.size(%int_tuple_7737) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7739 = cute.get_leaves(%sz_7738) : !cute.int_tuple<"16">
        %int_tuple_7740 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
        %sz_7741 = cute.size(%int_tuple_7740) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
        %e0_7742 = cute.get_leaves(%sz_7741) : !cute.int_tuple<"16">
        cute.memref.store_vec %2486, %view_7724, row_major : !memref_smem_bf16_14
      }
      nvvm.cp.async.commit.group
      %shape_1060 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1061 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1062 = cute.memref.alloca(%lay_1061) : !memref_rmem_f32_1
      %iter_1063 = cute.get_iter(%rmem_1062) : !memref_rmem_f32_1
      %iter_1064 = cute.get_iter(%rmem_1062) : !memref_rmem_f32_1
      %shape_1065 = cute.make_shape() : () -> !cute.shape<"4">
      %lay_1066 = cute.make_layout() : !cute.layout<"4:1">
      %rmem_1067 = cute.memref.alloca(%lay_1066) : !memref_rmem_f32_1
      %iter_1068 = cute.get_iter(%rmem_1067) : !memref_rmem_f32_1
      %iter_1069 = cute.get_iter(%rmem_1067) : !memref_rmem_f32_1
      %lay_1070 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
      %sz_1071 = cute.size(%lay_1070) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1072 = cute.get_leaves(%sz_1071) : !cute.int_tuple<"4">
      %lay_1073 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
      %493 = cute.get_shape(%lay_1073) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1074 = cute.get_leaves(%493) : !cute.shape<"4">
      %cst_1075 = arith.constant 0xFF800000 : f32
      %494 = vector.splat %cst_1075 : vector<4xf32>
      %int_tuple_1076 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1077 = cute.size(%int_tuple_1076) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1078 = cute.get_leaves(%sz_1077) : !cute.int_tuple<"4">
      %int_tuple_1079 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1080 = cute.size(%int_tuple_1079) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1081 = cute.get_leaves(%sz_1080) : !cute.int_tuple<"4">
      cute.memref.store_vec %494, %rmem_1062, row_major : !memref_rmem_f32_1
      %lay_1082 = cute.get_layout(%rmem_1067) : !memref_rmem_f32_1
      %sz_1083 = cute.size(%lay_1082) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_1084 = cute.get_leaves(%sz_1083) : !cute.int_tuple<"4">
      %lay_1085 = cute.get_layout(%rmem_1067) : !memref_rmem_f32_1
      %495 = cute.get_shape(%lay_1085) : (!cute.layout<"4:1">) -> !cute.shape<"4">
      %e0_1086 = cute.get_leaves(%495) : !cute.shape<"4">
      %cst_1087 = arith.constant 0.000000e+00 : f32
      %496 = vector.splat %cst_1087 : vector<4xf32>
      %int_tuple_1088 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1089 = cute.size(%int_tuple_1088) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1090 = cute.get_leaves(%sz_1089) : !cute.int_tuple<"4">
      %int_tuple_1091 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_1092 = cute.size(%int_tuple_1091) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_1093 = cute.get_leaves(%sz_1092) : !cute.int_tuple<"4">
      cute.memref.store_vec %496, %rmem_1067, row_major : !memref_rmem_f32_1
      %c0_i32 = arith.constant 0 : i32
      %497 = arith.subi %128, %c0_i32 : i32
      %498 = arith.subi %497, %c1_i32 : i32
      %shape_1094 = cute.make_shape() : () -> !cute.shape<"(128,64)">
      %499 = cute.tiled.mma.partition_shape C (%5, %shape_1094) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1095, %e1_1096, %e2_1097, %e3_1098 = cute.get_leaves(%499) : !cute.shape<"((2,2),2,8)">
      %shape_1099 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_1100 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_1101 = cute.memref.alloca(%lay_1100) : !memref_rmem_f32_2
      %iter_1102 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_1103 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_1104 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %sz_1105 = cute.size(%lay_1104) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
      %e0_1106 = cute.get_leaves(%sz_1105) : !cute.int_tuple<"64">
      %lay_1107 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %500 = cute.get_shape(%lay_1107) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_1108, %e1_1109, %e2_1110, %e3_1111 = cute.get_leaves(%500) : !cute.shape<"((2,2),2,8)">
      %int_tuple_1112 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %res_1113 = cute.tuple.product(%int_tuple_1112) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1114 = cute.get_leaves(%res_1113) : !cute.int_tuple<"64">
      %cst_1115 = arith.constant 0.000000e+00 : f32
      %501 = vector.splat %cst_1115 : vector<64xf32>
      %int_tuple_1116 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1117 = cute.size(%int_tuple_1116) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1118 = cute.get_leaves(%sz_1117) : !cute.int_tuple<"64">
      %int_tuple_1119 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_1120 = cute.size(%int_tuple_1119) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_1121 = cute.get_leaves(%sz_1120) : !cute.int_tuple<"64">
      cute.memref.store_vec %501, %rmem_1101, row_major : !memref_rmem_f32_2
      nvvm.cp.async.wait.group 0
      %c1_i32_1122 = arith.constant 1 : i32
      %c128_i32_1123 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_1122 number_of_threads = %c128_i32_1123
      %true = arith.constant true
      scf.if %true {
        %lay_7719 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
        %2485 = cute.get_shape(%lay_7719) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7720, %e1_7721, %e2_7722, %e3_7723 = cute.get_leaves(%2485) : !cute.shape<"((8,1),4,2)">
        %int_tuple_7724 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_7725 = cute.size(%int_tuple_7724) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_7726 = cute.get_leaves(%sz_7725) : !cute.int_tuple<"4">
        %coord_7727 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
        %lay_7728 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7729 = cute.crd2idx(%coord_7727, %lay_7728) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
        %iter_7730 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7731 = cute.add_offset(%iter_7730, %idx_7729) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7732 = cute.make_view(%tup_7731) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7733 = cute.get_iter(%view_7732) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7734, %e1_7735, %e2_7736, %e3_7737 = cute.get_leaves(%iter_7733) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2486 = cute.get_scalars(%e0_7734) : !cute.int_tuple<"?">
        %2487 = cute.get_scalars(%e1_7735) : !cute.int_tuple<"?">
        %2488 = cute.get_scalars(%e2_7736) : !cute.int_tuple<"?">
        %2489 = cute.get_scalars(%e3_7737) : !cute.int_tuple<"?{div=8}">
        %iter_7738 = cute.get_iter(%view_7732) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7739, %e1_7740, %e2_7741, %e3_7742 = cute.get_leaves(%iter_7738) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2490 = cute.get_scalars(%e0_7739) : !cute.int_tuple<"?">
        %2491 = cute.get_scalars(%e1_7740) : !cute.int_tuple<"?">
        %2492 = cute.get_scalars(%e2_7741) : !cute.int_tuple<"?">
        %2493 = cute.get_scalars(%e3_7742) : !cute.int_tuple<"?{div=8}">
        %iter_7743 = cute.get_iter(%view_7732) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7744, %e1_7745, %e2_7746, %e3_7747 = cute.get_leaves(%iter_7743) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2494 = cute.get_scalars(%e0_7744) : !cute.int_tuple<"?">
        %2495 = cute.get_scalars(%e1_7745) : !cute.int_tuple<"?">
        %2496 = cute.get_scalars(%e2_7746) : !cute.int_tuple<"?">
        %2497 = cute.get_scalars(%e3_7747) : !cute.int_tuple<"?{div=8}">
        %lay_7748 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2498 = cute.get_shape(%lay_7748) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7749, %e1_7750, %e2_7751, %e3_7752 = cute.get_leaves(%2498) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7753 = cute.to_int_tuple(%e0_7749) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2499 = cute.get_scalars(%itup_7753) : !cute.int_tuple<"?">
        %itup_7754 = cute.to_int_tuple(%e1_7750) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2500 = cute.get_scalars(%itup_7754) : !cute.int_tuple<"?">
        %itup_7755 = cute.to_int_tuple(%e2_7751) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2501 = cute.get_scalars(%itup_7755) : !cute.int_tuple<"?">
        %itup_7756 = cute.to_int_tuple(%e3_7752) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2502 = cute.get_scalars(%itup_7756) : !cute.int_tuple<"?{div=8}">
        %coord_7757 = cute.make_coord(%e1_7745) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7758 = cute.make_coord(%itup_7754) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2503 = cute.elem_less(%coord_7757, %coord_7758) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2503 {
          %coord_7855 = cute.make_coord(%498) : (i32) -> !cute.coord<"(_,0,_,?)">
          %lay_7856 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_7858 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_gmem_bf16_6
          %iter_7861 = cute.get_iter(%view_7860) : !memref_gmem_bf16_6
          %coord_7862 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7863 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7864 = cute.crd2idx(%coord_7862, %lay_7863) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_7865 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7866 = cute.add_offset(%iter_7865, %idx_7864) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7867 = cute.make_view(%ptr_7866) : !memref_smem_bf16_14
          %iter_7868 = cute.get_iter(%view_7867) : !memref_smem_bf16_14
          %coord_7869 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7870 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7872 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
          %ptr_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7874 = cute.make_view(%ptr_7873) : !memref_rmem_i8_2
          %iter_7875 = cute.get_iter(%view_7874) : !memref_rmem_i8_2
          %lay_7876 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %2558 = cute.get_shape(%lay_7876) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7877, %e1_7878, %e2_7879 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %lay_7880 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %2559 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7881, %e1_7882, %e2_7883 = cute.get_leaves(%2559) : !cute.shape<"((8,1),2)">
          %lay_7884 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
          %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_7888 = cute.make_view(%iter_7861, %append_7887) : !memref_gmem_bf16_6
          %iter_7889 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %lay_7890 = cute.get_layout(%view_7888) : !memref_gmem_bf16_6
          %2560 = cute.get_shape(%lay_7890) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2560) : !cute.shape<"((8,1),2)">
          %iter_7894 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %view_7895 = cute.make_view(%iter_7894) : !memref_gmem_bf16_7
          %iter_7896 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7897 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %lay_7898 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %shape_7899 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7900 = cute.make_layout() : !cute.layout<"1:0">
          %append_7901 = cute.append_to_rank<2> (%lay_7898, %lay_7900) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_7902 = cute.make_view(%iter_7868, %append_7901) : !memref_smem_bf16_14
          %iter_7903 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %lay_7904 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
          %2561 = cute.get_shape(%lay_7904) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7905, %e1_7906, %e2_7907 = cute.get_leaves(%2561) : !cute.shape<"((8,1),2)">
          %iter_7908 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %view_7909 = cute.make_view(%iter_7908) : !memref_smem_bf16_15
          %iter_7910 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %iter_7911 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7912 = cute.get_layout(%view_7874) : !memref_rmem_i8_2
          %shape_7913 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7914 = cute.make_layout() : !cute.layout<"1:0">
          %append_7915 = cute.append_to_rank<2> (%lay_7912, %lay_7914) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_7916 = cute.make_view(%iter_7875, %append_7915) : !memref_rmem_i8_2
          %iter_7917 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %lay_7918 = cute.get_layout(%view_7916) : !memref_rmem_i8_2
          %2562 = cute.get_shape(%lay_7918) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_7919, %e1_7920 = cute.get_leaves(%2562) : !cute.shape<"(1,2)">
          %iter_7921 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %view_7922 = cute.make_view(%iter_7921) : !memref_rmem_i8_3
          %iter_7923 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %iter_7924 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7925 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %2563 = cute.get_shape(%lay_7925) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_7926, %e1_7927, %e2_7928 = cute.get_leaves(%2563) : !cute.shape<"((8,1),(2))">
          %lay_7929 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %2564 = cute.get_shape(%lay_7929) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_7930, %e1_7931, %e2_7932 = cute.get_leaves(%2564) : !cute.shape<"((8,1),(2))">
          %lay_7933 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %sz_7934 = cute.size(%lay_7933) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_7935 = cute.get_leaves(%sz_7934) : !cute.int_tuple<"2">
          %lay_7936 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %sz_7937 = cute.size(%lay_7936) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_7938 = cute.get_leaves(%sz_7937) : !cute.int_tuple<"2">
          %2565 = cute.static : !cute.layout<"1:0">
          %iter_7939 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7940 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7941 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %lay_7942 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %append_7943 = cute.append_to_rank<2> (%lay_7941, %2565) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_7944 = cute.append_to_rank<2> (%lay_7942, %2565) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_7945 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_7946 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_7947 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7948 = cute.get_layout(%view_7922) : !memref_rmem_i8_3
          %append_7949 = cute.append_to_rank<2> (%lay_7948, %2565) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_7950 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_7951 = cute.size(%lay_7945) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2566 = cute.get_scalars(%sz_7951) : !cute.int_tuple<"2">
          %c0_i32_7952 = arith.constant 0 : i32
          %c1_i32_7953 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_7952 to %2566 step %c1_i32_7953  : i32 {
            %coord_7954 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_7955 = cute.slice(%lay_7945, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_7956 = cute.crd2idx(%coord_7954, %lay_7945) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_7957 = cute.add_offset(%iter_7939, %idx_7956) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_7958 = cute.make_view(%ptr_7957, %slice_7955) : !memref_gmem_bf16_8
            %slice_7959 = cute.slice(%lay_7946, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_7960 = cute.crd2idx(%coord_7954, %lay_7946) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_7961 = cute.add_offset(%iter_7940, %idx_7960) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_7962 = cute.make_view(%ptr_7961, %slice_7959) : !memref_smem_bf16_13
            %slice_7963 = cute.slice(%lay_7950, %coord_7954) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_7964 = cute.crd2idx(%coord_7954, %lay_7950) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_7965 = cute.add_offset(%iter_7947, %idx_7964) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_7966 = cute.make_view(%ptr_7965, %slice_7963) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_7958, %view_7962, %view_7966) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7855 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
          %lay_7856 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
          %iter_7858 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_smem_bf16_14
          %iter_7861 = cute.get_iter(%view_7860) : !memref_smem_bf16_14
          %lay_7862 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %sz_7863 = cute.size(%lay_7862) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7864 = cute.get_leaves(%sz_7863) : !cute.int_tuple<"16">
          %lay_7865 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %2558 = cute.get_shape(%lay_7865) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7866, %e1_7867, %e2_7868 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %int_tuple_7869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7870 = cute.tuple.product(%int_tuple_7869) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7871 = cute.get_leaves(%res_7870) : !cute.int_tuple<"16">
          %cst_7872 = arith.constant 0.000000e+00 : bf16
          %2559 = vector.splat %cst_7872 : vector<16xbf16>
          %int_tuple_7873 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7874 = cute.size(%int_tuple_7873) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7875 = cute.get_leaves(%sz_7874) : !cute.int_tuple<"16">
          %int_tuple_7876 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7877 = cute.size(%int_tuple_7876) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7878 = cute.get_leaves(%sz_7877) : !cute.int_tuple<"16">
          cute.memref.store_vec %2559, %view_7860, row_major : !memref_smem_bf16_14
        }
        %coord_7759 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
        %lay_7760 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7761 = cute.crd2idx(%coord_7759, %lay_7760) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
        %iter_7762 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7763 = cute.add_offset(%iter_7762, %idx_7761) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7764 = cute.make_view(%tup_7763) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7765 = cute.get_iter(%view_7764) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7766, %e1_7767, %e2_7768, %e3_7769 = cute.get_leaves(%iter_7765) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2504 = cute.get_scalars(%e0_7766) : !cute.int_tuple<"?">
        %2505 = cute.get_scalars(%e1_7767) : !cute.int_tuple<"?">
        %2506 = cute.get_scalars(%e2_7768) : !cute.int_tuple<"?">
        %2507 = cute.get_scalars(%e3_7769) : !cute.int_tuple<"?{div=8}">
        %iter_7770 = cute.get_iter(%view_7764) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7771, %e1_7772, %e2_7773, %e3_7774 = cute.get_leaves(%iter_7770) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2508 = cute.get_scalars(%e0_7771) : !cute.int_tuple<"?">
        %2509 = cute.get_scalars(%e1_7772) : !cute.int_tuple<"?">
        %2510 = cute.get_scalars(%e2_7773) : !cute.int_tuple<"?">
        %2511 = cute.get_scalars(%e3_7774) : !cute.int_tuple<"?{div=8}">
        %iter_7775 = cute.get_iter(%view_7764) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7776, %e1_7777, %e2_7778, %e3_7779 = cute.get_leaves(%iter_7775) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2512 = cute.get_scalars(%e0_7776) : !cute.int_tuple<"?">
        %2513 = cute.get_scalars(%e1_7777) : !cute.int_tuple<"?">
        %2514 = cute.get_scalars(%e2_7778) : !cute.int_tuple<"?">
        %2515 = cute.get_scalars(%e3_7779) : !cute.int_tuple<"?{div=8}">
        %lay_7780 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2516 = cute.get_shape(%lay_7780) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7781, %e1_7782, %e2_7783, %e3_7784 = cute.get_leaves(%2516) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7785 = cute.to_int_tuple(%e0_7781) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2517 = cute.get_scalars(%itup_7785) : !cute.int_tuple<"?">
        %itup_7786 = cute.to_int_tuple(%e1_7782) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2518 = cute.get_scalars(%itup_7786) : !cute.int_tuple<"?">
        %itup_7787 = cute.to_int_tuple(%e2_7783) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2519 = cute.get_scalars(%itup_7787) : !cute.int_tuple<"?">
        %itup_7788 = cute.to_int_tuple(%e3_7784) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2520 = cute.get_scalars(%itup_7788) : !cute.int_tuple<"?{div=8}">
        %coord_7789 = cute.make_coord(%e1_7777) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7790 = cute.make_coord(%itup_7786) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2521 = cute.elem_less(%coord_7789, %coord_7790) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2521 {
          %coord_7855 = cute.make_coord(%498) : (i32) -> !cute.coord<"(_,1,_,?)">
          %lay_7856 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_7858 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_gmem_bf16_6
          %iter_7861 = cute.get_iter(%view_7860) : !memref_gmem_bf16_6
          %coord_7862 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7863 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7864 = cute.crd2idx(%coord_7862, %lay_7863) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_7865 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7866 = cute.add_offset(%iter_7865, %idx_7864) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7867 = cute.make_view(%ptr_7866) : !memref_smem_bf16_14
          %iter_7868 = cute.get_iter(%view_7867) : !memref_smem_bf16_14
          %coord_7869 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7870 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7872 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
          %ptr_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7874 = cute.make_view(%ptr_7873) : !memref_rmem_i8_2
          %iter_7875 = cute.get_iter(%view_7874) : !memref_rmem_i8_2
          %lay_7876 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %2558 = cute.get_shape(%lay_7876) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7877, %e1_7878, %e2_7879 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %lay_7880 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %2559 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7881, %e1_7882, %e2_7883 = cute.get_leaves(%2559) : !cute.shape<"((8,1),2)">
          %lay_7884 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
          %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_7888 = cute.make_view(%iter_7861, %append_7887) : !memref_gmem_bf16_6
          %iter_7889 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %lay_7890 = cute.get_layout(%view_7888) : !memref_gmem_bf16_6
          %2560 = cute.get_shape(%lay_7890) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2560) : !cute.shape<"((8,1),2)">
          %iter_7894 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %view_7895 = cute.make_view(%iter_7894) : !memref_gmem_bf16_7
          %iter_7896 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7897 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %lay_7898 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %shape_7899 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7900 = cute.make_layout() : !cute.layout<"1:0">
          %append_7901 = cute.append_to_rank<2> (%lay_7898, %lay_7900) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_7902 = cute.make_view(%iter_7868, %append_7901) : !memref_smem_bf16_14
          %iter_7903 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %lay_7904 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
          %2561 = cute.get_shape(%lay_7904) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7905, %e1_7906, %e2_7907 = cute.get_leaves(%2561) : !cute.shape<"((8,1),2)">
          %iter_7908 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %view_7909 = cute.make_view(%iter_7908) : !memref_smem_bf16_15
          %iter_7910 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %iter_7911 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7912 = cute.get_layout(%view_7874) : !memref_rmem_i8_2
          %shape_7913 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7914 = cute.make_layout() : !cute.layout<"1:0">
          %append_7915 = cute.append_to_rank<2> (%lay_7912, %lay_7914) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_7916 = cute.make_view(%iter_7875, %append_7915) : !memref_rmem_i8_2
          %iter_7917 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %lay_7918 = cute.get_layout(%view_7916) : !memref_rmem_i8_2
          %2562 = cute.get_shape(%lay_7918) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_7919, %e1_7920 = cute.get_leaves(%2562) : !cute.shape<"(1,2)">
          %iter_7921 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %view_7922 = cute.make_view(%iter_7921) : !memref_rmem_i8_3
          %iter_7923 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %iter_7924 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7925 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %2563 = cute.get_shape(%lay_7925) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_7926, %e1_7927, %e2_7928 = cute.get_leaves(%2563) : !cute.shape<"((8,1),(2))">
          %lay_7929 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %2564 = cute.get_shape(%lay_7929) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_7930, %e1_7931, %e2_7932 = cute.get_leaves(%2564) : !cute.shape<"((8,1),(2))">
          %lay_7933 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %sz_7934 = cute.size(%lay_7933) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_7935 = cute.get_leaves(%sz_7934) : !cute.int_tuple<"2">
          %lay_7936 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %sz_7937 = cute.size(%lay_7936) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_7938 = cute.get_leaves(%sz_7937) : !cute.int_tuple<"2">
          %2565 = cute.static : !cute.layout<"1:0">
          %iter_7939 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7940 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7941 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %lay_7942 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %append_7943 = cute.append_to_rank<2> (%lay_7941, %2565) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_7944 = cute.append_to_rank<2> (%lay_7942, %2565) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_7945 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_7946 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_7947 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7948 = cute.get_layout(%view_7922) : !memref_rmem_i8_3
          %append_7949 = cute.append_to_rank<2> (%lay_7948, %2565) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_7950 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_7951 = cute.size(%lay_7945) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2566 = cute.get_scalars(%sz_7951) : !cute.int_tuple<"2">
          %c0_i32_7952 = arith.constant 0 : i32
          %c1_i32_7953 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_7952 to %2566 step %c1_i32_7953  : i32 {
            %coord_7954 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_7955 = cute.slice(%lay_7945, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_7956 = cute.crd2idx(%coord_7954, %lay_7945) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_7957 = cute.add_offset(%iter_7939, %idx_7956) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_7958 = cute.make_view(%ptr_7957, %slice_7955) : !memref_gmem_bf16_8
            %slice_7959 = cute.slice(%lay_7946, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_7960 = cute.crd2idx(%coord_7954, %lay_7946) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_7961 = cute.add_offset(%iter_7940, %idx_7960) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_7962 = cute.make_view(%ptr_7961, %slice_7959) : !memref_smem_bf16_13
            %slice_7963 = cute.slice(%lay_7950, %coord_7954) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_7964 = cute.crd2idx(%coord_7954, %lay_7950) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_7965 = cute.add_offset(%iter_7947, %idx_7964) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_7966 = cute.make_view(%ptr_7965, %slice_7963) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_7958, %view_7962, %view_7966) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7855 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
          %lay_7856 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
          %iter_7858 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_smem_bf16_14
          %iter_7861 = cute.get_iter(%view_7860) : !memref_smem_bf16_14
          %lay_7862 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %sz_7863 = cute.size(%lay_7862) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7864 = cute.get_leaves(%sz_7863) : !cute.int_tuple<"16">
          %lay_7865 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %2558 = cute.get_shape(%lay_7865) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7866, %e1_7867, %e2_7868 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %int_tuple_7869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7870 = cute.tuple.product(%int_tuple_7869) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7871 = cute.get_leaves(%res_7870) : !cute.int_tuple<"16">
          %cst_7872 = arith.constant 0.000000e+00 : bf16
          %2559 = vector.splat %cst_7872 : vector<16xbf16>
          %int_tuple_7873 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7874 = cute.size(%int_tuple_7873) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7875 = cute.get_leaves(%sz_7874) : !cute.int_tuple<"16">
          %int_tuple_7876 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7877 = cute.size(%int_tuple_7876) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7878 = cute.get_leaves(%sz_7877) : !cute.int_tuple<"16">
          cute.memref.store_vec %2559, %view_7860, row_major : !memref_smem_bf16_14
        }
        %coord_7791 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
        %lay_7792 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7793 = cute.crd2idx(%coord_7791, %lay_7792) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
        %iter_7794 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7795 = cute.add_offset(%iter_7794, %idx_7793) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7796 = cute.make_view(%tup_7795) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7797 = cute.get_iter(%view_7796) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7798, %e1_7799, %e2_7800, %e3_7801 = cute.get_leaves(%iter_7797) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2522 = cute.get_scalars(%e0_7798) : !cute.int_tuple<"?">
        %2523 = cute.get_scalars(%e1_7799) : !cute.int_tuple<"?">
        %2524 = cute.get_scalars(%e2_7800) : !cute.int_tuple<"?">
        %2525 = cute.get_scalars(%e3_7801) : !cute.int_tuple<"?{div=8}">
        %iter_7802 = cute.get_iter(%view_7796) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7803, %e1_7804, %e2_7805, %e3_7806 = cute.get_leaves(%iter_7802) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2526 = cute.get_scalars(%e0_7803) : !cute.int_tuple<"?">
        %2527 = cute.get_scalars(%e1_7804) : !cute.int_tuple<"?">
        %2528 = cute.get_scalars(%e2_7805) : !cute.int_tuple<"?">
        %2529 = cute.get_scalars(%e3_7806) : !cute.int_tuple<"?{div=8}">
        %iter_7807 = cute.get_iter(%view_7796) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7808, %e1_7809, %e2_7810, %e3_7811 = cute.get_leaves(%iter_7807) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2530 = cute.get_scalars(%e0_7808) : !cute.int_tuple<"?">
        %2531 = cute.get_scalars(%e1_7809) : !cute.int_tuple<"?">
        %2532 = cute.get_scalars(%e2_7810) : !cute.int_tuple<"?">
        %2533 = cute.get_scalars(%e3_7811) : !cute.int_tuple<"?{div=8}">
        %lay_7812 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2534 = cute.get_shape(%lay_7812) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7813, %e1_7814, %e2_7815, %e3_7816 = cute.get_leaves(%2534) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7817 = cute.to_int_tuple(%e0_7813) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2535 = cute.get_scalars(%itup_7817) : !cute.int_tuple<"?">
        %itup_7818 = cute.to_int_tuple(%e1_7814) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2536 = cute.get_scalars(%itup_7818) : !cute.int_tuple<"?">
        %itup_7819 = cute.to_int_tuple(%e2_7815) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2537 = cute.get_scalars(%itup_7819) : !cute.int_tuple<"?">
        %itup_7820 = cute.to_int_tuple(%e3_7816) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2538 = cute.get_scalars(%itup_7820) : !cute.int_tuple<"?{div=8}">
        %coord_7821 = cute.make_coord(%e1_7809) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7822 = cute.make_coord(%itup_7818) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2539 = cute.elem_less(%coord_7821, %coord_7822) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2539 {
          %coord_7855 = cute.make_coord(%498) : (i32) -> !cute.coord<"(_,2,_,?)">
          %lay_7856 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
          %iter_7858 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_gmem_bf16_6
          %iter_7861 = cute.get_iter(%view_7860) : !memref_gmem_bf16_6
          %coord_7862 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7863 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7864 = cute.crd2idx(%coord_7862, %lay_7863) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_7865 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7866 = cute.add_offset(%iter_7865, %idx_7864) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7867 = cute.make_view(%ptr_7866) : !memref_smem_bf16_14
          %iter_7868 = cute.get_iter(%view_7867) : !memref_smem_bf16_14
          %coord_7869 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7870 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7872 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
          %ptr_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7874 = cute.make_view(%ptr_7873) : !memref_rmem_i8_2
          %iter_7875 = cute.get_iter(%view_7874) : !memref_rmem_i8_2
          %lay_7876 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %2558 = cute.get_shape(%lay_7876) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7877, %e1_7878, %e2_7879 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %lay_7880 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %2559 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7881, %e1_7882, %e2_7883 = cute.get_leaves(%2559) : !cute.shape<"((8,1),2)">
          %lay_7884 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
          %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_7888 = cute.make_view(%iter_7861, %append_7887) : !memref_gmem_bf16_6
          %iter_7889 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %lay_7890 = cute.get_layout(%view_7888) : !memref_gmem_bf16_6
          %2560 = cute.get_shape(%lay_7890) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2560) : !cute.shape<"((8,1),2)">
          %iter_7894 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %view_7895 = cute.make_view(%iter_7894) : !memref_gmem_bf16_7
          %iter_7896 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7897 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %lay_7898 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %shape_7899 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7900 = cute.make_layout() : !cute.layout<"1:0">
          %append_7901 = cute.append_to_rank<2> (%lay_7898, %lay_7900) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_7902 = cute.make_view(%iter_7868, %append_7901) : !memref_smem_bf16_14
          %iter_7903 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %lay_7904 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
          %2561 = cute.get_shape(%lay_7904) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7905, %e1_7906, %e2_7907 = cute.get_leaves(%2561) : !cute.shape<"((8,1),2)">
          %iter_7908 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %view_7909 = cute.make_view(%iter_7908) : !memref_smem_bf16_15
          %iter_7910 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %iter_7911 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7912 = cute.get_layout(%view_7874) : !memref_rmem_i8_2
          %shape_7913 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7914 = cute.make_layout() : !cute.layout<"1:0">
          %append_7915 = cute.append_to_rank<2> (%lay_7912, %lay_7914) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_7916 = cute.make_view(%iter_7875, %append_7915) : !memref_rmem_i8_2
          %iter_7917 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %lay_7918 = cute.get_layout(%view_7916) : !memref_rmem_i8_2
          %2562 = cute.get_shape(%lay_7918) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_7919, %e1_7920 = cute.get_leaves(%2562) : !cute.shape<"(1,2)">
          %iter_7921 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %view_7922 = cute.make_view(%iter_7921) : !memref_rmem_i8_3
          %iter_7923 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %iter_7924 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7925 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %2563 = cute.get_shape(%lay_7925) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_7926, %e1_7927, %e2_7928 = cute.get_leaves(%2563) : !cute.shape<"((8,1),(2))">
          %lay_7929 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %2564 = cute.get_shape(%lay_7929) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_7930, %e1_7931, %e2_7932 = cute.get_leaves(%2564) : !cute.shape<"((8,1),(2))">
          %lay_7933 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %sz_7934 = cute.size(%lay_7933) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_7935 = cute.get_leaves(%sz_7934) : !cute.int_tuple<"2">
          %lay_7936 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %sz_7937 = cute.size(%lay_7936) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_7938 = cute.get_leaves(%sz_7937) : !cute.int_tuple<"2">
          %2565 = cute.static : !cute.layout<"1:0">
          %iter_7939 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7940 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7941 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %lay_7942 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %append_7943 = cute.append_to_rank<2> (%lay_7941, %2565) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_7944 = cute.append_to_rank<2> (%lay_7942, %2565) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_7945 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_7946 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_7947 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7948 = cute.get_layout(%view_7922) : !memref_rmem_i8_3
          %append_7949 = cute.append_to_rank<2> (%lay_7948, %2565) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_7950 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_7951 = cute.size(%lay_7945) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2566 = cute.get_scalars(%sz_7951) : !cute.int_tuple<"2">
          %c0_i32_7952 = arith.constant 0 : i32
          %c1_i32_7953 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_7952 to %2566 step %c1_i32_7953  : i32 {
            %coord_7954 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_7955 = cute.slice(%lay_7945, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_7956 = cute.crd2idx(%coord_7954, %lay_7945) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_7957 = cute.add_offset(%iter_7939, %idx_7956) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_7958 = cute.make_view(%ptr_7957, %slice_7955) : !memref_gmem_bf16_8
            %slice_7959 = cute.slice(%lay_7946, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_7960 = cute.crd2idx(%coord_7954, %lay_7946) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_7961 = cute.add_offset(%iter_7940, %idx_7960) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_7962 = cute.make_view(%ptr_7961, %slice_7959) : !memref_smem_bf16_13
            %slice_7963 = cute.slice(%lay_7950, %coord_7954) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_7964 = cute.crd2idx(%coord_7954, %lay_7950) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_7965 = cute.add_offset(%iter_7947, %idx_7964) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_7966 = cute.make_view(%ptr_7965, %slice_7963) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_7958, %view_7962, %view_7966) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7855 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
          %lay_7856 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
          %iter_7858 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_smem_bf16_14
          %iter_7861 = cute.get_iter(%view_7860) : !memref_smem_bf16_14
          %lay_7862 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %sz_7863 = cute.size(%lay_7862) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7864 = cute.get_leaves(%sz_7863) : !cute.int_tuple<"16">
          %lay_7865 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %2558 = cute.get_shape(%lay_7865) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7866, %e1_7867, %e2_7868 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %int_tuple_7869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7870 = cute.tuple.product(%int_tuple_7869) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7871 = cute.get_leaves(%res_7870) : !cute.int_tuple<"16">
          %cst_7872 = arith.constant 0.000000e+00 : bf16
          %2559 = vector.splat %cst_7872 : vector<16xbf16>
          %int_tuple_7873 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7874 = cute.size(%int_tuple_7873) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7875 = cute.get_leaves(%sz_7874) : !cute.int_tuple<"16">
          %int_tuple_7876 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7877 = cute.size(%int_tuple_7876) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7878 = cute.get_leaves(%sz_7877) : !cute.int_tuple<"16">
          cute.memref.store_vec %2559, %view_7860, row_major : !memref_smem_bf16_14
        }
        %coord_7823 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
        %lay_7824 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %idx_7825 = cute.crd2idx(%coord_7823, %lay_7824) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
        %iter_7826 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
        %tup_7827 = cute.add_offset(%iter_7826, %idx_7825) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
        %view_7828 = cute.make_view(%tup_7827) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %iter_7829 = cute.get_iter(%view_7828) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7830, %e1_7831, %e2_7832, %e3_7833 = cute.get_leaves(%iter_7829) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2540 = cute.get_scalars(%e0_7830) : !cute.int_tuple<"?">
        %2541 = cute.get_scalars(%e1_7831) : !cute.int_tuple<"?">
        %2542 = cute.get_scalars(%e2_7832) : !cute.int_tuple<"?">
        %2543 = cute.get_scalars(%e3_7833) : !cute.int_tuple<"?{div=8}">
        %iter_7834 = cute.get_iter(%view_7828) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7835, %e1_7836, %e2_7837, %e3_7838 = cute.get_leaves(%iter_7834) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2544 = cute.get_scalars(%e0_7835) : !cute.int_tuple<"?">
        %2545 = cute.get_scalars(%e1_7836) : !cute.int_tuple<"?">
        %2546 = cute.get_scalars(%e2_7837) : !cute.int_tuple<"?">
        %2547 = cute.get_scalars(%e3_7838) : !cute.int_tuple<"?{div=8}">
        %iter_7839 = cute.get_iter(%view_7828) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
        %e0_7840, %e1_7841, %e2_7842, %e3_7843 = cute.get_leaves(%iter_7839) : !cute.int_tuple<"(?,?,?,?{div=8})">
        %2548 = cute.get_scalars(%e0_7840) : !cute.int_tuple<"?">
        %2549 = cute.get_scalars(%e1_7841) : !cute.int_tuple<"?">
        %2550 = cute.get_scalars(%e2_7842) : !cute.int_tuple<"?">
        %2551 = cute.get_scalars(%e3_7843) : !cute.int_tuple<"?{div=8}">
        %lay_7844 = cute.get_layout(%arg1) : !memref_gmem_bf16_
        %2552 = cute.get_shape(%lay_7844) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7845, %e1_7846, %e2_7847, %e3_7848 = cute.get_leaves(%2552) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7849 = cute.to_int_tuple(%e0_7845) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2553 = cute.get_scalars(%itup_7849) : !cute.int_tuple<"?">
        %itup_7850 = cute.to_int_tuple(%e1_7846) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2554 = cute.get_scalars(%itup_7850) : !cute.int_tuple<"?">
        %itup_7851 = cute.to_int_tuple(%e2_7847) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2555 = cute.get_scalars(%itup_7851) : !cute.int_tuple<"?">
        %itup_7852 = cute.to_int_tuple(%e3_7848) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2556 = cute.get_scalars(%itup_7852) : !cute.int_tuple<"?{div=8}">
        %coord_7853 = cute.make_coord(%e1_7841) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %coord_7854 = cute.make_coord(%itup_7850) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
        %2557 = cute.elem_less(%coord_7853, %coord_7854) : !cute.coord<"?">, !cute.coord<"?">
        scf.if %2557 {
          %coord_7855 = cute.make_coord(%498) : (i32) -> !cute.coord<"(_,3,_,?)">
          %lay_7856 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
          %iter_7858 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_gmem_bf16_6
          %iter_7861 = cute.get_iter(%view_7860) : !memref_gmem_bf16_6
          %coord_7862 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7863 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7864 = cute.crd2idx(%coord_7862, %lay_7863) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_7865 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7866 = cute.add_offset(%iter_7865, %idx_7864) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7867 = cute.make_view(%ptr_7866) : !memref_smem_bf16_14
          %iter_7868 = cute.get_iter(%view_7867) : !memref_smem_bf16_14
          %coord_7869 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7870 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
          %iter_7872 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
          %ptr_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
          %view_7874 = cute.make_view(%ptr_7873) : !memref_rmem_i8_2
          %iter_7875 = cute.get_iter(%view_7874) : !memref_rmem_i8_2
          %lay_7876 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %2558 = cute.get_shape(%lay_7876) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7877, %e1_7878, %e2_7879 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %lay_7880 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %2559 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7881, %e1_7882, %e2_7883 = cute.get_leaves(%2559) : !cute.shape<"((8,1),2)">
          %lay_7884 = cute.get_layout(%view_7860) : !memref_gmem_bf16_6
          %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
          %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
          %view_7888 = cute.make_view(%iter_7861, %append_7887) : !memref_gmem_bf16_6
          %iter_7889 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %lay_7890 = cute.get_layout(%view_7888) : !memref_gmem_bf16_6
          %2560 = cute.get_shape(%lay_7890) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
          %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2560) : !cute.shape<"((8,1),2)">
          %iter_7894 = cute.get_iter(%view_7888) : !memref_gmem_bf16_6
          %view_7895 = cute.make_view(%iter_7894) : !memref_gmem_bf16_7
          %iter_7896 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7897 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %lay_7898 = cute.get_layout(%view_7867) : !memref_smem_bf16_14
          %shape_7899 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7900 = cute.make_layout() : !cute.layout<"1:0">
          %append_7901 = cute.append_to_rank<2> (%lay_7898, %lay_7900) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
          %view_7902 = cute.make_view(%iter_7868, %append_7901) : !memref_smem_bf16_14
          %iter_7903 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %lay_7904 = cute.get_layout(%view_7902) : !memref_smem_bf16_14
          %2561 = cute.get_shape(%lay_7904) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7905, %e1_7906, %e2_7907 = cute.get_leaves(%2561) : !cute.shape<"((8,1),2)">
          %iter_7908 = cute.get_iter(%view_7902) : !memref_smem_bf16_14
          %view_7909 = cute.make_view(%iter_7908) : !memref_smem_bf16_15
          %iter_7910 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %iter_7911 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7912 = cute.get_layout(%view_7874) : !memref_rmem_i8_2
          %shape_7913 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_7914 = cute.make_layout() : !cute.layout<"1:0">
          %append_7915 = cute.append_to_rank<2> (%lay_7912, %lay_7914) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
          %view_7916 = cute.make_view(%iter_7875, %append_7915) : !memref_rmem_i8_2
          %iter_7917 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %lay_7918 = cute.get_layout(%view_7916) : !memref_rmem_i8_2
          %2562 = cute.get_shape(%lay_7918) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
          %e0_7919, %e1_7920 = cute.get_leaves(%2562) : !cute.shape<"(1,2)">
          %iter_7921 = cute.get_iter(%view_7916) : !memref_rmem_i8_2
          %view_7922 = cute.make_view(%iter_7921) : !memref_rmem_i8_3
          %iter_7923 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %iter_7924 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7925 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %2563 = cute.get_shape(%lay_7925) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
          %e0_7926, %e1_7927, %e2_7928 = cute.get_leaves(%2563) : !cute.shape<"((8,1),(2))">
          %lay_7929 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %2564 = cute.get_shape(%lay_7929) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
          %e0_7930, %e1_7931, %e2_7932 = cute.get_leaves(%2564) : !cute.shape<"((8,1),(2))">
          %lay_7933 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %sz_7934 = cute.size(%lay_7933) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
          %e0_7935 = cute.get_leaves(%sz_7934) : !cute.int_tuple<"2">
          %lay_7936 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %sz_7937 = cute.size(%lay_7936) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
          %e0_7938 = cute.get_leaves(%sz_7937) : !cute.int_tuple<"2">
          %2565 = cute.static : !cute.layout<"1:0">
          %iter_7939 = cute.get_iter(%view_7895) : !memref_gmem_bf16_7
          %iter_7940 = cute.get_iter(%view_7909) : !memref_smem_bf16_15
          %lay_7941 = cute.get_layout(%view_7895) : !memref_gmem_bf16_7
          %lay_7942 = cute.get_layout(%view_7909) : !memref_smem_bf16_15
          %append_7943 = cute.append_to_rank<2> (%lay_7941, %2565) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
          %append_7944 = cute.append_to_rank<2> (%lay_7942, %2565) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
          %lay_7945 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
          %lay_7946 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
          %iter_7947 = cute.get_iter(%view_7922) : !memref_rmem_i8_3
          %lay_7948 = cute.get_layout(%view_7922) : !memref_rmem_i8_3
          %append_7949 = cute.append_to_rank<2> (%lay_7948, %2565) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
          %lay_7950 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
          %sz_7951 = cute.size(%lay_7945) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
          %2566 = cute.get_scalars(%sz_7951) : !cute.int_tuple<"2">
          %c0_i32_7952 = arith.constant 0 : i32
          %c1_i32_7953 = arith.constant 1 : i32
          scf.for %arg5 = %c0_i32_7952 to %2566 step %c1_i32_7953  : i32 {
            %coord_7954 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
            %slice_7955 = cute.slice(%lay_7945, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
            %idx_7956 = cute.crd2idx(%coord_7954, %lay_7945) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
            %ptr_7957 = cute.add_offset(%iter_7939, %idx_7956) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_7958 = cute.make_view(%ptr_7957, %slice_7955) : !memref_gmem_bf16_8
            %slice_7959 = cute.slice(%lay_7946, %coord_7954) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
            %idx_7960 = cute.crd2idx(%coord_7954, %lay_7946) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
            %ptr_7961 = cute.add_offset(%iter_7940, %idx_7960) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_7962 = cute.make_view(%ptr_7961, %slice_7959) : !memref_smem_bf16_13
            %slice_7963 = cute.slice(%lay_7950, %coord_7954) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
            %idx_7964 = cute.crd2idx(%coord_7954, %lay_7950) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
            %ptr_7965 = cute.add_offset(%iter_7947, %idx_7964) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_7966 = cute.make_view(%ptr_7965, %slice_7963) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_7958, %view_7962, %view_7966) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } else {
          %coord_7855 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
          %lay_7856 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %idx_7857 = cute.crd2idx(%coord_7855, %lay_7856) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
          %iter_7858 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
          %ptr_7859 = cute.add_offset(%iter_7858, %idx_7857) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7860 = cute.make_view(%ptr_7859) : !memref_smem_bf16_14
          %iter_7861 = cute.get_iter(%view_7860) : !memref_smem_bf16_14
          %lay_7862 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %sz_7863 = cute.size(%lay_7862) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
          %e0_7864 = cute.get_leaves(%sz_7863) : !cute.int_tuple<"16">
          %lay_7865 = cute.get_layout(%view_7860) : !memref_smem_bf16_14
          %2558 = cute.get_shape(%lay_7865) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
          %e0_7866, %e1_7867, %e2_7868 = cute.get_leaves(%2558) : !cute.shape<"((8,1),2)">
          %int_tuple_7869 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %res_7870 = cute.tuple.product(%int_tuple_7869) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7871 = cute.get_leaves(%res_7870) : !cute.int_tuple<"16">
          %cst_7872 = arith.constant 0.000000e+00 : bf16
          %2559 = vector.splat %cst_7872 : vector<16xbf16>
          %int_tuple_7873 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7874 = cute.size(%int_tuple_7873) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7875 = cute.get_leaves(%sz_7874) : !cute.int_tuple<"16">
          %int_tuple_7876 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
          %sz_7877 = cute.size(%int_tuple_7876) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
          %e0_7878 = cute.get_leaves(%sz_7877) : !cute.int_tuple<"16">
          cute.memref.store_vec %2559, %view_7860, row_major : !memref_smem_bf16_14
        }
      } else {
        %coord_7719 = cute.make_coord(%498) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_7720 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
        %slice_7721 = cute.slice(%lay_7720, %coord_7719) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
        %idx_7722 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7723 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
        %ptr_7724 = cute.add_offset(%iter_7723, %idx_7722) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7725 = cute.make_view(%ptr_7724, %slice_7721) : !memref_gmem_bf16_9
        %iter_7726 = cute.get_iter(%view_7725) : !memref_gmem_bf16_9
        %lay_7727 = cute.get_layout(%view_7725) : !memref_gmem_bf16_9
        %2485 = cute.get_shape(%lay_7727) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7728, %e1_7729, %e2_7730, %e3_7731 = cute.get_leaves(%2485) : !cute.shape<"((8,1),4,2)">
        %lay_7732 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
        %2486 = cute.get_shape(%lay_7732) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7733, %e1_7734, %e2_7735, %e3_7736 = cute.get_leaves(%2486) : !cute.shape<"((8,1),4,2)">
        %lay_7737 = cute.get_layout(%view_7725) : !memref_gmem_bf16_9
        %shape_7738 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7739 = cute.make_layout() : !cute.layout<"1:0">
        %append_7740 = cute.append_to_rank<2> (%lay_7737, %lay_7739) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_7741 = cute.make_view(%iter_7726, %append_7740) : !memref_gmem_bf16_9
        %iter_7742 = cute.get_iter(%view_7741) : !memref_gmem_bf16_9
        %lay_7743 = cute.get_layout(%view_7741) : !memref_gmem_bf16_9
        %2487 = cute.get_shape(%lay_7743) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7744, %e1_7745, %e2_7746, %e3_7747 = cute.get_leaves(%2487) : !cute.shape<"((8,1),4,2)">
        %iter_7748 = cute.get_iter(%view_7741) : !memref_gmem_bf16_9
        %lay_7749 = cute.get_layout(%view_7741) : !memref_gmem_bf16_9
        %2488 = cute.get_scalars(%lay_7749) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_7750 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_7751 = cute.assume(%2488) : (i64) -> !cute.i64<divby 128>
        %stride_7752 = cute.make_stride(%iv_7751) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_7753 = cute.make_layout(%shape_7750, %stride_7752) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_7754 = cute.make_view(%iter_7748, %lay_7753) : !memref_gmem_bf16_10
        %iter_7755 = cute.get_iter(%view_7754) : !memref_gmem_bf16_10
        %iter_7756 = cute.get_iter(%view_7754) : !memref_gmem_bf16_10
        %lay_7757 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
        %shape_7758 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7759 = cute.make_layout() : !cute.layout<"1:0">
        %append_7760 = cute.append_to_rank<2> (%lay_7757, %lay_7759) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_7761 = cute.make_view(%iter_299, %append_7760) : !memref_smem_bf16_4
        %iter_7762 = cute.get_iter(%view_7761) : !memref_smem_bf16_4
        %lay_7763 = cute.get_layout(%view_7761) : !memref_smem_bf16_4
        %2489 = cute.get_shape(%lay_7763) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7764, %e1_7765, %e2_7766, %e3_7767 = cute.get_leaves(%2489) : !cute.shape<"((8,1),4,2)">
        %iter_7768 = cute.get_iter(%view_7761) : !memref_smem_bf16_4
        %view_7769 = cute.make_view(%iter_7768) : !memref_smem_bf16_16
        %iter_7770 = cute.get_iter(%view_7769) : !memref_smem_bf16_16
        %iter_7771 = cute.get_iter(%view_7769) : !memref_smem_bf16_16
        %lay_7772 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %shape_7773 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7774 = cute.make_layout() : !cute.layout<"1:0">
        %append_7775 = cute.append_to_rank<2> (%lay_7772, %lay_7774) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_7776 = cute.make_view(%iter_529, %append_7775) : !memref_rmem_i8_1
        %iter_7777 = cute.get_iter(%view_7776) : !memref_rmem_i8_1
        %lay_7778 = cute.get_layout(%view_7776) : !memref_rmem_i8_1
        %2490 = cute.get_shape(%lay_7778) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_7779, %e1_7780, %e2_7781 = cute.get_leaves(%2490) : !cute.shape<"(1,4,2)">
        %iter_7782 = cute.get_iter(%view_7776) : !memref_rmem_i8_1
        %view_7783 = cute.make_view(%iter_7782) : !memref_rmem_i8_5
        %iter_7784 = cute.get_iter(%view_7783) : !memref_rmem_i8_5
        %iter_7785 = cute.get_iter(%view_7783) : !memref_rmem_i8_5
        %lay_7786 = cute.get_layout(%view_7754) : !memref_gmem_bf16_10
        %2491 = cute.get_shape(%lay_7786) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7787, %e1_7788, %e2_7789, %e3_7790 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(4,2))">
        %lay_7791 = cute.get_layout(%view_7769) : !memref_smem_bf16_16
        %2492 = cute.get_shape(%lay_7791) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7792, %e1_7793, %e2_7794, %e3_7795 = cute.get_leaves(%2492) : !cute.shape<"((8,1),(4,2))">
        %lay_7796 = cute.get_layout(%view_7754) : !memref_gmem_bf16_10
        %sz_7797 = cute.size(%lay_7796) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_7798 = cute.get_leaves(%sz_7797) : !cute.int_tuple<"8">
        %lay_7799 = cute.get_layout(%view_7769) : !memref_smem_bf16_16
        %sz_7800 = cute.size(%lay_7799) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_7801 = cute.get_leaves(%sz_7800) : !cute.int_tuple<"8">
        %2493 = cute.static : !cute.layout<"1:0">
        %iter_7802 = cute.get_iter(%view_7754) : !memref_gmem_bf16_10
        %iter_7803 = cute.get_iter(%view_7769) : !memref_smem_bf16_16
        %lay_7804 = cute.get_layout(%view_7754) : !memref_gmem_bf16_10
        %lay_7805 = cute.get_layout(%view_7769) : !memref_smem_bf16_16
        %append_7806 = cute.append_to_rank<2> (%lay_7804, %2493) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2493) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %2494 = cute.get_scalars(%append_7806) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_7808 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_7809 = cute.assume(%2494) : (i64) -> !cute.i64<divby 128>
        %stride_7810 = cute.make_stride(%iv_7809) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_7811 = cute.make_layout(%shape_7808, %stride_7810) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_7812 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_7813 = cute.get_iter(%view_7783) : !memref_rmem_i8_5
        %lay_7814 = cute.get_layout(%view_7783) : !memref_rmem_i8_5
        %append_7815 = cute.append_to_rank<2> (%lay_7814, %2493) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_7816 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_7817 = cute.size(%lay_7811) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %2495 = cute.get_scalars(%sz_7817) : !cute.int_tuple<"8">
        %c0_i32_7818 = arith.constant 0 : i32
        %c1_i32_7819 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7818 to %2495 step %c1_i32_7819  : i32 {
          %coord_7820 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7821 = cute.slice(%lay_7811, %coord_7820) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
          %idx_7822 = cute.crd2idx(%coord_7820, %lay_7811) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_7823 = cute.add_offset(%iter_7802, %idx_7822) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7824 = cute.make_view(%ptr_7823, %slice_7821) : !memref_gmem_bf16_8
          %slice_7825 = cute.slice(%lay_7812, %coord_7820) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
          %idx_7826 = cute.crd2idx(%coord_7820, %lay_7812) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_7827 = cute.add_offset(%iter_7803, %idx_7826) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7828 = cute.make_view(%ptr_7827, %slice_7825) : !memref_smem_bf16_13
          %slice_7829 = cute.slice(%lay_7816, %coord_7820) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
          %idx_7830 = cute.crd2idx(%coord_7820, %lay_7816) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_7831 = cute.add_offset(%iter_7813, %idx_7830) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7832 = cute.make_view(%ptr_7831, %slice_7829) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7824, %view_7828, %view_7832) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      nvvm.cp.async.commit.group
      %coord_1124 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1125 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_1126 = cute.crd2idx(%coord_1124, %lay_1125) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_1127 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_1128 = cute.add_offset(%iter_1127, %idx_1126) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1129 = cute.make_view(%ptr_1128) : !memref_smem_bf16_14
      %iter_1130 = cute.get_iter(%view_1129) : !memref_smem_bf16_14
      %coord_1131 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1132 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1133 = cute.crd2idx(%coord_1131, %lay_1132) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_1134 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1135 = cute.add_offset(%iter_1134, %idx_1133) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1136 = cute.make_view(%ptr_1135) : !memref_rmem_bf16_6
      %iter_1137 = cute.get_iter(%view_1136) : !memref_rmem_bf16_6
      %lay_1138 = cute.get_layout(%view_1129) : !memref_smem_bf16_14
      %502 = cute.get_shape(%lay_1138) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1139, %e1_1140, %e2_1141 = cute.get_leaves(%502) : !cute.shape<"((8,1),2)">
      %lay_1142 = cute.get_layout(%view_1136) : !memref_rmem_bf16_6
      %503 = cute.get_shape(%lay_1142) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1143, %e1_1144, %e2_1145 = cute.get_leaves(%503) : !cute.shape<"((8,1),2)">
      %lay_1146 = cute.get_layout(%view_1129) : !memref_smem_bf16_14
      %shape_1147 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1148 = cute.make_layout() : !cute.layout<"1:0">
      %append = cute.append_to_rank<2> (%lay_1146, %lay_1148) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1149 = cute.make_view(%iter_1130, %append) : !memref_smem_bf16_14
      %iter_1150 = cute.get_iter(%view_1149) : !memref_smem_bf16_14
      %lay_1151 = cute.get_layout(%view_1149) : !memref_smem_bf16_14
      %504 = cute.get_shape(%lay_1151) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1152, %e1_1153, %e2_1154 = cute.get_leaves(%504) : !cute.shape<"((8,1),2)">
      %iter_1155 = cute.get_iter(%view_1149) : !memref_smem_bf16_14
      %view_1156 = cute.make_view(%iter_1155) : !memref_smem_bf16_15
      %iter_1157 = cute.get_iter(%view_1156) : !memref_smem_bf16_15
      %iter_1158 = cute.get_iter(%view_1156) : !memref_smem_bf16_15
      %lay_1159 = cute.get_layout(%view_1136) : !memref_rmem_bf16_6
      %shape_1160 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1161 = cute.make_layout() : !cute.layout<"1:0">
      %append_1162 = cute.append_to_rank<2> (%lay_1159, %lay_1161) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1163 = cute.make_view(%iter_1137, %append_1162) : !memref_rmem_bf16_6
      %iter_1164 = cute.get_iter(%view_1163) : !memref_rmem_bf16_6
      %lay_1165 = cute.get_layout(%view_1163) : !memref_rmem_bf16_6
      %505 = cute.get_shape(%lay_1165) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1166, %e1_1167, %e2_1168 = cute.get_leaves(%505) : !cute.shape<"((8,1),2)">
      %iter_1169 = cute.get_iter(%view_1163) : !memref_rmem_bf16_6
      %view_1170 = cute.make_view(%iter_1169) : !memref_rmem_bf16_7
      %iter_1171 = cute.get_iter(%view_1170) : !memref_rmem_bf16_7
      %iter_1172 = cute.get_iter(%view_1170) : !memref_rmem_bf16_7
      %lay_1173 = cute.get_layout(%view_1156) : !memref_smem_bf16_15
      %506 = cute.get_shape(%lay_1173) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1174, %e1_1175, %e2_1176 = cute.get_leaves(%506) : !cute.shape<"((8,1),(2))">
      %lay_1177 = cute.get_layout(%view_1170) : !memref_rmem_bf16_7
      %507 = cute.get_shape(%lay_1177) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1178, %e1_1179, %e2_1180 = cute.get_leaves(%507) : !cute.shape<"((8,1),(2))">
      %lay_1181 = cute.get_layout(%view_1156) : !memref_smem_bf16_15
      %sz_1182 = cute.size(%lay_1181) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1183 = cute.get_leaves(%sz_1182) : !cute.int_tuple<"2">
      %lay_1184 = cute.get_layout(%view_1170) : !memref_rmem_bf16_7
      %sz_1185 = cute.size(%lay_1184) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1186 = cute.get_leaves(%sz_1185) : !cute.int_tuple<"2">
      %508 = cute.static : !cute.layout<"1:0">
      %iter_1187 = cute.get_iter(%view_1156) : !memref_smem_bf16_15
      %iter_1188 = cute.get_iter(%view_1170) : !memref_rmem_bf16_7
      %lay_1189 = cute.get_layout(%view_1156) : !memref_smem_bf16_15
      %lay_1190 = cute.get_layout(%view_1170) : !memref_rmem_bf16_7
      %append_1191 = cute.append_to_rank<2> (%lay_1189, %508) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1192 = cute.append_to_rank<2> (%lay_1190, %508) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1193 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1194 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1195 = cute.size(%lay_1193) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %509 = cute.get_scalars(%sz_1195) : !cute.int_tuple<"2">
      %c0_i32_1196 = arith.constant 0 : i32
      %c1_i32_1197 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1196 to %509 step %c1_i32_1197  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1193, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1193) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_1187, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1194, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1194) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1188, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1198 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1199 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_1200 = cute.crd2idx(%coord_1198, %lay_1199) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_1201 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_1202 = cute.add_offset(%iter_1201, %idx_1200) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1203 = cute.make_view(%ptr_1202) : !memref_smem_bf16_17
      %iter_1204 = cute.get_iter(%view_1203) : !memref_smem_bf16_17
      %coord_1205 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1206 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_1207 = cute.crd2idx(%coord_1205, %lay_1206) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_1208 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_1209 = cute.add_offset(%iter_1208, %idx_1207) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1210 = cute.make_view(%ptr_1209) : !memref_rmem_bf16_9
      %iter_1211 = cute.get_iter(%view_1210) : !memref_rmem_bf16_9
      %lay_1212 = cute.get_layout(%view_1203) : !memref_smem_bf16_17
      %510 = cute.get_shape(%lay_1212) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1213, %e1_1214, %e2_1215 = cute.get_leaves(%510) : !cute.shape<"((8,1),4)">
      %lay_1216 = cute.get_layout(%view_1210) : !memref_rmem_bf16_9
      %511 = cute.get_shape(%lay_1216) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1217, %e1_1218, %e2_1219 = cute.get_leaves(%511) : !cute.shape<"((8,1),4)">
      %lay_1220 = cute.get_layout(%view_1203) : !memref_smem_bf16_17
      %shape_1221 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1222 = cute.make_layout() : !cute.layout<"1:0">
      %append_1223 = cute.append_to_rank<2> (%lay_1220, %lay_1222) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1224 = cute.make_view(%iter_1204, %append_1223) : !memref_smem_bf16_17
      %iter_1225 = cute.get_iter(%view_1224) : !memref_smem_bf16_17
      %lay_1226 = cute.get_layout(%view_1224) : !memref_smem_bf16_17
      %512 = cute.get_shape(%lay_1226) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1227, %e1_1228, %e2_1229 = cute.get_leaves(%512) : !cute.shape<"((8,1),4)">
      %iter_1230 = cute.get_iter(%view_1224) : !memref_smem_bf16_17
      %view_1231 = cute.make_view(%iter_1230) : !memref_smem_bf16_18
      %iter_1232 = cute.get_iter(%view_1231) : !memref_smem_bf16_18
      %iter_1233 = cute.get_iter(%view_1231) : !memref_smem_bf16_18
      %lay_1234 = cute.get_layout(%view_1210) : !memref_rmem_bf16_9
      %shape_1235 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1236 = cute.make_layout() : !cute.layout<"1:0">
      %append_1237 = cute.append_to_rank<2> (%lay_1234, %lay_1236) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1238 = cute.make_view(%iter_1211, %append_1237) : !memref_rmem_bf16_9
      %iter_1239 = cute.get_iter(%view_1238) : !memref_rmem_bf16_9
      %lay_1240 = cute.get_layout(%view_1238) : !memref_rmem_bf16_9
      %513 = cute.get_shape(%lay_1240) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1241, %e1_1242, %e2_1243 = cute.get_leaves(%513) : !cute.shape<"((8,1),4)">
      %iter_1244 = cute.get_iter(%view_1238) : !memref_rmem_bf16_9
      %view_1245 = cute.make_view(%iter_1244) : !memref_rmem_bf16_10
      %iter_1246 = cute.get_iter(%view_1245) : !memref_rmem_bf16_10
      %iter_1247 = cute.get_iter(%view_1245) : !memref_rmem_bf16_10
      %lay_1248 = cute.get_layout(%view_1231) : !memref_smem_bf16_18
      %514 = cute.get_shape(%lay_1248) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1249, %e1_1250, %e2_1251 = cute.get_leaves(%514) : !cute.shape<"((8,1),(4))">
      %lay_1252 = cute.get_layout(%view_1245) : !memref_rmem_bf16_10
      %515 = cute.get_shape(%lay_1252) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1253, %e1_1254, %e2_1255 = cute.get_leaves(%515) : !cute.shape<"((8,1),(4))">
      %lay_1256 = cute.get_layout(%view_1231) : !memref_smem_bf16_18
      %sz_1257 = cute.size(%lay_1256) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1258 = cute.get_leaves(%sz_1257) : !cute.int_tuple<"4">
      %lay_1259 = cute.get_layout(%view_1245) : !memref_rmem_bf16_10
      %sz_1260 = cute.size(%lay_1259) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1261 = cute.get_leaves(%sz_1260) : !cute.int_tuple<"4">
      %516 = cute.static : !cute.layout<"1:0">
      %iter_1262 = cute.get_iter(%view_1231) : !memref_smem_bf16_18
      %iter_1263 = cute.get_iter(%view_1245) : !memref_rmem_bf16_10
      %lay_1264 = cute.get_layout(%view_1231) : !memref_smem_bf16_18
      %lay_1265 = cute.get_layout(%view_1245) : !memref_rmem_bf16_10
      %append_1266 = cute.append_to_rank<2> (%lay_1264, %516) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1267 = cute.append_to_rank<2> (%lay_1265, %516) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1268 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1269 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1270 = cute.size(%lay_1268) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %517 = cute.get_scalars(%sz_1270) : !cute.int_tuple<"4">
      %c0_i32_1271 = arith.constant 0 : i32
      %c1_i32_1272 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1271 to %517 step %c1_i32_1272  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1268, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1268) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_1262, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1269, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1269) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1263, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_1273 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %518 = cute.get_shape(%lay_1273) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
      %e0_1274, %e1_1275, %e2_1276, %e3_1277, %e4_1278, %e5 = cute.get_leaves(%518) : !cute.shape<"((8,1),2,((2,2),2))">
      %int_tuple_1279 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1280 = cute.size(%int_tuple_1279) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1281 = cute.get_leaves(%sz_1280) : !cute.int_tuple<"8">
      %int_tuple_1282 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1283 = cute.size(%int_tuple_1282) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1284 = cute.get_leaves(%sz_1283) : !cute.int_tuple<"8">
      %coord_1285 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1286 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_1287 = cute.crd2idx(%coord_1285, %lay_1286) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1288 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_1289 = cute.add_offset(%iter_1288, %idx_1287) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1290 = cute.make_view(%ptr_1289) : !memref_smem_bf16_14
      %iter_1291 = cute.get_iter(%view_1290) : !memref_smem_bf16_14
      %coord_1292 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1293 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1294 = cute.crd2idx(%coord_1292, %lay_1293) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
      %iter_1295 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1296 = cute.add_offset(%iter_1295, %idx_1294) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1297 = cute.make_view(%ptr_1296) : !memref_rmem_bf16_6
      %iter_1298 = cute.get_iter(%view_1297) : !memref_rmem_bf16_6
      %lay_1299 = cute.get_layout(%view_1290) : !memref_smem_bf16_14
      %519 = cute.get_shape(%lay_1299) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1300, %e1_1301, %e2_1302 = cute.get_leaves(%519) : !cute.shape<"((8,1),2)">
      %lay_1303 = cute.get_layout(%view_1297) : !memref_rmem_bf16_6
      %520 = cute.get_shape(%lay_1303) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1304, %e1_1305, %e2_1306 = cute.get_leaves(%520) : !cute.shape<"((8,1),2)">
      %lay_1307 = cute.get_layout(%view_1290) : !memref_smem_bf16_14
      %shape_1308 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1309 = cute.make_layout() : !cute.layout<"1:0">
      %append_1310 = cute.append_to_rank<2> (%lay_1307, %lay_1309) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1311 = cute.make_view(%iter_1291, %append_1310) : !memref_smem_bf16_14
      %iter_1312 = cute.get_iter(%view_1311) : !memref_smem_bf16_14
      %lay_1313 = cute.get_layout(%view_1311) : !memref_smem_bf16_14
      %521 = cute.get_shape(%lay_1313) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1314, %e1_1315, %e2_1316 = cute.get_leaves(%521) : !cute.shape<"((8,1),2)">
      %iter_1317 = cute.get_iter(%view_1311) : !memref_smem_bf16_14
      %view_1318 = cute.make_view(%iter_1317) : !memref_smem_bf16_15
      %iter_1319 = cute.get_iter(%view_1318) : !memref_smem_bf16_15
      %iter_1320 = cute.get_iter(%view_1318) : !memref_smem_bf16_15
      %lay_1321 = cute.get_layout(%view_1297) : !memref_rmem_bf16_6
      %shape_1322 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1323 = cute.make_layout() : !cute.layout<"1:0">
      %append_1324 = cute.append_to_rank<2> (%lay_1321, %lay_1323) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1325 = cute.make_view(%iter_1298, %append_1324) : !memref_rmem_bf16_6
      %iter_1326 = cute.get_iter(%view_1325) : !memref_rmem_bf16_6
      %lay_1327 = cute.get_layout(%view_1325) : !memref_rmem_bf16_6
      %522 = cute.get_shape(%lay_1327) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1328, %e1_1329, %e2_1330 = cute.get_leaves(%522) : !cute.shape<"((8,1),2)">
      %iter_1331 = cute.get_iter(%view_1325) : !memref_rmem_bf16_6
      %view_1332 = cute.make_view(%iter_1331) : !memref_rmem_bf16_7
      %iter_1333 = cute.get_iter(%view_1332) : !memref_rmem_bf16_7
      %iter_1334 = cute.get_iter(%view_1332) : !memref_rmem_bf16_7
      %lay_1335 = cute.get_layout(%view_1318) : !memref_smem_bf16_15
      %523 = cute.get_shape(%lay_1335) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1336, %e1_1337, %e2_1338 = cute.get_leaves(%523) : !cute.shape<"((8,1),(2))">
      %lay_1339 = cute.get_layout(%view_1332) : !memref_rmem_bf16_7
      %524 = cute.get_shape(%lay_1339) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1340, %e1_1341, %e2_1342 = cute.get_leaves(%524) : !cute.shape<"((8,1),(2))">
      %lay_1343 = cute.get_layout(%view_1318) : !memref_smem_bf16_15
      %sz_1344 = cute.size(%lay_1343) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1345 = cute.get_leaves(%sz_1344) : !cute.int_tuple<"2">
      %lay_1346 = cute.get_layout(%view_1332) : !memref_rmem_bf16_7
      %sz_1347 = cute.size(%lay_1346) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1348 = cute.get_leaves(%sz_1347) : !cute.int_tuple<"2">
      %525 = cute.static : !cute.layout<"1:0">
      %iter_1349 = cute.get_iter(%view_1318) : !memref_smem_bf16_15
      %iter_1350 = cute.get_iter(%view_1332) : !memref_rmem_bf16_7
      %lay_1351 = cute.get_layout(%view_1318) : !memref_smem_bf16_15
      %lay_1352 = cute.get_layout(%view_1332) : !memref_rmem_bf16_7
      %append_1353 = cute.append_to_rank<2> (%lay_1351, %525) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1354 = cute.append_to_rank<2> (%lay_1352, %525) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1355 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1356 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1357 = cute.size(%lay_1355) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %526 = cute.get_scalars(%sz_1357) : !cute.int_tuple<"2">
      %c0_i32_1358 = arith.constant 0 : i32
      %c1_i32_1359 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1358 to %526 step %c1_i32_1359  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1355, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1355) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_1349, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1356, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1356) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1350, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1360 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1361 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_1362 = cute.crd2idx(%coord_1360, %lay_1361) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1363 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_1364 = cute.add_offset(%iter_1363, %idx_1362) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1365 = cute.make_view(%ptr_1364) : !memref_smem_bf16_17
      %iter_1366 = cute.get_iter(%view_1365) : !memref_smem_bf16_17
      %coord_1367 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1368 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_1369 = cute.crd2idx(%coord_1367, %lay_1368) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
      %iter_1370 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_1371 = cute.add_offset(%iter_1370, %idx_1369) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1372 = cute.make_view(%ptr_1371) : !memref_rmem_bf16_9
      %iter_1373 = cute.get_iter(%view_1372) : !memref_rmem_bf16_9
      %lay_1374 = cute.get_layout(%view_1365) : !memref_smem_bf16_17
      %527 = cute.get_shape(%lay_1374) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1375, %e1_1376, %e2_1377 = cute.get_leaves(%527) : !cute.shape<"((8,1),4)">
      %lay_1378 = cute.get_layout(%view_1372) : !memref_rmem_bf16_9
      %528 = cute.get_shape(%lay_1378) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1379, %e1_1380, %e2_1381 = cute.get_leaves(%528) : !cute.shape<"((8,1),4)">
      %lay_1382 = cute.get_layout(%view_1365) : !memref_smem_bf16_17
      %shape_1383 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1384 = cute.make_layout() : !cute.layout<"1:0">
      %append_1385 = cute.append_to_rank<2> (%lay_1382, %lay_1384) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1386 = cute.make_view(%iter_1366, %append_1385) : !memref_smem_bf16_17
      %iter_1387 = cute.get_iter(%view_1386) : !memref_smem_bf16_17
      %lay_1388 = cute.get_layout(%view_1386) : !memref_smem_bf16_17
      %529 = cute.get_shape(%lay_1388) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1389, %e1_1390, %e2_1391 = cute.get_leaves(%529) : !cute.shape<"((8,1),4)">
      %iter_1392 = cute.get_iter(%view_1386) : !memref_smem_bf16_17
      %view_1393 = cute.make_view(%iter_1392) : !memref_smem_bf16_18
      %iter_1394 = cute.get_iter(%view_1393) : !memref_smem_bf16_18
      %iter_1395 = cute.get_iter(%view_1393) : !memref_smem_bf16_18
      %lay_1396 = cute.get_layout(%view_1372) : !memref_rmem_bf16_9
      %shape_1397 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1398 = cute.make_layout() : !cute.layout<"1:0">
      %append_1399 = cute.append_to_rank<2> (%lay_1396, %lay_1398) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1400 = cute.make_view(%iter_1373, %append_1399) : !memref_rmem_bf16_9
      %iter_1401 = cute.get_iter(%view_1400) : !memref_rmem_bf16_9
      %lay_1402 = cute.get_layout(%view_1400) : !memref_rmem_bf16_9
      %530 = cute.get_shape(%lay_1402) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1403, %e1_1404, %e2_1405 = cute.get_leaves(%530) : !cute.shape<"((8,1),4)">
      %iter_1406 = cute.get_iter(%view_1400) : !memref_rmem_bf16_9
      %view_1407 = cute.make_view(%iter_1406) : !memref_rmem_bf16_10
      %iter_1408 = cute.get_iter(%view_1407) : !memref_rmem_bf16_10
      %iter_1409 = cute.get_iter(%view_1407) : !memref_rmem_bf16_10
      %lay_1410 = cute.get_layout(%view_1393) : !memref_smem_bf16_18
      %531 = cute.get_shape(%lay_1410) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1411, %e1_1412, %e2_1413 = cute.get_leaves(%531) : !cute.shape<"((8,1),(4))">
      %lay_1414 = cute.get_layout(%view_1407) : !memref_rmem_bf16_10
      %532 = cute.get_shape(%lay_1414) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1415, %e1_1416, %e2_1417 = cute.get_leaves(%532) : !cute.shape<"((8,1),(4))">
      %lay_1418 = cute.get_layout(%view_1393) : !memref_smem_bf16_18
      %sz_1419 = cute.size(%lay_1418) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1420 = cute.get_leaves(%sz_1419) : !cute.int_tuple<"4">
      %lay_1421 = cute.get_layout(%view_1407) : !memref_rmem_bf16_10
      %sz_1422 = cute.size(%lay_1421) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1423 = cute.get_leaves(%sz_1422) : !cute.int_tuple<"4">
      %533 = cute.static : !cute.layout<"1:0">
      %iter_1424 = cute.get_iter(%view_1393) : !memref_smem_bf16_18
      %iter_1425 = cute.get_iter(%view_1407) : !memref_rmem_bf16_10
      %lay_1426 = cute.get_layout(%view_1393) : !memref_smem_bf16_18
      %lay_1427 = cute.get_layout(%view_1407) : !memref_rmem_bf16_10
      %append_1428 = cute.append_to_rank<2> (%lay_1426, %533) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1429 = cute.append_to_rank<2> (%lay_1427, %533) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1430 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1431 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1432 = cute.size(%lay_1430) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %534 = cute.get_scalars(%sz_1432) : !cute.int_tuple<"4">
      %c0_i32_1433 = arith.constant 0 : i32
      %c1_i32_1434 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1433 to %534 step %c1_i32_1434  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1430, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1430) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_1424, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1431, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1431) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1425, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1435 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1436 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1437 = cute.crd2idx(%coord_1435, %lay_1436) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
      %iter_1438 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1439 = cute.add_offset(%iter_1438, %idx_1437) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1440 = cute.make_view(%ptr_1439) : !memref_rmem_bf16_12
      %iter_1441 = cute.get_iter(%view_1440) : !memref_rmem_bf16_12
      %coord_1442 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_1443 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1444 = cute.crd2idx(%coord_1442, %lay_1443) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
      %iter_1445 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1446 = cute.add_offset(%iter_1445, %idx_1444) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1447 = cute.make_view(%ptr_1446) : !memref_rmem_bf16_13
      %iter_1448 = cute.get_iter(%view_1447) : !memref_rmem_bf16_13
      %lay_1449 = cute.get_layout(%view_1440) : !memref_rmem_bf16_12
      %535 = cute.get_shape(%lay_1449) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1450, %e1_1451, %e2_1452, %e3_1453 = cute.get_leaves(%535) : !cute.shape<"((2,2,2),2)">
      %lay_1454 = cute.get_layout(%view_1447) : !memref_rmem_bf16_13
      %536 = cute.get_shape(%lay_1454) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1455, %e1_1456, %e2_1457 = cute.get_leaves(%536) : !cute.shape<"((2,2),8)">
      %iter_1458 = cute.get_iter(%view_1440) : !memref_rmem_bf16_12
      %iter_1459 = cute.get_iter(%view_1447) : !memref_rmem_bf16_13
      %iter_1460 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_1461 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_1462 = cute.get_layout(%view_1440) : !memref_rmem_bf16_12
      %lay_1463 = cute.get_layout(%view_1447) : !memref_rmem_bf16_13
      %lay_1464 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_1465 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %537 = cute.static : !cute.layout<"1:0">
      %append_1466 = cute.append_to_rank<3> (%lay_1462, %537) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1467 = cute.append_to_rank<3> (%lay_1463, %537) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1468 = cute.size(%append_1466) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1469 = cute.size(%append_1466) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1470 = cute.size(%append_1467) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %538 = cute.get_scalars(%sz_1468) : !cute.int_tuple<"1">
      %539 = cute.get_scalars(%sz_1469) : !cute.int_tuple<"2">
      %540 = cute.get_scalars(%sz_1470) : !cute.int_tuple<"8">
      %c0_i32_1471 = arith.constant 0 : i32
      %c1_i32_1472 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1471 to %538 step %c1_i32_1472  : i32 {
        scf.for %arg6 = %c0_i32_1471 to %539 step %c1_i32_1472  : i32 {
          scf.for %arg7 = %c0_i32_1471 to %540 step %c1_i32_1472  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_1466, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_1466) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_1458, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_1467, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_1467) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_1459, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_1464, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_1464) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_1460, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_1465, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_1465) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_1461, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1473 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1474 = cute.size(%int_tuple_1473) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1475 = cute.get_leaves(%sz_1474) : !cute.int_tuple<"8">
      %coord_1476 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1477 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_1478 = cute.crd2idx(%coord_1476, %lay_1477) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_1479 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_1480 = cute.add_offset(%iter_1479, %idx_1478) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1481 = cute.make_view(%ptr_1480) : !memref_smem_bf16_14
      %iter_1482 = cute.get_iter(%view_1481) : !memref_smem_bf16_14
      %coord_1483 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1484 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1485 = cute.crd2idx(%coord_1483, %lay_1484) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
      %iter_1486 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1487 = cute.add_offset(%iter_1486, %idx_1485) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1488 = cute.make_view(%ptr_1487) : !memref_rmem_bf16_6
      %iter_1489 = cute.get_iter(%view_1488) : !memref_rmem_bf16_6
      %lay_1490 = cute.get_layout(%view_1481) : !memref_smem_bf16_14
      %541 = cute.get_shape(%lay_1490) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1491, %e1_1492, %e2_1493 = cute.get_leaves(%541) : !cute.shape<"((8,1),2)">
      %lay_1494 = cute.get_layout(%view_1488) : !memref_rmem_bf16_6
      %542 = cute.get_shape(%lay_1494) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1495, %e1_1496, %e2_1497 = cute.get_leaves(%542) : !cute.shape<"((8,1),2)">
      %lay_1498 = cute.get_layout(%view_1481) : !memref_smem_bf16_14
      %shape_1499 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1500 = cute.make_layout() : !cute.layout<"1:0">
      %append_1501 = cute.append_to_rank<2> (%lay_1498, %lay_1500) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1502 = cute.make_view(%iter_1482, %append_1501) : !memref_smem_bf16_14
      %iter_1503 = cute.get_iter(%view_1502) : !memref_smem_bf16_14
      %lay_1504 = cute.get_layout(%view_1502) : !memref_smem_bf16_14
      %543 = cute.get_shape(%lay_1504) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1505, %e1_1506, %e2_1507 = cute.get_leaves(%543) : !cute.shape<"((8,1),2)">
      %iter_1508 = cute.get_iter(%view_1502) : !memref_smem_bf16_14
      %view_1509 = cute.make_view(%iter_1508) : !memref_smem_bf16_15
      %iter_1510 = cute.get_iter(%view_1509) : !memref_smem_bf16_15
      %iter_1511 = cute.get_iter(%view_1509) : !memref_smem_bf16_15
      %lay_1512 = cute.get_layout(%view_1488) : !memref_rmem_bf16_6
      %shape_1513 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1514 = cute.make_layout() : !cute.layout<"1:0">
      %append_1515 = cute.append_to_rank<2> (%lay_1512, %lay_1514) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1516 = cute.make_view(%iter_1489, %append_1515) : !memref_rmem_bf16_6
      %iter_1517 = cute.get_iter(%view_1516) : !memref_rmem_bf16_6
      %lay_1518 = cute.get_layout(%view_1516) : !memref_rmem_bf16_6
      %544 = cute.get_shape(%lay_1518) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1519, %e1_1520, %e2_1521 = cute.get_leaves(%544) : !cute.shape<"((8,1),2)">
      %iter_1522 = cute.get_iter(%view_1516) : !memref_rmem_bf16_6
      %view_1523 = cute.make_view(%iter_1522) : !memref_rmem_bf16_7
      %iter_1524 = cute.get_iter(%view_1523) : !memref_rmem_bf16_7
      %iter_1525 = cute.get_iter(%view_1523) : !memref_rmem_bf16_7
      %lay_1526 = cute.get_layout(%view_1509) : !memref_smem_bf16_15
      %545 = cute.get_shape(%lay_1526) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1527, %e1_1528, %e2_1529 = cute.get_leaves(%545) : !cute.shape<"((8,1),(2))">
      %lay_1530 = cute.get_layout(%view_1523) : !memref_rmem_bf16_7
      %546 = cute.get_shape(%lay_1530) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1531, %e1_1532, %e2_1533 = cute.get_leaves(%546) : !cute.shape<"((8,1),(2))">
      %lay_1534 = cute.get_layout(%view_1509) : !memref_smem_bf16_15
      %sz_1535 = cute.size(%lay_1534) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1536 = cute.get_leaves(%sz_1535) : !cute.int_tuple<"2">
      %lay_1537 = cute.get_layout(%view_1523) : !memref_rmem_bf16_7
      %sz_1538 = cute.size(%lay_1537) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1539 = cute.get_leaves(%sz_1538) : !cute.int_tuple<"2">
      %547 = cute.static : !cute.layout<"1:0">
      %iter_1540 = cute.get_iter(%view_1509) : !memref_smem_bf16_15
      %iter_1541 = cute.get_iter(%view_1523) : !memref_rmem_bf16_7
      %lay_1542 = cute.get_layout(%view_1509) : !memref_smem_bf16_15
      %lay_1543 = cute.get_layout(%view_1523) : !memref_rmem_bf16_7
      %append_1544 = cute.append_to_rank<2> (%lay_1542, %547) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1545 = cute.append_to_rank<2> (%lay_1543, %547) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1546 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1547 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1548 = cute.size(%lay_1546) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %548 = cute.get_scalars(%sz_1548) : !cute.int_tuple<"2">
      %c0_i32_1549 = arith.constant 0 : i32
      %c1_i32_1550 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1549 to %548 step %c1_i32_1550  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1546, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1546) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_1540, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1547, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1547) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1541, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1551 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1552 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_1553 = cute.crd2idx(%coord_1551, %lay_1552) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_1554 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_1555 = cute.add_offset(%iter_1554, %idx_1553) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1556 = cute.make_view(%ptr_1555) : !memref_smem_bf16_17
      %iter_1557 = cute.get_iter(%view_1556) : !memref_smem_bf16_17
      %coord_1558 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1559 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_1560 = cute.crd2idx(%coord_1558, %lay_1559) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
      %iter_1561 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_1562 = cute.add_offset(%iter_1561, %idx_1560) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1563 = cute.make_view(%ptr_1562) : !memref_rmem_bf16_9
      %iter_1564 = cute.get_iter(%view_1563) : !memref_rmem_bf16_9
      %lay_1565 = cute.get_layout(%view_1556) : !memref_smem_bf16_17
      %549 = cute.get_shape(%lay_1565) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1566, %e1_1567, %e2_1568 = cute.get_leaves(%549) : !cute.shape<"((8,1),4)">
      %lay_1569 = cute.get_layout(%view_1563) : !memref_rmem_bf16_9
      %550 = cute.get_shape(%lay_1569) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1570, %e1_1571, %e2_1572 = cute.get_leaves(%550) : !cute.shape<"((8,1),4)">
      %lay_1573 = cute.get_layout(%view_1556) : !memref_smem_bf16_17
      %shape_1574 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1575 = cute.make_layout() : !cute.layout<"1:0">
      %append_1576 = cute.append_to_rank<2> (%lay_1573, %lay_1575) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1577 = cute.make_view(%iter_1557, %append_1576) : !memref_smem_bf16_17
      %iter_1578 = cute.get_iter(%view_1577) : !memref_smem_bf16_17
      %lay_1579 = cute.get_layout(%view_1577) : !memref_smem_bf16_17
      %551 = cute.get_shape(%lay_1579) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1580, %e1_1581, %e2_1582 = cute.get_leaves(%551) : !cute.shape<"((8,1),4)">
      %iter_1583 = cute.get_iter(%view_1577) : !memref_smem_bf16_17
      %view_1584 = cute.make_view(%iter_1583) : !memref_smem_bf16_18
      %iter_1585 = cute.get_iter(%view_1584) : !memref_smem_bf16_18
      %iter_1586 = cute.get_iter(%view_1584) : !memref_smem_bf16_18
      %lay_1587 = cute.get_layout(%view_1563) : !memref_rmem_bf16_9
      %shape_1588 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1589 = cute.make_layout() : !cute.layout<"1:0">
      %append_1590 = cute.append_to_rank<2> (%lay_1587, %lay_1589) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1591 = cute.make_view(%iter_1564, %append_1590) : !memref_rmem_bf16_9
      %iter_1592 = cute.get_iter(%view_1591) : !memref_rmem_bf16_9
      %lay_1593 = cute.get_layout(%view_1591) : !memref_rmem_bf16_9
      %552 = cute.get_shape(%lay_1593) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1594, %e1_1595, %e2_1596 = cute.get_leaves(%552) : !cute.shape<"((8,1),4)">
      %iter_1597 = cute.get_iter(%view_1591) : !memref_rmem_bf16_9
      %view_1598 = cute.make_view(%iter_1597) : !memref_rmem_bf16_10
      %iter_1599 = cute.get_iter(%view_1598) : !memref_rmem_bf16_10
      %iter_1600 = cute.get_iter(%view_1598) : !memref_rmem_bf16_10
      %lay_1601 = cute.get_layout(%view_1584) : !memref_smem_bf16_18
      %553 = cute.get_shape(%lay_1601) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1602, %e1_1603, %e2_1604 = cute.get_leaves(%553) : !cute.shape<"((8,1),(4))">
      %lay_1605 = cute.get_layout(%view_1598) : !memref_rmem_bf16_10
      %554 = cute.get_shape(%lay_1605) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1606, %e1_1607, %e2_1608 = cute.get_leaves(%554) : !cute.shape<"((8,1),(4))">
      %lay_1609 = cute.get_layout(%view_1584) : !memref_smem_bf16_18
      %sz_1610 = cute.size(%lay_1609) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1611 = cute.get_leaves(%sz_1610) : !cute.int_tuple<"4">
      %lay_1612 = cute.get_layout(%view_1598) : !memref_rmem_bf16_10
      %sz_1613 = cute.size(%lay_1612) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1614 = cute.get_leaves(%sz_1613) : !cute.int_tuple<"4">
      %555 = cute.static : !cute.layout<"1:0">
      %iter_1615 = cute.get_iter(%view_1584) : !memref_smem_bf16_18
      %iter_1616 = cute.get_iter(%view_1598) : !memref_rmem_bf16_10
      %lay_1617 = cute.get_layout(%view_1584) : !memref_smem_bf16_18
      %lay_1618 = cute.get_layout(%view_1598) : !memref_rmem_bf16_10
      %append_1619 = cute.append_to_rank<2> (%lay_1617, %555) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1620 = cute.append_to_rank<2> (%lay_1618, %555) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1621 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1622 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1623 = cute.size(%lay_1621) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %556 = cute.get_scalars(%sz_1623) : !cute.int_tuple<"4">
      %c0_i32_1624 = arith.constant 0 : i32
      %c1_i32_1625 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1624 to %556 step %c1_i32_1625  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1621, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1621) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_1615, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1622, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1622) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1616, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1626 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1627 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1628 = cute.crd2idx(%coord_1626, %lay_1627) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
      %iter_1629 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1630 = cute.add_offset(%iter_1629, %idx_1628) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1631 = cute.make_view(%ptr_1630) : !memref_rmem_bf16_12
      %iter_1632 = cute.get_iter(%view_1631) : !memref_rmem_bf16_12
      %coord_1633 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_1634 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1635 = cute.crd2idx(%coord_1633, %lay_1634) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
      %iter_1636 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1637 = cute.add_offset(%iter_1636, %idx_1635) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1638 = cute.make_view(%ptr_1637) : !memref_rmem_bf16_13
      %iter_1639 = cute.get_iter(%view_1638) : !memref_rmem_bf16_13
      %lay_1640 = cute.get_layout(%view_1631) : !memref_rmem_bf16_12
      %557 = cute.get_shape(%lay_1640) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1641, %e1_1642, %e2_1643, %e3_1644 = cute.get_leaves(%557) : !cute.shape<"((2,2,2),2)">
      %lay_1645 = cute.get_layout(%view_1638) : !memref_rmem_bf16_13
      %558 = cute.get_shape(%lay_1645) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1646, %e1_1647, %e2_1648 = cute.get_leaves(%558) : !cute.shape<"((2,2),8)">
      %iter_1649 = cute.get_iter(%view_1631) : !memref_rmem_bf16_12
      %iter_1650 = cute.get_iter(%view_1638) : !memref_rmem_bf16_13
      %iter_1651 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_1652 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_1653 = cute.get_layout(%view_1631) : !memref_rmem_bf16_12
      %lay_1654 = cute.get_layout(%view_1638) : !memref_rmem_bf16_13
      %lay_1655 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_1656 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %559 = cute.static : !cute.layout<"1:0">
      %append_1657 = cute.append_to_rank<3> (%lay_1653, %559) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1658 = cute.append_to_rank<3> (%lay_1654, %559) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1659 = cute.size(%append_1657) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1660 = cute.size(%append_1657) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1661 = cute.size(%append_1658) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %560 = cute.get_scalars(%sz_1659) : !cute.int_tuple<"1">
      %561 = cute.get_scalars(%sz_1660) : !cute.int_tuple<"2">
      %562 = cute.get_scalars(%sz_1661) : !cute.int_tuple<"8">
      %c0_i32_1662 = arith.constant 0 : i32
      %c1_i32_1663 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1662 to %560 step %c1_i32_1663  : i32 {
        scf.for %arg6 = %c0_i32_1662 to %561 step %c1_i32_1663  : i32 {
          scf.for %arg7 = %c0_i32_1662 to %562 step %c1_i32_1663  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_1657, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_1657) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_1649, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_1658, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_1658) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_1650, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_1655, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_1655) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_1651, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_1656, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_1656) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_1652, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1664 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1665 = cute.size(%int_tuple_1664) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1666 = cute.get_leaves(%sz_1665) : !cute.int_tuple<"8">
      %coord_1667 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1668 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_1669 = cute.crd2idx(%coord_1667, %lay_1668) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1670 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_1671 = cute.add_offset(%iter_1670, %idx_1669) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1672 = cute.make_view(%ptr_1671) : !memref_smem_bf16_14
      %iter_1673 = cute.get_iter(%view_1672) : !memref_smem_bf16_14
      %coord_1674 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1675 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1676 = cute.crd2idx(%coord_1674, %lay_1675) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
      %iter_1677 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1678 = cute.add_offset(%iter_1677, %idx_1676) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1679 = cute.make_view(%ptr_1678) : !memref_rmem_bf16_6
      %iter_1680 = cute.get_iter(%view_1679) : !memref_rmem_bf16_6
      %lay_1681 = cute.get_layout(%view_1672) : !memref_smem_bf16_14
      %563 = cute.get_shape(%lay_1681) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1682, %e1_1683, %e2_1684 = cute.get_leaves(%563) : !cute.shape<"((8,1),2)">
      %lay_1685 = cute.get_layout(%view_1679) : !memref_rmem_bf16_6
      %564 = cute.get_shape(%lay_1685) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1686, %e1_1687, %e2_1688 = cute.get_leaves(%564) : !cute.shape<"((8,1),2)">
      %lay_1689 = cute.get_layout(%view_1672) : !memref_smem_bf16_14
      %shape_1690 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1691 = cute.make_layout() : !cute.layout<"1:0">
      %append_1692 = cute.append_to_rank<2> (%lay_1689, %lay_1691) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1693 = cute.make_view(%iter_1673, %append_1692) : !memref_smem_bf16_14
      %iter_1694 = cute.get_iter(%view_1693) : !memref_smem_bf16_14
      %lay_1695 = cute.get_layout(%view_1693) : !memref_smem_bf16_14
      %565 = cute.get_shape(%lay_1695) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1696, %e1_1697, %e2_1698 = cute.get_leaves(%565) : !cute.shape<"((8,1),2)">
      %iter_1699 = cute.get_iter(%view_1693) : !memref_smem_bf16_14
      %view_1700 = cute.make_view(%iter_1699) : !memref_smem_bf16_15
      %iter_1701 = cute.get_iter(%view_1700) : !memref_smem_bf16_15
      %iter_1702 = cute.get_iter(%view_1700) : !memref_smem_bf16_15
      %lay_1703 = cute.get_layout(%view_1679) : !memref_rmem_bf16_6
      %shape_1704 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1705 = cute.make_layout() : !cute.layout<"1:0">
      %append_1706 = cute.append_to_rank<2> (%lay_1703, %lay_1705) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1707 = cute.make_view(%iter_1680, %append_1706) : !memref_rmem_bf16_6
      %iter_1708 = cute.get_iter(%view_1707) : !memref_rmem_bf16_6
      %lay_1709 = cute.get_layout(%view_1707) : !memref_rmem_bf16_6
      %566 = cute.get_shape(%lay_1709) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1710, %e1_1711, %e2_1712 = cute.get_leaves(%566) : !cute.shape<"((8,1),2)">
      %iter_1713 = cute.get_iter(%view_1707) : !memref_rmem_bf16_6
      %view_1714 = cute.make_view(%iter_1713) : !memref_rmem_bf16_7
      %iter_1715 = cute.get_iter(%view_1714) : !memref_rmem_bf16_7
      %iter_1716 = cute.get_iter(%view_1714) : !memref_rmem_bf16_7
      %lay_1717 = cute.get_layout(%view_1700) : !memref_smem_bf16_15
      %567 = cute.get_shape(%lay_1717) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1718, %e1_1719, %e2_1720 = cute.get_leaves(%567) : !cute.shape<"((8,1),(2))">
      %lay_1721 = cute.get_layout(%view_1714) : !memref_rmem_bf16_7
      %568 = cute.get_shape(%lay_1721) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1722, %e1_1723, %e2_1724 = cute.get_leaves(%568) : !cute.shape<"((8,1),(2))">
      %lay_1725 = cute.get_layout(%view_1700) : !memref_smem_bf16_15
      %sz_1726 = cute.size(%lay_1725) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1727 = cute.get_leaves(%sz_1726) : !cute.int_tuple<"2">
      %lay_1728 = cute.get_layout(%view_1714) : !memref_rmem_bf16_7
      %sz_1729 = cute.size(%lay_1728) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1730 = cute.get_leaves(%sz_1729) : !cute.int_tuple<"2">
      %569 = cute.static : !cute.layout<"1:0">
      %iter_1731 = cute.get_iter(%view_1700) : !memref_smem_bf16_15
      %iter_1732 = cute.get_iter(%view_1714) : !memref_rmem_bf16_7
      %lay_1733 = cute.get_layout(%view_1700) : !memref_smem_bf16_15
      %lay_1734 = cute.get_layout(%view_1714) : !memref_rmem_bf16_7
      %append_1735 = cute.append_to_rank<2> (%lay_1733, %569) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1736 = cute.append_to_rank<2> (%lay_1734, %569) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1737 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1738 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1739 = cute.size(%lay_1737) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %570 = cute.get_scalars(%sz_1739) : !cute.int_tuple<"2">
      %c0_i32_1740 = arith.constant 0 : i32
      %c1_i32_1741 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1740 to %570 step %c1_i32_1741  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1737, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1737) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_1731, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1738, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1738) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1732, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1742 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1743 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_1744 = cute.crd2idx(%coord_1742, %lay_1743) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_1745 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_1746 = cute.add_offset(%iter_1745, %idx_1744) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1747 = cute.make_view(%ptr_1746) : !memref_smem_bf16_17
      %iter_1748 = cute.get_iter(%view_1747) : !memref_smem_bf16_17
      %coord_1749 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_1750 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_1751 = cute.crd2idx(%coord_1749, %lay_1750) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
      %iter_1752 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_1753 = cute.add_offset(%iter_1752, %idx_1751) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1754 = cute.make_view(%ptr_1753) : !memref_rmem_bf16_9
      %iter_1755 = cute.get_iter(%view_1754) : !memref_rmem_bf16_9
      %lay_1756 = cute.get_layout(%view_1747) : !memref_smem_bf16_17
      %571 = cute.get_shape(%lay_1756) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1757, %e1_1758, %e2_1759 = cute.get_leaves(%571) : !cute.shape<"((8,1),4)">
      %lay_1760 = cute.get_layout(%view_1754) : !memref_rmem_bf16_9
      %572 = cute.get_shape(%lay_1760) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1761, %e1_1762, %e2_1763 = cute.get_leaves(%572) : !cute.shape<"((8,1),4)">
      %lay_1764 = cute.get_layout(%view_1747) : !memref_smem_bf16_17
      %shape_1765 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1766 = cute.make_layout() : !cute.layout<"1:0">
      %append_1767 = cute.append_to_rank<2> (%lay_1764, %lay_1766) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1768 = cute.make_view(%iter_1748, %append_1767) : !memref_smem_bf16_17
      %iter_1769 = cute.get_iter(%view_1768) : !memref_smem_bf16_17
      %lay_1770 = cute.get_layout(%view_1768) : !memref_smem_bf16_17
      %573 = cute.get_shape(%lay_1770) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1771, %e1_1772, %e2_1773 = cute.get_leaves(%573) : !cute.shape<"((8,1),4)">
      %iter_1774 = cute.get_iter(%view_1768) : !memref_smem_bf16_17
      %view_1775 = cute.make_view(%iter_1774) : !memref_smem_bf16_18
      %iter_1776 = cute.get_iter(%view_1775) : !memref_smem_bf16_18
      %iter_1777 = cute.get_iter(%view_1775) : !memref_smem_bf16_18
      %lay_1778 = cute.get_layout(%view_1754) : !memref_rmem_bf16_9
      %shape_1779 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1780 = cute.make_layout() : !cute.layout<"1:0">
      %append_1781 = cute.append_to_rank<2> (%lay_1778, %lay_1780) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1782 = cute.make_view(%iter_1755, %append_1781) : !memref_rmem_bf16_9
      %iter_1783 = cute.get_iter(%view_1782) : !memref_rmem_bf16_9
      %lay_1784 = cute.get_layout(%view_1782) : !memref_rmem_bf16_9
      %574 = cute.get_shape(%lay_1784) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1785, %e1_1786, %e2_1787 = cute.get_leaves(%574) : !cute.shape<"((8,1),4)">
      %iter_1788 = cute.get_iter(%view_1782) : !memref_rmem_bf16_9
      %view_1789 = cute.make_view(%iter_1788) : !memref_rmem_bf16_10
      %iter_1790 = cute.get_iter(%view_1789) : !memref_rmem_bf16_10
      %iter_1791 = cute.get_iter(%view_1789) : !memref_rmem_bf16_10
      %lay_1792 = cute.get_layout(%view_1775) : !memref_smem_bf16_18
      %575 = cute.get_shape(%lay_1792) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1793, %e1_1794, %e2_1795 = cute.get_leaves(%575) : !cute.shape<"((8,1),(4))">
      %lay_1796 = cute.get_layout(%view_1789) : !memref_rmem_bf16_10
      %576 = cute.get_shape(%lay_1796) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1797, %e1_1798, %e2_1799 = cute.get_leaves(%576) : !cute.shape<"((8,1),(4))">
      %lay_1800 = cute.get_layout(%view_1775) : !memref_smem_bf16_18
      %sz_1801 = cute.size(%lay_1800) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1802 = cute.get_leaves(%sz_1801) : !cute.int_tuple<"4">
      %lay_1803 = cute.get_layout(%view_1789) : !memref_rmem_bf16_10
      %sz_1804 = cute.size(%lay_1803) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1805 = cute.get_leaves(%sz_1804) : !cute.int_tuple<"4">
      %577 = cute.static : !cute.layout<"1:0">
      %iter_1806 = cute.get_iter(%view_1775) : !memref_smem_bf16_18
      %iter_1807 = cute.get_iter(%view_1789) : !memref_rmem_bf16_10
      %lay_1808 = cute.get_layout(%view_1775) : !memref_smem_bf16_18
      %lay_1809 = cute.get_layout(%view_1789) : !memref_rmem_bf16_10
      %append_1810 = cute.append_to_rank<2> (%lay_1808, %577) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_1811 = cute.append_to_rank<2> (%lay_1809, %577) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1812 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_1813 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_1814 = cute.size(%lay_1812) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %578 = cute.get_scalars(%sz_1814) : !cute.int_tuple<"4">
      %c0_i32_1815 = arith.constant 0 : i32
      %c1_i32_1816 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1815 to %578 step %c1_i32_1816  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1812, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1812) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_1806, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1813, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1813) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1807, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1817 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1818 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_1819 = cute.crd2idx(%coord_1817, %lay_1818) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
      %iter_1820 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_1821 = cute.add_offset(%iter_1820, %idx_1819) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1822 = cute.make_view(%ptr_1821) : !memref_rmem_bf16_12
      %iter_1823 = cute.get_iter(%view_1822) : !memref_rmem_bf16_12
      %coord_1824 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_1825 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_1826 = cute.crd2idx(%coord_1824, %lay_1825) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
      %iter_1827 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_1828 = cute.add_offset(%iter_1827, %idx_1826) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1829 = cute.make_view(%ptr_1828) : !memref_rmem_bf16_13
      %iter_1830 = cute.get_iter(%view_1829) : !memref_rmem_bf16_13
      %lay_1831 = cute.get_layout(%view_1822) : !memref_rmem_bf16_12
      %579 = cute.get_shape(%lay_1831) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_1832, %e1_1833, %e2_1834, %e3_1835 = cute.get_leaves(%579) : !cute.shape<"((2,2,2),2)">
      %lay_1836 = cute.get_layout(%view_1829) : !memref_rmem_bf16_13
      %580 = cute.get_shape(%lay_1836) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_1837, %e1_1838, %e2_1839 = cute.get_leaves(%580) : !cute.shape<"((2,2),8)">
      %iter_1840 = cute.get_iter(%view_1822) : !memref_rmem_bf16_12
      %iter_1841 = cute.get_iter(%view_1829) : !memref_rmem_bf16_13
      %iter_1842 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_1843 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_1844 = cute.get_layout(%view_1822) : !memref_rmem_bf16_12
      %lay_1845 = cute.get_layout(%view_1829) : !memref_rmem_bf16_13
      %lay_1846 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_1847 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %581 = cute.static : !cute.layout<"1:0">
      %append_1848 = cute.append_to_rank<3> (%lay_1844, %581) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_1849 = cute.append_to_rank<3> (%lay_1845, %581) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_1850 = cute.size(%append_1848) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_1851 = cute.size(%append_1848) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_1852 = cute.size(%append_1849) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %582 = cute.get_scalars(%sz_1850) : !cute.int_tuple<"1">
      %583 = cute.get_scalars(%sz_1851) : !cute.int_tuple<"2">
      %584 = cute.get_scalars(%sz_1852) : !cute.int_tuple<"8">
      %c0_i32_1853 = arith.constant 0 : i32
      %c1_i32_1854 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1853 to %582 step %c1_i32_1854  : i32 {
        scf.for %arg6 = %c0_i32_1853 to %583 step %c1_i32_1854  : i32 {
          scf.for %arg7 = %c0_i32_1853 to %584 step %c1_i32_1854  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_1848, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_1848) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_1840, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_1849, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_1849) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_1841, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_1846, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_1846) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_1842, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_1847, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_1847) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_1843, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_1855 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_1856 = cute.size(%int_tuple_1855) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_1857 = cute.get_leaves(%sz_1856) : !cute.int_tuple<"8">
      %coord_1858 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1859 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_1860 = cute.crd2idx(%coord_1858, %lay_1859) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
      %iter_1861 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_1862 = cute.add_offset(%iter_1861, %idx_1860) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1863 = cute.make_view(%ptr_1862) : !memref_smem_bf16_14
      %iter_1864 = cute.get_iter(%view_1863) : !memref_smem_bf16_14
      %coord_1865 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1866 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_1867 = cute.crd2idx(%coord_1865, %lay_1866) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
      %iter_1868 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_1869 = cute.add_offset(%iter_1868, %idx_1867) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_1870 = cute.make_view(%ptr_1869) : !memref_rmem_bf16_6
      %iter_1871 = cute.get_iter(%view_1870) : !memref_rmem_bf16_6
      %lay_1872 = cute.get_layout(%view_1863) : !memref_smem_bf16_14
      %585 = cute.get_shape(%lay_1872) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1873, %e1_1874, %e2_1875 = cute.get_leaves(%585) : !cute.shape<"((8,1),2)">
      %lay_1876 = cute.get_layout(%view_1870) : !memref_rmem_bf16_6
      %586 = cute.get_shape(%lay_1876) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1877, %e1_1878, %e2_1879 = cute.get_leaves(%586) : !cute.shape<"((8,1),2)">
      %lay_1880 = cute.get_layout(%view_1863) : !memref_smem_bf16_14
      %shape_1881 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1882 = cute.make_layout() : !cute.layout<"1:0">
      %append_1883 = cute.append_to_rank<2> (%lay_1880, %lay_1882) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_1884 = cute.make_view(%iter_1864, %append_1883) : !memref_smem_bf16_14
      %iter_1885 = cute.get_iter(%view_1884) : !memref_smem_bf16_14
      %lay_1886 = cute.get_layout(%view_1884) : !memref_smem_bf16_14
      %587 = cute.get_shape(%lay_1886) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_1887, %e1_1888, %e2_1889 = cute.get_leaves(%587) : !cute.shape<"((8,1),2)">
      %iter_1890 = cute.get_iter(%view_1884) : !memref_smem_bf16_14
      %view_1891 = cute.make_view(%iter_1890) : !memref_smem_bf16_15
      %iter_1892 = cute.get_iter(%view_1891) : !memref_smem_bf16_15
      %iter_1893 = cute.get_iter(%view_1891) : !memref_smem_bf16_15
      %lay_1894 = cute.get_layout(%view_1870) : !memref_rmem_bf16_6
      %shape_1895 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1896 = cute.make_layout() : !cute.layout<"1:0">
      %append_1897 = cute.append_to_rank<2> (%lay_1894, %lay_1896) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_1898 = cute.make_view(%iter_1871, %append_1897) : !memref_rmem_bf16_6
      %iter_1899 = cute.get_iter(%view_1898) : !memref_rmem_bf16_6
      %lay_1900 = cute.get_layout(%view_1898) : !memref_rmem_bf16_6
      %588 = cute.get_shape(%lay_1900) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_1901, %e1_1902, %e2_1903 = cute.get_leaves(%588) : !cute.shape<"((8,1),2)">
      %iter_1904 = cute.get_iter(%view_1898) : !memref_rmem_bf16_6
      %view_1905 = cute.make_view(%iter_1904) : !memref_rmem_bf16_7
      %iter_1906 = cute.get_iter(%view_1905) : !memref_rmem_bf16_7
      %iter_1907 = cute.get_iter(%view_1905) : !memref_rmem_bf16_7
      %lay_1908 = cute.get_layout(%view_1891) : !memref_smem_bf16_15
      %589 = cute.get_shape(%lay_1908) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_1909, %e1_1910, %e2_1911 = cute.get_leaves(%589) : !cute.shape<"((8,1),(2))">
      %lay_1912 = cute.get_layout(%view_1905) : !memref_rmem_bf16_7
      %590 = cute.get_shape(%lay_1912) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_1913, %e1_1914, %e2_1915 = cute.get_leaves(%590) : !cute.shape<"((8,1),(2))">
      %lay_1916 = cute.get_layout(%view_1891) : !memref_smem_bf16_15
      %sz_1917 = cute.size(%lay_1916) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_1918 = cute.get_leaves(%sz_1917) : !cute.int_tuple<"2">
      %lay_1919 = cute.get_layout(%view_1905) : !memref_rmem_bf16_7
      %sz_1920 = cute.size(%lay_1919) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_1921 = cute.get_leaves(%sz_1920) : !cute.int_tuple<"2">
      %591 = cute.static : !cute.layout<"1:0">
      %iter_1922 = cute.get_iter(%view_1891) : !memref_smem_bf16_15
      %iter_1923 = cute.get_iter(%view_1905) : !memref_rmem_bf16_7
      %lay_1924 = cute.get_layout(%view_1891) : !memref_smem_bf16_15
      %lay_1925 = cute.get_layout(%view_1905) : !memref_rmem_bf16_7
      %append_1926 = cute.append_to_rank<2> (%lay_1924, %591) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_1927 = cute.append_to_rank<2> (%lay_1925, %591) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_1928 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_1929 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_1930 = cute.size(%lay_1928) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %592 = cute.get_scalars(%sz_1930) : !cute.int_tuple<"2">
      %c0_i32_1931 = arith.constant 0 : i32
      %c1_i32_1932 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_1931 to %592 step %c1_i32_1932  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_1928, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_1928) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_1922, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_1929, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_1929) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1923, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_1933 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1934 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_1935 = cute.crd2idx(%coord_1933, %lay_1934) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
      %iter_1936 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_1937 = cute.add_offset(%iter_1936, %idx_1935) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
      %view_1938 = cute.make_view(%ptr_1937) : !memref_smem_bf16_17
      %iter_1939 = cute.get_iter(%view_1938) : !memref_smem_bf16_17
      %coord_1940 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_1941 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_1942 = cute.crd2idx(%coord_1940, %lay_1941) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
      %iter_1943 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_1944 = cute.add_offset(%iter_1943, %idx_1942) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_1945 = cute.make_view(%ptr_1944) : !memref_rmem_bf16_9
      %iter_1946 = cute.get_iter(%view_1945) : !memref_rmem_bf16_9
      %lay_1947 = cute.get_layout(%view_1938) : !memref_smem_bf16_17
      %593 = cute.get_shape(%lay_1947) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1948, %e1_1949, %e2_1950 = cute.get_leaves(%593) : !cute.shape<"((8,1),4)">
      %lay_1951 = cute.get_layout(%view_1945) : !memref_rmem_bf16_9
      %594 = cute.get_shape(%lay_1951) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1952, %e1_1953, %e2_1954 = cute.get_leaves(%594) : !cute.shape<"((8,1),4)">
      %lay_1955 = cute.get_layout(%view_1938) : !memref_smem_bf16_17
      %shape_1956 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1957 = cute.make_layout() : !cute.layout<"1:0">
      %append_1958 = cute.append_to_rank<2> (%lay_1955, %lay_1957) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_1959 = cute.make_view(%iter_1939, %append_1958) : !memref_smem_bf16_17
      %iter_1960 = cute.get_iter(%view_1959) : !memref_smem_bf16_17
      %lay_1961 = cute.get_layout(%view_1959) : !memref_smem_bf16_17
      %595 = cute.get_shape(%lay_1961) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_1962, %e1_1963, %e2_1964 = cute.get_leaves(%595) : !cute.shape<"((8,1),4)">
      %iter_1965 = cute.get_iter(%view_1959) : !memref_smem_bf16_17
      %view_1966 = cute.make_view(%iter_1965) : !memref_smem_bf16_18
      %iter_1967 = cute.get_iter(%view_1966) : !memref_smem_bf16_18
      %iter_1968 = cute.get_iter(%view_1966) : !memref_smem_bf16_18
      %lay_1969 = cute.get_layout(%view_1945) : !memref_rmem_bf16_9
      %shape_1970 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_1971 = cute.make_layout() : !cute.layout<"1:0">
      %append_1972 = cute.append_to_rank<2> (%lay_1969, %lay_1971) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_1973 = cute.make_view(%iter_1946, %append_1972) : !memref_rmem_bf16_9
      %iter_1974 = cute.get_iter(%view_1973) : !memref_rmem_bf16_9
      %lay_1975 = cute.get_layout(%view_1973) : !memref_rmem_bf16_9
      %596 = cute.get_shape(%lay_1975) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_1976, %e1_1977, %e2_1978 = cute.get_leaves(%596) : !cute.shape<"((8,1),4)">
      %iter_1979 = cute.get_iter(%view_1973) : !memref_rmem_bf16_9
      %view_1980 = cute.make_view(%iter_1979) : !memref_rmem_bf16_10
      %iter_1981 = cute.get_iter(%view_1980) : !memref_rmem_bf16_10
      %iter_1982 = cute.get_iter(%view_1980) : !memref_rmem_bf16_10
      %lay_1983 = cute.get_layout(%view_1966) : !memref_smem_bf16_18
      %597 = cute.get_shape(%lay_1983) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_1984, %e1_1985, %e2_1986 = cute.get_leaves(%597) : !cute.shape<"((8,1),(4))">
      %lay_1987 = cute.get_layout(%view_1980) : !memref_rmem_bf16_10
      %598 = cute.get_shape(%lay_1987) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_1988, %e1_1989, %e2_1990 = cute.get_leaves(%598) : !cute.shape<"((8,1),(4))">
      %lay_1991 = cute.get_layout(%view_1966) : !memref_smem_bf16_18
      %sz_1992 = cute.size(%lay_1991) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_1993 = cute.get_leaves(%sz_1992) : !cute.int_tuple<"4">
      %lay_1994 = cute.get_layout(%view_1980) : !memref_rmem_bf16_10
      %sz_1995 = cute.size(%lay_1994) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_1996 = cute.get_leaves(%sz_1995) : !cute.int_tuple<"4">
      %599 = cute.static : !cute.layout<"1:0">
      %iter_1997 = cute.get_iter(%view_1966) : !memref_smem_bf16_18
      %iter_1998 = cute.get_iter(%view_1980) : !memref_rmem_bf16_10
      %lay_1999 = cute.get_layout(%view_1966) : !memref_smem_bf16_18
      %lay_2000 = cute.get_layout(%view_1980) : !memref_rmem_bf16_10
      %append_2001 = cute.append_to_rank<2> (%lay_1999, %599) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2002 = cute.append_to_rank<2> (%lay_2000, %599) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2003 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2004 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2005 = cute.size(%lay_2003) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %600 = cute.get_scalars(%sz_2005) : !cute.int_tuple<"4">
      %c0_i32_2006 = arith.constant 0 : i32
      %c1_i32_2007 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2006 to %600 step %c1_i32_2007  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2003, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2003) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_1997, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2004, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2004) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_1998, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2008 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2009 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2010 = cute.crd2idx(%coord_2008, %lay_2009) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
      %iter_2011 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2012 = cute.add_offset(%iter_2011, %idx_2010) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2013 = cute.make_view(%ptr_2012) : !memref_rmem_bf16_12
      %iter_2014 = cute.get_iter(%view_2013) : !memref_rmem_bf16_12
      %coord_2015 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_2016 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2017 = cute.crd2idx(%coord_2015, %lay_2016) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
      %iter_2018 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2019 = cute.add_offset(%iter_2018, %idx_2017) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2020 = cute.make_view(%ptr_2019) : !memref_rmem_bf16_13
      %iter_2021 = cute.get_iter(%view_2020) : !memref_rmem_bf16_13
      %lay_2022 = cute.get_layout(%view_2013) : !memref_rmem_bf16_12
      %601 = cute.get_shape(%lay_2022) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2023, %e1_2024, %e2_2025, %e3_2026 = cute.get_leaves(%601) : !cute.shape<"((2,2,2),2)">
      %lay_2027 = cute.get_layout(%view_2020) : !memref_rmem_bf16_13
      %602 = cute.get_shape(%lay_2027) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2028, %e1_2029, %e2_2030 = cute.get_leaves(%602) : !cute.shape<"((2,2),8)">
      %iter_2031 = cute.get_iter(%view_2013) : !memref_rmem_bf16_12
      %iter_2032 = cute.get_iter(%view_2020) : !memref_rmem_bf16_13
      %iter_2033 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_2034 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_2035 = cute.get_layout(%view_2013) : !memref_rmem_bf16_12
      %lay_2036 = cute.get_layout(%view_2020) : !memref_rmem_bf16_13
      %lay_2037 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2038 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %603 = cute.static : !cute.layout<"1:0">
      %append_2039 = cute.append_to_rank<3> (%lay_2035, %603) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2040 = cute.append_to_rank<3> (%lay_2036, %603) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2041 = cute.size(%append_2039) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2042 = cute.size(%append_2039) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2043 = cute.size(%append_2040) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %604 = cute.get_scalars(%sz_2041) : !cute.int_tuple<"1">
      %605 = cute.get_scalars(%sz_2042) : !cute.int_tuple<"2">
      %606 = cute.get_scalars(%sz_2043) : !cute.int_tuple<"8">
      %c0_i32_2044 = arith.constant 0 : i32
      %c1_i32_2045 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2044 to %604 step %c1_i32_2045  : i32 {
        scf.for %arg6 = %c0_i32_2044 to %605 step %c1_i32_2045  : i32 {
          scf.for %arg7 = %c0_i32_2044 to %606 step %c1_i32_2045  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_2039, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_2039) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_2031, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_2040, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_2040) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_2032, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_2037, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_2037) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_2033, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_2038, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_2038) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_2034, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2046 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2047 = cute.size(%int_tuple_2046) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2048 = cute.get_leaves(%sz_2047) : !cute.int_tuple<"8">
      %coord_2049 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2050 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_2051 = cute.crd2idx(%coord_2049, %lay_2050) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2052 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_2053 = cute.add_offset(%iter_2052, %idx_2051) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2054 = cute.make_view(%ptr_2053) : !memref_smem_bf16_14
      %iter_2055 = cute.get_iter(%view_2054) : !memref_smem_bf16_14
      %coord_2056 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2057 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2058 = cute.crd2idx(%coord_2056, %lay_2057) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
      %iter_2059 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2060 = cute.add_offset(%iter_2059, %idx_2058) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2061 = cute.make_view(%ptr_2060) : !memref_rmem_bf16_6
      %iter_2062 = cute.get_iter(%view_2061) : !memref_rmem_bf16_6
      %lay_2063 = cute.get_layout(%view_2054) : !memref_smem_bf16_14
      %607 = cute.get_shape(%lay_2063) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2064, %e1_2065, %e2_2066 = cute.get_leaves(%607) : !cute.shape<"((8,1),2)">
      %lay_2067 = cute.get_layout(%view_2061) : !memref_rmem_bf16_6
      %608 = cute.get_shape(%lay_2067) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2068, %e1_2069, %e2_2070 = cute.get_leaves(%608) : !cute.shape<"((8,1),2)">
      %lay_2071 = cute.get_layout(%view_2054) : !memref_smem_bf16_14
      %shape_2072 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2073 = cute.make_layout() : !cute.layout<"1:0">
      %append_2074 = cute.append_to_rank<2> (%lay_2071, %lay_2073) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2075 = cute.make_view(%iter_2055, %append_2074) : !memref_smem_bf16_14
      %iter_2076 = cute.get_iter(%view_2075) : !memref_smem_bf16_14
      %lay_2077 = cute.get_layout(%view_2075) : !memref_smem_bf16_14
      %609 = cute.get_shape(%lay_2077) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2078, %e1_2079, %e2_2080 = cute.get_leaves(%609) : !cute.shape<"((8,1),2)">
      %iter_2081 = cute.get_iter(%view_2075) : !memref_smem_bf16_14
      %view_2082 = cute.make_view(%iter_2081) : !memref_smem_bf16_15
      %iter_2083 = cute.get_iter(%view_2082) : !memref_smem_bf16_15
      %iter_2084 = cute.get_iter(%view_2082) : !memref_smem_bf16_15
      %lay_2085 = cute.get_layout(%view_2061) : !memref_rmem_bf16_6
      %shape_2086 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2087 = cute.make_layout() : !cute.layout<"1:0">
      %append_2088 = cute.append_to_rank<2> (%lay_2085, %lay_2087) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2089 = cute.make_view(%iter_2062, %append_2088) : !memref_rmem_bf16_6
      %iter_2090 = cute.get_iter(%view_2089) : !memref_rmem_bf16_6
      %lay_2091 = cute.get_layout(%view_2089) : !memref_rmem_bf16_6
      %610 = cute.get_shape(%lay_2091) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2092, %e1_2093, %e2_2094 = cute.get_leaves(%610) : !cute.shape<"((8,1),2)">
      %iter_2095 = cute.get_iter(%view_2089) : !memref_rmem_bf16_6
      %view_2096 = cute.make_view(%iter_2095) : !memref_rmem_bf16_7
      %iter_2097 = cute.get_iter(%view_2096) : !memref_rmem_bf16_7
      %iter_2098 = cute.get_iter(%view_2096) : !memref_rmem_bf16_7
      %lay_2099 = cute.get_layout(%view_2082) : !memref_smem_bf16_15
      %611 = cute.get_shape(%lay_2099) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2100, %e1_2101, %e2_2102 = cute.get_leaves(%611) : !cute.shape<"((8,1),(2))">
      %lay_2103 = cute.get_layout(%view_2096) : !memref_rmem_bf16_7
      %612 = cute.get_shape(%lay_2103) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2104, %e1_2105, %e2_2106 = cute.get_leaves(%612) : !cute.shape<"((8,1),(2))">
      %lay_2107 = cute.get_layout(%view_2082) : !memref_smem_bf16_15
      %sz_2108 = cute.size(%lay_2107) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2109 = cute.get_leaves(%sz_2108) : !cute.int_tuple<"2">
      %lay_2110 = cute.get_layout(%view_2096) : !memref_rmem_bf16_7
      %sz_2111 = cute.size(%lay_2110) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2112 = cute.get_leaves(%sz_2111) : !cute.int_tuple<"2">
      %613 = cute.static : !cute.layout<"1:0">
      %iter_2113 = cute.get_iter(%view_2082) : !memref_smem_bf16_15
      %iter_2114 = cute.get_iter(%view_2096) : !memref_rmem_bf16_7
      %lay_2115 = cute.get_layout(%view_2082) : !memref_smem_bf16_15
      %lay_2116 = cute.get_layout(%view_2096) : !memref_rmem_bf16_7
      %append_2117 = cute.append_to_rank<2> (%lay_2115, %613) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2118 = cute.append_to_rank<2> (%lay_2116, %613) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2119 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2120 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2121 = cute.size(%lay_2119) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %614 = cute.get_scalars(%sz_2121) : !cute.int_tuple<"2">
      %c0_i32_2122 = arith.constant 0 : i32
      %c1_i32_2123 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2122 to %614 step %c1_i32_2123  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2119, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2119) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_2113, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2120, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2120) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2114, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2124 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2125 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_2126 = cute.crd2idx(%coord_2124, %lay_2125) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2127 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_2128 = cute.add_offset(%iter_2127, %idx_2126) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2129 = cute.make_view(%ptr_2128) : !memref_smem_bf16_17
      %iter_2130 = cute.get_iter(%view_2129) : !memref_smem_bf16_17
      %coord_2131 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2132 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_2133 = cute.crd2idx(%coord_2131, %lay_2132) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
      %iter_2134 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_2135 = cute.add_offset(%iter_2134, %idx_2133) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2136 = cute.make_view(%ptr_2135) : !memref_rmem_bf16_9
      %iter_2137 = cute.get_iter(%view_2136) : !memref_rmem_bf16_9
      %lay_2138 = cute.get_layout(%view_2129) : !memref_smem_bf16_17
      %615 = cute.get_shape(%lay_2138) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2139, %e1_2140, %e2_2141 = cute.get_leaves(%615) : !cute.shape<"((8,1),4)">
      %lay_2142 = cute.get_layout(%view_2136) : !memref_rmem_bf16_9
      %616 = cute.get_shape(%lay_2142) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2143, %e1_2144, %e2_2145 = cute.get_leaves(%616) : !cute.shape<"((8,1),4)">
      %lay_2146 = cute.get_layout(%view_2129) : !memref_smem_bf16_17
      %shape_2147 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2148 = cute.make_layout() : !cute.layout<"1:0">
      %append_2149 = cute.append_to_rank<2> (%lay_2146, %lay_2148) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2150 = cute.make_view(%iter_2130, %append_2149) : !memref_smem_bf16_17
      %iter_2151 = cute.get_iter(%view_2150) : !memref_smem_bf16_17
      %lay_2152 = cute.get_layout(%view_2150) : !memref_smem_bf16_17
      %617 = cute.get_shape(%lay_2152) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2153, %e1_2154, %e2_2155 = cute.get_leaves(%617) : !cute.shape<"((8,1),4)">
      %iter_2156 = cute.get_iter(%view_2150) : !memref_smem_bf16_17
      %view_2157 = cute.make_view(%iter_2156) : !memref_smem_bf16_18
      %iter_2158 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
      %iter_2159 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
      %lay_2160 = cute.get_layout(%view_2136) : !memref_rmem_bf16_9
      %shape_2161 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2162 = cute.make_layout() : !cute.layout<"1:0">
      %append_2163 = cute.append_to_rank<2> (%lay_2160, %lay_2162) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2164 = cute.make_view(%iter_2137, %append_2163) : !memref_rmem_bf16_9
      %iter_2165 = cute.get_iter(%view_2164) : !memref_rmem_bf16_9
      %lay_2166 = cute.get_layout(%view_2164) : !memref_rmem_bf16_9
      %618 = cute.get_shape(%lay_2166) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2167, %e1_2168, %e2_2169 = cute.get_leaves(%618) : !cute.shape<"((8,1),4)">
      %iter_2170 = cute.get_iter(%view_2164) : !memref_rmem_bf16_9
      %view_2171 = cute.make_view(%iter_2170) : !memref_rmem_bf16_10
      %iter_2172 = cute.get_iter(%view_2171) : !memref_rmem_bf16_10
      %iter_2173 = cute.get_iter(%view_2171) : !memref_rmem_bf16_10
      %lay_2174 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
      %619 = cute.get_shape(%lay_2174) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2175, %e1_2176, %e2_2177 = cute.get_leaves(%619) : !cute.shape<"((8,1),(4))">
      %lay_2178 = cute.get_layout(%view_2171) : !memref_rmem_bf16_10
      %620 = cute.get_shape(%lay_2178) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2179, %e1_2180, %e2_2181 = cute.get_leaves(%620) : !cute.shape<"((8,1),(4))">
      %lay_2182 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
      %sz_2183 = cute.size(%lay_2182) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2184 = cute.get_leaves(%sz_2183) : !cute.int_tuple<"4">
      %lay_2185 = cute.get_layout(%view_2171) : !memref_rmem_bf16_10
      %sz_2186 = cute.size(%lay_2185) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2187 = cute.get_leaves(%sz_2186) : !cute.int_tuple<"4">
      %621 = cute.static : !cute.layout<"1:0">
      %iter_2188 = cute.get_iter(%view_2157) : !memref_smem_bf16_18
      %iter_2189 = cute.get_iter(%view_2171) : !memref_rmem_bf16_10
      %lay_2190 = cute.get_layout(%view_2157) : !memref_smem_bf16_18
      %lay_2191 = cute.get_layout(%view_2171) : !memref_rmem_bf16_10
      %append_2192 = cute.append_to_rank<2> (%lay_2190, %621) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2193 = cute.append_to_rank<2> (%lay_2191, %621) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2194 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2195 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2196 = cute.size(%lay_2194) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %622 = cute.get_scalars(%sz_2196) : !cute.int_tuple<"4">
      %c0_i32_2197 = arith.constant 0 : i32
      %c1_i32_2198 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2197 to %622 step %c1_i32_2198  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2194, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2194) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_2188, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2195, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2195) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2189, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2199 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2200 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2201 = cute.crd2idx(%coord_2199, %lay_2200) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
      %iter_2202 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2203 = cute.add_offset(%iter_2202, %idx_2201) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2204 = cute.make_view(%ptr_2203) : !memref_rmem_bf16_12
      %iter_2205 = cute.get_iter(%view_2204) : !memref_rmem_bf16_12
      %coord_2206 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
      %lay_2207 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2208 = cute.crd2idx(%coord_2206, %lay_2207) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
      %iter_2209 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2210 = cute.add_offset(%iter_2209, %idx_2208) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2211 = cute.make_view(%ptr_2210) : !memref_rmem_bf16_13
      %iter_2212 = cute.get_iter(%view_2211) : !memref_rmem_bf16_13
      %lay_2213 = cute.get_layout(%view_2204) : !memref_rmem_bf16_12
      %623 = cute.get_shape(%lay_2213) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2214, %e1_2215, %e2_2216, %e3_2217 = cute.get_leaves(%623) : !cute.shape<"((2,2,2),2)">
      %lay_2218 = cute.get_layout(%view_2211) : !memref_rmem_bf16_13
      %624 = cute.get_shape(%lay_2218) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2219, %e1_2220, %e2_2221 = cute.get_leaves(%624) : !cute.shape<"((2,2),8)">
      %iter_2222 = cute.get_iter(%view_2204) : !memref_rmem_bf16_12
      %iter_2223 = cute.get_iter(%view_2211) : !memref_rmem_bf16_13
      %iter_2224 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_2225 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_2226 = cute.get_layout(%view_2204) : !memref_rmem_bf16_12
      %lay_2227 = cute.get_layout(%view_2211) : !memref_rmem_bf16_13
      %lay_2228 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2229 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %625 = cute.static : !cute.layout<"1:0">
      %append_2230 = cute.append_to_rank<3> (%lay_2226, %625) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2231 = cute.append_to_rank<3> (%lay_2227, %625) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2232 = cute.size(%append_2230) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2233 = cute.size(%append_2230) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2234 = cute.size(%append_2231) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %626 = cute.get_scalars(%sz_2232) : !cute.int_tuple<"1">
      %627 = cute.get_scalars(%sz_2233) : !cute.int_tuple<"2">
      %628 = cute.get_scalars(%sz_2234) : !cute.int_tuple<"8">
      %c0_i32_2235 = arith.constant 0 : i32
      %c1_i32_2236 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2235 to %626 step %c1_i32_2236  : i32 {
        scf.for %arg6 = %c0_i32_2235 to %627 step %c1_i32_2236  : i32 {
          scf.for %arg7 = %c0_i32_2235 to %628 step %c1_i32_2236  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_2230, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_2230) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_2222, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_2231, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_2231) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_2223, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_2228, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_2228) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_2224, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_2229, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_2229) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_2225, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2237 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2238 = cute.size(%int_tuple_2237) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2239 = cute.get_leaves(%sz_2238) : !cute.int_tuple<"8">
      %coord_2240 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2241 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_2242 = cute.crd2idx(%coord_2240, %lay_2241) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2243 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_2244 = cute.add_offset(%iter_2243, %idx_2242) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2245 = cute.make_view(%ptr_2244) : !memref_smem_bf16_14
      %iter_2246 = cute.get_iter(%view_2245) : !memref_smem_bf16_14
      %coord_2247 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2248 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2249 = cute.crd2idx(%coord_2247, %lay_2248) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
      %iter_2250 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2251 = cute.add_offset(%iter_2250, %idx_2249) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2252 = cute.make_view(%ptr_2251) : !memref_rmem_bf16_6
      %iter_2253 = cute.get_iter(%view_2252) : !memref_rmem_bf16_6
      %lay_2254 = cute.get_layout(%view_2245) : !memref_smem_bf16_14
      %629 = cute.get_shape(%lay_2254) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2255, %e1_2256, %e2_2257 = cute.get_leaves(%629) : !cute.shape<"((8,1),2)">
      %lay_2258 = cute.get_layout(%view_2252) : !memref_rmem_bf16_6
      %630 = cute.get_shape(%lay_2258) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2259, %e1_2260, %e2_2261 = cute.get_leaves(%630) : !cute.shape<"((8,1),2)">
      %lay_2262 = cute.get_layout(%view_2245) : !memref_smem_bf16_14
      %shape_2263 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2264 = cute.make_layout() : !cute.layout<"1:0">
      %append_2265 = cute.append_to_rank<2> (%lay_2262, %lay_2264) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2266 = cute.make_view(%iter_2246, %append_2265) : !memref_smem_bf16_14
      %iter_2267 = cute.get_iter(%view_2266) : !memref_smem_bf16_14
      %lay_2268 = cute.get_layout(%view_2266) : !memref_smem_bf16_14
      %631 = cute.get_shape(%lay_2268) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2269, %e1_2270, %e2_2271 = cute.get_leaves(%631) : !cute.shape<"((8,1),2)">
      %iter_2272 = cute.get_iter(%view_2266) : !memref_smem_bf16_14
      %view_2273 = cute.make_view(%iter_2272) : !memref_smem_bf16_15
      %iter_2274 = cute.get_iter(%view_2273) : !memref_smem_bf16_15
      %iter_2275 = cute.get_iter(%view_2273) : !memref_smem_bf16_15
      %lay_2276 = cute.get_layout(%view_2252) : !memref_rmem_bf16_6
      %shape_2277 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2278 = cute.make_layout() : !cute.layout<"1:0">
      %append_2279 = cute.append_to_rank<2> (%lay_2276, %lay_2278) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2280 = cute.make_view(%iter_2253, %append_2279) : !memref_rmem_bf16_6
      %iter_2281 = cute.get_iter(%view_2280) : !memref_rmem_bf16_6
      %lay_2282 = cute.get_layout(%view_2280) : !memref_rmem_bf16_6
      %632 = cute.get_shape(%lay_2282) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2283, %e1_2284, %e2_2285 = cute.get_leaves(%632) : !cute.shape<"((8,1),2)">
      %iter_2286 = cute.get_iter(%view_2280) : !memref_rmem_bf16_6
      %view_2287 = cute.make_view(%iter_2286) : !memref_rmem_bf16_7
      %iter_2288 = cute.get_iter(%view_2287) : !memref_rmem_bf16_7
      %iter_2289 = cute.get_iter(%view_2287) : !memref_rmem_bf16_7
      %lay_2290 = cute.get_layout(%view_2273) : !memref_smem_bf16_15
      %633 = cute.get_shape(%lay_2290) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2291, %e1_2292, %e2_2293 = cute.get_leaves(%633) : !cute.shape<"((8,1),(2))">
      %lay_2294 = cute.get_layout(%view_2287) : !memref_rmem_bf16_7
      %634 = cute.get_shape(%lay_2294) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2295, %e1_2296, %e2_2297 = cute.get_leaves(%634) : !cute.shape<"((8,1),(2))">
      %lay_2298 = cute.get_layout(%view_2273) : !memref_smem_bf16_15
      %sz_2299 = cute.size(%lay_2298) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2300 = cute.get_leaves(%sz_2299) : !cute.int_tuple<"2">
      %lay_2301 = cute.get_layout(%view_2287) : !memref_rmem_bf16_7
      %sz_2302 = cute.size(%lay_2301) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2303 = cute.get_leaves(%sz_2302) : !cute.int_tuple<"2">
      %635 = cute.static : !cute.layout<"1:0">
      %iter_2304 = cute.get_iter(%view_2273) : !memref_smem_bf16_15
      %iter_2305 = cute.get_iter(%view_2287) : !memref_rmem_bf16_7
      %lay_2306 = cute.get_layout(%view_2273) : !memref_smem_bf16_15
      %lay_2307 = cute.get_layout(%view_2287) : !memref_rmem_bf16_7
      %append_2308 = cute.append_to_rank<2> (%lay_2306, %635) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2309 = cute.append_to_rank<2> (%lay_2307, %635) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2310 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2311 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2312 = cute.size(%lay_2310) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %636 = cute.get_scalars(%sz_2312) : !cute.int_tuple<"2">
      %c0_i32_2313 = arith.constant 0 : i32
      %c1_i32_2314 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2313 to %636 step %c1_i32_2314  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2310, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2310) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_2304, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2311, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2311) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2305, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2315 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2316 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_2317 = cute.crd2idx(%coord_2315, %lay_2316) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
      %iter_2318 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_2319 = cute.add_offset(%iter_2318, %idx_2317) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2320 = cute.make_view(%ptr_2319) : !memref_smem_bf16_17
      %iter_2321 = cute.get_iter(%view_2320) : !memref_smem_bf16_17
      %coord_2322 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2323 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_2324 = cute.crd2idx(%coord_2322, %lay_2323) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
      %iter_2325 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_2326 = cute.add_offset(%iter_2325, %idx_2324) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2327 = cute.make_view(%ptr_2326) : !memref_rmem_bf16_9
      %iter_2328 = cute.get_iter(%view_2327) : !memref_rmem_bf16_9
      %lay_2329 = cute.get_layout(%view_2320) : !memref_smem_bf16_17
      %637 = cute.get_shape(%lay_2329) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2330, %e1_2331, %e2_2332 = cute.get_leaves(%637) : !cute.shape<"((8,1),4)">
      %lay_2333 = cute.get_layout(%view_2327) : !memref_rmem_bf16_9
      %638 = cute.get_shape(%lay_2333) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2334, %e1_2335, %e2_2336 = cute.get_leaves(%638) : !cute.shape<"((8,1),4)">
      %lay_2337 = cute.get_layout(%view_2320) : !memref_smem_bf16_17
      %shape_2338 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2339 = cute.make_layout() : !cute.layout<"1:0">
      %append_2340 = cute.append_to_rank<2> (%lay_2337, %lay_2339) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2341 = cute.make_view(%iter_2321, %append_2340) : !memref_smem_bf16_17
      %iter_2342 = cute.get_iter(%view_2341) : !memref_smem_bf16_17
      %lay_2343 = cute.get_layout(%view_2341) : !memref_smem_bf16_17
      %639 = cute.get_shape(%lay_2343) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2344, %e1_2345, %e2_2346 = cute.get_leaves(%639) : !cute.shape<"((8,1),4)">
      %iter_2347 = cute.get_iter(%view_2341) : !memref_smem_bf16_17
      %view_2348 = cute.make_view(%iter_2347) : !memref_smem_bf16_18
      %iter_2349 = cute.get_iter(%view_2348) : !memref_smem_bf16_18
      %iter_2350 = cute.get_iter(%view_2348) : !memref_smem_bf16_18
      %lay_2351 = cute.get_layout(%view_2327) : !memref_rmem_bf16_9
      %shape_2352 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2353 = cute.make_layout() : !cute.layout<"1:0">
      %append_2354 = cute.append_to_rank<2> (%lay_2351, %lay_2353) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2355 = cute.make_view(%iter_2328, %append_2354) : !memref_rmem_bf16_9
      %iter_2356 = cute.get_iter(%view_2355) : !memref_rmem_bf16_9
      %lay_2357 = cute.get_layout(%view_2355) : !memref_rmem_bf16_9
      %640 = cute.get_shape(%lay_2357) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2358, %e1_2359, %e2_2360 = cute.get_leaves(%640) : !cute.shape<"((8,1),4)">
      %iter_2361 = cute.get_iter(%view_2355) : !memref_rmem_bf16_9
      %view_2362 = cute.make_view(%iter_2361) : !memref_rmem_bf16_10
      %iter_2363 = cute.get_iter(%view_2362) : !memref_rmem_bf16_10
      %iter_2364 = cute.get_iter(%view_2362) : !memref_rmem_bf16_10
      %lay_2365 = cute.get_layout(%view_2348) : !memref_smem_bf16_18
      %641 = cute.get_shape(%lay_2365) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2366, %e1_2367, %e2_2368 = cute.get_leaves(%641) : !cute.shape<"((8,1),(4))">
      %lay_2369 = cute.get_layout(%view_2362) : !memref_rmem_bf16_10
      %642 = cute.get_shape(%lay_2369) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2370, %e1_2371, %e2_2372 = cute.get_leaves(%642) : !cute.shape<"((8,1),(4))">
      %lay_2373 = cute.get_layout(%view_2348) : !memref_smem_bf16_18
      %sz_2374 = cute.size(%lay_2373) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2375 = cute.get_leaves(%sz_2374) : !cute.int_tuple<"4">
      %lay_2376 = cute.get_layout(%view_2362) : !memref_rmem_bf16_10
      %sz_2377 = cute.size(%lay_2376) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2378 = cute.get_leaves(%sz_2377) : !cute.int_tuple<"4">
      %643 = cute.static : !cute.layout<"1:0">
      %iter_2379 = cute.get_iter(%view_2348) : !memref_smem_bf16_18
      %iter_2380 = cute.get_iter(%view_2362) : !memref_rmem_bf16_10
      %lay_2381 = cute.get_layout(%view_2348) : !memref_smem_bf16_18
      %lay_2382 = cute.get_layout(%view_2362) : !memref_rmem_bf16_10
      %append_2383 = cute.append_to_rank<2> (%lay_2381, %643) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2384 = cute.append_to_rank<2> (%lay_2382, %643) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2385 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2386 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2387 = cute.size(%lay_2385) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %644 = cute.get_scalars(%sz_2387) : !cute.int_tuple<"4">
      %c0_i32_2388 = arith.constant 0 : i32
      %c1_i32_2389 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2388 to %644 step %c1_i32_2389  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2385, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2385) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_2379, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2386, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2386) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2380, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2390 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2391 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2392 = cute.crd2idx(%coord_2390, %lay_2391) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
      %iter_2393 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2394 = cute.add_offset(%iter_2393, %idx_2392) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2395 = cute.make_view(%ptr_2394) : !memref_rmem_bf16_12
      %iter_2396 = cute.get_iter(%view_2395) : !memref_rmem_bf16_12
      %coord_2397 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
      %lay_2398 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2399 = cute.crd2idx(%coord_2397, %lay_2398) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
      %iter_2400 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2401 = cute.add_offset(%iter_2400, %idx_2399) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2402 = cute.make_view(%ptr_2401) : !memref_rmem_bf16_13
      %iter_2403 = cute.get_iter(%view_2402) : !memref_rmem_bf16_13
      %lay_2404 = cute.get_layout(%view_2395) : !memref_rmem_bf16_12
      %645 = cute.get_shape(%lay_2404) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2405, %e1_2406, %e2_2407, %e3_2408 = cute.get_leaves(%645) : !cute.shape<"((2,2,2),2)">
      %lay_2409 = cute.get_layout(%view_2402) : !memref_rmem_bf16_13
      %646 = cute.get_shape(%lay_2409) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2410, %e1_2411, %e2_2412 = cute.get_leaves(%646) : !cute.shape<"((2,2),8)">
      %iter_2413 = cute.get_iter(%view_2395) : !memref_rmem_bf16_12
      %iter_2414 = cute.get_iter(%view_2402) : !memref_rmem_bf16_13
      %iter_2415 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_2416 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_2417 = cute.get_layout(%view_2395) : !memref_rmem_bf16_12
      %lay_2418 = cute.get_layout(%view_2402) : !memref_rmem_bf16_13
      %lay_2419 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2420 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %647 = cute.static : !cute.layout<"1:0">
      %append_2421 = cute.append_to_rank<3> (%lay_2417, %647) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2422 = cute.append_to_rank<3> (%lay_2418, %647) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2423 = cute.size(%append_2421) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2424 = cute.size(%append_2421) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2425 = cute.size(%append_2422) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %648 = cute.get_scalars(%sz_2423) : !cute.int_tuple<"1">
      %649 = cute.get_scalars(%sz_2424) : !cute.int_tuple<"2">
      %650 = cute.get_scalars(%sz_2425) : !cute.int_tuple<"8">
      %c0_i32_2426 = arith.constant 0 : i32
      %c1_i32_2427 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2426 to %648 step %c1_i32_2427  : i32 {
        scf.for %arg6 = %c0_i32_2426 to %649 step %c1_i32_2427  : i32 {
          scf.for %arg7 = %c0_i32_2426 to %650 step %c1_i32_2427  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_2421, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_2421) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_2413, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_2422, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_2422) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_2414, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_2419, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_2419) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_2415, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_2420, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_2420) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_2416, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2428 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2429 = cute.size(%int_tuple_2428) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2430 = cute.get_leaves(%sz_2429) : !cute.int_tuple<"8">
      %coord_2431 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2432 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_2433 = cute.crd2idx(%coord_2431, %lay_2432) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2434 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_2435 = cute.add_offset(%iter_2434, %idx_2433) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2436 = cute.make_view(%ptr_2435) : !memref_smem_bf16_14
      %iter_2437 = cute.get_iter(%view_2436) : !memref_smem_bf16_14
      %coord_2438 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2439 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2440 = cute.crd2idx(%coord_2438, %lay_2439) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
      %iter_2441 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2442 = cute.add_offset(%iter_2441, %idx_2440) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2443 = cute.make_view(%ptr_2442) : !memref_rmem_bf16_6
      %iter_2444 = cute.get_iter(%view_2443) : !memref_rmem_bf16_6
      %lay_2445 = cute.get_layout(%view_2436) : !memref_smem_bf16_14
      %651 = cute.get_shape(%lay_2445) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2446, %e1_2447, %e2_2448 = cute.get_leaves(%651) : !cute.shape<"((8,1),2)">
      %lay_2449 = cute.get_layout(%view_2443) : !memref_rmem_bf16_6
      %652 = cute.get_shape(%lay_2449) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2450, %e1_2451, %e2_2452 = cute.get_leaves(%652) : !cute.shape<"((8,1),2)">
      %lay_2453 = cute.get_layout(%view_2436) : !memref_smem_bf16_14
      %shape_2454 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2455 = cute.make_layout() : !cute.layout<"1:0">
      %append_2456 = cute.append_to_rank<2> (%lay_2453, %lay_2455) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2457 = cute.make_view(%iter_2437, %append_2456) : !memref_smem_bf16_14
      %iter_2458 = cute.get_iter(%view_2457) : !memref_smem_bf16_14
      %lay_2459 = cute.get_layout(%view_2457) : !memref_smem_bf16_14
      %653 = cute.get_shape(%lay_2459) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2460, %e1_2461, %e2_2462 = cute.get_leaves(%653) : !cute.shape<"((8,1),2)">
      %iter_2463 = cute.get_iter(%view_2457) : !memref_smem_bf16_14
      %view_2464 = cute.make_view(%iter_2463) : !memref_smem_bf16_15
      %iter_2465 = cute.get_iter(%view_2464) : !memref_smem_bf16_15
      %iter_2466 = cute.get_iter(%view_2464) : !memref_smem_bf16_15
      %lay_2467 = cute.get_layout(%view_2443) : !memref_rmem_bf16_6
      %shape_2468 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2469 = cute.make_layout() : !cute.layout<"1:0">
      %append_2470 = cute.append_to_rank<2> (%lay_2467, %lay_2469) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2471 = cute.make_view(%iter_2444, %append_2470) : !memref_rmem_bf16_6
      %iter_2472 = cute.get_iter(%view_2471) : !memref_rmem_bf16_6
      %lay_2473 = cute.get_layout(%view_2471) : !memref_rmem_bf16_6
      %654 = cute.get_shape(%lay_2473) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2474, %e1_2475, %e2_2476 = cute.get_leaves(%654) : !cute.shape<"((8,1),2)">
      %iter_2477 = cute.get_iter(%view_2471) : !memref_rmem_bf16_6
      %view_2478 = cute.make_view(%iter_2477) : !memref_rmem_bf16_7
      %iter_2479 = cute.get_iter(%view_2478) : !memref_rmem_bf16_7
      %iter_2480 = cute.get_iter(%view_2478) : !memref_rmem_bf16_7
      %lay_2481 = cute.get_layout(%view_2464) : !memref_smem_bf16_15
      %655 = cute.get_shape(%lay_2481) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2482, %e1_2483, %e2_2484 = cute.get_leaves(%655) : !cute.shape<"((8,1),(2))">
      %lay_2485 = cute.get_layout(%view_2478) : !memref_rmem_bf16_7
      %656 = cute.get_shape(%lay_2485) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2486, %e1_2487, %e2_2488 = cute.get_leaves(%656) : !cute.shape<"((8,1),(2))">
      %lay_2489 = cute.get_layout(%view_2464) : !memref_smem_bf16_15
      %sz_2490 = cute.size(%lay_2489) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2491 = cute.get_leaves(%sz_2490) : !cute.int_tuple<"2">
      %lay_2492 = cute.get_layout(%view_2478) : !memref_rmem_bf16_7
      %sz_2493 = cute.size(%lay_2492) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2494 = cute.get_leaves(%sz_2493) : !cute.int_tuple<"2">
      %657 = cute.static : !cute.layout<"1:0">
      %iter_2495 = cute.get_iter(%view_2464) : !memref_smem_bf16_15
      %iter_2496 = cute.get_iter(%view_2478) : !memref_rmem_bf16_7
      %lay_2497 = cute.get_layout(%view_2464) : !memref_smem_bf16_15
      %lay_2498 = cute.get_layout(%view_2478) : !memref_rmem_bf16_7
      %append_2499 = cute.append_to_rank<2> (%lay_2497, %657) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2500 = cute.append_to_rank<2> (%lay_2498, %657) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2501 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2502 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2503 = cute.size(%lay_2501) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %658 = cute.get_scalars(%sz_2503) : !cute.int_tuple<"2">
      %c0_i32_2504 = arith.constant 0 : i32
      %c1_i32_2505 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2504 to %658 step %c1_i32_2505  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2501, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2501) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_2495, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2502, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2502) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2496, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2506 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2507 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_2508 = cute.crd2idx(%coord_2506, %lay_2507) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
      %iter_2509 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_2510 = cute.add_offset(%iter_2509, %idx_2508) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2511 = cute.make_view(%ptr_2510) : !memref_smem_bf16_17
      %iter_2512 = cute.get_iter(%view_2511) : !memref_smem_bf16_17
      %coord_2513 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2514 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_2515 = cute.crd2idx(%coord_2513, %lay_2514) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
      %iter_2516 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_2517 = cute.add_offset(%iter_2516, %idx_2515) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2518 = cute.make_view(%ptr_2517) : !memref_rmem_bf16_9
      %iter_2519 = cute.get_iter(%view_2518) : !memref_rmem_bf16_9
      %lay_2520 = cute.get_layout(%view_2511) : !memref_smem_bf16_17
      %659 = cute.get_shape(%lay_2520) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2521, %e1_2522, %e2_2523 = cute.get_leaves(%659) : !cute.shape<"((8,1),4)">
      %lay_2524 = cute.get_layout(%view_2518) : !memref_rmem_bf16_9
      %660 = cute.get_shape(%lay_2524) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2525, %e1_2526, %e2_2527 = cute.get_leaves(%660) : !cute.shape<"((8,1),4)">
      %lay_2528 = cute.get_layout(%view_2511) : !memref_smem_bf16_17
      %shape_2529 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2530 = cute.make_layout() : !cute.layout<"1:0">
      %append_2531 = cute.append_to_rank<2> (%lay_2528, %lay_2530) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2532 = cute.make_view(%iter_2512, %append_2531) : !memref_smem_bf16_17
      %iter_2533 = cute.get_iter(%view_2532) : !memref_smem_bf16_17
      %lay_2534 = cute.get_layout(%view_2532) : !memref_smem_bf16_17
      %661 = cute.get_shape(%lay_2534) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2535, %e1_2536, %e2_2537 = cute.get_leaves(%661) : !cute.shape<"((8,1),4)">
      %iter_2538 = cute.get_iter(%view_2532) : !memref_smem_bf16_17
      %view_2539 = cute.make_view(%iter_2538) : !memref_smem_bf16_18
      %iter_2540 = cute.get_iter(%view_2539) : !memref_smem_bf16_18
      %iter_2541 = cute.get_iter(%view_2539) : !memref_smem_bf16_18
      %lay_2542 = cute.get_layout(%view_2518) : !memref_rmem_bf16_9
      %shape_2543 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2544 = cute.make_layout() : !cute.layout<"1:0">
      %append_2545 = cute.append_to_rank<2> (%lay_2542, %lay_2544) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2546 = cute.make_view(%iter_2519, %append_2545) : !memref_rmem_bf16_9
      %iter_2547 = cute.get_iter(%view_2546) : !memref_rmem_bf16_9
      %lay_2548 = cute.get_layout(%view_2546) : !memref_rmem_bf16_9
      %662 = cute.get_shape(%lay_2548) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2549, %e1_2550, %e2_2551 = cute.get_leaves(%662) : !cute.shape<"((8,1),4)">
      %iter_2552 = cute.get_iter(%view_2546) : !memref_rmem_bf16_9
      %view_2553 = cute.make_view(%iter_2552) : !memref_rmem_bf16_10
      %iter_2554 = cute.get_iter(%view_2553) : !memref_rmem_bf16_10
      %iter_2555 = cute.get_iter(%view_2553) : !memref_rmem_bf16_10
      %lay_2556 = cute.get_layout(%view_2539) : !memref_smem_bf16_18
      %663 = cute.get_shape(%lay_2556) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2557, %e1_2558, %e2_2559 = cute.get_leaves(%663) : !cute.shape<"((8,1),(4))">
      %lay_2560 = cute.get_layout(%view_2553) : !memref_rmem_bf16_10
      %664 = cute.get_shape(%lay_2560) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2561, %e1_2562, %e2_2563 = cute.get_leaves(%664) : !cute.shape<"((8,1),(4))">
      %lay_2564 = cute.get_layout(%view_2539) : !memref_smem_bf16_18
      %sz_2565 = cute.size(%lay_2564) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2566 = cute.get_leaves(%sz_2565) : !cute.int_tuple<"4">
      %lay_2567 = cute.get_layout(%view_2553) : !memref_rmem_bf16_10
      %sz_2568 = cute.size(%lay_2567) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2569 = cute.get_leaves(%sz_2568) : !cute.int_tuple<"4">
      %665 = cute.static : !cute.layout<"1:0">
      %iter_2570 = cute.get_iter(%view_2539) : !memref_smem_bf16_18
      %iter_2571 = cute.get_iter(%view_2553) : !memref_rmem_bf16_10
      %lay_2572 = cute.get_layout(%view_2539) : !memref_smem_bf16_18
      %lay_2573 = cute.get_layout(%view_2553) : !memref_rmem_bf16_10
      %append_2574 = cute.append_to_rank<2> (%lay_2572, %665) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2575 = cute.append_to_rank<2> (%lay_2573, %665) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2576 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2577 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2578 = cute.size(%lay_2576) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %666 = cute.get_scalars(%sz_2578) : !cute.int_tuple<"4">
      %c0_i32_2579 = arith.constant 0 : i32
      %c1_i32_2580 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2579 to %666 step %c1_i32_2580  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2576, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2576) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_2570, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2577, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2577) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2571, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2581 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2582 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2583 = cute.crd2idx(%coord_2581, %lay_2582) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
      %iter_2584 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2585 = cute.add_offset(%iter_2584, %idx_2583) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2586 = cute.make_view(%ptr_2585) : !memref_rmem_bf16_12
      %iter_2587 = cute.get_iter(%view_2586) : !memref_rmem_bf16_12
      %coord_2588 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
      %lay_2589 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2590 = cute.crd2idx(%coord_2588, %lay_2589) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
      %iter_2591 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2592 = cute.add_offset(%iter_2591, %idx_2590) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2593 = cute.make_view(%ptr_2592) : !memref_rmem_bf16_13
      %iter_2594 = cute.get_iter(%view_2593) : !memref_rmem_bf16_13
      %lay_2595 = cute.get_layout(%view_2586) : !memref_rmem_bf16_12
      %667 = cute.get_shape(%lay_2595) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2596, %e1_2597, %e2_2598, %e3_2599 = cute.get_leaves(%667) : !cute.shape<"((2,2,2),2)">
      %lay_2600 = cute.get_layout(%view_2593) : !memref_rmem_bf16_13
      %668 = cute.get_shape(%lay_2600) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2601, %e1_2602, %e2_2603 = cute.get_leaves(%668) : !cute.shape<"((2,2),8)">
      %iter_2604 = cute.get_iter(%view_2586) : !memref_rmem_bf16_12
      %iter_2605 = cute.get_iter(%view_2593) : !memref_rmem_bf16_13
      %iter_2606 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_2607 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_2608 = cute.get_layout(%view_2586) : !memref_rmem_bf16_12
      %lay_2609 = cute.get_layout(%view_2593) : !memref_rmem_bf16_13
      %lay_2610 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2611 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %669 = cute.static : !cute.layout<"1:0">
      %append_2612 = cute.append_to_rank<3> (%lay_2608, %669) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2613 = cute.append_to_rank<3> (%lay_2609, %669) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2614 = cute.size(%append_2612) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2615 = cute.size(%append_2612) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2616 = cute.size(%append_2613) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %670 = cute.get_scalars(%sz_2614) : !cute.int_tuple<"1">
      %671 = cute.get_scalars(%sz_2615) : !cute.int_tuple<"2">
      %672 = cute.get_scalars(%sz_2616) : !cute.int_tuple<"8">
      %c0_i32_2617 = arith.constant 0 : i32
      %c1_i32_2618 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2617 to %670 step %c1_i32_2618  : i32 {
        scf.for %arg6 = %c0_i32_2617 to %671 step %c1_i32_2618  : i32 {
          scf.for %arg7 = %c0_i32_2617 to %672 step %c1_i32_2618  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_2612, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_2612) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_2604, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_2613, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_2613) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_2605, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_2610, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_2610) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_2606, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_2611, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_2611) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_2607, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_2619 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
      %sz_2620 = cute.size(%int_tuple_2619) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
      %e0_2621 = cute.get_leaves(%sz_2620) : !cute.int_tuple<"8">
      %coord_2622 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2623 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
      %idx_2624 = cute.crd2idx(%coord_2622, %lay_2623) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
      %iter_2625 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
      %ptr_2626 = cute.add_offset(%iter_2625, %idx_2624) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2627 = cute.make_view(%ptr_2626) : !memref_smem_bf16_14
      %iter_2628 = cute.get_iter(%view_2627) : !memref_smem_bf16_14
      %coord_2629 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2630 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
      %idx_2631 = cute.crd2idx(%coord_2629, %lay_2630) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
      %iter_2632 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
      %ptr_2633 = cute.add_offset(%iter_2632, %idx_2631) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2634 = cute.make_view(%ptr_2633) : !memref_rmem_bf16_6
      %iter_2635 = cute.get_iter(%view_2634) : !memref_rmem_bf16_6
      %lay_2636 = cute.get_layout(%view_2627) : !memref_smem_bf16_14
      %673 = cute.get_shape(%lay_2636) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2637, %e1_2638, %e2_2639 = cute.get_leaves(%673) : !cute.shape<"((8,1),2)">
      %lay_2640 = cute.get_layout(%view_2634) : !memref_rmem_bf16_6
      %674 = cute.get_shape(%lay_2640) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2641, %e1_2642, %e2_2643 = cute.get_leaves(%674) : !cute.shape<"((8,1),2)">
      %lay_2644 = cute.get_layout(%view_2627) : !memref_smem_bf16_14
      %shape_2645 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2646 = cute.make_layout() : !cute.layout<"1:0">
      %append_2647 = cute.append_to_rank<2> (%lay_2644, %lay_2646) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
      %view_2648 = cute.make_view(%iter_2628, %append_2647) : !memref_smem_bf16_14
      %iter_2649 = cute.get_iter(%view_2648) : !memref_smem_bf16_14
      %lay_2650 = cute.get_layout(%view_2648) : !memref_smem_bf16_14
      %675 = cute.get_shape(%lay_2650) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
      %e0_2651, %e1_2652, %e2_2653 = cute.get_leaves(%675) : !cute.shape<"((8,1),2)">
      %iter_2654 = cute.get_iter(%view_2648) : !memref_smem_bf16_14
      %view_2655 = cute.make_view(%iter_2654) : !memref_smem_bf16_15
      %iter_2656 = cute.get_iter(%view_2655) : !memref_smem_bf16_15
      %iter_2657 = cute.get_iter(%view_2655) : !memref_smem_bf16_15
      %lay_2658 = cute.get_layout(%view_2634) : !memref_rmem_bf16_6
      %shape_2659 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2660 = cute.make_layout() : !cute.layout<"1:0">
      %append_2661 = cute.append_to_rank<2> (%lay_2658, %lay_2660) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
      %view_2662 = cute.make_view(%iter_2635, %append_2661) : !memref_rmem_bf16_6
      %iter_2663 = cute.get_iter(%view_2662) : !memref_rmem_bf16_6
      %lay_2664 = cute.get_layout(%view_2662) : !memref_rmem_bf16_6
      %676 = cute.get_shape(%lay_2664) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
      %e0_2665, %e1_2666, %e2_2667 = cute.get_leaves(%676) : !cute.shape<"((8,1),2)">
      %iter_2668 = cute.get_iter(%view_2662) : !memref_rmem_bf16_6
      %view_2669 = cute.make_view(%iter_2668) : !memref_rmem_bf16_7
      %iter_2670 = cute.get_iter(%view_2669) : !memref_rmem_bf16_7
      %iter_2671 = cute.get_iter(%view_2669) : !memref_rmem_bf16_7
      %lay_2672 = cute.get_layout(%view_2655) : !memref_smem_bf16_15
      %677 = cute.get_shape(%lay_2672) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
      %e0_2673, %e1_2674, %e2_2675 = cute.get_leaves(%677) : !cute.shape<"((8,1),(2))">
      %lay_2676 = cute.get_layout(%view_2669) : !memref_rmem_bf16_7
      %678 = cute.get_shape(%lay_2676) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
      %e0_2677, %e1_2678, %e2_2679 = cute.get_leaves(%678) : !cute.shape<"((8,1),(2))">
      %lay_2680 = cute.get_layout(%view_2655) : !memref_smem_bf16_15
      %sz_2681 = cute.size(%lay_2680) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
      %e0_2682 = cute.get_leaves(%sz_2681) : !cute.int_tuple<"2">
      %lay_2683 = cute.get_layout(%view_2669) : !memref_rmem_bf16_7
      %sz_2684 = cute.size(%lay_2683) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
      %e0_2685 = cute.get_leaves(%sz_2684) : !cute.int_tuple<"2">
      %679 = cute.static : !cute.layout<"1:0">
      %iter_2686 = cute.get_iter(%view_2655) : !memref_smem_bf16_15
      %iter_2687 = cute.get_iter(%view_2669) : !memref_rmem_bf16_7
      %lay_2688 = cute.get_layout(%view_2655) : !memref_smem_bf16_15
      %lay_2689 = cute.get_layout(%view_2669) : !memref_rmem_bf16_7
      %append_2690 = cute.append_to_rank<2> (%lay_2688, %679) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
      %append_2691 = cute.append_to_rank<2> (%lay_2689, %679) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2692 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
      %lay_2693 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
      %sz_2694 = cute.size(%lay_2692) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
      %680 = cute.get_scalars(%sz_2694) : !cute.int_tuple<"2">
      %c0_i32_2695 = arith.constant 0 : i32
      %c1_i32_2696 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2695 to %680 step %c1_i32_2696  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2692, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2692) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
        %ptr_7722 = cute.add_offset(%iter_2686, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2693, %coord_7719) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2693) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2687, %idx_7725) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%150, %view_7723, %view_7727) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2697 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2698 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
      %idx_2699 = cute.crd2idx(%coord_2697, %lay_2698) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
      %iter_2700 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
      %ptr_2701 = cute.add_offset(%iter_2700, %idx_2699) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_2702 = cute.make_view(%ptr_2701) : !memref_smem_bf16_17
      %iter_2703 = cute.get_iter(%view_2702) : !memref_smem_bf16_17
      %coord_2704 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_2705 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
      %idx_2706 = cute.crd2idx(%coord_2704, %lay_2705) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
      %iter_2707 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
      %ptr_2708 = cute.add_offset(%iter_2707, %idx_2706) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2709 = cute.make_view(%ptr_2708) : !memref_rmem_bf16_9
      %iter_2710 = cute.get_iter(%view_2709) : !memref_rmem_bf16_9
      %lay_2711 = cute.get_layout(%view_2702) : !memref_smem_bf16_17
      %681 = cute.get_shape(%lay_2711) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2712, %e1_2713, %e2_2714 = cute.get_leaves(%681) : !cute.shape<"((8,1),4)">
      %lay_2715 = cute.get_layout(%view_2709) : !memref_rmem_bf16_9
      %682 = cute.get_shape(%lay_2715) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2716, %e1_2717, %e2_2718 = cute.get_leaves(%682) : !cute.shape<"((8,1),4)">
      %lay_2719 = cute.get_layout(%view_2702) : !memref_smem_bf16_17
      %shape_2720 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2721 = cute.make_layout() : !cute.layout<"1:0">
      %append_2722 = cute.append_to_rank<2> (%lay_2719, %lay_2721) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
      %view_2723 = cute.make_view(%iter_2703, %append_2722) : !memref_smem_bf16_17
      %iter_2724 = cute.get_iter(%view_2723) : !memref_smem_bf16_17
      %lay_2725 = cute.get_layout(%view_2723) : !memref_smem_bf16_17
      %683 = cute.get_shape(%lay_2725) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
      %e0_2726, %e1_2727, %e2_2728 = cute.get_leaves(%683) : !cute.shape<"((8,1),4)">
      %iter_2729 = cute.get_iter(%view_2723) : !memref_smem_bf16_17
      %view_2730 = cute.make_view(%iter_2729) : !memref_smem_bf16_18
      %iter_2731 = cute.get_iter(%view_2730) : !memref_smem_bf16_18
      %iter_2732 = cute.get_iter(%view_2730) : !memref_smem_bf16_18
      %lay_2733 = cute.get_layout(%view_2709) : !memref_rmem_bf16_9
      %shape_2734 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_2735 = cute.make_layout() : !cute.layout<"1:0">
      %append_2736 = cute.append_to_rank<2> (%lay_2733, %lay_2735) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
      %view_2737 = cute.make_view(%iter_2710, %append_2736) : !memref_rmem_bf16_9
      %iter_2738 = cute.get_iter(%view_2737) : !memref_rmem_bf16_9
      %lay_2739 = cute.get_layout(%view_2737) : !memref_rmem_bf16_9
      %684 = cute.get_shape(%lay_2739) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
      %e0_2740, %e1_2741, %e2_2742 = cute.get_leaves(%684) : !cute.shape<"((8,1),4)">
      %iter_2743 = cute.get_iter(%view_2737) : !memref_rmem_bf16_9
      %view_2744 = cute.make_view(%iter_2743) : !memref_rmem_bf16_10
      %iter_2745 = cute.get_iter(%view_2744) : !memref_rmem_bf16_10
      %iter_2746 = cute.get_iter(%view_2744) : !memref_rmem_bf16_10
      %lay_2747 = cute.get_layout(%view_2730) : !memref_smem_bf16_18
      %685 = cute.get_shape(%lay_2747) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
      %e0_2748, %e1_2749, %e2_2750 = cute.get_leaves(%685) : !cute.shape<"((8,1),(4))">
      %lay_2751 = cute.get_layout(%view_2744) : !memref_rmem_bf16_10
      %686 = cute.get_shape(%lay_2751) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
      %e0_2752, %e1_2753, %e2_2754 = cute.get_leaves(%686) : !cute.shape<"((8,1),(4))">
      %lay_2755 = cute.get_layout(%view_2730) : !memref_smem_bf16_18
      %sz_2756 = cute.size(%lay_2755) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
      %e0_2757 = cute.get_leaves(%sz_2756) : !cute.int_tuple<"4">
      %lay_2758 = cute.get_layout(%view_2744) : !memref_rmem_bf16_10
      %sz_2759 = cute.size(%lay_2758) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
      %e0_2760 = cute.get_leaves(%sz_2759) : !cute.int_tuple<"4">
      %687 = cute.static : !cute.layout<"1:0">
      %iter_2761 = cute.get_iter(%view_2730) : !memref_smem_bf16_18
      %iter_2762 = cute.get_iter(%view_2744) : !memref_rmem_bf16_10
      %lay_2763 = cute.get_layout(%view_2730) : !memref_smem_bf16_18
      %lay_2764 = cute.get_layout(%view_2744) : !memref_rmem_bf16_10
      %append_2765 = cute.append_to_rank<2> (%lay_2763, %687) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
      %append_2766 = cute.append_to_rank<2> (%lay_2764, %687) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
      %lay_2767 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
      %lay_2768 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
      %sz_2769 = cute.size(%lay_2767) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
      %688 = cute.get_scalars(%sz_2769) : !cute.int_tuple<"4">
      %c0_i32_2770 = arith.constant 0 : i32
      %c1_i32_2771 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2770 to %688 step %c1_i32_2771  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_2767, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_2767) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_2761, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_2768, %coord_7719) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_2768) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_2762, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%154, %view_7723, %view_7727) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_2772 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2773 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
      %idx_2774 = cute.crd2idx(%coord_2772, %lay_2773) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
      %iter_2775 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
      %ptr_2776 = cute.add_offset(%iter_2775, %idx_2774) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
      %view_2777 = cute.make_view(%ptr_2776) : !memref_rmem_bf16_12
      %iter_2778 = cute.get_iter(%view_2777) : !memref_rmem_bf16_12
      %coord_2779 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
      %lay_2780 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
      %idx_2781 = cute.crd2idx(%coord_2779, %lay_2780) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
      %iter_2782 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
      %ptr_2783 = cute.add_offset(%iter_2782, %idx_2781) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_2784 = cute.make_view(%ptr_2783) : !memref_rmem_bf16_13
      %iter_2785 = cute.get_iter(%view_2784) : !memref_rmem_bf16_13
      %lay_2786 = cute.get_layout(%view_2777) : !memref_rmem_bf16_12
      %689 = cute.get_shape(%lay_2786) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
      %e0_2787, %e1_2788, %e2_2789, %e3_2790 = cute.get_leaves(%689) : !cute.shape<"((2,2,2),2)">
      %lay_2791 = cute.get_layout(%view_2784) : !memref_rmem_bf16_13
      %690 = cute.get_shape(%lay_2791) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
      %e0_2792, %e1_2793, %e2_2794 = cute.get_leaves(%690) : !cute.shape<"((2,2),8)">
      %iter_2795 = cute.get_iter(%view_2777) : !memref_rmem_bf16_12
      %iter_2796 = cute.get_iter(%view_2784) : !memref_rmem_bf16_13
      %iter_2797 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %iter_2798 = cute.get_iter(%rmem_1101) : !memref_rmem_f32_2
      %lay_2799 = cute.get_layout(%view_2777) : !memref_rmem_bf16_12
      %lay_2800 = cute.get_layout(%view_2784) : !memref_rmem_bf16_13
      %lay_2801 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2802 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %691 = cute.static : !cute.layout<"1:0">
      %append_2803 = cute.append_to_rank<3> (%lay_2799, %691) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
      %append_2804 = cute.append_to_rank<3> (%lay_2800, %691) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
      %sz_2805 = cute.size(%append_2803) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
      %sz_2806 = cute.size(%append_2803) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
      %sz_2807 = cute.size(%append_2804) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
      %692 = cute.get_scalars(%sz_2805) : !cute.int_tuple<"1">
      %693 = cute.get_scalars(%sz_2806) : !cute.int_tuple<"2">
      %694 = cute.get_scalars(%sz_2807) : !cute.int_tuple<"8">
      %c0_i32_2808 = arith.constant 0 : i32
      %c1_i32_2809 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_2808 to %692 step %c1_i32_2809  : i32 {
        scf.for %arg6 = %c0_i32_2808 to %693 step %c1_i32_2809  : i32 {
          scf.for %arg7 = %c0_i32_2808 to %694 step %c1_i32_2809  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_2803, %coord_7719) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_2803) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
            %ptr_7724 = cute.add_offset(%iter_2795, %idx_7723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_14
            %slice_7726 = cute.slice(%append_2804, %coord_7720) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_2804) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_2796, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_2801, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_2801) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_2797, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_2802, %coord_7721) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_2802) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_2798, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      nvvm.cp.async.wait.group 0
      %c1_i32_2810 = arith.constant 1 : i32
      %c128_i32_2811 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_2810 number_of_threads = %c128_i32_2811
      %695 = arith.cmpi sgt, %498, %c0_i32 : i32
      scf.if %695 {
        %c1_i32_7719 = arith.constant 1 : i32
        %2485 = arith.subi %498, %c1_i32_7719 : i32
        %coord_7720 = cute.make_coord(%2485) : (i32) -> !cute.coord<"(_,_,_,?)">
        %lay_7721 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
        %slice_7722 = cute.slice(%lay_7721, %coord_7720) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
        %idx_7723 = cute.crd2idx(%coord_7720, %lay_7721) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7724 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
        %ptr_7725 = cute.add_offset(%iter_7724, %idx_7723) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7726 = cute.make_view(%ptr_7725, %slice_7722) : !memref_gmem_bf16_9
        %iter_7727 = cute.get_iter(%view_7726) : !memref_gmem_bf16_9
        %lay_7728 = cute.get_layout(%view_7726) : !memref_gmem_bf16_9
        %2486 = cute.get_shape(%lay_7728) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7729, %e1_7730, %e2_7731, %e3_7732 = cute.get_leaves(%2486) : !cute.shape<"((8,1),4,2)">
        %lay_7733 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %2487 = cute.get_shape(%lay_7733) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7734, %e1_7735, %e2_7736, %e3_7737 = cute.get_leaves(%2487) : !cute.shape<"((8,1),4,2)">
        %lay_7738 = cute.get_layout(%view_7726) : !memref_gmem_bf16_9
        %shape_7739 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7740 = cute.make_layout() : !cute.layout<"1:0">
        %append_7741 = cute.append_to_rank<2> (%lay_7738, %lay_7740) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
        %view_7742 = cute.make_view(%iter_7727, %append_7741) : !memref_gmem_bf16_9
        %iter_7743 = cute.get_iter(%view_7742) : !memref_gmem_bf16_9
        %lay_7744 = cute.get_layout(%view_7742) : !memref_gmem_bf16_9
        %2488 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7745, %e1_7746, %e2_7747, %e3_7748 = cute.get_leaves(%2488) : !cute.shape<"((8,1),4,2)">
        %iter_7749 = cute.get_iter(%view_7742) : !memref_gmem_bf16_9
        %lay_7750 = cute.get_layout(%view_7742) : !memref_gmem_bf16_9
        %2489 = cute.get_scalars(%lay_7750) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
        %shape_7751 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
        %iv_7752 = cute.assume(%2489) : (i64) -> !cute.i64<divby 128>
        %stride_7753 = cute.make_stride(%iv_7752) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
        %lay_7754 = cute.make_layout(%shape_7751, %stride_7753) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %view_7755 = cute.make_view(%iter_7749, %lay_7754) : !memref_gmem_bf16_10
        %iter_7756 = cute.get_iter(%view_7755) : !memref_gmem_bf16_10
        %iter_7757 = cute.get_iter(%view_7755) : !memref_gmem_bf16_10
        %lay_7758 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
        %shape_7759 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7760 = cute.make_layout() : !cute.layout<"1:0">
        %append_7761 = cute.append_to_rank<2> (%lay_7758, %lay_7760) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
        %view_7762 = cute.make_view(%iter_293, %append_7761) : !memref_smem_bf16_4
        %iter_7763 = cute.get_iter(%view_7762) : !memref_smem_bf16_4
        %lay_7764 = cute.get_layout(%view_7762) : !memref_smem_bf16_4
        %2490 = cute.get_shape(%lay_7764) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
        %e0_7765, %e1_7766, %e2_7767, %e3_7768 = cute.get_leaves(%2490) : !cute.shape<"((8,1),4,2)">
        %iter_7769 = cute.get_iter(%view_7762) : !memref_smem_bf16_4
        %view_7770 = cute.make_view(%iter_7769) : !memref_smem_bf16_16
        %iter_7771 = cute.get_iter(%view_7770) : !memref_smem_bf16_16
        %iter_7772 = cute.get_iter(%view_7770) : !memref_smem_bf16_16
        %lay_7773 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
        %shape_7774 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7775 = cute.make_layout() : !cute.layout<"1:0">
        %append_7776 = cute.append_to_rank<2> (%lay_7773, %lay_7775) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
        %view_7777 = cute.make_view(%iter_529, %append_7776) : !memref_rmem_i8_1
        %iter_7778 = cute.get_iter(%view_7777) : !memref_rmem_i8_1
        %lay_7779 = cute.get_layout(%view_7777) : !memref_rmem_i8_1
        %2491 = cute.get_shape(%lay_7779) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
        %e0_7780, %e1_7781, %e2_7782 = cute.get_leaves(%2491) : !cute.shape<"(1,4,2)">
        %iter_7783 = cute.get_iter(%view_7777) : !memref_rmem_i8_1
        %view_7784 = cute.make_view(%iter_7783) : !memref_rmem_i8_5
        %iter_7785 = cute.get_iter(%view_7784) : !memref_rmem_i8_5
        %iter_7786 = cute.get_iter(%view_7784) : !memref_rmem_i8_5
        %lay_7787 = cute.get_layout(%view_7755) : !memref_gmem_bf16_10
        %2492 = cute.get_shape(%lay_7787) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7788, %e1_7789, %e2_7790, %e3_7791 = cute.get_leaves(%2492) : !cute.shape<"((8,1),(4,2))">
        %lay_7792 = cute.get_layout(%view_7770) : !memref_smem_bf16_16
        %2493 = cute.get_shape(%lay_7792) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_7793, %e1_7794, %e2_7795, %e3_7796 = cute.get_leaves(%2493) : !cute.shape<"((8,1),(4,2))">
        %lay_7797 = cute.get_layout(%view_7755) : !memref_gmem_bf16_10
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"8">
        %lay_7800 = cute.get_layout(%view_7770) : !memref_smem_bf16_16
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"8">
        %2494 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7755) : !memref_gmem_bf16_10
        %iter_7804 = cute.get_iter(%view_7770) : !memref_smem_bf16_16
        %lay_7805 = cute.get_layout(%view_7755) : !memref_gmem_bf16_10
        %lay_7806 = cute.get_layout(%view_7770) : !memref_smem_bf16_16
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2494) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2494) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
        %2495 = cute.get_scalars(%append_7807) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
        %shape_7809 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
        %iv_7810 = cute.assume(%2495) : (i64) -> !cute.i64<divby 128>
        %stride_7811 = cute.make_stride(%iv_7810) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
        %lay_7812 = cute.make_layout(%shape_7809, %stride_7811) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
        %lay_7813 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
        %iter_7814 = cute.get_iter(%view_7784) : !memref_rmem_i8_5
        %lay_7815 = cute.get_layout(%view_7784) : !memref_rmem_i8_5
        %append_7816 = cute.append_to_rank<2> (%lay_7815, %2494) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
        %lay_7817 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
        %sz_7818 = cute.size(%lay_7812) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
        %2496 = cute.get_scalars(%sz_7818) : !cute.int_tuple<"8">
        %c0_i32_7819 = arith.constant 0 : i32
        %c1_i32_7820 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7819 to %2496 step %c1_i32_7820  : i32 {
          %coord_7821 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7822 = cute.slice(%lay_7812, %coord_7821) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
          %idx_7823 = cute.crd2idx(%coord_7821, %lay_7812) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
          %ptr_7824 = cute.add_offset(%iter_7803, %idx_7823) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7825 = cute.make_view(%ptr_7824, %slice_7822) : !memref_gmem_bf16_8
          %slice_7826 = cute.slice(%lay_7813, %coord_7821) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
          %idx_7827 = cute.crd2idx(%coord_7821, %lay_7813) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_7828 = cute.add_offset(%iter_7804, %idx_7827) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_7829 = cute.make_view(%ptr_7828, %slice_7826) : !memref_smem_bf16_13
          %slice_7830 = cute.slice(%lay_7817, %coord_7821) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
          %idx_7831 = cute.crd2idx(%coord_7821, %lay_7817) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
          %ptr_7832 = cute.add_offset(%iter_7814, %idx_7831) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7833 = cute.make_view(%ptr_7832, %slice_7830) : !memref_rmem_i8_4
          cute.copy_atom_call(%3, %view_7825, %view_7829, %view_7833) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.commit.group
      }
      %lay_2812 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %696 = cute.get_shape(%lay_2812) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2813, %e1_2814, %e2_2815, %e3_2816 = cute.get_leaves(%696) : !cute.shape<"((2,2),2,8)">
      %shape_2817 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_2818 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %697 = cute.get_shape(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2819, %e1_2820, %e2_2821, %e3_2822 = cute.get_leaves(%697) : !cute.shape<"((2,2),2,8)">
      %698 = cute.get_shape(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2823, %e1_2824, %e2_2825, %e3_2826 = cute.get_leaves(%698) : !cute.shape<"((2,2),2,8)">
      %699 = cute.get_shape(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2827, %e1_2828, %e2_2829, %e3_2830 = cute.get_leaves(%699) : !cute.shape<"((2,2),2,8)">
      %700 = cute.get_shape(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2831, %e1_2832, %e2_2833, %e3_2834 = cute.get_leaves(%700) : !cute.shape<"((2,2),2,8)">
      %701 = cute.get_stride(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2835, %e1_2836, %e2_2837, %e3_2838 = cute.get_leaves(%701) : !cute.stride<"((1,2),4,8)">
      %702 = cute.get_stride(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2839, %e1_2840, %e2_2841, %e3_2842 = cute.get_leaves(%702) : !cute.stride<"((1,2),4,8)">
      %703 = cute.get_stride(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2843, %e1_2844, %e2_2845, %e3_2846 = cute.get_leaves(%703) : !cute.stride<"((1,2),4,8)">
      %704 = cute.get_stride(%lay_2818) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2847, %e1_2848, %e2_2849, %e3_2850 = cute.get_leaves(%704) : !cute.stride<"((1,2),4,8)">
      %shape_2851 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_2852 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2853 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_2854 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %lay_2855 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %view_2856 = cute.make_view(%iter_1103, %lay_2855) : !memref_rmem_f32_4
      %iter_2857 = cute.get_iter(%view_2856) : !memref_rmem_f32_4
      %lay_2858 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %705 = cute.get_shape(%lay_2858) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2859, %e1_2860, %e2_2861, %e3_2862 = cute.get_leaves(%705) : !cute.shape<"((2,2),2,16)">
      %shape_2863 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_2864 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %706 = cute.get_shape(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2865, %e1_2866, %e2_2867, %e3_2868 = cute.get_leaves(%706) : !cute.shape<"((2,2),2,16)">
      %707 = cute.get_shape(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2869, %e1_2870, %e2_2871, %e3_2872 = cute.get_leaves(%707) : !cute.shape<"((2,2),2,16)">
      %708 = cute.get_shape(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2873, %e1_2874, %e2_2875, %e3_2876 = cute.get_leaves(%708) : !cute.shape<"((2,2),2,16)">
      %709 = cute.get_shape(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_2877, %e1_2878, %e2_2879, %e3_2880 = cute.get_leaves(%709) : !cute.shape<"((2,2),2,16)">
      %710 = cute.get_stride(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2881, %e1_2882, %e2_2883, %e3_2884 = cute.get_leaves(%710) : !cute.stride<"((1,2),4,8)">
      %711 = cute.get_stride(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2885, %e1_2886, %e2_2887, %e3_2888 = cute.get_leaves(%711) : !cute.stride<"((1,2),4,8)">
      %712 = cute.get_stride(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2889, %e1_2890, %e2_2891, %e3_2892 = cute.get_leaves(%712) : !cute.stride<"((1,2),4,8)">
      %713 = cute.get_stride(%lay_2864) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2893, %e1_2894, %e2_2895, %e3_2896 = cute.get_leaves(%713) : !cute.stride<"((1,2),4,8)">
      %shape_2897 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_2898 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_2899 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_2900 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_2901 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_2902 = cute.make_view(%iter_319, %lay_2901) : !memref_rmem_f32_5
      %iter_2903 = cute.get_iter(%view_2902) : !memref_rmem_f32_5
      %lay_2904 = cute.get_layout(%arg0) : !memref_gmem_bf16_
      %714 = cute.get_shape(%lay_2904) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2905, %e1_2906, %e2_2907, %e3_2908 = cute.get_leaves(%714) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2909 = cute.to_int_tuple(%e0_2905) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %715 = cute.get_scalars(%itup_2909) : !cute.int_tuple<"?">
      %itup_2910 = cute.to_int_tuple(%e1_2906) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %716 = cute.get_scalars(%itup_2910) : !cute.int_tuple<"?">
      %itup_2911 = cute.to_int_tuple(%e2_2907) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %717 = cute.get_scalars(%itup_2911) : !cute.int_tuple<"?">
      %itup_2912 = cute.to_int_tuple(%e3_2908) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %718 = cute.get_scalars(%itup_2912) : !cute.int_tuple<"?{div=8}">
      %lay_2913 = cute.get_layout(%arg1) : !memref_gmem_bf16_
      %719 = cute.get_shape(%lay_2913) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_2914, %e1_2915, %e2_2916, %e3_2917 = cute.get_leaves(%719) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_2918 = cute.to_int_tuple(%e0_2914) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %720 = cute.get_scalars(%itup_2918) : !cute.int_tuple<"?">
      %itup_2919 = cute.to_int_tuple(%e1_2915) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %721 = cute.get_scalars(%itup_2919) : !cute.int_tuple<"?">
      %itup_2920 = cute.to_int_tuple(%e2_2916) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %722 = cute.get_scalars(%itup_2920) : !cute.int_tuple<"?">
      %itup_2921 = cute.to_int_tuple(%e3_2917) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %723 = cute.get_scalars(%itup_2921) : !cute.int_tuple<"?{div=8}">
      %shape_2922 = cute.make_shape(%itup_2909, %itup_2910, %itup_2911, %itup_2919) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)">
      %724 = cute.make_identity_tensor(%shape_2922) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %iter_2923 = cute.get_iter(%724) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %e0_2924, %e1_2925, %e2_2926, %e3_2927 = cute.get_leaves(%iter_2923) : !cute.int_tuple<"(0,0,0,0)">
      %coord_2928 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_2929 = cute.get_layout(%724) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %slice_2930 = cute.slice(%lay_2929, %coord_2928) : !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_2931 = cute.crd2idx(%coord_2928, %lay_2929) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_2932 = cute.get_iter(%724) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">
      %tup_2933 = cute.add_offset(%iter_2932, %idx_2931) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_2934 = cute.make_view(%tup_2933, %slice_2930) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %iter_2935 = cute.get_iter(%view_2934) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %e0_2936, %e1_2937, %e2_2938, %e3_2939 = cute.get_leaves(%iter_2935) : !cute.int_tuple<"(?,0,?,0)">
      %725 = cute.get_scalars(%e0_2936) : !cute.int_tuple<"?">
      %726 = cute.get_scalars(%e2_2938) : !cute.int_tuple<"?">
      %tile_2940 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]">
      %coord_2941 = cute.make_coord(%117, %498) : (i32, i32) -> !cute.coord<"(?,?)">
      %727:2 = cute.get_scalars(%coord_2941) <{only_dynamic}> : !cute.coord<"(?,?)">
      %coord_2942 = cute.make_coord(%727#0, %727#1) : (i32, i32) -> !cute.coord<"((_,_),(?,?))">
      %lay_2943 = cute.get_layout(%view_2934) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %728:2 = cute.get_scalars(%lay_2943) <{only_dynamic}> : !cute.layout<"(?,?):(1@1,1@3)">
      %c128_i32_2944 = arith.constant 128 : i32
      %729 = arith.ceildivsi %728#0, %c128_i32_2944 : i32
      %c64_i32_2945 = arith.constant 64 : i32
      %730 = arith.ceildivsi %728#1, %c64_i32_2945 : i32
      %shape_2946 = cute.make_shape(%729, %730) : (i32, i32) -> !cute.shape<"((128,64),(?,?))">
      %stride_2947 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,64@3))">
      %lay_2948 = cute.make_layout(%shape_2946, %stride_2947) : !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">
      %idx_2949 = cute.crd2idx(%coord_2942, %lay_2948) : (!cute.coord<"((_,_),(?,?))">, !cute.layout<"((128,64),(?,?)):((1@1,1@3),(128@1,64@3))">) -> !cute.int_tuple<"(0,?{div=128},0,?{div=64})">
      %iter_2950 = cute.get_iter(%view_2934) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">
      %tup_2951 = cute.add_offset(%iter_2950, %idx_2949) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,?{div=64})">) -> !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %view_2952 = cute.make_view(%tup_2951) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %iter_2953 = cute.get_iter(%view_2952) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">
      %e0_2954, %e1_2955, %e2_2956, %e3_2957 = cute.get_leaves(%iter_2953) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})">
      %731 = cute.get_scalars(%e0_2954) : !cute.int_tuple<"?">
      %732 = cute.get_scalars(%e1_2955) : !cute.int_tuple<"?{div=128}">
      %733 = cute.get_scalars(%e2_2956) : !cute.int_tuple<"?">
      %734 = cute.get_scalars(%e3_2957) : !cute.int_tuple<"?{div=64}">
      %coord_2958 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %ptn_C = cute.tiled.mma.partition C (%5, %view_2952, %coord_2958) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %iter_2959 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %e0_2960, %e1_2961, %e2_2962, %e3_2963 = cute.get_leaves(%iter_2959) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %735 = cute.get_scalars(%e0_2960) : !cute.int_tuple<"?">
      %736 = cute.get_scalars(%e1_2961) : !cute.int_tuple<"?">
      %737 = cute.get_scalars(%e2_2962) : !cute.int_tuple<"?">
      %738 = cute.get_scalars(%e3_2963) : !cute.int_tuple<"?{div=2}">
      %lay_2964 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %739 = cute.get_shape(%lay_2964) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2965, %e1_2966, %e2_2967, %e3_2968 = cute.get_leaves(%739) : !cute.shape<"((2,2),2,8)">
      %shape_2969 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
      %lay_2970 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %740 = cute.get_shape(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2971, %e1_2972, %e2_2973, %e3_2974 = cute.get_leaves(%740) : !cute.shape<"((2,2),2,8)">
      %741 = cute.get_shape(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2975, %e1_2976, %e2_2977, %e3_2978 = cute.get_leaves(%741) : !cute.shape<"((2,2),2,8)">
      %742 = cute.get_shape(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2979, %e1_2980, %e2_2981, %e3_2982 = cute.get_leaves(%742) : !cute.shape<"((2,2),2,8)">
      %743 = cute.get_shape(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_2983, %e1_2984, %e2_2985, %e3_2986 = cute.get_leaves(%743) : !cute.shape<"((2,2),2,8)">
      %744 = cute.get_stride(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2987, %e1_2988, %e2_2989, %e3_2990 = cute.get_leaves(%744) : !cute.stride<"((1,2),4,8)">
      %745 = cute.get_stride(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2991, %e1_2992, %e2_2993, %e3_2994 = cute.get_leaves(%745) : !cute.stride<"((1,2),4,8)">
      %746 = cute.get_stride(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2995, %e1_2996, %e2_2997, %e3_2998 = cute.get_leaves(%746) : !cute.stride<"((1,2),4,8)">
      %747 = cute.get_stride(%lay_2970) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_2999, %e1_3000, %e2_3001, %e3_3002 = cute.get_leaves(%747) : !cute.stride<"((1,2),4,8)">
      %shape_3003 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
      %stride_3004 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_3005 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
      %lay_3006 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)">
      %lay_3007 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %int_tuple_3008 = cute.make_int_tuple(%e0_2960, %e1_2961, %e2_2962, %e3_2963) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3009 = cute.make_view(%int_tuple_3008, %lay_3007) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %iter_3010 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %e0_3011, %e1_3012, %e2_3013, %e3_3014 = cute.get_leaves(%iter_3010) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %748 = cute.get_scalars(%e0_3011) : !cute.int_tuple<"?">
      %749 = cute.get_scalars(%e1_3012) : !cute.int_tuple<"?">
      %750 = cute.get_scalars(%e2_3013) : !cute.int_tuple<"?">
      %751 = cute.get_scalars(%e3_3014) : !cute.int_tuple<"?{div=2}">
      %lay_3015 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
      %sz_3016 = cute.size(%lay_3015) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_3017 = cute.get_leaves(%sz_3016) : !cute.int_tuple<"4">
      %lay_3018 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %752 = cute.get_shape(%lay_3018) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3019, %e1_3020, %e2_3021, %e3_3022 = cute.get_leaves(%752) : !cute.shape<"((2,2),(2,8))">
      %int_tuple_3023 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3024 = cute.size(%int_tuple_3023) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3025 = cute.get_leaves(%sz_3024) : !cute.int_tuple<"16">
      %coord_3026 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3027 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3028 = cute.crd2idx(%coord_3026, %lay_3027) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3029 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3030 = cute.add_offset(%iter_3029, %idx_3028) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3031 = cute.make_view(%tup_3030) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3032 = cute.get_iter(%view_3031) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3033, %e1_3034, %e2_3035, %e3_3036 = cute.get_leaves(%iter_3032) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %753 = cute.get_scalars(%e0_3033) : !cute.int_tuple<"?">
      %754 = cute.get_scalars(%e1_3034) : !cute.int_tuple<"?">
      %755 = cute.get_scalars(%e2_3035) : !cute.int_tuple<"?">
      %756 = cute.get_scalars(%e3_3036) : !cute.int_tuple<"?{div=2}">
      %iter_3037 = cute.get_iter(%view_3031) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3038, %e1_3039, %e2_3040, %e3_3041 = cute.get_leaves(%iter_3037) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %757 = cute.get_scalars(%e0_3038) : !cute.int_tuple<"?">
      %758 = cute.get_scalars(%e1_3039) : !cute.int_tuple<"?">
      %759 = cute.get_scalars(%e2_3040) : !cute.int_tuple<"?">
      %760 = cute.get_scalars(%e3_3041) : !cute.int_tuple<"?{div=2}">
      %iter_3042 = cute.get_iter(%view_3031) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3043, %e1_3044, %e2_3045, %e3_3046 = cute.get_leaves(%iter_3042) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %761 = cute.get_scalars(%e0_3043) : !cute.int_tuple<"?">
      %762 = cute.get_scalars(%e1_3044) : !cute.int_tuple<"?">
      %763 = cute.get_scalars(%e2_3045) : !cute.int_tuple<"?">
      %764 = cute.get_scalars(%e3_3046) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3047 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3048 = cute.add_offset(%e3_3046, %int_tuple_3047) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %765 = cute.get_scalars(%tup_3048) : !cute.int_tuple<"?">
      %coord_3049 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3050 = cute.make_coord(%tup_3048) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %766 = cute.elem_less(%coord_3049, %coord_3050) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3051 = cute.get_layout(%view_2856) : !memref_rmem_f32_4
      %767 = cute.get_shape(%lay_3051) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3052, %e1_3053, %e2_3054, %e3_3055 = cute.get_leaves(%767) : !cute.shape<"((2,2),(2,8))">
      %768 = cute.get_stride(%lay_3051) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3056, %e1_3057, %e2_3058, %e3_3059 = cute.get_leaves(%768) : !cute.stride<"((2,4),(1,8))">
      %769 = scf.if %766 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%view_2856) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,0)">
        cute.memref.store(%view_2856, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,0)">, f32) -> ()
        %lay_7722 = cute.get_layout(%view_2856) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2856 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%view_2856) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%view_2856) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %view_2856 : !memref_rmem_f32_4
      }
      %iter_3060 = cute.get_iter(%769) : !memref_rmem_f32_4
      %lay_3061 = cute.get_layout(%769) : !memref_rmem_f32_4
      %770 = cute.get_shape(%lay_3061) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3062, %e1_3063, %e2_3064, %e3_3065 = cute.get_leaves(%770) : !cute.shape<"((2,2),(2,8))">
      %771 = cute.get_stride(%lay_3061) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3066, %e1_3067, %e2_3068, %e3_3069 = cute.get_leaves(%771) : !cute.stride<"((2,4),(1,8))">
      %iter_3070 = cute.get_iter(%769) : !memref_rmem_f32_4
      %iter_3071 = cute.get_iter(%769) : !memref_rmem_f32_4
      %coord_3072 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3073 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3074 = cute.crd2idx(%coord_3072, %lay_3073) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3075 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3076 = cute.add_offset(%iter_3075, %idx_3074) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3077 = cute.make_view(%tup_3076) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3078 = cute.get_iter(%view_3077) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3079, %e1_3080, %e2_3081, %e3_3082 = cute.get_leaves(%iter_3078) : !cute.int_tuple<"(?,?,?,?)">
      %772 = cute.get_scalars(%e0_3079) : !cute.int_tuple<"?">
      %773 = cute.get_scalars(%e1_3080) : !cute.int_tuple<"?">
      %774 = cute.get_scalars(%e2_3081) : !cute.int_tuple<"?">
      %775 = cute.get_scalars(%e3_3082) : !cute.int_tuple<"?">
      %iter_3083 = cute.get_iter(%view_3077) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3084, %e1_3085, %e2_3086, %e3_3087 = cute.get_leaves(%iter_3083) : !cute.int_tuple<"(?,?,?,?)">
      %776 = cute.get_scalars(%e0_3084) : !cute.int_tuple<"?">
      %777 = cute.get_scalars(%e1_3085) : !cute.int_tuple<"?">
      %778 = cute.get_scalars(%e2_3086) : !cute.int_tuple<"?">
      %779 = cute.get_scalars(%e3_3087) : !cute.int_tuple<"?">
      %iter_3088 = cute.get_iter(%view_3077) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3089, %e1_3090, %e2_3091, %e3_3092 = cute.get_leaves(%iter_3088) : !cute.int_tuple<"(?,?,?,?)">
      %780 = cute.get_scalars(%e0_3089) : !cute.int_tuple<"?">
      %781 = cute.get_scalars(%e1_3090) : !cute.int_tuple<"?">
      %782 = cute.get_scalars(%e2_3091) : !cute.int_tuple<"?">
      %783 = cute.get_scalars(%e3_3092) : !cute.int_tuple<"?">
      %int_tuple_3093 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3094 = cute.add_offset(%e3_3092, %int_tuple_3093) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %784 = cute.get_scalars(%tup_3094) : !cute.int_tuple<"?">
      %coord_3095 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3096 = cute.make_coord(%tup_3094) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %785 = cute.elem_less(%coord_3095, %coord_3096) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3097 = cute.get_layout(%769) : !memref_rmem_f32_4
      %786 = cute.get_shape(%lay_3097) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3098, %e1_3099, %e2_3100, %e3_3101 = cute.get_leaves(%786) : !cute.shape<"((2,2),(2,8))">
      %787 = cute.get_stride(%lay_3097) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3102, %e1_3103, %e2_3104, %e3_3105 = cute.get_leaves(%787) : !cute.stride<"((2,4),(1,8))">
      %788 = scf.if %785 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%769) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,1)">
        cute.memref.store(%769, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,1)">, f32) -> ()
        %lay_7722 = cute.get_layout(%769) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %769 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%769) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%769) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %769 : !memref_rmem_f32_4
      }
      %iter_3106 = cute.get_iter(%788) : !memref_rmem_f32_4
      %lay_3107 = cute.get_layout(%788) : !memref_rmem_f32_4
      %789 = cute.get_shape(%lay_3107) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3108, %e1_3109, %e2_3110, %e3_3111 = cute.get_leaves(%789) : !cute.shape<"((2,2),(2,8))">
      %790 = cute.get_stride(%lay_3107) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3112, %e1_3113, %e2_3114, %e3_3115 = cute.get_leaves(%790) : !cute.stride<"((2,4),(1,8))">
      %iter_3116 = cute.get_iter(%788) : !memref_rmem_f32_4
      %iter_3117 = cute.get_iter(%788) : !memref_rmem_f32_4
      %coord_3118 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3119 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3120 = cute.crd2idx(%coord_3118, %lay_3119) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3121 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3122 = cute.add_offset(%iter_3121, %idx_3120) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3123 = cute.make_view(%tup_3122) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3124 = cute.get_iter(%view_3123) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3125, %e1_3126, %e2_3127, %e3_3128 = cute.get_leaves(%iter_3124) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %791 = cute.get_scalars(%e0_3125) : !cute.int_tuple<"?">
      %792 = cute.get_scalars(%e1_3126) : !cute.int_tuple<"?">
      %793 = cute.get_scalars(%e2_3127) : !cute.int_tuple<"?">
      %794 = cute.get_scalars(%e3_3128) : !cute.int_tuple<"?{div=2}">
      %iter_3129 = cute.get_iter(%view_3123) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3130, %e1_3131, %e2_3132, %e3_3133 = cute.get_leaves(%iter_3129) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %795 = cute.get_scalars(%e0_3130) : !cute.int_tuple<"?">
      %796 = cute.get_scalars(%e1_3131) : !cute.int_tuple<"?">
      %797 = cute.get_scalars(%e2_3132) : !cute.int_tuple<"?">
      %798 = cute.get_scalars(%e3_3133) : !cute.int_tuple<"?{div=2}">
      %iter_3134 = cute.get_iter(%view_3123) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3135, %e1_3136, %e2_3137, %e3_3138 = cute.get_leaves(%iter_3134) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %799 = cute.get_scalars(%e0_3135) : !cute.int_tuple<"?">
      %800 = cute.get_scalars(%e1_3136) : !cute.int_tuple<"?">
      %801 = cute.get_scalars(%e2_3137) : !cute.int_tuple<"?">
      %802 = cute.get_scalars(%e3_3138) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3139 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3140 = cute.add_offset(%e3_3138, %int_tuple_3139) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %803 = cute.get_scalars(%tup_3140) : !cute.int_tuple<"?">
      %coord_3141 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3142 = cute.make_coord(%tup_3140) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %804 = cute.elem_less(%coord_3141, %coord_3142) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3143 = cute.get_layout(%788) : !memref_rmem_f32_4
      %805 = cute.get_shape(%lay_3143) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3144, %e1_3145, %e2_3146, %e3_3147 = cute.get_leaves(%805) : !cute.shape<"((2,2),(2,8))">
      %806 = cute.get_stride(%lay_3143) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3148, %e1_3149, %e2_3150, %e3_3151 = cute.get_leaves(%806) : !cute.stride<"((2,4),(1,8))">
      %807 = scf.if %804 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%788) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,2)">
        cute.memref.store(%788, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,2)">, f32) -> ()
        %lay_7722 = cute.get_layout(%788) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %788 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%788) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%788) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %788 : !memref_rmem_f32_4
      }
      %iter_3152 = cute.get_iter(%807) : !memref_rmem_f32_4
      %lay_3153 = cute.get_layout(%807) : !memref_rmem_f32_4
      %808 = cute.get_shape(%lay_3153) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3154, %e1_3155, %e2_3156, %e3_3157 = cute.get_leaves(%808) : !cute.shape<"((2,2),(2,8))">
      %809 = cute.get_stride(%lay_3153) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3158, %e1_3159, %e2_3160, %e3_3161 = cute.get_leaves(%809) : !cute.stride<"((2,4),(1,8))">
      %iter_3162 = cute.get_iter(%807) : !memref_rmem_f32_4
      %iter_3163 = cute.get_iter(%807) : !memref_rmem_f32_4
      %coord_3164 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_3165 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3166 = cute.crd2idx(%coord_3164, %lay_3165) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_3167 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3168 = cute.add_offset(%iter_3167, %idx_3166) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3169 = cute.make_view(%tup_3168) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3170 = cute.get_iter(%view_3169) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3171, %e1_3172, %e2_3173, %e3_3174 = cute.get_leaves(%iter_3170) : !cute.int_tuple<"(?,?,?,?)">
      %810 = cute.get_scalars(%e0_3171) : !cute.int_tuple<"?">
      %811 = cute.get_scalars(%e1_3172) : !cute.int_tuple<"?">
      %812 = cute.get_scalars(%e2_3173) : !cute.int_tuple<"?">
      %813 = cute.get_scalars(%e3_3174) : !cute.int_tuple<"?">
      %iter_3175 = cute.get_iter(%view_3169) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3176, %e1_3177, %e2_3178, %e3_3179 = cute.get_leaves(%iter_3175) : !cute.int_tuple<"(?,?,?,?)">
      %814 = cute.get_scalars(%e0_3176) : !cute.int_tuple<"?">
      %815 = cute.get_scalars(%e1_3177) : !cute.int_tuple<"?">
      %816 = cute.get_scalars(%e2_3178) : !cute.int_tuple<"?">
      %817 = cute.get_scalars(%e3_3179) : !cute.int_tuple<"?">
      %iter_3180 = cute.get_iter(%view_3169) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3181, %e1_3182, %e2_3183, %e3_3184 = cute.get_leaves(%iter_3180) : !cute.int_tuple<"(?,?,?,?)">
      %818 = cute.get_scalars(%e0_3181) : !cute.int_tuple<"?">
      %819 = cute.get_scalars(%e1_3182) : !cute.int_tuple<"?">
      %820 = cute.get_scalars(%e2_3183) : !cute.int_tuple<"?">
      %821 = cute.get_scalars(%e3_3184) : !cute.int_tuple<"?">
      %int_tuple_3185 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3186 = cute.add_offset(%e3_3184, %int_tuple_3185) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %822 = cute.get_scalars(%tup_3186) : !cute.int_tuple<"?">
      %coord_3187 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3188 = cute.make_coord(%tup_3186) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %823 = cute.elem_less(%coord_3187, %coord_3188) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3189 = cute.get_layout(%807) : !memref_rmem_f32_4
      %824 = cute.get_shape(%lay_3189) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3190, %e1_3191, %e2_3192, %e3_3193 = cute.get_leaves(%824) : !cute.shape<"((2,2),(2,8))">
      %825 = cute.get_stride(%lay_3189) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3194, %e1_3195, %e2_3196, %e3_3197 = cute.get_leaves(%825) : !cute.stride<"((2,4),(1,8))">
      %826 = scf.if %823 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%807) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,3)">
        cute.memref.store(%807, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,3)">, f32) -> ()
        %lay_7722 = cute.get_layout(%807) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %807 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%807) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%807) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %807 : !memref_rmem_f32_4
      }
      %iter_3198 = cute.get_iter(%826) : !memref_rmem_f32_4
      %lay_3199 = cute.get_layout(%826) : !memref_rmem_f32_4
      %827 = cute.get_shape(%lay_3199) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3200, %e1_3201, %e2_3202, %e3_3203 = cute.get_leaves(%827) : !cute.shape<"((2,2),(2,8))">
      %828 = cute.get_stride(%lay_3199) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3204, %e1_3205, %e2_3206, %e3_3207 = cute.get_leaves(%828) : !cute.stride<"((2,4),(1,8))">
      %iter_3208 = cute.get_iter(%826) : !memref_rmem_f32_4
      %iter_3209 = cute.get_iter(%826) : !memref_rmem_f32_4
      %coord_3210 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_3211 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3212 = cute.crd2idx(%coord_3210, %lay_3211) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_3213 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3214 = cute.add_offset(%iter_3213, %idx_3212) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3215 = cute.make_view(%tup_3214) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3216 = cute.get_iter(%view_3215) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3217, %e1_3218, %e2_3219, %e3_3220 = cute.get_leaves(%iter_3216) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %829 = cute.get_scalars(%e0_3217) : !cute.int_tuple<"?">
      %830 = cute.get_scalars(%e1_3218) : !cute.int_tuple<"?">
      %831 = cute.get_scalars(%e2_3219) : !cute.int_tuple<"?">
      %832 = cute.get_scalars(%e3_3220) : !cute.int_tuple<"?{div=2}">
      %iter_3221 = cute.get_iter(%view_3215) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3222, %e1_3223, %e2_3224, %e3_3225 = cute.get_leaves(%iter_3221) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %833 = cute.get_scalars(%e0_3222) : !cute.int_tuple<"?">
      %834 = cute.get_scalars(%e1_3223) : !cute.int_tuple<"?">
      %835 = cute.get_scalars(%e2_3224) : !cute.int_tuple<"?">
      %836 = cute.get_scalars(%e3_3225) : !cute.int_tuple<"?{div=2}">
      %iter_3226 = cute.get_iter(%view_3215) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3227, %e1_3228, %e2_3229, %e3_3230 = cute.get_leaves(%iter_3226) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %837 = cute.get_scalars(%e0_3227) : !cute.int_tuple<"?">
      %838 = cute.get_scalars(%e1_3228) : !cute.int_tuple<"?">
      %839 = cute.get_scalars(%e2_3229) : !cute.int_tuple<"?">
      %840 = cute.get_scalars(%e3_3230) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3231 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3232 = cute.add_offset(%e3_3230, %int_tuple_3231) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %841 = cute.get_scalars(%tup_3232) : !cute.int_tuple<"?">
      %coord_3233 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3234 = cute.make_coord(%tup_3232) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %842 = cute.elem_less(%coord_3233, %coord_3234) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3235 = cute.get_layout(%826) : !memref_rmem_f32_4
      %843 = cute.get_shape(%lay_3235) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3236, %e1_3237, %e2_3238, %e3_3239 = cute.get_leaves(%843) : !cute.shape<"((2,2),(2,8))">
      %844 = cute.get_stride(%lay_3235) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3240, %e1_3241, %e2_3242, %e3_3243 = cute.get_leaves(%844) : !cute.stride<"((2,4),(1,8))">
      %845 = scf.if %842 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%826) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,4)">
        cute.memref.store(%826, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,4)">, f32) -> ()
        %lay_7722 = cute.get_layout(%826) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %826 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%826) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%826) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %826 : !memref_rmem_f32_4
      }
      %iter_3244 = cute.get_iter(%845) : !memref_rmem_f32_4
      %lay_3245 = cute.get_layout(%845) : !memref_rmem_f32_4
      %846 = cute.get_shape(%lay_3245) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3246, %e1_3247, %e2_3248, %e3_3249 = cute.get_leaves(%846) : !cute.shape<"((2,2),(2,8))">
      %847 = cute.get_stride(%lay_3245) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3250, %e1_3251, %e2_3252, %e3_3253 = cute.get_leaves(%847) : !cute.stride<"((2,4),(1,8))">
      %iter_3254 = cute.get_iter(%845) : !memref_rmem_f32_4
      %iter_3255 = cute.get_iter(%845) : !memref_rmem_f32_4
      %coord_3256 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_3257 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3258 = cute.crd2idx(%coord_3256, %lay_3257) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_3259 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3260 = cute.add_offset(%iter_3259, %idx_3258) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3261 = cute.make_view(%tup_3260) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3262 = cute.get_iter(%view_3261) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3263, %e1_3264, %e2_3265, %e3_3266 = cute.get_leaves(%iter_3262) : !cute.int_tuple<"(?,?,?,?)">
      %848 = cute.get_scalars(%e0_3263) : !cute.int_tuple<"?">
      %849 = cute.get_scalars(%e1_3264) : !cute.int_tuple<"?">
      %850 = cute.get_scalars(%e2_3265) : !cute.int_tuple<"?">
      %851 = cute.get_scalars(%e3_3266) : !cute.int_tuple<"?">
      %iter_3267 = cute.get_iter(%view_3261) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3268, %e1_3269, %e2_3270, %e3_3271 = cute.get_leaves(%iter_3267) : !cute.int_tuple<"(?,?,?,?)">
      %852 = cute.get_scalars(%e0_3268) : !cute.int_tuple<"?">
      %853 = cute.get_scalars(%e1_3269) : !cute.int_tuple<"?">
      %854 = cute.get_scalars(%e2_3270) : !cute.int_tuple<"?">
      %855 = cute.get_scalars(%e3_3271) : !cute.int_tuple<"?">
      %iter_3272 = cute.get_iter(%view_3261) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3273, %e1_3274, %e2_3275, %e3_3276 = cute.get_leaves(%iter_3272) : !cute.int_tuple<"(?,?,?,?)">
      %856 = cute.get_scalars(%e0_3273) : !cute.int_tuple<"?">
      %857 = cute.get_scalars(%e1_3274) : !cute.int_tuple<"?">
      %858 = cute.get_scalars(%e2_3275) : !cute.int_tuple<"?">
      %859 = cute.get_scalars(%e3_3276) : !cute.int_tuple<"?">
      %int_tuple_3277 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3278 = cute.add_offset(%e3_3276, %int_tuple_3277) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %860 = cute.get_scalars(%tup_3278) : !cute.int_tuple<"?">
      %coord_3279 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3280 = cute.make_coord(%tup_3278) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %861 = cute.elem_less(%coord_3279, %coord_3280) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3281 = cute.get_layout(%845) : !memref_rmem_f32_4
      %862 = cute.get_shape(%lay_3281) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3282, %e1_3283, %e2_3284, %e3_3285 = cute.get_leaves(%862) : !cute.shape<"((2,2),(2,8))">
      %863 = cute.get_stride(%lay_3281) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3286, %e1_3287, %e2_3288, %e3_3289 = cute.get_leaves(%863) : !cute.stride<"((2,4),(1,8))">
      %864 = scf.if %861 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%845) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,5)">
        cute.memref.store(%845, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,5)">, f32) -> ()
        %lay_7722 = cute.get_layout(%845) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %845 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%845) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%845) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %845 : !memref_rmem_f32_4
      }
      %iter_3290 = cute.get_iter(%864) : !memref_rmem_f32_4
      %lay_3291 = cute.get_layout(%864) : !memref_rmem_f32_4
      %865 = cute.get_shape(%lay_3291) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3292, %e1_3293, %e2_3294, %e3_3295 = cute.get_leaves(%865) : !cute.shape<"((2,2),(2,8))">
      %866 = cute.get_stride(%lay_3291) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3296, %e1_3297, %e2_3298, %e3_3299 = cute.get_leaves(%866) : !cute.stride<"((2,4),(1,8))">
      %iter_3300 = cute.get_iter(%864) : !memref_rmem_f32_4
      %iter_3301 = cute.get_iter(%864) : !memref_rmem_f32_4
      %coord_3302 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_3303 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3304 = cute.crd2idx(%coord_3302, %lay_3303) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_3305 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3306 = cute.add_offset(%iter_3305, %idx_3304) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3307 = cute.make_view(%tup_3306) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3308 = cute.get_iter(%view_3307) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3309, %e1_3310, %e2_3311, %e3_3312 = cute.get_leaves(%iter_3308) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %867 = cute.get_scalars(%e0_3309) : !cute.int_tuple<"?">
      %868 = cute.get_scalars(%e1_3310) : !cute.int_tuple<"?">
      %869 = cute.get_scalars(%e2_3311) : !cute.int_tuple<"?">
      %870 = cute.get_scalars(%e3_3312) : !cute.int_tuple<"?{div=2}">
      %iter_3313 = cute.get_iter(%view_3307) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3314, %e1_3315, %e2_3316, %e3_3317 = cute.get_leaves(%iter_3313) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %871 = cute.get_scalars(%e0_3314) : !cute.int_tuple<"?">
      %872 = cute.get_scalars(%e1_3315) : !cute.int_tuple<"?">
      %873 = cute.get_scalars(%e2_3316) : !cute.int_tuple<"?">
      %874 = cute.get_scalars(%e3_3317) : !cute.int_tuple<"?{div=2}">
      %iter_3318 = cute.get_iter(%view_3307) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3319, %e1_3320, %e2_3321, %e3_3322 = cute.get_leaves(%iter_3318) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %875 = cute.get_scalars(%e0_3319) : !cute.int_tuple<"?">
      %876 = cute.get_scalars(%e1_3320) : !cute.int_tuple<"?">
      %877 = cute.get_scalars(%e2_3321) : !cute.int_tuple<"?">
      %878 = cute.get_scalars(%e3_3322) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3323 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3324 = cute.add_offset(%e3_3322, %int_tuple_3323) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %879 = cute.get_scalars(%tup_3324) : !cute.int_tuple<"?">
      %coord_3325 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3326 = cute.make_coord(%tup_3324) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %880 = cute.elem_less(%coord_3325, %coord_3326) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3327 = cute.get_layout(%864) : !memref_rmem_f32_4
      %881 = cute.get_shape(%lay_3327) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3328, %e1_3329, %e2_3330, %e3_3331 = cute.get_leaves(%881) : !cute.shape<"((2,2),(2,8))">
      %882 = cute.get_stride(%lay_3327) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3332, %e1_3333, %e2_3334, %e3_3335 = cute.get_leaves(%882) : !cute.stride<"((2,4),(1,8))">
      %883 = scf.if %880 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%864) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,6)">
        cute.memref.store(%864, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,6)">, f32) -> ()
        %lay_7722 = cute.get_layout(%864) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %864 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%864) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%864) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %864 : !memref_rmem_f32_4
      }
      %iter_3336 = cute.get_iter(%883) : !memref_rmem_f32_4
      %lay_3337 = cute.get_layout(%883) : !memref_rmem_f32_4
      %884 = cute.get_shape(%lay_3337) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3338, %e1_3339, %e2_3340, %e3_3341 = cute.get_leaves(%884) : !cute.shape<"((2,2),(2,8))">
      %885 = cute.get_stride(%lay_3337) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3342, %e1_3343, %e2_3344, %e3_3345 = cute.get_leaves(%885) : !cute.stride<"((2,4),(1,8))">
      %iter_3346 = cute.get_iter(%883) : !memref_rmem_f32_4
      %iter_3347 = cute.get_iter(%883) : !memref_rmem_f32_4
      %coord_3348 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_3349 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3350 = cute.crd2idx(%coord_3348, %lay_3349) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_3351 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3352 = cute.add_offset(%iter_3351, %idx_3350) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3353 = cute.make_view(%tup_3352) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3354 = cute.get_iter(%view_3353) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3355, %e1_3356, %e2_3357, %e3_3358 = cute.get_leaves(%iter_3354) : !cute.int_tuple<"(?,?,?,?)">
      %886 = cute.get_scalars(%e0_3355) : !cute.int_tuple<"?">
      %887 = cute.get_scalars(%e1_3356) : !cute.int_tuple<"?">
      %888 = cute.get_scalars(%e2_3357) : !cute.int_tuple<"?">
      %889 = cute.get_scalars(%e3_3358) : !cute.int_tuple<"?">
      %iter_3359 = cute.get_iter(%view_3353) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3360, %e1_3361, %e2_3362, %e3_3363 = cute.get_leaves(%iter_3359) : !cute.int_tuple<"(?,?,?,?)">
      %890 = cute.get_scalars(%e0_3360) : !cute.int_tuple<"?">
      %891 = cute.get_scalars(%e1_3361) : !cute.int_tuple<"?">
      %892 = cute.get_scalars(%e2_3362) : !cute.int_tuple<"?">
      %893 = cute.get_scalars(%e3_3363) : !cute.int_tuple<"?">
      %iter_3364 = cute.get_iter(%view_3353) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3365, %e1_3366, %e2_3367, %e3_3368 = cute.get_leaves(%iter_3364) : !cute.int_tuple<"(?,?,?,?)">
      %894 = cute.get_scalars(%e0_3365) : !cute.int_tuple<"?">
      %895 = cute.get_scalars(%e1_3366) : !cute.int_tuple<"?">
      %896 = cute.get_scalars(%e2_3367) : !cute.int_tuple<"?">
      %897 = cute.get_scalars(%e3_3368) : !cute.int_tuple<"?">
      %int_tuple_3369 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3370 = cute.add_offset(%e3_3368, %int_tuple_3369) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %898 = cute.get_scalars(%tup_3370) : !cute.int_tuple<"?">
      %coord_3371 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3372 = cute.make_coord(%tup_3370) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %899 = cute.elem_less(%coord_3371, %coord_3372) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3373 = cute.get_layout(%883) : !memref_rmem_f32_4
      %900 = cute.get_shape(%lay_3373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3374, %e1_3375, %e2_3376, %e3_3377 = cute.get_leaves(%900) : !cute.shape<"((2,2),(2,8))">
      %901 = cute.get_stride(%lay_3373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3378, %e1_3379, %e2_3380, %e3_3381 = cute.get_leaves(%901) : !cute.stride<"((2,4),(1,8))">
      %902 = scf.if %899 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%883) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,7)">
        cute.memref.store(%883, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,7)">, f32) -> ()
        %lay_7722 = cute.get_layout(%883) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %883 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%883) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%883) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %883 : !memref_rmem_f32_4
      }
      %iter_3382 = cute.get_iter(%902) : !memref_rmem_f32_4
      %lay_3383 = cute.get_layout(%902) : !memref_rmem_f32_4
      %903 = cute.get_shape(%lay_3383) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3384, %e1_3385, %e2_3386, %e3_3387 = cute.get_leaves(%903) : !cute.shape<"((2,2),(2,8))">
      %904 = cute.get_stride(%lay_3383) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3388, %e1_3389, %e2_3390, %e3_3391 = cute.get_leaves(%904) : !cute.stride<"((2,4),(1,8))">
      %iter_3392 = cute.get_iter(%902) : !memref_rmem_f32_4
      %iter_3393 = cute.get_iter(%902) : !memref_rmem_f32_4
      %coord_3394 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_3395 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3396 = cute.crd2idx(%coord_3394, %lay_3395) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_3397 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3398 = cute.add_offset(%iter_3397, %idx_3396) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3399 = cute.make_view(%tup_3398) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3400 = cute.get_iter(%view_3399) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3401, %e1_3402, %e2_3403, %e3_3404 = cute.get_leaves(%iter_3400) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %905 = cute.get_scalars(%e0_3401) : !cute.int_tuple<"?">
      %906 = cute.get_scalars(%e1_3402) : !cute.int_tuple<"?">
      %907 = cute.get_scalars(%e2_3403) : !cute.int_tuple<"?">
      %908 = cute.get_scalars(%e3_3404) : !cute.int_tuple<"?{div=2}">
      %iter_3405 = cute.get_iter(%view_3399) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3406, %e1_3407, %e2_3408, %e3_3409 = cute.get_leaves(%iter_3405) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %909 = cute.get_scalars(%e0_3406) : !cute.int_tuple<"?">
      %910 = cute.get_scalars(%e1_3407) : !cute.int_tuple<"?">
      %911 = cute.get_scalars(%e2_3408) : !cute.int_tuple<"?">
      %912 = cute.get_scalars(%e3_3409) : !cute.int_tuple<"?{div=2}">
      %iter_3410 = cute.get_iter(%view_3399) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3411, %e1_3412, %e2_3413, %e3_3414 = cute.get_leaves(%iter_3410) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %913 = cute.get_scalars(%e0_3411) : !cute.int_tuple<"?">
      %914 = cute.get_scalars(%e1_3412) : !cute.int_tuple<"?">
      %915 = cute.get_scalars(%e2_3413) : !cute.int_tuple<"?">
      %916 = cute.get_scalars(%e3_3414) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3415 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3416 = cute.add_offset(%e3_3414, %int_tuple_3415) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %917 = cute.get_scalars(%tup_3416) : !cute.int_tuple<"?">
      %coord_3417 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3418 = cute.make_coord(%tup_3416) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %918 = cute.elem_less(%coord_3417, %coord_3418) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3419 = cute.get_layout(%902) : !memref_rmem_f32_4
      %919 = cute.get_shape(%lay_3419) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3420, %e1_3421, %e2_3422, %e3_3423 = cute.get_leaves(%919) : !cute.shape<"((2,2),(2,8))">
      %920 = cute.get_stride(%lay_3419) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3424, %e1_3425, %e2_3426, %e3_3427 = cute.get_leaves(%920) : !cute.stride<"((2,4),(1,8))">
      %921 = scf.if %918 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%902) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,8)">
        cute.memref.store(%902, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,8)">, f32) -> ()
        %lay_7722 = cute.get_layout(%902) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %902 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%902) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%902) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %902 : !memref_rmem_f32_4
      }
      %iter_3428 = cute.get_iter(%921) : !memref_rmem_f32_4
      %lay_3429 = cute.get_layout(%921) : !memref_rmem_f32_4
      %922 = cute.get_shape(%lay_3429) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3430, %e1_3431, %e2_3432, %e3_3433 = cute.get_leaves(%922) : !cute.shape<"((2,2),(2,8))">
      %923 = cute.get_stride(%lay_3429) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3434, %e1_3435, %e2_3436, %e3_3437 = cute.get_leaves(%923) : !cute.stride<"((2,4),(1,8))">
      %iter_3438 = cute.get_iter(%921) : !memref_rmem_f32_4
      %iter_3439 = cute.get_iter(%921) : !memref_rmem_f32_4
      %coord_3440 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_3441 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3442 = cute.crd2idx(%coord_3440, %lay_3441) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_3443 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3444 = cute.add_offset(%iter_3443, %idx_3442) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3445 = cute.make_view(%tup_3444) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3446 = cute.get_iter(%view_3445) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3447, %e1_3448, %e2_3449, %e3_3450 = cute.get_leaves(%iter_3446) : !cute.int_tuple<"(?,?,?,?)">
      %924 = cute.get_scalars(%e0_3447) : !cute.int_tuple<"?">
      %925 = cute.get_scalars(%e1_3448) : !cute.int_tuple<"?">
      %926 = cute.get_scalars(%e2_3449) : !cute.int_tuple<"?">
      %927 = cute.get_scalars(%e3_3450) : !cute.int_tuple<"?">
      %iter_3451 = cute.get_iter(%view_3445) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3452, %e1_3453, %e2_3454, %e3_3455 = cute.get_leaves(%iter_3451) : !cute.int_tuple<"(?,?,?,?)">
      %928 = cute.get_scalars(%e0_3452) : !cute.int_tuple<"?">
      %929 = cute.get_scalars(%e1_3453) : !cute.int_tuple<"?">
      %930 = cute.get_scalars(%e2_3454) : !cute.int_tuple<"?">
      %931 = cute.get_scalars(%e3_3455) : !cute.int_tuple<"?">
      %iter_3456 = cute.get_iter(%view_3445) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3457, %e1_3458, %e2_3459, %e3_3460 = cute.get_leaves(%iter_3456) : !cute.int_tuple<"(?,?,?,?)">
      %932 = cute.get_scalars(%e0_3457) : !cute.int_tuple<"?">
      %933 = cute.get_scalars(%e1_3458) : !cute.int_tuple<"?">
      %934 = cute.get_scalars(%e2_3459) : !cute.int_tuple<"?">
      %935 = cute.get_scalars(%e3_3460) : !cute.int_tuple<"?">
      %int_tuple_3461 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3462 = cute.add_offset(%e3_3460, %int_tuple_3461) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %936 = cute.get_scalars(%tup_3462) : !cute.int_tuple<"?">
      %coord_3463 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3464 = cute.make_coord(%tup_3462) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %937 = cute.elem_less(%coord_3463, %coord_3464) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3465 = cute.get_layout(%921) : !memref_rmem_f32_4
      %938 = cute.get_shape(%lay_3465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3466, %e1_3467, %e2_3468, %e3_3469 = cute.get_leaves(%938) : !cute.shape<"((2,2),(2,8))">
      %939 = cute.get_stride(%lay_3465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3470, %e1_3471, %e2_3472, %e3_3473 = cute.get_leaves(%939) : !cute.stride<"((2,4),(1,8))">
      %940 = scf.if %937 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%921) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,9)">
        cute.memref.store(%921, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,9)">, f32) -> ()
        %lay_7722 = cute.get_layout(%921) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %921 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%921) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%921) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %921 : !memref_rmem_f32_4
      }
      %iter_3474 = cute.get_iter(%940) : !memref_rmem_f32_4
      %lay_3475 = cute.get_layout(%940) : !memref_rmem_f32_4
      %941 = cute.get_shape(%lay_3475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3476, %e1_3477, %e2_3478, %e3_3479 = cute.get_leaves(%941) : !cute.shape<"((2,2),(2,8))">
      %942 = cute.get_stride(%lay_3475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3480, %e1_3481, %e2_3482, %e3_3483 = cute.get_leaves(%942) : !cute.stride<"((2,4),(1,8))">
      %iter_3484 = cute.get_iter(%940) : !memref_rmem_f32_4
      %iter_3485 = cute.get_iter(%940) : !memref_rmem_f32_4
      %coord_3486 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_3487 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3488 = cute.crd2idx(%coord_3486, %lay_3487) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_3489 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3490 = cute.add_offset(%iter_3489, %idx_3488) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3491 = cute.make_view(%tup_3490) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3492 = cute.get_iter(%view_3491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3493, %e1_3494, %e2_3495, %e3_3496 = cute.get_leaves(%iter_3492) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %943 = cute.get_scalars(%e0_3493) : !cute.int_tuple<"?">
      %944 = cute.get_scalars(%e1_3494) : !cute.int_tuple<"?">
      %945 = cute.get_scalars(%e2_3495) : !cute.int_tuple<"?">
      %946 = cute.get_scalars(%e3_3496) : !cute.int_tuple<"?{div=2}">
      %iter_3497 = cute.get_iter(%view_3491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3498, %e1_3499, %e2_3500, %e3_3501 = cute.get_leaves(%iter_3497) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %947 = cute.get_scalars(%e0_3498) : !cute.int_tuple<"?">
      %948 = cute.get_scalars(%e1_3499) : !cute.int_tuple<"?">
      %949 = cute.get_scalars(%e2_3500) : !cute.int_tuple<"?">
      %950 = cute.get_scalars(%e3_3501) : !cute.int_tuple<"?{div=2}">
      %iter_3502 = cute.get_iter(%view_3491) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3503, %e1_3504, %e2_3505, %e3_3506 = cute.get_leaves(%iter_3502) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %951 = cute.get_scalars(%e0_3503) : !cute.int_tuple<"?">
      %952 = cute.get_scalars(%e1_3504) : !cute.int_tuple<"?">
      %953 = cute.get_scalars(%e2_3505) : !cute.int_tuple<"?">
      %954 = cute.get_scalars(%e3_3506) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3507 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3508 = cute.add_offset(%e3_3506, %int_tuple_3507) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %955 = cute.get_scalars(%tup_3508) : !cute.int_tuple<"?">
      %coord_3509 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3510 = cute.make_coord(%tup_3508) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %956 = cute.elem_less(%coord_3509, %coord_3510) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3511 = cute.get_layout(%940) : !memref_rmem_f32_4
      %957 = cute.get_shape(%lay_3511) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3512, %e1_3513, %e2_3514, %e3_3515 = cute.get_leaves(%957) : !cute.shape<"((2,2),(2,8))">
      %958 = cute.get_stride(%lay_3511) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3516, %e1_3517, %e2_3518, %e3_3519 = cute.get_leaves(%958) : !cute.stride<"((2,4),(1,8))">
      %959 = scf.if %956 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%940) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,10)">
        cute.memref.store(%940, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,10)">, f32) -> ()
        %lay_7722 = cute.get_layout(%940) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %940 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%940) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%940) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %940 : !memref_rmem_f32_4
      }
      %iter_3520 = cute.get_iter(%959) : !memref_rmem_f32_4
      %lay_3521 = cute.get_layout(%959) : !memref_rmem_f32_4
      %960 = cute.get_shape(%lay_3521) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3522, %e1_3523, %e2_3524, %e3_3525 = cute.get_leaves(%960) : !cute.shape<"((2,2),(2,8))">
      %961 = cute.get_stride(%lay_3521) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3526, %e1_3527, %e2_3528, %e3_3529 = cute.get_leaves(%961) : !cute.stride<"((2,4),(1,8))">
      %iter_3530 = cute.get_iter(%959) : !memref_rmem_f32_4
      %iter_3531 = cute.get_iter(%959) : !memref_rmem_f32_4
      %coord_3532 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_3533 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3534 = cute.crd2idx(%coord_3532, %lay_3533) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_3535 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3536 = cute.add_offset(%iter_3535, %idx_3534) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3537 = cute.make_view(%tup_3536) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3538 = cute.get_iter(%view_3537) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3539, %e1_3540, %e2_3541, %e3_3542 = cute.get_leaves(%iter_3538) : !cute.int_tuple<"(?,?,?,?)">
      %962 = cute.get_scalars(%e0_3539) : !cute.int_tuple<"?">
      %963 = cute.get_scalars(%e1_3540) : !cute.int_tuple<"?">
      %964 = cute.get_scalars(%e2_3541) : !cute.int_tuple<"?">
      %965 = cute.get_scalars(%e3_3542) : !cute.int_tuple<"?">
      %iter_3543 = cute.get_iter(%view_3537) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3544, %e1_3545, %e2_3546, %e3_3547 = cute.get_leaves(%iter_3543) : !cute.int_tuple<"(?,?,?,?)">
      %966 = cute.get_scalars(%e0_3544) : !cute.int_tuple<"?">
      %967 = cute.get_scalars(%e1_3545) : !cute.int_tuple<"?">
      %968 = cute.get_scalars(%e2_3546) : !cute.int_tuple<"?">
      %969 = cute.get_scalars(%e3_3547) : !cute.int_tuple<"?">
      %iter_3548 = cute.get_iter(%view_3537) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3549, %e1_3550, %e2_3551, %e3_3552 = cute.get_leaves(%iter_3548) : !cute.int_tuple<"(?,?,?,?)">
      %970 = cute.get_scalars(%e0_3549) : !cute.int_tuple<"?">
      %971 = cute.get_scalars(%e1_3550) : !cute.int_tuple<"?">
      %972 = cute.get_scalars(%e2_3551) : !cute.int_tuple<"?">
      %973 = cute.get_scalars(%e3_3552) : !cute.int_tuple<"?">
      %int_tuple_3553 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3554 = cute.add_offset(%e3_3552, %int_tuple_3553) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %974 = cute.get_scalars(%tup_3554) : !cute.int_tuple<"?">
      %coord_3555 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3556 = cute.make_coord(%tup_3554) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %975 = cute.elem_less(%coord_3555, %coord_3556) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3557 = cute.get_layout(%959) : !memref_rmem_f32_4
      %976 = cute.get_shape(%lay_3557) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3558, %e1_3559, %e2_3560, %e3_3561 = cute.get_leaves(%976) : !cute.shape<"((2,2),(2,8))">
      %977 = cute.get_stride(%lay_3557) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3562, %e1_3563, %e2_3564, %e3_3565 = cute.get_leaves(%977) : !cute.stride<"((2,4),(1,8))">
      %978 = scf.if %975 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%959) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,11)">
        cute.memref.store(%959, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,11)">, f32) -> ()
        %lay_7722 = cute.get_layout(%959) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %959 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%959) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%959) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %959 : !memref_rmem_f32_4
      }
      %iter_3566 = cute.get_iter(%978) : !memref_rmem_f32_4
      %lay_3567 = cute.get_layout(%978) : !memref_rmem_f32_4
      %979 = cute.get_shape(%lay_3567) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3568, %e1_3569, %e2_3570, %e3_3571 = cute.get_leaves(%979) : !cute.shape<"((2,2),(2,8))">
      %980 = cute.get_stride(%lay_3567) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3572, %e1_3573, %e2_3574, %e3_3575 = cute.get_leaves(%980) : !cute.stride<"((2,4),(1,8))">
      %iter_3576 = cute.get_iter(%978) : !memref_rmem_f32_4
      %iter_3577 = cute.get_iter(%978) : !memref_rmem_f32_4
      %coord_3578 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_3579 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3580 = cute.crd2idx(%coord_3578, %lay_3579) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_3581 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3582 = cute.add_offset(%iter_3581, %idx_3580) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3583 = cute.make_view(%tup_3582) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3584 = cute.get_iter(%view_3583) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3585, %e1_3586, %e2_3587, %e3_3588 = cute.get_leaves(%iter_3584) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %981 = cute.get_scalars(%e0_3585) : !cute.int_tuple<"?">
      %982 = cute.get_scalars(%e1_3586) : !cute.int_tuple<"?">
      %983 = cute.get_scalars(%e2_3587) : !cute.int_tuple<"?">
      %984 = cute.get_scalars(%e3_3588) : !cute.int_tuple<"?{div=2}">
      %iter_3589 = cute.get_iter(%view_3583) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3590, %e1_3591, %e2_3592, %e3_3593 = cute.get_leaves(%iter_3589) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %985 = cute.get_scalars(%e0_3590) : !cute.int_tuple<"?">
      %986 = cute.get_scalars(%e1_3591) : !cute.int_tuple<"?">
      %987 = cute.get_scalars(%e2_3592) : !cute.int_tuple<"?">
      %988 = cute.get_scalars(%e3_3593) : !cute.int_tuple<"?{div=2}">
      %iter_3594 = cute.get_iter(%view_3583) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3595, %e1_3596, %e2_3597, %e3_3598 = cute.get_leaves(%iter_3594) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %989 = cute.get_scalars(%e0_3595) : !cute.int_tuple<"?">
      %990 = cute.get_scalars(%e1_3596) : !cute.int_tuple<"?">
      %991 = cute.get_scalars(%e2_3597) : !cute.int_tuple<"?">
      %992 = cute.get_scalars(%e3_3598) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3599 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3600 = cute.add_offset(%e3_3598, %int_tuple_3599) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %993 = cute.get_scalars(%tup_3600) : !cute.int_tuple<"?">
      %coord_3601 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3602 = cute.make_coord(%tup_3600) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %994 = cute.elem_less(%coord_3601, %coord_3602) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3603 = cute.get_layout(%978) : !memref_rmem_f32_4
      %995 = cute.get_shape(%lay_3603) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3604, %e1_3605, %e2_3606, %e3_3607 = cute.get_leaves(%995) : !cute.shape<"((2,2),(2,8))">
      %996 = cute.get_stride(%lay_3603) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3608, %e1_3609, %e2_3610, %e3_3611 = cute.get_leaves(%996) : !cute.stride<"((2,4),(1,8))">
      %997 = scf.if %994 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%978) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,12)">
        cute.memref.store(%978, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,12)">, f32) -> ()
        %lay_7722 = cute.get_layout(%978) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %978 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%978) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%978) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %978 : !memref_rmem_f32_4
      }
      %iter_3612 = cute.get_iter(%997) : !memref_rmem_f32_4
      %lay_3613 = cute.get_layout(%997) : !memref_rmem_f32_4
      %998 = cute.get_shape(%lay_3613) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3614, %e1_3615, %e2_3616, %e3_3617 = cute.get_leaves(%998) : !cute.shape<"((2,2),(2,8))">
      %999 = cute.get_stride(%lay_3613) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3618, %e1_3619, %e2_3620, %e3_3621 = cute.get_leaves(%999) : !cute.stride<"((2,4),(1,8))">
      %iter_3622 = cute.get_iter(%997) : !memref_rmem_f32_4
      %iter_3623 = cute.get_iter(%997) : !memref_rmem_f32_4
      %coord_3624 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_3625 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3626 = cute.crd2idx(%coord_3624, %lay_3625) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_3627 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3628 = cute.add_offset(%iter_3627, %idx_3626) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3629 = cute.make_view(%tup_3628) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3630 = cute.get_iter(%view_3629) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3631, %e1_3632, %e2_3633, %e3_3634 = cute.get_leaves(%iter_3630) : !cute.int_tuple<"(?,?,?,?)">
      %1000 = cute.get_scalars(%e0_3631) : !cute.int_tuple<"?">
      %1001 = cute.get_scalars(%e1_3632) : !cute.int_tuple<"?">
      %1002 = cute.get_scalars(%e2_3633) : !cute.int_tuple<"?">
      %1003 = cute.get_scalars(%e3_3634) : !cute.int_tuple<"?">
      %iter_3635 = cute.get_iter(%view_3629) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3636, %e1_3637, %e2_3638, %e3_3639 = cute.get_leaves(%iter_3635) : !cute.int_tuple<"(?,?,?,?)">
      %1004 = cute.get_scalars(%e0_3636) : !cute.int_tuple<"?">
      %1005 = cute.get_scalars(%e1_3637) : !cute.int_tuple<"?">
      %1006 = cute.get_scalars(%e2_3638) : !cute.int_tuple<"?">
      %1007 = cute.get_scalars(%e3_3639) : !cute.int_tuple<"?">
      %iter_3640 = cute.get_iter(%view_3629) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3641, %e1_3642, %e2_3643, %e3_3644 = cute.get_leaves(%iter_3640) : !cute.int_tuple<"(?,?,?,?)">
      %1008 = cute.get_scalars(%e0_3641) : !cute.int_tuple<"?">
      %1009 = cute.get_scalars(%e1_3642) : !cute.int_tuple<"?">
      %1010 = cute.get_scalars(%e2_3643) : !cute.int_tuple<"?">
      %1011 = cute.get_scalars(%e3_3644) : !cute.int_tuple<"?">
      %int_tuple_3645 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3646 = cute.add_offset(%e3_3644, %int_tuple_3645) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1012 = cute.get_scalars(%tup_3646) : !cute.int_tuple<"?">
      %coord_3647 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3648 = cute.make_coord(%tup_3646) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1013 = cute.elem_less(%coord_3647, %coord_3648) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3649 = cute.get_layout(%997) : !memref_rmem_f32_4
      %1014 = cute.get_shape(%lay_3649) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3650, %e1_3651, %e2_3652, %e3_3653 = cute.get_leaves(%1014) : !cute.shape<"((2,2),(2,8))">
      %1015 = cute.get_stride(%lay_3649) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3654, %e1_3655, %e2_3656, %e3_3657 = cute.get_leaves(%1015) : !cute.stride<"((2,4),(1,8))">
      %1016 = scf.if %1013 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%997) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,13)">
        cute.memref.store(%997, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,13)">, f32) -> ()
        %lay_7722 = cute.get_layout(%997) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %997 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%997) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%997) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %997 : !memref_rmem_f32_4
      }
      %iter_3658 = cute.get_iter(%1016) : !memref_rmem_f32_4
      %lay_3659 = cute.get_layout(%1016) : !memref_rmem_f32_4
      %1017 = cute.get_shape(%lay_3659) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3660, %e1_3661, %e2_3662, %e3_3663 = cute.get_leaves(%1017) : !cute.shape<"((2,2),(2,8))">
      %1018 = cute.get_stride(%lay_3659) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3664, %e1_3665, %e2_3666, %e3_3667 = cute.get_leaves(%1018) : !cute.stride<"((2,4),(1,8))">
      %iter_3668 = cute.get_iter(%1016) : !memref_rmem_f32_4
      %iter_3669 = cute.get_iter(%1016) : !memref_rmem_f32_4
      %coord_3670 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_3671 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3672 = cute.crd2idx(%coord_3670, %lay_3671) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_3673 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3674 = cute.add_offset(%iter_3673, %idx_3672) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3675 = cute.make_view(%tup_3674) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3676 = cute.get_iter(%view_3675) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3677, %e1_3678, %e2_3679, %e3_3680 = cute.get_leaves(%iter_3676) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1019 = cute.get_scalars(%e0_3677) : !cute.int_tuple<"?">
      %1020 = cute.get_scalars(%e1_3678) : !cute.int_tuple<"?">
      %1021 = cute.get_scalars(%e2_3679) : !cute.int_tuple<"?">
      %1022 = cute.get_scalars(%e3_3680) : !cute.int_tuple<"?{div=2}">
      %iter_3681 = cute.get_iter(%view_3675) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3682, %e1_3683, %e2_3684, %e3_3685 = cute.get_leaves(%iter_3681) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1023 = cute.get_scalars(%e0_3682) : !cute.int_tuple<"?">
      %1024 = cute.get_scalars(%e1_3683) : !cute.int_tuple<"?">
      %1025 = cute.get_scalars(%e2_3684) : !cute.int_tuple<"?">
      %1026 = cute.get_scalars(%e3_3685) : !cute.int_tuple<"?{div=2}">
      %iter_3686 = cute.get_iter(%view_3675) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3687, %e1_3688, %e2_3689, %e3_3690 = cute.get_leaves(%iter_3686) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1027 = cute.get_scalars(%e0_3687) : !cute.int_tuple<"?">
      %1028 = cute.get_scalars(%e1_3688) : !cute.int_tuple<"?">
      %1029 = cute.get_scalars(%e2_3689) : !cute.int_tuple<"?">
      %1030 = cute.get_scalars(%e3_3690) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3691 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3692 = cute.add_offset(%e3_3690, %int_tuple_3691) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1031 = cute.get_scalars(%tup_3692) : !cute.int_tuple<"?">
      %coord_3693 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3694 = cute.make_coord(%tup_3692) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1032 = cute.elem_less(%coord_3693, %coord_3694) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3695 = cute.get_layout(%1016) : !memref_rmem_f32_4
      %1033 = cute.get_shape(%lay_3695) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3696, %e1_3697, %e2_3698, %e3_3699 = cute.get_leaves(%1033) : !cute.shape<"((2,2),(2,8))">
      %1034 = cute.get_stride(%lay_3695) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3700, %e1_3701, %e2_3702, %e3_3703 = cute.get_leaves(%1034) : !cute.stride<"((2,4),(1,8))">
      %1035 = scf.if %1032 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1016) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,14)">
        cute.memref.store(%1016, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,14)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1016) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1016 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1016) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1016) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1016 : !memref_rmem_f32_4
      }
      %iter_3704 = cute.get_iter(%1035) : !memref_rmem_f32_4
      %lay_3705 = cute.get_layout(%1035) : !memref_rmem_f32_4
      %1036 = cute.get_shape(%lay_3705) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3706, %e1_3707, %e2_3708, %e3_3709 = cute.get_leaves(%1036) : !cute.shape<"((2,2),(2,8))">
      %1037 = cute.get_stride(%lay_3705) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3710, %e1_3711, %e2_3712, %e3_3713 = cute.get_leaves(%1037) : !cute.stride<"((2,4),(1,8))">
      %iter_3714 = cute.get_iter(%1035) : !memref_rmem_f32_4
      %iter_3715 = cute.get_iter(%1035) : !memref_rmem_f32_4
      %coord_3716 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_3717 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3718 = cute.crd2idx(%coord_3716, %lay_3717) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_3719 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3720 = cute.add_offset(%iter_3719, %idx_3718) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3721 = cute.make_view(%tup_3720) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3722 = cute.get_iter(%view_3721) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3723, %e1_3724, %e2_3725, %e3_3726 = cute.get_leaves(%iter_3722) : !cute.int_tuple<"(?,?,?,?)">
      %1038 = cute.get_scalars(%e0_3723) : !cute.int_tuple<"?">
      %1039 = cute.get_scalars(%e1_3724) : !cute.int_tuple<"?">
      %1040 = cute.get_scalars(%e2_3725) : !cute.int_tuple<"?">
      %1041 = cute.get_scalars(%e3_3726) : !cute.int_tuple<"?">
      %iter_3727 = cute.get_iter(%view_3721) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3728, %e1_3729, %e2_3730, %e3_3731 = cute.get_leaves(%iter_3727) : !cute.int_tuple<"(?,?,?,?)">
      %1042 = cute.get_scalars(%e0_3728) : !cute.int_tuple<"?">
      %1043 = cute.get_scalars(%e1_3729) : !cute.int_tuple<"?">
      %1044 = cute.get_scalars(%e2_3730) : !cute.int_tuple<"?">
      %1045 = cute.get_scalars(%e3_3731) : !cute.int_tuple<"?">
      %iter_3732 = cute.get_iter(%view_3721) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3733, %e1_3734, %e2_3735, %e3_3736 = cute.get_leaves(%iter_3732) : !cute.int_tuple<"(?,?,?,?)">
      %1046 = cute.get_scalars(%e0_3733) : !cute.int_tuple<"?">
      %1047 = cute.get_scalars(%e1_3734) : !cute.int_tuple<"?">
      %1048 = cute.get_scalars(%e2_3735) : !cute.int_tuple<"?">
      %1049 = cute.get_scalars(%e3_3736) : !cute.int_tuple<"?">
      %int_tuple_3737 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3738 = cute.add_offset(%e3_3736, %int_tuple_3737) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1050 = cute.get_scalars(%tup_3738) : !cute.int_tuple<"?">
      %coord_3739 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3740 = cute.make_coord(%tup_3738) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1051 = cute.elem_less(%coord_3739, %coord_3740) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3741 = cute.get_layout(%1035) : !memref_rmem_f32_4
      %1052 = cute.get_shape(%lay_3741) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3742, %e1_3743, %e2_3744, %e3_3745 = cute.get_leaves(%1052) : !cute.shape<"((2,2),(2,8))">
      %1053 = cute.get_stride(%lay_3741) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3746, %e1_3747, %e2_3748, %e3_3749 = cute.get_leaves(%1053) : !cute.stride<"((2,4),(1,8))">
      %1054 = scf.if %1051 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1035) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(0,15)">
        cute.memref.store(%1035, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(0,15)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1035) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1035 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1035) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1035) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1035 : !memref_rmem_f32_4
      }
      %iter_3750 = cute.get_iter(%1054) : !memref_rmem_f32_4
      %lay_3751 = cute.get_layout(%1054) : !memref_rmem_f32_4
      %1055 = cute.get_shape(%lay_3751) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3752, %e1_3753, %e2_3754, %e3_3755 = cute.get_leaves(%1055) : !cute.shape<"((2,2),(2,8))">
      %1056 = cute.get_stride(%lay_3751) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3756, %e1_3757, %e2_3758, %e3_3759 = cute.get_leaves(%1056) : !cute.stride<"((2,4),(1,8))">
      %iter_3760 = cute.get_iter(%1054) : !memref_rmem_f32_4
      %iter_3761 = cute.get_iter(%1054) : !memref_rmem_f32_4
      %coord_3762 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_3763 = cute.get_layout(%1054) : !memref_rmem_f32_4
      %idx_3764 = cute.crd2idx(%coord_3762, %lay_3763) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_3765 = cute.get_iter(%1054) : !memref_rmem_f32_4
      %ptr_3766 = cute.add_offset(%iter_3765, %idx_3764) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_3767 = cute.make_view(%ptr_3766) : !memref_rmem_f32_6
      %iter_3768 = cute.get_iter(%view_3767) : !memref_rmem_f32_6
      %lay_3769 = cute.get_layout(%view_3767) : !memref_rmem_f32_6
      %1057 = cute.get_shape(%lay_3769) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3770, %e1_3771 = cute.get_leaves(%1057) : !cute.shape<"((2,8))">
      %1058 = cute.memref.load_vec %view_3767, row_major : !memref_rmem_f32_6
      %cst_3772 = arith.constant 0xFF800000 : f32
      %1059 = vector.reduction <maximumf>, %1058, %cst_3772 : vector<16xf32> into f32
      %c-1_i32 = arith.constant -1 : i32
      %c2_i32 = arith.constant 2 : i32
      %c31_i32 = arith.constant 31 : i32
      %1060 = nvvm.shfl.sync  bfly %c-1_i32, %1059, %c2_i32, %c31_i32 : f32 -> f32
      %1061 = nvvm.fmax %1059, %1060
      %c-1_i32_3773 = arith.constant -1 : i32
      %c1_i32_3774 = arith.constant 1 : i32
      %c31_i32_3775 = arith.constant 31 : i32
      %1062 = nvvm.shfl.sync  bfly %c-1_i32_3773, %1061, %c1_i32_3774, %c31_i32_3775 : f32 -> f32
      %1063 = nvvm.fmax %1061, %1062
      %1064 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1065 = arith.mulf %1058, %1064 : vector<16xf32>
      %1066 = arith.mulf %1063, %arg4 : f32
      %1067 = vector.broadcast %1066 : f32 to vector<16xf32>
      %1068 = arith.subf %1065, %1067 : vector<16xf32>
      %1069 = math.exp2 %1068 fastmath<fast> : vector<16xf32>
      %cst_3776 = arith.constant 0.000000e+00 : f32
      %1070 = vector.reduction <add>, %1069, %cst_3776 : vector<16xf32> into f32
      %coord_3777 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1062, %coord_3777, %1063) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_3778 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1067, %coord_3778, %1070) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_3779 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_3780 = cute.get_layout(%1054) : !memref_rmem_f32_4
      %idx_3781 = cute.crd2idx(%coord_3779, %lay_3780) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_3782 = cute.get_iter(%1054) : !memref_rmem_f32_4
      %ptr_3783 = cute.add_offset(%iter_3782, %idx_3781) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_3784 = cute.make_view(%ptr_3783) : !memref_rmem_f32_6
      %iter_3785 = cute.get_iter(%view_3784) : !memref_rmem_f32_6
      %lay_3786 = cute.get_layout(%view_3784) : !memref_rmem_f32_6
      %1071 = cute.get_shape(%lay_3786) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_3787, %e1_3788 = cute.get_leaves(%1071) : !cute.shape<"((2,8))">
      %int_tuple_3789 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3790 = cute.size(%int_tuple_3789) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3791 = cute.get_leaves(%sz_3790) : !cute.int_tuple<"16">
      %int_tuple_3792 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_3793 = cute.size(%int_tuple_3792) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_3794 = cute.get_leaves(%sz_3793) : !cute.int_tuple<"16">
      cute.memref.store_vec %1069, %view_3784, row_major : !memref_rmem_f32_6
      %int_tuple_3795 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_3796 = cute.size(%int_tuple_3795) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_3797 = cute.get_leaves(%sz_3796) : !cute.int_tuple<"16">
      %coord_3798 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_3799 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3800 = cute.crd2idx(%coord_3798, %lay_3799) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_3801 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3802 = cute.add_offset(%iter_3801, %idx_3800) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3803 = cute.make_view(%tup_3802) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3804 = cute.get_iter(%view_3803) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3805, %e1_3806, %e2_3807, %e3_3808 = cute.get_leaves(%iter_3804) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1072 = cute.get_scalars(%e0_3805) : !cute.int_tuple<"?">
      %1073 = cute.get_scalars(%e1_3806) : !cute.int_tuple<"?">
      %1074 = cute.get_scalars(%e2_3807) : !cute.int_tuple<"?">
      %1075 = cute.get_scalars(%e3_3808) : !cute.int_tuple<"?{div=2}">
      %iter_3809 = cute.get_iter(%view_3803) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3810, %e1_3811, %e2_3812, %e3_3813 = cute.get_leaves(%iter_3809) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1076 = cute.get_scalars(%e0_3810) : !cute.int_tuple<"?">
      %1077 = cute.get_scalars(%e1_3811) : !cute.int_tuple<"?">
      %1078 = cute.get_scalars(%e2_3812) : !cute.int_tuple<"?">
      %1079 = cute.get_scalars(%e3_3813) : !cute.int_tuple<"?{div=2}">
      %iter_3814 = cute.get_iter(%view_3803) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3815, %e1_3816, %e2_3817, %e3_3818 = cute.get_leaves(%iter_3814) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1080 = cute.get_scalars(%e0_3815) : !cute.int_tuple<"?">
      %1081 = cute.get_scalars(%e1_3816) : !cute.int_tuple<"?">
      %1082 = cute.get_scalars(%e2_3817) : !cute.int_tuple<"?">
      %1083 = cute.get_scalars(%e3_3818) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3819 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3820 = cute.add_offset(%e3_3818, %int_tuple_3819) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1084 = cute.get_scalars(%tup_3820) : !cute.int_tuple<"?">
      %coord_3821 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3822 = cute.make_coord(%tup_3820) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1085 = cute.elem_less(%coord_3821, %coord_3822) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3823 = cute.get_layout(%1054) : !memref_rmem_f32_4
      %1086 = cute.get_shape(%lay_3823) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3824, %e1_3825, %e2_3826, %e3_3827 = cute.get_leaves(%1086) : !cute.shape<"((2,2),(2,8))">
      %1087 = cute.get_stride(%lay_3823) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3828, %e1_3829, %e2_3830, %e3_3831 = cute.get_leaves(%1087) : !cute.stride<"((2,4),(1,8))">
      %1088 = scf.if %1085 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1054) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,0)">
        cute.memref.store(%1054, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,0)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1054) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1054 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1054) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1054) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1054 : !memref_rmem_f32_4
      }
      %iter_3832 = cute.get_iter(%1088) : !memref_rmem_f32_4
      %lay_3833 = cute.get_layout(%1088) : !memref_rmem_f32_4
      %1089 = cute.get_shape(%lay_3833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3834, %e1_3835, %e2_3836, %e3_3837 = cute.get_leaves(%1089) : !cute.shape<"((2,2),(2,8))">
      %1090 = cute.get_stride(%lay_3833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3838, %e1_3839, %e2_3840, %e3_3841 = cute.get_leaves(%1090) : !cute.stride<"((2,4),(1,8))">
      %iter_3842 = cute.get_iter(%1088) : !memref_rmem_f32_4
      %iter_3843 = cute.get_iter(%1088) : !memref_rmem_f32_4
      %coord_3844 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_3845 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3846 = cute.crd2idx(%coord_3844, %lay_3845) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_3847 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3848 = cute.add_offset(%iter_3847, %idx_3846) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3849 = cute.make_view(%tup_3848) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3850 = cute.get_iter(%view_3849) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3851, %e1_3852, %e2_3853, %e3_3854 = cute.get_leaves(%iter_3850) : !cute.int_tuple<"(?,?,?,?)">
      %1091 = cute.get_scalars(%e0_3851) : !cute.int_tuple<"?">
      %1092 = cute.get_scalars(%e1_3852) : !cute.int_tuple<"?">
      %1093 = cute.get_scalars(%e2_3853) : !cute.int_tuple<"?">
      %1094 = cute.get_scalars(%e3_3854) : !cute.int_tuple<"?">
      %iter_3855 = cute.get_iter(%view_3849) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3856, %e1_3857, %e2_3858, %e3_3859 = cute.get_leaves(%iter_3855) : !cute.int_tuple<"(?,?,?,?)">
      %1095 = cute.get_scalars(%e0_3856) : !cute.int_tuple<"?">
      %1096 = cute.get_scalars(%e1_3857) : !cute.int_tuple<"?">
      %1097 = cute.get_scalars(%e2_3858) : !cute.int_tuple<"?">
      %1098 = cute.get_scalars(%e3_3859) : !cute.int_tuple<"?">
      %iter_3860 = cute.get_iter(%view_3849) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3861, %e1_3862, %e2_3863, %e3_3864 = cute.get_leaves(%iter_3860) : !cute.int_tuple<"(?,?,?,?)">
      %1099 = cute.get_scalars(%e0_3861) : !cute.int_tuple<"?">
      %1100 = cute.get_scalars(%e1_3862) : !cute.int_tuple<"?">
      %1101 = cute.get_scalars(%e2_3863) : !cute.int_tuple<"?">
      %1102 = cute.get_scalars(%e3_3864) : !cute.int_tuple<"?">
      %int_tuple_3865 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3866 = cute.add_offset(%e3_3864, %int_tuple_3865) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1103 = cute.get_scalars(%tup_3866) : !cute.int_tuple<"?">
      %coord_3867 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3868 = cute.make_coord(%tup_3866) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1104 = cute.elem_less(%coord_3867, %coord_3868) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3869 = cute.get_layout(%1088) : !memref_rmem_f32_4
      %1105 = cute.get_shape(%lay_3869) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3870, %e1_3871, %e2_3872, %e3_3873 = cute.get_leaves(%1105) : !cute.shape<"((2,2),(2,8))">
      %1106 = cute.get_stride(%lay_3869) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3874, %e1_3875, %e2_3876, %e3_3877 = cute.get_leaves(%1106) : !cute.stride<"((2,4),(1,8))">
      %1107 = scf.if %1104 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1088) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,1)">
        cute.memref.store(%1088, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,1)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1088) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1088 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1088) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1088) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1088 : !memref_rmem_f32_4
      }
      %iter_3878 = cute.get_iter(%1107) : !memref_rmem_f32_4
      %lay_3879 = cute.get_layout(%1107) : !memref_rmem_f32_4
      %1108 = cute.get_shape(%lay_3879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3880, %e1_3881, %e2_3882, %e3_3883 = cute.get_leaves(%1108) : !cute.shape<"((2,2),(2,8))">
      %1109 = cute.get_stride(%lay_3879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3884, %e1_3885, %e2_3886, %e3_3887 = cute.get_leaves(%1109) : !cute.stride<"((2,4),(1,8))">
      %iter_3888 = cute.get_iter(%1107) : !memref_rmem_f32_4
      %iter_3889 = cute.get_iter(%1107) : !memref_rmem_f32_4
      %coord_3890 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_3891 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3892 = cute.crd2idx(%coord_3890, %lay_3891) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_3893 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3894 = cute.add_offset(%iter_3893, %idx_3892) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3895 = cute.make_view(%tup_3894) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3896 = cute.get_iter(%view_3895) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3897, %e1_3898, %e2_3899, %e3_3900 = cute.get_leaves(%iter_3896) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1110 = cute.get_scalars(%e0_3897) : !cute.int_tuple<"?">
      %1111 = cute.get_scalars(%e1_3898) : !cute.int_tuple<"?">
      %1112 = cute.get_scalars(%e2_3899) : !cute.int_tuple<"?">
      %1113 = cute.get_scalars(%e3_3900) : !cute.int_tuple<"?{div=2}">
      %iter_3901 = cute.get_iter(%view_3895) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3902, %e1_3903, %e2_3904, %e3_3905 = cute.get_leaves(%iter_3901) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1114 = cute.get_scalars(%e0_3902) : !cute.int_tuple<"?">
      %1115 = cute.get_scalars(%e1_3903) : !cute.int_tuple<"?">
      %1116 = cute.get_scalars(%e2_3904) : !cute.int_tuple<"?">
      %1117 = cute.get_scalars(%e3_3905) : !cute.int_tuple<"?{div=2}">
      %iter_3906 = cute.get_iter(%view_3895) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3907, %e1_3908, %e2_3909, %e3_3910 = cute.get_leaves(%iter_3906) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1118 = cute.get_scalars(%e0_3907) : !cute.int_tuple<"?">
      %1119 = cute.get_scalars(%e1_3908) : !cute.int_tuple<"?">
      %1120 = cute.get_scalars(%e2_3909) : !cute.int_tuple<"?">
      %1121 = cute.get_scalars(%e3_3910) : !cute.int_tuple<"?{div=2}">
      %int_tuple_3911 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3912 = cute.add_offset(%e3_3910, %int_tuple_3911) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1122 = cute.get_scalars(%tup_3912) : !cute.int_tuple<"?">
      %coord_3913 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3914 = cute.make_coord(%tup_3912) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1123 = cute.elem_less(%coord_3913, %coord_3914) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3915 = cute.get_layout(%1107) : !memref_rmem_f32_4
      %1124 = cute.get_shape(%lay_3915) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3916, %e1_3917, %e2_3918, %e3_3919 = cute.get_leaves(%1124) : !cute.shape<"((2,2),(2,8))">
      %1125 = cute.get_stride(%lay_3915) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3920, %e1_3921, %e2_3922, %e3_3923 = cute.get_leaves(%1125) : !cute.stride<"((2,4),(1,8))">
      %1126 = scf.if %1123 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1107) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,2)">
        cute.memref.store(%1107, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,2)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1107) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1107 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1107) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1107) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1107 : !memref_rmem_f32_4
      }
      %iter_3924 = cute.get_iter(%1126) : !memref_rmem_f32_4
      %lay_3925 = cute.get_layout(%1126) : !memref_rmem_f32_4
      %1127 = cute.get_shape(%lay_3925) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3926, %e1_3927, %e2_3928, %e3_3929 = cute.get_leaves(%1127) : !cute.shape<"((2,2),(2,8))">
      %1128 = cute.get_stride(%lay_3925) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3930, %e1_3931, %e2_3932, %e3_3933 = cute.get_leaves(%1128) : !cute.stride<"((2,4),(1,8))">
      %iter_3934 = cute.get_iter(%1126) : !memref_rmem_f32_4
      %iter_3935 = cute.get_iter(%1126) : !memref_rmem_f32_4
      %coord_3936 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_3937 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3938 = cute.crd2idx(%coord_3936, %lay_3937) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_3939 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3940 = cute.add_offset(%iter_3939, %idx_3938) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_3941 = cute.make_view(%tup_3940) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_3942 = cute.get_iter(%view_3941) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3943, %e1_3944, %e2_3945, %e3_3946 = cute.get_leaves(%iter_3942) : !cute.int_tuple<"(?,?,?,?)">
      %1129 = cute.get_scalars(%e0_3943) : !cute.int_tuple<"?">
      %1130 = cute.get_scalars(%e1_3944) : !cute.int_tuple<"?">
      %1131 = cute.get_scalars(%e2_3945) : !cute.int_tuple<"?">
      %1132 = cute.get_scalars(%e3_3946) : !cute.int_tuple<"?">
      %iter_3947 = cute.get_iter(%view_3941) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3948, %e1_3949, %e2_3950, %e3_3951 = cute.get_leaves(%iter_3947) : !cute.int_tuple<"(?,?,?,?)">
      %1133 = cute.get_scalars(%e0_3948) : !cute.int_tuple<"?">
      %1134 = cute.get_scalars(%e1_3949) : !cute.int_tuple<"?">
      %1135 = cute.get_scalars(%e2_3950) : !cute.int_tuple<"?">
      %1136 = cute.get_scalars(%e3_3951) : !cute.int_tuple<"?">
      %iter_3952 = cute.get_iter(%view_3941) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_3953, %e1_3954, %e2_3955, %e3_3956 = cute.get_leaves(%iter_3952) : !cute.int_tuple<"(?,?,?,?)">
      %1137 = cute.get_scalars(%e0_3953) : !cute.int_tuple<"?">
      %1138 = cute.get_scalars(%e1_3954) : !cute.int_tuple<"?">
      %1139 = cute.get_scalars(%e2_3955) : !cute.int_tuple<"?">
      %1140 = cute.get_scalars(%e3_3956) : !cute.int_tuple<"?">
      %int_tuple_3957 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_3958 = cute.add_offset(%e3_3956, %int_tuple_3957) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1141 = cute.get_scalars(%tup_3958) : !cute.int_tuple<"?">
      %coord_3959 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_3960 = cute.make_coord(%tup_3958) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1142 = cute.elem_less(%coord_3959, %coord_3960) : !cute.coord<"?">, !cute.coord<"?">
      %lay_3961 = cute.get_layout(%1126) : !memref_rmem_f32_4
      %1143 = cute.get_shape(%lay_3961) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3962, %e1_3963, %e2_3964, %e3_3965 = cute.get_leaves(%1143) : !cute.shape<"((2,2),(2,8))">
      %1144 = cute.get_stride(%lay_3961) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3966, %e1_3967, %e2_3968, %e3_3969 = cute.get_leaves(%1144) : !cute.stride<"((2,4),(1,8))">
      %1145 = scf.if %1142 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1126) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,3)">
        cute.memref.store(%1126, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,3)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1126) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1126 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1126) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1126) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1126 : !memref_rmem_f32_4
      }
      %iter_3970 = cute.get_iter(%1145) : !memref_rmem_f32_4
      %lay_3971 = cute.get_layout(%1145) : !memref_rmem_f32_4
      %1146 = cute.get_shape(%lay_3971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_3972, %e1_3973, %e2_3974, %e3_3975 = cute.get_leaves(%1146) : !cute.shape<"((2,2),(2,8))">
      %1147 = cute.get_stride(%lay_3971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_3976, %e1_3977, %e2_3978, %e3_3979 = cute.get_leaves(%1147) : !cute.stride<"((2,4),(1,8))">
      %iter_3980 = cute.get_iter(%1145) : !memref_rmem_f32_4
      %iter_3981 = cute.get_iter(%1145) : !memref_rmem_f32_4
      %coord_3982 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_3983 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_3984 = cute.crd2idx(%coord_3982, %lay_3983) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_3985 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_3986 = cute.add_offset(%iter_3985, %idx_3984) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_3987 = cute.make_view(%tup_3986) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_3988 = cute.get_iter(%view_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3989, %e1_3990, %e2_3991, %e3_3992 = cute.get_leaves(%iter_3988) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1148 = cute.get_scalars(%e0_3989) : !cute.int_tuple<"?">
      %1149 = cute.get_scalars(%e1_3990) : !cute.int_tuple<"?">
      %1150 = cute.get_scalars(%e2_3991) : !cute.int_tuple<"?">
      %1151 = cute.get_scalars(%e3_3992) : !cute.int_tuple<"?{div=2}">
      %iter_3993 = cute.get_iter(%view_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3994, %e1_3995, %e2_3996, %e3_3997 = cute.get_leaves(%iter_3993) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1152 = cute.get_scalars(%e0_3994) : !cute.int_tuple<"?">
      %1153 = cute.get_scalars(%e1_3995) : !cute.int_tuple<"?">
      %1154 = cute.get_scalars(%e2_3996) : !cute.int_tuple<"?">
      %1155 = cute.get_scalars(%e3_3997) : !cute.int_tuple<"?{div=2}">
      %iter_3998 = cute.get_iter(%view_3987) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_3999, %e1_4000, %e2_4001, %e3_4002 = cute.get_leaves(%iter_3998) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1156 = cute.get_scalars(%e0_3999) : !cute.int_tuple<"?">
      %1157 = cute.get_scalars(%e1_4000) : !cute.int_tuple<"?">
      %1158 = cute.get_scalars(%e2_4001) : !cute.int_tuple<"?">
      %1159 = cute.get_scalars(%e3_4002) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4003 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4004 = cute.add_offset(%e3_4002, %int_tuple_4003) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1160 = cute.get_scalars(%tup_4004) : !cute.int_tuple<"?">
      %coord_4005 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4006 = cute.make_coord(%tup_4004) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1161 = cute.elem_less(%coord_4005, %coord_4006) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4007 = cute.get_layout(%1145) : !memref_rmem_f32_4
      %1162 = cute.get_shape(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4008, %e1_4009, %e2_4010, %e3_4011 = cute.get_leaves(%1162) : !cute.shape<"((2,2),(2,8))">
      %1163 = cute.get_stride(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4012, %e1_4013, %e2_4014, %e3_4015 = cute.get_leaves(%1163) : !cute.stride<"((2,4),(1,8))">
      %1164 = scf.if %1161 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1145) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,4)">
        cute.memref.store(%1145, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,4)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1145) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1145 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1145) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1145) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1145 : !memref_rmem_f32_4
      }
      %iter_4016 = cute.get_iter(%1164) : !memref_rmem_f32_4
      %lay_4017 = cute.get_layout(%1164) : !memref_rmem_f32_4
      %1165 = cute.get_shape(%lay_4017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4018, %e1_4019, %e2_4020, %e3_4021 = cute.get_leaves(%1165) : !cute.shape<"((2,2),(2,8))">
      %1166 = cute.get_stride(%lay_4017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4022, %e1_4023, %e2_4024, %e3_4025 = cute.get_leaves(%1166) : !cute.stride<"((2,4),(1,8))">
      %iter_4026 = cute.get_iter(%1164) : !memref_rmem_f32_4
      %iter_4027 = cute.get_iter(%1164) : !memref_rmem_f32_4
      %coord_4028 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4029 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4030 = cute.crd2idx(%coord_4028, %lay_4029) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4031 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4032 = cute.add_offset(%iter_4031, %idx_4030) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4033 = cute.make_view(%tup_4032) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4034 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4035, %e1_4036, %e2_4037, %e3_4038 = cute.get_leaves(%iter_4034) : !cute.int_tuple<"(?,?,?,?)">
      %1167 = cute.get_scalars(%e0_4035) : !cute.int_tuple<"?">
      %1168 = cute.get_scalars(%e1_4036) : !cute.int_tuple<"?">
      %1169 = cute.get_scalars(%e2_4037) : !cute.int_tuple<"?">
      %1170 = cute.get_scalars(%e3_4038) : !cute.int_tuple<"?">
      %iter_4039 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4040, %e1_4041, %e2_4042, %e3_4043 = cute.get_leaves(%iter_4039) : !cute.int_tuple<"(?,?,?,?)">
      %1171 = cute.get_scalars(%e0_4040) : !cute.int_tuple<"?">
      %1172 = cute.get_scalars(%e1_4041) : !cute.int_tuple<"?">
      %1173 = cute.get_scalars(%e2_4042) : !cute.int_tuple<"?">
      %1174 = cute.get_scalars(%e3_4043) : !cute.int_tuple<"?">
      %iter_4044 = cute.get_iter(%view_4033) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4045, %e1_4046, %e2_4047, %e3_4048 = cute.get_leaves(%iter_4044) : !cute.int_tuple<"(?,?,?,?)">
      %1175 = cute.get_scalars(%e0_4045) : !cute.int_tuple<"?">
      %1176 = cute.get_scalars(%e1_4046) : !cute.int_tuple<"?">
      %1177 = cute.get_scalars(%e2_4047) : !cute.int_tuple<"?">
      %1178 = cute.get_scalars(%e3_4048) : !cute.int_tuple<"?">
      %int_tuple_4049 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4050 = cute.add_offset(%e3_4048, %int_tuple_4049) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1179 = cute.get_scalars(%tup_4050) : !cute.int_tuple<"?">
      %coord_4051 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4052 = cute.make_coord(%tup_4050) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1180 = cute.elem_less(%coord_4051, %coord_4052) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4053 = cute.get_layout(%1164) : !memref_rmem_f32_4
      %1181 = cute.get_shape(%lay_4053) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4054, %e1_4055, %e2_4056, %e3_4057 = cute.get_leaves(%1181) : !cute.shape<"((2,2),(2,8))">
      %1182 = cute.get_stride(%lay_4053) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4058, %e1_4059, %e2_4060, %e3_4061 = cute.get_leaves(%1182) : !cute.stride<"((2,4),(1,8))">
      %1183 = scf.if %1180 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1164) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,5)">
        cute.memref.store(%1164, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,5)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1164) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1164 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1164) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1164) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1164 : !memref_rmem_f32_4
      }
      %iter_4062 = cute.get_iter(%1183) : !memref_rmem_f32_4
      %lay_4063 = cute.get_layout(%1183) : !memref_rmem_f32_4
      %1184 = cute.get_shape(%lay_4063) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4064, %e1_4065, %e2_4066, %e3_4067 = cute.get_leaves(%1184) : !cute.shape<"((2,2),(2,8))">
      %1185 = cute.get_stride(%lay_4063) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4068, %e1_4069, %e2_4070, %e3_4071 = cute.get_leaves(%1185) : !cute.stride<"((2,4),(1,8))">
      %iter_4072 = cute.get_iter(%1183) : !memref_rmem_f32_4
      %iter_4073 = cute.get_iter(%1183) : !memref_rmem_f32_4
      %coord_4074 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4075 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4076 = cute.crd2idx(%coord_4074, %lay_4075) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4077 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4078 = cute.add_offset(%iter_4077, %idx_4076) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4079 = cute.make_view(%tup_4078) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4080 = cute.get_iter(%view_4079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4081, %e1_4082, %e2_4083, %e3_4084 = cute.get_leaves(%iter_4080) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1186 = cute.get_scalars(%e0_4081) : !cute.int_tuple<"?">
      %1187 = cute.get_scalars(%e1_4082) : !cute.int_tuple<"?">
      %1188 = cute.get_scalars(%e2_4083) : !cute.int_tuple<"?">
      %1189 = cute.get_scalars(%e3_4084) : !cute.int_tuple<"?{div=2}">
      %iter_4085 = cute.get_iter(%view_4079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%iter_4085) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1190 = cute.get_scalars(%e0_4086) : !cute.int_tuple<"?">
      %1191 = cute.get_scalars(%e1_4087) : !cute.int_tuple<"?">
      %1192 = cute.get_scalars(%e2_4088) : !cute.int_tuple<"?">
      %1193 = cute.get_scalars(%e3_4089) : !cute.int_tuple<"?{div=2}">
      %iter_4090 = cute.get_iter(%view_4079) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4091, %e1_4092, %e2_4093, %e3_4094 = cute.get_leaves(%iter_4090) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1194 = cute.get_scalars(%e0_4091) : !cute.int_tuple<"?">
      %1195 = cute.get_scalars(%e1_4092) : !cute.int_tuple<"?">
      %1196 = cute.get_scalars(%e2_4093) : !cute.int_tuple<"?">
      %1197 = cute.get_scalars(%e3_4094) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4095 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4096 = cute.add_offset(%e3_4094, %int_tuple_4095) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1198 = cute.get_scalars(%tup_4096) : !cute.int_tuple<"?">
      %coord_4097 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4098 = cute.make_coord(%tup_4096) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1199 = cute.elem_less(%coord_4097, %coord_4098) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4099 = cute.get_layout(%1183) : !memref_rmem_f32_4
      %1200 = cute.get_shape(%lay_4099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4100, %e1_4101, %e2_4102, %e3_4103 = cute.get_leaves(%1200) : !cute.shape<"((2,2),(2,8))">
      %1201 = cute.get_stride(%lay_4099) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4104, %e1_4105, %e2_4106, %e3_4107 = cute.get_leaves(%1201) : !cute.stride<"((2,4),(1,8))">
      %1202 = scf.if %1199 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1183) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,6)">
        cute.memref.store(%1183, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,6)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1183) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1183 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1183) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1183) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1183 : !memref_rmem_f32_4
      }
      %iter_4108 = cute.get_iter(%1202) : !memref_rmem_f32_4
      %lay_4109 = cute.get_layout(%1202) : !memref_rmem_f32_4
      %1203 = cute.get_shape(%lay_4109) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4110, %e1_4111, %e2_4112, %e3_4113 = cute.get_leaves(%1203) : !cute.shape<"((2,2),(2,8))">
      %1204 = cute.get_stride(%lay_4109) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4114, %e1_4115, %e2_4116, %e3_4117 = cute.get_leaves(%1204) : !cute.stride<"((2,4),(1,8))">
      %iter_4118 = cute.get_iter(%1202) : !memref_rmem_f32_4
      %iter_4119 = cute.get_iter(%1202) : !memref_rmem_f32_4
      %coord_4120 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4121 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4122 = cute.crd2idx(%coord_4120, %lay_4121) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4123 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4124 = cute.add_offset(%iter_4123, %idx_4122) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4125 = cute.make_view(%tup_4124) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4126 = cute.get_iter(%view_4125) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4127, %e1_4128, %e2_4129, %e3_4130 = cute.get_leaves(%iter_4126) : !cute.int_tuple<"(?,?,?,?)">
      %1205 = cute.get_scalars(%e0_4127) : !cute.int_tuple<"?">
      %1206 = cute.get_scalars(%e1_4128) : !cute.int_tuple<"?">
      %1207 = cute.get_scalars(%e2_4129) : !cute.int_tuple<"?">
      %1208 = cute.get_scalars(%e3_4130) : !cute.int_tuple<"?">
      %iter_4131 = cute.get_iter(%view_4125) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4132, %e1_4133, %e2_4134, %e3_4135 = cute.get_leaves(%iter_4131) : !cute.int_tuple<"(?,?,?,?)">
      %1209 = cute.get_scalars(%e0_4132) : !cute.int_tuple<"?">
      %1210 = cute.get_scalars(%e1_4133) : !cute.int_tuple<"?">
      %1211 = cute.get_scalars(%e2_4134) : !cute.int_tuple<"?">
      %1212 = cute.get_scalars(%e3_4135) : !cute.int_tuple<"?">
      %iter_4136 = cute.get_iter(%view_4125) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4137, %e1_4138, %e2_4139, %e3_4140 = cute.get_leaves(%iter_4136) : !cute.int_tuple<"(?,?,?,?)">
      %1213 = cute.get_scalars(%e0_4137) : !cute.int_tuple<"?">
      %1214 = cute.get_scalars(%e1_4138) : !cute.int_tuple<"?">
      %1215 = cute.get_scalars(%e2_4139) : !cute.int_tuple<"?">
      %1216 = cute.get_scalars(%e3_4140) : !cute.int_tuple<"?">
      %int_tuple_4141 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4142 = cute.add_offset(%e3_4140, %int_tuple_4141) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1217 = cute.get_scalars(%tup_4142) : !cute.int_tuple<"?">
      %coord_4143 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4144 = cute.make_coord(%tup_4142) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1218 = cute.elem_less(%coord_4143, %coord_4144) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4145 = cute.get_layout(%1202) : !memref_rmem_f32_4
      %1219 = cute.get_shape(%lay_4145) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4146, %e1_4147, %e2_4148, %e3_4149 = cute.get_leaves(%1219) : !cute.shape<"((2,2),(2,8))">
      %1220 = cute.get_stride(%lay_4145) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4150, %e1_4151, %e2_4152, %e3_4153 = cute.get_leaves(%1220) : !cute.stride<"((2,4),(1,8))">
      %1221 = scf.if %1218 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1202) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,7)">
        cute.memref.store(%1202, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,7)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1202) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1202 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1202) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1202) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1202 : !memref_rmem_f32_4
      }
      %iter_4154 = cute.get_iter(%1221) : !memref_rmem_f32_4
      %lay_4155 = cute.get_layout(%1221) : !memref_rmem_f32_4
      %1222 = cute.get_shape(%lay_4155) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4156, %e1_4157, %e2_4158, %e3_4159 = cute.get_leaves(%1222) : !cute.shape<"((2,2),(2,8))">
      %1223 = cute.get_stride(%lay_4155) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4160, %e1_4161, %e2_4162, %e3_4163 = cute.get_leaves(%1223) : !cute.stride<"((2,4),(1,8))">
      %iter_4164 = cute.get_iter(%1221) : !memref_rmem_f32_4
      %iter_4165 = cute.get_iter(%1221) : !memref_rmem_f32_4
      %coord_4166 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4167 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4168 = cute.crd2idx(%coord_4166, %lay_4167) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4169 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4170 = cute.add_offset(%iter_4169, %idx_4168) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4171 = cute.make_view(%tup_4170) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4172 = cute.get_iter(%view_4171) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4173, %e1_4174, %e2_4175, %e3_4176 = cute.get_leaves(%iter_4172) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1224 = cute.get_scalars(%e0_4173) : !cute.int_tuple<"?">
      %1225 = cute.get_scalars(%e1_4174) : !cute.int_tuple<"?">
      %1226 = cute.get_scalars(%e2_4175) : !cute.int_tuple<"?">
      %1227 = cute.get_scalars(%e3_4176) : !cute.int_tuple<"?{div=2}">
      %iter_4177 = cute.get_iter(%view_4171) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4178, %e1_4179, %e2_4180, %e3_4181 = cute.get_leaves(%iter_4177) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1228 = cute.get_scalars(%e0_4178) : !cute.int_tuple<"?">
      %1229 = cute.get_scalars(%e1_4179) : !cute.int_tuple<"?">
      %1230 = cute.get_scalars(%e2_4180) : !cute.int_tuple<"?">
      %1231 = cute.get_scalars(%e3_4181) : !cute.int_tuple<"?{div=2}">
      %iter_4182 = cute.get_iter(%view_4171) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4183, %e1_4184, %e2_4185, %e3_4186 = cute.get_leaves(%iter_4182) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1232 = cute.get_scalars(%e0_4183) : !cute.int_tuple<"?">
      %1233 = cute.get_scalars(%e1_4184) : !cute.int_tuple<"?">
      %1234 = cute.get_scalars(%e2_4185) : !cute.int_tuple<"?">
      %1235 = cute.get_scalars(%e3_4186) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4187 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4188 = cute.add_offset(%e3_4186, %int_tuple_4187) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1236 = cute.get_scalars(%tup_4188) : !cute.int_tuple<"?">
      %coord_4189 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4190 = cute.make_coord(%tup_4188) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1237 = cute.elem_less(%coord_4189, %coord_4190) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4191 = cute.get_layout(%1221) : !memref_rmem_f32_4
      %1238 = cute.get_shape(%lay_4191) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4192, %e1_4193, %e2_4194, %e3_4195 = cute.get_leaves(%1238) : !cute.shape<"((2,2),(2,8))">
      %1239 = cute.get_stride(%lay_4191) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4196, %e1_4197, %e2_4198, %e3_4199 = cute.get_leaves(%1239) : !cute.stride<"((2,4),(1,8))">
      %1240 = scf.if %1237 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1221) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,8)">
        cute.memref.store(%1221, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,8)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1221) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1221 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1221) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1221) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1221 : !memref_rmem_f32_4
      }
      %iter_4200 = cute.get_iter(%1240) : !memref_rmem_f32_4
      %lay_4201 = cute.get_layout(%1240) : !memref_rmem_f32_4
      %1241 = cute.get_shape(%lay_4201) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4202, %e1_4203, %e2_4204, %e3_4205 = cute.get_leaves(%1241) : !cute.shape<"((2,2),(2,8))">
      %1242 = cute.get_stride(%lay_4201) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4206, %e1_4207, %e2_4208, %e3_4209 = cute.get_leaves(%1242) : !cute.stride<"((2,4),(1,8))">
      %iter_4210 = cute.get_iter(%1240) : !memref_rmem_f32_4
      %iter_4211 = cute.get_iter(%1240) : !memref_rmem_f32_4
      %coord_4212 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4213 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4214 = cute.crd2idx(%coord_4212, %lay_4213) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4215 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4216 = cute.add_offset(%iter_4215, %idx_4214) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4217 = cute.make_view(%tup_4216) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4218 = cute.get_iter(%view_4217) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4219, %e1_4220, %e2_4221, %e3_4222 = cute.get_leaves(%iter_4218) : !cute.int_tuple<"(?,?,?,?)">
      %1243 = cute.get_scalars(%e0_4219) : !cute.int_tuple<"?">
      %1244 = cute.get_scalars(%e1_4220) : !cute.int_tuple<"?">
      %1245 = cute.get_scalars(%e2_4221) : !cute.int_tuple<"?">
      %1246 = cute.get_scalars(%e3_4222) : !cute.int_tuple<"?">
      %iter_4223 = cute.get_iter(%view_4217) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4224, %e1_4225, %e2_4226, %e3_4227 = cute.get_leaves(%iter_4223) : !cute.int_tuple<"(?,?,?,?)">
      %1247 = cute.get_scalars(%e0_4224) : !cute.int_tuple<"?">
      %1248 = cute.get_scalars(%e1_4225) : !cute.int_tuple<"?">
      %1249 = cute.get_scalars(%e2_4226) : !cute.int_tuple<"?">
      %1250 = cute.get_scalars(%e3_4227) : !cute.int_tuple<"?">
      %iter_4228 = cute.get_iter(%view_4217) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4229, %e1_4230, %e2_4231, %e3_4232 = cute.get_leaves(%iter_4228) : !cute.int_tuple<"(?,?,?,?)">
      %1251 = cute.get_scalars(%e0_4229) : !cute.int_tuple<"?">
      %1252 = cute.get_scalars(%e1_4230) : !cute.int_tuple<"?">
      %1253 = cute.get_scalars(%e2_4231) : !cute.int_tuple<"?">
      %1254 = cute.get_scalars(%e3_4232) : !cute.int_tuple<"?">
      %int_tuple_4233 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4234 = cute.add_offset(%e3_4232, %int_tuple_4233) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1255 = cute.get_scalars(%tup_4234) : !cute.int_tuple<"?">
      %coord_4235 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4236 = cute.make_coord(%tup_4234) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1256 = cute.elem_less(%coord_4235, %coord_4236) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4237 = cute.get_layout(%1240) : !memref_rmem_f32_4
      %1257 = cute.get_shape(%lay_4237) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4238, %e1_4239, %e2_4240, %e3_4241 = cute.get_leaves(%1257) : !cute.shape<"((2,2),(2,8))">
      %1258 = cute.get_stride(%lay_4237) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4242, %e1_4243, %e2_4244, %e3_4245 = cute.get_leaves(%1258) : !cute.stride<"((2,4),(1,8))">
      %1259 = scf.if %1256 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1240) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,9)">
        cute.memref.store(%1240, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,9)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1240) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1240 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1240) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1240) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1240 : !memref_rmem_f32_4
      }
      %iter_4246 = cute.get_iter(%1259) : !memref_rmem_f32_4
      %lay_4247 = cute.get_layout(%1259) : !memref_rmem_f32_4
      %1260 = cute.get_shape(%lay_4247) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4248, %e1_4249, %e2_4250, %e3_4251 = cute.get_leaves(%1260) : !cute.shape<"((2,2),(2,8))">
      %1261 = cute.get_stride(%lay_4247) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4252, %e1_4253, %e2_4254, %e3_4255 = cute.get_leaves(%1261) : !cute.stride<"((2,4),(1,8))">
      %iter_4256 = cute.get_iter(%1259) : !memref_rmem_f32_4
      %iter_4257 = cute.get_iter(%1259) : !memref_rmem_f32_4
      %coord_4258 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_4259 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4260 = cute.crd2idx(%coord_4258, %lay_4259) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_4261 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4262 = cute.add_offset(%iter_4261, %idx_4260) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4263 = cute.make_view(%tup_4262) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4264 = cute.get_iter(%view_4263) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4265, %e1_4266, %e2_4267, %e3_4268 = cute.get_leaves(%iter_4264) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1262 = cute.get_scalars(%e0_4265) : !cute.int_tuple<"?">
      %1263 = cute.get_scalars(%e1_4266) : !cute.int_tuple<"?">
      %1264 = cute.get_scalars(%e2_4267) : !cute.int_tuple<"?">
      %1265 = cute.get_scalars(%e3_4268) : !cute.int_tuple<"?{div=2}">
      %iter_4269 = cute.get_iter(%view_4263) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4270, %e1_4271, %e2_4272, %e3_4273 = cute.get_leaves(%iter_4269) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1266 = cute.get_scalars(%e0_4270) : !cute.int_tuple<"?">
      %1267 = cute.get_scalars(%e1_4271) : !cute.int_tuple<"?">
      %1268 = cute.get_scalars(%e2_4272) : !cute.int_tuple<"?">
      %1269 = cute.get_scalars(%e3_4273) : !cute.int_tuple<"?{div=2}">
      %iter_4274 = cute.get_iter(%view_4263) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4275, %e1_4276, %e2_4277, %e3_4278 = cute.get_leaves(%iter_4274) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1270 = cute.get_scalars(%e0_4275) : !cute.int_tuple<"?">
      %1271 = cute.get_scalars(%e1_4276) : !cute.int_tuple<"?">
      %1272 = cute.get_scalars(%e2_4277) : !cute.int_tuple<"?">
      %1273 = cute.get_scalars(%e3_4278) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4279 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4280 = cute.add_offset(%e3_4278, %int_tuple_4279) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1274 = cute.get_scalars(%tup_4280) : !cute.int_tuple<"?">
      %coord_4281 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4282 = cute.make_coord(%tup_4280) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1275 = cute.elem_less(%coord_4281, %coord_4282) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4283 = cute.get_layout(%1259) : !memref_rmem_f32_4
      %1276 = cute.get_shape(%lay_4283) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4284, %e1_4285, %e2_4286, %e3_4287 = cute.get_leaves(%1276) : !cute.shape<"((2,2),(2,8))">
      %1277 = cute.get_stride(%lay_4283) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4288, %e1_4289, %e2_4290, %e3_4291 = cute.get_leaves(%1277) : !cute.stride<"((2,4),(1,8))">
      %1278 = scf.if %1275 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1259) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,10)">
        cute.memref.store(%1259, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,10)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1259) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1259 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1259) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1259) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1259 : !memref_rmem_f32_4
      }
      %iter_4292 = cute.get_iter(%1278) : !memref_rmem_f32_4
      %lay_4293 = cute.get_layout(%1278) : !memref_rmem_f32_4
      %1279 = cute.get_shape(%lay_4293) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4294, %e1_4295, %e2_4296, %e3_4297 = cute.get_leaves(%1279) : !cute.shape<"((2,2),(2,8))">
      %1280 = cute.get_stride(%lay_4293) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4298, %e1_4299, %e2_4300, %e3_4301 = cute.get_leaves(%1280) : !cute.stride<"((2,4),(1,8))">
      %iter_4302 = cute.get_iter(%1278) : !memref_rmem_f32_4
      %iter_4303 = cute.get_iter(%1278) : !memref_rmem_f32_4
      %coord_4304 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_4305 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4306 = cute.crd2idx(%coord_4304, %lay_4305) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_4307 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4308 = cute.add_offset(%iter_4307, %idx_4306) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4309 = cute.make_view(%tup_4308) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4310 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4311, %e1_4312, %e2_4313, %e3_4314 = cute.get_leaves(%iter_4310) : !cute.int_tuple<"(?,?,?,?)">
      %1281 = cute.get_scalars(%e0_4311) : !cute.int_tuple<"?">
      %1282 = cute.get_scalars(%e1_4312) : !cute.int_tuple<"?">
      %1283 = cute.get_scalars(%e2_4313) : !cute.int_tuple<"?">
      %1284 = cute.get_scalars(%e3_4314) : !cute.int_tuple<"?">
      %iter_4315 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4316, %e1_4317, %e2_4318, %e3_4319 = cute.get_leaves(%iter_4315) : !cute.int_tuple<"(?,?,?,?)">
      %1285 = cute.get_scalars(%e0_4316) : !cute.int_tuple<"?">
      %1286 = cute.get_scalars(%e1_4317) : !cute.int_tuple<"?">
      %1287 = cute.get_scalars(%e2_4318) : !cute.int_tuple<"?">
      %1288 = cute.get_scalars(%e3_4319) : !cute.int_tuple<"?">
      %iter_4320 = cute.get_iter(%view_4309) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4321, %e1_4322, %e2_4323, %e3_4324 = cute.get_leaves(%iter_4320) : !cute.int_tuple<"(?,?,?,?)">
      %1289 = cute.get_scalars(%e0_4321) : !cute.int_tuple<"?">
      %1290 = cute.get_scalars(%e1_4322) : !cute.int_tuple<"?">
      %1291 = cute.get_scalars(%e2_4323) : !cute.int_tuple<"?">
      %1292 = cute.get_scalars(%e3_4324) : !cute.int_tuple<"?">
      %int_tuple_4325 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4326 = cute.add_offset(%e3_4324, %int_tuple_4325) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1293 = cute.get_scalars(%tup_4326) : !cute.int_tuple<"?">
      %coord_4327 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4328 = cute.make_coord(%tup_4326) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1294 = cute.elem_less(%coord_4327, %coord_4328) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4329 = cute.get_layout(%1278) : !memref_rmem_f32_4
      %1295 = cute.get_shape(%lay_4329) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4330, %e1_4331, %e2_4332, %e3_4333 = cute.get_leaves(%1295) : !cute.shape<"((2,2),(2,8))">
      %1296 = cute.get_stride(%lay_4329) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4334, %e1_4335, %e2_4336, %e3_4337 = cute.get_leaves(%1296) : !cute.stride<"((2,4),(1,8))">
      %1297 = scf.if %1294 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1278) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,11)">
        cute.memref.store(%1278, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,11)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1278) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1278 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1278) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1278) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1278 : !memref_rmem_f32_4
      }
      %iter_4338 = cute.get_iter(%1297) : !memref_rmem_f32_4
      %lay_4339 = cute.get_layout(%1297) : !memref_rmem_f32_4
      %1298 = cute.get_shape(%lay_4339) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4340, %e1_4341, %e2_4342, %e3_4343 = cute.get_leaves(%1298) : !cute.shape<"((2,2),(2,8))">
      %1299 = cute.get_stride(%lay_4339) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4344, %e1_4345, %e2_4346, %e3_4347 = cute.get_leaves(%1299) : !cute.stride<"((2,4),(1,8))">
      %iter_4348 = cute.get_iter(%1297) : !memref_rmem_f32_4
      %iter_4349 = cute.get_iter(%1297) : !memref_rmem_f32_4
      %coord_4350 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_4351 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4352 = cute.crd2idx(%coord_4350, %lay_4351) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_4353 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4354 = cute.add_offset(%iter_4353, %idx_4352) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4355 = cute.make_view(%tup_4354) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4356 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4357, %e1_4358, %e2_4359, %e3_4360 = cute.get_leaves(%iter_4356) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1300 = cute.get_scalars(%e0_4357) : !cute.int_tuple<"?">
      %1301 = cute.get_scalars(%e1_4358) : !cute.int_tuple<"?">
      %1302 = cute.get_scalars(%e2_4359) : !cute.int_tuple<"?">
      %1303 = cute.get_scalars(%e3_4360) : !cute.int_tuple<"?{div=2}">
      %iter_4361 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4362, %e1_4363, %e2_4364, %e3_4365 = cute.get_leaves(%iter_4361) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1304 = cute.get_scalars(%e0_4362) : !cute.int_tuple<"?">
      %1305 = cute.get_scalars(%e1_4363) : !cute.int_tuple<"?">
      %1306 = cute.get_scalars(%e2_4364) : !cute.int_tuple<"?">
      %1307 = cute.get_scalars(%e3_4365) : !cute.int_tuple<"?{div=2}">
      %iter_4366 = cute.get_iter(%view_4355) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4367, %e1_4368, %e2_4369, %e3_4370 = cute.get_leaves(%iter_4366) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1308 = cute.get_scalars(%e0_4367) : !cute.int_tuple<"?">
      %1309 = cute.get_scalars(%e1_4368) : !cute.int_tuple<"?">
      %1310 = cute.get_scalars(%e2_4369) : !cute.int_tuple<"?">
      %1311 = cute.get_scalars(%e3_4370) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4371 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4372 = cute.add_offset(%e3_4370, %int_tuple_4371) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1312 = cute.get_scalars(%tup_4372) : !cute.int_tuple<"?">
      %coord_4373 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4374 = cute.make_coord(%tup_4372) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1313 = cute.elem_less(%coord_4373, %coord_4374) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4375 = cute.get_layout(%1297) : !memref_rmem_f32_4
      %1314 = cute.get_shape(%lay_4375) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4376, %e1_4377, %e2_4378, %e3_4379 = cute.get_leaves(%1314) : !cute.shape<"((2,2),(2,8))">
      %1315 = cute.get_stride(%lay_4375) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4380, %e1_4381, %e2_4382, %e3_4383 = cute.get_leaves(%1315) : !cute.stride<"((2,4),(1,8))">
      %1316 = scf.if %1313 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1297) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,12)">
        cute.memref.store(%1297, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,12)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1297) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1297 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1297) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1297) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1297 : !memref_rmem_f32_4
      }
      %iter_4384 = cute.get_iter(%1316) : !memref_rmem_f32_4
      %lay_4385 = cute.get_layout(%1316) : !memref_rmem_f32_4
      %1317 = cute.get_shape(%lay_4385) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4386, %e1_4387, %e2_4388, %e3_4389 = cute.get_leaves(%1317) : !cute.shape<"((2,2),(2,8))">
      %1318 = cute.get_stride(%lay_4385) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4390, %e1_4391, %e2_4392, %e3_4393 = cute.get_leaves(%1318) : !cute.stride<"((2,4),(1,8))">
      %iter_4394 = cute.get_iter(%1316) : !memref_rmem_f32_4
      %iter_4395 = cute.get_iter(%1316) : !memref_rmem_f32_4
      %coord_4396 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_4397 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4398 = cute.crd2idx(%coord_4396, %lay_4397) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_4399 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4400 = cute.add_offset(%iter_4399, %idx_4398) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4401 = cute.make_view(%tup_4400) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4402 = cute.get_iter(%view_4401) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4403, %e1_4404, %e2_4405, %e3_4406 = cute.get_leaves(%iter_4402) : !cute.int_tuple<"(?,?,?,?)">
      %1319 = cute.get_scalars(%e0_4403) : !cute.int_tuple<"?">
      %1320 = cute.get_scalars(%e1_4404) : !cute.int_tuple<"?">
      %1321 = cute.get_scalars(%e2_4405) : !cute.int_tuple<"?">
      %1322 = cute.get_scalars(%e3_4406) : !cute.int_tuple<"?">
      %iter_4407 = cute.get_iter(%view_4401) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4408, %e1_4409, %e2_4410, %e3_4411 = cute.get_leaves(%iter_4407) : !cute.int_tuple<"(?,?,?,?)">
      %1323 = cute.get_scalars(%e0_4408) : !cute.int_tuple<"?">
      %1324 = cute.get_scalars(%e1_4409) : !cute.int_tuple<"?">
      %1325 = cute.get_scalars(%e2_4410) : !cute.int_tuple<"?">
      %1326 = cute.get_scalars(%e3_4411) : !cute.int_tuple<"?">
      %iter_4412 = cute.get_iter(%view_4401) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4413, %e1_4414, %e2_4415, %e3_4416 = cute.get_leaves(%iter_4412) : !cute.int_tuple<"(?,?,?,?)">
      %1327 = cute.get_scalars(%e0_4413) : !cute.int_tuple<"?">
      %1328 = cute.get_scalars(%e1_4414) : !cute.int_tuple<"?">
      %1329 = cute.get_scalars(%e2_4415) : !cute.int_tuple<"?">
      %1330 = cute.get_scalars(%e3_4416) : !cute.int_tuple<"?">
      %int_tuple_4417 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4418 = cute.add_offset(%e3_4416, %int_tuple_4417) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1331 = cute.get_scalars(%tup_4418) : !cute.int_tuple<"?">
      %coord_4419 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4420 = cute.make_coord(%tup_4418) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1332 = cute.elem_less(%coord_4419, %coord_4420) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4421 = cute.get_layout(%1316) : !memref_rmem_f32_4
      %1333 = cute.get_shape(%lay_4421) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4422, %e1_4423, %e2_4424, %e3_4425 = cute.get_leaves(%1333) : !cute.shape<"((2,2),(2,8))">
      %1334 = cute.get_stride(%lay_4421) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4426, %e1_4427, %e2_4428, %e3_4429 = cute.get_leaves(%1334) : !cute.stride<"((2,4),(1,8))">
      %1335 = scf.if %1332 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1316) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,13)">
        cute.memref.store(%1316, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,13)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1316) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1316 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1316) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1316) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1316 : !memref_rmem_f32_4
      }
      %iter_4430 = cute.get_iter(%1335) : !memref_rmem_f32_4
      %lay_4431 = cute.get_layout(%1335) : !memref_rmem_f32_4
      %1336 = cute.get_shape(%lay_4431) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4432, %e1_4433, %e2_4434, %e3_4435 = cute.get_leaves(%1336) : !cute.shape<"((2,2),(2,8))">
      %1337 = cute.get_stride(%lay_4431) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4436, %e1_4437, %e2_4438, %e3_4439 = cute.get_leaves(%1337) : !cute.stride<"((2,4),(1,8))">
      %iter_4440 = cute.get_iter(%1335) : !memref_rmem_f32_4
      %iter_4441 = cute.get_iter(%1335) : !memref_rmem_f32_4
      %coord_4442 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_4443 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4444 = cute.crd2idx(%coord_4442, %lay_4443) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_4445 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4446 = cute.add_offset(%iter_4445, %idx_4444) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4447 = cute.make_view(%tup_4446) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4448 = cute.get_iter(%view_4447) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4449, %e1_4450, %e2_4451, %e3_4452 = cute.get_leaves(%iter_4448) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1338 = cute.get_scalars(%e0_4449) : !cute.int_tuple<"?">
      %1339 = cute.get_scalars(%e1_4450) : !cute.int_tuple<"?">
      %1340 = cute.get_scalars(%e2_4451) : !cute.int_tuple<"?">
      %1341 = cute.get_scalars(%e3_4452) : !cute.int_tuple<"?{div=2}">
      %iter_4453 = cute.get_iter(%view_4447) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4454, %e1_4455, %e2_4456, %e3_4457 = cute.get_leaves(%iter_4453) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1342 = cute.get_scalars(%e0_4454) : !cute.int_tuple<"?">
      %1343 = cute.get_scalars(%e1_4455) : !cute.int_tuple<"?">
      %1344 = cute.get_scalars(%e2_4456) : !cute.int_tuple<"?">
      %1345 = cute.get_scalars(%e3_4457) : !cute.int_tuple<"?{div=2}">
      %iter_4458 = cute.get_iter(%view_4447) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4459, %e1_4460, %e2_4461, %e3_4462 = cute.get_leaves(%iter_4458) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1346 = cute.get_scalars(%e0_4459) : !cute.int_tuple<"?">
      %1347 = cute.get_scalars(%e1_4460) : !cute.int_tuple<"?">
      %1348 = cute.get_scalars(%e2_4461) : !cute.int_tuple<"?">
      %1349 = cute.get_scalars(%e3_4462) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4463 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4464 = cute.add_offset(%e3_4462, %int_tuple_4463) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1350 = cute.get_scalars(%tup_4464) : !cute.int_tuple<"?">
      %coord_4465 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4466 = cute.make_coord(%tup_4464) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1351 = cute.elem_less(%coord_4465, %coord_4466) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4467 = cute.get_layout(%1335) : !memref_rmem_f32_4
      %1352 = cute.get_shape(%lay_4467) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4468, %e1_4469, %e2_4470, %e3_4471 = cute.get_leaves(%1352) : !cute.shape<"((2,2),(2,8))">
      %1353 = cute.get_stride(%lay_4467) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4472, %e1_4473, %e2_4474, %e3_4475 = cute.get_leaves(%1353) : !cute.stride<"((2,4),(1,8))">
      %1354 = scf.if %1351 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1335) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,14)">
        cute.memref.store(%1335, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,14)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1335) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1335 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1335) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1335) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1335 : !memref_rmem_f32_4
      }
      %iter_4476 = cute.get_iter(%1354) : !memref_rmem_f32_4
      %lay_4477 = cute.get_layout(%1354) : !memref_rmem_f32_4
      %1355 = cute.get_shape(%lay_4477) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4478, %e1_4479, %e2_4480, %e3_4481 = cute.get_leaves(%1355) : !cute.shape<"((2,2),(2,8))">
      %1356 = cute.get_stride(%lay_4477) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4482, %e1_4483, %e2_4484, %e3_4485 = cute.get_leaves(%1356) : !cute.stride<"((2,4),(1,8))">
      %iter_4486 = cute.get_iter(%1354) : !memref_rmem_f32_4
      %iter_4487 = cute.get_iter(%1354) : !memref_rmem_f32_4
      %coord_4488 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_4489 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4490 = cute.crd2idx(%coord_4488, %lay_4489) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_4491 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4492 = cute.add_offset(%iter_4491, %idx_4490) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4493 = cute.make_view(%tup_4492) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4494 = cute.get_iter(%view_4493) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4495, %e1_4496, %e2_4497, %e3_4498 = cute.get_leaves(%iter_4494) : !cute.int_tuple<"(?,?,?,?)">
      %1357 = cute.get_scalars(%e0_4495) : !cute.int_tuple<"?">
      %1358 = cute.get_scalars(%e1_4496) : !cute.int_tuple<"?">
      %1359 = cute.get_scalars(%e2_4497) : !cute.int_tuple<"?">
      %1360 = cute.get_scalars(%e3_4498) : !cute.int_tuple<"?">
      %iter_4499 = cute.get_iter(%view_4493) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4500, %e1_4501, %e2_4502, %e3_4503 = cute.get_leaves(%iter_4499) : !cute.int_tuple<"(?,?,?,?)">
      %1361 = cute.get_scalars(%e0_4500) : !cute.int_tuple<"?">
      %1362 = cute.get_scalars(%e1_4501) : !cute.int_tuple<"?">
      %1363 = cute.get_scalars(%e2_4502) : !cute.int_tuple<"?">
      %1364 = cute.get_scalars(%e3_4503) : !cute.int_tuple<"?">
      %iter_4504 = cute.get_iter(%view_4493) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4505, %e1_4506, %e2_4507, %e3_4508 = cute.get_leaves(%iter_4504) : !cute.int_tuple<"(?,?,?,?)">
      %1365 = cute.get_scalars(%e0_4505) : !cute.int_tuple<"?">
      %1366 = cute.get_scalars(%e1_4506) : !cute.int_tuple<"?">
      %1367 = cute.get_scalars(%e2_4507) : !cute.int_tuple<"?">
      %1368 = cute.get_scalars(%e3_4508) : !cute.int_tuple<"?">
      %int_tuple_4509 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4510 = cute.add_offset(%e3_4508, %int_tuple_4509) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1369 = cute.get_scalars(%tup_4510) : !cute.int_tuple<"?">
      %coord_4511 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4512 = cute.make_coord(%tup_4510) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1370 = cute.elem_less(%coord_4511, %coord_4512) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4513 = cute.get_layout(%1354) : !memref_rmem_f32_4
      %1371 = cute.get_shape(%lay_4513) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4514, %e1_4515, %e2_4516, %e3_4517 = cute.get_leaves(%1371) : !cute.shape<"((2,2),(2,8))">
      %1372 = cute.get_stride(%lay_4513) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4518, %e1_4519, %e2_4520, %e3_4521 = cute.get_leaves(%1372) : !cute.stride<"((2,4),(1,8))">
      %1373 = scf.if %1370 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1354) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(1,15)">
        cute.memref.store(%1354, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(1,15)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1354) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1354 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1354) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1354) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1354 : !memref_rmem_f32_4
      }
      %iter_4522 = cute.get_iter(%1373) : !memref_rmem_f32_4
      %lay_4523 = cute.get_layout(%1373) : !memref_rmem_f32_4
      %1374 = cute.get_shape(%lay_4523) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4524, %e1_4525, %e2_4526, %e3_4527 = cute.get_leaves(%1374) : !cute.shape<"((2,2),(2,8))">
      %1375 = cute.get_stride(%lay_4523) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4528, %e1_4529, %e2_4530, %e3_4531 = cute.get_leaves(%1375) : !cute.stride<"((2,4),(1,8))">
      %iter_4532 = cute.get_iter(%1373) : !memref_rmem_f32_4
      %iter_4533 = cute.get_iter(%1373) : !memref_rmem_f32_4
      %coord_4534 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_4535 = cute.get_layout(%1373) : !memref_rmem_f32_4
      %idx_4536 = cute.crd2idx(%coord_4534, %lay_4535) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_4537 = cute.get_iter(%1373) : !memref_rmem_f32_4
      %ptr_4538 = cute.add_offset(%iter_4537, %idx_4536) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_4539 = cute.make_view(%ptr_4538) : !memref_rmem_f32_7
      %iter_4540 = cute.get_iter(%view_4539) : !memref_rmem_f32_7
      %lay_4541 = cute.get_layout(%view_4539) : !memref_rmem_f32_7
      %1376 = cute.get_shape(%lay_4541) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4542, %e1_4543 = cute.get_leaves(%1376) : !cute.shape<"((2,8))">
      %1377 = cute.memref.load_vec %view_4539, row_major : !memref_rmem_f32_7
      %cst_4544 = arith.constant 0xFF800000 : f32
      %1378 = vector.reduction <maximumf>, %1377, %cst_4544 : vector<16xf32> into f32
      %c-1_i32_4545 = arith.constant -1 : i32
      %c2_i32_4546 = arith.constant 2 : i32
      %c31_i32_4547 = arith.constant 31 : i32
      %1379 = nvvm.shfl.sync  bfly %c-1_i32_4545, %1378, %c2_i32_4546, %c31_i32_4547 : f32 -> f32
      %1380 = nvvm.fmax %1378, %1379
      %c-1_i32_4548 = arith.constant -1 : i32
      %c1_i32_4549 = arith.constant 1 : i32
      %c31_i32_4550 = arith.constant 31 : i32
      %1381 = nvvm.shfl.sync  bfly %c-1_i32_4548, %1380, %c1_i32_4549, %c31_i32_4550 : f32 -> f32
      %1382 = nvvm.fmax %1380, %1381
      %1383 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1384 = arith.mulf %1377, %1383 : vector<16xf32>
      %1385 = arith.mulf %1382, %arg4 : f32
      %1386 = vector.broadcast %1385 : f32 to vector<16xf32>
      %1387 = arith.subf %1384, %1386 : vector<16xf32>
      %1388 = math.exp2 %1387 fastmath<fast> : vector<16xf32>
      %cst_4551 = arith.constant 0.000000e+00 : f32
      %1389 = vector.reduction <add>, %1388, %cst_4551 : vector<16xf32> into f32
      %coord_4552 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1062, %coord_4552, %1382) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_4553 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1067, %coord_4553, %1389) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_4554 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_4555 = cute.get_layout(%1373) : !memref_rmem_f32_4
      %idx_4556 = cute.crd2idx(%coord_4554, %lay_4555) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_4557 = cute.get_iter(%1373) : !memref_rmem_f32_4
      %ptr_4558 = cute.add_offset(%iter_4557, %idx_4556) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_4559 = cute.make_view(%ptr_4558) : !memref_rmem_f32_7
      %iter_4560 = cute.get_iter(%view_4559) : !memref_rmem_f32_7
      %lay_4561 = cute.get_layout(%view_4559) : !memref_rmem_f32_7
      %1390 = cute.get_shape(%lay_4561) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_4562, %e1_4563 = cute.get_leaves(%1390) : !cute.shape<"((2,8))">
      %int_tuple_4564 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4565 = cute.size(%int_tuple_4564) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4566 = cute.get_leaves(%sz_4565) : !cute.int_tuple<"16">
      %int_tuple_4567 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_4568 = cute.size(%int_tuple_4567) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_4569 = cute.get_leaves(%sz_4568) : !cute.int_tuple<"16">
      cute.memref.store_vec %1388, %view_4559, row_major : !memref_rmem_f32_7
      %int_tuple_4570 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_4571 = cute.size(%int_tuple_4570) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_4572 = cute.get_leaves(%sz_4571) : !cute.int_tuple<"16">
      %coord_4573 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_4574 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4575 = cute.crd2idx(%coord_4573, %lay_4574) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_4576 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4577 = cute.add_offset(%iter_4576, %idx_4575) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4578 = cute.make_view(%tup_4577) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4579 = cute.get_iter(%view_4578) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4580, %e1_4581, %e2_4582, %e3_4583 = cute.get_leaves(%iter_4579) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1391 = cute.get_scalars(%e0_4580) : !cute.int_tuple<"?">
      %1392 = cute.get_scalars(%e1_4581) : !cute.int_tuple<"?">
      %1393 = cute.get_scalars(%e2_4582) : !cute.int_tuple<"?">
      %1394 = cute.get_scalars(%e3_4583) : !cute.int_tuple<"?{div=2}">
      %iter_4584 = cute.get_iter(%view_4578) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4585, %e1_4586, %e2_4587, %e3_4588 = cute.get_leaves(%iter_4584) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1395 = cute.get_scalars(%e0_4585) : !cute.int_tuple<"?">
      %1396 = cute.get_scalars(%e1_4586) : !cute.int_tuple<"?">
      %1397 = cute.get_scalars(%e2_4587) : !cute.int_tuple<"?">
      %1398 = cute.get_scalars(%e3_4588) : !cute.int_tuple<"?{div=2}">
      %iter_4589 = cute.get_iter(%view_4578) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4590, %e1_4591, %e2_4592, %e3_4593 = cute.get_leaves(%iter_4589) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1399 = cute.get_scalars(%e0_4590) : !cute.int_tuple<"?">
      %1400 = cute.get_scalars(%e1_4591) : !cute.int_tuple<"?">
      %1401 = cute.get_scalars(%e2_4592) : !cute.int_tuple<"?">
      %1402 = cute.get_scalars(%e3_4593) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4594 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4595 = cute.add_offset(%e3_4593, %int_tuple_4594) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1403 = cute.get_scalars(%tup_4595) : !cute.int_tuple<"?">
      %coord_4596 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4597 = cute.make_coord(%tup_4595) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1404 = cute.elem_less(%coord_4596, %coord_4597) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4598 = cute.get_layout(%1373) : !memref_rmem_f32_4
      %1405 = cute.get_shape(%lay_4598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4599, %e1_4600, %e2_4601, %e3_4602 = cute.get_leaves(%1405) : !cute.shape<"((2,2),(2,8))">
      %1406 = cute.get_stride(%lay_4598) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4603, %e1_4604, %e2_4605, %e3_4606 = cute.get_leaves(%1406) : !cute.stride<"((2,4),(1,8))">
      %1407 = scf.if %1404 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1373) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,0)">
        cute.memref.store(%1373, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,0)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1373) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1373 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1373) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1373) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1373 : !memref_rmem_f32_4
      }
      %iter_4607 = cute.get_iter(%1407) : !memref_rmem_f32_4
      %lay_4608 = cute.get_layout(%1407) : !memref_rmem_f32_4
      %1408 = cute.get_shape(%lay_4608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4609, %e1_4610, %e2_4611, %e3_4612 = cute.get_leaves(%1408) : !cute.shape<"((2,2),(2,8))">
      %1409 = cute.get_stride(%lay_4608) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4613, %e1_4614, %e2_4615, %e3_4616 = cute.get_leaves(%1409) : !cute.stride<"((2,4),(1,8))">
      %iter_4617 = cute.get_iter(%1407) : !memref_rmem_f32_4
      %iter_4618 = cute.get_iter(%1407) : !memref_rmem_f32_4
      %coord_4619 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_4620 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4621 = cute.crd2idx(%coord_4619, %lay_4620) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_4622 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4623 = cute.add_offset(%iter_4622, %idx_4621) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4624 = cute.make_view(%tup_4623) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4625 = cute.get_iter(%view_4624) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4626, %e1_4627, %e2_4628, %e3_4629 = cute.get_leaves(%iter_4625) : !cute.int_tuple<"(?,?,?,?)">
      %1410 = cute.get_scalars(%e0_4626) : !cute.int_tuple<"?">
      %1411 = cute.get_scalars(%e1_4627) : !cute.int_tuple<"?">
      %1412 = cute.get_scalars(%e2_4628) : !cute.int_tuple<"?">
      %1413 = cute.get_scalars(%e3_4629) : !cute.int_tuple<"?">
      %iter_4630 = cute.get_iter(%view_4624) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4631, %e1_4632, %e2_4633, %e3_4634 = cute.get_leaves(%iter_4630) : !cute.int_tuple<"(?,?,?,?)">
      %1414 = cute.get_scalars(%e0_4631) : !cute.int_tuple<"?">
      %1415 = cute.get_scalars(%e1_4632) : !cute.int_tuple<"?">
      %1416 = cute.get_scalars(%e2_4633) : !cute.int_tuple<"?">
      %1417 = cute.get_scalars(%e3_4634) : !cute.int_tuple<"?">
      %iter_4635 = cute.get_iter(%view_4624) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4636, %e1_4637, %e2_4638, %e3_4639 = cute.get_leaves(%iter_4635) : !cute.int_tuple<"(?,?,?,?)">
      %1418 = cute.get_scalars(%e0_4636) : !cute.int_tuple<"?">
      %1419 = cute.get_scalars(%e1_4637) : !cute.int_tuple<"?">
      %1420 = cute.get_scalars(%e2_4638) : !cute.int_tuple<"?">
      %1421 = cute.get_scalars(%e3_4639) : !cute.int_tuple<"?">
      %int_tuple_4640 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4641 = cute.add_offset(%e3_4639, %int_tuple_4640) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1422 = cute.get_scalars(%tup_4641) : !cute.int_tuple<"?">
      %coord_4642 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4643 = cute.make_coord(%tup_4641) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1423 = cute.elem_less(%coord_4642, %coord_4643) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4644 = cute.get_layout(%1407) : !memref_rmem_f32_4
      %1424 = cute.get_shape(%lay_4644) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4645, %e1_4646, %e2_4647, %e3_4648 = cute.get_leaves(%1424) : !cute.shape<"((2,2),(2,8))">
      %1425 = cute.get_stride(%lay_4644) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4649, %e1_4650, %e2_4651, %e3_4652 = cute.get_leaves(%1425) : !cute.stride<"((2,4),(1,8))">
      %1426 = scf.if %1423 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1407) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,1)">
        cute.memref.store(%1407, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,1)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1407) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1407 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1407) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1407) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1407 : !memref_rmem_f32_4
      }
      %iter_4653 = cute.get_iter(%1426) : !memref_rmem_f32_4
      %lay_4654 = cute.get_layout(%1426) : !memref_rmem_f32_4
      %1427 = cute.get_shape(%lay_4654) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4655, %e1_4656, %e2_4657, %e3_4658 = cute.get_leaves(%1427) : !cute.shape<"((2,2),(2,8))">
      %1428 = cute.get_stride(%lay_4654) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4659, %e1_4660, %e2_4661, %e3_4662 = cute.get_leaves(%1428) : !cute.stride<"((2,4),(1,8))">
      %iter_4663 = cute.get_iter(%1426) : !memref_rmem_f32_4
      %iter_4664 = cute.get_iter(%1426) : !memref_rmem_f32_4
      %coord_4665 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_4666 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4667 = cute.crd2idx(%coord_4665, %lay_4666) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_4668 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4669 = cute.add_offset(%iter_4668, %idx_4667) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4670 = cute.make_view(%tup_4669) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4671 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4672, %e1_4673, %e2_4674, %e3_4675 = cute.get_leaves(%iter_4671) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1429 = cute.get_scalars(%e0_4672) : !cute.int_tuple<"?">
      %1430 = cute.get_scalars(%e1_4673) : !cute.int_tuple<"?">
      %1431 = cute.get_scalars(%e2_4674) : !cute.int_tuple<"?">
      %1432 = cute.get_scalars(%e3_4675) : !cute.int_tuple<"?{div=2}">
      %iter_4676 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4677, %e1_4678, %e2_4679, %e3_4680 = cute.get_leaves(%iter_4676) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1433 = cute.get_scalars(%e0_4677) : !cute.int_tuple<"?">
      %1434 = cute.get_scalars(%e1_4678) : !cute.int_tuple<"?">
      %1435 = cute.get_scalars(%e2_4679) : !cute.int_tuple<"?">
      %1436 = cute.get_scalars(%e3_4680) : !cute.int_tuple<"?{div=2}">
      %iter_4681 = cute.get_iter(%view_4670) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4682, %e1_4683, %e2_4684, %e3_4685 = cute.get_leaves(%iter_4681) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1437 = cute.get_scalars(%e0_4682) : !cute.int_tuple<"?">
      %1438 = cute.get_scalars(%e1_4683) : !cute.int_tuple<"?">
      %1439 = cute.get_scalars(%e2_4684) : !cute.int_tuple<"?">
      %1440 = cute.get_scalars(%e3_4685) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4686 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4687 = cute.add_offset(%e3_4685, %int_tuple_4686) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1441 = cute.get_scalars(%tup_4687) : !cute.int_tuple<"?">
      %coord_4688 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4689 = cute.make_coord(%tup_4687) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1442 = cute.elem_less(%coord_4688, %coord_4689) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4690 = cute.get_layout(%1426) : !memref_rmem_f32_4
      %1443 = cute.get_shape(%lay_4690) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4691, %e1_4692, %e2_4693, %e3_4694 = cute.get_leaves(%1443) : !cute.shape<"((2,2),(2,8))">
      %1444 = cute.get_stride(%lay_4690) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4695, %e1_4696, %e2_4697, %e3_4698 = cute.get_leaves(%1444) : !cute.stride<"((2,4),(1,8))">
      %1445 = scf.if %1442 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1426) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,2)">
        cute.memref.store(%1426, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,2)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1426) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1426 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1426) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1426) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1426 : !memref_rmem_f32_4
      }
      %iter_4699 = cute.get_iter(%1445) : !memref_rmem_f32_4
      %lay_4700 = cute.get_layout(%1445) : !memref_rmem_f32_4
      %1446 = cute.get_shape(%lay_4700) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4701, %e1_4702, %e2_4703, %e3_4704 = cute.get_leaves(%1446) : !cute.shape<"((2,2),(2,8))">
      %1447 = cute.get_stride(%lay_4700) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4705, %e1_4706, %e2_4707, %e3_4708 = cute.get_leaves(%1447) : !cute.stride<"((2,4),(1,8))">
      %iter_4709 = cute.get_iter(%1445) : !memref_rmem_f32_4
      %iter_4710 = cute.get_iter(%1445) : !memref_rmem_f32_4
      %coord_4711 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_4712 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4713 = cute.crd2idx(%coord_4711, %lay_4712) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_4714 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4715 = cute.add_offset(%iter_4714, %idx_4713) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4716 = cute.make_view(%tup_4715) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4717 = cute.get_iter(%view_4716) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4718, %e1_4719, %e2_4720, %e3_4721 = cute.get_leaves(%iter_4717) : !cute.int_tuple<"(?,?,?,?)">
      %1448 = cute.get_scalars(%e0_4718) : !cute.int_tuple<"?">
      %1449 = cute.get_scalars(%e1_4719) : !cute.int_tuple<"?">
      %1450 = cute.get_scalars(%e2_4720) : !cute.int_tuple<"?">
      %1451 = cute.get_scalars(%e3_4721) : !cute.int_tuple<"?">
      %iter_4722 = cute.get_iter(%view_4716) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4723, %e1_4724, %e2_4725, %e3_4726 = cute.get_leaves(%iter_4722) : !cute.int_tuple<"(?,?,?,?)">
      %1452 = cute.get_scalars(%e0_4723) : !cute.int_tuple<"?">
      %1453 = cute.get_scalars(%e1_4724) : !cute.int_tuple<"?">
      %1454 = cute.get_scalars(%e2_4725) : !cute.int_tuple<"?">
      %1455 = cute.get_scalars(%e3_4726) : !cute.int_tuple<"?">
      %iter_4727 = cute.get_iter(%view_4716) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4728, %e1_4729, %e2_4730, %e3_4731 = cute.get_leaves(%iter_4727) : !cute.int_tuple<"(?,?,?,?)">
      %1456 = cute.get_scalars(%e0_4728) : !cute.int_tuple<"?">
      %1457 = cute.get_scalars(%e1_4729) : !cute.int_tuple<"?">
      %1458 = cute.get_scalars(%e2_4730) : !cute.int_tuple<"?">
      %1459 = cute.get_scalars(%e3_4731) : !cute.int_tuple<"?">
      %int_tuple_4732 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4733 = cute.add_offset(%e3_4731, %int_tuple_4732) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1460 = cute.get_scalars(%tup_4733) : !cute.int_tuple<"?">
      %coord_4734 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4735 = cute.make_coord(%tup_4733) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1461 = cute.elem_less(%coord_4734, %coord_4735) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4736 = cute.get_layout(%1445) : !memref_rmem_f32_4
      %1462 = cute.get_shape(%lay_4736) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4737, %e1_4738, %e2_4739, %e3_4740 = cute.get_leaves(%1462) : !cute.shape<"((2,2),(2,8))">
      %1463 = cute.get_stride(%lay_4736) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4741, %e1_4742, %e2_4743, %e3_4744 = cute.get_leaves(%1463) : !cute.stride<"((2,4),(1,8))">
      %1464 = scf.if %1461 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1445) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,3)">
        cute.memref.store(%1445, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,3)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1445) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1445 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1445) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1445) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1445 : !memref_rmem_f32_4
      }
      %iter_4745 = cute.get_iter(%1464) : !memref_rmem_f32_4
      %lay_4746 = cute.get_layout(%1464) : !memref_rmem_f32_4
      %1465 = cute.get_shape(%lay_4746) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4747, %e1_4748, %e2_4749, %e3_4750 = cute.get_leaves(%1465) : !cute.shape<"((2,2),(2,8))">
      %1466 = cute.get_stride(%lay_4746) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4751, %e1_4752, %e2_4753, %e3_4754 = cute.get_leaves(%1466) : !cute.stride<"((2,4),(1,8))">
      %iter_4755 = cute.get_iter(%1464) : !memref_rmem_f32_4
      %iter_4756 = cute.get_iter(%1464) : !memref_rmem_f32_4
      %coord_4757 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_4758 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4759 = cute.crd2idx(%coord_4757, %lay_4758) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_4760 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4761 = cute.add_offset(%iter_4760, %idx_4759) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4762 = cute.make_view(%tup_4761) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4763 = cute.get_iter(%view_4762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4764, %e1_4765, %e2_4766, %e3_4767 = cute.get_leaves(%iter_4763) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1467 = cute.get_scalars(%e0_4764) : !cute.int_tuple<"?">
      %1468 = cute.get_scalars(%e1_4765) : !cute.int_tuple<"?">
      %1469 = cute.get_scalars(%e2_4766) : !cute.int_tuple<"?">
      %1470 = cute.get_scalars(%e3_4767) : !cute.int_tuple<"?{div=2}">
      %iter_4768 = cute.get_iter(%view_4762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4769, %e1_4770, %e2_4771, %e3_4772 = cute.get_leaves(%iter_4768) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1471 = cute.get_scalars(%e0_4769) : !cute.int_tuple<"?">
      %1472 = cute.get_scalars(%e1_4770) : !cute.int_tuple<"?">
      %1473 = cute.get_scalars(%e2_4771) : !cute.int_tuple<"?">
      %1474 = cute.get_scalars(%e3_4772) : !cute.int_tuple<"?{div=2}">
      %iter_4773 = cute.get_iter(%view_4762) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4774, %e1_4775, %e2_4776, %e3_4777 = cute.get_leaves(%iter_4773) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1475 = cute.get_scalars(%e0_4774) : !cute.int_tuple<"?">
      %1476 = cute.get_scalars(%e1_4775) : !cute.int_tuple<"?">
      %1477 = cute.get_scalars(%e2_4776) : !cute.int_tuple<"?">
      %1478 = cute.get_scalars(%e3_4777) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4778 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4779 = cute.add_offset(%e3_4777, %int_tuple_4778) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1479 = cute.get_scalars(%tup_4779) : !cute.int_tuple<"?">
      %coord_4780 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4781 = cute.make_coord(%tup_4779) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1480 = cute.elem_less(%coord_4780, %coord_4781) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4782 = cute.get_layout(%1464) : !memref_rmem_f32_4
      %1481 = cute.get_shape(%lay_4782) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4783, %e1_4784, %e2_4785, %e3_4786 = cute.get_leaves(%1481) : !cute.shape<"((2,2),(2,8))">
      %1482 = cute.get_stride(%lay_4782) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4787, %e1_4788, %e2_4789, %e3_4790 = cute.get_leaves(%1482) : !cute.stride<"((2,4),(1,8))">
      %1483 = scf.if %1480 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1464) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,4)">
        cute.memref.store(%1464, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,4)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1464) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1464 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1464) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1464) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1464 : !memref_rmem_f32_4
      }
      %iter_4791 = cute.get_iter(%1483) : !memref_rmem_f32_4
      %lay_4792 = cute.get_layout(%1483) : !memref_rmem_f32_4
      %1484 = cute.get_shape(%lay_4792) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4793, %e1_4794, %e2_4795, %e3_4796 = cute.get_leaves(%1484) : !cute.shape<"((2,2),(2,8))">
      %1485 = cute.get_stride(%lay_4792) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4797, %e1_4798, %e2_4799, %e3_4800 = cute.get_leaves(%1485) : !cute.stride<"((2,4),(1,8))">
      %iter_4801 = cute.get_iter(%1483) : !memref_rmem_f32_4
      %iter_4802 = cute.get_iter(%1483) : !memref_rmem_f32_4
      %coord_4803 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_4804 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4805 = cute.crd2idx(%coord_4803, %lay_4804) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_4806 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4807 = cute.add_offset(%iter_4806, %idx_4805) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4808 = cute.make_view(%tup_4807) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4809 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4810, %e1_4811, %e2_4812, %e3_4813 = cute.get_leaves(%iter_4809) : !cute.int_tuple<"(?,?,?,?)">
      %1486 = cute.get_scalars(%e0_4810) : !cute.int_tuple<"?">
      %1487 = cute.get_scalars(%e1_4811) : !cute.int_tuple<"?">
      %1488 = cute.get_scalars(%e2_4812) : !cute.int_tuple<"?">
      %1489 = cute.get_scalars(%e3_4813) : !cute.int_tuple<"?">
      %iter_4814 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4815, %e1_4816, %e2_4817, %e3_4818 = cute.get_leaves(%iter_4814) : !cute.int_tuple<"(?,?,?,?)">
      %1490 = cute.get_scalars(%e0_4815) : !cute.int_tuple<"?">
      %1491 = cute.get_scalars(%e1_4816) : !cute.int_tuple<"?">
      %1492 = cute.get_scalars(%e2_4817) : !cute.int_tuple<"?">
      %1493 = cute.get_scalars(%e3_4818) : !cute.int_tuple<"?">
      %iter_4819 = cute.get_iter(%view_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4820, %e1_4821, %e2_4822, %e3_4823 = cute.get_leaves(%iter_4819) : !cute.int_tuple<"(?,?,?,?)">
      %1494 = cute.get_scalars(%e0_4820) : !cute.int_tuple<"?">
      %1495 = cute.get_scalars(%e1_4821) : !cute.int_tuple<"?">
      %1496 = cute.get_scalars(%e2_4822) : !cute.int_tuple<"?">
      %1497 = cute.get_scalars(%e3_4823) : !cute.int_tuple<"?">
      %int_tuple_4824 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4825 = cute.add_offset(%e3_4823, %int_tuple_4824) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1498 = cute.get_scalars(%tup_4825) : !cute.int_tuple<"?">
      %coord_4826 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4827 = cute.make_coord(%tup_4825) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1499 = cute.elem_less(%coord_4826, %coord_4827) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4828 = cute.get_layout(%1483) : !memref_rmem_f32_4
      %1500 = cute.get_shape(%lay_4828) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4829, %e1_4830, %e2_4831, %e3_4832 = cute.get_leaves(%1500) : !cute.shape<"((2,2),(2,8))">
      %1501 = cute.get_stride(%lay_4828) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4833, %e1_4834, %e2_4835, %e3_4836 = cute.get_leaves(%1501) : !cute.stride<"((2,4),(1,8))">
      %1502 = scf.if %1499 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1483) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,5)">
        cute.memref.store(%1483, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,5)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1483) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1483 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1483) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1483) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1483 : !memref_rmem_f32_4
      }
      %iter_4837 = cute.get_iter(%1502) : !memref_rmem_f32_4
      %lay_4838 = cute.get_layout(%1502) : !memref_rmem_f32_4
      %1503 = cute.get_shape(%lay_4838) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4839, %e1_4840, %e2_4841, %e3_4842 = cute.get_leaves(%1503) : !cute.shape<"((2,2),(2,8))">
      %1504 = cute.get_stride(%lay_4838) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4843, %e1_4844, %e2_4845, %e3_4846 = cute.get_leaves(%1504) : !cute.stride<"((2,4),(1,8))">
      %iter_4847 = cute.get_iter(%1502) : !memref_rmem_f32_4
      %iter_4848 = cute.get_iter(%1502) : !memref_rmem_f32_4
      %coord_4849 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_4850 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4851 = cute.crd2idx(%coord_4849, %lay_4850) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_4852 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4853 = cute.add_offset(%iter_4852, %idx_4851) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4854 = cute.make_view(%tup_4853) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4855 = cute.get_iter(%view_4854) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4856, %e1_4857, %e2_4858, %e3_4859 = cute.get_leaves(%iter_4855) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1505 = cute.get_scalars(%e0_4856) : !cute.int_tuple<"?">
      %1506 = cute.get_scalars(%e1_4857) : !cute.int_tuple<"?">
      %1507 = cute.get_scalars(%e2_4858) : !cute.int_tuple<"?">
      %1508 = cute.get_scalars(%e3_4859) : !cute.int_tuple<"?{div=2}">
      %iter_4860 = cute.get_iter(%view_4854) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4861, %e1_4862, %e2_4863, %e3_4864 = cute.get_leaves(%iter_4860) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1509 = cute.get_scalars(%e0_4861) : !cute.int_tuple<"?">
      %1510 = cute.get_scalars(%e1_4862) : !cute.int_tuple<"?">
      %1511 = cute.get_scalars(%e2_4863) : !cute.int_tuple<"?">
      %1512 = cute.get_scalars(%e3_4864) : !cute.int_tuple<"?{div=2}">
      %iter_4865 = cute.get_iter(%view_4854) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4866, %e1_4867, %e2_4868, %e3_4869 = cute.get_leaves(%iter_4865) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1513 = cute.get_scalars(%e0_4866) : !cute.int_tuple<"?">
      %1514 = cute.get_scalars(%e1_4867) : !cute.int_tuple<"?">
      %1515 = cute.get_scalars(%e2_4868) : !cute.int_tuple<"?">
      %1516 = cute.get_scalars(%e3_4869) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4870 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4871 = cute.add_offset(%e3_4869, %int_tuple_4870) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1517 = cute.get_scalars(%tup_4871) : !cute.int_tuple<"?">
      %coord_4872 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4873 = cute.make_coord(%tup_4871) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1518 = cute.elem_less(%coord_4872, %coord_4873) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4874 = cute.get_layout(%1502) : !memref_rmem_f32_4
      %1519 = cute.get_shape(%lay_4874) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4875, %e1_4876, %e2_4877, %e3_4878 = cute.get_leaves(%1519) : !cute.shape<"((2,2),(2,8))">
      %1520 = cute.get_stride(%lay_4874) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4879, %e1_4880, %e2_4881, %e3_4882 = cute.get_leaves(%1520) : !cute.stride<"((2,4),(1,8))">
      %1521 = scf.if %1518 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1502) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,6)">
        cute.memref.store(%1502, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,6)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1502) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1502 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1502) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1502) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1502 : !memref_rmem_f32_4
      }
      %iter_4883 = cute.get_iter(%1521) : !memref_rmem_f32_4
      %lay_4884 = cute.get_layout(%1521) : !memref_rmem_f32_4
      %1522 = cute.get_shape(%lay_4884) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4885, %e1_4886, %e2_4887, %e3_4888 = cute.get_leaves(%1522) : !cute.shape<"((2,2),(2,8))">
      %1523 = cute.get_stride(%lay_4884) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4889, %e1_4890, %e2_4891, %e3_4892 = cute.get_leaves(%1523) : !cute.stride<"((2,4),(1,8))">
      %iter_4893 = cute.get_iter(%1521) : !memref_rmem_f32_4
      %iter_4894 = cute.get_iter(%1521) : !memref_rmem_f32_4
      %coord_4895 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_4896 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4897 = cute.crd2idx(%coord_4895, %lay_4896) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_4898 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4899 = cute.add_offset(%iter_4898, %idx_4897) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4900 = cute.make_view(%tup_4899) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4901 = cute.get_iter(%view_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4902, %e1_4903, %e2_4904, %e3_4905 = cute.get_leaves(%iter_4901) : !cute.int_tuple<"(?,?,?,?)">
      %1524 = cute.get_scalars(%e0_4902) : !cute.int_tuple<"?">
      %1525 = cute.get_scalars(%e1_4903) : !cute.int_tuple<"?">
      %1526 = cute.get_scalars(%e2_4904) : !cute.int_tuple<"?">
      %1527 = cute.get_scalars(%e3_4905) : !cute.int_tuple<"?">
      %iter_4906 = cute.get_iter(%view_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4907, %e1_4908, %e2_4909, %e3_4910 = cute.get_leaves(%iter_4906) : !cute.int_tuple<"(?,?,?,?)">
      %1528 = cute.get_scalars(%e0_4907) : !cute.int_tuple<"?">
      %1529 = cute.get_scalars(%e1_4908) : !cute.int_tuple<"?">
      %1530 = cute.get_scalars(%e2_4909) : !cute.int_tuple<"?">
      %1531 = cute.get_scalars(%e3_4910) : !cute.int_tuple<"?">
      %iter_4911 = cute.get_iter(%view_4900) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4912, %e1_4913, %e2_4914, %e3_4915 = cute.get_leaves(%iter_4911) : !cute.int_tuple<"(?,?,?,?)">
      %1532 = cute.get_scalars(%e0_4912) : !cute.int_tuple<"?">
      %1533 = cute.get_scalars(%e1_4913) : !cute.int_tuple<"?">
      %1534 = cute.get_scalars(%e2_4914) : !cute.int_tuple<"?">
      %1535 = cute.get_scalars(%e3_4915) : !cute.int_tuple<"?">
      %int_tuple_4916 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4917 = cute.add_offset(%e3_4915, %int_tuple_4916) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1536 = cute.get_scalars(%tup_4917) : !cute.int_tuple<"?">
      %coord_4918 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4919 = cute.make_coord(%tup_4917) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1537 = cute.elem_less(%coord_4918, %coord_4919) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4920 = cute.get_layout(%1521) : !memref_rmem_f32_4
      %1538 = cute.get_shape(%lay_4920) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4921, %e1_4922, %e2_4923, %e3_4924 = cute.get_leaves(%1538) : !cute.shape<"((2,2),(2,8))">
      %1539 = cute.get_stride(%lay_4920) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4925, %e1_4926, %e2_4927, %e3_4928 = cute.get_leaves(%1539) : !cute.stride<"((2,4),(1,8))">
      %1540 = scf.if %1537 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1521) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,7)">
        cute.memref.store(%1521, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,7)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1521) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1521 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1521) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1521) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1521 : !memref_rmem_f32_4
      }
      %iter_4929 = cute.get_iter(%1540) : !memref_rmem_f32_4
      %lay_4930 = cute.get_layout(%1540) : !memref_rmem_f32_4
      %1541 = cute.get_shape(%lay_4930) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4931, %e1_4932, %e2_4933, %e3_4934 = cute.get_leaves(%1541) : !cute.shape<"((2,2),(2,8))">
      %1542 = cute.get_stride(%lay_4930) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4935, %e1_4936, %e2_4937, %e3_4938 = cute.get_leaves(%1542) : !cute.stride<"((2,4),(1,8))">
      %iter_4939 = cute.get_iter(%1540) : !memref_rmem_f32_4
      %iter_4940 = cute.get_iter(%1540) : !memref_rmem_f32_4
      %coord_4941 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_4942 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4943 = cute.crd2idx(%coord_4941, %lay_4942) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_4944 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4945 = cute.add_offset(%iter_4944, %idx_4943) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_4946 = cute.make_view(%tup_4945) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_4947 = cute.get_iter(%view_4946) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4948, %e1_4949, %e2_4950, %e3_4951 = cute.get_leaves(%iter_4947) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1543 = cute.get_scalars(%e0_4948) : !cute.int_tuple<"?">
      %1544 = cute.get_scalars(%e1_4949) : !cute.int_tuple<"?">
      %1545 = cute.get_scalars(%e2_4950) : !cute.int_tuple<"?">
      %1546 = cute.get_scalars(%e3_4951) : !cute.int_tuple<"?{div=2}">
      %iter_4952 = cute.get_iter(%view_4946) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4953, %e1_4954, %e2_4955, %e3_4956 = cute.get_leaves(%iter_4952) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1547 = cute.get_scalars(%e0_4953) : !cute.int_tuple<"?">
      %1548 = cute.get_scalars(%e1_4954) : !cute.int_tuple<"?">
      %1549 = cute.get_scalars(%e2_4955) : !cute.int_tuple<"?">
      %1550 = cute.get_scalars(%e3_4956) : !cute.int_tuple<"?{div=2}">
      %iter_4957 = cute.get_iter(%view_4946) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_4958, %e1_4959, %e2_4960, %e3_4961 = cute.get_leaves(%iter_4957) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1551 = cute.get_scalars(%e0_4958) : !cute.int_tuple<"?">
      %1552 = cute.get_scalars(%e1_4959) : !cute.int_tuple<"?">
      %1553 = cute.get_scalars(%e2_4960) : !cute.int_tuple<"?">
      %1554 = cute.get_scalars(%e3_4961) : !cute.int_tuple<"?{div=2}">
      %int_tuple_4962 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_4963 = cute.add_offset(%e3_4961, %int_tuple_4962) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1555 = cute.get_scalars(%tup_4963) : !cute.int_tuple<"?">
      %coord_4964 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_4965 = cute.make_coord(%tup_4963) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1556 = cute.elem_less(%coord_4964, %coord_4965) : !cute.coord<"?">, !cute.coord<"?">
      %lay_4966 = cute.get_layout(%1540) : !memref_rmem_f32_4
      %1557 = cute.get_shape(%lay_4966) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4967, %e1_4968, %e2_4969, %e3_4970 = cute.get_leaves(%1557) : !cute.shape<"((2,2),(2,8))">
      %1558 = cute.get_stride(%lay_4966) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4971, %e1_4972, %e2_4973, %e3_4974 = cute.get_leaves(%1558) : !cute.stride<"((2,4),(1,8))">
      %1559 = scf.if %1556 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1540) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,8)">
        cute.memref.store(%1540, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,8)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1540) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1540 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1540) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1540) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1540 : !memref_rmem_f32_4
      }
      %iter_4975 = cute.get_iter(%1559) : !memref_rmem_f32_4
      %lay_4976 = cute.get_layout(%1559) : !memref_rmem_f32_4
      %1560 = cute.get_shape(%lay_4976) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_4977, %e1_4978, %e2_4979, %e3_4980 = cute.get_leaves(%1560) : !cute.shape<"((2,2),(2,8))">
      %1561 = cute.get_stride(%lay_4976) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_4981, %e1_4982, %e2_4983, %e3_4984 = cute.get_leaves(%1561) : !cute.stride<"((2,4),(1,8))">
      %iter_4985 = cute.get_iter(%1559) : !memref_rmem_f32_4
      %iter_4986 = cute.get_iter(%1559) : !memref_rmem_f32_4
      %coord_4987 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_4988 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_4989 = cute.crd2idx(%coord_4987, %lay_4988) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_4990 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_4991 = cute.add_offset(%iter_4990, %idx_4989) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_4992 = cute.make_view(%tup_4991) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_4993 = cute.get_iter(%view_4992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4994, %e1_4995, %e2_4996, %e3_4997 = cute.get_leaves(%iter_4993) : !cute.int_tuple<"(?,?,?,?)">
      %1562 = cute.get_scalars(%e0_4994) : !cute.int_tuple<"?">
      %1563 = cute.get_scalars(%e1_4995) : !cute.int_tuple<"?">
      %1564 = cute.get_scalars(%e2_4996) : !cute.int_tuple<"?">
      %1565 = cute.get_scalars(%e3_4997) : !cute.int_tuple<"?">
      %iter_4998 = cute.get_iter(%view_4992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_4999, %e1_5000, %e2_5001, %e3_5002 = cute.get_leaves(%iter_4998) : !cute.int_tuple<"(?,?,?,?)">
      %1566 = cute.get_scalars(%e0_4999) : !cute.int_tuple<"?">
      %1567 = cute.get_scalars(%e1_5000) : !cute.int_tuple<"?">
      %1568 = cute.get_scalars(%e2_5001) : !cute.int_tuple<"?">
      %1569 = cute.get_scalars(%e3_5002) : !cute.int_tuple<"?">
      %iter_5003 = cute.get_iter(%view_4992) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5004, %e1_5005, %e2_5006, %e3_5007 = cute.get_leaves(%iter_5003) : !cute.int_tuple<"(?,?,?,?)">
      %1570 = cute.get_scalars(%e0_5004) : !cute.int_tuple<"?">
      %1571 = cute.get_scalars(%e1_5005) : !cute.int_tuple<"?">
      %1572 = cute.get_scalars(%e2_5006) : !cute.int_tuple<"?">
      %1573 = cute.get_scalars(%e3_5007) : !cute.int_tuple<"?">
      %int_tuple_5008 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5009 = cute.add_offset(%e3_5007, %int_tuple_5008) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1574 = cute.get_scalars(%tup_5009) : !cute.int_tuple<"?">
      %coord_5010 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5011 = cute.make_coord(%tup_5009) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1575 = cute.elem_less(%coord_5010, %coord_5011) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5012 = cute.get_layout(%1559) : !memref_rmem_f32_4
      %1576 = cute.get_shape(%lay_5012) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5013, %e1_5014, %e2_5015, %e3_5016 = cute.get_leaves(%1576) : !cute.shape<"((2,2),(2,8))">
      %1577 = cute.get_stride(%lay_5012) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5017, %e1_5018, %e2_5019, %e3_5020 = cute.get_leaves(%1577) : !cute.stride<"((2,4),(1,8))">
      %1578 = scf.if %1575 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1559) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,9)">
        cute.memref.store(%1559, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,9)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1559) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1559 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1559) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1559) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1559 : !memref_rmem_f32_4
      }
      %iter_5021 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %lay_5022 = cute.get_layout(%1578) : !memref_rmem_f32_4
      %1579 = cute.get_shape(%lay_5022) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5023, %e1_5024, %e2_5025, %e3_5026 = cute.get_leaves(%1579) : !cute.shape<"((2,2),(2,8))">
      %1580 = cute.get_stride(%lay_5022) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5027, %e1_5028, %e2_5029, %e3_5030 = cute.get_leaves(%1580) : !cute.stride<"((2,4),(1,8))">
      %iter_5031 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %iter_5032 = cute.get_iter(%1578) : !memref_rmem_f32_4
      %coord_5033 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5034 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5035 = cute.crd2idx(%coord_5033, %lay_5034) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5036 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5037 = cute.add_offset(%iter_5036, %idx_5035) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5038 = cute.make_view(%tup_5037) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5039 = cute.get_iter(%view_5038) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5040, %e1_5041, %e2_5042, %e3_5043 = cute.get_leaves(%iter_5039) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1581 = cute.get_scalars(%e0_5040) : !cute.int_tuple<"?">
      %1582 = cute.get_scalars(%e1_5041) : !cute.int_tuple<"?">
      %1583 = cute.get_scalars(%e2_5042) : !cute.int_tuple<"?">
      %1584 = cute.get_scalars(%e3_5043) : !cute.int_tuple<"?{div=2}">
      %iter_5044 = cute.get_iter(%view_5038) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5045, %e1_5046, %e2_5047, %e3_5048 = cute.get_leaves(%iter_5044) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1585 = cute.get_scalars(%e0_5045) : !cute.int_tuple<"?">
      %1586 = cute.get_scalars(%e1_5046) : !cute.int_tuple<"?">
      %1587 = cute.get_scalars(%e2_5047) : !cute.int_tuple<"?">
      %1588 = cute.get_scalars(%e3_5048) : !cute.int_tuple<"?{div=2}">
      %iter_5049 = cute.get_iter(%view_5038) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5050, %e1_5051, %e2_5052, %e3_5053 = cute.get_leaves(%iter_5049) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1589 = cute.get_scalars(%e0_5050) : !cute.int_tuple<"?">
      %1590 = cute.get_scalars(%e1_5051) : !cute.int_tuple<"?">
      %1591 = cute.get_scalars(%e2_5052) : !cute.int_tuple<"?">
      %1592 = cute.get_scalars(%e3_5053) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5054 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5055 = cute.add_offset(%e3_5053, %int_tuple_5054) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1593 = cute.get_scalars(%tup_5055) : !cute.int_tuple<"?">
      %coord_5056 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5057 = cute.make_coord(%tup_5055) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1594 = cute.elem_less(%coord_5056, %coord_5057) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5058 = cute.get_layout(%1578) : !memref_rmem_f32_4
      %1595 = cute.get_shape(%lay_5058) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5059, %e1_5060, %e2_5061, %e3_5062 = cute.get_leaves(%1595) : !cute.shape<"((2,2),(2,8))">
      %1596 = cute.get_stride(%lay_5058) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5063, %e1_5064, %e2_5065, %e3_5066 = cute.get_leaves(%1596) : !cute.stride<"((2,4),(1,8))">
      %1597 = scf.if %1594 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1578) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,10)">
        cute.memref.store(%1578, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,10)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1578) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1578 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1578) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1578) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1578 : !memref_rmem_f32_4
      }
      %iter_5067 = cute.get_iter(%1597) : !memref_rmem_f32_4
      %lay_5068 = cute.get_layout(%1597) : !memref_rmem_f32_4
      %1598 = cute.get_shape(%lay_5068) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5069, %e1_5070, %e2_5071, %e3_5072 = cute.get_leaves(%1598) : !cute.shape<"((2,2),(2,8))">
      %1599 = cute.get_stride(%lay_5068) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5073, %e1_5074, %e2_5075, %e3_5076 = cute.get_leaves(%1599) : !cute.stride<"((2,4),(1,8))">
      %iter_5077 = cute.get_iter(%1597) : !memref_rmem_f32_4
      %iter_5078 = cute.get_iter(%1597) : !memref_rmem_f32_4
      %coord_5079 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5080 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5081 = cute.crd2idx(%coord_5079, %lay_5080) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5082 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5083 = cute.add_offset(%iter_5082, %idx_5081) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5084 = cute.make_view(%tup_5083) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5085 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5086, %e1_5087, %e2_5088, %e3_5089 = cute.get_leaves(%iter_5085) : !cute.int_tuple<"(?,?,?,?)">
      %1600 = cute.get_scalars(%e0_5086) : !cute.int_tuple<"?">
      %1601 = cute.get_scalars(%e1_5087) : !cute.int_tuple<"?">
      %1602 = cute.get_scalars(%e2_5088) : !cute.int_tuple<"?">
      %1603 = cute.get_scalars(%e3_5089) : !cute.int_tuple<"?">
      %iter_5090 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5091, %e1_5092, %e2_5093, %e3_5094 = cute.get_leaves(%iter_5090) : !cute.int_tuple<"(?,?,?,?)">
      %1604 = cute.get_scalars(%e0_5091) : !cute.int_tuple<"?">
      %1605 = cute.get_scalars(%e1_5092) : !cute.int_tuple<"?">
      %1606 = cute.get_scalars(%e2_5093) : !cute.int_tuple<"?">
      %1607 = cute.get_scalars(%e3_5094) : !cute.int_tuple<"?">
      %iter_5095 = cute.get_iter(%view_5084) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5096, %e1_5097, %e2_5098, %e3_5099 = cute.get_leaves(%iter_5095) : !cute.int_tuple<"(?,?,?,?)">
      %1608 = cute.get_scalars(%e0_5096) : !cute.int_tuple<"?">
      %1609 = cute.get_scalars(%e1_5097) : !cute.int_tuple<"?">
      %1610 = cute.get_scalars(%e2_5098) : !cute.int_tuple<"?">
      %1611 = cute.get_scalars(%e3_5099) : !cute.int_tuple<"?">
      %int_tuple_5100 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5101 = cute.add_offset(%e3_5099, %int_tuple_5100) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1612 = cute.get_scalars(%tup_5101) : !cute.int_tuple<"?">
      %coord_5102 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5103 = cute.make_coord(%tup_5101) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1613 = cute.elem_less(%coord_5102, %coord_5103) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5104 = cute.get_layout(%1597) : !memref_rmem_f32_4
      %1614 = cute.get_shape(%lay_5104) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5105, %e1_5106, %e2_5107, %e3_5108 = cute.get_leaves(%1614) : !cute.shape<"((2,2),(2,8))">
      %1615 = cute.get_stride(%lay_5104) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5109, %e1_5110, %e2_5111, %e3_5112 = cute.get_leaves(%1615) : !cute.stride<"((2,4),(1,8))">
      %1616 = scf.if %1613 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1597) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,11)">
        cute.memref.store(%1597, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,11)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1597) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1597 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1597) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1597) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1597 : !memref_rmem_f32_4
      }
      %iter_5113 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %lay_5114 = cute.get_layout(%1616) : !memref_rmem_f32_4
      %1617 = cute.get_shape(%lay_5114) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5115, %e1_5116, %e2_5117, %e3_5118 = cute.get_leaves(%1617) : !cute.shape<"((2,2),(2,8))">
      %1618 = cute.get_stride(%lay_5114) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5119, %e1_5120, %e2_5121, %e3_5122 = cute.get_leaves(%1618) : !cute.stride<"((2,4),(1,8))">
      %iter_5123 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %iter_5124 = cute.get_iter(%1616) : !memref_rmem_f32_4
      %coord_5125 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5126 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5127 = cute.crd2idx(%coord_5125, %lay_5126) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5128 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5129 = cute.add_offset(%iter_5128, %idx_5127) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5130 = cute.make_view(%tup_5129) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5131 = cute.get_iter(%view_5130) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5132, %e1_5133, %e2_5134, %e3_5135 = cute.get_leaves(%iter_5131) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1619 = cute.get_scalars(%e0_5132) : !cute.int_tuple<"?">
      %1620 = cute.get_scalars(%e1_5133) : !cute.int_tuple<"?">
      %1621 = cute.get_scalars(%e2_5134) : !cute.int_tuple<"?">
      %1622 = cute.get_scalars(%e3_5135) : !cute.int_tuple<"?{div=2}">
      %iter_5136 = cute.get_iter(%view_5130) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5137, %e1_5138, %e2_5139, %e3_5140 = cute.get_leaves(%iter_5136) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1623 = cute.get_scalars(%e0_5137) : !cute.int_tuple<"?">
      %1624 = cute.get_scalars(%e1_5138) : !cute.int_tuple<"?">
      %1625 = cute.get_scalars(%e2_5139) : !cute.int_tuple<"?">
      %1626 = cute.get_scalars(%e3_5140) : !cute.int_tuple<"?{div=2}">
      %iter_5141 = cute.get_iter(%view_5130) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5142, %e1_5143, %e2_5144, %e3_5145 = cute.get_leaves(%iter_5141) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1627 = cute.get_scalars(%e0_5142) : !cute.int_tuple<"?">
      %1628 = cute.get_scalars(%e1_5143) : !cute.int_tuple<"?">
      %1629 = cute.get_scalars(%e2_5144) : !cute.int_tuple<"?">
      %1630 = cute.get_scalars(%e3_5145) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5146 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5147 = cute.add_offset(%e3_5145, %int_tuple_5146) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1631 = cute.get_scalars(%tup_5147) : !cute.int_tuple<"?">
      %coord_5148 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5149 = cute.make_coord(%tup_5147) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1632 = cute.elem_less(%coord_5148, %coord_5149) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5150 = cute.get_layout(%1616) : !memref_rmem_f32_4
      %1633 = cute.get_shape(%lay_5150) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5151, %e1_5152, %e2_5153, %e3_5154 = cute.get_leaves(%1633) : !cute.shape<"((2,2),(2,8))">
      %1634 = cute.get_stride(%lay_5150) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5155, %e1_5156, %e2_5157, %e3_5158 = cute.get_leaves(%1634) : !cute.stride<"((2,4),(1,8))">
      %1635 = scf.if %1632 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1616) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,12)">
        cute.memref.store(%1616, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,12)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1616) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1616 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1616) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1616) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1616 : !memref_rmem_f32_4
      }
      %iter_5159 = cute.get_iter(%1635) : !memref_rmem_f32_4
      %lay_5160 = cute.get_layout(%1635) : !memref_rmem_f32_4
      %1636 = cute.get_shape(%lay_5160) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5161, %e1_5162, %e2_5163, %e3_5164 = cute.get_leaves(%1636) : !cute.shape<"((2,2),(2,8))">
      %1637 = cute.get_stride(%lay_5160) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5165, %e1_5166, %e2_5167, %e3_5168 = cute.get_leaves(%1637) : !cute.stride<"((2,4),(1,8))">
      %iter_5169 = cute.get_iter(%1635) : !memref_rmem_f32_4
      %iter_5170 = cute.get_iter(%1635) : !memref_rmem_f32_4
      %coord_5171 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5172 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5173 = cute.crd2idx(%coord_5171, %lay_5172) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5174 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5175 = cute.add_offset(%iter_5174, %idx_5173) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5176 = cute.make_view(%tup_5175) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5177 = cute.get_iter(%view_5176) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5178, %e1_5179, %e2_5180, %e3_5181 = cute.get_leaves(%iter_5177) : !cute.int_tuple<"(?,?,?,?)">
      %1638 = cute.get_scalars(%e0_5178) : !cute.int_tuple<"?">
      %1639 = cute.get_scalars(%e1_5179) : !cute.int_tuple<"?">
      %1640 = cute.get_scalars(%e2_5180) : !cute.int_tuple<"?">
      %1641 = cute.get_scalars(%e3_5181) : !cute.int_tuple<"?">
      %iter_5182 = cute.get_iter(%view_5176) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5183, %e1_5184, %e2_5185, %e3_5186 = cute.get_leaves(%iter_5182) : !cute.int_tuple<"(?,?,?,?)">
      %1642 = cute.get_scalars(%e0_5183) : !cute.int_tuple<"?">
      %1643 = cute.get_scalars(%e1_5184) : !cute.int_tuple<"?">
      %1644 = cute.get_scalars(%e2_5185) : !cute.int_tuple<"?">
      %1645 = cute.get_scalars(%e3_5186) : !cute.int_tuple<"?">
      %iter_5187 = cute.get_iter(%view_5176) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5188, %e1_5189, %e2_5190, %e3_5191 = cute.get_leaves(%iter_5187) : !cute.int_tuple<"(?,?,?,?)">
      %1646 = cute.get_scalars(%e0_5188) : !cute.int_tuple<"?">
      %1647 = cute.get_scalars(%e1_5189) : !cute.int_tuple<"?">
      %1648 = cute.get_scalars(%e2_5190) : !cute.int_tuple<"?">
      %1649 = cute.get_scalars(%e3_5191) : !cute.int_tuple<"?">
      %int_tuple_5192 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5193 = cute.add_offset(%e3_5191, %int_tuple_5192) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1650 = cute.get_scalars(%tup_5193) : !cute.int_tuple<"?">
      %coord_5194 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5195 = cute.make_coord(%tup_5193) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1651 = cute.elem_less(%coord_5194, %coord_5195) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5196 = cute.get_layout(%1635) : !memref_rmem_f32_4
      %1652 = cute.get_shape(%lay_5196) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5197, %e1_5198, %e2_5199, %e3_5200 = cute.get_leaves(%1652) : !cute.shape<"((2,2),(2,8))">
      %1653 = cute.get_stride(%lay_5196) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5201, %e1_5202, %e2_5203, %e3_5204 = cute.get_leaves(%1653) : !cute.stride<"((2,4),(1,8))">
      %1654 = scf.if %1651 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1635) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,13)">
        cute.memref.store(%1635, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,13)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1635) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1635 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1635) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1635) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1635 : !memref_rmem_f32_4
      }
      %iter_5205 = cute.get_iter(%1654) : !memref_rmem_f32_4
      %lay_5206 = cute.get_layout(%1654) : !memref_rmem_f32_4
      %1655 = cute.get_shape(%lay_5206) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5207, %e1_5208, %e2_5209, %e3_5210 = cute.get_leaves(%1655) : !cute.shape<"((2,2),(2,8))">
      %1656 = cute.get_stride(%lay_5206) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5211, %e1_5212, %e2_5213, %e3_5214 = cute.get_leaves(%1656) : !cute.stride<"((2,4),(1,8))">
      %iter_5215 = cute.get_iter(%1654) : !memref_rmem_f32_4
      %iter_5216 = cute.get_iter(%1654) : !memref_rmem_f32_4
      %coord_5217 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5218 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5219 = cute.crd2idx(%coord_5217, %lay_5218) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5220 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5221 = cute.add_offset(%iter_5220, %idx_5219) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5222 = cute.make_view(%tup_5221) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5223 = cute.get_iter(%view_5222) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5224, %e1_5225, %e2_5226, %e3_5227 = cute.get_leaves(%iter_5223) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1657 = cute.get_scalars(%e0_5224) : !cute.int_tuple<"?">
      %1658 = cute.get_scalars(%e1_5225) : !cute.int_tuple<"?">
      %1659 = cute.get_scalars(%e2_5226) : !cute.int_tuple<"?">
      %1660 = cute.get_scalars(%e3_5227) : !cute.int_tuple<"?{div=2}">
      %iter_5228 = cute.get_iter(%view_5222) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5229, %e1_5230, %e2_5231, %e3_5232 = cute.get_leaves(%iter_5228) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1661 = cute.get_scalars(%e0_5229) : !cute.int_tuple<"?">
      %1662 = cute.get_scalars(%e1_5230) : !cute.int_tuple<"?">
      %1663 = cute.get_scalars(%e2_5231) : !cute.int_tuple<"?">
      %1664 = cute.get_scalars(%e3_5232) : !cute.int_tuple<"?{div=2}">
      %iter_5233 = cute.get_iter(%view_5222) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5234, %e1_5235, %e2_5236, %e3_5237 = cute.get_leaves(%iter_5233) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1665 = cute.get_scalars(%e0_5234) : !cute.int_tuple<"?">
      %1666 = cute.get_scalars(%e1_5235) : !cute.int_tuple<"?">
      %1667 = cute.get_scalars(%e2_5236) : !cute.int_tuple<"?">
      %1668 = cute.get_scalars(%e3_5237) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5238 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5239 = cute.add_offset(%e3_5237, %int_tuple_5238) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1669 = cute.get_scalars(%tup_5239) : !cute.int_tuple<"?">
      %coord_5240 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5241 = cute.make_coord(%tup_5239) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1670 = cute.elem_less(%coord_5240, %coord_5241) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5242 = cute.get_layout(%1654) : !memref_rmem_f32_4
      %1671 = cute.get_shape(%lay_5242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5243, %e1_5244, %e2_5245, %e3_5246 = cute.get_leaves(%1671) : !cute.shape<"((2,2),(2,8))">
      %1672 = cute.get_stride(%lay_5242) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5247, %e1_5248, %e2_5249, %e3_5250 = cute.get_leaves(%1672) : !cute.stride<"((2,4),(1,8))">
      %1673 = scf.if %1670 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1654) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,14)">
        cute.memref.store(%1654, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,14)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1654) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1654 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1654) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1654) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1654 : !memref_rmem_f32_4
      }
      %iter_5251 = cute.get_iter(%1673) : !memref_rmem_f32_4
      %lay_5252 = cute.get_layout(%1673) : !memref_rmem_f32_4
      %1674 = cute.get_shape(%lay_5252) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5253, %e1_5254, %e2_5255, %e3_5256 = cute.get_leaves(%1674) : !cute.shape<"((2,2),(2,8))">
      %1675 = cute.get_stride(%lay_5252) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5257, %e1_5258, %e2_5259, %e3_5260 = cute.get_leaves(%1675) : !cute.stride<"((2,4),(1,8))">
      %iter_5261 = cute.get_iter(%1673) : !memref_rmem_f32_4
      %iter_5262 = cute.get_iter(%1673) : !memref_rmem_f32_4
      %coord_5263 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_5264 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5265 = cute.crd2idx(%coord_5263, %lay_5264) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_5266 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5267 = cute.add_offset(%iter_5266, %idx_5265) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5268 = cute.make_view(%tup_5267) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5269 = cute.get_iter(%view_5268) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5270, %e1_5271, %e2_5272, %e3_5273 = cute.get_leaves(%iter_5269) : !cute.int_tuple<"(?,?,?,?)">
      %1676 = cute.get_scalars(%e0_5270) : !cute.int_tuple<"?">
      %1677 = cute.get_scalars(%e1_5271) : !cute.int_tuple<"?">
      %1678 = cute.get_scalars(%e2_5272) : !cute.int_tuple<"?">
      %1679 = cute.get_scalars(%e3_5273) : !cute.int_tuple<"?">
      %iter_5274 = cute.get_iter(%view_5268) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5275, %e1_5276, %e2_5277, %e3_5278 = cute.get_leaves(%iter_5274) : !cute.int_tuple<"(?,?,?,?)">
      %1680 = cute.get_scalars(%e0_5275) : !cute.int_tuple<"?">
      %1681 = cute.get_scalars(%e1_5276) : !cute.int_tuple<"?">
      %1682 = cute.get_scalars(%e2_5277) : !cute.int_tuple<"?">
      %1683 = cute.get_scalars(%e3_5278) : !cute.int_tuple<"?">
      %iter_5279 = cute.get_iter(%view_5268) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5280, %e1_5281, %e2_5282, %e3_5283 = cute.get_leaves(%iter_5279) : !cute.int_tuple<"(?,?,?,?)">
      %1684 = cute.get_scalars(%e0_5280) : !cute.int_tuple<"?">
      %1685 = cute.get_scalars(%e1_5281) : !cute.int_tuple<"?">
      %1686 = cute.get_scalars(%e2_5282) : !cute.int_tuple<"?">
      %1687 = cute.get_scalars(%e3_5283) : !cute.int_tuple<"?">
      %int_tuple_5284 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5285 = cute.add_offset(%e3_5283, %int_tuple_5284) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1688 = cute.get_scalars(%tup_5285) : !cute.int_tuple<"?">
      %coord_5286 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5287 = cute.make_coord(%tup_5285) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1689 = cute.elem_less(%coord_5286, %coord_5287) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5288 = cute.get_layout(%1673) : !memref_rmem_f32_4
      %1690 = cute.get_shape(%lay_5288) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5289, %e1_5290, %e2_5291, %e3_5292 = cute.get_leaves(%1690) : !cute.shape<"((2,2),(2,8))">
      %1691 = cute.get_stride(%lay_5288) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5293, %e1_5294, %e2_5295, %e3_5296 = cute.get_leaves(%1691) : !cute.stride<"((2,4),(1,8))">
      %1692 = scf.if %1689 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1673) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(2,15)">
        cute.memref.store(%1673, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(2,15)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1673) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1673 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1673) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1673) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1673 : !memref_rmem_f32_4
      }
      %iter_5297 = cute.get_iter(%1692) : !memref_rmem_f32_4
      %lay_5298 = cute.get_layout(%1692) : !memref_rmem_f32_4
      %1693 = cute.get_shape(%lay_5298) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5299, %e1_5300, %e2_5301, %e3_5302 = cute.get_leaves(%1693) : !cute.shape<"((2,2),(2,8))">
      %1694 = cute.get_stride(%lay_5298) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5303, %e1_5304, %e2_5305, %e3_5306 = cute.get_leaves(%1694) : !cute.stride<"((2,4),(1,8))">
      %iter_5307 = cute.get_iter(%1692) : !memref_rmem_f32_4
      %iter_5308 = cute.get_iter(%1692) : !memref_rmem_f32_4
      %coord_5309 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5310 = cute.get_layout(%1692) : !memref_rmem_f32_4
      %idx_5311 = cute.crd2idx(%coord_5309, %lay_5310) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5312 = cute.get_iter(%1692) : !memref_rmem_f32_4
      %ptr_5313 = cute.add_offset(%iter_5312, %idx_5311) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5314 = cute.make_view(%ptr_5313) : !memref_rmem_f32_8
      %iter_5315 = cute.get_iter(%view_5314) : !memref_rmem_f32_8
      %lay_5316 = cute.get_layout(%view_5314) : !memref_rmem_f32_8
      %1695 = cute.get_shape(%lay_5316) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5317, %e1_5318 = cute.get_leaves(%1695) : !cute.shape<"((2,8))">
      %1696 = cute.memref.load_vec %view_5314, row_major : !memref_rmem_f32_8
      %cst_5319 = arith.constant 0xFF800000 : f32
      %1697 = vector.reduction <maximumf>, %1696, %cst_5319 : vector<16xf32> into f32
      %c-1_i32_5320 = arith.constant -1 : i32
      %c2_i32_5321 = arith.constant 2 : i32
      %c31_i32_5322 = arith.constant 31 : i32
      %1698 = nvvm.shfl.sync  bfly %c-1_i32_5320, %1697, %c2_i32_5321, %c31_i32_5322 : f32 -> f32
      %1699 = nvvm.fmax %1697, %1698
      %c-1_i32_5323 = arith.constant -1 : i32
      %c1_i32_5324 = arith.constant 1 : i32
      %c31_i32_5325 = arith.constant 31 : i32
      %1700 = nvvm.shfl.sync  bfly %c-1_i32_5323, %1699, %c1_i32_5324, %c31_i32_5325 : f32 -> f32
      %1701 = nvvm.fmax %1699, %1700
      %1702 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %1703 = arith.mulf %1696, %1702 : vector<16xf32>
      %1704 = arith.mulf %1701, %arg4 : f32
      %1705 = vector.broadcast %1704 : f32 to vector<16xf32>
      %1706 = arith.subf %1703, %1705 : vector<16xf32>
      %1707 = math.exp2 %1706 fastmath<fast> : vector<16xf32>
      %cst_5326 = arith.constant 0.000000e+00 : f32
      %1708 = vector.reduction <add>, %1707, %cst_5326 : vector<16xf32> into f32
      %coord_5327 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1062, %coord_5327, %1701) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5328 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1067, %coord_5328, %1708) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_5329 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_5330 = cute.get_layout(%1692) : !memref_rmem_f32_4
      %idx_5331 = cute.crd2idx(%coord_5329, %lay_5330) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_5332 = cute.get_iter(%1692) : !memref_rmem_f32_4
      %ptr_5333 = cute.add_offset(%iter_5332, %idx_5331) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_5334 = cute.make_view(%ptr_5333) : !memref_rmem_f32_8
      %iter_5335 = cute.get_iter(%view_5334) : !memref_rmem_f32_8
      %lay_5336 = cute.get_layout(%view_5334) : !memref_rmem_f32_8
      %1709 = cute.get_shape(%lay_5336) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_5337, %e1_5338 = cute.get_leaves(%1709) : !cute.shape<"((2,8))">
      %int_tuple_5339 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5340 = cute.size(%int_tuple_5339) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5341 = cute.get_leaves(%sz_5340) : !cute.int_tuple<"16">
      %int_tuple_5342 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_5343 = cute.size(%int_tuple_5342) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_5344 = cute.get_leaves(%sz_5343) : !cute.int_tuple<"16">
      cute.memref.store_vec %1707, %view_5334, row_major : !memref_rmem_f32_8
      %int_tuple_5345 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)">
      %sz_5346 = cute.size(%int_tuple_5345) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16">
      %e0_5347 = cute.get_leaves(%sz_5346) : !cute.int_tuple<"16">
      %coord_5348 = cute.make_coord() : () -> !cute.coord<"(0,0)">
      %lay_5349 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5350 = cute.crd2idx(%coord_5348, %lay_5349) : (!cute.coord<"(0,0)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_5351 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5352 = cute.add_offset(%iter_5351, %idx_5350) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5353 = cute.make_view(%tup_5352) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5354 = cute.get_iter(%view_5353) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5355, %e1_5356, %e2_5357, %e3_5358 = cute.get_leaves(%iter_5354) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1710 = cute.get_scalars(%e0_5355) : !cute.int_tuple<"?">
      %1711 = cute.get_scalars(%e1_5356) : !cute.int_tuple<"?">
      %1712 = cute.get_scalars(%e2_5357) : !cute.int_tuple<"?">
      %1713 = cute.get_scalars(%e3_5358) : !cute.int_tuple<"?{div=2}">
      %iter_5359 = cute.get_iter(%view_5353) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5360, %e1_5361, %e2_5362, %e3_5363 = cute.get_leaves(%iter_5359) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1714 = cute.get_scalars(%e0_5360) : !cute.int_tuple<"?">
      %1715 = cute.get_scalars(%e1_5361) : !cute.int_tuple<"?">
      %1716 = cute.get_scalars(%e2_5362) : !cute.int_tuple<"?">
      %1717 = cute.get_scalars(%e3_5363) : !cute.int_tuple<"?{div=2}">
      %iter_5364 = cute.get_iter(%view_5353) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5365, %e1_5366, %e2_5367, %e3_5368 = cute.get_leaves(%iter_5364) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1718 = cute.get_scalars(%e0_5365) : !cute.int_tuple<"?">
      %1719 = cute.get_scalars(%e1_5366) : !cute.int_tuple<"?">
      %1720 = cute.get_scalars(%e2_5367) : !cute.int_tuple<"?">
      %1721 = cute.get_scalars(%e3_5368) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5369 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5370 = cute.add_offset(%e3_5368, %int_tuple_5369) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1722 = cute.get_scalars(%tup_5370) : !cute.int_tuple<"?">
      %coord_5371 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5372 = cute.make_coord(%tup_5370) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1723 = cute.elem_less(%coord_5371, %coord_5372) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5373 = cute.get_layout(%1692) : !memref_rmem_f32_4
      %1724 = cute.get_shape(%lay_5373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5374, %e1_5375, %e2_5376, %e3_5377 = cute.get_leaves(%1724) : !cute.shape<"((2,2),(2,8))">
      %1725 = cute.get_stride(%lay_5373) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5378, %e1_5379, %e2_5380, %e3_5381 = cute.get_leaves(%1725) : !cute.stride<"((2,4),(1,8))">
      %1726 = scf.if %1723 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1692) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,0)">
        cute.memref.store(%1692, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,0)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1692) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1692 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1692) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1692) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1692 : !memref_rmem_f32_4
      }
      %iter_5382 = cute.get_iter(%1726) : !memref_rmem_f32_4
      %lay_5383 = cute.get_layout(%1726) : !memref_rmem_f32_4
      %1727 = cute.get_shape(%lay_5383) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5384, %e1_5385, %e2_5386, %e3_5387 = cute.get_leaves(%1727) : !cute.shape<"((2,2),(2,8))">
      %1728 = cute.get_stride(%lay_5383) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5388, %e1_5389, %e2_5390, %e3_5391 = cute.get_leaves(%1728) : !cute.stride<"((2,4),(1,8))">
      %iter_5392 = cute.get_iter(%1726) : !memref_rmem_f32_4
      %iter_5393 = cute.get_iter(%1726) : !memref_rmem_f32_4
      %coord_5394 = cute.make_coord() : () -> !cute.coord<"(0,1)">
      %lay_5395 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5396 = cute.crd2idx(%coord_5394, %lay_5395) : (!cute.coord<"(0,1)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,1)">
      %iter_5397 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5398 = cute.add_offset(%iter_5397, %idx_5396) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,1)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5399 = cute.make_view(%tup_5398) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5400 = cute.get_iter(%view_5399) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5401, %e1_5402, %e2_5403, %e3_5404 = cute.get_leaves(%iter_5400) : !cute.int_tuple<"(?,?,?,?)">
      %1729 = cute.get_scalars(%e0_5401) : !cute.int_tuple<"?">
      %1730 = cute.get_scalars(%e1_5402) : !cute.int_tuple<"?">
      %1731 = cute.get_scalars(%e2_5403) : !cute.int_tuple<"?">
      %1732 = cute.get_scalars(%e3_5404) : !cute.int_tuple<"?">
      %iter_5405 = cute.get_iter(%view_5399) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5406, %e1_5407, %e2_5408, %e3_5409 = cute.get_leaves(%iter_5405) : !cute.int_tuple<"(?,?,?,?)">
      %1733 = cute.get_scalars(%e0_5406) : !cute.int_tuple<"?">
      %1734 = cute.get_scalars(%e1_5407) : !cute.int_tuple<"?">
      %1735 = cute.get_scalars(%e2_5408) : !cute.int_tuple<"?">
      %1736 = cute.get_scalars(%e3_5409) : !cute.int_tuple<"?">
      %iter_5410 = cute.get_iter(%view_5399) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5411, %e1_5412, %e2_5413, %e3_5414 = cute.get_leaves(%iter_5410) : !cute.int_tuple<"(?,?,?,?)">
      %1737 = cute.get_scalars(%e0_5411) : !cute.int_tuple<"?">
      %1738 = cute.get_scalars(%e1_5412) : !cute.int_tuple<"?">
      %1739 = cute.get_scalars(%e2_5413) : !cute.int_tuple<"?">
      %1740 = cute.get_scalars(%e3_5414) : !cute.int_tuple<"?">
      %int_tuple_5415 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5416 = cute.add_offset(%e3_5414, %int_tuple_5415) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1741 = cute.get_scalars(%tup_5416) : !cute.int_tuple<"?">
      %coord_5417 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5418 = cute.make_coord(%tup_5416) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1742 = cute.elem_less(%coord_5417, %coord_5418) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5419 = cute.get_layout(%1726) : !memref_rmem_f32_4
      %1743 = cute.get_shape(%lay_5419) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5420, %e1_5421, %e2_5422, %e3_5423 = cute.get_leaves(%1743) : !cute.shape<"((2,2),(2,8))">
      %1744 = cute.get_stride(%lay_5419) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5424, %e1_5425, %e2_5426, %e3_5427 = cute.get_leaves(%1744) : !cute.stride<"((2,4),(1,8))">
      %1745 = scf.if %1742 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1726) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,1)">
        cute.memref.store(%1726, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,1)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1726) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1726 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1726) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1726) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1726 : !memref_rmem_f32_4
      }
      %iter_5428 = cute.get_iter(%1745) : !memref_rmem_f32_4
      %lay_5429 = cute.get_layout(%1745) : !memref_rmem_f32_4
      %1746 = cute.get_shape(%lay_5429) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5430, %e1_5431, %e2_5432, %e3_5433 = cute.get_leaves(%1746) : !cute.shape<"((2,2),(2,8))">
      %1747 = cute.get_stride(%lay_5429) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5434, %e1_5435, %e2_5436, %e3_5437 = cute.get_leaves(%1747) : !cute.stride<"((2,4),(1,8))">
      %iter_5438 = cute.get_iter(%1745) : !memref_rmem_f32_4
      %iter_5439 = cute.get_iter(%1745) : !memref_rmem_f32_4
      %coord_5440 = cute.make_coord() : () -> !cute.coord<"(0,2)">
      %lay_5441 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5442 = cute.crd2idx(%coord_5440, %lay_5441) : (!cute.coord<"(0,2)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,8)">
      %iter_5443 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5444 = cute.add_offset(%iter_5443, %idx_5442) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,8)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5445 = cute.make_view(%tup_5444) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5446 = cute.get_iter(%view_5445) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5447, %e1_5448, %e2_5449, %e3_5450 = cute.get_leaves(%iter_5446) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1748 = cute.get_scalars(%e0_5447) : !cute.int_tuple<"?">
      %1749 = cute.get_scalars(%e1_5448) : !cute.int_tuple<"?">
      %1750 = cute.get_scalars(%e2_5449) : !cute.int_tuple<"?">
      %1751 = cute.get_scalars(%e3_5450) : !cute.int_tuple<"?{div=2}">
      %iter_5451 = cute.get_iter(%view_5445) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5452, %e1_5453, %e2_5454, %e3_5455 = cute.get_leaves(%iter_5451) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1752 = cute.get_scalars(%e0_5452) : !cute.int_tuple<"?">
      %1753 = cute.get_scalars(%e1_5453) : !cute.int_tuple<"?">
      %1754 = cute.get_scalars(%e2_5454) : !cute.int_tuple<"?">
      %1755 = cute.get_scalars(%e3_5455) : !cute.int_tuple<"?{div=2}">
      %iter_5456 = cute.get_iter(%view_5445) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5457, %e1_5458, %e2_5459, %e3_5460 = cute.get_leaves(%iter_5456) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1756 = cute.get_scalars(%e0_5457) : !cute.int_tuple<"?">
      %1757 = cute.get_scalars(%e1_5458) : !cute.int_tuple<"?">
      %1758 = cute.get_scalars(%e2_5459) : !cute.int_tuple<"?">
      %1759 = cute.get_scalars(%e3_5460) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5461 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5462 = cute.add_offset(%e3_5460, %int_tuple_5461) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1760 = cute.get_scalars(%tup_5462) : !cute.int_tuple<"?">
      %coord_5463 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5464 = cute.make_coord(%tup_5462) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1761 = cute.elem_less(%coord_5463, %coord_5464) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5465 = cute.get_layout(%1745) : !memref_rmem_f32_4
      %1762 = cute.get_shape(%lay_5465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5466, %e1_5467, %e2_5468, %e3_5469 = cute.get_leaves(%1762) : !cute.shape<"((2,2),(2,8))">
      %1763 = cute.get_stride(%lay_5465) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5470, %e1_5471, %e2_5472, %e3_5473 = cute.get_leaves(%1763) : !cute.stride<"((2,4),(1,8))">
      %1764 = scf.if %1761 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1745) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,2)">
        cute.memref.store(%1745, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,2)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1745) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1745 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1745) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1745) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1745 : !memref_rmem_f32_4
      }
      %iter_5474 = cute.get_iter(%1764) : !memref_rmem_f32_4
      %lay_5475 = cute.get_layout(%1764) : !memref_rmem_f32_4
      %1765 = cute.get_shape(%lay_5475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5476, %e1_5477, %e2_5478, %e3_5479 = cute.get_leaves(%1765) : !cute.shape<"((2,2),(2,8))">
      %1766 = cute.get_stride(%lay_5475) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5480, %e1_5481, %e2_5482, %e3_5483 = cute.get_leaves(%1766) : !cute.stride<"((2,4),(1,8))">
      %iter_5484 = cute.get_iter(%1764) : !memref_rmem_f32_4
      %iter_5485 = cute.get_iter(%1764) : !memref_rmem_f32_4
      %coord_5486 = cute.make_coord() : () -> !cute.coord<"(0,3)">
      %lay_5487 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5488 = cute.crd2idx(%coord_5486, %lay_5487) : (!cute.coord<"(0,3)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,9)">
      %iter_5489 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5490 = cute.add_offset(%iter_5489, %idx_5488) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,9)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5491 = cute.make_view(%tup_5490) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5492 = cute.get_iter(%view_5491) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5493, %e1_5494, %e2_5495, %e3_5496 = cute.get_leaves(%iter_5492) : !cute.int_tuple<"(?,?,?,?)">
      %1767 = cute.get_scalars(%e0_5493) : !cute.int_tuple<"?">
      %1768 = cute.get_scalars(%e1_5494) : !cute.int_tuple<"?">
      %1769 = cute.get_scalars(%e2_5495) : !cute.int_tuple<"?">
      %1770 = cute.get_scalars(%e3_5496) : !cute.int_tuple<"?">
      %iter_5497 = cute.get_iter(%view_5491) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5498, %e1_5499, %e2_5500, %e3_5501 = cute.get_leaves(%iter_5497) : !cute.int_tuple<"(?,?,?,?)">
      %1771 = cute.get_scalars(%e0_5498) : !cute.int_tuple<"?">
      %1772 = cute.get_scalars(%e1_5499) : !cute.int_tuple<"?">
      %1773 = cute.get_scalars(%e2_5500) : !cute.int_tuple<"?">
      %1774 = cute.get_scalars(%e3_5501) : !cute.int_tuple<"?">
      %iter_5502 = cute.get_iter(%view_5491) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5503, %e1_5504, %e2_5505, %e3_5506 = cute.get_leaves(%iter_5502) : !cute.int_tuple<"(?,?,?,?)">
      %1775 = cute.get_scalars(%e0_5503) : !cute.int_tuple<"?">
      %1776 = cute.get_scalars(%e1_5504) : !cute.int_tuple<"?">
      %1777 = cute.get_scalars(%e2_5505) : !cute.int_tuple<"?">
      %1778 = cute.get_scalars(%e3_5506) : !cute.int_tuple<"?">
      %int_tuple_5507 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5508 = cute.add_offset(%e3_5506, %int_tuple_5507) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1779 = cute.get_scalars(%tup_5508) : !cute.int_tuple<"?">
      %coord_5509 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5510 = cute.make_coord(%tup_5508) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1780 = cute.elem_less(%coord_5509, %coord_5510) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5511 = cute.get_layout(%1764) : !memref_rmem_f32_4
      %1781 = cute.get_shape(%lay_5511) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5512, %e1_5513, %e2_5514, %e3_5515 = cute.get_leaves(%1781) : !cute.shape<"((2,2),(2,8))">
      %1782 = cute.get_stride(%lay_5511) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5516, %e1_5517, %e2_5518, %e3_5519 = cute.get_leaves(%1782) : !cute.stride<"((2,4),(1,8))">
      %1783 = scf.if %1780 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1764) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,3)">
        cute.memref.store(%1764, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,3)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1764) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1764 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1764) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1764) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1764 : !memref_rmem_f32_4
      }
      %iter_5520 = cute.get_iter(%1783) : !memref_rmem_f32_4
      %lay_5521 = cute.get_layout(%1783) : !memref_rmem_f32_4
      %1784 = cute.get_shape(%lay_5521) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5522, %e1_5523, %e2_5524, %e3_5525 = cute.get_leaves(%1784) : !cute.shape<"((2,2),(2,8))">
      %1785 = cute.get_stride(%lay_5521) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5526, %e1_5527, %e2_5528, %e3_5529 = cute.get_leaves(%1785) : !cute.stride<"((2,4),(1,8))">
      %iter_5530 = cute.get_iter(%1783) : !memref_rmem_f32_4
      %iter_5531 = cute.get_iter(%1783) : !memref_rmem_f32_4
      %coord_5532 = cute.make_coord() : () -> !cute.coord<"(0,4)">
      %lay_5533 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5534 = cute.crd2idx(%coord_5532, %lay_5533) : (!cute.coord<"(0,4)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,16)">
      %iter_5535 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5536 = cute.add_offset(%iter_5535, %idx_5534) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,16)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5537 = cute.make_view(%tup_5536) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5538 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5539, %e1_5540, %e2_5541, %e3_5542 = cute.get_leaves(%iter_5538) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1786 = cute.get_scalars(%e0_5539) : !cute.int_tuple<"?">
      %1787 = cute.get_scalars(%e1_5540) : !cute.int_tuple<"?">
      %1788 = cute.get_scalars(%e2_5541) : !cute.int_tuple<"?">
      %1789 = cute.get_scalars(%e3_5542) : !cute.int_tuple<"?{div=2}">
      %iter_5543 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5544, %e1_5545, %e2_5546, %e3_5547 = cute.get_leaves(%iter_5543) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1790 = cute.get_scalars(%e0_5544) : !cute.int_tuple<"?">
      %1791 = cute.get_scalars(%e1_5545) : !cute.int_tuple<"?">
      %1792 = cute.get_scalars(%e2_5546) : !cute.int_tuple<"?">
      %1793 = cute.get_scalars(%e3_5547) : !cute.int_tuple<"?{div=2}">
      %iter_5548 = cute.get_iter(%view_5537) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5549, %e1_5550, %e2_5551, %e3_5552 = cute.get_leaves(%iter_5548) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1794 = cute.get_scalars(%e0_5549) : !cute.int_tuple<"?">
      %1795 = cute.get_scalars(%e1_5550) : !cute.int_tuple<"?">
      %1796 = cute.get_scalars(%e2_5551) : !cute.int_tuple<"?">
      %1797 = cute.get_scalars(%e3_5552) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5553 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5554 = cute.add_offset(%e3_5552, %int_tuple_5553) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1798 = cute.get_scalars(%tup_5554) : !cute.int_tuple<"?">
      %coord_5555 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5556 = cute.make_coord(%tup_5554) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1799 = cute.elem_less(%coord_5555, %coord_5556) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5557 = cute.get_layout(%1783) : !memref_rmem_f32_4
      %1800 = cute.get_shape(%lay_5557) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5558, %e1_5559, %e2_5560, %e3_5561 = cute.get_leaves(%1800) : !cute.shape<"((2,2),(2,8))">
      %1801 = cute.get_stride(%lay_5557) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5562, %e1_5563, %e2_5564, %e3_5565 = cute.get_leaves(%1801) : !cute.stride<"((2,4),(1,8))">
      %1802 = scf.if %1799 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1783) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,4)">
        cute.memref.store(%1783, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,4)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1783) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1783 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1783) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1783) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1783 : !memref_rmem_f32_4
      }
      %iter_5566 = cute.get_iter(%1802) : !memref_rmem_f32_4
      %lay_5567 = cute.get_layout(%1802) : !memref_rmem_f32_4
      %1803 = cute.get_shape(%lay_5567) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5568, %e1_5569, %e2_5570, %e3_5571 = cute.get_leaves(%1803) : !cute.shape<"((2,2),(2,8))">
      %1804 = cute.get_stride(%lay_5567) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5572, %e1_5573, %e2_5574, %e3_5575 = cute.get_leaves(%1804) : !cute.stride<"((2,4),(1,8))">
      %iter_5576 = cute.get_iter(%1802) : !memref_rmem_f32_4
      %iter_5577 = cute.get_iter(%1802) : !memref_rmem_f32_4
      %coord_5578 = cute.make_coord() : () -> !cute.coord<"(0,5)">
      %lay_5579 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5580 = cute.crd2idx(%coord_5578, %lay_5579) : (!cute.coord<"(0,5)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,17)">
      %iter_5581 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5582 = cute.add_offset(%iter_5581, %idx_5580) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,17)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5583 = cute.make_view(%tup_5582) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5584 = cute.get_iter(%view_5583) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5585, %e1_5586, %e2_5587, %e3_5588 = cute.get_leaves(%iter_5584) : !cute.int_tuple<"(?,?,?,?)">
      %1805 = cute.get_scalars(%e0_5585) : !cute.int_tuple<"?">
      %1806 = cute.get_scalars(%e1_5586) : !cute.int_tuple<"?">
      %1807 = cute.get_scalars(%e2_5587) : !cute.int_tuple<"?">
      %1808 = cute.get_scalars(%e3_5588) : !cute.int_tuple<"?">
      %iter_5589 = cute.get_iter(%view_5583) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5590, %e1_5591, %e2_5592, %e3_5593 = cute.get_leaves(%iter_5589) : !cute.int_tuple<"(?,?,?,?)">
      %1809 = cute.get_scalars(%e0_5590) : !cute.int_tuple<"?">
      %1810 = cute.get_scalars(%e1_5591) : !cute.int_tuple<"?">
      %1811 = cute.get_scalars(%e2_5592) : !cute.int_tuple<"?">
      %1812 = cute.get_scalars(%e3_5593) : !cute.int_tuple<"?">
      %iter_5594 = cute.get_iter(%view_5583) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5595, %e1_5596, %e2_5597, %e3_5598 = cute.get_leaves(%iter_5594) : !cute.int_tuple<"(?,?,?,?)">
      %1813 = cute.get_scalars(%e0_5595) : !cute.int_tuple<"?">
      %1814 = cute.get_scalars(%e1_5596) : !cute.int_tuple<"?">
      %1815 = cute.get_scalars(%e2_5597) : !cute.int_tuple<"?">
      %1816 = cute.get_scalars(%e3_5598) : !cute.int_tuple<"?">
      %int_tuple_5599 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5600 = cute.add_offset(%e3_5598, %int_tuple_5599) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1817 = cute.get_scalars(%tup_5600) : !cute.int_tuple<"?">
      %coord_5601 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5602 = cute.make_coord(%tup_5600) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1818 = cute.elem_less(%coord_5601, %coord_5602) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5603 = cute.get_layout(%1802) : !memref_rmem_f32_4
      %1819 = cute.get_shape(%lay_5603) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5604, %e1_5605, %e2_5606, %e3_5607 = cute.get_leaves(%1819) : !cute.shape<"((2,2),(2,8))">
      %1820 = cute.get_stride(%lay_5603) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5608, %e1_5609, %e2_5610, %e3_5611 = cute.get_leaves(%1820) : !cute.stride<"((2,4),(1,8))">
      %1821 = scf.if %1818 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1802) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,5)">
        cute.memref.store(%1802, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,5)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1802) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1802 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1802) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1802) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1802 : !memref_rmem_f32_4
      }
      %iter_5612 = cute.get_iter(%1821) : !memref_rmem_f32_4
      %lay_5613 = cute.get_layout(%1821) : !memref_rmem_f32_4
      %1822 = cute.get_shape(%lay_5613) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5614, %e1_5615, %e2_5616, %e3_5617 = cute.get_leaves(%1822) : !cute.shape<"((2,2),(2,8))">
      %1823 = cute.get_stride(%lay_5613) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5618, %e1_5619, %e2_5620, %e3_5621 = cute.get_leaves(%1823) : !cute.stride<"((2,4),(1,8))">
      %iter_5622 = cute.get_iter(%1821) : !memref_rmem_f32_4
      %iter_5623 = cute.get_iter(%1821) : !memref_rmem_f32_4
      %coord_5624 = cute.make_coord() : () -> !cute.coord<"(0,6)">
      %lay_5625 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5626 = cute.crd2idx(%coord_5624, %lay_5625) : (!cute.coord<"(0,6)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,24)">
      %iter_5627 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5628 = cute.add_offset(%iter_5627, %idx_5626) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,24)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5629 = cute.make_view(%tup_5628) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5630 = cute.get_iter(%view_5629) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5631, %e1_5632, %e2_5633, %e3_5634 = cute.get_leaves(%iter_5630) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1824 = cute.get_scalars(%e0_5631) : !cute.int_tuple<"?">
      %1825 = cute.get_scalars(%e1_5632) : !cute.int_tuple<"?">
      %1826 = cute.get_scalars(%e2_5633) : !cute.int_tuple<"?">
      %1827 = cute.get_scalars(%e3_5634) : !cute.int_tuple<"?{div=2}">
      %iter_5635 = cute.get_iter(%view_5629) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5636, %e1_5637, %e2_5638, %e3_5639 = cute.get_leaves(%iter_5635) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1828 = cute.get_scalars(%e0_5636) : !cute.int_tuple<"?">
      %1829 = cute.get_scalars(%e1_5637) : !cute.int_tuple<"?">
      %1830 = cute.get_scalars(%e2_5638) : !cute.int_tuple<"?">
      %1831 = cute.get_scalars(%e3_5639) : !cute.int_tuple<"?{div=2}">
      %iter_5640 = cute.get_iter(%view_5629) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5641, %e1_5642, %e2_5643, %e3_5644 = cute.get_leaves(%iter_5640) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1832 = cute.get_scalars(%e0_5641) : !cute.int_tuple<"?">
      %1833 = cute.get_scalars(%e1_5642) : !cute.int_tuple<"?">
      %1834 = cute.get_scalars(%e2_5643) : !cute.int_tuple<"?">
      %1835 = cute.get_scalars(%e3_5644) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5645 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5646 = cute.add_offset(%e3_5644, %int_tuple_5645) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1836 = cute.get_scalars(%tup_5646) : !cute.int_tuple<"?">
      %coord_5647 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5648 = cute.make_coord(%tup_5646) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1837 = cute.elem_less(%coord_5647, %coord_5648) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5649 = cute.get_layout(%1821) : !memref_rmem_f32_4
      %1838 = cute.get_shape(%lay_5649) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5650, %e1_5651, %e2_5652, %e3_5653 = cute.get_leaves(%1838) : !cute.shape<"((2,2),(2,8))">
      %1839 = cute.get_stride(%lay_5649) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5654, %e1_5655, %e2_5656, %e3_5657 = cute.get_leaves(%1839) : !cute.stride<"((2,4),(1,8))">
      %1840 = scf.if %1837 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1821) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,6)">
        cute.memref.store(%1821, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,6)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1821) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1821 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1821) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1821) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1821 : !memref_rmem_f32_4
      }
      %iter_5658 = cute.get_iter(%1840) : !memref_rmem_f32_4
      %lay_5659 = cute.get_layout(%1840) : !memref_rmem_f32_4
      %1841 = cute.get_shape(%lay_5659) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5660, %e1_5661, %e2_5662, %e3_5663 = cute.get_leaves(%1841) : !cute.shape<"((2,2),(2,8))">
      %1842 = cute.get_stride(%lay_5659) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5664, %e1_5665, %e2_5666, %e3_5667 = cute.get_leaves(%1842) : !cute.stride<"((2,4),(1,8))">
      %iter_5668 = cute.get_iter(%1840) : !memref_rmem_f32_4
      %iter_5669 = cute.get_iter(%1840) : !memref_rmem_f32_4
      %coord_5670 = cute.make_coord() : () -> !cute.coord<"(0,7)">
      %lay_5671 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5672 = cute.crd2idx(%coord_5670, %lay_5671) : (!cute.coord<"(0,7)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,25)">
      %iter_5673 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5674 = cute.add_offset(%iter_5673, %idx_5672) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,25)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5675 = cute.make_view(%tup_5674) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5676 = cute.get_iter(%view_5675) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5677, %e1_5678, %e2_5679, %e3_5680 = cute.get_leaves(%iter_5676) : !cute.int_tuple<"(?,?,?,?)">
      %1843 = cute.get_scalars(%e0_5677) : !cute.int_tuple<"?">
      %1844 = cute.get_scalars(%e1_5678) : !cute.int_tuple<"?">
      %1845 = cute.get_scalars(%e2_5679) : !cute.int_tuple<"?">
      %1846 = cute.get_scalars(%e3_5680) : !cute.int_tuple<"?">
      %iter_5681 = cute.get_iter(%view_5675) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5682, %e1_5683, %e2_5684, %e3_5685 = cute.get_leaves(%iter_5681) : !cute.int_tuple<"(?,?,?,?)">
      %1847 = cute.get_scalars(%e0_5682) : !cute.int_tuple<"?">
      %1848 = cute.get_scalars(%e1_5683) : !cute.int_tuple<"?">
      %1849 = cute.get_scalars(%e2_5684) : !cute.int_tuple<"?">
      %1850 = cute.get_scalars(%e3_5685) : !cute.int_tuple<"?">
      %iter_5686 = cute.get_iter(%view_5675) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5687, %e1_5688, %e2_5689, %e3_5690 = cute.get_leaves(%iter_5686) : !cute.int_tuple<"(?,?,?,?)">
      %1851 = cute.get_scalars(%e0_5687) : !cute.int_tuple<"?">
      %1852 = cute.get_scalars(%e1_5688) : !cute.int_tuple<"?">
      %1853 = cute.get_scalars(%e2_5689) : !cute.int_tuple<"?">
      %1854 = cute.get_scalars(%e3_5690) : !cute.int_tuple<"?">
      %int_tuple_5691 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5692 = cute.add_offset(%e3_5690, %int_tuple_5691) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1855 = cute.get_scalars(%tup_5692) : !cute.int_tuple<"?">
      %coord_5693 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5694 = cute.make_coord(%tup_5692) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1856 = cute.elem_less(%coord_5693, %coord_5694) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5695 = cute.get_layout(%1840) : !memref_rmem_f32_4
      %1857 = cute.get_shape(%lay_5695) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5696, %e1_5697, %e2_5698, %e3_5699 = cute.get_leaves(%1857) : !cute.shape<"((2,2),(2,8))">
      %1858 = cute.get_stride(%lay_5695) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5700, %e1_5701, %e2_5702, %e3_5703 = cute.get_leaves(%1858) : !cute.stride<"((2,4),(1,8))">
      %1859 = scf.if %1856 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1840) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,7)">
        cute.memref.store(%1840, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,7)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1840) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1840 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1840) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1840) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1840 : !memref_rmem_f32_4
      }
      %iter_5704 = cute.get_iter(%1859) : !memref_rmem_f32_4
      %lay_5705 = cute.get_layout(%1859) : !memref_rmem_f32_4
      %1860 = cute.get_shape(%lay_5705) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5706, %e1_5707, %e2_5708, %e3_5709 = cute.get_leaves(%1860) : !cute.shape<"((2,2),(2,8))">
      %1861 = cute.get_stride(%lay_5705) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5710, %e1_5711, %e2_5712, %e3_5713 = cute.get_leaves(%1861) : !cute.stride<"((2,4),(1,8))">
      %iter_5714 = cute.get_iter(%1859) : !memref_rmem_f32_4
      %iter_5715 = cute.get_iter(%1859) : !memref_rmem_f32_4
      %coord_5716 = cute.make_coord() : () -> !cute.coord<"(0,8)">
      %lay_5717 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5718 = cute.crd2idx(%coord_5716, %lay_5717) : (!cute.coord<"(0,8)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,32)">
      %iter_5719 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5720 = cute.add_offset(%iter_5719, %idx_5718) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,32)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5721 = cute.make_view(%tup_5720) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5722 = cute.get_iter(%view_5721) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5723, %e1_5724, %e2_5725, %e3_5726 = cute.get_leaves(%iter_5722) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1862 = cute.get_scalars(%e0_5723) : !cute.int_tuple<"?">
      %1863 = cute.get_scalars(%e1_5724) : !cute.int_tuple<"?">
      %1864 = cute.get_scalars(%e2_5725) : !cute.int_tuple<"?">
      %1865 = cute.get_scalars(%e3_5726) : !cute.int_tuple<"?{div=2}">
      %iter_5727 = cute.get_iter(%view_5721) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5728, %e1_5729, %e2_5730, %e3_5731 = cute.get_leaves(%iter_5727) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1866 = cute.get_scalars(%e0_5728) : !cute.int_tuple<"?">
      %1867 = cute.get_scalars(%e1_5729) : !cute.int_tuple<"?">
      %1868 = cute.get_scalars(%e2_5730) : !cute.int_tuple<"?">
      %1869 = cute.get_scalars(%e3_5731) : !cute.int_tuple<"?{div=2}">
      %iter_5732 = cute.get_iter(%view_5721) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5733, %e1_5734, %e2_5735, %e3_5736 = cute.get_leaves(%iter_5732) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1870 = cute.get_scalars(%e0_5733) : !cute.int_tuple<"?">
      %1871 = cute.get_scalars(%e1_5734) : !cute.int_tuple<"?">
      %1872 = cute.get_scalars(%e2_5735) : !cute.int_tuple<"?">
      %1873 = cute.get_scalars(%e3_5736) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5737 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5738 = cute.add_offset(%e3_5736, %int_tuple_5737) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1874 = cute.get_scalars(%tup_5738) : !cute.int_tuple<"?">
      %coord_5739 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5740 = cute.make_coord(%tup_5738) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1875 = cute.elem_less(%coord_5739, %coord_5740) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5741 = cute.get_layout(%1859) : !memref_rmem_f32_4
      %1876 = cute.get_shape(%lay_5741) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5742, %e1_5743, %e2_5744, %e3_5745 = cute.get_leaves(%1876) : !cute.shape<"((2,2),(2,8))">
      %1877 = cute.get_stride(%lay_5741) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5746, %e1_5747, %e2_5748, %e3_5749 = cute.get_leaves(%1877) : !cute.stride<"((2,4),(1,8))">
      %1878 = scf.if %1875 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1859) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,8)">
        cute.memref.store(%1859, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,8)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1859) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1859 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1859) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1859) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1859 : !memref_rmem_f32_4
      }
      %iter_5750 = cute.get_iter(%1878) : !memref_rmem_f32_4
      %lay_5751 = cute.get_layout(%1878) : !memref_rmem_f32_4
      %1879 = cute.get_shape(%lay_5751) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5752, %e1_5753, %e2_5754, %e3_5755 = cute.get_leaves(%1879) : !cute.shape<"((2,2),(2,8))">
      %1880 = cute.get_stride(%lay_5751) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5756, %e1_5757, %e2_5758, %e3_5759 = cute.get_leaves(%1880) : !cute.stride<"((2,4),(1,8))">
      %iter_5760 = cute.get_iter(%1878) : !memref_rmem_f32_4
      %iter_5761 = cute.get_iter(%1878) : !memref_rmem_f32_4
      %coord_5762 = cute.make_coord() : () -> !cute.coord<"(0,9)">
      %lay_5763 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5764 = cute.crd2idx(%coord_5762, %lay_5763) : (!cute.coord<"(0,9)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,33)">
      %iter_5765 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5766 = cute.add_offset(%iter_5765, %idx_5764) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,33)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5767 = cute.make_view(%tup_5766) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5768 = cute.get_iter(%view_5767) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5769, %e1_5770, %e2_5771, %e3_5772 = cute.get_leaves(%iter_5768) : !cute.int_tuple<"(?,?,?,?)">
      %1881 = cute.get_scalars(%e0_5769) : !cute.int_tuple<"?">
      %1882 = cute.get_scalars(%e1_5770) : !cute.int_tuple<"?">
      %1883 = cute.get_scalars(%e2_5771) : !cute.int_tuple<"?">
      %1884 = cute.get_scalars(%e3_5772) : !cute.int_tuple<"?">
      %iter_5773 = cute.get_iter(%view_5767) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5774, %e1_5775, %e2_5776, %e3_5777 = cute.get_leaves(%iter_5773) : !cute.int_tuple<"(?,?,?,?)">
      %1885 = cute.get_scalars(%e0_5774) : !cute.int_tuple<"?">
      %1886 = cute.get_scalars(%e1_5775) : !cute.int_tuple<"?">
      %1887 = cute.get_scalars(%e2_5776) : !cute.int_tuple<"?">
      %1888 = cute.get_scalars(%e3_5777) : !cute.int_tuple<"?">
      %iter_5778 = cute.get_iter(%view_5767) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5779, %e1_5780, %e2_5781, %e3_5782 = cute.get_leaves(%iter_5778) : !cute.int_tuple<"(?,?,?,?)">
      %1889 = cute.get_scalars(%e0_5779) : !cute.int_tuple<"?">
      %1890 = cute.get_scalars(%e1_5780) : !cute.int_tuple<"?">
      %1891 = cute.get_scalars(%e2_5781) : !cute.int_tuple<"?">
      %1892 = cute.get_scalars(%e3_5782) : !cute.int_tuple<"?">
      %int_tuple_5783 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5784 = cute.add_offset(%e3_5782, %int_tuple_5783) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1893 = cute.get_scalars(%tup_5784) : !cute.int_tuple<"?">
      %coord_5785 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5786 = cute.make_coord(%tup_5784) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1894 = cute.elem_less(%coord_5785, %coord_5786) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5787 = cute.get_layout(%1878) : !memref_rmem_f32_4
      %1895 = cute.get_shape(%lay_5787) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5788, %e1_5789, %e2_5790, %e3_5791 = cute.get_leaves(%1895) : !cute.shape<"((2,2),(2,8))">
      %1896 = cute.get_stride(%lay_5787) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5792, %e1_5793, %e2_5794, %e3_5795 = cute.get_leaves(%1896) : !cute.stride<"((2,4),(1,8))">
      %1897 = scf.if %1894 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1878) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,9)">
        cute.memref.store(%1878, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,9)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1878) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1878 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1878) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1878) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1878 : !memref_rmem_f32_4
      }
      %iter_5796 = cute.get_iter(%1897) : !memref_rmem_f32_4
      %lay_5797 = cute.get_layout(%1897) : !memref_rmem_f32_4
      %1898 = cute.get_shape(%lay_5797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5798, %e1_5799, %e2_5800, %e3_5801 = cute.get_leaves(%1898) : !cute.shape<"((2,2),(2,8))">
      %1899 = cute.get_stride(%lay_5797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5802, %e1_5803, %e2_5804, %e3_5805 = cute.get_leaves(%1899) : !cute.stride<"((2,4),(1,8))">
      %iter_5806 = cute.get_iter(%1897) : !memref_rmem_f32_4
      %iter_5807 = cute.get_iter(%1897) : !memref_rmem_f32_4
      %coord_5808 = cute.make_coord() : () -> !cute.coord<"(0,10)">
      %lay_5809 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5810 = cute.crd2idx(%coord_5808, %lay_5809) : (!cute.coord<"(0,10)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,40)">
      %iter_5811 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5812 = cute.add_offset(%iter_5811, %idx_5810) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,40)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5813 = cute.make_view(%tup_5812) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5814 = cute.get_iter(%view_5813) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5815, %e1_5816, %e2_5817, %e3_5818 = cute.get_leaves(%iter_5814) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1900 = cute.get_scalars(%e0_5815) : !cute.int_tuple<"?">
      %1901 = cute.get_scalars(%e1_5816) : !cute.int_tuple<"?">
      %1902 = cute.get_scalars(%e2_5817) : !cute.int_tuple<"?">
      %1903 = cute.get_scalars(%e3_5818) : !cute.int_tuple<"?{div=2}">
      %iter_5819 = cute.get_iter(%view_5813) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5820, %e1_5821, %e2_5822, %e3_5823 = cute.get_leaves(%iter_5819) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1904 = cute.get_scalars(%e0_5820) : !cute.int_tuple<"?">
      %1905 = cute.get_scalars(%e1_5821) : !cute.int_tuple<"?">
      %1906 = cute.get_scalars(%e2_5822) : !cute.int_tuple<"?">
      %1907 = cute.get_scalars(%e3_5823) : !cute.int_tuple<"?{div=2}">
      %iter_5824 = cute.get_iter(%view_5813) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5825, %e1_5826, %e2_5827, %e3_5828 = cute.get_leaves(%iter_5824) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1908 = cute.get_scalars(%e0_5825) : !cute.int_tuple<"?">
      %1909 = cute.get_scalars(%e1_5826) : !cute.int_tuple<"?">
      %1910 = cute.get_scalars(%e2_5827) : !cute.int_tuple<"?">
      %1911 = cute.get_scalars(%e3_5828) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5829 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5830 = cute.add_offset(%e3_5828, %int_tuple_5829) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1912 = cute.get_scalars(%tup_5830) : !cute.int_tuple<"?">
      %coord_5831 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5832 = cute.make_coord(%tup_5830) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1913 = cute.elem_less(%coord_5831, %coord_5832) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5833 = cute.get_layout(%1897) : !memref_rmem_f32_4
      %1914 = cute.get_shape(%lay_5833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5834, %e1_5835, %e2_5836, %e3_5837 = cute.get_leaves(%1914) : !cute.shape<"((2,2),(2,8))">
      %1915 = cute.get_stride(%lay_5833) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5838, %e1_5839, %e2_5840, %e3_5841 = cute.get_leaves(%1915) : !cute.stride<"((2,4),(1,8))">
      %1916 = scf.if %1913 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1897) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,10)">
        cute.memref.store(%1897, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,10)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1897) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1897 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1897) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1897) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1897 : !memref_rmem_f32_4
      }
      %iter_5842 = cute.get_iter(%1916) : !memref_rmem_f32_4
      %lay_5843 = cute.get_layout(%1916) : !memref_rmem_f32_4
      %1917 = cute.get_shape(%lay_5843) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5844, %e1_5845, %e2_5846, %e3_5847 = cute.get_leaves(%1917) : !cute.shape<"((2,2),(2,8))">
      %1918 = cute.get_stride(%lay_5843) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5848, %e1_5849, %e2_5850, %e3_5851 = cute.get_leaves(%1918) : !cute.stride<"((2,4),(1,8))">
      %iter_5852 = cute.get_iter(%1916) : !memref_rmem_f32_4
      %iter_5853 = cute.get_iter(%1916) : !memref_rmem_f32_4
      %coord_5854 = cute.make_coord() : () -> !cute.coord<"(0,11)">
      %lay_5855 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5856 = cute.crd2idx(%coord_5854, %lay_5855) : (!cute.coord<"(0,11)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,41)">
      %iter_5857 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5858 = cute.add_offset(%iter_5857, %idx_5856) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,41)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5859 = cute.make_view(%tup_5858) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5860 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5861, %e1_5862, %e2_5863, %e3_5864 = cute.get_leaves(%iter_5860) : !cute.int_tuple<"(?,?,?,?)">
      %1919 = cute.get_scalars(%e0_5861) : !cute.int_tuple<"?">
      %1920 = cute.get_scalars(%e1_5862) : !cute.int_tuple<"?">
      %1921 = cute.get_scalars(%e2_5863) : !cute.int_tuple<"?">
      %1922 = cute.get_scalars(%e3_5864) : !cute.int_tuple<"?">
      %iter_5865 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5866, %e1_5867, %e2_5868, %e3_5869 = cute.get_leaves(%iter_5865) : !cute.int_tuple<"(?,?,?,?)">
      %1923 = cute.get_scalars(%e0_5866) : !cute.int_tuple<"?">
      %1924 = cute.get_scalars(%e1_5867) : !cute.int_tuple<"?">
      %1925 = cute.get_scalars(%e2_5868) : !cute.int_tuple<"?">
      %1926 = cute.get_scalars(%e3_5869) : !cute.int_tuple<"?">
      %iter_5870 = cute.get_iter(%view_5859) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5871, %e1_5872, %e2_5873, %e3_5874 = cute.get_leaves(%iter_5870) : !cute.int_tuple<"(?,?,?,?)">
      %1927 = cute.get_scalars(%e0_5871) : !cute.int_tuple<"?">
      %1928 = cute.get_scalars(%e1_5872) : !cute.int_tuple<"?">
      %1929 = cute.get_scalars(%e2_5873) : !cute.int_tuple<"?">
      %1930 = cute.get_scalars(%e3_5874) : !cute.int_tuple<"?">
      %int_tuple_5875 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5876 = cute.add_offset(%e3_5874, %int_tuple_5875) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1931 = cute.get_scalars(%tup_5876) : !cute.int_tuple<"?">
      %coord_5877 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5878 = cute.make_coord(%tup_5876) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1932 = cute.elem_less(%coord_5877, %coord_5878) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5879 = cute.get_layout(%1916) : !memref_rmem_f32_4
      %1933 = cute.get_shape(%lay_5879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5880, %e1_5881, %e2_5882, %e3_5883 = cute.get_leaves(%1933) : !cute.shape<"((2,2),(2,8))">
      %1934 = cute.get_stride(%lay_5879) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5884, %e1_5885, %e2_5886, %e3_5887 = cute.get_leaves(%1934) : !cute.stride<"((2,4),(1,8))">
      %1935 = scf.if %1932 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1916) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,11)">
        cute.memref.store(%1916, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,11)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1916) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1916 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1916) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1916) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1916 : !memref_rmem_f32_4
      }
      %iter_5888 = cute.get_iter(%1935) : !memref_rmem_f32_4
      %lay_5889 = cute.get_layout(%1935) : !memref_rmem_f32_4
      %1936 = cute.get_shape(%lay_5889) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5890, %e1_5891, %e2_5892, %e3_5893 = cute.get_leaves(%1936) : !cute.shape<"((2,2),(2,8))">
      %1937 = cute.get_stride(%lay_5889) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5894, %e1_5895, %e2_5896, %e3_5897 = cute.get_leaves(%1937) : !cute.stride<"((2,4),(1,8))">
      %iter_5898 = cute.get_iter(%1935) : !memref_rmem_f32_4
      %iter_5899 = cute.get_iter(%1935) : !memref_rmem_f32_4
      %coord_5900 = cute.make_coord() : () -> !cute.coord<"(0,12)">
      %lay_5901 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5902 = cute.crd2idx(%coord_5900, %lay_5901) : (!cute.coord<"(0,12)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,48)">
      %iter_5903 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5904 = cute.add_offset(%iter_5903, %idx_5902) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,48)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5905 = cute.make_view(%tup_5904) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5906 = cute.get_iter(%view_5905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5907, %e1_5908, %e2_5909, %e3_5910 = cute.get_leaves(%iter_5906) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1938 = cute.get_scalars(%e0_5907) : !cute.int_tuple<"?">
      %1939 = cute.get_scalars(%e1_5908) : !cute.int_tuple<"?">
      %1940 = cute.get_scalars(%e2_5909) : !cute.int_tuple<"?">
      %1941 = cute.get_scalars(%e3_5910) : !cute.int_tuple<"?{div=2}">
      %iter_5911 = cute.get_iter(%view_5905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5912, %e1_5913, %e2_5914, %e3_5915 = cute.get_leaves(%iter_5911) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1942 = cute.get_scalars(%e0_5912) : !cute.int_tuple<"?">
      %1943 = cute.get_scalars(%e1_5913) : !cute.int_tuple<"?">
      %1944 = cute.get_scalars(%e2_5914) : !cute.int_tuple<"?">
      %1945 = cute.get_scalars(%e3_5915) : !cute.int_tuple<"?{div=2}">
      %iter_5916 = cute.get_iter(%view_5905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5917, %e1_5918, %e2_5919, %e3_5920 = cute.get_leaves(%iter_5916) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1946 = cute.get_scalars(%e0_5917) : !cute.int_tuple<"?">
      %1947 = cute.get_scalars(%e1_5918) : !cute.int_tuple<"?">
      %1948 = cute.get_scalars(%e2_5919) : !cute.int_tuple<"?">
      %1949 = cute.get_scalars(%e3_5920) : !cute.int_tuple<"?{div=2}">
      %int_tuple_5921 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5922 = cute.add_offset(%e3_5920, %int_tuple_5921) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1950 = cute.get_scalars(%tup_5922) : !cute.int_tuple<"?">
      %coord_5923 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5924 = cute.make_coord(%tup_5922) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1951 = cute.elem_less(%coord_5923, %coord_5924) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5925 = cute.get_layout(%1935) : !memref_rmem_f32_4
      %1952 = cute.get_shape(%lay_5925) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5926, %e1_5927, %e2_5928, %e3_5929 = cute.get_leaves(%1952) : !cute.shape<"((2,2),(2,8))">
      %1953 = cute.get_stride(%lay_5925) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5930, %e1_5931, %e2_5932, %e3_5933 = cute.get_leaves(%1953) : !cute.stride<"((2,4),(1,8))">
      %1954 = scf.if %1951 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1935) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,12)">
        cute.memref.store(%1935, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,12)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1935) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1935 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1935) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1935) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1935 : !memref_rmem_f32_4
      }
      %iter_5934 = cute.get_iter(%1954) : !memref_rmem_f32_4
      %lay_5935 = cute.get_layout(%1954) : !memref_rmem_f32_4
      %1955 = cute.get_shape(%lay_5935) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5936, %e1_5937, %e2_5938, %e3_5939 = cute.get_leaves(%1955) : !cute.shape<"((2,2),(2,8))">
      %1956 = cute.get_stride(%lay_5935) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5940, %e1_5941, %e2_5942, %e3_5943 = cute.get_leaves(%1956) : !cute.stride<"((2,4),(1,8))">
      %iter_5944 = cute.get_iter(%1954) : !memref_rmem_f32_4
      %iter_5945 = cute.get_iter(%1954) : !memref_rmem_f32_4
      %coord_5946 = cute.make_coord() : () -> !cute.coord<"(0,13)">
      %lay_5947 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5948 = cute.crd2idx(%coord_5946, %lay_5947) : (!cute.coord<"(0,13)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,49)">
      %iter_5949 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5950 = cute.add_offset(%iter_5949, %idx_5948) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,49)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_5951 = cute.make_view(%tup_5950) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_5952 = cute.get_iter(%view_5951) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5953, %e1_5954, %e2_5955, %e3_5956 = cute.get_leaves(%iter_5952) : !cute.int_tuple<"(?,?,?,?)">
      %1957 = cute.get_scalars(%e0_5953) : !cute.int_tuple<"?">
      %1958 = cute.get_scalars(%e1_5954) : !cute.int_tuple<"?">
      %1959 = cute.get_scalars(%e2_5955) : !cute.int_tuple<"?">
      %1960 = cute.get_scalars(%e3_5956) : !cute.int_tuple<"?">
      %iter_5957 = cute.get_iter(%view_5951) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5958, %e1_5959, %e2_5960, %e3_5961 = cute.get_leaves(%iter_5957) : !cute.int_tuple<"(?,?,?,?)">
      %1961 = cute.get_scalars(%e0_5958) : !cute.int_tuple<"?">
      %1962 = cute.get_scalars(%e1_5959) : !cute.int_tuple<"?">
      %1963 = cute.get_scalars(%e2_5960) : !cute.int_tuple<"?">
      %1964 = cute.get_scalars(%e3_5961) : !cute.int_tuple<"?">
      %iter_5962 = cute.get_iter(%view_5951) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_5963, %e1_5964, %e2_5965, %e3_5966 = cute.get_leaves(%iter_5962) : !cute.int_tuple<"(?,?,?,?)">
      %1965 = cute.get_scalars(%e0_5963) : !cute.int_tuple<"?">
      %1966 = cute.get_scalars(%e1_5964) : !cute.int_tuple<"?">
      %1967 = cute.get_scalars(%e2_5965) : !cute.int_tuple<"?">
      %1968 = cute.get_scalars(%e3_5966) : !cute.int_tuple<"?">
      %int_tuple_5967 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_5968 = cute.add_offset(%e3_5966, %int_tuple_5967) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1969 = cute.get_scalars(%tup_5968) : !cute.int_tuple<"?">
      %coord_5969 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_5970 = cute.make_coord(%tup_5968) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1970 = cute.elem_less(%coord_5969, %coord_5970) : !cute.coord<"?">, !cute.coord<"?">
      %lay_5971 = cute.get_layout(%1954) : !memref_rmem_f32_4
      %1971 = cute.get_shape(%lay_5971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5972, %e1_5973, %e2_5974, %e3_5975 = cute.get_leaves(%1971) : !cute.shape<"((2,2),(2,8))">
      %1972 = cute.get_stride(%lay_5971) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5976, %e1_5977, %e2_5978, %e3_5979 = cute.get_leaves(%1972) : !cute.stride<"((2,4),(1,8))">
      %1973 = scf.if %1970 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1954) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,13)">
        cute.memref.store(%1954, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,13)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1954) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1954 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1954) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1954) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1954 : !memref_rmem_f32_4
      }
      %iter_5980 = cute.get_iter(%1973) : !memref_rmem_f32_4
      %lay_5981 = cute.get_layout(%1973) : !memref_rmem_f32_4
      %1974 = cute.get_shape(%lay_5981) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_5982, %e1_5983, %e2_5984, %e3_5985 = cute.get_leaves(%1974) : !cute.shape<"((2,2),(2,8))">
      %1975 = cute.get_stride(%lay_5981) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_5986, %e1_5987, %e2_5988, %e3_5989 = cute.get_leaves(%1975) : !cute.stride<"((2,4),(1,8))">
      %iter_5990 = cute.get_iter(%1973) : !memref_rmem_f32_4
      %iter_5991 = cute.get_iter(%1973) : !memref_rmem_f32_4
      %coord_5992 = cute.make_coord() : () -> !cute.coord<"(0,14)">
      %lay_5993 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_5994 = cute.crd2idx(%coord_5992, %lay_5993) : (!cute.coord<"(0,14)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,56)">
      %iter_5995 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_5996 = cute.add_offset(%iter_5995, %idx_5994) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,56)">) -> !cute.int_tuple<"(?,?,?,?{div=2})">
      %view_5997 = cute.make_view(%tup_5996) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %iter_5998 = cute.get_iter(%view_5997) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_5999, %e1_6000, %e2_6001, %e3_6002 = cute.get_leaves(%iter_5998) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1976 = cute.get_scalars(%e0_5999) : !cute.int_tuple<"?">
      %1977 = cute.get_scalars(%e1_6000) : !cute.int_tuple<"?">
      %1978 = cute.get_scalars(%e2_6001) : !cute.int_tuple<"?">
      %1979 = cute.get_scalars(%e3_6002) : !cute.int_tuple<"?{div=2}">
      %iter_6003 = cute.get_iter(%view_5997) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6004, %e1_6005, %e2_6006, %e3_6007 = cute.get_leaves(%iter_6003) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1980 = cute.get_scalars(%e0_6004) : !cute.int_tuple<"?">
      %1981 = cute.get_scalars(%e1_6005) : !cute.int_tuple<"?">
      %1982 = cute.get_scalars(%e2_6006) : !cute.int_tuple<"?">
      %1983 = cute.get_scalars(%e3_6007) : !cute.int_tuple<"?{div=2}">
      %iter_6008 = cute.get_iter(%view_5997) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()">
      %e0_6009, %e1_6010, %e2_6011, %e3_6012 = cute.get_leaves(%iter_6008) : !cute.int_tuple<"(?,?,?,?{div=2})">
      %1984 = cute.get_scalars(%e0_6009) : !cute.int_tuple<"?">
      %1985 = cute.get_scalars(%e1_6010) : !cute.int_tuple<"?">
      %1986 = cute.get_scalars(%e2_6011) : !cute.int_tuple<"?">
      %1987 = cute.get_scalars(%e3_6012) : !cute.int_tuple<"?{div=2}">
      %int_tuple_6013 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6014 = cute.add_offset(%e3_6012, %int_tuple_6013) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %1988 = cute.get_scalars(%tup_6014) : !cute.int_tuple<"?">
      %coord_6015 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6016 = cute.make_coord(%tup_6014) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %1989 = cute.elem_less(%coord_6015, %coord_6016) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6017 = cute.get_layout(%1973) : !memref_rmem_f32_4
      %1990 = cute.get_shape(%lay_6017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6018, %e1_6019, %e2_6020, %e3_6021 = cute.get_leaves(%1990) : !cute.shape<"((2,2),(2,8))">
      %1991 = cute.get_stride(%lay_6017) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6022, %e1_6023, %e2_6024, %e3_6025 = cute.get_leaves(%1991) : !cute.stride<"((2,4),(1,8))">
      %1992 = scf.if %1989 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1973) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,14)">
        cute.memref.store(%1973, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,14)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1973) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1973 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1973) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1973) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1973 : !memref_rmem_f32_4
      }
      %iter_6026 = cute.get_iter(%1992) : !memref_rmem_f32_4
      %lay_6027 = cute.get_layout(%1992) : !memref_rmem_f32_4
      %1993 = cute.get_shape(%lay_6027) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6028, %e1_6029, %e2_6030, %e3_6031 = cute.get_leaves(%1993) : !cute.shape<"((2,2),(2,8))">
      %1994 = cute.get_stride(%lay_6027) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6032, %e1_6033, %e2_6034, %e3_6035 = cute.get_leaves(%1994) : !cute.stride<"((2,4),(1,8))">
      %iter_6036 = cute.get_iter(%1992) : !memref_rmem_f32_4
      %iter_6037 = cute.get_iter(%1992) : !memref_rmem_f32_4
      %coord_6038 = cute.make_coord() : () -> !cute.coord<"(0,15)">
      %lay_6039 = cute.get_layout(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %idx_6040 = cute.crd2idx(%coord_6038, %lay_6039) : (!cute.coord<"(0,15)">, !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.int_tuple<"(0,0,0,57)">
      %iter_6041 = cute.get_iter(%view_3009) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">
      %tup_6042 = cute.add_offset(%iter_6041, %idx_6040) : (!cute.int_tuple<"(?,?,?,?{div=2})">, !cute.int_tuple<"(0,0,0,57)">) -> !cute.int_tuple<"(?,?,?,?)">
      %view_6043 = cute.make_view(%tup_6042) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %iter_6044 = cute.get_iter(%view_6043) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6045, %e1_6046, %e2_6047, %e3_6048 = cute.get_leaves(%iter_6044) : !cute.int_tuple<"(?,?,?,?)">
      %1995 = cute.get_scalars(%e0_6045) : !cute.int_tuple<"?">
      %1996 = cute.get_scalars(%e1_6046) : !cute.int_tuple<"?">
      %1997 = cute.get_scalars(%e2_6047) : !cute.int_tuple<"?">
      %1998 = cute.get_scalars(%e3_6048) : !cute.int_tuple<"?">
      %iter_6049 = cute.get_iter(%view_6043) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6050, %e1_6051, %e2_6052, %e3_6053 = cute.get_leaves(%iter_6049) : !cute.int_tuple<"(?,?,?,?)">
      %1999 = cute.get_scalars(%e0_6050) : !cute.int_tuple<"?">
      %2000 = cute.get_scalars(%e1_6051) : !cute.int_tuple<"?">
      %2001 = cute.get_scalars(%e2_6052) : !cute.int_tuple<"?">
      %2002 = cute.get_scalars(%e3_6053) : !cute.int_tuple<"?">
      %iter_6054 = cute.get_iter(%view_6043) : !cute.coord_tensor<"(?,?,?,?)", "():()">
      %e0_6055, %e1_6056, %e2_6057, %e3_6058 = cute.get_leaves(%iter_6054) : !cute.int_tuple<"(?,?,?,?)">
      %2003 = cute.get_scalars(%e0_6055) : !cute.int_tuple<"?">
      %2004 = cute.get_scalars(%e1_6056) : !cute.int_tuple<"?">
      %2005 = cute.get_scalars(%e2_6057) : !cute.int_tuple<"?">
      %2006 = cute.get_scalars(%e3_6058) : !cute.int_tuple<"?">
      %int_tuple_6059 = cute.make_int_tuple() : () -> !cute.int_tuple<"1">
      %tup_6060 = cute.add_offset(%e3_6058, %int_tuple_6059) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?">
      %2007 = cute.get_scalars(%tup_6060) : !cute.int_tuple<"?">
      %coord_6061 = cute.make_coord(%itup_2919) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_6062 = cute.make_coord(%tup_6060) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2008 = cute.elem_less(%coord_6061, %coord_6062) : !cute.coord<"?">, !cute.coord<"?">
      %lay_6063 = cute.get_layout(%1992) : !memref_rmem_f32_4
      %2009 = cute.get_shape(%lay_6063) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6064, %e1_6065, %e2_6066, %e3_6067 = cute.get_leaves(%2009) : !cute.shape<"((2,2),(2,8))">
      %2010 = cute.get_stride(%lay_6063) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6068, %e1_6069, %e2_6070, %e3_6071 = cute.get_leaves(%2010) : !cute.stride<"((2,4),(1,8))">
      %2011 = scf.if %2008 -> (!memref_rmem_f32_4) {
        %iter_7719 = cute.get_iter(%1992) : !memref_rmem_f32_4
        %cst_7720 = arith.constant 0xFF800000 : f32
        %coord_7721 = cute.make_coord() : () -> !cute.coord<"(3,15)">
        cute.memref.store(%1992, %coord_7721, %cst_7720) : (!memref_rmem_f32_4, !cute.coord<"(3,15)">, f32) -> ()
        %lay_7722 = cute.get_layout(%1992) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7723, %e1_7724, %e2_7725, %e3_7726 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7722) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7727, %e1_7728, %e2_7729, %e3_7730 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1992 : !memref_rmem_f32_4
      } else {
        %iter_7719 = cute.get_iter(%1992) : !memref_rmem_f32_4
        %lay_7720 = cute.get_layout(%1992) : !memref_rmem_f32_4
        %2485 = cute.get_shape(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
        %e0_7721, %e1_7722, %e2_7723, %e3_7724 = cute.get_leaves(%2485) : !cute.shape<"((2,2),(2,8))">
        %2486 = cute.get_stride(%lay_7720) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
        %e0_7725, %e1_7726, %e2_7727, %e3_7728 = cute.get_leaves(%2486) : !cute.stride<"((2,4),(1,8))">
        scf.yield %1992 : !memref_rmem_f32_4
      }
      %iter_6072 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %lay_6073 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %2012 = cute.get_shape(%lay_6073) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))">
      %e0_6074, %e1_6075, %e2_6076, %e3_6077 = cute.get_leaves(%2012) : !cute.shape<"((2,2),(2,8))">
      %2013 = cute.get_stride(%lay_6073) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))">
      %e0_6078, %e1_6079, %e2_6080, %e3_6081 = cute.get_leaves(%2013) : !cute.stride<"((2,4),(1,8))">
      %iter_6082 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %iter_6083 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %coord_6084 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6085 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %idx_6086 = cute.crd2idx(%coord_6084, %lay_6085) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6087 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %ptr_6088 = cute.add_offset(%iter_6087, %idx_6086) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6089 = cute.make_view(%ptr_6088) : !memref_rmem_f32_7
      %iter_6090 = cute.get_iter(%view_6089) : !memref_rmem_f32_7
      %lay_6091 = cute.get_layout(%view_6089) : !memref_rmem_f32_7
      %2014 = cute.get_shape(%lay_6091) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6092, %e1_6093 = cute.get_leaves(%2014) : !cute.shape<"((2,8))">
      %2015 = cute.memref.load_vec %view_6089, row_major : !memref_rmem_f32_7
      %cst_6094 = arith.constant 0xFF800000 : f32
      %2016 = vector.reduction <maximumf>, %2015, %cst_6094 : vector<16xf32> into f32
      %c-1_i32_6095 = arith.constant -1 : i32
      %c2_i32_6096 = arith.constant 2 : i32
      %c31_i32_6097 = arith.constant 31 : i32
      %2017 = nvvm.shfl.sync  bfly %c-1_i32_6095, %2016, %c2_i32_6096, %c31_i32_6097 : f32 -> f32
      %2018 = nvvm.fmax %2016, %2017
      %c-1_i32_6098 = arith.constant -1 : i32
      %c1_i32_6099 = arith.constant 1 : i32
      %c31_i32_6100 = arith.constant 31 : i32
      %2019 = nvvm.shfl.sync  bfly %c-1_i32_6098, %2018, %c1_i32_6099, %c31_i32_6100 : f32 -> f32
      %2020 = nvvm.fmax %2018, %2019
      %2021 = vector.broadcast %arg4 : f32 to vector<16xf32>
      %2022 = arith.mulf %2015, %2021 : vector<16xf32>
      %2023 = arith.mulf %2020, %arg4 : f32
      %2024 = vector.broadcast %2023 : f32 to vector<16xf32>
      %2025 = arith.subf %2022, %2024 : vector<16xf32>
      %2026 = math.exp2 %2025 fastmath<fast> : vector<16xf32>
      %cst_6101 = arith.constant 0.000000e+00 : f32
      %2027 = vector.reduction <add>, %2026, %cst_6101 : vector<16xf32> into f32
      %coord_6102 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1062, %coord_6102, %2020) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6103 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1067, %coord_6103, %2027) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_6104 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_6105 = cute.get_layout(%2011) : !memref_rmem_f32_4
      %idx_6106 = cute.crd2idx(%coord_6104, %lay_6105) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_6107 = cute.get_iter(%2011) : !memref_rmem_f32_4
      %ptr_6108 = cute.add_offset(%iter_6107, %idx_6106) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6109 = cute.make_view(%ptr_6108) : !memref_rmem_f32_7
      %iter_6110 = cute.get_iter(%view_6109) : !memref_rmem_f32_7
      %lay_6111 = cute.get_layout(%view_6109) : !memref_rmem_f32_7
      %2028 = cute.get_shape(%lay_6111) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
      %e0_6112, %e1_6113 = cute.get_leaves(%2028) : !cute.shape<"((2,8))">
      %int_tuple_6114 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6115 = cute.size(%int_tuple_6114) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6116 = cute.get_leaves(%sz_6115) : !cute.int_tuple<"16">
      %int_tuple_6117 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
      %sz_6118 = cute.size(%int_tuple_6117) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
      %e0_6119 = cute.get_leaves(%sz_6118) : !cute.int_tuple<"16">
      cute.memref.store_vec %2026, %view_6109, row_major : !memref_rmem_f32_7
      %lay_6120 = cute.get_layout(%rmem_1101) : !memref_rmem_f32_2
      %2029 = cute.make_layout_like(%lay_6120) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
      %rmem_6121 = cute.memref.alloca(%2029) : !memref_rmem_bf16_16
      %iter_6122 = cute.get_iter(%rmem_6121) : !memref_rmem_bf16_16
      %iter_6123 = cute.get_iter(%rmem_6121) : !memref_rmem_bf16_16
      %2030 = cute.memref.load_vec %rmem_1101, row_major : !memref_rmem_f32_2
      %2031 = arith.truncf %2030 : vector<64xf32> to vector<64xbf16>
      %lay_6124 = cute.get_layout(%rmem_6121) : !memref_rmem_bf16_16
      %2032 = cute.get_shape(%lay_6124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
      %e0_6125, %e1_6126, %e2_6127, %e3_6128 = cute.get_leaves(%2032) : !cute.shape<"((2,2),2,8)">
      %int_tuple_6129 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6130 = cute.size(%int_tuple_6129) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6131 = cute.get_leaves(%sz_6130) : !cute.int_tuple<"64">
      %int_tuple_6132 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
      %sz_6133 = cute.size(%int_tuple_6132) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
      %e0_6134 = cute.get_leaves(%sz_6133) : !cute.int_tuple<"64">
      cute.memref.store_vec %2031, %rmem_6121, row_major : !memref_rmem_bf16_16
      %lay_6135 = cute.get_layout(%rmem_6121) : !memref_rmem_bf16_16
      %tile_6136 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
      %lay_6137 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
      %2033 = cute.get_shape(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6138, %e1_6139, %e2_6140, %e3_6141, %e4_6142 = cute.get_leaves(%2033) : !cute.shape<"((2,2),2,(2,4))">
      %2034 = cute.get_shape(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6143, %e1_6144, %e2_6145, %e3_6146, %e4_6147 = cute.get_leaves(%2034) : !cute.shape<"((2,2),2,(2,4))">
      %2035 = cute.get_shape(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6148, %e1_6149, %e2_6150, %e3_6151, %e4_6152 = cute.get_leaves(%2035) : !cute.shape<"((2,2),2,(2,4))">
      %2036 = cute.get_shape(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
      %e0_6153, %e1_6154, %e2_6155, %e3_6156, %e4_6157 = cute.get_leaves(%2036) : !cute.shape<"((2,2),2,(2,4))">
      %2037 = cute.get_stride(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6158, %e1_6159, %e2_6160, %e3_6161, %e4_6162 = cute.get_leaves(%2037) : !cute.stride<"((1,2),4,(8,16))">
      %2038 = cute.get_stride(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6163, %e1_6164, %e2_6165, %e3_6166, %e4_6167 = cute.get_leaves(%2038) : !cute.stride<"((1,2),4,(8,16))">
      %2039 = cute.get_stride(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6168, %e1_6169, %e2_6170, %e3_6171, %e4_6172 = cute.get_leaves(%2039) : !cute.stride<"((1,2),4,(8,16))">
      %2040 = cute.get_stride(%lay_6137) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
      %e0_6173, %e1_6174, %e2_6175, %e3_6176, %e4_6177 = cute.get_leaves(%2040) : !cute.stride<"((1,2),4,(8,16))">
      %shape_6178 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
      %stride_6179 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
      %lay_6180 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
      %view_6181 = cute.make_view(%iter_6123, %lay_6180) : !memref_rmem_bf16_17
      %iter_6182 = cute.get_iter(%view_6181) : !memref_rmem_bf16_17
      %coord_6183 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6184 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
      %slice_6185 = cute.slice(%lay_6184, %coord_6183) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
      %idx_6186 = cute.crd2idx(%coord_6183, %lay_6184) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6187 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %ptr_6188 = cute.add_offset(%iter_6187, %idx_6186) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6189 = cute.make_view(%ptr_6188, %slice_6185) : !memref_smem_bf16_19
      %iter_6190 = cute.get_iter(%view_6189) : !memref_smem_bf16_19
      %coord_6191 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6192 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
      %idx_6193 = cute.crd2idx(%coord_6191, %lay_6192) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6194 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %ptr_6195 = cute.add_offset(%iter_6194, %idx_6193) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6196 = cute.make_view(%ptr_6195) : !memref_rmem_bf16_18
      %iter_6197 = cute.get_iter(%view_6196) : !memref_rmem_bf16_18
      %lay_6198 = cute.get_layout(%view_6189) : !memref_smem_bf16_19
      %2041 = cute.get_shape(%lay_6198) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6199, %e1_6200, %e2_6201, %e3_6202, %e4_6203 = cute.get_leaves(%2041) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6204 = cute.get_layout(%view_6196) : !memref_rmem_bf16_18
      %2042 = cute.get_shape(%lay_6204) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6205, %e1_6206, %e2_6207, %e3_6208 = cute.get_leaves(%2042) : !cute.shape<"((8,1),(4,2))">
      %lay_6209 = cute.get_layout(%view_6189) : !memref_smem_bf16_19
      %shape_6210 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6211 = cute.make_layout() : !cute.layout<"1:0">
      %append_6212 = cute.append_to_rank<2> (%lay_6209, %lay_6211) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6213 = cute.make_view(%iter_6190, %append_6212) : !memref_smem_bf16_19
      %iter_6214 = cute.get_iter(%view_6213) : !memref_smem_bf16_19
      %lay_6215 = cute.get_layout(%view_6213) : !memref_smem_bf16_19
      %2043 = cute.get_shape(%lay_6215) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6216, %e1_6217, %e2_6218, %e3_6219, %e4_6220 = cute.get_leaves(%2043) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6221 = cute.get_iter(%view_6213) : !memref_smem_bf16_19
      %lay_6222 = cute.get_layout(%view_6213) : !memref_smem_bf16_19
      %2044:2 = cute.get_scalars(%lay_6222) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6223 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6224 = cute.assume(%2044#0) : (i32) -> !cute.i32<divby 16>
      %iv_6225 = cute.assume(%2044#1) : (i32) -> !cute.i32<divby 32>
      %stride_6226 = cute.make_stride(%iv_6224, %iv_6225) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6227 = cute.make_layout(%shape_6223, %stride_6226) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6228 = cute.make_view(%iter_6221, %lay_6227) : !memref_smem_bf16_20
      %iter_6229 = cute.get_iter(%view_6228) : !memref_smem_bf16_20
      %iter_6230 = cute.get_iter(%view_6228) : !memref_smem_bf16_20
      %lay_6231 = cute.get_layout(%view_6196) : !memref_rmem_bf16_18
      %shape_6232 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6233 = cute.make_layout() : !cute.layout<"1:0">
      %append_6234 = cute.append_to_rank<2> (%lay_6231, %lay_6233) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6235 = cute.make_view(%iter_6197, %append_6234) : !memref_rmem_bf16_18
      %iter_6236 = cute.get_iter(%view_6235) : !memref_rmem_bf16_18
      %lay_6237 = cute.get_layout(%view_6235) : !memref_rmem_bf16_18
      %2045 = cute.get_shape(%lay_6237) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6238, %e1_6239, %e2_6240, %e3_6241 = cute.get_leaves(%2045) : !cute.shape<"((8,1),(4,2))">
      %iter_6242 = cute.get_iter(%view_6235) : !memref_rmem_bf16_18
      %view_6243 = cute.make_view(%iter_6242) : !memref_rmem_bf16_19
      %iter_6244 = cute.get_iter(%view_6243) : !memref_rmem_bf16_19
      %iter_6245 = cute.get_iter(%view_6243) : !memref_rmem_bf16_19
      %lay_6246 = cute.get_layout(%view_6228) : !memref_smem_bf16_20
      %2046 = cute.get_shape(%lay_6246) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6247, %e1_6248, %e2_6249, %e3_6250, %e4_6251 = cute.get_leaves(%2046) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6252 = cute.get_layout(%view_6243) : !memref_rmem_bf16_19
      %2047 = cute.get_shape(%lay_6252) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6253, %e1_6254, %e2_6255, %e3_6256 = cute.get_leaves(%2047) : !cute.shape<"((8,1),((4,2)))">
      %lay_6257 = cute.get_layout(%view_6228) : !memref_smem_bf16_20
      %sz_6258 = cute.size(%lay_6257) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6259 = cute.get_leaves(%sz_6258) : !cute.int_tuple<"8">
      %lay_6260 = cute.get_layout(%view_6243) : !memref_rmem_bf16_19
      %sz_6261 = cute.size(%lay_6260) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6262 = cute.get_leaves(%sz_6261) : !cute.int_tuple<"8">
      %2048 = cute.static : !cute.layout<"1:0">
      %iter_6263 = cute.get_iter(%view_6228) : !memref_smem_bf16_20
      %iter_6264 = cute.get_iter(%view_6243) : !memref_rmem_bf16_19
      %lay_6265 = cute.get_layout(%view_6228) : !memref_smem_bf16_20
      %lay_6266 = cute.get_layout(%view_6243) : !memref_rmem_bf16_19
      %append_6267 = cute.append_to_rank<2> (%lay_6265, %2048) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6268 = cute.append_to_rank<2> (%lay_6266, %2048) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2049:2 = cute.get_scalars(%append_6267) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6269 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6270 = cute.assume(%2049#0) : (i32) -> !cute.i32<divby 16>
      %iv_6271 = cute.assume(%2049#1) : (i32) -> !cute.i32<divby 32>
      %stride_6272 = cute.make_stride(%iv_6270, %iv_6271) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6273 = cute.make_layout(%shape_6269, %stride_6272) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6274 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6275 = cute.size(%lay_6273) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2050 = cute.get_scalars(%sz_6275) : !cute.int_tuple<"8">
      %c0_i32_6276 = arith.constant 0 : i32
      %c1_i32_6277 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6276 to %2050 step %c1_i32_6277  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_6273, %coord_7719) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_6273) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7722 = cute.add_offset(%iter_6263, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_6274, %coord_7719) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_6274) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_6264, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7723, %view_7727) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_6278 = cute.get_layout(%view_6181) : !memref_rmem_bf16_17
      %2051 = cute.get_shape(%lay_6278) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
      %e0_6279, %e1_6280, %e2_6281, %e3_6282, %e4_6283 = cute.get_leaves(%2051) : !cute.shape<"(((2,2),2),2,4)">
      %int_tuple_6284 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6285 = cute.size(%int_tuple_6284) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6286 = cute.get_leaves(%sz_6285) : !cute.int_tuple<"4">
      %int_tuple_6287 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6288 = cute.size(%int_tuple_6287) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6289 = cute.get_leaves(%sz_6288) : !cute.int_tuple<"4">
      %coord_6290 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6291 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
      %slice_6292 = cute.slice(%lay_6291, %coord_6290) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
      %idx_6293 = cute.crd2idx(%coord_6290, %lay_6291) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
      %iter_6294 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %ptr_6295 = cute.add_offset(%iter_6294, %idx_6293) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6296 = cute.make_view(%ptr_6295, %slice_6292) : !memref_smem_bf16_19
      %iter_6297 = cute.get_iter(%view_6296) : !memref_smem_bf16_19
      %coord_6298 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6299 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
      %idx_6300 = cute.crd2idx(%coord_6298, %lay_6299) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
      %iter_6301 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %ptr_6302 = cute.add_offset(%iter_6301, %idx_6300) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6303 = cute.make_view(%ptr_6302) : !memref_rmem_bf16_18
      %iter_6304 = cute.get_iter(%view_6303) : !memref_rmem_bf16_18
      %lay_6305 = cute.get_layout(%view_6296) : !memref_smem_bf16_19
      %2052 = cute.get_shape(%lay_6305) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6306, %e1_6307, %e2_6308, %e3_6309, %e4_6310 = cute.get_leaves(%2052) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6311 = cute.get_layout(%view_6303) : !memref_rmem_bf16_18
      %2053 = cute.get_shape(%lay_6311) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6312, %e1_6313, %e2_6314, %e3_6315 = cute.get_leaves(%2053) : !cute.shape<"((8,1),(4,2))">
      %lay_6316 = cute.get_layout(%view_6296) : !memref_smem_bf16_19
      %shape_6317 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6318 = cute.make_layout() : !cute.layout<"1:0">
      %append_6319 = cute.append_to_rank<2> (%lay_6316, %lay_6318) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6320 = cute.make_view(%iter_6297, %append_6319) : !memref_smem_bf16_19
      %iter_6321 = cute.get_iter(%view_6320) : !memref_smem_bf16_19
      %lay_6322 = cute.get_layout(%view_6320) : !memref_smem_bf16_19
      %2054 = cute.get_shape(%lay_6322) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6323, %e1_6324, %e2_6325, %e3_6326, %e4_6327 = cute.get_leaves(%2054) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6328 = cute.get_iter(%view_6320) : !memref_smem_bf16_19
      %lay_6329 = cute.get_layout(%view_6320) : !memref_smem_bf16_19
      %2055:2 = cute.get_scalars(%lay_6329) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6330 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6331 = cute.assume(%2055#0) : (i32) -> !cute.i32<divby 16>
      %iv_6332 = cute.assume(%2055#1) : (i32) -> !cute.i32<divby 32>
      %stride_6333 = cute.make_stride(%iv_6331, %iv_6332) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6334 = cute.make_layout(%shape_6330, %stride_6333) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6335 = cute.make_view(%iter_6328, %lay_6334) : !memref_smem_bf16_20
      %iter_6336 = cute.get_iter(%view_6335) : !memref_smem_bf16_20
      %iter_6337 = cute.get_iter(%view_6335) : !memref_smem_bf16_20
      %lay_6338 = cute.get_layout(%view_6303) : !memref_rmem_bf16_18
      %shape_6339 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6340 = cute.make_layout() : !cute.layout<"1:0">
      %append_6341 = cute.append_to_rank<2> (%lay_6338, %lay_6340) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6342 = cute.make_view(%iter_6304, %append_6341) : !memref_rmem_bf16_18
      %iter_6343 = cute.get_iter(%view_6342) : !memref_rmem_bf16_18
      %lay_6344 = cute.get_layout(%view_6342) : !memref_rmem_bf16_18
      %2056 = cute.get_shape(%lay_6344) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6345, %e1_6346, %e2_6347, %e3_6348 = cute.get_leaves(%2056) : !cute.shape<"((8,1),(4,2))">
      %iter_6349 = cute.get_iter(%view_6342) : !memref_rmem_bf16_18
      %view_6350 = cute.make_view(%iter_6349) : !memref_rmem_bf16_19
      %iter_6351 = cute.get_iter(%view_6350) : !memref_rmem_bf16_19
      %iter_6352 = cute.get_iter(%view_6350) : !memref_rmem_bf16_19
      %lay_6353 = cute.get_layout(%view_6335) : !memref_smem_bf16_20
      %2057 = cute.get_shape(%lay_6353) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6354, %e1_6355, %e2_6356, %e3_6357, %e4_6358 = cute.get_leaves(%2057) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6359 = cute.get_layout(%view_6350) : !memref_rmem_bf16_19
      %2058 = cute.get_shape(%lay_6359) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6360, %e1_6361, %e2_6362, %e3_6363 = cute.get_leaves(%2058) : !cute.shape<"((8,1),((4,2)))">
      %lay_6364 = cute.get_layout(%view_6335) : !memref_smem_bf16_20
      %sz_6365 = cute.size(%lay_6364) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6366 = cute.get_leaves(%sz_6365) : !cute.int_tuple<"8">
      %lay_6367 = cute.get_layout(%view_6350) : !memref_rmem_bf16_19
      %sz_6368 = cute.size(%lay_6367) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6369 = cute.get_leaves(%sz_6368) : !cute.int_tuple<"8">
      %2059 = cute.static : !cute.layout<"1:0">
      %iter_6370 = cute.get_iter(%view_6335) : !memref_smem_bf16_20
      %iter_6371 = cute.get_iter(%view_6350) : !memref_rmem_bf16_19
      %lay_6372 = cute.get_layout(%view_6335) : !memref_smem_bf16_20
      %lay_6373 = cute.get_layout(%view_6350) : !memref_rmem_bf16_19
      %append_6374 = cute.append_to_rank<2> (%lay_6372, %2059) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6375 = cute.append_to_rank<2> (%lay_6373, %2059) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2060:2 = cute.get_scalars(%append_6374) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6376 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6377 = cute.assume(%2060#0) : (i32) -> !cute.i32<divby 16>
      %iv_6378 = cute.assume(%2060#1) : (i32) -> !cute.i32<divby 32>
      %stride_6379 = cute.make_stride(%iv_6377, %iv_6378) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6380 = cute.make_layout(%shape_6376, %stride_6379) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6381 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6382 = cute.size(%lay_6380) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2061 = cute.get_scalars(%sz_6382) : !cute.int_tuple<"8">
      %c0_i32_6383 = arith.constant 0 : i32
      %c1_i32_6384 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6383 to %2061 step %c1_i32_6384  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_6380, %coord_7719) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_6380) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7722 = cute.add_offset(%iter_6370, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_6381, %coord_7719) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_6381) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_6371, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7723, %view_7727) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6385 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6386 = cute.get_layout(%view_6181) : !memref_rmem_bf16_17
      %idx_6387 = cute.crd2idx(%coord_6385, %lay_6386) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
      %iter_6388 = cute.get_iter(%view_6181) : !memref_rmem_bf16_17
      %ptr_6389 = cute.add_offset(%iter_6388, %idx_6387) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6390 = cute.make_view(%ptr_6389) : !memref_rmem_bf16_20
      %iter_6391 = cute.get_iter(%view_6390) : !memref_rmem_bf16_20
      %coord_6392 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6393 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
      %idx_6394 = cute.crd2idx(%coord_6392, %lay_6393) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
      %iter_6395 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
      %ptr_6396 = cute.add_offset(%iter_6395, %idx_6394) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6397 = cute.make_view(%ptr_6396) : !memref_rmem_bf16_21
      %iter_6398 = cute.get_iter(%view_6397) : !memref_rmem_bf16_21
      %lay_6399 = cute.get_layout(%view_6390) : !memref_rmem_bf16_20
      %2062 = cute.get_shape(%lay_6399) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6400, %e1_6401, %e2_6402, %e3_6403 = cute.get_leaves(%2062) : !cute.shape<"(((2,2),2),2)">
      %lay_6404 = cute.get_layout(%view_6397) : !memref_rmem_bf16_21
      %2063 = cute.get_shape(%lay_6404) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6405, %e1_6406, %e2_6407, %e3_6408 = cute.get_leaves(%2063) : !cute.shape<"((2,2),(8,2))">
      %lay_6409 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2064 = cute.get_shape(%lay_6409) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6410, %e1_6411, %e2_6412, %e3_6413 = cute.get_leaves(%2064) : !cute.shape<"((2,2),2,16)">
      %iter_6414 = cute.get_iter(%view_6390) : !memref_rmem_bf16_20
      %iter_6415 = cute.get_iter(%view_6397) : !memref_rmem_bf16_21
      %iter_6416 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6417 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6418 = cute.get_layout(%view_6390) : !memref_rmem_bf16_20
      %lay_6419 = cute.get_layout(%view_6397) : !memref_rmem_bf16_21
      %lay_6420 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6421 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2065 = cute.static : !cute.layout<"1:0">
      %append_6422 = cute.append_to_rank<3> (%lay_6418, %2065) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6423 = cute.append_to_rank<3> (%lay_6419, %2065) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6424 = cute.size(%append_6422) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6425 = cute.size(%append_6422) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6426 = cute.size(%append_6423) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2066 = cute.get_scalars(%sz_6424) : !cute.int_tuple<"1">
      %2067 = cute.get_scalars(%sz_6425) : !cute.int_tuple<"2">
      %2068 = cute.get_scalars(%sz_6426) : !cute.int_tuple<"16">
      %c0_i32_6427 = arith.constant 0 : i32
      %c1_i32_6428 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6427 to %2066 step %c1_i32_6428  : i32 {
        scf.for %arg6 = %c0_i32_6427 to %2067 step %c1_i32_6428  : i32 {
          scf.for %arg7 = %c0_i32_6427 to %2068 step %c1_i32_6428  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_6422, %coord_7719) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_6422) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7724 = cute.add_offset(%iter_6414, %idx_7723) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_22
            %slice_7726 = cute.slice(%append_6423, %coord_7720) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_6423) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_6415, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_6420, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_6420) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_6416, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_6421, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_6421) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_6417, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6429 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6430 = cute.size(%int_tuple_6429) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6431 = cute.get_leaves(%sz_6430) : !cute.int_tuple<"4">
      %coord_6432 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6433 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
      %slice_6434 = cute.slice(%lay_6433, %coord_6432) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
      %idx_6435 = cute.crd2idx(%coord_6432, %lay_6433) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
      %iter_6436 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %ptr_6437 = cute.add_offset(%iter_6436, %idx_6435) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6438 = cute.make_view(%ptr_6437, %slice_6434) : !memref_smem_bf16_19
      %iter_6439 = cute.get_iter(%view_6438) : !memref_smem_bf16_19
      %coord_6440 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6441 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
      %idx_6442 = cute.crd2idx(%coord_6440, %lay_6441) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
      %iter_6443 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %ptr_6444 = cute.add_offset(%iter_6443, %idx_6442) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6445 = cute.make_view(%ptr_6444) : !memref_rmem_bf16_18
      %iter_6446 = cute.get_iter(%view_6445) : !memref_rmem_bf16_18
      %lay_6447 = cute.get_layout(%view_6438) : !memref_smem_bf16_19
      %2069 = cute.get_shape(%lay_6447) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6448, %e1_6449, %e2_6450, %e3_6451, %e4_6452 = cute.get_leaves(%2069) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6453 = cute.get_layout(%view_6445) : !memref_rmem_bf16_18
      %2070 = cute.get_shape(%lay_6453) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6454, %e1_6455, %e2_6456, %e3_6457 = cute.get_leaves(%2070) : !cute.shape<"((8,1),(4,2))">
      %lay_6458 = cute.get_layout(%view_6438) : !memref_smem_bf16_19
      %shape_6459 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6460 = cute.make_layout() : !cute.layout<"1:0">
      %append_6461 = cute.append_to_rank<2> (%lay_6458, %lay_6460) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6462 = cute.make_view(%iter_6439, %append_6461) : !memref_smem_bf16_19
      %iter_6463 = cute.get_iter(%view_6462) : !memref_smem_bf16_19
      %lay_6464 = cute.get_layout(%view_6462) : !memref_smem_bf16_19
      %2071 = cute.get_shape(%lay_6464) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6465, %e1_6466, %e2_6467, %e3_6468, %e4_6469 = cute.get_leaves(%2071) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6470 = cute.get_iter(%view_6462) : !memref_smem_bf16_19
      %lay_6471 = cute.get_layout(%view_6462) : !memref_smem_bf16_19
      %2072:2 = cute.get_scalars(%lay_6471) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6472 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6473 = cute.assume(%2072#0) : (i32) -> !cute.i32<divby 16>
      %iv_6474 = cute.assume(%2072#1) : (i32) -> !cute.i32<divby 32>
      %stride_6475 = cute.make_stride(%iv_6473, %iv_6474) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6476 = cute.make_layout(%shape_6472, %stride_6475) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6477 = cute.make_view(%iter_6470, %lay_6476) : !memref_smem_bf16_20
      %iter_6478 = cute.get_iter(%view_6477) : !memref_smem_bf16_20
      %iter_6479 = cute.get_iter(%view_6477) : !memref_smem_bf16_20
      %lay_6480 = cute.get_layout(%view_6445) : !memref_rmem_bf16_18
      %shape_6481 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6482 = cute.make_layout() : !cute.layout<"1:0">
      %append_6483 = cute.append_to_rank<2> (%lay_6480, %lay_6482) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6484 = cute.make_view(%iter_6446, %append_6483) : !memref_rmem_bf16_18
      %iter_6485 = cute.get_iter(%view_6484) : !memref_rmem_bf16_18
      %lay_6486 = cute.get_layout(%view_6484) : !memref_rmem_bf16_18
      %2073 = cute.get_shape(%lay_6486) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6487, %e1_6488, %e2_6489, %e3_6490 = cute.get_leaves(%2073) : !cute.shape<"((8,1),(4,2))">
      %iter_6491 = cute.get_iter(%view_6484) : !memref_rmem_bf16_18
      %view_6492 = cute.make_view(%iter_6491) : !memref_rmem_bf16_19
      %iter_6493 = cute.get_iter(%view_6492) : !memref_rmem_bf16_19
      %iter_6494 = cute.get_iter(%view_6492) : !memref_rmem_bf16_19
      %lay_6495 = cute.get_layout(%view_6477) : !memref_smem_bf16_20
      %2074 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6496, %e1_6497, %e2_6498, %e3_6499, %e4_6500 = cute.get_leaves(%2074) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6501 = cute.get_layout(%view_6492) : !memref_rmem_bf16_19
      %2075 = cute.get_shape(%lay_6501) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6502, %e1_6503, %e2_6504, %e3_6505 = cute.get_leaves(%2075) : !cute.shape<"((8,1),((4,2)))">
      %lay_6506 = cute.get_layout(%view_6477) : !memref_smem_bf16_20
      %sz_6507 = cute.size(%lay_6506) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6508 = cute.get_leaves(%sz_6507) : !cute.int_tuple<"8">
      %lay_6509 = cute.get_layout(%view_6492) : !memref_rmem_bf16_19
      %sz_6510 = cute.size(%lay_6509) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6511 = cute.get_leaves(%sz_6510) : !cute.int_tuple<"8">
      %2076 = cute.static : !cute.layout<"1:0">
      %iter_6512 = cute.get_iter(%view_6477) : !memref_smem_bf16_20
      %iter_6513 = cute.get_iter(%view_6492) : !memref_rmem_bf16_19
      %lay_6514 = cute.get_layout(%view_6477) : !memref_smem_bf16_20
      %lay_6515 = cute.get_layout(%view_6492) : !memref_rmem_bf16_19
      %append_6516 = cute.append_to_rank<2> (%lay_6514, %2076) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6517 = cute.append_to_rank<2> (%lay_6515, %2076) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2077:2 = cute.get_scalars(%append_6516) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6518 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6519 = cute.assume(%2077#0) : (i32) -> !cute.i32<divby 16>
      %iv_6520 = cute.assume(%2077#1) : (i32) -> !cute.i32<divby 32>
      %stride_6521 = cute.make_stride(%iv_6519, %iv_6520) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6522 = cute.make_layout(%shape_6518, %stride_6521) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6523 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6524 = cute.size(%lay_6522) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2078 = cute.get_scalars(%sz_6524) : !cute.int_tuple<"8">
      %c0_i32_6525 = arith.constant 0 : i32
      %c1_i32_6526 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6525 to %2078 step %c1_i32_6526  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_6522, %coord_7719) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_6522) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7722 = cute.add_offset(%iter_6512, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_6523, %coord_7719) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_6523) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_6513, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7723, %view_7727) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6527 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6528 = cute.get_layout(%view_6181) : !memref_rmem_bf16_17
      %idx_6529 = cute.crd2idx(%coord_6527, %lay_6528) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
      %iter_6530 = cute.get_iter(%view_6181) : !memref_rmem_bf16_17
      %ptr_6531 = cute.add_offset(%iter_6530, %idx_6529) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6532 = cute.make_view(%ptr_6531) : !memref_rmem_bf16_20
      %iter_6533 = cute.get_iter(%view_6532) : !memref_rmem_bf16_20
      %coord_6534 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
      %lay_6535 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
      %idx_6536 = cute.crd2idx(%coord_6534, %lay_6535) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
      %iter_6537 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
      %ptr_6538 = cute.add_offset(%iter_6537, %idx_6536) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6539 = cute.make_view(%ptr_6538) : !memref_rmem_bf16_21
      %iter_6540 = cute.get_iter(%view_6539) : !memref_rmem_bf16_21
      %lay_6541 = cute.get_layout(%view_6532) : !memref_rmem_bf16_20
      %2079 = cute.get_shape(%lay_6541) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6542, %e1_6543, %e2_6544, %e3_6545 = cute.get_leaves(%2079) : !cute.shape<"(((2,2),2),2)">
      %lay_6546 = cute.get_layout(%view_6539) : !memref_rmem_bf16_21
      %2080 = cute.get_shape(%lay_6546) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6547, %e1_6548, %e2_6549, %e3_6550 = cute.get_leaves(%2080) : !cute.shape<"((2,2),(8,2))">
      %iter_6551 = cute.get_iter(%view_6532) : !memref_rmem_bf16_20
      %iter_6552 = cute.get_iter(%view_6539) : !memref_rmem_bf16_21
      %iter_6553 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6554 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6555 = cute.get_layout(%view_6532) : !memref_rmem_bf16_20
      %lay_6556 = cute.get_layout(%view_6539) : !memref_rmem_bf16_21
      %lay_6557 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6558 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2081 = cute.static : !cute.layout<"1:0">
      %append_6559 = cute.append_to_rank<3> (%lay_6555, %2081) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6560 = cute.append_to_rank<3> (%lay_6556, %2081) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6561 = cute.size(%append_6559) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6562 = cute.size(%append_6559) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6563 = cute.size(%append_6560) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2082 = cute.get_scalars(%sz_6561) : !cute.int_tuple<"1">
      %2083 = cute.get_scalars(%sz_6562) : !cute.int_tuple<"2">
      %2084 = cute.get_scalars(%sz_6563) : !cute.int_tuple<"16">
      %c0_i32_6564 = arith.constant 0 : i32
      %c1_i32_6565 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6564 to %2082 step %c1_i32_6565  : i32 {
        scf.for %arg6 = %c0_i32_6564 to %2083 step %c1_i32_6565  : i32 {
          scf.for %arg7 = %c0_i32_6564 to %2084 step %c1_i32_6565  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_6559, %coord_7719) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_6559) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7724 = cute.add_offset(%iter_6551, %idx_7723) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_22
            %slice_7726 = cute.slice(%append_6560, %coord_7720) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_6560) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_6552, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_6557, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_6557) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_6553, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_6558, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_6558) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_6554, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6566 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6567 = cute.size(%int_tuple_6566) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6568 = cute.get_leaves(%sz_6567) : !cute.int_tuple<"4">
      %coord_6569 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6570 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
      %slice_6571 = cute.slice(%lay_6570, %coord_6569) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
      %idx_6572 = cute.crd2idx(%coord_6569, %lay_6570) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
      %iter_6573 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %ptr_6574 = cute.add_offset(%iter_6573, %idx_6572) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6575 = cute.make_view(%ptr_6574, %slice_6571) : !memref_smem_bf16_19
      %iter_6576 = cute.get_iter(%view_6575) : !memref_smem_bf16_19
      %coord_6577 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6578 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
      %idx_6579 = cute.crd2idx(%coord_6577, %lay_6578) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
      %iter_6580 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %ptr_6581 = cute.add_offset(%iter_6580, %idx_6579) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6582 = cute.make_view(%ptr_6581) : !memref_rmem_bf16_18
      %iter_6583 = cute.get_iter(%view_6582) : !memref_rmem_bf16_18
      %lay_6584 = cute.get_layout(%view_6575) : !memref_smem_bf16_19
      %2085 = cute.get_shape(%lay_6584) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6585, %e1_6586, %e2_6587, %e3_6588, %e4_6589 = cute.get_leaves(%2085) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6590 = cute.get_layout(%view_6582) : !memref_rmem_bf16_18
      %2086 = cute.get_shape(%lay_6590) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6591, %e1_6592, %e2_6593, %e3_6594 = cute.get_leaves(%2086) : !cute.shape<"((8,1),(4,2))">
      %lay_6595 = cute.get_layout(%view_6575) : !memref_smem_bf16_19
      %shape_6596 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6597 = cute.make_layout() : !cute.layout<"1:0">
      %append_6598 = cute.append_to_rank<2> (%lay_6595, %lay_6597) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6599 = cute.make_view(%iter_6576, %append_6598) : !memref_smem_bf16_19
      %iter_6600 = cute.get_iter(%view_6599) : !memref_smem_bf16_19
      %lay_6601 = cute.get_layout(%view_6599) : !memref_smem_bf16_19
      %2087 = cute.get_shape(%lay_6601) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6602, %e1_6603, %e2_6604, %e3_6605, %e4_6606 = cute.get_leaves(%2087) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6607 = cute.get_iter(%view_6599) : !memref_smem_bf16_19
      %lay_6608 = cute.get_layout(%view_6599) : !memref_smem_bf16_19
      %2088:2 = cute.get_scalars(%lay_6608) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6609 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6610 = cute.assume(%2088#0) : (i32) -> !cute.i32<divby 16>
      %iv_6611 = cute.assume(%2088#1) : (i32) -> !cute.i32<divby 32>
      %stride_6612 = cute.make_stride(%iv_6610, %iv_6611) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6613 = cute.make_layout(%shape_6609, %stride_6612) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6614 = cute.make_view(%iter_6607, %lay_6613) : !memref_smem_bf16_20
      %iter_6615 = cute.get_iter(%view_6614) : !memref_smem_bf16_20
      %iter_6616 = cute.get_iter(%view_6614) : !memref_smem_bf16_20
      %lay_6617 = cute.get_layout(%view_6582) : !memref_rmem_bf16_18
      %shape_6618 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6619 = cute.make_layout() : !cute.layout<"1:0">
      %append_6620 = cute.append_to_rank<2> (%lay_6617, %lay_6619) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6621 = cute.make_view(%iter_6583, %append_6620) : !memref_rmem_bf16_18
      %iter_6622 = cute.get_iter(%view_6621) : !memref_rmem_bf16_18
      %lay_6623 = cute.get_layout(%view_6621) : !memref_rmem_bf16_18
      %2089 = cute.get_shape(%lay_6623) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6624, %e1_6625, %e2_6626, %e3_6627 = cute.get_leaves(%2089) : !cute.shape<"((8,1),(4,2))">
      %iter_6628 = cute.get_iter(%view_6621) : !memref_rmem_bf16_18
      %view_6629 = cute.make_view(%iter_6628) : !memref_rmem_bf16_19
      %iter_6630 = cute.get_iter(%view_6629) : !memref_rmem_bf16_19
      %iter_6631 = cute.get_iter(%view_6629) : !memref_rmem_bf16_19
      %lay_6632 = cute.get_layout(%view_6614) : !memref_smem_bf16_20
      %2090 = cute.get_shape(%lay_6632) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6633, %e1_6634, %e2_6635, %e3_6636, %e4_6637 = cute.get_leaves(%2090) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6638 = cute.get_layout(%view_6629) : !memref_rmem_bf16_19
      %2091 = cute.get_shape(%lay_6638) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6639, %e1_6640, %e2_6641, %e3_6642 = cute.get_leaves(%2091) : !cute.shape<"((8,1),((4,2)))">
      %lay_6643 = cute.get_layout(%view_6614) : !memref_smem_bf16_20
      %sz_6644 = cute.size(%lay_6643) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6645 = cute.get_leaves(%sz_6644) : !cute.int_tuple<"8">
      %lay_6646 = cute.get_layout(%view_6629) : !memref_rmem_bf16_19
      %sz_6647 = cute.size(%lay_6646) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6648 = cute.get_leaves(%sz_6647) : !cute.int_tuple<"8">
      %2092 = cute.static : !cute.layout<"1:0">
      %iter_6649 = cute.get_iter(%view_6614) : !memref_smem_bf16_20
      %iter_6650 = cute.get_iter(%view_6629) : !memref_rmem_bf16_19
      %lay_6651 = cute.get_layout(%view_6614) : !memref_smem_bf16_20
      %lay_6652 = cute.get_layout(%view_6629) : !memref_rmem_bf16_19
      %append_6653 = cute.append_to_rank<2> (%lay_6651, %2092) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6654 = cute.append_to_rank<2> (%lay_6652, %2092) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2093:2 = cute.get_scalars(%append_6653) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6655 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6656 = cute.assume(%2093#0) : (i32) -> !cute.i32<divby 16>
      %iv_6657 = cute.assume(%2093#1) : (i32) -> !cute.i32<divby 32>
      %stride_6658 = cute.make_stride(%iv_6656, %iv_6657) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6659 = cute.make_layout(%shape_6655, %stride_6658) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6660 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6661 = cute.size(%lay_6659) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2094 = cute.get_scalars(%sz_6661) : !cute.int_tuple<"8">
      %c0_i32_6662 = arith.constant 0 : i32
      %c1_i32_6663 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6662 to %2094 step %c1_i32_6663  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_6659, %coord_7719) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_6659) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7722 = cute.add_offset(%iter_6649, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_6660, %coord_7719) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_6660) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_6650, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7723, %view_7727) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6664 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6665 = cute.get_layout(%view_6181) : !memref_rmem_bf16_17
      %idx_6666 = cute.crd2idx(%coord_6664, %lay_6665) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
      %iter_6667 = cute.get_iter(%view_6181) : !memref_rmem_bf16_17
      %ptr_6668 = cute.add_offset(%iter_6667, %idx_6666) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6669 = cute.make_view(%ptr_6668) : !memref_rmem_bf16_20
      %iter_6670 = cute.get_iter(%view_6669) : !memref_rmem_bf16_20
      %coord_6671 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
      %lay_6672 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
      %idx_6673 = cute.crd2idx(%coord_6671, %lay_6672) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
      %iter_6674 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
      %ptr_6675 = cute.add_offset(%iter_6674, %idx_6673) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6676 = cute.make_view(%ptr_6675) : !memref_rmem_bf16_21
      %iter_6677 = cute.get_iter(%view_6676) : !memref_rmem_bf16_21
      %lay_6678 = cute.get_layout(%view_6669) : !memref_rmem_bf16_20
      %2095 = cute.get_shape(%lay_6678) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6679, %e1_6680, %e2_6681, %e3_6682 = cute.get_leaves(%2095) : !cute.shape<"(((2,2),2),2)">
      %lay_6683 = cute.get_layout(%view_6676) : !memref_rmem_bf16_21
      %2096 = cute.get_shape(%lay_6683) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6684, %e1_6685, %e2_6686, %e3_6687 = cute.get_leaves(%2096) : !cute.shape<"((2,2),(8,2))">
      %iter_6688 = cute.get_iter(%view_6669) : !memref_rmem_bf16_20
      %iter_6689 = cute.get_iter(%view_6676) : !memref_rmem_bf16_21
      %iter_6690 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6691 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6692 = cute.get_layout(%view_6669) : !memref_rmem_bf16_20
      %lay_6693 = cute.get_layout(%view_6676) : !memref_rmem_bf16_21
      %lay_6694 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6695 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2097 = cute.static : !cute.layout<"1:0">
      %append_6696 = cute.append_to_rank<3> (%lay_6692, %2097) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6697 = cute.append_to_rank<3> (%lay_6693, %2097) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6698 = cute.size(%append_6696) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6699 = cute.size(%append_6696) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6700 = cute.size(%append_6697) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2098 = cute.get_scalars(%sz_6698) : !cute.int_tuple<"1">
      %2099 = cute.get_scalars(%sz_6699) : !cute.int_tuple<"2">
      %2100 = cute.get_scalars(%sz_6700) : !cute.int_tuple<"16">
      %c0_i32_6701 = arith.constant 0 : i32
      %c1_i32_6702 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6701 to %2098 step %c1_i32_6702  : i32 {
        scf.for %arg6 = %c0_i32_6701 to %2099 step %c1_i32_6702  : i32 {
          scf.for %arg7 = %c0_i32_6701 to %2100 step %c1_i32_6702  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_6696, %coord_7719) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_6696) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7724 = cute.add_offset(%iter_6688, %idx_7723) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_22
            %slice_7726 = cute.slice(%append_6697, %coord_7720) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_6697) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_6689, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_6694, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_6694) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_6690, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_6695, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_6695) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_6691, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %int_tuple_6703 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
      %sz_6704 = cute.size(%int_tuple_6703) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
      %e0_6705 = cute.get_leaves(%sz_6704) : !cute.int_tuple<"4">
      %coord_6706 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6707 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
      %slice_6708 = cute.slice(%lay_6707, %coord_6706) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
      %idx_6709 = cute.crd2idx(%coord_6706, %lay_6707) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
      %iter_6710 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
      %ptr_6711 = cute.add_offset(%iter_6710, %idx_6709) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
      %view_6712 = cute.make_view(%ptr_6711, %slice_6708) : !memref_smem_bf16_19
      %iter_6713 = cute.get_iter(%view_6712) : !memref_smem_bf16_19
      %coord_6714 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
      %lay_6715 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
      %idx_6716 = cute.crd2idx(%coord_6714, %lay_6715) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
      %iter_6717 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
      %ptr_6718 = cute.add_offset(%iter_6717, %idx_6716) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6719 = cute.make_view(%ptr_6718) : !memref_rmem_bf16_18
      %iter_6720 = cute.get_iter(%view_6719) : !memref_rmem_bf16_18
      %lay_6721 = cute.get_layout(%view_6712) : !memref_smem_bf16_19
      %2101 = cute.get_shape(%lay_6721) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6722, %e1_6723, %e2_6724, %e3_6725, %e4_6726 = cute.get_leaves(%2101) : !cute.shape<"((8,1),((2,2),2))">
      %lay_6727 = cute.get_layout(%view_6719) : !memref_rmem_bf16_18
      %2102 = cute.get_shape(%lay_6727) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6728, %e1_6729, %e2_6730, %e3_6731 = cute.get_leaves(%2102) : !cute.shape<"((8,1),(4,2))">
      %lay_6732 = cute.get_layout(%view_6712) : !memref_smem_bf16_19
      %shape_6733 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6734 = cute.make_layout() : !cute.layout<"1:0">
      %append_6735 = cute.append_to_rank<2> (%lay_6732, %lay_6734) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
      %view_6736 = cute.make_view(%iter_6713, %append_6735) : !memref_smem_bf16_19
      %iter_6737 = cute.get_iter(%view_6736) : !memref_smem_bf16_19
      %lay_6738 = cute.get_layout(%view_6736) : !memref_smem_bf16_19
      %2103 = cute.get_shape(%lay_6738) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
      %e0_6739, %e1_6740, %e2_6741, %e3_6742, %e4_6743 = cute.get_leaves(%2103) : !cute.shape<"((8,1),((2,2),2))">
      %iter_6744 = cute.get_iter(%view_6736) : !memref_smem_bf16_19
      %lay_6745 = cute.get_layout(%view_6736) : !memref_smem_bf16_19
      %2104:2 = cute.get_scalars(%lay_6745) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
      %shape_6746 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
      %iv_6747 = cute.assume(%2104#0) : (i32) -> !cute.i32<divby 16>
      %iv_6748 = cute.assume(%2104#1) : (i32) -> !cute.i32<divby 32>
      %stride_6749 = cute.make_stride(%iv_6747, %iv_6748) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
      %lay_6750 = cute.make_layout(%shape_6746, %stride_6749) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %view_6751 = cute.make_view(%iter_6744, %lay_6750) : !memref_smem_bf16_20
      %iter_6752 = cute.get_iter(%view_6751) : !memref_smem_bf16_20
      %iter_6753 = cute.get_iter(%view_6751) : !memref_smem_bf16_20
      %lay_6754 = cute.get_layout(%view_6719) : !memref_rmem_bf16_18
      %shape_6755 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_6756 = cute.make_layout() : !cute.layout<"1:0">
      %append_6757 = cute.append_to_rank<2> (%lay_6754, %lay_6756) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
      %view_6758 = cute.make_view(%iter_6720, %append_6757) : !memref_rmem_bf16_18
      %iter_6759 = cute.get_iter(%view_6758) : !memref_rmem_bf16_18
      %lay_6760 = cute.get_layout(%view_6758) : !memref_rmem_bf16_18
      %2105 = cute.get_shape(%lay_6760) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
      %e0_6761, %e1_6762, %e2_6763, %e3_6764 = cute.get_leaves(%2105) : !cute.shape<"((8,1),(4,2))">
      %iter_6765 = cute.get_iter(%view_6758) : !memref_rmem_bf16_18
      %view_6766 = cute.make_view(%iter_6765) : !memref_rmem_bf16_19
      %iter_6767 = cute.get_iter(%view_6766) : !memref_rmem_bf16_19
      %iter_6768 = cute.get_iter(%view_6766) : !memref_rmem_bf16_19
      %lay_6769 = cute.get_layout(%view_6751) : !memref_smem_bf16_20
      %2106 = cute.get_shape(%lay_6769) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
      %e0_6770, %e1_6771, %e2_6772, %e3_6773, %e4_6774 = cute.get_leaves(%2106) : !cute.shape<"((8,1),(((2,2),2)))">
      %lay_6775 = cute.get_layout(%view_6766) : !memref_rmem_bf16_19
      %2107 = cute.get_shape(%lay_6775) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
      %e0_6776, %e1_6777, %e2_6778, %e3_6779 = cute.get_leaves(%2107) : !cute.shape<"((8,1),((4,2)))">
      %lay_6780 = cute.get_layout(%view_6751) : !memref_smem_bf16_20
      %sz_6781 = cute.size(%lay_6780) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
      %e0_6782 = cute.get_leaves(%sz_6781) : !cute.int_tuple<"8">
      %lay_6783 = cute.get_layout(%view_6766) : !memref_rmem_bf16_19
      %sz_6784 = cute.size(%lay_6783) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
      %e0_6785 = cute.get_leaves(%sz_6784) : !cute.int_tuple<"8">
      %2108 = cute.static : !cute.layout<"1:0">
      %iter_6786 = cute.get_iter(%view_6751) : !memref_smem_bf16_20
      %iter_6787 = cute.get_iter(%view_6766) : !memref_rmem_bf16_19
      %lay_6788 = cute.get_layout(%view_6751) : !memref_smem_bf16_20
      %lay_6789 = cute.get_layout(%view_6766) : !memref_rmem_bf16_19
      %append_6790 = cute.append_to_rank<2> (%lay_6788, %2108) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
      %append_6791 = cute.append_to_rank<2> (%lay_6789, %2108) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
      %2109:2 = cute.get_scalars(%append_6790) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
      %shape_6792 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
      %iv_6793 = cute.assume(%2109#0) : (i32) -> !cute.i32<divby 16>
      %iv_6794 = cute.assume(%2109#1) : (i32) -> !cute.i32<divby 32>
      %stride_6795 = cute.make_stride(%iv_6793, %iv_6794) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6796 = cute.make_layout(%shape_6792, %stride_6795) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
      %lay_6797 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
      %sz_6798 = cute.size(%lay_6796) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
      %2110 = cute.get_scalars(%sz_6798) : !cute.int_tuple<"8">
      %c0_i32_6799 = arith.constant 0 : i32
      %c1_i32_6800 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6799 to %2110 step %c1_i32_6800  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_6796, %coord_7719) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_6796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7722 = cute.add_offset(%iter_6786, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_6797, %coord_7719) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_6797) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_6787, %idx_7725) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_11
        cute.copy_atom_call(%158, %view_7723, %view_7727) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_6801 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6802 = cute.get_layout(%view_6181) : !memref_rmem_bf16_17
      %idx_6803 = cute.crd2idx(%coord_6801, %lay_6802) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
      %iter_6804 = cute.get_iter(%view_6181) : !memref_rmem_bf16_17
      %ptr_6805 = cute.add_offset(%iter_6804, %idx_6803) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
      %view_6806 = cute.make_view(%ptr_6805) : !memref_rmem_bf16_20
      %iter_6807 = cute.get_iter(%view_6806) : !memref_rmem_bf16_20
      %coord_6808 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
      %lay_6809 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
      %idx_6810 = cute.crd2idx(%coord_6808, %lay_6809) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
      %iter_6811 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
      %ptr_6812 = cute.add_offset(%iter_6811, %idx_6810) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
      %view_6813 = cute.make_view(%ptr_6812) : !memref_rmem_bf16_21
      %iter_6814 = cute.get_iter(%view_6813) : !memref_rmem_bf16_21
      %lay_6815 = cute.get_layout(%view_6806) : !memref_rmem_bf16_20
      %2111 = cute.get_shape(%lay_6815) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
      %e0_6816, %e1_6817, %e2_6818, %e3_6819 = cute.get_leaves(%2111) : !cute.shape<"(((2,2),2),2)">
      %lay_6820 = cute.get_layout(%view_6813) : !memref_rmem_bf16_21
      %2112 = cute.get_shape(%lay_6820) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
      %e0_6821, %e1_6822, %e2_6823, %e3_6824 = cute.get_leaves(%2112) : !cute.shape<"((2,2),(8,2))">
      %iter_6825 = cute.get_iter(%view_6806) : !memref_rmem_bf16_20
      %iter_6826 = cute.get_iter(%view_6813) : !memref_rmem_bf16_21
      %iter_6827 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %iter_6828 = cute.get_iter(%rmem) : !memref_rmem_f32_
      %lay_6829 = cute.get_layout(%view_6806) : !memref_rmem_bf16_20
      %lay_6830 = cute.get_layout(%view_6813) : !memref_rmem_bf16_21
      %lay_6831 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6832 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2113 = cute.static : !cute.layout<"1:0">
      %append_6833 = cute.append_to_rank<3> (%lay_6829, %2113) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
      %append_6834 = cute.append_to_rank<3> (%lay_6830, %2113) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
      %sz_6835 = cute.size(%append_6833) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
      %sz_6836 = cute.size(%append_6833) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
      %sz_6837 = cute.size(%append_6834) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
      %2114 = cute.get_scalars(%sz_6835) : !cute.int_tuple<"1">
      %2115 = cute.get_scalars(%sz_6836) : !cute.int_tuple<"2">
      %2116 = cute.get_scalars(%sz_6837) : !cute.int_tuple<"16">
      %c0_i32_6838 = arith.constant 0 : i32
      %c1_i32_6839 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_6838 to %2114 step %c1_i32_6839  : i32 {
        scf.for %arg6 = %c0_i32_6838 to %2115 step %c1_i32_6839  : i32 {
          scf.for %arg7 = %c0_i32_6838 to %2116 step %c1_i32_6839  : i32 {
            %coord_7719 = cute.make_coord(%arg6, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7720 = cute.make_coord(%arg7, %arg5) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %coord_7721 = cute.make_coord(%arg6, %arg7) : (i32, i32) -> !cute.coord<"(_,?,?)">
            %slice_7722 = cute.slice(%append_6833, %coord_7719) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
            %idx_7723 = cute.crd2idx(%coord_7719, %append_6833) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7724 = cute.add_offset(%iter_6825, %idx_7723) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7725 = cute.make_view(%ptr_7724, %slice_7722) : !memref_rmem_bf16_22
            %slice_7726 = cute.slice(%append_6834, %coord_7720) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
            %idx_7727 = cute.crd2idx(%coord_7720, %append_6834) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7728 = cute.add_offset(%iter_6826, %idx_7727) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
            %view_7729 = cute.make_view(%ptr_7728, %slice_7726) : !memref_rmem_bf16_15
            %slice_7730 = cute.slice(%lay_6831, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7731 = cute.crd2idx(%coord_7721, %lay_6831) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7732 = cute.add_offset(%iter_6827, %idx_7731) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7733 = cute.make_view(%ptr_7732, %slice_7730) : !memref_rmem_f32_3
            %slice_7734 = cute.slice(%lay_6832, %coord_7721) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
            %idx_7735 = cute.crd2idx(%coord_7721, %lay_6832) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
            %ptr_7736 = cute.add_offset(%iter_6828, %idx_7735) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
            %view_7737 = cute.make_view(%ptr_7736, %slice_7734) : !memref_rmem_f32_3
            cute.mma_atom_call(%5, %view_7737, %view_7725, %view_7729, %view_7733) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
      } {llvm.loop_annotation = #loop_annotation}
      %c1_i32_6840 = arith.constant 1 : i32
      %2117:7 = scf.for %arg5 = %c1_i32_6840 to %128 step %c1_i32_6840 iter_args(%arg6 = %498, %arg7 = %117, %arg8 = %498, %arg9 = %arg0, %arg10 = %arg1, %arg11 = %118, %arg12 = %119) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_7719 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_7720 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %lay_7721 = cute.get_layout(%arg9) : !memref_gmem_bf16_
        %2485 = cute.get_shape(%lay_7721) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7722, %e1_7723, %e2_7724, %e3_7725 = cute.get_leaves(%2485) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7726 = cute.to_int_tuple(%e0_7722) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2486 = cute.get_scalars(%itup_7726) : !cute.int_tuple<"?">
        %itup_7727 = cute.to_int_tuple(%e1_7723) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2487 = cute.get_scalars(%itup_7727) : !cute.int_tuple<"?">
        %itup_7728 = cute.to_int_tuple(%e2_7724) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2488 = cute.get_scalars(%itup_7728) : !cute.int_tuple<"?">
        %itup_7729 = cute.to_int_tuple(%e3_7725) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2489 = cute.get_scalars(%itup_7729) : !cute.int_tuple<"?{div=8}">
        %2490 = cute.get_stride(%lay_7721) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_7730, %e1_7731, %e2_7732, %e3_7733 = cute.get_leaves(%2490) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_7734 = cute.to_int_tuple(%e0_7730) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2491 = cute.get_scalars(%itup_7734) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7735 = cute.to_int_tuple(%e1_7731) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2492 = cute.get_scalars(%itup_7735) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7736 = cute.to_int_tuple(%e2_7732) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2493 = cute.get_scalars(%itup_7736) : !cute.int_tuple<"?{i64 div=8}">
        %lay_7737 = cute.get_layout(%arg10) : !memref_gmem_bf16_
        %2494 = cute.get_shape(%lay_7737) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
        %e0_7738, %e1_7739, %e2_7740, %e3_7741 = cute.get_leaves(%2494) : !cute.shape<"(?,?,?,?{div=8})">
        %itup_7742 = cute.to_int_tuple(%e0_7738) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2495 = cute.get_scalars(%itup_7742) : !cute.int_tuple<"?">
        %itup_7743 = cute.to_int_tuple(%e1_7739) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2496 = cute.get_scalars(%itup_7743) : !cute.int_tuple<"?">
        %itup_7744 = cute.to_int_tuple(%e2_7740) : !cute.shape<"?"> to !cute.int_tuple<"?">
        %2497 = cute.get_scalars(%itup_7744) : !cute.int_tuple<"?">
        %itup_7745 = cute.to_int_tuple(%e3_7741) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
        %2498 = cute.get_scalars(%itup_7745) : !cute.int_tuple<"?{div=8}">
        %2499 = cute.get_stride(%lay_7737) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %e0_7746, %e1_7747, %e2_7748, %e3_7749 = cute.get_leaves(%2499) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
        %itup_7750 = cute.to_int_tuple(%e0_7746) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2500 = cute.get_scalars(%itup_7750) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7751 = cute.to_int_tuple(%e1_7747) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2501 = cute.get_scalars(%itup_7751) : !cute.int_tuple<"?{i64 div=8}">
        %itup_7752 = cute.to_int_tuple(%e2_7748) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
        %2502 = cute.get_scalars(%itup_7752) : !cute.int_tuple<"?{i64 div=8}">
        %iter_7753 = cute.get_iter(%arg9) : !memref_gmem_bf16_
        %iter_7754 = cute.get_iter(%arg10) : !memref_gmem_bf16_
        %2503 = arith.subi %128, %arg5 : i32
        %c1_i32_7755 = arith.constant 1 : i32
        %2504 = arith.subi %2503, %c1_i32_7755 : i32
        %shape_7756 = cute.make_shape() : () -> !cute.shape<"(128,64)">
        %2505 = cute.tiled.mma.partition_shape C (%5, %shape_7756) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7757, %e1_7758, %e2_7759, %e3_7760 = cute.get_leaves(%2505) : !cute.shape<"((2,2),2,8)">
        %shape_7761 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_7762 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_7763 = cute.memref.alloca(%lay_7762) : !memref_rmem_f32_2
        %iter_7764 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_7765 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_7766 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %sz_7767 = cute.size(%lay_7766) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"64">
        %e0_7768 = cute.get_leaves(%sz_7767) : !cute.int_tuple<"64">
        %lay_7769 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2506 = cute.get_shape(%lay_7769) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_7770, %e1_7771, %e2_7772, %e3_7773 = cute.get_leaves(%2506) : !cute.shape<"((2,2),2,8)">
        %int_tuple_7774 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %res_7775 = cute.tuple.product(%int_tuple_7774) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7776 = cute.get_leaves(%res_7775) : !cute.int_tuple<"64">
        %cst_7777 = arith.constant 0.000000e+00 : f32
        %2507 = vector.splat %cst_7777 : vector<64xf32>
        %int_tuple_7778 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7779 = cute.size(%int_tuple_7778) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7780 = cute.get_leaves(%sz_7779) : !cute.int_tuple<"64">
        %int_tuple_7781 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_7782 = cute.size(%int_tuple_7781) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_7783 = cute.get_leaves(%sz_7782) : !cute.int_tuple<"64">
        cute.memref.store_vec %2507, %rmem_7763, row_major : !memref_rmem_f32_2
        nvvm.cp.async.wait.group 0
        %c1_i32_7784 = arith.constant 1 : i32
        %c128_i32_7785 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_7784 number_of_threads = %c128_i32_7785
        %false_7786 = arith.constant false
        scf.if %false_7786 {
          %lay_10569 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %2929 = cute.get_shape(%lay_10569) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10570, %e1_10571, %e2_10572, %e3_10573 = cute.get_leaves(%2929) : !cute.shape<"((8,1),4,2)">
          %int_tuple_10574 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
          %sz_10575 = cute.size(%int_tuple_10574) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
          %e0_10576 = cute.get_leaves(%sz_10575) : !cute.int_tuple<"4">
          %coord_10577 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
          %lay_10578 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10579 = cute.crd2idx(%coord_10577, %lay_10578) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
          %iter_10580 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10581 = cute.add_offset(%iter_10580, %idx_10579) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10582 = cute.make_view(%tup_10581) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10583 = cute.get_iter(%view_10582) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10584, %e1_10585, %e2_10586, %e3_10587 = cute.get_leaves(%iter_10583) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2930 = cute.get_scalars(%e0_10584) : !cute.int_tuple<"?">
          %2931 = cute.get_scalars(%e1_10585) : !cute.int_tuple<"?">
          %2932 = cute.get_scalars(%e2_10586) : !cute.int_tuple<"?">
          %2933 = cute.get_scalars(%e3_10587) : !cute.int_tuple<"?{div=8}">
          %iter_10588 = cute.get_iter(%view_10582) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10589, %e1_10590, %e2_10591, %e3_10592 = cute.get_leaves(%iter_10588) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2934 = cute.get_scalars(%e0_10589) : !cute.int_tuple<"?">
          %2935 = cute.get_scalars(%e1_10590) : !cute.int_tuple<"?">
          %2936 = cute.get_scalars(%e2_10591) : !cute.int_tuple<"?">
          %2937 = cute.get_scalars(%e3_10592) : !cute.int_tuple<"?{div=8}">
          %iter_10593 = cute.get_iter(%view_10582) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10594, %e1_10595, %e2_10596, %e3_10597 = cute.get_leaves(%iter_10593) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2938 = cute.get_scalars(%e0_10594) : !cute.int_tuple<"?">
          %2939 = cute.get_scalars(%e1_10595) : !cute.int_tuple<"?">
          %2940 = cute.get_scalars(%e2_10596) : !cute.int_tuple<"?">
          %2941 = cute.get_scalars(%e3_10597) : !cute.int_tuple<"?{div=8}">
          %lay_10598 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2942 = cute.get_shape(%lay_10598) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10599, %e1_10600, %e2_10601, %e3_10602 = cute.get_leaves(%2942) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10603 = cute.to_int_tuple(%e0_10599) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2943 = cute.get_scalars(%itup_10603) : !cute.int_tuple<"?">
          %itup_10604 = cute.to_int_tuple(%e1_10600) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2944 = cute.get_scalars(%itup_10604) : !cute.int_tuple<"?">
          %itup_10605 = cute.to_int_tuple(%e2_10601) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2945 = cute.get_scalars(%itup_10605) : !cute.int_tuple<"?">
          %itup_10606 = cute.to_int_tuple(%e3_10602) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2946 = cute.get_scalars(%itup_10606) : !cute.int_tuple<"?{div=8}">
          %coord_10607 = cute.make_coord(%e1_10595) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10608 = cute.make_coord(%itup_10604) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2947 = cute.elem_less(%coord_10607, %coord_10608) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2947 {
            %coord_10705 = cute.make_coord(%2504) : (i32) -> !cute.coord<"(_,0,_,?)">
            %lay_10706 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,0,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
            %iter_10708 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_gmem_bf16_6
            %iter_10711 = cute.get_iter(%view_10710) : !memref_gmem_bf16_6
            %coord_10712 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10713 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10714 = cute.crd2idx(%coord_10712, %lay_10713) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_10715 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10716 = cute.add_offset(%iter_10715, %idx_10714) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10717 = cute.make_view(%ptr_10716) : !memref_smem_bf16_14
            %iter_10718 = cute.get_iter(%view_10717) : !memref_smem_bf16_14
            %coord_10719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10720 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
            %idx_10721 = cute.crd2idx(%coord_10719, %lay_10720) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10722 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
            %ptr_10723 = cute.add_offset(%iter_10722, %idx_10721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10724 = cute.make_view(%ptr_10723) : !memref_rmem_i8_2
            %iter_10725 = cute.get_iter(%view_10724) : !memref_rmem_i8_2
            %lay_10726 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %3002 = cute.get_shape(%lay_10726) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10727, %e1_10728, %e2_10729 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %lay_10730 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %3003 = cute.get_shape(%lay_10730) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10731, %e1_10732, %e2_10733 = cute.get_leaves(%3003) : !cute.shape<"((8,1),2)">
            %lay_10734 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %shape_10735 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10736 = cute.make_layout() : !cute.layout<"1:0">
            %append_10737 = cute.append_to_rank<2> (%lay_10734, %lay_10736) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10738 = cute.make_view(%iter_10711, %append_10737) : !memref_gmem_bf16_6
            %iter_10739 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %lay_10740 = cute.get_layout(%view_10738) : !memref_gmem_bf16_6
            %3004 = cute.get_shape(%lay_10740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10741, %e1_10742, %e2_10743 = cute.get_leaves(%3004) : !cute.shape<"((8,1),2)">
            %iter_10744 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %view_10745 = cute.make_view(%iter_10744) : !memref_gmem_bf16_7
            %iter_10746 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10747 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %lay_10748 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %shape_10749 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10750 = cute.make_layout() : !cute.layout<"1:0">
            %append_10751 = cute.append_to_rank<2> (%lay_10748, %lay_10750) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10752 = cute.make_view(%iter_10718, %append_10751) : !memref_smem_bf16_14
            %iter_10753 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %lay_10754 = cute.get_layout(%view_10752) : !memref_smem_bf16_14
            %3005 = cute.get_shape(%lay_10754) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10755, %e1_10756, %e2_10757 = cute.get_leaves(%3005) : !cute.shape<"((8,1),2)">
            %iter_10758 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %view_10759 = cute.make_view(%iter_10758) : !memref_smem_bf16_15
            %iter_10760 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %iter_10761 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10762 = cute.get_layout(%view_10724) : !memref_rmem_i8_2
            %shape_10763 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10764 = cute.make_layout() : !cute.layout<"1:0">
            %append_10765 = cute.append_to_rank<2> (%lay_10762, %lay_10764) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10766 = cute.make_view(%iter_10725, %append_10765) : !memref_rmem_i8_2
            %iter_10767 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %lay_10768 = cute.get_layout(%view_10766) : !memref_rmem_i8_2
            %3006 = cute.get_shape(%lay_10768) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10769, %e1_10770 = cute.get_leaves(%3006) : !cute.shape<"(1,2)">
            %iter_10771 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %view_10772 = cute.make_view(%iter_10771) : !memref_rmem_i8_3
            %iter_10773 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %iter_10774 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10775 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %3007 = cute.get_shape(%lay_10775) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10776, %e1_10777, %e2_10778 = cute.get_leaves(%3007) : !cute.shape<"((8,1),(2))">
            %lay_10779 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %3008 = cute.get_shape(%lay_10779) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10780, %e1_10781, %e2_10782 = cute.get_leaves(%3008) : !cute.shape<"((8,1),(2))">
            %lay_10783 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %sz_10784 = cute.size(%lay_10783) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10785 = cute.get_leaves(%sz_10784) : !cute.int_tuple<"2">
            %lay_10786 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %sz_10787 = cute.size(%lay_10786) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10788 = cute.get_leaves(%sz_10787) : !cute.int_tuple<"2">
            %3009 = cute.static : !cute.layout<"1:0">
            %iter_10789 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10790 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10791 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %lay_10792 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %append_10793 = cute.append_to_rank<2> (%lay_10791, %3009) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10794 = cute.append_to_rank<2> (%lay_10792, %3009) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10795 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10797 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10798 = cute.get_layout(%view_10772) : !memref_rmem_i8_3
            %append_10799 = cute.append_to_rank<2> (%lay_10798, %3009) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10800 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_10801 = cute.size(%lay_10795) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3010 = cute.get_scalars(%sz_10801) : !cute.int_tuple<"2">
            %c0_i32_10802 = arith.constant 0 : i32
            %c1_i32_10803 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_10802 to %3010 step %c1_i32_10803  : i32 {
              %coord_10804 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_10805 = cute.slice(%lay_10795, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_10806 = cute.crd2idx(%coord_10804, %lay_10795) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_10807 = cute.add_offset(%iter_10789, %idx_10806) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_10808 = cute.make_view(%ptr_10807, %slice_10805) : !memref_gmem_bf16_8
              %slice_10809 = cute.slice(%lay_10796, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_10810 = cute.crd2idx(%coord_10804, %lay_10796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_10811 = cute.add_offset(%iter_10790, %idx_10810) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_10812 = cute.make_view(%ptr_10811, %slice_10809) : !memref_smem_bf16_13
              %slice_10813 = cute.slice(%lay_10800, %coord_10804) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_10814 = cute.crd2idx(%coord_10804, %lay_10800) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_10815 = cute.add_offset(%iter_10797, %idx_10814) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_10816 = cute.make_view(%ptr_10815, %slice_10813) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_10808, %view_10812, %view_10816) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10705 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
            %lay_10706 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"0">
            %iter_10708 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_smem_bf16_14
            %iter_10711 = cute.get_iter(%view_10710) : !memref_smem_bf16_14
            %lay_10712 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %sz_10713 = cute.size(%lay_10712) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10714 = cute.get_leaves(%sz_10713) : !cute.int_tuple<"16">
            %lay_10715 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %3002 = cute.get_shape(%lay_10715) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10716, %e1_10717, %e2_10718 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %int_tuple_10719 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10720 = cute.tuple.product(%int_tuple_10719) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10721 = cute.get_leaves(%res_10720) : !cute.int_tuple<"16">
            %cst_10722 = arith.constant 0.000000e+00 : bf16
            %3003 = vector.splat %cst_10722 : vector<16xbf16>
            %int_tuple_10723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10724 = cute.size(%int_tuple_10723) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10725 = cute.get_leaves(%sz_10724) : !cute.int_tuple<"16">
            %int_tuple_10726 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10727 = cute.size(%int_tuple_10726) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10728 = cute.get_leaves(%sz_10727) : !cute.int_tuple<"16">
            cute.memref.store_vec %3003, %view_10710, row_major : !memref_smem_bf16_14
          }
          %coord_10609 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
          %lay_10610 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10611 = cute.crd2idx(%coord_10609, %lay_10610) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
          %iter_10612 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10613 = cute.add_offset(%iter_10612, %idx_10611) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10614 = cute.make_view(%tup_10613) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10615 = cute.get_iter(%view_10614) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10616, %e1_10617, %e2_10618, %e3_10619 = cute.get_leaves(%iter_10615) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2948 = cute.get_scalars(%e0_10616) : !cute.int_tuple<"?">
          %2949 = cute.get_scalars(%e1_10617) : !cute.int_tuple<"?">
          %2950 = cute.get_scalars(%e2_10618) : !cute.int_tuple<"?">
          %2951 = cute.get_scalars(%e3_10619) : !cute.int_tuple<"?{div=8}">
          %iter_10620 = cute.get_iter(%view_10614) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10621, %e1_10622, %e2_10623, %e3_10624 = cute.get_leaves(%iter_10620) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2952 = cute.get_scalars(%e0_10621) : !cute.int_tuple<"?">
          %2953 = cute.get_scalars(%e1_10622) : !cute.int_tuple<"?">
          %2954 = cute.get_scalars(%e2_10623) : !cute.int_tuple<"?">
          %2955 = cute.get_scalars(%e3_10624) : !cute.int_tuple<"?{div=8}">
          %iter_10625 = cute.get_iter(%view_10614) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10626, %e1_10627, %e2_10628, %e3_10629 = cute.get_leaves(%iter_10625) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2956 = cute.get_scalars(%e0_10626) : !cute.int_tuple<"?">
          %2957 = cute.get_scalars(%e1_10627) : !cute.int_tuple<"?">
          %2958 = cute.get_scalars(%e2_10628) : !cute.int_tuple<"?">
          %2959 = cute.get_scalars(%e3_10629) : !cute.int_tuple<"?{div=8}">
          %lay_10630 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2960 = cute.get_shape(%lay_10630) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10631, %e1_10632, %e2_10633, %e3_10634 = cute.get_leaves(%2960) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10635 = cute.to_int_tuple(%e0_10631) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2961 = cute.get_scalars(%itup_10635) : !cute.int_tuple<"?">
          %itup_10636 = cute.to_int_tuple(%e1_10632) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2962 = cute.get_scalars(%itup_10636) : !cute.int_tuple<"?">
          %itup_10637 = cute.to_int_tuple(%e2_10633) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2963 = cute.get_scalars(%itup_10637) : !cute.int_tuple<"?">
          %itup_10638 = cute.to_int_tuple(%e3_10634) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2964 = cute.get_scalars(%itup_10638) : !cute.int_tuple<"?{div=8}">
          %coord_10639 = cute.make_coord(%e1_10627) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10640 = cute.make_coord(%itup_10636) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2965 = cute.elem_less(%coord_10639, %coord_10640) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2965 {
            %coord_10705 = cute.make_coord(%2504) : (i32) -> !cute.coord<"(_,1,_,?)">
            %lay_10706 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,1,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_10708 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_gmem_bf16_6
            %iter_10711 = cute.get_iter(%view_10710) : !memref_gmem_bf16_6
            %coord_10712 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10713 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10714 = cute.crd2idx(%coord_10712, %lay_10713) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_10715 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10716 = cute.add_offset(%iter_10715, %idx_10714) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10717 = cute.make_view(%ptr_10716) : !memref_smem_bf16_14
            %iter_10718 = cute.get_iter(%view_10717) : !memref_smem_bf16_14
            %coord_10719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10720 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
            %idx_10721 = cute.crd2idx(%coord_10719, %lay_10720) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10722 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
            %ptr_10723 = cute.add_offset(%iter_10722, %idx_10721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10724 = cute.make_view(%ptr_10723) : !memref_rmem_i8_2
            %iter_10725 = cute.get_iter(%view_10724) : !memref_rmem_i8_2
            %lay_10726 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %3002 = cute.get_shape(%lay_10726) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10727, %e1_10728, %e2_10729 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %lay_10730 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %3003 = cute.get_shape(%lay_10730) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10731, %e1_10732, %e2_10733 = cute.get_leaves(%3003) : !cute.shape<"((8,1),2)">
            %lay_10734 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %shape_10735 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10736 = cute.make_layout() : !cute.layout<"1:0">
            %append_10737 = cute.append_to_rank<2> (%lay_10734, %lay_10736) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10738 = cute.make_view(%iter_10711, %append_10737) : !memref_gmem_bf16_6
            %iter_10739 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %lay_10740 = cute.get_layout(%view_10738) : !memref_gmem_bf16_6
            %3004 = cute.get_shape(%lay_10740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10741, %e1_10742, %e2_10743 = cute.get_leaves(%3004) : !cute.shape<"((8,1),2)">
            %iter_10744 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %view_10745 = cute.make_view(%iter_10744) : !memref_gmem_bf16_7
            %iter_10746 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10747 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %lay_10748 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %shape_10749 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10750 = cute.make_layout() : !cute.layout<"1:0">
            %append_10751 = cute.append_to_rank<2> (%lay_10748, %lay_10750) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10752 = cute.make_view(%iter_10718, %append_10751) : !memref_smem_bf16_14
            %iter_10753 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %lay_10754 = cute.get_layout(%view_10752) : !memref_smem_bf16_14
            %3005 = cute.get_shape(%lay_10754) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10755, %e1_10756, %e2_10757 = cute.get_leaves(%3005) : !cute.shape<"((8,1),2)">
            %iter_10758 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %view_10759 = cute.make_view(%iter_10758) : !memref_smem_bf16_15
            %iter_10760 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %iter_10761 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10762 = cute.get_layout(%view_10724) : !memref_rmem_i8_2
            %shape_10763 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10764 = cute.make_layout() : !cute.layout<"1:0">
            %append_10765 = cute.append_to_rank<2> (%lay_10762, %lay_10764) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10766 = cute.make_view(%iter_10725, %append_10765) : !memref_rmem_i8_2
            %iter_10767 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %lay_10768 = cute.get_layout(%view_10766) : !memref_rmem_i8_2
            %3006 = cute.get_shape(%lay_10768) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10769, %e1_10770 = cute.get_leaves(%3006) : !cute.shape<"(1,2)">
            %iter_10771 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %view_10772 = cute.make_view(%iter_10771) : !memref_rmem_i8_3
            %iter_10773 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %iter_10774 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10775 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %3007 = cute.get_shape(%lay_10775) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10776, %e1_10777, %e2_10778 = cute.get_leaves(%3007) : !cute.shape<"((8,1),(2))">
            %lay_10779 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %3008 = cute.get_shape(%lay_10779) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10780, %e1_10781, %e2_10782 = cute.get_leaves(%3008) : !cute.shape<"((8,1),(2))">
            %lay_10783 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %sz_10784 = cute.size(%lay_10783) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10785 = cute.get_leaves(%sz_10784) : !cute.int_tuple<"2">
            %lay_10786 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %sz_10787 = cute.size(%lay_10786) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10788 = cute.get_leaves(%sz_10787) : !cute.int_tuple<"2">
            %3009 = cute.static : !cute.layout<"1:0">
            %iter_10789 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10790 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10791 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %lay_10792 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %append_10793 = cute.append_to_rank<2> (%lay_10791, %3009) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10794 = cute.append_to_rank<2> (%lay_10792, %3009) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10795 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10797 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10798 = cute.get_layout(%view_10772) : !memref_rmem_i8_3
            %append_10799 = cute.append_to_rank<2> (%lay_10798, %3009) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10800 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_10801 = cute.size(%lay_10795) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3010 = cute.get_scalars(%sz_10801) : !cute.int_tuple<"2">
            %c0_i32_10802 = arith.constant 0 : i32
            %c1_i32_10803 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_10802 to %3010 step %c1_i32_10803  : i32 {
              %coord_10804 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_10805 = cute.slice(%lay_10795, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_10806 = cute.crd2idx(%coord_10804, %lay_10795) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_10807 = cute.add_offset(%iter_10789, %idx_10806) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_10808 = cute.make_view(%ptr_10807, %slice_10805) : !memref_gmem_bf16_8
              %slice_10809 = cute.slice(%lay_10796, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_10810 = cute.crd2idx(%coord_10804, %lay_10796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_10811 = cute.add_offset(%iter_10790, %idx_10810) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_10812 = cute.make_view(%ptr_10811, %slice_10809) : !memref_smem_bf16_13
              %slice_10813 = cute.slice(%lay_10800, %coord_10804) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_10814 = cute.crd2idx(%coord_10804, %lay_10800) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_10815 = cute.add_offset(%iter_10797, %idx_10814) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_10816 = cute.make_view(%ptr_10815, %slice_10813) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_10808, %view_10812, %view_10816) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10705 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
            %lay_10706 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"1024">
            %iter_10708 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_smem_bf16_14
            %iter_10711 = cute.get_iter(%view_10710) : !memref_smem_bf16_14
            %lay_10712 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %sz_10713 = cute.size(%lay_10712) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10714 = cute.get_leaves(%sz_10713) : !cute.int_tuple<"16">
            %lay_10715 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %3002 = cute.get_shape(%lay_10715) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10716, %e1_10717, %e2_10718 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %int_tuple_10719 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10720 = cute.tuple.product(%int_tuple_10719) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10721 = cute.get_leaves(%res_10720) : !cute.int_tuple<"16">
            %cst_10722 = arith.constant 0.000000e+00 : bf16
            %3003 = vector.splat %cst_10722 : vector<16xbf16>
            %int_tuple_10723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10724 = cute.size(%int_tuple_10723) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10725 = cute.get_leaves(%sz_10724) : !cute.int_tuple<"16">
            %int_tuple_10726 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10727 = cute.size(%int_tuple_10726) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10728 = cute.get_leaves(%sz_10727) : !cute.int_tuple<"16">
            cute.memref.store_vec %3003, %view_10710, row_major : !memref_smem_bf16_14
          }
          %coord_10641 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
          %lay_10642 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10643 = cute.crd2idx(%coord_10641, %lay_10642) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
          %iter_10644 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10645 = cute.add_offset(%iter_10644, %idx_10643) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10646 = cute.make_view(%tup_10645) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10647 = cute.get_iter(%view_10646) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10648, %e1_10649, %e2_10650, %e3_10651 = cute.get_leaves(%iter_10647) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2966 = cute.get_scalars(%e0_10648) : !cute.int_tuple<"?">
          %2967 = cute.get_scalars(%e1_10649) : !cute.int_tuple<"?">
          %2968 = cute.get_scalars(%e2_10650) : !cute.int_tuple<"?">
          %2969 = cute.get_scalars(%e3_10651) : !cute.int_tuple<"?{div=8}">
          %iter_10652 = cute.get_iter(%view_10646) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10653, %e1_10654, %e2_10655, %e3_10656 = cute.get_leaves(%iter_10652) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2970 = cute.get_scalars(%e0_10653) : !cute.int_tuple<"?">
          %2971 = cute.get_scalars(%e1_10654) : !cute.int_tuple<"?">
          %2972 = cute.get_scalars(%e2_10655) : !cute.int_tuple<"?">
          %2973 = cute.get_scalars(%e3_10656) : !cute.int_tuple<"?{div=8}">
          %iter_10657 = cute.get_iter(%view_10646) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10658, %e1_10659, %e2_10660, %e3_10661 = cute.get_leaves(%iter_10657) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2974 = cute.get_scalars(%e0_10658) : !cute.int_tuple<"?">
          %2975 = cute.get_scalars(%e1_10659) : !cute.int_tuple<"?">
          %2976 = cute.get_scalars(%e2_10660) : !cute.int_tuple<"?">
          %2977 = cute.get_scalars(%e3_10661) : !cute.int_tuple<"?{div=8}">
          %lay_10662 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2978 = cute.get_shape(%lay_10662) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10663, %e1_10664, %e2_10665, %e3_10666 = cute.get_leaves(%2978) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10667 = cute.to_int_tuple(%e0_10663) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2979 = cute.get_scalars(%itup_10667) : !cute.int_tuple<"?">
          %itup_10668 = cute.to_int_tuple(%e1_10664) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2980 = cute.get_scalars(%itup_10668) : !cute.int_tuple<"?">
          %itup_10669 = cute.to_int_tuple(%e2_10665) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2981 = cute.get_scalars(%itup_10669) : !cute.int_tuple<"?">
          %itup_10670 = cute.to_int_tuple(%e3_10666) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %2982 = cute.get_scalars(%itup_10670) : !cute.int_tuple<"?{div=8}">
          %coord_10671 = cute.make_coord(%e1_10659) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10672 = cute.make_coord(%itup_10668) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %2983 = cute.elem_less(%coord_10671, %coord_10672) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %2983 {
            %coord_10705 = cute.make_coord(%2504) : (i32) -> !cute.coord<"(_,2,_,?)">
            %lay_10706 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,2,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=256}">
            %iter_10708 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_gmem_bf16_6
            %iter_10711 = cute.get_iter(%view_10710) : !memref_gmem_bf16_6
            %coord_10712 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10713 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10714 = cute.crd2idx(%coord_10712, %lay_10713) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_10715 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10716 = cute.add_offset(%iter_10715, %idx_10714) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10717 = cute.make_view(%ptr_10716) : !memref_smem_bf16_14
            %iter_10718 = cute.get_iter(%view_10717) : !memref_smem_bf16_14
            %coord_10719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10720 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
            %idx_10721 = cute.crd2idx(%coord_10719, %lay_10720) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10722 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
            %ptr_10723 = cute.add_offset(%iter_10722, %idx_10721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10724 = cute.make_view(%ptr_10723) : !memref_rmem_i8_2
            %iter_10725 = cute.get_iter(%view_10724) : !memref_rmem_i8_2
            %lay_10726 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %3002 = cute.get_shape(%lay_10726) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10727, %e1_10728, %e2_10729 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %lay_10730 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %3003 = cute.get_shape(%lay_10730) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10731, %e1_10732, %e2_10733 = cute.get_leaves(%3003) : !cute.shape<"((8,1),2)">
            %lay_10734 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %shape_10735 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10736 = cute.make_layout() : !cute.layout<"1:0">
            %append_10737 = cute.append_to_rank<2> (%lay_10734, %lay_10736) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10738 = cute.make_view(%iter_10711, %append_10737) : !memref_gmem_bf16_6
            %iter_10739 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %lay_10740 = cute.get_layout(%view_10738) : !memref_gmem_bf16_6
            %3004 = cute.get_shape(%lay_10740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10741, %e1_10742, %e2_10743 = cute.get_leaves(%3004) : !cute.shape<"((8,1),2)">
            %iter_10744 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %view_10745 = cute.make_view(%iter_10744) : !memref_gmem_bf16_7
            %iter_10746 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10747 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %lay_10748 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %shape_10749 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10750 = cute.make_layout() : !cute.layout<"1:0">
            %append_10751 = cute.append_to_rank<2> (%lay_10748, %lay_10750) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10752 = cute.make_view(%iter_10718, %append_10751) : !memref_smem_bf16_14
            %iter_10753 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %lay_10754 = cute.get_layout(%view_10752) : !memref_smem_bf16_14
            %3005 = cute.get_shape(%lay_10754) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10755, %e1_10756, %e2_10757 = cute.get_leaves(%3005) : !cute.shape<"((8,1),2)">
            %iter_10758 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %view_10759 = cute.make_view(%iter_10758) : !memref_smem_bf16_15
            %iter_10760 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %iter_10761 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10762 = cute.get_layout(%view_10724) : !memref_rmem_i8_2
            %shape_10763 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10764 = cute.make_layout() : !cute.layout<"1:0">
            %append_10765 = cute.append_to_rank<2> (%lay_10762, %lay_10764) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10766 = cute.make_view(%iter_10725, %append_10765) : !memref_rmem_i8_2
            %iter_10767 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %lay_10768 = cute.get_layout(%view_10766) : !memref_rmem_i8_2
            %3006 = cute.get_shape(%lay_10768) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10769, %e1_10770 = cute.get_leaves(%3006) : !cute.shape<"(1,2)">
            %iter_10771 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %view_10772 = cute.make_view(%iter_10771) : !memref_rmem_i8_3
            %iter_10773 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %iter_10774 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10775 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %3007 = cute.get_shape(%lay_10775) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10776, %e1_10777, %e2_10778 = cute.get_leaves(%3007) : !cute.shape<"((8,1),(2))">
            %lay_10779 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %3008 = cute.get_shape(%lay_10779) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10780, %e1_10781, %e2_10782 = cute.get_leaves(%3008) : !cute.shape<"((8,1),(2))">
            %lay_10783 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %sz_10784 = cute.size(%lay_10783) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10785 = cute.get_leaves(%sz_10784) : !cute.int_tuple<"2">
            %lay_10786 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %sz_10787 = cute.size(%lay_10786) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10788 = cute.get_leaves(%sz_10787) : !cute.int_tuple<"2">
            %3009 = cute.static : !cute.layout<"1:0">
            %iter_10789 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10790 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10791 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %lay_10792 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %append_10793 = cute.append_to_rank<2> (%lay_10791, %3009) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10794 = cute.append_to_rank<2> (%lay_10792, %3009) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10795 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10797 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10798 = cute.get_layout(%view_10772) : !memref_rmem_i8_3
            %append_10799 = cute.append_to_rank<2> (%lay_10798, %3009) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10800 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_10801 = cute.size(%lay_10795) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3010 = cute.get_scalars(%sz_10801) : !cute.int_tuple<"2">
            %c0_i32_10802 = arith.constant 0 : i32
            %c1_i32_10803 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_10802 to %3010 step %c1_i32_10803  : i32 {
              %coord_10804 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_10805 = cute.slice(%lay_10795, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_10806 = cute.crd2idx(%coord_10804, %lay_10795) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_10807 = cute.add_offset(%iter_10789, %idx_10806) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_10808 = cute.make_view(%ptr_10807, %slice_10805) : !memref_gmem_bf16_8
              %slice_10809 = cute.slice(%lay_10796, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_10810 = cute.crd2idx(%coord_10804, %lay_10796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_10811 = cute.add_offset(%iter_10790, %idx_10810) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_10812 = cute.make_view(%ptr_10811, %slice_10809) : !memref_smem_bf16_13
              %slice_10813 = cute.slice(%lay_10800, %coord_10804) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_10814 = cute.crd2idx(%coord_10804, %lay_10800) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_10815 = cute.add_offset(%iter_10797, %idx_10814) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_10816 = cute.make_view(%ptr_10815, %slice_10813) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_10808, %view_10812, %view_10816) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10705 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
            %lay_10706 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"2048">
            %iter_10708 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_smem_bf16_14
            %iter_10711 = cute.get_iter(%view_10710) : !memref_smem_bf16_14
            %lay_10712 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %sz_10713 = cute.size(%lay_10712) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10714 = cute.get_leaves(%sz_10713) : !cute.int_tuple<"16">
            %lay_10715 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %3002 = cute.get_shape(%lay_10715) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10716, %e1_10717, %e2_10718 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %int_tuple_10719 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10720 = cute.tuple.product(%int_tuple_10719) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10721 = cute.get_leaves(%res_10720) : !cute.int_tuple<"16">
            %cst_10722 = arith.constant 0.000000e+00 : bf16
            %3003 = vector.splat %cst_10722 : vector<16xbf16>
            %int_tuple_10723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10724 = cute.size(%int_tuple_10723) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10725 = cute.get_leaves(%sz_10724) : !cute.int_tuple<"16">
            %int_tuple_10726 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10727 = cute.size(%int_tuple_10726) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10728 = cute.get_leaves(%sz_10727) : !cute.int_tuple<"16">
            cute.memref.store_vec %3003, %view_10710, row_major : !memref_smem_bf16_14
          }
          %coord_10673 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
          %lay_10674 = cute.get_layout(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %idx_10675 = cute.crd2idx(%coord_10673, %lay_10674) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),4,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
          %iter_10676 = cute.get_iter(%src_partitioned_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">
          %tup_10677 = cute.add_offset(%iter_10676, %idx_10675) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
          %view_10678 = cute.make_view(%tup_10677) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %iter_10679 = cute.get_iter(%view_10678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10680, %e1_10681, %e2_10682, %e3_10683 = cute.get_leaves(%iter_10679) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2984 = cute.get_scalars(%e0_10680) : !cute.int_tuple<"?">
          %2985 = cute.get_scalars(%e1_10681) : !cute.int_tuple<"?">
          %2986 = cute.get_scalars(%e2_10682) : !cute.int_tuple<"?">
          %2987 = cute.get_scalars(%e3_10683) : !cute.int_tuple<"?{div=8}">
          %iter_10684 = cute.get_iter(%view_10678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10685, %e1_10686, %e2_10687, %e3_10688 = cute.get_leaves(%iter_10684) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2988 = cute.get_scalars(%e0_10685) : !cute.int_tuple<"?">
          %2989 = cute.get_scalars(%e1_10686) : !cute.int_tuple<"?">
          %2990 = cute.get_scalars(%e2_10687) : !cute.int_tuple<"?">
          %2991 = cute.get_scalars(%e3_10688) : !cute.int_tuple<"?{div=8}">
          %iter_10689 = cute.get_iter(%view_10678) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
          %e0_10690, %e1_10691, %e2_10692, %e3_10693 = cute.get_leaves(%iter_10689) : !cute.int_tuple<"(?,?,?,?{div=8})">
          %2992 = cute.get_scalars(%e0_10690) : !cute.int_tuple<"?">
          %2993 = cute.get_scalars(%e1_10691) : !cute.int_tuple<"?">
          %2994 = cute.get_scalars(%e2_10692) : !cute.int_tuple<"?">
          %2995 = cute.get_scalars(%e3_10693) : !cute.int_tuple<"?{div=8}">
          %lay_10694 = cute.get_layout(%arg10) : !memref_gmem_bf16_
          %2996 = cute.get_shape(%lay_10694) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
          %e0_10695, %e1_10696, %e2_10697, %e3_10698 = cute.get_leaves(%2996) : !cute.shape<"(?,?,?,?{div=8})">
          %itup_10699 = cute.to_int_tuple(%e0_10695) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2997 = cute.get_scalars(%itup_10699) : !cute.int_tuple<"?">
          %itup_10700 = cute.to_int_tuple(%e1_10696) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2998 = cute.get_scalars(%itup_10700) : !cute.int_tuple<"?">
          %itup_10701 = cute.to_int_tuple(%e2_10697) : !cute.shape<"?"> to !cute.int_tuple<"?">
          %2999 = cute.get_scalars(%itup_10701) : !cute.int_tuple<"?">
          %itup_10702 = cute.to_int_tuple(%e3_10698) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
          %3000 = cute.get_scalars(%itup_10702) : !cute.int_tuple<"?{div=8}">
          %coord_10703 = cute.make_coord(%e1_10691) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %coord_10704 = cute.make_coord(%itup_10700) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
          %3001 = cute.elem_less(%coord_10703, %coord_10704) : !cute.coord<"?">, !cute.coord<"?">
          scf.if %3001 {
            %coord_10705 = cute.make_coord(%2504) : (i32) -> !cute.coord<"(_,3,_,?)">
            %lay_10706 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,3,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=128}">
            %iter_10708 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_gmem_bf16_6
            %iter_10711 = cute.get_iter(%view_10710) : !memref_gmem_bf16_6
            %coord_10712 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10713 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10714 = cute.crd2idx(%coord_10712, %lay_10713) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_10715 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10716 = cute.add_offset(%iter_10715, %idx_10714) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10717 = cute.make_view(%ptr_10716) : !memref_smem_bf16_14
            %iter_10718 = cute.get_iter(%view_10717) : !memref_smem_bf16_14
            %coord_10719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10720 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
            %idx_10721 = cute.crd2idx(%coord_10719, %lay_10720) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,4,2):(2,0,1)">) -> !cute.int_tuple<"0">
            %iter_10722 = cute.get_iter(%rmem_527) : !memref_rmem_i8_1
            %ptr_10723 = cute.add_offset(%iter_10722, %idx_10721) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
            %view_10724 = cute.make_view(%ptr_10723) : !memref_rmem_i8_2
            %iter_10725 = cute.get_iter(%view_10724) : !memref_rmem_i8_2
            %lay_10726 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %3002 = cute.get_shape(%lay_10726) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10727, %e1_10728, %e2_10729 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %lay_10730 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %3003 = cute.get_shape(%lay_10730) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10731, %e1_10732, %e2_10733 = cute.get_leaves(%3003) : !cute.shape<"((8,1),2)">
            %lay_10734 = cute.get_layout(%view_10710) : !memref_gmem_bf16_6
            %shape_10735 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10736 = cute.make_layout() : !cute.layout<"1:0">
            %append_10737 = cute.append_to_rank<2> (%lay_10734, %lay_10736) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
            %view_10738 = cute.make_view(%iter_10711, %append_10737) : !memref_gmem_bf16_6
            %iter_10739 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %lay_10740 = cute.get_layout(%view_10738) : !memref_gmem_bf16_6
            %3004 = cute.get_shape(%lay_10740) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
            %e0_10741, %e1_10742, %e2_10743 = cute.get_leaves(%3004) : !cute.shape<"((8,1),2)">
            %iter_10744 = cute.get_iter(%view_10738) : !memref_gmem_bf16_6
            %view_10745 = cute.make_view(%iter_10744) : !memref_gmem_bf16_7
            %iter_10746 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10747 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %lay_10748 = cute.get_layout(%view_10717) : !memref_smem_bf16_14
            %shape_10749 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10750 = cute.make_layout() : !cute.layout<"1:0">
            %append_10751 = cute.append_to_rank<2> (%lay_10748, %lay_10750) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
            %view_10752 = cute.make_view(%iter_10718, %append_10751) : !memref_smem_bf16_14
            %iter_10753 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %lay_10754 = cute.get_layout(%view_10752) : !memref_smem_bf16_14
            %3005 = cute.get_shape(%lay_10754) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10755, %e1_10756, %e2_10757 = cute.get_leaves(%3005) : !cute.shape<"((8,1),2)">
            %iter_10758 = cute.get_iter(%view_10752) : !memref_smem_bf16_14
            %view_10759 = cute.make_view(%iter_10758) : !memref_smem_bf16_15
            %iter_10760 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %iter_10761 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10762 = cute.get_layout(%view_10724) : !memref_rmem_i8_2
            %shape_10763 = cute.make_shape() : () -> !cute.shape<"1">
            %lay_10764 = cute.make_layout() : !cute.layout<"1:0">
            %append_10765 = cute.append_to_rank<2> (%lay_10762, %lay_10764) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
            %view_10766 = cute.make_view(%iter_10725, %append_10765) : !memref_rmem_i8_2
            %iter_10767 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %lay_10768 = cute.get_layout(%view_10766) : !memref_rmem_i8_2
            %3006 = cute.get_shape(%lay_10768) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
            %e0_10769, %e1_10770 = cute.get_leaves(%3006) : !cute.shape<"(1,2)">
            %iter_10771 = cute.get_iter(%view_10766) : !memref_rmem_i8_2
            %view_10772 = cute.make_view(%iter_10771) : !memref_rmem_i8_3
            %iter_10773 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %iter_10774 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10775 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %3007 = cute.get_shape(%lay_10775) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
            %e0_10776, %e1_10777, %e2_10778 = cute.get_leaves(%3007) : !cute.shape<"((8,1),(2))">
            %lay_10779 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %3008 = cute.get_shape(%lay_10779) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
            %e0_10780, %e1_10781, %e2_10782 = cute.get_leaves(%3008) : !cute.shape<"((8,1),(2))">
            %lay_10783 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %sz_10784 = cute.size(%lay_10783) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
            %e0_10785 = cute.get_leaves(%sz_10784) : !cute.int_tuple<"2">
            %lay_10786 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %sz_10787 = cute.size(%lay_10786) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
            %e0_10788 = cute.get_leaves(%sz_10787) : !cute.int_tuple<"2">
            %3009 = cute.static : !cute.layout<"1:0">
            %iter_10789 = cute.get_iter(%view_10745) : !memref_gmem_bf16_7
            %iter_10790 = cute.get_iter(%view_10759) : !memref_smem_bf16_15
            %lay_10791 = cute.get_layout(%view_10745) : !memref_gmem_bf16_7
            %lay_10792 = cute.get_layout(%view_10759) : !memref_smem_bf16_15
            %append_10793 = cute.append_to_rank<2> (%lay_10791, %3009) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
            %append_10794 = cute.append_to_rank<2> (%lay_10792, %3009) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
            %lay_10795 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
            %lay_10796 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
            %iter_10797 = cute.get_iter(%view_10772) : !memref_rmem_i8_3
            %lay_10798 = cute.get_layout(%view_10772) : !memref_rmem_i8_3
            %append_10799 = cute.append_to_rank<2> (%lay_10798, %3009) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
            %lay_10800 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
            %sz_10801 = cute.size(%lay_10795) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"2">
            %3010 = cute.get_scalars(%sz_10801) : !cute.int_tuple<"2">
            %c0_i32_10802 = arith.constant 0 : i32
            %c1_i32_10803 = arith.constant 1 : i32
            scf.for %arg13 = %c0_i32_10802 to %3010 step %c1_i32_10803  : i32 {
              %coord_10804 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
              %slice_10805 = cute.slice(%lay_10795, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
              %idx_10806 = cute.crd2idx(%coord_10804, %lay_10795) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
              %ptr_10807 = cute.add_offset(%iter_10789, %idx_10806) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
              %view_10808 = cute.make_view(%ptr_10807, %slice_10805) : !memref_gmem_bf16_8
              %slice_10809 = cute.slice(%lay_10796, %coord_10804) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
              %idx_10810 = cute.crd2idx(%coord_10804, %lay_10796) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
              %ptr_10811 = cute.add_offset(%iter_10790, %idx_10810) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
              %view_10812 = cute.make_view(%ptr_10811, %slice_10809) : !memref_smem_bf16_13
              %slice_10813 = cute.slice(%lay_10800, %coord_10804) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
              %idx_10814 = cute.crd2idx(%coord_10804, %lay_10800) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
              %ptr_10815 = cute.add_offset(%iter_10797, %idx_10814) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
              %view_10816 = cute.make_view(%ptr_10815, %slice_10813) : !memref_rmem_i8_4
              cute.copy_atom_call(%3, %view_10808, %view_10812, %view_10816) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } else {
            %coord_10705 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
            %lay_10706 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
            %idx_10707 = cute.crd2idx(%coord_10705, %lay_10706) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.int_tuple<"3072">
            %iter_10708 = cute.get_iter(%dst_partitioned_298) : !memref_smem_bf16_4
            %ptr_10709 = cute.add_offset(%iter_10708, %idx_10707) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10710 = cute.make_view(%ptr_10709) : !memref_smem_bf16_14
            %iter_10711 = cute.get_iter(%view_10710) : !memref_smem_bf16_14
            %lay_10712 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %sz_10713 = cute.size(%lay_10712) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.int_tuple<"16">
            %e0_10714 = cute.get_leaves(%sz_10713) : !cute.int_tuple<"16">
            %lay_10715 = cute.get_layout(%view_10710) : !memref_smem_bf16_14
            %3002 = cute.get_shape(%lay_10715) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
            %e0_10716, %e1_10717, %e2_10718 = cute.get_leaves(%3002) : !cute.shape<"((8,1),2)">
            %int_tuple_10719 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %res_10720 = cute.tuple.product(%int_tuple_10719) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10721 = cute.get_leaves(%res_10720) : !cute.int_tuple<"16">
            %cst_10722 = arith.constant 0.000000e+00 : bf16
            %3003 = vector.splat %cst_10722 : vector<16xbf16>
            %int_tuple_10723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10724 = cute.size(%int_tuple_10723) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10725 = cute.get_leaves(%sz_10724) : !cute.int_tuple<"16">
            %int_tuple_10726 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)">
            %sz_10727 = cute.size(%int_tuple_10726) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16">
            %e0_10728 = cute.get_leaves(%sz_10727) : !cute.int_tuple<"16">
            cute.memref.store_vec %3003, %view_10710, row_major : !memref_smem_bf16_14
          }
        } else {
          %coord_10569 = cute.make_coord(%2504) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_10570 = cute.get_layout(%src_partitioned_295) : !memref_gmem_bf16_5
          %slice_10571 = cute.slice(%lay_10570, %coord_10569) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_10572 = cute.crd2idx(%coord_10569, %lay_10570) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_10573 = cute.get_iter(%src_partitioned_295) : !memref_gmem_bf16_5
          %ptr_10574 = cute.add_offset(%iter_10573, %idx_10572) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_10575 = cute.make_view(%ptr_10574, %slice_10571) : !memref_gmem_bf16_9
          %iter_10576 = cute.get_iter(%view_10575) : !memref_gmem_bf16_9
          %lay_10577 = cute.get_layout(%view_10575) : !memref_gmem_bf16_9
          %2929 = cute.get_shape(%lay_10577) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10578, %e1_10579, %e2_10580, %e3_10581 = cute.get_leaves(%2929) : !cute.shape<"((8,1),4,2)">
          %lay_10582 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %2930 = cute.get_shape(%lay_10582) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10583, %e1_10584, %e2_10585, %e3_10586 = cute.get_leaves(%2930) : !cute.shape<"((8,1),4,2)">
          %lay_10587 = cute.get_layout(%view_10575) : !memref_gmem_bf16_9
          %shape_10588 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10589 = cute.make_layout() : !cute.layout<"1:0">
          %append_10590 = cute.append_to_rank<2> (%lay_10587, %lay_10589) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_10591 = cute.make_view(%iter_10576, %append_10590) : !memref_gmem_bf16_9
          %iter_10592 = cute.get_iter(%view_10591) : !memref_gmem_bf16_9
          %lay_10593 = cute.get_layout(%view_10591) : !memref_gmem_bf16_9
          %2931 = cute.get_shape(%lay_10593) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10594, %e1_10595, %e2_10596, %e3_10597 = cute.get_leaves(%2931) : !cute.shape<"((8,1),4,2)">
          %iter_10598 = cute.get_iter(%view_10591) : !memref_gmem_bf16_9
          %lay_10599 = cute.get_layout(%view_10591) : !memref_gmem_bf16_9
          %2932 = cute.get_scalars(%lay_10599) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_10600 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_10601 = cute.assume(%2932) : (i64) -> !cute.i64<divby 128>
          %stride_10602 = cute.make_stride(%iv_10601) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_10603 = cute.make_layout(%shape_10600, %stride_10602) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_10604 = cute.make_view(%iter_10598, %lay_10603) : !memref_gmem_bf16_10
          %iter_10605 = cute.get_iter(%view_10604) : !memref_gmem_bf16_10
          %iter_10606 = cute.get_iter(%view_10604) : !memref_gmem_bf16_10
          %lay_10607 = cute.get_layout(%dst_partitioned_298) : !memref_smem_bf16_4
          %shape_10608 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10609 = cute.make_layout() : !cute.layout<"1:0">
          %append_10610 = cute.append_to_rank<2> (%lay_10607, %lay_10609) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_10611 = cute.make_view(%iter_299, %append_10610) : !memref_smem_bf16_4
          %iter_10612 = cute.get_iter(%view_10611) : !memref_smem_bf16_4
          %lay_10613 = cute.get_layout(%view_10611) : !memref_smem_bf16_4
          %2933 = cute.get_shape(%lay_10613) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10614, %e1_10615, %e2_10616, %e3_10617 = cute.get_leaves(%2933) : !cute.shape<"((8,1),4,2)">
          %iter_10618 = cute.get_iter(%view_10611) : !memref_smem_bf16_4
          %view_10619 = cute.make_view(%iter_10618) : !memref_smem_bf16_16
          %iter_10620 = cute.get_iter(%view_10619) : !memref_smem_bf16_16
          %iter_10621 = cute.get_iter(%view_10619) : !memref_smem_bf16_16
          %lay_10622 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %shape_10623 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10624 = cute.make_layout() : !cute.layout<"1:0">
          %append_10625 = cute.append_to_rank<2> (%lay_10622, %lay_10624) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_10626 = cute.make_view(%iter_529, %append_10625) : !memref_rmem_i8_1
          %iter_10627 = cute.get_iter(%view_10626) : !memref_rmem_i8_1
          %lay_10628 = cute.get_layout(%view_10626) : !memref_rmem_i8_1
          %2934 = cute.get_shape(%lay_10628) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_10629, %e1_10630, %e2_10631 = cute.get_leaves(%2934) : !cute.shape<"(1,4,2)">
          %iter_10632 = cute.get_iter(%view_10626) : !memref_rmem_i8_1
          %view_10633 = cute.make_view(%iter_10632) : !memref_rmem_i8_5
          %iter_10634 = cute.get_iter(%view_10633) : !memref_rmem_i8_5
          %iter_10635 = cute.get_iter(%view_10633) : !memref_rmem_i8_5
          %lay_10636 = cute.get_layout(%view_10604) : !memref_gmem_bf16_10
          %2935 = cute.get_shape(%lay_10636) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10637, %e1_10638, %e2_10639, %e3_10640 = cute.get_leaves(%2935) : !cute.shape<"((8,1),(4,2))">
          %lay_10641 = cute.get_layout(%view_10619) : !memref_smem_bf16_16
          %2936 = cute.get_shape(%lay_10641) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10642, %e1_10643, %e2_10644, %e3_10645 = cute.get_leaves(%2936) : !cute.shape<"((8,1),(4,2))">
          %lay_10646 = cute.get_layout(%view_10604) : !memref_gmem_bf16_10
          %sz_10647 = cute.size(%lay_10646) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_10648 = cute.get_leaves(%sz_10647) : !cute.int_tuple<"8">
          %lay_10649 = cute.get_layout(%view_10619) : !memref_smem_bf16_16
          %sz_10650 = cute.size(%lay_10649) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_10651 = cute.get_leaves(%sz_10650) : !cute.int_tuple<"8">
          %2937 = cute.static : !cute.layout<"1:0">
          %iter_10652 = cute.get_iter(%view_10604) : !memref_gmem_bf16_10
          %iter_10653 = cute.get_iter(%view_10619) : !memref_smem_bf16_16
          %lay_10654 = cute.get_layout(%view_10604) : !memref_gmem_bf16_10
          %lay_10655 = cute.get_layout(%view_10619) : !memref_smem_bf16_16
          %append_10656 = cute.append_to_rank<2> (%lay_10654, %2937) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_10657 = cute.append_to_rank<2> (%lay_10655, %2937) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %2938 = cute.get_scalars(%append_10656) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_10658 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_10659 = cute.assume(%2938) : (i64) -> !cute.i64<divby 128>
          %stride_10660 = cute.make_stride(%iv_10659) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_10661 = cute.make_layout(%shape_10658, %stride_10660) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_10662 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_10663 = cute.get_iter(%view_10633) : !memref_rmem_i8_5
          %lay_10664 = cute.get_layout(%view_10633) : !memref_rmem_i8_5
          %append_10665 = cute.append_to_rank<2> (%lay_10664, %2937) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_10666 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_10667 = cute.size(%lay_10661) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %2939 = cute.get_scalars(%sz_10667) : !cute.int_tuple<"8">
          %c0_i32_10668 = arith.constant 0 : i32
          %c1_i32_10669 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_10668 to %2939 step %c1_i32_10669  : i32 {
            %coord_10670 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %slice_10671 = cute.slice(%lay_10661, %coord_10670) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_10672 = cute.crd2idx(%coord_10670, %lay_10661) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_10673 = cute.add_offset(%iter_10652, %idx_10672) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10674 = cute.make_view(%ptr_10673, %slice_10671) : !memref_gmem_bf16_8
            %slice_10675 = cute.slice(%lay_10662, %coord_10670) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_10676 = cute.crd2idx(%coord_10670, %lay_10662) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_10677 = cute.add_offset(%iter_10653, %idx_10676) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10678 = cute.make_view(%ptr_10677, %slice_10675) : !memref_smem_bf16_13
            %slice_10679 = cute.slice(%lay_10666, %coord_10670) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_10680 = cute.crd2idx(%coord_10670, %lay_10666) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_10681 = cute.add_offset(%iter_10663, %idx_10680) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_10682 = cute.make_view(%ptr_10681, %slice_10679) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_10674, %view_10678, %view_10682) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
        }
        nvvm.cp.async.commit.group
        %coord_7787 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7788 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_7789 = cute.crd2idx(%coord_7787, %lay_7788) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_7790 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_7791 = cute.add_offset(%iter_7790, %idx_7789) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7792 = cute.make_view(%ptr_7791) : !memref_smem_bf16_14
        %iter_7793 = cute.get_iter(%view_7792) : !memref_smem_bf16_14
        %coord_7794 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7795 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_7796 = cute.crd2idx(%coord_7794, %lay_7795) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_7797 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_7798 = cute.add_offset(%iter_7797, %idx_7796) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7799 = cute.make_view(%ptr_7798) : !memref_rmem_bf16_6
        %iter_7800 = cute.get_iter(%view_7799) : !memref_rmem_bf16_6
        %lay_7801 = cute.get_layout(%view_7792) : !memref_smem_bf16_14
        %2508 = cute.get_shape(%lay_7801) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7802, %e1_7803, %e2_7804 = cute.get_leaves(%2508) : !cute.shape<"((8,1),2)">
        %lay_7805 = cute.get_layout(%view_7799) : !memref_rmem_bf16_6
        %2509 = cute.get_shape(%lay_7805) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7806, %e1_7807, %e2_7808 = cute.get_leaves(%2509) : !cute.shape<"((8,1),2)">
        %lay_7809 = cute.get_layout(%view_7792) : !memref_smem_bf16_14
        %shape_7810 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7811 = cute.make_layout() : !cute.layout<"1:0">
        %append_7812 = cute.append_to_rank<2> (%lay_7809, %lay_7811) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7813 = cute.make_view(%iter_7793, %append_7812) : !memref_smem_bf16_14
        %iter_7814 = cute.get_iter(%view_7813) : !memref_smem_bf16_14
        %lay_7815 = cute.get_layout(%view_7813) : !memref_smem_bf16_14
        %2510 = cute.get_shape(%lay_7815) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7816, %e1_7817, %e2_7818 = cute.get_leaves(%2510) : !cute.shape<"((8,1),2)">
        %iter_7819 = cute.get_iter(%view_7813) : !memref_smem_bf16_14
        %view_7820 = cute.make_view(%iter_7819) : !memref_smem_bf16_15
        %iter_7821 = cute.get_iter(%view_7820) : !memref_smem_bf16_15
        %iter_7822 = cute.get_iter(%view_7820) : !memref_smem_bf16_15
        %lay_7823 = cute.get_layout(%view_7799) : !memref_rmem_bf16_6
        %shape_7824 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7825 = cute.make_layout() : !cute.layout<"1:0">
        %append_7826 = cute.append_to_rank<2> (%lay_7823, %lay_7825) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7827 = cute.make_view(%iter_7800, %append_7826) : !memref_rmem_bf16_6
        %iter_7828 = cute.get_iter(%view_7827) : !memref_rmem_bf16_6
        %lay_7829 = cute.get_layout(%view_7827) : !memref_rmem_bf16_6
        %2511 = cute.get_shape(%lay_7829) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7830, %e1_7831, %e2_7832 = cute.get_leaves(%2511) : !cute.shape<"((8,1),2)">
        %iter_7833 = cute.get_iter(%view_7827) : !memref_rmem_bf16_6
        %view_7834 = cute.make_view(%iter_7833) : !memref_rmem_bf16_7
        %iter_7835 = cute.get_iter(%view_7834) : !memref_rmem_bf16_7
        %iter_7836 = cute.get_iter(%view_7834) : !memref_rmem_bf16_7
        %lay_7837 = cute.get_layout(%view_7820) : !memref_smem_bf16_15
        %2512 = cute.get_shape(%lay_7837) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_7838, %e1_7839, %e2_7840 = cute.get_leaves(%2512) : !cute.shape<"((8,1),(2))">
        %lay_7841 = cute.get_layout(%view_7834) : !memref_rmem_bf16_7
        %2513 = cute.get_shape(%lay_7841) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7842, %e1_7843, %e2_7844 = cute.get_leaves(%2513) : !cute.shape<"((8,1),(2))">
        %lay_7845 = cute.get_layout(%view_7820) : !memref_smem_bf16_15
        %sz_7846 = cute.size(%lay_7845) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_7847 = cute.get_leaves(%sz_7846) : !cute.int_tuple<"2">
        %lay_7848 = cute.get_layout(%view_7834) : !memref_rmem_bf16_7
        %sz_7849 = cute.size(%lay_7848) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7850 = cute.get_leaves(%sz_7849) : !cute.int_tuple<"2">
        %2514 = cute.static : !cute.layout<"1:0">
        %iter_7851 = cute.get_iter(%view_7820) : !memref_smem_bf16_15
        %iter_7852 = cute.get_iter(%view_7834) : !memref_rmem_bf16_7
        %lay_7853 = cute.get_layout(%view_7820) : !memref_smem_bf16_15
        %lay_7854 = cute.get_layout(%view_7834) : !memref_rmem_bf16_7
        %append_7855 = cute.append_to_rank<2> (%lay_7853, %2514) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_7856 = cute.append_to_rank<2> (%lay_7854, %2514) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_7857 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_7858 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_7859 = cute.size(%lay_7857) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2515 = cute.get_scalars(%sz_7859) : !cute.int_tuple<"2">
        %c0_i32_7860 = arith.constant 0 : i32
        %c1_i32_7861 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_7860 to %2515 step %c1_i32_7861  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_7857, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_7857) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_7851, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_7858, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_7858) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_7852, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_7862 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7863 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_7864 = cute.crd2idx(%coord_7862, %lay_7863) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_7865 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_7866 = cute.add_offset(%iter_7865, %idx_7864) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7867 = cute.make_view(%ptr_7866) : !memref_smem_bf16_17
        %iter_7868 = cute.get_iter(%view_7867) : !memref_smem_bf16_17
        %coord_7869 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_7870 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_7871 = cute.crd2idx(%coord_7869, %lay_7870) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_7872 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_7873 = cute.add_offset(%iter_7872, %idx_7871) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7874 = cute.make_view(%ptr_7873) : !memref_rmem_bf16_9
        %iter_7875 = cute.get_iter(%view_7874) : !memref_rmem_bf16_9
        %lay_7876 = cute.get_layout(%view_7867) : !memref_smem_bf16_17
        %2516 = cute.get_shape(%lay_7876) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7877, %e1_7878, %e2_7879 = cute.get_leaves(%2516) : !cute.shape<"((8,1),4)">
        %lay_7880 = cute.get_layout(%view_7874) : !memref_rmem_bf16_9
        %2517 = cute.get_shape(%lay_7880) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7881, %e1_7882, %e2_7883 = cute.get_leaves(%2517) : !cute.shape<"((8,1),4)">
        %lay_7884 = cute.get_layout(%view_7867) : !memref_smem_bf16_17
        %shape_7885 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7886 = cute.make_layout() : !cute.layout<"1:0">
        %append_7887 = cute.append_to_rank<2> (%lay_7884, %lay_7886) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_7888 = cute.make_view(%iter_7868, %append_7887) : !memref_smem_bf16_17
        %iter_7889 = cute.get_iter(%view_7888) : !memref_smem_bf16_17
        %lay_7890 = cute.get_layout(%view_7888) : !memref_smem_bf16_17
        %2518 = cute.get_shape(%lay_7890) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_7891, %e1_7892, %e2_7893 = cute.get_leaves(%2518) : !cute.shape<"((8,1),4)">
        %iter_7894 = cute.get_iter(%view_7888) : !memref_smem_bf16_17
        %view_7895 = cute.make_view(%iter_7894) : !memref_smem_bf16_18
        %iter_7896 = cute.get_iter(%view_7895) : !memref_smem_bf16_18
        %iter_7897 = cute.get_iter(%view_7895) : !memref_smem_bf16_18
        %lay_7898 = cute.get_layout(%view_7874) : !memref_rmem_bf16_9
        %shape_7899 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7900 = cute.make_layout() : !cute.layout<"1:0">
        %append_7901 = cute.append_to_rank<2> (%lay_7898, %lay_7900) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_7902 = cute.make_view(%iter_7875, %append_7901) : !memref_rmem_bf16_9
        %iter_7903 = cute.get_iter(%view_7902) : !memref_rmem_bf16_9
        %lay_7904 = cute.get_layout(%view_7902) : !memref_rmem_bf16_9
        %2519 = cute.get_shape(%lay_7904) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_7905, %e1_7906, %e2_7907 = cute.get_leaves(%2519) : !cute.shape<"((8,1),4)">
        %iter_7908 = cute.get_iter(%view_7902) : !memref_rmem_bf16_9
        %view_7909 = cute.make_view(%iter_7908) : !memref_rmem_bf16_10
        %iter_7910 = cute.get_iter(%view_7909) : !memref_rmem_bf16_10
        %iter_7911 = cute.get_iter(%view_7909) : !memref_rmem_bf16_10
        %lay_7912 = cute.get_layout(%view_7895) : !memref_smem_bf16_18
        %2520 = cute.get_shape(%lay_7912) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_7913, %e1_7914, %e2_7915 = cute.get_leaves(%2520) : !cute.shape<"((8,1),(4))">
        %lay_7916 = cute.get_layout(%view_7909) : !memref_rmem_bf16_10
        %2521 = cute.get_shape(%lay_7916) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_7917, %e1_7918, %e2_7919 = cute.get_leaves(%2521) : !cute.shape<"((8,1),(4))">
        %lay_7920 = cute.get_layout(%view_7895) : !memref_smem_bf16_18
        %sz_7921 = cute.size(%lay_7920) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_7922 = cute.get_leaves(%sz_7921) : !cute.int_tuple<"4">
        %lay_7923 = cute.get_layout(%view_7909) : !memref_rmem_bf16_10
        %sz_7924 = cute.size(%lay_7923) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_7925 = cute.get_leaves(%sz_7924) : !cute.int_tuple<"4">
        %2522 = cute.static : !cute.layout<"1:0">
        %iter_7926 = cute.get_iter(%view_7895) : !memref_smem_bf16_18
        %iter_7927 = cute.get_iter(%view_7909) : !memref_rmem_bf16_10
        %lay_7928 = cute.get_layout(%view_7895) : !memref_smem_bf16_18
        %lay_7929 = cute.get_layout(%view_7909) : !memref_rmem_bf16_10
        %append_7930 = cute.append_to_rank<2> (%lay_7928, %2522) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_7931 = cute.append_to_rank<2> (%lay_7929, %2522) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_7932 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_7933 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_7934 = cute.size(%lay_7932) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2523 = cute.get_scalars(%sz_7934) : !cute.int_tuple<"4">
        %c0_i32_7935 = arith.constant 0 : i32
        %c1_i32_7936 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_7935 to %2523 step %c1_i32_7936  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_7932, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_7932) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_7926, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_7933, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_7933) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_7927, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_7937 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %2524 = cute.get_shape(%lay_7937) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))">
        %e0_7938, %e1_7939, %e2_7940, %e3_7941, %e4_7942, %e5_7943 = cute.get_leaves(%2524) : !cute.shape<"((8,1),2,((2,2),2))">
        %int_tuple_7944 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_7945 = cute.size(%int_tuple_7944) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_7946 = cute.get_leaves(%sz_7945) : !cute.int_tuple<"8">
        %int_tuple_7947 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_7948 = cute.size(%int_tuple_7947) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_7949 = cute.get_leaves(%sz_7948) : !cute.int_tuple<"8">
        %coord_7950 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_7951 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_7952 = cute.crd2idx(%coord_7950, %lay_7951) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_7953 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_7954 = cute.add_offset(%iter_7953, %idx_7952) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7955 = cute.make_view(%ptr_7954) : !memref_smem_bf16_14
        %iter_7956 = cute.get_iter(%view_7955) : !memref_smem_bf16_14
        %coord_7957 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_7958 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_7959 = cute.crd2idx(%coord_7957, %lay_7958) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"32">
        %iter_7960 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_7961 = cute.add_offset(%iter_7960, %idx_7959) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7962 = cute.make_view(%ptr_7961) : !memref_rmem_bf16_6
        %iter_7963 = cute.get_iter(%view_7962) : !memref_rmem_bf16_6
        %lay_7964 = cute.get_layout(%view_7955) : !memref_smem_bf16_14
        %2525 = cute.get_shape(%lay_7964) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7965, %e1_7966, %e2_7967 = cute.get_leaves(%2525) : !cute.shape<"((8,1),2)">
        %lay_7968 = cute.get_layout(%view_7962) : !memref_rmem_bf16_6
        %2526 = cute.get_shape(%lay_7968) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7969, %e1_7970, %e2_7971 = cute.get_leaves(%2526) : !cute.shape<"((8,1),2)">
        %lay_7972 = cute.get_layout(%view_7955) : !memref_smem_bf16_14
        %shape_7973 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7974 = cute.make_layout() : !cute.layout<"1:0">
        %append_7975 = cute.append_to_rank<2> (%lay_7972, %lay_7974) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_7976 = cute.make_view(%iter_7956, %append_7975) : !memref_smem_bf16_14
        %iter_7977 = cute.get_iter(%view_7976) : !memref_smem_bf16_14
        %lay_7978 = cute.get_layout(%view_7976) : !memref_smem_bf16_14
        %2527 = cute.get_shape(%lay_7978) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_7979, %e1_7980, %e2_7981 = cute.get_leaves(%2527) : !cute.shape<"((8,1),2)">
        %iter_7982 = cute.get_iter(%view_7976) : !memref_smem_bf16_14
        %view_7983 = cute.make_view(%iter_7982) : !memref_smem_bf16_15
        %iter_7984 = cute.get_iter(%view_7983) : !memref_smem_bf16_15
        %iter_7985 = cute.get_iter(%view_7983) : !memref_smem_bf16_15
        %lay_7986 = cute.get_layout(%view_7962) : !memref_rmem_bf16_6
        %shape_7987 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7988 = cute.make_layout() : !cute.layout<"1:0">
        %append_7989 = cute.append_to_rank<2> (%lay_7986, %lay_7988) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7990 = cute.make_view(%iter_7963, %append_7989) : !memref_rmem_bf16_6
        %iter_7991 = cute.get_iter(%view_7990) : !memref_rmem_bf16_6
        %lay_7992 = cute.get_layout(%view_7990) : !memref_rmem_bf16_6
        %2528 = cute.get_shape(%lay_7992) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7993, %e1_7994, %e2_7995 = cute.get_leaves(%2528) : !cute.shape<"((8,1),2)">
        %iter_7996 = cute.get_iter(%view_7990) : !memref_rmem_bf16_6
        %view_7997 = cute.make_view(%iter_7996) : !memref_rmem_bf16_7
        %iter_7998 = cute.get_iter(%view_7997) : !memref_rmem_bf16_7
        %iter_7999 = cute.get_iter(%view_7997) : !memref_rmem_bf16_7
        %lay_8000 = cute.get_layout(%view_7983) : !memref_smem_bf16_15
        %2529 = cute.get_shape(%lay_8000) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8001, %e1_8002, %e2_8003 = cute.get_leaves(%2529) : !cute.shape<"((8,1),(2))">
        %lay_8004 = cute.get_layout(%view_7997) : !memref_rmem_bf16_7
        %2530 = cute.get_shape(%lay_8004) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8005, %e1_8006, %e2_8007 = cute.get_leaves(%2530) : !cute.shape<"((8,1),(2))">
        %lay_8008 = cute.get_layout(%view_7983) : !memref_smem_bf16_15
        %sz_8009 = cute.size(%lay_8008) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8010 = cute.get_leaves(%sz_8009) : !cute.int_tuple<"2">
        %lay_8011 = cute.get_layout(%view_7997) : !memref_rmem_bf16_7
        %sz_8012 = cute.size(%lay_8011) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8013 = cute.get_leaves(%sz_8012) : !cute.int_tuple<"2">
        %2531 = cute.static : !cute.layout<"1:0">
        %iter_8014 = cute.get_iter(%view_7983) : !memref_smem_bf16_15
        %iter_8015 = cute.get_iter(%view_7997) : !memref_rmem_bf16_7
        %lay_8016 = cute.get_layout(%view_7983) : !memref_smem_bf16_15
        %lay_8017 = cute.get_layout(%view_7997) : !memref_rmem_bf16_7
        %append_8018 = cute.append_to_rank<2> (%lay_8016, %2531) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8019 = cute.append_to_rank<2> (%lay_8017, %2531) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8020 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8021 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8022 = cute.size(%lay_8020) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2532 = cute.get_scalars(%sz_8022) : !cute.int_tuple<"2">
        %c0_i32_8023 = arith.constant 0 : i32
        %c1_i32_8024 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8023 to %2532 step %c1_i32_8024  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8020, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8020) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8014, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8021, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8021) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8015, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8025 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8026 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8027 = cute.crd2idx(%coord_8025, %lay_8026) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8028 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8029 = cute.add_offset(%iter_8028, %idx_8027) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8030 = cute.make_view(%ptr_8029) : !memref_smem_bf16_17
        %iter_8031 = cute.get_iter(%view_8030) : !memref_smem_bf16_17
        %coord_8032 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8033 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8034 = cute.crd2idx(%coord_8032, %lay_8033) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"64">
        %iter_8035 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8036 = cute.add_offset(%iter_8035, %idx_8034) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8037 = cute.make_view(%ptr_8036) : !memref_rmem_bf16_9
        %iter_8038 = cute.get_iter(%view_8037) : !memref_rmem_bf16_9
        %lay_8039 = cute.get_layout(%view_8030) : !memref_smem_bf16_17
        %2533 = cute.get_shape(%lay_8039) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8040, %e1_8041, %e2_8042 = cute.get_leaves(%2533) : !cute.shape<"((8,1),4)">
        %lay_8043 = cute.get_layout(%view_8037) : !memref_rmem_bf16_9
        %2534 = cute.get_shape(%lay_8043) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8044, %e1_8045, %e2_8046 = cute.get_leaves(%2534) : !cute.shape<"((8,1),4)">
        %lay_8047 = cute.get_layout(%view_8030) : !memref_smem_bf16_17
        %shape_8048 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8049 = cute.make_layout() : !cute.layout<"1:0">
        %append_8050 = cute.append_to_rank<2> (%lay_8047, %lay_8049) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8051 = cute.make_view(%iter_8031, %append_8050) : !memref_smem_bf16_17
        %iter_8052 = cute.get_iter(%view_8051) : !memref_smem_bf16_17
        %lay_8053 = cute.get_layout(%view_8051) : !memref_smem_bf16_17
        %2535 = cute.get_shape(%lay_8053) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8054, %e1_8055, %e2_8056 = cute.get_leaves(%2535) : !cute.shape<"((8,1),4)">
        %iter_8057 = cute.get_iter(%view_8051) : !memref_smem_bf16_17
        %view_8058 = cute.make_view(%iter_8057) : !memref_smem_bf16_18
        %iter_8059 = cute.get_iter(%view_8058) : !memref_smem_bf16_18
        %iter_8060 = cute.get_iter(%view_8058) : !memref_smem_bf16_18
        %lay_8061 = cute.get_layout(%view_8037) : !memref_rmem_bf16_9
        %shape_8062 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8063 = cute.make_layout() : !cute.layout<"1:0">
        %append_8064 = cute.append_to_rank<2> (%lay_8061, %lay_8063) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8065 = cute.make_view(%iter_8038, %append_8064) : !memref_rmem_bf16_9
        %iter_8066 = cute.get_iter(%view_8065) : !memref_rmem_bf16_9
        %lay_8067 = cute.get_layout(%view_8065) : !memref_rmem_bf16_9
        %2536 = cute.get_shape(%lay_8067) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8068, %e1_8069, %e2_8070 = cute.get_leaves(%2536) : !cute.shape<"((8,1),4)">
        %iter_8071 = cute.get_iter(%view_8065) : !memref_rmem_bf16_9
        %view_8072 = cute.make_view(%iter_8071) : !memref_rmem_bf16_10
        %iter_8073 = cute.get_iter(%view_8072) : !memref_rmem_bf16_10
        %iter_8074 = cute.get_iter(%view_8072) : !memref_rmem_bf16_10
        %lay_8075 = cute.get_layout(%view_8058) : !memref_smem_bf16_18
        %2537 = cute.get_shape(%lay_8075) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8076, %e1_8077, %e2_8078 = cute.get_leaves(%2537) : !cute.shape<"((8,1),(4))">
        %lay_8079 = cute.get_layout(%view_8072) : !memref_rmem_bf16_10
        %2538 = cute.get_shape(%lay_8079) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8080, %e1_8081, %e2_8082 = cute.get_leaves(%2538) : !cute.shape<"((8,1),(4))">
        %lay_8083 = cute.get_layout(%view_8058) : !memref_smem_bf16_18
        %sz_8084 = cute.size(%lay_8083) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8085 = cute.get_leaves(%sz_8084) : !cute.int_tuple<"4">
        %lay_8086 = cute.get_layout(%view_8072) : !memref_rmem_bf16_10
        %sz_8087 = cute.size(%lay_8086) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8088 = cute.get_leaves(%sz_8087) : !cute.int_tuple<"4">
        %2539 = cute.static : !cute.layout<"1:0">
        %iter_8089 = cute.get_iter(%view_8058) : !memref_smem_bf16_18
        %iter_8090 = cute.get_iter(%view_8072) : !memref_rmem_bf16_10
        %lay_8091 = cute.get_layout(%view_8058) : !memref_smem_bf16_18
        %lay_8092 = cute.get_layout(%view_8072) : !memref_rmem_bf16_10
        %append_8093 = cute.append_to_rank<2> (%lay_8091, %2539) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8094 = cute.append_to_rank<2> (%lay_8092, %2539) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8095 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8096 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8097 = cute.size(%lay_8095) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2540 = cute.get_scalars(%sz_8097) : !cute.int_tuple<"4">
        %c0_i32_8098 = arith.constant 0 : i32
        %c1_i32_8099 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8098 to %2540 step %c1_i32_8099  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8095, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8095) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_8089, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8096, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8096) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8090, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8100 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8101 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8102 = cute.crd2idx(%coord_8100, %lay_8101) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"0">
        %iter_8103 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8104 = cute.add_offset(%iter_8103, %idx_8102) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8105 = cute.make_view(%ptr_8104) : !memref_rmem_bf16_12
        %iter_8106 = cute.get_iter(%view_8105) : !memref_rmem_bf16_12
        %coord_8107 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_8108 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8109 = cute.crd2idx(%coord_8107, %lay_8108) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"0">
        %iter_8110 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8111 = cute.add_offset(%iter_8110, %idx_8109) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8112 = cute.make_view(%ptr_8111) : !memref_rmem_bf16_13
        %iter_8113 = cute.get_iter(%view_8112) : !memref_rmem_bf16_13
        %lay_8114 = cute.get_layout(%view_8105) : !memref_rmem_bf16_12
        %2541 = cute.get_shape(%lay_8114) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8115, %e1_8116, %e2_8117, %e3_8118 = cute.get_leaves(%2541) : !cute.shape<"((2,2,2),2)">
        %lay_8119 = cute.get_layout(%view_8112) : !memref_rmem_bf16_13
        %2542 = cute.get_shape(%lay_8119) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8120, %e1_8121, %e2_8122 = cute.get_leaves(%2542) : !cute.shape<"((2,2),8)">
        %iter_8123 = cute.get_iter(%view_8105) : !memref_rmem_bf16_12
        %iter_8124 = cute.get_iter(%view_8112) : !memref_rmem_bf16_13
        %iter_8125 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_8126 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_8127 = cute.get_layout(%view_8105) : !memref_rmem_bf16_12
        %lay_8128 = cute.get_layout(%view_8112) : !memref_rmem_bf16_13
        %lay_8129 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_8130 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2543 = cute.static : !cute.layout<"1:0">
        %append_8131 = cute.append_to_rank<3> (%lay_8127, %2543) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8132 = cute.append_to_rank<3> (%lay_8128, %2543) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8133 = cute.size(%append_8131) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8134 = cute.size(%append_8131) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8135 = cute.size(%append_8132) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2544 = cute.get_scalars(%sz_8133) : !cute.int_tuple<"1">
        %2545 = cute.get_scalars(%sz_8134) : !cute.int_tuple<"2">
        %2546 = cute.get_scalars(%sz_8135) : !cute.int_tuple<"8">
        %c0_i32_8136 = arith.constant 0 : i32
        %c1_i32_8137 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8136 to %2544 step %c1_i32_8137  : i32 {
          scf.for %arg14 = %c0_i32_8136 to %2545 step %c1_i32_8137  : i32 {
            scf.for %arg15 = %c0_i32_8136 to %2546 step %c1_i32_8137  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_8131, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_8131) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_8123, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_8132, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_8132) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_8124, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_8129, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_8129) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_8125, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_8130, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_8130) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_8126, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8138 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8139 = cute.size(%int_tuple_8138) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8140 = cute.get_leaves(%sz_8139) : !cute.int_tuple<"8">
        %coord_8141 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8142 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_8143 = cute.crd2idx(%coord_8141, %lay_8142) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8144 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_8145 = cute.add_offset(%iter_8144, %idx_8143) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8146 = cute.make_view(%ptr_8145) : !memref_smem_bf16_14
        %iter_8147 = cute.get_iter(%view_8146) : !memref_smem_bf16_14
        %coord_8148 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8149 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8150 = cute.crd2idx(%coord_8148, %lay_8149) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"64">
        %iter_8151 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8152 = cute.add_offset(%iter_8151, %idx_8150) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8153 = cute.make_view(%ptr_8152) : !memref_rmem_bf16_6
        %iter_8154 = cute.get_iter(%view_8153) : !memref_rmem_bf16_6
        %lay_8155 = cute.get_layout(%view_8146) : !memref_smem_bf16_14
        %2547 = cute.get_shape(%lay_8155) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8156, %e1_8157, %e2_8158 = cute.get_leaves(%2547) : !cute.shape<"((8,1),2)">
        %lay_8159 = cute.get_layout(%view_8153) : !memref_rmem_bf16_6
        %2548 = cute.get_shape(%lay_8159) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8160, %e1_8161, %e2_8162 = cute.get_leaves(%2548) : !cute.shape<"((8,1),2)">
        %lay_8163 = cute.get_layout(%view_8146) : !memref_smem_bf16_14
        %shape_8164 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8165 = cute.make_layout() : !cute.layout<"1:0">
        %append_8166 = cute.append_to_rank<2> (%lay_8163, %lay_8165) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8167 = cute.make_view(%iter_8147, %append_8166) : !memref_smem_bf16_14
        %iter_8168 = cute.get_iter(%view_8167) : !memref_smem_bf16_14
        %lay_8169 = cute.get_layout(%view_8167) : !memref_smem_bf16_14
        %2549 = cute.get_shape(%lay_8169) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8170, %e1_8171, %e2_8172 = cute.get_leaves(%2549) : !cute.shape<"((8,1),2)">
        %iter_8173 = cute.get_iter(%view_8167) : !memref_smem_bf16_14
        %view_8174 = cute.make_view(%iter_8173) : !memref_smem_bf16_15
        %iter_8175 = cute.get_iter(%view_8174) : !memref_smem_bf16_15
        %iter_8176 = cute.get_iter(%view_8174) : !memref_smem_bf16_15
        %lay_8177 = cute.get_layout(%view_8153) : !memref_rmem_bf16_6
        %shape_8178 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8179 = cute.make_layout() : !cute.layout<"1:0">
        %append_8180 = cute.append_to_rank<2> (%lay_8177, %lay_8179) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8181 = cute.make_view(%iter_8154, %append_8180) : !memref_rmem_bf16_6
        %iter_8182 = cute.get_iter(%view_8181) : !memref_rmem_bf16_6
        %lay_8183 = cute.get_layout(%view_8181) : !memref_rmem_bf16_6
        %2550 = cute.get_shape(%lay_8183) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8184, %e1_8185, %e2_8186 = cute.get_leaves(%2550) : !cute.shape<"((8,1),2)">
        %iter_8187 = cute.get_iter(%view_8181) : !memref_rmem_bf16_6
        %view_8188 = cute.make_view(%iter_8187) : !memref_rmem_bf16_7
        %iter_8189 = cute.get_iter(%view_8188) : !memref_rmem_bf16_7
        %iter_8190 = cute.get_iter(%view_8188) : !memref_rmem_bf16_7
        %lay_8191 = cute.get_layout(%view_8174) : !memref_smem_bf16_15
        %2551 = cute.get_shape(%lay_8191) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8192, %e1_8193, %e2_8194 = cute.get_leaves(%2551) : !cute.shape<"((8,1),(2))">
        %lay_8195 = cute.get_layout(%view_8188) : !memref_rmem_bf16_7
        %2552 = cute.get_shape(%lay_8195) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8196, %e1_8197, %e2_8198 = cute.get_leaves(%2552) : !cute.shape<"((8,1),(2))">
        %lay_8199 = cute.get_layout(%view_8174) : !memref_smem_bf16_15
        %sz_8200 = cute.size(%lay_8199) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8201 = cute.get_leaves(%sz_8200) : !cute.int_tuple<"2">
        %lay_8202 = cute.get_layout(%view_8188) : !memref_rmem_bf16_7
        %sz_8203 = cute.size(%lay_8202) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8204 = cute.get_leaves(%sz_8203) : !cute.int_tuple<"2">
        %2553 = cute.static : !cute.layout<"1:0">
        %iter_8205 = cute.get_iter(%view_8174) : !memref_smem_bf16_15
        %iter_8206 = cute.get_iter(%view_8188) : !memref_rmem_bf16_7
        %lay_8207 = cute.get_layout(%view_8174) : !memref_smem_bf16_15
        %lay_8208 = cute.get_layout(%view_8188) : !memref_rmem_bf16_7
        %append_8209 = cute.append_to_rank<2> (%lay_8207, %2553) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8210 = cute.append_to_rank<2> (%lay_8208, %2553) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8211 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8212 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8213 = cute.size(%lay_8211) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2554 = cute.get_scalars(%sz_8213) : !cute.int_tuple<"2">
        %c0_i32_8214 = arith.constant 0 : i32
        %c1_i32_8215 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8214 to %2554 step %c1_i32_8215  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8211, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8211) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8205, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8212, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8212) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8206, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8216 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8217 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8218 = cute.crd2idx(%coord_8216, %lay_8217) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8219 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8220 = cute.add_offset(%iter_8219, %idx_8218) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8221 = cute.make_view(%ptr_8220) : !memref_smem_bf16_17
        %iter_8222 = cute.get_iter(%view_8221) : !memref_smem_bf16_17
        %coord_8223 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8224 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8225 = cute.crd2idx(%coord_8223, %lay_8224) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"128">
        %iter_8226 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8227 = cute.add_offset(%iter_8226, %idx_8225) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8228 = cute.make_view(%ptr_8227) : !memref_rmem_bf16_9
        %iter_8229 = cute.get_iter(%view_8228) : !memref_rmem_bf16_9
        %lay_8230 = cute.get_layout(%view_8221) : !memref_smem_bf16_17
        %2555 = cute.get_shape(%lay_8230) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8231, %e1_8232, %e2_8233 = cute.get_leaves(%2555) : !cute.shape<"((8,1),4)">
        %lay_8234 = cute.get_layout(%view_8228) : !memref_rmem_bf16_9
        %2556 = cute.get_shape(%lay_8234) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8235, %e1_8236, %e2_8237 = cute.get_leaves(%2556) : !cute.shape<"((8,1),4)">
        %lay_8238 = cute.get_layout(%view_8221) : !memref_smem_bf16_17
        %shape_8239 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8240 = cute.make_layout() : !cute.layout<"1:0">
        %append_8241 = cute.append_to_rank<2> (%lay_8238, %lay_8240) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8242 = cute.make_view(%iter_8222, %append_8241) : !memref_smem_bf16_17
        %iter_8243 = cute.get_iter(%view_8242) : !memref_smem_bf16_17
        %lay_8244 = cute.get_layout(%view_8242) : !memref_smem_bf16_17
        %2557 = cute.get_shape(%lay_8244) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8245, %e1_8246, %e2_8247 = cute.get_leaves(%2557) : !cute.shape<"((8,1),4)">
        %iter_8248 = cute.get_iter(%view_8242) : !memref_smem_bf16_17
        %view_8249 = cute.make_view(%iter_8248) : !memref_smem_bf16_18
        %iter_8250 = cute.get_iter(%view_8249) : !memref_smem_bf16_18
        %iter_8251 = cute.get_iter(%view_8249) : !memref_smem_bf16_18
        %lay_8252 = cute.get_layout(%view_8228) : !memref_rmem_bf16_9
        %shape_8253 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8254 = cute.make_layout() : !cute.layout<"1:0">
        %append_8255 = cute.append_to_rank<2> (%lay_8252, %lay_8254) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8256 = cute.make_view(%iter_8229, %append_8255) : !memref_rmem_bf16_9
        %iter_8257 = cute.get_iter(%view_8256) : !memref_rmem_bf16_9
        %lay_8258 = cute.get_layout(%view_8256) : !memref_rmem_bf16_9
        %2558 = cute.get_shape(%lay_8258) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8259, %e1_8260, %e2_8261 = cute.get_leaves(%2558) : !cute.shape<"((8,1),4)">
        %iter_8262 = cute.get_iter(%view_8256) : !memref_rmem_bf16_9
        %view_8263 = cute.make_view(%iter_8262) : !memref_rmem_bf16_10
        %iter_8264 = cute.get_iter(%view_8263) : !memref_rmem_bf16_10
        %iter_8265 = cute.get_iter(%view_8263) : !memref_rmem_bf16_10
        %lay_8266 = cute.get_layout(%view_8249) : !memref_smem_bf16_18
        %2559 = cute.get_shape(%lay_8266) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8267, %e1_8268, %e2_8269 = cute.get_leaves(%2559) : !cute.shape<"((8,1),(4))">
        %lay_8270 = cute.get_layout(%view_8263) : !memref_rmem_bf16_10
        %2560 = cute.get_shape(%lay_8270) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8271, %e1_8272, %e2_8273 = cute.get_leaves(%2560) : !cute.shape<"((8,1),(4))">
        %lay_8274 = cute.get_layout(%view_8249) : !memref_smem_bf16_18
        %sz_8275 = cute.size(%lay_8274) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8276 = cute.get_leaves(%sz_8275) : !cute.int_tuple<"4">
        %lay_8277 = cute.get_layout(%view_8263) : !memref_rmem_bf16_10
        %sz_8278 = cute.size(%lay_8277) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8279 = cute.get_leaves(%sz_8278) : !cute.int_tuple<"4">
        %2561 = cute.static : !cute.layout<"1:0">
        %iter_8280 = cute.get_iter(%view_8249) : !memref_smem_bf16_18
        %iter_8281 = cute.get_iter(%view_8263) : !memref_rmem_bf16_10
        %lay_8282 = cute.get_layout(%view_8249) : !memref_smem_bf16_18
        %lay_8283 = cute.get_layout(%view_8263) : !memref_rmem_bf16_10
        %append_8284 = cute.append_to_rank<2> (%lay_8282, %2561) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8285 = cute.append_to_rank<2> (%lay_8283, %2561) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8286 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8287 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8288 = cute.size(%lay_8286) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2562 = cute.get_scalars(%sz_8288) : !cute.int_tuple<"4">
        %c0_i32_8289 = arith.constant 0 : i32
        %c1_i32_8290 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8289 to %2562 step %c1_i32_8290  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8286, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8286) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_8280, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8287, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8287) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8281, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8291 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8292 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8293 = cute.crd2idx(%coord_8291, %lay_8292) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"32">
        %iter_8294 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8295 = cute.add_offset(%iter_8294, %idx_8293) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8296 = cute.make_view(%ptr_8295) : !memref_rmem_bf16_12
        %iter_8297 = cute.get_iter(%view_8296) : !memref_rmem_bf16_12
        %coord_8298 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_8299 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8300 = cute.crd2idx(%coord_8298, %lay_8299) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"64">
        %iter_8301 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8302 = cute.add_offset(%iter_8301, %idx_8300) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8303 = cute.make_view(%ptr_8302) : !memref_rmem_bf16_13
        %iter_8304 = cute.get_iter(%view_8303) : !memref_rmem_bf16_13
        %lay_8305 = cute.get_layout(%view_8296) : !memref_rmem_bf16_12
        %2563 = cute.get_shape(%lay_8305) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8306, %e1_8307, %e2_8308, %e3_8309 = cute.get_leaves(%2563) : !cute.shape<"((2,2,2),2)">
        %lay_8310 = cute.get_layout(%view_8303) : !memref_rmem_bf16_13
        %2564 = cute.get_shape(%lay_8310) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8311, %e1_8312, %e2_8313 = cute.get_leaves(%2564) : !cute.shape<"((2,2),8)">
        %iter_8314 = cute.get_iter(%view_8296) : !memref_rmem_bf16_12
        %iter_8315 = cute.get_iter(%view_8303) : !memref_rmem_bf16_13
        %iter_8316 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_8317 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_8318 = cute.get_layout(%view_8296) : !memref_rmem_bf16_12
        %lay_8319 = cute.get_layout(%view_8303) : !memref_rmem_bf16_13
        %lay_8320 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_8321 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2565 = cute.static : !cute.layout<"1:0">
        %append_8322 = cute.append_to_rank<3> (%lay_8318, %2565) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8323 = cute.append_to_rank<3> (%lay_8319, %2565) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8324 = cute.size(%append_8322) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8325 = cute.size(%append_8322) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8326 = cute.size(%append_8323) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2566 = cute.get_scalars(%sz_8324) : !cute.int_tuple<"1">
        %2567 = cute.get_scalars(%sz_8325) : !cute.int_tuple<"2">
        %2568 = cute.get_scalars(%sz_8326) : !cute.int_tuple<"8">
        %c0_i32_8327 = arith.constant 0 : i32
        %c1_i32_8328 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8327 to %2566 step %c1_i32_8328  : i32 {
          scf.for %arg14 = %c0_i32_8327 to %2567 step %c1_i32_8328  : i32 {
            scf.for %arg15 = %c0_i32_8327 to %2568 step %c1_i32_8328  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_8322, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_8322) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_8314, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_8323, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_8323) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_8315, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_8320, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_8320) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_8316, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_8321, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_8321) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_8317, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8329 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8330 = cute.size(%int_tuple_8329) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8331 = cute.get_leaves(%sz_8330) : !cute.int_tuple<"8">
        %coord_8332 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8333 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_8334 = cute.crd2idx(%coord_8332, %lay_8333) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8335 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_8336 = cute.add_offset(%iter_8335, %idx_8334) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8337 = cute.make_view(%ptr_8336) : !memref_smem_bf16_14
        %iter_8338 = cute.get_iter(%view_8337) : !memref_smem_bf16_14
        %coord_8339 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8340 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8341 = cute.crd2idx(%coord_8339, %lay_8340) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"96">
        %iter_8342 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8343 = cute.add_offset(%iter_8342, %idx_8341) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8344 = cute.make_view(%ptr_8343) : !memref_rmem_bf16_6
        %iter_8345 = cute.get_iter(%view_8344) : !memref_rmem_bf16_6
        %lay_8346 = cute.get_layout(%view_8337) : !memref_smem_bf16_14
        %2569 = cute.get_shape(%lay_8346) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8347, %e1_8348, %e2_8349 = cute.get_leaves(%2569) : !cute.shape<"((8,1),2)">
        %lay_8350 = cute.get_layout(%view_8344) : !memref_rmem_bf16_6
        %2570 = cute.get_shape(%lay_8350) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8351, %e1_8352, %e2_8353 = cute.get_leaves(%2570) : !cute.shape<"((8,1),2)">
        %lay_8354 = cute.get_layout(%view_8337) : !memref_smem_bf16_14
        %shape_8355 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8356 = cute.make_layout() : !cute.layout<"1:0">
        %append_8357 = cute.append_to_rank<2> (%lay_8354, %lay_8356) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8358 = cute.make_view(%iter_8338, %append_8357) : !memref_smem_bf16_14
        %iter_8359 = cute.get_iter(%view_8358) : !memref_smem_bf16_14
        %lay_8360 = cute.get_layout(%view_8358) : !memref_smem_bf16_14
        %2571 = cute.get_shape(%lay_8360) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8361, %e1_8362, %e2_8363 = cute.get_leaves(%2571) : !cute.shape<"((8,1),2)">
        %iter_8364 = cute.get_iter(%view_8358) : !memref_smem_bf16_14
        %view_8365 = cute.make_view(%iter_8364) : !memref_smem_bf16_15
        %iter_8366 = cute.get_iter(%view_8365) : !memref_smem_bf16_15
        %iter_8367 = cute.get_iter(%view_8365) : !memref_smem_bf16_15
        %lay_8368 = cute.get_layout(%view_8344) : !memref_rmem_bf16_6
        %shape_8369 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8370 = cute.make_layout() : !cute.layout<"1:0">
        %append_8371 = cute.append_to_rank<2> (%lay_8368, %lay_8370) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8372 = cute.make_view(%iter_8345, %append_8371) : !memref_rmem_bf16_6
        %iter_8373 = cute.get_iter(%view_8372) : !memref_rmem_bf16_6
        %lay_8374 = cute.get_layout(%view_8372) : !memref_rmem_bf16_6
        %2572 = cute.get_shape(%lay_8374) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8375, %e1_8376, %e2_8377 = cute.get_leaves(%2572) : !cute.shape<"((8,1),2)">
        %iter_8378 = cute.get_iter(%view_8372) : !memref_rmem_bf16_6
        %view_8379 = cute.make_view(%iter_8378) : !memref_rmem_bf16_7
        %iter_8380 = cute.get_iter(%view_8379) : !memref_rmem_bf16_7
        %iter_8381 = cute.get_iter(%view_8379) : !memref_rmem_bf16_7
        %lay_8382 = cute.get_layout(%view_8365) : !memref_smem_bf16_15
        %2573 = cute.get_shape(%lay_8382) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8383, %e1_8384, %e2_8385 = cute.get_leaves(%2573) : !cute.shape<"((8,1),(2))">
        %lay_8386 = cute.get_layout(%view_8379) : !memref_rmem_bf16_7
        %2574 = cute.get_shape(%lay_8386) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8387, %e1_8388, %e2_8389 = cute.get_leaves(%2574) : !cute.shape<"((8,1),(2))">
        %lay_8390 = cute.get_layout(%view_8365) : !memref_smem_bf16_15
        %sz_8391 = cute.size(%lay_8390) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8392 = cute.get_leaves(%sz_8391) : !cute.int_tuple<"2">
        %lay_8393 = cute.get_layout(%view_8379) : !memref_rmem_bf16_7
        %sz_8394 = cute.size(%lay_8393) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8395 = cute.get_leaves(%sz_8394) : !cute.int_tuple<"2">
        %2575 = cute.static : !cute.layout<"1:0">
        %iter_8396 = cute.get_iter(%view_8365) : !memref_smem_bf16_15
        %iter_8397 = cute.get_iter(%view_8379) : !memref_rmem_bf16_7
        %lay_8398 = cute.get_layout(%view_8365) : !memref_smem_bf16_15
        %lay_8399 = cute.get_layout(%view_8379) : !memref_rmem_bf16_7
        %append_8400 = cute.append_to_rank<2> (%lay_8398, %2575) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8401 = cute.append_to_rank<2> (%lay_8399, %2575) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8402 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8403 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8404 = cute.size(%lay_8402) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2576 = cute.get_scalars(%sz_8404) : !cute.int_tuple<"2">
        %c0_i32_8405 = arith.constant 0 : i32
        %c1_i32_8406 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8405 to %2576 step %c1_i32_8406  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8402, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8402) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8396, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8403, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8403) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8397, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8407 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8408 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8409 = cute.crd2idx(%coord_8407, %lay_8408) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8410 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8411 = cute.add_offset(%iter_8410, %idx_8409) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8412 = cute.make_view(%ptr_8411) : !memref_smem_bf16_17
        %iter_8413 = cute.get_iter(%view_8412) : !memref_smem_bf16_17
        %coord_8414 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8415 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8416 = cute.crd2idx(%coord_8414, %lay_8415) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"192">
        %iter_8417 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8418 = cute.add_offset(%iter_8417, %idx_8416) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8419 = cute.make_view(%ptr_8418) : !memref_rmem_bf16_9
        %iter_8420 = cute.get_iter(%view_8419) : !memref_rmem_bf16_9
        %lay_8421 = cute.get_layout(%view_8412) : !memref_smem_bf16_17
        %2577 = cute.get_shape(%lay_8421) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8422, %e1_8423, %e2_8424 = cute.get_leaves(%2577) : !cute.shape<"((8,1),4)">
        %lay_8425 = cute.get_layout(%view_8419) : !memref_rmem_bf16_9
        %2578 = cute.get_shape(%lay_8425) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8426, %e1_8427, %e2_8428 = cute.get_leaves(%2578) : !cute.shape<"((8,1),4)">
        %lay_8429 = cute.get_layout(%view_8412) : !memref_smem_bf16_17
        %shape_8430 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8431 = cute.make_layout() : !cute.layout<"1:0">
        %append_8432 = cute.append_to_rank<2> (%lay_8429, %lay_8431) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8433 = cute.make_view(%iter_8413, %append_8432) : !memref_smem_bf16_17
        %iter_8434 = cute.get_iter(%view_8433) : !memref_smem_bf16_17
        %lay_8435 = cute.get_layout(%view_8433) : !memref_smem_bf16_17
        %2579 = cute.get_shape(%lay_8435) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8436, %e1_8437, %e2_8438 = cute.get_leaves(%2579) : !cute.shape<"((8,1),4)">
        %iter_8439 = cute.get_iter(%view_8433) : !memref_smem_bf16_17
        %view_8440 = cute.make_view(%iter_8439) : !memref_smem_bf16_18
        %iter_8441 = cute.get_iter(%view_8440) : !memref_smem_bf16_18
        %iter_8442 = cute.get_iter(%view_8440) : !memref_smem_bf16_18
        %lay_8443 = cute.get_layout(%view_8419) : !memref_rmem_bf16_9
        %shape_8444 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8445 = cute.make_layout() : !cute.layout<"1:0">
        %append_8446 = cute.append_to_rank<2> (%lay_8443, %lay_8445) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8447 = cute.make_view(%iter_8420, %append_8446) : !memref_rmem_bf16_9
        %iter_8448 = cute.get_iter(%view_8447) : !memref_rmem_bf16_9
        %lay_8449 = cute.get_layout(%view_8447) : !memref_rmem_bf16_9
        %2580 = cute.get_shape(%lay_8449) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8450, %e1_8451, %e2_8452 = cute.get_leaves(%2580) : !cute.shape<"((8,1),4)">
        %iter_8453 = cute.get_iter(%view_8447) : !memref_rmem_bf16_9
        %view_8454 = cute.make_view(%iter_8453) : !memref_rmem_bf16_10
        %iter_8455 = cute.get_iter(%view_8454) : !memref_rmem_bf16_10
        %iter_8456 = cute.get_iter(%view_8454) : !memref_rmem_bf16_10
        %lay_8457 = cute.get_layout(%view_8440) : !memref_smem_bf16_18
        %2581 = cute.get_shape(%lay_8457) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8458, %e1_8459, %e2_8460 = cute.get_leaves(%2581) : !cute.shape<"((8,1),(4))">
        %lay_8461 = cute.get_layout(%view_8454) : !memref_rmem_bf16_10
        %2582 = cute.get_shape(%lay_8461) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8462, %e1_8463, %e2_8464 = cute.get_leaves(%2582) : !cute.shape<"((8,1),(4))">
        %lay_8465 = cute.get_layout(%view_8440) : !memref_smem_bf16_18
        %sz_8466 = cute.size(%lay_8465) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8467 = cute.get_leaves(%sz_8466) : !cute.int_tuple<"4">
        %lay_8468 = cute.get_layout(%view_8454) : !memref_rmem_bf16_10
        %sz_8469 = cute.size(%lay_8468) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8470 = cute.get_leaves(%sz_8469) : !cute.int_tuple<"4">
        %2583 = cute.static : !cute.layout<"1:0">
        %iter_8471 = cute.get_iter(%view_8440) : !memref_smem_bf16_18
        %iter_8472 = cute.get_iter(%view_8454) : !memref_rmem_bf16_10
        %lay_8473 = cute.get_layout(%view_8440) : !memref_smem_bf16_18
        %lay_8474 = cute.get_layout(%view_8454) : !memref_rmem_bf16_10
        %append_8475 = cute.append_to_rank<2> (%lay_8473, %2583) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8476 = cute.append_to_rank<2> (%lay_8474, %2583) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8477 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8478 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8479 = cute.size(%lay_8477) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2584 = cute.get_scalars(%sz_8479) : !cute.int_tuple<"4">
        %c0_i32_8480 = arith.constant 0 : i32
        %c1_i32_8481 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8480 to %2584 step %c1_i32_8481  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8477, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8477) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_8471, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8478, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8478) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8472, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8482 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8483 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8484 = cute.crd2idx(%coord_8482, %lay_8483) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"64">
        %iter_8485 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8486 = cute.add_offset(%iter_8485, %idx_8484) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8487 = cute.make_view(%ptr_8486) : !memref_rmem_bf16_12
        %iter_8488 = cute.get_iter(%view_8487) : !memref_rmem_bf16_12
        %coord_8489 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_8490 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8491 = cute.crd2idx(%coord_8489, %lay_8490) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"128">
        %iter_8492 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8493 = cute.add_offset(%iter_8492, %idx_8491) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"128">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8494 = cute.make_view(%ptr_8493) : !memref_rmem_bf16_13
        %iter_8495 = cute.get_iter(%view_8494) : !memref_rmem_bf16_13
        %lay_8496 = cute.get_layout(%view_8487) : !memref_rmem_bf16_12
        %2585 = cute.get_shape(%lay_8496) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8497, %e1_8498, %e2_8499, %e3_8500 = cute.get_leaves(%2585) : !cute.shape<"((2,2,2),2)">
        %lay_8501 = cute.get_layout(%view_8494) : !memref_rmem_bf16_13
        %2586 = cute.get_shape(%lay_8501) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8502, %e1_8503, %e2_8504 = cute.get_leaves(%2586) : !cute.shape<"((2,2),8)">
        %iter_8505 = cute.get_iter(%view_8487) : !memref_rmem_bf16_12
        %iter_8506 = cute.get_iter(%view_8494) : !memref_rmem_bf16_13
        %iter_8507 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_8508 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_8509 = cute.get_layout(%view_8487) : !memref_rmem_bf16_12
        %lay_8510 = cute.get_layout(%view_8494) : !memref_rmem_bf16_13
        %lay_8511 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_8512 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2587 = cute.static : !cute.layout<"1:0">
        %append_8513 = cute.append_to_rank<3> (%lay_8509, %2587) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8514 = cute.append_to_rank<3> (%lay_8510, %2587) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8515 = cute.size(%append_8513) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8516 = cute.size(%append_8513) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8517 = cute.size(%append_8514) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2588 = cute.get_scalars(%sz_8515) : !cute.int_tuple<"1">
        %2589 = cute.get_scalars(%sz_8516) : !cute.int_tuple<"2">
        %2590 = cute.get_scalars(%sz_8517) : !cute.int_tuple<"8">
        %c0_i32_8518 = arith.constant 0 : i32
        %c1_i32_8519 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8518 to %2588 step %c1_i32_8519  : i32 {
          scf.for %arg14 = %c0_i32_8518 to %2589 step %c1_i32_8519  : i32 {
            scf.for %arg15 = %c0_i32_8518 to %2590 step %c1_i32_8519  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_8513, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_8513) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_8505, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_8514, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_8514) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_8506, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_8511, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_8511) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_8507, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_8512, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_8512) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_8508, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8520 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8521 = cute.size(%int_tuple_8520) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8522 = cute.get_leaves(%sz_8521) : !cute.int_tuple<"8">
        %coord_8523 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8524 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_8525 = cute.crd2idx(%coord_8523, %lay_8524) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"8192">
        %iter_8526 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_8527 = cute.add_offset(%iter_8526, %idx_8525) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"8192">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8528 = cute.make_view(%ptr_8527) : !memref_smem_bf16_14
        %iter_8529 = cute.get_iter(%view_8528) : !memref_smem_bf16_14
        %coord_8530 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8531 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8532 = cute.crd2idx(%coord_8530, %lay_8531) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"16">
        %iter_8533 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8534 = cute.add_offset(%iter_8533, %idx_8532) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8535 = cute.make_view(%ptr_8534) : !memref_rmem_bf16_6
        %iter_8536 = cute.get_iter(%view_8535) : !memref_rmem_bf16_6
        %lay_8537 = cute.get_layout(%view_8528) : !memref_smem_bf16_14
        %2591 = cute.get_shape(%lay_8537) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8538, %e1_8539, %e2_8540 = cute.get_leaves(%2591) : !cute.shape<"((8,1),2)">
        %lay_8541 = cute.get_layout(%view_8535) : !memref_rmem_bf16_6
        %2592 = cute.get_shape(%lay_8541) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8542, %e1_8543, %e2_8544 = cute.get_leaves(%2592) : !cute.shape<"((8,1),2)">
        %lay_8545 = cute.get_layout(%view_8528) : !memref_smem_bf16_14
        %shape_8546 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8547 = cute.make_layout() : !cute.layout<"1:0">
        %append_8548 = cute.append_to_rank<2> (%lay_8545, %lay_8547) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8549 = cute.make_view(%iter_8529, %append_8548) : !memref_smem_bf16_14
        %iter_8550 = cute.get_iter(%view_8549) : !memref_smem_bf16_14
        %lay_8551 = cute.get_layout(%view_8549) : !memref_smem_bf16_14
        %2593 = cute.get_shape(%lay_8551) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8552, %e1_8553, %e2_8554 = cute.get_leaves(%2593) : !cute.shape<"((8,1),2)">
        %iter_8555 = cute.get_iter(%view_8549) : !memref_smem_bf16_14
        %view_8556 = cute.make_view(%iter_8555) : !memref_smem_bf16_15
        %iter_8557 = cute.get_iter(%view_8556) : !memref_smem_bf16_15
        %iter_8558 = cute.get_iter(%view_8556) : !memref_smem_bf16_15
        %lay_8559 = cute.get_layout(%view_8535) : !memref_rmem_bf16_6
        %shape_8560 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8561 = cute.make_layout() : !cute.layout<"1:0">
        %append_8562 = cute.append_to_rank<2> (%lay_8559, %lay_8561) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8563 = cute.make_view(%iter_8536, %append_8562) : !memref_rmem_bf16_6
        %iter_8564 = cute.get_iter(%view_8563) : !memref_rmem_bf16_6
        %lay_8565 = cute.get_layout(%view_8563) : !memref_rmem_bf16_6
        %2594 = cute.get_shape(%lay_8565) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8566, %e1_8567, %e2_8568 = cute.get_leaves(%2594) : !cute.shape<"((8,1),2)">
        %iter_8569 = cute.get_iter(%view_8563) : !memref_rmem_bf16_6
        %view_8570 = cute.make_view(%iter_8569) : !memref_rmem_bf16_7
        %iter_8571 = cute.get_iter(%view_8570) : !memref_rmem_bf16_7
        %iter_8572 = cute.get_iter(%view_8570) : !memref_rmem_bf16_7
        %lay_8573 = cute.get_layout(%view_8556) : !memref_smem_bf16_15
        %2595 = cute.get_shape(%lay_8573) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8574, %e1_8575, %e2_8576 = cute.get_leaves(%2595) : !cute.shape<"((8,1),(2))">
        %lay_8577 = cute.get_layout(%view_8570) : !memref_rmem_bf16_7
        %2596 = cute.get_shape(%lay_8577) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8578, %e1_8579, %e2_8580 = cute.get_leaves(%2596) : !cute.shape<"((8,1),(2))">
        %lay_8581 = cute.get_layout(%view_8556) : !memref_smem_bf16_15
        %sz_8582 = cute.size(%lay_8581) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8583 = cute.get_leaves(%sz_8582) : !cute.int_tuple<"2">
        %lay_8584 = cute.get_layout(%view_8570) : !memref_rmem_bf16_7
        %sz_8585 = cute.size(%lay_8584) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8586 = cute.get_leaves(%sz_8585) : !cute.int_tuple<"2">
        %2597 = cute.static : !cute.layout<"1:0">
        %iter_8587 = cute.get_iter(%view_8556) : !memref_smem_bf16_15
        %iter_8588 = cute.get_iter(%view_8570) : !memref_rmem_bf16_7
        %lay_8589 = cute.get_layout(%view_8556) : !memref_smem_bf16_15
        %lay_8590 = cute.get_layout(%view_8570) : !memref_rmem_bf16_7
        %append_8591 = cute.append_to_rank<2> (%lay_8589, %2597) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8592 = cute.append_to_rank<2> (%lay_8590, %2597) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8593 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8594 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8595 = cute.size(%lay_8593) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2598 = cute.get_scalars(%sz_8595) : !cute.int_tuple<"2">
        %c0_i32_8596 = arith.constant 0 : i32
        %c1_i32_8597 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8596 to %2598 step %c1_i32_8597  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8593, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8593) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8587, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8594, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8594) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8588, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8598 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8599 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8600 = cute.crd2idx(%coord_8598, %lay_8599) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"4096">
        %iter_8601 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8602 = cute.add_offset(%iter_8601, %idx_8600) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"4096">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8603 = cute.make_view(%ptr_8602) : !memref_smem_bf16_17
        %iter_8604 = cute.get_iter(%view_8603) : !memref_smem_bf16_17
        %coord_8605 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8606 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8607 = cute.crd2idx(%coord_8605, %lay_8606) : (!cute.coord<"(_,_,4)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"32">
        %iter_8608 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8609 = cute.add_offset(%iter_8608, %idx_8607) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8610 = cute.make_view(%ptr_8609) : !memref_rmem_bf16_9
        %iter_8611 = cute.get_iter(%view_8610) : !memref_rmem_bf16_9
        %lay_8612 = cute.get_layout(%view_8603) : !memref_smem_bf16_17
        %2599 = cute.get_shape(%lay_8612) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8613, %e1_8614, %e2_8615 = cute.get_leaves(%2599) : !cute.shape<"((8,1),4)">
        %lay_8616 = cute.get_layout(%view_8610) : !memref_rmem_bf16_9
        %2600 = cute.get_shape(%lay_8616) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8617, %e1_8618, %e2_8619 = cute.get_leaves(%2600) : !cute.shape<"((8,1),4)">
        %lay_8620 = cute.get_layout(%view_8603) : !memref_smem_bf16_17
        %shape_8621 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8622 = cute.make_layout() : !cute.layout<"1:0">
        %append_8623 = cute.append_to_rank<2> (%lay_8620, %lay_8622) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8624 = cute.make_view(%iter_8604, %append_8623) : !memref_smem_bf16_17
        %iter_8625 = cute.get_iter(%view_8624) : !memref_smem_bf16_17
        %lay_8626 = cute.get_layout(%view_8624) : !memref_smem_bf16_17
        %2601 = cute.get_shape(%lay_8626) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8627, %e1_8628, %e2_8629 = cute.get_leaves(%2601) : !cute.shape<"((8,1),4)">
        %iter_8630 = cute.get_iter(%view_8624) : !memref_smem_bf16_17
        %view_8631 = cute.make_view(%iter_8630) : !memref_smem_bf16_18
        %iter_8632 = cute.get_iter(%view_8631) : !memref_smem_bf16_18
        %iter_8633 = cute.get_iter(%view_8631) : !memref_smem_bf16_18
        %lay_8634 = cute.get_layout(%view_8610) : !memref_rmem_bf16_9
        %shape_8635 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8636 = cute.make_layout() : !cute.layout<"1:0">
        %append_8637 = cute.append_to_rank<2> (%lay_8634, %lay_8636) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8638 = cute.make_view(%iter_8611, %append_8637) : !memref_rmem_bf16_9
        %iter_8639 = cute.get_iter(%view_8638) : !memref_rmem_bf16_9
        %lay_8640 = cute.get_layout(%view_8638) : !memref_rmem_bf16_9
        %2602 = cute.get_shape(%lay_8640) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8641, %e1_8642, %e2_8643 = cute.get_leaves(%2602) : !cute.shape<"((8,1),4)">
        %iter_8644 = cute.get_iter(%view_8638) : !memref_rmem_bf16_9
        %view_8645 = cute.make_view(%iter_8644) : !memref_rmem_bf16_10
        %iter_8646 = cute.get_iter(%view_8645) : !memref_rmem_bf16_10
        %iter_8647 = cute.get_iter(%view_8645) : !memref_rmem_bf16_10
        %lay_8648 = cute.get_layout(%view_8631) : !memref_smem_bf16_18
        %2603 = cute.get_shape(%lay_8648) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8649, %e1_8650, %e2_8651 = cute.get_leaves(%2603) : !cute.shape<"((8,1),(4))">
        %lay_8652 = cute.get_layout(%view_8645) : !memref_rmem_bf16_10
        %2604 = cute.get_shape(%lay_8652) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8653, %e1_8654, %e2_8655 = cute.get_leaves(%2604) : !cute.shape<"((8,1),(4))">
        %lay_8656 = cute.get_layout(%view_8631) : !memref_smem_bf16_18
        %sz_8657 = cute.size(%lay_8656) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8658 = cute.get_leaves(%sz_8657) : !cute.int_tuple<"4">
        %lay_8659 = cute.get_layout(%view_8645) : !memref_rmem_bf16_10
        %sz_8660 = cute.size(%lay_8659) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8661 = cute.get_leaves(%sz_8660) : !cute.int_tuple<"4">
        %2605 = cute.static : !cute.layout<"1:0">
        %iter_8662 = cute.get_iter(%view_8631) : !memref_smem_bf16_18
        %iter_8663 = cute.get_iter(%view_8645) : !memref_rmem_bf16_10
        %lay_8664 = cute.get_layout(%view_8631) : !memref_smem_bf16_18
        %lay_8665 = cute.get_layout(%view_8645) : !memref_rmem_bf16_10
        %append_8666 = cute.append_to_rank<2> (%lay_8664, %2605) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8667 = cute.append_to_rank<2> (%lay_8665, %2605) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8668 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8669 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8670 = cute.size(%lay_8668) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2606 = cute.get_scalars(%sz_8670) : !cute.int_tuple<"4">
        %c0_i32_8671 = arith.constant 0 : i32
        %c1_i32_8672 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8671 to %2606 step %c1_i32_8672  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8668, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8668) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_8662, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8669, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8669) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8663, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8673 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8674 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8675 = cute.crd2idx(%coord_8673, %lay_8674) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"96">
        %iter_8676 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8677 = cute.add_offset(%iter_8676, %idx_8675) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8678 = cute.make_view(%ptr_8677) : !memref_rmem_bf16_12
        %iter_8679 = cute.get_iter(%view_8678) : !memref_rmem_bf16_12
        %coord_8680 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_8681 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8682 = cute.crd2idx(%coord_8680, %lay_8681) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"192">
        %iter_8683 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8684 = cute.add_offset(%iter_8683, %idx_8682) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"192">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8685 = cute.make_view(%ptr_8684) : !memref_rmem_bf16_13
        %iter_8686 = cute.get_iter(%view_8685) : !memref_rmem_bf16_13
        %lay_8687 = cute.get_layout(%view_8678) : !memref_rmem_bf16_12
        %2607 = cute.get_shape(%lay_8687) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8688, %e1_8689, %e2_8690, %e3_8691 = cute.get_leaves(%2607) : !cute.shape<"((2,2,2),2)">
        %lay_8692 = cute.get_layout(%view_8685) : !memref_rmem_bf16_13
        %2608 = cute.get_shape(%lay_8692) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8693, %e1_8694, %e2_8695 = cute.get_leaves(%2608) : !cute.shape<"((2,2),8)">
        %iter_8696 = cute.get_iter(%view_8678) : !memref_rmem_bf16_12
        %iter_8697 = cute.get_iter(%view_8685) : !memref_rmem_bf16_13
        %iter_8698 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_8699 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_8700 = cute.get_layout(%view_8678) : !memref_rmem_bf16_12
        %lay_8701 = cute.get_layout(%view_8685) : !memref_rmem_bf16_13
        %lay_8702 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_8703 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2609 = cute.static : !cute.layout<"1:0">
        %append_8704 = cute.append_to_rank<3> (%lay_8700, %2609) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8705 = cute.append_to_rank<3> (%lay_8701, %2609) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8706 = cute.size(%append_8704) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8707 = cute.size(%append_8704) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8708 = cute.size(%append_8705) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2610 = cute.get_scalars(%sz_8706) : !cute.int_tuple<"1">
        %2611 = cute.get_scalars(%sz_8707) : !cute.int_tuple<"2">
        %2612 = cute.get_scalars(%sz_8708) : !cute.int_tuple<"8">
        %c0_i32_8709 = arith.constant 0 : i32
        %c1_i32_8710 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8709 to %2610 step %c1_i32_8710  : i32 {
          scf.for %arg14 = %c0_i32_8709 to %2611 step %c1_i32_8710  : i32 {
            scf.for %arg15 = %c0_i32_8709 to %2612 step %c1_i32_8710  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_8704, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_8704) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_8696, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_8705, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_8705) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_8697, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_8702, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_8702) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_8698, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_8703, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_8703) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_8699, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8711 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8712 = cute.size(%int_tuple_8711) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8713 = cute.get_leaves(%sz_8712) : !cute.int_tuple<"8">
        %coord_8714 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8715 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_8716 = cute.crd2idx(%coord_8714, %lay_8715) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8717 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_8718 = cute.add_offset(%iter_8717, %idx_8716) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8719 = cute.make_view(%ptr_8718) : !memref_smem_bf16_14
        %iter_8720 = cute.get_iter(%view_8719) : !memref_smem_bf16_14
        %coord_8721 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8722 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8723 = cute.crd2idx(%coord_8721, %lay_8722) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"48">
        %iter_8724 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8725 = cute.add_offset(%iter_8724, %idx_8723) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8726 = cute.make_view(%ptr_8725) : !memref_rmem_bf16_6
        %iter_8727 = cute.get_iter(%view_8726) : !memref_rmem_bf16_6
        %lay_8728 = cute.get_layout(%view_8719) : !memref_smem_bf16_14
        %2613 = cute.get_shape(%lay_8728) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8729, %e1_8730, %e2_8731 = cute.get_leaves(%2613) : !cute.shape<"((8,1),2)">
        %lay_8732 = cute.get_layout(%view_8726) : !memref_rmem_bf16_6
        %2614 = cute.get_shape(%lay_8732) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8733, %e1_8734, %e2_8735 = cute.get_leaves(%2614) : !cute.shape<"((8,1),2)">
        %lay_8736 = cute.get_layout(%view_8719) : !memref_smem_bf16_14
        %shape_8737 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8738 = cute.make_layout() : !cute.layout<"1:0">
        %append_8739 = cute.append_to_rank<2> (%lay_8736, %lay_8738) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8740 = cute.make_view(%iter_8720, %append_8739) : !memref_smem_bf16_14
        %iter_8741 = cute.get_iter(%view_8740) : !memref_smem_bf16_14
        %lay_8742 = cute.get_layout(%view_8740) : !memref_smem_bf16_14
        %2615 = cute.get_shape(%lay_8742) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8743, %e1_8744, %e2_8745 = cute.get_leaves(%2615) : !cute.shape<"((8,1),2)">
        %iter_8746 = cute.get_iter(%view_8740) : !memref_smem_bf16_14
        %view_8747 = cute.make_view(%iter_8746) : !memref_smem_bf16_15
        %iter_8748 = cute.get_iter(%view_8747) : !memref_smem_bf16_15
        %iter_8749 = cute.get_iter(%view_8747) : !memref_smem_bf16_15
        %lay_8750 = cute.get_layout(%view_8726) : !memref_rmem_bf16_6
        %shape_8751 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8752 = cute.make_layout() : !cute.layout<"1:0">
        %append_8753 = cute.append_to_rank<2> (%lay_8750, %lay_8752) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8754 = cute.make_view(%iter_8727, %append_8753) : !memref_rmem_bf16_6
        %iter_8755 = cute.get_iter(%view_8754) : !memref_rmem_bf16_6
        %lay_8756 = cute.get_layout(%view_8754) : !memref_rmem_bf16_6
        %2616 = cute.get_shape(%lay_8756) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8757, %e1_8758, %e2_8759 = cute.get_leaves(%2616) : !cute.shape<"((8,1),2)">
        %iter_8760 = cute.get_iter(%view_8754) : !memref_rmem_bf16_6
        %view_8761 = cute.make_view(%iter_8760) : !memref_rmem_bf16_7
        %iter_8762 = cute.get_iter(%view_8761) : !memref_rmem_bf16_7
        %iter_8763 = cute.get_iter(%view_8761) : !memref_rmem_bf16_7
        %lay_8764 = cute.get_layout(%view_8747) : !memref_smem_bf16_15
        %2617 = cute.get_shape(%lay_8764) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8765, %e1_8766, %e2_8767 = cute.get_leaves(%2617) : !cute.shape<"((8,1),(2))">
        %lay_8768 = cute.get_layout(%view_8761) : !memref_rmem_bf16_7
        %2618 = cute.get_shape(%lay_8768) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8769, %e1_8770, %e2_8771 = cute.get_leaves(%2618) : !cute.shape<"((8,1),(2))">
        %lay_8772 = cute.get_layout(%view_8747) : !memref_smem_bf16_15
        %sz_8773 = cute.size(%lay_8772) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8774 = cute.get_leaves(%sz_8773) : !cute.int_tuple<"2">
        %lay_8775 = cute.get_layout(%view_8761) : !memref_rmem_bf16_7
        %sz_8776 = cute.size(%lay_8775) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8777 = cute.get_leaves(%sz_8776) : !cute.int_tuple<"2">
        %2619 = cute.static : !cute.layout<"1:0">
        %iter_8778 = cute.get_iter(%view_8747) : !memref_smem_bf16_15
        %iter_8779 = cute.get_iter(%view_8761) : !memref_rmem_bf16_7
        %lay_8780 = cute.get_layout(%view_8747) : !memref_smem_bf16_15
        %lay_8781 = cute.get_layout(%view_8761) : !memref_rmem_bf16_7
        %append_8782 = cute.append_to_rank<2> (%lay_8780, %2619) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8783 = cute.append_to_rank<2> (%lay_8781, %2619) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8784 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8785 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8786 = cute.size(%lay_8784) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2620 = cute.get_scalars(%sz_8786) : !cute.int_tuple<"2">
        %c0_i32_8787 = arith.constant 0 : i32
        %c1_i32_8788 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8787 to %2620 step %c1_i32_8788  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8784, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8784) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8778, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8785, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8785) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8779, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8789 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8790 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8791 = cute.crd2idx(%coord_8789, %lay_8790) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_8792 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8793 = cute.add_offset(%iter_8792, %idx_8791) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8794 = cute.make_view(%ptr_8793) : !memref_smem_bf16_17
        %iter_8795 = cute.get_iter(%view_8794) : !memref_smem_bf16_17
        %coord_8796 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_8797 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8798 = cute.crd2idx(%coord_8796, %lay_8797) : (!cute.coord<"(_,_,5)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"96">
        %iter_8799 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8800 = cute.add_offset(%iter_8799, %idx_8798) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8801 = cute.make_view(%ptr_8800) : !memref_rmem_bf16_9
        %iter_8802 = cute.get_iter(%view_8801) : !memref_rmem_bf16_9
        %lay_8803 = cute.get_layout(%view_8794) : !memref_smem_bf16_17
        %2621 = cute.get_shape(%lay_8803) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8804, %e1_8805, %e2_8806 = cute.get_leaves(%2621) : !cute.shape<"((8,1),4)">
        %lay_8807 = cute.get_layout(%view_8801) : !memref_rmem_bf16_9
        %2622 = cute.get_shape(%lay_8807) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8808, %e1_8809, %e2_8810 = cute.get_leaves(%2622) : !cute.shape<"((8,1),4)">
        %lay_8811 = cute.get_layout(%view_8794) : !memref_smem_bf16_17
        %shape_8812 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8813 = cute.make_layout() : !cute.layout<"1:0">
        %append_8814 = cute.append_to_rank<2> (%lay_8811, %lay_8813) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_8815 = cute.make_view(%iter_8795, %append_8814) : !memref_smem_bf16_17
        %iter_8816 = cute.get_iter(%view_8815) : !memref_smem_bf16_17
        %lay_8817 = cute.get_layout(%view_8815) : !memref_smem_bf16_17
        %2623 = cute.get_shape(%lay_8817) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8818, %e1_8819, %e2_8820 = cute.get_leaves(%2623) : !cute.shape<"((8,1),4)">
        %iter_8821 = cute.get_iter(%view_8815) : !memref_smem_bf16_17
        %view_8822 = cute.make_view(%iter_8821) : !memref_smem_bf16_18
        %iter_8823 = cute.get_iter(%view_8822) : !memref_smem_bf16_18
        %iter_8824 = cute.get_iter(%view_8822) : !memref_smem_bf16_18
        %lay_8825 = cute.get_layout(%view_8801) : !memref_rmem_bf16_9
        %shape_8826 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8827 = cute.make_layout() : !cute.layout<"1:0">
        %append_8828 = cute.append_to_rank<2> (%lay_8825, %lay_8827) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_8829 = cute.make_view(%iter_8802, %append_8828) : !memref_rmem_bf16_9
        %iter_8830 = cute.get_iter(%view_8829) : !memref_rmem_bf16_9
        %lay_8831 = cute.get_layout(%view_8829) : !memref_rmem_bf16_9
        %2624 = cute.get_shape(%lay_8831) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8832, %e1_8833, %e2_8834 = cute.get_leaves(%2624) : !cute.shape<"((8,1),4)">
        %iter_8835 = cute.get_iter(%view_8829) : !memref_rmem_bf16_9
        %view_8836 = cute.make_view(%iter_8835) : !memref_rmem_bf16_10
        %iter_8837 = cute.get_iter(%view_8836) : !memref_rmem_bf16_10
        %iter_8838 = cute.get_iter(%view_8836) : !memref_rmem_bf16_10
        %lay_8839 = cute.get_layout(%view_8822) : !memref_smem_bf16_18
        %2625 = cute.get_shape(%lay_8839) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_8840, %e1_8841, %e2_8842 = cute.get_leaves(%2625) : !cute.shape<"((8,1),(4))">
        %lay_8843 = cute.get_layout(%view_8836) : !memref_rmem_bf16_10
        %2626 = cute.get_shape(%lay_8843) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_8844, %e1_8845, %e2_8846 = cute.get_leaves(%2626) : !cute.shape<"((8,1),(4))">
        %lay_8847 = cute.get_layout(%view_8822) : !memref_smem_bf16_18
        %sz_8848 = cute.size(%lay_8847) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_8849 = cute.get_leaves(%sz_8848) : !cute.int_tuple<"4">
        %lay_8850 = cute.get_layout(%view_8836) : !memref_rmem_bf16_10
        %sz_8851 = cute.size(%lay_8850) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_8852 = cute.get_leaves(%sz_8851) : !cute.int_tuple<"4">
        %2627 = cute.static : !cute.layout<"1:0">
        %iter_8853 = cute.get_iter(%view_8822) : !memref_smem_bf16_18
        %iter_8854 = cute.get_iter(%view_8836) : !memref_rmem_bf16_10
        %lay_8855 = cute.get_layout(%view_8822) : !memref_smem_bf16_18
        %lay_8856 = cute.get_layout(%view_8836) : !memref_rmem_bf16_10
        %append_8857 = cute.append_to_rank<2> (%lay_8855, %2627) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_8858 = cute.append_to_rank<2> (%lay_8856, %2627) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8859 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_8860 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_8861 = cute.size(%lay_8859) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2628 = cute.get_scalars(%sz_8861) : !cute.int_tuple<"4">
        %c0_i32_8862 = arith.constant 0 : i32
        %c1_i32_8863 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8862 to %2628 step %c1_i32_8863  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8859, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8859) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_8853, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8860, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8860) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8854, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8864 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8865 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_8866 = cute.crd2idx(%coord_8864, %lay_8865) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"16">
        %iter_8867 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_8868 = cute.add_offset(%iter_8867, %idx_8866) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8869 = cute.make_view(%ptr_8868) : !memref_rmem_bf16_12
        %iter_8870 = cute.get_iter(%view_8869) : !memref_rmem_bf16_12
        %coord_8871 = cute.make_coord() : () -> !cute.coord<"(_,_,4)">
        %lay_8872 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_8873 = cute.crd2idx(%coord_8871, %lay_8872) : (!cute.coord<"(_,_,4)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"32">
        %iter_8874 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_8875 = cute.add_offset(%iter_8874, %idx_8873) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8876 = cute.make_view(%ptr_8875) : !memref_rmem_bf16_13
        %iter_8877 = cute.get_iter(%view_8876) : !memref_rmem_bf16_13
        %lay_8878 = cute.get_layout(%view_8869) : !memref_rmem_bf16_12
        %2629 = cute.get_shape(%lay_8878) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_8879, %e1_8880, %e2_8881, %e3_8882 = cute.get_leaves(%2629) : !cute.shape<"((2,2,2),2)">
        %lay_8883 = cute.get_layout(%view_8876) : !memref_rmem_bf16_13
        %2630 = cute.get_shape(%lay_8883) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_8884, %e1_8885, %e2_8886 = cute.get_leaves(%2630) : !cute.shape<"((2,2),8)">
        %iter_8887 = cute.get_iter(%view_8869) : !memref_rmem_bf16_12
        %iter_8888 = cute.get_iter(%view_8876) : !memref_rmem_bf16_13
        %iter_8889 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_8890 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_8891 = cute.get_layout(%view_8869) : !memref_rmem_bf16_12
        %lay_8892 = cute.get_layout(%view_8876) : !memref_rmem_bf16_13
        %lay_8893 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_8894 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2631 = cute.static : !cute.layout<"1:0">
        %append_8895 = cute.append_to_rank<3> (%lay_8891, %2631) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_8896 = cute.append_to_rank<3> (%lay_8892, %2631) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_8897 = cute.size(%append_8895) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_8898 = cute.size(%append_8895) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_8899 = cute.size(%append_8896) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2632 = cute.get_scalars(%sz_8897) : !cute.int_tuple<"1">
        %2633 = cute.get_scalars(%sz_8898) : !cute.int_tuple<"2">
        %2634 = cute.get_scalars(%sz_8899) : !cute.int_tuple<"8">
        %c0_i32_8900 = arith.constant 0 : i32
        %c1_i32_8901 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8900 to %2632 step %c1_i32_8901  : i32 {
          scf.for %arg14 = %c0_i32_8900 to %2633 step %c1_i32_8901  : i32 {
            scf.for %arg15 = %c0_i32_8900 to %2634 step %c1_i32_8901  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_8895, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_8895) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_8887, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_8896, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_8896) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_8888, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_8893, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_8893) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_8889, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_8894, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_8894) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_8890, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_8902 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_8903 = cute.size(%int_tuple_8902) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_8904 = cute.get_leaves(%sz_8903) : !cute.int_tuple<"8">
        %coord_8905 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_8906 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_8907 = cute.crd2idx(%coord_8905, %lay_8906) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8908 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_8909 = cute.add_offset(%iter_8908, %idx_8907) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8910 = cute.make_view(%ptr_8909) : !memref_smem_bf16_14
        %iter_8911 = cute.get_iter(%view_8910) : !memref_smem_bf16_14
        %coord_8912 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_8913 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_8914 = cute.crd2idx(%coord_8912, %lay_8913) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"80">
        %iter_8915 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_8916 = cute.add_offset(%iter_8915, %idx_8914) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_8917 = cute.make_view(%ptr_8916) : !memref_rmem_bf16_6
        %iter_8918 = cute.get_iter(%view_8917) : !memref_rmem_bf16_6
        %lay_8919 = cute.get_layout(%view_8910) : !memref_smem_bf16_14
        %2635 = cute.get_shape(%lay_8919) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8920, %e1_8921, %e2_8922 = cute.get_leaves(%2635) : !cute.shape<"((8,1),2)">
        %lay_8923 = cute.get_layout(%view_8917) : !memref_rmem_bf16_6
        %2636 = cute.get_shape(%lay_8923) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8924, %e1_8925, %e2_8926 = cute.get_leaves(%2636) : !cute.shape<"((8,1),2)">
        %lay_8927 = cute.get_layout(%view_8910) : !memref_smem_bf16_14
        %shape_8928 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8929 = cute.make_layout() : !cute.layout<"1:0">
        %append_8930 = cute.append_to_rank<2> (%lay_8927, %lay_8929) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_8931 = cute.make_view(%iter_8911, %append_8930) : !memref_smem_bf16_14
        %iter_8932 = cute.get_iter(%view_8931) : !memref_smem_bf16_14
        %lay_8933 = cute.get_layout(%view_8931) : !memref_smem_bf16_14
        %2637 = cute.get_shape(%lay_8933) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_8934, %e1_8935, %e2_8936 = cute.get_leaves(%2637) : !cute.shape<"((8,1),2)">
        %iter_8937 = cute.get_iter(%view_8931) : !memref_smem_bf16_14
        %view_8938 = cute.make_view(%iter_8937) : !memref_smem_bf16_15
        %iter_8939 = cute.get_iter(%view_8938) : !memref_smem_bf16_15
        %iter_8940 = cute.get_iter(%view_8938) : !memref_smem_bf16_15
        %lay_8941 = cute.get_layout(%view_8917) : !memref_rmem_bf16_6
        %shape_8942 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_8943 = cute.make_layout() : !cute.layout<"1:0">
        %append_8944 = cute.append_to_rank<2> (%lay_8941, %lay_8943) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_8945 = cute.make_view(%iter_8918, %append_8944) : !memref_rmem_bf16_6
        %iter_8946 = cute.get_iter(%view_8945) : !memref_rmem_bf16_6
        %lay_8947 = cute.get_layout(%view_8945) : !memref_rmem_bf16_6
        %2638 = cute.get_shape(%lay_8947) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_8948, %e1_8949, %e2_8950 = cute.get_leaves(%2638) : !cute.shape<"((8,1),2)">
        %iter_8951 = cute.get_iter(%view_8945) : !memref_rmem_bf16_6
        %view_8952 = cute.make_view(%iter_8951) : !memref_rmem_bf16_7
        %iter_8953 = cute.get_iter(%view_8952) : !memref_rmem_bf16_7
        %iter_8954 = cute.get_iter(%view_8952) : !memref_rmem_bf16_7
        %lay_8955 = cute.get_layout(%view_8938) : !memref_smem_bf16_15
        %2639 = cute.get_shape(%lay_8955) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_8956, %e1_8957, %e2_8958 = cute.get_leaves(%2639) : !cute.shape<"((8,1),(2))">
        %lay_8959 = cute.get_layout(%view_8952) : !memref_rmem_bf16_7
        %2640 = cute.get_shape(%lay_8959) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_8960, %e1_8961, %e2_8962 = cute.get_leaves(%2640) : !cute.shape<"((8,1),(2))">
        %lay_8963 = cute.get_layout(%view_8938) : !memref_smem_bf16_15
        %sz_8964 = cute.size(%lay_8963) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_8965 = cute.get_leaves(%sz_8964) : !cute.int_tuple<"2">
        %lay_8966 = cute.get_layout(%view_8952) : !memref_rmem_bf16_7
        %sz_8967 = cute.size(%lay_8966) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_8968 = cute.get_leaves(%sz_8967) : !cute.int_tuple<"2">
        %2641 = cute.static : !cute.layout<"1:0">
        %iter_8969 = cute.get_iter(%view_8938) : !memref_smem_bf16_15
        %iter_8970 = cute.get_iter(%view_8952) : !memref_rmem_bf16_7
        %lay_8971 = cute.get_layout(%view_8938) : !memref_smem_bf16_15
        %lay_8972 = cute.get_layout(%view_8952) : !memref_rmem_bf16_7
        %append_8973 = cute.append_to_rank<2> (%lay_8971, %2641) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_8974 = cute.append_to_rank<2> (%lay_8972, %2641) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_8975 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_8976 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_8977 = cute.size(%lay_8975) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2642 = cute.get_scalars(%sz_8977) : !cute.int_tuple<"2">
        %c0_i32_8978 = arith.constant 0 : i32
        %c1_i32_8979 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_8978 to %2642 step %c1_i32_8979  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_8975, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_8975) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_8969, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_8976, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_8976) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_8970, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_8980 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_8981 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_8982 = cute.crd2idx(%coord_8980, %lay_8981) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=32}">
        %iter_8983 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_8984 = cute.add_offset(%iter_8983, %idx_8982) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=32}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_8985 = cute.make_view(%ptr_8984) : !memref_smem_bf16_17
        %iter_8986 = cute.get_iter(%view_8985) : !memref_smem_bf16_17
        %coord_8987 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_8988 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_8989 = cute.crd2idx(%coord_8987, %lay_8988) : (!cute.coord<"(_,_,6)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"160">
        %iter_8990 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_8991 = cute.add_offset(%iter_8990, %idx_8989) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_8992 = cute.make_view(%ptr_8991) : !memref_rmem_bf16_9
        %iter_8993 = cute.get_iter(%view_8992) : !memref_rmem_bf16_9
        %lay_8994 = cute.get_layout(%view_8985) : !memref_smem_bf16_17
        %2643 = cute.get_shape(%lay_8994) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_8995, %e1_8996, %e2_8997 = cute.get_leaves(%2643) : !cute.shape<"((8,1),4)">
        %lay_8998 = cute.get_layout(%view_8992) : !memref_rmem_bf16_9
        %2644 = cute.get_shape(%lay_8998) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_8999, %e1_9000, %e2_9001 = cute.get_leaves(%2644) : !cute.shape<"((8,1),4)">
        %lay_9002 = cute.get_layout(%view_8985) : !memref_smem_bf16_17
        %shape_9003 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9004 = cute.make_layout() : !cute.layout<"1:0">
        %append_9005 = cute.append_to_rank<2> (%lay_9002, %lay_9004) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9006 = cute.make_view(%iter_8986, %append_9005) : !memref_smem_bf16_17
        %iter_9007 = cute.get_iter(%view_9006) : !memref_smem_bf16_17
        %lay_9008 = cute.get_layout(%view_9006) : !memref_smem_bf16_17
        %2645 = cute.get_shape(%lay_9008) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9009, %e1_9010, %e2_9011 = cute.get_leaves(%2645) : !cute.shape<"((8,1),4)">
        %iter_9012 = cute.get_iter(%view_9006) : !memref_smem_bf16_17
        %view_9013 = cute.make_view(%iter_9012) : !memref_smem_bf16_18
        %iter_9014 = cute.get_iter(%view_9013) : !memref_smem_bf16_18
        %iter_9015 = cute.get_iter(%view_9013) : !memref_smem_bf16_18
        %lay_9016 = cute.get_layout(%view_8992) : !memref_rmem_bf16_9
        %shape_9017 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9018 = cute.make_layout() : !cute.layout<"1:0">
        %append_9019 = cute.append_to_rank<2> (%lay_9016, %lay_9018) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9020 = cute.make_view(%iter_8993, %append_9019) : !memref_rmem_bf16_9
        %iter_9021 = cute.get_iter(%view_9020) : !memref_rmem_bf16_9
        %lay_9022 = cute.get_layout(%view_9020) : !memref_rmem_bf16_9
        %2646 = cute.get_shape(%lay_9022) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9023, %e1_9024, %e2_9025 = cute.get_leaves(%2646) : !cute.shape<"((8,1),4)">
        %iter_9026 = cute.get_iter(%view_9020) : !memref_rmem_bf16_9
        %view_9027 = cute.make_view(%iter_9026) : !memref_rmem_bf16_10
        %iter_9028 = cute.get_iter(%view_9027) : !memref_rmem_bf16_10
        %iter_9029 = cute.get_iter(%view_9027) : !memref_rmem_bf16_10
        %lay_9030 = cute.get_layout(%view_9013) : !memref_smem_bf16_18
        %2647 = cute.get_shape(%lay_9030) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9031, %e1_9032, %e2_9033 = cute.get_leaves(%2647) : !cute.shape<"((8,1),(4))">
        %lay_9034 = cute.get_layout(%view_9027) : !memref_rmem_bf16_10
        %2648 = cute.get_shape(%lay_9034) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9035, %e1_9036, %e2_9037 = cute.get_leaves(%2648) : !cute.shape<"((8,1),(4))">
        %lay_9038 = cute.get_layout(%view_9013) : !memref_smem_bf16_18
        %sz_9039 = cute.size(%lay_9038) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9040 = cute.get_leaves(%sz_9039) : !cute.int_tuple<"4">
        %lay_9041 = cute.get_layout(%view_9027) : !memref_rmem_bf16_10
        %sz_9042 = cute.size(%lay_9041) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9043 = cute.get_leaves(%sz_9042) : !cute.int_tuple<"4">
        %2649 = cute.static : !cute.layout<"1:0">
        %iter_9044 = cute.get_iter(%view_9013) : !memref_smem_bf16_18
        %iter_9045 = cute.get_iter(%view_9027) : !memref_rmem_bf16_10
        %lay_9046 = cute.get_layout(%view_9013) : !memref_smem_bf16_18
        %lay_9047 = cute.get_layout(%view_9027) : !memref_rmem_bf16_10
        %append_9048 = cute.append_to_rank<2> (%lay_9046, %2649) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9049 = cute.append_to_rank<2> (%lay_9047, %2649) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9050 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9051 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9052 = cute.size(%lay_9050) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2650 = cute.get_scalars(%sz_9052) : !cute.int_tuple<"4">
        %c0_i32_9053 = arith.constant 0 : i32
        %c1_i32_9054 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9053 to %2650 step %c1_i32_9054  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9050, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9050) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_9044, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_9051, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9051) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9045, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9055 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9056 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9057 = cute.crd2idx(%coord_9055, %lay_9056) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"48">
        %iter_9058 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9059 = cute.add_offset(%iter_9058, %idx_9057) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9060 = cute.make_view(%ptr_9059) : !memref_rmem_bf16_12
        %iter_9061 = cute.get_iter(%view_9060) : !memref_rmem_bf16_12
        %coord_9062 = cute.make_coord() : () -> !cute.coord<"(_,_,5)">
        %lay_9063 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9064 = cute.crd2idx(%coord_9062, %lay_9063) : (!cute.coord<"(_,_,5)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"96">
        %iter_9065 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9066 = cute.add_offset(%iter_9065, %idx_9064) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9067 = cute.make_view(%ptr_9066) : !memref_rmem_bf16_13
        %iter_9068 = cute.get_iter(%view_9067) : !memref_rmem_bf16_13
        %lay_9069 = cute.get_layout(%view_9060) : !memref_rmem_bf16_12
        %2651 = cute.get_shape(%lay_9069) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9070, %e1_9071, %e2_9072, %e3_9073 = cute.get_leaves(%2651) : !cute.shape<"((2,2,2),2)">
        %lay_9074 = cute.get_layout(%view_9067) : !memref_rmem_bf16_13
        %2652 = cute.get_shape(%lay_9074) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9075, %e1_9076, %e2_9077 = cute.get_leaves(%2652) : !cute.shape<"((2,2),8)">
        %iter_9078 = cute.get_iter(%view_9060) : !memref_rmem_bf16_12
        %iter_9079 = cute.get_iter(%view_9067) : !memref_rmem_bf16_13
        %iter_9080 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_9081 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_9082 = cute.get_layout(%view_9060) : !memref_rmem_bf16_12
        %lay_9083 = cute.get_layout(%view_9067) : !memref_rmem_bf16_13
        %lay_9084 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_9085 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2653 = cute.static : !cute.layout<"1:0">
        %append_9086 = cute.append_to_rank<3> (%lay_9082, %2653) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9087 = cute.append_to_rank<3> (%lay_9083, %2653) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9088 = cute.size(%append_9086) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9089 = cute.size(%append_9086) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9090 = cute.size(%append_9087) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2654 = cute.get_scalars(%sz_9088) : !cute.int_tuple<"1">
        %2655 = cute.get_scalars(%sz_9089) : !cute.int_tuple<"2">
        %2656 = cute.get_scalars(%sz_9090) : !cute.int_tuple<"8">
        %c0_i32_9091 = arith.constant 0 : i32
        %c1_i32_9092 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9091 to %2654 step %c1_i32_9092  : i32 {
          scf.for %arg14 = %c0_i32_9091 to %2655 step %c1_i32_9092  : i32 {
            scf.for %arg15 = %c0_i32_9091 to %2656 step %c1_i32_9092  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_9086, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_9086) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_9078, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_9087, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_9087) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_9079, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_9084, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_9084) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_9080, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_9085, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_9085) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_9081, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9093 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9094 = cute.size(%int_tuple_9093) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9095 = cute.get_leaves(%sz_9094) : !cute.int_tuple<"8">
        %coord_9096 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9097 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_9098 = cute.crd2idx(%coord_9096, %lay_9097) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9099 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_9100 = cute.add_offset(%iter_9099, %idx_9098) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9101 = cute.make_view(%ptr_9100) : !memref_smem_bf16_14
        %iter_9102 = cute.get_iter(%view_9101) : !memref_smem_bf16_14
        %coord_9103 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9104 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_9105 = cute.crd2idx(%coord_9103, %lay_9104) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"112">
        %iter_9106 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_9107 = cute.add_offset(%iter_9106, %idx_9105) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9108 = cute.make_view(%ptr_9107) : !memref_rmem_bf16_6
        %iter_9109 = cute.get_iter(%view_9108) : !memref_rmem_bf16_6
        %lay_9110 = cute.get_layout(%view_9101) : !memref_smem_bf16_14
        %2657 = cute.get_shape(%lay_9110) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9111, %e1_9112, %e2_9113 = cute.get_leaves(%2657) : !cute.shape<"((8,1),2)">
        %lay_9114 = cute.get_layout(%view_9108) : !memref_rmem_bf16_6
        %2658 = cute.get_shape(%lay_9114) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9115, %e1_9116, %e2_9117 = cute.get_leaves(%2658) : !cute.shape<"((8,1),2)">
        %lay_9118 = cute.get_layout(%view_9101) : !memref_smem_bf16_14
        %shape_9119 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9120 = cute.make_layout() : !cute.layout<"1:0">
        %append_9121 = cute.append_to_rank<2> (%lay_9118, %lay_9120) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9122 = cute.make_view(%iter_9102, %append_9121) : !memref_smem_bf16_14
        %iter_9123 = cute.get_iter(%view_9122) : !memref_smem_bf16_14
        %lay_9124 = cute.get_layout(%view_9122) : !memref_smem_bf16_14
        %2659 = cute.get_shape(%lay_9124) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9125, %e1_9126, %e2_9127 = cute.get_leaves(%2659) : !cute.shape<"((8,1),2)">
        %iter_9128 = cute.get_iter(%view_9122) : !memref_smem_bf16_14
        %view_9129 = cute.make_view(%iter_9128) : !memref_smem_bf16_15
        %iter_9130 = cute.get_iter(%view_9129) : !memref_smem_bf16_15
        %iter_9131 = cute.get_iter(%view_9129) : !memref_smem_bf16_15
        %lay_9132 = cute.get_layout(%view_9108) : !memref_rmem_bf16_6
        %shape_9133 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9134 = cute.make_layout() : !cute.layout<"1:0">
        %append_9135 = cute.append_to_rank<2> (%lay_9132, %lay_9134) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9136 = cute.make_view(%iter_9109, %append_9135) : !memref_rmem_bf16_6
        %iter_9137 = cute.get_iter(%view_9136) : !memref_rmem_bf16_6
        %lay_9138 = cute.get_layout(%view_9136) : !memref_rmem_bf16_6
        %2660 = cute.get_shape(%lay_9138) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9139, %e1_9140, %e2_9141 = cute.get_leaves(%2660) : !cute.shape<"((8,1),2)">
        %iter_9142 = cute.get_iter(%view_9136) : !memref_rmem_bf16_6
        %view_9143 = cute.make_view(%iter_9142) : !memref_rmem_bf16_7
        %iter_9144 = cute.get_iter(%view_9143) : !memref_rmem_bf16_7
        %iter_9145 = cute.get_iter(%view_9143) : !memref_rmem_bf16_7
        %lay_9146 = cute.get_layout(%view_9129) : !memref_smem_bf16_15
        %2661 = cute.get_shape(%lay_9146) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9147, %e1_9148, %e2_9149 = cute.get_leaves(%2661) : !cute.shape<"((8,1),(2))">
        %lay_9150 = cute.get_layout(%view_9143) : !memref_rmem_bf16_7
        %2662 = cute.get_shape(%lay_9150) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9151, %e1_9152, %e2_9153 = cute.get_leaves(%2662) : !cute.shape<"((8,1),(2))">
        %lay_9154 = cute.get_layout(%view_9129) : !memref_smem_bf16_15
        %sz_9155 = cute.size(%lay_9154) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9156 = cute.get_leaves(%sz_9155) : !cute.int_tuple<"2">
        %lay_9157 = cute.get_layout(%view_9143) : !memref_rmem_bf16_7
        %sz_9158 = cute.size(%lay_9157) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9159 = cute.get_leaves(%sz_9158) : !cute.int_tuple<"2">
        %2663 = cute.static : !cute.layout<"1:0">
        %iter_9160 = cute.get_iter(%view_9129) : !memref_smem_bf16_15
        %iter_9161 = cute.get_iter(%view_9143) : !memref_rmem_bf16_7
        %lay_9162 = cute.get_layout(%view_9129) : !memref_smem_bf16_15
        %lay_9163 = cute.get_layout(%view_9143) : !memref_rmem_bf16_7
        %append_9164 = cute.append_to_rank<2> (%lay_9162, %2663) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9165 = cute.append_to_rank<2> (%lay_9163, %2663) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9166 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9167 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9168 = cute.size(%lay_9166) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2664 = cute.get_scalars(%sz_9168) : !cute.int_tuple<"2">
        %c0_i32_9169 = arith.constant 0 : i32
        %c1_i32_9170 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9169 to %2664 step %c1_i32_9170  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9166, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9166) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_9160, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_9167, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9167) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9161, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9171 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9172 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_9173 = cute.crd2idx(%coord_9171, %lay_9172) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"?{div=16}">
        %iter_9174 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_9175 = cute.add_offset(%iter_9174, %idx_9173) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9176 = cute.make_view(%ptr_9175) : !memref_smem_bf16_17
        %iter_9177 = cute.get_iter(%view_9176) : !memref_smem_bf16_17
        %coord_9178 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9179 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_9180 = cute.crd2idx(%coord_9178, %lay_9179) : (!cute.coord<"(_,_,7)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"224">
        %iter_9181 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_9182 = cute.add_offset(%iter_9181, %idx_9180) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9183 = cute.make_view(%ptr_9182) : !memref_rmem_bf16_9
        %iter_9184 = cute.get_iter(%view_9183) : !memref_rmem_bf16_9
        %lay_9185 = cute.get_layout(%view_9176) : !memref_smem_bf16_17
        %2665 = cute.get_shape(%lay_9185) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9186, %e1_9187, %e2_9188 = cute.get_leaves(%2665) : !cute.shape<"((8,1),4)">
        %lay_9189 = cute.get_layout(%view_9183) : !memref_rmem_bf16_9
        %2666 = cute.get_shape(%lay_9189) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9190, %e1_9191, %e2_9192 = cute.get_leaves(%2666) : !cute.shape<"((8,1),4)">
        %lay_9193 = cute.get_layout(%view_9176) : !memref_smem_bf16_17
        %shape_9194 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9195 = cute.make_layout() : !cute.layout<"1:0">
        %append_9196 = cute.append_to_rank<2> (%lay_9193, %lay_9195) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9197 = cute.make_view(%iter_9177, %append_9196) : !memref_smem_bf16_17
        %iter_9198 = cute.get_iter(%view_9197) : !memref_smem_bf16_17
        %lay_9199 = cute.get_layout(%view_9197) : !memref_smem_bf16_17
        %2667 = cute.get_shape(%lay_9199) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9200, %e1_9201, %e2_9202 = cute.get_leaves(%2667) : !cute.shape<"((8,1),4)">
        %iter_9203 = cute.get_iter(%view_9197) : !memref_smem_bf16_17
        %view_9204 = cute.make_view(%iter_9203) : !memref_smem_bf16_18
        %iter_9205 = cute.get_iter(%view_9204) : !memref_smem_bf16_18
        %iter_9206 = cute.get_iter(%view_9204) : !memref_smem_bf16_18
        %lay_9207 = cute.get_layout(%view_9183) : !memref_rmem_bf16_9
        %shape_9208 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9209 = cute.make_layout() : !cute.layout<"1:0">
        %append_9210 = cute.append_to_rank<2> (%lay_9207, %lay_9209) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9211 = cute.make_view(%iter_9184, %append_9210) : !memref_rmem_bf16_9
        %iter_9212 = cute.get_iter(%view_9211) : !memref_rmem_bf16_9
        %lay_9213 = cute.get_layout(%view_9211) : !memref_rmem_bf16_9
        %2668 = cute.get_shape(%lay_9213) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9214, %e1_9215, %e2_9216 = cute.get_leaves(%2668) : !cute.shape<"((8,1),4)">
        %iter_9217 = cute.get_iter(%view_9211) : !memref_rmem_bf16_9
        %view_9218 = cute.make_view(%iter_9217) : !memref_rmem_bf16_10
        %iter_9219 = cute.get_iter(%view_9218) : !memref_rmem_bf16_10
        %iter_9220 = cute.get_iter(%view_9218) : !memref_rmem_bf16_10
        %lay_9221 = cute.get_layout(%view_9204) : !memref_smem_bf16_18
        %2669 = cute.get_shape(%lay_9221) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9222, %e1_9223, %e2_9224 = cute.get_leaves(%2669) : !cute.shape<"((8,1),(4))">
        %lay_9225 = cute.get_layout(%view_9218) : !memref_rmem_bf16_10
        %2670 = cute.get_shape(%lay_9225) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9226, %e1_9227, %e2_9228 = cute.get_leaves(%2670) : !cute.shape<"((8,1),(4))">
        %lay_9229 = cute.get_layout(%view_9204) : !memref_smem_bf16_18
        %sz_9230 = cute.size(%lay_9229) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9231 = cute.get_leaves(%sz_9230) : !cute.int_tuple<"4">
        %lay_9232 = cute.get_layout(%view_9218) : !memref_rmem_bf16_10
        %sz_9233 = cute.size(%lay_9232) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9234 = cute.get_leaves(%sz_9233) : !cute.int_tuple<"4">
        %2671 = cute.static : !cute.layout<"1:0">
        %iter_9235 = cute.get_iter(%view_9204) : !memref_smem_bf16_18
        %iter_9236 = cute.get_iter(%view_9218) : !memref_rmem_bf16_10
        %lay_9237 = cute.get_layout(%view_9204) : !memref_smem_bf16_18
        %lay_9238 = cute.get_layout(%view_9218) : !memref_rmem_bf16_10
        %append_9239 = cute.append_to_rank<2> (%lay_9237, %2671) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9240 = cute.append_to_rank<2> (%lay_9238, %2671) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9241 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9242 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9243 = cute.size(%lay_9241) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2672 = cute.get_scalars(%sz_9243) : !cute.int_tuple<"4">
        %c0_i32_9244 = arith.constant 0 : i32
        %c1_i32_9245 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9244 to %2672 step %c1_i32_9245  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9241, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9241) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_9235, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_9242, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9242) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9236, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9246 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9247 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9248 = cute.crd2idx(%coord_9246, %lay_9247) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"80">
        %iter_9249 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9250 = cute.add_offset(%iter_9249, %idx_9248) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9251 = cute.make_view(%ptr_9250) : !memref_rmem_bf16_12
        %iter_9252 = cute.get_iter(%view_9251) : !memref_rmem_bf16_12
        %coord_9253 = cute.make_coord() : () -> !cute.coord<"(_,_,6)">
        %lay_9254 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9255 = cute.crd2idx(%coord_9253, %lay_9254) : (!cute.coord<"(_,_,6)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"160">
        %iter_9256 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9257 = cute.add_offset(%iter_9256, %idx_9255) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"160">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9258 = cute.make_view(%ptr_9257) : !memref_rmem_bf16_13
        %iter_9259 = cute.get_iter(%view_9258) : !memref_rmem_bf16_13
        %lay_9260 = cute.get_layout(%view_9251) : !memref_rmem_bf16_12
        %2673 = cute.get_shape(%lay_9260) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9261, %e1_9262, %e2_9263, %e3_9264 = cute.get_leaves(%2673) : !cute.shape<"((2,2,2),2)">
        %lay_9265 = cute.get_layout(%view_9258) : !memref_rmem_bf16_13
        %2674 = cute.get_shape(%lay_9265) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9266, %e1_9267, %e2_9268 = cute.get_leaves(%2674) : !cute.shape<"((2,2),8)">
        %iter_9269 = cute.get_iter(%view_9251) : !memref_rmem_bf16_12
        %iter_9270 = cute.get_iter(%view_9258) : !memref_rmem_bf16_13
        %iter_9271 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_9272 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_9273 = cute.get_layout(%view_9251) : !memref_rmem_bf16_12
        %lay_9274 = cute.get_layout(%view_9258) : !memref_rmem_bf16_13
        %lay_9275 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_9276 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2675 = cute.static : !cute.layout<"1:0">
        %append_9277 = cute.append_to_rank<3> (%lay_9273, %2675) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9278 = cute.append_to_rank<3> (%lay_9274, %2675) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9279 = cute.size(%append_9277) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9280 = cute.size(%append_9277) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9281 = cute.size(%append_9278) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2676 = cute.get_scalars(%sz_9279) : !cute.int_tuple<"1">
        %2677 = cute.get_scalars(%sz_9280) : !cute.int_tuple<"2">
        %2678 = cute.get_scalars(%sz_9281) : !cute.int_tuple<"8">
        %c0_i32_9282 = arith.constant 0 : i32
        %c1_i32_9283 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9282 to %2676 step %c1_i32_9283  : i32 {
          scf.for %arg14 = %c0_i32_9282 to %2677 step %c1_i32_9283  : i32 {
            scf.for %arg15 = %c0_i32_9282 to %2678 step %c1_i32_9283  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_9277, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_9277) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_9269, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_9278, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_9278) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_9270, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_9275, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_9275) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_9271, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_9276, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_9276) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_9272, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_9284 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)">
        %sz_9285 = cute.size(%int_tuple_9284) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8">
        %e0_9286 = cute.get_leaves(%sz_9285) : !cute.int_tuple<"8">
        %coord_9287 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9288 = cute.get_layout(%src_partitioned_374) : !memref_smem_bf16_8
        %idx_9289 = cute.crd2idx(%coord_9287, %lay_9288) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.int_tuple<"0">
        %iter_9290 = cute.get_iter(%src_partitioned_374) : !memref_smem_bf16_8
        %ptr_9291 = cute.add_offset(%iter_9290, %idx_9289) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9292 = cute.make_view(%ptr_9291) : !memref_smem_bf16_14
        %iter_9293 = cute.get_iter(%view_9292) : !memref_smem_bf16_14
        %coord_9294 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9295 = cute.get_layout(%retiled) : !memref_rmem_bf16_3
        %idx_9296 = cute.crd2idx(%coord_9294, %lay_9295) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),2,(4,2)):((1,0),8,(32,16))">) -> !cute.int_tuple<"0">
        %iter_9297 = cute.get_iter(%retiled) : !memref_rmem_bf16_3
        %ptr_9298 = cute.add_offset(%iter_9297, %idx_9296) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9299 = cute.make_view(%ptr_9298) : !memref_rmem_bf16_6
        %iter_9300 = cute.get_iter(%view_9299) : !memref_rmem_bf16_6
        %lay_9301 = cute.get_layout(%view_9292) : !memref_smem_bf16_14
        %2679 = cute.get_shape(%lay_9301) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9302, %e1_9303, %e2_9304 = cute.get_leaves(%2679) : !cute.shape<"((8,1),2)">
        %lay_9305 = cute.get_layout(%view_9299) : !memref_rmem_bf16_6
        %2680 = cute.get_shape(%lay_9305) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9306, %e1_9307, %e2_9308 = cute.get_leaves(%2680) : !cute.shape<"((8,1),2)">
        %lay_9309 = cute.get_layout(%view_9292) : !memref_smem_bf16_14
        %shape_9310 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9311 = cute.make_layout() : !cute.layout<"1:0">
        %append_9312 = cute.append_to_rank<2> (%lay_9309, %lay_9311) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0">
        %view_9313 = cute.make_view(%iter_9293, %append_9312) : !memref_smem_bf16_14
        %iter_9314 = cute.get_iter(%view_9313) : !memref_smem_bf16_14
        %lay_9315 = cute.get_layout(%view_9313) : !memref_smem_bf16_14
        %2681 = cute.get_shape(%lay_9315) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)">
        %e0_9316, %e1_9317, %e2_9318 = cute.get_leaves(%2681) : !cute.shape<"((8,1),2)">
        %iter_9319 = cute.get_iter(%view_9313) : !memref_smem_bf16_14
        %view_9320 = cute.make_view(%iter_9319) : !memref_smem_bf16_15
        %iter_9321 = cute.get_iter(%view_9320) : !memref_smem_bf16_15
        %iter_9322 = cute.get_iter(%view_9320) : !memref_smem_bf16_15
        %lay_9323 = cute.get_layout(%view_9299) : !memref_rmem_bf16_6
        %shape_9324 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9325 = cute.make_layout() : !cute.layout<"1:0">
        %append_9326 = cute.append_to_rank<2> (%lay_9323, %lay_9325) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_9327 = cute.make_view(%iter_9300, %append_9326) : !memref_rmem_bf16_6
        %iter_9328 = cute.get_iter(%view_9327) : !memref_rmem_bf16_6
        %lay_9329 = cute.get_layout(%view_9327) : !memref_rmem_bf16_6
        %2682 = cute.get_shape(%lay_9329) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_9330, %e1_9331, %e2_9332 = cute.get_leaves(%2682) : !cute.shape<"((8,1),2)">
        %iter_9333 = cute.get_iter(%view_9327) : !memref_rmem_bf16_6
        %view_9334 = cute.make_view(%iter_9333) : !memref_rmem_bf16_7
        %iter_9335 = cute.get_iter(%view_9334) : !memref_rmem_bf16_7
        %iter_9336 = cute.get_iter(%view_9334) : !memref_rmem_bf16_7
        %lay_9337 = cute.get_layout(%view_9320) : !memref_smem_bf16_15
        %2683 = cute.get_shape(%lay_9337) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))">
        %e0_9338, %e1_9339, %e2_9340 = cute.get_leaves(%2683) : !cute.shape<"((8,1),(2))">
        %lay_9341 = cute.get_layout(%view_9334) : !memref_rmem_bf16_7
        %2684 = cute.get_shape(%lay_9341) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_9342, %e1_9343, %e2_9344 = cute.get_leaves(%2684) : !cute.shape<"((8,1),(2))">
        %lay_9345 = cute.get_layout(%view_9320) : !memref_smem_bf16_15
        %sz_9346 = cute.size(%lay_9345) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.int_tuple<"2">
        %e0_9347 = cute.get_leaves(%sz_9346) : !cute.int_tuple<"2">
        %lay_9348 = cute.get_layout(%view_9334) : !memref_rmem_bf16_7
        %sz_9349 = cute.size(%lay_9348) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_9350 = cute.get_leaves(%sz_9349) : !cute.int_tuple<"2">
        %2685 = cute.static : !cute.layout<"1:0">
        %iter_9351 = cute.get_iter(%view_9320) : !memref_smem_bf16_15
        %iter_9352 = cute.get_iter(%view_9334) : !memref_rmem_bf16_7
        %lay_9353 = cute.get_layout(%view_9320) : !memref_smem_bf16_15
        %lay_9354 = cute.get_layout(%view_9334) : !memref_rmem_bf16_7
        %append_9355 = cute.append_to_rank<2> (%lay_9353, %2685) : !cute.layout<"((8,1),(2)):((1,0),(4096))">, !cute.layout<"1:0">
        %append_9356 = cute.append_to_rank<2> (%lay_9354, %2685) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9357 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((4096)))">
        %lay_9358 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %sz_9359 = cute.size(%lay_9357) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"2">
        %2686 = cute.get_scalars(%sz_9359) : !cute.int_tuple<"2">
        %c0_i32_9360 = arith.constant 0 : i32
        %c1_i32_9361 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9360 to %2686 step %c1_i32_9361  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9357, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((4096)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9357) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((4096)))">) -> !cute.int_tuple<"?{div=4096}">
          %ptr_10572 = cute.add_offset(%iter_9351, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=4096}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_9358, %coord_10569) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9358) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9352, %idx_10575) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_8
          cute.copy_atom_call(%150, %view_10573, %view_10577) : (!copy_ldsm_4_, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9362 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9363 = cute.get_layout(%src_partitioned_378) : !memref_smem_bf16_9
        %idx_9364 = cute.crd2idx(%coord_9362, %lay_9363) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">) -> !cute.int_tuple<"0">
        %iter_9365 = cute.get_iter(%src_partitioned_378) : !memref_smem_bf16_9
        %ptr_9366 = cute.add_offset(%iter_9365, %idx_9364) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9367 = cute.make_view(%ptr_9366) : !memref_smem_bf16_17
        %iter_9368 = cute.get_iter(%view_9367) : !memref_smem_bf16_17
        %coord_9369 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9370 = cute.get_layout(%retiled_380) : !memref_rmem_bf16_4
        %idx_9371 = cute.crd2idx(%coord_9369, %lay_9370) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),4,(4,2)):((1,0),8,(64,32))">) -> !cute.int_tuple<"0">
        %iter_9372 = cute.get_iter(%retiled_380) : !memref_rmem_bf16_4
        %ptr_9373 = cute.add_offset(%iter_9372, %idx_9371) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9374 = cute.make_view(%ptr_9373) : !memref_rmem_bf16_9
        %iter_9375 = cute.get_iter(%view_9374) : !memref_rmem_bf16_9
        %lay_9376 = cute.get_layout(%view_9367) : !memref_smem_bf16_17
        %2687 = cute.get_shape(%lay_9376) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9377, %e1_9378, %e2_9379 = cute.get_leaves(%2687) : !cute.shape<"((8,1),4)">
        %lay_9380 = cute.get_layout(%view_9374) : !memref_rmem_bf16_9
        %2688 = cute.get_shape(%lay_9380) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9381, %e1_9382, %e2_9383 = cute.get_leaves(%2688) : !cute.shape<"((8,1),4)">
        %lay_9384 = cute.get_layout(%view_9367) : !memref_smem_bf16_17
        %shape_9385 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9386 = cute.make_layout() : !cute.layout<"1:0">
        %append_9387 = cute.append_to_rank<2> (%lay_9384, %lay_9386) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0">
        %view_9388 = cute.make_view(%iter_9368, %append_9387) : !memref_smem_bf16_17
        %iter_9389 = cute.get_iter(%view_9388) : !memref_smem_bf16_17
        %lay_9390 = cute.get_layout(%view_9388) : !memref_smem_bf16_17
        %2689 = cute.get_shape(%lay_9390) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)">
        %e0_9391, %e1_9392, %e2_9393 = cute.get_leaves(%2689) : !cute.shape<"((8,1),4)">
        %iter_9394 = cute.get_iter(%view_9388) : !memref_smem_bf16_17
        %view_9395 = cute.make_view(%iter_9394) : !memref_smem_bf16_18
        %iter_9396 = cute.get_iter(%view_9395) : !memref_smem_bf16_18
        %iter_9397 = cute.get_iter(%view_9395) : !memref_smem_bf16_18
        %lay_9398 = cute.get_layout(%view_9374) : !memref_rmem_bf16_9
        %shape_9399 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9400 = cute.make_layout() : !cute.layout<"1:0">
        %append_9401 = cute.append_to_rank<2> (%lay_9398, %lay_9400) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0">
        %view_9402 = cute.make_view(%iter_9375, %append_9401) : !memref_rmem_bf16_9
        %iter_9403 = cute.get_iter(%view_9402) : !memref_rmem_bf16_9
        %lay_9404 = cute.get_layout(%view_9402) : !memref_rmem_bf16_9
        %2690 = cute.get_shape(%lay_9404) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)">
        %e0_9405, %e1_9406, %e2_9407 = cute.get_leaves(%2690) : !cute.shape<"((8,1),4)">
        %iter_9408 = cute.get_iter(%view_9402) : !memref_rmem_bf16_9
        %view_9409 = cute.make_view(%iter_9408) : !memref_rmem_bf16_10
        %iter_9410 = cute.get_iter(%view_9409) : !memref_rmem_bf16_10
        %iter_9411 = cute.get_iter(%view_9409) : !memref_rmem_bf16_10
        %lay_9412 = cute.get_layout(%view_9395) : !memref_smem_bf16_18
        %2691 = cute.get_shape(%lay_9412) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))">
        %e0_9413, %e1_9414, %e2_9415 = cute.get_leaves(%2691) : !cute.shape<"((8,1),(4))">
        %lay_9416 = cute.get_layout(%view_9409) : !memref_rmem_bf16_10
        %2692 = cute.get_shape(%lay_9416) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))">
        %e0_9417, %e1_9418, %e2_9419 = cute.get_leaves(%2692) : !cute.shape<"((8,1),(4))">
        %lay_9420 = cute.get_layout(%view_9395) : !memref_smem_bf16_18
        %sz_9421 = cute.size(%lay_9420) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.int_tuple<"4">
        %e0_9422 = cute.get_leaves(%sz_9421) : !cute.int_tuple<"4">
        %lay_9423 = cute.get_layout(%view_9409) : !memref_rmem_bf16_10
        %sz_9424 = cute.size(%lay_9423) <{mode = [1]}> : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.int_tuple<"4">
        %e0_9425 = cute.get_leaves(%sz_9424) : !cute.int_tuple<"4">
        %2693 = cute.static : !cute.layout<"1:0">
        %iter_9426 = cute.get_iter(%view_9395) : !memref_smem_bf16_18
        %iter_9427 = cute.get_iter(%view_9409) : !memref_rmem_bf16_10
        %lay_9428 = cute.get_layout(%view_9395) : !memref_smem_bf16_18
        %lay_9429 = cute.get_layout(%view_9409) : !memref_rmem_bf16_10
        %append_9430 = cute.append_to_rank<2> (%lay_9428, %2693) : !cute.layout<"((8,1),(4)):((1,0),(1024))">, !cute.layout<"1:0">
        %append_9431 = cute.append_to_rank<2> (%lay_9429, %2693) : !cute.layout<"((8,1),(4)):((1,0),(8))">, !cute.layout<"1:0">
        %lay_9432 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((1024)))">
        %lay_9433 = cute.make_layout() : !cute.layout<"((8,1),((4))):((1,0),((8)))">
        %sz_9434 = cute.size(%lay_9432) <{mode = [1]}> : (!cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"4">
        %2694 = cute.get_scalars(%sz_9434) : !cute.int_tuple<"4">
        %c0_i32_9435 = arith.constant 0 : i32
        %c1_i32_9436 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9435 to %2694 step %c1_i32_9436  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9432, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((1024)))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9432) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((1024)))">) -> !cute.int_tuple<"?{div=1024}">
          %ptr_10572 = cute.add_offset(%iter_9426, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_9433, %coord_10569) : !cute.layout<"((8,1),((4))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9433) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9427, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%154, %view_10573, %view_10577) : (!copy_ldsm_4_1, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_9437 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9438 = cute.get_layout(%frg_A) : !memref_rmem_bf16_
        %idx_9439 = cute.crd2idx(%coord_9437, %lay_9438) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">) -> !cute.int_tuple<"112">
        %iter_9440 = cute.get_iter(%frg_A) : !memref_rmem_bf16_
        %ptr_9441 = cute.add_offset(%iter_9440, %idx_9439) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_9442 = cute.make_view(%ptr_9441) : !memref_rmem_bf16_12
        %iter_9443 = cute.get_iter(%view_9442) : !memref_rmem_bf16_12
        %coord_9444 = cute.make_coord() : () -> !cute.coord<"(_,_,7)">
        %lay_9445 = cute.get_layout(%frg_B) : !memref_rmem_bf16_1
        %idx_9446 = cute.crd2idx(%coord_9444, %lay_9445) : (!cute.coord<"(_,_,7)">, !cute.layout<"((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">) -> !cute.int_tuple<"224">
        %iter_9447 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1
        %ptr_9448 = cute.add_offset(%iter_9447, %idx_9446) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"224">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9449 = cute.make_view(%ptr_9448) : !memref_rmem_bf16_13
        %iter_9450 = cute.get_iter(%view_9449) : !memref_rmem_bf16_13
        %lay_9451 = cute.get_layout(%view_9442) : !memref_rmem_bf16_12
        %2695 = cute.get_shape(%lay_9451) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)">
        %e0_9452, %e1_9453, %e2_9454, %e3_9455 = cute.get_leaves(%2695) : !cute.shape<"((2,2,2),2)">
        %lay_9456 = cute.get_layout(%view_9449) : !memref_rmem_bf16_13
        %2696 = cute.get_shape(%lay_9456) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)">
        %e0_9457, %e1_9458, %e2_9459 = cute.get_leaves(%2696) : !cute.shape<"((2,2),8)">
        %iter_9460 = cute.get_iter(%view_9442) : !memref_rmem_bf16_12
        %iter_9461 = cute.get_iter(%view_9449) : !memref_rmem_bf16_13
        %iter_9462 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %iter_9463 = cute.get_iter(%rmem_7763) : !memref_rmem_f32_2
        %lay_9464 = cute.get_layout(%view_9442) : !memref_rmem_bf16_12
        %lay_9465 = cute.get_layout(%view_9449) : !memref_rmem_bf16_13
        %lay_9466 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_9467 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2697 = cute.static : !cute.layout<"1:0">
        %append_9468 = cute.append_to_rank<3> (%lay_9464, %2697) : !cute.layout<"((2,2,2),2):((1,2,4),8)">, !cute.layout<"1:0">
        %append_9469 = cute.append_to_rank<3> (%lay_9465, %2697) : !cute.layout<"((2,2),8):((1,2),4)">, !cute.layout<"1:0">
        %sz_9470 = cute.size(%append_9468) <{mode = [2]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"1">
        %sz_9471 = cute.size(%append_9468) <{mode = [1]}> : (!cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"2">
        %sz_9472 = cute.size(%append_9469) <{mode = [1]}> : (!cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"8">
        %2698 = cute.get_scalars(%sz_9470) : !cute.int_tuple<"1">
        %2699 = cute.get_scalars(%sz_9471) : !cute.int_tuple<"2">
        %2700 = cute.get_scalars(%sz_9472) : !cute.int_tuple<"8">
        %c0_i32_9473 = arith.constant 0 : i32
        %c1_i32_9474 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9473 to %2698 step %c1_i32_9474  : i32 {
          scf.for %arg14 = %c0_i32_9473 to %2699 step %c1_i32_9474  : i32 {
            scf.for %arg15 = %c0_i32_9473 to %2700 step %c1_i32_9474  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_9468, %coord_10569) : !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_9468) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2,2),2,1):((1,2,4),8,0)">) -> !cute.int_tuple<"?{div=8}">
              %ptr_10574 = cute.add_offset(%iter_9460, %idx_10573) : (!cute.ptr<bf16, rmem, align<16>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_14
              %slice_10576 = cute.slice(%append_9469, %coord_10570) : !cute.layout<"((2,2),8,1):((1,2),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_9469) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),8,1):((1,2),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_9461, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_9466, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_9466) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_9462, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_9467, %coord_10571) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_9467) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_9463, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_14, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        nvvm.cp.async.wait.group 0
        %c1_i32_9475 = arith.constant 1 : i32
        %c128_i32_9476 = arith.constant 128 : i32
        nvvm.barrier id = %c1_i32_9475 number_of_threads = %c128_i32_9476
        %c0_i32_9477 = arith.constant 0 : i32
        %2701 = arith.cmpi sgt, %2504, %c0_i32_9477 : i32
        scf.if %2701 {
          %c1_i32_10569 = arith.constant 1 : i32
          %2929 = arith.subi %2504, %c1_i32_10569 : i32
          %coord_10570 = cute.make_coord(%2929) : (i32) -> !cute.coord<"(_,_,_,?)">
          %lay_10571 = cute.get_layout(%src_partitioned_289) : !memref_gmem_bf16_5
          %slice_10572 = cute.slice(%lay_10571, %coord_10570) : !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">, !cute.coord<"(_,_,_,?)">
          %idx_10573 = cute.crd2idx(%coord_10570, %lay_10571) : (!cute.coord<"(_,_,_,?)">, !cute.layout<"((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">) -> !cute.int_tuple<"?{i64 div=512}">
          %iter_10574 = cute.get_iter(%src_partitioned_289) : !memref_gmem_bf16_5
          %ptr_10575 = cute.add_offset(%iter_10574, %idx_10573) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_10576 = cute.make_view(%ptr_10575, %slice_10572) : !memref_gmem_bf16_9
          %iter_10577 = cute.get_iter(%view_10576) : !memref_gmem_bf16_9
          %lay_10578 = cute.get_layout(%view_10576) : !memref_gmem_bf16_9
          %2930 = cute.get_shape(%lay_10578) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10579, %e1_10580, %e2_10581, %e3_10582 = cute.get_leaves(%2930) : !cute.shape<"((8,1),4,2)">
          %lay_10583 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
          %2931 = cute.get_shape(%lay_10583) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10584, %e1_10585, %e2_10586, %e3_10587 = cute.get_leaves(%2931) : !cute.shape<"((8,1),4,2)">
          %lay_10588 = cute.get_layout(%view_10576) : !memref_gmem_bf16_9
          %shape_10589 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10590 = cute.make_layout() : !cute.layout<"1:0">
          %append_10591 = cute.append_to_rank<2> (%lay_10588, %lay_10590) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0">
          %view_10592 = cute.make_view(%iter_10577, %append_10591) : !memref_gmem_bf16_9
          %iter_10593 = cute.get_iter(%view_10592) : !memref_gmem_bf16_9
          %lay_10594 = cute.get_layout(%view_10592) : !memref_gmem_bf16_9
          %2932 = cute.get_shape(%lay_10594) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10595, %e1_10596, %e2_10597, %e3_10598 = cute.get_leaves(%2932) : !cute.shape<"((8,1),4,2)">
          %iter_10599 = cute.get_iter(%view_10592) : !memref_gmem_bf16_9
          %lay_10600 = cute.get_layout(%view_10592) : !memref_gmem_bf16_9
          %2933 = cute.get_scalars(%lay_10600) <{only_dynamic}> : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">
          %shape_10601 = cute.make_shape() : () -> !cute.shape<"((8,1),(4,2))">
          %iv_10602 = cute.assume(%2933) : (i64) -> !cute.i64<divby 128>
          %stride_10603 = cute.make_stride(%iv_10602) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),(?{i64 div=128},64))">
          %lay_10604 = cute.make_layout(%shape_10601, %stride_10603) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %view_10605 = cute.make_view(%iter_10599, %lay_10604) : !memref_gmem_bf16_10
          %iter_10606 = cute.get_iter(%view_10605) : !memref_gmem_bf16_10
          %iter_10607 = cute.get_iter(%view_10605) : !memref_gmem_bf16_10
          %lay_10608 = cute.get_layout(%dst_partitioned_292) : !memref_smem_bf16_4
          %shape_10609 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10610 = cute.make_layout() : !cute.layout<"1:0">
          %append_10611 = cute.append_to_rank<2> (%lay_10608, %lay_10610) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0">
          %view_10612 = cute.make_view(%iter_293, %append_10611) : !memref_smem_bf16_4
          %iter_10613 = cute.get_iter(%view_10612) : !memref_smem_bf16_4
          %lay_10614 = cute.get_layout(%view_10612) : !memref_smem_bf16_4
          %2934 = cute.get_shape(%lay_10614) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)">
          %e0_10615, %e1_10616, %e2_10617, %e3_10618 = cute.get_leaves(%2934) : !cute.shape<"((8,1),4,2)">
          %iter_10619 = cute.get_iter(%view_10612) : !memref_smem_bf16_4
          %view_10620 = cute.make_view(%iter_10619) : !memref_smem_bf16_16
          %iter_10621 = cute.get_iter(%view_10620) : !memref_smem_bf16_16
          %iter_10622 = cute.get_iter(%view_10620) : !memref_smem_bf16_16
          %lay_10623 = cute.get_layout(%rmem_527) : !memref_rmem_i8_1
          %shape_10624 = cute.make_shape() : () -> !cute.shape<"1">
          %lay_10625 = cute.make_layout() : !cute.layout<"1:0">
          %append_10626 = cute.append_to_rank<2> (%lay_10623, %lay_10625) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0">
          %view_10627 = cute.make_view(%iter_529, %append_10626) : !memref_rmem_i8_1
          %iter_10628 = cute.get_iter(%view_10627) : !memref_rmem_i8_1
          %lay_10629 = cute.get_layout(%view_10627) : !memref_rmem_i8_1
          %2935 = cute.get_shape(%lay_10629) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)">
          %e0_10630, %e1_10631, %e2_10632 = cute.get_leaves(%2935) : !cute.shape<"(1,4,2)">
          %iter_10633 = cute.get_iter(%view_10627) : !memref_rmem_i8_1
          %view_10634 = cute.make_view(%iter_10633) : !memref_rmem_i8_5
          %iter_10635 = cute.get_iter(%view_10634) : !memref_rmem_i8_5
          %iter_10636 = cute.get_iter(%view_10634) : !memref_rmem_i8_5
          %lay_10637 = cute.get_layout(%view_10605) : !memref_gmem_bf16_10
          %2936 = cute.get_shape(%lay_10637) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10638, %e1_10639, %e2_10640, %e3_10641 = cute.get_leaves(%2936) : !cute.shape<"((8,1),(4,2))">
          %lay_10642 = cute.get_layout(%view_10620) : !memref_smem_bf16_16
          %2937 = cute.get_shape(%lay_10642) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))">
          %e0_10643, %e1_10644, %e2_10645, %e3_10646 = cute.get_leaves(%2937) : !cute.shape<"((8,1),(4,2))">
          %lay_10647 = cute.get_layout(%view_10605) : !memref_gmem_bf16_10
          %sz_10648 = cute.size(%lay_10647) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.int_tuple<"8">
          %e0_10649 = cute.get_leaves(%sz_10648) : !cute.int_tuple<"8">
          %lay_10650 = cute.get_layout(%view_10620) : !memref_smem_bf16_16
          %sz_10651 = cute.size(%lay_10650) <{mode = [1]}> : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.int_tuple<"8">
          %e0_10652 = cute.get_leaves(%sz_10651) : !cute.int_tuple<"8">
          %2938 = cute.static : !cute.layout<"1:0">
          %iter_10653 = cute.get_iter(%view_10605) : !memref_gmem_bf16_10
          %iter_10654 = cute.get_iter(%view_10620) : !memref_smem_bf16_16
          %lay_10655 = cute.get_layout(%view_10605) : !memref_gmem_bf16_10
          %lay_10656 = cute.get_layout(%view_10620) : !memref_smem_bf16_16
          %append_10657 = cute.append_to_rank<2> (%lay_10655, %2938) : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">, !cute.layout<"1:0">
          %append_10658 = cute.append_to_rank<2> (%lay_10656, %2938) : !cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">, !cute.layout<"1:0">
          %2939 = cute.get_scalars(%append_10657) <{only_dynamic}> : !cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
          %shape_10659 = cute.make_shape() : () -> !cute.shape<"((8,1),((4,2)))">
          %iv_10660 = cute.assume(%2939) : (i64) -> !cute.i64<divby 128>
          %stride_10661 = cute.make_stride(%iv_10660) : (!cute.i64<divby 128>) -> !cute.stride<"((1,0),((?{i64 div=128},64)))">
          %lay_10662 = cute.make_layout(%shape_10659, %stride_10661) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">
          %lay_10663 = cute.make_layout() : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">
          %iter_10664 = cute.get_iter(%view_10634) : !memref_rmem_i8_5
          %lay_10665 = cute.get_layout(%view_10634) : !memref_rmem_i8_5
          %append_10666 = cute.append_to_rank<2> (%lay_10665, %2938) : !cute.layout<"(1,(4,2)):(2,(0,1))">, !cute.layout<"1:0">
          %lay_10667 = cute.make_layout() : !cute.layout<"(1,((4,2))):(2,((0,1)))">
          %sz_10668 = cute.size(%lay_10662) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"8">
          %2940 = cute.get_scalars(%sz_10668) : !cute.int_tuple<"8">
          %c0_i32_10669 = arith.constant 0 : i32
          %c1_i32_10670 = arith.constant 1 : i32
          scf.for %arg13 = %c0_i32_10669 to %2940 step %c1_i32_10670  : i32 {
            %coord_10671 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
            %slice_10672 = cute.slice(%lay_10662, %coord_10671) : !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">, !cute.coord<"(_,?)">
            %idx_10673 = cute.crd2idx(%coord_10671, %lay_10662) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((?{i64 div=128},64)))">) -> !cute.int_tuple<"?{i64 div=64}">
            %ptr_10674 = cute.add_offset(%iter_10653, %idx_10673) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
            %view_10675 = cute.make_view(%ptr_10674, %slice_10672) : !memref_gmem_bf16_8
            %slice_10676 = cute.slice(%lay_10663, %coord_10671) : !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">, !cute.coord<"(_,?)">
            %idx_10677 = cute.crd2idx(%coord_10671, %lay_10663) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((4,2))):((1,0),((1024,4096)))">) -> !cute.int_tuple<"?{div=1024}">
            %ptr_10678 = cute.add_offset(%iter_10654, %idx_10677) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
            %view_10679 = cute.make_view(%ptr_10678, %slice_10676) : !memref_smem_bf16_13
            %slice_10680 = cute.slice(%lay_10667, %coord_10671) : !cute.layout<"(1,((4,2))):(2,((0,1)))">, !cute.coord<"(_,?)">
            %idx_10681 = cute.crd2idx(%coord_10671, %lay_10667) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((4,2))):(2,((0,1)))">) -> !cute.int_tuple<"?">
            %ptr_10682 = cute.add_offset(%iter_10664, %idx_10681) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
            %view_10683 = cute.make_view(%ptr_10682, %slice_10680) : !memref_rmem_i8_4
            cute.copy_atom_call(%3, %view_10675, %view_10679, %view_10683) : (!copy_ldgsts, !memref_gmem_bf16_8, !memref_smem_bf16_13, !memref_rmem_i8_4) -> ()
          } {llvm.loop_annotation = #loop_annotation}
          nvvm.cp.async.commit.group
        }
        %lay_9478 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2702 = cute.get_shape(%lay_9478) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9479, %e1_9480, %e2_9481, %e3_9482 = cute.get_leaves(%2702) : !cute.shape<"((2,2),2,8)">
        %shape_9483 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)">
        %lay_9484 = cute.make_layout() : !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %2703 = cute.get_shape(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9485, %e1_9486, %e2_9487, %e3_9488 = cute.get_leaves(%2703) : !cute.shape<"((2,2),2,8)">
        %2704 = cute.get_shape(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9489, %e1_9490, %e2_9491, %e3_9492 = cute.get_leaves(%2704) : !cute.shape<"((2,2),2,8)">
        %2705 = cute.get_shape(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9493, %e1_9494, %e2_9495, %e3_9496 = cute.get_leaves(%2705) : !cute.shape<"((2,2),2,8)">
        %2706 = cute.get_shape(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9497, %e1_9498, %e2_9499, %e3_9500 = cute.get_leaves(%2706) : !cute.shape<"((2,2),2,8)">
        %2707 = cute.get_stride(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9501, %e1_9502, %e2_9503, %e3_9504 = cute.get_leaves(%2707) : !cute.stride<"((1,2),4,8)">
        %2708 = cute.get_stride(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9505, %e1_9506, %e2_9507, %e3_9508 = cute.get_leaves(%2708) : !cute.stride<"((1,2),4,8)">
        %2709 = cute.get_stride(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9509, %e1_9510, %e2_9511, %e3_9512 = cute.get_leaves(%2709) : !cute.stride<"((1,2),4,8)">
        %2710 = cute.get_stride(%lay_9484) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9513, %e1_9514, %e2_9515, %e3_9516 = cute.get_leaves(%2710) : !cute.stride<"((1,2),4,8)">
        %shape_9517 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))">
        %stride_9518 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_9519 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %lay_9520 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %lay_9521 = cute.make_layout() : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">
        %view_9522 = cute.make_view(%iter_7765, %lay_9521) : !memref_rmem_f32_4
        %iter_9523 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %lay_9524 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2711 = cute.get_shape(%lay_9524) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9525, %e1_9526, %e2_9527, %e3_9528 = cute.get_leaves(%2711) : !cute.shape<"((2,2),2,16)">
        %shape_9529 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
        %lay_9530 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
        %2712 = cute.get_shape(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9531, %e1_9532, %e2_9533, %e3_9534 = cute.get_leaves(%2712) : !cute.shape<"((2,2),2,16)">
        %2713 = cute.get_shape(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9535, %e1_9536, %e2_9537, %e3_9538 = cute.get_leaves(%2713) : !cute.shape<"((2,2),2,16)">
        %2714 = cute.get_shape(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9539, %e1_9540, %e2_9541, %e3_9542 = cute.get_leaves(%2714) : !cute.shape<"((2,2),2,16)">
        %2715 = cute.get_shape(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_9543, %e1_9544, %e2_9545, %e3_9546 = cute.get_leaves(%2715) : !cute.shape<"((2,2),2,16)">
        %2716 = cute.get_stride(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9547, %e1_9548, %e2_9549, %e3_9550 = cute.get_leaves(%2716) : !cute.stride<"((1,2),4,8)">
        %2717 = cute.get_stride(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9551, %e1_9552, %e2_9553, %e3_9554 = cute.get_leaves(%2717) : !cute.stride<"((1,2),4,8)">
        %2718 = cute.get_stride(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9555, %e1_9556, %e2_9557, %e3_9558 = cute.get_leaves(%2718) : !cute.stride<"((1,2),4,8)">
        %2719 = cute.get_stride(%lay_9530) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
        %e0_9559, %e1_9560, %e2_9561, %e3_9562 = cute.get_leaves(%2719) : !cute.stride<"((1,2),4,8)">
        %shape_9563 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
        %stride_9564 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
        %lay_9565 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %lay_9566 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_9567 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
        %view_9568 = cute.make_view(%iter_319, %lay_9567) : !memref_rmem_f32_5
        %iter_9569 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %lay_9570 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
        %2720 = cute.make_layout_like(%lay_9570) : !cute.layout<"4:1"> to !cute.layout<"4:1">
        %rmem_9571 = cute.memref.alloca(%2720) : !memref_rmem_f32_1
        %iter_9572 = cute.get_iter(%rmem_9571) : !memref_rmem_f32_1
        %iter_9573 = cute.get_iter(%rmem_9571) : !memref_rmem_f32_1
        %lay_9574 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
        %2721 = cute.get_shape(%lay_9574) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_9575 = cute.get_leaves(%2721) : !cute.shape<"4">
        %lay_9576 = cute.get_layout(%rmem_9571) : !memref_rmem_f32_1
        %2722 = cute.get_shape(%lay_9576) : (!cute.layout<"4:1">) -> !cute.shape<"4">
        %e0_9577 = cute.get_leaves(%2722) : !cute.shape<"4">
        %atom_9578 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b>
        %2723 = cute.static : !cute.layout<"1:0">
        %iter_9579 = cute.get_iter(%rmem_1062) : !memref_rmem_f32_1
        %iter_9580 = cute.get_iter(%rmem_9571) : !memref_rmem_f32_1
        %lay_9581 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
        %lay_9582 = cute.get_layout(%rmem_9571) : !memref_rmem_f32_1
        %append_9583 = cute.append_to_rank<2> (%lay_9581, %2723) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %append_9584 = cute.append_to_rank<2> (%lay_9582, %2723) : !cute.layout<"4:1">, !cute.layout<"1:0">
        %lay_9585 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %lay_9586 = cute.make_layout() : !cute.layout<"(4,(1)):(1,(0))">
        %sz_9587 = cute.size(%lay_9585) <{mode = [1]}> : (!cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"1">
        %2724 = cute.get_scalars(%sz_9587) : !cute.int_tuple<"1">
        %c0_i32_9588 = arith.constant 0 : i32
        %c1_i32_9589 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_9588 to %2724 step %c1_i32_9589  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_9585, %coord_10569) : !cute.layout<"(4,(1)):(1,(0))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_9585) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_10572 = cute.add_offset(%iter_9579, %idx_10571) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_rmem_f32_9
          %slice_10574 = cute.slice(%lay_9586, %coord_10569) : !cute.layout<"(4,(1)):(1,(0))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_9586) : (!cute.coord<"(_,?)">, !cute.layout<"(4,(1)):(1,(0))">) -> !cute.int_tuple<"0">
          %ptr_10576 = cute.add_offset(%iter_9580, %idx_10575) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_f32_9
          cute.copy_atom_call(%atom_9578, %view_10573, %view_10577) : (!cute_nvgpu.atom.universal_copy<f32, 32 b>, !memref_rmem_f32_9, !memref_rmem_f32_9) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_9590 = cute.get_layout(%rmem_1062) : !memref_rmem_f32_1
        %sz_9591 = cute.size(%lay_9590) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
        %e0_9592 = cute.get_leaves(%sz_9591) : !cute.int_tuple<"4">
        %coord_9593 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9594 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9595 = cute.crd2idx(%coord_9593, %lay_9594) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9596 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9597 = cute.add_offset(%iter_9596, %idx_9595) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9598 = cute.make_view(%ptr_9597) : !memref_rmem_f32_6
        %iter_9599 = cute.get_iter(%view_9598) : !memref_rmem_f32_6
        %lay_9600 = cute.get_layout(%view_9598) : !memref_rmem_f32_6
        %2725 = cute.get_shape(%lay_9600) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9601, %e1_9602 = cute.get_leaves(%2725) : !cute.shape<"((2,8))">
        %2726 = cute.memref.load_vec %view_9598, row_major : !memref_rmem_f32_6
        %cst_9603 = arith.constant 0xFF800000 : f32
        %2727 = vector.reduction <maximumf>, %2726, %cst_9603 : vector<16xf32> into f32
        %c-1_i32_9604 = arith.constant -1 : i32
        %c2_i32_9605 = arith.constant 2 : i32
        %c31_i32_9606 = arith.constant 31 : i32
        %2728 = nvvm.shfl.sync  bfly %c-1_i32_9604, %2727, %c2_i32_9605, %c31_i32_9606 : f32 -> f32
        %2729 = nvvm.fmax %2727, %2728
        %c-1_i32_9607 = arith.constant -1 : i32
        %c1_i32_9608 = arith.constant 1 : i32
        %c31_i32_9609 = arith.constant 31 : i32
        %2730 = nvvm.shfl.sync  bfly %c-1_i32_9607, %2729, %c1_i32_9608, %c31_i32_9609 : f32 -> f32
        %2731 = nvvm.fmax %2729, %2730
        %coord_9610 = cute.make_coord() : () -> !cute.coord<"0">
        %2732 = cute.memref.load(%rmem_9571, %coord_9610) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2733 = nvvm.fmax %2732, %2731
        %2734 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2735 = arith.mulf %2726, %2734 : vector<16xf32>
        %2736 = arith.mulf %2733, %arg4 : f32
        %2737 = vector.broadcast %2736 : f32 to vector<16xf32>
        %2738 = arith.subf %2735, %2737 : vector<16xf32>
        %2739 = math.exp2 %2738 fastmath<fast> : vector<16xf32>
        %cst_9611 = arith.constant 0.000000e+00 : f32
        %2740 = vector.reduction <add>, %2739, %cst_9611 : vector<16xf32> into f32
        %2741 = arith.mulf %2732, %arg4 : f32
        %2742 = arith.mulf %2733, %arg4 : f32
        %2743 = arith.subf %2741, %2742 : f32
        %2744 = math.exp2 %2743 fastmath<fast> : f32
        %coord_9612 = cute.make_coord() : () -> !cute.coord<"0">
        %2745 = cute.memref.load(%rmem_1067, %coord_9612) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
        %2746 = arith.mulf %2745, %2744 : f32
        %2747 = arith.addf %2746, %2740 : f32
        %coord_9613 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9614 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9615 = cute.crd2idx(%coord_9613, %lay_9614) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9616 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9617 = cute.add_offset(%iter_9616, %idx_9615) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9618 = cute.make_view(%ptr_9617) : !memref_rmem_f32_10
        %iter_9619 = cute.get_iter(%view_9618) : !memref_rmem_f32_10
        %lay_9620 = cute.get_layout(%view_9618) : !memref_rmem_f32_10
        %2748 = cute.get_shape(%lay_9620) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9621, %e1_9622 = cute.get_leaves(%2748) : !cute.shape<"((2,16))">
        %2749 = cute.memref.load_vec %view_9618, row_major : !memref_rmem_f32_10
        %2750 = vector.broadcast %2744 : f32 to vector<32xf32>
        %2751 = arith.mulf %2749, %2750 : vector<32xf32>
        %coord_9623 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9624 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9625 = cute.crd2idx(%coord_9623, %lay_9624) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9626 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9627 = cute.add_offset(%iter_9626, %idx_9625) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9628 = cute.make_view(%ptr_9627) : !memref_rmem_f32_10
        %iter_9629 = cute.get_iter(%view_9628) : !memref_rmem_f32_10
        %lay_9630 = cute.get_layout(%view_9628) : !memref_rmem_f32_10
        %2752 = cute.get_shape(%lay_9630) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9631, %e1_9632 = cute.get_leaves(%2752) : !cute.shape<"((2,16))">
        %int_tuple_9633 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9634 = cute.size(%int_tuple_9633) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9635 = cute.get_leaves(%sz_9634) : !cute.int_tuple<"32">
        %int_tuple_9636 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9637 = cute.size(%int_tuple_9636) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9638 = cute.get_leaves(%sz_9637) : !cute.int_tuple<"32">
        cute.memref.store_vec %2751, %view_9628, row_major : !memref_rmem_f32_10
        %coord_9639 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1062, %coord_9639, %2733) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_9640 = cute.make_coord() : () -> !cute.coord<"0">
        cute.memref.store(%rmem_1067, %coord_9640, %2747) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
        %coord_9641 = cute.make_coord() : () -> !cute.coord<"(0,_)">
        %lay_9642 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9643 = cute.crd2idx(%coord_9641, %lay_9642) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
        %iter_9644 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9645 = cute.add_offset(%iter_9644, %idx_9643) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
        %view_9646 = cute.make_view(%ptr_9645) : !memref_rmem_f32_6
        %iter_9647 = cute.get_iter(%view_9646) : !memref_rmem_f32_6
        %lay_9648 = cute.get_layout(%view_9646) : !memref_rmem_f32_6
        %2753 = cute.get_shape(%lay_9648) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9649, %e1_9650 = cute.get_leaves(%2753) : !cute.shape<"((2,8))">
        %int_tuple_9651 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9652 = cute.size(%int_tuple_9651) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9653 = cute.get_leaves(%sz_9652) : !cute.int_tuple<"16">
        %int_tuple_9654 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9655 = cute.size(%int_tuple_9654) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9656 = cute.get_leaves(%sz_9655) : !cute.int_tuple<"16">
        cute.memref.store_vec %2739, %view_9646, row_major : !memref_rmem_f32_6
        %coord_9657 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9658 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9659 = cute.crd2idx(%coord_9657, %lay_9658) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9660 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9661 = cute.add_offset(%iter_9660, %idx_9659) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9662 = cute.make_view(%ptr_9661) : !memref_rmem_f32_7
        %iter_9663 = cute.get_iter(%view_9662) : !memref_rmem_f32_7
        %lay_9664 = cute.get_layout(%view_9662) : !memref_rmem_f32_7
        %2754 = cute.get_shape(%lay_9664) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9665, %e1_9666 = cute.get_leaves(%2754) : !cute.shape<"((2,8))">
        %2755 = cute.memref.load_vec %view_9662, row_major : !memref_rmem_f32_7
        %cst_9667 = arith.constant 0xFF800000 : f32
        %2756 = vector.reduction <maximumf>, %2755, %cst_9667 : vector<16xf32> into f32
        %c-1_i32_9668 = arith.constant -1 : i32
        %c2_i32_9669 = arith.constant 2 : i32
        %c31_i32_9670 = arith.constant 31 : i32
        %2757 = nvvm.shfl.sync  bfly %c-1_i32_9668, %2756, %c2_i32_9669, %c31_i32_9670 : f32 -> f32
        %2758 = nvvm.fmax %2756, %2757
        %c-1_i32_9671 = arith.constant -1 : i32
        %c1_i32_9672 = arith.constant 1 : i32
        %c31_i32_9673 = arith.constant 31 : i32
        %2759 = nvvm.shfl.sync  bfly %c-1_i32_9671, %2758, %c1_i32_9672, %c31_i32_9673 : f32 -> f32
        %2760 = nvvm.fmax %2758, %2759
        %coord_9674 = cute.make_coord() : () -> !cute.coord<"1">
        %2761 = cute.memref.load(%rmem_9571, %coord_9674) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2762 = nvvm.fmax %2761, %2760
        %2763 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2764 = arith.mulf %2755, %2763 : vector<16xf32>
        %2765 = arith.mulf %2762, %arg4 : f32
        %2766 = vector.broadcast %2765 : f32 to vector<16xf32>
        %2767 = arith.subf %2764, %2766 : vector<16xf32>
        %2768 = math.exp2 %2767 fastmath<fast> : vector<16xf32>
        %cst_9675 = arith.constant 0.000000e+00 : f32
        %2769 = vector.reduction <add>, %2768, %cst_9675 : vector<16xf32> into f32
        %2770 = arith.mulf %2761, %arg4 : f32
        %2771 = arith.mulf %2762, %arg4 : f32
        %2772 = arith.subf %2770, %2771 : f32
        %2773 = math.exp2 %2772 fastmath<fast> : f32
        %coord_9676 = cute.make_coord() : () -> !cute.coord<"1">
        %2774 = cute.memref.load(%rmem_1067, %coord_9676) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
        %2775 = arith.mulf %2774, %2773 : f32
        %2776 = arith.addf %2775, %2769 : f32
        %coord_9677 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9678 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9679 = cute.crd2idx(%coord_9677, %lay_9678) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9680 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9681 = cute.add_offset(%iter_9680, %idx_9679) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9682 = cute.make_view(%ptr_9681) : !memref_rmem_f32_11
        %iter_9683 = cute.get_iter(%view_9682) : !memref_rmem_f32_11
        %lay_9684 = cute.get_layout(%view_9682) : !memref_rmem_f32_11
        %2777 = cute.get_shape(%lay_9684) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9685, %e1_9686 = cute.get_leaves(%2777) : !cute.shape<"((2,16))">
        %2778 = cute.memref.load_vec %view_9682, row_major : !memref_rmem_f32_11
        %2779 = vector.broadcast %2773 : f32 to vector<32xf32>
        %2780 = arith.mulf %2778, %2779 : vector<32xf32>
        %coord_9687 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9688 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9689 = cute.crd2idx(%coord_9687, %lay_9688) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9690 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9691 = cute.add_offset(%iter_9690, %idx_9689) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9692 = cute.make_view(%ptr_9691) : !memref_rmem_f32_11
        %iter_9693 = cute.get_iter(%view_9692) : !memref_rmem_f32_11
        %lay_9694 = cute.get_layout(%view_9692) : !memref_rmem_f32_11
        %2781 = cute.get_shape(%lay_9694) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9695, %e1_9696 = cute.get_leaves(%2781) : !cute.shape<"((2,16))">
        %int_tuple_9697 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9698 = cute.size(%int_tuple_9697) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9699 = cute.get_leaves(%sz_9698) : !cute.int_tuple<"32">
        %int_tuple_9700 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9701 = cute.size(%int_tuple_9700) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9702 = cute.get_leaves(%sz_9701) : !cute.int_tuple<"32">
        cute.memref.store_vec %2780, %view_9692, row_major : !memref_rmem_f32_11
        %coord_9703 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1062, %coord_9703, %2762) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_9704 = cute.make_coord() : () -> !cute.coord<"1">
        cute.memref.store(%rmem_1067, %coord_9704, %2776) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
        %coord_9705 = cute.make_coord() : () -> !cute.coord<"(1,_)">
        %lay_9706 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9707 = cute.crd2idx(%coord_9705, %lay_9706) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
        %iter_9708 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9709 = cute.add_offset(%iter_9708, %idx_9707) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9710 = cute.make_view(%ptr_9709) : !memref_rmem_f32_7
        %iter_9711 = cute.get_iter(%view_9710) : !memref_rmem_f32_7
        %lay_9712 = cute.get_layout(%view_9710) : !memref_rmem_f32_7
        %2782 = cute.get_shape(%lay_9712) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9713, %e1_9714 = cute.get_leaves(%2782) : !cute.shape<"((2,8))">
        %int_tuple_9715 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9716 = cute.size(%int_tuple_9715) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9717 = cute.get_leaves(%sz_9716) : !cute.int_tuple<"16">
        %int_tuple_9718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9719 = cute.size(%int_tuple_9718) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9720 = cute.get_leaves(%sz_9719) : !cute.int_tuple<"16">
        cute.memref.store_vec %2768, %view_9710, row_major : !memref_rmem_f32_7
        %coord_9721 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9722 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9723 = cute.crd2idx(%coord_9721, %lay_9722) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9724 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9725 = cute.add_offset(%iter_9724, %idx_9723) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9726 = cute.make_view(%ptr_9725) : !memref_rmem_f32_8
        %iter_9727 = cute.get_iter(%view_9726) : !memref_rmem_f32_8
        %lay_9728 = cute.get_layout(%view_9726) : !memref_rmem_f32_8
        %2783 = cute.get_shape(%lay_9728) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9729, %e1_9730 = cute.get_leaves(%2783) : !cute.shape<"((2,8))">
        %2784 = cute.memref.load_vec %view_9726, row_major : !memref_rmem_f32_8
        %cst_9731 = arith.constant 0xFF800000 : f32
        %2785 = vector.reduction <maximumf>, %2784, %cst_9731 : vector<16xf32> into f32
        %c-1_i32_9732 = arith.constant -1 : i32
        %c2_i32_9733 = arith.constant 2 : i32
        %c31_i32_9734 = arith.constant 31 : i32
        %2786 = nvvm.shfl.sync  bfly %c-1_i32_9732, %2785, %c2_i32_9733, %c31_i32_9734 : f32 -> f32
        %2787 = nvvm.fmax %2785, %2786
        %c-1_i32_9735 = arith.constant -1 : i32
        %c1_i32_9736 = arith.constant 1 : i32
        %c31_i32_9737 = arith.constant 31 : i32
        %2788 = nvvm.shfl.sync  bfly %c-1_i32_9735, %2787, %c1_i32_9736, %c31_i32_9737 : f32 -> f32
        %2789 = nvvm.fmax %2787, %2788
        %coord_9738 = cute.make_coord() : () -> !cute.coord<"2">
        %2790 = cute.memref.load(%rmem_9571, %coord_9738) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2791 = nvvm.fmax %2790, %2789
        %2792 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2793 = arith.mulf %2784, %2792 : vector<16xf32>
        %2794 = arith.mulf %2791, %arg4 : f32
        %2795 = vector.broadcast %2794 : f32 to vector<16xf32>
        %2796 = arith.subf %2793, %2795 : vector<16xf32>
        %2797 = math.exp2 %2796 fastmath<fast> : vector<16xf32>
        %cst_9739 = arith.constant 0.000000e+00 : f32
        %2798 = vector.reduction <add>, %2797, %cst_9739 : vector<16xf32> into f32
        %2799 = arith.mulf %2790, %arg4 : f32
        %2800 = arith.mulf %2791, %arg4 : f32
        %2801 = arith.subf %2799, %2800 : f32
        %2802 = math.exp2 %2801 fastmath<fast> : f32
        %coord_9740 = cute.make_coord() : () -> !cute.coord<"2">
        %2803 = cute.memref.load(%rmem_1067, %coord_9740) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
        %2804 = arith.mulf %2803, %2802 : f32
        %2805 = arith.addf %2804, %2798 : f32
        %coord_9741 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9742 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9743 = cute.crd2idx(%coord_9741, %lay_9742) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9744 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9745 = cute.add_offset(%iter_9744, %idx_9743) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9746 = cute.make_view(%ptr_9745) : !memref_rmem_f32_12
        %iter_9747 = cute.get_iter(%view_9746) : !memref_rmem_f32_12
        %lay_9748 = cute.get_layout(%view_9746) : !memref_rmem_f32_12
        %2806 = cute.get_shape(%lay_9748) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9749, %e1_9750 = cute.get_leaves(%2806) : !cute.shape<"((2,16))">
        %2807 = cute.memref.load_vec %view_9746, row_major : !memref_rmem_f32_12
        %2808 = vector.broadcast %2802 : f32 to vector<32xf32>
        %2809 = arith.mulf %2807, %2808 : vector<32xf32>
        %coord_9751 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9752 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9753 = cute.crd2idx(%coord_9751, %lay_9752) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9754 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9755 = cute.add_offset(%iter_9754, %idx_9753) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9756 = cute.make_view(%ptr_9755) : !memref_rmem_f32_12
        %iter_9757 = cute.get_iter(%view_9756) : !memref_rmem_f32_12
        %lay_9758 = cute.get_layout(%view_9756) : !memref_rmem_f32_12
        %2810 = cute.get_shape(%lay_9758) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9759, %e1_9760 = cute.get_leaves(%2810) : !cute.shape<"((2,16))">
        %int_tuple_9761 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9762 = cute.size(%int_tuple_9761) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9763 = cute.get_leaves(%sz_9762) : !cute.int_tuple<"32">
        %int_tuple_9764 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9765 = cute.size(%int_tuple_9764) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9766 = cute.get_leaves(%sz_9765) : !cute.int_tuple<"32">
        cute.memref.store_vec %2809, %view_9756, row_major : !memref_rmem_f32_12
        %coord_9767 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1062, %coord_9767, %2791) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_9768 = cute.make_coord() : () -> !cute.coord<"2">
        cute.memref.store(%rmem_1067, %coord_9768, %2805) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
        %coord_9769 = cute.make_coord() : () -> !cute.coord<"(2,_)">
        %lay_9770 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9771 = cute.crd2idx(%coord_9769, %lay_9770) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
        %iter_9772 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9773 = cute.add_offset(%iter_9772, %idx_9771) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
        %view_9774 = cute.make_view(%ptr_9773) : !memref_rmem_f32_8
        %iter_9775 = cute.get_iter(%view_9774) : !memref_rmem_f32_8
        %lay_9776 = cute.get_layout(%view_9774) : !memref_rmem_f32_8
        %2811 = cute.get_shape(%lay_9776) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9777, %e1_9778 = cute.get_leaves(%2811) : !cute.shape<"((2,8))">
        %int_tuple_9779 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9780 = cute.size(%int_tuple_9779) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9781 = cute.get_leaves(%sz_9780) : !cute.int_tuple<"16">
        %int_tuple_9782 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9783 = cute.size(%int_tuple_9782) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9784 = cute.get_leaves(%sz_9783) : !cute.int_tuple<"16">
        cute.memref.store_vec %2797, %view_9774, row_major : !memref_rmem_f32_8
        %coord_9785 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9786 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9787 = cute.crd2idx(%coord_9785, %lay_9786) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9788 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9789 = cute.add_offset(%iter_9788, %idx_9787) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9790 = cute.make_view(%ptr_9789) : !memref_rmem_f32_7
        %iter_9791 = cute.get_iter(%view_9790) : !memref_rmem_f32_7
        %lay_9792 = cute.get_layout(%view_9790) : !memref_rmem_f32_7
        %2812 = cute.get_shape(%lay_9792) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9793, %e1_9794 = cute.get_leaves(%2812) : !cute.shape<"((2,8))">
        %2813 = cute.memref.load_vec %view_9790, row_major : !memref_rmem_f32_7
        %cst_9795 = arith.constant 0xFF800000 : f32
        %2814 = vector.reduction <maximumf>, %2813, %cst_9795 : vector<16xf32> into f32
        %c-1_i32_9796 = arith.constant -1 : i32
        %c2_i32_9797 = arith.constant 2 : i32
        %c31_i32_9798 = arith.constant 31 : i32
        %2815 = nvvm.shfl.sync  bfly %c-1_i32_9796, %2814, %c2_i32_9797, %c31_i32_9798 : f32 -> f32
        %2816 = nvvm.fmax %2814, %2815
        %c-1_i32_9799 = arith.constant -1 : i32
        %c1_i32_9800 = arith.constant 1 : i32
        %c31_i32_9801 = arith.constant 31 : i32
        %2817 = nvvm.shfl.sync  bfly %c-1_i32_9799, %2816, %c1_i32_9800, %c31_i32_9801 : f32 -> f32
        %2818 = nvvm.fmax %2816, %2817
        %coord_9802 = cute.make_coord() : () -> !cute.coord<"3">
        %2819 = cute.memref.load(%rmem_9571, %coord_9802) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2820 = nvvm.fmax %2819, %2818
        %2821 = vector.broadcast %arg4 : f32 to vector<16xf32>
        %2822 = arith.mulf %2813, %2821 : vector<16xf32>
        %2823 = arith.mulf %2820, %arg4 : f32
        %2824 = vector.broadcast %2823 : f32 to vector<16xf32>
        %2825 = arith.subf %2822, %2824 : vector<16xf32>
        %2826 = math.exp2 %2825 fastmath<fast> : vector<16xf32>
        %cst_9803 = arith.constant 0.000000e+00 : f32
        %2827 = vector.reduction <add>, %2826, %cst_9803 : vector<16xf32> into f32
        %2828 = arith.mulf %2819, %arg4 : f32
        %2829 = arith.mulf %2820, %arg4 : f32
        %2830 = arith.subf %2828, %2829 : f32
        %2831 = math.exp2 %2830 fastmath<fast> : f32
        %coord_9804 = cute.make_coord() : () -> !cute.coord<"3">
        %2832 = cute.memref.load(%rmem_1067, %coord_9804) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
        %2833 = arith.mulf %2832, %2831 : f32
        %2834 = arith.addf %2833, %2827 : f32
        %coord_9805 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9806 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9807 = cute.crd2idx(%coord_9805, %lay_9806) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9808 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9809 = cute.add_offset(%iter_9808, %idx_9807) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9810 = cute.make_view(%ptr_9809) : !memref_rmem_f32_11
        %iter_9811 = cute.get_iter(%view_9810) : !memref_rmem_f32_11
        %lay_9812 = cute.get_layout(%view_9810) : !memref_rmem_f32_11
        %2835 = cute.get_shape(%lay_9812) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9813, %e1_9814 = cute.get_leaves(%2835) : !cute.shape<"((2,16))">
        %2836 = cute.memref.load_vec %view_9810, row_major : !memref_rmem_f32_11
        %2837 = vector.broadcast %2831 : f32 to vector<32xf32>
        %2838 = arith.mulf %2836, %2837 : vector<32xf32>
        %coord_9815 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9816 = cute.get_layout(%view_9568) : !memref_rmem_f32_5
        %idx_9817 = cute.crd2idx(%coord_9815, %lay_9816) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9818 = cute.get_iter(%view_9568) : !memref_rmem_f32_5
        %ptr_9819 = cute.add_offset(%iter_9818, %idx_9817) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9820 = cute.make_view(%ptr_9819) : !memref_rmem_f32_11
        %iter_9821 = cute.get_iter(%view_9820) : !memref_rmem_f32_11
        %lay_9822 = cute.get_layout(%view_9820) : !memref_rmem_f32_11
        %2839 = cute.get_shape(%lay_9822) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
        %e0_9823, %e1_9824 = cute.get_leaves(%2839) : !cute.shape<"((2,16))">
        %int_tuple_9825 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9826 = cute.size(%int_tuple_9825) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9827 = cute.get_leaves(%sz_9826) : !cute.int_tuple<"32">
        %int_tuple_9828 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
        %sz_9829 = cute.size(%int_tuple_9828) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
        %e0_9830 = cute.get_leaves(%sz_9829) : !cute.int_tuple<"32">
        cute.memref.store_vec %2838, %view_9820, row_major : !memref_rmem_f32_11
        %coord_9831 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1062, %coord_9831, %2820) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_9832 = cute.make_coord() : () -> !cute.coord<"3">
        cute.memref.store(%rmem_1067, %coord_9832, %2834) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
        %coord_9833 = cute.make_coord() : () -> !cute.coord<"(3,_)">
        %lay_9834 = cute.get_layout(%view_9522) : !memref_rmem_f32_4
        %idx_9835 = cute.crd2idx(%coord_9833, %lay_9834) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
        %iter_9836 = cute.get_iter(%view_9522) : !memref_rmem_f32_4
        %ptr_9837 = cute.add_offset(%iter_9836, %idx_9835) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
        %view_9838 = cute.make_view(%ptr_9837) : !memref_rmem_f32_7
        %iter_9839 = cute.get_iter(%view_9838) : !memref_rmem_f32_7
        %lay_9840 = cute.get_layout(%view_9838) : !memref_rmem_f32_7
        %2840 = cute.get_shape(%lay_9840) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))">
        %e0_9841, %e1_9842 = cute.get_leaves(%2840) : !cute.shape<"((2,8))">
        %int_tuple_9843 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9844 = cute.size(%int_tuple_9843) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9845 = cute.get_leaves(%sz_9844) : !cute.int_tuple<"16">
        %int_tuple_9846 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))">
        %sz_9847 = cute.size(%int_tuple_9846) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16">
        %e0_9848 = cute.get_leaves(%sz_9847) : !cute.int_tuple<"16">
        cute.memref.store_vec %2826, %view_9838, row_major : !memref_rmem_f32_7
        %lay_9849 = cute.get_layout(%rmem_7763) : !memref_rmem_f32_2
        %2841 = cute.make_layout_like(%lay_9849) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)">
        %rmem_9850 = cute.memref.alloca(%2841) : !memref_rmem_bf16_16
        %iter_9851 = cute.get_iter(%rmem_9850) : !memref_rmem_bf16_16
        %iter_9852 = cute.get_iter(%rmem_9850) : !memref_rmem_bf16_16
        %2842 = cute.memref.load_vec %rmem_7763, row_major : !memref_rmem_f32_2
        %2843 = arith.truncf %2842 : vector<64xf32> to vector<64xbf16>
        %lay_9853 = cute.get_layout(%rmem_9850) : !memref_rmem_bf16_16
        %2844 = cute.get_shape(%lay_9853) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)">
        %e0_9854, %e1_9855, %e2_9856, %e3_9857 = cute.get_leaves(%2844) : !cute.shape<"((2,2),2,8)">
        %int_tuple_9858 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_9859 = cute.size(%int_tuple_9858) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_9860 = cute.get_leaves(%sz_9859) : !cute.int_tuple<"64">
        %int_tuple_9861 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)">
        %sz_9862 = cute.size(%int_tuple_9861) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64">
        %e0_9863 = cute.get_leaves(%sz_9862) : !cute.int_tuple<"64">
        cute.memref.store_vec %2843, %rmem_9850, row_major : !memref_rmem_bf16_16
        %lay_9864 = cute.get_layout(%rmem_9850) : !memref_rmem_bf16_16
        %tile_9865 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]">
        %lay_9866 = cute.make_layout() : !cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">
        %2845 = cute.get_shape(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_9867, %e1_9868, %e2_9869, %e3_9870, %e4_9871 = cute.get_leaves(%2845) : !cute.shape<"((2,2),2,(2,4))">
        %2846 = cute.get_shape(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_9872, %e1_9873, %e2_9874, %e3_9875, %e4_9876 = cute.get_leaves(%2846) : !cute.shape<"((2,2),2,(2,4))">
        %2847 = cute.get_shape(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_9877, %e1_9878, %e2_9879, %e3_9880, %e4_9881 = cute.get_leaves(%2847) : !cute.shape<"((2,2),2,(2,4))">
        %2848 = cute.get_shape(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))">
        %e0_9882, %e1_9883, %e2_9884, %e3_9885, %e4_9886 = cute.get_leaves(%2848) : !cute.shape<"((2,2),2,(2,4))">
        %2849 = cute.get_stride(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_9887, %e1_9888, %e2_9889, %e3_9890, %e4_9891 = cute.get_leaves(%2849) : !cute.stride<"((1,2),4,(8,16))">
        %2850 = cute.get_stride(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_9892, %e1_9893, %e2_9894, %e3_9895, %e4_9896 = cute.get_leaves(%2850) : !cute.stride<"((1,2),4,(8,16))">
        %2851 = cute.get_stride(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_9897, %e1_9898, %e2_9899, %e3_9900, %e4_9901 = cute.get_leaves(%2851) : !cute.stride<"((1,2),4,(8,16))">
        %2852 = cute.get_stride(%lay_9866) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))">
        %e0_9902, %e1_9903, %e2_9904, %e3_9905, %e4_9906 = cute.get_leaves(%2852) : !cute.stride<"((1,2),4,(8,16))">
        %shape_9907 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)">
        %stride_9908 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)">
        %lay_9909 = cute.make_layout() : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">
        %view_9910 = cute.make_view(%iter_9852, %lay_9909) : !memref_rmem_bf16_17
        %iter_9911 = cute.get_iter(%view_9910) : !memref_rmem_bf16_17
        %coord_9912 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9913 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
        %slice_9914 = cute.slice(%lay_9913, %coord_9912) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_9915 = cute.crd2idx(%coord_9912, %lay_9913) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_9916 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
        %ptr_9917 = cute.add_offset(%iter_9916, %idx_9915) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_9918 = cute.make_view(%ptr_9917, %slice_9914) : !memref_smem_bf16_19
        %iter_9919 = cute.get_iter(%view_9918) : !memref_smem_bf16_19
        %coord_9920 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_9921 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
        %idx_9922 = cute.crd2idx(%coord_9920, %lay_9921) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_9923 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
        %ptr_9924 = cute.add_offset(%iter_9923, %idx_9922) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_9925 = cute.make_view(%ptr_9924) : !memref_rmem_bf16_18
        %iter_9926 = cute.get_iter(%view_9925) : !memref_rmem_bf16_18
        %lay_9927 = cute.get_layout(%view_9918) : !memref_smem_bf16_19
        %2853 = cute.get_shape(%lay_9927) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_9928, %e1_9929, %e2_9930, %e3_9931, %e4_9932 = cute.get_leaves(%2853) : !cute.shape<"((8,1),((2,2),2))">
        %lay_9933 = cute.get_layout(%view_9925) : !memref_rmem_bf16_18
        %2854 = cute.get_shape(%lay_9933) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_9934, %e1_9935, %e2_9936, %e3_9937 = cute.get_leaves(%2854) : !cute.shape<"((8,1),(4,2))">
        %lay_9938 = cute.get_layout(%view_9918) : !memref_smem_bf16_19
        %shape_9939 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9940 = cute.make_layout() : !cute.layout<"1:0">
        %append_9941 = cute.append_to_rank<2> (%lay_9938, %lay_9940) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_9942 = cute.make_view(%iter_9919, %append_9941) : !memref_smem_bf16_19
        %iter_9943 = cute.get_iter(%view_9942) : !memref_smem_bf16_19
        %lay_9944 = cute.get_layout(%view_9942) : !memref_smem_bf16_19
        %2855 = cute.get_shape(%lay_9944) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_9945, %e1_9946, %e2_9947, %e3_9948, %e4_9949 = cute.get_leaves(%2855) : !cute.shape<"((8,1),((2,2),2))">
        %iter_9950 = cute.get_iter(%view_9942) : !memref_smem_bf16_19
        %lay_9951 = cute.get_layout(%view_9942) : !memref_smem_bf16_19
        %2856:2 = cute.get_scalars(%lay_9951) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_9952 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_9953 = cute.assume(%2856#0) : (i32) -> !cute.i32<divby 16>
        %iv_9954 = cute.assume(%2856#1) : (i32) -> !cute.i32<divby 32>
        %stride_9955 = cute.make_stride(%iv_9953, %iv_9954) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_9956 = cute.make_layout(%shape_9952, %stride_9955) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_9957 = cute.make_view(%iter_9950, %lay_9956) : !memref_smem_bf16_20
        %iter_9958 = cute.get_iter(%view_9957) : !memref_smem_bf16_20
        %iter_9959 = cute.get_iter(%view_9957) : !memref_smem_bf16_20
        %lay_9960 = cute.get_layout(%view_9925) : !memref_rmem_bf16_18
        %shape_9961 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_9962 = cute.make_layout() : !cute.layout<"1:0">
        %append_9963 = cute.append_to_rank<2> (%lay_9960, %lay_9962) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_9964 = cute.make_view(%iter_9926, %append_9963) : !memref_rmem_bf16_18
        %iter_9965 = cute.get_iter(%view_9964) : !memref_rmem_bf16_18
        %lay_9966 = cute.get_layout(%view_9964) : !memref_rmem_bf16_18
        %2857 = cute.get_shape(%lay_9966) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_9967, %e1_9968, %e2_9969, %e3_9970 = cute.get_leaves(%2857) : !cute.shape<"((8,1),(4,2))">
        %iter_9971 = cute.get_iter(%view_9964) : !memref_rmem_bf16_18
        %view_9972 = cute.make_view(%iter_9971) : !memref_rmem_bf16_19
        %iter_9973 = cute.get_iter(%view_9972) : !memref_rmem_bf16_19
        %iter_9974 = cute.get_iter(%view_9972) : !memref_rmem_bf16_19
        %lay_9975 = cute.get_layout(%view_9957) : !memref_smem_bf16_20
        %2858 = cute.get_shape(%lay_9975) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_9976, %e1_9977, %e2_9978, %e3_9979, %e4_9980 = cute.get_leaves(%2858) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_9981 = cute.get_layout(%view_9972) : !memref_rmem_bf16_19
        %2859 = cute.get_shape(%lay_9981) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_9982, %e1_9983, %e2_9984, %e3_9985 = cute.get_leaves(%2859) : !cute.shape<"((8,1),((4,2)))">
        %lay_9986 = cute.get_layout(%view_9957) : !memref_smem_bf16_20
        %sz_9987 = cute.size(%lay_9986) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_9988 = cute.get_leaves(%sz_9987) : !cute.int_tuple<"8">
        %lay_9989 = cute.get_layout(%view_9972) : !memref_rmem_bf16_19
        %sz_9990 = cute.size(%lay_9989) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_9991 = cute.get_leaves(%sz_9990) : !cute.int_tuple<"8">
        %2860 = cute.static : !cute.layout<"1:0">
        %iter_9992 = cute.get_iter(%view_9957) : !memref_smem_bf16_20
        %iter_9993 = cute.get_iter(%view_9972) : !memref_rmem_bf16_19
        %lay_9994 = cute.get_layout(%view_9957) : !memref_smem_bf16_20
        %lay_9995 = cute.get_layout(%view_9972) : !memref_rmem_bf16_19
        %append_9996 = cute.append_to_rank<2> (%lay_9994, %2860) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_9997 = cute.append_to_rank<2> (%lay_9995, %2860) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2861:2 = cute.get_scalars(%append_9996) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_9998 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_9999 = cute.assume(%2861#0) : (i32) -> !cute.i32<divby 16>
        %iv_10000 = cute.assume(%2861#1) : (i32) -> !cute.i32<divby 32>
        %stride_10001 = cute.make_stride(%iv_9999, %iv_10000) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10002 = cute.make_layout(%shape_9998, %stride_10001) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10003 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10004 = cute.size(%lay_10002) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2862 = cute.get_scalars(%sz_10004) : !cute.int_tuple<"8">
        %c0_i32_10005 = arith.constant 0 : i32
        %c1_i32_10006 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10005 to %2862 step %c1_i32_10006  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_10002, %coord_10569) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_10002) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10572 = cute.add_offset(%iter_9992, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_10003, %coord_10569) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_10003) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_9993, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10573, %view_10577) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %lay_10007 = cute.get_layout(%view_9910) : !memref_rmem_bf16_17
        %2863 = cute.get_shape(%lay_10007) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)">
        %e0_10008, %e1_10009, %e2_10010, %e3_10011, %e4_10012 = cute.get_leaves(%2863) : !cute.shape<"(((2,2),2),2,4)">
        %int_tuple_10013 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10014 = cute.size(%int_tuple_10013) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10015 = cute.get_leaves(%sz_10014) : !cute.int_tuple<"4">
        %int_tuple_10016 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10017 = cute.size(%int_tuple_10016) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10018 = cute.get_leaves(%sz_10017) : !cute.int_tuple<"4">
        %coord_10019 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10020 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
        %slice_10021 = cute.slice(%lay_10020, %coord_10019) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,1)">
        %idx_10022 = cute.crd2idx(%coord_10019, %lay_10020) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"1024">
        %iter_10023 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
        %ptr_10024 = cute.add_offset(%iter_10023, %idx_10022) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"1024">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10025 = cute.make_view(%ptr_10024, %slice_10021) : !memref_smem_bf16_19
        %iter_10026 = cute.get_iter(%view_10025) : !memref_smem_bf16_19
        %coord_10027 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10028 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
        %idx_10029 = cute.crd2idx(%coord_10027, %lay_10028) : (!cute.coord<"(_,_,1)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"32">
        %iter_10030 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
        %ptr_10031 = cute.add_offset(%iter_10030, %idx_10029) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10032 = cute.make_view(%ptr_10031) : !memref_rmem_bf16_18
        %iter_10033 = cute.get_iter(%view_10032) : !memref_rmem_bf16_18
        %lay_10034 = cute.get_layout(%view_10025) : !memref_smem_bf16_19
        %2864 = cute.get_shape(%lay_10034) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10035, %e1_10036, %e2_10037, %e3_10038, %e4_10039 = cute.get_leaves(%2864) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10040 = cute.get_layout(%view_10032) : !memref_rmem_bf16_18
        %2865 = cute.get_shape(%lay_10040) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10041, %e1_10042, %e2_10043, %e3_10044 = cute.get_leaves(%2865) : !cute.shape<"((8,1),(4,2))">
        %lay_10045 = cute.get_layout(%view_10025) : !memref_smem_bf16_19
        %shape_10046 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10047 = cute.make_layout() : !cute.layout<"1:0">
        %append_10048 = cute.append_to_rank<2> (%lay_10045, %lay_10047) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10049 = cute.make_view(%iter_10026, %append_10048) : !memref_smem_bf16_19
        %iter_10050 = cute.get_iter(%view_10049) : !memref_smem_bf16_19
        %lay_10051 = cute.get_layout(%view_10049) : !memref_smem_bf16_19
        %2866 = cute.get_shape(%lay_10051) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10052, %e1_10053, %e2_10054, %e3_10055, %e4_10056 = cute.get_leaves(%2866) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10057 = cute.get_iter(%view_10049) : !memref_smem_bf16_19
        %lay_10058 = cute.get_layout(%view_10049) : !memref_smem_bf16_19
        %2867:2 = cute.get_scalars(%lay_10058) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10059 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10060 = cute.assume(%2867#0) : (i32) -> !cute.i32<divby 16>
        %iv_10061 = cute.assume(%2867#1) : (i32) -> !cute.i32<divby 32>
        %stride_10062 = cute.make_stride(%iv_10060, %iv_10061) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10063 = cute.make_layout(%shape_10059, %stride_10062) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10064 = cute.make_view(%iter_10057, %lay_10063) : !memref_smem_bf16_20
        %iter_10065 = cute.get_iter(%view_10064) : !memref_smem_bf16_20
        %iter_10066 = cute.get_iter(%view_10064) : !memref_smem_bf16_20
        %lay_10067 = cute.get_layout(%view_10032) : !memref_rmem_bf16_18
        %shape_10068 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10069 = cute.make_layout() : !cute.layout<"1:0">
        %append_10070 = cute.append_to_rank<2> (%lay_10067, %lay_10069) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10071 = cute.make_view(%iter_10033, %append_10070) : !memref_rmem_bf16_18
        %iter_10072 = cute.get_iter(%view_10071) : !memref_rmem_bf16_18
        %lay_10073 = cute.get_layout(%view_10071) : !memref_rmem_bf16_18
        %2868 = cute.get_shape(%lay_10073) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10074, %e1_10075, %e2_10076, %e3_10077 = cute.get_leaves(%2868) : !cute.shape<"((8,1),(4,2))">
        %iter_10078 = cute.get_iter(%view_10071) : !memref_rmem_bf16_18
        %view_10079 = cute.make_view(%iter_10078) : !memref_rmem_bf16_19
        %iter_10080 = cute.get_iter(%view_10079) : !memref_rmem_bf16_19
        %iter_10081 = cute.get_iter(%view_10079) : !memref_rmem_bf16_19
        %lay_10082 = cute.get_layout(%view_10064) : !memref_smem_bf16_20
        %2869 = cute.get_shape(%lay_10082) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10083, %e1_10084, %e2_10085, %e3_10086, %e4_10087 = cute.get_leaves(%2869) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10088 = cute.get_layout(%view_10079) : !memref_rmem_bf16_19
        %2870 = cute.get_shape(%lay_10088) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10089, %e1_10090, %e2_10091, %e3_10092 = cute.get_leaves(%2870) : !cute.shape<"((8,1),((4,2)))">
        %lay_10093 = cute.get_layout(%view_10064) : !memref_smem_bf16_20
        %sz_10094 = cute.size(%lay_10093) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10095 = cute.get_leaves(%sz_10094) : !cute.int_tuple<"8">
        %lay_10096 = cute.get_layout(%view_10079) : !memref_rmem_bf16_19
        %sz_10097 = cute.size(%lay_10096) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10098 = cute.get_leaves(%sz_10097) : !cute.int_tuple<"8">
        %2871 = cute.static : !cute.layout<"1:0">
        %iter_10099 = cute.get_iter(%view_10064) : !memref_smem_bf16_20
        %iter_10100 = cute.get_iter(%view_10079) : !memref_rmem_bf16_19
        %lay_10101 = cute.get_layout(%view_10064) : !memref_smem_bf16_20
        %lay_10102 = cute.get_layout(%view_10079) : !memref_rmem_bf16_19
        %append_10103 = cute.append_to_rank<2> (%lay_10101, %2871) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10104 = cute.append_to_rank<2> (%lay_10102, %2871) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2872:2 = cute.get_scalars(%append_10103) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10105 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10106 = cute.assume(%2872#0) : (i32) -> !cute.i32<divby 16>
        %iv_10107 = cute.assume(%2872#1) : (i32) -> !cute.i32<divby 32>
        %stride_10108 = cute.make_stride(%iv_10106, %iv_10107) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10109 = cute.make_layout(%shape_10105, %stride_10108) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10110 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10111 = cute.size(%lay_10109) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2873 = cute.get_scalars(%sz_10111) : !cute.int_tuple<"8">
        %c0_i32_10112 = arith.constant 0 : i32
        %c1_i32_10113 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10112 to %2873 step %c1_i32_10113  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_10109, %coord_10569) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_10109) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10572 = cute.add_offset(%iter_10099, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_10110, %coord_10569) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_10110) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_10100, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10573, %view_10577) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10114 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10115 = cute.get_layout(%view_9910) : !memref_rmem_bf16_17
        %idx_10116 = cute.crd2idx(%coord_10114, %lay_10115) : (!cute.coord<"(_,_,0)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"0">
        %iter_10117 = cute.get_iter(%view_9910) : !memref_rmem_bf16_17
        %ptr_10118 = cute.add_offset(%iter_10117, %idx_10116) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10119 = cute.make_view(%ptr_10118) : !memref_rmem_bf16_20
        %iter_10120 = cute.get_iter(%view_10119) : !memref_rmem_bf16_20
        %coord_10121 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10122 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
        %idx_10123 = cute.crd2idx(%coord_10121, %lay_10122) : (!cute.coord<"(_,_,0)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"0">
        %iter_10124 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
        %ptr_10125 = cute.add_offset(%iter_10124, %idx_10123) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10126 = cute.make_view(%ptr_10125) : !memref_rmem_bf16_21
        %iter_10127 = cute.get_iter(%view_10126) : !memref_rmem_bf16_21
        %lay_10128 = cute.get_layout(%view_10119) : !memref_rmem_bf16_20
        %2874 = cute.get_shape(%lay_10128) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10129, %e1_10130, %e2_10131, %e3_10132 = cute.get_leaves(%2874) : !cute.shape<"(((2,2),2),2)">
        %lay_10133 = cute.get_layout(%view_10126) : !memref_rmem_bf16_21
        %2875 = cute.get_shape(%lay_10133) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10134, %e1_10135, %e2_10136, %e3_10137 = cute.get_leaves(%2875) : !cute.shape<"((2,2),(8,2))">
        %lay_10138 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2876 = cute.get_shape(%lay_10138) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
        %e0_10139, %e1_10140, %e2_10141, %e3_10142 = cute.get_leaves(%2876) : !cute.shape<"((2,2),2,16)">
        %iter_10143 = cute.get_iter(%view_10119) : !memref_rmem_bf16_20
        %iter_10144 = cute.get_iter(%view_10126) : !memref_rmem_bf16_21
        %iter_10145 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10146 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10147 = cute.get_layout(%view_10119) : !memref_rmem_bf16_20
        %lay_10148 = cute.get_layout(%view_10126) : !memref_rmem_bf16_21
        %lay_10149 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10150 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2877 = cute.static : !cute.layout<"1:0">
        %append_10151 = cute.append_to_rank<3> (%lay_10147, %2877) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10152 = cute.append_to_rank<3> (%lay_10148, %2877) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10153 = cute.size(%append_10151) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10154 = cute.size(%append_10151) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10155 = cute.size(%append_10152) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2878 = cute.get_scalars(%sz_10153) : !cute.int_tuple<"1">
        %2879 = cute.get_scalars(%sz_10154) : !cute.int_tuple<"2">
        %2880 = cute.get_scalars(%sz_10155) : !cute.int_tuple<"16">
        %c0_i32_10156 = arith.constant 0 : i32
        %c1_i32_10157 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10156 to %2878 step %c1_i32_10157  : i32 {
          scf.for %arg14 = %c0_i32_10156 to %2879 step %c1_i32_10157  : i32 {
            scf.for %arg15 = %c0_i32_10156 to %2880 step %c1_i32_10157  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_10151, %coord_10569) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_10151) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10574 = cute.add_offset(%iter_10143, %idx_10573) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_22
              %slice_10576 = cute.slice(%append_10152, %coord_10570) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_10152) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_10144, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_10149, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_10149) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_10145, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_10150, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_10150) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_10146, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10158 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10159 = cute.size(%int_tuple_10158) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10160 = cute.get_leaves(%sz_10159) : !cute.int_tuple<"4">
        %coord_10161 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10162 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
        %slice_10163 = cute.slice(%lay_10162, %coord_10161) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,2)">
        %idx_10164 = cute.crd2idx(%coord_10161, %lay_10162) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"2048">
        %iter_10165 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
        %ptr_10166 = cute.add_offset(%iter_10165, %idx_10164) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"2048">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10167 = cute.make_view(%ptr_10166, %slice_10163) : !memref_smem_bf16_19
        %iter_10168 = cute.get_iter(%view_10167) : !memref_smem_bf16_19
        %coord_10169 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10170 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
        %idx_10171 = cute.crd2idx(%coord_10169, %lay_10170) : (!cute.coord<"(_,_,2)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"64">
        %iter_10172 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
        %ptr_10173 = cute.add_offset(%iter_10172, %idx_10171) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10174 = cute.make_view(%ptr_10173) : !memref_rmem_bf16_18
        %iter_10175 = cute.get_iter(%view_10174) : !memref_rmem_bf16_18
        %lay_10176 = cute.get_layout(%view_10167) : !memref_smem_bf16_19
        %2881 = cute.get_shape(%lay_10176) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10177, %e1_10178, %e2_10179, %e3_10180, %e4_10181 = cute.get_leaves(%2881) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10182 = cute.get_layout(%view_10174) : !memref_rmem_bf16_18
        %2882 = cute.get_shape(%lay_10182) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10183, %e1_10184, %e2_10185, %e3_10186 = cute.get_leaves(%2882) : !cute.shape<"((8,1),(4,2))">
        %lay_10187 = cute.get_layout(%view_10167) : !memref_smem_bf16_19
        %shape_10188 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10189 = cute.make_layout() : !cute.layout<"1:0">
        %append_10190 = cute.append_to_rank<2> (%lay_10187, %lay_10189) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10191 = cute.make_view(%iter_10168, %append_10190) : !memref_smem_bf16_19
        %iter_10192 = cute.get_iter(%view_10191) : !memref_smem_bf16_19
        %lay_10193 = cute.get_layout(%view_10191) : !memref_smem_bf16_19
        %2883 = cute.get_shape(%lay_10193) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10194, %e1_10195, %e2_10196, %e3_10197, %e4_10198 = cute.get_leaves(%2883) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10199 = cute.get_iter(%view_10191) : !memref_smem_bf16_19
        %lay_10200 = cute.get_layout(%view_10191) : !memref_smem_bf16_19
        %2884:2 = cute.get_scalars(%lay_10200) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10201 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10202 = cute.assume(%2884#0) : (i32) -> !cute.i32<divby 16>
        %iv_10203 = cute.assume(%2884#1) : (i32) -> !cute.i32<divby 32>
        %stride_10204 = cute.make_stride(%iv_10202, %iv_10203) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10205 = cute.make_layout(%shape_10201, %stride_10204) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10206 = cute.make_view(%iter_10199, %lay_10205) : !memref_smem_bf16_20
        %iter_10207 = cute.get_iter(%view_10206) : !memref_smem_bf16_20
        %iter_10208 = cute.get_iter(%view_10206) : !memref_smem_bf16_20
        %lay_10209 = cute.get_layout(%view_10174) : !memref_rmem_bf16_18
        %shape_10210 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10211 = cute.make_layout() : !cute.layout<"1:0">
        %append_10212 = cute.append_to_rank<2> (%lay_10209, %lay_10211) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10213 = cute.make_view(%iter_10175, %append_10212) : !memref_rmem_bf16_18
        %iter_10214 = cute.get_iter(%view_10213) : !memref_rmem_bf16_18
        %lay_10215 = cute.get_layout(%view_10213) : !memref_rmem_bf16_18
        %2885 = cute.get_shape(%lay_10215) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10216, %e1_10217, %e2_10218, %e3_10219 = cute.get_leaves(%2885) : !cute.shape<"((8,1),(4,2))">
        %iter_10220 = cute.get_iter(%view_10213) : !memref_rmem_bf16_18
        %view_10221 = cute.make_view(%iter_10220) : !memref_rmem_bf16_19
        %iter_10222 = cute.get_iter(%view_10221) : !memref_rmem_bf16_19
        %iter_10223 = cute.get_iter(%view_10221) : !memref_rmem_bf16_19
        %lay_10224 = cute.get_layout(%view_10206) : !memref_smem_bf16_20
        %2886 = cute.get_shape(%lay_10224) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10225, %e1_10226, %e2_10227, %e3_10228, %e4_10229 = cute.get_leaves(%2886) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10230 = cute.get_layout(%view_10221) : !memref_rmem_bf16_19
        %2887 = cute.get_shape(%lay_10230) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10231, %e1_10232, %e2_10233, %e3_10234 = cute.get_leaves(%2887) : !cute.shape<"((8,1),((4,2)))">
        %lay_10235 = cute.get_layout(%view_10206) : !memref_smem_bf16_20
        %sz_10236 = cute.size(%lay_10235) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10237 = cute.get_leaves(%sz_10236) : !cute.int_tuple<"8">
        %lay_10238 = cute.get_layout(%view_10221) : !memref_rmem_bf16_19
        %sz_10239 = cute.size(%lay_10238) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10240 = cute.get_leaves(%sz_10239) : !cute.int_tuple<"8">
        %2888 = cute.static : !cute.layout<"1:0">
        %iter_10241 = cute.get_iter(%view_10206) : !memref_smem_bf16_20
        %iter_10242 = cute.get_iter(%view_10221) : !memref_rmem_bf16_19
        %lay_10243 = cute.get_layout(%view_10206) : !memref_smem_bf16_20
        %lay_10244 = cute.get_layout(%view_10221) : !memref_rmem_bf16_19
        %append_10245 = cute.append_to_rank<2> (%lay_10243, %2888) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10246 = cute.append_to_rank<2> (%lay_10244, %2888) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2889:2 = cute.get_scalars(%append_10245) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10247 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10248 = cute.assume(%2889#0) : (i32) -> !cute.i32<divby 16>
        %iv_10249 = cute.assume(%2889#1) : (i32) -> !cute.i32<divby 32>
        %stride_10250 = cute.make_stride(%iv_10248, %iv_10249) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10251 = cute.make_layout(%shape_10247, %stride_10250) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10252 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10253 = cute.size(%lay_10251) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2890 = cute.get_scalars(%sz_10253) : !cute.int_tuple<"8">
        %c0_i32_10254 = arith.constant 0 : i32
        %c1_i32_10255 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10254 to %2890 step %c1_i32_10255  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_10251, %coord_10569) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_10251) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10572 = cute.add_offset(%iter_10241, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_10252, %coord_10569) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_10252) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_10242, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10573, %view_10577) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10256 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10257 = cute.get_layout(%view_9910) : !memref_rmem_bf16_17
        %idx_10258 = cute.crd2idx(%coord_10256, %lay_10257) : (!cute.coord<"(_,_,1)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"16">
        %iter_10259 = cute.get_iter(%view_9910) : !memref_rmem_bf16_17
        %ptr_10260 = cute.add_offset(%iter_10259, %idx_10258) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10261 = cute.make_view(%ptr_10260) : !memref_rmem_bf16_20
        %iter_10262 = cute.get_iter(%view_10261) : !memref_rmem_bf16_20
        %coord_10263 = cute.make_coord() : () -> !cute.coord<"(_,_,1)">
        %lay_10264 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
        %idx_10265 = cute.crd2idx(%coord_10263, %lay_10264) : (!cute.coord<"(_,_,1)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"32">
        %iter_10266 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
        %ptr_10267 = cute.add_offset(%iter_10266, %idx_10265) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10268 = cute.make_view(%ptr_10267) : !memref_rmem_bf16_21
        %iter_10269 = cute.get_iter(%view_10268) : !memref_rmem_bf16_21
        %lay_10270 = cute.get_layout(%view_10261) : !memref_rmem_bf16_20
        %2891 = cute.get_shape(%lay_10270) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10271, %e1_10272, %e2_10273, %e3_10274 = cute.get_leaves(%2891) : !cute.shape<"(((2,2),2),2)">
        %lay_10275 = cute.get_layout(%view_10268) : !memref_rmem_bf16_21
        %2892 = cute.get_shape(%lay_10275) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10276, %e1_10277, %e2_10278, %e3_10279 = cute.get_leaves(%2892) : !cute.shape<"((2,2),(8,2))">
        %iter_10280 = cute.get_iter(%view_10261) : !memref_rmem_bf16_20
        %iter_10281 = cute.get_iter(%view_10268) : !memref_rmem_bf16_21
        %iter_10282 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10283 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10284 = cute.get_layout(%view_10261) : !memref_rmem_bf16_20
        %lay_10285 = cute.get_layout(%view_10268) : !memref_rmem_bf16_21
        %lay_10286 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10287 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2893 = cute.static : !cute.layout<"1:0">
        %append_10288 = cute.append_to_rank<3> (%lay_10284, %2893) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10289 = cute.append_to_rank<3> (%lay_10285, %2893) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10290 = cute.size(%append_10288) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10291 = cute.size(%append_10288) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10292 = cute.size(%append_10289) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2894 = cute.get_scalars(%sz_10290) : !cute.int_tuple<"1">
        %2895 = cute.get_scalars(%sz_10291) : !cute.int_tuple<"2">
        %2896 = cute.get_scalars(%sz_10292) : !cute.int_tuple<"16">
        %c0_i32_10293 = arith.constant 0 : i32
        %c1_i32_10294 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10293 to %2894 step %c1_i32_10294  : i32 {
          scf.for %arg14 = %c0_i32_10293 to %2895 step %c1_i32_10294  : i32 {
            scf.for %arg15 = %c0_i32_10293 to %2896 step %c1_i32_10294  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_10288, %coord_10569) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_10288) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10574 = cute.add_offset(%iter_10280, %idx_10573) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_22
              %slice_10576 = cute.slice(%append_10289, %coord_10570) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_10289) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_10281, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_10286, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_10286) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_10282, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_10287, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_10287) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_10283, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10295 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10296 = cute.size(%int_tuple_10295) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10297 = cute.get_leaves(%sz_10296) : !cute.int_tuple<"4">
        %coord_10298 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10299 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
        %slice_10300 = cute.slice(%lay_10299, %coord_10298) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,3)">
        %idx_10301 = cute.crd2idx(%coord_10298, %lay_10299) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"3072">
        %iter_10302 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
        %ptr_10303 = cute.add_offset(%iter_10302, %idx_10301) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"3072">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10304 = cute.make_view(%ptr_10303, %slice_10300) : !memref_smem_bf16_19
        %iter_10305 = cute.get_iter(%view_10304) : !memref_smem_bf16_19
        %coord_10306 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10307 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
        %idx_10308 = cute.crd2idx(%coord_10306, %lay_10307) : (!cute.coord<"(_,_,3)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"96">
        %iter_10309 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
        %ptr_10310 = cute.add_offset(%iter_10309, %idx_10308) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10311 = cute.make_view(%ptr_10310) : !memref_rmem_bf16_18
        %iter_10312 = cute.get_iter(%view_10311) : !memref_rmem_bf16_18
        %lay_10313 = cute.get_layout(%view_10304) : !memref_smem_bf16_19
        %2897 = cute.get_shape(%lay_10313) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10314, %e1_10315, %e2_10316, %e3_10317, %e4_10318 = cute.get_leaves(%2897) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10319 = cute.get_layout(%view_10311) : !memref_rmem_bf16_18
        %2898 = cute.get_shape(%lay_10319) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10320, %e1_10321, %e2_10322, %e3_10323 = cute.get_leaves(%2898) : !cute.shape<"((8,1),(4,2))">
        %lay_10324 = cute.get_layout(%view_10304) : !memref_smem_bf16_19
        %shape_10325 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10326 = cute.make_layout() : !cute.layout<"1:0">
        %append_10327 = cute.append_to_rank<2> (%lay_10324, %lay_10326) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10328 = cute.make_view(%iter_10305, %append_10327) : !memref_smem_bf16_19
        %iter_10329 = cute.get_iter(%view_10328) : !memref_smem_bf16_19
        %lay_10330 = cute.get_layout(%view_10328) : !memref_smem_bf16_19
        %2899 = cute.get_shape(%lay_10330) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10331, %e1_10332, %e2_10333, %e3_10334, %e4_10335 = cute.get_leaves(%2899) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10336 = cute.get_iter(%view_10328) : !memref_smem_bf16_19
        %lay_10337 = cute.get_layout(%view_10328) : !memref_smem_bf16_19
        %2900:2 = cute.get_scalars(%lay_10337) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10338 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10339 = cute.assume(%2900#0) : (i32) -> !cute.i32<divby 16>
        %iv_10340 = cute.assume(%2900#1) : (i32) -> !cute.i32<divby 32>
        %stride_10341 = cute.make_stride(%iv_10339, %iv_10340) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10342 = cute.make_layout(%shape_10338, %stride_10341) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10343 = cute.make_view(%iter_10336, %lay_10342) : !memref_smem_bf16_20
        %iter_10344 = cute.get_iter(%view_10343) : !memref_smem_bf16_20
        %iter_10345 = cute.get_iter(%view_10343) : !memref_smem_bf16_20
        %lay_10346 = cute.get_layout(%view_10311) : !memref_rmem_bf16_18
        %shape_10347 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10348 = cute.make_layout() : !cute.layout<"1:0">
        %append_10349 = cute.append_to_rank<2> (%lay_10346, %lay_10348) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10350 = cute.make_view(%iter_10312, %append_10349) : !memref_rmem_bf16_18
        %iter_10351 = cute.get_iter(%view_10350) : !memref_rmem_bf16_18
        %lay_10352 = cute.get_layout(%view_10350) : !memref_rmem_bf16_18
        %2901 = cute.get_shape(%lay_10352) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10353, %e1_10354, %e2_10355, %e3_10356 = cute.get_leaves(%2901) : !cute.shape<"((8,1),(4,2))">
        %iter_10357 = cute.get_iter(%view_10350) : !memref_rmem_bf16_18
        %view_10358 = cute.make_view(%iter_10357) : !memref_rmem_bf16_19
        %iter_10359 = cute.get_iter(%view_10358) : !memref_rmem_bf16_19
        %iter_10360 = cute.get_iter(%view_10358) : !memref_rmem_bf16_19
        %lay_10361 = cute.get_layout(%view_10343) : !memref_smem_bf16_20
        %2902 = cute.get_shape(%lay_10361) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10362, %e1_10363, %e2_10364, %e3_10365, %e4_10366 = cute.get_leaves(%2902) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10367 = cute.get_layout(%view_10358) : !memref_rmem_bf16_19
        %2903 = cute.get_shape(%lay_10367) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10368, %e1_10369, %e2_10370, %e3_10371 = cute.get_leaves(%2903) : !cute.shape<"((8,1),((4,2)))">
        %lay_10372 = cute.get_layout(%view_10343) : !memref_smem_bf16_20
        %sz_10373 = cute.size(%lay_10372) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10374 = cute.get_leaves(%sz_10373) : !cute.int_tuple<"8">
        %lay_10375 = cute.get_layout(%view_10358) : !memref_rmem_bf16_19
        %sz_10376 = cute.size(%lay_10375) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10377 = cute.get_leaves(%sz_10376) : !cute.int_tuple<"8">
        %2904 = cute.static : !cute.layout<"1:0">
        %iter_10378 = cute.get_iter(%view_10343) : !memref_smem_bf16_20
        %iter_10379 = cute.get_iter(%view_10358) : !memref_rmem_bf16_19
        %lay_10380 = cute.get_layout(%view_10343) : !memref_smem_bf16_20
        %lay_10381 = cute.get_layout(%view_10358) : !memref_rmem_bf16_19
        %append_10382 = cute.append_to_rank<2> (%lay_10380, %2904) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10383 = cute.append_to_rank<2> (%lay_10381, %2904) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2905:2 = cute.get_scalars(%append_10382) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10384 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10385 = cute.assume(%2905#0) : (i32) -> !cute.i32<divby 16>
        %iv_10386 = cute.assume(%2905#1) : (i32) -> !cute.i32<divby 32>
        %stride_10387 = cute.make_stride(%iv_10385, %iv_10386) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10388 = cute.make_layout(%shape_10384, %stride_10387) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10389 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10390 = cute.size(%lay_10388) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2906 = cute.get_scalars(%sz_10390) : !cute.int_tuple<"8">
        %c0_i32_10391 = arith.constant 0 : i32
        %c1_i32_10392 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10391 to %2906 step %c1_i32_10392  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_10388, %coord_10569) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_10388) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10572 = cute.add_offset(%iter_10378, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_10389, %coord_10569) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_10389) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_10379, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10573, %view_10577) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10393 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10394 = cute.get_layout(%view_9910) : !memref_rmem_bf16_17
        %idx_10395 = cute.crd2idx(%coord_10393, %lay_10394) : (!cute.coord<"(_,_,2)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"32">
        %iter_10396 = cute.get_iter(%view_9910) : !memref_rmem_bf16_17
        %ptr_10397 = cute.add_offset(%iter_10396, %idx_10395) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10398 = cute.make_view(%ptr_10397) : !memref_rmem_bf16_20
        %iter_10399 = cute.get_iter(%view_10398) : !memref_rmem_bf16_20
        %coord_10400 = cute.make_coord() : () -> !cute.coord<"(_,_,2)">
        %lay_10401 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
        %idx_10402 = cute.crd2idx(%coord_10400, %lay_10401) : (!cute.coord<"(_,_,2)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"64">
        %iter_10403 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
        %ptr_10404 = cute.add_offset(%iter_10403, %idx_10402) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10405 = cute.make_view(%ptr_10404) : !memref_rmem_bf16_21
        %iter_10406 = cute.get_iter(%view_10405) : !memref_rmem_bf16_21
        %lay_10407 = cute.get_layout(%view_10398) : !memref_rmem_bf16_20
        %2907 = cute.get_shape(%lay_10407) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10408, %e1_10409, %e2_10410, %e3_10411 = cute.get_leaves(%2907) : !cute.shape<"(((2,2),2),2)">
        %lay_10412 = cute.get_layout(%view_10405) : !memref_rmem_bf16_21
        %2908 = cute.get_shape(%lay_10412) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10413, %e1_10414, %e2_10415, %e3_10416 = cute.get_leaves(%2908) : !cute.shape<"((2,2),(8,2))">
        %iter_10417 = cute.get_iter(%view_10398) : !memref_rmem_bf16_20
        %iter_10418 = cute.get_iter(%view_10405) : !memref_rmem_bf16_21
        %iter_10419 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10420 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10421 = cute.get_layout(%view_10398) : !memref_rmem_bf16_20
        %lay_10422 = cute.get_layout(%view_10405) : !memref_rmem_bf16_21
        %lay_10423 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10424 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2909 = cute.static : !cute.layout<"1:0">
        %append_10425 = cute.append_to_rank<3> (%lay_10421, %2909) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10426 = cute.append_to_rank<3> (%lay_10422, %2909) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10427 = cute.size(%append_10425) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10428 = cute.size(%append_10425) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10429 = cute.size(%append_10426) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2910 = cute.get_scalars(%sz_10427) : !cute.int_tuple<"1">
        %2911 = cute.get_scalars(%sz_10428) : !cute.int_tuple<"2">
        %2912 = cute.get_scalars(%sz_10429) : !cute.int_tuple<"16">
        %c0_i32_10430 = arith.constant 0 : i32
        %c1_i32_10431 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10430 to %2910 step %c1_i32_10431  : i32 {
          scf.for %arg14 = %c0_i32_10430 to %2911 step %c1_i32_10431  : i32 {
            scf.for %arg15 = %c0_i32_10430 to %2912 step %c1_i32_10431  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_10425, %coord_10569) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_10425) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10574 = cute.add_offset(%iter_10417, %idx_10573) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_22
              %slice_10576 = cute.slice(%append_10426, %coord_10570) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_10426) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_10418, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_10423, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_10423) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_10419, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_10424, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_10424) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_10420, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        %int_tuple_10432 = cute.make_int_tuple() : () -> !cute.int_tuple<"4">
        %sz_10433 = cute.size(%int_tuple_10432) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4">
        %e0_10434 = cute.get_leaves(%sz_10433) : !cute.int_tuple<"4">
        %coord_10435 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10436 = cute.get_layout(%src_partitioned_383) : !memref_smem_bf16_10
        %slice_10437 = cute.slice(%lay_10436, %coord_10435) : !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">, !cute.coord<"(_,_,0)">
        %idx_10438 = cute.crd2idx(%coord_10435, %lay_10436) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">) -> !cute.int_tuple<"0">
        %iter_10439 = cute.get_iter(%src_partitioned_383) : !memref_smem_bf16_10
        %ptr_10440 = cute.add_offset(%iter_10439, %idx_10438) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, smem, align<16>>
        %view_10441 = cute.make_view(%ptr_10440, %slice_10437) : !memref_smem_bf16_19
        %iter_10442 = cute.get_iter(%view_10441) : !memref_smem_bf16_19
        %coord_10443 = cute.make_coord() : () -> !cute.coord<"(_,_,0)">
        %lay_10444 = cute.get_layout(%retiled_385) : !memref_rmem_bf16_5
        %idx_10445 = cute.crd2idx(%coord_10443, %lay_10444) : (!cute.coord<"(_,_,0)">, !cute.layout<"((8,1),(4,2),4):((1,0),(8,128),32)">) -> !cute.int_tuple<"0">
        %iter_10446 = cute.get_iter(%retiled_385) : !memref_rmem_bf16_5
        %ptr_10447 = cute.add_offset(%iter_10446, %idx_10445) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10448 = cute.make_view(%ptr_10447) : !memref_rmem_bf16_18
        %iter_10449 = cute.get_iter(%view_10448) : !memref_rmem_bf16_18
        %lay_10450 = cute.get_layout(%view_10441) : !memref_smem_bf16_19
        %2913 = cute.get_shape(%lay_10450) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10451, %e1_10452, %e2_10453, %e3_10454, %e4_10455 = cute.get_leaves(%2913) : !cute.shape<"((8,1),((2,2),2))">
        %lay_10456 = cute.get_layout(%view_10448) : !memref_rmem_bf16_18
        %2914 = cute.get_shape(%lay_10456) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10457, %e1_10458, %e2_10459, %e3_10460 = cute.get_leaves(%2914) : !cute.shape<"((8,1),(4,2))">
        %lay_10461 = cute.get_layout(%view_10441) : !memref_smem_bf16_19
        %shape_10462 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10463 = cute.make_layout() : !cute.layout<"1:0">
        %append_10464 = cute.append_to_rank<2> (%lay_10461, %lay_10463) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0">
        %view_10465 = cute.make_view(%iter_10442, %append_10464) : !memref_smem_bf16_19
        %iter_10466 = cute.get_iter(%view_10465) : !memref_smem_bf16_19
        %lay_10467 = cute.get_layout(%view_10465) : !memref_smem_bf16_19
        %2915 = cute.get_shape(%lay_10467) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))">
        %e0_10468, %e1_10469, %e2_10470, %e3_10471, %e4_10472 = cute.get_leaves(%2915) : !cute.shape<"((8,1),((2,2),2))">
        %iter_10473 = cute.get_iter(%view_10465) : !memref_smem_bf16_19
        %lay_10474 = cute.get_layout(%view_10465) : !memref_smem_bf16_19
        %2916:2 = cute.get_scalars(%lay_10474) <{only_dynamic}> : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
        %shape_10475 = cute.make_shape() : () -> !cute.shape<"((8,1),(((2,2),2)))">
        %iv_10476 = cute.assume(%2916#0) : (i32) -> !cute.i32<divby 16>
        %iv_10477 = cute.assume(%2916#1) : (i32) -> !cute.i32<divby 32>
        %stride_10478 = cute.make_stride(%iv_10476, %iv_10477) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),(((?{div=16},?{div=32}),4096)))">
        %lay_10479 = cute.make_layout(%shape_10475, %stride_10478) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %view_10480 = cute.make_view(%iter_10473, %lay_10479) : !memref_smem_bf16_20
        %iter_10481 = cute.get_iter(%view_10480) : !memref_smem_bf16_20
        %iter_10482 = cute.get_iter(%view_10480) : !memref_smem_bf16_20
        %lay_10483 = cute.get_layout(%view_10448) : !memref_rmem_bf16_18
        %shape_10484 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_10485 = cute.make_layout() : !cute.layout<"1:0">
        %append_10486 = cute.append_to_rank<2> (%lay_10483, %lay_10485) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0">
        %view_10487 = cute.make_view(%iter_10449, %append_10486) : !memref_rmem_bf16_18
        %iter_10488 = cute.get_iter(%view_10487) : !memref_rmem_bf16_18
        %lay_10489 = cute.get_layout(%view_10487) : !memref_rmem_bf16_18
        %2917 = cute.get_shape(%lay_10489) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))">
        %e0_10490, %e1_10491, %e2_10492, %e3_10493 = cute.get_leaves(%2917) : !cute.shape<"((8,1),(4,2))">
        %iter_10494 = cute.get_iter(%view_10487) : !memref_rmem_bf16_18
        %view_10495 = cute.make_view(%iter_10494) : !memref_rmem_bf16_19
        %iter_10496 = cute.get_iter(%view_10495) : !memref_rmem_bf16_19
        %iter_10497 = cute.get_iter(%view_10495) : !memref_rmem_bf16_19
        %lay_10498 = cute.get_layout(%view_10480) : !memref_smem_bf16_20
        %2918 = cute.get_shape(%lay_10498) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))">
        %e0_10499, %e1_10500, %e2_10501, %e3_10502, %e4_10503 = cute.get_leaves(%2918) : !cute.shape<"((8,1),(((2,2),2)))">
        %lay_10504 = cute.get_layout(%view_10495) : !memref_rmem_bf16_19
        %2919 = cute.get_shape(%lay_10504) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))">
        %e0_10505, %e1_10506, %e2_10507, %e3_10508 = cute.get_leaves(%2919) : !cute.shape<"((8,1),((4,2)))">
        %lay_10509 = cute.get_layout(%view_10480) : !memref_smem_bf16_20
        %sz_10510 = cute.size(%lay_10509) <{mode = [1]}> : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.int_tuple<"8">
        %e0_10511 = cute.get_leaves(%sz_10510) : !cute.int_tuple<"8">
        %lay_10512 = cute.get_layout(%view_10495) : !memref_rmem_bf16_19
        %sz_10513 = cute.size(%lay_10512) <{mode = [1]}> : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.int_tuple<"8">
        %e0_10514 = cute.get_leaves(%sz_10513) : !cute.int_tuple<"8">
        %2920 = cute.static : !cute.layout<"1:0">
        %iter_10515 = cute.get_iter(%view_10480) : !memref_smem_bf16_20
        %iter_10516 = cute.get_iter(%view_10495) : !memref_rmem_bf16_19
        %lay_10517 = cute.get_layout(%view_10480) : !memref_smem_bf16_20
        %lay_10518 = cute.get_layout(%view_10495) : !memref_rmem_bf16_19
        %append_10519 = cute.append_to_rank<2> (%lay_10517, %2920) : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">, !cute.layout<"1:0">
        %append_10520 = cute.append_to_rank<2> (%lay_10518, %2920) : !cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">, !cute.layout<"1:0">
        %2921:2 = cute.get_scalars(%append_10519) <{only_dynamic}> : !cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
        %shape_10521 = cute.make_shape() : () -> !cute.shape<"((8,1),((((2,2),2))))">
        %iv_10522 = cute.assume(%2921#0) : (i32) -> !cute.i32<divby 16>
        %iv_10523 = cute.assume(%2921#1) : (i32) -> !cute.i32<divby 32>
        %stride_10524 = cute.make_stride(%iv_10522, %iv_10523) : (!cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10525 = cute.make_layout(%shape_10521, %stride_10524) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">
        %lay_10526 = cute.make_layout() : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">
        %sz_10527 = cute.size(%lay_10525) <{mode = [1]}> : (!cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"8">
        %2922 = cute.get_scalars(%sz_10527) : !cute.int_tuple<"8">
        %c0_i32_10528 = arith.constant 0 : i32
        %c1_i32_10529 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10528 to %2922 step %c1_i32_10529  : i32 {
          %coord_10569 = cute.make_coord(%arg13) : (i32) -> !cute.coord<"(_,?)">
          %slice_10570 = cute.slice(%lay_10525, %coord_10569) : !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">, !cute.coord<"(_,?)">
          %idx_10571 = cute.crd2idx(%coord_10569, %lay_10525) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((((2,2),2)))):((1,0),((((?{div=16},?{div=32}),4096))))">) -> !cute.int_tuple<"?{div=16}">
          %ptr_10572 = cute.add_offset(%iter_10515, %idx_10571) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<16>>
          %view_10573 = cute.make_view(%ptr_10572, %slice_10570) : !memref_smem_bf16_13
          %slice_10574 = cute.slice(%lay_10526, %coord_10569) : !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">, !cute.coord<"(_,?)">
          %idx_10575 = cute.crd2idx(%coord_10569, %lay_10526) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),(((4,2)))):((1,0),(((8,128))))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_10576 = cute.add_offset(%iter_10516, %idx_10575) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<8>>
          %view_10577 = cute.make_view(%ptr_10576, %slice_10574) : !memref_rmem_bf16_11
          cute.copy_atom_call(%158, %view_10573, %view_10577) : (!copy_ldsm_4_2, !memref_smem_bf16_13, !memref_rmem_bf16_11) -> ()
        } {llvm.loop_annotation = #loop_annotation}
        %coord_10530 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10531 = cute.get_layout(%view_9910) : !memref_rmem_bf16_17
        %idx_10532 = cute.crd2idx(%coord_10530, %lay_10531) : (!cute.coord<"(_,_,3)">, !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.int_tuple<"48">
        %iter_10533 = cute.get_iter(%view_9910) : !memref_rmem_bf16_17
        %ptr_10534 = cute.add_offset(%iter_10533, %idx_10532) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_10535 = cute.make_view(%ptr_10534) : !memref_rmem_bf16_20
        %iter_10536 = cute.get_iter(%view_10535) : !memref_rmem_bf16_20
        %coord_10537 = cute.make_coord() : () -> !cute.coord<"(_,_,3)">
        %lay_10538 = cute.get_layout(%frg_B_309) : !memref_rmem_bf16_2
        %idx_10539 = cute.crd2idx(%coord_10537, %lay_10538) : (!cute.coord<"(_,_,3)">, !cute.layout<"((2,2),(8,2),4):((1,2),(4,128),32)">) -> !cute.int_tuple<"96">
        %iter_10540 = cute.get_iter(%frg_B_309) : !memref_rmem_bf16_2
        %ptr_10541 = cute.add_offset(%iter_10540, %idx_10539) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_10542 = cute.make_view(%ptr_10541) : !memref_rmem_bf16_21
        %iter_10543 = cute.get_iter(%view_10542) : !memref_rmem_bf16_21
        %lay_10544 = cute.get_layout(%view_10535) : !memref_rmem_bf16_20
        %2923 = cute.get_shape(%lay_10544) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)">
        %e0_10545, %e1_10546, %e2_10547, %e3_10548 = cute.get_leaves(%2923) : !cute.shape<"(((2,2),2),2)">
        %lay_10549 = cute.get_layout(%view_10542) : !memref_rmem_bf16_21
        %2924 = cute.get_shape(%lay_10549) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))">
        %e0_10550, %e1_10551, %e2_10552, %e3_10553 = cute.get_leaves(%2924) : !cute.shape<"((2,2),(8,2))">
        %iter_10554 = cute.get_iter(%view_10535) : !memref_rmem_bf16_20
        %iter_10555 = cute.get_iter(%view_10542) : !memref_rmem_bf16_21
        %iter_10556 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %iter_10557 = cute.get_iter(%rmem) : !memref_rmem_f32_
        %lay_10558 = cute.get_layout(%view_10535) : !memref_rmem_bf16_20
        %lay_10559 = cute.get_layout(%view_10542) : !memref_rmem_bf16_21
        %lay_10560 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %lay_10561 = cute.get_layout(%rmem) : !memref_rmem_f32_
        %2925 = cute.static : !cute.layout<"1:0">
        %append_10562 = cute.append_to_rank<3> (%lay_10558, %2925) : !cute.layout<"(((2,2),2),2):(((1,2),8),4)">, !cute.layout<"1:0">
        %append_10563 = cute.append_to_rank<3> (%lay_10559, %2925) : !cute.layout<"((2,2),(8,2)):((1,2),(4,128))">, !cute.layout<"1:0">
        %sz_10564 = cute.size(%append_10562) <{mode = [2]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"1">
        %sz_10565 = cute.size(%append_10562) <{mode = [1]}> : (!cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"2">
        %sz_10566 = cute.size(%append_10563) <{mode = [1]}> : (!cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"16">
        %2926 = cute.get_scalars(%sz_10564) : !cute.int_tuple<"1">
        %2927 = cute.get_scalars(%sz_10565) : !cute.int_tuple<"2">
        %2928 = cute.get_scalars(%sz_10566) : !cute.int_tuple<"16">
        %c0_i32_10567 = arith.constant 0 : i32
        %c1_i32_10568 = arith.constant 1 : i32
        scf.for %arg13 = %c0_i32_10567 to %2926 step %c1_i32_10568  : i32 {
          scf.for %arg14 = %c0_i32_10567 to %2927 step %c1_i32_10568  : i32 {
            scf.for %arg15 = %c0_i32_10567 to %2928 step %c1_i32_10568  : i32 {
              %coord_10569 = cute.make_coord(%arg14, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10570 = cute.make_coord(%arg15, %arg13) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %coord_10571 = cute.make_coord(%arg14, %arg15) : (i32, i32) -> !cute.coord<"(_,?,?)">
              %slice_10572 = cute.slice(%append_10562, %coord_10569) : !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">, !cute.coord<"(_,?,?)">
              %idx_10573 = cute.crd2idx(%coord_10569, %append_10562) : (!cute.coord<"(_,?,?)">, !cute.layout<"(((2,2),2),2,1):(((1,2),8),4,0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10574 = cute.add_offset(%iter_10554, %idx_10573) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10575 = cute.make_view(%ptr_10574, %slice_10572) : !memref_rmem_bf16_22
              %slice_10576 = cute.slice(%append_10563, %coord_10570) : !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">, !cute.coord<"(_,?,?)">
              %idx_10577 = cute.crd2idx(%coord_10570, %append_10563) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),(8,2),1):((1,2),(4,128),0)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10578 = cute.add_offset(%iter_10555, %idx_10577) : (!cute.ptr<bf16, rmem, align<8>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
              %view_10579 = cute.make_view(%ptr_10578, %slice_10576) : !memref_rmem_bf16_15
              %slice_10580 = cute.slice(%lay_10560, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10581 = cute.crd2idx(%coord_10571, %lay_10560) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10582 = cute.add_offset(%iter_10556, %idx_10581) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10583 = cute.make_view(%ptr_10582, %slice_10580) : !memref_rmem_f32_3
              %slice_10584 = cute.slice(%lay_10561, %coord_10571) : !cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.coord<"(_,?,?)">
              %idx_10585 = cute.crd2idx(%coord_10571, %lay_10561) : (!cute.coord<"(_,?,?)">, !cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.int_tuple<"?{div=4}">
              %ptr_10586 = cute.add_offset(%iter_10557, %idx_10585) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<f32, rmem, align<16>>
              %view_10587 = cute.make_view(%ptr_10586, %slice_10584) : !memref_rmem_f32_3
              cute.mma_atom_call(%5, %view_10587, %view_10575, %view_10579, %view_10583) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_3, !memref_rmem_bf16_22, !memref_rmem_bf16_15, !memref_rmem_f32_3) -> ()
            } {llvm.loop_annotation = #loop_annotation}
          } {llvm.loop_annotation = #loop_annotation}
        } {llvm.loop_annotation = #loop_annotation}
        scf.yield %2504, %arg7, %2504, %arg9, %arg10, %arg11, %arg12 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32
      }
      %iter_6841 = cute.get_iter(%2117#3) : !memref_gmem_bf16_
      %lay_6842 = cute.get_layout(%2117#3) : !memref_gmem_bf16_
      %2118 = cute.get_shape(%lay_6842) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6843, %e1_6844, %e2_6845, %e3_6846 = cute.get_leaves(%2118) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6847 = cute.to_int_tuple(%e0_6843) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2119 = cute.get_scalars(%itup_6847) : !cute.int_tuple<"?">
      %itup_6848 = cute.to_int_tuple(%e1_6844) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2120 = cute.get_scalars(%itup_6848) : !cute.int_tuple<"?">
      %itup_6849 = cute.to_int_tuple(%e2_6845) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2121 = cute.get_scalars(%itup_6849) : !cute.int_tuple<"?">
      %itup_6850 = cute.to_int_tuple(%e3_6846) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2122 = cute.get_scalars(%itup_6850) : !cute.int_tuple<"?{div=8}">
      %2123 = cute.get_stride(%lay_6842) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_6851, %e1_6852, %e2_6853, %e3_6854 = cute.get_leaves(%2123) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_6855 = cute.to_int_tuple(%e0_6851) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2124 = cute.get_scalars(%itup_6855) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6856 = cute.to_int_tuple(%e1_6852) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2125 = cute.get_scalars(%itup_6856) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6857 = cute.to_int_tuple(%e2_6853) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2126 = cute.get_scalars(%itup_6857) : !cute.int_tuple<"?{i64 div=8}">
      %iter_6858 = cute.get_iter(%2117#4) : !memref_gmem_bf16_
      %lay_6859 = cute.get_layout(%2117#4) : !memref_gmem_bf16_
      %2127 = cute.get_shape(%lay_6859) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_6860, %e1_6861, %e2_6862, %e3_6863 = cute.get_leaves(%2127) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_6864 = cute.to_int_tuple(%e0_6860) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2128 = cute.get_scalars(%itup_6864) : !cute.int_tuple<"?">
      %itup_6865 = cute.to_int_tuple(%e1_6861) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2129 = cute.get_scalars(%itup_6865) : !cute.int_tuple<"?">
      %itup_6866 = cute.to_int_tuple(%e2_6862) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2130 = cute.get_scalars(%itup_6866) : !cute.int_tuple<"?">
      %itup_6867 = cute.to_int_tuple(%e3_6863) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2131 = cute.get_scalars(%itup_6867) : !cute.int_tuple<"?{div=8}">
      %2132 = cute.get_stride(%lay_6859) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %e0_6868, %e1_6869, %e2_6870, %e3_6871 = cute.get_leaves(%2132) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
      %itup_6872 = cute.to_int_tuple(%e0_6868) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2133 = cute.get_scalars(%itup_6872) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6873 = cute.to_int_tuple(%e1_6869) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2134 = cute.get_scalars(%itup_6873) : !cute.int_tuple<"?{i64 div=8}">
      %itup_6874 = cute.to_int_tuple(%e2_6870) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
      %2135 = cute.get_scalars(%itup_6874) : !cute.int_tuple<"?{i64 div=8}">
      %iter_6875 = cute.get_iter(%2117#3) : !memref_gmem_bf16_
      %iter_6876 = cute.get_iter(%2117#3) : !memref_gmem_bf16_
      %iter_6877 = cute.get_iter(%2117#4) : !memref_gmem_bf16_
      %iter_6878 = cute.get_iter(%2117#4) : !memref_gmem_bf16_
      %lay_6879 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2136 = cute.get_shape(%lay_6879) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6880, %e1_6881, %e2_6882, %e3_6883 = cute.get_leaves(%2136) : !cute.shape<"((2,2),2,16)">
      %shape_6884 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)">
      %lay_6885 = cute.make_layout() : !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %2137 = cute.get_shape(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6886, %e1_6887, %e2_6888, %e3_6889 = cute.get_leaves(%2137) : !cute.shape<"((2,2),2,16)">
      %2138 = cute.get_shape(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6890, %e1_6891, %e2_6892, %e3_6893 = cute.get_leaves(%2138) : !cute.shape<"((2,2),2,16)">
      %2139 = cute.get_shape(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6894, %e1_6895, %e2_6896, %e3_6897 = cute.get_leaves(%2139) : !cute.shape<"((2,2),2,16)">
      %2140 = cute.get_shape(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_6898, %e1_6899, %e2_6900, %e3_6901 = cute.get_leaves(%2140) : !cute.shape<"((2,2),2,16)">
      %2141 = cute.get_stride(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_6902, %e1_6903, %e2_6904, %e3_6905 = cute.get_leaves(%2141) : !cute.stride<"((1,2),4,8)">
      %2142 = cute.get_stride(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_6906, %e1_6907, %e2_6908, %e3_6909 = cute.get_leaves(%2142) : !cute.stride<"((1,2),4,8)">
      %2143 = cute.get_stride(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_6910, %e1_6911, %e2_6912, %e3_6913 = cute.get_leaves(%2143) : !cute.stride<"((1,2),4,8)">
      %2144 = cute.get_stride(%lay_6885) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)">
      %e0_6914, %e1_6915, %e2_6916, %e3_6917 = cute.get_leaves(%2144) : !cute.stride<"((1,2),4,8)">
      %shape_6918 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))">
      %stride_6919 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))">
      %lay_6920 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %lay_6921 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %lay_6922 = cute.make_layout() : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">
      %view_6923 = cute.make_view(%iter_319, %lay_6922) : !memref_rmem_f32_5
      %iter_6924 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %lay_6925 = cute.get_layout(%rmem_1067) : !memref_rmem_f32_1
      %sz_6926 = cute.size(%lay_6925) : (!cute.layout<"4:1">) -> !cute.int_tuple<"4">
      %e0_6927 = cute.get_leaves(%sz_6926) : !cute.int_tuple<"4">
      %coord_6928 = cute.make_coord() : () -> !cute.coord<"0">
      %2145 = cute.memref.load(%rmem_1067, %coord_6928) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %c-1_i32_6929 = arith.constant -1 : i32
      %c2_i32_6930 = arith.constant 2 : i32
      %c31_i32_6931 = arith.constant 31 : i32
      %2146 = nvvm.shfl.sync  bfly %c-1_i32_6929, %2145, %c2_i32_6930, %c31_i32_6931 : f32 -> f32
      %2147 = arith.addf %2145, %2146 : f32
      %c-1_i32_6932 = arith.constant -1 : i32
      %c1_i32_6933 = arith.constant 1 : i32
      %c31_i32_6934 = arith.constant 31 : i32
      %2148 = nvvm.shfl.sync  bfly %c-1_i32_6932, %2147, %c1_i32_6933, %c31_i32_6934 : f32 -> f32
      %2149 = arith.addf %2147, %2148 : f32
      %coord_6935 = cute.make_coord() : () -> !cute.coord<"0">
      cute.memref.store(%rmem_1067, %coord_6935, %2149) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> ()
      %coord_6936 = cute.make_coord() : () -> !cute.coord<"0">
      %2150 = cute.memref.load(%rmem_1067, %coord_6936) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %cst_6937 = arith.constant 0.000000e+00 : f32
      %2151 = arith.cmpf oeq, %2150, %cst_6937 : f32
      %coord_6938 = cute.make_coord() : () -> !cute.coord<"0">
      %2152 = cute.memref.load(%rmem_1067, %coord_6938) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2153 = arith.cmpf oeq, %2152, %cst_6937 : f32
      %coord_6939 = cute.make_coord() : () -> !cute.coord<"0">
      %2154 = cute.memref.load(%rmem_1067, %coord_6939) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %coord_6940 = cute.make_coord() : () -> !cute.coord<"0">
      %2155 = cute.memref.load(%rmem_1067, %coord_6940) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2156 = arith.cmpf une, %2154, %2155 : f32
      %2157 = arith.extui %2153 : i1 to i32
      %c0_i32_6941 = arith.constant 0 : i32
      %2158 = arith.cmpi ne, %2157, %c0_i32_6941 : i32
      %2159 = arith.extui %2153 : i1 to i32
      %2160 = arith.extui %2156 : i1 to i32
      %2161 = arith.select %2158, %2159, %2160 : i32
      %c0_i32_6942 = arith.constant 0 : i32
      %2162 = arith.cmpi ne, %2161, %c0_i32_6942 : i32
      %coord_6943 = cute.make_coord() : () -> !cute.coord<"0">
      %2163 = cute.memref.load(%rmem_1067, %coord_6943) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32
      %2164 = nvvm.rcp.approx.ftz.f %2163 : f32
      %cst_6944 = arith.constant 1.000000e+00 : f32
      %2165 = arith.select %2162, %cst_6944, %2164 : f32
      %coord_6945 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_6946 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_6947 = cute.crd2idx(%coord_6945, %lay_6946) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_6948 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_6949 = cute.add_offset(%iter_6948, %idx_6947) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_6950 = cute.make_view(%ptr_6949) : !memref_rmem_f32_10
      %iter_6951 = cute.get_iter(%view_6950) : !memref_rmem_f32_10
      %lay_6952 = cute.get_layout(%view_6950) : !memref_rmem_f32_10
      %2166 = cute.get_shape(%lay_6952) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_6953, %e1_6954 = cute.get_leaves(%2166) : !cute.shape<"((2,16))">
      %2167 = cute.memref.load_vec %view_6950, row_major : !memref_rmem_f32_10
      %2168 = vector.broadcast %2165 : f32 to vector<32xf32>
      %2169 = arith.mulf %2167, %2168 : vector<32xf32>
      %coord_6955 = cute.make_coord() : () -> !cute.coord<"(0,_)">
      %lay_6956 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_6957 = cute.crd2idx(%coord_6955, %lay_6956) : (!cute.coord<"(0,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"0">
      %iter_6958 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_6959 = cute.add_offset(%iter_6958, %idx_6957) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<f32, rmem, align<32>>
      %view_6960 = cute.make_view(%ptr_6959) : !memref_rmem_f32_10
      %iter_6961 = cute.get_iter(%view_6960) : !memref_rmem_f32_10
      %lay_6962 = cute.get_layout(%view_6960) : !memref_rmem_f32_10
      %2170 = cute.get_shape(%lay_6962) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_6963, %e1_6964 = cute.get_leaves(%2170) : !cute.shape<"((2,16))">
      %int_tuple_6965 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_6966 = cute.size(%int_tuple_6965) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_6967 = cute.get_leaves(%sz_6966) : !cute.int_tuple<"32">
      %int_tuple_6968 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_6969 = cute.size(%int_tuple_6968) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_6970 = cute.get_leaves(%sz_6969) : !cute.int_tuple<"32">
      cute.memref.store_vec %2169, %view_6960, row_major : !memref_rmem_f32_10
      %coord_6971 = cute.make_coord() : () -> !cute.coord<"1">
      %2171 = cute.memref.load(%rmem_1067, %coord_6971) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %c-1_i32_6972 = arith.constant -1 : i32
      %c2_i32_6973 = arith.constant 2 : i32
      %c31_i32_6974 = arith.constant 31 : i32
      %2172 = nvvm.shfl.sync  bfly %c-1_i32_6972, %2171, %c2_i32_6973, %c31_i32_6974 : f32 -> f32
      %2173 = arith.addf %2171, %2172 : f32
      %c-1_i32_6975 = arith.constant -1 : i32
      %c1_i32_6976 = arith.constant 1 : i32
      %c31_i32_6977 = arith.constant 31 : i32
      %2174 = nvvm.shfl.sync  bfly %c-1_i32_6975, %2173, %c1_i32_6976, %c31_i32_6977 : f32 -> f32
      %2175 = arith.addf %2173, %2174 : f32
      %coord_6978 = cute.make_coord() : () -> !cute.coord<"1">
      cute.memref.store(%rmem_1067, %coord_6978, %2175) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> ()
      %coord_6979 = cute.make_coord() : () -> !cute.coord<"1">
      %2176 = cute.memref.load(%rmem_1067, %coord_6979) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2177 = arith.cmpf oeq, %2176, %cst_6937 : f32
      %coord_6980 = cute.make_coord() : () -> !cute.coord<"1">
      %2178 = cute.memref.load(%rmem_1067, %coord_6980) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2179 = arith.cmpf oeq, %2178, %cst_6937 : f32
      %coord_6981 = cute.make_coord() : () -> !cute.coord<"1">
      %2180 = cute.memref.load(%rmem_1067, %coord_6981) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %coord_6982 = cute.make_coord() : () -> !cute.coord<"1">
      %2181 = cute.memref.load(%rmem_1067, %coord_6982) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2182 = arith.cmpf une, %2180, %2181 : f32
      %2183 = arith.extui %2179 : i1 to i32
      %2184 = arith.cmpi ne, %2183, %c0_i32_6941 : i32
      %2185 = arith.extui %2179 : i1 to i32
      %2186 = arith.extui %2182 : i1 to i32
      %2187 = arith.select %2184, %2185, %2186 : i32
      %2188 = arith.cmpi ne, %2187, %c0_i32_6942 : i32
      %coord_6983 = cute.make_coord() : () -> !cute.coord<"1">
      %2189 = cute.memref.load(%rmem_1067, %coord_6983) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32
      %2190 = nvvm.rcp.approx.ftz.f %2189 : f32
      %2191 = arith.select %2188, %cst_6944, %2190 : f32
      %coord_6984 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_6985 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_6986 = cute.crd2idx(%coord_6984, %lay_6985) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_6987 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_6988 = cute.add_offset(%iter_6987, %idx_6986) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6989 = cute.make_view(%ptr_6988) : !memref_rmem_f32_11
      %iter_6990 = cute.get_iter(%view_6989) : !memref_rmem_f32_11
      %lay_6991 = cute.get_layout(%view_6989) : !memref_rmem_f32_11
      %2192 = cute.get_shape(%lay_6991) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_6992, %e1_6993 = cute.get_leaves(%2192) : !cute.shape<"((2,16))">
      %2193 = cute.memref.load_vec %view_6989, row_major : !memref_rmem_f32_11
      %2194 = vector.broadcast %2191 : f32 to vector<32xf32>
      %2195 = arith.mulf %2193, %2194 : vector<32xf32>
      %coord_6994 = cute.make_coord() : () -> !cute.coord<"(1,_)">
      %lay_6995 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_6996 = cute.crd2idx(%coord_6994, %lay_6995) : (!cute.coord<"(1,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"2">
      %iter_6997 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_6998 = cute.add_offset(%iter_6997, %idx_6996) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"2">) -> !cute.ptr<f32, rmem, align<8>>
      %view_6999 = cute.make_view(%ptr_6998) : !memref_rmem_f32_11
      %iter_7000 = cute.get_iter(%view_6999) : !memref_rmem_f32_11
      %lay_7001 = cute.get_layout(%view_6999) : !memref_rmem_f32_11
      %2196 = cute.get_shape(%lay_7001) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7002, %e1_7003 = cute.get_leaves(%2196) : !cute.shape<"((2,16))">
      %int_tuple_7004 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7005 = cute.size(%int_tuple_7004) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7006 = cute.get_leaves(%sz_7005) : !cute.int_tuple<"32">
      %int_tuple_7007 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7008 = cute.size(%int_tuple_7007) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7009 = cute.get_leaves(%sz_7008) : !cute.int_tuple<"32">
      cute.memref.store_vec %2195, %view_6999, row_major : !memref_rmem_f32_11
      %coord_7010 = cute.make_coord() : () -> !cute.coord<"2">
      %2197 = cute.memref.load(%rmem_1067, %coord_7010) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %c-1_i32_7011 = arith.constant -1 : i32
      %c2_i32_7012 = arith.constant 2 : i32
      %c31_i32_7013 = arith.constant 31 : i32
      %2198 = nvvm.shfl.sync  bfly %c-1_i32_7011, %2197, %c2_i32_7012, %c31_i32_7013 : f32 -> f32
      %2199 = arith.addf %2197, %2198 : f32
      %c-1_i32_7014 = arith.constant -1 : i32
      %c1_i32_7015 = arith.constant 1 : i32
      %c31_i32_7016 = arith.constant 31 : i32
      %2200 = nvvm.shfl.sync  bfly %c-1_i32_7014, %2199, %c1_i32_7015, %c31_i32_7016 : f32 -> f32
      %2201 = arith.addf %2199, %2200 : f32
      %coord_7017 = cute.make_coord() : () -> !cute.coord<"2">
      cute.memref.store(%rmem_1067, %coord_7017, %2201) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> ()
      %coord_7018 = cute.make_coord() : () -> !cute.coord<"2">
      %2202 = cute.memref.load(%rmem_1067, %coord_7018) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2203 = arith.cmpf oeq, %2202, %cst_6937 : f32
      %coord_7019 = cute.make_coord() : () -> !cute.coord<"2">
      %2204 = cute.memref.load(%rmem_1067, %coord_7019) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2205 = arith.cmpf oeq, %2204, %cst_6937 : f32
      %coord_7020 = cute.make_coord() : () -> !cute.coord<"2">
      %2206 = cute.memref.load(%rmem_1067, %coord_7020) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %coord_7021 = cute.make_coord() : () -> !cute.coord<"2">
      %2207 = cute.memref.load(%rmem_1067, %coord_7021) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2208 = arith.cmpf une, %2206, %2207 : f32
      %2209 = arith.extui %2205 : i1 to i32
      %2210 = arith.cmpi ne, %2209, %c0_i32_6941 : i32
      %2211 = arith.extui %2205 : i1 to i32
      %2212 = arith.extui %2208 : i1 to i32
      %2213 = arith.select %2210, %2211, %2212 : i32
      %2214 = arith.cmpi ne, %2213, %c0_i32_6942 : i32
      %coord_7022 = cute.make_coord() : () -> !cute.coord<"2">
      %2215 = cute.memref.load(%rmem_1067, %coord_7022) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32
      %2216 = nvvm.rcp.approx.ftz.f %2215 : f32
      %2217 = arith.select %2214, %cst_6944, %2216 : f32
      %coord_7023 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7024 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_7025 = cute.crd2idx(%coord_7023, %lay_7024) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7026 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_7027 = cute.add_offset(%iter_7026, %idx_7025) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7028 = cute.make_view(%ptr_7027) : !memref_rmem_f32_12
      %iter_7029 = cute.get_iter(%view_7028) : !memref_rmem_f32_12
      %lay_7030 = cute.get_layout(%view_7028) : !memref_rmem_f32_12
      %2218 = cute.get_shape(%lay_7030) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7031, %e1_7032 = cute.get_leaves(%2218) : !cute.shape<"((2,16))">
      %2219 = cute.memref.load_vec %view_7028, row_major : !memref_rmem_f32_12
      %2220 = vector.broadcast %2217 : f32 to vector<32xf32>
      %2221 = arith.mulf %2219, %2220 : vector<32xf32>
      %coord_7033 = cute.make_coord() : () -> !cute.coord<"(2,_)">
      %lay_7034 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_7035 = cute.crd2idx(%coord_7033, %lay_7034) : (!cute.coord<"(2,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"4">
      %iter_7036 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_7037 = cute.add_offset(%iter_7036, %idx_7035) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"4">) -> !cute.ptr<f32, rmem, align<16>>
      %view_7038 = cute.make_view(%ptr_7037) : !memref_rmem_f32_12
      %iter_7039 = cute.get_iter(%view_7038) : !memref_rmem_f32_12
      %lay_7040 = cute.get_layout(%view_7038) : !memref_rmem_f32_12
      %2222 = cute.get_shape(%lay_7040) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7041, %e1_7042 = cute.get_leaves(%2222) : !cute.shape<"((2,16))">
      %int_tuple_7043 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7044 = cute.size(%int_tuple_7043) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7045 = cute.get_leaves(%sz_7044) : !cute.int_tuple<"32">
      %int_tuple_7046 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7047 = cute.size(%int_tuple_7046) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7048 = cute.get_leaves(%sz_7047) : !cute.int_tuple<"32">
      cute.memref.store_vec %2221, %view_7038, row_major : !memref_rmem_f32_12
      %coord_7049 = cute.make_coord() : () -> !cute.coord<"3">
      %2223 = cute.memref.load(%rmem_1067, %coord_7049) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %c-1_i32_7050 = arith.constant -1 : i32
      %c2_i32_7051 = arith.constant 2 : i32
      %c31_i32_7052 = arith.constant 31 : i32
      %2224 = nvvm.shfl.sync  bfly %c-1_i32_7050, %2223, %c2_i32_7051, %c31_i32_7052 : f32 -> f32
      %2225 = arith.addf %2223, %2224 : f32
      %c-1_i32_7053 = arith.constant -1 : i32
      %c1_i32_7054 = arith.constant 1 : i32
      %c31_i32_7055 = arith.constant 31 : i32
      %2226 = nvvm.shfl.sync  bfly %c-1_i32_7053, %2225, %c1_i32_7054, %c31_i32_7055 : f32 -> f32
      %2227 = arith.addf %2225, %2226 : f32
      %coord_7056 = cute.make_coord() : () -> !cute.coord<"3">
      cute.memref.store(%rmem_1067, %coord_7056, %2227) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> ()
      %coord_7057 = cute.make_coord() : () -> !cute.coord<"3">
      %2228 = cute.memref.load(%rmem_1067, %coord_7057) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2229 = arith.cmpf oeq, %2228, %cst_6937 : f32
      %coord_7058 = cute.make_coord() : () -> !cute.coord<"3">
      %2230 = cute.memref.load(%rmem_1067, %coord_7058) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2231 = arith.cmpf oeq, %2230, %cst_6937 : f32
      %coord_7059 = cute.make_coord() : () -> !cute.coord<"3">
      %2232 = cute.memref.load(%rmem_1067, %coord_7059) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %coord_7060 = cute.make_coord() : () -> !cute.coord<"3">
      %2233 = cute.memref.load(%rmem_1067, %coord_7060) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2234 = arith.cmpf une, %2232, %2233 : f32
      %2235 = arith.extui %2231 : i1 to i32
      %2236 = arith.cmpi ne, %2235, %c0_i32_6941 : i32
      %2237 = arith.extui %2231 : i1 to i32
      %2238 = arith.extui %2234 : i1 to i32
      %2239 = arith.select %2236, %2237, %2238 : i32
      %2240 = arith.cmpi ne, %2239, %c0_i32_6942 : i32
      %coord_7061 = cute.make_coord() : () -> !cute.coord<"3">
      %2241 = cute.memref.load(%rmem_1067, %coord_7061) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32
      %2242 = nvvm.rcp.approx.ftz.f %2241 : f32
      %2243 = arith.select %2240, %cst_6944, %2242 : f32
      %coord_7062 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7063 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_7064 = cute.crd2idx(%coord_7062, %lay_7063) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7065 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_7066 = cute.add_offset(%iter_7065, %idx_7064) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7067 = cute.make_view(%ptr_7066) : !memref_rmem_f32_11
      %iter_7068 = cute.get_iter(%view_7067) : !memref_rmem_f32_11
      %lay_7069 = cute.get_layout(%view_7067) : !memref_rmem_f32_11
      %2244 = cute.get_shape(%lay_7069) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7070, %e1_7071 = cute.get_leaves(%2244) : !cute.shape<"((2,16))">
      %2245 = cute.memref.load_vec %view_7067, row_major : !memref_rmem_f32_11
      %2246 = vector.broadcast %2243 : f32 to vector<32xf32>
      %2247 = arith.mulf %2245, %2246 : vector<32xf32>
      %coord_7072 = cute.make_coord() : () -> !cute.coord<"(3,_)">
      %lay_7073 = cute.get_layout(%view_6923) : !memref_rmem_f32_5
      %idx_7074 = cute.crd2idx(%coord_7072, %lay_7073) : (!cute.coord<"(3,_)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.int_tuple<"6">
      %iter_7075 = cute.get_iter(%view_6923) : !memref_rmem_f32_5
      %ptr_7076 = cute.add_offset(%iter_7075, %idx_7074) : (!cute.ptr<f32, rmem, align<32>>, !cute.int_tuple<"6">) -> !cute.ptr<f32, rmem, align<8>>
      %view_7077 = cute.make_view(%ptr_7076) : !memref_rmem_f32_11
      %iter_7078 = cute.get_iter(%view_7077) : !memref_rmem_f32_11
      %lay_7079 = cute.get_layout(%view_7077) : !memref_rmem_f32_11
      %2248 = cute.get_shape(%lay_7079) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))">
      %e0_7080, %e1_7081 = cute.get_leaves(%2248) : !cute.shape<"((2,16))">
      %int_tuple_7082 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7083 = cute.size(%int_tuple_7082) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7084 = cute.get_leaves(%sz_7083) : !cute.int_tuple<"32">
      %int_tuple_7085 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))">
      %sz_7086 = cute.size(%int_tuple_7085) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32">
      %e0_7087 = cute.get_leaves(%sz_7086) : !cute.int_tuple<"32">
      cute.memref.store_vec %2247, %view_7077, row_major : !memref_rmem_f32_11
      %lay_7088 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2249 = cute.make_layout_like(%lay_7088) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> to !cute.layout<"((2,2),2,16):((1,2),4,8)">
      %rmem_7089 = cute.memref.alloca(%2249) : !memref_rmem_bf16_23
      %iter_7090 = cute.get_iter(%rmem_7089) : !memref_rmem_bf16_23
      %iter_7091 = cute.get_iter(%rmem_7089) : !memref_rmem_bf16_23
      %lay_7092 = cute.get_layout(%rmem) : !memref_rmem_f32_
      %2250 = cute.get_shape(%lay_7092) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7093, %e1_7094, %e2_7095, %e3_7096 = cute.get_leaves(%2250) : !cute.shape<"((2,2),2,16)">
      %2251 = cute.memref.load_vec %rmem, row_major : !memref_rmem_f32_
      %2252 = arith.truncf %2251 : vector<128xf32> to vector<128xbf16>
      %lay_7097 = cute.get_layout(%rmem_7089) : !memref_rmem_bf16_23
      %2253 = cute.get_shape(%lay_7097) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)">
      %e0_7098, %e1_7099, %e2_7100, %e3_7101 = cute.get_leaves(%2253) : !cute.shape<"((2,2),2,16)">
      %int_tuple_7102 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7103 = cute.size(%int_tuple_7102) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7104 = cute.get_leaves(%sz_7103) : !cute.int_tuple<"128">
      %int_tuple_7105 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)">
      %sz_7106 = cute.size(%int_tuple_7105) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128">
      %e0_7107 = cute.get_leaves(%sz_7106) : !cute.int_tuple<"128">
      cute.memref.store_vec %2252, %rmem_7089, row_major : !memref_rmem_bf16_23
      %view_7108 = cute.make_view(%iter_271, %2) : !memref_smem_bf16_
      %iter_7109 = cute.get_iter(%view_7108) : !memref_smem_bf16_
      %atom_7110 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16>
      %2254 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">
      %2255 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7111, %e1_7112, %e2_7113 = cute.get_leaves(%2255) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7114 = cute.size(%e0_7111) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64">
      %e0_7115 = cute.get_leaves(%sz_7114) : !cute.int_tuple<"64">
      %2256 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
      %e0_7116, %e1_7117, %e2_7118 = cute.get_leaves(%2256) : !cute.tile<"[64:1;16:1;16:1]">
      %sz_7119 = cute.size(%e1_7117) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16">
      %e0_7120 = cute.get_leaves(%sz_7119) : !cute.int_tuple<"16">
      %tile_7121 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]">
      %2257 = cute.make_tiled_copy(%atom_7110) : !copy_simt1
      %retiled_7122 = cute.tiled.copy.retile(%2257, %rmem_7089) : (!copy_simt1, !memref_rmem_bf16_23) -> !memref_rmem_bf16_24
      %iter_7123 = cute.get_iter(%retiled_7122) : !memref_rmem_bf16_24
      %coord_7124 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7125 = cute.tiled.copy.partition_D(%2257, %view_7108, %coord_7124) : (!copy_simt1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_21
      %iter_7126 = cute.get_iter(%dst_partitioned_7125) : !memref_smem_bf16_21
      %lay_7127 = cute.get_layout(%retiled_7122) : !memref_rmem_bf16_24
      %2258 = cute.get_shape(%lay_7127) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7128, %e1_7129, %e2_7130, %e3_7131, %e4_7132 = cute.get_leaves(%2258) : !cute.shape<"((1,(4,2)),2,8)">
      %lay_7133 = cute.get_layout(%dst_partitioned_7125) : !memref_smem_bf16_21
      %2259 = cute.get_shape(%lay_7133) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7134, %e1_7135, %e2_7136, %e3_7137, %e4_7138, %e5_7139, %e6, %e7 = cute.get_leaves(%2259) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %lay_7140 = cute.get_layout(%retiled_7122) : !memref_rmem_bf16_24
      %shape_7141 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7142 = cute.make_layout() : !cute.layout<"1:0">
      %append_7143 = cute.append_to_rank<2> (%lay_7140, %lay_7142) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0">
      %view_7144 = cute.make_view(%iter_7123, %append_7143) : !memref_rmem_bf16_24
      %iter_7145 = cute.get_iter(%view_7144) : !memref_rmem_bf16_24
      %lay_7146 = cute.get_layout(%view_7144) : !memref_rmem_bf16_24
      %2260 = cute.get_shape(%lay_7146) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)">
      %e0_7147, %e1_7148, %e2_7149, %e3_7150, %e4_7151 = cute.get_leaves(%2260) : !cute.shape<"((1,(4,2)),2,8)">
      %iter_7152 = cute.get_iter(%view_7144) : !memref_rmem_bf16_24
      %view_7153 = cute.make_view(%iter_7152) : !memref_rmem_bf16_25
      %iter_7154 = cute.get_iter(%view_7153) : !memref_rmem_bf16_25
      %iter_7155 = cute.get_iter(%view_7153) : !memref_rmem_bf16_25
      %lay_7156 = cute.get_layout(%dst_partitioned_7125) : !memref_smem_bf16_21
      %shape_7157 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7158 = cute.make_layout() : !cute.layout<"1:0">
      %append_7159 = cute.append_to_rank<2> (%lay_7156, %lay_7158) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0">
      %view_7160 = cute.make_view(%iter_7126, %append_7159) : !memref_smem_bf16_21
      %iter_7161 = cute.get_iter(%view_7160) : !memref_smem_bf16_21
      %lay_7162 = cute.get_layout(%view_7160) : !memref_smem_bf16_21
      %2261 = cute.get_shape(%lay_7162) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %e0_7163, %e1_7164, %e2_7165, %e3_7166, %e4_7167, %e5_7168, %e6_7169, %e7_7170 = cute.get_leaves(%2261) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))">
      %iter_7171 = cute.get_iter(%view_7160) : !memref_smem_bf16_21
      %lay_7172 = cute.get_layout(%view_7160) : !memref_smem_bf16_21
      %2262:3 = cute.get_scalars(%lay_7172) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
      %shape_7173 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %iv_7174 = cute.assume(%2262#0) : (i32) -> !cute.i32<divby 8>
      %iv_7175 = cute.assume(%2262#1) : (i32) -> !cute.i32<divby 16>
      %iv_7176 = cute.assume(%2262#2) : (i32) -> !cute.i32<divby 32>
      %stride_7177 = cute.make_stride(%iv_7174, %iv_7175, %iv_7176) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %lay_7178 = cute.make_layout(%shape_7173, %stride_7177) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %view_7179 = cute.make_view(%iter_7171, %lay_7178) : !memref_smem_bf16_22
      %iter_7180 = cute.get_iter(%view_7179) : !memref_smem_bf16_22
      %iter_7181 = cute.get_iter(%view_7179) : !memref_smem_bf16_22
      %lay_7182 = cute.get_layout(%view_7153) : !memref_rmem_bf16_25
      %2263 = cute.get_shape(%lay_7182) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))">
      %e0_7183, %e1_7184, %e2_7185, %e3_7186, %e4_7187 = cute.get_leaves(%2263) : !cute.shape<"((1,(4,2)),(2,8))">
      %lay_7188 = cute.get_layout(%view_7179) : !memref_smem_bf16_22
      %2264 = cute.get_shape(%lay_7188) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %e0_7189, %e1_7190, %e2_7191, %e3_7192, %e4_7193, %e5_7194, %e6_7195, %e7_7196 = cute.get_leaves(%2264) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))">
      %lay_7197 = cute.get_layout(%view_7153) : !memref_rmem_bf16_25
      %sz_7198 = cute.size(%lay_7197) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.int_tuple<"16">
      %e0_7199 = cute.get_leaves(%sz_7198) : !cute.int_tuple<"16">
      %lay_7200 = cute.get_layout(%view_7179) : !memref_smem_bf16_22
      %sz_7201 = cute.size(%lay_7200) <{mode = [1]}> : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.int_tuple<"16">
      %e0_7202 = cute.get_leaves(%sz_7201) : !cute.int_tuple<"16">
      %2265 = cute.static : !cute.layout<"1:0">
      %iter_7203 = cute.get_iter(%view_7153) : !memref_rmem_bf16_25
      %iter_7204 = cute.get_iter(%view_7179) : !memref_smem_bf16_22
      %lay_7205 = cute.get_layout(%view_7153) : !memref_rmem_bf16_25
      %lay_7206 = cute.get_layout(%view_7179) : !memref_smem_bf16_22
      %append_7207 = cute.append_to_rank<2> (%lay_7205, %2265) : !cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">, !cute.layout<"1:0">
      %append_7208 = cute.append_to_rank<2> (%lay_7206, %2265) : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">, !cute.layout<"1:0">
      %lay_7209 = cute.make_layout() : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">
      %2266:3 = cute.get_scalars(%append_7208) <{only_dynamic}> : !cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
      %shape_7210 = cute.make_shape() : () -> !cute.shape<"((1,(2,2,2)),((2,((2,2),2))))">
      %iv_7211 = cute.assume(%2266#0) : (i32) -> !cute.i32<divby 8>
      %iv_7212 = cute.assume(%2266#1) : (i32) -> !cute.i32<divby 16>
      %iv_7213 = cute.assume(%2266#2) : (i32) -> !cute.i32<divby 32>
      %stride_7214 = cute.make_stride(%iv_7211, %iv_7212, %iv_7213) : (!cute.i32<divby 8>, !cute.i32<divby 16>, !cute.i32<divby 32>) -> !cute.stride<"((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %lay_7215 = cute.make_layout(%shape_7210, %stride_7214) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">
      %sz_7216 = cute.size(%lay_7209) <{mode = [1]}> : (!cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"16">
      %2267 = cute.get_scalars(%sz_7216) : !cute.int_tuple<"16">
      %c0_i32_7217 = arith.constant 0 : i32
      %c1_i32_7218 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7217 to %2267 step %c1_i32_7218  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_7209, %coord_7719) : !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7209) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(4,2)),((2,8))):((0,(1,8)),((4,16)))">) -> !cute.int_tuple<"?{div=4}">
        %ptr_7722 = cute.add_offset(%iter_7203, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=4}">) -> !cute.ptr<bf16, rmem, align<8>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_rmem_bf16_26
        %slice_7724 = cute.slice(%lay_7215, %coord_7719) : !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_7215) : (!cute.coord<"(_,?)">, !cute.layout<"((1,(2,2,2)),((2,((2,2),2)))):((0,(1,512,?{div=8})),((4096,((?{div=16},?{div=32}),8192))))">) -> !cute.int_tuple<"?{div=16}">
        %ptr_7726 = cute.add_offset(%iter_7204, %idx_7725) : (!cute.ptr<bf16, smem, align<4>>, !cute.int_tuple<"?{div=16}">) -> !cute.ptr<bf16, smem, align<4>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_smem_bf16_23
        cute.copy_atom_call(%atom_7110, %view_7723, %view_7727) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_26, !memref_smem_bf16_23) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %coord_7219 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_7220 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %slice_7221 = cute.slice(%lay_7220, %coord_7219) : !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">, !cute.coord<"(?,_,?,_)">
      %idx_7222 = cute.crd2idx(%coord_7219, %lay_7220) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.int_tuple<"?{i64 div=8}">
      %iter_7223 = cute.get_iter(%arg3) : !memref_gmem_bf16_
      %ptr_7224 = cute.add_offset(%iter_7223, %idx_7222) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=8}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7225 = cute.make_view(%ptr_7224, %slice_7221) : !memref_gmem_bf16_1
      %iter_7226 = cute.get_iter(%view_7225) : !memref_gmem_bf16_1
      %tile_7227 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_7228 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %2268 = cute.get_scalars(%coord_7228) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_7229 = cute.make_coord(%2268) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_7230 = cute.get_layout(%view_7225) : !memref_gmem_bf16_1
      %2269:3 = cute.get_scalars(%lay_7230) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(?{i64 div=8},1)">
      %c128_i32_7231 = arith.constant 128 : i32
      %2270 = arith.ceildivsi %2269#0, %c128_i32_7231 : i32
      %c128_i64_7232 = arith.constant 128 : i64
      %2271 = arith.muli %2269#2, %c128_i64_7232 : i64
      %c128_i32_7233 = arith.constant 128 : i32
      %2272 = arith.ceildivsi %2269#1, %c128_i32_7233 : i32
      %shape_7234 = cute.make_shape(%2270, %2272) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %iv_7235 = cute.assume(%2269#2) : (i64) -> !cute.i64<divby 8>
      %iv_7236 = cute.assume(%2271) : (i64) -> !cute.i64<divby 1024>
      %stride_7237 = cute.make_stride(%iv_7235, %iv_7236) : (!cute.i64<divby 8>, !cute.i64<divby 1024>) -> !cute.stride<"((?{i64 div=8},1),(?{i64 div=1024},128))">
      %lay_7238 = cute.make_layout(%shape_7234, %stride_7237) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">
      %slice_7239 = cute.slice(%lay_7238, %coord_7229) : !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">, !cute.coord<"((_,_),(?,0))">
      %idx_7240 = cute.crd2idx(%coord_7229, %lay_7238) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((?{i64 div=8},1),(?{i64 div=1024},128))">) -> !cute.int_tuple<"?{i64 div=1024}">
      %iter_7241 = cute.get_iter(%view_7225) : !memref_gmem_bf16_1
      %ptr_7242 = cute.add_offset(%iter_7241, %idx_7240) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=1024}">) -> !cute.ptr<bf16, gmem, align<16>>
      %view_7243 = cute.make_view(%ptr_7242, %slice_7239) : !memref_gmem_bf16_2
      %iter_7244 = cute.get_iter(%view_7243) : !memref_gmem_bf16_2
      %coord_7245 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %src_partitioned_7246 = cute.tiled.copy.partition_S(%4, %view_7108, %coord_7245) : (!copy_simt, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3
      %iter_7247 = cute.get_iter(%src_partitioned_7246) : !memref_smem_bf16_3
      %coord_7248 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7249 = cute.tiled.copy.partition_D(%4, %view_7243, %coord_7248) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4
      %iter_7250 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
      %lay_7251 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
      %2273 = cute.make_layout_like(%lay_7251) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),8,2):((1,0),16,8)">
      %rmem_7252 = cute.memref.alloca(%2273) : !memref_rmem_bf16_27
      %iter_7253 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
      %iter_7254 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
      %c1_i32_7255 = arith.constant 1 : i32
      %c128_i32_7256 = arith.constant 128 : i32
      nvvm.barrier id = %c1_i32_7255 number_of_threads = %c128_i32_7256
      %lay_7257 = cute.get_layout(%src_partitioned_7246) : !memref_smem_bf16_3
      %2274 = cute.get_shape(%lay_7257) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7258, %e1_7259, %e2_7260, %e3_7261 = cute.get_leaves(%2274) : !cute.shape<"((8,1),8,2)">
      %lay_7262 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
      %2275 = cute.get_shape(%lay_7262) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7263, %e1_7264, %e2_7265, %e3_7266 = cute.get_leaves(%2275) : !cute.shape<"((8,1),8,2)">
      %lay_7267 = cute.get_layout(%src_partitioned_7246) : !memref_smem_bf16_3
      %shape_7268 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7269 = cute.make_layout() : !cute.layout<"1:0">
      %append_7270 = cute.append_to_rank<2> (%lay_7267, %lay_7269) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0">
      %view_7271 = cute.make_view(%iter_7247, %append_7270) : !memref_smem_bf16_3
      %iter_7272 = cute.get_iter(%view_7271) : !memref_smem_bf16_3
      %lay_7273 = cute.get_layout(%view_7271) : !memref_smem_bf16_3
      %2276 = cute.get_shape(%lay_7273) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7274, %e1_7275, %e2_7276, %e3_7277 = cute.get_leaves(%2276) : !cute.shape<"((8,1),8,2)">
      %iter_7278 = cute.get_iter(%view_7271) : !memref_smem_bf16_3
      %view_7279 = cute.make_view(%iter_7278) : !memref_smem_bf16_24
      %iter_7280 = cute.get_iter(%view_7279) : !memref_smem_bf16_24
      %iter_7281 = cute.get_iter(%view_7279) : !memref_smem_bf16_24
      %lay_7282 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
      %shape_7283 = cute.make_shape() : () -> !cute.shape<"1">
      %lay_7284 = cute.make_layout() : !cute.layout<"1:0">
      %append_7285 = cute.append_to_rank<2> (%lay_7282, %lay_7284) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0">
      %view_7286 = cute.make_view(%iter_7254, %append_7285) : !memref_rmem_bf16_27
      %iter_7287 = cute.get_iter(%view_7286) : !memref_rmem_bf16_27
      %lay_7288 = cute.get_layout(%view_7286) : !memref_rmem_bf16_27
      %2277 = cute.get_shape(%lay_7288) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7289, %e1_7290, %e2_7291, %e3_7292 = cute.get_leaves(%2277) : !cute.shape<"((8,1),8,2)">
      %iter_7293 = cute.get_iter(%view_7286) : !memref_rmem_bf16_27
      %view_7294 = cute.make_view(%iter_7293) : !memref_rmem_bf16_28
      %iter_7295 = cute.get_iter(%view_7294) : !memref_rmem_bf16_28
      %iter_7296 = cute.get_iter(%view_7294) : !memref_rmem_bf16_28
      %lay_7297 = cute.get_layout(%view_7279) : !memref_smem_bf16_24
      %2278 = cute.get_shape(%lay_7297) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_7298, %e1_7299, %e2_7300, %e3_7301 = cute.get_leaves(%2278) : !cute.shape<"((8,1),(8,2))">
      %lay_7302 = cute.get_layout(%view_7294) : !memref_rmem_bf16_28
      %2279 = cute.get_shape(%lay_7302) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))">
      %e0_7303, %e1_7304, %e2_7305, %e3_7306 = cute.get_leaves(%2279) : !cute.shape<"((8,1),(8,2))">
      %lay_7307 = cute.get_layout(%view_7279) : !memref_smem_bf16_24
      %sz_7308 = cute.size(%lay_7307) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.int_tuple<"16">
      %e0_7309 = cute.get_leaves(%sz_7308) : !cute.int_tuple<"16">
      %lay_7310 = cute.get_layout(%view_7294) : !memref_rmem_bf16_28
      %sz_7311 = cute.size(%lay_7310) <{mode = [1]}> : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.int_tuple<"16">
      %e0_7312 = cute.get_leaves(%sz_7311) : !cute.int_tuple<"16">
      %2280 = cute.static : !cute.layout<"1:0">
      %iter_7313 = cute.get_iter(%view_7279) : !memref_smem_bf16_24
      %iter_7314 = cute.get_iter(%view_7294) : !memref_rmem_bf16_28
      %lay_7315 = cute.get_layout(%view_7279) : !memref_smem_bf16_24
      %lay_7316 = cute.get_layout(%view_7294) : !memref_rmem_bf16_28
      %append_7317 = cute.append_to_rank<2> (%lay_7315, %2280) : !cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">, !cute.layout<"1:0">
      %append_7318 = cute.append_to_rank<2> (%lay_7316, %2280) : !cute.layout<"((8,1),(8,2)):((1,0),(16,8))">, !cute.layout<"1:0">
      %lay_7319 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">
      %lay_7320 = cute.make_layout() : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">
      %sz_7321 = cute.size(%lay_7319) <{mode = [1]}> : (!cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"16">
      %2281 = cute.get_scalars(%sz_7321) : !cute.int_tuple<"16">
      %c0_i32_7322 = arith.constant 0 : i32
      %c1_i32_7323 = arith.constant 1 : i32
      scf.for %arg5 = %c0_i32_7322 to %2281 step %c1_i32_7323  : i32 {
        %coord_7719 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
        %slice_7720 = cute.slice(%lay_7319, %coord_7719) : !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">, !cute.coord<"(_,?)">
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7319) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((1024,8192)))">) -> !cute.int_tuple<"?{div=1024}">
        %ptr_7722 = cute.add_offset(%iter_7313, %idx_7721) : (!cute.ptr<bf16, smem, align<16>>, !cute.int_tuple<"?{div=1024}">) -> !cute.ptr<bf16, smem, align<16>>
        %view_7723 = cute.make_view(%ptr_7722, %slice_7720) : !memref_smem_bf16_13
        %slice_7724 = cute.slice(%lay_7320, %coord_7719) : !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">, !cute.coord<"(_,?)">
        %idx_7725 = cute.crd2idx(%coord_7719, %lay_7320) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((8,2))):((1,0),((16,8)))">) -> !cute.int_tuple<"?{div=8}">
        %ptr_7726 = cute.add_offset(%iter_7314, %idx_7725) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
        %view_7727 = cute.make_view(%ptr_7726, %slice_7724) : !memref_rmem_bf16_8
        cute.copy_atom_call(%4, %view_7723, %view_7727) : (!copy_simt, !memref_smem_bf16_13, !memref_rmem_bf16_8) -> ()
      } {llvm.loop_annotation = #loop_annotation}
      %lay_7324 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2282 = cute.get_shape(%lay_7324) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7325, %e1_7326, %e2_7327, %e3_7328 = cute.get_leaves(%2282) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7329 = cute.to_int_tuple(%e0_7325) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2283 = cute.get_scalars(%itup_7329) : !cute.int_tuple<"?">
      %itup_7330 = cute.to_int_tuple(%e1_7326) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2284 = cute.get_scalars(%itup_7330) : !cute.int_tuple<"?">
      %itup_7331 = cute.to_int_tuple(%e2_7327) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2285 = cute.get_scalars(%itup_7331) : !cute.int_tuple<"?">
      %itup_7332 = cute.to_int_tuple(%e3_7328) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2286 = cute.get_scalars(%itup_7332) : !cute.int_tuple<"?{div=8}">
      %shape_7333 = cute.make_shape(%itup_7329, %itup_7330, %itup_7331, %itup_7332) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})">
      %2287 = cute.make_identity_tensor(%shape_7333) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %iter_7334 = cute.get_iter(%2287) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %e0_7335, %e1_7336, %e2_7337, %e3_7338 = cute.get_leaves(%iter_7334) : !cute.int_tuple<"(0,0,0,0)">
      %coord_7339 = cute.make_coord(%118, %119) : (i32, i32) -> !cute.coord<"(?,_,?,_)">
      %lay_7340 = cute.get_layout(%2287) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %slice_7341 = cute.slice(%lay_7340, %coord_7339) : !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)">
      %idx_7342 = cute.crd2idx(%coord_7339, %lay_7340) : (!cute.coord<"(?,_,?,_)">, !cute.layout<"(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">) -> !cute.int_tuple<"(?,0,?,0)">
      %iter_7343 = cute.get_iter(%2287) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">
      %tup_7344 = cute.add_offset(%iter_7343, %idx_7342) : (!cute.int_tuple<"(0,0,0,0)">, !cute.int_tuple<"(?,0,?,0)">) -> !cute.int_tuple<"(?,0,?,0)">
      %view_7345 = cute.make_view(%tup_7344, %slice_7341) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %iter_7346 = cute.get_iter(%view_7345) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %e0_7347, %e1_7348, %e2_7349, %e3_7350 = cute.get_leaves(%iter_7346) : !cute.int_tuple<"(?,0,?,0)">
      %2288 = cute.get_scalars(%e0_7347) : !cute.int_tuple<"?">
      %2289 = cute.get_scalars(%e2_7349) : !cute.int_tuple<"?">
      %tile_7351 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]">
      %coord_7352 = cute.make_coord(%117) : (i32) -> !cute.coord<"(?,0)">
      %2290 = cute.get_scalars(%coord_7352) <{only_dynamic}> : !cute.coord<"(?,0)">
      %coord_7353 = cute.make_coord(%2290) : (i32) -> !cute.coord<"((_,_),(?,0))">
      %lay_7354 = cute.get_layout(%view_7345) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %2291:2 = cute.get_scalars(%lay_7354) <{only_dynamic}> : !cute.layout<"(?,?{div=8}):(1@1,1@3)">
      %c128_i32_7355 = arith.constant 128 : i32
      %2292 = arith.ceildivsi %2291#0, %c128_i32_7355 : i32
      %c128_i32_7356 = arith.constant 128 : i32
      %2293 = arith.ceildivsi %2291#1, %c128_i32_7356 : i32
      %shape_7357 = cute.make_shape(%2292, %2293) : (i32, i32) -> !cute.shape<"((128,128),(?,?))">
      %stride_7358 = cute.make_stride() : () -> !cute.stride<"((1@1,1@3),(128@1,128@3))">
      %lay_7359 = cute.make_layout(%shape_7357, %stride_7358) : !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">
      %idx_7360 = cute.crd2idx(%coord_7353, %lay_7359) : (!cute.coord<"((_,_),(?,0))">, !cute.layout<"((128,128),(?,?)):((1@1,1@3),(128@1,128@3))">) -> !cute.int_tuple<"(0,?{div=128},0,0)">
      %iter_7361 = cute.get_iter(%view_7345) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">
      %tup_7362 = cute.add_offset(%iter_7361, %idx_7360) : (!cute.int_tuple<"(?,0,?,0)">, !cute.int_tuple<"(0,?{div=128},0,0)">) -> !cute.int_tuple<"(?,?{div=128},?,0)">
      %view_7363 = cute.make_view(%tup_7362) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %iter_7364 = cute.get_iter(%view_7363) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">
      %e0_7365, %e1_7366, %e2_7367, %e3_7368 = cute.get_leaves(%iter_7364) : !cute.int_tuple<"(?,?{div=128},?,0)">
      %2294 = cute.get_scalars(%e0_7365) : !cute.int_tuple<"?">
      %2295 = cute.get_scalars(%e1_7366) : !cute.int_tuple<"?{div=128}">
      %2296 = cute.get_scalars(%e2_7367) : !cute.int_tuple<"?">
      %coord_7369 = cute.make_coord(%114) : (i32) -> !cute.coord<"?">
      %dst_partitioned_7370 = cute.tiled.copy.partition_D(%4, %view_7363, %coord_7369) : (!copy_simt, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %iter_7371 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %e0_7372, %e1_7373, %e2_7374, %e3_7375 = cute.get_leaves(%iter_7371) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2297 = cute.get_scalars(%e0_7372) : !cute.int_tuple<"?">
      %2298 = cute.get_scalars(%e1_7373) : !cute.int_tuple<"?">
      %2299 = cute.get_scalars(%e2_7374) : !cute.int_tuple<"?">
      %2300 = cute.get_scalars(%e3_7375) : !cute.int_tuple<"?{div=8}">
      %lay_7376 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
      %2301 = cute.get_shape(%lay_7376) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)">
      %e0_7377, %e1_7378, %e2_7379, %e3_7380 = cute.get_leaves(%2301) : !cute.shape<"((8,1),8,2)">
      %shape_7381 = cute.make_shape() : () -> !cute.shape<"(1,8,2)">
      %stride_7382 = cute.make_stride() : () -> !cute.stride<"(2,0,1)">
      %lay_7383 = cute.make_layout() : !cute.layout<"(1,8,2):(2,0,1)">
      %rmem_7384 = cute.memref.alloca(%lay_7383) : !memref_rmem_i8_
      %iter_7385 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
      %iter_7386 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
      %lay_7387 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
      %2302 = cute.get_shape(%lay_7387) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)">
      %e0_7388, %e1_7389, %e2_7390 = cute.get_leaves(%2302) : !cute.shape<"(1,8,2)">
      %int_tuple_7391 = cute.make_int_tuple() : () -> !cute.int_tuple<"2">
      %sz_7392 = cute.size(%int_tuple_7391) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2">
      %e0_7393 = cute.get_leaves(%sz_7392) : !cute.int_tuple<"2">
      %coord_7394 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)">
      %lay_7395 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7396 = cute.crd2idx(%coord_7394, %lay_7395) : (!cute.coord<"((0,0),0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_7397 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7398 = cute.add_offset(%iter_7397, %idx_7396) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7399 = cute.make_view(%tup_7398) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7400 = cute.get_iter(%view_7399) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7401, %e1_7402, %e2_7403, %e3_7404 = cute.get_leaves(%iter_7400) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2303 = cute.get_scalars(%e0_7401) : !cute.int_tuple<"?">
      %2304 = cute.get_scalars(%e1_7402) : !cute.int_tuple<"?">
      %2305 = cute.get_scalars(%e2_7403) : !cute.int_tuple<"?">
      %2306 = cute.get_scalars(%e3_7404) : !cute.int_tuple<"?{div=8}">
      %iter_7405 = cute.get_iter(%view_7399) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7406, %e1_7407, %e2_7408, %e3_7409 = cute.get_leaves(%iter_7405) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2307 = cute.get_scalars(%e0_7406) : !cute.int_tuple<"?">
      %2308 = cute.get_scalars(%e1_7407) : !cute.int_tuple<"?">
      %2309 = cute.get_scalars(%e2_7408) : !cute.int_tuple<"?">
      %2310 = cute.get_scalars(%e3_7409) : !cute.int_tuple<"?{div=8}">
      %iter_7410 = cute.get_iter(%view_7399) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7411, %e1_7412, %e2_7413, %e3_7414 = cute.get_leaves(%iter_7410) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2311 = cute.get_scalars(%e0_7411) : !cute.int_tuple<"?">
      %2312 = cute.get_scalars(%e1_7412) : !cute.int_tuple<"?">
      %2313 = cute.get_scalars(%e2_7413) : !cute.int_tuple<"?">
      %2314 = cute.get_scalars(%e3_7414) : !cute.int_tuple<"?{div=8}">
      %lay_7415 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2315 = cute.get_shape(%lay_7415) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7416, %e1_7417, %e2_7418, %e3_7419 = cute.get_leaves(%2315) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7420 = cute.to_int_tuple(%e0_7416) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2316 = cute.get_scalars(%itup_7420) : !cute.int_tuple<"?">
      %itup_7421 = cute.to_int_tuple(%e1_7417) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2317 = cute.get_scalars(%itup_7421) : !cute.int_tuple<"?">
      %itup_7422 = cute.to_int_tuple(%e2_7418) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2318 = cute.get_scalars(%itup_7422) : !cute.int_tuple<"?">
      %itup_7423 = cute.to_int_tuple(%e3_7419) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2319 = cute.get_scalars(%itup_7423) : !cute.int_tuple<"?{div=8}">
      %coord_7424 = cute.make_coord(%e3_7414) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_7425 = cute.make_coord(%itup_7423) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2320 = cute.elem_less(%coord_7424, %coord_7425) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2321 = arith.extui %2320 : i1 to i8
      %coord_7426 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      cute.memref.store(%rmem_7384, %coord_7426, %2321) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> ()
      %coord_7427 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)">
      %lay_7428 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7429 = cute.crd2idx(%coord_7427, %lay_7428) : (!cute.coord<"((0,0),0,1)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,64)">
      %iter_7430 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7431 = cute.add_offset(%iter_7430, %idx_7429) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,64)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7432 = cute.make_view(%tup_7431) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7433 = cute.get_iter(%view_7432) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7434, %e1_7435, %e2_7436, %e3_7437 = cute.get_leaves(%iter_7433) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2322 = cute.get_scalars(%e0_7434) : !cute.int_tuple<"?">
      %2323 = cute.get_scalars(%e1_7435) : !cute.int_tuple<"?">
      %2324 = cute.get_scalars(%e2_7436) : !cute.int_tuple<"?">
      %2325 = cute.get_scalars(%e3_7437) : !cute.int_tuple<"?{div=8}">
      %iter_7438 = cute.get_iter(%view_7432) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7439, %e1_7440, %e2_7441, %e3_7442 = cute.get_leaves(%iter_7438) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2326 = cute.get_scalars(%e0_7439) : !cute.int_tuple<"?">
      %2327 = cute.get_scalars(%e1_7440) : !cute.int_tuple<"?">
      %2328 = cute.get_scalars(%e2_7441) : !cute.int_tuple<"?">
      %2329 = cute.get_scalars(%e3_7442) : !cute.int_tuple<"?{div=8}">
      %iter_7443 = cute.get_iter(%view_7432) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7444, %e1_7445, %e2_7446, %e3_7447 = cute.get_leaves(%iter_7443) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2330 = cute.get_scalars(%e0_7444) : !cute.int_tuple<"?">
      %2331 = cute.get_scalars(%e1_7445) : !cute.int_tuple<"?">
      %2332 = cute.get_scalars(%e2_7446) : !cute.int_tuple<"?">
      %2333 = cute.get_scalars(%e3_7447) : !cute.int_tuple<"?{div=8}">
      %lay_7448 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2334 = cute.get_shape(%lay_7448) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7449, %e1_7450, %e2_7451, %e3_7452 = cute.get_leaves(%2334) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7453 = cute.to_int_tuple(%e0_7449) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2335 = cute.get_scalars(%itup_7453) : !cute.int_tuple<"?">
      %itup_7454 = cute.to_int_tuple(%e1_7450) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2336 = cute.get_scalars(%itup_7454) : !cute.int_tuple<"?">
      %itup_7455 = cute.to_int_tuple(%e2_7451) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2337 = cute.get_scalars(%itup_7455) : !cute.int_tuple<"?">
      %itup_7456 = cute.to_int_tuple(%e3_7452) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2338 = cute.get_scalars(%itup_7456) : !cute.int_tuple<"?{div=8}">
      %coord_7457 = cute.make_coord(%e3_7447) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %coord_7458 = cute.make_coord(%itup_7456) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}">
      %2339 = cute.elem_less(%coord_7457, %coord_7458) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}">
      %2340 = arith.extui %2339 : i1 to i8
      %coord_7459 = cute.make_coord() : () -> !cute.coord<"(0,0,1)">
      cute.memref.store(%rmem_7384, %coord_7459, %2340) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> ()
      %int_tuple_7460 = cute.make_int_tuple() : () -> !cute.int_tuple<"8">
      %sz_7461 = cute.size(%int_tuple_7460) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8">
      %e0_7462 = cute.get_leaves(%sz_7461) : !cute.int_tuple<"8">
      %coord_7463 = cute.make_coord() : () -> !cute.coord<"(0,0,0)">
      %lay_7464 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7465 = cute.crd2idx(%coord_7463, %lay_7464) : (!cute.coord<"(0,0,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,0,0,0)">
      %iter_7466 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7467 = cute.add_offset(%iter_7466, %idx_7465) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,0,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7468 = cute.make_view(%tup_7467) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7469 = cute.get_iter(%view_7468) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7470, %e1_7471, %e2_7472, %e3_7473 = cute.get_leaves(%iter_7469) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2341 = cute.get_scalars(%e0_7470) : !cute.int_tuple<"?">
      %2342 = cute.get_scalars(%e1_7471) : !cute.int_tuple<"?">
      %2343 = cute.get_scalars(%e2_7472) : !cute.int_tuple<"?">
      %2344 = cute.get_scalars(%e3_7473) : !cute.int_tuple<"?{div=8}">
      %iter_7474 = cute.get_iter(%view_7468) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7475, %e1_7476, %e2_7477, %e3_7478 = cute.get_leaves(%iter_7474) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2345 = cute.get_scalars(%e0_7475) : !cute.int_tuple<"?">
      %2346 = cute.get_scalars(%e1_7476) : !cute.int_tuple<"?">
      %2347 = cute.get_scalars(%e2_7477) : !cute.int_tuple<"?">
      %2348 = cute.get_scalars(%e3_7478) : !cute.int_tuple<"?{div=8}">
      %iter_7479 = cute.get_iter(%view_7468) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7480, %e1_7481, %e2_7482, %e3_7483 = cute.get_leaves(%iter_7479) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2349 = cute.get_scalars(%e0_7480) : !cute.int_tuple<"?">
      %2350 = cute.get_scalars(%e1_7481) : !cute.int_tuple<"?">
      %2351 = cute.get_scalars(%e2_7482) : !cute.int_tuple<"?">
      %2352 = cute.get_scalars(%e3_7483) : !cute.int_tuple<"?{div=8}">
      %lay_7484 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2353 = cute.get_shape(%lay_7484) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7485, %e1_7486, %e2_7487, %e3_7488 = cute.get_leaves(%2353) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7489 = cute.to_int_tuple(%e0_7485) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2354 = cute.get_scalars(%itup_7489) : !cute.int_tuple<"?">
      %itup_7490 = cute.to_int_tuple(%e1_7486) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2355 = cute.get_scalars(%itup_7490) : !cute.int_tuple<"?">
      %itup_7491 = cute.to_int_tuple(%e2_7487) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2356 = cute.get_scalars(%itup_7491) : !cute.int_tuple<"?">
      %itup_7492 = cute.to_int_tuple(%e3_7488) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2357 = cute.get_scalars(%itup_7492) : !cute.int_tuple<"?{div=8}">
      %coord_7493 = cute.make_coord(%e1_7481) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7494 = cute.make_coord(%itup_7490) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2358 = cute.elem_less(%coord_7493, %coord_7494) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2358 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"0">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,0,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"0">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"0">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,0,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,0,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7495 = cute.make_coord() : () -> !cute.coord<"(0,1,0)">
      %lay_7496 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7497 = cute.crd2idx(%coord_7495, %lay_7496) : (!cute.coord<"(0,1,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,16,0,0)">
      %iter_7498 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7499 = cute.add_offset(%iter_7498, %idx_7497) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,16,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7500 = cute.make_view(%tup_7499) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7501 = cute.get_iter(%view_7500) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7502, %e1_7503, %e2_7504, %e3_7505 = cute.get_leaves(%iter_7501) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2359 = cute.get_scalars(%e0_7502) : !cute.int_tuple<"?">
      %2360 = cute.get_scalars(%e1_7503) : !cute.int_tuple<"?">
      %2361 = cute.get_scalars(%e2_7504) : !cute.int_tuple<"?">
      %2362 = cute.get_scalars(%e3_7505) : !cute.int_tuple<"?{div=8}">
      %iter_7506 = cute.get_iter(%view_7500) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7507, %e1_7508, %e2_7509, %e3_7510 = cute.get_leaves(%iter_7506) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2363 = cute.get_scalars(%e0_7507) : !cute.int_tuple<"?">
      %2364 = cute.get_scalars(%e1_7508) : !cute.int_tuple<"?">
      %2365 = cute.get_scalars(%e2_7509) : !cute.int_tuple<"?">
      %2366 = cute.get_scalars(%e3_7510) : !cute.int_tuple<"?{div=8}">
      %iter_7511 = cute.get_iter(%view_7500) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7512, %e1_7513, %e2_7514, %e3_7515 = cute.get_leaves(%iter_7511) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2367 = cute.get_scalars(%e0_7512) : !cute.int_tuple<"?">
      %2368 = cute.get_scalars(%e1_7513) : !cute.int_tuple<"?">
      %2369 = cute.get_scalars(%e2_7514) : !cute.int_tuple<"?">
      %2370 = cute.get_scalars(%e3_7515) : !cute.int_tuple<"?{div=8}">
      %lay_7516 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2371 = cute.get_shape(%lay_7516) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7517, %e1_7518, %e2_7519, %e3_7520 = cute.get_leaves(%2371) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7521 = cute.to_int_tuple(%e0_7517) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2372 = cute.get_scalars(%itup_7521) : !cute.int_tuple<"?">
      %itup_7522 = cute.to_int_tuple(%e1_7518) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2373 = cute.get_scalars(%itup_7522) : !cute.int_tuple<"?">
      %itup_7523 = cute.to_int_tuple(%e2_7519) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2374 = cute.get_scalars(%itup_7523) : !cute.int_tuple<"?">
      %itup_7524 = cute.to_int_tuple(%e3_7520) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2375 = cute.get_scalars(%itup_7524) : !cute.int_tuple<"?{div=8}">
      %coord_7525 = cute.make_coord(%e1_7513) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7526 = cute.make_coord(%itup_7522) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2376 = cute.elem_less(%coord_7525, %coord_7526) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2376 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"16">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"16">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,1,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=128}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=128}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,1,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,1,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7527 = cute.make_coord() : () -> !cute.coord<"(0,2,0)">
      %lay_7528 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7529 = cute.crd2idx(%coord_7527, %lay_7528) : (!cute.coord<"(0,2,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,32,0,0)">
      %iter_7530 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7531 = cute.add_offset(%iter_7530, %idx_7529) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,32,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7532 = cute.make_view(%tup_7531) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7533 = cute.get_iter(%view_7532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7534, %e1_7535, %e2_7536, %e3_7537 = cute.get_leaves(%iter_7533) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2377 = cute.get_scalars(%e0_7534) : !cute.int_tuple<"?">
      %2378 = cute.get_scalars(%e1_7535) : !cute.int_tuple<"?">
      %2379 = cute.get_scalars(%e2_7536) : !cute.int_tuple<"?">
      %2380 = cute.get_scalars(%e3_7537) : !cute.int_tuple<"?{div=8}">
      %iter_7538 = cute.get_iter(%view_7532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7539, %e1_7540, %e2_7541, %e3_7542 = cute.get_leaves(%iter_7538) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2381 = cute.get_scalars(%e0_7539) : !cute.int_tuple<"?">
      %2382 = cute.get_scalars(%e1_7540) : !cute.int_tuple<"?">
      %2383 = cute.get_scalars(%e2_7541) : !cute.int_tuple<"?">
      %2384 = cute.get_scalars(%e3_7542) : !cute.int_tuple<"?{div=8}">
      %iter_7543 = cute.get_iter(%view_7532) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7544, %e1_7545, %e2_7546, %e3_7547 = cute.get_leaves(%iter_7543) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2385 = cute.get_scalars(%e0_7544) : !cute.int_tuple<"?">
      %2386 = cute.get_scalars(%e1_7545) : !cute.int_tuple<"?">
      %2387 = cute.get_scalars(%e2_7546) : !cute.int_tuple<"?">
      %2388 = cute.get_scalars(%e3_7547) : !cute.int_tuple<"?{div=8}">
      %lay_7548 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2389 = cute.get_shape(%lay_7548) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7549, %e1_7550, %e2_7551, %e3_7552 = cute.get_leaves(%2389) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7553 = cute.to_int_tuple(%e0_7549) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2390 = cute.get_scalars(%itup_7553) : !cute.int_tuple<"?">
      %itup_7554 = cute.to_int_tuple(%e1_7550) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2391 = cute.get_scalars(%itup_7554) : !cute.int_tuple<"?">
      %itup_7555 = cute.to_int_tuple(%e2_7551) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2392 = cute.get_scalars(%itup_7555) : !cute.int_tuple<"?">
      %itup_7556 = cute.to_int_tuple(%e3_7552) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2393 = cute.get_scalars(%itup_7556) : !cute.int_tuple<"?{div=8}">
      %coord_7557 = cute.make_coord(%e1_7545) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7558 = cute.make_coord(%itup_7554) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2394 = cute.elem_less(%coord_7557, %coord_7558) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2394 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"32">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"32">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,2,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=256}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=256}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,2,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,2,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7559 = cute.make_coord() : () -> !cute.coord<"(0,3,0)">
      %lay_7560 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7561 = cute.crd2idx(%coord_7559, %lay_7560) : (!cute.coord<"(0,3,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,48,0,0)">
      %iter_7562 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7563 = cute.add_offset(%iter_7562, %idx_7561) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,48,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7564 = cute.make_view(%tup_7563) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7565 = cute.get_iter(%view_7564) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7566, %e1_7567, %e2_7568, %e3_7569 = cute.get_leaves(%iter_7565) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2395 = cute.get_scalars(%e0_7566) : !cute.int_tuple<"?">
      %2396 = cute.get_scalars(%e1_7567) : !cute.int_tuple<"?">
      %2397 = cute.get_scalars(%e2_7568) : !cute.int_tuple<"?">
      %2398 = cute.get_scalars(%e3_7569) : !cute.int_tuple<"?{div=8}">
      %iter_7570 = cute.get_iter(%view_7564) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7571, %e1_7572, %e2_7573, %e3_7574 = cute.get_leaves(%iter_7570) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2399 = cute.get_scalars(%e0_7571) : !cute.int_tuple<"?">
      %2400 = cute.get_scalars(%e1_7572) : !cute.int_tuple<"?">
      %2401 = cute.get_scalars(%e2_7573) : !cute.int_tuple<"?">
      %2402 = cute.get_scalars(%e3_7574) : !cute.int_tuple<"?{div=8}">
      %iter_7575 = cute.get_iter(%view_7564) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7576, %e1_7577, %e2_7578, %e3_7579 = cute.get_leaves(%iter_7575) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2403 = cute.get_scalars(%e0_7576) : !cute.int_tuple<"?">
      %2404 = cute.get_scalars(%e1_7577) : !cute.int_tuple<"?">
      %2405 = cute.get_scalars(%e2_7578) : !cute.int_tuple<"?">
      %2406 = cute.get_scalars(%e3_7579) : !cute.int_tuple<"?{div=8}">
      %lay_7580 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2407 = cute.get_shape(%lay_7580) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7581, %e1_7582, %e2_7583, %e3_7584 = cute.get_leaves(%2407) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7585 = cute.to_int_tuple(%e0_7581) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2408 = cute.get_scalars(%itup_7585) : !cute.int_tuple<"?">
      %itup_7586 = cute.to_int_tuple(%e1_7582) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2409 = cute.get_scalars(%itup_7586) : !cute.int_tuple<"?">
      %itup_7587 = cute.to_int_tuple(%e2_7583) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2410 = cute.get_scalars(%itup_7587) : !cute.int_tuple<"?">
      %itup_7588 = cute.to_int_tuple(%e3_7584) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2411 = cute.get_scalars(%itup_7588) : !cute.int_tuple<"?{div=8}">
      %coord_7589 = cute.make_coord(%e1_7577) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7590 = cute.make_coord(%itup_7586) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2412 = cute.elem_less(%coord_7589, %coord_7590) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2412 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"48">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"48">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,3,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=384}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=384}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,3,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,3,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7591 = cute.make_coord() : () -> !cute.coord<"(0,4,0)">
      %lay_7592 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7593 = cute.crd2idx(%coord_7591, %lay_7592) : (!cute.coord<"(0,4,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,64,0,0)">
      %iter_7594 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7595 = cute.add_offset(%iter_7594, %idx_7593) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,64,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7596 = cute.make_view(%tup_7595) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7597 = cute.get_iter(%view_7596) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7598, %e1_7599, %e2_7600, %e3_7601 = cute.get_leaves(%iter_7597) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2413 = cute.get_scalars(%e0_7598) : !cute.int_tuple<"?">
      %2414 = cute.get_scalars(%e1_7599) : !cute.int_tuple<"?">
      %2415 = cute.get_scalars(%e2_7600) : !cute.int_tuple<"?">
      %2416 = cute.get_scalars(%e3_7601) : !cute.int_tuple<"?{div=8}">
      %iter_7602 = cute.get_iter(%view_7596) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7603, %e1_7604, %e2_7605, %e3_7606 = cute.get_leaves(%iter_7602) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2417 = cute.get_scalars(%e0_7603) : !cute.int_tuple<"?">
      %2418 = cute.get_scalars(%e1_7604) : !cute.int_tuple<"?">
      %2419 = cute.get_scalars(%e2_7605) : !cute.int_tuple<"?">
      %2420 = cute.get_scalars(%e3_7606) : !cute.int_tuple<"?{div=8}">
      %iter_7607 = cute.get_iter(%view_7596) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7608, %e1_7609, %e2_7610, %e3_7611 = cute.get_leaves(%iter_7607) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2421 = cute.get_scalars(%e0_7608) : !cute.int_tuple<"?">
      %2422 = cute.get_scalars(%e1_7609) : !cute.int_tuple<"?">
      %2423 = cute.get_scalars(%e2_7610) : !cute.int_tuple<"?">
      %2424 = cute.get_scalars(%e3_7611) : !cute.int_tuple<"?{div=8}">
      %lay_7612 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2425 = cute.get_shape(%lay_7612) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7613, %e1_7614, %e2_7615, %e3_7616 = cute.get_leaves(%2425) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7617 = cute.to_int_tuple(%e0_7613) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2426 = cute.get_scalars(%itup_7617) : !cute.int_tuple<"?">
      %itup_7618 = cute.to_int_tuple(%e1_7614) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2427 = cute.get_scalars(%itup_7618) : !cute.int_tuple<"?">
      %itup_7619 = cute.to_int_tuple(%e2_7615) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2428 = cute.get_scalars(%itup_7619) : !cute.int_tuple<"?">
      %itup_7620 = cute.to_int_tuple(%e3_7616) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2429 = cute.get_scalars(%itup_7620) : !cute.int_tuple<"?{div=8}">
      %coord_7621 = cute.make_coord(%e1_7609) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7622 = cute.make_coord(%itup_7618) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2430 = cute.elem_less(%coord_7621, %coord_7622) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2430 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"64">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"64">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,4,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=512}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=512}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,4,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,4,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7623 = cute.make_coord() : () -> !cute.coord<"(0,5,0)">
      %lay_7624 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7625 = cute.crd2idx(%coord_7623, %lay_7624) : (!cute.coord<"(0,5,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,80,0,0)">
      %iter_7626 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7627 = cute.add_offset(%iter_7626, %idx_7625) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,80,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7628 = cute.make_view(%tup_7627) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7629 = cute.get_iter(%view_7628) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7630, %e1_7631, %e2_7632, %e3_7633 = cute.get_leaves(%iter_7629) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2431 = cute.get_scalars(%e0_7630) : !cute.int_tuple<"?">
      %2432 = cute.get_scalars(%e1_7631) : !cute.int_tuple<"?">
      %2433 = cute.get_scalars(%e2_7632) : !cute.int_tuple<"?">
      %2434 = cute.get_scalars(%e3_7633) : !cute.int_tuple<"?{div=8}">
      %iter_7634 = cute.get_iter(%view_7628) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7635, %e1_7636, %e2_7637, %e3_7638 = cute.get_leaves(%iter_7634) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2435 = cute.get_scalars(%e0_7635) : !cute.int_tuple<"?">
      %2436 = cute.get_scalars(%e1_7636) : !cute.int_tuple<"?">
      %2437 = cute.get_scalars(%e2_7637) : !cute.int_tuple<"?">
      %2438 = cute.get_scalars(%e3_7638) : !cute.int_tuple<"?{div=8}">
      %iter_7639 = cute.get_iter(%view_7628) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7640, %e1_7641, %e2_7642, %e3_7643 = cute.get_leaves(%iter_7639) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2439 = cute.get_scalars(%e0_7640) : !cute.int_tuple<"?">
      %2440 = cute.get_scalars(%e1_7641) : !cute.int_tuple<"?">
      %2441 = cute.get_scalars(%e2_7642) : !cute.int_tuple<"?">
      %2442 = cute.get_scalars(%e3_7643) : !cute.int_tuple<"?{div=8}">
      %lay_7644 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2443 = cute.get_shape(%lay_7644) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7645, %e1_7646, %e2_7647, %e3_7648 = cute.get_leaves(%2443) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7649 = cute.to_int_tuple(%e0_7645) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2444 = cute.get_scalars(%itup_7649) : !cute.int_tuple<"?">
      %itup_7650 = cute.to_int_tuple(%e1_7646) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2445 = cute.get_scalars(%itup_7650) : !cute.int_tuple<"?">
      %itup_7651 = cute.to_int_tuple(%e2_7647) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2446 = cute.get_scalars(%itup_7651) : !cute.int_tuple<"?">
      %itup_7652 = cute.to_int_tuple(%e3_7648) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2447 = cute.get_scalars(%itup_7652) : !cute.int_tuple<"?{div=8}">
      %coord_7653 = cute.make_coord(%e1_7641) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7654 = cute.make_coord(%itup_7650) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2448 = cute.elem_less(%coord_7653, %coord_7654) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2448 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"80">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"80">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,5,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=640}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=640}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,5,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,5,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7655 = cute.make_coord() : () -> !cute.coord<"(0,6,0)">
      %lay_7656 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7657 = cute.crd2idx(%coord_7655, %lay_7656) : (!cute.coord<"(0,6,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,96,0,0)">
      %iter_7658 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7659 = cute.add_offset(%iter_7658, %idx_7657) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,96,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7660 = cute.make_view(%tup_7659) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7661 = cute.get_iter(%view_7660) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7662, %e1_7663, %e2_7664, %e3_7665 = cute.get_leaves(%iter_7661) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2449 = cute.get_scalars(%e0_7662) : !cute.int_tuple<"?">
      %2450 = cute.get_scalars(%e1_7663) : !cute.int_tuple<"?">
      %2451 = cute.get_scalars(%e2_7664) : !cute.int_tuple<"?">
      %2452 = cute.get_scalars(%e3_7665) : !cute.int_tuple<"?{div=8}">
      %iter_7666 = cute.get_iter(%view_7660) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7667, %e1_7668, %e2_7669, %e3_7670 = cute.get_leaves(%iter_7666) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2453 = cute.get_scalars(%e0_7667) : !cute.int_tuple<"?">
      %2454 = cute.get_scalars(%e1_7668) : !cute.int_tuple<"?">
      %2455 = cute.get_scalars(%e2_7669) : !cute.int_tuple<"?">
      %2456 = cute.get_scalars(%e3_7670) : !cute.int_tuple<"?{div=8}">
      %iter_7671 = cute.get_iter(%view_7660) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7672, %e1_7673, %e2_7674, %e3_7675 = cute.get_leaves(%iter_7671) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2457 = cute.get_scalars(%e0_7672) : !cute.int_tuple<"?">
      %2458 = cute.get_scalars(%e1_7673) : !cute.int_tuple<"?">
      %2459 = cute.get_scalars(%e2_7674) : !cute.int_tuple<"?">
      %2460 = cute.get_scalars(%e3_7675) : !cute.int_tuple<"?{div=8}">
      %lay_7676 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2461 = cute.get_shape(%lay_7676) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7677, %e1_7678, %e2_7679, %e3_7680 = cute.get_leaves(%2461) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7681 = cute.to_int_tuple(%e0_7677) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2462 = cute.get_scalars(%itup_7681) : !cute.int_tuple<"?">
      %itup_7682 = cute.to_int_tuple(%e1_7678) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2463 = cute.get_scalars(%itup_7682) : !cute.int_tuple<"?">
      %itup_7683 = cute.to_int_tuple(%e2_7679) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2464 = cute.get_scalars(%itup_7683) : !cute.int_tuple<"?">
      %itup_7684 = cute.to_int_tuple(%e3_7680) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2465 = cute.get_scalars(%itup_7684) : !cute.int_tuple<"?{div=8}">
      %coord_7685 = cute.make_coord(%e1_7673) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7686 = cute.make_coord(%itup_7682) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2466 = cute.elem_less(%coord_7685, %coord_7686) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2466 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"96">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"96">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,6,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=768}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=768}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,6,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,6,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      %coord_7687 = cute.make_coord() : () -> !cute.coord<"(0,7,0)">
      %lay_7688 = cute.get_layout(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %idx_7689 = cute.crd2idx(%coord_7687, %lay_7688) : (!cute.coord<"(0,7,0)">, !cute.layout<"((8,1),8,2):((1@3,0),16@1,64@3)">) -> !cute.int_tuple<"(0,112,0,0)">
      %iter_7690 = cute.get_iter(%dst_partitioned_7370) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">
      %tup_7691 = cute.add_offset(%iter_7690, %idx_7689) : (!cute.int_tuple<"(?,?,?,?{div=8})">, !cute.int_tuple<"(0,112,0,0)">) -> !cute.int_tuple<"(?,?,?,?{div=8})">
      %view_7692 = cute.make_view(%tup_7691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %iter_7693 = cute.get_iter(%view_7692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7694, %e1_7695, %e2_7696, %e3_7697 = cute.get_leaves(%iter_7693) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2467 = cute.get_scalars(%e0_7694) : !cute.int_tuple<"?">
      %2468 = cute.get_scalars(%e1_7695) : !cute.int_tuple<"?">
      %2469 = cute.get_scalars(%e2_7696) : !cute.int_tuple<"?">
      %2470 = cute.get_scalars(%e3_7697) : !cute.int_tuple<"?{div=8}">
      %iter_7698 = cute.get_iter(%view_7692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7699, %e1_7700, %e2_7701, %e3_7702 = cute.get_leaves(%iter_7698) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2471 = cute.get_scalars(%e0_7699) : !cute.int_tuple<"?">
      %2472 = cute.get_scalars(%e1_7700) : !cute.int_tuple<"?">
      %2473 = cute.get_scalars(%e2_7701) : !cute.int_tuple<"?">
      %2474 = cute.get_scalars(%e3_7702) : !cute.int_tuple<"?{div=8}">
      %iter_7703 = cute.get_iter(%view_7692) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()">
      %e0_7704, %e1_7705, %e2_7706, %e3_7707 = cute.get_leaves(%iter_7703) : !cute.int_tuple<"(?,?,?,?{div=8})">
      %2475 = cute.get_scalars(%e0_7704) : !cute.int_tuple<"?">
      %2476 = cute.get_scalars(%e1_7705) : !cute.int_tuple<"?">
      %2477 = cute.get_scalars(%e2_7706) : !cute.int_tuple<"?">
      %2478 = cute.get_scalars(%e3_7707) : !cute.int_tuple<"?{div=8}">
      %lay_7708 = cute.get_layout(%arg3) : !memref_gmem_bf16_
      %2479 = cute.get_shape(%lay_7708) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
      %e0_7709, %e1_7710, %e2_7711, %e3_7712 = cute.get_leaves(%2479) : !cute.shape<"(?,?,?,?{div=8})">
      %itup_7713 = cute.to_int_tuple(%e0_7709) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2480 = cute.get_scalars(%itup_7713) : !cute.int_tuple<"?">
      %itup_7714 = cute.to_int_tuple(%e1_7710) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2481 = cute.get_scalars(%itup_7714) : !cute.int_tuple<"?">
      %itup_7715 = cute.to_int_tuple(%e2_7711) : !cute.shape<"?"> to !cute.int_tuple<"?">
      %2482 = cute.get_scalars(%itup_7715) : !cute.int_tuple<"?">
      %itup_7716 = cute.to_int_tuple(%e3_7712) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
      %2483 = cute.get_scalars(%itup_7716) : !cute.int_tuple<"?{div=8}">
      %coord_7717 = cute.make_coord(%e1_7705) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %coord_7718 = cute.make_coord(%itup_7714) : (!cute.int_tuple<"?">) -> !cute.coord<"?">
      %2484 = cute.elem_less(%coord_7717, %coord_7718) : !cute.coord<"?">, !cute.coord<"?">
      scf.if %2484 {
        %coord_7719 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7720 = cute.get_layout(%rmem_7252) : !memref_rmem_bf16_27
        %idx_7721 = cute.crd2idx(%coord_7719, %lay_7720) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.int_tuple<"112">
        %iter_7722 = cute.get_iter(%rmem_7252) : !memref_rmem_bf16_27
        %ptr_7723 = cute.add_offset(%iter_7722, %idx_7721) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"112">) -> !cute.ptr<bf16, rmem, align<32>>
        %view_7724 = cute.make_view(%ptr_7723) : !memref_rmem_bf16_29
        %iter_7725 = cute.get_iter(%view_7724) : !memref_rmem_bf16_29
        %coord_7726 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7727 = cute.get_layout(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %idx_7728 = cute.crd2idx(%coord_7726, %lay_7727) : (!cute.coord<"(_,7,_)">, !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.int_tuple<"?{i64 div=896}">
        %iter_7729 = cute.get_iter(%dst_partitioned_7249) : !memref_gmem_bf16_4
        %ptr_7730 = cute.add_offset(%iter_7729, %idx_7728) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{i64 div=896}">) -> !cute.ptr<bf16, gmem, align<16>>
        %view_7731 = cute.make_view(%ptr_7730) : !memref_gmem_bf16_6
        %iter_7732 = cute.get_iter(%view_7731) : !memref_gmem_bf16_6
        %coord_7733 = cute.make_coord() : () -> !cute.coord<"(_,7,_)">
        %lay_7734 = cute.get_layout(%rmem_7384) : !memref_rmem_i8_
        %idx_7735 = cute.crd2idx(%coord_7733, %lay_7734) : (!cute.coord<"(_,7,_)">, !cute.layout<"(1,8,2):(2,0,1)">) -> !cute.int_tuple<"0">
        %iter_7736 = cute.get_iter(%rmem_7384) : !memref_rmem_i8_
        %ptr_7737 = cute.add_offset(%iter_7736, %idx_7735) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, rmem, align<32>>
        %view_7738 = cute.make_view(%ptr_7737) : !memref_rmem_i8_2
        %iter_7739 = cute.get_iter(%view_7738) : !memref_rmem_i8_2
        %lay_7740 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %2485 = cute.get_shape(%lay_7740) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7741, %e1_7742, %e2_7743 = cute.get_leaves(%2485) : !cute.shape<"((8,1),2)">
        %lay_7744 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %2486 = cute.get_shape(%lay_7744) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7745, %e1_7746, %e2_7747 = cute.get_leaves(%2486) : !cute.shape<"((8,1),2)">
        %lay_7748 = cute.get_layout(%view_7724) : !memref_rmem_bf16_29
        %shape_7749 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7750 = cute.make_layout() : !cute.layout<"1:0">
        %append_7751 = cute.append_to_rank<2> (%lay_7748, %lay_7750) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0">
        %view_7752 = cute.make_view(%iter_7725, %append_7751) : !memref_rmem_bf16_29
        %iter_7753 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %lay_7754 = cute.get_layout(%view_7752) : !memref_rmem_bf16_29
        %2487 = cute.get_shape(%lay_7754) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)">
        %e0_7755, %e1_7756, %e2_7757 = cute.get_leaves(%2487) : !cute.shape<"((8,1),2)">
        %iter_7758 = cute.get_iter(%view_7752) : !memref_rmem_bf16_29
        %view_7759 = cute.make_view(%iter_7758) : !memref_rmem_bf16_30
        %iter_7760 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7761 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %lay_7762 = cute.get_layout(%view_7731) : !memref_gmem_bf16_6
        %shape_7763 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7764 = cute.make_layout() : !cute.layout<"1:0">
        %append_7765 = cute.append_to_rank<2> (%lay_7762, %lay_7764) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0">
        %view_7766 = cute.make_view(%iter_7732, %append_7765) : !memref_gmem_bf16_6
        %iter_7767 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %lay_7768 = cute.get_layout(%view_7766) : !memref_gmem_bf16_6
        %2488 = cute.get_shape(%lay_7768) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)">
        %e0_7769, %e1_7770, %e2_7771 = cute.get_leaves(%2488) : !cute.shape<"((8,1),2)">
        %iter_7772 = cute.get_iter(%view_7766) : !memref_gmem_bf16_6
        %view_7773 = cute.make_view(%iter_7772) : !memref_gmem_bf16_7
        %iter_7774 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %iter_7775 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7776 = cute.get_layout(%view_7738) : !memref_rmem_i8_2
        %shape_7777 = cute.make_shape() : () -> !cute.shape<"1">
        %lay_7778 = cute.make_layout() : !cute.layout<"1:0">
        %append_7779 = cute.append_to_rank<2> (%lay_7776, %lay_7778) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0">
        %view_7780 = cute.make_view(%iter_7739, %append_7779) : !memref_rmem_i8_2
        %iter_7781 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %lay_7782 = cute.get_layout(%view_7780) : !memref_rmem_i8_2
        %2489 = cute.get_shape(%lay_7782) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)">
        %e0_7783, %e1_7784 = cute.get_leaves(%2489) : !cute.shape<"(1,2)">
        %iter_7785 = cute.get_iter(%view_7780) : !memref_rmem_i8_2
        %view_7786 = cute.make_view(%iter_7785) : !memref_rmem_i8_3
        %iter_7787 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %iter_7788 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7789 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %2490 = cute.get_shape(%lay_7789) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))">
        %e0_7790, %e1_7791, %e2_7792 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(2))">
        %lay_7793 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %2491 = cute.get_shape(%lay_7793) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))">
        %e0_7794, %e1_7795, %e2_7796 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(2))">
        %lay_7797 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %sz_7798 = cute.size(%lay_7797) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.int_tuple<"2">
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"2">
        %lay_7800 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %sz_7801 = cute.size(%lay_7800) <{mode = [1]}> : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.int_tuple<"2">
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"2">
        %2492 = cute.static : !cute.layout<"1:0">
        %iter_7803 = cute.get_iter(%view_7759) : !memref_rmem_bf16_30
        %iter_7804 = cute.get_iter(%view_7773) : !memref_gmem_bf16_7
        %lay_7805 = cute.get_layout(%view_7759) : !memref_rmem_bf16_30
        %lay_7806 = cute.get_layout(%view_7773) : !memref_gmem_bf16_7
        %append_7807 = cute.append_to_rank<2> (%lay_7805, %2492) : !cute.layout<"((8,1),(2)):((1,0),(8))">, !cute.layout<"1:0">
        %append_7808 = cute.append_to_rank<2> (%lay_7806, %2492) : !cute.layout<"((8,1),(2)):((1,0),(64))">, !cute.layout<"1:0">
        %lay_7809 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((8)))">
        %lay_7810 = cute.make_layout() : !cute.layout<"((8,1),((2))):((1,0),((64)))">
        %iter_7811 = cute.get_iter(%view_7786) : !memref_rmem_i8_3
        %lay_7812 = cute.get_layout(%view_7786) : !memref_rmem_i8_3
        %append_7813 = cute.append_to_rank<2> (%lay_7812, %2492) : !cute.layout<"(1,(2)):(2,(1))">, !cute.layout<"1:0">
        %lay_7814 = cute.make_layout() : !cute.layout<"(1,((2))):(2,((1)))">
        %sz_7815 = cute.size(%lay_7809) <{mode = [1]}> : (!cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"2">
        %2493 = cute.get_scalars(%sz_7815) : !cute.int_tuple<"2">
        %c0_i32_7816 = arith.constant 0 : i32
        %c1_i32_7817 = arith.constant 1 : i32
        scf.for %arg5 = %c0_i32_7816 to %2493 step %c1_i32_7817  : i32 {
          %coord_7818 = cute.make_coord(%arg5) : (i32) -> !cute.coord<"(_,?)">
          %slice_7819 = cute.slice(%lay_7809, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((8)))">, !cute.coord<"(_,?)">
          %idx_7820 = cute.crd2idx(%coord_7818, %lay_7809) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((8)))">) -> !cute.int_tuple<"?{div=8}">
          %ptr_7821 = cute.add_offset(%iter_7803, %idx_7820) : (!cute.ptr<bf16, rmem, align<32>>, !cute.int_tuple<"?{div=8}">) -> !cute.ptr<bf16, rmem, align<16>>
          %view_7822 = cute.make_view(%ptr_7821, %slice_7819) : !memref_rmem_bf16_8
          %slice_7823 = cute.slice(%lay_7810, %coord_7818) : !cute.layout<"((8,1),((2))):((1,0),((64)))">, !cute.coord<"(_,?)">
          %idx_7824 = cute.crd2idx(%coord_7818, %lay_7810) : (!cute.coord<"(_,?)">, !cute.layout<"((8,1),((2))):((1,0),((64)))">) -> !cute.int_tuple<"?{div=64}">
          %ptr_7825 = cute.add_offset(%iter_7804, %idx_7824) : (!cute.ptr<bf16, gmem, align<16>>, !cute.int_tuple<"?{div=64}">) -> !cute.ptr<bf16, gmem, align<16>>
          %view_7826 = cute.make_view(%ptr_7825, %slice_7823) : !memref_gmem_bf16_8
          %slice_7827 = cute.slice(%lay_7814, %coord_7818) : !cute.layout<"(1,((2))):(2,((1)))">, !cute.coord<"(_,?)">
          %idx_7828 = cute.crd2idx(%coord_7818, %lay_7814) : (!cute.coord<"(_,?)">, !cute.layout<"(1,((2))):(2,((1)))">) -> !cute.int_tuple<"?">
          %ptr_7829 = cute.add_offset(%iter_7811, %idx_7828) : (!cute.ptr<i8, rmem, align<32>>, !cute.int_tuple<"?">) -> !cute.ptr<i8, rmem>
          %view_7830 = cute.make_view(%ptr_7829, %slice_7827) : !memref_rmem_i8_4
          cute.copy_atom_call(%4, %view_7822, %view_7826, %view_7830) : (!copy_simt, !memref_rmem_bf16_8, !memref_gmem_bf16_8, !memref_rmem_i8_4) -> ()
        } {llvm.loop_annotation = #loop_annotation}
      }
      return
    }
  }
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_, %arg1: !memref_gmem_bf16_, %arg2: !memref_gmem_bf16_, %arg3: !memref_gmem_bf16_, %arg4: f32, %arg5: !gpu.async.token) attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})">
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?">
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?">
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?">
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}">
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}">
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}">
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}">
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?">
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?">
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?">
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}">
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}">
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}">
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}">
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?">
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?">
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?">
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}">
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}">
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}">
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}">
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?">
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?">
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?">
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}">
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}">
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}">
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}">
    %36 = cute.static : !cute.swizzle<"S<3,3,3>">
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)">
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)">
    %lay_65 = cute.make_layout() : !cute.layout<"(8,64):(64,1)">
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)">
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)">
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0">
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)">
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %38 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)">
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)">
    %39 = cute.static : !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
    %cosz = cute.cosize(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384">
    %e0_73 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384">
    %cosz_74 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_75 = cute.get_leaves(%cosz_74) : !cute.int_tuple<"8192">
    %cosz_76 = cute.cosize(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192">
    %e0_77 = cute.get_leaves(%cosz_76) : !cute.int_tuple<"8192">
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>
    %atom_78 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b>
    %40 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)">
    %41 = cute.get_shape(%40) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)">
    %e0_79, %e1_80 = cute.get_leaves(%41) : !cute.shape<"(8,64)">
    %shape_81 = cute.make_shape() : () -> !cute.shape<"(16,8)">
    %stride_82 = cute.make_stride() : () -> !cute.stride<"(8,1)">
    %lay_83 = cute.make_layout() : !cute.layout<"(16,8):(8,1)">
    %shape_84 = cute.make_shape() : () -> !cute.shape<"(1,8)">
    %lay_85 = cute.make_layout() : !cute.layout<"(1,8):(0,1)">
    %prod = cute.raked_product(%lay_83, %lay_85) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_86 = cute.get_leaves(%sz) : !cute.int_tuple<"128">
    %sz_87 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_88 = cute.get_leaves(%sz_87) : !cute.int_tuple<"8">
    %shape_89 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_90 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_91 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %42 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_92, %e1_93, %e2_94 = cute.get_leaves(%42) : !cute.shape<"(16,(8,8))">
    %int_tuple_95 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res = cute.tuple.product_each(%int_tuple_95) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_96, %e1_97 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)">
    %int_tuple_98 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_99 = cute.tuple.product_each(%int_tuple_98) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_100, %e1_101 = cute.get_leaves(%res_99) : !cute.int_tuple<"(16,64)">
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %43 = cute.make_tiled_copy(%atom) : !copy_ldgsts
    %prod_102 = cute.raked_product(%lay_83, %lay_85) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))">
    %sz_103 = cute.size(%lay_83) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128">
    %e0_104 = cute.get_leaves(%sz_103) : !cute.int_tuple<"128">
    %sz_105 = cute.size(%lay_85) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8">
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"8">
    %shape_107 = cute.make_shape() : () -> !cute.shape<"(128,8)">
    %lay_108 = cute.make_layout() : !cute.layout<"(128,8):(1,128)">
    %rinv_109 = cute.right_inverse(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)">
    %lay_110 = cute.make_layout() : !cute.layout<"((8,16),8):((128,1),16)">
    %44 = cute.get_shape(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))">
    %e0_111, %e1_112, %e2_113 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))">
    %int_tuple_114 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))">
    %res_115 = cute.tuple.product_each(%int_tuple_114) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)">
    %e0_116, %e1_117 = cute.get_leaves(%res_115) : !cute.int_tuple<"(16,64)">
    %int_tuple_118 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)">
    %res_119 = cute.tuple.product_each(%int_tuple_118) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)">
    %e0_120, %e1_121 = cute.get_leaves(%res_119) : !cute.int_tuple<"(16,64)">
    %tile_122 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]">
    %45 = cute.make_tiled_copy(%atom_78) : !copy_simt
    %shape_123 = cute.make_shape() : () -> !cute.shape<"(16,8,16)">
    %atom_124 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >
    %shape_125 = cute.make_shape() : () -> !cute.shape<"(4,1,1)">
    %lay_126 = cute.make_layout() : !cute.layout<"(4,1,1):(1,0,0)">
    %46 = cute.get_shape(%lay_126) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)">
    %e0_127, %e1_128, %e2_129 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)">
    %tile_130 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]">
    %47 = cute.make_tiled_mma(%atom_124) : !mma_bf16_bf16_f32_16x8x16_
    %lay_131 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %48 = cute.get_shape(%lay_131) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_132, %e1_133, %e2_134, %e3_135 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_136 = cute.to_int_tuple(%e0_132) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %49 = cute.get_scalars(%itup_136) : !cute.int_tuple<"?">
    %itup_137 = cute.to_int_tuple(%e1_133) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %50 = cute.get_scalars(%itup_137) : !cute.int_tuple<"?">
    %itup_138 = cute.to_int_tuple(%e2_134) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %51 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?">
    %itup_139 = cute.to_int_tuple(%e3_135) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %52 = cute.get_scalars(%itup_139) : !cute.int_tuple<"?{div=8}">
    %int_tuple_140 = cute.make_int_tuple(%itup_137) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %tile_141 = cute.make_tile() : () -> !cute.tile<"128:1">
    %53 = cute.get_scalars(%int_tuple_140) <{only_dynamic}> : !cute.int_tuple<"?">
    %c128_i32 = arith.constant 128 : i32
    %54 = arith.ceildivsi %53, %c128_i32 : i32
    %int_tuple_142 = cute.make_int_tuple(%54) : (i32) -> !cute.int_tuple<"?">
    %e0_143 = cute.get_leaves(%int_tuple_142) : !cute.int_tuple<"?">
    %55 = cute.get_scalars(%e0_143) : !cute.int_tuple<"?">
    %int_tuple_144 = cute.make_int_tuple(%itup_136) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_145 = cute.size(%int_tuple_144) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_146 = cute.get_leaves(%sz_145) : !cute.int_tuple<"?">
    %56 = cute.get_scalars(%e0_146) : !cute.int_tuple<"?">
    %int_tuple_147 = cute.make_int_tuple(%itup_138) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %sz_148 = cute.size(%int_tuple_147) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?">
    %e0_149 = cute.get_leaves(%sz_148) : !cute.int_tuple<"?">
    %57 = cute.get_scalars(%e0_149) : !cute.int_tuple<"?">
    %cst = arith.constant 1.44269502 : f32
    %58 = arith.mulf %arg4, %cst : f32
    %lay_150 = cute.get_layout(%arg0) : !memref_gmem_bf16_
    %59 = cute.get_shape(%lay_150) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_151, %e1_152, %e2_153, %e3_154 = cute.get_leaves(%59) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_155 = cute.to_int_tuple(%e0_151) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %60 = cute.get_scalars(%itup_155) : !cute.int_tuple<"?">
    %itup_156 = cute.to_int_tuple(%e1_152) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %61 = cute.get_scalars(%itup_156) : !cute.int_tuple<"?">
    %itup_157 = cute.to_int_tuple(%e2_153) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %62 = cute.get_scalars(%itup_157) : !cute.int_tuple<"?">
    %itup_158 = cute.to_int_tuple(%e3_154) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %63 = cute.get_scalars(%itup_158) : !cute.int_tuple<"?{div=8}">
    %64 = cute.get_stride(%lay_150) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_159, %e1_160, %e2_161, %e3_162 = cute.get_leaves(%64) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_163 = cute.to_int_tuple(%e0_159) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %65 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{i64 div=8}">
    %itup_164 = cute.to_int_tuple(%e1_160) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %66 = cute.get_scalars(%itup_164) : !cute.int_tuple<"?{i64 div=8}">
    %itup_165 = cute.to_int_tuple(%e2_161) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %67 = cute.get_scalars(%itup_165) : !cute.int_tuple<"?{i64 div=8}">
    %lay_166 = cute.get_layout(%arg1) : !memref_gmem_bf16_
    %68 = cute.get_shape(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%68) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_171 = cute.to_int_tuple(%e0_167) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %69 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?">
    %itup_172 = cute.to_int_tuple(%e1_168) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %70 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?">
    %itup_173 = cute.to_int_tuple(%e2_169) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %71 = cute.get_scalars(%itup_173) : !cute.int_tuple<"?">
    %itup_174 = cute.to_int_tuple(%e3_170) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %72 = cute.get_scalars(%itup_174) : !cute.int_tuple<"?{div=8}">
    %73 = cute.get_stride(%lay_166) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%73) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_179 = cute.to_int_tuple(%e0_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %74 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}">
    %itup_180 = cute.to_int_tuple(%e1_176) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %75 = cute.get_scalars(%itup_180) : !cute.int_tuple<"?{i64 div=8}">
    %itup_181 = cute.to_int_tuple(%e2_177) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %76 = cute.get_scalars(%itup_181) : !cute.int_tuple<"?{i64 div=8}">
    %lay_182 = cute.get_layout(%arg2) : !memref_gmem_bf16_
    %77 = cute.get_shape(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_183, %e1_184, %e2_185, %e3_186 = cute.get_leaves(%77) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_187 = cute.to_int_tuple(%e0_183) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %78 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?">
    %itup_188 = cute.to_int_tuple(%e1_184) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %79 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?">
    %itup_189 = cute.to_int_tuple(%e2_185) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %80 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?">
    %itup_190 = cute.to_int_tuple(%e3_186) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %81 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?{div=8}">
    %82 = cute.get_stride(%lay_182) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_191, %e1_192, %e2_193, %e3_194 = cute.get_leaves(%82) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_195 = cute.to_int_tuple(%e0_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %83 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}">
    %itup_196 = cute.to_int_tuple(%e1_192) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %84 = cute.get_scalars(%itup_196) : !cute.int_tuple<"?{i64 div=8}">
    %itup_197 = cute.to_int_tuple(%e2_193) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %85 = cute.get_scalars(%itup_197) : !cute.int_tuple<"?{i64 div=8}">
    %lay_198 = cute.get_layout(%arg3) : !memref_gmem_bf16_
    %86 = cute.get_shape(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})">
    %e0_199, %e1_200, %e2_201, %e3_202 = cute.get_leaves(%86) : !cute.shape<"(?,?,?,?{div=8})">
    %itup_203 = cute.to_int_tuple(%e0_199) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %87 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?">
    %itup_204 = cute.to_int_tuple(%e1_200) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %88 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?">
    %itup_205 = cute.to_int_tuple(%e2_201) : !cute.shape<"?"> to !cute.int_tuple<"?">
    %89 = cute.get_scalars(%itup_205) : !cute.int_tuple<"?">
    %itup_206 = cute.to_int_tuple(%e3_202) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}">
    %90 = cute.get_scalars(%itup_206) : !cute.int_tuple<"?{div=8}">
    %91 = cute.get_stride(%lay_198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %e0_207, %e1_208, %e2_209, %e3_210 = cute.get_leaves(%91) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
    %itup_211 = cute.to_int_tuple(%e0_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %92 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}">
    %itup_212 = cute.to_int_tuple(%e1_208) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %93 = cute.get_scalars(%itup_212) : !cute.int_tuple<"?{i64 div=8}">
    %itup_213 = cute.to_int_tuple(%e2_209) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}">
    %94 = cute.get_scalars(%itup_213) : !cute.int_tuple<"?{i64 div=8}">
    %95 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %96 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_214 = cute.get_leaves(%96) : !cute.int_tuple<"0">
    %97 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %98 = cute.get_shape(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_215, %e1_216, %e2_217, %e3_218 = cute.get_leaves(%98) : !cute.shape<"((8,16),(64,2))">
    %99 = cute.get_stride(%97) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_219, %e1_220, %e2_221, %e3_222 = cute.get_leaves(%99) : !cute.stride<"((64,512),(1,8192))">
    %100 = cute.composed_get_inner(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>">
    %101 = cute.composed_get_offset(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0">
    %e0_223 = cute.get_leaves(%101) : !cute.int_tuple<"0">
    %102 = cute.composed_get_outer(%39) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">
    %103 = cute.get_shape(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))">
    %e0_224, %e1_225, %e2_226, %e3_227 = cute.get_leaves(%103) : !cute.shape<"((8,8),(64,2))">
    %104 = cute.get_stride(%102) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))">
    %e0_228, %e1_229, %e2_230, %e3_231 = cute.get_leaves(%104) : !cute.stride<"((64,512),(1,4096))">
    %105 = cute.composed_get_inner(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>">
    %106 = cute.composed_get_offset(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0">
    %e0_232 = cute.get_leaves(%106) : !cute.int_tuple<"0">
    %107 = cute.composed_get_outer(%38) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">
    %108 = cute.get_shape(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))">
    %e0_233, %e1_234, %e2_235, %e3_236 = cute.get_leaves(%108) : !cute.shape<"((8,16),(64,2))">
    %109 = cute.get_stride(%107) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))">
    %e0_237, %e1_238, %e2_239, %e3_240 = cute.get_leaves(%109) : !cute.stride<"((64,512),(1,8192))">
    %110 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_241, %e1_242 = cute.get_leaves(%110) : !cute.tile<"[16:1;64:1]">
    %111 = cute.get_shape(%e0_241) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_243 = cute.get_leaves(%111) : !cute.shape<"16">
    %112 = cute.get_stride(%e0_241) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_244 = cute.get_leaves(%112) : !cute.stride<"1">
    %113 = cute.get_shape(%e1_242) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_245 = cute.get_leaves(%113) : !cute.shape<"64">
    %114 = cute.get_stride(%e1_242) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_246 = cute.get_leaves(%114) : !cute.stride<"1">
    %115 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %116 = cute.get_shape(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_247, %e1_248, %e2_249 = cute.get_leaves(%116) : !cute.shape<"((8,16),8)">
    %117 = cute.get_stride(%115) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_250, %e1_251, %e2_252 = cute.get_leaves(%117) : !cute.stride<"((128,1),16)">
    %118 = cute.static : !cute.layout<"1:0">
    %119 = cute.get_shape(%118) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_253 = cute.get_leaves(%119) : !cute.shape<"1">
    %120 = cute.get_stride(%118) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_254 = cute.get_leaves(%120) : !cute.stride<"0">
    %121 = cute.static : !cute.layout<"(1,8):(0,1)">
    %122 = cute.get_shape(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_255, %e1_256 = cute.get_leaves(%122) : !cute.shape<"(1,8)">
    %123 = cute.get_stride(%121) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_257, %e1_258 = cute.get_leaves(%123) : !cute.stride<"(0,1)">
    %124 = cute.static : !cute.layout<"(1,8):(0,1)">
    %125 = cute.get_shape(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_259, %e1_260 = cute.get_leaves(%125) : !cute.shape<"(1,8)">
    %126 = cute.get_stride(%124) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_261, %e1_262 = cute.get_leaves(%126) : !cute.stride<"(0,1)">
    %127 = cute.static : !cute.tile<"[16:1;64:1]">
    %e0_263, %e1_264 = cute.get_leaves(%127) : !cute.tile<"[16:1;64:1]">
    %128 = cute.get_shape(%e0_263) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_265 = cute.get_leaves(%128) : !cute.shape<"16">
    %129 = cute.get_stride(%e0_263) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_266 = cute.get_leaves(%129) : !cute.stride<"1">
    %130 = cute.get_shape(%e1_264) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_267 = cute.get_leaves(%130) : !cute.shape<"64">
    %131 = cute.get_stride(%e1_264) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_268 = cute.get_leaves(%131) : !cute.stride<"1">
    %132 = cute.static : !cute.layout<"((8,16),8):((128,1),16)">
    %133 = cute.get_shape(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)">
    %e0_269, %e1_270, %e2_271 = cute.get_leaves(%133) : !cute.shape<"((8,16),8)">
    %134 = cute.get_stride(%132) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)">
    %e0_272, %e1_273, %e2_274 = cute.get_leaves(%134) : !cute.stride<"((128,1),16)">
    %135 = cute.static : !cute.layout<"1:0">
    %136 = cute.get_shape(%135) : (!cute.layout<"1:0">) -> !cute.shape<"1">
    %e0_275 = cute.get_leaves(%136) : !cute.shape<"1">
    %137 = cute.get_stride(%135) : (!cute.layout<"1:0">) -> !cute.stride<"0">
    %e0_276 = cute.get_leaves(%137) : !cute.stride<"0">
    %138 = cute.static : !cute.layout<"(1,8):(0,1)">
    %139 = cute.get_shape(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_277, %e1_278 = cute.get_leaves(%139) : !cute.shape<"(1,8)">
    %140 = cute.get_stride(%138) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_279, %e1_280 = cute.get_leaves(%140) : !cute.stride<"(0,1)">
    %141 = cute.static : !cute.layout<"(1,8):(0,1)">
    %142 = cute.get_shape(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)">
    %e0_281, %e1_282 = cute.get_leaves(%142) : !cute.shape<"(1,8)">
    %143 = cute.get_stride(%141) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)">
    %e0_283, %e1_284 = cute.get_leaves(%143) : !cute.stride<"(0,1)">
    %144 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)">
    %145 = cute.get_shape(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)">
    %e0_285, %e1_286, %e2_287, %e3_288 = cute.get_leaves(%145) : !cute.shape<"(32,4,1,1)">
    %146 = cute.get_stride(%144) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)">
    %e0_289, %e1_290, %e2_291, %e3_292 = cute.get_leaves(%146) : !cute.stride<"(1,32,0,0)">
    %147 = cute.static : !cute.tile<"[64:1;16:1;16:1]">
    %e0_293, %e1_294, %e2_295 = cute.get_leaves(%147) : !cute.tile<"[64:1;16:1;16:1]">
    %148 = cute.get_shape(%e0_293) : (!cute.layout<"64:1">) -> !cute.shape<"64">
    %e0_296 = cute.get_leaves(%148) : !cute.shape<"64">
    %149 = cute.get_stride(%e0_293) : (!cute.layout<"64:1">) -> !cute.stride<"1">
    %e0_297 = cute.get_leaves(%149) : !cute.stride<"1">
    %150 = cute.get_shape(%e1_294) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_298 = cute.get_leaves(%150) : !cute.shape<"16">
    %151 = cute.get_stride(%e1_294) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_299 = cute.get_leaves(%151) : !cute.stride<"1">
    %152 = cute.get_shape(%e2_295) : (!cute.layout<"16:1">) -> !cute.shape<"16">
    %e0_300 = cute.get_leaves(%152) : !cute.shape<"16">
    %153 = cute.get_stride(%e2_295) : (!cute.layout<"16:1">) -> !cute.stride<"1">
    %e0_301 = cute.get_leaves(%153) : !cute.stride<"1">
    %154 = cute.static : !cute.layout<"32:1">
    %155 = cute.get_shape(%154) : (!cute.layout<"32:1">) -> !cute.shape<"32">
    %e0_302 = cute.get_leaves(%155) : !cute.shape<"32">
    %156 = cute.get_stride(%154) : (!cute.layout<"32:1">) -> !cute.stride<"1">
    %e0_303 = cute.get_leaves(%156) : !cute.stride<"1">
    %157 = cute.static : !cute.shape<"(16,8,16)">
    %e0_304, %e1_305, %e2_306 = cute.get_leaves(%157) : !cute.shape<"(16,8,16)">
    %158 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">
    %159 = cute.get_shape(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))">
    %e0_307, %e1_308, %e2_309, %e3_310, %e4 = cute.get_leaves(%159) : !cute.shape<"((4,8),(2,2,2))">
    %160 = cute.get_stride(%158) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))">
    %e0_311, %e1_312, %e2_313, %e3_314, %e4_315 = cute.get_leaves(%160) : !cute.stride<"((32,1),(16,8,128))">
    %161 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))">
    %162 = cute.get_shape(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_316, %e1_317, %e2_318, %e3_319 = cute.get_leaves(%162) : !cute.shape<"((4,8),(2,2))">
    %163 = cute.get_stride(%161) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))">
    %e0_320, %e1_321, %e2_322, %e3_323 = cute.get_leaves(%163) : !cute.stride<"((16,1),(8,64))">
    %164 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))">
    %165 = cute.get_shape(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))">
    %e0_324, %e1_325, %e2_326, %e3_327 = cute.get_leaves(%165) : !cute.shape<"((4,8),(2,2))">
    %166 = cute.get_stride(%164) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))">
    %e0_328, %e1_329, %e2_330, %e3_331 = cute.get_leaves(%166) : !cute.stride<"((32,1),(16,8))">
    %167 = arith.index_cast %55 : i32 to index
    %168 = arith.index_cast %56 : i32 to index
    %169 = arith.index_cast %57 : i32 to index
    %c128 = arith.constant 128 : index
    %c1 = arith.constant 1 : index
    %c65536_i32 = arith.constant 65536 : i32
    %170 = gpu.launch_func async [%arg5] @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div8div8div81_tensorptrbf16gmemalign16odiv8div_0 blocks in (%167, %168, %169) threads in (%c128, %c1, %c1)  dynamic_shared_memory_size %c65536_i32 args(%arg0 : !memref_gmem_bf16_, %arg1 : !memref_gmem_bf16_, %arg2 : !memref_gmem_bf16_, %arg3 : !memref_gmem_bf16_, %58 : f32) {use_pdl = false}
    return
  }
}
