

!copy_ldgsts = !cute.tiled_copy<!cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_ldsm_4_ = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))">, tiler_mn = <"[64:1;16:1]">>
!copy_ldsm_4_1 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_ldsm_4_2 = !cute.tiled_copy<!cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t>, layout_copy_tv = <"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))">, tiler_mn = <"[16:1;16:1]">>
!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16, 128 b>, layout_copy_tv = <"((8,16),8):((128,1),16)">, tiler_mn = <"[16:1;64:1]">>
!copy_simt1 = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<bf16>, layout_copy_tv = <"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))">, tiler_mn = <"[64:1;16:1]">>
!memref_gmem_bf16_ = !cute.memref<bf16, gmem, align<16>, "(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">
!memref_gmem_bf16_1 = !cute.memref<bf16, gmem, align<16>, "(?,?{div=8}):(?{i64 div=8},1)">
!memref_gmem_bf16_2 = !cute.memref<bf16, gmem, align<16>, "(128,128):(?{i64 div=8},1)">
!memref_gmem_bf16_3 = !cute.memref<bf16, gmem, align<16>, "(64,128,?):(?{i64 div=8},1,?{i64 div=512})">
!memref_gmem_bf16_4 = !cute.memref<bf16, gmem, align<16>, "((8,1),8,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_5 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2,?):((1,0),?{i64 div=128},64,?{i64 div=512})">
!memref_gmem_bf16_6 = !cute.memref<bf16, gmem, align<16>, "((8,1),2):((1,0),64)">
!memref_gmem_bf16_7 = !cute.memref<bf16, gmem, align<16>, "((8,1),(2)):((1,0),(64))">
!memref_gmem_bf16_8 = !cute.memref<bf16, gmem, align<16>, "((8,1),4,2):((1,0),?{i64 div=128},64)">
!memref_gmem_bf16_9 = !cute.memref<bf16, gmem, align<16>, "((8,1),(4,2)):((1,0),(?{i64 div=128},64))">
!memref_rmem_bf16_ = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2,((2,2),2)):((1,2,4),8,((32,64),16))">
!memref_rmem_bf16_1 = !cute.memref<bf16, rmem, align<8>, "((2,2),8,((2,2),2)):((1,2),4,((64,128),32))">
!memref_rmem_bf16_2 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2),4):((1,2),(4,128),32)">
!memref_rmem_bf16_3 = !cute.memref<bf16, rmem, align<16>, "((8,1),2,(4,2)):((1,0),8,(32,16))">
!memref_rmem_bf16_4 = !cute.memref<bf16, rmem, align<8>, "((8,1),4,(4,2)):((1,0),8,(64,32))">
!memref_rmem_bf16_5 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2),4):((1,0),(8,128),32)">
!memref_rmem_bf16_6 = !cute.memref<bf16, rmem, align<16>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_7 = !cute.memref<bf16, rmem, align<16>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_bf16_8 = !cute.memref<bf16, rmem, align<8>, "((8,1),4):((1,0),8)">
!memref_rmem_bf16_9 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4)):((1,0),(8))">
!memref_rmem_bf16_10 = !cute.memref<bf16, rmem, align<16>, "((2,2,2),2):((1,2,4),8)">
!memref_rmem_bf16_11 = !cute.memref<bf16, rmem, align<8>, "((2,2),8):((1,2),4)">
!memref_rmem_bf16_12 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_bf16_13 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2,4):(((1,2),8),4,16)">
!memref_rmem_bf16_14 = !cute.memref<bf16, rmem, align<8>, "((8,1),(4,2)):((1,0),(8,128))">
!memref_rmem_bf16_15 = !cute.memref<bf16, rmem, align<8>, "((8,1),((4,2))):((1,0),((8,128)))">
!memref_rmem_bf16_16 = !cute.memref<bf16, rmem, align<32>, "(((2,2),2),2):(((1,2),8),4)">
!memref_rmem_bf16_17 = !cute.memref<bf16, rmem, align<8>, "((2,2),(8,2)):((1,2),(4,128))">
!memref_rmem_bf16_18 = !cute.memref<bf16, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_bf16_19 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),2,8):((0,(1,8)),4,16)">
!memref_rmem_bf16_20 = !cute.memref<bf16, rmem, align<32>, "((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">
!memref_rmem_bf16_21 = !cute.memref<bf16, rmem, align<32>, "((8,1),8,2):((1,0),16,8)">
!memref_rmem_bf16_22 = !cute.memref<bf16, rmem, align<32>, "((8,1),(8,2)):((1,0),(16,8))">
!memref_rmem_bf16_23 = !cute.memref<bf16, rmem, align<32>, "((8,1),2):((1,0),8)">
!memref_rmem_bf16_24 = !cute.memref<bf16, rmem, align<32>, "((8,1),(2)):((1,0),(8))">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((2,2),2,16):((1,2),4,8)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "4:1">
!memref_rmem_f32_2 = !cute.memref<f32, rmem, align<32>, "((2,2),2,8):((1,2),4,8)">
!memref_rmem_f32_3 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,8)):((2,4),(1,8))">
!memref_rmem_f32_4 = !cute.memref<f32, rmem, align<32>, "((2,2),(2,16)):((2,4),(1,8))">
!memref_rmem_f32_5 = !cute.memref<f32, rmem, align<32>, "((2,8)):((1,8))">
!memref_rmem_f32_6 = !cute.memref<f32, rmem, align<8>, "((2,8)):((1,8))">
!memref_rmem_f32_7 = !cute.memref<f32, rmem, align<16>, "((2,8)):((1,8))">
!memref_rmem_f32_8 = !cute.memref<f32, rmem, align<32>, "((2,16)):((1,8))">
!memref_rmem_f32_9 = !cute.memref<f32, rmem, align<8>, "((2,16)):((1,8))">
!memref_rmem_f32_10 = !cute.memref<f32, rmem, align<16>, "((2,16)):((1,8))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "(1,8,2):(2,0,1)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "(1,4,2):(2,0,1)">
!memref_rmem_i8_2 = !cute.memref<i8, rmem, align<32>, "(1,2):(2,1)">
!memref_rmem_i8_3 = !cute.memref<i8, rmem, align<32>, "(1,(2)):(2,(1))">
!memref_rmem_i8_4 = !cute.memref<i8, rmem, align<32>, "(1,(4,2)):(2,(0,1))">
!memref_smem_bf16_ = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">
!memref_smem_bf16_1 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">
!memref_smem_bf16_2 = !cute.memref<bf16, smem, align<1024>, "S<3,3,3> o 0 o ((64,2),64):((1,4096),64)">
!memref_smem_bf16_3 = !cute.memref<bf16, smem, align<16>, "((8,1),8,2):((1,0),1024,8192)">
!memref_smem_bf16_4 = !cute.memref<bf16, smem, align<16>, "((8,1),4,2):((1,0),1024,4096)">
!memref_smem_bf16_5 = !cute.memref<bf16, smem, align<4>, "((2,2,2),2,((2,2),2)):((1,512,?{div=8}),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_6 = !cute.memref<bf16, smem, align<4>, "((2,2),8,((2,2),2)):((1,?{div=8}),512,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_7 = !cute.memref<bf16, smem, "S<3,3,3> o ?{div=128} o ((2,2),(8,2),4):((64,512),(8,4096),1024)">
!memref_smem_bf16_8 = !cute.memref<bf16, smem, align<16>, "((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_9 = !cute.memref<bf16, smem, align<16>, "((8,1),4,((2,2),2)):((1,0),1024,((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_10 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2),4):((1,0),((?{div=16},?{div=32}),4096),1024)">
!memref_smem_bf16_11 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),8192)">
!memref_smem_bf16_12 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(8192))">
!memref_smem_bf16_13 = !cute.memref<bf16, smem, align<16>, "((8,1),2):((1,0),4096)">
!memref_smem_bf16_14 = !cute.memref<bf16, smem, align<16>, "((8,1),(2)):((1,0),(4096))">
!memref_smem_bf16_15 = !cute.memref<bf16, smem, align<16>, "((8,1),(4,2)):((1,0),(1024,4096))">
!memref_smem_bf16_16 = !cute.memref<bf16, smem, align<16>, "((8,1),4):((1,0),1024)">
!memref_smem_bf16_17 = !cute.memref<bf16, smem, align<16>, "((8,1),(4)):((1,0),(1024))">
!memref_smem_bf16_18 = !cute.memref<bf16, smem, align<16>, "((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">
!memref_smem_bf16_19 = !cute.memref<bf16, smem, align<16>, "((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">
!memref_smem_bf16_20 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">
!memref_smem_bf16_21 = !cute.memref<bf16, smem, align<4>, "((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">
!memref_smem_bf16_22 = !cute.memref<bf16, smem, align<16>, "((8,1),(8,2)):((1,0),(1024,8192))">
!mma_bf16_bf16_f32_16x8x16_ = !cute.tiled_mma<!cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) >, atom_layout_MNK = <"(4,1,1):(1,0,0)">, permutation_MNK = <"[64:1;16:1;16:1]">>
#loc = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1143:0)
#loc1 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":326:0)
#loc290 = loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc))
#loc291 = loc("self.kernel("(#loc1))
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0(%arg0: !memref_gmem_bf16_ loc("self.kernel("(#loc1)), %arg1: !memref_gmem_bf16_ loc("self.kernel("(#loc1)), %arg2: !memref_gmem_bf16_ loc("self.kernel("(#loc1)), %arg3: !memref_gmem_bf16_ loc("self.kernel("(#loc1)), %arg4: f32 loc("self.kernel("(#loc1)), %arg5: !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))"> loc("self.kernel("(#loc1)), %arg6: !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))"> loc("self.kernel("(#loc1)), %arg7: !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))"> loc("self.kernel("(#loc1)), %arg8: !copy_ldgsts loc("self.kernel("(#loc1)), %arg9: !copy_simt loc("self.kernel("(#loc1)), %arg10: !mma_bf16_bf16_f32_16x8x16_ loc("self.kernel("(#loc1))) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_ loc(#loc292)
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_ loc(#loc292)
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_ loc(#loc292)
      %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_ loc(#loc292)
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_ loc(#loc293)
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_ loc(#loc293)
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_ loc(#loc293)
      %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_ loc(#loc293)
      %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc294)
      %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc294)
      %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_ loc(#loc294)
      %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc294)
      %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %36 = cute.composed_get_inner(%arg5) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
      %37 = cute.composed_get_offset(%arg5) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0"> loc(#loc296)
      %e0_65 = cute.get_leaves(%37) : !cute.int_tuple<"0"> loc(#loc296)
      %38 = cute.composed_get_outer(%arg5) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))"> loc(#loc296)
      %39 = cute.get_shape(%38) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))"> loc(#loc295)
      %e0_66, %e1_67, %e2_68, %e3_69 = cute.get_leaves(%39) : !cute.shape<"((8,16),(64,2))"> loc(#loc295)
      %40 = cute.get_stride(%38) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
      %e0_70, %e1_71, %e2_72, %e3_73 = cute.get_leaves(%40) : !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
      %41 = cute.composed_get_inner(%arg6) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
      %42 = cute.composed_get_offset(%arg6) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0"> loc(#loc296)
      %e0_74 = cute.get_leaves(%42) : !cute.int_tuple<"0"> loc(#loc296)
      %43 = cute.composed_get_outer(%arg6) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))"> loc(#loc296)
      %44 = cute.get_shape(%43) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))"> loc(#loc295)
      %e0_75, %e1_76, %e2_77, %e3_78 = cute.get_leaves(%44) : !cute.shape<"((8,8),(64,2))"> loc(#loc295)
      %45 = cute.get_stride(%43) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))"> loc(#loc295)
      %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%45) : !cute.stride<"((64,512),(1,4096))"> loc(#loc295)
      %46 = cute.composed_get_inner(%arg7) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
      %47 = cute.composed_get_offset(%arg7) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0"> loc(#loc296)
      %e0_83 = cute.get_leaves(%47) : !cute.int_tuple<"0"> loc(#loc296)
      %48 = cute.composed_get_outer(%arg7) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))"> loc(#loc296)
      %49 = cute.get_shape(%48) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))"> loc(#loc295)
      %e0_84, %e1_85, %e2_86, %e3_87 = cute.get_leaves(%49) : !cute.shape<"((8,16),(64,2))"> loc(#loc295)
      %50 = cute.get_stride(%48) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
      %e0_88, %e1_89, %e2_90, %e3_91 = cute.get_leaves(%50) : !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
      %51 = cute.static : !cute.tile<"[16:1;64:1]"> loc(#loc297)
      %e0_92, %e1_93 = cute.get_leaves(%51) : !cute.tile<"[16:1;64:1]"> loc(#loc298)
      %52 = cute.get_shape(%e0_92) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
      %e0_94 = cute.get_leaves(%52) : !cute.shape<"16"> loc(#loc295)
      %53 = cute.get_stride(%e0_92) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_95 = cute.get_leaves(%53) : !cute.stride<"1"> loc(#loc295)
      %54 = cute.get_shape(%e1_93) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
      %e0_96 = cute.get_leaves(%54) : !cute.shape<"64"> loc(#loc295)
      %55 = cute.get_stride(%e1_93) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_97 = cute.get_leaves(%55) : !cute.stride<"1"> loc(#loc295)
      %56 = cute.static : !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc299)
      %57 = cute.get_shape(%56) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)"> loc(#loc295)
      %e0_98, %e1_99, %e2_100 = cute.get_leaves(%57) : !cute.shape<"((8,16),8)"> loc(#loc295)
      %58 = cute.get_stride(%56) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)"> loc(#loc295)
      %e0_101, %e1_102, %e2_103 = cute.get_leaves(%58) : !cute.stride<"((128,1),16)"> loc(#loc295)
      %59 = cute.static : !cute.layout<"1:0"> loc(#loc300)
      %60 = cute.get_shape(%59) : (!cute.layout<"1:0">) -> !cute.shape<"1"> loc(#loc295)
      %e0_104 = cute.get_leaves(%60) : !cute.shape<"1"> loc(#loc295)
      %61 = cute.get_stride(%59) : (!cute.layout<"1:0">) -> !cute.stride<"0"> loc(#loc295)
      %e0_105 = cute.get_leaves(%61) : !cute.stride<"0"> loc(#loc295)
      %62 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc301)
      %63 = cute.get_shape(%62) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
      %e0_106, %e1_107 = cute.get_leaves(%63) : !cute.shape<"(1,8)"> loc(#loc295)
      %64 = cute.get_stride(%62) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
      %e0_108, %e1_109 = cute.get_leaves(%64) : !cute.stride<"(0,1)"> loc(#loc295)
      %65 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc302)
      %66 = cute.get_shape(%65) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
      %e0_110, %e1_111 = cute.get_leaves(%66) : !cute.shape<"(1,8)"> loc(#loc295)
      %67 = cute.get_stride(%65) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
      %e0_112, %e1_113 = cute.get_leaves(%67) : !cute.stride<"(0,1)"> loc(#loc295)
      %68 = cute.static : !cute.tile<"[16:1;64:1]"> loc(#loc297)
      %e0_114, %e1_115 = cute.get_leaves(%68) : !cute.tile<"[16:1;64:1]"> loc(#loc298)
      %69 = cute.get_shape(%e0_114) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
      %e0_116 = cute.get_leaves(%69) : !cute.shape<"16"> loc(#loc295)
      %70 = cute.get_stride(%e0_114) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_117 = cute.get_leaves(%70) : !cute.stride<"1"> loc(#loc295)
      %71 = cute.get_shape(%e1_115) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
      %e0_118 = cute.get_leaves(%71) : !cute.shape<"64"> loc(#loc295)
      %72 = cute.get_stride(%e1_115) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_119 = cute.get_leaves(%72) : !cute.stride<"1"> loc(#loc295)
      %73 = cute.static : !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc299)
      %74 = cute.get_shape(%73) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)"> loc(#loc295)
      %e0_120, %e1_121, %e2_122 = cute.get_leaves(%74) : !cute.shape<"((8,16),8)"> loc(#loc295)
      %75 = cute.get_stride(%73) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)"> loc(#loc295)
      %e0_123, %e1_124, %e2_125 = cute.get_leaves(%75) : !cute.stride<"((128,1),16)"> loc(#loc295)
      %76 = cute.static : !cute.layout<"1:0"> loc(#loc300)
      %77 = cute.get_shape(%76) : (!cute.layout<"1:0">) -> !cute.shape<"1"> loc(#loc295)
      %e0_126 = cute.get_leaves(%77) : !cute.shape<"1"> loc(#loc295)
      %78 = cute.get_stride(%76) : (!cute.layout<"1:0">) -> !cute.stride<"0"> loc(#loc295)
      %e0_127 = cute.get_leaves(%78) : !cute.stride<"0"> loc(#loc295)
      %79 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc301)
      %80 = cute.get_shape(%79) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
      %e0_128, %e1_129 = cute.get_leaves(%80) : !cute.shape<"(1,8)"> loc(#loc295)
      %81 = cute.get_stride(%79) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
      %e0_130, %e1_131 = cute.get_leaves(%81) : !cute.stride<"(0,1)"> loc(#loc295)
      %82 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc302)
      %83 = cute.get_shape(%82) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
      %e0_132, %e1_133 = cute.get_leaves(%83) : !cute.shape<"(1,8)"> loc(#loc295)
      %84 = cute.get_stride(%82) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
      %e0_134, %e1_135 = cute.get_leaves(%84) : !cute.stride<"(0,1)"> loc(#loc295)
      %85 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)"> loc(#loc303)
      %86 = cute.get_shape(%85) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)"> loc(#loc295)
      %e0_136, %e1_137, %e2_138, %e3_139 = cute.get_leaves(%86) : !cute.shape<"(32,4,1,1)"> loc(#loc295)
      %87 = cute.get_stride(%85) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)"> loc(#loc295)
      %e0_140, %e1_141, %e2_142, %e3_143 = cute.get_leaves(%87) : !cute.stride<"(1,32,0,0)"> loc(#loc295)
      %88 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_144, %e1_145, %e2_146 = cute.get_leaves(%88) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %89 = cute.get_shape(%e0_144) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
      %e0_147 = cute.get_leaves(%89) : !cute.shape<"64"> loc(#loc295)
      %90 = cute.get_stride(%e0_144) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_148 = cute.get_leaves(%90) : !cute.stride<"1"> loc(#loc295)
      %91 = cute.get_shape(%e1_145) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
      %e0_149 = cute.get_leaves(%91) : !cute.shape<"16"> loc(#loc295)
      %92 = cute.get_stride(%e1_145) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_150 = cute.get_leaves(%92) : !cute.stride<"1"> loc(#loc295)
      %93 = cute.get_shape(%e2_146) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
      %e0_151 = cute.get_leaves(%93) : !cute.shape<"16"> loc(#loc295)
      %94 = cute.get_stride(%e2_146) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_152 = cute.get_leaves(%94) : !cute.stride<"1"> loc(#loc295)
      %95 = cute.static : !cute.layout<"32:1"> loc(#loc304)
      %96 = cute.get_shape(%95) : (!cute.layout<"32:1">) -> !cute.shape<"32"> loc(#loc295)
      %e0_153 = cute.get_leaves(%96) : !cute.shape<"32"> loc(#loc295)
      %97 = cute.get_stride(%95) : (!cute.layout<"32:1">) -> !cute.stride<"1"> loc(#loc295)
      %e0_154 = cute.get_leaves(%97) : !cute.stride<"1"> loc(#loc295)
      %98 = cute.static : !cute.shape<"(16,8,16)"> loc(#loc305)
      %e0_155, %e1_156, %e2_157 = cute.get_leaves(%98) : !cute.shape<"(16,8,16)"> loc(#loc305)
      %99 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))"> loc(#loc306)
      %100 = cute.get_shape(%99) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))"> loc(#loc295)
      %e0_158, %e1_159, %e2_160, %e3_161, %e4 = cute.get_leaves(%100) : !cute.shape<"((4,8),(2,2,2))"> loc(#loc295)
      %101 = cute.get_stride(%99) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))"> loc(#loc295)
      %e0_162, %e1_163, %e2_164, %e3_165, %e4_166 = cute.get_leaves(%101) : !cute.stride<"((32,1),(16,8,128))"> loc(#loc295)
      %102 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))"> loc(#loc307)
      %103 = cute.get_shape(%102) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))"> loc(#loc295)
      %e0_167, %e1_168, %e2_169, %e3_170 = cute.get_leaves(%103) : !cute.shape<"((4,8),(2,2))"> loc(#loc295)
      %104 = cute.get_stride(%102) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))"> loc(#loc295)
      %e0_171, %e1_172, %e2_173, %e3_174 = cute.get_leaves(%104) : !cute.stride<"((16,1),(8,64))"> loc(#loc295)
      %105 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))"> loc(#loc308)
      %106 = cute.get_shape(%105) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))"> loc(#loc295)
      %e0_175, %e1_176, %e2_177, %e3_178 = cute.get_leaves(%106) : !cute.shape<"((4,8),(2,2))"> loc(#loc295)
      %107 = cute.get_stride(%105) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))"> loc(#loc295)
      %e0_179, %e1_180, %e2_181, %e3_182 = cute.get_leaves(%107) : !cute.stride<"((32,1),(16,8))"> loc(#loc295)
      %108 = nvvm.read.ptx.sreg.tid.x : i32 loc(#loc309)
      %109 = nvvm.read.ptx.sreg.tid.y : i32 loc(#loc309)
      %110 = nvvm.read.ptx.sreg.tid.z : i32 loc(#loc309)
      %111 = nvvm.read.ptx.sreg.ctaid.x : i32 loc(#loc310)
      %112 = nvvm.read.ptx.sreg.ctaid.y : i32 loc(#loc310)
      %113 = nvvm.read.ptx.sreg.ctaid.z : i32 loc(#loc310)
      %lay_183 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc311)
      %114 = cute.get_shape(%lay_183) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %e0_184, %e1_185, %e2_186, %e3_187 = cute.get_leaves(%114) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %itup_188 = cute.to_int_tuple(%e0_184) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %115 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_189 = cute.to_int_tuple(%e1_185) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %116 = cute.get_scalars(%itup_189) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_190 = cute.to_int_tuple(%e2_186) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %117 = cute.get_scalars(%itup_190) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_191 = cute.to_int_tuple(%e3_187) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %118 = cute.get_scalars(%itup_191) : !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %int_tuple = cute.make_int_tuple(%itup_189) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc312)
      %tile = cute.make_tile() : () -> !cute.tile<"64:1"> loc(#loc312)
      %shp = cute.ceil_div(%int_tuple, %tile) : !cute.int_tuple<"?">, !cute.tile<"64:1"> loc(#loc312)
      %e0_192 = cute.get_leaves(%shp) : !cute.int_tuple<"?"> loc(#loc312)
      %119 = cute.get_scalars(%e0_192) : !cute.int_tuple<"?"> loc(#loc312)
      %false = arith.constant false loc(#loc290)
      %120 = scf.if %false -> (i32) {
        %c1_i32_6349 = arith.constant 1 : i32 loc(#loc290)
        %2346 = arith.addi %111, %c1_i32_6349 : i32 loc(#loc313)
        %c128_i32_6350 = arith.constant 128 : i32 loc(#loc290)
        %2347 = arith.muli %2346, %c128_i32_6350 : i32 loc(#loc313)
        %int_tuple_6351 = cute.make_int_tuple(%2347) : (i32) -> !cute.int_tuple<"?"> loc(#loc314)
        %tile_6352 = cute.make_tile() : () -> !cute.tile<"64:1"> loc(#loc314)
        %shp_6353 = cute.ceil_div(%int_tuple_6351, %tile_6352) : !cute.int_tuple<"?">, !cute.tile<"64:1"> loc(#loc314)
        %e0_6354 = cute.get_leaves(%shp_6353) : !cute.int_tuple<"?"> loc(#loc314)
        %2348 = cute.get_scalars(%e0_6354) : !cute.int_tuple<"?"> loc(#loc314)
        %2349 = arith.minsi %2348, %119 : i32 loc(#loc290)
        scf.yield %2349 : i32 loc(#loc290)
      } else {
        scf.yield %119 : i32 loc(#loc290)
      } loc(#loc290)
      %c1_i32 = arith.constant 1 : i32 loc(#loc290)
      %121 = arith.subi %120, %c1_i32 : i32 loc(#loc313)
      %coord = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc315)
      %slice = cute.slice(%arg0, %coord) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)"> loc(#loc315)
      %iter_193 = cute.get_iter(%slice) : !memref_gmem_bf16_1 loc(#loc316)
      %iter_194 = cute.get_iter(%slice) : !memref_gmem_bf16_1 loc(#loc317)
      %tile_195 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]"> loc(#loc318)
      %coord_196 = cute.make_coord(%111) : (i32) -> !cute.coord<"(?,0)"> loc(#loc318)
      %tiled_view = cute.local_tile(%slice, %tile_195, %coord_196) : (!memref_gmem_bf16_1, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !memref_gmem_bf16_2 loc(#loc318)
      %iter_197 = cute.get_iter(%tiled_view) : !memref_gmem_bf16_2 loc(#loc319)
      %coord_198 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc320)
      %slice_199 = cute.slice(%arg1, %coord_198) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)"> loc(#loc320)
      %iter_200 = cute.get_iter(%slice_199) : !memref_gmem_bf16_1 loc(#loc316)
      %iter_201 = cute.get_iter(%slice_199) : !memref_gmem_bf16_1 loc(#loc317)
      %tile_202 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]"> loc(#loc321)
      %coord_203 = cute.make_coord() : () -> !cute.coord<"(_,0)"> loc(#loc321)
      %tiled_view_204 = cute.local_tile(%slice_199, %tile_202, %coord_203) : (!memref_gmem_bf16_1, !cute.tile<"[64:1;128:1]">, !cute.coord<"(_,0)">) -> !memref_gmem_bf16_3 loc(#loc321)
      %iter_205 = cute.get_iter(%tiled_view_204) : !memref_gmem_bf16_3 loc(#loc319)
      %coord_206 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc322)
      %slice_207 = cute.slice(%arg2, %coord_206) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)"> loc(#loc322)
      %iter_208 = cute.get_iter(%slice_207) : !memref_gmem_bf16_1 loc(#loc316)
      %iter_209 = cute.get_iter(%slice_207) : !memref_gmem_bf16_1 loc(#loc317)
      %tile_210 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]"> loc(#loc323)
      %coord_211 = cute.make_coord() : () -> !cute.coord<"(_,0)"> loc(#loc323)
      %tiled_view_212 = cute.local_tile(%slice_207, %tile_210, %coord_211) : (!memref_gmem_bf16_1, !cute.tile<"[64:1;128:1]">, !cute.coord<"(_,0)">) -> !memref_gmem_bf16_3 loc(#loc323)
      %iter_213 = cute.get_iter(%tiled_view_212) : !memref_gmem_bf16_3 loc(#loc319)
      %smem_ptr = cute_nvgpu.arch.get_dyn_smem() : !cute.ptr<i8, smem, align<1024>> loc(#loc324)
      %int_tuple_214 = cute.make_int_tuple() : () -> !cute.int_tuple<"65536"> loc(#loc325)
      %ptr = cute.add_offset(%smem_ptr, %int_tuple_214) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"65536">) -> !cute.ptr<i8, smem, align<1024>> loc(#loc325)
      %smem_size = cute_nvgpu.arch.get_dyn_smem_size() : i32 loc(#loc326)
      %c65536_i32 = arith.constant 65536 : i32 loc(#loc290)
      %122 = arith.cmpi sge, %smem_size, %c65536_i32 : i32 loc(#loc327)
      cf.assert %122, "Allocation failed: shared memory allocation exceeds available memory set in kernel launch. Allocated bytes: 65536 bytes. Please reduce the allocation or set a larger smem size in kernel launch." loc(#loc326)
      %int_tuple_215 = cute.make_int_tuple() : () -> !cute.int_tuple<"0"> loc(#loc328)
      %ptr_216 = cute.add_offset(%smem_ptr, %int_tuple_215) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"0">) -> !cute.ptr<i8, smem, align<1024>> loc(#loc328)
      %int_tuple_217 = cute.make_int_tuple() : () -> !cute.int_tuple<"32768"> loc(#loc328)
      %ptr_218 = cute.add_offset(%smem_ptr, %int_tuple_217) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"32768">) -> !cute.ptr<i8, smem, align<1024>> loc(#loc328)
      %int_tuple_219 = cute.make_int_tuple() : () -> !cute.int_tuple<"49152"> loc(#loc328)
      %ptr_220 = cute.add_offset(%smem_ptr, %int_tuple_219) : (!cute.ptr<i8, smem, align<1024>>, !cute.int_tuple<"49152">) -> !cute.ptr<i8, smem, align<1024>> loc(#loc328)
      %iter_221 = cute.recast_iter(%ptr_216) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>> loc(#loc329)
      %view = cute.make_view(%iter_221, %arg5) : !memref_smem_bf16_ loc(#loc330)
      %iter_222 = cute.get_iter(%view) : !memref_smem_bf16_ loc(#loc331)
      %iter_223 = cute.recast_iter(%ptr_218) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>> loc(#loc329)
      %view_224 = cute.make_view(%iter_223, %arg6) : !memref_smem_bf16_1 loc(#loc330)
      %iter_225 = cute.get_iter(%view_224) : !memref_smem_bf16_1 loc(#loc331)
      %iter_226 = cute.recast_iter(%ptr_220) : !cute.ptr<i8, smem, align<1024>> to !cute.ptr<bf16, smem, align<1024>> loc(#loc329)
      %view_227 = cute.make_view(%iter_226, %arg6) : !memref_smem_bf16_1 loc(#loc330)
      %iter_228 = cute.get_iter(%view_227) : !memref_smem_bf16_1 loc(#loc331)
      %shape = cute.make_shape() : () -> !cute.shape<"(128,64)"> loc(#loc332)
      %stride = cute.make_stride() : () -> !cute.stride<"(64,1)"> loc(#loc332)
      %lay_229 = cute.make_layout(%shape, %stride) : !cute.layout<"(128,64):(64,1)"> loc(#loc332)
      %123 = cute.composition(%view_227, %lay_229) : (!memref_smem_bf16_1, !cute.layout<"(128,64):(64,1)">) -> !memref_smem_bf16_2 loc(#loc333)
      %iter_230 = cute.get_iter(%123) : !memref_smem_bf16_2 loc(#loc334)
      %coord_231 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc335)
      %src_partitioned = cute.tiled.copy.partition_S(%arg8, %tiled_view, %coord_231) : (!copy_ldgsts, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4 loc(#loc335)
      %iter_232 = cute.get_iter(%src_partitioned) : !memref_gmem_bf16_4 loc(#loc336)
      %coord_233 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc337)
      %dst_partitioned = cute.tiled.copy.partition_D(%arg8, %view, %coord_233) : (!copy_ldgsts, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3 loc(#loc337)
      %iter_234 = cute.get_iter(%dst_partitioned) : !memref_smem_bf16_3 loc(#loc338)
      %coord_235 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc339)
      %src_partitioned_236 = cute.tiled.copy.partition_S(%arg8, %tiled_view_204, %coord_235) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5 loc(#loc339)
      %iter_237 = cute.get_iter(%src_partitioned_236) : !memref_gmem_bf16_5 loc(#loc336)
      %coord_238 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc340)
      %dst_partitioned_239 = cute.tiled.copy.partition_D(%arg8, %view_224, %coord_238) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4 loc(#loc340)
      %iter_240 = cute.get_iter(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc338)
      %coord_241 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc341)
      %src_partitioned_242 = cute.tiled.copy.partition_S(%arg8, %tiled_view_212, %coord_241) : (!copy_ldgsts, !memref_gmem_bf16_3, !cute.coord<"?">) -> !memref_gmem_bf16_5 loc(#loc341)
      %iter_243 = cute.get_iter(%src_partitioned_242) : !memref_gmem_bf16_5 loc(#loc336)
      %coord_244 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc342)
      %dst_partitioned_245 = cute.tiled.copy.partition_D(%arg8, %view_227, %coord_244) : (!copy_ldgsts, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_4 loc(#loc342)
      %iter_246 = cute.get_iter(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc338)
      %coord_247 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc343)
      %ptn_A = cute.tiled.mma.partition A (%arg10, %view, %coord_247) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_5 loc(#loc343)
      %iter_248 = cute.get_iter(%ptn_A) : !memref_smem_bf16_5 loc(#loc344)
      %frg_A = cute.mma.make_fragment A (%arg10, %ptn_A) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_5) -> !memref_rmem_bf16_ loc(#loc343)
      %iter_249 = cute.get_iter(%frg_A) : !memref_rmem_bf16_ loc(#loc345)
      %coord_250 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc346)
      %ptn_B = cute.tiled.mma.partition B (%arg10, %view_224, %coord_250) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_6 loc(#loc346)
      %iter_251 = cute.get_iter(%ptn_B) : !memref_smem_bf16_6 loc(#loc344)
      %frg_B = cute.mma.make_fragment B (%arg10, %ptn_B) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_6) -> !memref_rmem_bf16_1 loc(#loc346)
      %iter_252 = cute.get_iter(%frg_B) : !memref_rmem_bf16_1 loc(#loc345)
      %coord_253 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc347)
      %ptn_B_254 = cute.tiled.mma.partition B (%arg10, %123, %coord_253) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_7 loc(#loc347)
      %iter_255 = cute.get_iter(%ptn_B_254) : !memref_smem_bf16_7 loc(#loc344)
      %frg_B_256 = cute.mma.make_fragment B (%arg10, %ptn_B_254) : (!mma_bf16_bf16_f32_16x8x16_, !memref_smem_bf16_7) -> !memref_rmem_bf16_2 loc(#loc347)
      %iter_257 = cute.get_iter(%frg_B_256) : !memref_rmem_bf16_2 loc(#loc345)
      %shape_258 = cute.make_shape() : () -> !cute.shape<"(128,128)"> loc(#loc348)
      %124 = cute.tiled.mma.partition_shape C (%arg10, %shape_258) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,128)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc348)
      %e0_259, %e1_260, %e2_261, %e3_262 = cute.get_leaves(%124) : !cute.shape<"((2,2),2,16)"> loc(#loc348)
      %shape_263 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)"> loc(#loc349)
      %lay_264 = cute.make_layout(%shape_263) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> loc(#loc349)
      %rmem = cute.memref.alloca(%lay_264) : !memref_rmem_f32_ loc(#loc349)
      %iter_265 = cute.get_iter(%rmem) : !memref_rmem_f32_ loc(#loc350)
      %iter_266 = cute.get_iter(%rmem) : !memref_rmem_f32_ loc(#loc351)
      %sz = cute.size(%rmem) : (!memref_rmem_f32_) -> !cute.int_tuple<"128"> loc(#loc352)
      %e0_267 = cute.get_leaves(%sz) : !cute.int_tuple<"128"> loc(#loc352)
      %lay_268 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc311)
      %125 = cute.get_shape(%lay_268) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %e0_269, %e1_270, %e2_271, %e3_272 = cute.get_leaves(%125) : !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %int_tuple_273 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)"> loc(#loc352)
      %res = cute.tuple.product(%int_tuple_273) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128"> loc(#loc352)
      %e0_274 = cute.get_leaves(%res) : !cute.int_tuple<"128"> loc(#loc352)
      %cst = arith.constant 0.000000e+00 : f32 loc(#loc352)
      %126 = vector.splat %cst : vector<128xf32> loc(#loc352)
      %int_tuple_275 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)"> loc(#loc352)
      %sz_276 = cute.size(%int_tuple_275) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128"> loc(#loc352)
      %e0_277 = cute.get_leaves(%sz_276) : !cute.int_tuple<"128"> loc(#loc352)
      %int_tuple_278 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)"> loc(#loc352)
      %sz_279 = cute.size(%int_tuple_278) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128"> loc(#loc352)
      %e0_280 = cute.get_leaves(%sz_279) : !cute.int_tuple<"128"> loc(#loc352)
      cute.memref.store_vec %126, %rmem : !memref_rmem_f32_ loc(#loc352)
      %shape_281 = cute.make_shape() : () -> !cute.shape<"(8,8)"> loc(#loc353)
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n> loc(#loc353)
      %shape_282 = cute.make_shape() : () -> !cute.shape<"(8,8)"> loc(#loc354)
      %atom_283 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, n> loc(#loc354)
      %shape_284 = cute.make_shape() : () -> !cute.shape<"(8,8)"> loc(#loc355)
      %atom_285 = cute.make_atom() : () -> !cute_nvgpu.atom.ldsm<val_type = bf16, mode = <"(8,8)">, sz_pattern = u16, num_matrices = 4, t> loc(#loc355)
      %127 = cute.static : !cute.layout<"((4,8,4),((2,2,2),(1,1))):((128,1,16),((64,8,512),(0,0)))"> loc(#loc356)
      %128 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_286, %e1_287, %e2_288 = cute.get_leaves(%128) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_289 = cute.size(%e0_286) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64"> loc(#loc357)
      %e0_290 = cute.get_leaves(%sz_289) : !cute.int_tuple<"64"> loc(#loc357)
      %129 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_291, %e1_292, %e2_293 = cute.get_leaves(%129) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_294 = cute.size(%e2_293) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_295 = cute.get_leaves(%sz_294) : !cute.int_tuple<"16"> loc(#loc357)
      %tile_296 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]"> loc(#loc358)
      %130 = cute.make_tiled_copy(%atom) : !copy_ldsm_4_ loc(#loc358)
      %131 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))"> loc(#loc359)
      %132 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_297, %e1_298, %e2_299 = cute.get_leaves(%132) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_300 = cute.size(%e1_298) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_301 = cute.get_leaves(%sz_300) : !cute.int_tuple<"16"> loc(#loc357)
      %133 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_302, %e1_303, %e2_304 = cute.get_leaves(%133) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_305 = cute.size(%e2_304) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_306 = cute.get_leaves(%sz_305) : !cute.int_tuple<"16"> loc(#loc357)
      %tile_307 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]"> loc(#loc360)
      %134 = cute.make_tiled_copy(%atom_283) : !copy_ldsm_4_1 loc(#loc360)
      %135 = cute.static : !cute.layout<"((4,8,4),((2,2),(2,1))):((32,1,0),((16,128),(8,0)))"> loc(#loc359)
      %136 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_308, %e1_309, %e2_310 = cute.get_leaves(%136) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_311 = cute.size(%e1_309) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_312 = cute.get_leaves(%sz_311) : !cute.int_tuple<"16"> loc(#loc357)
      %137 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_313, %e1_314, %e2_315 = cute.get_leaves(%137) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_316 = cute.size(%e2_315) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_317 = cute.get_leaves(%sz_316) : !cute.int_tuple<"16"> loc(#loc357)
      %tile_318 = cute.make_tile() : () -> !cute.tile<"[16:1;16:1]"> loc(#loc361)
      %138 = cute.make_tiled_copy(%atom_285) : !copy_ldsm_4_2 loc(#loc361)
      %coord_319 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc362)
      %src_partitioned_320 = cute.tiled.copy.partition_S(%130, %view, %coord_319) : (!copy_ldsm_4_, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_8 loc(#loc362)
      %iter_321 = cute.get_iter(%src_partitioned_320) : !memref_smem_bf16_8 loc(#loc336)
      %retiled = cute.tiled.copy.retile(%130, %frg_A) : (!copy_ldsm_4_, !memref_rmem_bf16_) -> !memref_rmem_bf16_3 loc(#loc363)
      %iter_322 = cute.get_iter(%retiled) : !memref_rmem_bf16_3 loc(#loc364)
      %coord_323 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc365)
      %src_partitioned_324 = cute.tiled.copy.partition_S(%134, %view_224, %coord_323) : (!copy_ldsm_4_1, !memref_smem_bf16_1, !cute.coord<"?">) -> !memref_smem_bf16_9 loc(#loc365)
      %iter_325 = cute.get_iter(%src_partitioned_324) : !memref_smem_bf16_9 loc(#loc336)
      %retiled_326 = cute.tiled.copy.retile(%134, %frg_B) : (!copy_ldsm_4_1, !memref_rmem_bf16_1) -> !memref_rmem_bf16_4 loc(#loc366)
      %iter_327 = cute.get_iter(%retiled_326) : !memref_rmem_bf16_4 loc(#loc364)
      %coord_328 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc367)
      %src_partitioned_329 = cute.tiled.copy.partition_S(%138, %123, %coord_328) : (!copy_ldsm_4_2, !memref_smem_bf16_2, !cute.coord<"?">) -> !memref_smem_bf16_10 loc(#loc367)
      %iter_330 = cute.get_iter(%src_partitioned_329) : !memref_smem_bf16_10 loc(#loc336)
      %retiled_331 = cute.tiled.copy.retile(%138, %frg_B_256) : (!copy_ldsm_4_2, !memref_rmem_bf16_2) -> !memref_rmem_bf16_5 loc(#loc368)
      %iter_332 = cute.get_iter(%retiled_331) : !memref_rmem_bf16_5 loc(#loc364)
      %lay_333 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc369)
      %139 = cute.get_shape(%lay_333) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc369)
      %e0_334, %e1_335, %e2_336, %e3_337 = cute.get_leaves(%139) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc369)
      %itup_338 = cute.to_int_tuple(%e0_334) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc369)
      %140 = cute.get_scalars(%itup_338) : !cute.int_tuple<"?"> loc(#loc369)
      %itup_339 = cute.to_int_tuple(%e1_335) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc369)
      %141 = cute.get_scalars(%itup_339) : !cute.int_tuple<"?"> loc(#loc369)
      %itup_340 = cute.to_int_tuple(%e2_336) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc369)
      %142 = cute.get_scalars(%itup_340) : !cute.int_tuple<"?"> loc(#loc369)
      %itup_341 = cute.to_int_tuple(%e3_337) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc369)
      %143 = cute.get_scalars(%itup_341) : !cute.int_tuple<"?{div=8}"> loc(#loc369)
      %shape_342 = cute.make_shape(%itup_338, %itup_339, %itup_340, %itup_341) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc369)
      %144 = cute.make_identity_tensor(%shape_342) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc369)
      %iter_343 = cute.get_iter(%144) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc370)
      %e0_344, %e1_345, %e2_346, %e3_347 = cute.get_leaves(%iter_343) : !cute.int_tuple<"(0,0,0,0)"> loc(#loc298)
      %lay_348 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc371)
      %145 = cute.get_shape(%lay_348) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc371)
      %e0_349, %e1_350, %e2_351, %e3_352 = cute.get_leaves(%145) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc371)
      %itup_353 = cute.to_int_tuple(%e0_349) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc371)
      %146 = cute.get_scalars(%itup_353) : !cute.int_tuple<"?"> loc(#loc371)
      %itup_354 = cute.to_int_tuple(%e1_350) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc371)
      %147 = cute.get_scalars(%itup_354) : !cute.int_tuple<"?"> loc(#loc371)
      %itup_355 = cute.to_int_tuple(%e2_351) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc371)
      %148 = cute.get_scalars(%itup_355) : !cute.int_tuple<"?"> loc(#loc371)
      %itup_356 = cute.to_int_tuple(%e3_352) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc371)
      %149 = cute.get_scalars(%itup_356) : !cute.int_tuple<"?{div=8}"> loc(#loc371)
      %shape_357 = cute.make_shape(%itup_353, %itup_354, %itup_355, %itup_356) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc371)
      %150 = cute.make_identity_tensor(%shape_357) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc371)
      %iter_358 = cute.get_iter(%150) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc370)
      %e0_359, %e1_360, %e2_361, %e3_362 = cute.get_leaves(%iter_358) : !cute.int_tuple<"(0,0,0,0)"> loc(#loc298)
      %coord_363 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc372)
      %slice_364 = cute.slice(%144, %coord_363) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)"> loc(#loc372)
      %iter_365 = cute.get_iter(%slice_364) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc316)
      %e0_366, %e1_367, %e2_368, %e3_369 = cute.get_leaves(%iter_365) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %151 = cute.get_scalars(%e0_366) : !cute.int_tuple<"?"> loc(#loc290)
      %152 = cute.get_scalars(%e2_368) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_370 = cute.get_iter(%slice_364) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc317)
      %e0_371, %e1_372, %e2_373, %e3_374 = cute.get_leaves(%iter_370) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %153 = cute.get_scalars(%e0_371) : !cute.int_tuple<"?"> loc(#loc290)
      %154 = cute.get_scalars(%e2_373) : !cute.int_tuple<"?"> loc(#loc290)
      %tile_375 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]"> loc(#loc373)
      %coord_376 = cute.make_coord(%111) : (i32) -> !cute.coord<"(?,0)"> loc(#loc373)
      %tiled_view_377 = cute.local_tile(%slice_364, %tile_375, %coord_376) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)"> loc(#loc373)
      %iter_378 = cute.get_iter(%tiled_view_377) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)"> loc(#loc319)
      %e0_379, %e1_380, %e2_381, %e3_382 = cute.get_leaves(%iter_378) : !cute.int_tuple<"(?,?{div=128},?,0)"> loc(#loc298)
      %155 = cute.get_scalars(%e0_379) : !cute.int_tuple<"?"> loc(#loc290)
      %156 = cute.get_scalars(%e1_380) : !cute.int_tuple<"?{div=128}"> loc(#loc290)
      %157 = cute.get_scalars(%e2_381) : !cute.int_tuple<"?"> loc(#loc290)
      %coord_383 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc374)
      %slice_384 = cute.slice(%150, %coord_383) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)"> loc(#loc374)
      %iter_385 = cute.get_iter(%slice_384) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc316)
      %e0_386, %e1_387, %e2_388, %e3_389 = cute.get_leaves(%iter_385) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %158 = cute.get_scalars(%e0_386) : !cute.int_tuple<"?"> loc(#loc290)
      %159 = cute.get_scalars(%e2_388) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_390 = cute.get_iter(%slice_384) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc317)
      %e0_391, %e1_392, %e2_393, %e3_394 = cute.get_leaves(%iter_390) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %160 = cute.get_scalars(%e0_391) : !cute.int_tuple<"?"> loc(#loc290)
      %161 = cute.get_scalars(%e2_393) : !cute.int_tuple<"?"> loc(#loc290)
      %tile_395 = cute.make_tile() : () -> !cute.tile<"[64:1;128:1]"> loc(#loc375)
      %coord_396 = cute.make_coord(%121) : (i32) -> !cute.coord<"(?,0)"> loc(#loc375)
      %tiled_view_397 = cute.local_tile(%slice_384, %tile_395, %coord_396) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[64:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)"> loc(#loc375)
      %iter_398 = cute.get_iter(%tiled_view_397) : !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)"> loc(#loc319)
      %e0_399, %e1_400, %e2_401, %e3_402 = cute.get_leaves(%iter_398) : !cute.int_tuple<"(?,?{div=64},?,0)"> loc(#loc298)
      %162 = cute.get_scalars(%e0_399) : !cute.int_tuple<"?"> loc(#loc290)
      %163 = cute.get_scalars(%e1_400) : !cute.int_tuple<"?{div=64}"> loc(#loc290)
      %164 = cute.get_scalars(%e2_401) : !cute.int_tuple<"?"> loc(#loc290)
      %coord_403 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc376)
      %src_partitioned_404 = cute.tiled.copy.partition_S(%arg8, %tiled_view_377, %coord_403) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)"> loc(#loc376)
      %iter_405 = cute.get_iter(%src_partitioned_404) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)"> loc(#loc336)
      %e0_406, %e1_407, %e2_408, %e3_409 = cute.get_leaves(%iter_405) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %165 = cute.get_scalars(%e0_406) : !cute.int_tuple<"?"> loc(#loc290)
      %166 = cute.get_scalars(%e1_407) : !cute.int_tuple<"?"> loc(#loc290)
      %167 = cute.get_scalars(%e2_408) : !cute.int_tuple<"?"> loc(#loc290)
      %168 = cute.get_scalars(%e3_409) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %coord_410 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc377)
      %src_partitioned_411 = cute.tiled.copy.partition_S(%arg8, %tiled_view_397, %coord_410) : (!copy_ldgsts, !cute.coord_tensor<"(?,?{div=64},?,0)", "(64,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)"> loc(#loc377)
      %iter_412 = cute.get_iter(%src_partitioned_411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)"> loc(#loc336)
      %e0_413, %e1_414, %e2_415, %e3_416 = cute.get_leaves(%iter_412) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %169 = cute.get_scalars(%e0_413) : !cute.int_tuple<"?"> loc(#loc290)
      %170 = cute.get_scalars(%e1_414) : !cute.int_tuple<"?"> loc(#loc290)
      %171 = cute.get_scalars(%e2_415) : !cute.int_tuple<"?"> loc(#loc290)
      %172 = cute.get_scalars(%e3_416) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %lay_417 = cute.get_layout(%dst_partitioned) : !memref_smem_bf16_3 loc(#loc311)
      %173 = cute.get_shape(%lay_417) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_418, %e1_419, %e2_420, %e3_421 = cute.get_leaves(%173) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %sz_422 = cute.size(%dst_partitioned) <{mode = [1]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"8"> loc(#loc378)
      %e0_423 = cute.get_leaves(%sz_422) : !cute.int_tuple<"8"> loc(#loc378)
      %sz_424 = cute.size(%dst_partitioned) <{mode = [2]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"2"> loc(#loc379)
      %e0_425 = cute.get_leaves(%sz_424) : !cute.int_tuple<"2"> loc(#loc379)
      %sz_426 = cute.size(%dst_partitioned) <{mode = [2]}> : (!memref_smem_bf16_3) -> !cute.int_tuple<"2"> loc(#loc380)
      %e0_427 = cute.get_leaves(%sz_426) : !cute.int_tuple<"2"> loc(#loc380)
      %shape_428 = cute.make_shape() : () -> !cute.shape<"(1,8,2)"> loc(#loc381)
      %stride_429 = cute.make_stride() : () -> !cute.stride<"(2,0,1)"> loc(#loc381)
      %lay_430 = cute.make_layout(%shape_428, %stride_429) : !cute.layout<"(1,8,2):(2,0,1)"> loc(#loc381)
      %rmem_431 = cute.memref.alloca(%lay_430) : !memref_rmem_i8_ loc(#loc382)
      %iter_432 = cute.get_iter(%rmem_431) : !memref_rmem_i8_ loc(#loc350)
      %iter_433 = cute.get_iter(%rmem_431) : !memref_rmem_i8_ loc(#loc351)
      %lay_434 = cute.get_layout(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc311)
      %174 = cute.get_shape(%lay_434) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
      %e0_435, %e1_436, %e2_437, %e3_438 = cute.get_leaves(%174) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
      %sz_439 = cute.size(%dst_partitioned_239) <{mode = [1]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"4"> loc(#loc383)
      %e0_440 = cute.get_leaves(%sz_439) : !cute.int_tuple<"4"> loc(#loc383)
      %sz_441 = cute.size(%dst_partitioned_239) <{mode = [2]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"2"> loc(#loc384)
      %e0_442 = cute.get_leaves(%sz_441) : !cute.int_tuple<"2"> loc(#loc384)
      %sz_443 = cute.size(%dst_partitioned_239) <{mode = [2]}> : (!memref_smem_bf16_4) -> !cute.int_tuple<"2"> loc(#loc385)
      %e0_444 = cute.get_leaves(%sz_443) : !cute.int_tuple<"2"> loc(#loc385)
      %shape_445 = cute.make_shape() : () -> !cute.shape<"(1,4,2)"> loc(#loc386)
      %stride_446 = cute.make_stride() : () -> !cute.stride<"(2,0,1)"> loc(#loc386)
      %lay_447 = cute.make_layout(%shape_445, %stride_446) : !cute.layout<"(1,4,2):(2,0,1)"> loc(#loc386)
      %rmem_448 = cute.memref.alloca(%lay_447) : !memref_rmem_i8_1 loc(#loc387)
      %iter_449 = cute.get_iter(%rmem_448) : !memref_rmem_i8_1 loc(#loc350)
      %iter_450 = cute.get_iter(%rmem_448) : !memref_rmem_i8_1 loc(#loc351)
      %lay_451 = cute.get_layout(%rmem_431) : !memref_rmem_i8_ loc(#loc311)
      %175 = cute.get_shape(%lay_451) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)"> loc(#loc311)
      %e0_452, %e1_453, %e2_454 = cute.get_leaves(%175) : !cute.shape<"(1,8,2)"> loc(#loc311)
      %coord_455 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)"> loc(#loc388)
      %slice_456 = cute.slice(%src_partitioned_404, %coord_455) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)"> loc(#loc388)
      %iter_457 = cute.get_iter(%slice_456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_458, %e1_459, %e2_460, %e3_461 = cute.get_leaves(%iter_457) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %176 = cute.get_scalars(%e0_458) : !cute.int_tuple<"?"> loc(#loc290)
      %177 = cute.get_scalars(%e1_459) : !cute.int_tuple<"?"> loc(#loc290)
      %178 = cute.get_scalars(%e2_460) : !cute.int_tuple<"?"> loc(#loc290)
      %179 = cute.get_scalars(%e3_461) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_462 = cute.get_iter(%slice_456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_463, %e1_464, %e2_465, %e3_466 = cute.get_leaves(%iter_462) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %180 = cute.get_scalars(%e0_463) : !cute.int_tuple<"?"> loc(#loc290)
      %181 = cute.get_scalars(%e1_464) : !cute.int_tuple<"?"> loc(#loc290)
      %182 = cute.get_scalars(%e2_465) : !cute.int_tuple<"?"> loc(#loc290)
      %183 = cute.get_scalars(%e3_466) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_467 = cute.get_iter(%slice_456) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc388)
      %e0_468, %e1_469, %e2_470, %e3_471 = cute.get_leaves(%iter_467) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc388)
      %184 = cute.get_scalars(%e0_468) : !cute.int_tuple<"?"> loc(#loc388)
      %185 = cute.get_scalars(%e1_469) : !cute.int_tuple<"?"> loc(#loc388)
      %186 = cute.get_scalars(%e2_470) : !cute.int_tuple<"?"> loc(#loc388)
      %187 = cute.get_scalars(%e3_471) : !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %lay_472 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc388)
      %188 = cute.get_shape(%lay_472) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc388)
      %e0_473, %e1_474, %e2_475, %e3_476 = cute.get_leaves(%188) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc388)
      %itup_477 = cute.to_int_tuple(%e0_473) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %189 = cute.get_scalars(%itup_477) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_478 = cute.to_int_tuple(%e1_474) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %190 = cute.get_scalars(%itup_478) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_479 = cute.to_int_tuple(%e2_475) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %191 = cute.get_scalars(%itup_479) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_480 = cute.to_int_tuple(%e3_476) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %192 = cute.get_scalars(%itup_480) : !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %coord_481 = cute.make_coord(%e3_471) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc389)
      %coord_482 = cute.make_coord(%itup_480) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc389)
      %193 = cute.elem_less(%coord_481, %coord_482) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc389)
      %194 = arith.extui %193 : i1 to i8 loc(#loc290)
      %coord_483 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc389)
      cute.memref.store(%rmem_431, %coord_483, %194) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> () loc(#loc389)
      %coord_484 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)"> loc(#loc388)
      %slice_485 = cute.slice(%src_partitioned_404, %coord_484) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)"> loc(#loc388)
      %iter_486 = cute.get_iter(%slice_485) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_487, %e1_488, %e2_489, %e3_490 = cute.get_leaves(%iter_486) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %195 = cute.get_scalars(%e0_487) : !cute.int_tuple<"?"> loc(#loc290)
      %196 = cute.get_scalars(%e1_488) : !cute.int_tuple<"?"> loc(#loc290)
      %197 = cute.get_scalars(%e2_489) : !cute.int_tuple<"?"> loc(#loc290)
      %198 = cute.get_scalars(%e3_490) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_491 = cute.get_iter(%slice_485) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_492, %e1_493, %e2_494, %e3_495 = cute.get_leaves(%iter_491) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %199 = cute.get_scalars(%e0_492) : !cute.int_tuple<"?"> loc(#loc290)
      %200 = cute.get_scalars(%e1_493) : !cute.int_tuple<"?"> loc(#loc290)
      %201 = cute.get_scalars(%e2_494) : !cute.int_tuple<"?"> loc(#loc290)
      %202 = cute.get_scalars(%e3_495) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_496 = cute.get_iter(%slice_485) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc388)
      %e0_497, %e1_498, %e2_499, %e3_500 = cute.get_leaves(%iter_496) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc388)
      %203 = cute.get_scalars(%e0_497) : !cute.int_tuple<"?"> loc(#loc388)
      %204 = cute.get_scalars(%e1_498) : !cute.int_tuple<"?"> loc(#loc388)
      %205 = cute.get_scalars(%e2_499) : !cute.int_tuple<"?"> loc(#loc388)
      %206 = cute.get_scalars(%e3_500) : !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %lay_501 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc388)
      %207 = cute.get_shape(%lay_501) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc388)
      %e0_502, %e1_503, %e2_504, %e3_505 = cute.get_leaves(%207) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc388)
      %itup_506 = cute.to_int_tuple(%e0_502) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %208 = cute.get_scalars(%itup_506) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_507 = cute.to_int_tuple(%e1_503) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %209 = cute.get_scalars(%itup_507) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_508 = cute.to_int_tuple(%e2_504) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc388)
      %210 = cute.get_scalars(%itup_508) : !cute.int_tuple<"?"> loc(#loc388)
      %itup_509 = cute.to_int_tuple(%e3_505) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %211 = cute.get_scalars(%itup_509) : !cute.int_tuple<"?{div=8}"> loc(#loc388)
      %coord_510 = cute.make_coord(%e3_500) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc389)
      %coord_511 = cute.make_coord(%itup_509) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc389)
      %212 = cute.elem_less(%coord_510, %coord_511) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc389)
      %213 = arith.extui %212 : i1 to i8 loc(#loc290)
      %coord_512 = cute.make_coord() : () -> !cute.coord<"(0,0,1)"> loc(#loc389)
      cute.memref.store(%rmem_431, %coord_512, %213) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> () loc(#loc389)
      %lay_513 = cute.get_layout(%rmem_448) : !memref_rmem_i8_1 loc(#loc311)
      %214 = cute.get_shape(%lay_513) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)"> loc(#loc311)
      %e0_514, %e1_515, %e2_516 = cute.get_leaves(%214) : !cute.shape<"(1,4,2)"> loc(#loc311)
      %coord_517 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)"> loc(#loc390)
      %slice_518 = cute.slice(%src_partitioned_411, %coord_517) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)"> loc(#loc390)
      %iter_519 = cute.get_iter(%slice_518) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_520, %e1_521, %e2_522, %e3_523 = cute.get_leaves(%iter_519) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %215 = cute.get_scalars(%e0_520) : !cute.int_tuple<"?"> loc(#loc290)
      %216 = cute.get_scalars(%e1_521) : !cute.int_tuple<"?"> loc(#loc290)
      %217 = cute.get_scalars(%e2_522) : !cute.int_tuple<"?"> loc(#loc290)
      %218 = cute.get_scalars(%e3_523) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_524 = cute.get_iter(%slice_518) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_525, %e1_526, %e2_527, %e3_528 = cute.get_leaves(%iter_524) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %219 = cute.get_scalars(%e0_525) : !cute.int_tuple<"?"> loc(#loc290)
      %220 = cute.get_scalars(%e1_526) : !cute.int_tuple<"?"> loc(#loc290)
      %221 = cute.get_scalars(%e2_527) : !cute.int_tuple<"?"> loc(#loc290)
      %222 = cute.get_scalars(%e3_528) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_529 = cute.get_iter(%slice_518) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc390)
      %e0_530, %e1_531, %e2_532, %e3_533 = cute.get_leaves(%iter_529) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc390)
      %223 = cute.get_scalars(%e0_530) : !cute.int_tuple<"?"> loc(#loc390)
      %224 = cute.get_scalars(%e1_531) : !cute.int_tuple<"?"> loc(#loc390)
      %225 = cute.get_scalars(%e2_532) : !cute.int_tuple<"?"> loc(#loc390)
      %226 = cute.get_scalars(%e3_533) : !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %lay_534 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc390)
      %227 = cute.get_shape(%lay_534) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc390)
      %e0_535, %e1_536, %e2_537, %e3_538 = cute.get_leaves(%227) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc390)
      %itup_539 = cute.to_int_tuple(%e0_535) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %228 = cute.get_scalars(%itup_539) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_540 = cute.to_int_tuple(%e1_536) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %229 = cute.get_scalars(%itup_540) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_541 = cute.to_int_tuple(%e2_537) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %230 = cute.get_scalars(%itup_541) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_542 = cute.to_int_tuple(%e3_538) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %231 = cute.get_scalars(%itup_542) : !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %coord_543 = cute.make_coord(%e3_533) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc391)
      %coord_544 = cute.make_coord(%itup_542) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc391)
      %232 = cute.elem_less(%coord_543, %coord_544) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc391)
      %233 = arith.extui %232 : i1 to i8 loc(#loc290)
      %coord_545 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc391)
      cute.memref.store(%rmem_448, %coord_545, %233) : (!memref_rmem_i8_1, !cute.coord<"(0,0,0)">, i8) -> () loc(#loc391)
      %coord_546 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)"> loc(#loc390)
      %slice_547 = cute.slice(%src_partitioned_411, %coord_546) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)"> loc(#loc390)
      %iter_548 = cute.get_iter(%slice_547) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_549, %e1_550, %e2_551, %e3_552 = cute.get_leaves(%iter_548) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %234 = cute.get_scalars(%e0_549) : !cute.int_tuple<"?"> loc(#loc290)
      %235 = cute.get_scalars(%e1_550) : !cute.int_tuple<"?"> loc(#loc290)
      %236 = cute.get_scalars(%e2_551) : !cute.int_tuple<"?"> loc(#loc290)
      %237 = cute.get_scalars(%e3_552) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_553 = cute.get_iter(%slice_547) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_554, %e1_555, %e2_556, %e3_557 = cute.get_leaves(%iter_553) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %238 = cute.get_scalars(%e0_554) : !cute.int_tuple<"?"> loc(#loc290)
      %239 = cute.get_scalars(%e1_555) : !cute.int_tuple<"?"> loc(#loc290)
      %240 = cute.get_scalars(%e2_556) : !cute.int_tuple<"?"> loc(#loc290)
      %241 = cute.get_scalars(%e3_557) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_558 = cute.get_iter(%slice_547) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc390)
      %e0_559, %e1_560, %e2_561, %e3_562 = cute.get_leaves(%iter_558) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc390)
      %242 = cute.get_scalars(%e0_559) : !cute.int_tuple<"?"> loc(#loc390)
      %243 = cute.get_scalars(%e1_560) : !cute.int_tuple<"?"> loc(#loc390)
      %244 = cute.get_scalars(%e2_561) : !cute.int_tuple<"?"> loc(#loc390)
      %245 = cute.get_scalars(%e3_562) : !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %lay_563 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc390)
      %246 = cute.get_shape(%lay_563) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc390)
      %e0_564, %e1_565, %e2_566, %e3_567 = cute.get_leaves(%246) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc390)
      %itup_568 = cute.to_int_tuple(%e0_564) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %247 = cute.get_scalars(%itup_568) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_569 = cute.to_int_tuple(%e1_565) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %248 = cute.get_scalars(%itup_569) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_570 = cute.to_int_tuple(%e2_566) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc390)
      %249 = cute.get_scalars(%itup_570) : !cute.int_tuple<"?"> loc(#loc390)
      %itup_571 = cute.to_int_tuple(%e3_567) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %250 = cute.get_scalars(%itup_571) : !cute.int_tuple<"?{div=8}"> loc(#loc390)
      %coord_572 = cute.make_coord(%e3_562) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc391)
      %coord_573 = cute.make_coord(%itup_571) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc391)
      %251 = cute.elem_less(%coord_572, %coord_573) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc391)
      %252 = arith.extui %251 : i1 to i8 loc(#loc290)
      %coord_574 = cute.make_coord() : () -> !cute.coord<"(0,0,1)"> loc(#loc391)
      cute.memref.store(%rmem_448, %coord_574, %252) : (!memref_rmem_i8_1, !cute.coord<"(0,0,1)">, i8) -> () loc(#loc391)
      %int_tuple_575 = cute.make_int_tuple() : () -> !cute.int_tuple<"8"> loc(#loc392)
      %sz_576 = cute.size(%int_tuple_575) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8"> loc(#loc392)
      %e0_577 = cute.get_leaves(%sz_576) : !cute.int_tuple<"8"> loc(#loc392)
      %coord_578 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc393)
      %slice_579 = cute.slice(%src_partitioned_404, %coord_578) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)"> loc(#loc393)
      %iter_580 = cute.get_iter(%slice_579) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_581, %e1_582, %e2_583, %e3_584 = cute.get_leaves(%iter_580) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %253 = cute.get_scalars(%e0_581) : !cute.int_tuple<"?"> loc(#loc290)
      %254 = cute.get_scalars(%e1_582) : !cute.int_tuple<"?"> loc(#loc290)
      %255 = cute.get_scalars(%e2_583) : !cute.int_tuple<"?"> loc(#loc290)
      %256 = cute.get_scalars(%e3_584) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_585 = cute.get_iter(%slice_579) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_586, %e1_587, %e2_588, %e3_589 = cute.get_leaves(%iter_585) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %257 = cute.get_scalars(%e0_586) : !cute.int_tuple<"?"> loc(#loc290)
      %258 = cute.get_scalars(%e1_587) : !cute.int_tuple<"?"> loc(#loc290)
      %259 = cute.get_scalars(%e2_588) : !cute.int_tuple<"?"> loc(#loc290)
      %260 = cute.get_scalars(%e3_589) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_590 = cute.get_iter(%slice_579) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_591, %e1_592, %e2_593, %e3_594 = cute.get_leaves(%iter_590) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %261 = cute.get_scalars(%e0_591) : !cute.int_tuple<"?"> loc(#loc393)
      %262 = cute.get_scalars(%e1_592) : !cute.int_tuple<"?"> loc(#loc393)
      %263 = cute.get_scalars(%e2_593) : !cute.int_tuple<"?"> loc(#loc393)
      %264 = cute.get_scalars(%e3_594) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_595 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %265 = cute.get_shape(%lay_595) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_596, %e1_597, %e2_598, %e3_599 = cute.get_leaves(%265) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_600 = cute.to_int_tuple(%e0_596) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %266 = cute.get_scalars(%itup_600) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_601 = cute.to_int_tuple(%e1_597) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %267 = cute.get_scalars(%itup_601) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_602 = cute.to_int_tuple(%e2_598) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %268 = cute.get_scalars(%itup_602) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_603 = cute.to_int_tuple(%e3_599) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %269 = cute.get_scalars(%itup_603) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_604 = cute.make_coord(%e1_592) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_605 = cute.make_coord(%itup_601) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %270 = cute.elem_less(%coord_604, %coord_605) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %270 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,0,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,0,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,0,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_606 = cute.make_coord() : () -> !cute.coord<"(0,1,0)"> loc(#loc393)
      %slice_607 = cute.slice(%src_partitioned_404, %coord_606) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)"> loc(#loc393)
      %iter_608 = cute.get_iter(%slice_607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_609, %e1_610, %e2_611, %e3_612 = cute.get_leaves(%iter_608) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %271 = cute.get_scalars(%e0_609) : !cute.int_tuple<"?"> loc(#loc290)
      %272 = cute.get_scalars(%e1_610) : !cute.int_tuple<"?"> loc(#loc290)
      %273 = cute.get_scalars(%e2_611) : !cute.int_tuple<"?"> loc(#loc290)
      %274 = cute.get_scalars(%e3_612) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_613 = cute.get_iter(%slice_607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_614, %e1_615, %e2_616, %e3_617 = cute.get_leaves(%iter_613) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %275 = cute.get_scalars(%e0_614) : !cute.int_tuple<"?"> loc(#loc290)
      %276 = cute.get_scalars(%e1_615) : !cute.int_tuple<"?"> loc(#loc290)
      %277 = cute.get_scalars(%e2_616) : !cute.int_tuple<"?"> loc(#loc290)
      %278 = cute.get_scalars(%e3_617) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_618 = cute.get_iter(%slice_607) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_619, %e1_620, %e2_621, %e3_622 = cute.get_leaves(%iter_618) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %279 = cute.get_scalars(%e0_619) : !cute.int_tuple<"?"> loc(#loc393)
      %280 = cute.get_scalars(%e1_620) : !cute.int_tuple<"?"> loc(#loc393)
      %281 = cute.get_scalars(%e2_621) : !cute.int_tuple<"?"> loc(#loc393)
      %282 = cute.get_scalars(%e3_622) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_623 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %283 = cute.get_shape(%lay_623) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_624, %e1_625, %e2_626, %e3_627 = cute.get_leaves(%283) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_628 = cute.to_int_tuple(%e0_624) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %284 = cute.get_scalars(%itup_628) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_629 = cute.to_int_tuple(%e1_625) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %285 = cute.get_scalars(%itup_629) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_630 = cute.to_int_tuple(%e2_626) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %286 = cute.get_scalars(%itup_630) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_631 = cute.to_int_tuple(%e3_627) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %287 = cute.get_scalars(%itup_631) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_632 = cute.make_coord(%e1_620) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_633 = cute.make_coord(%itup_629) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %288 = cute.elem_less(%coord_632, %coord_633) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %288 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,1,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,1,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,1,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_634 = cute.make_coord() : () -> !cute.coord<"(0,2,0)"> loc(#loc393)
      %slice_635 = cute.slice(%src_partitioned_404, %coord_634) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)"> loc(#loc393)
      %iter_636 = cute.get_iter(%slice_635) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_637, %e1_638, %e2_639, %e3_640 = cute.get_leaves(%iter_636) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %289 = cute.get_scalars(%e0_637) : !cute.int_tuple<"?"> loc(#loc290)
      %290 = cute.get_scalars(%e1_638) : !cute.int_tuple<"?"> loc(#loc290)
      %291 = cute.get_scalars(%e2_639) : !cute.int_tuple<"?"> loc(#loc290)
      %292 = cute.get_scalars(%e3_640) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_641 = cute.get_iter(%slice_635) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_642, %e1_643, %e2_644, %e3_645 = cute.get_leaves(%iter_641) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %293 = cute.get_scalars(%e0_642) : !cute.int_tuple<"?"> loc(#loc290)
      %294 = cute.get_scalars(%e1_643) : !cute.int_tuple<"?"> loc(#loc290)
      %295 = cute.get_scalars(%e2_644) : !cute.int_tuple<"?"> loc(#loc290)
      %296 = cute.get_scalars(%e3_645) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_646 = cute.get_iter(%slice_635) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_647, %e1_648, %e2_649, %e3_650 = cute.get_leaves(%iter_646) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %297 = cute.get_scalars(%e0_647) : !cute.int_tuple<"?"> loc(#loc393)
      %298 = cute.get_scalars(%e1_648) : !cute.int_tuple<"?"> loc(#loc393)
      %299 = cute.get_scalars(%e2_649) : !cute.int_tuple<"?"> loc(#loc393)
      %300 = cute.get_scalars(%e3_650) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_651 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %301 = cute.get_shape(%lay_651) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_652, %e1_653, %e2_654, %e3_655 = cute.get_leaves(%301) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_656 = cute.to_int_tuple(%e0_652) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %302 = cute.get_scalars(%itup_656) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_657 = cute.to_int_tuple(%e1_653) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %303 = cute.get_scalars(%itup_657) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_658 = cute.to_int_tuple(%e2_654) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %304 = cute.get_scalars(%itup_658) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_659 = cute.to_int_tuple(%e3_655) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %305 = cute.get_scalars(%itup_659) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_660 = cute.make_coord(%e1_648) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_661 = cute.make_coord(%itup_657) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %306 = cute.elem_less(%coord_660, %coord_661) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %306 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,2,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,2,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,2,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_662 = cute.make_coord() : () -> !cute.coord<"(0,3,0)"> loc(#loc393)
      %slice_663 = cute.slice(%src_partitioned_404, %coord_662) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)"> loc(#loc393)
      %iter_664 = cute.get_iter(%slice_663) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_665, %e1_666, %e2_667, %e3_668 = cute.get_leaves(%iter_664) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %307 = cute.get_scalars(%e0_665) : !cute.int_tuple<"?"> loc(#loc290)
      %308 = cute.get_scalars(%e1_666) : !cute.int_tuple<"?"> loc(#loc290)
      %309 = cute.get_scalars(%e2_667) : !cute.int_tuple<"?"> loc(#loc290)
      %310 = cute.get_scalars(%e3_668) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_669 = cute.get_iter(%slice_663) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_670, %e1_671, %e2_672, %e3_673 = cute.get_leaves(%iter_669) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %311 = cute.get_scalars(%e0_670) : !cute.int_tuple<"?"> loc(#loc290)
      %312 = cute.get_scalars(%e1_671) : !cute.int_tuple<"?"> loc(#loc290)
      %313 = cute.get_scalars(%e2_672) : !cute.int_tuple<"?"> loc(#loc290)
      %314 = cute.get_scalars(%e3_673) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_674 = cute.get_iter(%slice_663) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_675, %e1_676, %e2_677, %e3_678 = cute.get_leaves(%iter_674) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %315 = cute.get_scalars(%e0_675) : !cute.int_tuple<"?"> loc(#loc393)
      %316 = cute.get_scalars(%e1_676) : !cute.int_tuple<"?"> loc(#loc393)
      %317 = cute.get_scalars(%e2_677) : !cute.int_tuple<"?"> loc(#loc393)
      %318 = cute.get_scalars(%e3_678) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_679 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %319 = cute.get_shape(%lay_679) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_680, %e1_681, %e2_682, %e3_683 = cute.get_leaves(%319) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_684 = cute.to_int_tuple(%e0_680) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %320 = cute.get_scalars(%itup_684) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_685 = cute.to_int_tuple(%e1_681) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %321 = cute.get_scalars(%itup_685) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_686 = cute.to_int_tuple(%e2_682) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %322 = cute.get_scalars(%itup_686) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_687 = cute.to_int_tuple(%e3_683) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %323 = cute.get_scalars(%itup_687) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_688 = cute.make_coord(%e1_676) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_689 = cute.make_coord(%itup_685) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %324 = cute.elem_less(%coord_688, %coord_689) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %324 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,3,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,3,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,3,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_690 = cute.make_coord() : () -> !cute.coord<"(0,4,0)"> loc(#loc393)
      %slice_691 = cute.slice(%src_partitioned_404, %coord_690) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,4,0)"> loc(#loc393)
      %iter_692 = cute.get_iter(%slice_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_693, %e1_694, %e2_695, %e3_696 = cute.get_leaves(%iter_692) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %325 = cute.get_scalars(%e0_693) : !cute.int_tuple<"?"> loc(#loc290)
      %326 = cute.get_scalars(%e1_694) : !cute.int_tuple<"?"> loc(#loc290)
      %327 = cute.get_scalars(%e2_695) : !cute.int_tuple<"?"> loc(#loc290)
      %328 = cute.get_scalars(%e3_696) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_697 = cute.get_iter(%slice_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_698, %e1_699, %e2_700, %e3_701 = cute.get_leaves(%iter_697) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %329 = cute.get_scalars(%e0_698) : !cute.int_tuple<"?"> loc(#loc290)
      %330 = cute.get_scalars(%e1_699) : !cute.int_tuple<"?"> loc(#loc290)
      %331 = cute.get_scalars(%e2_700) : !cute.int_tuple<"?"> loc(#loc290)
      %332 = cute.get_scalars(%e3_701) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_702 = cute.get_iter(%slice_691) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_703, %e1_704, %e2_705, %e3_706 = cute.get_leaves(%iter_702) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %333 = cute.get_scalars(%e0_703) : !cute.int_tuple<"?"> loc(#loc393)
      %334 = cute.get_scalars(%e1_704) : !cute.int_tuple<"?"> loc(#loc393)
      %335 = cute.get_scalars(%e2_705) : !cute.int_tuple<"?"> loc(#loc393)
      %336 = cute.get_scalars(%e3_706) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_707 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %337 = cute.get_shape(%lay_707) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_708, %e1_709, %e2_710, %e3_711 = cute.get_leaves(%337) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_712 = cute.to_int_tuple(%e0_708) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %338 = cute.get_scalars(%itup_712) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_713 = cute.to_int_tuple(%e1_709) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %339 = cute.get_scalars(%itup_713) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_714 = cute.to_int_tuple(%e2_710) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %340 = cute.get_scalars(%itup_714) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_715 = cute.to_int_tuple(%e3_711) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %341 = cute.get_scalars(%itup_715) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_716 = cute.make_coord(%e1_704) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_717 = cute.make_coord(%itup_713) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %342 = cute.elem_less(%coord_716, %coord_717) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %342 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,4,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,4,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,4,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,4,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_718 = cute.make_coord() : () -> !cute.coord<"(0,5,0)"> loc(#loc393)
      %slice_719 = cute.slice(%src_partitioned_404, %coord_718) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,5,0)"> loc(#loc393)
      %iter_720 = cute.get_iter(%slice_719) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_721, %e1_722, %e2_723, %e3_724 = cute.get_leaves(%iter_720) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %343 = cute.get_scalars(%e0_721) : !cute.int_tuple<"?"> loc(#loc290)
      %344 = cute.get_scalars(%e1_722) : !cute.int_tuple<"?"> loc(#loc290)
      %345 = cute.get_scalars(%e2_723) : !cute.int_tuple<"?"> loc(#loc290)
      %346 = cute.get_scalars(%e3_724) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_725 = cute.get_iter(%slice_719) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_726, %e1_727, %e2_728, %e3_729 = cute.get_leaves(%iter_725) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %347 = cute.get_scalars(%e0_726) : !cute.int_tuple<"?"> loc(#loc290)
      %348 = cute.get_scalars(%e1_727) : !cute.int_tuple<"?"> loc(#loc290)
      %349 = cute.get_scalars(%e2_728) : !cute.int_tuple<"?"> loc(#loc290)
      %350 = cute.get_scalars(%e3_729) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_730 = cute.get_iter(%slice_719) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_731, %e1_732, %e2_733, %e3_734 = cute.get_leaves(%iter_730) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %351 = cute.get_scalars(%e0_731) : !cute.int_tuple<"?"> loc(#loc393)
      %352 = cute.get_scalars(%e1_732) : !cute.int_tuple<"?"> loc(#loc393)
      %353 = cute.get_scalars(%e2_733) : !cute.int_tuple<"?"> loc(#loc393)
      %354 = cute.get_scalars(%e3_734) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_735 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %355 = cute.get_shape(%lay_735) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_736, %e1_737, %e2_738, %e3_739 = cute.get_leaves(%355) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_740 = cute.to_int_tuple(%e0_736) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %356 = cute.get_scalars(%itup_740) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_741 = cute.to_int_tuple(%e1_737) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %357 = cute.get_scalars(%itup_741) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_742 = cute.to_int_tuple(%e2_738) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %358 = cute.get_scalars(%itup_742) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_743 = cute.to_int_tuple(%e3_739) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %359 = cute.get_scalars(%itup_743) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_744 = cute.make_coord(%e1_732) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_745 = cute.make_coord(%itup_741) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %360 = cute.elem_less(%coord_744, %coord_745) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %360 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,5,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,5,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,5,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,5,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_746 = cute.make_coord() : () -> !cute.coord<"(0,6,0)"> loc(#loc393)
      %slice_747 = cute.slice(%src_partitioned_404, %coord_746) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,6,0)"> loc(#loc393)
      %iter_748 = cute.get_iter(%slice_747) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_749, %e1_750, %e2_751, %e3_752 = cute.get_leaves(%iter_748) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %361 = cute.get_scalars(%e0_749) : !cute.int_tuple<"?"> loc(#loc290)
      %362 = cute.get_scalars(%e1_750) : !cute.int_tuple<"?"> loc(#loc290)
      %363 = cute.get_scalars(%e2_751) : !cute.int_tuple<"?"> loc(#loc290)
      %364 = cute.get_scalars(%e3_752) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_753 = cute.get_iter(%slice_747) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_754, %e1_755, %e2_756, %e3_757 = cute.get_leaves(%iter_753) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %365 = cute.get_scalars(%e0_754) : !cute.int_tuple<"?"> loc(#loc290)
      %366 = cute.get_scalars(%e1_755) : !cute.int_tuple<"?"> loc(#loc290)
      %367 = cute.get_scalars(%e2_756) : !cute.int_tuple<"?"> loc(#loc290)
      %368 = cute.get_scalars(%e3_757) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_758 = cute.get_iter(%slice_747) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_759, %e1_760, %e2_761, %e3_762 = cute.get_leaves(%iter_758) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %369 = cute.get_scalars(%e0_759) : !cute.int_tuple<"?"> loc(#loc393)
      %370 = cute.get_scalars(%e1_760) : !cute.int_tuple<"?"> loc(#loc393)
      %371 = cute.get_scalars(%e2_761) : !cute.int_tuple<"?"> loc(#loc393)
      %372 = cute.get_scalars(%e3_762) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_763 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %373 = cute.get_shape(%lay_763) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_764, %e1_765, %e2_766, %e3_767 = cute.get_leaves(%373) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_768 = cute.to_int_tuple(%e0_764) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %374 = cute.get_scalars(%itup_768) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_769 = cute.to_int_tuple(%e1_765) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %375 = cute.get_scalars(%itup_769) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_770 = cute.to_int_tuple(%e2_766) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %376 = cute.get_scalars(%itup_770) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_771 = cute.to_int_tuple(%e3_767) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %377 = cute.get_scalars(%itup_771) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_772 = cute.make_coord(%e1_760) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_773 = cute.make_coord(%itup_769) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %378 = cute.elem_less(%coord_772, %coord_773) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %378 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,6,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,6,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,6,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,6,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %coord_774 = cute.make_coord() : () -> !cute.coord<"(0,7,0)"> loc(#loc393)
      %slice_775 = cute.slice(%src_partitioned_404, %coord_774) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,7,0)"> loc(#loc393)
      %iter_776 = cute.get_iter(%slice_775) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_777, %e1_778, %e2_779, %e3_780 = cute.get_leaves(%iter_776) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %379 = cute.get_scalars(%e0_777) : !cute.int_tuple<"?"> loc(#loc290)
      %380 = cute.get_scalars(%e1_778) : !cute.int_tuple<"?"> loc(#loc290)
      %381 = cute.get_scalars(%e2_779) : !cute.int_tuple<"?"> loc(#loc290)
      %382 = cute.get_scalars(%e3_780) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_781 = cute.get_iter(%slice_775) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_782, %e1_783, %e2_784, %e3_785 = cute.get_leaves(%iter_781) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %383 = cute.get_scalars(%e0_782) : !cute.int_tuple<"?"> loc(#loc290)
      %384 = cute.get_scalars(%e1_783) : !cute.int_tuple<"?"> loc(#loc290)
      %385 = cute.get_scalars(%e2_784) : !cute.int_tuple<"?"> loc(#loc290)
      %386 = cute.get_scalars(%e3_785) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_786 = cute.get_iter(%slice_775) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc393)
      %e0_787, %e1_788, %e2_789, %e3_790 = cute.get_leaves(%iter_786) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc393)
      %387 = cute.get_scalars(%e0_787) : !cute.int_tuple<"?"> loc(#loc393)
      %388 = cute.get_scalars(%e1_788) : !cute.int_tuple<"?"> loc(#loc393)
      %389 = cute.get_scalars(%e2_789) : !cute.int_tuple<"?"> loc(#loc393)
      %390 = cute.get_scalars(%e3_790) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %lay_791 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc393)
      %391 = cute.get_shape(%lay_791) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %e0_792, %e1_793, %e2_794, %e3_795 = cute.get_leaves(%391) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc393)
      %itup_796 = cute.to_int_tuple(%e0_792) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %392 = cute.get_scalars(%itup_796) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_797 = cute.to_int_tuple(%e1_793) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %393 = cute.get_scalars(%itup_797) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_798 = cute.to_int_tuple(%e2_794) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc393)
      %394 = cute.get_scalars(%itup_798) : !cute.int_tuple<"?"> loc(#loc393)
      %itup_799 = cute.to_int_tuple(%e3_795) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %395 = cute.get_scalars(%itup_799) : !cute.int_tuple<"?{div=8}"> loc(#loc393)
      %coord_800 = cute.make_coord(%e1_788) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %coord_801 = cute.make_coord(%itup_797) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc393)
      %396 = cute.elem_less(%coord_800, %coord_801) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc393)
      scf.if %396 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc394)
        %slice_6350 = cute.slice(%src_partitioned, %coord_6349) : !memref_gmem_bf16_4, !cute.coord<"(_,7,_)"> loc(#loc394)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc395)
        %slice_6354 = cute.slice(%dst_partitioned, %coord_6353) : !memref_smem_bf16_3, !cute.coord<"(_,7,_)"> loc(#loc395)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_11 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc396)
        %slice_6358 = cute.slice(%rmem_431, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,7,_)"> loc(#loc396)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_11 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),8192)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_11 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_11 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_11 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_11) -> !memref_smem_bf16_12 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_12 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_12 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(8192))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_12) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_12, !memref_rmem_i8_3) loc(#loc403)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc404)
        %slice_6350 = cute.slice(%dst_partitioned, %coord_6349) : !memref_smem_bf16_3, !cute.coord<"(_,7,_)"> loc(#loc404)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_11 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_11) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc404)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_11 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),8192)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc404)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc404)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc404)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc404)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc404)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc404)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc404)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_11 loc(#loc404)
      } loc(#loc290)
      %int_tuple_802 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc405)
      %sz_803 = cute.size(%int_tuple_802) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc405)
      %e0_804 = cute.get_leaves(%sz_803) : !cute.int_tuple<"4"> loc(#loc405)
      %coord_805 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc406)
      %slice_806 = cute.slice(%src_partitioned_411, %coord_805) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)"> loc(#loc406)
      %iter_807 = cute.get_iter(%slice_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_808, %e1_809, %e2_810, %e3_811 = cute.get_leaves(%iter_807) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %397 = cute.get_scalars(%e0_808) : !cute.int_tuple<"?"> loc(#loc290)
      %398 = cute.get_scalars(%e1_809) : !cute.int_tuple<"?"> loc(#loc290)
      %399 = cute.get_scalars(%e2_810) : !cute.int_tuple<"?"> loc(#loc290)
      %400 = cute.get_scalars(%e3_811) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_812 = cute.get_iter(%slice_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_813, %e1_814, %e2_815, %e3_816 = cute.get_leaves(%iter_812) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %401 = cute.get_scalars(%e0_813) : !cute.int_tuple<"?"> loc(#loc290)
      %402 = cute.get_scalars(%e1_814) : !cute.int_tuple<"?"> loc(#loc290)
      %403 = cute.get_scalars(%e2_815) : !cute.int_tuple<"?"> loc(#loc290)
      %404 = cute.get_scalars(%e3_816) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_817 = cute.get_iter(%slice_806) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc406)
      %e0_818, %e1_819, %e2_820, %e3_821 = cute.get_leaves(%iter_817) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc406)
      %405 = cute.get_scalars(%e0_818) : !cute.int_tuple<"?"> loc(#loc406)
      %406 = cute.get_scalars(%e1_819) : !cute.int_tuple<"?"> loc(#loc406)
      %407 = cute.get_scalars(%e2_820) : !cute.int_tuple<"?"> loc(#loc406)
      %408 = cute.get_scalars(%e3_821) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %lay_822 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc406)
      %409 = cute.get_shape(%lay_822) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %e0_823, %e1_824, %e2_825, %e3_826 = cute.get_leaves(%409) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %itup_827 = cute.to_int_tuple(%e0_823) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %410 = cute.get_scalars(%itup_827) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_828 = cute.to_int_tuple(%e1_824) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %411 = cute.get_scalars(%itup_828) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_829 = cute.to_int_tuple(%e2_825) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %412 = cute.get_scalars(%itup_829) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_830 = cute.to_int_tuple(%e3_826) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %413 = cute.get_scalars(%itup_830) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %coord_831 = cute.make_coord(%e1_819) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %coord_832 = cute.make_coord(%itup_828) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %414 = cute.elem_less(%coord_831, %coord_832) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc406)
      scf.if %414 {
        %coord_6349 = cute.make_coord(%121) : (i32) -> !cute.coord<"(_,0,_,?)"> loc(#loc407)
        %slice_6350 = cute.slice(%src_partitioned_236, %coord_6349) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)"> loc(#loc407)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc408)
        %slice_6354 = cute.slice(%dst_partitioned_239, %coord_6353) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc408)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc409)
        %slice_6358 = cute.slice(%rmem_448, %coord_6357) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)"> loc(#loc409)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_13 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_13 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_14 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc410)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc411)
        %slice_6350 = cute.slice(%dst_partitioned_239, %coord_6349) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc411)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc411)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_13 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc411)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc411)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc411)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc411)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc411)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_13 loc(#loc411)
      } loc(#loc290)
      %coord_833 = cute.make_coord() : () -> !cute.coord<"(0,1,0)"> loc(#loc406)
      %slice_834 = cute.slice(%src_partitioned_411, %coord_833) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)"> loc(#loc406)
      %iter_835 = cute.get_iter(%slice_834) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_836, %e1_837, %e2_838, %e3_839 = cute.get_leaves(%iter_835) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %415 = cute.get_scalars(%e0_836) : !cute.int_tuple<"?"> loc(#loc290)
      %416 = cute.get_scalars(%e1_837) : !cute.int_tuple<"?"> loc(#loc290)
      %417 = cute.get_scalars(%e2_838) : !cute.int_tuple<"?"> loc(#loc290)
      %418 = cute.get_scalars(%e3_839) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_840 = cute.get_iter(%slice_834) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_841, %e1_842, %e2_843, %e3_844 = cute.get_leaves(%iter_840) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %419 = cute.get_scalars(%e0_841) : !cute.int_tuple<"?"> loc(#loc290)
      %420 = cute.get_scalars(%e1_842) : !cute.int_tuple<"?"> loc(#loc290)
      %421 = cute.get_scalars(%e2_843) : !cute.int_tuple<"?"> loc(#loc290)
      %422 = cute.get_scalars(%e3_844) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_845 = cute.get_iter(%slice_834) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc406)
      %e0_846, %e1_847, %e2_848, %e3_849 = cute.get_leaves(%iter_845) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc406)
      %423 = cute.get_scalars(%e0_846) : !cute.int_tuple<"?"> loc(#loc406)
      %424 = cute.get_scalars(%e1_847) : !cute.int_tuple<"?"> loc(#loc406)
      %425 = cute.get_scalars(%e2_848) : !cute.int_tuple<"?"> loc(#loc406)
      %426 = cute.get_scalars(%e3_849) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %lay_850 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc406)
      %427 = cute.get_shape(%lay_850) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %e0_851, %e1_852, %e2_853, %e3_854 = cute.get_leaves(%427) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %itup_855 = cute.to_int_tuple(%e0_851) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %428 = cute.get_scalars(%itup_855) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_856 = cute.to_int_tuple(%e1_852) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %429 = cute.get_scalars(%itup_856) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_857 = cute.to_int_tuple(%e2_853) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %430 = cute.get_scalars(%itup_857) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_858 = cute.to_int_tuple(%e3_854) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %431 = cute.get_scalars(%itup_858) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %coord_859 = cute.make_coord(%e1_847) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %coord_860 = cute.make_coord(%itup_856) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %432 = cute.elem_less(%coord_859, %coord_860) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc406)
      scf.if %432 {
        %coord_6349 = cute.make_coord(%121) : (i32) -> !cute.coord<"(_,1,_,?)"> loc(#loc407)
        %slice_6350 = cute.slice(%src_partitioned_236, %coord_6349) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)"> loc(#loc407)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc408)
        %slice_6354 = cute.slice(%dst_partitioned_239, %coord_6353) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc408)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc409)
        %slice_6358 = cute.slice(%rmem_448, %coord_6357) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)"> loc(#loc409)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_13 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_13 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_14 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc410)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc411)
        %slice_6350 = cute.slice(%dst_partitioned_239, %coord_6349) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc411)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc411)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_13 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc411)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc411)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc411)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc411)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc411)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_13 loc(#loc411)
      } loc(#loc290)
      %coord_861 = cute.make_coord() : () -> !cute.coord<"(0,2,0)"> loc(#loc406)
      %slice_862 = cute.slice(%src_partitioned_411, %coord_861) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)"> loc(#loc406)
      %iter_863 = cute.get_iter(%slice_862) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_864, %e1_865, %e2_866, %e3_867 = cute.get_leaves(%iter_863) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %433 = cute.get_scalars(%e0_864) : !cute.int_tuple<"?"> loc(#loc290)
      %434 = cute.get_scalars(%e1_865) : !cute.int_tuple<"?"> loc(#loc290)
      %435 = cute.get_scalars(%e2_866) : !cute.int_tuple<"?"> loc(#loc290)
      %436 = cute.get_scalars(%e3_867) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_868 = cute.get_iter(%slice_862) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_869, %e1_870, %e2_871, %e3_872 = cute.get_leaves(%iter_868) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %437 = cute.get_scalars(%e0_869) : !cute.int_tuple<"?"> loc(#loc290)
      %438 = cute.get_scalars(%e1_870) : !cute.int_tuple<"?"> loc(#loc290)
      %439 = cute.get_scalars(%e2_871) : !cute.int_tuple<"?"> loc(#loc290)
      %440 = cute.get_scalars(%e3_872) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_873 = cute.get_iter(%slice_862) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc406)
      %e0_874, %e1_875, %e2_876, %e3_877 = cute.get_leaves(%iter_873) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc406)
      %441 = cute.get_scalars(%e0_874) : !cute.int_tuple<"?"> loc(#loc406)
      %442 = cute.get_scalars(%e1_875) : !cute.int_tuple<"?"> loc(#loc406)
      %443 = cute.get_scalars(%e2_876) : !cute.int_tuple<"?"> loc(#loc406)
      %444 = cute.get_scalars(%e3_877) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %lay_878 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc406)
      %445 = cute.get_shape(%lay_878) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %e0_879, %e1_880, %e2_881, %e3_882 = cute.get_leaves(%445) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %itup_883 = cute.to_int_tuple(%e0_879) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %446 = cute.get_scalars(%itup_883) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_884 = cute.to_int_tuple(%e1_880) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %447 = cute.get_scalars(%itup_884) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_885 = cute.to_int_tuple(%e2_881) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %448 = cute.get_scalars(%itup_885) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_886 = cute.to_int_tuple(%e3_882) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %449 = cute.get_scalars(%itup_886) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %coord_887 = cute.make_coord(%e1_875) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %coord_888 = cute.make_coord(%itup_884) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %450 = cute.elem_less(%coord_887, %coord_888) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc406)
      scf.if %450 {
        %coord_6349 = cute.make_coord(%121) : (i32) -> !cute.coord<"(_,2,_,?)"> loc(#loc407)
        %slice_6350 = cute.slice(%src_partitioned_236, %coord_6349) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)"> loc(#loc407)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc408)
        %slice_6354 = cute.slice(%dst_partitioned_239, %coord_6353) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc408)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc409)
        %slice_6358 = cute.slice(%rmem_448, %coord_6357) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)"> loc(#loc409)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_13 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_13 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_14 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc410)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc411)
        %slice_6350 = cute.slice(%dst_partitioned_239, %coord_6349) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc411)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc411)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_13 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc411)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc411)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc411)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc411)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc411)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_13 loc(#loc411)
      } loc(#loc290)
      %coord_889 = cute.make_coord() : () -> !cute.coord<"(0,3,0)"> loc(#loc406)
      %slice_890 = cute.slice(%src_partitioned_411, %coord_889) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)"> loc(#loc406)
      %iter_891 = cute.get_iter(%slice_890) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_892, %e1_893, %e2_894, %e3_895 = cute.get_leaves(%iter_891) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %451 = cute.get_scalars(%e0_892) : !cute.int_tuple<"?"> loc(#loc290)
      %452 = cute.get_scalars(%e1_893) : !cute.int_tuple<"?"> loc(#loc290)
      %453 = cute.get_scalars(%e2_894) : !cute.int_tuple<"?"> loc(#loc290)
      %454 = cute.get_scalars(%e3_895) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_896 = cute.get_iter(%slice_890) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_897, %e1_898, %e2_899, %e3_900 = cute.get_leaves(%iter_896) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %455 = cute.get_scalars(%e0_897) : !cute.int_tuple<"?"> loc(#loc290)
      %456 = cute.get_scalars(%e1_898) : !cute.int_tuple<"?"> loc(#loc290)
      %457 = cute.get_scalars(%e2_899) : !cute.int_tuple<"?"> loc(#loc290)
      %458 = cute.get_scalars(%e3_900) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_901 = cute.get_iter(%slice_890) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc406)
      %e0_902, %e1_903, %e2_904, %e3_905 = cute.get_leaves(%iter_901) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc406)
      %459 = cute.get_scalars(%e0_902) : !cute.int_tuple<"?"> loc(#loc406)
      %460 = cute.get_scalars(%e1_903) : !cute.int_tuple<"?"> loc(#loc406)
      %461 = cute.get_scalars(%e2_904) : !cute.int_tuple<"?"> loc(#loc406)
      %462 = cute.get_scalars(%e3_905) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %lay_906 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc406)
      %463 = cute.get_shape(%lay_906) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %e0_907, %e1_908, %e2_909, %e3_910 = cute.get_leaves(%463) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc406)
      %itup_911 = cute.to_int_tuple(%e0_907) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %464 = cute.get_scalars(%itup_911) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_912 = cute.to_int_tuple(%e1_908) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %465 = cute.get_scalars(%itup_912) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_913 = cute.to_int_tuple(%e2_909) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc406)
      %466 = cute.get_scalars(%itup_913) : !cute.int_tuple<"?"> loc(#loc406)
      %itup_914 = cute.to_int_tuple(%e3_910) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %467 = cute.get_scalars(%itup_914) : !cute.int_tuple<"?{div=8}"> loc(#loc406)
      %coord_915 = cute.make_coord(%e1_903) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %coord_916 = cute.make_coord(%itup_912) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc406)
      %468 = cute.elem_less(%coord_915, %coord_916) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc406)
      scf.if %468 {
        %coord_6349 = cute.make_coord(%121) : (i32) -> !cute.coord<"(_,3,_,?)"> loc(#loc407)
        %slice_6350 = cute.slice(%src_partitioned_236, %coord_6349) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)"> loc(#loc407)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc408)
        %slice_6354 = cute.slice(%dst_partitioned_239, %coord_6353) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc408)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc409)
        %slice_6358 = cute.slice(%rmem_448, %coord_6357) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)"> loc(#loc409)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_gmem_bf16_6 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_gmem_bf16_6 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_smem_bf16_13 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_smem_bf16_13 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_gmem_bf16_7 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_smem_bf16_14 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg8, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc410)
      } else {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc411)
        %slice_6350 = cute.slice(%dst_partitioned_239, %coord_6349) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc411)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_smem_bf16_13 loc(#loc317)
        %sz_6353 = cute.size(%slice_6350) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6354 = cute.get_leaves(%sz_6353) : !cute.int_tuple<"16"> loc(#loc411)
        %lay_6355 = cute.get_layout(%slice_6350) : !memref_smem_bf16_13 loc(#loc311)
        %2346 = cute.get_shape(%lay_6355) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6356, %e1_6357, %e2_6358 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %int_tuple_6359 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %res_6360 = cute.tuple.product(%int_tuple_6359) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6361 = cute.get_leaves(%res_6360) : !cute.int_tuple<"16"> loc(#loc411)
        %cst_6362 = arith.constant 0.000000e+00 : bf16 loc(#loc411)
        %2347 = vector.splat %cst_6362 : vector<16xbf16> loc(#loc411)
        %int_tuple_6363 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6364 = cute.size(%int_tuple_6363) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6365 = cute.get_leaves(%sz_6364) : !cute.int_tuple<"16"> loc(#loc411)
        %int_tuple_6366 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc411)
        %sz_6367 = cute.size(%int_tuple_6366) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc411)
        %e0_6368 = cute.get_leaves(%sz_6367) : !cute.int_tuple<"16"> loc(#loc411)
        cute.memref.store_vec %2347, %slice_6350 : !memref_smem_bf16_13 loc(#loc411)
      } loc(#loc290)
      nvvm.cp.async.commit.group loc(#loc412)
      %shape_917 = cute.make_shape() : () -> !cute.shape<"4"> loc(#loc413)
      %lay_918 = cute.make_layout(%shape_917) : !cute.layout<"4:1"> loc(#loc413)
      %rmem_919 = cute.memref.alloca(%lay_918) : !memref_rmem_f32_1 loc(#loc413)
      %iter_920 = cute.get_iter(%rmem_919) : !memref_rmem_f32_1 loc(#loc350)
      %iter_921 = cute.get_iter(%rmem_919) : !memref_rmem_f32_1 loc(#loc351)
      %shape_922 = cute.make_shape() : () -> !cute.shape<"4"> loc(#loc414)
      %lay_923 = cute.make_layout(%shape_922) : !cute.layout<"4:1"> loc(#loc414)
      %rmem_924 = cute.memref.alloca(%lay_923) : !memref_rmem_f32_1 loc(#loc414)
      %iter_925 = cute.get_iter(%rmem_924) : !memref_rmem_f32_1 loc(#loc350)
      %iter_926 = cute.get_iter(%rmem_924) : !memref_rmem_f32_1 loc(#loc351)
      %sz_927 = cute.size(%rmem_919) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4"> loc(#loc415)
      %e0_928 = cute.get_leaves(%sz_927) : !cute.int_tuple<"4"> loc(#loc415)
      %lay_929 = cute.get_layout(%rmem_919) : !memref_rmem_f32_1 loc(#loc311)
      %469 = cute.get_shape(%lay_929) : (!cute.layout<"4:1">) -> !cute.shape<"4"> loc(#loc311)
      %e0_930 = cute.get_leaves(%469) : !cute.shape<"4"> loc(#loc311)
      %cst_931 = arith.constant 0xFF800000 : f32 loc(#loc415)
      %470 = vector.splat %cst_931 : vector<4xf32> loc(#loc415)
      %int_tuple_932 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc415)
      %sz_933 = cute.size(%int_tuple_932) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc415)
      %e0_934 = cute.get_leaves(%sz_933) : !cute.int_tuple<"4"> loc(#loc415)
      %int_tuple_935 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc415)
      %sz_936 = cute.size(%int_tuple_935) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc415)
      %e0_937 = cute.get_leaves(%sz_936) : !cute.int_tuple<"4"> loc(#loc415)
      cute.memref.store_vec %470, %rmem_919 : !memref_rmem_f32_1 loc(#loc415)
      %sz_938 = cute.size(%rmem_924) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4"> loc(#loc416)
      %e0_939 = cute.get_leaves(%sz_938) : !cute.int_tuple<"4"> loc(#loc416)
      %lay_940 = cute.get_layout(%rmem_924) : !memref_rmem_f32_1 loc(#loc311)
      %471 = cute.get_shape(%lay_940) : (!cute.layout<"4:1">) -> !cute.shape<"4"> loc(#loc311)
      %e0_941 = cute.get_leaves(%471) : !cute.shape<"4"> loc(#loc311)
      %cst_942 = arith.constant 0.000000e+00 : f32 loc(#loc416)
      %472 = vector.splat %cst_942 : vector<4xf32> loc(#loc416)
      %int_tuple_943 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc416)
      %sz_944 = cute.size(%int_tuple_943) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc416)
      %e0_945 = cute.get_leaves(%sz_944) : !cute.int_tuple<"4"> loc(#loc416)
      %int_tuple_946 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc416)
      %sz_947 = cute.size(%int_tuple_946) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc416)
      %e0_948 = cute.get_leaves(%sz_947) : !cute.int_tuple<"4"> loc(#loc416)
      cute.memref.store_vec %472, %rmem_924 : !memref_rmem_f32_1 loc(#loc416)
      %c0_i32 = arith.constant 0 : i32 loc(#loc290)
      %473 = arith.subi %120, %c0_i32 : i32 loc(#loc313)
      %474 = arith.subi %473, %c1_i32 : i32 loc(#loc313)
      %shape_949 = cute.make_shape() : () -> !cute.shape<"(128,64)"> loc(#loc417)
      %475 = cute.tiled.mma.partition_shape C (%arg10, %shape_949) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc417)
      %e0_950, %e1_951, %e2_952, %e3_953 = cute.get_leaves(%475) : !cute.shape<"((2,2),2,8)"> loc(#loc417)
      %shape_954 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)"> loc(#loc418)
      %lay_955 = cute.make_layout(%shape_954) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc418)
      %rmem_956 = cute.memref.alloca(%lay_955) : !memref_rmem_f32_2 loc(#loc418)
      %iter_957 = cute.get_iter(%rmem_956) : !memref_rmem_f32_2 loc(#loc350)
      %iter_958 = cute.get_iter(%rmem_956) : !memref_rmem_f32_2 loc(#loc351)
      %sz_959 = cute.size(%rmem_956) : (!memref_rmem_f32_2) -> !cute.int_tuple<"64"> loc(#loc419)
      %e0_960 = cute.get_leaves(%sz_959) : !cute.int_tuple<"64"> loc(#loc419)
      %lay_961 = cute.get_layout(%rmem_956) : !memref_rmem_f32_2 loc(#loc311)
      %476 = cute.get_shape(%lay_961) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc311)
      %e0_962, %e1_963, %e2_964, %e3_965 = cute.get_leaves(%476) : !cute.shape<"((2,2),2,8)"> loc(#loc311)
      %int_tuple_966 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
      %res_967 = cute.tuple.product(%int_tuple_966) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
      %e0_968 = cute.get_leaves(%res_967) : !cute.int_tuple<"64"> loc(#loc419)
      %cst_969 = arith.constant 0.000000e+00 : f32 loc(#loc419)
      %477 = vector.splat %cst_969 : vector<64xf32> loc(#loc419)
      %int_tuple_970 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
      %sz_971 = cute.size(%int_tuple_970) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
      %e0_972 = cute.get_leaves(%sz_971) : !cute.int_tuple<"64"> loc(#loc419)
      %int_tuple_973 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
      %sz_974 = cute.size(%int_tuple_973) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
      %e0_975 = cute.get_leaves(%sz_974) : !cute.int_tuple<"64"> loc(#loc419)
      cute.memref.store_vec %477, %rmem_956 : !memref_rmem_f32_2 loc(#loc419)
      nvvm.cp.async.wait.group 0 loc(#loc420)
      %c1_i32_976 = arith.constant 1 : i32 loc(#loc421)
      %c128_i32 = arith.constant 128 : i32 loc(#loc421)
      nvvm.barrier id = %c1_i32_976 number_of_threads = %c128_i32 loc(#loc421)
      %true = arith.constant true loc(#loc290)
      scf.if %true {
        %lay_6349 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc311)
        %2346 = cute.get_shape(%lay_6349) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6350, %e1_6351, %e2_6352, %e3_6353 = cute.get_leaves(%2346) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %int_tuple_6354 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc422)
        %sz_6355 = cute.size(%int_tuple_6354) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc422)
        %e0_6356 = cute.get_leaves(%sz_6355) : !cute.int_tuple<"4"> loc(#loc422)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc423)
        %slice_6358 = cute.slice(%src_partitioned_411, %coord_6357) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)"> loc(#loc423)
        %iter_6359 = cute.get_iter(%slice_6358) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
        %e0_6360, %e1_6361, %e2_6362, %e3_6363 = cute.get_leaves(%iter_6359) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2347 = cute.get_scalars(%e0_6360) : !cute.int_tuple<"?"> loc(#loc290)
        %2348 = cute.get_scalars(%e1_6361) : !cute.int_tuple<"?"> loc(#loc290)
        %2349 = cute.get_scalars(%e2_6362) : !cute.int_tuple<"?"> loc(#loc290)
        %2350 = cute.get_scalars(%e3_6363) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6364 = cute.get_iter(%slice_6358) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
        %e0_6365, %e1_6366, %e2_6367, %e3_6368 = cute.get_leaves(%iter_6364) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2351 = cute.get_scalars(%e0_6365) : !cute.int_tuple<"?"> loc(#loc290)
        %2352 = cute.get_scalars(%e1_6366) : !cute.int_tuple<"?"> loc(#loc290)
        %2353 = cute.get_scalars(%e2_6367) : !cute.int_tuple<"?"> loc(#loc290)
        %2354 = cute.get_scalars(%e3_6368) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6369 = cute.get_iter(%slice_6358) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
        %e0_6370, %e1_6371, %e2_6372, %e3_6373 = cute.get_leaves(%iter_6369) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
        %2355 = cute.get_scalars(%e0_6370) : !cute.int_tuple<"?"> loc(#loc423)
        %2356 = cute.get_scalars(%e1_6371) : !cute.int_tuple<"?"> loc(#loc423)
        %2357 = cute.get_scalars(%e2_6372) : !cute.int_tuple<"?"> loc(#loc423)
        %2358 = cute.get_scalars(%e3_6373) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
        %lay_6374 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc424)
        %2359 = cute.get_shape(%lay_6374) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %e0_6375, %e1_6376, %e2_6377, %e3_6378 = cute.get_leaves(%2359) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %itup_6379 = cute.to_int_tuple(%e0_6375) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2360 = cute.get_scalars(%itup_6379) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6380 = cute.to_int_tuple(%e1_6376) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2361 = cute.get_scalars(%itup_6380) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6381 = cute.to_int_tuple(%e2_6377) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2362 = cute.get_scalars(%itup_6381) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6382 = cute.to_int_tuple(%e3_6378) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %2363 = cute.get_scalars(%itup_6382) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %coord_6383 = cute.make_coord(%e1_6371) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %coord_6384 = cute.make_coord(%itup_6380) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %2364 = cute.elem_less(%coord_6383, %coord_6384) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
        scf.if %2364 {
          %coord_6469 = cute.make_coord(%474) : (i32) -> !cute.coord<"(_,0,_,?)"> loc(#loc426)
          %slice_6470 = cute.slice(%src_partitioned_242, %coord_6469) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)"> loc(#loc426)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc317)
          %coord_6473 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc427)
          %slice_6474 = cute.slice(%dst_partitioned_245, %coord_6473) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc427)
          %iter_6475 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6476 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc317)
          %coord_6477 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc428)
          %slice_6478 = cute.slice(%rmem_448, %coord_6477) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)"> loc(#loc428)
          %iter_6479 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc316)
          %iter_6480 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc317)
          %lay_6481 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc311)
          %2419 = cute.get_shape(%lay_6481) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6482, %e1_6483, %e2_6484 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6485 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc311)
          %2420 = cute.get_shape(%lay_6485) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6486, %e1_6487, %e2_6488 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6489 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc397)
          %shape_6490 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6491 = cute.make_layout(%shape_6490) : !cute.layout<"1:0"> loc(#loc397)
          %append_6492 = cute.append_to_rank<2> (%lay_6489, %lay_6491) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6493 = cute.make_view(%iter_6472, %append_6492) : !memref_gmem_bf16_6 loc(#loc398)
          %iter_6494 = cute.get_iter(%view_6493) : !memref_gmem_bf16_6 loc(#loc331)
          %lay_6495 = cute.get_layout(%view_6493) : !memref_gmem_bf16_6 loc(#loc311)
          %2421 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6496, %e1_6497, %e2_6498 = cute.get_leaves(%2421) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6499 = cute.group_modes(%view_6493) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
          %iter_6500 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc399)
          %iter_6501 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc317)
          %lay_6502 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc397)
          %shape_6503 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6504 = cute.make_layout(%shape_6503) : !cute.layout<"1:0"> loc(#loc397)
          %append_6505 = cute.append_to_rank<2> (%lay_6502, %lay_6504) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6506 = cute.make_view(%iter_6476, %append_6505) : !memref_smem_bf16_13 loc(#loc400)
          %iter_6507 = cute.get_iter(%view_6506) : !memref_smem_bf16_13 loc(#loc331)
          %lay_6508 = cute.get_layout(%view_6506) : !memref_smem_bf16_13 loc(#loc311)
          %2422 = cute.get_shape(%lay_6508) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6509, %e1_6510, %e2_6511 = cute.get_leaves(%2422) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6512 = cute.group_modes(%view_6506) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
          %iter_6513 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc399)
          %iter_6514 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc317)
          %lay_6515 = cute.get_layout(%slice_6478) : !memref_rmem_i8_2 loc(#loc397)
          %shape_6516 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6517 = cute.make_layout(%shape_6516) : !cute.layout<"1:0"> loc(#loc397)
          %append_6518 = cute.append_to_rank<2> (%lay_6515, %lay_6517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6519 = cute.make_view(%iter_6480, %append_6518) : !memref_rmem_i8_2 loc(#loc401)
          %iter_6520 = cute.get_iter(%view_6519) : !memref_rmem_i8_2 loc(#loc331)
          %lay_6521 = cute.get_layout(%view_6519) : !memref_rmem_i8_2 loc(#loc311)
          %2423 = cute.get_shape(%lay_6521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
          %e0_6522, %e1_6523 = cute.get_leaves(%2423) : !cute.shape<"(1,2)"> loc(#loc311)
          %grouped_6524 = cute.group_modes(%view_6519) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
          %iter_6525 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc399)
          %iter_6526 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc317)
          %lay_6527 = cute.get_layout(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc311)
          %2424 = cute.get_shape(%lay_6527) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6528, %e1_6529, %e2_6530 = cute.get_leaves(%2424) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %lay_6531 = cute.get_layout(%grouped_6512) : !memref_smem_bf16_14 loc(#loc311)
          %2425 = cute.get_shape(%lay_6531) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6532, %e1_6533, %e2_6534 = cute.get_leaves(%2425) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %sz_6535 = cute.size(%grouped_6499) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6536 = cute.get_leaves(%sz_6535) : !cute.int_tuple<"2"> loc(#loc402)
          %sz_6537 = cute.size(%grouped_6512) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6538 = cute.get_leaves(%sz_6537) : !cute.int_tuple<"2"> loc(#loc402)
          cute.copy(%arg8, %grouped_6499, %grouped_6512, %grouped_6524) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
        } else {
          %coord_6469 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc430)
          %slice_6470 = cute.slice(%dst_partitioned_245, %coord_6469) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc430)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc317)
          %sz_6473 = cute.size(%slice_6470) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6474 = cute.get_leaves(%sz_6473) : !cute.int_tuple<"16"> loc(#loc430)
          %lay_6475 = cute.get_layout(%slice_6470) : !memref_smem_bf16_13 loc(#loc311)
          %2419 = cute.get_shape(%lay_6475) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6476, %e1_6477, %e2_6478 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %int_tuple_6479 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %res_6480 = cute.tuple.product(%int_tuple_6479) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6481 = cute.get_leaves(%res_6480) : !cute.int_tuple<"16"> loc(#loc430)
          %cst_6482 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
          %2420 = vector.splat %cst_6482 : vector<16xbf16> loc(#loc430)
          %int_tuple_6483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6484 = cute.size(%int_tuple_6483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6485 = cute.get_leaves(%sz_6484) : !cute.int_tuple<"16"> loc(#loc430)
          %int_tuple_6486 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6487 = cute.size(%int_tuple_6486) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6488 = cute.get_leaves(%sz_6487) : !cute.int_tuple<"16"> loc(#loc430)
          cute.memref.store_vec %2420, %slice_6470 : !memref_smem_bf16_13 loc(#loc430)
        } loc(#loc290)
        %coord_6385 = cute.make_coord() : () -> !cute.coord<"(0,1,0)"> loc(#loc423)
        %slice_6386 = cute.slice(%src_partitioned_411, %coord_6385) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)"> loc(#loc423)
        %iter_6387 = cute.get_iter(%slice_6386) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
        %e0_6388, %e1_6389, %e2_6390, %e3_6391 = cute.get_leaves(%iter_6387) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2365 = cute.get_scalars(%e0_6388) : !cute.int_tuple<"?"> loc(#loc290)
        %2366 = cute.get_scalars(%e1_6389) : !cute.int_tuple<"?"> loc(#loc290)
        %2367 = cute.get_scalars(%e2_6390) : !cute.int_tuple<"?"> loc(#loc290)
        %2368 = cute.get_scalars(%e3_6391) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6392 = cute.get_iter(%slice_6386) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
        %e0_6393, %e1_6394, %e2_6395, %e3_6396 = cute.get_leaves(%iter_6392) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2369 = cute.get_scalars(%e0_6393) : !cute.int_tuple<"?"> loc(#loc290)
        %2370 = cute.get_scalars(%e1_6394) : !cute.int_tuple<"?"> loc(#loc290)
        %2371 = cute.get_scalars(%e2_6395) : !cute.int_tuple<"?"> loc(#loc290)
        %2372 = cute.get_scalars(%e3_6396) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6397 = cute.get_iter(%slice_6386) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
        %e0_6398, %e1_6399, %e2_6400, %e3_6401 = cute.get_leaves(%iter_6397) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
        %2373 = cute.get_scalars(%e0_6398) : !cute.int_tuple<"?"> loc(#loc423)
        %2374 = cute.get_scalars(%e1_6399) : !cute.int_tuple<"?"> loc(#loc423)
        %2375 = cute.get_scalars(%e2_6400) : !cute.int_tuple<"?"> loc(#loc423)
        %2376 = cute.get_scalars(%e3_6401) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
        %lay_6402 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc424)
        %2377 = cute.get_shape(%lay_6402) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %e0_6403, %e1_6404, %e2_6405, %e3_6406 = cute.get_leaves(%2377) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %itup_6407 = cute.to_int_tuple(%e0_6403) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2378 = cute.get_scalars(%itup_6407) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6408 = cute.to_int_tuple(%e1_6404) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2379 = cute.get_scalars(%itup_6408) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6409 = cute.to_int_tuple(%e2_6405) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2380 = cute.get_scalars(%itup_6409) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6410 = cute.to_int_tuple(%e3_6406) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %2381 = cute.get_scalars(%itup_6410) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %coord_6411 = cute.make_coord(%e1_6399) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %coord_6412 = cute.make_coord(%itup_6408) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %2382 = cute.elem_less(%coord_6411, %coord_6412) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
        scf.if %2382 {
          %coord_6469 = cute.make_coord(%474) : (i32) -> !cute.coord<"(_,1,_,?)"> loc(#loc426)
          %slice_6470 = cute.slice(%src_partitioned_242, %coord_6469) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)"> loc(#loc426)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc317)
          %coord_6473 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc427)
          %slice_6474 = cute.slice(%dst_partitioned_245, %coord_6473) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc427)
          %iter_6475 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6476 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc317)
          %coord_6477 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc428)
          %slice_6478 = cute.slice(%rmem_448, %coord_6477) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)"> loc(#loc428)
          %iter_6479 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc316)
          %iter_6480 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc317)
          %lay_6481 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc311)
          %2419 = cute.get_shape(%lay_6481) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6482, %e1_6483, %e2_6484 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6485 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc311)
          %2420 = cute.get_shape(%lay_6485) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6486, %e1_6487, %e2_6488 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6489 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc397)
          %shape_6490 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6491 = cute.make_layout(%shape_6490) : !cute.layout<"1:0"> loc(#loc397)
          %append_6492 = cute.append_to_rank<2> (%lay_6489, %lay_6491) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6493 = cute.make_view(%iter_6472, %append_6492) : !memref_gmem_bf16_6 loc(#loc398)
          %iter_6494 = cute.get_iter(%view_6493) : !memref_gmem_bf16_6 loc(#loc331)
          %lay_6495 = cute.get_layout(%view_6493) : !memref_gmem_bf16_6 loc(#loc311)
          %2421 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6496, %e1_6497, %e2_6498 = cute.get_leaves(%2421) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6499 = cute.group_modes(%view_6493) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
          %iter_6500 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc399)
          %iter_6501 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc317)
          %lay_6502 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc397)
          %shape_6503 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6504 = cute.make_layout(%shape_6503) : !cute.layout<"1:0"> loc(#loc397)
          %append_6505 = cute.append_to_rank<2> (%lay_6502, %lay_6504) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6506 = cute.make_view(%iter_6476, %append_6505) : !memref_smem_bf16_13 loc(#loc400)
          %iter_6507 = cute.get_iter(%view_6506) : !memref_smem_bf16_13 loc(#loc331)
          %lay_6508 = cute.get_layout(%view_6506) : !memref_smem_bf16_13 loc(#loc311)
          %2422 = cute.get_shape(%lay_6508) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6509, %e1_6510, %e2_6511 = cute.get_leaves(%2422) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6512 = cute.group_modes(%view_6506) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
          %iter_6513 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc399)
          %iter_6514 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc317)
          %lay_6515 = cute.get_layout(%slice_6478) : !memref_rmem_i8_2 loc(#loc397)
          %shape_6516 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6517 = cute.make_layout(%shape_6516) : !cute.layout<"1:0"> loc(#loc397)
          %append_6518 = cute.append_to_rank<2> (%lay_6515, %lay_6517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6519 = cute.make_view(%iter_6480, %append_6518) : !memref_rmem_i8_2 loc(#loc401)
          %iter_6520 = cute.get_iter(%view_6519) : !memref_rmem_i8_2 loc(#loc331)
          %lay_6521 = cute.get_layout(%view_6519) : !memref_rmem_i8_2 loc(#loc311)
          %2423 = cute.get_shape(%lay_6521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
          %e0_6522, %e1_6523 = cute.get_leaves(%2423) : !cute.shape<"(1,2)"> loc(#loc311)
          %grouped_6524 = cute.group_modes(%view_6519) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
          %iter_6525 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc399)
          %iter_6526 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc317)
          %lay_6527 = cute.get_layout(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc311)
          %2424 = cute.get_shape(%lay_6527) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6528, %e1_6529, %e2_6530 = cute.get_leaves(%2424) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %lay_6531 = cute.get_layout(%grouped_6512) : !memref_smem_bf16_14 loc(#loc311)
          %2425 = cute.get_shape(%lay_6531) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6532, %e1_6533, %e2_6534 = cute.get_leaves(%2425) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %sz_6535 = cute.size(%grouped_6499) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6536 = cute.get_leaves(%sz_6535) : !cute.int_tuple<"2"> loc(#loc402)
          %sz_6537 = cute.size(%grouped_6512) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6538 = cute.get_leaves(%sz_6537) : !cute.int_tuple<"2"> loc(#loc402)
          cute.copy(%arg8, %grouped_6499, %grouped_6512, %grouped_6524) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
        } else {
          %coord_6469 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc430)
          %slice_6470 = cute.slice(%dst_partitioned_245, %coord_6469) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc430)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc317)
          %sz_6473 = cute.size(%slice_6470) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6474 = cute.get_leaves(%sz_6473) : !cute.int_tuple<"16"> loc(#loc430)
          %lay_6475 = cute.get_layout(%slice_6470) : !memref_smem_bf16_13 loc(#loc311)
          %2419 = cute.get_shape(%lay_6475) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6476, %e1_6477, %e2_6478 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %int_tuple_6479 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %res_6480 = cute.tuple.product(%int_tuple_6479) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6481 = cute.get_leaves(%res_6480) : !cute.int_tuple<"16"> loc(#loc430)
          %cst_6482 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
          %2420 = vector.splat %cst_6482 : vector<16xbf16> loc(#loc430)
          %int_tuple_6483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6484 = cute.size(%int_tuple_6483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6485 = cute.get_leaves(%sz_6484) : !cute.int_tuple<"16"> loc(#loc430)
          %int_tuple_6486 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6487 = cute.size(%int_tuple_6486) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6488 = cute.get_leaves(%sz_6487) : !cute.int_tuple<"16"> loc(#loc430)
          cute.memref.store_vec %2420, %slice_6470 : !memref_smem_bf16_13 loc(#loc430)
        } loc(#loc290)
        %coord_6413 = cute.make_coord() : () -> !cute.coord<"(0,2,0)"> loc(#loc423)
        %slice_6414 = cute.slice(%src_partitioned_411, %coord_6413) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)"> loc(#loc423)
        %iter_6415 = cute.get_iter(%slice_6414) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
        %e0_6416, %e1_6417, %e2_6418, %e3_6419 = cute.get_leaves(%iter_6415) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2383 = cute.get_scalars(%e0_6416) : !cute.int_tuple<"?"> loc(#loc290)
        %2384 = cute.get_scalars(%e1_6417) : !cute.int_tuple<"?"> loc(#loc290)
        %2385 = cute.get_scalars(%e2_6418) : !cute.int_tuple<"?"> loc(#loc290)
        %2386 = cute.get_scalars(%e3_6419) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6420 = cute.get_iter(%slice_6414) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
        %e0_6421, %e1_6422, %e2_6423, %e3_6424 = cute.get_leaves(%iter_6420) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2387 = cute.get_scalars(%e0_6421) : !cute.int_tuple<"?"> loc(#loc290)
        %2388 = cute.get_scalars(%e1_6422) : !cute.int_tuple<"?"> loc(#loc290)
        %2389 = cute.get_scalars(%e2_6423) : !cute.int_tuple<"?"> loc(#loc290)
        %2390 = cute.get_scalars(%e3_6424) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6425 = cute.get_iter(%slice_6414) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
        %e0_6426, %e1_6427, %e2_6428, %e3_6429 = cute.get_leaves(%iter_6425) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
        %2391 = cute.get_scalars(%e0_6426) : !cute.int_tuple<"?"> loc(#loc423)
        %2392 = cute.get_scalars(%e1_6427) : !cute.int_tuple<"?"> loc(#loc423)
        %2393 = cute.get_scalars(%e2_6428) : !cute.int_tuple<"?"> loc(#loc423)
        %2394 = cute.get_scalars(%e3_6429) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
        %lay_6430 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc424)
        %2395 = cute.get_shape(%lay_6430) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %e0_6431, %e1_6432, %e2_6433, %e3_6434 = cute.get_leaves(%2395) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %itup_6435 = cute.to_int_tuple(%e0_6431) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2396 = cute.get_scalars(%itup_6435) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6436 = cute.to_int_tuple(%e1_6432) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2397 = cute.get_scalars(%itup_6436) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6437 = cute.to_int_tuple(%e2_6433) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2398 = cute.get_scalars(%itup_6437) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6438 = cute.to_int_tuple(%e3_6434) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %2399 = cute.get_scalars(%itup_6438) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %coord_6439 = cute.make_coord(%e1_6427) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %coord_6440 = cute.make_coord(%itup_6436) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %2400 = cute.elem_less(%coord_6439, %coord_6440) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
        scf.if %2400 {
          %coord_6469 = cute.make_coord(%474) : (i32) -> !cute.coord<"(_,2,_,?)"> loc(#loc426)
          %slice_6470 = cute.slice(%src_partitioned_242, %coord_6469) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)"> loc(#loc426)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc317)
          %coord_6473 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc427)
          %slice_6474 = cute.slice(%dst_partitioned_245, %coord_6473) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc427)
          %iter_6475 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6476 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc317)
          %coord_6477 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc428)
          %slice_6478 = cute.slice(%rmem_448, %coord_6477) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)"> loc(#loc428)
          %iter_6479 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc316)
          %iter_6480 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc317)
          %lay_6481 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc311)
          %2419 = cute.get_shape(%lay_6481) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6482, %e1_6483, %e2_6484 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6485 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc311)
          %2420 = cute.get_shape(%lay_6485) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6486, %e1_6487, %e2_6488 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6489 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc397)
          %shape_6490 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6491 = cute.make_layout(%shape_6490) : !cute.layout<"1:0"> loc(#loc397)
          %append_6492 = cute.append_to_rank<2> (%lay_6489, %lay_6491) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6493 = cute.make_view(%iter_6472, %append_6492) : !memref_gmem_bf16_6 loc(#loc398)
          %iter_6494 = cute.get_iter(%view_6493) : !memref_gmem_bf16_6 loc(#loc331)
          %lay_6495 = cute.get_layout(%view_6493) : !memref_gmem_bf16_6 loc(#loc311)
          %2421 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6496, %e1_6497, %e2_6498 = cute.get_leaves(%2421) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6499 = cute.group_modes(%view_6493) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
          %iter_6500 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc399)
          %iter_6501 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc317)
          %lay_6502 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc397)
          %shape_6503 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6504 = cute.make_layout(%shape_6503) : !cute.layout<"1:0"> loc(#loc397)
          %append_6505 = cute.append_to_rank<2> (%lay_6502, %lay_6504) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6506 = cute.make_view(%iter_6476, %append_6505) : !memref_smem_bf16_13 loc(#loc400)
          %iter_6507 = cute.get_iter(%view_6506) : !memref_smem_bf16_13 loc(#loc331)
          %lay_6508 = cute.get_layout(%view_6506) : !memref_smem_bf16_13 loc(#loc311)
          %2422 = cute.get_shape(%lay_6508) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6509, %e1_6510, %e2_6511 = cute.get_leaves(%2422) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6512 = cute.group_modes(%view_6506) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
          %iter_6513 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc399)
          %iter_6514 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc317)
          %lay_6515 = cute.get_layout(%slice_6478) : !memref_rmem_i8_2 loc(#loc397)
          %shape_6516 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6517 = cute.make_layout(%shape_6516) : !cute.layout<"1:0"> loc(#loc397)
          %append_6518 = cute.append_to_rank<2> (%lay_6515, %lay_6517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6519 = cute.make_view(%iter_6480, %append_6518) : !memref_rmem_i8_2 loc(#loc401)
          %iter_6520 = cute.get_iter(%view_6519) : !memref_rmem_i8_2 loc(#loc331)
          %lay_6521 = cute.get_layout(%view_6519) : !memref_rmem_i8_2 loc(#loc311)
          %2423 = cute.get_shape(%lay_6521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
          %e0_6522, %e1_6523 = cute.get_leaves(%2423) : !cute.shape<"(1,2)"> loc(#loc311)
          %grouped_6524 = cute.group_modes(%view_6519) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
          %iter_6525 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc399)
          %iter_6526 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc317)
          %lay_6527 = cute.get_layout(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc311)
          %2424 = cute.get_shape(%lay_6527) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6528, %e1_6529, %e2_6530 = cute.get_leaves(%2424) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %lay_6531 = cute.get_layout(%grouped_6512) : !memref_smem_bf16_14 loc(#loc311)
          %2425 = cute.get_shape(%lay_6531) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6532, %e1_6533, %e2_6534 = cute.get_leaves(%2425) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %sz_6535 = cute.size(%grouped_6499) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6536 = cute.get_leaves(%sz_6535) : !cute.int_tuple<"2"> loc(#loc402)
          %sz_6537 = cute.size(%grouped_6512) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6538 = cute.get_leaves(%sz_6537) : !cute.int_tuple<"2"> loc(#loc402)
          cute.copy(%arg8, %grouped_6499, %grouped_6512, %grouped_6524) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
        } else {
          %coord_6469 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc430)
          %slice_6470 = cute.slice(%dst_partitioned_245, %coord_6469) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc430)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc317)
          %sz_6473 = cute.size(%slice_6470) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6474 = cute.get_leaves(%sz_6473) : !cute.int_tuple<"16"> loc(#loc430)
          %lay_6475 = cute.get_layout(%slice_6470) : !memref_smem_bf16_13 loc(#loc311)
          %2419 = cute.get_shape(%lay_6475) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6476, %e1_6477, %e2_6478 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %int_tuple_6479 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %res_6480 = cute.tuple.product(%int_tuple_6479) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6481 = cute.get_leaves(%res_6480) : !cute.int_tuple<"16"> loc(#loc430)
          %cst_6482 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
          %2420 = vector.splat %cst_6482 : vector<16xbf16> loc(#loc430)
          %int_tuple_6483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6484 = cute.size(%int_tuple_6483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6485 = cute.get_leaves(%sz_6484) : !cute.int_tuple<"16"> loc(#loc430)
          %int_tuple_6486 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6487 = cute.size(%int_tuple_6486) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6488 = cute.get_leaves(%sz_6487) : !cute.int_tuple<"16"> loc(#loc430)
          cute.memref.store_vec %2420, %slice_6470 : !memref_smem_bf16_13 loc(#loc430)
        } loc(#loc290)
        %coord_6441 = cute.make_coord() : () -> !cute.coord<"(0,3,0)"> loc(#loc423)
        %slice_6442 = cute.slice(%src_partitioned_411, %coord_6441) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)"> loc(#loc423)
        %iter_6443 = cute.get_iter(%slice_6442) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
        %e0_6444, %e1_6445, %e2_6446, %e3_6447 = cute.get_leaves(%iter_6443) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2401 = cute.get_scalars(%e0_6444) : !cute.int_tuple<"?"> loc(#loc290)
        %2402 = cute.get_scalars(%e1_6445) : !cute.int_tuple<"?"> loc(#loc290)
        %2403 = cute.get_scalars(%e2_6446) : !cute.int_tuple<"?"> loc(#loc290)
        %2404 = cute.get_scalars(%e3_6447) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6448 = cute.get_iter(%slice_6442) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
        %e0_6449, %e1_6450, %e2_6451, %e3_6452 = cute.get_leaves(%iter_6448) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
        %2405 = cute.get_scalars(%e0_6449) : !cute.int_tuple<"?"> loc(#loc290)
        %2406 = cute.get_scalars(%e1_6450) : !cute.int_tuple<"?"> loc(#loc290)
        %2407 = cute.get_scalars(%e2_6451) : !cute.int_tuple<"?"> loc(#loc290)
        %2408 = cute.get_scalars(%e3_6452) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
        %iter_6453 = cute.get_iter(%slice_6442) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
        %e0_6454, %e1_6455, %e2_6456, %e3_6457 = cute.get_leaves(%iter_6453) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
        %2409 = cute.get_scalars(%e0_6454) : !cute.int_tuple<"?"> loc(#loc423)
        %2410 = cute.get_scalars(%e1_6455) : !cute.int_tuple<"?"> loc(#loc423)
        %2411 = cute.get_scalars(%e2_6456) : !cute.int_tuple<"?"> loc(#loc423)
        %2412 = cute.get_scalars(%e3_6457) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
        %lay_6458 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc424)
        %2413 = cute.get_shape(%lay_6458) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %e0_6459, %e1_6460, %e2_6461, %e3_6462 = cute.get_leaves(%2413) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
        %itup_6463 = cute.to_int_tuple(%e0_6459) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2414 = cute.get_scalars(%itup_6463) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6464 = cute.to_int_tuple(%e1_6460) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2415 = cute.get_scalars(%itup_6464) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6465 = cute.to_int_tuple(%e2_6461) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
        %2416 = cute.get_scalars(%itup_6465) : !cute.int_tuple<"?"> loc(#loc424)
        %itup_6466 = cute.to_int_tuple(%e3_6462) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %2417 = cute.get_scalars(%itup_6466) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
        %coord_6467 = cute.make_coord(%e1_6455) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %coord_6468 = cute.make_coord(%itup_6464) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
        %2418 = cute.elem_less(%coord_6467, %coord_6468) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
        scf.if %2418 {
          %coord_6469 = cute.make_coord(%474) : (i32) -> !cute.coord<"(_,3,_,?)"> loc(#loc426)
          %slice_6470 = cute.slice(%src_partitioned_242, %coord_6469) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)"> loc(#loc426)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_gmem_bf16_6 loc(#loc317)
          %coord_6473 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc427)
          %slice_6474 = cute.slice(%dst_partitioned_245, %coord_6473) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc427)
          %iter_6475 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6476 = cute.get_iter(%slice_6474) : !memref_smem_bf16_13 loc(#loc317)
          %coord_6477 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc428)
          %slice_6478 = cute.slice(%rmem_448, %coord_6477) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)"> loc(#loc428)
          %iter_6479 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc316)
          %iter_6480 = cute.get_iter(%slice_6478) : !memref_rmem_i8_2 loc(#loc317)
          %lay_6481 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc311)
          %2419 = cute.get_shape(%lay_6481) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6482, %e1_6483, %e2_6484 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6485 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc311)
          %2420 = cute.get_shape(%lay_6485) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6486, %e1_6487, %e2_6488 = cute.get_leaves(%2420) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %lay_6489 = cute.get_layout(%slice_6470) : !memref_gmem_bf16_6 loc(#loc397)
          %shape_6490 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6491 = cute.make_layout(%shape_6490) : !cute.layout<"1:0"> loc(#loc397)
          %append_6492 = cute.append_to_rank<2> (%lay_6489, %lay_6491) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6493 = cute.make_view(%iter_6472, %append_6492) : !memref_gmem_bf16_6 loc(#loc398)
          %iter_6494 = cute.get_iter(%view_6493) : !memref_gmem_bf16_6 loc(#loc331)
          %lay_6495 = cute.get_layout(%view_6493) : !memref_gmem_bf16_6 loc(#loc311)
          %2421 = cute.get_shape(%lay_6495) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6496, %e1_6497, %e2_6498 = cute.get_leaves(%2421) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6499 = cute.group_modes(%view_6493) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
          %iter_6500 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc399)
          %iter_6501 = cute.get_iter(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc317)
          %lay_6502 = cute.get_layout(%slice_6474) : !memref_smem_bf16_13 loc(#loc397)
          %shape_6503 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6504 = cute.make_layout(%shape_6503) : !cute.layout<"1:0"> loc(#loc397)
          %append_6505 = cute.append_to_rank<2> (%lay_6502, %lay_6504) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6506 = cute.make_view(%iter_6476, %append_6505) : !memref_smem_bf16_13 loc(#loc400)
          %iter_6507 = cute.get_iter(%view_6506) : !memref_smem_bf16_13 loc(#loc331)
          %lay_6508 = cute.get_layout(%view_6506) : !memref_smem_bf16_13 loc(#loc311)
          %2422 = cute.get_shape(%lay_6508) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6509, %e1_6510, %e2_6511 = cute.get_leaves(%2422) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %grouped_6512 = cute.group_modes(%view_6506) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
          %iter_6513 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc399)
          %iter_6514 = cute.get_iter(%grouped_6512) : !memref_smem_bf16_14 loc(#loc317)
          %lay_6515 = cute.get_layout(%slice_6478) : !memref_rmem_i8_2 loc(#loc397)
          %shape_6516 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_6517 = cute.make_layout(%shape_6516) : !cute.layout<"1:0"> loc(#loc397)
          %append_6518 = cute.append_to_rank<2> (%lay_6515, %lay_6517) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_6519 = cute.make_view(%iter_6480, %append_6518) : !memref_rmem_i8_2 loc(#loc401)
          %iter_6520 = cute.get_iter(%view_6519) : !memref_rmem_i8_2 loc(#loc331)
          %lay_6521 = cute.get_layout(%view_6519) : !memref_rmem_i8_2 loc(#loc311)
          %2423 = cute.get_shape(%lay_6521) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
          %e0_6522, %e1_6523 = cute.get_leaves(%2423) : !cute.shape<"(1,2)"> loc(#loc311)
          %grouped_6524 = cute.group_modes(%view_6519) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
          %iter_6525 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc399)
          %iter_6526 = cute.get_iter(%grouped_6524) : !memref_rmem_i8_3 loc(#loc317)
          %lay_6527 = cute.get_layout(%grouped_6499) : !memref_gmem_bf16_7 loc(#loc311)
          %2424 = cute.get_shape(%lay_6527) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6528, %e1_6529, %e2_6530 = cute.get_leaves(%2424) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %lay_6531 = cute.get_layout(%grouped_6512) : !memref_smem_bf16_14 loc(#loc311)
          %2425 = cute.get_shape(%lay_6531) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
          %e0_6532, %e1_6533, %e2_6534 = cute.get_leaves(%2425) : !cute.shape<"((8,1),(2))"> loc(#loc311)
          %sz_6535 = cute.size(%grouped_6499) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6536 = cute.get_leaves(%sz_6535) : !cute.int_tuple<"2"> loc(#loc402)
          %sz_6537 = cute.size(%grouped_6512) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
          %e0_6538 = cute.get_leaves(%sz_6537) : !cute.int_tuple<"2"> loc(#loc402)
          cute.copy(%arg8, %grouped_6499, %grouped_6512, %grouped_6524) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
        } else {
          %coord_6469 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc430)
          %slice_6470 = cute.slice(%dst_partitioned_245, %coord_6469) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc430)
          %iter_6471 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc316)
          %iter_6472 = cute.get_iter(%slice_6470) : !memref_smem_bf16_13 loc(#loc317)
          %sz_6473 = cute.size(%slice_6470) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6474 = cute.get_leaves(%sz_6473) : !cute.int_tuple<"16"> loc(#loc430)
          %lay_6475 = cute.get_layout(%slice_6470) : !memref_smem_bf16_13 loc(#loc311)
          %2419 = cute.get_shape(%lay_6475) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
          %e0_6476, %e1_6477, %e2_6478 = cute.get_leaves(%2419) : !cute.shape<"((8,1),2)"> loc(#loc311)
          %int_tuple_6479 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %res_6480 = cute.tuple.product(%int_tuple_6479) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6481 = cute.get_leaves(%res_6480) : !cute.int_tuple<"16"> loc(#loc430)
          %cst_6482 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
          %2420 = vector.splat %cst_6482 : vector<16xbf16> loc(#loc430)
          %int_tuple_6483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6484 = cute.size(%int_tuple_6483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6485 = cute.get_leaves(%sz_6484) : !cute.int_tuple<"16"> loc(#loc430)
          %int_tuple_6486 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
          %sz_6487 = cute.size(%int_tuple_6486) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
          %e0_6488 = cute.get_leaves(%sz_6487) : !cute.int_tuple<"16"> loc(#loc430)
          cute.memref.store_vec %2420, %slice_6470 : !memref_smem_bf16_13 loc(#loc430)
        } loc(#loc290)
      } else {
        %coord_6349 = cute.make_coord(%474) : (i32) -> !cute.coord<"(_,_,_,?)"> loc(#loc431)
        %slice_6350 = cute.slice(%src_partitioned_242, %coord_6349) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)"> loc(#loc431)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_8 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_gmem_bf16_8 loc(#loc317)
        %lay_6353 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_8 loc(#loc311)
        %2346 = cute.get_shape(%lay_6353) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6354, %e1_6355, %e2_6356, %e3_6357 = cute.get_leaves(%2346) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %lay_6358 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc311)
        %2347 = cute.get_shape(%lay_6358) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6359, %e1_6360, %e2_6361, %e3_6362 = cute.get_leaves(%2347) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %lay_6363 = cute.get_layout(%slice_6350) : !memref_gmem_bf16_8 loc(#loc397)
        %shape_6364 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6365 = cute.make_layout(%shape_6364) : !cute.layout<"1:0"> loc(#loc397)
        %append_6366 = cute.append_to_rank<2> (%lay_6363, %lay_6365) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6367 = cute.make_view(%iter_6352, %append_6366) : !memref_gmem_bf16_8 loc(#loc398)
        %iter_6368 = cute.get_iter(%view_6367) : !memref_gmem_bf16_8 loc(#loc331)
        %lay_6369 = cute.get_layout(%view_6367) : !memref_gmem_bf16_8 loc(#loc311)
        %2348 = cute.get_shape(%lay_6369) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6370, %e1_6371, %e2_6372, %e3_6373 = cute.get_leaves(%2348) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %grouped_6374 = cute.group_modes(%view_6367) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9 loc(#loc398)
        %iter_6375 = cute.get_iter(%grouped_6374) : !memref_gmem_bf16_9 loc(#loc399)
        %iter_6376 = cute.get_iter(%grouped_6374) : !memref_gmem_bf16_9 loc(#loc317)
        %lay_6377 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc397)
        %shape_6378 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6379 = cute.make_layout(%shape_6378) : !cute.layout<"1:0"> loc(#loc397)
        %append_6380 = cute.append_to_rank<2> (%lay_6377, %lay_6379) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6381 = cute.make_view(%iter_246, %append_6380) : !memref_smem_bf16_4 loc(#loc400)
        %iter_6382 = cute.get_iter(%view_6381) : !memref_smem_bf16_4 loc(#loc331)
        %lay_6383 = cute.get_layout(%view_6381) : !memref_smem_bf16_4 loc(#loc311)
        %2349 = cute.get_shape(%lay_6383) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6384, %e1_6385, %e2_6386, %e3_6387 = cute.get_leaves(%2349) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %grouped_6388 = cute.group_modes(%view_6381) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15 loc(#loc400)
        %iter_6389 = cute.get_iter(%grouped_6388) : !memref_smem_bf16_15 loc(#loc399)
        %iter_6390 = cute.get_iter(%grouped_6388) : !memref_smem_bf16_15 loc(#loc317)
        %lay_6391 = cute.get_layout(%rmem_448) : !memref_rmem_i8_1 loc(#loc397)
        %shape_6392 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6393 = cute.make_layout(%shape_6392) : !cute.layout<"1:0"> loc(#loc397)
        %append_6394 = cute.append_to_rank<2> (%lay_6391, %lay_6393) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6395 = cute.make_view(%iter_450, %append_6394) : !memref_rmem_i8_1 loc(#loc401)
        %iter_6396 = cute.get_iter(%view_6395) : !memref_rmem_i8_1 loc(#loc331)
        %lay_6397 = cute.get_layout(%view_6395) : !memref_rmem_i8_1 loc(#loc311)
        %2350 = cute.get_shape(%lay_6397) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)"> loc(#loc311)
        %e0_6398, %e1_6399, %e2_6400 = cute.get_leaves(%2350) : !cute.shape<"(1,4,2)"> loc(#loc311)
        %grouped_6401 = cute.group_modes(%view_6395) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4 loc(#loc401)
        %iter_6402 = cute.get_iter(%grouped_6401) : !memref_rmem_i8_4 loc(#loc399)
        %iter_6403 = cute.get_iter(%grouped_6401) : !memref_rmem_i8_4 loc(#loc317)
        %lay_6404 = cute.get_layout(%grouped_6374) : !memref_gmem_bf16_9 loc(#loc311)
        %2351 = cute.get_shape(%lay_6404) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_6405, %e1_6406, %e2_6407, %e3_6408 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_6409 = cute.get_layout(%grouped_6388) : !memref_smem_bf16_15 loc(#loc311)
        %2352 = cute.get_shape(%lay_6409) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_6410, %e1_6411, %e2_6412, %e3_6413 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %sz_6414 = cute.size(%grouped_6374) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_6415 = cute.get_leaves(%sz_6414) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_6416 = cute.size(%grouped_6388) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_6417 = cute.get_leaves(%sz_6416) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%arg8, %grouped_6374, %grouped_6388, %grouped_6401) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4) loc(#loc432)
      } loc(#loc290)
      nvvm.cp.async.commit.group loc(#loc433)
      %coord_977 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc434)
      %slice_978 = cute.slice(%src_partitioned_320, %coord_977) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)"> loc(#loc434)
      %iter_979 = cute.get_iter(%slice_978) : !memref_smem_bf16_13 loc(#loc316)
      %iter_980 = cute.get_iter(%slice_978) : !memref_smem_bf16_13 loc(#loc317)
      %coord_981 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc435)
      %slice_982 = cute.slice(%retiled, %coord_981) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)"> loc(#loc435)
      %iter_983 = cute.get_iter(%slice_982) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_984 = cute.get_iter(%slice_982) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_985 = cute.get_layout(%slice_978) : !memref_smem_bf16_13 loc(#loc311)
      %478 = cute.get_shape(%lay_985) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_986, %e1_987, %e2_988 = cute.get_leaves(%478) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_989 = cute.get_layout(%slice_982) : !memref_rmem_bf16_6 loc(#loc311)
      %479 = cute.get_shape(%lay_989) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_990, %e1_991, %e2_992 = cute.get_leaves(%479) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_993 = cute.get_layout(%slice_978) : !memref_smem_bf16_13 loc(#loc397)
      %shape_994 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_995 = cute.make_layout(%shape_994) : !cute.layout<"1:0"> loc(#loc397)
      %append = cute.append_to_rank<2> (%lay_993, %lay_995) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_996 = cute.make_view(%iter_980, %append) : !memref_smem_bf16_13 loc(#loc398)
      %iter_997 = cute.get_iter(%view_996) : !memref_smem_bf16_13 loc(#loc331)
      %lay_998 = cute.get_layout(%view_996) : !memref_smem_bf16_13 loc(#loc311)
      %480 = cute.get_shape(%lay_998) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_999, %e1_1000, %e2_1001 = cute.get_leaves(%480) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped = cute.group_modes(%view_996) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1002 = cute.get_iter(%grouped) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1003 = cute.get_iter(%grouped) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1004 = cute.get_layout(%slice_982) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1005 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1006 = cute.make_layout(%shape_1005) : !cute.layout<"1:0"> loc(#loc397)
      %append_1007 = cute.append_to_rank<2> (%lay_1004, %lay_1006) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1008 = cute.make_view(%iter_984, %append_1007) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1009 = cute.get_iter(%view_1008) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1010 = cute.get_layout(%view_1008) : !memref_rmem_bf16_6 loc(#loc311)
      %481 = cute.get_shape(%lay_1010) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1011, %e1_1012, %e2_1013 = cute.get_leaves(%481) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1014 = cute.group_modes(%view_1008) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1015 = cute.get_iter(%grouped_1014) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1016 = cute.get_iter(%grouped_1014) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1017 = cute.get_layout(%grouped) : !memref_smem_bf16_14 loc(#loc311)
      %482 = cute.get_shape(%lay_1017) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1018, %e1_1019, %e2_1020 = cute.get_leaves(%482) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1021 = cute.get_layout(%grouped_1014) : !memref_rmem_bf16_7 loc(#loc311)
      %483 = cute.get_shape(%lay_1021) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1022, %e1_1023, %e2_1024 = cute.get_leaves(%483) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1025 = cute.size(%grouped) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1026 = cute.get_leaves(%sz_1025) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1027 = cute.size(%grouped_1014) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1028 = cute.get_leaves(%sz_1027) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped, %grouped_1014) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc436)
      %coord_1029 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc437)
      %slice_1030 = cute.slice(%src_partitioned_324, %coord_1029) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)"> loc(#loc437)
      %iter_1031 = cute.get_iter(%slice_1030) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1032 = cute.get_iter(%slice_1030) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1033 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc438)
      %slice_1034 = cute.slice(%retiled_326, %coord_1033) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)"> loc(#loc438)
      %iter_1035 = cute.get_iter(%slice_1034) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1036 = cute.get_iter(%slice_1034) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1037 = cute.get_layout(%slice_1030) : !memref_smem_bf16_16 loc(#loc311)
      %484 = cute.get_shape(%lay_1037) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1038, %e1_1039, %e2_1040 = cute.get_leaves(%484) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1041 = cute.get_layout(%slice_1034) : !memref_rmem_bf16_8 loc(#loc311)
      %485 = cute.get_shape(%lay_1041) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1042, %e1_1043, %e2_1044 = cute.get_leaves(%485) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1045 = cute.get_layout(%slice_1030) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1046 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1047 = cute.make_layout(%shape_1046) : !cute.layout<"1:0"> loc(#loc397)
      %append_1048 = cute.append_to_rank<2> (%lay_1045, %lay_1047) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1049 = cute.make_view(%iter_1032, %append_1048) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1050 = cute.get_iter(%view_1049) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1051 = cute.get_layout(%view_1049) : !memref_smem_bf16_16 loc(#loc311)
      %486 = cute.get_shape(%lay_1051) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1052, %e1_1053, %e2_1054 = cute.get_leaves(%486) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1055 = cute.group_modes(%view_1049) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1056 = cute.get_iter(%grouped_1055) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1057 = cute.get_iter(%grouped_1055) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1058 = cute.get_layout(%slice_1034) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1059 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1060 = cute.make_layout(%shape_1059) : !cute.layout<"1:0"> loc(#loc397)
      %append_1061 = cute.append_to_rank<2> (%lay_1058, %lay_1060) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1062 = cute.make_view(%iter_1036, %append_1061) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1063 = cute.get_iter(%view_1062) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1064 = cute.get_layout(%view_1062) : !memref_rmem_bf16_8 loc(#loc311)
      %487 = cute.get_shape(%lay_1064) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1065, %e1_1066, %e2_1067 = cute.get_leaves(%487) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1068 = cute.group_modes(%view_1062) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1069 = cute.get_iter(%grouped_1068) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1070 = cute.get_iter(%grouped_1068) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1071 = cute.get_layout(%grouped_1055) : !memref_smem_bf16_17 loc(#loc311)
      %488 = cute.get_shape(%lay_1071) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1072, %e1_1073, %e2_1074 = cute.get_leaves(%488) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1075 = cute.get_layout(%grouped_1068) : !memref_rmem_bf16_9 loc(#loc311)
      %489 = cute.get_shape(%lay_1075) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1076, %e1_1077, %e2_1078 = cute.get_leaves(%489) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1079 = cute.size(%grouped_1055) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1080 = cute.get_leaves(%sz_1079) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1081 = cute.size(%grouped_1068) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1082 = cute.get_leaves(%sz_1081) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1055, %grouped_1068) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc439)
      %lay_1083 = cute.get_layout(%src_partitioned_320) : !memref_smem_bf16_8 loc(#loc311)
      %490 = cute.get_shape(%lay_1083) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))"> loc(#loc311)
      %e0_1084, %e1_1085, %e2_1086, %e3_1087, %e4_1088, %e5 = cute.get_leaves(%490) : !cute.shape<"((8,1),2,((2,2),2))"> loc(#loc311)
      %int_tuple_1089 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc440)
      %sz_1090 = cute.size(%int_tuple_1089) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc440)
      %e0_1091 = cute.get_leaves(%sz_1090) : !cute.int_tuple<"8"> loc(#loc440)
      %int_tuple_1092 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1093 = cute.size(%int_tuple_1092) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1094 = cute.get_leaves(%sz_1093) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1095 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc442)
      %slice_1096 = cute.slice(%src_partitioned_320, %coord_1095) : !memref_smem_bf16_8, !cute.coord<"(_,_,1)"> loc(#loc442)
      %iter_1097 = cute.get_iter(%slice_1096) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1098 = cute.get_iter(%slice_1096) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1099 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc443)
      %slice_1100 = cute.slice(%retiled, %coord_1099) : !memref_rmem_bf16_3, !cute.coord<"(_,_,1)"> loc(#loc443)
      %iter_1101 = cute.get_iter(%slice_1100) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1102 = cute.get_iter(%slice_1100) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1103 = cute.get_layout(%slice_1096) : !memref_smem_bf16_13 loc(#loc311)
      %491 = cute.get_shape(%lay_1103) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1104, %e1_1105, %e2_1106 = cute.get_leaves(%491) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1107 = cute.get_layout(%slice_1100) : !memref_rmem_bf16_6 loc(#loc311)
      %492 = cute.get_shape(%lay_1107) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1108, %e1_1109, %e2_1110 = cute.get_leaves(%492) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1111 = cute.get_layout(%slice_1096) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1112 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1113 = cute.make_layout(%shape_1112) : !cute.layout<"1:0"> loc(#loc397)
      %append_1114 = cute.append_to_rank<2> (%lay_1111, %lay_1113) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1115 = cute.make_view(%iter_1098, %append_1114) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1116 = cute.get_iter(%view_1115) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1117 = cute.get_layout(%view_1115) : !memref_smem_bf16_13 loc(#loc311)
      %493 = cute.get_shape(%lay_1117) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1118, %e1_1119, %e2_1120 = cute.get_leaves(%493) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1121 = cute.group_modes(%view_1115) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1122 = cute.get_iter(%grouped_1121) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1123 = cute.get_iter(%grouped_1121) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1124 = cute.get_layout(%slice_1100) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1125 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1126 = cute.make_layout(%shape_1125) : !cute.layout<"1:0"> loc(#loc397)
      %append_1127 = cute.append_to_rank<2> (%lay_1124, %lay_1126) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1128 = cute.make_view(%iter_1102, %append_1127) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1129 = cute.get_iter(%view_1128) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1130 = cute.get_layout(%view_1128) : !memref_rmem_bf16_6 loc(#loc311)
      %494 = cute.get_shape(%lay_1130) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1131, %e1_1132, %e2_1133 = cute.get_leaves(%494) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1134 = cute.group_modes(%view_1128) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1135 = cute.get_iter(%grouped_1134) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1136 = cute.get_iter(%grouped_1134) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1137 = cute.get_layout(%grouped_1121) : !memref_smem_bf16_14 loc(#loc311)
      %495 = cute.get_shape(%lay_1137) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1138, %e1_1139, %e2_1140 = cute.get_leaves(%495) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1141 = cute.get_layout(%grouped_1134) : !memref_rmem_bf16_7 loc(#loc311)
      %496 = cute.get_shape(%lay_1141) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1142, %e1_1143, %e2_1144 = cute.get_leaves(%496) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1145 = cute.size(%grouped_1121) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1146 = cute.get_leaves(%sz_1145) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1147 = cute.size(%grouped_1134) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1148 = cute.get_leaves(%sz_1147) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1121, %grouped_1134) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1149 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc445)
      %slice_1150 = cute.slice(%src_partitioned_324, %coord_1149) : !memref_smem_bf16_9, !cute.coord<"(_,_,1)"> loc(#loc445)
      %iter_1151 = cute.get_iter(%slice_1150) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1152 = cute.get_iter(%slice_1150) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1153 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc446)
      %slice_1154 = cute.slice(%retiled_326, %coord_1153) : !memref_rmem_bf16_4, !cute.coord<"(_,_,1)"> loc(#loc446)
      %iter_1155 = cute.get_iter(%slice_1154) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1156 = cute.get_iter(%slice_1154) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1157 = cute.get_layout(%slice_1150) : !memref_smem_bf16_16 loc(#loc311)
      %497 = cute.get_shape(%lay_1157) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1158, %e1_1159, %e2_1160 = cute.get_leaves(%497) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1161 = cute.get_layout(%slice_1154) : !memref_rmem_bf16_8 loc(#loc311)
      %498 = cute.get_shape(%lay_1161) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1162, %e1_1163, %e2_1164 = cute.get_leaves(%498) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1165 = cute.get_layout(%slice_1150) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1166 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1167 = cute.make_layout(%shape_1166) : !cute.layout<"1:0"> loc(#loc397)
      %append_1168 = cute.append_to_rank<2> (%lay_1165, %lay_1167) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1169 = cute.make_view(%iter_1152, %append_1168) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1170 = cute.get_iter(%view_1169) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1171 = cute.get_layout(%view_1169) : !memref_smem_bf16_16 loc(#loc311)
      %499 = cute.get_shape(%lay_1171) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1172, %e1_1173, %e2_1174 = cute.get_leaves(%499) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1175 = cute.group_modes(%view_1169) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1176 = cute.get_iter(%grouped_1175) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1177 = cute.get_iter(%grouped_1175) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1178 = cute.get_layout(%slice_1154) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1179 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1180 = cute.make_layout(%shape_1179) : !cute.layout<"1:0"> loc(#loc397)
      %append_1181 = cute.append_to_rank<2> (%lay_1178, %lay_1180) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1182 = cute.make_view(%iter_1156, %append_1181) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1183 = cute.get_iter(%view_1182) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1184 = cute.get_layout(%view_1182) : !memref_rmem_bf16_8 loc(#loc311)
      %500 = cute.get_shape(%lay_1184) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1185, %e1_1186, %e2_1187 = cute.get_leaves(%500) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1188 = cute.group_modes(%view_1182) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1189 = cute.get_iter(%grouped_1188) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1190 = cute.get_iter(%grouped_1188) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1191 = cute.get_layout(%grouped_1175) : !memref_smem_bf16_17 loc(#loc311)
      %501 = cute.get_shape(%lay_1191) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1192, %e1_1193, %e2_1194 = cute.get_leaves(%501) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1195 = cute.get_layout(%grouped_1188) : !memref_rmem_bf16_9 loc(#loc311)
      %502 = cute.get_shape(%lay_1195) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1196, %e1_1197, %e2_1198 = cute.get_leaves(%502) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1199 = cute.size(%grouped_1175) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1200 = cute.get_leaves(%sz_1199) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1201 = cute.size(%grouped_1188) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1202 = cute.get_leaves(%sz_1201) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1175, %grouped_1188) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1203 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc448)
      %slice_1204 = cute.slice(%frg_A, %coord_1203) : !memref_rmem_bf16_, !cute.coord<"(_,_,0)"> loc(#loc448)
      %iter_1205 = cute.get_iter(%slice_1204) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1206 = cute.get_iter(%slice_1204) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1207 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc449)
      %slice_1208 = cute.slice(%frg_B, %coord_1207) : !memref_rmem_bf16_1, !cute.coord<"(_,_,0)"> loc(#loc449)
      %iter_1209 = cute.get_iter(%slice_1208) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1210 = cute.get_iter(%slice_1208) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1211 = cute.get_layout(%slice_1204) : !memref_rmem_bf16_10 loc(#loc311)
      %503 = cute.get_shape(%lay_1211) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1212, %e1_1213, %e2_1214, %e3_1215 = cute.get_leaves(%503) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1216 = cute.get_layout(%slice_1208) : !memref_rmem_bf16_11 loc(#loc311)
      %504 = cute.get_shape(%lay_1216) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1217, %e1_1218, %e2_1219 = cute.get_leaves(%504) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1204, %slice_1208, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1220 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1221 = cute.size(%int_tuple_1220) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1222 = cute.get_leaves(%sz_1221) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1223 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc442)
      %slice_1224 = cute.slice(%src_partitioned_320, %coord_1223) : !memref_smem_bf16_8, !cute.coord<"(_,_,2)"> loc(#loc442)
      %iter_1225 = cute.get_iter(%slice_1224) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1226 = cute.get_iter(%slice_1224) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1227 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc443)
      %slice_1228 = cute.slice(%retiled, %coord_1227) : !memref_rmem_bf16_3, !cute.coord<"(_,_,2)"> loc(#loc443)
      %iter_1229 = cute.get_iter(%slice_1228) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1230 = cute.get_iter(%slice_1228) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1231 = cute.get_layout(%slice_1224) : !memref_smem_bf16_13 loc(#loc311)
      %505 = cute.get_shape(%lay_1231) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1232, %e1_1233, %e2_1234 = cute.get_leaves(%505) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1235 = cute.get_layout(%slice_1228) : !memref_rmem_bf16_6 loc(#loc311)
      %506 = cute.get_shape(%lay_1235) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1236, %e1_1237, %e2_1238 = cute.get_leaves(%506) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1239 = cute.get_layout(%slice_1224) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1240 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1241 = cute.make_layout(%shape_1240) : !cute.layout<"1:0"> loc(#loc397)
      %append_1242 = cute.append_to_rank<2> (%lay_1239, %lay_1241) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1243 = cute.make_view(%iter_1226, %append_1242) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1244 = cute.get_iter(%view_1243) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1245 = cute.get_layout(%view_1243) : !memref_smem_bf16_13 loc(#loc311)
      %507 = cute.get_shape(%lay_1245) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1246, %e1_1247, %e2_1248 = cute.get_leaves(%507) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1249 = cute.group_modes(%view_1243) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1250 = cute.get_iter(%grouped_1249) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1251 = cute.get_iter(%grouped_1249) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1252 = cute.get_layout(%slice_1228) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1253 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1254 = cute.make_layout(%shape_1253) : !cute.layout<"1:0"> loc(#loc397)
      %append_1255 = cute.append_to_rank<2> (%lay_1252, %lay_1254) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1256 = cute.make_view(%iter_1230, %append_1255) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1257 = cute.get_iter(%view_1256) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1258 = cute.get_layout(%view_1256) : !memref_rmem_bf16_6 loc(#loc311)
      %508 = cute.get_shape(%lay_1258) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1259, %e1_1260, %e2_1261 = cute.get_leaves(%508) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1262 = cute.group_modes(%view_1256) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1263 = cute.get_iter(%grouped_1262) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1264 = cute.get_iter(%grouped_1262) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1265 = cute.get_layout(%grouped_1249) : !memref_smem_bf16_14 loc(#loc311)
      %509 = cute.get_shape(%lay_1265) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1266, %e1_1267, %e2_1268 = cute.get_leaves(%509) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1269 = cute.get_layout(%grouped_1262) : !memref_rmem_bf16_7 loc(#loc311)
      %510 = cute.get_shape(%lay_1269) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1270, %e1_1271, %e2_1272 = cute.get_leaves(%510) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1273 = cute.size(%grouped_1249) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1274 = cute.get_leaves(%sz_1273) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1275 = cute.size(%grouped_1262) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1276 = cute.get_leaves(%sz_1275) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1249, %grouped_1262) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1277 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc445)
      %slice_1278 = cute.slice(%src_partitioned_324, %coord_1277) : !memref_smem_bf16_9, !cute.coord<"(_,_,2)"> loc(#loc445)
      %iter_1279 = cute.get_iter(%slice_1278) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1280 = cute.get_iter(%slice_1278) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1281 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc446)
      %slice_1282 = cute.slice(%retiled_326, %coord_1281) : !memref_rmem_bf16_4, !cute.coord<"(_,_,2)"> loc(#loc446)
      %iter_1283 = cute.get_iter(%slice_1282) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1284 = cute.get_iter(%slice_1282) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1285 = cute.get_layout(%slice_1278) : !memref_smem_bf16_16 loc(#loc311)
      %511 = cute.get_shape(%lay_1285) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1286, %e1_1287, %e2_1288 = cute.get_leaves(%511) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1289 = cute.get_layout(%slice_1282) : !memref_rmem_bf16_8 loc(#loc311)
      %512 = cute.get_shape(%lay_1289) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1290, %e1_1291, %e2_1292 = cute.get_leaves(%512) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1293 = cute.get_layout(%slice_1278) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1294 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1295 = cute.make_layout(%shape_1294) : !cute.layout<"1:0"> loc(#loc397)
      %append_1296 = cute.append_to_rank<2> (%lay_1293, %lay_1295) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1297 = cute.make_view(%iter_1280, %append_1296) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1298 = cute.get_iter(%view_1297) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1299 = cute.get_layout(%view_1297) : !memref_smem_bf16_16 loc(#loc311)
      %513 = cute.get_shape(%lay_1299) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1300, %e1_1301, %e2_1302 = cute.get_leaves(%513) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1303 = cute.group_modes(%view_1297) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1304 = cute.get_iter(%grouped_1303) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1305 = cute.get_iter(%grouped_1303) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1306 = cute.get_layout(%slice_1282) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1307 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1308 = cute.make_layout(%shape_1307) : !cute.layout<"1:0"> loc(#loc397)
      %append_1309 = cute.append_to_rank<2> (%lay_1306, %lay_1308) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1310 = cute.make_view(%iter_1284, %append_1309) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1311 = cute.get_iter(%view_1310) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1312 = cute.get_layout(%view_1310) : !memref_rmem_bf16_8 loc(#loc311)
      %514 = cute.get_shape(%lay_1312) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1313, %e1_1314, %e2_1315 = cute.get_leaves(%514) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1316 = cute.group_modes(%view_1310) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1317 = cute.get_iter(%grouped_1316) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1318 = cute.get_iter(%grouped_1316) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1319 = cute.get_layout(%grouped_1303) : !memref_smem_bf16_17 loc(#loc311)
      %515 = cute.get_shape(%lay_1319) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1320, %e1_1321, %e2_1322 = cute.get_leaves(%515) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1323 = cute.get_layout(%grouped_1316) : !memref_rmem_bf16_9 loc(#loc311)
      %516 = cute.get_shape(%lay_1323) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1324, %e1_1325, %e2_1326 = cute.get_leaves(%516) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1327 = cute.size(%grouped_1303) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1328 = cute.get_leaves(%sz_1327) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1329 = cute.size(%grouped_1316) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1330 = cute.get_leaves(%sz_1329) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1303, %grouped_1316) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1331 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc448)
      %slice_1332 = cute.slice(%frg_A, %coord_1331) : !memref_rmem_bf16_, !cute.coord<"(_,_,1)"> loc(#loc448)
      %iter_1333 = cute.get_iter(%slice_1332) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1334 = cute.get_iter(%slice_1332) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1335 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc449)
      %slice_1336 = cute.slice(%frg_B, %coord_1335) : !memref_rmem_bf16_1, !cute.coord<"(_,_,1)"> loc(#loc449)
      %iter_1337 = cute.get_iter(%slice_1336) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1338 = cute.get_iter(%slice_1336) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1339 = cute.get_layout(%slice_1332) : !memref_rmem_bf16_10 loc(#loc311)
      %517 = cute.get_shape(%lay_1339) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1340, %e1_1341, %e2_1342, %e3_1343 = cute.get_leaves(%517) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1344 = cute.get_layout(%slice_1336) : !memref_rmem_bf16_11 loc(#loc311)
      %518 = cute.get_shape(%lay_1344) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1345, %e1_1346, %e2_1347 = cute.get_leaves(%518) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1332, %slice_1336, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1348 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1349 = cute.size(%int_tuple_1348) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1350 = cute.get_leaves(%sz_1349) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1351 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc442)
      %slice_1352 = cute.slice(%src_partitioned_320, %coord_1351) : !memref_smem_bf16_8, !cute.coord<"(_,_,3)"> loc(#loc442)
      %iter_1353 = cute.get_iter(%slice_1352) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1354 = cute.get_iter(%slice_1352) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1355 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc443)
      %slice_1356 = cute.slice(%retiled, %coord_1355) : !memref_rmem_bf16_3, !cute.coord<"(_,_,3)"> loc(#loc443)
      %iter_1357 = cute.get_iter(%slice_1356) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1358 = cute.get_iter(%slice_1356) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1359 = cute.get_layout(%slice_1352) : !memref_smem_bf16_13 loc(#loc311)
      %519 = cute.get_shape(%lay_1359) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1360, %e1_1361, %e2_1362 = cute.get_leaves(%519) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1363 = cute.get_layout(%slice_1356) : !memref_rmem_bf16_6 loc(#loc311)
      %520 = cute.get_shape(%lay_1363) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1364, %e1_1365, %e2_1366 = cute.get_leaves(%520) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1367 = cute.get_layout(%slice_1352) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1368 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1369 = cute.make_layout(%shape_1368) : !cute.layout<"1:0"> loc(#loc397)
      %append_1370 = cute.append_to_rank<2> (%lay_1367, %lay_1369) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1371 = cute.make_view(%iter_1354, %append_1370) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1372 = cute.get_iter(%view_1371) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1373 = cute.get_layout(%view_1371) : !memref_smem_bf16_13 loc(#loc311)
      %521 = cute.get_shape(%lay_1373) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1374, %e1_1375, %e2_1376 = cute.get_leaves(%521) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1377 = cute.group_modes(%view_1371) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1378 = cute.get_iter(%grouped_1377) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1379 = cute.get_iter(%grouped_1377) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1380 = cute.get_layout(%slice_1356) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1381 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1382 = cute.make_layout(%shape_1381) : !cute.layout<"1:0"> loc(#loc397)
      %append_1383 = cute.append_to_rank<2> (%lay_1380, %lay_1382) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1384 = cute.make_view(%iter_1358, %append_1383) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1385 = cute.get_iter(%view_1384) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1386 = cute.get_layout(%view_1384) : !memref_rmem_bf16_6 loc(#loc311)
      %522 = cute.get_shape(%lay_1386) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1387, %e1_1388, %e2_1389 = cute.get_leaves(%522) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1390 = cute.group_modes(%view_1384) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1391 = cute.get_iter(%grouped_1390) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1392 = cute.get_iter(%grouped_1390) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1393 = cute.get_layout(%grouped_1377) : !memref_smem_bf16_14 loc(#loc311)
      %523 = cute.get_shape(%lay_1393) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1394, %e1_1395, %e2_1396 = cute.get_leaves(%523) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1397 = cute.get_layout(%grouped_1390) : !memref_rmem_bf16_7 loc(#loc311)
      %524 = cute.get_shape(%lay_1397) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1398, %e1_1399, %e2_1400 = cute.get_leaves(%524) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1401 = cute.size(%grouped_1377) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1402 = cute.get_leaves(%sz_1401) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1403 = cute.size(%grouped_1390) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1404 = cute.get_leaves(%sz_1403) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1377, %grouped_1390) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1405 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc445)
      %slice_1406 = cute.slice(%src_partitioned_324, %coord_1405) : !memref_smem_bf16_9, !cute.coord<"(_,_,3)"> loc(#loc445)
      %iter_1407 = cute.get_iter(%slice_1406) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1408 = cute.get_iter(%slice_1406) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1409 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc446)
      %slice_1410 = cute.slice(%retiled_326, %coord_1409) : !memref_rmem_bf16_4, !cute.coord<"(_,_,3)"> loc(#loc446)
      %iter_1411 = cute.get_iter(%slice_1410) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1412 = cute.get_iter(%slice_1410) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1413 = cute.get_layout(%slice_1406) : !memref_smem_bf16_16 loc(#loc311)
      %525 = cute.get_shape(%lay_1413) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1414, %e1_1415, %e2_1416 = cute.get_leaves(%525) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1417 = cute.get_layout(%slice_1410) : !memref_rmem_bf16_8 loc(#loc311)
      %526 = cute.get_shape(%lay_1417) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1418, %e1_1419, %e2_1420 = cute.get_leaves(%526) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1421 = cute.get_layout(%slice_1406) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1422 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1423 = cute.make_layout(%shape_1422) : !cute.layout<"1:0"> loc(#loc397)
      %append_1424 = cute.append_to_rank<2> (%lay_1421, %lay_1423) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1425 = cute.make_view(%iter_1408, %append_1424) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1426 = cute.get_iter(%view_1425) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1427 = cute.get_layout(%view_1425) : !memref_smem_bf16_16 loc(#loc311)
      %527 = cute.get_shape(%lay_1427) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1428, %e1_1429, %e2_1430 = cute.get_leaves(%527) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1431 = cute.group_modes(%view_1425) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1432 = cute.get_iter(%grouped_1431) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1433 = cute.get_iter(%grouped_1431) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1434 = cute.get_layout(%slice_1410) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1435 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1436 = cute.make_layout(%shape_1435) : !cute.layout<"1:0"> loc(#loc397)
      %append_1437 = cute.append_to_rank<2> (%lay_1434, %lay_1436) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1438 = cute.make_view(%iter_1412, %append_1437) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1439 = cute.get_iter(%view_1438) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1440 = cute.get_layout(%view_1438) : !memref_rmem_bf16_8 loc(#loc311)
      %528 = cute.get_shape(%lay_1440) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1441, %e1_1442, %e2_1443 = cute.get_leaves(%528) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1444 = cute.group_modes(%view_1438) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1445 = cute.get_iter(%grouped_1444) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1446 = cute.get_iter(%grouped_1444) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1447 = cute.get_layout(%grouped_1431) : !memref_smem_bf16_17 loc(#loc311)
      %529 = cute.get_shape(%lay_1447) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1448, %e1_1449, %e2_1450 = cute.get_leaves(%529) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1451 = cute.get_layout(%grouped_1444) : !memref_rmem_bf16_9 loc(#loc311)
      %530 = cute.get_shape(%lay_1451) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1452, %e1_1453, %e2_1454 = cute.get_leaves(%530) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1455 = cute.size(%grouped_1431) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1456 = cute.get_leaves(%sz_1455) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1457 = cute.size(%grouped_1444) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1458 = cute.get_leaves(%sz_1457) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1431, %grouped_1444) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1459 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc448)
      %slice_1460 = cute.slice(%frg_A, %coord_1459) : !memref_rmem_bf16_, !cute.coord<"(_,_,2)"> loc(#loc448)
      %iter_1461 = cute.get_iter(%slice_1460) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1462 = cute.get_iter(%slice_1460) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1463 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc449)
      %slice_1464 = cute.slice(%frg_B, %coord_1463) : !memref_rmem_bf16_1, !cute.coord<"(_,_,2)"> loc(#loc449)
      %iter_1465 = cute.get_iter(%slice_1464) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1466 = cute.get_iter(%slice_1464) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1467 = cute.get_layout(%slice_1460) : !memref_rmem_bf16_10 loc(#loc311)
      %531 = cute.get_shape(%lay_1467) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1468, %e1_1469, %e2_1470, %e3_1471 = cute.get_leaves(%531) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1472 = cute.get_layout(%slice_1464) : !memref_rmem_bf16_11 loc(#loc311)
      %532 = cute.get_shape(%lay_1472) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1473, %e1_1474, %e2_1475 = cute.get_leaves(%532) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1460, %slice_1464, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1476 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1477 = cute.size(%int_tuple_1476) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1478 = cute.get_leaves(%sz_1477) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1479 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc442)
      %slice_1480 = cute.slice(%src_partitioned_320, %coord_1479) : !memref_smem_bf16_8, !cute.coord<"(_,_,4)"> loc(#loc442)
      %iter_1481 = cute.get_iter(%slice_1480) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1482 = cute.get_iter(%slice_1480) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1483 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc443)
      %slice_1484 = cute.slice(%retiled, %coord_1483) : !memref_rmem_bf16_3, !cute.coord<"(_,_,4)"> loc(#loc443)
      %iter_1485 = cute.get_iter(%slice_1484) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1486 = cute.get_iter(%slice_1484) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1487 = cute.get_layout(%slice_1480) : !memref_smem_bf16_13 loc(#loc311)
      %533 = cute.get_shape(%lay_1487) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1488, %e1_1489, %e2_1490 = cute.get_leaves(%533) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1491 = cute.get_layout(%slice_1484) : !memref_rmem_bf16_6 loc(#loc311)
      %534 = cute.get_shape(%lay_1491) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1492, %e1_1493, %e2_1494 = cute.get_leaves(%534) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1495 = cute.get_layout(%slice_1480) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1496 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1497 = cute.make_layout(%shape_1496) : !cute.layout<"1:0"> loc(#loc397)
      %append_1498 = cute.append_to_rank<2> (%lay_1495, %lay_1497) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1499 = cute.make_view(%iter_1482, %append_1498) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1500 = cute.get_iter(%view_1499) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1501 = cute.get_layout(%view_1499) : !memref_smem_bf16_13 loc(#loc311)
      %535 = cute.get_shape(%lay_1501) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1502, %e1_1503, %e2_1504 = cute.get_leaves(%535) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1505 = cute.group_modes(%view_1499) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1506 = cute.get_iter(%grouped_1505) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1507 = cute.get_iter(%grouped_1505) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1508 = cute.get_layout(%slice_1484) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1509 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1510 = cute.make_layout(%shape_1509) : !cute.layout<"1:0"> loc(#loc397)
      %append_1511 = cute.append_to_rank<2> (%lay_1508, %lay_1510) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1512 = cute.make_view(%iter_1486, %append_1511) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1513 = cute.get_iter(%view_1512) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1514 = cute.get_layout(%view_1512) : !memref_rmem_bf16_6 loc(#loc311)
      %536 = cute.get_shape(%lay_1514) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1515, %e1_1516, %e2_1517 = cute.get_leaves(%536) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1518 = cute.group_modes(%view_1512) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1519 = cute.get_iter(%grouped_1518) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1520 = cute.get_iter(%grouped_1518) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1521 = cute.get_layout(%grouped_1505) : !memref_smem_bf16_14 loc(#loc311)
      %537 = cute.get_shape(%lay_1521) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1522, %e1_1523, %e2_1524 = cute.get_leaves(%537) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1525 = cute.get_layout(%grouped_1518) : !memref_rmem_bf16_7 loc(#loc311)
      %538 = cute.get_shape(%lay_1525) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1526, %e1_1527, %e2_1528 = cute.get_leaves(%538) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1529 = cute.size(%grouped_1505) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1530 = cute.get_leaves(%sz_1529) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1531 = cute.size(%grouped_1518) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1532 = cute.get_leaves(%sz_1531) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1505, %grouped_1518) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1533 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc445)
      %slice_1534 = cute.slice(%src_partitioned_324, %coord_1533) : !memref_smem_bf16_9, !cute.coord<"(_,_,4)"> loc(#loc445)
      %iter_1535 = cute.get_iter(%slice_1534) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1536 = cute.get_iter(%slice_1534) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1537 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc446)
      %slice_1538 = cute.slice(%retiled_326, %coord_1537) : !memref_rmem_bf16_4, !cute.coord<"(_,_,4)"> loc(#loc446)
      %iter_1539 = cute.get_iter(%slice_1538) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1540 = cute.get_iter(%slice_1538) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1541 = cute.get_layout(%slice_1534) : !memref_smem_bf16_16 loc(#loc311)
      %539 = cute.get_shape(%lay_1541) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1542, %e1_1543, %e2_1544 = cute.get_leaves(%539) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1545 = cute.get_layout(%slice_1538) : !memref_rmem_bf16_8 loc(#loc311)
      %540 = cute.get_shape(%lay_1545) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1546, %e1_1547, %e2_1548 = cute.get_leaves(%540) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1549 = cute.get_layout(%slice_1534) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1550 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1551 = cute.make_layout(%shape_1550) : !cute.layout<"1:0"> loc(#loc397)
      %append_1552 = cute.append_to_rank<2> (%lay_1549, %lay_1551) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1553 = cute.make_view(%iter_1536, %append_1552) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1554 = cute.get_iter(%view_1553) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1555 = cute.get_layout(%view_1553) : !memref_smem_bf16_16 loc(#loc311)
      %541 = cute.get_shape(%lay_1555) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1556, %e1_1557, %e2_1558 = cute.get_leaves(%541) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1559 = cute.group_modes(%view_1553) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1560 = cute.get_iter(%grouped_1559) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1561 = cute.get_iter(%grouped_1559) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1562 = cute.get_layout(%slice_1538) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1563 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1564 = cute.make_layout(%shape_1563) : !cute.layout<"1:0"> loc(#loc397)
      %append_1565 = cute.append_to_rank<2> (%lay_1562, %lay_1564) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1566 = cute.make_view(%iter_1540, %append_1565) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1567 = cute.get_iter(%view_1566) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1568 = cute.get_layout(%view_1566) : !memref_rmem_bf16_8 loc(#loc311)
      %542 = cute.get_shape(%lay_1568) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1569, %e1_1570, %e2_1571 = cute.get_leaves(%542) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1572 = cute.group_modes(%view_1566) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1573 = cute.get_iter(%grouped_1572) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1574 = cute.get_iter(%grouped_1572) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1575 = cute.get_layout(%grouped_1559) : !memref_smem_bf16_17 loc(#loc311)
      %543 = cute.get_shape(%lay_1575) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1576, %e1_1577, %e2_1578 = cute.get_leaves(%543) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1579 = cute.get_layout(%grouped_1572) : !memref_rmem_bf16_9 loc(#loc311)
      %544 = cute.get_shape(%lay_1579) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1580, %e1_1581, %e2_1582 = cute.get_leaves(%544) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1583 = cute.size(%grouped_1559) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1584 = cute.get_leaves(%sz_1583) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1585 = cute.size(%grouped_1572) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1586 = cute.get_leaves(%sz_1585) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1559, %grouped_1572) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1587 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc448)
      %slice_1588 = cute.slice(%frg_A, %coord_1587) : !memref_rmem_bf16_, !cute.coord<"(_,_,3)"> loc(#loc448)
      %iter_1589 = cute.get_iter(%slice_1588) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1590 = cute.get_iter(%slice_1588) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1591 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc449)
      %slice_1592 = cute.slice(%frg_B, %coord_1591) : !memref_rmem_bf16_1, !cute.coord<"(_,_,3)"> loc(#loc449)
      %iter_1593 = cute.get_iter(%slice_1592) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1594 = cute.get_iter(%slice_1592) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1595 = cute.get_layout(%slice_1588) : !memref_rmem_bf16_10 loc(#loc311)
      %545 = cute.get_shape(%lay_1595) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1596, %e1_1597, %e2_1598, %e3_1599 = cute.get_leaves(%545) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1600 = cute.get_layout(%slice_1592) : !memref_rmem_bf16_11 loc(#loc311)
      %546 = cute.get_shape(%lay_1600) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1601, %e1_1602, %e2_1603 = cute.get_leaves(%546) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1588, %slice_1592, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1604 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1605 = cute.size(%int_tuple_1604) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1606 = cute.get_leaves(%sz_1605) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1607 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc442)
      %slice_1608 = cute.slice(%src_partitioned_320, %coord_1607) : !memref_smem_bf16_8, !cute.coord<"(_,_,5)"> loc(#loc442)
      %iter_1609 = cute.get_iter(%slice_1608) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1610 = cute.get_iter(%slice_1608) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1611 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc443)
      %slice_1612 = cute.slice(%retiled, %coord_1611) : !memref_rmem_bf16_3, !cute.coord<"(_,_,5)"> loc(#loc443)
      %iter_1613 = cute.get_iter(%slice_1612) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1614 = cute.get_iter(%slice_1612) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1615 = cute.get_layout(%slice_1608) : !memref_smem_bf16_13 loc(#loc311)
      %547 = cute.get_shape(%lay_1615) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1616, %e1_1617, %e2_1618 = cute.get_leaves(%547) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1619 = cute.get_layout(%slice_1612) : !memref_rmem_bf16_6 loc(#loc311)
      %548 = cute.get_shape(%lay_1619) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1620, %e1_1621, %e2_1622 = cute.get_leaves(%548) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1623 = cute.get_layout(%slice_1608) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1624 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1625 = cute.make_layout(%shape_1624) : !cute.layout<"1:0"> loc(#loc397)
      %append_1626 = cute.append_to_rank<2> (%lay_1623, %lay_1625) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1627 = cute.make_view(%iter_1610, %append_1626) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1628 = cute.get_iter(%view_1627) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1629 = cute.get_layout(%view_1627) : !memref_smem_bf16_13 loc(#loc311)
      %549 = cute.get_shape(%lay_1629) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1630, %e1_1631, %e2_1632 = cute.get_leaves(%549) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1633 = cute.group_modes(%view_1627) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1634 = cute.get_iter(%grouped_1633) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1635 = cute.get_iter(%grouped_1633) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1636 = cute.get_layout(%slice_1612) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1637 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1638 = cute.make_layout(%shape_1637) : !cute.layout<"1:0"> loc(#loc397)
      %append_1639 = cute.append_to_rank<2> (%lay_1636, %lay_1638) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1640 = cute.make_view(%iter_1614, %append_1639) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1641 = cute.get_iter(%view_1640) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1642 = cute.get_layout(%view_1640) : !memref_rmem_bf16_6 loc(#loc311)
      %550 = cute.get_shape(%lay_1642) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1643, %e1_1644, %e2_1645 = cute.get_leaves(%550) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1646 = cute.group_modes(%view_1640) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1647 = cute.get_iter(%grouped_1646) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1648 = cute.get_iter(%grouped_1646) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1649 = cute.get_layout(%grouped_1633) : !memref_smem_bf16_14 loc(#loc311)
      %551 = cute.get_shape(%lay_1649) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1650, %e1_1651, %e2_1652 = cute.get_leaves(%551) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1653 = cute.get_layout(%grouped_1646) : !memref_rmem_bf16_7 loc(#loc311)
      %552 = cute.get_shape(%lay_1653) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1654, %e1_1655, %e2_1656 = cute.get_leaves(%552) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1657 = cute.size(%grouped_1633) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1658 = cute.get_leaves(%sz_1657) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1659 = cute.size(%grouped_1646) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1660 = cute.get_leaves(%sz_1659) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1633, %grouped_1646) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1661 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc445)
      %slice_1662 = cute.slice(%src_partitioned_324, %coord_1661) : !memref_smem_bf16_9, !cute.coord<"(_,_,5)"> loc(#loc445)
      %iter_1663 = cute.get_iter(%slice_1662) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1664 = cute.get_iter(%slice_1662) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1665 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc446)
      %slice_1666 = cute.slice(%retiled_326, %coord_1665) : !memref_rmem_bf16_4, !cute.coord<"(_,_,5)"> loc(#loc446)
      %iter_1667 = cute.get_iter(%slice_1666) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1668 = cute.get_iter(%slice_1666) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1669 = cute.get_layout(%slice_1662) : !memref_smem_bf16_16 loc(#loc311)
      %553 = cute.get_shape(%lay_1669) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1670, %e1_1671, %e2_1672 = cute.get_leaves(%553) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1673 = cute.get_layout(%slice_1666) : !memref_rmem_bf16_8 loc(#loc311)
      %554 = cute.get_shape(%lay_1673) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1674, %e1_1675, %e2_1676 = cute.get_leaves(%554) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1677 = cute.get_layout(%slice_1662) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1678 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1679 = cute.make_layout(%shape_1678) : !cute.layout<"1:0"> loc(#loc397)
      %append_1680 = cute.append_to_rank<2> (%lay_1677, %lay_1679) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1681 = cute.make_view(%iter_1664, %append_1680) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1682 = cute.get_iter(%view_1681) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1683 = cute.get_layout(%view_1681) : !memref_smem_bf16_16 loc(#loc311)
      %555 = cute.get_shape(%lay_1683) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1684, %e1_1685, %e2_1686 = cute.get_leaves(%555) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1687 = cute.group_modes(%view_1681) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1688 = cute.get_iter(%grouped_1687) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1689 = cute.get_iter(%grouped_1687) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1690 = cute.get_layout(%slice_1666) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1691 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1692 = cute.make_layout(%shape_1691) : !cute.layout<"1:0"> loc(#loc397)
      %append_1693 = cute.append_to_rank<2> (%lay_1690, %lay_1692) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1694 = cute.make_view(%iter_1668, %append_1693) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1695 = cute.get_iter(%view_1694) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1696 = cute.get_layout(%view_1694) : !memref_rmem_bf16_8 loc(#loc311)
      %556 = cute.get_shape(%lay_1696) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1697, %e1_1698, %e2_1699 = cute.get_leaves(%556) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1700 = cute.group_modes(%view_1694) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1701 = cute.get_iter(%grouped_1700) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1702 = cute.get_iter(%grouped_1700) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1703 = cute.get_layout(%grouped_1687) : !memref_smem_bf16_17 loc(#loc311)
      %557 = cute.get_shape(%lay_1703) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1704, %e1_1705, %e2_1706 = cute.get_leaves(%557) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1707 = cute.get_layout(%grouped_1700) : !memref_rmem_bf16_9 loc(#loc311)
      %558 = cute.get_shape(%lay_1707) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1708, %e1_1709, %e2_1710 = cute.get_leaves(%558) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1711 = cute.size(%grouped_1687) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1712 = cute.get_leaves(%sz_1711) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1713 = cute.size(%grouped_1700) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1714 = cute.get_leaves(%sz_1713) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1687, %grouped_1700) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1715 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc448)
      %slice_1716 = cute.slice(%frg_A, %coord_1715) : !memref_rmem_bf16_, !cute.coord<"(_,_,4)"> loc(#loc448)
      %iter_1717 = cute.get_iter(%slice_1716) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1718 = cute.get_iter(%slice_1716) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1719 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc449)
      %slice_1720 = cute.slice(%frg_B, %coord_1719) : !memref_rmem_bf16_1, !cute.coord<"(_,_,4)"> loc(#loc449)
      %iter_1721 = cute.get_iter(%slice_1720) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1722 = cute.get_iter(%slice_1720) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1723 = cute.get_layout(%slice_1716) : !memref_rmem_bf16_10 loc(#loc311)
      %559 = cute.get_shape(%lay_1723) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1724, %e1_1725, %e2_1726, %e3_1727 = cute.get_leaves(%559) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1728 = cute.get_layout(%slice_1720) : !memref_rmem_bf16_11 loc(#loc311)
      %560 = cute.get_shape(%lay_1728) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1729, %e1_1730, %e2_1731 = cute.get_leaves(%560) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1716, %slice_1720, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1732 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1733 = cute.size(%int_tuple_1732) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1734 = cute.get_leaves(%sz_1733) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1735 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc442)
      %slice_1736 = cute.slice(%src_partitioned_320, %coord_1735) : !memref_smem_bf16_8, !cute.coord<"(_,_,6)"> loc(#loc442)
      %iter_1737 = cute.get_iter(%slice_1736) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1738 = cute.get_iter(%slice_1736) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1739 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc443)
      %slice_1740 = cute.slice(%retiled, %coord_1739) : !memref_rmem_bf16_3, !cute.coord<"(_,_,6)"> loc(#loc443)
      %iter_1741 = cute.get_iter(%slice_1740) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1742 = cute.get_iter(%slice_1740) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1743 = cute.get_layout(%slice_1736) : !memref_smem_bf16_13 loc(#loc311)
      %561 = cute.get_shape(%lay_1743) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1744, %e1_1745, %e2_1746 = cute.get_leaves(%561) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1747 = cute.get_layout(%slice_1740) : !memref_rmem_bf16_6 loc(#loc311)
      %562 = cute.get_shape(%lay_1747) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1748, %e1_1749, %e2_1750 = cute.get_leaves(%562) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1751 = cute.get_layout(%slice_1736) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1752 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1753 = cute.make_layout(%shape_1752) : !cute.layout<"1:0"> loc(#loc397)
      %append_1754 = cute.append_to_rank<2> (%lay_1751, %lay_1753) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1755 = cute.make_view(%iter_1738, %append_1754) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1756 = cute.get_iter(%view_1755) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1757 = cute.get_layout(%view_1755) : !memref_smem_bf16_13 loc(#loc311)
      %563 = cute.get_shape(%lay_1757) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1758, %e1_1759, %e2_1760 = cute.get_leaves(%563) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1761 = cute.group_modes(%view_1755) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1762 = cute.get_iter(%grouped_1761) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1763 = cute.get_iter(%grouped_1761) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1764 = cute.get_layout(%slice_1740) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1765 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1766 = cute.make_layout(%shape_1765) : !cute.layout<"1:0"> loc(#loc397)
      %append_1767 = cute.append_to_rank<2> (%lay_1764, %lay_1766) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1768 = cute.make_view(%iter_1742, %append_1767) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1769 = cute.get_iter(%view_1768) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1770 = cute.get_layout(%view_1768) : !memref_rmem_bf16_6 loc(#loc311)
      %564 = cute.get_shape(%lay_1770) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1771, %e1_1772, %e2_1773 = cute.get_leaves(%564) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1774 = cute.group_modes(%view_1768) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1775 = cute.get_iter(%grouped_1774) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1776 = cute.get_iter(%grouped_1774) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1777 = cute.get_layout(%grouped_1761) : !memref_smem_bf16_14 loc(#loc311)
      %565 = cute.get_shape(%lay_1777) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1778, %e1_1779, %e2_1780 = cute.get_leaves(%565) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1781 = cute.get_layout(%grouped_1774) : !memref_rmem_bf16_7 loc(#loc311)
      %566 = cute.get_shape(%lay_1781) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1782, %e1_1783, %e2_1784 = cute.get_leaves(%566) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1785 = cute.size(%grouped_1761) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1786 = cute.get_leaves(%sz_1785) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1787 = cute.size(%grouped_1774) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1788 = cute.get_leaves(%sz_1787) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1761, %grouped_1774) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1789 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc445)
      %slice_1790 = cute.slice(%src_partitioned_324, %coord_1789) : !memref_smem_bf16_9, !cute.coord<"(_,_,6)"> loc(#loc445)
      %iter_1791 = cute.get_iter(%slice_1790) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1792 = cute.get_iter(%slice_1790) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1793 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc446)
      %slice_1794 = cute.slice(%retiled_326, %coord_1793) : !memref_rmem_bf16_4, !cute.coord<"(_,_,6)"> loc(#loc446)
      %iter_1795 = cute.get_iter(%slice_1794) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1796 = cute.get_iter(%slice_1794) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1797 = cute.get_layout(%slice_1790) : !memref_smem_bf16_16 loc(#loc311)
      %567 = cute.get_shape(%lay_1797) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1798, %e1_1799, %e2_1800 = cute.get_leaves(%567) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1801 = cute.get_layout(%slice_1794) : !memref_rmem_bf16_8 loc(#loc311)
      %568 = cute.get_shape(%lay_1801) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1802, %e1_1803, %e2_1804 = cute.get_leaves(%568) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1805 = cute.get_layout(%slice_1790) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1806 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1807 = cute.make_layout(%shape_1806) : !cute.layout<"1:0"> loc(#loc397)
      %append_1808 = cute.append_to_rank<2> (%lay_1805, %lay_1807) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1809 = cute.make_view(%iter_1792, %append_1808) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1810 = cute.get_iter(%view_1809) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1811 = cute.get_layout(%view_1809) : !memref_smem_bf16_16 loc(#loc311)
      %569 = cute.get_shape(%lay_1811) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1812, %e1_1813, %e2_1814 = cute.get_leaves(%569) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1815 = cute.group_modes(%view_1809) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1816 = cute.get_iter(%grouped_1815) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1817 = cute.get_iter(%grouped_1815) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1818 = cute.get_layout(%slice_1794) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1819 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1820 = cute.make_layout(%shape_1819) : !cute.layout<"1:0"> loc(#loc397)
      %append_1821 = cute.append_to_rank<2> (%lay_1818, %lay_1820) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1822 = cute.make_view(%iter_1796, %append_1821) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1823 = cute.get_iter(%view_1822) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1824 = cute.get_layout(%view_1822) : !memref_rmem_bf16_8 loc(#loc311)
      %570 = cute.get_shape(%lay_1824) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1825, %e1_1826, %e2_1827 = cute.get_leaves(%570) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1828 = cute.group_modes(%view_1822) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1829 = cute.get_iter(%grouped_1828) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1830 = cute.get_iter(%grouped_1828) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1831 = cute.get_layout(%grouped_1815) : !memref_smem_bf16_17 loc(#loc311)
      %571 = cute.get_shape(%lay_1831) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1832, %e1_1833, %e2_1834 = cute.get_leaves(%571) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1835 = cute.get_layout(%grouped_1828) : !memref_rmem_bf16_9 loc(#loc311)
      %572 = cute.get_shape(%lay_1835) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1836, %e1_1837, %e2_1838 = cute.get_leaves(%572) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1839 = cute.size(%grouped_1815) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1840 = cute.get_leaves(%sz_1839) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1841 = cute.size(%grouped_1828) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1842 = cute.get_leaves(%sz_1841) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1815, %grouped_1828) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1843 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc448)
      %slice_1844 = cute.slice(%frg_A, %coord_1843) : !memref_rmem_bf16_, !cute.coord<"(_,_,5)"> loc(#loc448)
      %iter_1845 = cute.get_iter(%slice_1844) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1846 = cute.get_iter(%slice_1844) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1847 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc449)
      %slice_1848 = cute.slice(%frg_B, %coord_1847) : !memref_rmem_bf16_1, !cute.coord<"(_,_,5)"> loc(#loc449)
      %iter_1849 = cute.get_iter(%slice_1848) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1850 = cute.get_iter(%slice_1848) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1851 = cute.get_layout(%slice_1844) : !memref_rmem_bf16_10 loc(#loc311)
      %573 = cute.get_shape(%lay_1851) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1852, %e1_1853, %e2_1854, %e3_1855 = cute.get_leaves(%573) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1856 = cute.get_layout(%slice_1848) : !memref_rmem_bf16_11 loc(#loc311)
      %574 = cute.get_shape(%lay_1856) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1857, %e1_1858, %e2_1859 = cute.get_leaves(%574) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1844, %slice_1848, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1860 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1861 = cute.size(%int_tuple_1860) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1862 = cute.get_leaves(%sz_1861) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1863 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc442)
      %slice_1864 = cute.slice(%src_partitioned_320, %coord_1863) : !memref_smem_bf16_8, !cute.coord<"(_,_,7)"> loc(#loc442)
      %iter_1865 = cute.get_iter(%slice_1864) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1866 = cute.get_iter(%slice_1864) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1867 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc443)
      %slice_1868 = cute.slice(%retiled, %coord_1867) : !memref_rmem_bf16_3, !cute.coord<"(_,_,7)"> loc(#loc443)
      %iter_1869 = cute.get_iter(%slice_1868) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1870 = cute.get_iter(%slice_1868) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1871 = cute.get_layout(%slice_1864) : !memref_smem_bf16_13 loc(#loc311)
      %575 = cute.get_shape(%lay_1871) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1872, %e1_1873, %e2_1874 = cute.get_leaves(%575) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1875 = cute.get_layout(%slice_1868) : !memref_rmem_bf16_6 loc(#loc311)
      %576 = cute.get_shape(%lay_1875) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1876, %e1_1877, %e2_1878 = cute.get_leaves(%576) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_1879 = cute.get_layout(%slice_1864) : !memref_smem_bf16_13 loc(#loc397)
      %shape_1880 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1881 = cute.make_layout(%shape_1880) : !cute.layout<"1:0"> loc(#loc397)
      %append_1882 = cute.append_to_rank<2> (%lay_1879, %lay_1881) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1883 = cute.make_view(%iter_1866, %append_1882) : !memref_smem_bf16_13 loc(#loc398)
      %iter_1884 = cute.get_iter(%view_1883) : !memref_smem_bf16_13 loc(#loc331)
      %lay_1885 = cute.get_layout(%view_1883) : !memref_smem_bf16_13 loc(#loc311)
      %577 = cute.get_shape(%lay_1885) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1886, %e1_1887, %e2_1888 = cute.get_leaves(%577) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1889 = cute.group_modes(%view_1883) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_1890 = cute.get_iter(%grouped_1889) : !memref_smem_bf16_14 loc(#loc399)
      %iter_1891 = cute.get_iter(%grouped_1889) : !memref_smem_bf16_14 loc(#loc317)
      %lay_1892 = cute.get_layout(%slice_1868) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_1893 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1894 = cute.make_layout(%shape_1893) : !cute.layout<"1:0"> loc(#loc397)
      %append_1895 = cute.append_to_rank<2> (%lay_1892, %lay_1894) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1896 = cute.make_view(%iter_1870, %append_1895) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_1897 = cute.get_iter(%view_1896) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_1898 = cute.get_layout(%view_1896) : !memref_rmem_bf16_6 loc(#loc311)
      %578 = cute.get_shape(%lay_1898) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_1899, %e1_1900, %e2_1901 = cute.get_leaves(%578) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_1902 = cute.group_modes(%view_1896) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_1903 = cute.get_iter(%grouped_1902) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_1904 = cute.get_iter(%grouped_1902) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_1905 = cute.get_layout(%grouped_1889) : !memref_smem_bf16_14 loc(#loc311)
      %579 = cute.get_shape(%lay_1905) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1906, %e1_1907, %e2_1908 = cute.get_leaves(%579) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_1909 = cute.get_layout(%grouped_1902) : !memref_rmem_bf16_7 loc(#loc311)
      %580 = cute.get_shape(%lay_1909) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_1910, %e1_1911, %e2_1912 = cute.get_leaves(%580) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_1913 = cute.size(%grouped_1889) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1914 = cute.get_leaves(%sz_1913) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_1915 = cute.size(%grouped_1902) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_1916 = cute.get_leaves(%sz_1915) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_1889, %grouped_1902) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_1917 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc445)
      %slice_1918 = cute.slice(%src_partitioned_324, %coord_1917) : !memref_smem_bf16_9, !cute.coord<"(_,_,7)"> loc(#loc445)
      %iter_1919 = cute.get_iter(%slice_1918) : !memref_smem_bf16_16 loc(#loc316)
      %iter_1920 = cute.get_iter(%slice_1918) : !memref_smem_bf16_16 loc(#loc317)
      %coord_1921 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc446)
      %slice_1922 = cute.slice(%retiled_326, %coord_1921) : !memref_rmem_bf16_4, !cute.coord<"(_,_,7)"> loc(#loc446)
      %iter_1923 = cute.get_iter(%slice_1922) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_1924 = cute.get_iter(%slice_1922) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_1925 = cute.get_layout(%slice_1918) : !memref_smem_bf16_16 loc(#loc311)
      %581 = cute.get_shape(%lay_1925) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1926, %e1_1927, %e2_1928 = cute.get_leaves(%581) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1929 = cute.get_layout(%slice_1922) : !memref_rmem_bf16_8 loc(#loc311)
      %582 = cute.get_shape(%lay_1929) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1930, %e1_1931, %e2_1932 = cute.get_leaves(%582) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_1933 = cute.get_layout(%slice_1918) : !memref_smem_bf16_16 loc(#loc397)
      %shape_1934 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1935 = cute.make_layout(%shape_1934) : !cute.layout<"1:0"> loc(#loc397)
      %append_1936 = cute.append_to_rank<2> (%lay_1933, %lay_1935) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1937 = cute.make_view(%iter_1920, %append_1936) : !memref_smem_bf16_16 loc(#loc398)
      %iter_1938 = cute.get_iter(%view_1937) : !memref_smem_bf16_16 loc(#loc331)
      %lay_1939 = cute.get_layout(%view_1937) : !memref_smem_bf16_16 loc(#loc311)
      %583 = cute.get_shape(%lay_1939) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1940, %e1_1941, %e2_1942 = cute.get_leaves(%583) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1943 = cute.group_modes(%view_1937) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_1944 = cute.get_iter(%grouped_1943) : !memref_smem_bf16_17 loc(#loc399)
      %iter_1945 = cute.get_iter(%grouped_1943) : !memref_smem_bf16_17 loc(#loc317)
      %lay_1946 = cute.get_layout(%slice_1922) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_1947 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_1948 = cute.make_layout(%shape_1947) : !cute.layout<"1:0"> loc(#loc397)
      %append_1949 = cute.append_to_rank<2> (%lay_1946, %lay_1948) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_1950 = cute.make_view(%iter_1924, %append_1949) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_1951 = cute.get_iter(%view_1950) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_1952 = cute.get_layout(%view_1950) : !memref_rmem_bf16_8 loc(#loc311)
      %584 = cute.get_shape(%lay_1952) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_1953, %e1_1954, %e2_1955 = cute.get_leaves(%584) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_1956 = cute.group_modes(%view_1950) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_1957 = cute.get_iter(%grouped_1956) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_1958 = cute.get_iter(%grouped_1956) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_1959 = cute.get_layout(%grouped_1943) : !memref_smem_bf16_17 loc(#loc311)
      %585 = cute.get_shape(%lay_1959) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1960, %e1_1961, %e2_1962 = cute.get_leaves(%585) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_1963 = cute.get_layout(%grouped_1956) : !memref_rmem_bf16_9 loc(#loc311)
      %586 = cute.get_shape(%lay_1963) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_1964, %e1_1965, %e2_1966 = cute.get_leaves(%586) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_1967 = cute.size(%grouped_1943) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1968 = cute.get_leaves(%sz_1967) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_1969 = cute.size(%grouped_1956) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_1970 = cute.get_leaves(%sz_1969) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_1943, %grouped_1956) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_1971 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc448)
      %slice_1972 = cute.slice(%frg_A, %coord_1971) : !memref_rmem_bf16_, !cute.coord<"(_,_,6)"> loc(#loc448)
      %iter_1973 = cute.get_iter(%slice_1972) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_1974 = cute.get_iter(%slice_1972) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_1975 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc449)
      %slice_1976 = cute.slice(%frg_B, %coord_1975) : !memref_rmem_bf16_1, !cute.coord<"(_,_,6)"> loc(#loc449)
      %iter_1977 = cute.get_iter(%slice_1976) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_1978 = cute.get_iter(%slice_1976) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_1979 = cute.get_layout(%slice_1972) : !memref_rmem_bf16_10 loc(#loc311)
      %587 = cute.get_shape(%lay_1979) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_1980, %e1_1981, %e2_1982, %e3_1983 = cute.get_leaves(%587) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_1984 = cute.get_layout(%slice_1976) : !memref_rmem_bf16_11 loc(#loc311)
      %588 = cute.get_shape(%lay_1984) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_1985, %e1_1986, %e2_1987 = cute.get_leaves(%588) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_1972, %slice_1976, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      %int_tuple_1988 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
      %sz_1989 = cute.size(%int_tuple_1988) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
      %e0_1990 = cute.get_leaves(%sz_1989) : !cute.int_tuple<"8"> loc(#loc441)
      %coord_1991 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc442)
      %slice_1992 = cute.slice(%src_partitioned_320, %coord_1991) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)"> loc(#loc442)
      %iter_1993 = cute.get_iter(%slice_1992) : !memref_smem_bf16_13 loc(#loc316)
      %iter_1994 = cute.get_iter(%slice_1992) : !memref_smem_bf16_13 loc(#loc317)
      %coord_1995 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc443)
      %slice_1996 = cute.slice(%retiled, %coord_1995) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)"> loc(#loc443)
      %iter_1997 = cute.get_iter(%slice_1996) : !memref_rmem_bf16_6 loc(#loc316)
      %iter_1998 = cute.get_iter(%slice_1996) : !memref_rmem_bf16_6 loc(#loc317)
      %lay_1999 = cute.get_layout(%slice_1992) : !memref_smem_bf16_13 loc(#loc311)
      %589 = cute.get_shape(%lay_1999) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_2000, %e1_2001, %e2_2002 = cute.get_leaves(%589) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_2003 = cute.get_layout(%slice_1996) : !memref_rmem_bf16_6 loc(#loc311)
      %590 = cute.get_shape(%lay_2003) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_2004, %e1_2005, %e2_2006 = cute.get_leaves(%590) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %lay_2007 = cute.get_layout(%slice_1992) : !memref_smem_bf16_13 loc(#loc397)
      %shape_2008 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_2009 = cute.make_layout(%shape_2008) : !cute.layout<"1:0"> loc(#loc397)
      %append_2010 = cute.append_to_rank<2> (%lay_2007, %lay_2009) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
      %view_2011 = cute.make_view(%iter_1994, %append_2010) : !memref_smem_bf16_13 loc(#loc398)
      %iter_2012 = cute.get_iter(%view_2011) : !memref_smem_bf16_13 loc(#loc331)
      %lay_2013 = cute.get_layout(%view_2011) : !memref_smem_bf16_13 loc(#loc311)
      %591 = cute.get_shape(%lay_2013) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_2014, %e1_2015, %e2_2016 = cute.get_leaves(%591) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_2017 = cute.group_modes(%view_2011) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
      %iter_2018 = cute.get_iter(%grouped_2017) : !memref_smem_bf16_14 loc(#loc399)
      %iter_2019 = cute.get_iter(%grouped_2017) : !memref_smem_bf16_14 loc(#loc317)
      %lay_2020 = cute.get_layout(%slice_1996) : !memref_rmem_bf16_6 loc(#loc397)
      %shape_2021 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_2022 = cute.make_layout(%shape_2021) : !cute.layout<"1:0"> loc(#loc397)
      %append_2023 = cute.append_to_rank<2> (%lay_2020, %lay_2022) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_2024 = cute.make_view(%iter_1998, %append_2023) : !memref_rmem_bf16_6 loc(#loc400)
      %iter_2025 = cute.get_iter(%view_2024) : !memref_rmem_bf16_6 loc(#loc331)
      %lay_2026 = cute.get_layout(%view_2024) : !memref_rmem_bf16_6 loc(#loc311)
      %592 = cute.get_shape(%lay_2026) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
      %e0_2027, %e1_2028, %e2_2029 = cute.get_leaves(%592) : !cute.shape<"((8,1),2)"> loc(#loc311)
      %grouped_2030 = cute.group_modes(%view_2024) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
      %iter_2031 = cute.get_iter(%grouped_2030) : !memref_rmem_bf16_7 loc(#loc399)
      %iter_2032 = cute.get_iter(%grouped_2030) : !memref_rmem_bf16_7 loc(#loc317)
      %lay_2033 = cute.get_layout(%grouped_2017) : !memref_smem_bf16_14 loc(#loc311)
      %593 = cute.get_shape(%lay_2033) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_2034, %e1_2035, %e2_2036 = cute.get_leaves(%593) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %lay_2037 = cute.get_layout(%grouped_2030) : !memref_rmem_bf16_7 loc(#loc311)
      %594 = cute.get_shape(%lay_2037) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
      %e0_2038, %e1_2039, %e2_2040 = cute.get_leaves(%594) : !cute.shape<"((8,1),(2))"> loc(#loc311)
      %sz_2041 = cute.size(%grouped_2017) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_2042 = cute.get_leaves(%sz_2041) : !cute.int_tuple<"2"> loc(#loc402)
      %sz_2043 = cute.size(%grouped_2030) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
      %e0_2044 = cute.get_leaves(%sz_2043) : !cute.int_tuple<"2"> loc(#loc402)
      cute.copy(%130, %grouped_2017, %grouped_2030) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
      %coord_2045 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc445)
      %slice_2046 = cute.slice(%src_partitioned_324, %coord_2045) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)"> loc(#loc445)
      %iter_2047 = cute.get_iter(%slice_2046) : !memref_smem_bf16_16 loc(#loc316)
      %iter_2048 = cute.get_iter(%slice_2046) : !memref_smem_bf16_16 loc(#loc317)
      %coord_2049 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc446)
      %slice_2050 = cute.slice(%retiled_326, %coord_2049) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)"> loc(#loc446)
      %iter_2051 = cute.get_iter(%slice_2050) : !memref_rmem_bf16_8 loc(#loc316)
      %iter_2052 = cute.get_iter(%slice_2050) : !memref_rmem_bf16_8 loc(#loc317)
      %lay_2053 = cute.get_layout(%slice_2046) : !memref_smem_bf16_16 loc(#loc311)
      %595 = cute.get_shape(%lay_2053) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_2054, %e1_2055, %e2_2056 = cute.get_leaves(%595) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_2057 = cute.get_layout(%slice_2050) : !memref_rmem_bf16_8 loc(#loc311)
      %596 = cute.get_shape(%lay_2057) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_2058, %e1_2059, %e2_2060 = cute.get_leaves(%596) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %lay_2061 = cute.get_layout(%slice_2046) : !memref_smem_bf16_16 loc(#loc397)
      %shape_2062 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_2063 = cute.make_layout(%shape_2062) : !cute.layout<"1:0"> loc(#loc397)
      %append_2064 = cute.append_to_rank<2> (%lay_2061, %lay_2063) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
      %view_2065 = cute.make_view(%iter_2048, %append_2064) : !memref_smem_bf16_16 loc(#loc398)
      %iter_2066 = cute.get_iter(%view_2065) : !memref_smem_bf16_16 loc(#loc331)
      %lay_2067 = cute.get_layout(%view_2065) : !memref_smem_bf16_16 loc(#loc311)
      %597 = cute.get_shape(%lay_2067) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_2068, %e1_2069, %e2_2070 = cute.get_leaves(%597) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_2071 = cute.group_modes(%view_2065) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
      %iter_2072 = cute.get_iter(%grouped_2071) : !memref_smem_bf16_17 loc(#loc399)
      %iter_2073 = cute.get_iter(%grouped_2071) : !memref_smem_bf16_17 loc(#loc317)
      %lay_2074 = cute.get_layout(%slice_2050) : !memref_rmem_bf16_8 loc(#loc397)
      %shape_2075 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_2076 = cute.make_layout(%shape_2075) : !cute.layout<"1:0"> loc(#loc397)
      %append_2077 = cute.append_to_rank<2> (%lay_2074, %lay_2076) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_2078 = cute.make_view(%iter_2052, %append_2077) : !memref_rmem_bf16_8 loc(#loc400)
      %iter_2079 = cute.get_iter(%view_2078) : !memref_rmem_bf16_8 loc(#loc331)
      %lay_2080 = cute.get_layout(%view_2078) : !memref_rmem_bf16_8 loc(#loc311)
      %598 = cute.get_shape(%lay_2080) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
      %e0_2081, %e1_2082, %e2_2083 = cute.get_leaves(%598) : !cute.shape<"((8,1),4)"> loc(#loc311)
      %grouped_2084 = cute.group_modes(%view_2078) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
      %iter_2085 = cute.get_iter(%grouped_2084) : !memref_rmem_bf16_9 loc(#loc399)
      %iter_2086 = cute.get_iter(%grouped_2084) : !memref_rmem_bf16_9 loc(#loc317)
      %lay_2087 = cute.get_layout(%grouped_2071) : !memref_smem_bf16_17 loc(#loc311)
      %599 = cute.get_shape(%lay_2087) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_2088, %e1_2089, %e2_2090 = cute.get_leaves(%599) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %lay_2091 = cute.get_layout(%grouped_2084) : !memref_rmem_bf16_9 loc(#loc311)
      %600 = cute.get_shape(%lay_2091) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
      %e0_2092, %e1_2093, %e2_2094 = cute.get_leaves(%600) : !cute.shape<"((8,1),(4))"> loc(#loc311)
      %sz_2095 = cute.size(%grouped_2071) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_2096 = cute.get_leaves(%sz_2095) : !cute.int_tuple<"4"> loc(#loc402)
      %sz_2097 = cute.size(%grouped_2084) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
      %e0_2098 = cute.get_leaves(%sz_2097) : !cute.int_tuple<"4"> loc(#loc402)
      cute.copy(%134, %grouped_2071, %grouped_2084) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
      %coord_2099 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc448)
      %slice_2100 = cute.slice(%frg_A, %coord_2099) : !memref_rmem_bf16_, !cute.coord<"(_,_,7)"> loc(#loc448)
      %iter_2101 = cute.get_iter(%slice_2100) : !memref_rmem_bf16_10 loc(#loc316)
      %iter_2102 = cute.get_iter(%slice_2100) : !memref_rmem_bf16_10 loc(#loc317)
      %coord_2103 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc449)
      %slice_2104 = cute.slice(%frg_B, %coord_2103) : !memref_rmem_bf16_1, !cute.coord<"(_,_,7)"> loc(#loc449)
      %iter_2105 = cute.get_iter(%slice_2104) : !memref_rmem_bf16_11 loc(#loc316)
      %iter_2106 = cute.get_iter(%slice_2104) : !memref_rmem_bf16_11 loc(#loc317)
      %lay_2107 = cute.get_layout(%slice_2100) : !memref_rmem_bf16_10 loc(#loc311)
      %601 = cute.get_shape(%lay_2107) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %e0_2108, %e1_2109, %e2_2110, %e3_2111 = cute.get_leaves(%601) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
      %lay_2112 = cute.get_layout(%slice_2104) : !memref_rmem_bf16_11 loc(#loc311)
      %602 = cute.get_shape(%lay_2112) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
      %e0_2113, %e1_2114, %e2_2115 = cute.get_leaves(%602) : !cute.shape<"((2,2),8)"> loc(#loc311)
      cute.gemm(%arg10, %rmem_956, %slice_2100, %slice_2104, %rmem_956) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
      nvvm.cp.async.wait.group 0 loc(#loc451)
      %c1_i32_2116 = arith.constant 1 : i32 loc(#loc452)
      %c128_i32_2117 = arith.constant 128 : i32 loc(#loc452)
      nvvm.barrier id = %c1_i32_2116 number_of_threads = %c128_i32_2117 loc(#loc452)
      %603 = arith.cmpi sgt, %474, %c0_i32 : i32 loc(#loc313)
      scf.if %603 {
        %c1_i32_6349 = arith.constant 1 : i32 loc(#loc290)
        %2346 = arith.subi %474, %c1_i32_6349 : i32 loc(#loc313)
        %coord_6350 = cute.make_coord(%2346) : (i32) -> !cute.coord<"(_,_,_,?)"> loc(#loc453)
        %slice_6351 = cute.slice(%src_partitioned_236, %coord_6350) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)"> loc(#loc453)
        %iter_6352 = cute.get_iter(%slice_6351) : !memref_gmem_bf16_8 loc(#loc316)
        %iter_6353 = cute.get_iter(%slice_6351) : !memref_gmem_bf16_8 loc(#loc317)
        %lay_6354 = cute.get_layout(%slice_6351) : !memref_gmem_bf16_8 loc(#loc311)
        %2347 = cute.get_shape(%lay_6354) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %lay_6359 = cute.get_layout(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc311)
        %2348 = cute.get_shape(%lay_6359) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6360, %e1_6361, %e2_6362, %e3_6363 = cute.get_leaves(%2348) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %lay_6364 = cute.get_layout(%slice_6351) : !memref_gmem_bf16_8 loc(#loc397)
        %shape_6365 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6366 = cute.make_layout(%shape_6365) : !cute.layout<"1:0"> loc(#loc397)
        %append_6367 = cute.append_to_rank<2> (%lay_6364, %lay_6366) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6368 = cute.make_view(%iter_6353, %append_6367) : !memref_gmem_bf16_8 loc(#loc398)
        %iter_6369 = cute.get_iter(%view_6368) : !memref_gmem_bf16_8 loc(#loc331)
        %lay_6370 = cute.get_layout(%view_6368) : !memref_gmem_bf16_8 loc(#loc311)
        %2349 = cute.get_shape(%lay_6370) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6371, %e1_6372, %e2_6373, %e3_6374 = cute.get_leaves(%2349) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %grouped_6375 = cute.group_modes(%view_6368) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9 loc(#loc398)
        %iter_6376 = cute.get_iter(%grouped_6375) : !memref_gmem_bf16_9 loc(#loc399)
        %iter_6377 = cute.get_iter(%grouped_6375) : !memref_gmem_bf16_9 loc(#loc317)
        %lay_6378 = cute.get_layout(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc397)
        %shape_6379 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6380 = cute.make_layout(%shape_6379) : !cute.layout<"1:0"> loc(#loc397)
        %append_6381 = cute.append_to_rank<2> (%lay_6378, %lay_6380) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6382 = cute.make_view(%iter_240, %append_6381) : !memref_smem_bf16_4 loc(#loc400)
        %iter_6383 = cute.get_iter(%view_6382) : !memref_smem_bf16_4 loc(#loc331)
        %lay_6384 = cute.get_layout(%view_6382) : !memref_smem_bf16_4 loc(#loc311)
        %2350 = cute.get_shape(%lay_6384) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %e0_6385, %e1_6386, %e2_6387, %e3_6388 = cute.get_leaves(%2350) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
        %grouped_6389 = cute.group_modes(%view_6382) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15 loc(#loc400)
        %iter_6390 = cute.get_iter(%grouped_6389) : !memref_smem_bf16_15 loc(#loc399)
        %iter_6391 = cute.get_iter(%grouped_6389) : !memref_smem_bf16_15 loc(#loc317)
        %lay_6392 = cute.get_layout(%rmem_448) : !memref_rmem_i8_1 loc(#loc397)
        %shape_6393 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6394 = cute.make_layout(%shape_6393) : !cute.layout<"1:0"> loc(#loc397)
        %append_6395 = cute.append_to_rank<2> (%lay_6392, %lay_6394) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6396 = cute.make_view(%iter_450, %append_6395) : !memref_rmem_i8_1 loc(#loc401)
        %iter_6397 = cute.get_iter(%view_6396) : !memref_rmem_i8_1 loc(#loc331)
        %lay_6398 = cute.get_layout(%view_6396) : !memref_rmem_i8_1 loc(#loc311)
        %2351 = cute.get_shape(%lay_6398) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)"> loc(#loc311)
        %e0_6399, %e1_6400, %e2_6401 = cute.get_leaves(%2351) : !cute.shape<"(1,4,2)"> loc(#loc311)
        %grouped_6402 = cute.group_modes(%view_6396) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4 loc(#loc401)
        %iter_6403 = cute.get_iter(%grouped_6402) : !memref_rmem_i8_4 loc(#loc399)
        %iter_6404 = cute.get_iter(%grouped_6402) : !memref_rmem_i8_4 loc(#loc317)
        %lay_6405 = cute.get_layout(%grouped_6375) : !memref_gmem_bf16_9 loc(#loc311)
        %2352 = cute.get_shape(%lay_6405) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_6406, %e1_6407, %e2_6408, %e3_6409 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_6410 = cute.get_layout(%grouped_6389) : !memref_smem_bf16_15 loc(#loc311)
        %2353 = cute.get_shape(%lay_6410) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_6411, %e1_6412, %e2_6413, %e3_6414 = cute.get_leaves(%2353) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6375) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6389) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%arg8, %grouped_6375, %grouped_6389, %grouped_6402) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4) loc(#loc454)
        nvvm.cp.async.commit.group loc(#loc455)
      } loc(#loc290)
      %lay_2118 = cute.get_layout(%rmem_956) : !memref_rmem_f32_2 loc(#loc456)
      %604 = cute.get_shape(%lay_2118) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %e0_2119, %e1_2120, %e2_2121, %e3_2122 = cute.get_leaves(%604) : !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %shape_2123 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %lay_2124 = cute.make_layout(%shape_2123) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc456)
      %605 = cute.get_shape(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc457)
      %e0_2125, %e1_2126, %e2_2127, %e3_2128 = cute.get_leaves(%605) : !cute.shape<"((2,2),2,8)"> loc(#loc457)
      %606 = cute.get_shape(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc458)
      %e0_2129, %e1_2130, %e2_2131, %e3_2132 = cute.get_leaves(%606) : !cute.shape<"((2,2),2,8)"> loc(#loc458)
      %607 = cute.get_shape(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc459)
      %e0_2133, %e1_2134, %e2_2135, %e3_2136 = cute.get_leaves(%607) : !cute.shape<"((2,2),2,8)"> loc(#loc459)
      %608 = cute.get_shape(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc460)
      %e0_2137, %e1_2138, %e2_2139, %e3_2140 = cute.get_leaves(%608) : !cute.shape<"((2,2),2,8)"> loc(#loc460)
      %609 = cute.get_stride(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %e0_2141, %e1_2142, %e2_2143, %e3_2144 = cute.get_leaves(%609) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %610 = cute.get_stride(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %e0_2145, %e1_2146, %e2_2147, %e3_2148 = cute.get_leaves(%610) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %611 = cute.get_stride(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %e0_2149, %e1_2150, %e2_2151, %e3_2152 = cute.get_leaves(%611) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %612 = cute.get_stride(%lay_2124) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %e0_2153, %e1_2154, %e2_2155, %e3_2156 = cute.get_leaves(%612) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %shape_2157 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))"> loc(#loc465)
      %stride_2158 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
      %lay_2159 = cute.make_layout(%shape_2157, %stride_2158) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))"> loc(#loc465)
      %lay_2160 = cute.get_layout(%rmem_956) : !memref_rmem_f32_2 loc(#loc466)
      %613 = cute.composition(%lay_2160, %lay_2159) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((2,4),(1,8))"> loc(#loc466)
      %view_2161 = cute.make_view(%iter_958, %613) : !memref_rmem_f32_3 loc(#loc467)
      %iter_2162 = cute.get_iter(%view_2161) : !memref_rmem_f32_3 loc(#loc331)
      %lay_2163 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc456)
      %614 = cute.get_shape(%lay_2163) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %e0_2164, %e1_2165, %e2_2166, %e3_2167 = cute.get_leaves(%614) : !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %shape_2168 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %lay_2169 = cute.make_layout(%shape_2168) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> loc(#loc456)
      %615 = cute.get_shape(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc457)
      %e0_2170, %e1_2171, %e2_2172, %e3_2173 = cute.get_leaves(%615) : !cute.shape<"((2,2),2,16)"> loc(#loc457)
      %616 = cute.get_shape(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc458)
      %e0_2174, %e1_2175, %e2_2176, %e3_2177 = cute.get_leaves(%616) : !cute.shape<"((2,2),2,16)"> loc(#loc458)
      %617 = cute.get_shape(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc459)
      %e0_2178, %e1_2179, %e2_2180, %e3_2181 = cute.get_leaves(%617) : !cute.shape<"((2,2),2,16)"> loc(#loc459)
      %618 = cute.get_shape(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc460)
      %e0_2182, %e1_2183, %e2_2184, %e3_2185 = cute.get_leaves(%618) : !cute.shape<"((2,2),2,16)"> loc(#loc460)
      %619 = cute.get_stride(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %e0_2186, %e1_2187, %e2_2188, %e3_2189 = cute.get_leaves(%619) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %620 = cute.get_stride(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %e0_2190, %e1_2191, %e2_2192, %e3_2193 = cute.get_leaves(%620) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %621 = cute.get_stride(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %e0_2194, %e1_2195, %e2_2196, %e3_2197 = cute.get_leaves(%621) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %622 = cute.get_stride(%lay_2169) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %e0_2198, %e1_2199, %e2_2200, %e3_2201 = cute.get_leaves(%622) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %shape_2202 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))"> loc(#loc465)
      %stride_2203 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
      %lay_2204 = cute.make_layout(%shape_2202, %stride_2203) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc465)
      %lay_2205 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc466)
      %623 = cute.composition(%lay_2205, %lay_2204) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc466)
      %view_2206 = cute.make_view(%iter_266, %623) : !memref_rmem_f32_4 loc(#loc467)
      %iter_2207 = cute.get_iter(%view_2206) : !memref_rmem_f32_4 loc(#loc331)
      %lay_2208 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc311)
      %624 = cute.get_shape(%lay_2208) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %e0_2209, %e1_2210, %e2_2211, %e3_2212 = cute.get_leaves(%624) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %itup_2213 = cute.to_int_tuple(%e0_2209) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %625 = cute.get_scalars(%itup_2213) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2214 = cute.to_int_tuple(%e1_2210) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %626 = cute.get_scalars(%itup_2214) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2215 = cute.to_int_tuple(%e2_2211) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %627 = cute.get_scalars(%itup_2215) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2216 = cute.to_int_tuple(%e3_2212) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %628 = cute.get_scalars(%itup_2216) : !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %lay_2217 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc311)
      %629 = cute.get_shape(%lay_2217) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %e0_2218, %e1_2219, %e2_2220, %e3_2221 = cute.get_leaves(%629) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
      %itup_2222 = cute.to_int_tuple(%e0_2218) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %630 = cute.get_scalars(%itup_2222) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2223 = cute.to_int_tuple(%e1_2219) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %631 = cute.get_scalars(%itup_2223) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2224 = cute.to_int_tuple(%e2_2220) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
      %632 = cute.get_scalars(%itup_2224) : !cute.int_tuple<"?"> loc(#loc311)
      %itup_2225 = cute.to_int_tuple(%e3_2221) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %633 = cute.get_scalars(%itup_2225) : !cute.int_tuple<"?{div=8}"> loc(#loc311)
      %shape_2226 = cute.make_shape(%itup_2213, %itup_2214, %itup_2215, %itup_2223) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?,?,?)"> loc(#loc468)
      %634 = cute.make_identity_tensor(%shape_2226) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)"> loc(#loc468)
      %iter_2227 = cute.get_iter(%634) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)"> loc(#loc370)
      %e0_2228, %e1_2229, %e2_2230, %e3_2231 = cute.get_leaves(%iter_2227) : !cute.int_tuple<"(0,0,0,0)"> loc(#loc298)
      %coord_2232 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc469)
      %slice_2233 = cute.slice(%634, %coord_2232) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)"> loc(#loc469)
      %iter_2234 = cute.get_iter(%slice_2233) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)"> loc(#loc316)
      %e0_2235, %e1_2236, %e2_2237, %e3_2238 = cute.get_leaves(%iter_2234) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %635 = cute.get_scalars(%e0_2235) : !cute.int_tuple<"?"> loc(#loc290)
      %636 = cute.get_scalars(%e2_2237) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2239 = cute.get_iter(%slice_2233) : !cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)"> loc(#loc317)
      %e0_2240, %e1_2241, %e2_2242, %e3_2243 = cute.get_leaves(%iter_2239) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %637 = cute.get_scalars(%e0_2240) : !cute.int_tuple<"?"> loc(#loc290)
      %638 = cute.get_scalars(%e2_2242) : !cute.int_tuple<"?"> loc(#loc290)
      %tile_2244 = cute.make_tile() : () -> !cute.tile<"[128:1;64:1]"> loc(#loc470)
      %coord_2245 = cute.make_coord(%111, %474) : (i32, i32) -> !cute.coord<"(?,?)"> loc(#loc470)
      %tiled_view_2246 = cute.local_tile(%slice_2233, %tile_2244, %coord_2245) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?):(1@1,1@3)">, !cute.tile<"[128:1;64:1]">, !cute.coord<"(?,?)">) -> !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)"> loc(#loc470)
      %iter_2247 = cute.get_iter(%tiled_view_2246) : !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)"> loc(#loc319)
      %e0_2248, %e1_2249, %e2_2250, %e3_2251 = cute.get_leaves(%iter_2247) : !cute.int_tuple<"(?,?{div=128},?,?{div=64})"> loc(#loc298)
      %639 = cute.get_scalars(%e0_2248) : !cute.int_tuple<"?"> loc(#loc290)
      %640 = cute.get_scalars(%e1_2249) : !cute.int_tuple<"?{div=128}"> loc(#loc290)
      %641 = cute.get_scalars(%e2_2250) : !cute.int_tuple<"?"> loc(#loc290)
      %642 = cute.get_scalars(%e3_2251) : !cute.int_tuple<"?{div=64}"> loc(#loc290)
      %coord_2252 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc471)
      %ptn_C = cute.tiled.mma.partition C (%arg10, %tiled_view_2246, %coord_2252) : (!mma_bf16_bf16_f32_16x8x16_, !cute.coord_tensor<"(?,?{div=128},?,?{div=64})", "(128,64):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)"> loc(#loc471)
      %iter_2253 = cute.get_iter(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)"> loc(#loc344)
      %e0_2254, %e1_2255, %e2_2256, %e3_2257 = cute.get_leaves(%iter_2253) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %643 = cute.get_scalars(%e0_2254) : !cute.int_tuple<"?"> loc(#loc290)
      %644 = cute.get_scalars(%e1_2255) : !cute.int_tuple<"?"> loc(#loc290)
      %645 = cute.get_scalars(%e2_2256) : !cute.int_tuple<"?"> loc(#loc290)
      %646 = cute.get_scalars(%e3_2257) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %lay_2258 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)"> loc(#loc456)
      %647 = cute.get_shape(%lay_2258) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %e0_2259, %e1_2260, %e2_2261, %e3_2262 = cute.get_leaves(%647) : !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %shape_2263 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
      %lay_2264 = cute.make_layout(%shape_2263) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc456)
      %648 = cute.get_shape(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc457)
      %e0_2265, %e1_2266, %e2_2267, %e3_2268 = cute.get_leaves(%648) : !cute.shape<"((2,2),2,8)"> loc(#loc457)
      %649 = cute.get_shape(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc458)
      %e0_2269, %e1_2270, %e2_2271, %e3_2272 = cute.get_leaves(%649) : !cute.shape<"((2,2),2,8)"> loc(#loc458)
      %650 = cute.get_shape(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc459)
      %e0_2273, %e1_2274, %e2_2275, %e3_2276 = cute.get_leaves(%650) : !cute.shape<"((2,2),2,8)"> loc(#loc459)
      %651 = cute.get_shape(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc460)
      %e0_2277, %e1_2278, %e2_2279, %e3_2280 = cute.get_leaves(%651) : !cute.shape<"((2,2),2,8)"> loc(#loc460)
      %652 = cute.get_stride(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %e0_2281, %e1_2282, %e2_2283, %e3_2284 = cute.get_leaves(%652) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %653 = cute.get_stride(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %e0_2285, %e1_2286, %e2_2287, %e3_2288 = cute.get_leaves(%653) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %654 = cute.get_stride(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %e0_2289, %e1_2290, %e2_2291, %e3_2292 = cute.get_leaves(%654) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %655 = cute.get_stride(%lay_2264) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %e0_2293, %e1_2294, %e2_2295, %e3_2296 = cute.get_leaves(%655) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %shape_2297 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))"> loc(#loc465)
      %stride_2298 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
      %lay_2299 = cute.make_layout(%shape_2297, %stride_2298) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))"> loc(#loc465)
      %lay_2300 = cute.get_layout(%ptn_C) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),2,8):((1@3,8@1),64@1,8@3)"> loc(#loc466)
      %656 = cute.composition(%lay_2300, %lay_2299) : (!cute.layout<"((2,2),2,8):((1@3,8@1),64@1,8@3)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))"> loc(#loc466)
      %int_tuple_2301 = cute.make_int_tuple(%e0_2254, %e1_2255, %e2_2256, %e3_2257) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=2}">) -> !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc467)
      %view_2302 = cute.make_view(%int_tuple_2301, %656) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))"> loc(#loc467)
      %iter_2303 = cute.get_iter(%view_2302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))"> loc(#loc331)
      %e0_2304, %e1_2305, %e2_2306, %e3_2307 = cute.get_leaves(%iter_2303) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %657 = cute.get_scalars(%e0_2304) : !cute.int_tuple<"?"> loc(#loc290)
      %658 = cute.get_scalars(%e1_2305) : !cute.int_tuple<"?"> loc(#loc290)
      %659 = cute.get_scalars(%e2_2306) : !cute.int_tuple<"?"> loc(#loc290)
      %660 = cute.get_scalars(%e3_2307) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %sz_2308 = cute.size(%rmem_919) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4"> loc(#loc472)
      %e0_2309 = cute.get_leaves(%sz_2308) : !cute.int_tuple<"4"> loc(#loc472)
      %lay_2310 = cute.get_layout(%view_2302) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))"> loc(#loc311)
      %661 = cute.get_shape(%lay_2310) : (!cute.layout<"((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc311)
      %e0_2311, %e1_2312, %e2_2313, %e3_2314 = cute.get_leaves(%661) : !cute.shape<"((2,2),(2,8))"> loc(#loc311)
      %int_tuple_2315 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)"> loc(#loc473)
      %sz_2316 = cute.size(%int_tuple_2315) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16"> loc(#loc473)
      %e0_2317 = cute.get_leaves(%sz_2316) : !cute.int_tuple<"16"> loc(#loc473)
      %coord_2318 = cute.make_coord() : () -> !cute.coord<"(0,0)"> loc(#loc474)
      %slice_2319 = cute.slice(%view_2302, %coord_2318) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)"> loc(#loc474)
      %iter_2320 = cute.get_iter(%slice_2319) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2321, %e1_2322, %e2_2323, %e3_2324 = cute.get_leaves(%iter_2320) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %662 = cute.get_scalars(%e0_2321) : !cute.int_tuple<"?"> loc(#loc290)
      %663 = cute.get_scalars(%e1_2322) : !cute.int_tuple<"?"> loc(#loc290)
      %664 = cute.get_scalars(%e2_2323) : !cute.int_tuple<"?"> loc(#loc290)
      %665 = cute.get_scalars(%e3_2324) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2325 = cute.get_iter(%slice_2319) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2326, %e1_2327, %e2_2328, %e3_2329 = cute.get_leaves(%iter_2325) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %666 = cute.get_scalars(%e0_2326) : !cute.int_tuple<"?"> loc(#loc290)
      %667 = cute.get_scalars(%e1_2327) : !cute.int_tuple<"?"> loc(#loc290)
      %668 = cute.get_scalars(%e2_2328) : !cute.int_tuple<"?"> loc(#loc290)
      %669 = cute.get_scalars(%e3_2329) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2330 = cute.get_iter(%slice_2319) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2331, %e1_2332, %e2_2333, %e3_2334 = cute.get_leaves(%iter_2330) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %670 = cute.get_scalars(%e0_2331) : !cute.int_tuple<"?"> loc(#loc474)
      %671 = cute.get_scalars(%e1_2332) : !cute.int_tuple<"?"> loc(#loc474)
      %672 = cute.get_scalars(%e2_2333) : !cute.int_tuple<"?"> loc(#loc474)
      %673 = cute.get_scalars(%e3_2334) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2335 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup = cute.add_offset(%e3_2334, %int_tuple_2335) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %674 = cute.get_scalars(%tup) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2336 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2337 = cute.make_coord(%tup) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %675 = cute.elem_less(%coord_2336, %coord_2337) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2338 = cute.get_layout(%view_2161) : !memref_rmem_f32_3 loc(#loc294)
      %676 = cute.get_shape(%lay_2338) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2339, %e1_2340, %e2_2341, %e3_2342 = cute.get_leaves(%676) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %677 = cute.get_stride(%lay_2338) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2343, %e1_2344, %e2_2345, %e3_2346 = cute.get_leaves(%677) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %678 = scf.if %675 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%view_2161) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,0)"> loc(#loc477)
        cute.memref.store(%view_2161, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,0)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%view_2161) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %view_2161 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%view_2161) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%view_2161) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %view_2161 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2347 = cute.get_iter(%678) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2348 = cute.get_layout(%678) : !memref_rmem_f32_3 loc(#loc294)
      %679 = cute.get_shape(%lay_2348) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2349, %e1_2350, %e2_2351, %e3_2352 = cute.get_leaves(%679) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %680 = cute.get_stride(%lay_2348) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2353, %e1_2354, %e2_2355, %e3_2356 = cute.get_leaves(%680) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2357 = cute.get_iter(%678) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2358 = cute.get_iter(%678) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2359 = cute.make_coord() : () -> !cute.coord<"(0,1)"> loc(#loc474)
      %slice_2360 = cute.slice(%view_2302, %coord_2359) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)"> loc(#loc474)
      %iter_2361 = cute.get_iter(%slice_2360) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2362, %e1_2363, %e2_2364, %e3_2365 = cute.get_leaves(%iter_2361) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %681 = cute.get_scalars(%e0_2362) : !cute.int_tuple<"?"> loc(#loc290)
      %682 = cute.get_scalars(%e1_2363) : !cute.int_tuple<"?"> loc(#loc290)
      %683 = cute.get_scalars(%e2_2364) : !cute.int_tuple<"?"> loc(#loc290)
      %684 = cute.get_scalars(%e3_2365) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2366 = cute.get_iter(%slice_2360) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2367, %e1_2368, %e2_2369, %e3_2370 = cute.get_leaves(%iter_2366) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %685 = cute.get_scalars(%e0_2367) : !cute.int_tuple<"?"> loc(#loc290)
      %686 = cute.get_scalars(%e1_2368) : !cute.int_tuple<"?"> loc(#loc290)
      %687 = cute.get_scalars(%e2_2369) : !cute.int_tuple<"?"> loc(#loc290)
      %688 = cute.get_scalars(%e3_2370) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2371 = cute.get_iter(%slice_2360) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2372, %e1_2373, %e2_2374, %e3_2375 = cute.get_leaves(%iter_2371) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %689 = cute.get_scalars(%e0_2372) : !cute.int_tuple<"?"> loc(#loc474)
      %690 = cute.get_scalars(%e1_2373) : !cute.int_tuple<"?"> loc(#loc474)
      %691 = cute.get_scalars(%e2_2374) : !cute.int_tuple<"?"> loc(#loc474)
      %692 = cute.get_scalars(%e3_2375) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2376 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2377 = cute.add_offset(%e3_2375, %int_tuple_2376) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %693 = cute.get_scalars(%tup_2377) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2378 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2379 = cute.make_coord(%tup_2377) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %694 = cute.elem_less(%coord_2378, %coord_2379) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2380 = cute.get_layout(%678) : !memref_rmem_f32_3 loc(#loc294)
      %695 = cute.get_shape(%lay_2380) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2381, %e1_2382, %e2_2383, %e3_2384 = cute.get_leaves(%695) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %696 = cute.get_stride(%lay_2380) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2385, %e1_2386, %e2_2387, %e3_2388 = cute.get_leaves(%696) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %697 = scf.if %694 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%678) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,1)"> loc(#loc477)
        cute.memref.store(%678, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,1)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%678) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %678 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%678) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%678) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %678 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2389 = cute.get_iter(%697) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2390 = cute.get_layout(%697) : !memref_rmem_f32_3 loc(#loc294)
      %698 = cute.get_shape(%lay_2390) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2391, %e1_2392, %e2_2393, %e3_2394 = cute.get_leaves(%698) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %699 = cute.get_stride(%lay_2390) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2395, %e1_2396, %e2_2397, %e3_2398 = cute.get_leaves(%699) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2399 = cute.get_iter(%697) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2400 = cute.get_iter(%697) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2401 = cute.make_coord() : () -> !cute.coord<"(0,2)"> loc(#loc474)
      %slice_2402 = cute.slice(%view_2302, %coord_2401) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)"> loc(#loc474)
      %iter_2403 = cute.get_iter(%slice_2402) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2404, %e1_2405, %e2_2406, %e3_2407 = cute.get_leaves(%iter_2403) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %700 = cute.get_scalars(%e0_2404) : !cute.int_tuple<"?"> loc(#loc290)
      %701 = cute.get_scalars(%e1_2405) : !cute.int_tuple<"?"> loc(#loc290)
      %702 = cute.get_scalars(%e2_2406) : !cute.int_tuple<"?"> loc(#loc290)
      %703 = cute.get_scalars(%e3_2407) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2408 = cute.get_iter(%slice_2402) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2409, %e1_2410, %e2_2411, %e3_2412 = cute.get_leaves(%iter_2408) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %704 = cute.get_scalars(%e0_2409) : !cute.int_tuple<"?"> loc(#loc290)
      %705 = cute.get_scalars(%e1_2410) : !cute.int_tuple<"?"> loc(#loc290)
      %706 = cute.get_scalars(%e2_2411) : !cute.int_tuple<"?"> loc(#loc290)
      %707 = cute.get_scalars(%e3_2412) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2413 = cute.get_iter(%slice_2402) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2414, %e1_2415, %e2_2416, %e3_2417 = cute.get_leaves(%iter_2413) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %708 = cute.get_scalars(%e0_2414) : !cute.int_tuple<"?"> loc(#loc474)
      %709 = cute.get_scalars(%e1_2415) : !cute.int_tuple<"?"> loc(#loc474)
      %710 = cute.get_scalars(%e2_2416) : !cute.int_tuple<"?"> loc(#loc474)
      %711 = cute.get_scalars(%e3_2417) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2418 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2419 = cute.add_offset(%e3_2417, %int_tuple_2418) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %712 = cute.get_scalars(%tup_2419) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2420 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2421 = cute.make_coord(%tup_2419) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %713 = cute.elem_less(%coord_2420, %coord_2421) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2422 = cute.get_layout(%697) : !memref_rmem_f32_3 loc(#loc294)
      %714 = cute.get_shape(%lay_2422) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2423, %e1_2424, %e2_2425, %e3_2426 = cute.get_leaves(%714) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %715 = cute.get_stride(%lay_2422) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2427, %e1_2428, %e2_2429, %e3_2430 = cute.get_leaves(%715) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %716 = scf.if %713 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%697) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,2)"> loc(#loc477)
        cute.memref.store(%697, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,2)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%697) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %697 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%697) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%697) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %697 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2431 = cute.get_iter(%716) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2432 = cute.get_layout(%716) : !memref_rmem_f32_3 loc(#loc294)
      %717 = cute.get_shape(%lay_2432) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2433, %e1_2434, %e2_2435, %e3_2436 = cute.get_leaves(%717) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %718 = cute.get_stride(%lay_2432) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2437, %e1_2438, %e2_2439, %e3_2440 = cute.get_leaves(%718) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2441 = cute.get_iter(%716) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2442 = cute.get_iter(%716) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2443 = cute.make_coord() : () -> !cute.coord<"(0,3)"> loc(#loc474)
      %slice_2444 = cute.slice(%view_2302, %coord_2443) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)"> loc(#loc474)
      %iter_2445 = cute.get_iter(%slice_2444) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2446, %e1_2447, %e2_2448, %e3_2449 = cute.get_leaves(%iter_2445) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %719 = cute.get_scalars(%e0_2446) : !cute.int_tuple<"?"> loc(#loc290)
      %720 = cute.get_scalars(%e1_2447) : !cute.int_tuple<"?"> loc(#loc290)
      %721 = cute.get_scalars(%e2_2448) : !cute.int_tuple<"?"> loc(#loc290)
      %722 = cute.get_scalars(%e3_2449) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2450 = cute.get_iter(%slice_2444) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2451, %e1_2452, %e2_2453, %e3_2454 = cute.get_leaves(%iter_2450) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %723 = cute.get_scalars(%e0_2451) : !cute.int_tuple<"?"> loc(#loc290)
      %724 = cute.get_scalars(%e1_2452) : !cute.int_tuple<"?"> loc(#loc290)
      %725 = cute.get_scalars(%e2_2453) : !cute.int_tuple<"?"> loc(#loc290)
      %726 = cute.get_scalars(%e3_2454) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2455 = cute.get_iter(%slice_2444) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2456, %e1_2457, %e2_2458, %e3_2459 = cute.get_leaves(%iter_2455) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %727 = cute.get_scalars(%e0_2456) : !cute.int_tuple<"?"> loc(#loc474)
      %728 = cute.get_scalars(%e1_2457) : !cute.int_tuple<"?"> loc(#loc474)
      %729 = cute.get_scalars(%e2_2458) : !cute.int_tuple<"?"> loc(#loc474)
      %730 = cute.get_scalars(%e3_2459) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2460 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2461 = cute.add_offset(%e3_2459, %int_tuple_2460) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %731 = cute.get_scalars(%tup_2461) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2462 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2463 = cute.make_coord(%tup_2461) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %732 = cute.elem_less(%coord_2462, %coord_2463) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2464 = cute.get_layout(%716) : !memref_rmem_f32_3 loc(#loc294)
      %733 = cute.get_shape(%lay_2464) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2465, %e1_2466, %e2_2467, %e3_2468 = cute.get_leaves(%733) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %734 = cute.get_stride(%lay_2464) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2469, %e1_2470, %e2_2471, %e3_2472 = cute.get_leaves(%734) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %735 = scf.if %732 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%716) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,3)"> loc(#loc477)
        cute.memref.store(%716, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,3)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%716) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %716 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%716) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%716) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %716 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2473 = cute.get_iter(%735) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2474 = cute.get_layout(%735) : !memref_rmem_f32_3 loc(#loc294)
      %736 = cute.get_shape(%lay_2474) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2475, %e1_2476, %e2_2477, %e3_2478 = cute.get_leaves(%736) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %737 = cute.get_stride(%lay_2474) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2479, %e1_2480, %e2_2481, %e3_2482 = cute.get_leaves(%737) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2483 = cute.get_iter(%735) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2484 = cute.get_iter(%735) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2485 = cute.make_coord() : () -> !cute.coord<"(0,4)"> loc(#loc474)
      %slice_2486 = cute.slice(%view_2302, %coord_2485) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)"> loc(#loc474)
      %iter_2487 = cute.get_iter(%slice_2486) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2488, %e1_2489, %e2_2490, %e3_2491 = cute.get_leaves(%iter_2487) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %738 = cute.get_scalars(%e0_2488) : !cute.int_tuple<"?"> loc(#loc290)
      %739 = cute.get_scalars(%e1_2489) : !cute.int_tuple<"?"> loc(#loc290)
      %740 = cute.get_scalars(%e2_2490) : !cute.int_tuple<"?"> loc(#loc290)
      %741 = cute.get_scalars(%e3_2491) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2492 = cute.get_iter(%slice_2486) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2493, %e1_2494, %e2_2495, %e3_2496 = cute.get_leaves(%iter_2492) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %742 = cute.get_scalars(%e0_2493) : !cute.int_tuple<"?"> loc(#loc290)
      %743 = cute.get_scalars(%e1_2494) : !cute.int_tuple<"?"> loc(#loc290)
      %744 = cute.get_scalars(%e2_2495) : !cute.int_tuple<"?"> loc(#loc290)
      %745 = cute.get_scalars(%e3_2496) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2497 = cute.get_iter(%slice_2486) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2498, %e1_2499, %e2_2500, %e3_2501 = cute.get_leaves(%iter_2497) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %746 = cute.get_scalars(%e0_2498) : !cute.int_tuple<"?"> loc(#loc474)
      %747 = cute.get_scalars(%e1_2499) : !cute.int_tuple<"?"> loc(#loc474)
      %748 = cute.get_scalars(%e2_2500) : !cute.int_tuple<"?"> loc(#loc474)
      %749 = cute.get_scalars(%e3_2501) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2502 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2503 = cute.add_offset(%e3_2501, %int_tuple_2502) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %750 = cute.get_scalars(%tup_2503) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2504 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2505 = cute.make_coord(%tup_2503) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %751 = cute.elem_less(%coord_2504, %coord_2505) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2506 = cute.get_layout(%735) : !memref_rmem_f32_3 loc(#loc294)
      %752 = cute.get_shape(%lay_2506) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2507, %e1_2508, %e2_2509, %e3_2510 = cute.get_leaves(%752) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %753 = cute.get_stride(%lay_2506) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2511, %e1_2512, %e2_2513, %e3_2514 = cute.get_leaves(%753) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %754 = scf.if %751 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%735) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,4)"> loc(#loc477)
        cute.memref.store(%735, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,4)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%735) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %735 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%735) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%735) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %735 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2515 = cute.get_iter(%754) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2516 = cute.get_layout(%754) : !memref_rmem_f32_3 loc(#loc294)
      %755 = cute.get_shape(%lay_2516) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2517, %e1_2518, %e2_2519, %e3_2520 = cute.get_leaves(%755) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %756 = cute.get_stride(%lay_2516) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2521, %e1_2522, %e2_2523, %e3_2524 = cute.get_leaves(%756) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2525 = cute.get_iter(%754) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2526 = cute.get_iter(%754) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2527 = cute.make_coord() : () -> !cute.coord<"(0,5)"> loc(#loc474)
      %slice_2528 = cute.slice(%view_2302, %coord_2527) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)"> loc(#loc474)
      %iter_2529 = cute.get_iter(%slice_2528) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2530, %e1_2531, %e2_2532, %e3_2533 = cute.get_leaves(%iter_2529) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %757 = cute.get_scalars(%e0_2530) : !cute.int_tuple<"?"> loc(#loc290)
      %758 = cute.get_scalars(%e1_2531) : !cute.int_tuple<"?"> loc(#loc290)
      %759 = cute.get_scalars(%e2_2532) : !cute.int_tuple<"?"> loc(#loc290)
      %760 = cute.get_scalars(%e3_2533) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2534 = cute.get_iter(%slice_2528) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2535, %e1_2536, %e2_2537, %e3_2538 = cute.get_leaves(%iter_2534) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %761 = cute.get_scalars(%e0_2535) : !cute.int_tuple<"?"> loc(#loc290)
      %762 = cute.get_scalars(%e1_2536) : !cute.int_tuple<"?"> loc(#loc290)
      %763 = cute.get_scalars(%e2_2537) : !cute.int_tuple<"?"> loc(#loc290)
      %764 = cute.get_scalars(%e3_2538) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2539 = cute.get_iter(%slice_2528) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2540, %e1_2541, %e2_2542, %e3_2543 = cute.get_leaves(%iter_2539) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %765 = cute.get_scalars(%e0_2540) : !cute.int_tuple<"?"> loc(#loc474)
      %766 = cute.get_scalars(%e1_2541) : !cute.int_tuple<"?"> loc(#loc474)
      %767 = cute.get_scalars(%e2_2542) : !cute.int_tuple<"?"> loc(#loc474)
      %768 = cute.get_scalars(%e3_2543) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2544 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2545 = cute.add_offset(%e3_2543, %int_tuple_2544) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %769 = cute.get_scalars(%tup_2545) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2546 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2547 = cute.make_coord(%tup_2545) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %770 = cute.elem_less(%coord_2546, %coord_2547) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2548 = cute.get_layout(%754) : !memref_rmem_f32_3 loc(#loc294)
      %771 = cute.get_shape(%lay_2548) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2549, %e1_2550, %e2_2551, %e3_2552 = cute.get_leaves(%771) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %772 = cute.get_stride(%lay_2548) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2553, %e1_2554, %e2_2555, %e3_2556 = cute.get_leaves(%772) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %773 = scf.if %770 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%754) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,5)"> loc(#loc477)
        cute.memref.store(%754, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,5)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%754) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %754 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%754) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%754) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %754 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2557 = cute.get_iter(%773) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2558 = cute.get_layout(%773) : !memref_rmem_f32_3 loc(#loc294)
      %774 = cute.get_shape(%lay_2558) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2559, %e1_2560, %e2_2561, %e3_2562 = cute.get_leaves(%774) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %775 = cute.get_stride(%lay_2558) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2563, %e1_2564, %e2_2565, %e3_2566 = cute.get_leaves(%775) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2567 = cute.get_iter(%773) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2568 = cute.get_iter(%773) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2569 = cute.make_coord() : () -> !cute.coord<"(0,6)"> loc(#loc474)
      %slice_2570 = cute.slice(%view_2302, %coord_2569) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)"> loc(#loc474)
      %iter_2571 = cute.get_iter(%slice_2570) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2572, %e1_2573, %e2_2574, %e3_2575 = cute.get_leaves(%iter_2571) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %776 = cute.get_scalars(%e0_2572) : !cute.int_tuple<"?"> loc(#loc290)
      %777 = cute.get_scalars(%e1_2573) : !cute.int_tuple<"?"> loc(#loc290)
      %778 = cute.get_scalars(%e2_2574) : !cute.int_tuple<"?"> loc(#loc290)
      %779 = cute.get_scalars(%e3_2575) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2576 = cute.get_iter(%slice_2570) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2577, %e1_2578, %e2_2579, %e3_2580 = cute.get_leaves(%iter_2576) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %780 = cute.get_scalars(%e0_2577) : !cute.int_tuple<"?"> loc(#loc290)
      %781 = cute.get_scalars(%e1_2578) : !cute.int_tuple<"?"> loc(#loc290)
      %782 = cute.get_scalars(%e2_2579) : !cute.int_tuple<"?"> loc(#loc290)
      %783 = cute.get_scalars(%e3_2580) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2581 = cute.get_iter(%slice_2570) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2582, %e1_2583, %e2_2584, %e3_2585 = cute.get_leaves(%iter_2581) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %784 = cute.get_scalars(%e0_2582) : !cute.int_tuple<"?"> loc(#loc474)
      %785 = cute.get_scalars(%e1_2583) : !cute.int_tuple<"?"> loc(#loc474)
      %786 = cute.get_scalars(%e2_2584) : !cute.int_tuple<"?"> loc(#loc474)
      %787 = cute.get_scalars(%e3_2585) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2586 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2587 = cute.add_offset(%e3_2585, %int_tuple_2586) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %788 = cute.get_scalars(%tup_2587) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2588 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2589 = cute.make_coord(%tup_2587) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %789 = cute.elem_less(%coord_2588, %coord_2589) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2590 = cute.get_layout(%773) : !memref_rmem_f32_3 loc(#loc294)
      %790 = cute.get_shape(%lay_2590) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2591, %e1_2592, %e2_2593, %e3_2594 = cute.get_leaves(%790) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %791 = cute.get_stride(%lay_2590) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2595, %e1_2596, %e2_2597, %e3_2598 = cute.get_leaves(%791) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %792 = scf.if %789 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%773) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,6)"> loc(#loc477)
        cute.memref.store(%773, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,6)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%773) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %773 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%773) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%773) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %773 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2599 = cute.get_iter(%792) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2600 = cute.get_layout(%792) : !memref_rmem_f32_3 loc(#loc294)
      %793 = cute.get_shape(%lay_2600) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2601, %e1_2602, %e2_2603, %e3_2604 = cute.get_leaves(%793) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %794 = cute.get_stride(%lay_2600) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2605, %e1_2606, %e2_2607, %e3_2608 = cute.get_leaves(%794) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2609 = cute.get_iter(%792) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2610 = cute.get_iter(%792) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2611 = cute.make_coord() : () -> !cute.coord<"(0,7)"> loc(#loc474)
      %slice_2612 = cute.slice(%view_2302, %coord_2611) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)"> loc(#loc474)
      %iter_2613 = cute.get_iter(%slice_2612) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2614, %e1_2615, %e2_2616, %e3_2617 = cute.get_leaves(%iter_2613) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %795 = cute.get_scalars(%e0_2614) : !cute.int_tuple<"?"> loc(#loc290)
      %796 = cute.get_scalars(%e1_2615) : !cute.int_tuple<"?"> loc(#loc290)
      %797 = cute.get_scalars(%e2_2616) : !cute.int_tuple<"?"> loc(#loc290)
      %798 = cute.get_scalars(%e3_2617) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2618 = cute.get_iter(%slice_2612) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2619, %e1_2620, %e2_2621, %e3_2622 = cute.get_leaves(%iter_2618) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %799 = cute.get_scalars(%e0_2619) : !cute.int_tuple<"?"> loc(#loc290)
      %800 = cute.get_scalars(%e1_2620) : !cute.int_tuple<"?"> loc(#loc290)
      %801 = cute.get_scalars(%e2_2621) : !cute.int_tuple<"?"> loc(#loc290)
      %802 = cute.get_scalars(%e3_2622) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2623 = cute.get_iter(%slice_2612) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2624, %e1_2625, %e2_2626, %e3_2627 = cute.get_leaves(%iter_2623) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %803 = cute.get_scalars(%e0_2624) : !cute.int_tuple<"?"> loc(#loc474)
      %804 = cute.get_scalars(%e1_2625) : !cute.int_tuple<"?"> loc(#loc474)
      %805 = cute.get_scalars(%e2_2626) : !cute.int_tuple<"?"> loc(#loc474)
      %806 = cute.get_scalars(%e3_2627) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2628 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2629 = cute.add_offset(%e3_2627, %int_tuple_2628) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %807 = cute.get_scalars(%tup_2629) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2630 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2631 = cute.make_coord(%tup_2629) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %808 = cute.elem_less(%coord_2630, %coord_2631) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2632 = cute.get_layout(%792) : !memref_rmem_f32_3 loc(#loc294)
      %809 = cute.get_shape(%lay_2632) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2633, %e1_2634, %e2_2635, %e3_2636 = cute.get_leaves(%809) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %810 = cute.get_stride(%lay_2632) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2637, %e1_2638, %e2_2639, %e3_2640 = cute.get_leaves(%810) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %811 = scf.if %808 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%792) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,7)"> loc(#loc477)
        cute.memref.store(%792, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,7)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%792) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %792 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%792) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%792) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %792 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2641 = cute.get_iter(%811) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2642 = cute.get_layout(%811) : !memref_rmem_f32_3 loc(#loc294)
      %812 = cute.get_shape(%lay_2642) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2643, %e1_2644, %e2_2645, %e3_2646 = cute.get_leaves(%812) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %813 = cute.get_stride(%lay_2642) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2647, %e1_2648, %e2_2649, %e3_2650 = cute.get_leaves(%813) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2651 = cute.get_iter(%811) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2652 = cute.get_iter(%811) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2653 = cute.make_coord() : () -> !cute.coord<"(0,8)"> loc(#loc474)
      %slice_2654 = cute.slice(%view_2302, %coord_2653) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)"> loc(#loc474)
      %iter_2655 = cute.get_iter(%slice_2654) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2656, %e1_2657, %e2_2658, %e3_2659 = cute.get_leaves(%iter_2655) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %814 = cute.get_scalars(%e0_2656) : !cute.int_tuple<"?"> loc(#loc290)
      %815 = cute.get_scalars(%e1_2657) : !cute.int_tuple<"?"> loc(#loc290)
      %816 = cute.get_scalars(%e2_2658) : !cute.int_tuple<"?"> loc(#loc290)
      %817 = cute.get_scalars(%e3_2659) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2660 = cute.get_iter(%slice_2654) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2661, %e1_2662, %e2_2663, %e3_2664 = cute.get_leaves(%iter_2660) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %818 = cute.get_scalars(%e0_2661) : !cute.int_tuple<"?"> loc(#loc290)
      %819 = cute.get_scalars(%e1_2662) : !cute.int_tuple<"?"> loc(#loc290)
      %820 = cute.get_scalars(%e2_2663) : !cute.int_tuple<"?"> loc(#loc290)
      %821 = cute.get_scalars(%e3_2664) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2665 = cute.get_iter(%slice_2654) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2666, %e1_2667, %e2_2668, %e3_2669 = cute.get_leaves(%iter_2665) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %822 = cute.get_scalars(%e0_2666) : !cute.int_tuple<"?"> loc(#loc474)
      %823 = cute.get_scalars(%e1_2667) : !cute.int_tuple<"?"> loc(#loc474)
      %824 = cute.get_scalars(%e2_2668) : !cute.int_tuple<"?"> loc(#loc474)
      %825 = cute.get_scalars(%e3_2669) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2670 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2671 = cute.add_offset(%e3_2669, %int_tuple_2670) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %826 = cute.get_scalars(%tup_2671) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2672 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2673 = cute.make_coord(%tup_2671) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %827 = cute.elem_less(%coord_2672, %coord_2673) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2674 = cute.get_layout(%811) : !memref_rmem_f32_3 loc(#loc294)
      %828 = cute.get_shape(%lay_2674) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2675, %e1_2676, %e2_2677, %e3_2678 = cute.get_leaves(%828) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %829 = cute.get_stride(%lay_2674) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2679, %e1_2680, %e2_2681, %e3_2682 = cute.get_leaves(%829) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %830 = scf.if %827 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%811) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,8)"> loc(#loc477)
        cute.memref.store(%811, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,8)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%811) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %811 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%811) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%811) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %811 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2683 = cute.get_iter(%830) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2684 = cute.get_layout(%830) : !memref_rmem_f32_3 loc(#loc294)
      %831 = cute.get_shape(%lay_2684) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2685, %e1_2686, %e2_2687, %e3_2688 = cute.get_leaves(%831) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %832 = cute.get_stride(%lay_2684) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2689, %e1_2690, %e2_2691, %e3_2692 = cute.get_leaves(%832) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2693 = cute.get_iter(%830) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2694 = cute.get_iter(%830) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2695 = cute.make_coord() : () -> !cute.coord<"(0,9)"> loc(#loc474)
      %slice_2696 = cute.slice(%view_2302, %coord_2695) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)"> loc(#loc474)
      %iter_2697 = cute.get_iter(%slice_2696) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2698, %e1_2699, %e2_2700, %e3_2701 = cute.get_leaves(%iter_2697) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %833 = cute.get_scalars(%e0_2698) : !cute.int_tuple<"?"> loc(#loc290)
      %834 = cute.get_scalars(%e1_2699) : !cute.int_tuple<"?"> loc(#loc290)
      %835 = cute.get_scalars(%e2_2700) : !cute.int_tuple<"?"> loc(#loc290)
      %836 = cute.get_scalars(%e3_2701) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2702 = cute.get_iter(%slice_2696) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2703, %e1_2704, %e2_2705, %e3_2706 = cute.get_leaves(%iter_2702) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %837 = cute.get_scalars(%e0_2703) : !cute.int_tuple<"?"> loc(#loc290)
      %838 = cute.get_scalars(%e1_2704) : !cute.int_tuple<"?"> loc(#loc290)
      %839 = cute.get_scalars(%e2_2705) : !cute.int_tuple<"?"> loc(#loc290)
      %840 = cute.get_scalars(%e3_2706) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2707 = cute.get_iter(%slice_2696) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2708, %e1_2709, %e2_2710, %e3_2711 = cute.get_leaves(%iter_2707) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %841 = cute.get_scalars(%e0_2708) : !cute.int_tuple<"?"> loc(#loc474)
      %842 = cute.get_scalars(%e1_2709) : !cute.int_tuple<"?"> loc(#loc474)
      %843 = cute.get_scalars(%e2_2710) : !cute.int_tuple<"?"> loc(#loc474)
      %844 = cute.get_scalars(%e3_2711) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2712 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2713 = cute.add_offset(%e3_2711, %int_tuple_2712) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %845 = cute.get_scalars(%tup_2713) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2714 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2715 = cute.make_coord(%tup_2713) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %846 = cute.elem_less(%coord_2714, %coord_2715) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2716 = cute.get_layout(%830) : !memref_rmem_f32_3 loc(#loc294)
      %847 = cute.get_shape(%lay_2716) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2717, %e1_2718, %e2_2719, %e3_2720 = cute.get_leaves(%847) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %848 = cute.get_stride(%lay_2716) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2721, %e1_2722, %e2_2723, %e3_2724 = cute.get_leaves(%848) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %849 = scf.if %846 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%830) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,9)"> loc(#loc477)
        cute.memref.store(%830, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,9)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%830) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %830 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%830) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%830) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %830 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2725 = cute.get_iter(%849) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2726 = cute.get_layout(%849) : !memref_rmem_f32_3 loc(#loc294)
      %850 = cute.get_shape(%lay_2726) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2727, %e1_2728, %e2_2729, %e3_2730 = cute.get_leaves(%850) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %851 = cute.get_stride(%lay_2726) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2731, %e1_2732, %e2_2733, %e3_2734 = cute.get_leaves(%851) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2735 = cute.get_iter(%849) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2736 = cute.get_iter(%849) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2737 = cute.make_coord() : () -> !cute.coord<"(0,10)"> loc(#loc474)
      %slice_2738 = cute.slice(%view_2302, %coord_2737) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)"> loc(#loc474)
      %iter_2739 = cute.get_iter(%slice_2738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2740, %e1_2741, %e2_2742, %e3_2743 = cute.get_leaves(%iter_2739) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %852 = cute.get_scalars(%e0_2740) : !cute.int_tuple<"?"> loc(#loc290)
      %853 = cute.get_scalars(%e1_2741) : !cute.int_tuple<"?"> loc(#loc290)
      %854 = cute.get_scalars(%e2_2742) : !cute.int_tuple<"?"> loc(#loc290)
      %855 = cute.get_scalars(%e3_2743) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2744 = cute.get_iter(%slice_2738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2745, %e1_2746, %e2_2747, %e3_2748 = cute.get_leaves(%iter_2744) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %856 = cute.get_scalars(%e0_2745) : !cute.int_tuple<"?"> loc(#loc290)
      %857 = cute.get_scalars(%e1_2746) : !cute.int_tuple<"?"> loc(#loc290)
      %858 = cute.get_scalars(%e2_2747) : !cute.int_tuple<"?"> loc(#loc290)
      %859 = cute.get_scalars(%e3_2748) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2749 = cute.get_iter(%slice_2738) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2750, %e1_2751, %e2_2752, %e3_2753 = cute.get_leaves(%iter_2749) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %860 = cute.get_scalars(%e0_2750) : !cute.int_tuple<"?"> loc(#loc474)
      %861 = cute.get_scalars(%e1_2751) : !cute.int_tuple<"?"> loc(#loc474)
      %862 = cute.get_scalars(%e2_2752) : !cute.int_tuple<"?"> loc(#loc474)
      %863 = cute.get_scalars(%e3_2753) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2754 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2755 = cute.add_offset(%e3_2753, %int_tuple_2754) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %864 = cute.get_scalars(%tup_2755) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2756 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2757 = cute.make_coord(%tup_2755) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %865 = cute.elem_less(%coord_2756, %coord_2757) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2758 = cute.get_layout(%849) : !memref_rmem_f32_3 loc(#loc294)
      %866 = cute.get_shape(%lay_2758) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2759, %e1_2760, %e2_2761, %e3_2762 = cute.get_leaves(%866) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %867 = cute.get_stride(%lay_2758) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2763, %e1_2764, %e2_2765, %e3_2766 = cute.get_leaves(%867) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %868 = scf.if %865 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%849) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,10)"> loc(#loc477)
        cute.memref.store(%849, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,10)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%849) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %849 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%849) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%849) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %849 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2767 = cute.get_iter(%868) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2768 = cute.get_layout(%868) : !memref_rmem_f32_3 loc(#loc294)
      %869 = cute.get_shape(%lay_2768) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2769, %e1_2770, %e2_2771, %e3_2772 = cute.get_leaves(%869) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %870 = cute.get_stride(%lay_2768) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2773, %e1_2774, %e2_2775, %e3_2776 = cute.get_leaves(%870) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2777 = cute.get_iter(%868) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2778 = cute.get_iter(%868) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2779 = cute.make_coord() : () -> !cute.coord<"(0,11)"> loc(#loc474)
      %slice_2780 = cute.slice(%view_2302, %coord_2779) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)"> loc(#loc474)
      %iter_2781 = cute.get_iter(%slice_2780) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2782, %e1_2783, %e2_2784, %e3_2785 = cute.get_leaves(%iter_2781) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %871 = cute.get_scalars(%e0_2782) : !cute.int_tuple<"?"> loc(#loc290)
      %872 = cute.get_scalars(%e1_2783) : !cute.int_tuple<"?"> loc(#loc290)
      %873 = cute.get_scalars(%e2_2784) : !cute.int_tuple<"?"> loc(#loc290)
      %874 = cute.get_scalars(%e3_2785) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2786 = cute.get_iter(%slice_2780) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2787, %e1_2788, %e2_2789, %e3_2790 = cute.get_leaves(%iter_2786) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %875 = cute.get_scalars(%e0_2787) : !cute.int_tuple<"?"> loc(#loc290)
      %876 = cute.get_scalars(%e1_2788) : !cute.int_tuple<"?"> loc(#loc290)
      %877 = cute.get_scalars(%e2_2789) : !cute.int_tuple<"?"> loc(#loc290)
      %878 = cute.get_scalars(%e3_2790) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2791 = cute.get_iter(%slice_2780) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2792, %e1_2793, %e2_2794, %e3_2795 = cute.get_leaves(%iter_2791) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %879 = cute.get_scalars(%e0_2792) : !cute.int_tuple<"?"> loc(#loc474)
      %880 = cute.get_scalars(%e1_2793) : !cute.int_tuple<"?"> loc(#loc474)
      %881 = cute.get_scalars(%e2_2794) : !cute.int_tuple<"?"> loc(#loc474)
      %882 = cute.get_scalars(%e3_2795) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2796 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2797 = cute.add_offset(%e3_2795, %int_tuple_2796) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %883 = cute.get_scalars(%tup_2797) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2798 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2799 = cute.make_coord(%tup_2797) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %884 = cute.elem_less(%coord_2798, %coord_2799) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2800 = cute.get_layout(%868) : !memref_rmem_f32_3 loc(#loc294)
      %885 = cute.get_shape(%lay_2800) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2801, %e1_2802, %e2_2803, %e3_2804 = cute.get_leaves(%885) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %886 = cute.get_stride(%lay_2800) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2805, %e1_2806, %e2_2807, %e3_2808 = cute.get_leaves(%886) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %887 = scf.if %884 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%868) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,11)"> loc(#loc477)
        cute.memref.store(%868, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,11)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%868) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %868 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%868) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%868) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %868 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2809 = cute.get_iter(%887) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2810 = cute.get_layout(%887) : !memref_rmem_f32_3 loc(#loc294)
      %888 = cute.get_shape(%lay_2810) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2811, %e1_2812, %e2_2813, %e3_2814 = cute.get_leaves(%888) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %889 = cute.get_stride(%lay_2810) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2815, %e1_2816, %e2_2817, %e3_2818 = cute.get_leaves(%889) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2819 = cute.get_iter(%887) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2820 = cute.get_iter(%887) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2821 = cute.make_coord() : () -> !cute.coord<"(0,12)"> loc(#loc474)
      %slice_2822 = cute.slice(%view_2302, %coord_2821) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)"> loc(#loc474)
      %iter_2823 = cute.get_iter(%slice_2822) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2824, %e1_2825, %e2_2826, %e3_2827 = cute.get_leaves(%iter_2823) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %890 = cute.get_scalars(%e0_2824) : !cute.int_tuple<"?"> loc(#loc290)
      %891 = cute.get_scalars(%e1_2825) : !cute.int_tuple<"?"> loc(#loc290)
      %892 = cute.get_scalars(%e2_2826) : !cute.int_tuple<"?"> loc(#loc290)
      %893 = cute.get_scalars(%e3_2827) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2828 = cute.get_iter(%slice_2822) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2829, %e1_2830, %e2_2831, %e3_2832 = cute.get_leaves(%iter_2828) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %894 = cute.get_scalars(%e0_2829) : !cute.int_tuple<"?"> loc(#loc290)
      %895 = cute.get_scalars(%e1_2830) : !cute.int_tuple<"?"> loc(#loc290)
      %896 = cute.get_scalars(%e2_2831) : !cute.int_tuple<"?"> loc(#loc290)
      %897 = cute.get_scalars(%e3_2832) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2833 = cute.get_iter(%slice_2822) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2834, %e1_2835, %e2_2836, %e3_2837 = cute.get_leaves(%iter_2833) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %898 = cute.get_scalars(%e0_2834) : !cute.int_tuple<"?"> loc(#loc474)
      %899 = cute.get_scalars(%e1_2835) : !cute.int_tuple<"?"> loc(#loc474)
      %900 = cute.get_scalars(%e2_2836) : !cute.int_tuple<"?"> loc(#loc474)
      %901 = cute.get_scalars(%e3_2837) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2838 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2839 = cute.add_offset(%e3_2837, %int_tuple_2838) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %902 = cute.get_scalars(%tup_2839) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2840 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2841 = cute.make_coord(%tup_2839) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %903 = cute.elem_less(%coord_2840, %coord_2841) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2842 = cute.get_layout(%887) : !memref_rmem_f32_3 loc(#loc294)
      %904 = cute.get_shape(%lay_2842) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2843, %e1_2844, %e2_2845, %e3_2846 = cute.get_leaves(%904) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %905 = cute.get_stride(%lay_2842) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2847, %e1_2848, %e2_2849, %e3_2850 = cute.get_leaves(%905) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %906 = scf.if %903 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%887) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,12)"> loc(#loc477)
        cute.memref.store(%887, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,12)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%887) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %887 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%887) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%887) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %887 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2851 = cute.get_iter(%906) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2852 = cute.get_layout(%906) : !memref_rmem_f32_3 loc(#loc294)
      %907 = cute.get_shape(%lay_2852) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2853, %e1_2854, %e2_2855, %e3_2856 = cute.get_leaves(%907) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %908 = cute.get_stride(%lay_2852) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2857, %e1_2858, %e2_2859, %e3_2860 = cute.get_leaves(%908) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2861 = cute.get_iter(%906) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2862 = cute.get_iter(%906) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2863 = cute.make_coord() : () -> !cute.coord<"(0,13)"> loc(#loc474)
      %slice_2864 = cute.slice(%view_2302, %coord_2863) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)"> loc(#loc474)
      %iter_2865 = cute.get_iter(%slice_2864) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2866, %e1_2867, %e2_2868, %e3_2869 = cute.get_leaves(%iter_2865) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %909 = cute.get_scalars(%e0_2866) : !cute.int_tuple<"?"> loc(#loc290)
      %910 = cute.get_scalars(%e1_2867) : !cute.int_tuple<"?"> loc(#loc290)
      %911 = cute.get_scalars(%e2_2868) : !cute.int_tuple<"?"> loc(#loc290)
      %912 = cute.get_scalars(%e3_2869) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2870 = cute.get_iter(%slice_2864) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2871, %e1_2872, %e2_2873, %e3_2874 = cute.get_leaves(%iter_2870) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %913 = cute.get_scalars(%e0_2871) : !cute.int_tuple<"?"> loc(#loc290)
      %914 = cute.get_scalars(%e1_2872) : !cute.int_tuple<"?"> loc(#loc290)
      %915 = cute.get_scalars(%e2_2873) : !cute.int_tuple<"?"> loc(#loc290)
      %916 = cute.get_scalars(%e3_2874) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2875 = cute.get_iter(%slice_2864) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2876, %e1_2877, %e2_2878, %e3_2879 = cute.get_leaves(%iter_2875) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %917 = cute.get_scalars(%e0_2876) : !cute.int_tuple<"?"> loc(#loc474)
      %918 = cute.get_scalars(%e1_2877) : !cute.int_tuple<"?"> loc(#loc474)
      %919 = cute.get_scalars(%e2_2878) : !cute.int_tuple<"?"> loc(#loc474)
      %920 = cute.get_scalars(%e3_2879) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2880 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2881 = cute.add_offset(%e3_2879, %int_tuple_2880) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %921 = cute.get_scalars(%tup_2881) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2882 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2883 = cute.make_coord(%tup_2881) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %922 = cute.elem_less(%coord_2882, %coord_2883) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2884 = cute.get_layout(%906) : !memref_rmem_f32_3 loc(#loc294)
      %923 = cute.get_shape(%lay_2884) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2885, %e1_2886, %e2_2887, %e3_2888 = cute.get_leaves(%923) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %924 = cute.get_stride(%lay_2884) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2889, %e1_2890, %e2_2891, %e3_2892 = cute.get_leaves(%924) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %925 = scf.if %922 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%906) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,13)"> loc(#loc477)
        cute.memref.store(%906, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,13)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%906) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %906 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%906) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%906) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %906 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2893 = cute.get_iter(%925) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2894 = cute.get_layout(%925) : !memref_rmem_f32_3 loc(#loc294)
      %926 = cute.get_shape(%lay_2894) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2895, %e1_2896, %e2_2897, %e3_2898 = cute.get_leaves(%926) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %927 = cute.get_stride(%lay_2894) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2899, %e1_2900, %e2_2901, %e3_2902 = cute.get_leaves(%927) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2903 = cute.get_iter(%925) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2904 = cute.get_iter(%925) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2905 = cute.make_coord() : () -> !cute.coord<"(0,14)"> loc(#loc474)
      %slice_2906 = cute.slice(%view_2302, %coord_2905) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)"> loc(#loc474)
      %iter_2907 = cute.get_iter(%slice_2906) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_2908, %e1_2909, %e2_2910, %e3_2911 = cute.get_leaves(%iter_2907) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %928 = cute.get_scalars(%e0_2908) : !cute.int_tuple<"?"> loc(#loc290)
      %929 = cute.get_scalars(%e1_2909) : !cute.int_tuple<"?"> loc(#loc290)
      %930 = cute.get_scalars(%e2_2910) : !cute.int_tuple<"?"> loc(#loc290)
      %931 = cute.get_scalars(%e3_2911) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2912 = cute.get_iter(%slice_2906) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_2913, %e1_2914, %e2_2915, %e3_2916 = cute.get_leaves(%iter_2912) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %932 = cute.get_scalars(%e0_2913) : !cute.int_tuple<"?"> loc(#loc290)
      %933 = cute.get_scalars(%e1_2914) : !cute.int_tuple<"?"> loc(#loc290)
      %934 = cute.get_scalars(%e2_2915) : !cute.int_tuple<"?"> loc(#loc290)
      %935 = cute.get_scalars(%e3_2916) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_2917 = cute.get_iter(%slice_2906) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_2918, %e1_2919, %e2_2920, %e3_2921 = cute.get_leaves(%iter_2917) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %936 = cute.get_scalars(%e0_2918) : !cute.int_tuple<"?"> loc(#loc474)
      %937 = cute.get_scalars(%e1_2919) : !cute.int_tuple<"?"> loc(#loc474)
      %938 = cute.get_scalars(%e2_2920) : !cute.int_tuple<"?"> loc(#loc474)
      %939 = cute.get_scalars(%e3_2921) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_2922 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2923 = cute.add_offset(%e3_2921, %int_tuple_2922) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %940 = cute.get_scalars(%tup_2923) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2924 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2925 = cute.make_coord(%tup_2923) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %941 = cute.elem_less(%coord_2924, %coord_2925) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2926 = cute.get_layout(%925) : !memref_rmem_f32_3 loc(#loc294)
      %942 = cute.get_shape(%lay_2926) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2927, %e1_2928, %e2_2929, %e3_2930 = cute.get_leaves(%942) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %943 = cute.get_stride(%lay_2926) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2931, %e1_2932, %e2_2933, %e3_2934 = cute.get_leaves(%943) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %944 = scf.if %941 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%925) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,14)"> loc(#loc477)
        cute.memref.store(%925, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,14)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%925) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %925 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%925) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%925) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %925 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2935 = cute.get_iter(%944) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2936 = cute.get_layout(%944) : !memref_rmem_f32_3 loc(#loc294)
      %945 = cute.get_shape(%lay_2936) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2937, %e1_2938, %e2_2939, %e3_2940 = cute.get_leaves(%945) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %946 = cute.get_stride(%lay_2936) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2941, %e1_2942, %e2_2943, %e3_2944 = cute.get_leaves(%946) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2945 = cute.get_iter(%944) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2946 = cute.get_iter(%944) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2947 = cute.make_coord() : () -> !cute.coord<"(0,15)"> loc(#loc474)
      %slice_2948 = cute.slice(%view_2302, %coord_2947) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)"> loc(#loc474)
      %iter_2949 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_2950, %e1_2951, %e2_2952, %e3_2953 = cute.get_leaves(%iter_2949) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %947 = cute.get_scalars(%e0_2950) : !cute.int_tuple<"?"> loc(#loc290)
      %948 = cute.get_scalars(%e1_2951) : !cute.int_tuple<"?"> loc(#loc290)
      %949 = cute.get_scalars(%e2_2952) : !cute.int_tuple<"?"> loc(#loc290)
      %950 = cute.get_scalars(%e3_2953) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2954 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_2955, %e1_2956, %e2_2957, %e3_2958 = cute.get_leaves(%iter_2954) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %951 = cute.get_scalars(%e0_2955) : !cute.int_tuple<"?"> loc(#loc290)
      %952 = cute.get_scalars(%e1_2956) : !cute.int_tuple<"?"> loc(#loc290)
      %953 = cute.get_scalars(%e2_2957) : !cute.int_tuple<"?"> loc(#loc290)
      %954 = cute.get_scalars(%e3_2958) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_2959 = cute.get_iter(%slice_2948) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_2960, %e1_2961, %e2_2962, %e3_2963 = cute.get_leaves(%iter_2959) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %955 = cute.get_scalars(%e0_2960) : !cute.int_tuple<"?"> loc(#loc474)
      %956 = cute.get_scalars(%e1_2961) : !cute.int_tuple<"?"> loc(#loc474)
      %957 = cute.get_scalars(%e2_2962) : !cute.int_tuple<"?"> loc(#loc474)
      %958 = cute.get_scalars(%e3_2963) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_2964 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_2965 = cute.add_offset(%e3_2963, %int_tuple_2964) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %959 = cute.get_scalars(%tup_2965) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_2966 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_2967 = cute.make_coord(%tup_2965) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %960 = cute.elem_less(%coord_2966, %coord_2967) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_2968 = cute.get_layout(%944) : !memref_rmem_f32_3 loc(#loc294)
      %961 = cute.get_shape(%lay_2968) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2969, %e1_2970, %e2_2971, %e3_2972 = cute.get_leaves(%961) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %962 = cute.get_stride(%lay_2968) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2973, %e1_2974, %e2_2975, %e3_2976 = cute.get_leaves(%962) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %963 = scf.if %960 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%944) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(0,15)"> loc(#loc477)
        cute.memref.store(%944, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(0,15)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%944) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %944 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%944) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%944) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %944 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_2977 = cute.get_iter(%963) : !memref_rmem_f32_3 loc(#loc478)
      %lay_2978 = cute.get_layout(%963) : !memref_rmem_f32_3 loc(#loc294)
      %964 = cute.get_shape(%lay_2978) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_2979, %e1_2980, %e2_2981, %e3_2982 = cute.get_leaves(%964) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %965 = cute.get_stride(%lay_2978) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_2983, %e1_2984, %e2_2985, %e3_2986 = cute.get_leaves(%965) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_2987 = cute.get_iter(%963) : !memref_rmem_f32_3 loc(#loc479)
      %iter_2988 = cute.get_iter(%963) : !memref_rmem_f32_3 loc(#loc293)
      %coord_2989 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc480)
      %slice_2990 = cute.slice(%963, %coord_2989) : !memref_rmem_f32_3, !cute.coord<"(0,_)"> loc(#loc480)
      %iter_2991 = cute.get_iter(%slice_2990) : !memref_rmem_f32_5 loc(#loc316)
      %iter_2992 = cute.get_iter(%slice_2990) : !memref_rmem_f32_5 loc(#loc317)
      %lay_2993 = cute.get_layout(%slice_2990) : !memref_rmem_f32_5 loc(#loc311)
      %966 = cute.get_shape(%lay_2993) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_2994, %e1_2995 = cute.get_leaves(%966) : !cute.shape<"((2,8))"> loc(#loc311)
      %967 = cute.memref.load_vec %slice_2990 : !memref_rmem_f32_5 loc(#loc480)
      %cst_2996 = arith.constant 0xFF800000 : f32 loc(#loc481)
      %968 = vector.reduction <maximumf>, %967, %cst_2996 : vector<16xf32> into f32 loc(#loc481)
      %c-1_i32 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32 = arith.constant 31 : i32 loc(#loc482)
      %969 = nvvm.shfl.sync  bfly %c-1_i32, %968, %c2_i32, %c31_i32 : f32 -> f32 loc(#loc482)
      %970 = nvvm.fmax %968, %969 loc(#loc483)
      %c-1_i32_2997 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_2998 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_2999 = arith.constant 31 : i32 loc(#loc484)
      %971 = nvvm.shfl.sync  bfly %c-1_i32_2997, %970, %c1_i32_2998, %c31_i32_2999 : f32 -> f32 loc(#loc484)
      %972 = nvvm.fmax %970, %971 loc(#loc483)
      %973 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
      %974 = arith.mulf %967, %973 : vector<16xf32> loc(#loc485)
      %975 = arith.mulf %972, %arg4 : f32 loc(#loc313)
      %976 = vector.broadcast %975 : f32 to vector<16xf32> loc(#loc290)
      %977 = arith.subf %974, %976 : vector<16xf32> loc(#loc485)
      %978 = math.exp2 %977 fastmath<fast> : vector<16xf32> loc(#loc290)
      %cst_3000 = arith.constant 0.000000e+00 : f32 loc(#loc486)
      %979 = vector.reduction <add>, %978, %cst_3000 : vector<16xf32> into f32 loc(#loc486)
      %coord_3001 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc487)
      cute.memref.store(%rmem_919, %coord_3001, %972) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> () loc(#loc487)
      %coord_3002 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc488)
      cute.memref.store(%rmem_924, %coord_3002, %979) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> () loc(#loc488)
      %coord_3003 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc489)
      %slice_3004 = cute.slice(%963, %coord_3003) : !memref_rmem_f32_3, !cute.coord<"(0,_)"> loc(#loc489)
      %iter_3005 = cute.get_iter(%slice_3004) : !memref_rmem_f32_5 loc(#loc316)
      %iter_3006 = cute.get_iter(%slice_3004) : !memref_rmem_f32_5 loc(#loc317)
      %lay_3007 = cute.get_layout(%slice_3004) : !memref_rmem_f32_5 loc(#loc311)
      %980 = cute.get_shape(%lay_3007) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_3008, %e1_3009 = cute.get_leaves(%980) : !cute.shape<"((2,8))"> loc(#loc311)
      %int_tuple_3010 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_3011 = cute.size(%int_tuple_3010) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_3012 = cute.get_leaves(%sz_3011) : !cute.int_tuple<"16"> loc(#loc489)
      %int_tuple_3013 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_3014 = cute.size(%int_tuple_3013) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_3015 = cute.get_leaves(%sz_3014) : !cute.int_tuple<"16"> loc(#loc489)
      cute.memref.store_vec %978, %slice_3004 : !memref_rmem_f32_5 loc(#loc489)
      %int_tuple_3016 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)"> loc(#loc473)
      %sz_3017 = cute.size(%int_tuple_3016) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16"> loc(#loc473)
      %e0_3018 = cute.get_leaves(%sz_3017) : !cute.int_tuple<"16"> loc(#loc473)
      %coord_3019 = cute.make_coord() : () -> !cute.coord<"(0,0)"> loc(#loc474)
      %slice_3020 = cute.slice(%view_2302, %coord_3019) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)"> loc(#loc474)
      %iter_3021 = cute.get_iter(%slice_3020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3022, %e1_3023, %e2_3024, %e3_3025 = cute.get_leaves(%iter_3021) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %981 = cute.get_scalars(%e0_3022) : !cute.int_tuple<"?"> loc(#loc290)
      %982 = cute.get_scalars(%e1_3023) : !cute.int_tuple<"?"> loc(#loc290)
      %983 = cute.get_scalars(%e2_3024) : !cute.int_tuple<"?"> loc(#loc290)
      %984 = cute.get_scalars(%e3_3025) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3026 = cute.get_iter(%slice_3020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3027, %e1_3028, %e2_3029, %e3_3030 = cute.get_leaves(%iter_3026) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %985 = cute.get_scalars(%e0_3027) : !cute.int_tuple<"?"> loc(#loc290)
      %986 = cute.get_scalars(%e1_3028) : !cute.int_tuple<"?"> loc(#loc290)
      %987 = cute.get_scalars(%e2_3029) : !cute.int_tuple<"?"> loc(#loc290)
      %988 = cute.get_scalars(%e3_3030) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3031 = cute.get_iter(%slice_3020) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3032, %e1_3033, %e2_3034, %e3_3035 = cute.get_leaves(%iter_3031) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %989 = cute.get_scalars(%e0_3032) : !cute.int_tuple<"?"> loc(#loc474)
      %990 = cute.get_scalars(%e1_3033) : !cute.int_tuple<"?"> loc(#loc474)
      %991 = cute.get_scalars(%e2_3034) : !cute.int_tuple<"?"> loc(#loc474)
      %992 = cute.get_scalars(%e3_3035) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3036 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3037 = cute.add_offset(%e3_3035, %int_tuple_3036) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %993 = cute.get_scalars(%tup_3037) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3038 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3039 = cute.make_coord(%tup_3037) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %994 = cute.elem_less(%coord_3038, %coord_3039) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3040 = cute.get_layout(%963) : !memref_rmem_f32_3 loc(#loc294)
      %995 = cute.get_shape(%lay_3040) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3041, %e1_3042, %e2_3043, %e3_3044 = cute.get_leaves(%995) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %996 = cute.get_stride(%lay_3040) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3045, %e1_3046, %e2_3047, %e3_3048 = cute.get_leaves(%996) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %997 = scf.if %994 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%963) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,0)"> loc(#loc477)
        cute.memref.store(%963, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,0)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%963) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %963 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%963) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%963) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %963 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3049 = cute.get_iter(%997) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3050 = cute.get_layout(%997) : !memref_rmem_f32_3 loc(#loc294)
      %998 = cute.get_shape(%lay_3050) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3051, %e1_3052, %e2_3053, %e3_3054 = cute.get_leaves(%998) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %999 = cute.get_stride(%lay_3050) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3055, %e1_3056, %e2_3057, %e3_3058 = cute.get_leaves(%999) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3059 = cute.get_iter(%997) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3060 = cute.get_iter(%997) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3061 = cute.make_coord() : () -> !cute.coord<"(0,1)"> loc(#loc474)
      %slice_3062 = cute.slice(%view_2302, %coord_3061) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)"> loc(#loc474)
      %iter_3063 = cute.get_iter(%slice_3062) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3064, %e1_3065, %e2_3066, %e3_3067 = cute.get_leaves(%iter_3063) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1000 = cute.get_scalars(%e0_3064) : !cute.int_tuple<"?"> loc(#loc290)
      %1001 = cute.get_scalars(%e1_3065) : !cute.int_tuple<"?"> loc(#loc290)
      %1002 = cute.get_scalars(%e2_3066) : !cute.int_tuple<"?"> loc(#loc290)
      %1003 = cute.get_scalars(%e3_3067) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3068 = cute.get_iter(%slice_3062) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3069, %e1_3070, %e2_3071, %e3_3072 = cute.get_leaves(%iter_3068) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1004 = cute.get_scalars(%e0_3069) : !cute.int_tuple<"?"> loc(#loc290)
      %1005 = cute.get_scalars(%e1_3070) : !cute.int_tuple<"?"> loc(#loc290)
      %1006 = cute.get_scalars(%e2_3071) : !cute.int_tuple<"?"> loc(#loc290)
      %1007 = cute.get_scalars(%e3_3072) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3073 = cute.get_iter(%slice_3062) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3074, %e1_3075, %e2_3076, %e3_3077 = cute.get_leaves(%iter_3073) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1008 = cute.get_scalars(%e0_3074) : !cute.int_tuple<"?"> loc(#loc474)
      %1009 = cute.get_scalars(%e1_3075) : !cute.int_tuple<"?"> loc(#loc474)
      %1010 = cute.get_scalars(%e2_3076) : !cute.int_tuple<"?"> loc(#loc474)
      %1011 = cute.get_scalars(%e3_3077) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3078 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3079 = cute.add_offset(%e3_3077, %int_tuple_3078) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1012 = cute.get_scalars(%tup_3079) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3080 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3081 = cute.make_coord(%tup_3079) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1013 = cute.elem_less(%coord_3080, %coord_3081) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3082 = cute.get_layout(%997) : !memref_rmem_f32_3 loc(#loc294)
      %1014 = cute.get_shape(%lay_3082) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3083, %e1_3084, %e2_3085, %e3_3086 = cute.get_leaves(%1014) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1015 = cute.get_stride(%lay_3082) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3087, %e1_3088, %e2_3089, %e3_3090 = cute.get_leaves(%1015) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1016 = scf.if %1013 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%997) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,1)"> loc(#loc477)
        cute.memref.store(%997, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,1)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%997) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %997 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%997) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%997) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %997 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3091 = cute.get_iter(%1016) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3092 = cute.get_layout(%1016) : !memref_rmem_f32_3 loc(#loc294)
      %1017 = cute.get_shape(%lay_3092) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3093, %e1_3094, %e2_3095, %e3_3096 = cute.get_leaves(%1017) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1018 = cute.get_stride(%lay_3092) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3097, %e1_3098, %e2_3099, %e3_3100 = cute.get_leaves(%1018) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3101 = cute.get_iter(%1016) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3102 = cute.get_iter(%1016) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3103 = cute.make_coord() : () -> !cute.coord<"(0,2)"> loc(#loc474)
      %slice_3104 = cute.slice(%view_2302, %coord_3103) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)"> loc(#loc474)
      %iter_3105 = cute.get_iter(%slice_3104) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3106, %e1_3107, %e2_3108, %e3_3109 = cute.get_leaves(%iter_3105) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1019 = cute.get_scalars(%e0_3106) : !cute.int_tuple<"?"> loc(#loc290)
      %1020 = cute.get_scalars(%e1_3107) : !cute.int_tuple<"?"> loc(#loc290)
      %1021 = cute.get_scalars(%e2_3108) : !cute.int_tuple<"?"> loc(#loc290)
      %1022 = cute.get_scalars(%e3_3109) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3110 = cute.get_iter(%slice_3104) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3111, %e1_3112, %e2_3113, %e3_3114 = cute.get_leaves(%iter_3110) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1023 = cute.get_scalars(%e0_3111) : !cute.int_tuple<"?"> loc(#loc290)
      %1024 = cute.get_scalars(%e1_3112) : !cute.int_tuple<"?"> loc(#loc290)
      %1025 = cute.get_scalars(%e2_3113) : !cute.int_tuple<"?"> loc(#loc290)
      %1026 = cute.get_scalars(%e3_3114) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3115 = cute.get_iter(%slice_3104) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3116, %e1_3117, %e2_3118, %e3_3119 = cute.get_leaves(%iter_3115) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1027 = cute.get_scalars(%e0_3116) : !cute.int_tuple<"?"> loc(#loc474)
      %1028 = cute.get_scalars(%e1_3117) : !cute.int_tuple<"?"> loc(#loc474)
      %1029 = cute.get_scalars(%e2_3118) : !cute.int_tuple<"?"> loc(#loc474)
      %1030 = cute.get_scalars(%e3_3119) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3120 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3121 = cute.add_offset(%e3_3119, %int_tuple_3120) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1031 = cute.get_scalars(%tup_3121) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3122 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3123 = cute.make_coord(%tup_3121) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1032 = cute.elem_less(%coord_3122, %coord_3123) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3124 = cute.get_layout(%1016) : !memref_rmem_f32_3 loc(#loc294)
      %1033 = cute.get_shape(%lay_3124) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3125, %e1_3126, %e2_3127, %e3_3128 = cute.get_leaves(%1033) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1034 = cute.get_stride(%lay_3124) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3129, %e1_3130, %e2_3131, %e3_3132 = cute.get_leaves(%1034) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1035 = scf.if %1032 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1016) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,2)"> loc(#loc477)
        cute.memref.store(%1016, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,2)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1016) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1016 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1016) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1016) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1016 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3133 = cute.get_iter(%1035) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3134 = cute.get_layout(%1035) : !memref_rmem_f32_3 loc(#loc294)
      %1036 = cute.get_shape(%lay_3134) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3135, %e1_3136, %e2_3137, %e3_3138 = cute.get_leaves(%1036) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1037 = cute.get_stride(%lay_3134) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3139, %e1_3140, %e2_3141, %e3_3142 = cute.get_leaves(%1037) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3143 = cute.get_iter(%1035) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3144 = cute.get_iter(%1035) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3145 = cute.make_coord() : () -> !cute.coord<"(0,3)"> loc(#loc474)
      %slice_3146 = cute.slice(%view_2302, %coord_3145) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)"> loc(#loc474)
      %iter_3147 = cute.get_iter(%slice_3146) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3148, %e1_3149, %e2_3150, %e3_3151 = cute.get_leaves(%iter_3147) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1038 = cute.get_scalars(%e0_3148) : !cute.int_tuple<"?"> loc(#loc290)
      %1039 = cute.get_scalars(%e1_3149) : !cute.int_tuple<"?"> loc(#loc290)
      %1040 = cute.get_scalars(%e2_3150) : !cute.int_tuple<"?"> loc(#loc290)
      %1041 = cute.get_scalars(%e3_3151) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3152 = cute.get_iter(%slice_3146) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3153, %e1_3154, %e2_3155, %e3_3156 = cute.get_leaves(%iter_3152) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1042 = cute.get_scalars(%e0_3153) : !cute.int_tuple<"?"> loc(#loc290)
      %1043 = cute.get_scalars(%e1_3154) : !cute.int_tuple<"?"> loc(#loc290)
      %1044 = cute.get_scalars(%e2_3155) : !cute.int_tuple<"?"> loc(#loc290)
      %1045 = cute.get_scalars(%e3_3156) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3157 = cute.get_iter(%slice_3146) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3158, %e1_3159, %e2_3160, %e3_3161 = cute.get_leaves(%iter_3157) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1046 = cute.get_scalars(%e0_3158) : !cute.int_tuple<"?"> loc(#loc474)
      %1047 = cute.get_scalars(%e1_3159) : !cute.int_tuple<"?"> loc(#loc474)
      %1048 = cute.get_scalars(%e2_3160) : !cute.int_tuple<"?"> loc(#loc474)
      %1049 = cute.get_scalars(%e3_3161) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3162 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3163 = cute.add_offset(%e3_3161, %int_tuple_3162) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1050 = cute.get_scalars(%tup_3163) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3164 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3165 = cute.make_coord(%tup_3163) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1051 = cute.elem_less(%coord_3164, %coord_3165) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3166 = cute.get_layout(%1035) : !memref_rmem_f32_3 loc(#loc294)
      %1052 = cute.get_shape(%lay_3166) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3167, %e1_3168, %e2_3169, %e3_3170 = cute.get_leaves(%1052) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1053 = cute.get_stride(%lay_3166) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3171, %e1_3172, %e2_3173, %e3_3174 = cute.get_leaves(%1053) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1054 = scf.if %1051 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1035) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,3)"> loc(#loc477)
        cute.memref.store(%1035, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,3)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1035) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1035 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1035) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1035) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1035 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3175 = cute.get_iter(%1054) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3176 = cute.get_layout(%1054) : !memref_rmem_f32_3 loc(#loc294)
      %1055 = cute.get_shape(%lay_3176) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3177, %e1_3178, %e2_3179, %e3_3180 = cute.get_leaves(%1055) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1056 = cute.get_stride(%lay_3176) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3181, %e1_3182, %e2_3183, %e3_3184 = cute.get_leaves(%1056) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3185 = cute.get_iter(%1054) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3186 = cute.get_iter(%1054) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3187 = cute.make_coord() : () -> !cute.coord<"(0,4)"> loc(#loc474)
      %slice_3188 = cute.slice(%view_2302, %coord_3187) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)"> loc(#loc474)
      %iter_3189 = cute.get_iter(%slice_3188) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3190, %e1_3191, %e2_3192, %e3_3193 = cute.get_leaves(%iter_3189) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1057 = cute.get_scalars(%e0_3190) : !cute.int_tuple<"?"> loc(#loc290)
      %1058 = cute.get_scalars(%e1_3191) : !cute.int_tuple<"?"> loc(#loc290)
      %1059 = cute.get_scalars(%e2_3192) : !cute.int_tuple<"?"> loc(#loc290)
      %1060 = cute.get_scalars(%e3_3193) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3194 = cute.get_iter(%slice_3188) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3195, %e1_3196, %e2_3197, %e3_3198 = cute.get_leaves(%iter_3194) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1061 = cute.get_scalars(%e0_3195) : !cute.int_tuple<"?"> loc(#loc290)
      %1062 = cute.get_scalars(%e1_3196) : !cute.int_tuple<"?"> loc(#loc290)
      %1063 = cute.get_scalars(%e2_3197) : !cute.int_tuple<"?"> loc(#loc290)
      %1064 = cute.get_scalars(%e3_3198) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3199 = cute.get_iter(%slice_3188) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3200, %e1_3201, %e2_3202, %e3_3203 = cute.get_leaves(%iter_3199) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1065 = cute.get_scalars(%e0_3200) : !cute.int_tuple<"?"> loc(#loc474)
      %1066 = cute.get_scalars(%e1_3201) : !cute.int_tuple<"?"> loc(#loc474)
      %1067 = cute.get_scalars(%e2_3202) : !cute.int_tuple<"?"> loc(#loc474)
      %1068 = cute.get_scalars(%e3_3203) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3204 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3205 = cute.add_offset(%e3_3203, %int_tuple_3204) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1069 = cute.get_scalars(%tup_3205) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3206 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3207 = cute.make_coord(%tup_3205) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1070 = cute.elem_less(%coord_3206, %coord_3207) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3208 = cute.get_layout(%1054) : !memref_rmem_f32_3 loc(#loc294)
      %1071 = cute.get_shape(%lay_3208) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3209, %e1_3210, %e2_3211, %e3_3212 = cute.get_leaves(%1071) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1072 = cute.get_stride(%lay_3208) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3213, %e1_3214, %e2_3215, %e3_3216 = cute.get_leaves(%1072) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1073 = scf.if %1070 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1054) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,4)"> loc(#loc477)
        cute.memref.store(%1054, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,4)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1054) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1054 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1054) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1054) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1054 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3217 = cute.get_iter(%1073) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3218 = cute.get_layout(%1073) : !memref_rmem_f32_3 loc(#loc294)
      %1074 = cute.get_shape(%lay_3218) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3219, %e1_3220, %e2_3221, %e3_3222 = cute.get_leaves(%1074) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1075 = cute.get_stride(%lay_3218) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3223, %e1_3224, %e2_3225, %e3_3226 = cute.get_leaves(%1075) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3227 = cute.get_iter(%1073) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3228 = cute.get_iter(%1073) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3229 = cute.make_coord() : () -> !cute.coord<"(0,5)"> loc(#loc474)
      %slice_3230 = cute.slice(%view_2302, %coord_3229) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)"> loc(#loc474)
      %iter_3231 = cute.get_iter(%slice_3230) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3232, %e1_3233, %e2_3234, %e3_3235 = cute.get_leaves(%iter_3231) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1076 = cute.get_scalars(%e0_3232) : !cute.int_tuple<"?"> loc(#loc290)
      %1077 = cute.get_scalars(%e1_3233) : !cute.int_tuple<"?"> loc(#loc290)
      %1078 = cute.get_scalars(%e2_3234) : !cute.int_tuple<"?"> loc(#loc290)
      %1079 = cute.get_scalars(%e3_3235) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3236 = cute.get_iter(%slice_3230) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3237, %e1_3238, %e2_3239, %e3_3240 = cute.get_leaves(%iter_3236) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1080 = cute.get_scalars(%e0_3237) : !cute.int_tuple<"?"> loc(#loc290)
      %1081 = cute.get_scalars(%e1_3238) : !cute.int_tuple<"?"> loc(#loc290)
      %1082 = cute.get_scalars(%e2_3239) : !cute.int_tuple<"?"> loc(#loc290)
      %1083 = cute.get_scalars(%e3_3240) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3241 = cute.get_iter(%slice_3230) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3242, %e1_3243, %e2_3244, %e3_3245 = cute.get_leaves(%iter_3241) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1084 = cute.get_scalars(%e0_3242) : !cute.int_tuple<"?"> loc(#loc474)
      %1085 = cute.get_scalars(%e1_3243) : !cute.int_tuple<"?"> loc(#loc474)
      %1086 = cute.get_scalars(%e2_3244) : !cute.int_tuple<"?"> loc(#loc474)
      %1087 = cute.get_scalars(%e3_3245) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3246 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3247 = cute.add_offset(%e3_3245, %int_tuple_3246) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1088 = cute.get_scalars(%tup_3247) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3248 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3249 = cute.make_coord(%tup_3247) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1089 = cute.elem_less(%coord_3248, %coord_3249) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3250 = cute.get_layout(%1073) : !memref_rmem_f32_3 loc(#loc294)
      %1090 = cute.get_shape(%lay_3250) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3251, %e1_3252, %e2_3253, %e3_3254 = cute.get_leaves(%1090) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1091 = cute.get_stride(%lay_3250) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3255, %e1_3256, %e2_3257, %e3_3258 = cute.get_leaves(%1091) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1092 = scf.if %1089 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1073) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,5)"> loc(#loc477)
        cute.memref.store(%1073, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,5)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1073) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1073 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1073) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1073) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1073 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3259 = cute.get_iter(%1092) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3260 = cute.get_layout(%1092) : !memref_rmem_f32_3 loc(#loc294)
      %1093 = cute.get_shape(%lay_3260) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3261, %e1_3262, %e2_3263, %e3_3264 = cute.get_leaves(%1093) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1094 = cute.get_stride(%lay_3260) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3265, %e1_3266, %e2_3267, %e3_3268 = cute.get_leaves(%1094) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3269 = cute.get_iter(%1092) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3270 = cute.get_iter(%1092) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3271 = cute.make_coord() : () -> !cute.coord<"(0,6)"> loc(#loc474)
      %slice_3272 = cute.slice(%view_2302, %coord_3271) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)"> loc(#loc474)
      %iter_3273 = cute.get_iter(%slice_3272) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3274, %e1_3275, %e2_3276, %e3_3277 = cute.get_leaves(%iter_3273) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1095 = cute.get_scalars(%e0_3274) : !cute.int_tuple<"?"> loc(#loc290)
      %1096 = cute.get_scalars(%e1_3275) : !cute.int_tuple<"?"> loc(#loc290)
      %1097 = cute.get_scalars(%e2_3276) : !cute.int_tuple<"?"> loc(#loc290)
      %1098 = cute.get_scalars(%e3_3277) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3278 = cute.get_iter(%slice_3272) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3279, %e1_3280, %e2_3281, %e3_3282 = cute.get_leaves(%iter_3278) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1099 = cute.get_scalars(%e0_3279) : !cute.int_tuple<"?"> loc(#loc290)
      %1100 = cute.get_scalars(%e1_3280) : !cute.int_tuple<"?"> loc(#loc290)
      %1101 = cute.get_scalars(%e2_3281) : !cute.int_tuple<"?"> loc(#loc290)
      %1102 = cute.get_scalars(%e3_3282) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3283 = cute.get_iter(%slice_3272) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3284, %e1_3285, %e2_3286, %e3_3287 = cute.get_leaves(%iter_3283) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1103 = cute.get_scalars(%e0_3284) : !cute.int_tuple<"?"> loc(#loc474)
      %1104 = cute.get_scalars(%e1_3285) : !cute.int_tuple<"?"> loc(#loc474)
      %1105 = cute.get_scalars(%e2_3286) : !cute.int_tuple<"?"> loc(#loc474)
      %1106 = cute.get_scalars(%e3_3287) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3288 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3289 = cute.add_offset(%e3_3287, %int_tuple_3288) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1107 = cute.get_scalars(%tup_3289) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3290 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3291 = cute.make_coord(%tup_3289) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1108 = cute.elem_less(%coord_3290, %coord_3291) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3292 = cute.get_layout(%1092) : !memref_rmem_f32_3 loc(#loc294)
      %1109 = cute.get_shape(%lay_3292) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3293, %e1_3294, %e2_3295, %e3_3296 = cute.get_leaves(%1109) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1110 = cute.get_stride(%lay_3292) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3297, %e1_3298, %e2_3299, %e3_3300 = cute.get_leaves(%1110) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1111 = scf.if %1108 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1092) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,6)"> loc(#loc477)
        cute.memref.store(%1092, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,6)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1092) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1092 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1092) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1092) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1092 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3301 = cute.get_iter(%1111) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3302 = cute.get_layout(%1111) : !memref_rmem_f32_3 loc(#loc294)
      %1112 = cute.get_shape(%lay_3302) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3303, %e1_3304, %e2_3305, %e3_3306 = cute.get_leaves(%1112) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1113 = cute.get_stride(%lay_3302) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3307, %e1_3308, %e2_3309, %e3_3310 = cute.get_leaves(%1113) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3311 = cute.get_iter(%1111) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3312 = cute.get_iter(%1111) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3313 = cute.make_coord() : () -> !cute.coord<"(0,7)"> loc(#loc474)
      %slice_3314 = cute.slice(%view_2302, %coord_3313) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)"> loc(#loc474)
      %iter_3315 = cute.get_iter(%slice_3314) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3316, %e1_3317, %e2_3318, %e3_3319 = cute.get_leaves(%iter_3315) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1114 = cute.get_scalars(%e0_3316) : !cute.int_tuple<"?"> loc(#loc290)
      %1115 = cute.get_scalars(%e1_3317) : !cute.int_tuple<"?"> loc(#loc290)
      %1116 = cute.get_scalars(%e2_3318) : !cute.int_tuple<"?"> loc(#loc290)
      %1117 = cute.get_scalars(%e3_3319) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3320 = cute.get_iter(%slice_3314) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3321, %e1_3322, %e2_3323, %e3_3324 = cute.get_leaves(%iter_3320) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1118 = cute.get_scalars(%e0_3321) : !cute.int_tuple<"?"> loc(#loc290)
      %1119 = cute.get_scalars(%e1_3322) : !cute.int_tuple<"?"> loc(#loc290)
      %1120 = cute.get_scalars(%e2_3323) : !cute.int_tuple<"?"> loc(#loc290)
      %1121 = cute.get_scalars(%e3_3324) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3325 = cute.get_iter(%slice_3314) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3326, %e1_3327, %e2_3328, %e3_3329 = cute.get_leaves(%iter_3325) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1122 = cute.get_scalars(%e0_3326) : !cute.int_tuple<"?"> loc(#loc474)
      %1123 = cute.get_scalars(%e1_3327) : !cute.int_tuple<"?"> loc(#loc474)
      %1124 = cute.get_scalars(%e2_3328) : !cute.int_tuple<"?"> loc(#loc474)
      %1125 = cute.get_scalars(%e3_3329) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3330 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3331 = cute.add_offset(%e3_3329, %int_tuple_3330) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1126 = cute.get_scalars(%tup_3331) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3332 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3333 = cute.make_coord(%tup_3331) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1127 = cute.elem_less(%coord_3332, %coord_3333) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3334 = cute.get_layout(%1111) : !memref_rmem_f32_3 loc(#loc294)
      %1128 = cute.get_shape(%lay_3334) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3335, %e1_3336, %e2_3337, %e3_3338 = cute.get_leaves(%1128) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1129 = cute.get_stride(%lay_3334) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3339, %e1_3340, %e2_3341, %e3_3342 = cute.get_leaves(%1129) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1130 = scf.if %1127 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1111) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,7)"> loc(#loc477)
        cute.memref.store(%1111, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,7)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1111) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1111 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1111) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1111) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1111 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3343 = cute.get_iter(%1130) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3344 = cute.get_layout(%1130) : !memref_rmem_f32_3 loc(#loc294)
      %1131 = cute.get_shape(%lay_3344) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3345, %e1_3346, %e2_3347, %e3_3348 = cute.get_leaves(%1131) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1132 = cute.get_stride(%lay_3344) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3349, %e1_3350, %e2_3351, %e3_3352 = cute.get_leaves(%1132) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3353 = cute.get_iter(%1130) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3354 = cute.get_iter(%1130) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3355 = cute.make_coord() : () -> !cute.coord<"(0,8)"> loc(#loc474)
      %slice_3356 = cute.slice(%view_2302, %coord_3355) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)"> loc(#loc474)
      %iter_3357 = cute.get_iter(%slice_3356) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3358, %e1_3359, %e2_3360, %e3_3361 = cute.get_leaves(%iter_3357) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1133 = cute.get_scalars(%e0_3358) : !cute.int_tuple<"?"> loc(#loc290)
      %1134 = cute.get_scalars(%e1_3359) : !cute.int_tuple<"?"> loc(#loc290)
      %1135 = cute.get_scalars(%e2_3360) : !cute.int_tuple<"?"> loc(#loc290)
      %1136 = cute.get_scalars(%e3_3361) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3362 = cute.get_iter(%slice_3356) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3363, %e1_3364, %e2_3365, %e3_3366 = cute.get_leaves(%iter_3362) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1137 = cute.get_scalars(%e0_3363) : !cute.int_tuple<"?"> loc(#loc290)
      %1138 = cute.get_scalars(%e1_3364) : !cute.int_tuple<"?"> loc(#loc290)
      %1139 = cute.get_scalars(%e2_3365) : !cute.int_tuple<"?"> loc(#loc290)
      %1140 = cute.get_scalars(%e3_3366) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3367 = cute.get_iter(%slice_3356) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3368, %e1_3369, %e2_3370, %e3_3371 = cute.get_leaves(%iter_3367) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1141 = cute.get_scalars(%e0_3368) : !cute.int_tuple<"?"> loc(#loc474)
      %1142 = cute.get_scalars(%e1_3369) : !cute.int_tuple<"?"> loc(#loc474)
      %1143 = cute.get_scalars(%e2_3370) : !cute.int_tuple<"?"> loc(#loc474)
      %1144 = cute.get_scalars(%e3_3371) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3372 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3373 = cute.add_offset(%e3_3371, %int_tuple_3372) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1145 = cute.get_scalars(%tup_3373) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3374 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3375 = cute.make_coord(%tup_3373) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1146 = cute.elem_less(%coord_3374, %coord_3375) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3376 = cute.get_layout(%1130) : !memref_rmem_f32_3 loc(#loc294)
      %1147 = cute.get_shape(%lay_3376) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3377, %e1_3378, %e2_3379, %e3_3380 = cute.get_leaves(%1147) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1148 = cute.get_stride(%lay_3376) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3381, %e1_3382, %e2_3383, %e3_3384 = cute.get_leaves(%1148) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1149 = scf.if %1146 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1130) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,8)"> loc(#loc477)
        cute.memref.store(%1130, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,8)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1130) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1130 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1130) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1130) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1130 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3385 = cute.get_iter(%1149) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3386 = cute.get_layout(%1149) : !memref_rmem_f32_3 loc(#loc294)
      %1150 = cute.get_shape(%lay_3386) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3387, %e1_3388, %e2_3389, %e3_3390 = cute.get_leaves(%1150) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1151 = cute.get_stride(%lay_3386) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3391, %e1_3392, %e2_3393, %e3_3394 = cute.get_leaves(%1151) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3395 = cute.get_iter(%1149) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3396 = cute.get_iter(%1149) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3397 = cute.make_coord() : () -> !cute.coord<"(0,9)"> loc(#loc474)
      %slice_3398 = cute.slice(%view_2302, %coord_3397) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)"> loc(#loc474)
      %iter_3399 = cute.get_iter(%slice_3398) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3400, %e1_3401, %e2_3402, %e3_3403 = cute.get_leaves(%iter_3399) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1152 = cute.get_scalars(%e0_3400) : !cute.int_tuple<"?"> loc(#loc290)
      %1153 = cute.get_scalars(%e1_3401) : !cute.int_tuple<"?"> loc(#loc290)
      %1154 = cute.get_scalars(%e2_3402) : !cute.int_tuple<"?"> loc(#loc290)
      %1155 = cute.get_scalars(%e3_3403) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3404 = cute.get_iter(%slice_3398) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3405, %e1_3406, %e2_3407, %e3_3408 = cute.get_leaves(%iter_3404) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1156 = cute.get_scalars(%e0_3405) : !cute.int_tuple<"?"> loc(#loc290)
      %1157 = cute.get_scalars(%e1_3406) : !cute.int_tuple<"?"> loc(#loc290)
      %1158 = cute.get_scalars(%e2_3407) : !cute.int_tuple<"?"> loc(#loc290)
      %1159 = cute.get_scalars(%e3_3408) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3409 = cute.get_iter(%slice_3398) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3410, %e1_3411, %e2_3412, %e3_3413 = cute.get_leaves(%iter_3409) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1160 = cute.get_scalars(%e0_3410) : !cute.int_tuple<"?"> loc(#loc474)
      %1161 = cute.get_scalars(%e1_3411) : !cute.int_tuple<"?"> loc(#loc474)
      %1162 = cute.get_scalars(%e2_3412) : !cute.int_tuple<"?"> loc(#loc474)
      %1163 = cute.get_scalars(%e3_3413) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3414 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3415 = cute.add_offset(%e3_3413, %int_tuple_3414) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1164 = cute.get_scalars(%tup_3415) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3416 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3417 = cute.make_coord(%tup_3415) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1165 = cute.elem_less(%coord_3416, %coord_3417) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3418 = cute.get_layout(%1149) : !memref_rmem_f32_3 loc(#loc294)
      %1166 = cute.get_shape(%lay_3418) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3419, %e1_3420, %e2_3421, %e3_3422 = cute.get_leaves(%1166) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1167 = cute.get_stride(%lay_3418) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3423, %e1_3424, %e2_3425, %e3_3426 = cute.get_leaves(%1167) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1168 = scf.if %1165 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1149) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,9)"> loc(#loc477)
        cute.memref.store(%1149, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,9)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1149) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1149 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1149) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1149) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1149 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3427 = cute.get_iter(%1168) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3428 = cute.get_layout(%1168) : !memref_rmem_f32_3 loc(#loc294)
      %1169 = cute.get_shape(%lay_3428) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3429, %e1_3430, %e2_3431, %e3_3432 = cute.get_leaves(%1169) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1170 = cute.get_stride(%lay_3428) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3433, %e1_3434, %e2_3435, %e3_3436 = cute.get_leaves(%1170) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3437 = cute.get_iter(%1168) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3438 = cute.get_iter(%1168) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3439 = cute.make_coord() : () -> !cute.coord<"(0,10)"> loc(#loc474)
      %slice_3440 = cute.slice(%view_2302, %coord_3439) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)"> loc(#loc474)
      %iter_3441 = cute.get_iter(%slice_3440) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3442, %e1_3443, %e2_3444, %e3_3445 = cute.get_leaves(%iter_3441) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1171 = cute.get_scalars(%e0_3442) : !cute.int_tuple<"?"> loc(#loc290)
      %1172 = cute.get_scalars(%e1_3443) : !cute.int_tuple<"?"> loc(#loc290)
      %1173 = cute.get_scalars(%e2_3444) : !cute.int_tuple<"?"> loc(#loc290)
      %1174 = cute.get_scalars(%e3_3445) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3446 = cute.get_iter(%slice_3440) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3447, %e1_3448, %e2_3449, %e3_3450 = cute.get_leaves(%iter_3446) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1175 = cute.get_scalars(%e0_3447) : !cute.int_tuple<"?"> loc(#loc290)
      %1176 = cute.get_scalars(%e1_3448) : !cute.int_tuple<"?"> loc(#loc290)
      %1177 = cute.get_scalars(%e2_3449) : !cute.int_tuple<"?"> loc(#loc290)
      %1178 = cute.get_scalars(%e3_3450) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3451 = cute.get_iter(%slice_3440) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3452, %e1_3453, %e2_3454, %e3_3455 = cute.get_leaves(%iter_3451) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1179 = cute.get_scalars(%e0_3452) : !cute.int_tuple<"?"> loc(#loc474)
      %1180 = cute.get_scalars(%e1_3453) : !cute.int_tuple<"?"> loc(#loc474)
      %1181 = cute.get_scalars(%e2_3454) : !cute.int_tuple<"?"> loc(#loc474)
      %1182 = cute.get_scalars(%e3_3455) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3456 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3457 = cute.add_offset(%e3_3455, %int_tuple_3456) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1183 = cute.get_scalars(%tup_3457) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3458 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3459 = cute.make_coord(%tup_3457) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1184 = cute.elem_less(%coord_3458, %coord_3459) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3460 = cute.get_layout(%1168) : !memref_rmem_f32_3 loc(#loc294)
      %1185 = cute.get_shape(%lay_3460) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3461, %e1_3462, %e2_3463, %e3_3464 = cute.get_leaves(%1185) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1186 = cute.get_stride(%lay_3460) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3465, %e1_3466, %e2_3467, %e3_3468 = cute.get_leaves(%1186) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1187 = scf.if %1184 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1168) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,10)"> loc(#loc477)
        cute.memref.store(%1168, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,10)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1168) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1168 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1168) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1168) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1168 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3469 = cute.get_iter(%1187) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3470 = cute.get_layout(%1187) : !memref_rmem_f32_3 loc(#loc294)
      %1188 = cute.get_shape(%lay_3470) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3471, %e1_3472, %e2_3473, %e3_3474 = cute.get_leaves(%1188) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1189 = cute.get_stride(%lay_3470) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3475, %e1_3476, %e2_3477, %e3_3478 = cute.get_leaves(%1189) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3479 = cute.get_iter(%1187) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3480 = cute.get_iter(%1187) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3481 = cute.make_coord() : () -> !cute.coord<"(0,11)"> loc(#loc474)
      %slice_3482 = cute.slice(%view_2302, %coord_3481) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)"> loc(#loc474)
      %iter_3483 = cute.get_iter(%slice_3482) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3484, %e1_3485, %e2_3486, %e3_3487 = cute.get_leaves(%iter_3483) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1190 = cute.get_scalars(%e0_3484) : !cute.int_tuple<"?"> loc(#loc290)
      %1191 = cute.get_scalars(%e1_3485) : !cute.int_tuple<"?"> loc(#loc290)
      %1192 = cute.get_scalars(%e2_3486) : !cute.int_tuple<"?"> loc(#loc290)
      %1193 = cute.get_scalars(%e3_3487) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3488 = cute.get_iter(%slice_3482) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3489, %e1_3490, %e2_3491, %e3_3492 = cute.get_leaves(%iter_3488) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1194 = cute.get_scalars(%e0_3489) : !cute.int_tuple<"?"> loc(#loc290)
      %1195 = cute.get_scalars(%e1_3490) : !cute.int_tuple<"?"> loc(#loc290)
      %1196 = cute.get_scalars(%e2_3491) : !cute.int_tuple<"?"> loc(#loc290)
      %1197 = cute.get_scalars(%e3_3492) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3493 = cute.get_iter(%slice_3482) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3494, %e1_3495, %e2_3496, %e3_3497 = cute.get_leaves(%iter_3493) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1198 = cute.get_scalars(%e0_3494) : !cute.int_tuple<"?"> loc(#loc474)
      %1199 = cute.get_scalars(%e1_3495) : !cute.int_tuple<"?"> loc(#loc474)
      %1200 = cute.get_scalars(%e2_3496) : !cute.int_tuple<"?"> loc(#loc474)
      %1201 = cute.get_scalars(%e3_3497) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3498 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3499 = cute.add_offset(%e3_3497, %int_tuple_3498) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1202 = cute.get_scalars(%tup_3499) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3500 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3501 = cute.make_coord(%tup_3499) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1203 = cute.elem_less(%coord_3500, %coord_3501) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3502 = cute.get_layout(%1187) : !memref_rmem_f32_3 loc(#loc294)
      %1204 = cute.get_shape(%lay_3502) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3503, %e1_3504, %e2_3505, %e3_3506 = cute.get_leaves(%1204) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1205 = cute.get_stride(%lay_3502) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3507, %e1_3508, %e2_3509, %e3_3510 = cute.get_leaves(%1205) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1206 = scf.if %1203 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1187) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,11)"> loc(#loc477)
        cute.memref.store(%1187, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,11)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1187) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1187 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1187) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1187) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1187 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3511 = cute.get_iter(%1206) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3512 = cute.get_layout(%1206) : !memref_rmem_f32_3 loc(#loc294)
      %1207 = cute.get_shape(%lay_3512) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3513, %e1_3514, %e2_3515, %e3_3516 = cute.get_leaves(%1207) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1208 = cute.get_stride(%lay_3512) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3517, %e1_3518, %e2_3519, %e3_3520 = cute.get_leaves(%1208) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3521 = cute.get_iter(%1206) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3522 = cute.get_iter(%1206) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3523 = cute.make_coord() : () -> !cute.coord<"(0,12)"> loc(#loc474)
      %slice_3524 = cute.slice(%view_2302, %coord_3523) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)"> loc(#loc474)
      %iter_3525 = cute.get_iter(%slice_3524) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3526, %e1_3527, %e2_3528, %e3_3529 = cute.get_leaves(%iter_3525) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1209 = cute.get_scalars(%e0_3526) : !cute.int_tuple<"?"> loc(#loc290)
      %1210 = cute.get_scalars(%e1_3527) : !cute.int_tuple<"?"> loc(#loc290)
      %1211 = cute.get_scalars(%e2_3528) : !cute.int_tuple<"?"> loc(#loc290)
      %1212 = cute.get_scalars(%e3_3529) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3530 = cute.get_iter(%slice_3524) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3531, %e1_3532, %e2_3533, %e3_3534 = cute.get_leaves(%iter_3530) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1213 = cute.get_scalars(%e0_3531) : !cute.int_tuple<"?"> loc(#loc290)
      %1214 = cute.get_scalars(%e1_3532) : !cute.int_tuple<"?"> loc(#loc290)
      %1215 = cute.get_scalars(%e2_3533) : !cute.int_tuple<"?"> loc(#loc290)
      %1216 = cute.get_scalars(%e3_3534) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3535 = cute.get_iter(%slice_3524) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3536, %e1_3537, %e2_3538, %e3_3539 = cute.get_leaves(%iter_3535) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1217 = cute.get_scalars(%e0_3536) : !cute.int_tuple<"?"> loc(#loc474)
      %1218 = cute.get_scalars(%e1_3537) : !cute.int_tuple<"?"> loc(#loc474)
      %1219 = cute.get_scalars(%e2_3538) : !cute.int_tuple<"?"> loc(#loc474)
      %1220 = cute.get_scalars(%e3_3539) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3540 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3541 = cute.add_offset(%e3_3539, %int_tuple_3540) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1221 = cute.get_scalars(%tup_3541) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3542 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3543 = cute.make_coord(%tup_3541) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1222 = cute.elem_less(%coord_3542, %coord_3543) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3544 = cute.get_layout(%1206) : !memref_rmem_f32_3 loc(#loc294)
      %1223 = cute.get_shape(%lay_3544) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3545, %e1_3546, %e2_3547, %e3_3548 = cute.get_leaves(%1223) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1224 = cute.get_stride(%lay_3544) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3549, %e1_3550, %e2_3551, %e3_3552 = cute.get_leaves(%1224) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1225 = scf.if %1222 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1206) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,12)"> loc(#loc477)
        cute.memref.store(%1206, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,12)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1206) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1206 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1206) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1206) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1206 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3553 = cute.get_iter(%1225) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3554 = cute.get_layout(%1225) : !memref_rmem_f32_3 loc(#loc294)
      %1226 = cute.get_shape(%lay_3554) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3555, %e1_3556, %e2_3557, %e3_3558 = cute.get_leaves(%1226) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1227 = cute.get_stride(%lay_3554) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3559, %e1_3560, %e2_3561, %e3_3562 = cute.get_leaves(%1227) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3563 = cute.get_iter(%1225) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3564 = cute.get_iter(%1225) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3565 = cute.make_coord() : () -> !cute.coord<"(0,13)"> loc(#loc474)
      %slice_3566 = cute.slice(%view_2302, %coord_3565) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)"> loc(#loc474)
      %iter_3567 = cute.get_iter(%slice_3566) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3568, %e1_3569, %e2_3570, %e3_3571 = cute.get_leaves(%iter_3567) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1228 = cute.get_scalars(%e0_3568) : !cute.int_tuple<"?"> loc(#loc290)
      %1229 = cute.get_scalars(%e1_3569) : !cute.int_tuple<"?"> loc(#loc290)
      %1230 = cute.get_scalars(%e2_3570) : !cute.int_tuple<"?"> loc(#loc290)
      %1231 = cute.get_scalars(%e3_3571) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3572 = cute.get_iter(%slice_3566) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3573, %e1_3574, %e2_3575, %e3_3576 = cute.get_leaves(%iter_3572) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1232 = cute.get_scalars(%e0_3573) : !cute.int_tuple<"?"> loc(#loc290)
      %1233 = cute.get_scalars(%e1_3574) : !cute.int_tuple<"?"> loc(#loc290)
      %1234 = cute.get_scalars(%e2_3575) : !cute.int_tuple<"?"> loc(#loc290)
      %1235 = cute.get_scalars(%e3_3576) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3577 = cute.get_iter(%slice_3566) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3578, %e1_3579, %e2_3580, %e3_3581 = cute.get_leaves(%iter_3577) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1236 = cute.get_scalars(%e0_3578) : !cute.int_tuple<"?"> loc(#loc474)
      %1237 = cute.get_scalars(%e1_3579) : !cute.int_tuple<"?"> loc(#loc474)
      %1238 = cute.get_scalars(%e2_3580) : !cute.int_tuple<"?"> loc(#loc474)
      %1239 = cute.get_scalars(%e3_3581) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3582 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3583 = cute.add_offset(%e3_3581, %int_tuple_3582) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1240 = cute.get_scalars(%tup_3583) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3584 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3585 = cute.make_coord(%tup_3583) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1241 = cute.elem_less(%coord_3584, %coord_3585) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3586 = cute.get_layout(%1225) : !memref_rmem_f32_3 loc(#loc294)
      %1242 = cute.get_shape(%lay_3586) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3587, %e1_3588, %e2_3589, %e3_3590 = cute.get_leaves(%1242) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1243 = cute.get_stride(%lay_3586) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3591, %e1_3592, %e2_3593, %e3_3594 = cute.get_leaves(%1243) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1244 = scf.if %1241 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1225) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,13)"> loc(#loc477)
        cute.memref.store(%1225, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,13)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1225) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1225 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1225) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1225) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1225 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3595 = cute.get_iter(%1244) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3596 = cute.get_layout(%1244) : !memref_rmem_f32_3 loc(#loc294)
      %1245 = cute.get_shape(%lay_3596) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3597, %e1_3598, %e2_3599, %e3_3600 = cute.get_leaves(%1245) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1246 = cute.get_stride(%lay_3596) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3601, %e1_3602, %e2_3603, %e3_3604 = cute.get_leaves(%1246) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3605 = cute.get_iter(%1244) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3606 = cute.get_iter(%1244) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3607 = cute.make_coord() : () -> !cute.coord<"(0,14)"> loc(#loc474)
      %slice_3608 = cute.slice(%view_2302, %coord_3607) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)"> loc(#loc474)
      %iter_3609 = cute.get_iter(%slice_3608) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3610, %e1_3611, %e2_3612, %e3_3613 = cute.get_leaves(%iter_3609) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1247 = cute.get_scalars(%e0_3610) : !cute.int_tuple<"?"> loc(#loc290)
      %1248 = cute.get_scalars(%e1_3611) : !cute.int_tuple<"?"> loc(#loc290)
      %1249 = cute.get_scalars(%e2_3612) : !cute.int_tuple<"?"> loc(#loc290)
      %1250 = cute.get_scalars(%e3_3613) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3614 = cute.get_iter(%slice_3608) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3615, %e1_3616, %e2_3617, %e3_3618 = cute.get_leaves(%iter_3614) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1251 = cute.get_scalars(%e0_3615) : !cute.int_tuple<"?"> loc(#loc290)
      %1252 = cute.get_scalars(%e1_3616) : !cute.int_tuple<"?"> loc(#loc290)
      %1253 = cute.get_scalars(%e2_3617) : !cute.int_tuple<"?"> loc(#loc290)
      %1254 = cute.get_scalars(%e3_3618) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3619 = cute.get_iter(%slice_3608) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3620, %e1_3621, %e2_3622, %e3_3623 = cute.get_leaves(%iter_3619) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1255 = cute.get_scalars(%e0_3620) : !cute.int_tuple<"?"> loc(#loc474)
      %1256 = cute.get_scalars(%e1_3621) : !cute.int_tuple<"?"> loc(#loc474)
      %1257 = cute.get_scalars(%e2_3622) : !cute.int_tuple<"?"> loc(#loc474)
      %1258 = cute.get_scalars(%e3_3623) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3624 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3625 = cute.add_offset(%e3_3623, %int_tuple_3624) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1259 = cute.get_scalars(%tup_3625) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3626 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3627 = cute.make_coord(%tup_3625) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1260 = cute.elem_less(%coord_3626, %coord_3627) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3628 = cute.get_layout(%1244) : !memref_rmem_f32_3 loc(#loc294)
      %1261 = cute.get_shape(%lay_3628) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3629, %e1_3630, %e2_3631, %e3_3632 = cute.get_leaves(%1261) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1262 = cute.get_stride(%lay_3628) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3633, %e1_3634, %e2_3635, %e3_3636 = cute.get_leaves(%1262) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1263 = scf.if %1260 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1244) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,14)"> loc(#loc477)
        cute.memref.store(%1244, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,14)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1244) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1244 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1244) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1244) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1244 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3637 = cute.get_iter(%1263) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3638 = cute.get_layout(%1263) : !memref_rmem_f32_3 loc(#loc294)
      %1264 = cute.get_shape(%lay_3638) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3639, %e1_3640, %e2_3641, %e3_3642 = cute.get_leaves(%1264) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1265 = cute.get_stride(%lay_3638) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3643, %e1_3644, %e2_3645, %e3_3646 = cute.get_leaves(%1265) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3647 = cute.get_iter(%1263) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3648 = cute.get_iter(%1263) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3649 = cute.make_coord() : () -> !cute.coord<"(0,15)"> loc(#loc474)
      %slice_3650 = cute.slice(%view_2302, %coord_3649) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)"> loc(#loc474)
      %iter_3651 = cute.get_iter(%slice_3650) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3652, %e1_3653, %e2_3654, %e3_3655 = cute.get_leaves(%iter_3651) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1266 = cute.get_scalars(%e0_3652) : !cute.int_tuple<"?"> loc(#loc290)
      %1267 = cute.get_scalars(%e1_3653) : !cute.int_tuple<"?"> loc(#loc290)
      %1268 = cute.get_scalars(%e2_3654) : !cute.int_tuple<"?"> loc(#loc290)
      %1269 = cute.get_scalars(%e3_3655) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3656 = cute.get_iter(%slice_3650) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3657, %e1_3658, %e2_3659, %e3_3660 = cute.get_leaves(%iter_3656) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1270 = cute.get_scalars(%e0_3657) : !cute.int_tuple<"?"> loc(#loc290)
      %1271 = cute.get_scalars(%e1_3658) : !cute.int_tuple<"?"> loc(#loc290)
      %1272 = cute.get_scalars(%e2_3659) : !cute.int_tuple<"?"> loc(#loc290)
      %1273 = cute.get_scalars(%e3_3660) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3661 = cute.get_iter(%slice_3650) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3662, %e1_3663, %e2_3664, %e3_3665 = cute.get_leaves(%iter_3661) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1274 = cute.get_scalars(%e0_3662) : !cute.int_tuple<"?"> loc(#loc474)
      %1275 = cute.get_scalars(%e1_3663) : !cute.int_tuple<"?"> loc(#loc474)
      %1276 = cute.get_scalars(%e2_3664) : !cute.int_tuple<"?"> loc(#loc474)
      %1277 = cute.get_scalars(%e3_3665) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3666 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3667 = cute.add_offset(%e3_3665, %int_tuple_3666) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1278 = cute.get_scalars(%tup_3667) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3668 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3669 = cute.make_coord(%tup_3667) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1279 = cute.elem_less(%coord_3668, %coord_3669) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3670 = cute.get_layout(%1263) : !memref_rmem_f32_3 loc(#loc294)
      %1280 = cute.get_shape(%lay_3670) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3671, %e1_3672, %e2_3673, %e3_3674 = cute.get_leaves(%1280) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1281 = cute.get_stride(%lay_3670) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3675, %e1_3676, %e2_3677, %e3_3678 = cute.get_leaves(%1281) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1282 = scf.if %1279 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1263) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(1,15)"> loc(#loc477)
        cute.memref.store(%1263, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(1,15)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1263) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1263 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1263) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1263) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1263 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3679 = cute.get_iter(%1282) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3680 = cute.get_layout(%1282) : !memref_rmem_f32_3 loc(#loc294)
      %1283 = cute.get_shape(%lay_3680) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3681, %e1_3682, %e2_3683, %e3_3684 = cute.get_leaves(%1283) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1284 = cute.get_stride(%lay_3680) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3685, %e1_3686, %e2_3687, %e3_3688 = cute.get_leaves(%1284) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3689 = cute.get_iter(%1282) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3690 = cute.get_iter(%1282) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3691 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc480)
      %slice_3692 = cute.slice(%1282, %coord_3691) : !memref_rmem_f32_3, !cute.coord<"(1,_)"> loc(#loc480)
      %iter_3693 = cute.get_iter(%slice_3692) : !memref_rmem_f32_6 loc(#loc316)
      %iter_3694 = cute.get_iter(%slice_3692) : !memref_rmem_f32_6 loc(#loc317)
      %lay_3695 = cute.get_layout(%slice_3692) : !memref_rmem_f32_6 loc(#loc311)
      %1285 = cute.get_shape(%lay_3695) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_3696, %e1_3697 = cute.get_leaves(%1285) : !cute.shape<"((2,8))"> loc(#loc311)
      %1286 = cute.memref.load_vec %slice_3692 : !memref_rmem_f32_6 loc(#loc480)
      %cst_3698 = arith.constant 0xFF800000 : f32 loc(#loc481)
      %1287 = vector.reduction <maximumf>, %1286, %cst_3698 : vector<16xf32> into f32 loc(#loc481)
      %c-1_i32_3699 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_3700 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_3701 = arith.constant 31 : i32 loc(#loc482)
      %1288 = nvvm.shfl.sync  bfly %c-1_i32_3699, %1287, %c2_i32_3700, %c31_i32_3701 : f32 -> f32 loc(#loc482)
      %1289 = nvvm.fmax %1287, %1288 loc(#loc483)
      %c-1_i32_3702 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_3703 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_3704 = arith.constant 31 : i32 loc(#loc484)
      %1290 = nvvm.shfl.sync  bfly %c-1_i32_3702, %1289, %c1_i32_3703, %c31_i32_3704 : f32 -> f32 loc(#loc484)
      %1291 = nvvm.fmax %1289, %1290 loc(#loc483)
      %1292 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
      %1293 = arith.mulf %1286, %1292 : vector<16xf32> loc(#loc485)
      %1294 = arith.mulf %1291, %arg4 : f32 loc(#loc313)
      %1295 = vector.broadcast %1294 : f32 to vector<16xf32> loc(#loc290)
      %1296 = arith.subf %1293, %1295 : vector<16xf32> loc(#loc485)
      %1297 = math.exp2 %1296 fastmath<fast> : vector<16xf32> loc(#loc290)
      %cst_3705 = arith.constant 0.000000e+00 : f32 loc(#loc486)
      %1298 = vector.reduction <add>, %1297, %cst_3705 : vector<16xf32> into f32 loc(#loc486)
      %coord_3706 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc487)
      cute.memref.store(%rmem_919, %coord_3706, %1291) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> () loc(#loc487)
      %coord_3707 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc488)
      cute.memref.store(%rmem_924, %coord_3707, %1298) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> () loc(#loc488)
      %coord_3708 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc489)
      %slice_3709 = cute.slice(%1282, %coord_3708) : !memref_rmem_f32_3, !cute.coord<"(1,_)"> loc(#loc489)
      %iter_3710 = cute.get_iter(%slice_3709) : !memref_rmem_f32_6 loc(#loc316)
      %iter_3711 = cute.get_iter(%slice_3709) : !memref_rmem_f32_6 loc(#loc317)
      %lay_3712 = cute.get_layout(%slice_3709) : !memref_rmem_f32_6 loc(#loc311)
      %1299 = cute.get_shape(%lay_3712) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_3713, %e1_3714 = cute.get_leaves(%1299) : !cute.shape<"((2,8))"> loc(#loc311)
      %int_tuple_3715 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_3716 = cute.size(%int_tuple_3715) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_3717 = cute.get_leaves(%sz_3716) : !cute.int_tuple<"16"> loc(#loc489)
      %int_tuple_3718 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_3719 = cute.size(%int_tuple_3718) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_3720 = cute.get_leaves(%sz_3719) : !cute.int_tuple<"16"> loc(#loc489)
      cute.memref.store_vec %1297, %slice_3709 : !memref_rmem_f32_6 loc(#loc489)
      %int_tuple_3721 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)"> loc(#loc473)
      %sz_3722 = cute.size(%int_tuple_3721) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16"> loc(#loc473)
      %e0_3723 = cute.get_leaves(%sz_3722) : !cute.int_tuple<"16"> loc(#loc473)
      %coord_3724 = cute.make_coord() : () -> !cute.coord<"(0,0)"> loc(#loc474)
      %slice_3725 = cute.slice(%view_2302, %coord_3724) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)"> loc(#loc474)
      %iter_3726 = cute.get_iter(%slice_3725) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3727, %e1_3728, %e2_3729, %e3_3730 = cute.get_leaves(%iter_3726) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1300 = cute.get_scalars(%e0_3727) : !cute.int_tuple<"?"> loc(#loc290)
      %1301 = cute.get_scalars(%e1_3728) : !cute.int_tuple<"?"> loc(#loc290)
      %1302 = cute.get_scalars(%e2_3729) : !cute.int_tuple<"?"> loc(#loc290)
      %1303 = cute.get_scalars(%e3_3730) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3731 = cute.get_iter(%slice_3725) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3732, %e1_3733, %e2_3734, %e3_3735 = cute.get_leaves(%iter_3731) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1304 = cute.get_scalars(%e0_3732) : !cute.int_tuple<"?"> loc(#loc290)
      %1305 = cute.get_scalars(%e1_3733) : !cute.int_tuple<"?"> loc(#loc290)
      %1306 = cute.get_scalars(%e2_3734) : !cute.int_tuple<"?"> loc(#loc290)
      %1307 = cute.get_scalars(%e3_3735) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3736 = cute.get_iter(%slice_3725) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3737, %e1_3738, %e2_3739, %e3_3740 = cute.get_leaves(%iter_3736) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1308 = cute.get_scalars(%e0_3737) : !cute.int_tuple<"?"> loc(#loc474)
      %1309 = cute.get_scalars(%e1_3738) : !cute.int_tuple<"?"> loc(#loc474)
      %1310 = cute.get_scalars(%e2_3739) : !cute.int_tuple<"?"> loc(#loc474)
      %1311 = cute.get_scalars(%e3_3740) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3741 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3742 = cute.add_offset(%e3_3740, %int_tuple_3741) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1312 = cute.get_scalars(%tup_3742) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3743 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3744 = cute.make_coord(%tup_3742) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1313 = cute.elem_less(%coord_3743, %coord_3744) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3745 = cute.get_layout(%1282) : !memref_rmem_f32_3 loc(#loc294)
      %1314 = cute.get_shape(%lay_3745) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3746, %e1_3747, %e2_3748, %e3_3749 = cute.get_leaves(%1314) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1315 = cute.get_stride(%lay_3745) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3750, %e1_3751, %e2_3752, %e3_3753 = cute.get_leaves(%1315) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1316 = scf.if %1313 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1282) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,0)"> loc(#loc477)
        cute.memref.store(%1282, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,0)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1282) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1282 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1282) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1282) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1282 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3754 = cute.get_iter(%1316) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3755 = cute.get_layout(%1316) : !memref_rmem_f32_3 loc(#loc294)
      %1317 = cute.get_shape(%lay_3755) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3756, %e1_3757, %e2_3758, %e3_3759 = cute.get_leaves(%1317) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1318 = cute.get_stride(%lay_3755) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3760, %e1_3761, %e2_3762, %e3_3763 = cute.get_leaves(%1318) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3764 = cute.get_iter(%1316) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3765 = cute.get_iter(%1316) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3766 = cute.make_coord() : () -> !cute.coord<"(0,1)"> loc(#loc474)
      %slice_3767 = cute.slice(%view_2302, %coord_3766) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)"> loc(#loc474)
      %iter_3768 = cute.get_iter(%slice_3767) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3769, %e1_3770, %e2_3771, %e3_3772 = cute.get_leaves(%iter_3768) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1319 = cute.get_scalars(%e0_3769) : !cute.int_tuple<"?"> loc(#loc290)
      %1320 = cute.get_scalars(%e1_3770) : !cute.int_tuple<"?"> loc(#loc290)
      %1321 = cute.get_scalars(%e2_3771) : !cute.int_tuple<"?"> loc(#loc290)
      %1322 = cute.get_scalars(%e3_3772) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3773 = cute.get_iter(%slice_3767) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3774, %e1_3775, %e2_3776, %e3_3777 = cute.get_leaves(%iter_3773) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1323 = cute.get_scalars(%e0_3774) : !cute.int_tuple<"?"> loc(#loc290)
      %1324 = cute.get_scalars(%e1_3775) : !cute.int_tuple<"?"> loc(#loc290)
      %1325 = cute.get_scalars(%e2_3776) : !cute.int_tuple<"?"> loc(#loc290)
      %1326 = cute.get_scalars(%e3_3777) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3778 = cute.get_iter(%slice_3767) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3779, %e1_3780, %e2_3781, %e3_3782 = cute.get_leaves(%iter_3778) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1327 = cute.get_scalars(%e0_3779) : !cute.int_tuple<"?"> loc(#loc474)
      %1328 = cute.get_scalars(%e1_3780) : !cute.int_tuple<"?"> loc(#loc474)
      %1329 = cute.get_scalars(%e2_3781) : !cute.int_tuple<"?"> loc(#loc474)
      %1330 = cute.get_scalars(%e3_3782) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3783 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3784 = cute.add_offset(%e3_3782, %int_tuple_3783) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1331 = cute.get_scalars(%tup_3784) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3785 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3786 = cute.make_coord(%tup_3784) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1332 = cute.elem_less(%coord_3785, %coord_3786) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3787 = cute.get_layout(%1316) : !memref_rmem_f32_3 loc(#loc294)
      %1333 = cute.get_shape(%lay_3787) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3788, %e1_3789, %e2_3790, %e3_3791 = cute.get_leaves(%1333) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1334 = cute.get_stride(%lay_3787) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3792, %e1_3793, %e2_3794, %e3_3795 = cute.get_leaves(%1334) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1335 = scf.if %1332 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1316) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,1)"> loc(#loc477)
        cute.memref.store(%1316, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,1)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1316) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1316 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1316) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1316) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1316 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3796 = cute.get_iter(%1335) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3797 = cute.get_layout(%1335) : !memref_rmem_f32_3 loc(#loc294)
      %1336 = cute.get_shape(%lay_3797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3798, %e1_3799, %e2_3800, %e3_3801 = cute.get_leaves(%1336) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1337 = cute.get_stride(%lay_3797) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3802, %e1_3803, %e2_3804, %e3_3805 = cute.get_leaves(%1337) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3806 = cute.get_iter(%1335) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3807 = cute.get_iter(%1335) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3808 = cute.make_coord() : () -> !cute.coord<"(0,2)"> loc(#loc474)
      %slice_3809 = cute.slice(%view_2302, %coord_3808) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)"> loc(#loc474)
      %iter_3810 = cute.get_iter(%slice_3809) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3811, %e1_3812, %e2_3813, %e3_3814 = cute.get_leaves(%iter_3810) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1338 = cute.get_scalars(%e0_3811) : !cute.int_tuple<"?"> loc(#loc290)
      %1339 = cute.get_scalars(%e1_3812) : !cute.int_tuple<"?"> loc(#loc290)
      %1340 = cute.get_scalars(%e2_3813) : !cute.int_tuple<"?"> loc(#loc290)
      %1341 = cute.get_scalars(%e3_3814) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3815 = cute.get_iter(%slice_3809) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3816, %e1_3817, %e2_3818, %e3_3819 = cute.get_leaves(%iter_3815) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1342 = cute.get_scalars(%e0_3816) : !cute.int_tuple<"?"> loc(#loc290)
      %1343 = cute.get_scalars(%e1_3817) : !cute.int_tuple<"?"> loc(#loc290)
      %1344 = cute.get_scalars(%e2_3818) : !cute.int_tuple<"?"> loc(#loc290)
      %1345 = cute.get_scalars(%e3_3819) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3820 = cute.get_iter(%slice_3809) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3821, %e1_3822, %e2_3823, %e3_3824 = cute.get_leaves(%iter_3820) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1346 = cute.get_scalars(%e0_3821) : !cute.int_tuple<"?"> loc(#loc474)
      %1347 = cute.get_scalars(%e1_3822) : !cute.int_tuple<"?"> loc(#loc474)
      %1348 = cute.get_scalars(%e2_3823) : !cute.int_tuple<"?"> loc(#loc474)
      %1349 = cute.get_scalars(%e3_3824) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3825 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3826 = cute.add_offset(%e3_3824, %int_tuple_3825) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1350 = cute.get_scalars(%tup_3826) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3827 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3828 = cute.make_coord(%tup_3826) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1351 = cute.elem_less(%coord_3827, %coord_3828) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3829 = cute.get_layout(%1335) : !memref_rmem_f32_3 loc(#loc294)
      %1352 = cute.get_shape(%lay_3829) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3830, %e1_3831, %e2_3832, %e3_3833 = cute.get_leaves(%1352) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1353 = cute.get_stride(%lay_3829) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3834, %e1_3835, %e2_3836, %e3_3837 = cute.get_leaves(%1353) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1354 = scf.if %1351 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1335) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,2)"> loc(#loc477)
        cute.memref.store(%1335, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,2)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1335) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1335 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1335) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1335) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1335 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3838 = cute.get_iter(%1354) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3839 = cute.get_layout(%1354) : !memref_rmem_f32_3 loc(#loc294)
      %1355 = cute.get_shape(%lay_3839) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3840, %e1_3841, %e2_3842, %e3_3843 = cute.get_leaves(%1355) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1356 = cute.get_stride(%lay_3839) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3844, %e1_3845, %e2_3846, %e3_3847 = cute.get_leaves(%1356) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3848 = cute.get_iter(%1354) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3849 = cute.get_iter(%1354) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3850 = cute.make_coord() : () -> !cute.coord<"(0,3)"> loc(#loc474)
      %slice_3851 = cute.slice(%view_2302, %coord_3850) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)"> loc(#loc474)
      %iter_3852 = cute.get_iter(%slice_3851) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3853, %e1_3854, %e2_3855, %e3_3856 = cute.get_leaves(%iter_3852) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1357 = cute.get_scalars(%e0_3853) : !cute.int_tuple<"?"> loc(#loc290)
      %1358 = cute.get_scalars(%e1_3854) : !cute.int_tuple<"?"> loc(#loc290)
      %1359 = cute.get_scalars(%e2_3855) : !cute.int_tuple<"?"> loc(#loc290)
      %1360 = cute.get_scalars(%e3_3856) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3857 = cute.get_iter(%slice_3851) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3858, %e1_3859, %e2_3860, %e3_3861 = cute.get_leaves(%iter_3857) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1361 = cute.get_scalars(%e0_3858) : !cute.int_tuple<"?"> loc(#loc290)
      %1362 = cute.get_scalars(%e1_3859) : !cute.int_tuple<"?"> loc(#loc290)
      %1363 = cute.get_scalars(%e2_3860) : !cute.int_tuple<"?"> loc(#loc290)
      %1364 = cute.get_scalars(%e3_3861) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3862 = cute.get_iter(%slice_3851) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3863, %e1_3864, %e2_3865, %e3_3866 = cute.get_leaves(%iter_3862) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1365 = cute.get_scalars(%e0_3863) : !cute.int_tuple<"?"> loc(#loc474)
      %1366 = cute.get_scalars(%e1_3864) : !cute.int_tuple<"?"> loc(#loc474)
      %1367 = cute.get_scalars(%e2_3865) : !cute.int_tuple<"?"> loc(#loc474)
      %1368 = cute.get_scalars(%e3_3866) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3867 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3868 = cute.add_offset(%e3_3866, %int_tuple_3867) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1369 = cute.get_scalars(%tup_3868) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3869 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3870 = cute.make_coord(%tup_3868) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1370 = cute.elem_less(%coord_3869, %coord_3870) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3871 = cute.get_layout(%1354) : !memref_rmem_f32_3 loc(#loc294)
      %1371 = cute.get_shape(%lay_3871) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3872, %e1_3873, %e2_3874, %e3_3875 = cute.get_leaves(%1371) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1372 = cute.get_stride(%lay_3871) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3876, %e1_3877, %e2_3878, %e3_3879 = cute.get_leaves(%1372) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1373 = scf.if %1370 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1354) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,3)"> loc(#loc477)
        cute.memref.store(%1354, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,3)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1354) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1354 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1354) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1354) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1354 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3880 = cute.get_iter(%1373) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3881 = cute.get_layout(%1373) : !memref_rmem_f32_3 loc(#loc294)
      %1374 = cute.get_shape(%lay_3881) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3882, %e1_3883, %e2_3884, %e3_3885 = cute.get_leaves(%1374) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1375 = cute.get_stride(%lay_3881) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3886, %e1_3887, %e2_3888, %e3_3889 = cute.get_leaves(%1375) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3890 = cute.get_iter(%1373) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3891 = cute.get_iter(%1373) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3892 = cute.make_coord() : () -> !cute.coord<"(0,4)"> loc(#loc474)
      %slice_3893 = cute.slice(%view_2302, %coord_3892) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)"> loc(#loc474)
      %iter_3894 = cute.get_iter(%slice_3893) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3895, %e1_3896, %e2_3897, %e3_3898 = cute.get_leaves(%iter_3894) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1376 = cute.get_scalars(%e0_3895) : !cute.int_tuple<"?"> loc(#loc290)
      %1377 = cute.get_scalars(%e1_3896) : !cute.int_tuple<"?"> loc(#loc290)
      %1378 = cute.get_scalars(%e2_3897) : !cute.int_tuple<"?"> loc(#loc290)
      %1379 = cute.get_scalars(%e3_3898) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3899 = cute.get_iter(%slice_3893) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3900, %e1_3901, %e2_3902, %e3_3903 = cute.get_leaves(%iter_3899) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1380 = cute.get_scalars(%e0_3900) : !cute.int_tuple<"?"> loc(#loc290)
      %1381 = cute.get_scalars(%e1_3901) : !cute.int_tuple<"?"> loc(#loc290)
      %1382 = cute.get_scalars(%e2_3902) : !cute.int_tuple<"?"> loc(#loc290)
      %1383 = cute.get_scalars(%e3_3903) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3904 = cute.get_iter(%slice_3893) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3905, %e1_3906, %e2_3907, %e3_3908 = cute.get_leaves(%iter_3904) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1384 = cute.get_scalars(%e0_3905) : !cute.int_tuple<"?"> loc(#loc474)
      %1385 = cute.get_scalars(%e1_3906) : !cute.int_tuple<"?"> loc(#loc474)
      %1386 = cute.get_scalars(%e2_3907) : !cute.int_tuple<"?"> loc(#loc474)
      %1387 = cute.get_scalars(%e3_3908) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3909 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3910 = cute.add_offset(%e3_3908, %int_tuple_3909) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1388 = cute.get_scalars(%tup_3910) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3911 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3912 = cute.make_coord(%tup_3910) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1389 = cute.elem_less(%coord_3911, %coord_3912) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3913 = cute.get_layout(%1373) : !memref_rmem_f32_3 loc(#loc294)
      %1390 = cute.get_shape(%lay_3913) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3914, %e1_3915, %e2_3916, %e3_3917 = cute.get_leaves(%1390) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1391 = cute.get_stride(%lay_3913) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3918, %e1_3919, %e2_3920, %e3_3921 = cute.get_leaves(%1391) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1392 = scf.if %1389 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1373) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,4)"> loc(#loc477)
        cute.memref.store(%1373, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,4)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1373) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1373 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1373) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1373) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1373 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3922 = cute.get_iter(%1392) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3923 = cute.get_layout(%1392) : !memref_rmem_f32_3 loc(#loc294)
      %1393 = cute.get_shape(%lay_3923) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3924, %e1_3925, %e2_3926, %e3_3927 = cute.get_leaves(%1393) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1394 = cute.get_stride(%lay_3923) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3928, %e1_3929, %e2_3930, %e3_3931 = cute.get_leaves(%1394) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3932 = cute.get_iter(%1392) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3933 = cute.get_iter(%1392) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3934 = cute.make_coord() : () -> !cute.coord<"(0,5)"> loc(#loc474)
      %slice_3935 = cute.slice(%view_2302, %coord_3934) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)"> loc(#loc474)
      %iter_3936 = cute.get_iter(%slice_3935) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_3937, %e1_3938, %e2_3939, %e3_3940 = cute.get_leaves(%iter_3936) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1395 = cute.get_scalars(%e0_3937) : !cute.int_tuple<"?"> loc(#loc290)
      %1396 = cute.get_scalars(%e1_3938) : !cute.int_tuple<"?"> loc(#loc290)
      %1397 = cute.get_scalars(%e2_3939) : !cute.int_tuple<"?"> loc(#loc290)
      %1398 = cute.get_scalars(%e3_3940) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3941 = cute.get_iter(%slice_3935) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_3942, %e1_3943, %e2_3944, %e3_3945 = cute.get_leaves(%iter_3941) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1399 = cute.get_scalars(%e0_3942) : !cute.int_tuple<"?"> loc(#loc290)
      %1400 = cute.get_scalars(%e1_3943) : !cute.int_tuple<"?"> loc(#loc290)
      %1401 = cute.get_scalars(%e2_3944) : !cute.int_tuple<"?"> loc(#loc290)
      %1402 = cute.get_scalars(%e3_3945) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_3946 = cute.get_iter(%slice_3935) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_3947, %e1_3948, %e2_3949, %e3_3950 = cute.get_leaves(%iter_3946) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1403 = cute.get_scalars(%e0_3947) : !cute.int_tuple<"?"> loc(#loc474)
      %1404 = cute.get_scalars(%e1_3948) : !cute.int_tuple<"?"> loc(#loc474)
      %1405 = cute.get_scalars(%e2_3949) : !cute.int_tuple<"?"> loc(#loc474)
      %1406 = cute.get_scalars(%e3_3950) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_3951 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3952 = cute.add_offset(%e3_3950, %int_tuple_3951) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1407 = cute.get_scalars(%tup_3952) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3953 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3954 = cute.make_coord(%tup_3952) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1408 = cute.elem_less(%coord_3953, %coord_3954) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3955 = cute.get_layout(%1392) : !memref_rmem_f32_3 loc(#loc294)
      %1409 = cute.get_shape(%lay_3955) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3956, %e1_3957, %e2_3958, %e3_3959 = cute.get_leaves(%1409) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1410 = cute.get_stride(%lay_3955) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3960, %e1_3961, %e2_3962, %e3_3963 = cute.get_leaves(%1410) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1411 = scf.if %1408 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1392) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,5)"> loc(#loc477)
        cute.memref.store(%1392, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,5)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1392) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1392 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1392) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1392) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1392 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_3964 = cute.get_iter(%1411) : !memref_rmem_f32_3 loc(#loc478)
      %lay_3965 = cute.get_layout(%1411) : !memref_rmem_f32_3 loc(#loc294)
      %1412 = cute.get_shape(%lay_3965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3966, %e1_3967, %e2_3968, %e3_3969 = cute.get_leaves(%1412) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1413 = cute.get_stride(%lay_3965) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_3970, %e1_3971, %e2_3972, %e3_3973 = cute.get_leaves(%1413) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_3974 = cute.get_iter(%1411) : !memref_rmem_f32_3 loc(#loc479)
      %iter_3975 = cute.get_iter(%1411) : !memref_rmem_f32_3 loc(#loc293)
      %coord_3976 = cute.make_coord() : () -> !cute.coord<"(0,6)"> loc(#loc474)
      %slice_3977 = cute.slice(%view_2302, %coord_3976) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)"> loc(#loc474)
      %iter_3978 = cute.get_iter(%slice_3977) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_3979, %e1_3980, %e2_3981, %e3_3982 = cute.get_leaves(%iter_3978) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1414 = cute.get_scalars(%e0_3979) : !cute.int_tuple<"?"> loc(#loc290)
      %1415 = cute.get_scalars(%e1_3980) : !cute.int_tuple<"?"> loc(#loc290)
      %1416 = cute.get_scalars(%e2_3981) : !cute.int_tuple<"?"> loc(#loc290)
      %1417 = cute.get_scalars(%e3_3982) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3983 = cute.get_iter(%slice_3977) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_3984, %e1_3985, %e2_3986, %e3_3987 = cute.get_leaves(%iter_3983) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1418 = cute.get_scalars(%e0_3984) : !cute.int_tuple<"?"> loc(#loc290)
      %1419 = cute.get_scalars(%e1_3985) : !cute.int_tuple<"?"> loc(#loc290)
      %1420 = cute.get_scalars(%e2_3986) : !cute.int_tuple<"?"> loc(#loc290)
      %1421 = cute.get_scalars(%e3_3987) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_3988 = cute.get_iter(%slice_3977) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_3989, %e1_3990, %e2_3991, %e3_3992 = cute.get_leaves(%iter_3988) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1422 = cute.get_scalars(%e0_3989) : !cute.int_tuple<"?"> loc(#loc474)
      %1423 = cute.get_scalars(%e1_3990) : !cute.int_tuple<"?"> loc(#loc474)
      %1424 = cute.get_scalars(%e2_3991) : !cute.int_tuple<"?"> loc(#loc474)
      %1425 = cute.get_scalars(%e3_3992) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_3993 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_3994 = cute.add_offset(%e3_3992, %int_tuple_3993) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1426 = cute.get_scalars(%tup_3994) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_3995 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_3996 = cute.make_coord(%tup_3994) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1427 = cute.elem_less(%coord_3995, %coord_3996) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_3997 = cute.get_layout(%1411) : !memref_rmem_f32_3 loc(#loc294)
      %1428 = cute.get_shape(%lay_3997) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_3998, %e1_3999, %e2_4000, %e3_4001 = cute.get_leaves(%1428) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1429 = cute.get_stride(%lay_3997) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4002, %e1_4003, %e2_4004, %e3_4005 = cute.get_leaves(%1429) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1430 = scf.if %1427 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1411) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,6)"> loc(#loc477)
        cute.memref.store(%1411, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,6)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1411) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1411 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1411) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1411) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1411 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4006 = cute.get_iter(%1430) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4007 = cute.get_layout(%1430) : !memref_rmem_f32_3 loc(#loc294)
      %1431 = cute.get_shape(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4008, %e1_4009, %e2_4010, %e3_4011 = cute.get_leaves(%1431) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1432 = cute.get_stride(%lay_4007) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4012, %e1_4013, %e2_4014, %e3_4015 = cute.get_leaves(%1432) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4016 = cute.get_iter(%1430) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4017 = cute.get_iter(%1430) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4018 = cute.make_coord() : () -> !cute.coord<"(0,7)"> loc(#loc474)
      %slice_4019 = cute.slice(%view_2302, %coord_4018) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)"> loc(#loc474)
      %iter_4020 = cute.get_iter(%slice_4019) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4021, %e1_4022, %e2_4023, %e3_4024 = cute.get_leaves(%iter_4020) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1433 = cute.get_scalars(%e0_4021) : !cute.int_tuple<"?"> loc(#loc290)
      %1434 = cute.get_scalars(%e1_4022) : !cute.int_tuple<"?"> loc(#loc290)
      %1435 = cute.get_scalars(%e2_4023) : !cute.int_tuple<"?"> loc(#loc290)
      %1436 = cute.get_scalars(%e3_4024) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4025 = cute.get_iter(%slice_4019) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4026, %e1_4027, %e2_4028, %e3_4029 = cute.get_leaves(%iter_4025) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1437 = cute.get_scalars(%e0_4026) : !cute.int_tuple<"?"> loc(#loc290)
      %1438 = cute.get_scalars(%e1_4027) : !cute.int_tuple<"?"> loc(#loc290)
      %1439 = cute.get_scalars(%e2_4028) : !cute.int_tuple<"?"> loc(#loc290)
      %1440 = cute.get_scalars(%e3_4029) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4030 = cute.get_iter(%slice_4019) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4031, %e1_4032, %e2_4033, %e3_4034 = cute.get_leaves(%iter_4030) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1441 = cute.get_scalars(%e0_4031) : !cute.int_tuple<"?"> loc(#loc474)
      %1442 = cute.get_scalars(%e1_4032) : !cute.int_tuple<"?"> loc(#loc474)
      %1443 = cute.get_scalars(%e2_4033) : !cute.int_tuple<"?"> loc(#loc474)
      %1444 = cute.get_scalars(%e3_4034) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4035 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4036 = cute.add_offset(%e3_4034, %int_tuple_4035) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1445 = cute.get_scalars(%tup_4036) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4037 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4038 = cute.make_coord(%tup_4036) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1446 = cute.elem_less(%coord_4037, %coord_4038) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4039 = cute.get_layout(%1430) : !memref_rmem_f32_3 loc(#loc294)
      %1447 = cute.get_shape(%lay_4039) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4040, %e1_4041, %e2_4042, %e3_4043 = cute.get_leaves(%1447) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1448 = cute.get_stride(%lay_4039) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4044, %e1_4045, %e2_4046, %e3_4047 = cute.get_leaves(%1448) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1449 = scf.if %1446 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1430) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,7)"> loc(#loc477)
        cute.memref.store(%1430, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,7)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1430) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1430 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1430) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1430) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1430 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4048 = cute.get_iter(%1449) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4049 = cute.get_layout(%1449) : !memref_rmem_f32_3 loc(#loc294)
      %1450 = cute.get_shape(%lay_4049) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4050, %e1_4051, %e2_4052, %e3_4053 = cute.get_leaves(%1450) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1451 = cute.get_stride(%lay_4049) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4054, %e1_4055, %e2_4056, %e3_4057 = cute.get_leaves(%1451) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4058 = cute.get_iter(%1449) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4059 = cute.get_iter(%1449) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4060 = cute.make_coord() : () -> !cute.coord<"(0,8)"> loc(#loc474)
      %slice_4061 = cute.slice(%view_2302, %coord_4060) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)"> loc(#loc474)
      %iter_4062 = cute.get_iter(%slice_4061) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4063, %e1_4064, %e2_4065, %e3_4066 = cute.get_leaves(%iter_4062) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1452 = cute.get_scalars(%e0_4063) : !cute.int_tuple<"?"> loc(#loc290)
      %1453 = cute.get_scalars(%e1_4064) : !cute.int_tuple<"?"> loc(#loc290)
      %1454 = cute.get_scalars(%e2_4065) : !cute.int_tuple<"?"> loc(#loc290)
      %1455 = cute.get_scalars(%e3_4066) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4067 = cute.get_iter(%slice_4061) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4068, %e1_4069, %e2_4070, %e3_4071 = cute.get_leaves(%iter_4067) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1456 = cute.get_scalars(%e0_4068) : !cute.int_tuple<"?"> loc(#loc290)
      %1457 = cute.get_scalars(%e1_4069) : !cute.int_tuple<"?"> loc(#loc290)
      %1458 = cute.get_scalars(%e2_4070) : !cute.int_tuple<"?"> loc(#loc290)
      %1459 = cute.get_scalars(%e3_4071) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4072 = cute.get_iter(%slice_4061) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4073, %e1_4074, %e2_4075, %e3_4076 = cute.get_leaves(%iter_4072) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1460 = cute.get_scalars(%e0_4073) : !cute.int_tuple<"?"> loc(#loc474)
      %1461 = cute.get_scalars(%e1_4074) : !cute.int_tuple<"?"> loc(#loc474)
      %1462 = cute.get_scalars(%e2_4075) : !cute.int_tuple<"?"> loc(#loc474)
      %1463 = cute.get_scalars(%e3_4076) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4077 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4078 = cute.add_offset(%e3_4076, %int_tuple_4077) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1464 = cute.get_scalars(%tup_4078) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4079 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4080 = cute.make_coord(%tup_4078) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1465 = cute.elem_less(%coord_4079, %coord_4080) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4081 = cute.get_layout(%1449) : !memref_rmem_f32_3 loc(#loc294)
      %1466 = cute.get_shape(%lay_4081) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4082, %e1_4083, %e2_4084, %e3_4085 = cute.get_leaves(%1466) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1467 = cute.get_stride(%lay_4081) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4086, %e1_4087, %e2_4088, %e3_4089 = cute.get_leaves(%1467) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1468 = scf.if %1465 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1449) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,8)"> loc(#loc477)
        cute.memref.store(%1449, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,8)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1449) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1449 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1449) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1449) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1449 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4090 = cute.get_iter(%1468) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4091 = cute.get_layout(%1468) : !memref_rmem_f32_3 loc(#loc294)
      %1469 = cute.get_shape(%lay_4091) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4092, %e1_4093, %e2_4094, %e3_4095 = cute.get_leaves(%1469) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1470 = cute.get_stride(%lay_4091) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4096, %e1_4097, %e2_4098, %e3_4099 = cute.get_leaves(%1470) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4100 = cute.get_iter(%1468) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4101 = cute.get_iter(%1468) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4102 = cute.make_coord() : () -> !cute.coord<"(0,9)"> loc(#loc474)
      %slice_4103 = cute.slice(%view_2302, %coord_4102) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)"> loc(#loc474)
      %iter_4104 = cute.get_iter(%slice_4103) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4105, %e1_4106, %e2_4107, %e3_4108 = cute.get_leaves(%iter_4104) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1471 = cute.get_scalars(%e0_4105) : !cute.int_tuple<"?"> loc(#loc290)
      %1472 = cute.get_scalars(%e1_4106) : !cute.int_tuple<"?"> loc(#loc290)
      %1473 = cute.get_scalars(%e2_4107) : !cute.int_tuple<"?"> loc(#loc290)
      %1474 = cute.get_scalars(%e3_4108) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4109 = cute.get_iter(%slice_4103) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4110, %e1_4111, %e2_4112, %e3_4113 = cute.get_leaves(%iter_4109) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1475 = cute.get_scalars(%e0_4110) : !cute.int_tuple<"?"> loc(#loc290)
      %1476 = cute.get_scalars(%e1_4111) : !cute.int_tuple<"?"> loc(#loc290)
      %1477 = cute.get_scalars(%e2_4112) : !cute.int_tuple<"?"> loc(#loc290)
      %1478 = cute.get_scalars(%e3_4113) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4114 = cute.get_iter(%slice_4103) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4115, %e1_4116, %e2_4117, %e3_4118 = cute.get_leaves(%iter_4114) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1479 = cute.get_scalars(%e0_4115) : !cute.int_tuple<"?"> loc(#loc474)
      %1480 = cute.get_scalars(%e1_4116) : !cute.int_tuple<"?"> loc(#loc474)
      %1481 = cute.get_scalars(%e2_4117) : !cute.int_tuple<"?"> loc(#loc474)
      %1482 = cute.get_scalars(%e3_4118) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4119 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4120 = cute.add_offset(%e3_4118, %int_tuple_4119) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1483 = cute.get_scalars(%tup_4120) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4121 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4122 = cute.make_coord(%tup_4120) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1484 = cute.elem_less(%coord_4121, %coord_4122) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4123 = cute.get_layout(%1468) : !memref_rmem_f32_3 loc(#loc294)
      %1485 = cute.get_shape(%lay_4123) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4124, %e1_4125, %e2_4126, %e3_4127 = cute.get_leaves(%1485) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1486 = cute.get_stride(%lay_4123) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4128, %e1_4129, %e2_4130, %e3_4131 = cute.get_leaves(%1486) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1487 = scf.if %1484 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1468) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,9)"> loc(#loc477)
        cute.memref.store(%1468, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,9)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1468) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1468 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1468) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1468) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1468 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4132 = cute.get_iter(%1487) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4133 = cute.get_layout(%1487) : !memref_rmem_f32_3 loc(#loc294)
      %1488 = cute.get_shape(%lay_4133) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4134, %e1_4135, %e2_4136, %e3_4137 = cute.get_leaves(%1488) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1489 = cute.get_stride(%lay_4133) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4138, %e1_4139, %e2_4140, %e3_4141 = cute.get_leaves(%1489) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4142 = cute.get_iter(%1487) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4143 = cute.get_iter(%1487) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4144 = cute.make_coord() : () -> !cute.coord<"(0,10)"> loc(#loc474)
      %slice_4145 = cute.slice(%view_2302, %coord_4144) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)"> loc(#loc474)
      %iter_4146 = cute.get_iter(%slice_4145) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4147, %e1_4148, %e2_4149, %e3_4150 = cute.get_leaves(%iter_4146) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1490 = cute.get_scalars(%e0_4147) : !cute.int_tuple<"?"> loc(#loc290)
      %1491 = cute.get_scalars(%e1_4148) : !cute.int_tuple<"?"> loc(#loc290)
      %1492 = cute.get_scalars(%e2_4149) : !cute.int_tuple<"?"> loc(#loc290)
      %1493 = cute.get_scalars(%e3_4150) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4151 = cute.get_iter(%slice_4145) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4152, %e1_4153, %e2_4154, %e3_4155 = cute.get_leaves(%iter_4151) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1494 = cute.get_scalars(%e0_4152) : !cute.int_tuple<"?"> loc(#loc290)
      %1495 = cute.get_scalars(%e1_4153) : !cute.int_tuple<"?"> loc(#loc290)
      %1496 = cute.get_scalars(%e2_4154) : !cute.int_tuple<"?"> loc(#loc290)
      %1497 = cute.get_scalars(%e3_4155) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4156 = cute.get_iter(%slice_4145) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4157, %e1_4158, %e2_4159, %e3_4160 = cute.get_leaves(%iter_4156) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1498 = cute.get_scalars(%e0_4157) : !cute.int_tuple<"?"> loc(#loc474)
      %1499 = cute.get_scalars(%e1_4158) : !cute.int_tuple<"?"> loc(#loc474)
      %1500 = cute.get_scalars(%e2_4159) : !cute.int_tuple<"?"> loc(#loc474)
      %1501 = cute.get_scalars(%e3_4160) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4161 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4162 = cute.add_offset(%e3_4160, %int_tuple_4161) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1502 = cute.get_scalars(%tup_4162) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4163 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4164 = cute.make_coord(%tup_4162) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1503 = cute.elem_less(%coord_4163, %coord_4164) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4165 = cute.get_layout(%1487) : !memref_rmem_f32_3 loc(#loc294)
      %1504 = cute.get_shape(%lay_4165) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4166, %e1_4167, %e2_4168, %e3_4169 = cute.get_leaves(%1504) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1505 = cute.get_stride(%lay_4165) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4170, %e1_4171, %e2_4172, %e3_4173 = cute.get_leaves(%1505) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1506 = scf.if %1503 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1487) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,10)"> loc(#loc477)
        cute.memref.store(%1487, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,10)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1487) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1487 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1487) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1487) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1487 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4174 = cute.get_iter(%1506) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4175 = cute.get_layout(%1506) : !memref_rmem_f32_3 loc(#loc294)
      %1507 = cute.get_shape(%lay_4175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4176, %e1_4177, %e2_4178, %e3_4179 = cute.get_leaves(%1507) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1508 = cute.get_stride(%lay_4175) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4180, %e1_4181, %e2_4182, %e3_4183 = cute.get_leaves(%1508) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4184 = cute.get_iter(%1506) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4185 = cute.get_iter(%1506) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4186 = cute.make_coord() : () -> !cute.coord<"(0,11)"> loc(#loc474)
      %slice_4187 = cute.slice(%view_2302, %coord_4186) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)"> loc(#loc474)
      %iter_4188 = cute.get_iter(%slice_4187) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4189, %e1_4190, %e2_4191, %e3_4192 = cute.get_leaves(%iter_4188) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1509 = cute.get_scalars(%e0_4189) : !cute.int_tuple<"?"> loc(#loc290)
      %1510 = cute.get_scalars(%e1_4190) : !cute.int_tuple<"?"> loc(#loc290)
      %1511 = cute.get_scalars(%e2_4191) : !cute.int_tuple<"?"> loc(#loc290)
      %1512 = cute.get_scalars(%e3_4192) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4193 = cute.get_iter(%slice_4187) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4194, %e1_4195, %e2_4196, %e3_4197 = cute.get_leaves(%iter_4193) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1513 = cute.get_scalars(%e0_4194) : !cute.int_tuple<"?"> loc(#loc290)
      %1514 = cute.get_scalars(%e1_4195) : !cute.int_tuple<"?"> loc(#loc290)
      %1515 = cute.get_scalars(%e2_4196) : !cute.int_tuple<"?"> loc(#loc290)
      %1516 = cute.get_scalars(%e3_4197) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4198 = cute.get_iter(%slice_4187) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4199, %e1_4200, %e2_4201, %e3_4202 = cute.get_leaves(%iter_4198) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1517 = cute.get_scalars(%e0_4199) : !cute.int_tuple<"?"> loc(#loc474)
      %1518 = cute.get_scalars(%e1_4200) : !cute.int_tuple<"?"> loc(#loc474)
      %1519 = cute.get_scalars(%e2_4201) : !cute.int_tuple<"?"> loc(#loc474)
      %1520 = cute.get_scalars(%e3_4202) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4203 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4204 = cute.add_offset(%e3_4202, %int_tuple_4203) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1521 = cute.get_scalars(%tup_4204) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4205 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4206 = cute.make_coord(%tup_4204) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1522 = cute.elem_less(%coord_4205, %coord_4206) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4207 = cute.get_layout(%1506) : !memref_rmem_f32_3 loc(#loc294)
      %1523 = cute.get_shape(%lay_4207) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4208, %e1_4209, %e2_4210, %e3_4211 = cute.get_leaves(%1523) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1524 = cute.get_stride(%lay_4207) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4212, %e1_4213, %e2_4214, %e3_4215 = cute.get_leaves(%1524) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1525 = scf.if %1522 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1506) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,11)"> loc(#loc477)
        cute.memref.store(%1506, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,11)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1506) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1506 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1506) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1506) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1506 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4216 = cute.get_iter(%1525) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4217 = cute.get_layout(%1525) : !memref_rmem_f32_3 loc(#loc294)
      %1526 = cute.get_shape(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4218, %e1_4219, %e2_4220, %e3_4221 = cute.get_leaves(%1526) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1527 = cute.get_stride(%lay_4217) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4222, %e1_4223, %e2_4224, %e3_4225 = cute.get_leaves(%1527) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4226 = cute.get_iter(%1525) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4227 = cute.get_iter(%1525) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4228 = cute.make_coord() : () -> !cute.coord<"(0,12)"> loc(#loc474)
      %slice_4229 = cute.slice(%view_2302, %coord_4228) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)"> loc(#loc474)
      %iter_4230 = cute.get_iter(%slice_4229) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4231, %e1_4232, %e2_4233, %e3_4234 = cute.get_leaves(%iter_4230) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1528 = cute.get_scalars(%e0_4231) : !cute.int_tuple<"?"> loc(#loc290)
      %1529 = cute.get_scalars(%e1_4232) : !cute.int_tuple<"?"> loc(#loc290)
      %1530 = cute.get_scalars(%e2_4233) : !cute.int_tuple<"?"> loc(#loc290)
      %1531 = cute.get_scalars(%e3_4234) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4235 = cute.get_iter(%slice_4229) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4236, %e1_4237, %e2_4238, %e3_4239 = cute.get_leaves(%iter_4235) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1532 = cute.get_scalars(%e0_4236) : !cute.int_tuple<"?"> loc(#loc290)
      %1533 = cute.get_scalars(%e1_4237) : !cute.int_tuple<"?"> loc(#loc290)
      %1534 = cute.get_scalars(%e2_4238) : !cute.int_tuple<"?"> loc(#loc290)
      %1535 = cute.get_scalars(%e3_4239) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4240 = cute.get_iter(%slice_4229) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4241, %e1_4242, %e2_4243, %e3_4244 = cute.get_leaves(%iter_4240) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1536 = cute.get_scalars(%e0_4241) : !cute.int_tuple<"?"> loc(#loc474)
      %1537 = cute.get_scalars(%e1_4242) : !cute.int_tuple<"?"> loc(#loc474)
      %1538 = cute.get_scalars(%e2_4243) : !cute.int_tuple<"?"> loc(#loc474)
      %1539 = cute.get_scalars(%e3_4244) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4245 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4246 = cute.add_offset(%e3_4244, %int_tuple_4245) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1540 = cute.get_scalars(%tup_4246) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4247 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4248 = cute.make_coord(%tup_4246) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1541 = cute.elem_less(%coord_4247, %coord_4248) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4249 = cute.get_layout(%1525) : !memref_rmem_f32_3 loc(#loc294)
      %1542 = cute.get_shape(%lay_4249) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4250, %e1_4251, %e2_4252, %e3_4253 = cute.get_leaves(%1542) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1543 = cute.get_stride(%lay_4249) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4254, %e1_4255, %e2_4256, %e3_4257 = cute.get_leaves(%1543) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1544 = scf.if %1541 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1525) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,12)"> loc(#loc477)
        cute.memref.store(%1525, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,12)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1525) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1525 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1525) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1525) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1525 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4258 = cute.get_iter(%1544) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4259 = cute.get_layout(%1544) : !memref_rmem_f32_3 loc(#loc294)
      %1545 = cute.get_shape(%lay_4259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4260, %e1_4261, %e2_4262, %e3_4263 = cute.get_leaves(%1545) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1546 = cute.get_stride(%lay_4259) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4264, %e1_4265, %e2_4266, %e3_4267 = cute.get_leaves(%1546) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4268 = cute.get_iter(%1544) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4269 = cute.get_iter(%1544) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4270 = cute.make_coord() : () -> !cute.coord<"(0,13)"> loc(#loc474)
      %slice_4271 = cute.slice(%view_2302, %coord_4270) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)"> loc(#loc474)
      %iter_4272 = cute.get_iter(%slice_4271) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4273, %e1_4274, %e2_4275, %e3_4276 = cute.get_leaves(%iter_4272) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1547 = cute.get_scalars(%e0_4273) : !cute.int_tuple<"?"> loc(#loc290)
      %1548 = cute.get_scalars(%e1_4274) : !cute.int_tuple<"?"> loc(#loc290)
      %1549 = cute.get_scalars(%e2_4275) : !cute.int_tuple<"?"> loc(#loc290)
      %1550 = cute.get_scalars(%e3_4276) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4277 = cute.get_iter(%slice_4271) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4278, %e1_4279, %e2_4280, %e3_4281 = cute.get_leaves(%iter_4277) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1551 = cute.get_scalars(%e0_4278) : !cute.int_tuple<"?"> loc(#loc290)
      %1552 = cute.get_scalars(%e1_4279) : !cute.int_tuple<"?"> loc(#loc290)
      %1553 = cute.get_scalars(%e2_4280) : !cute.int_tuple<"?"> loc(#loc290)
      %1554 = cute.get_scalars(%e3_4281) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4282 = cute.get_iter(%slice_4271) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4283, %e1_4284, %e2_4285, %e3_4286 = cute.get_leaves(%iter_4282) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1555 = cute.get_scalars(%e0_4283) : !cute.int_tuple<"?"> loc(#loc474)
      %1556 = cute.get_scalars(%e1_4284) : !cute.int_tuple<"?"> loc(#loc474)
      %1557 = cute.get_scalars(%e2_4285) : !cute.int_tuple<"?"> loc(#loc474)
      %1558 = cute.get_scalars(%e3_4286) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4287 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4288 = cute.add_offset(%e3_4286, %int_tuple_4287) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1559 = cute.get_scalars(%tup_4288) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4289 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4290 = cute.make_coord(%tup_4288) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1560 = cute.elem_less(%coord_4289, %coord_4290) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4291 = cute.get_layout(%1544) : !memref_rmem_f32_3 loc(#loc294)
      %1561 = cute.get_shape(%lay_4291) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4292, %e1_4293, %e2_4294, %e3_4295 = cute.get_leaves(%1561) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1562 = cute.get_stride(%lay_4291) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4296, %e1_4297, %e2_4298, %e3_4299 = cute.get_leaves(%1562) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1563 = scf.if %1560 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1544) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,13)"> loc(#loc477)
        cute.memref.store(%1544, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,13)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1544) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1544 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1544) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1544) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1544 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4300 = cute.get_iter(%1563) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4301 = cute.get_layout(%1563) : !memref_rmem_f32_3 loc(#loc294)
      %1564 = cute.get_shape(%lay_4301) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4302, %e1_4303, %e2_4304, %e3_4305 = cute.get_leaves(%1564) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1565 = cute.get_stride(%lay_4301) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4306, %e1_4307, %e2_4308, %e3_4309 = cute.get_leaves(%1565) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4310 = cute.get_iter(%1563) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4311 = cute.get_iter(%1563) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4312 = cute.make_coord() : () -> !cute.coord<"(0,14)"> loc(#loc474)
      %slice_4313 = cute.slice(%view_2302, %coord_4312) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)"> loc(#loc474)
      %iter_4314 = cute.get_iter(%slice_4313) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4315, %e1_4316, %e2_4317, %e3_4318 = cute.get_leaves(%iter_4314) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1566 = cute.get_scalars(%e0_4315) : !cute.int_tuple<"?"> loc(#loc290)
      %1567 = cute.get_scalars(%e1_4316) : !cute.int_tuple<"?"> loc(#loc290)
      %1568 = cute.get_scalars(%e2_4317) : !cute.int_tuple<"?"> loc(#loc290)
      %1569 = cute.get_scalars(%e3_4318) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4319 = cute.get_iter(%slice_4313) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4320, %e1_4321, %e2_4322, %e3_4323 = cute.get_leaves(%iter_4319) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1570 = cute.get_scalars(%e0_4320) : !cute.int_tuple<"?"> loc(#loc290)
      %1571 = cute.get_scalars(%e1_4321) : !cute.int_tuple<"?"> loc(#loc290)
      %1572 = cute.get_scalars(%e2_4322) : !cute.int_tuple<"?"> loc(#loc290)
      %1573 = cute.get_scalars(%e3_4323) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4324 = cute.get_iter(%slice_4313) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4325, %e1_4326, %e2_4327, %e3_4328 = cute.get_leaves(%iter_4324) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1574 = cute.get_scalars(%e0_4325) : !cute.int_tuple<"?"> loc(#loc474)
      %1575 = cute.get_scalars(%e1_4326) : !cute.int_tuple<"?"> loc(#loc474)
      %1576 = cute.get_scalars(%e2_4327) : !cute.int_tuple<"?"> loc(#loc474)
      %1577 = cute.get_scalars(%e3_4328) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4329 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4330 = cute.add_offset(%e3_4328, %int_tuple_4329) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1578 = cute.get_scalars(%tup_4330) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4331 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4332 = cute.make_coord(%tup_4330) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1579 = cute.elem_less(%coord_4331, %coord_4332) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4333 = cute.get_layout(%1563) : !memref_rmem_f32_3 loc(#loc294)
      %1580 = cute.get_shape(%lay_4333) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4334, %e1_4335, %e2_4336, %e3_4337 = cute.get_leaves(%1580) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1581 = cute.get_stride(%lay_4333) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4338, %e1_4339, %e2_4340, %e3_4341 = cute.get_leaves(%1581) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1582 = scf.if %1579 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1563) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,14)"> loc(#loc477)
        cute.memref.store(%1563, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,14)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1563) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1563 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1563) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1563) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1563 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4342 = cute.get_iter(%1582) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4343 = cute.get_layout(%1582) : !memref_rmem_f32_3 loc(#loc294)
      %1583 = cute.get_shape(%lay_4343) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4344, %e1_4345, %e2_4346, %e3_4347 = cute.get_leaves(%1583) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1584 = cute.get_stride(%lay_4343) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4348, %e1_4349, %e2_4350, %e3_4351 = cute.get_leaves(%1584) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4352 = cute.get_iter(%1582) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4353 = cute.get_iter(%1582) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4354 = cute.make_coord() : () -> !cute.coord<"(0,15)"> loc(#loc474)
      %slice_4355 = cute.slice(%view_2302, %coord_4354) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)"> loc(#loc474)
      %iter_4356 = cute.get_iter(%slice_4355) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4357, %e1_4358, %e2_4359, %e3_4360 = cute.get_leaves(%iter_4356) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1585 = cute.get_scalars(%e0_4357) : !cute.int_tuple<"?"> loc(#loc290)
      %1586 = cute.get_scalars(%e1_4358) : !cute.int_tuple<"?"> loc(#loc290)
      %1587 = cute.get_scalars(%e2_4359) : !cute.int_tuple<"?"> loc(#loc290)
      %1588 = cute.get_scalars(%e3_4360) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4361 = cute.get_iter(%slice_4355) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4362, %e1_4363, %e2_4364, %e3_4365 = cute.get_leaves(%iter_4361) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1589 = cute.get_scalars(%e0_4362) : !cute.int_tuple<"?"> loc(#loc290)
      %1590 = cute.get_scalars(%e1_4363) : !cute.int_tuple<"?"> loc(#loc290)
      %1591 = cute.get_scalars(%e2_4364) : !cute.int_tuple<"?"> loc(#loc290)
      %1592 = cute.get_scalars(%e3_4365) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4366 = cute.get_iter(%slice_4355) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4367, %e1_4368, %e2_4369, %e3_4370 = cute.get_leaves(%iter_4366) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1593 = cute.get_scalars(%e0_4367) : !cute.int_tuple<"?"> loc(#loc474)
      %1594 = cute.get_scalars(%e1_4368) : !cute.int_tuple<"?"> loc(#loc474)
      %1595 = cute.get_scalars(%e2_4369) : !cute.int_tuple<"?"> loc(#loc474)
      %1596 = cute.get_scalars(%e3_4370) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4371 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4372 = cute.add_offset(%e3_4370, %int_tuple_4371) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1597 = cute.get_scalars(%tup_4372) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4373 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4374 = cute.make_coord(%tup_4372) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1598 = cute.elem_less(%coord_4373, %coord_4374) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4375 = cute.get_layout(%1582) : !memref_rmem_f32_3 loc(#loc294)
      %1599 = cute.get_shape(%lay_4375) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4376, %e1_4377, %e2_4378, %e3_4379 = cute.get_leaves(%1599) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1600 = cute.get_stride(%lay_4375) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4380, %e1_4381, %e2_4382, %e3_4383 = cute.get_leaves(%1600) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1601 = scf.if %1598 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1582) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(2,15)"> loc(#loc477)
        cute.memref.store(%1582, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(2,15)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1582) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1582 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1582) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1582) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1582 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4384 = cute.get_iter(%1601) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4385 = cute.get_layout(%1601) : !memref_rmem_f32_3 loc(#loc294)
      %1602 = cute.get_shape(%lay_4385) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4386, %e1_4387, %e2_4388, %e3_4389 = cute.get_leaves(%1602) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1603 = cute.get_stride(%lay_4385) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4390, %e1_4391, %e2_4392, %e3_4393 = cute.get_leaves(%1603) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4394 = cute.get_iter(%1601) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4395 = cute.get_iter(%1601) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4396 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc480)
      %slice_4397 = cute.slice(%1601, %coord_4396) : !memref_rmem_f32_3, !cute.coord<"(2,_)"> loc(#loc480)
      %iter_4398 = cute.get_iter(%slice_4397) : !memref_rmem_f32_7 loc(#loc316)
      %iter_4399 = cute.get_iter(%slice_4397) : !memref_rmem_f32_7 loc(#loc317)
      %lay_4400 = cute.get_layout(%slice_4397) : !memref_rmem_f32_7 loc(#loc311)
      %1604 = cute.get_shape(%lay_4400) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_4401, %e1_4402 = cute.get_leaves(%1604) : !cute.shape<"((2,8))"> loc(#loc311)
      %1605 = cute.memref.load_vec %slice_4397 : !memref_rmem_f32_7 loc(#loc480)
      %cst_4403 = arith.constant 0xFF800000 : f32 loc(#loc481)
      %1606 = vector.reduction <maximumf>, %1605, %cst_4403 : vector<16xf32> into f32 loc(#loc481)
      %c-1_i32_4404 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_4405 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_4406 = arith.constant 31 : i32 loc(#loc482)
      %1607 = nvvm.shfl.sync  bfly %c-1_i32_4404, %1606, %c2_i32_4405, %c31_i32_4406 : f32 -> f32 loc(#loc482)
      %1608 = nvvm.fmax %1606, %1607 loc(#loc483)
      %c-1_i32_4407 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_4408 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_4409 = arith.constant 31 : i32 loc(#loc484)
      %1609 = nvvm.shfl.sync  bfly %c-1_i32_4407, %1608, %c1_i32_4408, %c31_i32_4409 : f32 -> f32 loc(#loc484)
      %1610 = nvvm.fmax %1608, %1609 loc(#loc483)
      %1611 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
      %1612 = arith.mulf %1605, %1611 : vector<16xf32> loc(#loc485)
      %1613 = arith.mulf %1610, %arg4 : f32 loc(#loc313)
      %1614 = vector.broadcast %1613 : f32 to vector<16xf32> loc(#loc290)
      %1615 = arith.subf %1612, %1614 : vector<16xf32> loc(#loc485)
      %1616 = math.exp2 %1615 fastmath<fast> : vector<16xf32> loc(#loc290)
      %cst_4410 = arith.constant 0.000000e+00 : f32 loc(#loc486)
      %1617 = vector.reduction <add>, %1616, %cst_4410 : vector<16xf32> into f32 loc(#loc486)
      %coord_4411 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc487)
      cute.memref.store(%rmem_919, %coord_4411, %1610) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> () loc(#loc487)
      %coord_4412 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc488)
      cute.memref.store(%rmem_924, %coord_4412, %1617) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> () loc(#loc488)
      %coord_4413 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc489)
      %slice_4414 = cute.slice(%1601, %coord_4413) : !memref_rmem_f32_3, !cute.coord<"(2,_)"> loc(#loc489)
      %iter_4415 = cute.get_iter(%slice_4414) : !memref_rmem_f32_7 loc(#loc316)
      %iter_4416 = cute.get_iter(%slice_4414) : !memref_rmem_f32_7 loc(#loc317)
      %lay_4417 = cute.get_layout(%slice_4414) : !memref_rmem_f32_7 loc(#loc311)
      %1618 = cute.get_shape(%lay_4417) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_4418, %e1_4419 = cute.get_leaves(%1618) : !cute.shape<"((2,8))"> loc(#loc311)
      %int_tuple_4420 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_4421 = cute.size(%int_tuple_4420) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_4422 = cute.get_leaves(%sz_4421) : !cute.int_tuple<"16"> loc(#loc489)
      %int_tuple_4423 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_4424 = cute.size(%int_tuple_4423) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_4425 = cute.get_leaves(%sz_4424) : !cute.int_tuple<"16"> loc(#loc489)
      cute.memref.store_vec %1616, %slice_4414 : !memref_rmem_f32_7 loc(#loc489)
      %int_tuple_4426 = cute.make_int_tuple() : () -> !cute.int_tuple<"(2,8)"> loc(#loc473)
      %sz_4427 = cute.size(%int_tuple_4426) : (!cute.int_tuple<"(2,8)">) -> !cute.int_tuple<"16"> loc(#loc473)
      %e0_4428 = cute.get_leaves(%sz_4427) : !cute.int_tuple<"16"> loc(#loc473)
      %coord_4429 = cute.make_coord() : () -> !cute.coord<"(0,0)"> loc(#loc474)
      %slice_4430 = cute.slice(%view_2302, %coord_4429) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,0)"> loc(#loc474)
      %iter_4431 = cute.get_iter(%slice_4430) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4432, %e1_4433, %e2_4434, %e3_4435 = cute.get_leaves(%iter_4431) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1619 = cute.get_scalars(%e0_4432) : !cute.int_tuple<"?"> loc(#loc290)
      %1620 = cute.get_scalars(%e1_4433) : !cute.int_tuple<"?"> loc(#loc290)
      %1621 = cute.get_scalars(%e2_4434) : !cute.int_tuple<"?"> loc(#loc290)
      %1622 = cute.get_scalars(%e3_4435) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4436 = cute.get_iter(%slice_4430) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4437, %e1_4438, %e2_4439, %e3_4440 = cute.get_leaves(%iter_4436) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1623 = cute.get_scalars(%e0_4437) : !cute.int_tuple<"?"> loc(#loc290)
      %1624 = cute.get_scalars(%e1_4438) : !cute.int_tuple<"?"> loc(#loc290)
      %1625 = cute.get_scalars(%e2_4439) : !cute.int_tuple<"?"> loc(#loc290)
      %1626 = cute.get_scalars(%e3_4440) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4441 = cute.get_iter(%slice_4430) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4442, %e1_4443, %e2_4444, %e3_4445 = cute.get_leaves(%iter_4441) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1627 = cute.get_scalars(%e0_4442) : !cute.int_tuple<"?"> loc(#loc474)
      %1628 = cute.get_scalars(%e1_4443) : !cute.int_tuple<"?"> loc(#loc474)
      %1629 = cute.get_scalars(%e2_4444) : !cute.int_tuple<"?"> loc(#loc474)
      %1630 = cute.get_scalars(%e3_4445) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4446 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4447 = cute.add_offset(%e3_4445, %int_tuple_4446) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1631 = cute.get_scalars(%tup_4447) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4448 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4449 = cute.make_coord(%tup_4447) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1632 = cute.elem_less(%coord_4448, %coord_4449) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4450 = cute.get_layout(%1601) : !memref_rmem_f32_3 loc(#loc294)
      %1633 = cute.get_shape(%lay_4450) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4451, %e1_4452, %e2_4453, %e3_4454 = cute.get_leaves(%1633) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1634 = cute.get_stride(%lay_4450) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4455, %e1_4456, %e2_4457, %e3_4458 = cute.get_leaves(%1634) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1635 = scf.if %1632 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1601) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,0)"> loc(#loc477)
        cute.memref.store(%1601, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,0)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1601) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1601 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1601) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1601) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1601 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4459 = cute.get_iter(%1635) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4460 = cute.get_layout(%1635) : !memref_rmem_f32_3 loc(#loc294)
      %1636 = cute.get_shape(%lay_4460) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4461, %e1_4462, %e2_4463, %e3_4464 = cute.get_leaves(%1636) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1637 = cute.get_stride(%lay_4460) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4465, %e1_4466, %e2_4467, %e3_4468 = cute.get_leaves(%1637) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4469 = cute.get_iter(%1635) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4470 = cute.get_iter(%1635) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4471 = cute.make_coord() : () -> !cute.coord<"(0,1)"> loc(#loc474)
      %slice_4472 = cute.slice(%view_2302, %coord_4471) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,1)"> loc(#loc474)
      %iter_4473 = cute.get_iter(%slice_4472) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4474, %e1_4475, %e2_4476, %e3_4477 = cute.get_leaves(%iter_4473) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1638 = cute.get_scalars(%e0_4474) : !cute.int_tuple<"?"> loc(#loc290)
      %1639 = cute.get_scalars(%e1_4475) : !cute.int_tuple<"?"> loc(#loc290)
      %1640 = cute.get_scalars(%e2_4476) : !cute.int_tuple<"?"> loc(#loc290)
      %1641 = cute.get_scalars(%e3_4477) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4478 = cute.get_iter(%slice_4472) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4479, %e1_4480, %e2_4481, %e3_4482 = cute.get_leaves(%iter_4478) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1642 = cute.get_scalars(%e0_4479) : !cute.int_tuple<"?"> loc(#loc290)
      %1643 = cute.get_scalars(%e1_4480) : !cute.int_tuple<"?"> loc(#loc290)
      %1644 = cute.get_scalars(%e2_4481) : !cute.int_tuple<"?"> loc(#loc290)
      %1645 = cute.get_scalars(%e3_4482) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4483 = cute.get_iter(%slice_4472) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4484, %e1_4485, %e2_4486, %e3_4487 = cute.get_leaves(%iter_4483) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1646 = cute.get_scalars(%e0_4484) : !cute.int_tuple<"?"> loc(#loc474)
      %1647 = cute.get_scalars(%e1_4485) : !cute.int_tuple<"?"> loc(#loc474)
      %1648 = cute.get_scalars(%e2_4486) : !cute.int_tuple<"?"> loc(#loc474)
      %1649 = cute.get_scalars(%e3_4487) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4488 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4489 = cute.add_offset(%e3_4487, %int_tuple_4488) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1650 = cute.get_scalars(%tup_4489) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4490 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4491 = cute.make_coord(%tup_4489) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1651 = cute.elem_less(%coord_4490, %coord_4491) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4492 = cute.get_layout(%1635) : !memref_rmem_f32_3 loc(#loc294)
      %1652 = cute.get_shape(%lay_4492) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4493, %e1_4494, %e2_4495, %e3_4496 = cute.get_leaves(%1652) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1653 = cute.get_stride(%lay_4492) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4497, %e1_4498, %e2_4499, %e3_4500 = cute.get_leaves(%1653) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1654 = scf.if %1651 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1635) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,1)"> loc(#loc477)
        cute.memref.store(%1635, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,1)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1635) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1635 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1635) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1635) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1635 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4501 = cute.get_iter(%1654) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4502 = cute.get_layout(%1654) : !memref_rmem_f32_3 loc(#loc294)
      %1655 = cute.get_shape(%lay_4502) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4503, %e1_4504, %e2_4505, %e3_4506 = cute.get_leaves(%1655) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1656 = cute.get_stride(%lay_4502) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4507, %e1_4508, %e2_4509, %e3_4510 = cute.get_leaves(%1656) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4511 = cute.get_iter(%1654) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4512 = cute.get_iter(%1654) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4513 = cute.make_coord() : () -> !cute.coord<"(0,2)"> loc(#loc474)
      %slice_4514 = cute.slice(%view_2302, %coord_4513) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,2)"> loc(#loc474)
      %iter_4515 = cute.get_iter(%slice_4514) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4516, %e1_4517, %e2_4518, %e3_4519 = cute.get_leaves(%iter_4515) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1657 = cute.get_scalars(%e0_4516) : !cute.int_tuple<"?"> loc(#loc290)
      %1658 = cute.get_scalars(%e1_4517) : !cute.int_tuple<"?"> loc(#loc290)
      %1659 = cute.get_scalars(%e2_4518) : !cute.int_tuple<"?"> loc(#loc290)
      %1660 = cute.get_scalars(%e3_4519) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4520 = cute.get_iter(%slice_4514) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4521, %e1_4522, %e2_4523, %e3_4524 = cute.get_leaves(%iter_4520) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1661 = cute.get_scalars(%e0_4521) : !cute.int_tuple<"?"> loc(#loc290)
      %1662 = cute.get_scalars(%e1_4522) : !cute.int_tuple<"?"> loc(#loc290)
      %1663 = cute.get_scalars(%e2_4523) : !cute.int_tuple<"?"> loc(#loc290)
      %1664 = cute.get_scalars(%e3_4524) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4525 = cute.get_iter(%slice_4514) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4526, %e1_4527, %e2_4528, %e3_4529 = cute.get_leaves(%iter_4525) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1665 = cute.get_scalars(%e0_4526) : !cute.int_tuple<"?"> loc(#loc474)
      %1666 = cute.get_scalars(%e1_4527) : !cute.int_tuple<"?"> loc(#loc474)
      %1667 = cute.get_scalars(%e2_4528) : !cute.int_tuple<"?"> loc(#loc474)
      %1668 = cute.get_scalars(%e3_4529) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4530 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4531 = cute.add_offset(%e3_4529, %int_tuple_4530) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1669 = cute.get_scalars(%tup_4531) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4532 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4533 = cute.make_coord(%tup_4531) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1670 = cute.elem_less(%coord_4532, %coord_4533) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4534 = cute.get_layout(%1654) : !memref_rmem_f32_3 loc(#loc294)
      %1671 = cute.get_shape(%lay_4534) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4535, %e1_4536, %e2_4537, %e3_4538 = cute.get_leaves(%1671) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1672 = cute.get_stride(%lay_4534) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4539, %e1_4540, %e2_4541, %e3_4542 = cute.get_leaves(%1672) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1673 = scf.if %1670 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1654) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,2)"> loc(#loc477)
        cute.memref.store(%1654, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,2)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1654) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1654 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1654) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1654) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1654 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4543 = cute.get_iter(%1673) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4544 = cute.get_layout(%1673) : !memref_rmem_f32_3 loc(#loc294)
      %1674 = cute.get_shape(%lay_4544) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4545, %e1_4546, %e2_4547, %e3_4548 = cute.get_leaves(%1674) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1675 = cute.get_stride(%lay_4544) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4549, %e1_4550, %e2_4551, %e3_4552 = cute.get_leaves(%1675) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4553 = cute.get_iter(%1673) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4554 = cute.get_iter(%1673) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4555 = cute.make_coord() : () -> !cute.coord<"(0,3)"> loc(#loc474)
      %slice_4556 = cute.slice(%view_2302, %coord_4555) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,3)"> loc(#loc474)
      %iter_4557 = cute.get_iter(%slice_4556) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4558, %e1_4559, %e2_4560, %e3_4561 = cute.get_leaves(%iter_4557) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1676 = cute.get_scalars(%e0_4558) : !cute.int_tuple<"?"> loc(#loc290)
      %1677 = cute.get_scalars(%e1_4559) : !cute.int_tuple<"?"> loc(#loc290)
      %1678 = cute.get_scalars(%e2_4560) : !cute.int_tuple<"?"> loc(#loc290)
      %1679 = cute.get_scalars(%e3_4561) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4562 = cute.get_iter(%slice_4556) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4563, %e1_4564, %e2_4565, %e3_4566 = cute.get_leaves(%iter_4562) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1680 = cute.get_scalars(%e0_4563) : !cute.int_tuple<"?"> loc(#loc290)
      %1681 = cute.get_scalars(%e1_4564) : !cute.int_tuple<"?"> loc(#loc290)
      %1682 = cute.get_scalars(%e2_4565) : !cute.int_tuple<"?"> loc(#loc290)
      %1683 = cute.get_scalars(%e3_4566) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4567 = cute.get_iter(%slice_4556) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4568, %e1_4569, %e2_4570, %e3_4571 = cute.get_leaves(%iter_4567) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1684 = cute.get_scalars(%e0_4568) : !cute.int_tuple<"?"> loc(#loc474)
      %1685 = cute.get_scalars(%e1_4569) : !cute.int_tuple<"?"> loc(#loc474)
      %1686 = cute.get_scalars(%e2_4570) : !cute.int_tuple<"?"> loc(#loc474)
      %1687 = cute.get_scalars(%e3_4571) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4572 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4573 = cute.add_offset(%e3_4571, %int_tuple_4572) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1688 = cute.get_scalars(%tup_4573) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4574 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4575 = cute.make_coord(%tup_4573) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1689 = cute.elem_less(%coord_4574, %coord_4575) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4576 = cute.get_layout(%1673) : !memref_rmem_f32_3 loc(#loc294)
      %1690 = cute.get_shape(%lay_4576) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4577, %e1_4578, %e2_4579, %e3_4580 = cute.get_leaves(%1690) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1691 = cute.get_stride(%lay_4576) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4581, %e1_4582, %e2_4583, %e3_4584 = cute.get_leaves(%1691) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1692 = scf.if %1689 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1673) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,3)"> loc(#loc477)
        cute.memref.store(%1673, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,3)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1673) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1673 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1673) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1673) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1673 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4585 = cute.get_iter(%1692) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4586 = cute.get_layout(%1692) : !memref_rmem_f32_3 loc(#loc294)
      %1693 = cute.get_shape(%lay_4586) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4587, %e1_4588, %e2_4589, %e3_4590 = cute.get_leaves(%1693) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1694 = cute.get_stride(%lay_4586) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4591, %e1_4592, %e2_4593, %e3_4594 = cute.get_leaves(%1694) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4595 = cute.get_iter(%1692) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4596 = cute.get_iter(%1692) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4597 = cute.make_coord() : () -> !cute.coord<"(0,4)"> loc(#loc474)
      %slice_4598 = cute.slice(%view_2302, %coord_4597) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,4)"> loc(#loc474)
      %iter_4599 = cute.get_iter(%slice_4598) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4600, %e1_4601, %e2_4602, %e3_4603 = cute.get_leaves(%iter_4599) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1695 = cute.get_scalars(%e0_4600) : !cute.int_tuple<"?"> loc(#loc290)
      %1696 = cute.get_scalars(%e1_4601) : !cute.int_tuple<"?"> loc(#loc290)
      %1697 = cute.get_scalars(%e2_4602) : !cute.int_tuple<"?"> loc(#loc290)
      %1698 = cute.get_scalars(%e3_4603) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4604 = cute.get_iter(%slice_4598) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4605, %e1_4606, %e2_4607, %e3_4608 = cute.get_leaves(%iter_4604) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1699 = cute.get_scalars(%e0_4605) : !cute.int_tuple<"?"> loc(#loc290)
      %1700 = cute.get_scalars(%e1_4606) : !cute.int_tuple<"?"> loc(#loc290)
      %1701 = cute.get_scalars(%e2_4607) : !cute.int_tuple<"?"> loc(#loc290)
      %1702 = cute.get_scalars(%e3_4608) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4609 = cute.get_iter(%slice_4598) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4610, %e1_4611, %e2_4612, %e3_4613 = cute.get_leaves(%iter_4609) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1703 = cute.get_scalars(%e0_4610) : !cute.int_tuple<"?"> loc(#loc474)
      %1704 = cute.get_scalars(%e1_4611) : !cute.int_tuple<"?"> loc(#loc474)
      %1705 = cute.get_scalars(%e2_4612) : !cute.int_tuple<"?"> loc(#loc474)
      %1706 = cute.get_scalars(%e3_4613) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4614 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4615 = cute.add_offset(%e3_4613, %int_tuple_4614) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1707 = cute.get_scalars(%tup_4615) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4616 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4617 = cute.make_coord(%tup_4615) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1708 = cute.elem_less(%coord_4616, %coord_4617) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4618 = cute.get_layout(%1692) : !memref_rmem_f32_3 loc(#loc294)
      %1709 = cute.get_shape(%lay_4618) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4619, %e1_4620, %e2_4621, %e3_4622 = cute.get_leaves(%1709) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1710 = cute.get_stride(%lay_4618) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4623, %e1_4624, %e2_4625, %e3_4626 = cute.get_leaves(%1710) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1711 = scf.if %1708 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1692) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,4)"> loc(#loc477)
        cute.memref.store(%1692, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,4)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1692) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1692 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1692) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1692) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1692 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4627 = cute.get_iter(%1711) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4628 = cute.get_layout(%1711) : !memref_rmem_f32_3 loc(#loc294)
      %1712 = cute.get_shape(%lay_4628) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4629, %e1_4630, %e2_4631, %e3_4632 = cute.get_leaves(%1712) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1713 = cute.get_stride(%lay_4628) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4633, %e1_4634, %e2_4635, %e3_4636 = cute.get_leaves(%1713) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4637 = cute.get_iter(%1711) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4638 = cute.get_iter(%1711) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4639 = cute.make_coord() : () -> !cute.coord<"(0,5)"> loc(#loc474)
      %slice_4640 = cute.slice(%view_2302, %coord_4639) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,5)"> loc(#loc474)
      %iter_4641 = cute.get_iter(%slice_4640) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4642, %e1_4643, %e2_4644, %e3_4645 = cute.get_leaves(%iter_4641) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1714 = cute.get_scalars(%e0_4642) : !cute.int_tuple<"?"> loc(#loc290)
      %1715 = cute.get_scalars(%e1_4643) : !cute.int_tuple<"?"> loc(#loc290)
      %1716 = cute.get_scalars(%e2_4644) : !cute.int_tuple<"?"> loc(#loc290)
      %1717 = cute.get_scalars(%e3_4645) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4646 = cute.get_iter(%slice_4640) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4647, %e1_4648, %e2_4649, %e3_4650 = cute.get_leaves(%iter_4646) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1718 = cute.get_scalars(%e0_4647) : !cute.int_tuple<"?"> loc(#loc290)
      %1719 = cute.get_scalars(%e1_4648) : !cute.int_tuple<"?"> loc(#loc290)
      %1720 = cute.get_scalars(%e2_4649) : !cute.int_tuple<"?"> loc(#loc290)
      %1721 = cute.get_scalars(%e3_4650) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4651 = cute.get_iter(%slice_4640) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4652, %e1_4653, %e2_4654, %e3_4655 = cute.get_leaves(%iter_4651) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1722 = cute.get_scalars(%e0_4652) : !cute.int_tuple<"?"> loc(#loc474)
      %1723 = cute.get_scalars(%e1_4653) : !cute.int_tuple<"?"> loc(#loc474)
      %1724 = cute.get_scalars(%e2_4654) : !cute.int_tuple<"?"> loc(#loc474)
      %1725 = cute.get_scalars(%e3_4655) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4656 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4657 = cute.add_offset(%e3_4655, %int_tuple_4656) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1726 = cute.get_scalars(%tup_4657) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4658 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4659 = cute.make_coord(%tup_4657) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1727 = cute.elem_less(%coord_4658, %coord_4659) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4660 = cute.get_layout(%1711) : !memref_rmem_f32_3 loc(#loc294)
      %1728 = cute.get_shape(%lay_4660) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4661, %e1_4662, %e2_4663, %e3_4664 = cute.get_leaves(%1728) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1729 = cute.get_stride(%lay_4660) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4665, %e1_4666, %e2_4667, %e3_4668 = cute.get_leaves(%1729) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1730 = scf.if %1727 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1711) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,5)"> loc(#loc477)
        cute.memref.store(%1711, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,5)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1711) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1711 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1711) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1711) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1711 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4669 = cute.get_iter(%1730) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4670 = cute.get_layout(%1730) : !memref_rmem_f32_3 loc(#loc294)
      %1731 = cute.get_shape(%lay_4670) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4671, %e1_4672, %e2_4673, %e3_4674 = cute.get_leaves(%1731) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1732 = cute.get_stride(%lay_4670) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4675, %e1_4676, %e2_4677, %e3_4678 = cute.get_leaves(%1732) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4679 = cute.get_iter(%1730) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4680 = cute.get_iter(%1730) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4681 = cute.make_coord() : () -> !cute.coord<"(0,6)"> loc(#loc474)
      %slice_4682 = cute.slice(%view_2302, %coord_4681) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,6)"> loc(#loc474)
      %iter_4683 = cute.get_iter(%slice_4682) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4684, %e1_4685, %e2_4686, %e3_4687 = cute.get_leaves(%iter_4683) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1733 = cute.get_scalars(%e0_4684) : !cute.int_tuple<"?"> loc(#loc290)
      %1734 = cute.get_scalars(%e1_4685) : !cute.int_tuple<"?"> loc(#loc290)
      %1735 = cute.get_scalars(%e2_4686) : !cute.int_tuple<"?"> loc(#loc290)
      %1736 = cute.get_scalars(%e3_4687) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4688 = cute.get_iter(%slice_4682) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4689, %e1_4690, %e2_4691, %e3_4692 = cute.get_leaves(%iter_4688) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1737 = cute.get_scalars(%e0_4689) : !cute.int_tuple<"?"> loc(#loc290)
      %1738 = cute.get_scalars(%e1_4690) : !cute.int_tuple<"?"> loc(#loc290)
      %1739 = cute.get_scalars(%e2_4691) : !cute.int_tuple<"?"> loc(#loc290)
      %1740 = cute.get_scalars(%e3_4692) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4693 = cute.get_iter(%slice_4682) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4694, %e1_4695, %e2_4696, %e3_4697 = cute.get_leaves(%iter_4693) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1741 = cute.get_scalars(%e0_4694) : !cute.int_tuple<"?"> loc(#loc474)
      %1742 = cute.get_scalars(%e1_4695) : !cute.int_tuple<"?"> loc(#loc474)
      %1743 = cute.get_scalars(%e2_4696) : !cute.int_tuple<"?"> loc(#loc474)
      %1744 = cute.get_scalars(%e3_4697) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4698 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4699 = cute.add_offset(%e3_4697, %int_tuple_4698) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1745 = cute.get_scalars(%tup_4699) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4700 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4701 = cute.make_coord(%tup_4699) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1746 = cute.elem_less(%coord_4700, %coord_4701) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4702 = cute.get_layout(%1730) : !memref_rmem_f32_3 loc(#loc294)
      %1747 = cute.get_shape(%lay_4702) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4703, %e1_4704, %e2_4705, %e3_4706 = cute.get_leaves(%1747) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1748 = cute.get_stride(%lay_4702) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4707, %e1_4708, %e2_4709, %e3_4710 = cute.get_leaves(%1748) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1749 = scf.if %1746 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1730) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,6)"> loc(#loc477)
        cute.memref.store(%1730, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,6)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1730) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1730 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1730) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1730) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1730 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4711 = cute.get_iter(%1749) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4712 = cute.get_layout(%1749) : !memref_rmem_f32_3 loc(#loc294)
      %1750 = cute.get_shape(%lay_4712) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4713, %e1_4714, %e2_4715, %e3_4716 = cute.get_leaves(%1750) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1751 = cute.get_stride(%lay_4712) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4717, %e1_4718, %e2_4719, %e3_4720 = cute.get_leaves(%1751) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4721 = cute.get_iter(%1749) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4722 = cute.get_iter(%1749) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4723 = cute.make_coord() : () -> !cute.coord<"(0,7)"> loc(#loc474)
      %slice_4724 = cute.slice(%view_2302, %coord_4723) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,7)"> loc(#loc474)
      %iter_4725 = cute.get_iter(%slice_4724) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4726, %e1_4727, %e2_4728, %e3_4729 = cute.get_leaves(%iter_4725) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1752 = cute.get_scalars(%e0_4726) : !cute.int_tuple<"?"> loc(#loc290)
      %1753 = cute.get_scalars(%e1_4727) : !cute.int_tuple<"?"> loc(#loc290)
      %1754 = cute.get_scalars(%e2_4728) : !cute.int_tuple<"?"> loc(#loc290)
      %1755 = cute.get_scalars(%e3_4729) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4730 = cute.get_iter(%slice_4724) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4731, %e1_4732, %e2_4733, %e3_4734 = cute.get_leaves(%iter_4730) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1756 = cute.get_scalars(%e0_4731) : !cute.int_tuple<"?"> loc(#loc290)
      %1757 = cute.get_scalars(%e1_4732) : !cute.int_tuple<"?"> loc(#loc290)
      %1758 = cute.get_scalars(%e2_4733) : !cute.int_tuple<"?"> loc(#loc290)
      %1759 = cute.get_scalars(%e3_4734) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4735 = cute.get_iter(%slice_4724) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4736, %e1_4737, %e2_4738, %e3_4739 = cute.get_leaves(%iter_4735) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1760 = cute.get_scalars(%e0_4736) : !cute.int_tuple<"?"> loc(#loc474)
      %1761 = cute.get_scalars(%e1_4737) : !cute.int_tuple<"?"> loc(#loc474)
      %1762 = cute.get_scalars(%e2_4738) : !cute.int_tuple<"?"> loc(#loc474)
      %1763 = cute.get_scalars(%e3_4739) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4740 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4741 = cute.add_offset(%e3_4739, %int_tuple_4740) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1764 = cute.get_scalars(%tup_4741) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4742 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4743 = cute.make_coord(%tup_4741) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1765 = cute.elem_less(%coord_4742, %coord_4743) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4744 = cute.get_layout(%1749) : !memref_rmem_f32_3 loc(#loc294)
      %1766 = cute.get_shape(%lay_4744) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4745, %e1_4746, %e2_4747, %e3_4748 = cute.get_leaves(%1766) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1767 = cute.get_stride(%lay_4744) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4749, %e1_4750, %e2_4751, %e3_4752 = cute.get_leaves(%1767) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1768 = scf.if %1765 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1749) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,7)"> loc(#loc477)
        cute.memref.store(%1749, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,7)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1749) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1749 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1749) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1749) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1749 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4753 = cute.get_iter(%1768) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4754 = cute.get_layout(%1768) : !memref_rmem_f32_3 loc(#loc294)
      %1769 = cute.get_shape(%lay_4754) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4755, %e1_4756, %e2_4757, %e3_4758 = cute.get_leaves(%1769) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1770 = cute.get_stride(%lay_4754) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4759, %e1_4760, %e2_4761, %e3_4762 = cute.get_leaves(%1770) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4763 = cute.get_iter(%1768) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4764 = cute.get_iter(%1768) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4765 = cute.make_coord() : () -> !cute.coord<"(0,8)"> loc(#loc474)
      %slice_4766 = cute.slice(%view_2302, %coord_4765) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,8)"> loc(#loc474)
      %iter_4767 = cute.get_iter(%slice_4766) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4768, %e1_4769, %e2_4770, %e3_4771 = cute.get_leaves(%iter_4767) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1771 = cute.get_scalars(%e0_4768) : !cute.int_tuple<"?"> loc(#loc290)
      %1772 = cute.get_scalars(%e1_4769) : !cute.int_tuple<"?"> loc(#loc290)
      %1773 = cute.get_scalars(%e2_4770) : !cute.int_tuple<"?"> loc(#loc290)
      %1774 = cute.get_scalars(%e3_4771) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4772 = cute.get_iter(%slice_4766) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4773, %e1_4774, %e2_4775, %e3_4776 = cute.get_leaves(%iter_4772) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1775 = cute.get_scalars(%e0_4773) : !cute.int_tuple<"?"> loc(#loc290)
      %1776 = cute.get_scalars(%e1_4774) : !cute.int_tuple<"?"> loc(#loc290)
      %1777 = cute.get_scalars(%e2_4775) : !cute.int_tuple<"?"> loc(#loc290)
      %1778 = cute.get_scalars(%e3_4776) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4777 = cute.get_iter(%slice_4766) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4778, %e1_4779, %e2_4780, %e3_4781 = cute.get_leaves(%iter_4777) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1779 = cute.get_scalars(%e0_4778) : !cute.int_tuple<"?"> loc(#loc474)
      %1780 = cute.get_scalars(%e1_4779) : !cute.int_tuple<"?"> loc(#loc474)
      %1781 = cute.get_scalars(%e2_4780) : !cute.int_tuple<"?"> loc(#loc474)
      %1782 = cute.get_scalars(%e3_4781) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4782 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4783 = cute.add_offset(%e3_4781, %int_tuple_4782) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1783 = cute.get_scalars(%tup_4783) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4784 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4785 = cute.make_coord(%tup_4783) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1784 = cute.elem_less(%coord_4784, %coord_4785) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4786 = cute.get_layout(%1768) : !memref_rmem_f32_3 loc(#loc294)
      %1785 = cute.get_shape(%lay_4786) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4787, %e1_4788, %e2_4789, %e3_4790 = cute.get_leaves(%1785) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1786 = cute.get_stride(%lay_4786) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4791, %e1_4792, %e2_4793, %e3_4794 = cute.get_leaves(%1786) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1787 = scf.if %1784 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1768) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,8)"> loc(#loc477)
        cute.memref.store(%1768, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,8)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1768) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1768 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1768) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1768) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1768 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4795 = cute.get_iter(%1787) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4796 = cute.get_layout(%1787) : !memref_rmem_f32_3 loc(#loc294)
      %1788 = cute.get_shape(%lay_4796) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4797, %e1_4798, %e2_4799, %e3_4800 = cute.get_leaves(%1788) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1789 = cute.get_stride(%lay_4796) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4801, %e1_4802, %e2_4803, %e3_4804 = cute.get_leaves(%1789) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4805 = cute.get_iter(%1787) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4806 = cute.get_iter(%1787) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4807 = cute.make_coord() : () -> !cute.coord<"(0,9)"> loc(#loc474)
      %slice_4808 = cute.slice(%view_2302, %coord_4807) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,9)"> loc(#loc474)
      %iter_4809 = cute.get_iter(%slice_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4810, %e1_4811, %e2_4812, %e3_4813 = cute.get_leaves(%iter_4809) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1790 = cute.get_scalars(%e0_4810) : !cute.int_tuple<"?"> loc(#loc290)
      %1791 = cute.get_scalars(%e1_4811) : !cute.int_tuple<"?"> loc(#loc290)
      %1792 = cute.get_scalars(%e2_4812) : !cute.int_tuple<"?"> loc(#loc290)
      %1793 = cute.get_scalars(%e3_4813) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4814 = cute.get_iter(%slice_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4815, %e1_4816, %e2_4817, %e3_4818 = cute.get_leaves(%iter_4814) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1794 = cute.get_scalars(%e0_4815) : !cute.int_tuple<"?"> loc(#loc290)
      %1795 = cute.get_scalars(%e1_4816) : !cute.int_tuple<"?"> loc(#loc290)
      %1796 = cute.get_scalars(%e2_4817) : !cute.int_tuple<"?"> loc(#loc290)
      %1797 = cute.get_scalars(%e3_4818) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4819 = cute.get_iter(%slice_4808) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4820, %e1_4821, %e2_4822, %e3_4823 = cute.get_leaves(%iter_4819) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1798 = cute.get_scalars(%e0_4820) : !cute.int_tuple<"?"> loc(#loc474)
      %1799 = cute.get_scalars(%e1_4821) : !cute.int_tuple<"?"> loc(#loc474)
      %1800 = cute.get_scalars(%e2_4822) : !cute.int_tuple<"?"> loc(#loc474)
      %1801 = cute.get_scalars(%e3_4823) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4824 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4825 = cute.add_offset(%e3_4823, %int_tuple_4824) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1802 = cute.get_scalars(%tup_4825) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4826 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4827 = cute.make_coord(%tup_4825) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1803 = cute.elem_less(%coord_4826, %coord_4827) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4828 = cute.get_layout(%1787) : !memref_rmem_f32_3 loc(#loc294)
      %1804 = cute.get_shape(%lay_4828) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4829, %e1_4830, %e2_4831, %e3_4832 = cute.get_leaves(%1804) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1805 = cute.get_stride(%lay_4828) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4833, %e1_4834, %e2_4835, %e3_4836 = cute.get_leaves(%1805) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1806 = scf.if %1803 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1787) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,9)"> loc(#loc477)
        cute.memref.store(%1787, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,9)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1787) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1787 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1787) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1787) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1787 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4837 = cute.get_iter(%1806) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4838 = cute.get_layout(%1806) : !memref_rmem_f32_3 loc(#loc294)
      %1807 = cute.get_shape(%lay_4838) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4839, %e1_4840, %e2_4841, %e3_4842 = cute.get_leaves(%1807) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1808 = cute.get_stride(%lay_4838) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4843, %e1_4844, %e2_4845, %e3_4846 = cute.get_leaves(%1808) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4847 = cute.get_iter(%1806) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4848 = cute.get_iter(%1806) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4849 = cute.make_coord() : () -> !cute.coord<"(0,10)"> loc(#loc474)
      %slice_4850 = cute.slice(%view_2302, %coord_4849) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,10)"> loc(#loc474)
      %iter_4851 = cute.get_iter(%slice_4850) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4852, %e1_4853, %e2_4854, %e3_4855 = cute.get_leaves(%iter_4851) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1809 = cute.get_scalars(%e0_4852) : !cute.int_tuple<"?"> loc(#loc290)
      %1810 = cute.get_scalars(%e1_4853) : !cute.int_tuple<"?"> loc(#loc290)
      %1811 = cute.get_scalars(%e2_4854) : !cute.int_tuple<"?"> loc(#loc290)
      %1812 = cute.get_scalars(%e3_4855) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4856 = cute.get_iter(%slice_4850) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4857, %e1_4858, %e2_4859, %e3_4860 = cute.get_leaves(%iter_4856) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1813 = cute.get_scalars(%e0_4857) : !cute.int_tuple<"?"> loc(#loc290)
      %1814 = cute.get_scalars(%e1_4858) : !cute.int_tuple<"?"> loc(#loc290)
      %1815 = cute.get_scalars(%e2_4859) : !cute.int_tuple<"?"> loc(#loc290)
      %1816 = cute.get_scalars(%e3_4860) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4861 = cute.get_iter(%slice_4850) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4862, %e1_4863, %e2_4864, %e3_4865 = cute.get_leaves(%iter_4861) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1817 = cute.get_scalars(%e0_4862) : !cute.int_tuple<"?"> loc(#loc474)
      %1818 = cute.get_scalars(%e1_4863) : !cute.int_tuple<"?"> loc(#loc474)
      %1819 = cute.get_scalars(%e2_4864) : !cute.int_tuple<"?"> loc(#loc474)
      %1820 = cute.get_scalars(%e3_4865) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4866 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4867 = cute.add_offset(%e3_4865, %int_tuple_4866) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1821 = cute.get_scalars(%tup_4867) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4868 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4869 = cute.make_coord(%tup_4867) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1822 = cute.elem_less(%coord_4868, %coord_4869) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4870 = cute.get_layout(%1806) : !memref_rmem_f32_3 loc(#loc294)
      %1823 = cute.get_shape(%lay_4870) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4871, %e1_4872, %e2_4873, %e3_4874 = cute.get_leaves(%1823) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1824 = cute.get_stride(%lay_4870) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4875, %e1_4876, %e2_4877, %e3_4878 = cute.get_leaves(%1824) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1825 = scf.if %1822 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1806) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,10)"> loc(#loc477)
        cute.memref.store(%1806, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,10)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1806) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1806 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1806) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1806) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1806 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4879 = cute.get_iter(%1825) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4880 = cute.get_layout(%1825) : !memref_rmem_f32_3 loc(#loc294)
      %1826 = cute.get_shape(%lay_4880) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4881, %e1_4882, %e2_4883, %e3_4884 = cute.get_leaves(%1826) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1827 = cute.get_stride(%lay_4880) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4885, %e1_4886, %e2_4887, %e3_4888 = cute.get_leaves(%1827) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4889 = cute.get_iter(%1825) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4890 = cute.get_iter(%1825) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4891 = cute.make_coord() : () -> !cute.coord<"(0,11)"> loc(#loc474)
      %slice_4892 = cute.slice(%view_2302, %coord_4891) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,11)"> loc(#loc474)
      %iter_4893 = cute.get_iter(%slice_4892) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4894, %e1_4895, %e2_4896, %e3_4897 = cute.get_leaves(%iter_4893) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1828 = cute.get_scalars(%e0_4894) : !cute.int_tuple<"?"> loc(#loc290)
      %1829 = cute.get_scalars(%e1_4895) : !cute.int_tuple<"?"> loc(#loc290)
      %1830 = cute.get_scalars(%e2_4896) : !cute.int_tuple<"?"> loc(#loc290)
      %1831 = cute.get_scalars(%e3_4897) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4898 = cute.get_iter(%slice_4892) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4899, %e1_4900, %e2_4901, %e3_4902 = cute.get_leaves(%iter_4898) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1832 = cute.get_scalars(%e0_4899) : !cute.int_tuple<"?"> loc(#loc290)
      %1833 = cute.get_scalars(%e1_4900) : !cute.int_tuple<"?"> loc(#loc290)
      %1834 = cute.get_scalars(%e2_4901) : !cute.int_tuple<"?"> loc(#loc290)
      %1835 = cute.get_scalars(%e3_4902) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4903 = cute.get_iter(%slice_4892) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4904, %e1_4905, %e2_4906, %e3_4907 = cute.get_leaves(%iter_4903) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1836 = cute.get_scalars(%e0_4904) : !cute.int_tuple<"?"> loc(#loc474)
      %1837 = cute.get_scalars(%e1_4905) : !cute.int_tuple<"?"> loc(#loc474)
      %1838 = cute.get_scalars(%e2_4906) : !cute.int_tuple<"?"> loc(#loc474)
      %1839 = cute.get_scalars(%e3_4907) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4908 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4909 = cute.add_offset(%e3_4907, %int_tuple_4908) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1840 = cute.get_scalars(%tup_4909) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4910 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4911 = cute.make_coord(%tup_4909) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1841 = cute.elem_less(%coord_4910, %coord_4911) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4912 = cute.get_layout(%1825) : !memref_rmem_f32_3 loc(#loc294)
      %1842 = cute.get_shape(%lay_4912) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4913, %e1_4914, %e2_4915, %e3_4916 = cute.get_leaves(%1842) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1843 = cute.get_stride(%lay_4912) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4917, %e1_4918, %e2_4919, %e3_4920 = cute.get_leaves(%1843) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1844 = scf.if %1841 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1825) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,11)"> loc(#loc477)
        cute.memref.store(%1825, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,11)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1825) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1825 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1825) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1825) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1825 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4921 = cute.get_iter(%1844) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4922 = cute.get_layout(%1844) : !memref_rmem_f32_3 loc(#loc294)
      %1845 = cute.get_shape(%lay_4922) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4923, %e1_4924, %e2_4925, %e3_4926 = cute.get_leaves(%1845) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1846 = cute.get_stride(%lay_4922) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4927, %e1_4928, %e2_4929, %e3_4930 = cute.get_leaves(%1846) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4931 = cute.get_iter(%1844) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4932 = cute.get_iter(%1844) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4933 = cute.make_coord() : () -> !cute.coord<"(0,12)"> loc(#loc474)
      %slice_4934 = cute.slice(%view_2302, %coord_4933) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,12)"> loc(#loc474)
      %iter_4935 = cute.get_iter(%slice_4934) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_4936, %e1_4937, %e2_4938, %e3_4939 = cute.get_leaves(%iter_4935) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1847 = cute.get_scalars(%e0_4936) : !cute.int_tuple<"?"> loc(#loc290)
      %1848 = cute.get_scalars(%e1_4937) : !cute.int_tuple<"?"> loc(#loc290)
      %1849 = cute.get_scalars(%e2_4938) : !cute.int_tuple<"?"> loc(#loc290)
      %1850 = cute.get_scalars(%e3_4939) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4940 = cute.get_iter(%slice_4934) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_4941, %e1_4942, %e2_4943, %e3_4944 = cute.get_leaves(%iter_4940) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1851 = cute.get_scalars(%e0_4941) : !cute.int_tuple<"?"> loc(#loc290)
      %1852 = cute.get_scalars(%e1_4942) : !cute.int_tuple<"?"> loc(#loc290)
      %1853 = cute.get_scalars(%e2_4943) : !cute.int_tuple<"?"> loc(#loc290)
      %1854 = cute.get_scalars(%e3_4944) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_4945 = cute.get_iter(%slice_4934) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_4946, %e1_4947, %e2_4948, %e3_4949 = cute.get_leaves(%iter_4945) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1855 = cute.get_scalars(%e0_4946) : !cute.int_tuple<"?"> loc(#loc474)
      %1856 = cute.get_scalars(%e1_4947) : !cute.int_tuple<"?"> loc(#loc474)
      %1857 = cute.get_scalars(%e2_4948) : !cute.int_tuple<"?"> loc(#loc474)
      %1858 = cute.get_scalars(%e3_4949) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_4950 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4951 = cute.add_offset(%e3_4949, %int_tuple_4950) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1859 = cute.get_scalars(%tup_4951) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4952 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4953 = cute.make_coord(%tup_4951) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1860 = cute.elem_less(%coord_4952, %coord_4953) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4954 = cute.get_layout(%1844) : !memref_rmem_f32_3 loc(#loc294)
      %1861 = cute.get_shape(%lay_4954) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4955, %e1_4956, %e2_4957, %e3_4958 = cute.get_leaves(%1861) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1862 = cute.get_stride(%lay_4954) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4959, %e1_4960, %e2_4961, %e3_4962 = cute.get_leaves(%1862) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1863 = scf.if %1860 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1844) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,12)"> loc(#loc477)
        cute.memref.store(%1844, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,12)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1844) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1844 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1844) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1844) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1844 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_4963 = cute.get_iter(%1863) : !memref_rmem_f32_3 loc(#loc478)
      %lay_4964 = cute.get_layout(%1863) : !memref_rmem_f32_3 loc(#loc294)
      %1864 = cute.get_shape(%lay_4964) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4965, %e1_4966, %e2_4967, %e3_4968 = cute.get_leaves(%1864) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1865 = cute.get_stride(%lay_4964) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_4969, %e1_4970, %e2_4971, %e3_4972 = cute.get_leaves(%1865) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_4973 = cute.get_iter(%1863) : !memref_rmem_f32_3 loc(#loc479)
      %iter_4974 = cute.get_iter(%1863) : !memref_rmem_f32_3 loc(#loc293)
      %coord_4975 = cute.make_coord() : () -> !cute.coord<"(0,13)"> loc(#loc474)
      %slice_4976 = cute.slice(%view_2302, %coord_4975) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,13)"> loc(#loc474)
      %iter_4977 = cute.get_iter(%slice_4976) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_4978, %e1_4979, %e2_4980, %e3_4981 = cute.get_leaves(%iter_4977) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1866 = cute.get_scalars(%e0_4978) : !cute.int_tuple<"?"> loc(#loc290)
      %1867 = cute.get_scalars(%e1_4979) : !cute.int_tuple<"?"> loc(#loc290)
      %1868 = cute.get_scalars(%e2_4980) : !cute.int_tuple<"?"> loc(#loc290)
      %1869 = cute.get_scalars(%e3_4981) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4982 = cute.get_iter(%slice_4976) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_4983, %e1_4984, %e2_4985, %e3_4986 = cute.get_leaves(%iter_4982) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1870 = cute.get_scalars(%e0_4983) : !cute.int_tuple<"?"> loc(#loc290)
      %1871 = cute.get_scalars(%e1_4984) : !cute.int_tuple<"?"> loc(#loc290)
      %1872 = cute.get_scalars(%e2_4985) : !cute.int_tuple<"?"> loc(#loc290)
      %1873 = cute.get_scalars(%e3_4986) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_4987 = cute.get_iter(%slice_4976) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_4988, %e1_4989, %e2_4990, %e3_4991 = cute.get_leaves(%iter_4987) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1874 = cute.get_scalars(%e0_4988) : !cute.int_tuple<"?"> loc(#loc474)
      %1875 = cute.get_scalars(%e1_4989) : !cute.int_tuple<"?"> loc(#loc474)
      %1876 = cute.get_scalars(%e2_4990) : !cute.int_tuple<"?"> loc(#loc474)
      %1877 = cute.get_scalars(%e3_4991) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_4992 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_4993 = cute.add_offset(%e3_4991, %int_tuple_4992) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1878 = cute.get_scalars(%tup_4993) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_4994 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_4995 = cute.make_coord(%tup_4993) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1879 = cute.elem_less(%coord_4994, %coord_4995) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_4996 = cute.get_layout(%1863) : !memref_rmem_f32_3 loc(#loc294)
      %1880 = cute.get_shape(%lay_4996) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_4997, %e1_4998, %e2_4999, %e3_5000 = cute.get_leaves(%1880) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1881 = cute.get_stride(%lay_4996) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5001, %e1_5002, %e2_5003, %e3_5004 = cute.get_leaves(%1881) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1882 = scf.if %1879 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1863) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,13)"> loc(#loc477)
        cute.memref.store(%1863, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,13)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1863) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1863 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1863) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1863) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1863 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_5005 = cute.get_iter(%1882) : !memref_rmem_f32_3 loc(#loc478)
      %lay_5006 = cute.get_layout(%1882) : !memref_rmem_f32_3 loc(#loc294)
      %1883 = cute.get_shape(%lay_5006) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_5007, %e1_5008, %e2_5009, %e3_5010 = cute.get_leaves(%1883) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1884 = cute.get_stride(%lay_5006) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5011, %e1_5012, %e2_5013, %e3_5014 = cute.get_leaves(%1884) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_5015 = cute.get_iter(%1882) : !memref_rmem_f32_3 loc(#loc479)
      %iter_5016 = cute.get_iter(%1882) : !memref_rmem_f32_3 loc(#loc293)
      %coord_5017 = cute.make_coord() : () -> !cute.coord<"(0,14)"> loc(#loc474)
      %slice_5018 = cute.slice(%view_2302, %coord_5017) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,14)"> loc(#loc474)
      %iter_5019 = cute.get_iter(%slice_5018) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc316)
      %e0_5020, %e1_5021, %e2_5022, %e3_5023 = cute.get_leaves(%iter_5019) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1885 = cute.get_scalars(%e0_5020) : !cute.int_tuple<"?"> loc(#loc290)
      %1886 = cute.get_scalars(%e1_5021) : !cute.int_tuple<"?"> loc(#loc290)
      %1887 = cute.get_scalars(%e2_5022) : !cute.int_tuple<"?"> loc(#loc290)
      %1888 = cute.get_scalars(%e3_5023) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_5024 = cute.get_iter(%slice_5018) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc317)
      %e0_5025, %e1_5026, %e2_5027, %e3_5028 = cute.get_leaves(%iter_5024) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc298)
      %1889 = cute.get_scalars(%e0_5025) : !cute.int_tuple<"?"> loc(#loc290)
      %1890 = cute.get_scalars(%e1_5026) : !cute.int_tuple<"?"> loc(#loc290)
      %1891 = cute.get_scalars(%e2_5027) : !cute.int_tuple<"?"> loc(#loc290)
      %1892 = cute.get_scalars(%e3_5028) : !cute.int_tuple<"?{div=2}"> loc(#loc290)
      %iter_5029 = cute.get_iter(%slice_5018) : !cute.coord_tensor<"(?,?,?,?{div=2})", "():()"> loc(#loc474)
      %e0_5030, %e1_5031, %e2_5032, %e3_5033 = cute.get_leaves(%iter_5029) : !cute.int_tuple<"(?,?,?,?{div=2})"> loc(#loc474)
      %1893 = cute.get_scalars(%e0_5030) : !cute.int_tuple<"?"> loc(#loc474)
      %1894 = cute.get_scalars(%e1_5031) : !cute.int_tuple<"?"> loc(#loc474)
      %1895 = cute.get_scalars(%e2_5032) : !cute.int_tuple<"?"> loc(#loc474)
      %1896 = cute.get_scalars(%e3_5033) : !cute.int_tuple<"?{div=2}"> loc(#loc474)
      %int_tuple_5034 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_5035 = cute.add_offset(%e3_5033, %int_tuple_5034) : (!cute.int_tuple<"?{div=2}">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1897 = cute.get_scalars(%tup_5035) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_5036 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_5037 = cute.make_coord(%tup_5035) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1898 = cute.elem_less(%coord_5036, %coord_5037) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_5038 = cute.get_layout(%1882) : !memref_rmem_f32_3 loc(#loc294)
      %1899 = cute.get_shape(%lay_5038) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_5039, %e1_5040, %e2_5041, %e3_5042 = cute.get_leaves(%1899) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1900 = cute.get_stride(%lay_5038) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5043, %e1_5044, %e2_5045, %e3_5046 = cute.get_leaves(%1900) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1901 = scf.if %1898 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1882) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,14)"> loc(#loc477)
        cute.memref.store(%1882, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,14)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1882) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1882 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1882) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1882) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1882 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_5047 = cute.get_iter(%1901) : !memref_rmem_f32_3 loc(#loc478)
      %lay_5048 = cute.get_layout(%1901) : !memref_rmem_f32_3 loc(#loc294)
      %1902 = cute.get_shape(%lay_5048) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_5049, %e1_5050, %e2_5051, %e3_5052 = cute.get_leaves(%1902) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1903 = cute.get_stride(%lay_5048) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5053, %e1_5054, %e2_5055, %e3_5056 = cute.get_leaves(%1903) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_5057 = cute.get_iter(%1901) : !memref_rmem_f32_3 loc(#loc479)
      %iter_5058 = cute.get_iter(%1901) : !memref_rmem_f32_3 loc(#loc293)
      %coord_5059 = cute.make_coord() : () -> !cute.coord<"(0,15)"> loc(#loc474)
      %slice_5060 = cute.slice(%view_2302, %coord_5059) : !cute.coord_tensor<"(?,?,?,?{div=2})", "((2,2),(2,8)):((8@1,64@1),(1@3,8@3))">, !cute.coord<"(0,15)"> loc(#loc474)
      %iter_5061 = cute.get_iter(%slice_5060) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc316)
      %e0_5062, %e1_5063, %e2_5064, %e3_5065 = cute.get_leaves(%iter_5061) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1904 = cute.get_scalars(%e0_5062) : !cute.int_tuple<"?"> loc(#loc290)
      %1905 = cute.get_scalars(%e1_5063) : !cute.int_tuple<"?"> loc(#loc290)
      %1906 = cute.get_scalars(%e2_5064) : !cute.int_tuple<"?"> loc(#loc290)
      %1907 = cute.get_scalars(%e3_5065) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_5066 = cute.get_iter(%slice_5060) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc317)
      %e0_5067, %e1_5068, %e2_5069, %e3_5070 = cute.get_leaves(%iter_5066) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc298)
      %1908 = cute.get_scalars(%e0_5067) : !cute.int_tuple<"?"> loc(#loc290)
      %1909 = cute.get_scalars(%e1_5068) : !cute.int_tuple<"?"> loc(#loc290)
      %1910 = cute.get_scalars(%e2_5069) : !cute.int_tuple<"?"> loc(#loc290)
      %1911 = cute.get_scalars(%e3_5070) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_5071 = cute.get_iter(%slice_5060) : !cute.coord_tensor<"(?,?,?,?)", "():()"> loc(#loc474)
      %e0_5072, %e1_5073, %e2_5074, %e3_5075 = cute.get_leaves(%iter_5071) : !cute.int_tuple<"(?,?,?,?)"> loc(#loc474)
      %1912 = cute.get_scalars(%e0_5072) : !cute.int_tuple<"?"> loc(#loc474)
      %1913 = cute.get_scalars(%e1_5073) : !cute.int_tuple<"?"> loc(#loc474)
      %1914 = cute.get_scalars(%e2_5074) : !cute.int_tuple<"?"> loc(#loc474)
      %1915 = cute.get_scalars(%e3_5075) : !cute.int_tuple<"?"> loc(#loc474)
      %int_tuple_5076 = cute.make_int_tuple() : () -> !cute.int_tuple<"1"> loc(#loc290)
      %tup_5077 = cute.add_offset(%e3_5075, %int_tuple_5076) : (!cute.int_tuple<"?">, !cute.int_tuple<"1">) -> !cute.int_tuple<"?"> loc(#loc313)
      %1916 = cute.get_scalars(%tup_5077) : !cute.int_tuple<"?"> loc(#loc475)
      %coord_5078 = cute.make_coord(%itup_2223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %coord_5079 = cute.make_coord(%tup_5077) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc476)
      %1917 = cute.elem_less(%coord_5078, %coord_5079) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc476)
      %lay_5080 = cute.get_layout(%1901) : !memref_rmem_f32_3 loc(#loc294)
      %1918 = cute.get_shape(%lay_5080) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_5081, %e1_5082, %e2_5083, %e3_5084 = cute.get_leaves(%1918) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1919 = cute.get_stride(%lay_5080) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5085, %e1_5086, %e2_5087, %e3_5088 = cute.get_leaves(%1919) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %1920 = scf.if %1917 -> (!memref_rmem_f32_3) {
        %iter_6349 = cute.get_iter(%1901) : !memref_rmem_f32_3 loc(#loc293)
        %cst_6350 = arith.constant 0xFF800000 : f32 loc(#loc477)
        %coord_6351 = cute.make_coord() : () -> !cute.coord<"(3,15)"> loc(#loc477)
        cute.memref.store(%1901, %coord_6351, %cst_6350) : (!memref_rmem_f32_3, !cute.coord<"(3,15)">, f32) -> () loc(#loc477)
        %lay_6352 = cute.get_layout(%1901) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6353, %e1_6354, %e2_6355, %e3_6356 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6352) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6357, %e1_6358, %e2_6359, %e3_6360 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1901 : !memref_rmem_f32_3 loc(#loc290)
      } else {
        %iter_6349 = cute.get_iter(%1901) : !memref_rmem_f32_3 loc(#loc293)
        %lay_6350 = cute.get_layout(%1901) : !memref_rmem_f32_3 loc(#loc294)
        %2346 = cute.get_shape(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %e0_6351, %e1_6352, %e2_6353, %e3_6354 = cute.get_leaves(%2346) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
        %2347 = cute.get_stride(%lay_6350) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        %e0_6355, %e1_6356, %e2_6357, %e3_6358 = cute.get_leaves(%2347) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
        scf.yield %1901 : !memref_rmem_f32_3 loc(#loc290)
      } loc(#loc290)
      %iter_5089 = cute.get_iter(%1920) : !memref_rmem_f32_3 loc(#loc478)
      %lay_5090 = cute.get_layout(%1920) : !memref_rmem_f32_3 loc(#loc294)
      %1921 = cute.get_shape(%lay_5090) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %e0_5091, %e1_5092, %e2_5093, %e3_5094 = cute.get_leaves(%1921) : !cute.shape<"((2,2),(2,8))"> loc(#loc295)
      %1922 = cute.get_stride(%lay_5090) : (!cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %e0_5095, %e1_5096, %e2_5097, %e3_5098 = cute.get_leaves(%1922) : !cute.stride<"((2,4),(1,8))"> loc(#loc295)
      %iter_5099 = cute.get_iter(%1920) : !memref_rmem_f32_3 loc(#loc479)
      %iter_5100 = cute.get_iter(%1920) : !memref_rmem_f32_3 loc(#loc293)
      %coord_5101 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc480)
      %slice_5102 = cute.slice(%1920, %coord_5101) : !memref_rmem_f32_3, !cute.coord<"(3,_)"> loc(#loc480)
      %iter_5103 = cute.get_iter(%slice_5102) : !memref_rmem_f32_6 loc(#loc316)
      %iter_5104 = cute.get_iter(%slice_5102) : !memref_rmem_f32_6 loc(#loc317)
      %lay_5105 = cute.get_layout(%slice_5102) : !memref_rmem_f32_6 loc(#loc311)
      %1923 = cute.get_shape(%lay_5105) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_5106, %e1_5107 = cute.get_leaves(%1923) : !cute.shape<"((2,8))"> loc(#loc311)
      %1924 = cute.memref.load_vec %slice_5102 : !memref_rmem_f32_6 loc(#loc480)
      %cst_5108 = arith.constant 0xFF800000 : f32 loc(#loc481)
      %1925 = vector.reduction <maximumf>, %1924, %cst_5108 : vector<16xf32> into f32 loc(#loc481)
      %c-1_i32_5109 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_5110 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_5111 = arith.constant 31 : i32 loc(#loc482)
      %1926 = nvvm.shfl.sync  bfly %c-1_i32_5109, %1925, %c2_i32_5110, %c31_i32_5111 : f32 -> f32 loc(#loc482)
      %1927 = nvvm.fmax %1925, %1926 loc(#loc483)
      %c-1_i32_5112 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_5113 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_5114 = arith.constant 31 : i32 loc(#loc484)
      %1928 = nvvm.shfl.sync  bfly %c-1_i32_5112, %1927, %c1_i32_5113, %c31_i32_5114 : f32 -> f32 loc(#loc484)
      %1929 = nvvm.fmax %1927, %1928 loc(#loc483)
      %1930 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
      %1931 = arith.mulf %1924, %1930 : vector<16xf32> loc(#loc485)
      %1932 = arith.mulf %1929, %arg4 : f32 loc(#loc313)
      %1933 = vector.broadcast %1932 : f32 to vector<16xf32> loc(#loc290)
      %1934 = arith.subf %1931, %1933 : vector<16xf32> loc(#loc485)
      %1935 = math.exp2 %1934 fastmath<fast> : vector<16xf32> loc(#loc290)
      %cst_5115 = arith.constant 0.000000e+00 : f32 loc(#loc486)
      %1936 = vector.reduction <add>, %1935, %cst_5115 : vector<16xf32> into f32 loc(#loc486)
      %coord_5116 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc487)
      cute.memref.store(%rmem_919, %coord_5116, %1929) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> () loc(#loc487)
      %coord_5117 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc488)
      cute.memref.store(%rmem_924, %coord_5117, %1936) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> () loc(#loc488)
      %coord_5118 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc489)
      %slice_5119 = cute.slice(%1920, %coord_5118) : !memref_rmem_f32_3, !cute.coord<"(3,_)"> loc(#loc489)
      %iter_5120 = cute.get_iter(%slice_5119) : !memref_rmem_f32_6 loc(#loc316)
      %iter_5121 = cute.get_iter(%slice_5119) : !memref_rmem_f32_6 loc(#loc317)
      %lay_5122 = cute.get_layout(%slice_5119) : !memref_rmem_f32_6 loc(#loc311)
      %1937 = cute.get_shape(%lay_5122) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
      %e0_5123, %e1_5124 = cute.get_leaves(%1937) : !cute.shape<"((2,8))"> loc(#loc311)
      %int_tuple_5125 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_5126 = cute.size(%int_tuple_5125) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_5127 = cute.get_leaves(%sz_5126) : !cute.int_tuple<"16"> loc(#loc489)
      %int_tuple_5128 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
      %sz_5129 = cute.size(%int_tuple_5128) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
      %e0_5130 = cute.get_leaves(%sz_5129) : !cute.int_tuple<"16"> loc(#loc489)
      cute.memref.store_vec %1935, %slice_5119 : !memref_rmem_f32_6 loc(#loc489)
      %lay_5131 = cute.get_layout(%rmem_956) : !memref_rmem_f32_2 loc(#loc490)
      %1938 = cute.make_layout_like(%lay_5131) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc491)
      %rmem_5132 = cute.memref.alloca(%1938) : !memref_rmem_bf16_12 loc(#loc491)
      %iter_5133 = cute.get_iter(%rmem_5132) : !memref_rmem_bf16_12 loc(#loc350)
      %iter_5134 = cute.get_iter(%rmem_5132) : !memref_rmem_bf16_12 loc(#loc351)
      %1939 = cute.memref.load_vec %rmem_956 : !memref_rmem_f32_2 loc(#loc492)
      %1940 = arith.truncf %1939 : vector<64xf32> to vector<64xbf16> loc(#loc492)
      %lay_5135 = cute.get_layout(%rmem_5132) : !memref_rmem_bf16_12 loc(#loc311)
      %1941 = cute.get_shape(%lay_5135) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc311)
      %e0_5136, %e1_5137, %e2_5138, %e3_5139 = cute.get_leaves(%1941) : !cute.shape<"((2,2),2,8)"> loc(#loc311)
      %int_tuple_5140 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc492)
      %sz_5141 = cute.size(%int_tuple_5140) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc492)
      %e0_5142 = cute.get_leaves(%sz_5141) : !cute.int_tuple<"64"> loc(#loc492)
      %int_tuple_5143 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc492)
      %sz_5144 = cute.size(%int_tuple_5143) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc492)
      %e0_5145 = cute.get_leaves(%sz_5144) : !cute.int_tuple<"64"> loc(#loc492)
      cute.memref.store_vec %1940, %rmem_5132 : !memref_rmem_bf16_12 loc(#loc492)
      %lay_5146 = cute.get_layout(%rmem_5132) : !memref_rmem_bf16_12 loc(#loc493)
      %tile_5147 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]"> loc(#loc493)
      %div = cute.logical_divide(%lay_5146, %tile_5147) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.tile<"[_;_;2:1]"> loc(#loc493)
      %1942 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
      %e0_5148, %e1_5149, %e2_5150, %e3_5151, %e4_5152 = cute.get_leaves(%1942) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
      %1943 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
      %e0_5153, %e1_5154, %e2_5155, %e3_5156, %e4_5157 = cute.get_leaves(%1943) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
      %1944 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc495)
      %e0_5158, %e1_5159, %e2_5160, %e3_5161, %e4_5162 = cute.get_leaves(%1944) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc495)
      %1945 = cute.get_shape(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc496)
      %e0_5163, %e1_5164, %e2_5165, %e3_5166, %e4_5167 = cute.get_leaves(%1945) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc496)
      %1946 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
      %e0_5168, %e1_5169, %e2_5170, %e3_5171, %e4_5172 = cute.get_leaves(%1946) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
      %1947 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
      %e0_5173, %e1_5174, %e2_5175, %e3_5176, %e4_5177 = cute.get_leaves(%1947) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
      %1948 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc498)
      %e0_5178, %e1_5179, %e2_5180, %e3_5181, %e4_5182 = cute.get_leaves(%1948) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc498)
      %1949 = cute.get_stride(%div) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc499)
      %e0_5183, %e1_5184, %e2_5185, %e3_5186, %e4_5187 = cute.get_leaves(%1949) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc499)
      %shape_5188 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)"> loc(#loc500)
      %stride_5189 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)"> loc(#loc500)
      %lay_5190 = cute.make_layout(%shape_5188, %stride_5189) : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)"> loc(#loc500)
      %view_5191 = cute.make_view(%iter_5134, %lay_5190) : !memref_rmem_bf16_13 loc(#loc501)
      %iter_5192 = cute.get_iter(%view_5191) : !memref_rmem_bf16_13 loc(#loc331)
      %coord_5193 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc502)
      %slice_5194 = cute.slice(%src_partitioned_329, %coord_5193) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)"> loc(#loc502)
      %iter_5195 = cute.get_iter(%slice_5194) : !memref_smem_bf16_18 loc(#loc316)
      %iter_5196 = cute.get_iter(%slice_5194) : !memref_smem_bf16_18 loc(#loc317)
      %coord_5197 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc503)
      %slice_5198 = cute.slice(%retiled_331, %coord_5197) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)"> loc(#loc503)
      %iter_5199 = cute.get_iter(%slice_5198) : !memref_rmem_bf16_14 loc(#loc316)
      %iter_5200 = cute.get_iter(%slice_5198) : !memref_rmem_bf16_14 loc(#loc317)
      %lay_5201 = cute.get_layout(%slice_5194) : !memref_smem_bf16_18 loc(#loc311)
      %1950 = cute.get_shape(%lay_5201) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5202, %e1_5203, %e2_5204, %e3_5205, %e4_5206 = cute.get_leaves(%1950) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %lay_5207 = cute.get_layout(%slice_5198) : !memref_rmem_bf16_14 loc(#loc311)
      %1951 = cute.get_shape(%lay_5207) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5208, %e1_5209, %e2_5210, %e3_5211 = cute.get_leaves(%1951) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %lay_5212 = cute.get_layout(%slice_5194) : !memref_smem_bf16_18 loc(#loc397)
      %shape_5213 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5214 = cute.make_layout(%shape_5213) : !cute.layout<"1:0"> loc(#loc397)
      %append_5215 = cute.append_to_rank<2> (%lay_5212, %lay_5214) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5216 = cute.make_view(%iter_5196, %append_5215) : !memref_smem_bf16_18 loc(#loc398)
      %iter_5217 = cute.get_iter(%view_5216) : !memref_smem_bf16_18 loc(#loc331)
      %lay_5218 = cute.get_layout(%view_5216) : !memref_smem_bf16_18 loc(#loc311)
      %1952 = cute.get_shape(%lay_5218) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5219, %e1_5220, %e2_5221, %e3_5222, %e4_5223 = cute.get_leaves(%1952) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %grouped_5224 = cute.group_modes(%view_5216) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
      %iter_5225 = cute.get_iter(%grouped_5224) : !memref_smem_bf16_19 loc(#loc399)
      %iter_5226 = cute.get_iter(%grouped_5224) : !memref_smem_bf16_19 loc(#loc317)
      %lay_5227 = cute.get_layout(%slice_5198) : !memref_rmem_bf16_14 loc(#loc397)
      %shape_5228 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5229 = cute.make_layout(%shape_5228) : !cute.layout<"1:0"> loc(#loc397)
      %append_5230 = cute.append_to_rank<2> (%lay_5227, %lay_5229) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5231 = cute.make_view(%iter_5200, %append_5230) : !memref_rmem_bf16_14 loc(#loc400)
      %iter_5232 = cute.get_iter(%view_5231) : !memref_rmem_bf16_14 loc(#loc331)
      %lay_5233 = cute.get_layout(%view_5231) : !memref_rmem_bf16_14 loc(#loc311)
      %1953 = cute.get_shape(%lay_5233) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5234, %e1_5235, %e2_5236, %e3_5237 = cute.get_leaves(%1953) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %grouped_5238 = cute.group_modes(%view_5231) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
      %iter_5239 = cute.get_iter(%grouped_5238) : !memref_rmem_bf16_15 loc(#loc399)
      %iter_5240 = cute.get_iter(%grouped_5238) : !memref_rmem_bf16_15 loc(#loc317)
      %lay_5241 = cute.get_layout(%grouped_5224) : !memref_smem_bf16_19 loc(#loc311)
      %1954 = cute.get_shape(%lay_5241) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %e0_5242, %e1_5243, %e2_5244, %e3_5245, %e4_5246 = cute.get_leaves(%1954) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %lay_5247 = cute.get_layout(%grouped_5238) : !memref_rmem_bf16_15 loc(#loc311)
      %1955 = cute.get_shape(%lay_5247) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %e0_5248, %e1_5249, %e2_5250, %e3_5251 = cute.get_leaves(%1955) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %sz_5252 = cute.size(%grouped_5224) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5253 = cute.get_leaves(%sz_5252) : !cute.int_tuple<"8"> loc(#loc402)
      %sz_5254 = cute.size(%grouped_5238) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5255 = cute.get_leaves(%sz_5254) : !cute.int_tuple<"8"> loc(#loc402)
      cute.copy(%138, %grouped_5224, %grouped_5238) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc504)
      %lay_5256 = cute.get_layout(%view_5191) : !memref_rmem_bf16_13 loc(#loc311)
      %1956 = cute.get_shape(%lay_5256) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)"> loc(#loc311)
      %e0_5257, %e1_5258, %e2_5259, %e3_5260, %e4_5261 = cute.get_leaves(%1956) : !cute.shape<"(((2,2),2),2,4)"> loc(#loc311)
      %int_tuple_5262 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc505)
      %sz_5263 = cute.size(%int_tuple_5262) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc505)
      %e0_5264 = cute.get_leaves(%sz_5263) : !cute.int_tuple<"4"> loc(#loc505)
      %int_tuple_5265 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
      %sz_5266 = cute.size(%int_tuple_5265) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
      %e0_5267 = cute.get_leaves(%sz_5266) : !cute.int_tuple<"4"> loc(#loc506)
      %coord_5268 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc507)
      %slice_5269 = cute.slice(%src_partitioned_329, %coord_5268) : !memref_smem_bf16_10, !cute.coord<"(_,_,1)"> loc(#loc507)
      %iter_5270 = cute.get_iter(%slice_5269) : !memref_smem_bf16_18 loc(#loc316)
      %iter_5271 = cute.get_iter(%slice_5269) : !memref_smem_bf16_18 loc(#loc317)
      %coord_5272 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc508)
      %slice_5273 = cute.slice(%retiled_331, %coord_5272) : !memref_rmem_bf16_5, !cute.coord<"(_,_,1)"> loc(#loc508)
      %iter_5274 = cute.get_iter(%slice_5273) : !memref_rmem_bf16_14 loc(#loc316)
      %iter_5275 = cute.get_iter(%slice_5273) : !memref_rmem_bf16_14 loc(#loc317)
      %lay_5276 = cute.get_layout(%slice_5269) : !memref_smem_bf16_18 loc(#loc311)
      %1957 = cute.get_shape(%lay_5276) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5277, %e1_5278, %e2_5279, %e3_5280, %e4_5281 = cute.get_leaves(%1957) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %lay_5282 = cute.get_layout(%slice_5273) : !memref_rmem_bf16_14 loc(#loc311)
      %1958 = cute.get_shape(%lay_5282) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5283, %e1_5284, %e2_5285, %e3_5286 = cute.get_leaves(%1958) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %lay_5287 = cute.get_layout(%slice_5269) : !memref_smem_bf16_18 loc(#loc397)
      %shape_5288 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5289 = cute.make_layout(%shape_5288) : !cute.layout<"1:0"> loc(#loc397)
      %append_5290 = cute.append_to_rank<2> (%lay_5287, %lay_5289) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5291 = cute.make_view(%iter_5271, %append_5290) : !memref_smem_bf16_18 loc(#loc398)
      %iter_5292 = cute.get_iter(%view_5291) : !memref_smem_bf16_18 loc(#loc331)
      %lay_5293 = cute.get_layout(%view_5291) : !memref_smem_bf16_18 loc(#loc311)
      %1959 = cute.get_shape(%lay_5293) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5294, %e1_5295, %e2_5296, %e3_5297, %e4_5298 = cute.get_leaves(%1959) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %grouped_5299 = cute.group_modes(%view_5291) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
      %iter_5300 = cute.get_iter(%grouped_5299) : !memref_smem_bf16_19 loc(#loc399)
      %iter_5301 = cute.get_iter(%grouped_5299) : !memref_smem_bf16_19 loc(#loc317)
      %lay_5302 = cute.get_layout(%slice_5273) : !memref_rmem_bf16_14 loc(#loc397)
      %shape_5303 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5304 = cute.make_layout(%shape_5303) : !cute.layout<"1:0"> loc(#loc397)
      %append_5305 = cute.append_to_rank<2> (%lay_5302, %lay_5304) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5306 = cute.make_view(%iter_5275, %append_5305) : !memref_rmem_bf16_14 loc(#loc400)
      %iter_5307 = cute.get_iter(%view_5306) : !memref_rmem_bf16_14 loc(#loc331)
      %lay_5308 = cute.get_layout(%view_5306) : !memref_rmem_bf16_14 loc(#loc311)
      %1960 = cute.get_shape(%lay_5308) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5309, %e1_5310, %e2_5311, %e3_5312 = cute.get_leaves(%1960) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %grouped_5313 = cute.group_modes(%view_5306) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
      %iter_5314 = cute.get_iter(%grouped_5313) : !memref_rmem_bf16_15 loc(#loc399)
      %iter_5315 = cute.get_iter(%grouped_5313) : !memref_rmem_bf16_15 loc(#loc317)
      %lay_5316 = cute.get_layout(%grouped_5299) : !memref_smem_bf16_19 loc(#loc311)
      %1961 = cute.get_shape(%lay_5316) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %e0_5317, %e1_5318, %e2_5319, %e3_5320, %e4_5321 = cute.get_leaves(%1961) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %lay_5322 = cute.get_layout(%grouped_5313) : !memref_rmem_bf16_15 loc(#loc311)
      %1962 = cute.get_shape(%lay_5322) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %e0_5323, %e1_5324, %e2_5325, %e3_5326 = cute.get_leaves(%1962) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %sz_5327 = cute.size(%grouped_5299) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5328 = cute.get_leaves(%sz_5327) : !cute.int_tuple<"8"> loc(#loc402)
      %sz_5329 = cute.size(%grouped_5313) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5330 = cute.get_leaves(%sz_5329) : !cute.int_tuple<"8"> loc(#loc402)
      cute.copy(%138, %grouped_5299, %grouped_5313) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
      %coord_5331 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc510)
      %slice_5332 = cute.slice(%view_5191, %coord_5331) : !memref_rmem_bf16_13, !cute.coord<"(_,_,0)"> loc(#loc510)
      %iter_5333 = cute.get_iter(%slice_5332) : !memref_rmem_bf16_16 loc(#loc316)
      %iter_5334 = cute.get_iter(%slice_5332) : !memref_rmem_bf16_16 loc(#loc317)
      %coord_5335 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc511)
      %slice_5336 = cute.slice(%frg_B_256, %coord_5335) : !memref_rmem_bf16_2, !cute.coord<"(_,_,0)"> loc(#loc511)
      %iter_5337 = cute.get_iter(%slice_5336) : !memref_rmem_bf16_17 loc(#loc316)
      %iter_5338 = cute.get_iter(%slice_5336) : !memref_rmem_bf16_17 loc(#loc317)
      %lay_5339 = cute.get_layout(%slice_5332) : !memref_rmem_bf16_16 loc(#loc311)
      %1963 = cute.get_shape(%lay_5339) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %e0_5340, %e1_5341, %e2_5342, %e3_5343 = cute.get_leaves(%1963) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %lay_5344 = cute.get_layout(%slice_5336) : !memref_rmem_bf16_17 loc(#loc311)
      %1964 = cute.get_shape(%lay_5344) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      %e0_5345, %e1_5346, %e2_5347, %e3_5348 = cute.get_leaves(%1964) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      %lay_5349 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc311)
      %1965 = cute.get_shape(%lay_5349) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %e0_5350, %e1_5351, %e2_5352, %e3_5353 = cute.get_leaves(%1965) : !cute.shape<"((2,2),2,16)"> loc(#loc311)
      cute.gemm(%arg10, %rmem, %slice_5332, %slice_5336, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
      %int_tuple_5354 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
      %sz_5355 = cute.size(%int_tuple_5354) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
      %e0_5356 = cute.get_leaves(%sz_5355) : !cute.int_tuple<"4"> loc(#loc506)
      %coord_5357 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc507)
      %slice_5358 = cute.slice(%src_partitioned_329, %coord_5357) : !memref_smem_bf16_10, !cute.coord<"(_,_,2)"> loc(#loc507)
      %iter_5359 = cute.get_iter(%slice_5358) : !memref_smem_bf16_18 loc(#loc316)
      %iter_5360 = cute.get_iter(%slice_5358) : !memref_smem_bf16_18 loc(#loc317)
      %coord_5361 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc508)
      %slice_5362 = cute.slice(%retiled_331, %coord_5361) : !memref_rmem_bf16_5, !cute.coord<"(_,_,2)"> loc(#loc508)
      %iter_5363 = cute.get_iter(%slice_5362) : !memref_rmem_bf16_14 loc(#loc316)
      %iter_5364 = cute.get_iter(%slice_5362) : !memref_rmem_bf16_14 loc(#loc317)
      %lay_5365 = cute.get_layout(%slice_5358) : !memref_smem_bf16_18 loc(#loc311)
      %1966 = cute.get_shape(%lay_5365) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5366, %e1_5367, %e2_5368, %e3_5369, %e4_5370 = cute.get_leaves(%1966) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %lay_5371 = cute.get_layout(%slice_5362) : !memref_rmem_bf16_14 loc(#loc311)
      %1967 = cute.get_shape(%lay_5371) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5372, %e1_5373, %e2_5374, %e3_5375 = cute.get_leaves(%1967) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %lay_5376 = cute.get_layout(%slice_5358) : !memref_smem_bf16_18 loc(#loc397)
      %shape_5377 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5378 = cute.make_layout(%shape_5377) : !cute.layout<"1:0"> loc(#loc397)
      %append_5379 = cute.append_to_rank<2> (%lay_5376, %lay_5378) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5380 = cute.make_view(%iter_5360, %append_5379) : !memref_smem_bf16_18 loc(#loc398)
      %iter_5381 = cute.get_iter(%view_5380) : !memref_smem_bf16_18 loc(#loc331)
      %lay_5382 = cute.get_layout(%view_5380) : !memref_smem_bf16_18 loc(#loc311)
      %1968 = cute.get_shape(%lay_5382) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5383, %e1_5384, %e2_5385, %e3_5386, %e4_5387 = cute.get_leaves(%1968) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %grouped_5388 = cute.group_modes(%view_5380) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
      %iter_5389 = cute.get_iter(%grouped_5388) : !memref_smem_bf16_19 loc(#loc399)
      %iter_5390 = cute.get_iter(%grouped_5388) : !memref_smem_bf16_19 loc(#loc317)
      %lay_5391 = cute.get_layout(%slice_5362) : !memref_rmem_bf16_14 loc(#loc397)
      %shape_5392 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5393 = cute.make_layout(%shape_5392) : !cute.layout<"1:0"> loc(#loc397)
      %append_5394 = cute.append_to_rank<2> (%lay_5391, %lay_5393) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5395 = cute.make_view(%iter_5364, %append_5394) : !memref_rmem_bf16_14 loc(#loc400)
      %iter_5396 = cute.get_iter(%view_5395) : !memref_rmem_bf16_14 loc(#loc331)
      %lay_5397 = cute.get_layout(%view_5395) : !memref_rmem_bf16_14 loc(#loc311)
      %1969 = cute.get_shape(%lay_5397) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5398, %e1_5399, %e2_5400, %e3_5401 = cute.get_leaves(%1969) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %grouped_5402 = cute.group_modes(%view_5395) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
      %iter_5403 = cute.get_iter(%grouped_5402) : !memref_rmem_bf16_15 loc(#loc399)
      %iter_5404 = cute.get_iter(%grouped_5402) : !memref_rmem_bf16_15 loc(#loc317)
      %lay_5405 = cute.get_layout(%grouped_5388) : !memref_smem_bf16_19 loc(#loc311)
      %1970 = cute.get_shape(%lay_5405) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %e0_5406, %e1_5407, %e2_5408, %e3_5409, %e4_5410 = cute.get_leaves(%1970) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %lay_5411 = cute.get_layout(%grouped_5402) : !memref_rmem_bf16_15 loc(#loc311)
      %1971 = cute.get_shape(%lay_5411) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %e0_5412, %e1_5413, %e2_5414, %e3_5415 = cute.get_leaves(%1971) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %sz_5416 = cute.size(%grouped_5388) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5417 = cute.get_leaves(%sz_5416) : !cute.int_tuple<"8"> loc(#loc402)
      %sz_5418 = cute.size(%grouped_5402) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5419 = cute.get_leaves(%sz_5418) : !cute.int_tuple<"8"> loc(#loc402)
      cute.copy(%138, %grouped_5388, %grouped_5402) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
      %coord_5420 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc510)
      %slice_5421 = cute.slice(%view_5191, %coord_5420) : !memref_rmem_bf16_13, !cute.coord<"(_,_,1)"> loc(#loc510)
      %iter_5422 = cute.get_iter(%slice_5421) : !memref_rmem_bf16_16 loc(#loc316)
      %iter_5423 = cute.get_iter(%slice_5421) : !memref_rmem_bf16_16 loc(#loc317)
      %coord_5424 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc511)
      %slice_5425 = cute.slice(%frg_B_256, %coord_5424) : !memref_rmem_bf16_2, !cute.coord<"(_,_,1)"> loc(#loc511)
      %iter_5426 = cute.get_iter(%slice_5425) : !memref_rmem_bf16_17 loc(#loc316)
      %iter_5427 = cute.get_iter(%slice_5425) : !memref_rmem_bf16_17 loc(#loc317)
      %lay_5428 = cute.get_layout(%slice_5421) : !memref_rmem_bf16_16 loc(#loc311)
      %1972 = cute.get_shape(%lay_5428) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %e0_5429, %e1_5430, %e2_5431, %e3_5432 = cute.get_leaves(%1972) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %lay_5433 = cute.get_layout(%slice_5425) : !memref_rmem_bf16_17 loc(#loc311)
      %1973 = cute.get_shape(%lay_5433) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      %e0_5434, %e1_5435, %e2_5436, %e3_5437 = cute.get_leaves(%1973) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      cute.gemm(%arg10, %rmem, %slice_5421, %slice_5425, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
      %int_tuple_5438 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
      %sz_5439 = cute.size(%int_tuple_5438) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
      %e0_5440 = cute.get_leaves(%sz_5439) : !cute.int_tuple<"4"> loc(#loc506)
      %coord_5441 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc507)
      %slice_5442 = cute.slice(%src_partitioned_329, %coord_5441) : !memref_smem_bf16_10, !cute.coord<"(_,_,3)"> loc(#loc507)
      %iter_5443 = cute.get_iter(%slice_5442) : !memref_smem_bf16_18 loc(#loc316)
      %iter_5444 = cute.get_iter(%slice_5442) : !memref_smem_bf16_18 loc(#loc317)
      %coord_5445 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc508)
      %slice_5446 = cute.slice(%retiled_331, %coord_5445) : !memref_rmem_bf16_5, !cute.coord<"(_,_,3)"> loc(#loc508)
      %iter_5447 = cute.get_iter(%slice_5446) : !memref_rmem_bf16_14 loc(#loc316)
      %iter_5448 = cute.get_iter(%slice_5446) : !memref_rmem_bf16_14 loc(#loc317)
      %lay_5449 = cute.get_layout(%slice_5442) : !memref_smem_bf16_18 loc(#loc311)
      %1974 = cute.get_shape(%lay_5449) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5450, %e1_5451, %e2_5452, %e3_5453, %e4_5454 = cute.get_leaves(%1974) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %lay_5455 = cute.get_layout(%slice_5446) : !memref_rmem_bf16_14 loc(#loc311)
      %1975 = cute.get_shape(%lay_5455) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5456, %e1_5457, %e2_5458, %e3_5459 = cute.get_leaves(%1975) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %lay_5460 = cute.get_layout(%slice_5442) : !memref_smem_bf16_18 loc(#loc397)
      %shape_5461 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5462 = cute.make_layout(%shape_5461) : !cute.layout<"1:0"> loc(#loc397)
      %append_5463 = cute.append_to_rank<2> (%lay_5460, %lay_5462) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5464 = cute.make_view(%iter_5444, %append_5463) : !memref_smem_bf16_18 loc(#loc398)
      %iter_5465 = cute.get_iter(%view_5464) : !memref_smem_bf16_18 loc(#loc331)
      %lay_5466 = cute.get_layout(%view_5464) : !memref_smem_bf16_18 loc(#loc311)
      %1976 = cute.get_shape(%lay_5466) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5467, %e1_5468, %e2_5469, %e3_5470, %e4_5471 = cute.get_leaves(%1976) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %grouped_5472 = cute.group_modes(%view_5464) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
      %iter_5473 = cute.get_iter(%grouped_5472) : !memref_smem_bf16_19 loc(#loc399)
      %iter_5474 = cute.get_iter(%grouped_5472) : !memref_smem_bf16_19 loc(#loc317)
      %lay_5475 = cute.get_layout(%slice_5446) : !memref_rmem_bf16_14 loc(#loc397)
      %shape_5476 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5477 = cute.make_layout(%shape_5476) : !cute.layout<"1:0"> loc(#loc397)
      %append_5478 = cute.append_to_rank<2> (%lay_5475, %lay_5477) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5479 = cute.make_view(%iter_5448, %append_5478) : !memref_rmem_bf16_14 loc(#loc400)
      %iter_5480 = cute.get_iter(%view_5479) : !memref_rmem_bf16_14 loc(#loc331)
      %lay_5481 = cute.get_layout(%view_5479) : !memref_rmem_bf16_14 loc(#loc311)
      %1977 = cute.get_shape(%lay_5481) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5482, %e1_5483, %e2_5484, %e3_5485 = cute.get_leaves(%1977) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %grouped_5486 = cute.group_modes(%view_5479) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
      %iter_5487 = cute.get_iter(%grouped_5486) : !memref_rmem_bf16_15 loc(#loc399)
      %iter_5488 = cute.get_iter(%grouped_5486) : !memref_rmem_bf16_15 loc(#loc317)
      %lay_5489 = cute.get_layout(%grouped_5472) : !memref_smem_bf16_19 loc(#loc311)
      %1978 = cute.get_shape(%lay_5489) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %e0_5490, %e1_5491, %e2_5492, %e3_5493, %e4_5494 = cute.get_leaves(%1978) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %lay_5495 = cute.get_layout(%grouped_5486) : !memref_rmem_bf16_15 loc(#loc311)
      %1979 = cute.get_shape(%lay_5495) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %e0_5496, %e1_5497, %e2_5498, %e3_5499 = cute.get_leaves(%1979) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %sz_5500 = cute.size(%grouped_5472) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5501 = cute.get_leaves(%sz_5500) : !cute.int_tuple<"8"> loc(#loc402)
      %sz_5502 = cute.size(%grouped_5486) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5503 = cute.get_leaves(%sz_5502) : !cute.int_tuple<"8"> loc(#loc402)
      cute.copy(%138, %grouped_5472, %grouped_5486) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
      %coord_5504 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc510)
      %slice_5505 = cute.slice(%view_5191, %coord_5504) : !memref_rmem_bf16_13, !cute.coord<"(_,_,2)"> loc(#loc510)
      %iter_5506 = cute.get_iter(%slice_5505) : !memref_rmem_bf16_16 loc(#loc316)
      %iter_5507 = cute.get_iter(%slice_5505) : !memref_rmem_bf16_16 loc(#loc317)
      %coord_5508 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc511)
      %slice_5509 = cute.slice(%frg_B_256, %coord_5508) : !memref_rmem_bf16_2, !cute.coord<"(_,_,2)"> loc(#loc511)
      %iter_5510 = cute.get_iter(%slice_5509) : !memref_rmem_bf16_17 loc(#loc316)
      %iter_5511 = cute.get_iter(%slice_5509) : !memref_rmem_bf16_17 loc(#loc317)
      %lay_5512 = cute.get_layout(%slice_5505) : !memref_rmem_bf16_16 loc(#loc311)
      %1980 = cute.get_shape(%lay_5512) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %e0_5513, %e1_5514, %e2_5515, %e3_5516 = cute.get_leaves(%1980) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %lay_5517 = cute.get_layout(%slice_5509) : !memref_rmem_bf16_17 loc(#loc311)
      %1981 = cute.get_shape(%lay_5517) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      %e0_5518, %e1_5519, %e2_5520, %e3_5521 = cute.get_leaves(%1981) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      cute.gemm(%arg10, %rmem, %slice_5505, %slice_5509, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
      %int_tuple_5522 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
      %sz_5523 = cute.size(%int_tuple_5522) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
      %e0_5524 = cute.get_leaves(%sz_5523) : !cute.int_tuple<"4"> loc(#loc506)
      %coord_5525 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc507)
      %slice_5526 = cute.slice(%src_partitioned_329, %coord_5525) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)"> loc(#loc507)
      %iter_5527 = cute.get_iter(%slice_5526) : !memref_smem_bf16_18 loc(#loc316)
      %iter_5528 = cute.get_iter(%slice_5526) : !memref_smem_bf16_18 loc(#loc317)
      %coord_5529 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc508)
      %slice_5530 = cute.slice(%retiled_331, %coord_5529) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)"> loc(#loc508)
      %iter_5531 = cute.get_iter(%slice_5530) : !memref_rmem_bf16_14 loc(#loc316)
      %iter_5532 = cute.get_iter(%slice_5530) : !memref_rmem_bf16_14 loc(#loc317)
      %lay_5533 = cute.get_layout(%slice_5526) : !memref_smem_bf16_18 loc(#loc311)
      %1982 = cute.get_shape(%lay_5533) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5534, %e1_5535, %e2_5536, %e3_5537, %e4_5538 = cute.get_leaves(%1982) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %lay_5539 = cute.get_layout(%slice_5530) : !memref_rmem_bf16_14 loc(#loc311)
      %1983 = cute.get_shape(%lay_5539) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5540, %e1_5541, %e2_5542, %e3_5543 = cute.get_leaves(%1983) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %lay_5544 = cute.get_layout(%slice_5526) : !memref_smem_bf16_18 loc(#loc397)
      %shape_5545 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5546 = cute.make_layout(%shape_5545) : !cute.layout<"1:0"> loc(#loc397)
      %append_5547 = cute.append_to_rank<2> (%lay_5544, %lay_5546) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5548 = cute.make_view(%iter_5528, %append_5547) : !memref_smem_bf16_18 loc(#loc398)
      %iter_5549 = cute.get_iter(%view_5548) : !memref_smem_bf16_18 loc(#loc331)
      %lay_5550 = cute.get_layout(%view_5548) : !memref_smem_bf16_18 loc(#loc311)
      %1984 = cute.get_shape(%lay_5550) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %e0_5551, %e1_5552, %e2_5553, %e3_5554, %e4_5555 = cute.get_leaves(%1984) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
      %grouped_5556 = cute.group_modes(%view_5548) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
      %iter_5557 = cute.get_iter(%grouped_5556) : !memref_smem_bf16_19 loc(#loc399)
      %iter_5558 = cute.get_iter(%grouped_5556) : !memref_smem_bf16_19 loc(#loc317)
      %lay_5559 = cute.get_layout(%slice_5530) : !memref_rmem_bf16_14 loc(#loc397)
      %shape_5560 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5561 = cute.make_layout(%shape_5560) : !cute.layout<"1:0"> loc(#loc397)
      %append_5562 = cute.append_to_rank<2> (%lay_5559, %lay_5561) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5563 = cute.make_view(%iter_5532, %append_5562) : !memref_rmem_bf16_14 loc(#loc400)
      %iter_5564 = cute.get_iter(%view_5563) : !memref_rmem_bf16_14 loc(#loc331)
      %lay_5565 = cute.get_layout(%view_5563) : !memref_rmem_bf16_14 loc(#loc311)
      %1985 = cute.get_shape(%lay_5565) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %e0_5566, %e1_5567, %e2_5568, %e3_5569 = cute.get_leaves(%1985) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
      %grouped_5570 = cute.group_modes(%view_5563) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
      %iter_5571 = cute.get_iter(%grouped_5570) : !memref_rmem_bf16_15 loc(#loc399)
      %iter_5572 = cute.get_iter(%grouped_5570) : !memref_rmem_bf16_15 loc(#loc317)
      %lay_5573 = cute.get_layout(%grouped_5556) : !memref_smem_bf16_19 loc(#loc311)
      %1986 = cute.get_shape(%lay_5573) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %e0_5574, %e1_5575, %e2_5576, %e3_5577, %e4_5578 = cute.get_leaves(%1986) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
      %lay_5579 = cute.get_layout(%grouped_5570) : !memref_rmem_bf16_15 loc(#loc311)
      %1987 = cute.get_shape(%lay_5579) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %e0_5580, %e1_5581, %e2_5582, %e3_5583 = cute.get_leaves(%1987) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
      %sz_5584 = cute.size(%grouped_5556) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5585 = cute.get_leaves(%sz_5584) : !cute.int_tuple<"8"> loc(#loc402)
      %sz_5586 = cute.size(%grouped_5570) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
      %e0_5587 = cute.get_leaves(%sz_5586) : !cute.int_tuple<"8"> loc(#loc402)
      cute.copy(%138, %grouped_5556, %grouped_5570) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
      %coord_5588 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc510)
      %slice_5589 = cute.slice(%view_5191, %coord_5588) : !memref_rmem_bf16_13, !cute.coord<"(_,_,3)"> loc(#loc510)
      %iter_5590 = cute.get_iter(%slice_5589) : !memref_rmem_bf16_16 loc(#loc316)
      %iter_5591 = cute.get_iter(%slice_5589) : !memref_rmem_bf16_16 loc(#loc317)
      %coord_5592 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc511)
      %slice_5593 = cute.slice(%frg_B_256, %coord_5592) : !memref_rmem_bf16_2, !cute.coord<"(_,_,3)"> loc(#loc511)
      %iter_5594 = cute.get_iter(%slice_5593) : !memref_rmem_bf16_17 loc(#loc316)
      %iter_5595 = cute.get_iter(%slice_5593) : !memref_rmem_bf16_17 loc(#loc317)
      %lay_5596 = cute.get_layout(%slice_5589) : !memref_rmem_bf16_16 loc(#loc311)
      %1988 = cute.get_shape(%lay_5596) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %e0_5597, %e1_5598, %e2_5599, %e3_5600 = cute.get_leaves(%1988) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
      %lay_5601 = cute.get_layout(%slice_5593) : !memref_rmem_bf16_17 loc(#loc311)
      %1989 = cute.get_shape(%lay_5601) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      %e0_5602, %e1_5603, %e2_5604, %e3_5605 = cute.get_leaves(%1989) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
      cute.gemm(%arg10, %rmem, %slice_5589, %slice_5593, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
      %c1_i32_5606 = arith.constant 1 : i32 loc(#loc290)
      %1990:7 = scf.for %arg11 = %c1_i32_5606 to %120 step %c1_i32_5606 iter_args(%arg12 = %474, %arg13 = %111, %arg14 = %474, %arg15 = %arg0, %arg16 = %arg1, %arg17 = %112, %arg18 = %113) -> (i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32)  : i32 {
        %iter_6349 = cute.get_iter(%arg15) : !memref_gmem_bf16_ loc(#loc513)
        %iter_6350 = cute.get_iter(%arg16) : !memref_gmem_bf16_ loc(#loc513)
        %lay_6351 = cute.get_layout(%arg15) : !memref_gmem_bf16_ loc(#loc294)
        %2346 = cute.get_shape(%lay_6351) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
        %e0_6352, %e1_6353, %e2_6354, %e3_6355 = cute.get_leaves(%2346) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
        %itup_6356 = cute.to_int_tuple(%e0_6352) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2347 = cute.get_scalars(%itup_6356) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6357 = cute.to_int_tuple(%e1_6353) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2348 = cute.get_scalars(%itup_6357) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6358 = cute.to_int_tuple(%e2_6354) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2349 = cute.get_scalars(%itup_6358) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6359 = cute.to_int_tuple(%e3_6355) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
        %2350 = cute.get_scalars(%itup_6359) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
        %2351 = cute.get_stride(%lay_6351) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
        %e0_6360, %e1_6361, %e2_6362, %e3_6363 = cute.get_leaves(%2351) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
        %itup_6364 = cute.to_int_tuple(%e0_6360) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2352 = cute.get_scalars(%itup_6364) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %itup_6365 = cute.to_int_tuple(%e1_6361) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2353 = cute.get_scalars(%itup_6365) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %itup_6366 = cute.to_int_tuple(%e2_6362) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2354 = cute.get_scalars(%itup_6366) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %lay_6367 = cute.get_layout(%arg16) : !memref_gmem_bf16_ loc(#loc294)
        %2355 = cute.get_shape(%lay_6367) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
        %e0_6368, %e1_6369, %e2_6370, %e3_6371 = cute.get_leaves(%2355) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
        %itup_6372 = cute.to_int_tuple(%e0_6368) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2356 = cute.get_scalars(%itup_6372) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6373 = cute.to_int_tuple(%e1_6369) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2357 = cute.get_scalars(%itup_6373) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6374 = cute.to_int_tuple(%e2_6370) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
        %2358 = cute.get_scalars(%itup_6374) : !cute.int_tuple<"?"> loc(#loc295)
        %itup_6375 = cute.to_int_tuple(%e3_6371) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
        %2359 = cute.get_scalars(%itup_6375) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
        %2360 = cute.get_stride(%lay_6367) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
        %e0_6376, %e1_6377, %e2_6378, %e3_6379 = cute.get_leaves(%2360) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
        %itup_6380 = cute.to_int_tuple(%e0_6376) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2361 = cute.get_scalars(%itup_6380) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %itup_6381 = cute.to_int_tuple(%e1_6377) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2362 = cute.get_scalars(%itup_6381) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %itup_6382 = cute.to_int_tuple(%e2_6378) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %2363 = cute.get_scalars(%itup_6382) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
        %iter_6383 = cute.get_iter(%arg15) : !memref_gmem_bf16_ loc(#loc293)
        %iter_6384 = cute.get_iter(%arg16) : !memref_gmem_bf16_ loc(#loc293)
        %2364 = arith.subi %120, %arg11 : i32 loc(#loc313)
        %c1_i32_6385 = arith.constant 1 : i32 loc(#loc290)
        %2365 = arith.subi %2364, %c1_i32_6385 : i32 loc(#loc313)
        %shape_6386 = cute.make_shape() : () -> !cute.shape<"(128,64)"> loc(#loc417)
        %2366 = cute.tiled.mma.partition_shape C (%arg10, %shape_6386) : (!mma_bf16_bf16_f32_16x8x16_, !cute.shape<"(128,64)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc417)
        %e0_6387, %e1_6388, %e2_6389, %e3_6390 = cute.get_leaves(%2366) : !cute.shape<"((2,2),2,8)"> loc(#loc417)
        %shape_6391 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)"> loc(#loc418)
        %lay_6392 = cute.make_layout(%shape_6391) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc418)
        %rmem_6393 = cute.memref.alloca(%lay_6392) : !memref_rmem_f32_2 loc(#loc418)
        %iter_6394 = cute.get_iter(%rmem_6393) : !memref_rmem_f32_2 loc(#loc350)
        %iter_6395 = cute.get_iter(%rmem_6393) : !memref_rmem_f32_2 loc(#loc351)
        %sz_6396 = cute.size(%rmem_6393) : (!memref_rmem_f32_2) -> !cute.int_tuple<"64"> loc(#loc419)
        %e0_6397 = cute.get_leaves(%sz_6396) : !cute.int_tuple<"64"> loc(#loc419)
        %lay_6398 = cute.get_layout(%rmem_6393) : !memref_rmem_f32_2 loc(#loc311)
        %2367 = cute.get_shape(%lay_6398) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc311)
        %e0_6399, %e1_6400, %e2_6401, %e3_6402 = cute.get_leaves(%2367) : !cute.shape<"((2,2),2,8)"> loc(#loc311)
        %int_tuple_6403 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
        %res_6404 = cute.tuple.product(%int_tuple_6403) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
        %e0_6405 = cute.get_leaves(%res_6404) : !cute.int_tuple<"64"> loc(#loc419)
        %cst_6406 = arith.constant 0.000000e+00 : f32 loc(#loc419)
        %2368 = vector.splat %cst_6406 : vector<64xf32> loc(#loc419)
        %int_tuple_6407 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
        %sz_6408 = cute.size(%int_tuple_6407) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
        %e0_6409 = cute.get_leaves(%sz_6408) : !cute.int_tuple<"64"> loc(#loc419)
        %int_tuple_6410 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc419)
        %sz_6411 = cute.size(%int_tuple_6410) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc419)
        %e0_6412 = cute.get_leaves(%sz_6411) : !cute.int_tuple<"64"> loc(#loc419)
        cute.memref.store_vec %2368, %rmem_6393 : !memref_rmem_f32_2 loc(#loc419)
        nvvm.cp.async.wait.group 0 loc(#loc420)
        %c1_i32_6413 = arith.constant 1 : i32 loc(#loc421)
        %c128_i32_6414 = arith.constant 128 : i32 loc(#loc421)
        nvvm.barrier id = %c1_i32_6413 number_of_threads = %c128_i32_6414 loc(#loc421)
        %false_6415 = arith.constant false loc(#loc290)
        scf.if %false_6415 {
          %lay_8346 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc311)
          %2686 = cute.get_shape(%lay_8346) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8347, %e1_8348, %e2_8349, %e3_8350 = cute.get_leaves(%2686) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %int_tuple_8351 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc422)
          %sz_8352 = cute.size(%int_tuple_8351) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc422)
          %e0_8353 = cute.get_leaves(%sz_8352) : !cute.int_tuple<"4"> loc(#loc422)
          %coord_8354 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc423)
          %slice_8355 = cute.slice(%src_partitioned_411, %coord_8354) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)"> loc(#loc423)
          %iter_8356 = cute.get_iter(%slice_8355) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
          %e0_8357, %e1_8358, %e2_8359, %e3_8360 = cute.get_leaves(%iter_8356) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2687 = cute.get_scalars(%e0_8357) : !cute.int_tuple<"?"> loc(#loc290)
          %2688 = cute.get_scalars(%e1_8358) : !cute.int_tuple<"?"> loc(#loc290)
          %2689 = cute.get_scalars(%e2_8359) : !cute.int_tuple<"?"> loc(#loc290)
          %2690 = cute.get_scalars(%e3_8360) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8361 = cute.get_iter(%slice_8355) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
          %e0_8362, %e1_8363, %e2_8364, %e3_8365 = cute.get_leaves(%iter_8361) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2691 = cute.get_scalars(%e0_8362) : !cute.int_tuple<"?"> loc(#loc290)
          %2692 = cute.get_scalars(%e1_8363) : !cute.int_tuple<"?"> loc(#loc290)
          %2693 = cute.get_scalars(%e2_8364) : !cute.int_tuple<"?"> loc(#loc290)
          %2694 = cute.get_scalars(%e3_8365) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8366 = cute.get_iter(%slice_8355) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
          %e0_8367, %e1_8368, %e2_8369, %e3_8370 = cute.get_leaves(%iter_8366) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
          %2695 = cute.get_scalars(%e0_8367) : !cute.int_tuple<"?"> loc(#loc423)
          %2696 = cute.get_scalars(%e1_8368) : !cute.int_tuple<"?"> loc(#loc423)
          %2697 = cute.get_scalars(%e2_8369) : !cute.int_tuple<"?"> loc(#loc423)
          %2698 = cute.get_scalars(%e3_8370) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
          %lay_8371 = cute.get_layout(%arg16) : !memref_gmem_bf16_ loc(#loc424)
          %2699 = cute.get_shape(%lay_8371) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %e0_8372, %e1_8373, %e2_8374, %e3_8375 = cute.get_leaves(%2699) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %itup_8376 = cute.to_int_tuple(%e0_8372) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2700 = cute.get_scalars(%itup_8376) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8377 = cute.to_int_tuple(%e1_8373) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2701 = cute.get_scalars(%itup_8377) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8378 = cute.to_int_tuple(%e2_8374) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2702 = cute.get_scalars(%itup_8378) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8379 = cute.to_int_tuple(%e3_8375) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %2703 = cute.get_scalars(%itup_8379) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %coord_8380 = cute.make_coord(%e1_8368) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %coord_8381 = cute.make_coord(%itup_8377) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %2704 = cute.elem_less(%coord_8380, %coord_8381) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
          scf.if %2704 {
            %coord_8466 = cute.make_coord(%2365) : (i32) -> !cute.coord<"(_,0,_,?)"> loc(#loc426)
            %slice_8467 = cute.slice(%src_partitioned_242, %coord_8466) : !memref_gmem_bf16_5, !cute.coord<"(_,0,_,?)"> loc(#loc426)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc317)
            %coord_8470 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc427)
            %slice_8471 = cute.slice(%dst_partitioned_245, %coord_8470) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc427)
            %iter_8472 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8473 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc317)
            %coord_8474 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc428)
            %slice_8475 = cute.slice(%rmem_448, %coord_8474) : !memref_rmem_i8_1, !cute.coord<"(_,0,_)"> loc(#loc428)
            %iter_8476 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc316)
            %iter_8477 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc317)
            %lay_8478 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc311)
            %2759 = cute.get_shape(%lay_8478) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8479, %e1_8480, %e2_8481 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8482 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc311)
            %2760 = cute.get_shape(%lay_8482) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8483, %e1_8484, %e2_8485 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8486 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc397)
            %shape_8487 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8488 = cute.make_layout(%shape_8487) : !cute.layout<"1:0"> loc(#loc397)
            %append_8489 = cute.append_to_rank<2> (%lay_8486, %lay_8488) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8490 = cute.make_view(%iter_8469, %append_8489) : !memref_gmem_bf16_6 loc(#loc398)
            %iter_8491 = cute.get_iter(%view_8490) : !memref_gmem_bf16_6 loc(#loc331)
            %lay_8492 = cute.get_layout(%view_8490) : !memref_gmem_bf16_6 loc(#loc311)
            %2761 = cute.get_shape(%lay_8492) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8493, %e1_8494, %e2_8495 = cute.get_leaves(%2761) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8496 = cute.group_modes(%view_8490) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
            %iter_8497 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc399)
            %iter_8498 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc317)
            %lay_8499 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc397)
            %shape_8500 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8501 = cute.make_layout(%shape_8500) : !cute.layout<"1:0"> loc(#loc397)
            %append_8502 = cute.append_to_rank<2> (%lay_8499, %lay_8501) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8503 = cute.make_view(%iter_8473, %append_8502) : !memref_smem_bf16_13 loc(#loc400)
            %iter_8504 = cute.get_iter(%view_8503) : !memref_smem_bf16_13 loc(#loc331)
            %lay_8505 = cute.get_layout(%view_8503) : !memref_smem_bf16_13 loc(#loc311)
            %2762 = cute.get_shape(%lay_8505) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8506, %e1_8507, %e2_8508 = cute.get_leaves(%2762) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8509 = cute.group_modes(%view_8503) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
            %iter_8510 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc399)
            %iter_8511 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc317)
            %lay_8512 = cute.get_layout(%slice_8475) : !memref_rmem_i8_2 loc(#loc397)
            %shape_8513 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8514 = cute.make_layout(%shape_8513) : !cute.layout<"1:0"> loc(#loc397)
            %append_8515 = cute.append_to_rank<2> (%lay_8512, %lay_8514) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8516 = cute.make_view(%iter_8477, %append_8515) : !memref_rmem_i8_2 loc(#loc401)
            %iter_8517 = cute.get_iter(%view_8516) : !memref_rmem_i8_2 loc(#loc331)
            %lay_8518 = cute.get_layout(%view_8516) : !memref_rmem_i8_2 loc(#loc311)
            %2763 = cute.get_shape(%lay_8518) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
            %e0_8519, %e1_8520 = cute.get_leaves(%2763) : !cute.shape<"(1,2)"> loc(#loc311)
            %grouped_8521 = cute.group_modes(%view_8516) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
            %iter_8522 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc399)
            %iter_8523 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc317)
            %lay_8524 = cute.get_layout(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc311)
            %2764 = cute.get_shape(%lay_8524) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8525, %e1_8526, %e2_8527 = cute.get_leaves(%2764) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %lay_8528 = cute.get_layout(%grouped_8509) : !memref_smem_bf16_14 loc(#loc311)
            %2765 = cute.get_shape(%lay_8528) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8529, %e1_8530, %e2_8531 = cute.get_leaves(%2765) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %sz_8532 = cute.size(%grouped_8496) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8533 = cute.get_leaves(%sz_8532) : !cute.int_tuple<"2"> loc(#loc402)
            %sz_8534 = cute.size(%grouped_8509) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8535 = cute.get_leaves(%sz_8534) : !cute.int_tuple<"2"> loc(#loc402)
            cute.copy(%arg8, %grouped_8496, %grouped_8509, %grouped_8521) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
          } else {
            %coord_8466 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc430)
            %slice_8467 = cute.slice(%dst_partitioned_245, %coord_8466) : !memref_smem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc430)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc317)
            %sz_8470 = cute.size(%slice_8467) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8471 = cute.get_leaves(%sz_8470) : !cute.int_tuple<"16"> loc(#loc430)
            %lay_8472 = cute.get_layout(%slice_8467) : !memref_smem_bf16_13 loc(#loc311)
            %2759 = cute.get_shape(%lay_8472) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8473, %e1_8474, %e2_8475 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %int_tuple_8476 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %res_8477 = cute.tuple.product(%int_tuple_8476) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8478 = cute.get_leaves(%res_8477) : !cute.int_tuple<"16"> loc(#loc430)
            %cst_8479 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
            %2760 = vector.splat %cst_8479 : vector<16xbf16> loc(#loc430)
            %int_tuple_8480 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8481 = cute.size(%int_tuple_8480) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8482 = cute.get_leaves(%sz_8481) : !cute.int_tuple<"16"> loc(#loc430)
            %int_tuple_8483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8484 = cute.size(%int_tuple_8483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8485 = cute.get_leaves(%sz_8484) : !cute.int_tuple<"16"> loc(#loc430)
            cute.memref.store_vec %2760, %slice_8467 : !memref_smem_bf16_13 loc(#loc430)
          } loc(#loc290)
          %coord_8382 = cute.make_coord() : () -> !cute.coord<"(0,1,0)"> loc(#loc423)
          %slice_8383 = cute.slice(%src_partitioned_411, %coord_8382) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)"> loc(#loc423)
          %iter_8384 = cute.get_iter(%slice_8383) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
          %e0_8385, %e1_8386, %e2_8387, %e3_8388 = cute.get_leaves(%iter_8384) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2705 = cute.get_scalars(%e0_8385) : !cute.int_tuple<"?"> loc(#loc290)
          %2706 = cute.get_scalars(%e1_8386) : !cute.int_tuple<"?"> loc(#loc290)
          %2707 = cute.get_scalars(%e2_8387) : !cute.int_tuple<"?"> loc(#loc290)
          %2708 = cute.get_scalars(%e3_8388) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8389 = cute.get_iter(%slice_8383) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
          %e0_8390, %e1_8391, %e2_8392, %e3_8393 = cute.get_leaves(%iter_8389) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2709 = cute.get_scalars(%e0_8390) : !cute.int_tuple<"?"> loc(#loc290)
          %2710 = cute.get_scalars(%e1_8391) : !cute.int_tuple<"?"> loc(#loc290)
          %2711 = cute.get_scalars(%e2_8392) : !cute.int_tuple<"?"> loc(#loc290)
          %2712 = cute.get_scalars(%e3_8393) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8394 = cute.get_iter(%slice_8383) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
          %e0_8395, %e1_8396, %e2_8397, %e3_8398 = cute.get_leaves(%iter_8394) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
          %2713 = cute.get_scalars(%e0_8395) : !cute.int_tuple<"?"> loc(#loc423)
          %2714 = cute.get_scalars(%e1_8396) : !cute.int_tuple<"?"> loc(#loc423)
          %2715 = cute.get_scalars(%e2_8397) : !cute.int_tuple<"?"> loc(#loc423)
          %2716 = cute.get_scalars(%e3_8398) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
          %lay_8399 = cute.get_layout(%arg16) : !memref_gmem_bf16_ loc(#loc424)
          %2717 = cute.get_shape(%lay_8399) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %e0_8400, %e1_8401, %e2_8402, %e3_8403 = cute.get_leaves(%2717) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %itup_8404 = cute.to_int_tuple(%e0_8400) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2718 = cute.get_scalars(%itup_8404) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8405 = cute.to_int_tuple(%e1_8401) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2719 = cute.get_scalars(%itup_8405) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8406 = cute.to_int_tuple(%e2_8402) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2720 = cute.get_scalars(%itup_8406) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8407 = cute.to_int_tuple(%e3_8403) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %2721 = cute.get_scalars(%itup_8407) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %coord_8408 = cute.make_coord(%e1_8396) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %coord_8409 = cute.make_coord(%itup_8405) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %2722 = cute.elem_less(%coord_8408, %coord_8409) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
          scf.if %2722 {
            %coord_8466 = cute.make_coord(%2365) : (i32) -> !cute.coord<"(_,1,_,?)"> loc(#loc426)
            %slice_8467 = cute.slice(%src_partitioned_242, %coord_8466) : !memref_gmem_bf16_5, !cute.coord<"(_,1,_,?)"> loc(#loc426)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc317)
            %coord_8470 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc427)
            %slice_8471 = cute.slice(%dst_partitioned_245, %coord_8470) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc427)
            %iter_8472 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8473 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc317)
            %coord_8474 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc428)
            %slice_8475 = cute.slice(%rmem_448, %coord_8474) : !memref_rmem_i8_1, !cute.coord<"(_,1,_)"> loc(#loc428)
            %iter_8476 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc316)
            %iter_8477 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc317)
            %lay_8478 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc311)
            %2759 = cute.get_shape(%lay_8478) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8479, %e1_8480, %e2_8481 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8482 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc311)
            %2760 = cute.get_shape(%lay_8482) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8483, %e1_8484, %e2_8485 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8486 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc397)
            %shape_8487 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8488 = cute.make_layout(%shape_8487) : !cute.layout<"1:0"> loc(#loc397)
            %append_8489 = cute.append_to_rank<2> (%lay_8486, %lay_8488) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8490 = cute.make_view(%iter_8469, %append_8489) : !memref_gmem_bf16_6 loc(#loc398)
            %iter_8491 = cute.get_iter(%view_8490) : !memref_gmem_bf16_6 loc(#loc331)
            %lay_8492 = cute.get_layout(%view_8490) : !memref_gmem_bf16_6 loc(#loc311)
            %2761 = cute.get_shape(%lay_8492) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8493, %e1_8494, %e2_8495 = cute.get_leaves(%2761) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8496 = cute.group_modes(%view_8490) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
            %iter_8497 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc399)
            %iter_8498 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc317)
            %lay_8499 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc397)
            %shape_8500 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8501 = cute.make_layout(%shape_8500) : !cute.layout<"1:0"> loc(#loc397)
            %append_8502 = cute.append_to_rank<2> (%lay_8499, %lay_8501) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8503 = cute.make_view(%iter_8473, %append_8502) : !memref_smem_bf16_13 loc(#loc400)
            %iter_8504 = cute.get_iter(%view_8503) : !memref_smem_bf16_13 loc(#loc331)
            %lay_8505 = cute.get_layout(%view_8503) : !memref_smem_bf16_13 loc(#loc311)
            %2762 = cute.get_shape(%lay_8505) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8506, %e1_8507, %e2_8508 = cute.get_leaves(%2762) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8509 = cute.group_modes(%view_8503) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
            %iter_8510 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc399)
            %iter_8511 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc317)
            %lay_8512 = cute.get_layout(%slice_8475) : !memref_rmem_i8_2 loc(#loc397)
            %shape_8513 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8514 = cute.make_layout(%shape_8513) : !cute.layout<"1:0"> loc(#loc397)
            %append_8515 = cute.append_to_rank<2> (%lay_8512, %lay_8514) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8516 = cute.make_view(%iter_8477, %append_8515) : !memref_rmem_i8_2 loc(#loc401)
            %iter_8517 = cute.get_iter(%view_8516) : !memref_rmem_i8_2 loc(#loc331)
            %lay_8518 = cute.get_layout(%view_8516) : !memref_rmem_i8_2 loc(#loc311)
            %2763 = cute.get_shape(%lay_8518) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
            %e0_8519, %e1_8520 = cute.get_leaves(%2763) : !cute.shape<"(1,2)"> loc(#loc311)
            %grouped_8521 = cute.group_modes(%view_8516) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
            %iter_8522 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc399)
            %iter_8523 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc317)
            %lay_8524 = cute.get_layout(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc311)
            %2764 = cute.get_shape(%lay_8524) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8525, %e1_8526, %e2_8527 = cute.get_leaves(%2764) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %lay_8528 = cute.get_layout(%grouped_8509) : !memref_smem_bf16_14 loc(#loc311)
            %2765 = cute.get_shape(%lay_8528) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8529, %e1_8530, %e2_8531 = cute.get_leaves(%2765) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %sz_8532 = cute.size(%grouped_8496) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8533 = cute.get_leaves(%sz_8532) : !cute.int_tuple<"2"> loc(#loc402)
            %sz_8534 = cute.size(%grouped_8509) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8535 = cute.get_leaves(%sz_8534) : !cute.int_tuple<"2"> loc(#loc402)
            cute.copy(%arg8, %grouped_8496, %grouped_8509, %grouped_8521) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
          } else {
            %coord_8466 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc430)
            %slice_8467 = cute.slice(%dst_partitioned_245, %coord_8466) : !memref_smem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc430)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc317)
            %sz_8470 = cute.size(%slice_8467) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8471 = cute.get_leaves(%sz_8470) : !cute.int_tuple<"16"> loc(#loc430)
            %lay_8472 = cute.get_layout(%slice_8467) : !memref_smem_bf16_13 loc(#loc311)
            %2759 = cute.get_shape(%lay_8472) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8473, %e1_8474, %e2_8475 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %int_tuple_8476 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %res_8477 = cute.tuple.product(%int_tuple_8476) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8478 = cute.get_leaves(%res_8477) : !cute.int_tuple<"16"> loc(#loc430)
            %cst_8479 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
            %2760 = vector.splat %cst_8479 : vector<16xbf16> loc(#loc430)
            %int_tuple_8480 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8481 = cute.size(%int_tuple_8480) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8482 = cute.get_leaves(%sz_8481) : !cute.int_tuple<"16"> loc(#loc430)
            %int_tuple_8483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8484 = cute.size(%int_tuple_8483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8485 = cute.get_leaves(%sz_8484) : !cute.int_tuple<"16"> loc(#loc430)
            cute.memref.store_vec %2760, %slice_8467 : !memref_smem_bf16_13 loc(#loc430)
          } loc(#loc290)
          %coord_8410 = cute.make_coord() : () -> !cute.coord<"(0,2,0)"> loc(#loc423)
          %slice_8411 = cute.slice(%src_partitioned_411, %coord_8410) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)"> loc(#loc423)
          %iter_8412 = cute.get_iter(%slice_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
          %e0_8413, %e1_8414, %e2_8415, %e3_8416 = cute.get_leaves(%iter_8412) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2723 = cute.get_scalars(%e0_8413) : !cute.int_tuple<"?"> loc(#loc290)
          %2724 = cute.get_scalars(%e1_8414) : !cute.int_tuple<"?"> loc(#loc290)
          %2725 = cute.get_scalars(%e2_8415) : !cute.int_tuple<"?"> loc(#loc290)
          %2726 = cute.get_scalars(%e3_8416) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8417 = cute.get_iter(%slice_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
          %e0_8418, %e1_8419, %e2_8420, %e3_8421 = cute.get_leaves(%iter_8417) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2727 = cute.get_scalars(%e0_8418) : !cute.int_tuple<"?"> loc(#loc290)
          %2728 = cute.get_scalars(%e1_8419) : !cute.int_tuple<"?"> loc(#loc290)
          %2729 = cute.get_scalars(%e2_8420) : !cute.int_tuple<"?"> loc(#loc290)
          %2730 = cute.get_scalars(%e3_8421) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8422 = cute.get_iter(%slice_8411) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
          %e0_8423, %e1_8424, %e2_8425, %e3_8426 = cute.get_leaves(%iter_8422) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
          %2731 = cute.get_scalars(%e0_8423) : !cute.int_tuple<"?"> loc(#loc423)
          %2732 = cute.get_scalars(%e1_8424) : !cute.int_tuple<"?"> loc(#loc423)
          %2733 = cute.get_scalars(%e2_8425) : !cute.int_tuple<"?"> loc(#loc423)
          %2734 = cute.get_scalars(%e3_8426) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
          %lay_8427 = cute.get_layout(%arg16) : !memref_gmem_bf16_ loc(#loc424)
          %2735 = cute.get_shape(%lay_8427) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %e0_8428, %e1_8429, %e2_8430, %e3_8431 = cute.get_leaves(%2735) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %itup_8432 = cute.to_int_tuple(%e0_8428) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2736 = cute.get_scalars(%itup_8432) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8433 = cute.to_int_tuple(%e1_8429) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2737 = cute.get_scalars(%itup_8433) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8434 = cute.to_int_tuple(%e2_8430) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2738 = cute.get_scalars(%itup_8434) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8435 = cute.to_int_tuple(%e3_8431) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %2739 = cute.get_scalars(%itup_8435) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %coord_8436 = cute.make_coord(%e1_8424) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %coord_8437 = cute.make_coord(%itup_8433) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %2740 = cute.elem_less(%coord_8436, %coord_8437) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
          scf.if %2740 {
            %coord_8466 = cute.make_coord(%2365) : (i32) -> !cute.coord<"(_,2,_,?)"> loc(#loc426)
            %slice_8467 = cute.slice(%src_partitioned_242, %coord_8466) : !memref_gmem_bf16_5, !cute.coord<"(_,2,_,?)"> loc(#loc426)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc317)
            %coord_8470 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc427)
            %slice_8471 = cute.slice(%dst_partitioned_245, %coord_8470) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc427)
            %iter_8472 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8473 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc317)
            %coord_8474 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc428)
            %slice_8475 = cute.slice(%rmem_448, %coord_8474) : !memref_rmem_i8_1, !cute.coord<"(_,2,_)"> loc(#loc428)
            %iter_8476 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc316)
            %iter_8477 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc317)
            %lay_8478 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc311)
            %2759 = cute.get_shape(%lay_8478) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8479, %e1_8480, %e2_8481 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8482 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc311)
            %2760 = cute.get_shape(%lay_8482) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8483, %e1_8484, %e2_8485 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8486 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc397)
            %shape_8487 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8488 = cute.make_layout(%shape_8487) : !cute.layout<"1:0"> loc(#loc397)
            %append_8489 = cute.append_to_rank<2> (%lay_8486, %lay_8488) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8490 = cute.make_view(%iter_8469, %append_8489) : !memref_gmem_bf16_6 loc(#loc398)
            %iter_8491 = cute.get_iter(%view_8490) : !memref_gmem_bf16_6 loc(#loc331)
            %lay_8492 = cute.get_layout(%view_8490) : !memref_gmem_bf16_6 loc(#loc311)
            %2761 = cute.get_shape(%lay_8492) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8493, %e1_8494, %e2_8495 = cute.get_leaves(%2761) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8496 = cute.group_modes(%view_8490) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
            %iter_8497 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc399)
            %iter_8498 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc317)
            %lay_8499 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc397)
            %shape_8500 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8501 = cute.make_layout(%shape_8500) : !cute.layout<"1:0"> loc(#loc397)
            %append_8502 = cute.append_to_rank<2> (%lay_8499, %lay_8501) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8503 = cute.make_view(%iter_8473, %append_8502) : !memref_smem_bf16_13 loc(#loc400)
            %iter_8504 = cute.get_iter(%view_8503) : !memref_smem_bf16_13 loc(#loc331)
            %lay_8505 = cute.get_layout(%view_8503) : !memref_smem_bf16_13 loc(#loc311)
            %2762 = cute.get_shape(%lay_8505) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8506, %e1_8507, %e2_8508 = cute.get_leaves(%2762) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8509 = cute.group_modes(%view_8503) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
            %iter_8510 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc399)
            %iter_8511 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc317)
            %lay_8512 = cute.get_layout(%slice_8475) : !memref_rmem_i8_2 loc(#loc397)
            %shape_8513 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8514 = cute.make_layout(%shape_8513) : !cute.layout<"1:0"> loc(#loc397)
            %append_8515 = cute.append_to_rank<2> (%lay_8512, %lay_8514) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8516 = cute.make_view(%iter_8477, %append_8515) : !memref_rmem_i8_2 loc(#loc401)
            %iter_8517 = cute.get_iter(%view_8516) : !memref_rmem_i8_2 loc(#loc331)
            %lay_8518 = cute.get_layout(%view_8516) : !memref_rmem_i8_2 loc(#loc311)
            %2763 = cute.get_shape(%lay_8518) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
            %e0_8519, %e1_8520 = cute.get_leaves(%2763) : !cute.shape<"(1,2)"> loc(#loc311)
            %grouped_8521 = cute.group_modes(%view_8516) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
            %iter_8522 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc399)
            %iter_8523 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc317)
            %lay_8524 = cute.get_layout(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc311)
            %2764 = cute.get_shape(%lay_8524) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8525, %e1_8526, %e2_8527 = cute.get_leaves(%2764) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %lay_8528 = cute.get_layout(%grouped_8509) : !memref_smem_bf16_14 loc(#loc311)
            %2765 = cute.get_shape(%lay_8528) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8529, %e1_8530, %e2_8531 = cute.get_leaves(%2765) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %sz_8532 = cute.size(%grouped_8496) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8533 = cute.get_leaves(%sz_8532) : !cute.int_tuple<"2"> loc(#loc402)
            %sz_8534 = cute.size(%grouped_8509) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8535 = cute.get_leaves(%sz_8534) : !cute.int_tuple<"2"> loc(#loc402)
            cute.copy(%arg8, %grouped_8496, %grouped_8509, %grouped_8521) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
          } else {
            %coord_8466 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc430)
            %slice_8467 = cute.slice(%dst_partitioned_245, %coord_8466) : !memref_smem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc430)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc317)
            %sz_8470 = cute.size(%slice_8467) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8471 = cute.get_leaves(%sz_8470) : !cute.int_tuple<"16"> loc(#loc430)
            %lay_8472 = cute.get_layout(%slice_8467) : !memref_smem_bf16_13 loc(#loc311)
            %2759 = cute.get_shape(%lay_8472) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8473, %e1_8474, %e2_8475 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %int_tuple_8476 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %res_8477 = cute.tuple.product(%int_tuple_8476) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8478 = cute.get_leaves(%res_8477) : !cute.int_tuple<"16"> loc(#loc430)
            %cst_8479 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
            %2760 = vector.splat %cst_8479 : vector<16xbf16> loc(#loc430)
            %int_tuple_8480 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8481 = cute.size(%int_tuple_8480) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8482 = cute.get_leaves(%sz_8481) : !cute.int_tuple<"16"> loc(#loc430)
            %int_tuple_8483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8484 = cute.size(%int_tuple_8483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8485 = cute.get_leaves(%sz_8484) : !cute.int_tuple<"16"> loc(#loc430)
            cute.memref.store_vec %2760, %slice_8467 : !memref_smem_bf16_13 loc(#loc430)
          } loc(#loc290)
          %coord_8438 = cute.make_coord() : () -> !cute.coord<"(0,3,0)"> loc(#loc423)
          %slice_8439 = cute.slice(%src_partitioned_411, %coord_8438) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),4,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)"> loc(#loc423)
          %iter_8440 = cute.get_iter(%slice_8439) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
          %e0_8441, %e1_8442, %e2_8443, %e3_8444 = cute.get_leaves(%iter_8440) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2741 = cute.get_scalars(%e0_8441) : !cute.int_tuple<"?"> loc(#loc290)
          %2742 = cute.get_scalars(%e1_8442) : !cute.int_tuple<"?"> loc(#loc290)
          %2743 = cute.get_scalars(%e2_8443) : !cute.int_tuple<"?"> loc(#loc290)
          %2744 = cute.get_scalars(%e3_8444) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8445 = cute.get_iter(%slice_8439) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
          %e0_8446, %e1_8447, %e2_8448, %e3_8449 = cute.get_leaves(%iter_8445) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
          %2745 = cute.get_scalars(%e0_8446) : !cute.int_tuple<"?"> loc(#loc290)
          %2746 = cute.get_scalars(%e1_8447) : !cute.int_tuple<"?"> loc(#loc290)
          %2747 = cute.get_scalars(%e2_8448) : !cute.int_tuple<"?"> loc(#loc290)
          %2748 = cute.get_scalars(%e3_8449) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
          %iter_8450 = cute.get_iter(%slice_8439) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc423)
          %e0_8451, %e1_8452, %e2_8453, %e3_8454 = cute.get_leaves(%iter_8450) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc423)
          %2749 = cute.get_scalars(%e0_8451) : !cute.int_tuple<"?"> loc(#loc423)
          %2750 = cute.get_scalars(%e1_8452) : !cute.int_tuple<"?"> loc(#loc423)
          %2751 = cute.get_scalars(%e2_8453) : !cute.int_tuple<"?"> loc(#loc423)
          %2752 = cute.get_scalars(%e3_8454) : !cute.int_tuple<"?{div=8}"> loc(#loc423)
          %lay_8455 = cute.get_layout(%arg16) : !memref_gmem_bf16_ loc(#loc424)
          %2753 = cute.get_shape(%lay_8455) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %e0_8456, %e1_8457, %e2_8458, %e3_8459 = cute.get_leaves(%2753) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc424)
          %itup_8460 = cute.to_int_tuple(%e0_8456) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2754 = cute.get_scalars(%itup_8460) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8461 = cute.to_int_tuple(%e1_8457) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2755 = cute.get_scalars(%itup_8461) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8462 = cute.to_int_tuple(%e2_8458) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc424)
          %2756 = cute.get_scalars(%itup_8462) : !cute.int_tuple<"?"> loc(#loc424)
          %itup_8463 = cute.to_int_tuple(%e3_8459) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %2757 = cute.get_scalars(%itup_8463) : !cute.int_tuple<"?{div=8}"> loc(#loc424)
          %coord_8464 = cute.make_coord(%e1_8452) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %coord_8465 = cute.make_coord(%itup_8461) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc425)
          %2758 = cute.elem_less(%coord_8464, %coord_8465) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc425)
          scf.if %2758 {
            %coord_8466 = cute.make_coord(%2365) : (i32) -> !cute.coord<"(_,3,_,?)"> loc(#loc426)
            %slice_8467 = cute.slice(%src_partitioned_242, %coord_8466) : !memref_gmem_bf16_5, !cute.coord<"(_,3,_,?)"> loc(#loc426)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_gmem_bf16_6 loc(#loc317)
            %coord_8470 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc427)
            %slice_8471 = cute.slice(%dst_partitioned_245, %coord_8470) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc427)
            %iter_8472 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8473 = cute.get_iter(%slice_8471) : !memref_smem_bf16_13 loc(#loc317)
            %coord_8474 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc428)
            %slice_8475 = cute.slice(%rmem_448, %coord_8474) : !memref_rmem_i8_1, !cute.coord<"(_,3,_)"> loc(#loc428)
            %iter_8476 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc316)
            %iter_8477 = cute.get_iter(%slice_8475) : !memref_rmem_i8_2 loc(#loc317)
            %lay_8478 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc311)
            %2759 = cute.get_shape(%lay_8478) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8479, %e1_8480, %e2_8481 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8482 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc311)
            %2760 = cute.get_shape(%lay_8482) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8483, %e1_8484, %e2_8485 = cute.get_leaves(%2760) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %lay_8486 = cute.get_layout(%slice_8467) : !memref_gmem_bf16_6 loc(#loc397)
            %shape_8487 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8488 = cute.make_layout(%shape_8487) : !cute.layout<"1:0"> loc(#loc397)
            %append_8489 = cute.append_to_rank<2> (%lay_8486, %lay_8488) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8490 = cute.make_view(%iter_8469, %append_8489) : !memref_gmem_bf16_6 loc(#loc398)
            %iter_8491 = cute.get_iter(%view_8490) : !memref_gmem_bf16_6 loc(#loc331)
            %lay_8492 = cute.get_layout(%view_8490) : !memref_gmem_bf16_6 loc(#loc311)
            %2761 = cute.get_shape(%lay_8492) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8493, %e1_8494, %e2_8495 = cute.get_leaves(%2761) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8496 = cute.group_modes(%view_8490) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc398)
            %iter_8497 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc399)
            %iter_8498 = cute.get_iter(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc317)
            %lay_8499 = cute.get_layout(%slice_8471) : !memref_smem_bf16_13 loc(#loc397)
            %shape_8500 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8501 = cute.make_layout(%shape_8500) : !cute.layout<"1:0"> loc(#loc397)
            %append_8502 = cute.append_to_rank<2> (%lay_8499, %lay_8501) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8503 = cute.make_view(%iter_8473, %append_8502) : !memref_smem_bf16_13 loc(#loc400)
            %iter_8504 = cute.get_iter(%view_8503) : !memref_smem_bf16_13 loc(#loc331)
            %lay_8505 = cute.get_layout(%view_8503) : !memref_smem_bf16_13 loc(#loc311)
            %2762 = cute.get_shape(%lay_8505) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8506, %e1_8507, %e2_8508 = cute.get_leaves(%2762) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %grouped_8509 = cute.group_modes(%view_8503) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc400)
            %iter_8510 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc399)
            %iter_8511 = cute.get_iter(%grouped_8509) : !memref_smem_bf16_14 loc(#loc317)
            %lay_8512 = cute.get_layout(%slice_8475) : !memref_rmem_i8_2 loc(#loc397)
            %shape_8513 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
            %lay_8514 = cute.make_layout(%shape_8513) : !cute.layout<"1:0"> loc(#loc397)
            %append_8515 = cute.append_to_rank<2> (%lay_8512, %lay_8514) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
            %view_8516 = cute.make_view(%iter_8477, %append_8515) : !memref_rmem_i8_2 loc(#loc401)
            %iter_8517 = cute.get_iter(%view_8516) : !memref_rmem_i8_2 loc(#loc331)
            %lay_8518 = cute.get_layout(%view_8516) : !memref_rmem_i8_2 loc(#loc311)
            %2763 = cute.get_shape(%lay_8518) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
            %e0_8519, %e1_8520 = cute.get_leaves(%2763) : !cute.shape<"(1,2)"> loc(#loc311)
            %grouped_8521 = cute.group_modes(%view_8516) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
            %iter_8522 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc399)
            %iter_8523 = cute.get_iter(%grouped_8521) : !memref_rmem_i8_3 loc(#loc317)
            %lay_8524 = cute.get_layout(%grouped_8496) : !memref_gmem_bf16_7 loc(#loc311)
            %2764 = cute.get_shape(%lay_8524) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8525, %e1_8526, %e2_8527 = cute.get_leaves(%2764) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %lay_8528 = cute.get_layout(%grouped_8509) : !memref_smem_bf16_14 loc(#loc311)
            %2765 = cute.get_shape(%lay_8528) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
            %e0_8529, %e1_8530, %e2_8531 = cute.get_leaves(%2765) : !cute.shape<"((8,1),(2))"> loc(#loc311)
            %sz_8532 = cute.size(%grouped_8496) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8533 = cute.get_leaves(%sz_8532) : !cute.int_tuple<"2"> loc(#loc402)
            %sz_8534 = cute.size(%grouped_8509) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
            %e0_8535 = cute.get_leaves(%sz_8534) : !cute.int_tuple<"2"> loc(#loc402)
            cute.copy(%arg8, %grouped_8496, %grouped_8509, %grouped_8521) : (!copy_ldgsts, !memref_gmem_bf16_7, !memref_smem_bf16_14, !memref_rmem_i8_3) loc(#loc429)
          } else {
            %coord_8466 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc430)
            %slice_8467 = cute.slice(%dst_partitioned_245, %coord_8466) : !memref_smem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc430)
            %iter_8468 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc316)
            %iter_8469 = cute.get_iter(%slice_8467) : !memref_smem_bf16_13 loc(#loc317)
            %sz_8470 = cute.size(%slice_8467) : (!memref_smem_bf16_13) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8471 = cute.get_leaves(%sz_8470) : !cute.int_tuple<"16"> loc(#loc430)
            %lay_8472 = cute.get_layout(%slice_8467) : !memref_smem_bf16_13 loc(#loc311)
            %2759 = cute.get_shape(%lay_8472) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
            %e0_8473, %e1_8474, %e2_8475 = cute.get_leaves(%2759) : !cute.shape<"((8,1),2)"> loc(#loc311)
            %int_tuple_8476 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %res_8477 = cute.tuple.product(%int_tuple_8476) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8478 = cute.get_leaves(%res_8477) : !cute.int_tuple<"16"> loc(#loc430)
            %cst_8479 = arith.constant 0.000000e+00 : bf16 loc(#loc430)
            %2760 = vector.splat %cst_8479 : vector<16xbf16> loc(#loc430)
            %int_tuple_8480 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8481 = cute.size(%int_tuple_8480) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8482 = cute.get_leaves(%sz_8481) : !cute.int_tuple<"16"> loc(#loc430)
            %int_tuple_8483 = cute.make_int_tuple() : () -> !cute.int_tuple<"((8,1),2)"> loc(#loc430)
            %sz_8484 = cute.size(%int_tuple_8483) : (!cute.int_tuple<"((8,1),2)">) -> !cute.int_tuple<"16"> loc(#loc430)
            %e0_8485 = cute.get_leaves(%sz_8484) : !cute.int_tuple<"16"> loc(#loc430)
            cute.memref.store_vec %2760, %slice_8467 : !memref_smem_bf16_13 loc(#loc430)
          } loc(#loc290)
        } else {
          %coord_8346 = cute.make_coord(%2365) : (i32) -> !cute.coord<"(_,_,_,?)"> loc(#loc431)
          %slice_8347 = cute.slice(%src_partitioned_242, %coord_8346) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)"> loc(#loc431)
          %iter_8348 = cute.get_iter(%slice_8347) : !memref_gmem_bf16_8 loc(#loc316)
          %iter_8349 = cute.get_iter(%slice_8347) : !memref_gmem_bf16_8 loc(#loc317)
          %lay_8350 = cute.get_layout(%slice_8347) : !memref_gmem_bf16_8 loc(#loc311)
          %2686 = cute.get_shape(%lay_8350) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8351, %e1_8352, %e2_8353, %e3_8354 = cute.get_leaves(%2686) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %lay_8355 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc311)
          %2687 = cute.get_shape(%lay_8355) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8356, %e1_8357, %e2_8358, %e3_8359 = cute.get_leaves(%2687) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %lay_8360 = cute.get_layout(%slice_8347) : !memref_gmem_bf16_8 loc(#loc397)
          %shape_8361 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8362 = cute.make_layout(%shape_8361) : !cute.layout<"1:0"> loc(#loc397)
          %append_8363 = cute.append_to_rank<2> (%lay_8360, %lay_8362) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8364 = cute.make_view(%iter_8349, %append_8363) : !memref_gmem_bf16_8 loc(#loc398)
          %iter_8365 = cute.get_iter(%view_8364) : !memref_gmem_bf16_8 loc(#loc331)
          %lay_8366 = cute.get_layout(%view_8364) : !memref_gmem_bf16_8 loc(#loc311)
          %2688 = cute.get_shape(%lay_8366) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8367, %e1_8368, %e2_8369, %e3_8370 = cute.get_leaves(%2688) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %grouped_8371 = cute.group_modes(%view_8364) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9 loc(#loc398)
          %iter_8372 = cute.get_iter(%grouped_8371) : !memref_gmem_bf16_9 loc(#loc399)
          %iter_8373 = cute.get_iter(%grouped_8371) : !memref_gmem_bf16_9 loc(#loc317)
          %lay_8374 = cute.get_layout(%dst_partitioned_245) : !memref_smem_bf16_4 loc(#loc397)
          %shape_8375 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8376 = cute.make_layout(%shape_8375) : !cute.layout<"1:0"> loc(#loc397)
          %append_8377 = cute.append_to_rank<2> (%lay_8374, %lay_8376) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8378 = cute.make_view(%iter_246, %append_8377) : !memref_smem_bf16_4 loc(#loc400)
          %iter_8379 = cute.get_iter(%view_8378) : !memref_smem_bf16_4 loc(#loc331)
          %lay_8380 = cute.get_layout(%view_8378) : !memref_smem_bf16_4 loc(#loc311)
          %2689 = cute.get_shape(%lay_8380) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8381, %e1_8382, %e2_8383, %e3_8384 = cute.get_leaves(%2689) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %grouped_8385 = cute.group_modes(%view_8378) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15 loc(#loc400)
          %iter_8386 = cute.get_iter(%grouped_8385) : !memref_smem_bf16_15 loc(#loc399)
          %iter_8387 = cute.get_iter(%grouped_8385) : !memref_smem_bf16_15 loc(#loc317)
          %lay_8388 = cute.get_layout(%rmem_448) : !memref_rmem_i8_1 loc(#loc397)
          %shape_8389 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8390 = cute.make_layout(%shape_8389) : !cute.layout<"1:0"> loc(#loc397)
          %append_8391 = cute.append_to_rank<2> (%lay_8388, %lay_8390) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8392 = cute.make_view(%iter_450, %append_8391) : !memref_rmem_i8_1 loc(#loc401)
          %iter_8393 = cute.get_iter(%view_8392) : !memref_rmem_i8_1 loc(#loc331)
          %lay_8394 = cute.get_layout(%view_8392) : !memref_rmem_i8_1 loc(#loc311)
          %2690 = cute.get_shape(%lay_8394) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)"> loc(#loc311)
          %e0_8395, %e1_8396, %e2_8397 = cute.get_leaves(%2690) : !cute.shape<"(1,4,2)"> loc(#loc311)
          %grouped_8398 = cute.group_modes(%view_8392) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4 loc(#loc401)
          %iter_8399 = cute.get_iter(%grouped_8398) : !memref_rmem_i8_4 loc(#loc399)
          %iter_8400 = cute.get_iter(%grouped_8398) : !memref_rmem_i8_4 loc(#loc317)
          %lay_8401 = cute.get_layout(%grouped_8371) : !memref_gmem_bf16_9 loc(#loc311)
          %2691 = cute.get_shape(%lay_8401) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %e0_8402, %e1_8403, %e2_8404, %e3_8405 = cute.get_leaves(%2691) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %lay_8406 = cute.get_layout(%grouped_8385) : !memref_smem_bf16_15 loc(#loc311)
          %2692 = cute.get_shape(%lay_8406) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %e0_8407, %e1_8408, %e2_8409, %e3_8410 = cute.get_leaves(%2692) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %sz_8411 = cute.size(%grouped_8371) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8"> loc(#loc402)
          %e0_8412 = cute.get_leaves(%sz_8411) : !cute.int_tuple<"8"> loc(#loc402)
          %sz_8413 = cute.size(%grouped_8385) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
          %e0_8414 = cute.get_leaves(%sz_8413) : !cute.int_tuple<"8"> loc(#loc402)
          cute.copy(%arg8, %grouped_8371, %grouped_8385, %grouped_8398) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4) loc(#loc432)
        } loc(#loc290)
        nvvm.cp.async.commit.group loc(#loc433)
        %coord_6416 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc434)
        %slice_6417 = cute.slice(%src_partitioned_320, %coord_6416) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)"> loc(#loc434)
        %iter_6418 = cute.get_iter(%slice_6417) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6419 = cute.get_iter(%slice_6417) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6420 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc435)
        %slice_6421 = cute.slice(%retiled, %coord_6420) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)"> loc(#loc435)
        %iter_6422 = cute.get_iter(%slice_6421) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_6423 = cute.get_iter(%slice_6421) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_6424 = cute.get_layout(%slice_6417) : !memref_smem_bf16_13 loc(#loc311)
        %2369 = cute.get_shape(%lay_6424) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6425, %e1_6426, %e2_6427 = cute.get_leaves(%2369) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6428 = cute.get_layout(%slice_6421) : !memref_rmem_bf16_6 loc(#loc311)
        %2370 = cute.get_shape(%lay_6428) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6429, %e1_6430, %e2_6431 = cute.get_leaves(%2370) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6432 = cute.get_layout(%slice_6417) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6433 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6434 = cute.make_layout(%shape_6433) : !cute.layout<"1:0"> loc(#loc397)
        %append_6435 = cute.append_to_rank<2> (%lay_6432, %lay_6434) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6436 = cute.make_view(%iter_6419, %append_6435) : !memref_smem_bf16_13 loc(#loc398)
        %iter_6437 = cute.get_iter(%view_6436) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6438 = cute.get_layout(%view_6436) : !memref_smem_bf16_13 loc(#loc311)
        %2371 = cute.get_shape(%lay_6438) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6439, %e1_6440, %e2_6441 = cute.get_leaves(%2371) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6442 = cute.group_modes(%view_6436) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_6443 = cute.get_iter(%grouped_6442) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6444 = cute.get_iter(%grouped_6442) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6445 = cute.get_layout(%slice_6421) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_6446 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6447 = cute.make_layout(%shape_6446) : !cute.layout<"1:0"> loc(#loc397)
        %append_6448 = cute.append_to_rank<2> (%lay_6445, %lay_6447) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6449 = cute.make_view(%iter_6423, %append_6448) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_6450 = cute.get_iter(%view_6449) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_6451 = cute.get_layout(%view_6449) : !memref_rmem_bf16_6 loc(#loc311)
        %2372 = cute.get_shape(%lay_6451) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6452, %e1_6453, %e2_6454 = cute.get_leaves(%2372) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6455 = cute.group_modes(%view_6449) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_6456 = cute.get_iter(%grouped_6455) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_6457 = cute.get_iter(%grouped_6455) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_6458 = cute.get_layout(%grouped_6442) : !memref_smem_bf16_14 loc(#loc311)
        %2373 = cute.get_shape(%lay_6458) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6459, %e1_6460, %e2_6461 = cute.get_leaves(%2373) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6462 = cute.get_layout(%grouped_6455) : !memref_rmem_bf16_7 loc(#loc311)
        %2374 = cute.get_shape(%lay_6462) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6463, %e1_6464, %e2_6465 = cute.get_leaves(%2374) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6466 = cute.size(%grouped_6442) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6467 = cute.get_leaves(%sz_6466) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6468 = cute.size(%grouped_6455) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6469 = cute.get_leaves(%sz_6468) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_6442, %grouped_6455) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc436)
        %coord_6470 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc437)
        %slice_6471 = cute.slice(%src_partitioned_324, %coord_6470) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)"> loc(#loc437)
        %iter_6472 = cute.get_iter(%slice_6471) : !memref_smem_bf16_16 loc(#loc316)
        %iter_6473 = cute.get_iter(%slice_6471) : !memref_smem_bf16_16 loc(#loc317)
        %coord_6474 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc438)
        %slice_6475 = cute.slice(%retiled_326, %coord_6474) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)"> loc(#loc438)
        %iter_6476 = cute.get_iter(%slice_6475) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_6477 = cute.get_iter(%slice_6475) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_6478 = cute.get_layout(%slice_6471) : !memref_smem_bf16_16 loc(#loc311)
        %2375 = cute.get_shape(%lay_6478) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6479, %e1_6480, %e2_6481 = cute.get_leaves(%2375) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6482 = cute.get_layout(%slice_6475) : !memref_rmem_bf16_8 loc(#loc311)
        %2376 = cute.get_shape(%lay_6482) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6483, %e1_6484, %e2_6485 = cute.get_leaves(%2376) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6486 = cute.get_layout(%slice_6471) : !memref_smem_bf16_16 loc(#loc397)
        %shape_6487 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6488 = cute.make_layout(%shape_6487) : !cute.layout<"1:0"> loc(#loc397)
        %append_6489 = cute.append_to_rank<2> (%lay_6486, %lay_6488) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6490 = cute.make_view(%iter_6473, %append_6489) : !memref_smem_bf16_16 loc(#loc398)
        %iter_6491 = cute.get_iter(%view_6490) : !memref_smem_bf16_16 loc(#loc331)
        %lay_6492 = cute.get_layout(%view_6490) : !memref_smem_bf16_16 loc(#loc311)
        %2377 = cute.get_shape(%lay_6492) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6493, %e1_6494, %e2_6495 = cute.get_leaves(%2377) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6496 = cute.group_modes(%view_6490) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_6497 = cute.get_iter(%grouped_6496) : !memref_smem_bf16_17 loc(#loc399)
        %iter_6498 = cute.get_iter(%grouped_6496) : !memref_smem_bf16_17 loc(#loc317)
        %lay_6499 = cute.get_layout(%slice_6475) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_6500 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6501 = cute.make_layout(%shape_6500) : !cute.layout<"1:0"> loc(#loc397)
        %append_6502 = cute.append_to_rank<2> (%lay_6499, %lay_6501) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6503 = cute.make_view(%iter_6477, %append_6502) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_6504 = cute.get_iter(%view_6503) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_6505 = cute.get_layout(%view_6503) : !memref_rmem_bf16_8 loc(#loc311)
        %2378 = cute.get_shape(%lay_6505) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6506, %e1_6507, %e2_6508 = cute.get_leaves(%2378) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6509 = cute.group_modes(%view_6503) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_6510 = cute.get_iter(%grouped_6509) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_6511 = cute.get_iter(%grouped_6509) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_6512 = cute.get_layout(%grouped_6496) : !memref_smem_bf16_17 loc(#loc311)
        %2379 = cute.get_shape(%lay_6512) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6513, %e1_6514, %e2_6515 = cute.get_leaves(%2379) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_6516 = cute.get_layout(%grouped_6509) : !memref_rmem_bf16_9 loc(#loc311)
        %2380 = cute.get_shape(%lay_6516) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6517, %e1_6518, %e2_6519 = cute.get_leaves(%2380) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_6520 = cute.size(%grouped_6496) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6521 = cute.get_leaves(%sz_6520) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_6522 = cute.size(%grouped_6509) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6523 = cute.get_leaves(%sz_6522) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_6496, %grouped_6509) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc439)
        %lay_6524 = cute.get_layout(%src_partitioned_320) : !memref_smem_bf16_8 loc(#loc311)
        %2381 = cute.get_shape(%lay_6524) : (!cute.layout<"((8,1),2,((2,2),2)):((1,0),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((8,1),2,((2,2),2))"> loc(#loc311)
        %e0_6525, %e1_6526, %e2_6527, %e3_6528, %e4_6529, %e5_6530 = cute.get_leaves(%2381) : !cute.shape<"((8,1),2,((2,2),2))"> loc(#loc311)
        %int_tuple_6531 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc440)
        %sz_6532 = cute.size(%int_tuple_6531) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc440)
        %e0_6533 = cute.get_leaves(%sz_6532) : !cute.int_tuple<"8"> loc(#loc440)
        %int_tuple_6534 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_6535 = cute.size(%int_tuple_6534) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_6536 = cute.get_leaves(%sz_6535) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_6537 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc442)
        %slice_6538 = cute.slice(%src_partitioned_320, %coord_6537) : !memref_smem_bf16_8, !cute.coord<"(_,_,1)"> loc(#loc442)
        %iter_6539 = cute.get_iter(%slice_6538) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6540 = cute.get_iter(%slice_6538) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6541 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc443)
        %slice_6542 = cute.slice(%retiled, %coord_6541) : !memref_rmem_bf16_3, !cute.coord<"(_,_,1)"> loc(#loc443)
        %iter_6543 = cute.get_iter(%slice_6542) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_6544 = cute.get_iter(%slice_6542) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_6545 = cute.get_layout(%slice_6538) : !memref_smem_bf16_13 loc(#loc311)
        %2382 = cute.get_shape(%lay_6545) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6546, %e1_6547, %e2_6548 = cute.get_leaves(%2382) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6549 = cute.get_layout(%slice_6542) : !memref_rmem_bf16_6 loc(#loc311)
        %2383 = cute.get_shape(%lay_6549) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6550, %e1_6551, %e2_6552 = cute.get_leaves(%2383) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6553 = cute.get_layout(%slice_6538) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6554 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6555 = cute.make_layout(%shape_6554) : !cute.layout<"1:0"> loc(#loc397)
        %append_6556 = cute.append_to_rank<2> (%lay_6553, %lay_6555) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6557 = cute.make_view(%iter_6540, %append_6556) : !memref_smem_bf16_13 loc(#loc398)
        %iter_6558 = cute.get_iter(%view_6557) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6559 = cute.get_layout(%view_6557) : !memref_smem_bf16_13 loc(#loc311)
        %2384 = cute.get_shape(%lay_6559) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6560, %e1_6561, %e2_6562 = cute.get_leaves(%2384) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6563 = cute.group_modes(%view_6557) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_6564 = cute.get_iter(%grouped_6563) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6565 = cute.get_iter(%grouped_6563) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6566 = cute.get_layout(%slice_6542) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_6567 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6568 = cute.make_layout(%shape_6567) : !cute.layout<"1:0"> loc(#loc397)
        %append_6569 = cute.append_to_rank<2> (%lay_6566, %lay_6568) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6570 = cute.make_view(%iter_6544, %append_6569) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_6571 = cute.get_iter(%view_6570) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_6572 = cute.get_layout(%view_6570) : !memref_rmem_bf16_6 loc(#loc311)
        %2385 = cute.get_shape(%lay_6572) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6573, %e1_6574, %e2_6575 = cute.get_leaves(%2385) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6576 = cute.group_modes(%view_6570) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_6577 = cute.get_iter(%grouped_6576) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_6578 = cute.get_iter(%grouped_6576) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_6579 = cute.get_layout(%grouped_6563) : !memref_smem_bf16_14 loc(#loc311)
        %2386 = cute.get_shape(%lay_6579) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6580, %e1_6581, %e2_6582 = cute.get_leaves(%2386) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6583 = cute.get_layout(%grouped_6576) : !memref_rmem_bf16_7 loc(#loc311)
        %2387 = cute.get_shape(%lay_6583) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6584, %e1_6585, %e2_6586 = cute.get_leaves(%2387) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6587 = cute.size(%grouped_6563) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6588 = cute.get_leaves(%sz_6587) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6589 = cute.size(%grouped_6576) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6590 = cute.get_leaves(%sz_6589) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_6563, %grouped_6576) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_6591 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc445)
        %slice_6592 = cute.slice(%src_partitioned_324, %coord_6591) : !memref_smem_bf16_9, !cute.coord<"(_,_,1)"> loc(#loc445)
        %iter_6593 = cute.get_iter(%slice_6592) : !memref_smem_bf16_16 loc(#loc316)
        %iter_6594 = cute.get_iter(%slice_6592) : !memref_smem_bf16_16 loc(#loc317)
        %coord_6595 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc446)
        %slice_6596 = cute.slice(%retiled_326, %coord_6595) : !memref_rmem_bf16_4, !cute.coord<"(_,_,1)"> loc(#loc446)
        %iter_6597 = cute.get_iter(%slice_6596) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_6598 = cute.get_iter(%slice_6596) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_6599 = cute.get_layout(%slice_6592) : !memref_smem_bf16_16 loc(#loc311)
        %2388 = cute.get_shape(%lay_6599) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6600, %e1_6601, %e2_6602 = cute.get_leaves(%2388) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6603 = cute.get_layout(%slice_6596) : !memref_rmem_bf16_8 loc(#loc311)
        %2389 = cute.get_shape(%lay_6603) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6604, %e1_6605, %e2_6606 = cute.get_leaves(%2389) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6607 = cute.get_layout(%slice_6592) : !memref_smem_bf16_16 loc(#loc397)
        %shape_6608 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6609 = cute.make_layout(%shape_6608) : !cute.layout<"1:0"> loc(#loc397)
        %append_6610 = cute.append_to_rank<2> (%lay_6607, %lay_6609) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6611 = cute.make_view(%iter_6594, %append_6610) : !memref_smem_bf16_16 loc(#loc398)
        %iter_6612 = cute.get_iter(%view_6611) : !memref_smem_bf16_16 loc(#loc331)
        %lay_6613 = cute.get_layout(%view_6611) : !memref_smem_bf16_16 loc(#loc311)
        %2390 = cute.get_shape(%lay_6613) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6614, %e1_6615, %e2_6616 = cute.get_leaves(%2390) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6617 = cute.group_modes(%view_6611) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_6618 = cute.get_iter(%grouped_6617) : !memref_smem_bf16_17 loc(#loc399)
        %iter_6619 = cute.get_iter(%grouped_6617) : !memref_smem_bf16_17 loc(#loc317)
        %lay_6620 = cute.get_layout(%slice_6596) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_6621 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6622 = cute.make_layout(%shape_6621) : !cute.layout<"1:0"> loc(#loc397)
        %append_6623 = cute.append_to_rank<2> (%lay_6620, %lay_6622) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6624 = cute.make_view(%iter_6598, %append_6623) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_6625 = cute.get_iter(%view_6624) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_6626 = cute.get_layout(%view_6624) : !memref_rmem_bf16_8 loc(#loc311)
        %2391 = cute.get_shape(%lay_6626) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6627, %e1_6628, %e2_6629 = cute.get_leaves(%2391) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6630 = cute.group_modes(%view_6624) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_6631 = cute.get_iter(%grouped_6630) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_6632 = cute.get_iter(%grouped_6630) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_6633 = cute.get_layout(%grouped_6617) : !memref_smem_bf16_17 loc(#loc311)
        %2392 = cute.get_shape(%lay_6633) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6634, %e1_6635, %e2_6636 = cute.get_leaves(%2392) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_6637 = cute.get_layout(%grouped_6630) : !memref_rmem_bf16_9 loc(#loc311)
        %2393 = cute.get_shape(%lay_6637) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6638, %e1_6639, %e2_6640 = cute.get_leaves(%2393) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_6641 = cute.size(%grouped_6617) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6642 = cute.get_leaves(%sz_6641) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_6643 = cute.size(%grouped_6630) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6644 = cute.get_leaves(%sz_6643) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_6617, %grouped_6630) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_6645 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc448)
        %slice_6646 = cute.slice(%frg_A, %coord_6645) : !memref_rmem_bf16_, !cute.coord<"(_,_,0)"> loc(#loc448)
        %iter_6647 = cute.get_iter(%slice_6646) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_6648 = cute.get_iter(%slice_6646) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_6649 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc449)
        %slice_6650 = cute.slice(%frg_B, %coord_6649) : !memref_rmem_bf16_1, !cute.coord<"(_,_,0)"> loc(#loc449)
        %iter_6651 = cute.get_iter(%slice_6650) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_6652 = cute.get_iter(%slice_6650) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_6653 = cute.get_layout(%slice_6646) : !memref_rmem_bf16_10 loc(#loc311)
        %2394 = cute.get_shape(%lay_6653) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_6654, %e1_6655, %e2_6656, %e3_6657 = cute.get_leaves(%2394) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_6658 = cute.get_layout(%slice_6650) : !memref_rmem_bf16_11 loc(#loc311)
        %2395 = cute.get_shape(%lay_6658) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_6659, %e1_6660, %e2_6661 = cute.get_leaves(%2395) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_6646, %slice_6650, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_6662 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_6663 = cute.size(%int_tuple_6662) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_6664 = cute.get_leaves(%sz_6663) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_6665 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc442)
        %slice_6666 = cute.slice(%src_partitioned_320, %coord_6665) : !memref_smem_bf16_8, !cute.coord<"(_,_,2)"> loc(#loc442)
        %iter_6667 = cute.get_iter(%slice_6666) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6668 = cute.get_iter(%slice_6666) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6669 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc443)
        %slice_6670 = cute.slice(%retiled, %coord_6669) : !memref_rmem_bf16_3, !cute.coord<"(_,_,2)"> loc(#loc443)
        %iter_6671 = cute.get_iter(%slice_6670) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_6672 = cute.get_iter(%slice_6670) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_6673 = cute.get_layout(%slice_6666) : !memref_smem_bf16_13 loc(#loc311)
        %2396 = cute.get_shape(%lay_6673) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6674, %e1_6675, %e2_6676 = cute.get_leaves(%2396) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6677 = cute.get_layout(%slice_6670) : !memref_rmem_bf16_6 loc(#loc311)
        %2397 = cute.get_shape(%lay_6677) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6678, %e1_6679, %e2_6680 = cute.get_leaves(%2397) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6681 = cute.get_layout(%slice_6666) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6682 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6683 = cute.make_layout(%shape_6682) : !cute.layout<"1:0"> loc(#loc397)
        %append_6684 = cute.append_to_rank<2> (%lay_6681, %lay_6683) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6685 = cute.make_view(%iter_6668, %append_6684) : !memref_smem_bf16_13 loc(#loc398)
        %iter_6686 = cute.get_iter(%view_6685) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6687 = cute.get_layout(%view_6685) : !memref_smem_bf16_13 loc(#loc311)
        %2398 = cute.get_shape(%lay_6687) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6688, %e1_6689, %e2_6690 = cute.get_leaves(%2398) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6691 = cute.group_modes(%view_6685) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_6692 = cute.get_iter(%grouped_6691) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6693 = cute.get_iter(%grouped_6691) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6694 = cute.get_layout(%slice_6670) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_6695 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6696 = cute.make_layout(%shape_6695) : !cute.layout<"1:0"> loc(#loc397)
        %append_6697 = cute.append_to_rank<2> (%lay_6694, %lay_6696) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6698 = cute.make_view(%iter_6672, %append_6697) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_6699 = cute.get_iter(%view_6698) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_6700 = cute.get_layout(%view_6698) : !memref_rmem_bf16_6 loc(#loc311)
        %2399 = cute.get_shape(%lay_6700) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6701, %e1_6702, %e2_6703 = cute.get_leaves(%2399) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6704 = cute.group_modes(%view_6698) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_6705 = cute.get_iter(%grouped_6704) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_6706 = cute.get_iter(%grouped_6704) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_6707 = cute.get_layout(%grouped_6691) : !memref_smem_bf16_14 loc(#loc311)
        %2400 = cute.get_shape(%lay_6707) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6708, %e1_6709, %e2_6710 = cute.get_leaves(%2400) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6711 = cute.get_layout(%grouped_6704) : !memref_rmem_bf16_7 loc(#loc311)
        %2401 = cute.get_shape(%lay_6711) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6712, %e1_6713, %e2_6714 = cute.get_leaves(%2401) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6715 = cute.size(%grouped_6691) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6716 = cute.get_leaves(%sz_6715) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6717 = cute.size(%grouped_6704) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6718 = cute.get_leaves(%sz_6717) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_6691, %grouped_6704) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_6719 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc445)
        %slice_6720 = cute.slice(%src_partitioned_324, %coord_6719) : !memref_smem_bf16_9, !cute.coord<"(_,_,2)"> loc(#loc445)
        %iter_6721 = cute.get_iter(%slice_6720) : !memref_smem_bf16_16 loc(#loc316)
        %iter_6722 = cute.get_iter(%slice_6720) : !memref_smem_bf16_16 loc(#loc317)
        %coord_6723 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc446)
        %slice_6724 = cute.slice(%retiled_326, %coord_6723) : !memref_rmem_bf16_4, !cute.coord<"(_,_,2)"> loc(#loc446)
        %iter_6725 = cute.get_iter(%slice_6724) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_6726 = cute.get_iter(%slice_6724) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_6727 = cute.get_layout(%slice_6720) : !memref_smem_bf16_16 loc(#loc311)
        %2402 = cute.get_shape(%lay_6727) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6728, %e1_6729, %e2_6730 = cute.get_leaves(%2402) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6731 = cute.get_layout(%slice_6724) : !memref_rmem_bf16_8 loc(#loc311)
        %2403 = cute.get_shape(%lay_6731) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6732, %e1_6733, %e2_6734 = cute.get_leaves(%2403) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6735 = cute.get_layout(%slice_6720) : !memref_smem_bf16_16 loc(#loc397)
        %shape_6736 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6737 = cute.make_layout(%shape_6736) : !cute.layout<"1:0"> loc(#loc397)
        %append_6738 = cute.append_to_rank<2> (%lay_6735, %lay_6737) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6739 = cute.make_view(%iter_6722, %append_6738) : !memref_smem_bf16_16 loc(#loc398)
        %iter_6740 = cute.get_iter(%view_6739) : !memref_smem_bf16_16 loc(#loc331)
        %lay_6741 = cute.get_layout(%view_6739) : !memref_smem_bf16_16 loc(#loc311)
        %2404 = cute.get_shape(%lay_6741) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6742, %e1_6743, %e2_6744 = cute.get_leaves(%2404) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6745 = cute.group_modes(%view_6739) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_6746 = cute.get_iter(%grouped_6745) : !memref_smem_bf16_17 loc(#loc399)
        %iter_6747 = cute.get_iter(%grouped_6745) : !memref_smem_bf16_17 loc(#loc317)
        %lay_6748 = cute.get_layout(%slice_6724) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_6749 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6750 = cute.make_layout(%shape_6749) : !cute.layout<"1:0"> loc(#loc397)
        %append_6751 = cute.append_to_rank<2> (%lay_6748, %lay_6750) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6752 = cute.make_view(%iter_6726, %append_6751) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_6753 = cute.get_iter(%view_6752) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_6754 = cute.get_layout(%view_6752) : !memref_rmem_bf16_8 loc(#loc311)
        %2405 = cute.get_shape(%lay_6754) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6755, %e1_6756, %e2_6757 = cute.get_leaves(%2405) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6758 = cute.group_modes(%view_6752) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_6759 = cute.get_iter(%grouped_6758) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_6760 = cute.get_iter(%grouped_6758) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_6761 = cute.get_layout(%grouped_6745) : !memref_smem_bf16_17 loc(#loc311)
        %2406 = cute.get_shape(%lay_6761) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6762, %e1_6763, %e2_6764 = cute.get_leaves(%2406) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_6765 = cute.get_layout(%grouped_6758) : !memref_rmem_bf16_9 loc(#loc311)
        %2407 = cute.get_shape(%lay_6765) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6766, %e1_6767, %e2_6768 = cute.get_leaves(%2407) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_6769 = cute.size(%grouped_6745) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6770 = cute.get_leaves(%sz_6769) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_6771 = cute.size(%grouped_6758) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6772 = cute.get_leaves(%sz_6771) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_6745, %grouped_6758) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_6773 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc448)
        %slice_6774 = cute.slice(%frg_A, %coord_6773) : !memref_rmem_bf16_, !cute.coord<"(_,_,1)"> loc(#loc448)
        %iter_6775 = cute.get_iter(%slice_6774) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_6776 = cute.get_iter(%slice_6774) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_6777 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc449)
        %slice_6778 = cute.slice(%frg_B, %coord_6777) : !memref_rmem_bf16_1, !cute.coord<"(_,_,1)"> loc(#loc449)
        %iter_6779 = cute.get_iter(%slice_6778) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_6780 = cute.get_iter(%slice_6778) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_6781 = cute.get_layout(%slice_6774) : !memref_rmem_bf16_10 loc(#loc311)
        %2408 = cute.get_shape(%lay_6781) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_6782, %e1_6783, %e2_6784, %e3_6785 = cute.get_leaves(%2408) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_6786 = cute.get_layout(%slice_6778) : !memref_rmem_bf16_11 loc(#loc311)
        %2409 = cute.get_shape(%lay_6786) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_6787, %e1_6788, %e2_6789 = cute.get_leaves(%2409) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_6774, %slice_6778, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_6790 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_6791 = cute.size(%int_tuple_6790) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_6792 = cute.get_leaves(%sz_6791) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_6793 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc442)
        %slice_6794 = cute.slice(%src_partitioned_320, %coord_6793) : !memref_smem_bf16_8, !cute.coord<"(_,_,3)"> loc(#loc442)
        %iter_6795 = cute.get_iter(%slice_6794) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6796 = cute.get_iter(%slice_6794) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6797 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc443)
        %slice_6798 = cute.slice(%retiled, %coord_6797) : !memref_rmem_bf16_3, !cute.coord<"(_,_,3)"> loc(#loc443)
        %iter_6799 = cute.get_iter(%slice_6798) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_6800 = cute.get_iter(%slice_6798) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_6801 = cute.get_layout(%slice_6794) : !memref_smem_bf16_13 loc(#loc311)
        %2410 = cute.get_shape(%lay_6801) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6802, %e1_6803, %e2_6804 = cute.get_leaves(%2410) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6805 = cute.get_layout(%slice_6798) : !memref_rmem_bf16_6 loc(#loc311)
        %2411 = cute.get_shape(%lay_6805) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6806, %e1_6807, %e2_6808 = cute.get_leaves(%2411) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6809 = cute.get_layout(%slice_6794) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6810 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6811 = cute.make_layout(%shape_6810) : !cute.layout<"1:0"> loc(#loc397)
        %append_6812 = cute.append_to_rank<2> (%lay_6809, %lay_6811) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6813 = cute.make_view(%iter_6796, %append_6812) : !memref_smem_bf16_13 loc(#loc398)
        %iter_6814 = cute.get_iter(%view_6813) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6815 = cute.get_layout(%view_6813) : !memref_smem_bf16_13 loc(#loc311)
        %2412 = cute.get_shape(%lay_6815) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6816, %e1_6817, %e2_6818 = cute.get_leaves(%2412) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6819 = cute.group_modes(%view_6813) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_6820 = cute.get_iter(%grouped_6819) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6821 = cute.get_iter(%grouped_6819) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6822 = cute.get_layout(%slice_6798) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_6823 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6824 = cute.make_layout(%shape_6823) : !cute.layout<"1:0"> loc(#loc397)
        %append_6825 = cute.append_to_rank<2> (%lay_6822, %lay_6824) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6826 = cute.make_view(%iter_6800, %append_6825) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_6827 = cute.get_iter(%view_6826) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_6828 = cute.get_layout(%view_6826) : !memref_rmem_bf16_6 loc(#loc311)
        %2413 = cute.get_shape(%lay_6828) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6829, %e1_6830, %e2_6831 = cute.get_leaves(%2413) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6832 = cute.group_modes(%view_6826) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_6833 = cute.get_iter(%grouped_6832) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_6834 = cute.get_iter(%grouped_6832) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_6835 = cute.get_layout(%grouped_6819) : !memref_smem_bf16_14 loc(#loc311)
        %2414 = cute.get_shape(%lay_6835) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6836, %e1_6837, %e2_6838 = cute.get_leaves(%2414) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6839 = cute.get_layout(%grouped_6832) : !memref_rmem_bf16_7 loc(#loc311)
        %2415 = cute.get_shape(%lay_6839) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6840, %e1_6841, %e2_6842 = cute.get_leaves(%2415) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6843 = cute.size(%grouped_6819) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6844 = cute.get_leaves(%sz_6843) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6845 = cute.size(%grouped_6832) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6846 = cute.get_leaves(%sz_6845) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_6819, %grouped_6832) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_6847 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc445)
        %slice_6848 = cute.slice(%src_partitioned_324, %coord_6847) : !memref_smem_bf16_9, !cute.coord<"(_,_,3)"> loc(#loc445)
        %iter_6849 = cute.get_iter(%slice_6848) : !memref_smem_bf16_16 loc(#loc316)
        %iter_6850 = cute.get_iter(%slice_6848) : !memref_smem_bf16_16 loc(#loc317)
        %coord_6851 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc446)
        %slice_6852 = cute.slice(%retiled_326, %coord_6851) : !memref_rmem_bf16_4, !cute.coord<"(_,_,3)"> loc(#loc446)
        %iter_6853 = cute.get_iter(%slice_6852) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_6854 = cute.get_iter(%slice_6852) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_6855 = cute.get_layout(%slice_6848) : !memref_smem_bf16_16 loc(#loc311)
        %2416 = cute.get_shape(%lay_6855) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6856, %e1_6857, %e2_6858 = cute.get_leaves(%2416) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6859 = cute.get_layout(%slice_6852) : !memref_rmem_bf16_8 loc(#loc311)
        %2417 = cute.get_shape(%lay_6859) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6860, %e1_6861, %e2_6862 = cute.get_leaves(%2417) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6863 = cute.get_layout(%slice_6848) : !memref_smem_bf16_16 loc(#loc397)
        %shape_6864 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6865 = cute.make_layout(%shape_6864) : !cute.layout<"1:0"> loc(#loc397)
        %append_6866 = cute.append_to_rank<2> (%lay_6863, %lay_6865) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6867 = cute.make_view(%iter_6850, %append_6866) : !memref_smem_bf16_16 loc(#loc398)
        %iter_6868 = cute.get_iter(%view_6867) : !memref_smem_bf16_16 loc(#loc331)
        %lay_6869 = cute.get_layout(%view_6867) : !memref_smem_bf16_16 loc(#loc311)
        %2418 = cute.get_shape(%lay_6869) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6870, %e1_6871, %e2_6872 = cute.get_leaves(%2418) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6873 = cute.group_modes(%view_6867) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_6874 = cute.get_iter(%grouped_6873) : !memref_smem_bf16_17 loc(#loc399)
        %iter_6875 = cute.get_iter(%grouped_6873) : !memref_smem_bf16_17 loc(#loc317)
        %lay_6876 = cute.get_layout(%slice_6852) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_6877 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6878 = cute.make_layout(%shape_6877) : !cute.layout<"1:0"> loc(#loc397)
        %append_6879 = cute.append_to_rank<2> (%lay_6876, %lay_6878) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6880 = cute.make_view(%iter_6854, %append_6879) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_6881 = cute.get_iter(%view_6880) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_6882 = cute.get_layout(%view_6880) : !memref_rmem_bf16_8 loc(#loc311)
        %2419 = cute.get_shape(%lay_6882) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6883, %e1_6884, %e2_6885 = cute.get_leaves(%2419) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_6886 = cute.group_modes(%view_6880) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_6887 = cute.get_iter(%grouped_6886) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_6888 = cute.get_iter(%grouped_6886) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_6889 = cute.get_layout(%grouped_6873) : !memref_smem_bf16_17 loc(#loc311)
        %2420 = cute.get_shape(%lay_6889) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6890, %e1_6891, %e2_6892 = cute.get_leaves(%2420) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_6893 = cute.get_layout(%grouped_6886) : !memref_rmem_bf16_9 loc(#loc311)
        %2421 = cute.get_shape(%lay_6893) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_6894, %e1_6895, %e2_6896 = cute.get_leaves(%2421) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_6897 = cute.size(%grouped_6873) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6898 = cute.get_leaves(%sz_6897) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_6899 = cute.size(%grouped_6886) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_6900 = cute.get_leaves(%sz_6899) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_6873, %grouped_6886) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_6901 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc448)
        %slice_6902 = cute.slice(%frg_A, %coord_6901) : !memref_rmem_bf16_, !cute.coord<"(_,_,2)"> loc(#loc448)
        %iter_6903 = cute.get_iter(%slice_6902) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_6904 = cute.get_iter(%slice_6902) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_6905 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc449)
        %slice_6906 = cute.slice(%frg_B, %coord_6905) : !memref_rmem_bf16_1, !cute.coord<"(_,_,2)"> loc(#loc449)
        %iter_6907 = cute.get_iter(%slice_6906) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_6908 = cute.get_iter(%slice_6906) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_6909 = cute.get_layout(%slice_6902) : !memref_rmem_bf16_10 loc(#loc311)
        %2422 = cute.get_shape(%lay_6909) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_6910, %e1_6911, %e2_6912, %e3_6913 = cute.get_leaves(%2422) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_6914 = cute.get_layout(%slice_6906) : !memref_rmem_bf16_11 loc(#loc311)
        %2423 = cute.get_shape(%lay_6914) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_6915, %e1_6916, %e2_6917 = cute.get_leaves(%2423) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_6902, %slice_6906, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_6918 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_6919 = cute.size(%int_tuple_6918) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_6920 = cute.get_leaves(%sz_6919) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_6921 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc442)
        %slice_6922 = cute.slice(%src_partitioned_320, %coord_6921) : !memref_smem_bf16_8, !cute.coord<"(_,_,4)"> loc(#loc442)
        %iter_6923 = cute.get_iter(%slice_6922) : !memref_smem_bf16_13 loc(#loc316)
        %iter_6924 = cute.get_iter(%slice_6922) : !memref_smem_bf16_13 loc(#loc317)
        %coord_6925 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc443)
        %slice_6926 = cute.slice(%retiled, %coord_6925) : !memref_rmem_bf16_3, !cute.coord<"(_,_,4)"> loc(#loc443)
        %iter_6927 = cute.get_iter(%slice_6926) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_6928 = cute.get_iter(%slice_6926) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_6929 = cute.get_layout(%slice_6922) : !memref_smem_bf16_13 loc(#loc311)
        %2424 = cute.get_shape(%lay_6929) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6930, %e1_6931, %e2_6932 = cute.get_leaves(%2424) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6933 = cute.get_layout(%slice_6926) : !memref_rmem_bf16_6 loc(#loc311)
        %2425 = cute.get_shape(%lay_6933) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6934, %e1_6935, %e2_6936 = cute.get_leaves(%2425) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6937 = cute.get_layout(%slice_6922) : !memref_smem_bf16_13 loc(#loc397)
        %shape_6938 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6939 = cute.make_layout(%shape_6938) : !cute.layout<"1:0"> loc(#loc397)
        %append_6940 = cute.append_to_rank<2> (%lay_6937, %lay_6939) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6941 = cute.make_view(%iter_6924, %append_6940) : !memref_smem_bf16_13 loc(#loc398)
        %iter_6942 = cute.get_iter(%view_6941) : !memref_smem_bf16_13 loc(#loc331)
        %lay_6943 = cute.get_layout(%view_6941) : !memref_smem_bf16_13 loc(#loc311)
        %2426 = cute.get_shape(%lay_6943) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6944, %e1_6945, %e2_6946 = cute.get_leaves(%2426) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6947 = cute.group_modes(%view_6941) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_6948 = cute.get_iter(%grouped_6947) : !memref_smem_bf16_14 loc(#loc399)
        %iter_6949 = cute.get_iter(%grouped_6947) : !memref_smem_bf16_14 loc(#loc317)
        %lay_6950 = cute.get_layout(%slice_6926) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_6951 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6952 = cute.make_layout(%shape_6951) : !cute.layout<"1:0"> loc(#loc397)
        %append_6953 = cute.append_to_rank<2> (%lay_6950, %lay_6952) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6954 = cute.make_view(%iter_6928, %append_6953) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_6955 = cute.get_iter(%view_6954) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_6956 = cute.get_layout(%view_6954) : !memref_rmem_bf16_6 loc(#loc311)
        %2427 = cute.get_shape(%lay_6956) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6957, %e1_6958, %e2_6959 = cute.get_leaves(%2427) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6960 = cute.group_modes(%view_6954) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_6961 = cute.get_iter(%grouped_6960) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_6962 = cute.get_iter(%grouped_6960) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_6963 = cute.get_layout(%grouped_6947) : !memref_smem_bf16_14 loc(#loc311)
        %2428 = cute.get_shape(%lay_6963) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6964, %e1_6965, %e2_6966 = cute.get_leaves(%2428) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6967 = cute.get_layout(%grouped_6960) : !memref_rmem_bf16_7 loc(#loc311)
        %2429 = cute.get_shape(%lay_6967) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6968, %e1_6969, %e2_6970 = cute.get_leaves(%2429) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6971 = cute.size(%grouped_6947) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6972 = cute.get_leaves(%sz_6971) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6973 = cute.size(%grouped_6960) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6974 = cute.get_leaves(%sz_6973) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_6947, %grouped_6960) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_6975 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc445)
        %slice_6976 = cute.slice(%src_partitioned_324, %coord_6975) : !memref_smem_bf16_9, !cute.coord<"(_,_,4)"> loc(#loc445)
        %iter_6977 = cute.get_iter(%slice_6976) : !memref_smem_bf16_16 loc(#loc316)
        %iter_6978 = cute.get_iter(%slice_6976) : !memref_smem_bf16_16 loc(#loc317)
        %coord_6979 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc446)
        %slice_6980 = cute.slice(%retiled_326, %coord_6979) : !memref_rmem_bf16_4, !cute.coord<"(_,_,4)"> loc(#loc446)
        %iter_6981 = cute.get_iter(%slice_6980) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_6982 = cute.get_iter(%slice_6980) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_6983 = cute.get_layout(%slice_6976) : !memref_smem_bf16_16 loc(#loc311)
        %2430 = cute.get_shape(%lay_6983) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6984, %e1_6985, %e2_6986 = cute.get_leaves(%2430) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6987 = cute.get_layout(%slice_6980) : !memref_rmem_bf16_8 loc(#loc311)
        %2431 = cute.get_shape(%lay_6987) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6988, %e1_6989, %e2_6990 = cute.get_leaves(%2431) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_6991 = cute.get_layout(%slice_6976) : !memref_smem_bf16_16 loc(#loc397)
        %shape_6992 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6993 = cute.make_layout(%shape_6992) : !cute.layout<"1:0"> loc(#loc397)
        %append_6994 = cute.append_to_rank<2> (%lay_6991, %lay_6993) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6995 = cute.make_view(%iter_6978, %append_6994) : !memref_smem_bf16_16 loc(#loc398)
        %iter_6996 = cute.get_iter(%view_6995) : !memref_smem_bf16_16 loc(#loc331)
        %lay_6997 = cute.get_layout(%view_6995) : !memref_smem_bf16_16 loc(#loc311)
        %2432 = cute.get_shape(%lay_6997) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_6998, %e1_6999, %e2_7000 = cute.get_leaves(%2432) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7001 = cute.group_modes(%view_6995) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_7002 = cute.get_iter(%grouped_7001) : !memref_smem_bf16_17 loc(#loc399)
        %iter_7003 = cute.get_iter(%grouped_7001) : !memref_smem_bf16_17 loc(#loc317)
        %lay_7004 = cute.get_layout(%slice_6980) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_7005 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7006 = cute.make_layout(%shape_7005) : !cute.layout<"1:0"> loc(#loc397)
        %append_7007 = cute.append_to_rank<2> (%lay_7004, %lay_7006) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7008 = cute.make_view(%iter_6982, %append_7007) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_7009 = cute.get_iter(%view_7008) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_7010 = cute.get_layout(%view_7008) : !memref_rmem_bf16_8 loc(#loc311)
        %2433 = cute.get_shape(%lay_7010) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7011, %e1_7012, %e2_7013 = cute.get_leaves(%2433) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7014 = cute.group_modes(%view_7008) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_7015 = cute.get_iter(%grouped_7014) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_7016 = cute.get_iter(%grouped_7014) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_7017 = cute.get_layout(%grouped_7001) : !memref_smem_bf16_17 loc(#loc311)
        %2434 = cute.get_shape(%lay_7017) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7018, %e1_7019, %e2_7020 = cute.get_leaves(%2434) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_7021 = cute.get_layout(%grouped_7014) : !memref_rmem_bf16_9 loc(#loc311)
        %2435 = cute.get_shape(%lay_7021) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7022, %e1_7023, %e2_7024 = cute.get_leaves(%2435) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_7025 = cute.size(%grouped_7001) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7026 = cute.get_leaves(%sz_7025) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_7027 = cute.size(%grouped_7014) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7028 = cute.get_leaves(%sz_7027) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_7001, %grouped_7014) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_7029 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc448)
        %slice_7030 = cute.slice(%frg_A, %coord_7029) : !memref_rmem_bf16_, !cute.coord<"(_,_,3)"> loc(#loc448)
        %iter_7031 = cute.get_iter(%slice_7030) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_7032 = cute.get_iter(%slice_7030) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_7033 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc449)
        %slice_7034 = cute.slice(%frg_B, %coord_7033) : !memref_rmem_bf16_1, !cute.coord<"(_,_,3)"> loc(#loc449)
        %iter_7035 = cute.get_iter(%slice_7034) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_7036 = cute.get_iter(%slice_7034) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_7037 = cute.get_layout(%slice_7030) : !memref_rmem_bf16_10 loc(#loc311)
        %2436 = cute.get_shape(%lay_7037) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_7038, %e1_7039, %e2_7040, %e3_7041 = cute.get_leaves(%2436) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_7042 = cute.get_layout(%slice_7034) : !memref_rmem_bf16_11 loc(#loc311)
        %2437 = cute.get_shape(%lay_7042) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_7043, %e1_7044, %e2_7045 = cute.get_leaves(%2437) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_7030, %slice_7034, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_7046 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_7047 = cute.size(%int_tuple_7046) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_7048 = cute.get_leaves(%sz_7047) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_7049 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc442)
        %slice_7050 = cute.slice(%src_partitioned_320, %coord_7049) : !memref_smem_bf16_8, !cute.coord<"(_,_,5)"> loc(#loc442)
        %iter_7051 = cute.get_iter(%slice_7050) : !memref_smem_bf16_13 loc(#loc316)
        %iter_7052 = cute.get_iter(%slice_7050) : !memref_smem_bf16_13 loc(#loc317)
        %coord_7053 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc443)
        %slice_7054 = cute.slice(%retiled, %coord_7053) : !memref_rmem_bf16_3, !cute.coord<"(_,_,5)"> loc(#loc443)
        %iter_7055 = cute.get_iter(%slice_7054) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_7056 = cute.get_iter(%slice_7054) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_7057 = cute.get_layout(%slice_7050) : !memref_smem_bf16_13 loc(#loc311)
        %2438 = cute.get_shape(%lay_7057) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7058, %e1_7059, %e2_7060 = cute.get_leaves(%2438) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7061 = cute.get_layout(%slice_7054) : !memref_rmem_bf16_6 loc(#loc311)
        %2439 = cute.get_shape(%lay_7061) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7062, %e1_7063, %e2_7064 = cute.get_leaves(%2439) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7065 = cute.get_layout(%slice_7050) : !memref_smem_bf16_13 loc(#loc397)
        %shape_7066 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7067 = cute.make_layout(%shape_7066) : !cute.layout<"1:0"> loc(#loc397)
        %append_7068 = cute.append_to_rank<2> (%lay_7065, %lay_7067) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7069 = cute.make_view(%iter_7052, %append_7068) : !memref_smem_bf16_13 loc(#loc398)
        %iter_7070 = cute.get_iter(%view_7069) : !memref_smem_bf16_13 loc(#loc331)
        %lay_7071 = cute.get_layout(%view_7069) : !memref_smem_bf16_13 loc(#loc311)
        %2440 = cute.get_shape(%lay_7071) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7072, %e1_7073, %e2_7074 = cute.get_leaves(%2440) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7075 = cute.group_modes(%view_7069) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_7076 = cute.get_iter(%grouped_7075) : !memref_smem_bf16_14 loc(#loc399)
        %iter_7077 = cute.get_iter(%grouped_7075) : !memref_smem_bf16_14 loc(#loc317)
        %lay_7078 = cute.get_layout(%slice_7054) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_7079 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7080 = cute.make_layout(%shape_7079) : !cute.layout<"1:0"> loc(#loc397)
        %append_7081 = cute.append_to_rank<2> (%lay_7078, %lay_7080) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7082 = cute.make_view(%iter_7056, %append_7081) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_7083 = cute.get_iter(%view_7082) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_7084 = cute.get_layout(%view_7082) : !memref_rmem_bf16_6 loc(#loc311)
        %2441 = cute.get_shape(%lay_7084) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7085, %e1_7086, %e2_7087 = cute.get_leaves(%2441) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7088 = cute.group_modes(%view_7082) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_7089 = cute.get_iter(%grouped_7088) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_7090 = cute.get_iter(%grouped_7088) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_7091 = cute.get_layout(%grouped_7075) : !memref_smem_bf16_14 loc(#loc311)
        %2442 = cute.get_shape(%lay_7091) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7092, %e1_7093, %e2_7094 = cute.get_leaves(%2442) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_7095 = cute.get_layout(%grouped_7088) : !memref_rmem_bf16_7 loc(#loc311)
        %2443 = cute.get_shape(%lay_7095) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7096, %e1_7097, %e2_7098 = cute.get_leaves(%2443) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_7099 = cute.size(%grouped_7075) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7100 = cute.get_leaves(%sz_7099) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_7101 = cute.size(%grouped_7088) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7102 = cute.get_leaves(%sz_7101) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_7075, %grouped_7088) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_7103 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc445)
        %slice_7104 = cute.slice(%src_partitioned_324, %coord_7103) : !memref_smem_bf16_9, !cute.coord<"(_,_,5)"> loc(#loc445)
        %iter_7105 = cute.get_iter(%slice_7104) : !memref_smem_bf16_16 loc(#loc316)
        %iter_7106 = cute.get_iter(%slice_7104) : !memref_smem_bf16_16 loc(#loc317)
        %coord_7107 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc446)
        %slice_7108 = cute.slice(%retiled_326, %coord_7107) : !memref_rmem_bf16_4, !cute.coord<"(_,_,5)"> loc(#loc446)
        %iter_7109 = cute.get_iter(%slice_7108) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_7110 = cute.get_iter(%slice_7108) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_7111 = cute.get_layout(%slice_7104) : !memref_smem_bf16_16 loc(#loc311)
        %2444 = cute.get_shape(%lay_7111) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7112, %e1_7113, %e2_7114 = cute.get_leaves(%2444) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7115 = cute.get_layout(%slice_7108) : !memref_rmem_bf16_8 loc(#loc311)
        %2445 = cute.get_shape(%lay_7115) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7116, %e1_7117, %e2_7118 = cute.get_leaves(%2445) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7119 = cute.get_layout(%slice_7104) : !memref_smem_bf16_16 loc(#loc397)
        %shape_7120 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7121 = cute.make_layout(%shape_7120) : !cute.layout<"1:0"> loc(#loc397)
        %append_7122 = cute.append_to_rank<2> (%lay_7119, %lay_7121) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7123 = cute.make_view(%iter_7106, %append_7122) : !memref_smem_bf16_16 loc(#loc398)
        %iter_7124 = cute.get_iter(%view_7123) : !memref_smem_bf16_16 loc(#loc331)
        %lay_7125 = cute.get_layout(%view_7123) : !memref_smem_bf16_16 loc(#loc311)
        %2446 = cute.get_shape(%lay_7125) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7126, %e1_7127, %e2_7128 = cute.get_leaves(%2446) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7129 = cute.group_modes(%view_7123) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_7130 = cute.get_iter(%grouped_7129) : !memref_smem_bf16_17 loc(#loc399)
        %iter_7131 = cute.get_iter(%grouped_7129) : !memref_smem_bf16_17 loc(#loc317)
        %lay_7132 = cute.get_layout(%slice_7108) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_7133 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7134 = cute.make_layout(%shape_7133) : !cute.layout<"1:0"> loc(#loc397)
        %append_7135 = cute.append_to_rank<2> (%lay_7132, %lay_7134) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7136 = cute.make_view(%iter_7110, %append_7135) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_7137 = cute.get_iter(%view_7136) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_7138 = cute.get_layout(%view_7136) : !memref_rmem_bf16_8 loc(#loc311)
        %2447 = cute.get_shape(%lay_7138) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7139, %e1_7140, %e2_7141 = cute.get_leaves(%2447) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7142 = cute.group_modes(%view_7136) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_7143 = cute.get_iter(%grouped_7142) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_7144 = cute.get_iter(%grouped_7142) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_7145 = cute.get_layout(%grouped_7129) : !memref_smem_bf16_17 loc(#loc311)
        %2448 = cute.get_shape(%lay_7145) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7146, %e1_7147, %e2_7148 = cute.get_leaves(%2448) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_7149 = cute.get_layout(%grouped_7142) : !memref_rmem_bf16_9 loc(#loc311)
        %2449 = cute.get_shape(%lay_7149) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7150, %e1_7151, %e2_7152 = cute.get_leaves(%2449) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_7153 = cute.size(%grouped_7129) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7154 = cute.get_leaves(%sz_7153) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_7155 = cute.size(%grouped_7142) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7156 = cute.get_leaves(%sz_7155) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_7129, %grouped_7142) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_7157 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc448)
        %slice_7158 = cute.slice(%frg_A, %coord_7157) : !memref_rmem_bf16_, !cute.coord<"(_,_,4)"> loc(#loc448)
        %iter_7159 = cute.get_iter(%slice_7158) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_7160 = cute.get_iter(%slice_7158) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_7161 = cute.make_coord() : () -> !cute.coord<"(_,_,4)"> loc(#loc449)
        %slice_7162 = cute.slice(%frg_B, %coord_7161) : !memref_rmem_bf16_1, !cute.coord<"(_,_,4)"> loc(#loc449)
        %iter_7163 = cute.get_iter(%slice_7162) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_7164 = cute.get_iter(%slice_7162) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_7165 = cute.get_layout(%slice_7158) : !memref_rmem_bf16_10 loc(#loc311)
        %2450 = cute.get_shape(%lay_7165) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_7166, %e1_7167, %e2_7168, %e3_7169 = cute.get_leaves(%2450) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_7170 = cute.get_layout(%slice_7162) : !memref_rmem_bf16_11 loc(#loc311)
        %2451 = cute.get_shape(%lay_7170) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_7171, %e1_7172, %e2_7173 = cute.get_leaves(%2451) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_7158, %slice_7162, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_7174 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_7175 = cute.size(%int_tuple_7174) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_7176 = cute.get_leaves(%sz_7175) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_7177 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc442)
        %slice_7178 = cute.slice(%src_partitioned_320, %coord_7177) : !memref_smem_bf16_8, !cute.coord<"(_,_,6)"> loc(#loc442)
        %iter_7179 = cute.get_iter(%slice_7178) : !memref_smem_bf16_13 loc(#loc316)
        %iter_7180 = cute.get_iter(%slice_7178) : !memref_smem_bf16_13 loc(#loc317)
        %coord_7181 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc443)
        %slice_7182 = cute.slice(%retiled, %coord_7181) : !memref_rmem_bf16_3, !cute.coord<"(_,_,6)"> loc(#loc443)
        %iter_7183 = cute.get_iter(%slice_7182) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_7184 = cute.get_iter(%slice_7182) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_7185 = cute.get_layout(%slice_7178) : !memref_smem_bf16_13 loc(#loc311)
        %2452 = cute.get_shape(%lay_7185) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7186, %e1_7187, %e2_7188 = cute.get_leaves(%2452) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7189 = cute.get_layout(%slice_7182) : !memref_rmem_bf16_6 loc(#loc311)
        %2453 = cute.get_shape(%lay_7189) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7190, %e1_7191, %e2_7192 = cute.get_leaves(%2453) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7193 = cute.get_layout(%slice_7178) : !memref_smem_bf16_13 loc(#loc397)
        %shape_7194 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7195 = cute.make_layout(%shape_7194) : !cute.layout<"1:0"> loc(#loc397)
        %append_7196 = cute.append_to_rank<2> (%lay_7193, %lay_7195) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7197 = cute.make_view(%iter_7180, %append_7196) : !memref_smem_bf16_13 loc(#loc398)
        %iter_7198 = cute.get_iter(%view_7197) : !memref_smem_bf16_13 loc(#loc331)
        %lay_7199 = cute.get_layout(%view_7197) : !memref_smem_bf16_13 loc(#loc311)
        %2454 = cute.get_shape(%lay_7199) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7200, %e1_7201, %e2_7202 = cute.get_leaves(%2454) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7203 = cute.group_modes(%view_7197) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_7204 = cute.get_iter(%grouped_7203) : !memref_smem_bf16_14 loc(#loc399)
        %iter_7205 = cute.get_iter(%grouped_7203) : !memref_smem_bf16_14 loc(#loc317)
        %lay_7206 = cute.get_layout(%slice_7182) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_7207 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7208 = cute.make_layout(%shape_7207) : !cute.layout<"1:0"> loc(#loc397)
        %append_7209 = cute.append_to_rank<2> (%lay_7206, %lay_7208) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7210 = cute.make_view(%iter_7184, %append_7209) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_7211 = cute.get_iter(%view_7210) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_7212 = cute.get_layout(%view_7210) : !memref_rmem_bf16_6 loc(#loc311)
        %2455 = cute.get_shape(%lay_7212) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7213, %e1_7214, %e2_7215 = cute.get_leaves(%2455) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7216 = cute.group_modes(%view_7210) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_7217 = cute.get_iter(%grouped_7216) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_7218 = cute.get_iter(%grouped_7216) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_7219 = cute.get_layout(%grouped_7203) : !memref_smem_bf16_14 loc(#loc311)
        %2456 = cute.get_shape(%lay_7219) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7220, %e1_7221, %e2_7222 = cute.get_leaves(%2456) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_7223 = cute.get_layout(%grouped_7216) : !memref_rmem_bf16_7 loc(#loc311)
        %2457 = cute.get_shape(%lay_7223) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7224, %e1_7225, %e2_7226 = cute.get_leaves(%2457) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_7227 = cute.size(%grouped_7203) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7228 = cute.get_leaves(%sz_7227) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_7229 = cute.size(%grouped_7216) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7230 = cute.get_leaves(%sz_7229) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_7203, %grouped_7216) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_7231 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc445)
        %slice_7232 = cute.slice(%src_partitioned_324, %coord_7231) : !memref_smem_bf16_9, !cute.coord<"(_,_,6)"> loc(#loc445)
        %iter_7233 = cute.get_iter(%slice_7232) : !memref_smem_bf16_16 loc(#loc316)
        %iter_7234 = cute.get_iter(%slice_7232) : !memref_smem_bf16_16 loc(#loc317)
        %coord_7235 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc446)
        %slice_7236 = cute.slice(%retiled_326, %coord_7235) : !memref_rmem_bf16_4, !cute.coord<"(_,_,6)"> loc(#loc446)
        %iter_7237 = cute.get_iter(%slice_7236) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_7238 = cute.get_iter(%slice_7236) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_7239 = cute.get_layout(%slice_7232) : !memref_smem_bf16_16 loc(#loc311)
        %2458 = cute.get_shape(%lay_7239) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7240, %e1_7241, %e2_7242 = cute.get_leaves(%2458) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7243 = cute.get_layout(%slice_7236) : !memref_rmem_bf16_8 loc(#loc311)
        %2459 = cute.get_shape(%lay_7243) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7244, %e1_7245, %e2_7246 = cute.get_leaves(%2459) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7247 = cute.get_layout(%slice_7232) : !memref_smem_bf16_16 loc(#loc397)
        %shape_7248 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7249 = cute.make_layout(%shape_7248) : !cute.layout<"1:0"> loc(#loc397)
        %append_7250 = cute.append_to_rank<2> (%lay_7247, %lay_7249) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7251 = cute.make_view(%iter_7234, %append_7250) : !memref_smem_bf16_16 loc(#loc398)
        %iter_7252 = cute.get_iter(%view_7251) : !memref_smem_bf16_16 loc(#loc331)
        %lay_7253 = cute.get_layout(%view_7251) : !memref_smem_bf16_16 loc(#loc311)
        %2460 = cute.get_shape(%lay_7253) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7254, %e1_7255, %e2_7256 = cute.get_leaves(%2460) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7257 = cute.group_modes(%view_7251) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_7258 = cute.get_iter(%grouped_7257) : !memref_smem_bf16_17 loc(#loc399)
        %iter_7259 = cute.get_iter(%grouped_7257) : !memref_smem_bf16_17 loc(#loc317)
        %lay_7260 = cute.get_layout(%slice_7236) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_7261 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7262 = cute.make_layout(%shape_7261) : !cute.layout<"1:0"> loc(#loc397)
        %append_7263 = cute.append_to_rank<2> (%lay_7260, %lay_7262) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7264 = cute.make_view(%iter_7238, %append_7263) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_7265 = cute.get_iter(%view_7264) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_7266 = cute.get_layout(%view_7264) : !memref_rmem_bf16_8 loc(#loc311)
        %2461 = cute.get_shape(%lay_7266) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7267, %e1_7268, %e2_7269 = cute.get_leaves(%2461) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7270 = cute.group_modes(%view_7264) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_7271 = cute.get_iter(%grouped_7270) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_7272 = cute.get_iter(%grouped_7270) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_7273 = cute.get_layout(%grouped_7257) : !memref_smem_bf16_17 loc(#loc311)
        %2462 = cute.get_shape(%lay_7273) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7274, %e1_7275, %e2_7276 = cute.get_leaves(%2462) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_7277 = cute.get_layout(%grouped_7270) : !memref_rmem_bf16_9 loc(#loc311)
        %2463 = cute.get_shape(%lay_7277) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7278, %e1_7279, %e2_7280 = cute.get_leaves(%2463) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_7281 = cute.size(%grouped_7257) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7282 = cute.get_leaves(%sz_7281) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_7283 = cute.size(%grouped_7270) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7284 = cute.get_leaves(%sz_7283) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_7257, %grouped_7270) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_7285 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc448)
        %slice_7286 = cute.slice(%frg_A, %coord_7285) : !memref_rmem_bf16_, !cute.coord<"(_,_,5)"> loc(#loc448)
        %iter_7287 = cute.get_iter(%slice_7286) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_7288 = cute.get_iter(%slice_7286) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_7289 = cute.make_coord() : () -> !cute.coord<"(_,_,5)"> loc(#loc449)
        %slice_7290 = cute.slice(%frg_B, %coord_7289) : !memref_rmem_bf16_1, !cute.coord<"(_,_,5)"> loc(#loc449)
        %iter_7291 = cute.get_iter(%slice_7290) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_7292 = cute.get_iter(%slice_7290) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_7293 = cute.get_layout(%slice_7286) : !memref_rmem_bf16_10 loc(#loc311)
        %2464 = cute.get_shape(%lay_7293) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_7294, %e1_7295, %e2_7296, %e3_7297 = cute.get_leaves(%2464) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_7298 = cute.get_layout(%slice_7290) : !memref_rmem_bf16_11 loc(#loc311)
        %2465 = cute.get_shape(%lay_7298) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_7299, %e1_7300, %e2_7301 = cute.get_leaves(%2465) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_7286, %slice_7290, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_7302 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_7303 = cute.size(%int_tuple_7302) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_7304 = cute.get_leaves(%sz_7303) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_7305 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc442)
        %slice_7306 = cute.slice(%src_partitioned_320, %coord_7305) : !memref_smem_bf16_8, !cute.coord<"(_,_,7)"> loc(#loc442)
        %iter_7307 = cute.get_iter(%slice_7306) : !memref_smem_bf16_13 loc(#loc316)
        %iter_7308 = cute.get_iter(%slice_7306) : !memref_smem_bf16_13 loc(#loc317)
        %coord_7309 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc443)
        %slice_7310 = cute.slice(%retiled, %coord_7309) : !memref_rmem_bf16_3, !cute.coord<"(_,_,7)"> loc(#loc443)
        %iter_7311 = cute.get_iter(%slice_7310) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_7312 = cute.get_iter(%slice_7310) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_7313 = cute.get_layout(%slice_7306) : !memref_smem_bf16_13 loc(#loc311)
        %2466 = cute.get_shape(%lay_7313) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7314, %e1_7315, %e2_7316 = cute.get_leaves(%2466) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7317 = cute.get_layout(%slice_7310) : !memref_rmem_bf16_6 loc(#loc311)
        %2467 = cute.get_shape(%lay_7317) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7318, %e1_7319, %e2_7320 = cute.get_leaves(%2467) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7321 = cute.get_layout(%slice_7306) : !memref_smem_bf16_13 loc(#loc397)
        %shape_7322 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7323 = cute.make_layout(%shape_7322) : !cute.layout<"1:0"> loc(#loc397)
        %append_7324 = cute.append_to_rank<2> (%lay_7321, %lay_7323) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7325 = cute.make_view(%iter_7308, %append_7324) : !memref_smem_bf16_13 loc(#loc398)
        %iter_7326 = cute.get_iter(%view_7325) : !memref_smem_bf16_13 loc(#loc331)
        %lay_7327 = cute.get_layout(%view_7325) : !memref_smem_bf16_13 loc(#loc311)
        %2468 = cute.get_shape(%lay_7327) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7328, %e1_7329, %e2_7330 = cute.get_leaves(%2468) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7331 = cute.group_modes(%view_7325) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_7332 = cute.get_iter(%grouped_7331) : !memref_smem_bf16_14 loc(#loc399)
        %iter_7333 = cute.get_iter(%grouped_7331) : !memref_smem_bf16_14 loc(#loc317)
        %lay_7334 = cute.get_layout(%slice_7310) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_7335 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7336 = cute.make_layout(%shape_7335) : !cute.layout<"1:0"> loc(#loc397)
        %append_7337 = cute.append_to_rank<2> (%lay_7334, %lay_7336) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7338 = cute.make_view(%iter_7312, %append_7337) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_7339 = cute.get_iter(%view_7338) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_7340 = cute.get_layout(%view_7338) : !memref_rmem_bf16_6 loc(#loc311)
        %2469 = cute.get_shape(%lay_7340) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7341, %e1_7342, %e2_7343 = cute.get_leaves(%2469) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7344 = cute.group_modes(%view_7338) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_7345 = cute.get_iter(%grouped_7344) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_7346 = cute.get_iter(%grouped_7344) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_7347 = cute.get_layout(%grouped_7331) : !memref_smem_bf16_14 loc(#loc311)
        %2470 = cute.get_shape(%lay_7347) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7348, %e1_7349, %e2_7350 = cute.get_leaves(%2470) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_7351 = cute.get_layout(%grouped_7344) : !memref_rmem_bf16_7 loc(#loc311)
        %2471 = cute.get_shape(%lay_7351) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7352, %e1_7353, %e2_7354 = cute.get_leaves(%2471) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_7355 = cute.size(%grouped_7331) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7356 = cute.get_leaves(%sz_7355) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_7357 = cute.size(%grouped_7344) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7358 = cute.get_leaves(%sz_7357) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_7331, %grouped_7344) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_7359 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc445)
        %slice_7360 = cute.slice(%src_partitioned_324, %coord_7359) : !memref_smem_bf16_9, !cute.coord<"(_,_,7)"> loc(#loc445)
        %iter_7361 = cute.get_iter(%slice_7360) : !memref_smem_bf16_16 loc(#loc316)
        %iter_7362 = cute.get_iter(%slice_7360) : !memref_smem_bf16_16 loc(#loc317)
        %coord_7363 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc446)
        %slice_7364 = cute.slice(%retiled_326, %coord_7363) : !memref_rmem_bf16_4, !cute.coord<"(_,_,7)"> loc(#loc446)
        %iter_7365 = cute.get_iter(%slice_7364) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_7366 = cute.get_iter(%slice_7364) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_7367 = cute.get_layout(%slice_7360) : !memref_smem_bf16_16 loc(#loc311)
        %2472 = cute.get_shape(%lay_7367) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7368, %e1_7369, %e2_7370 = cute.get_leaves(%2472) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7371 = cute.get_layout(%slice_7364) : !memref_rmem_bf16_8 loc(#loc311)
        %2473 = cute.get_shape(%lay_7371) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7372, %e1_7373, %e2_7374 = cute.get_leaves(%2473) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7375 = cute.get_layout(%slice_7360) : !memref_smem_bf16_16 loc(#loc397)
        %shape_7376 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7377 = cute.make_layout(%shape_7376) : !cute.layout<"1:0"> loc(#loc397)
        %append_7378 = cute.append_to_rank<2> (%lay_7375, %lay_7377) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7379 = cute.make_view(%iter_7362, %append_7378) : !memref_smem_bf16_16 loc(#loc398)
        %iter_7380 = cute.get_iter(%view_7379) : !memref_smem_bf16_16 loc(#loc331)
        %lay_7381 = cute.get_layout(%view_7379) : !memref_smem_bf16_16 loc(#loc311)
        %2474 = cute.get_shape(%lay_7381) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7382, %e1_7383, %e2_7384 = cute.get_leaves(%2474) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7385 = cute.group_modes(%view_7379) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_7386 = cute.get_iter(%grouped_7385) : !memref_smem_bf16_17 loc(#loc399)
        %iter_7387 = cute.get_iter(%grouped_7385) : !memref_smem_bf16_17 loc(#loc317)
        %lay_7388 = cute.get_layout(%slice_7364) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_7389 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7390 = cute.make_layout(%shape_7389) : !cute.layout<"1:0"> loc(#loc397)
        %append_7391 = cute.append_to_rank<2> (%lay_7388, %lay_7390) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7392 = cute.make_view(%iter_7366, %append_7391) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_7393 = cute.get_iter(%view_7392) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_7394 = cute.get_layout(%view_7392) : !memref_rmem_bf16_8 loc(#loc311)
        %2475 = cute.get_shape(%lay_7394) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7395, %e1_7396, %e2_7397 = cute.get_leaves(%2475) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7398 = cute.group_modes(%view_7392) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_7399 = cute.get_iter(%grouped_7398) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_7400 = cute.get_iter(%grouped_7398) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_7401 = cute.get_layout(%grouped_7385) : !memref_smem_bf16_17 loc(#loc311)
        %2476 = cute.get_shape(%lay_7401) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7402, %e1_7403, %e2_7404 = cute.get_leaves(%2476) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_7405 = cute.get_layout(%grouped_7398) : !memref_rmem_bf16_9 loc(#loc311)
        %2477 = cute.get_shape(%lay_7405) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7406, %e1_7407, %e2_7408 = cute.get_leaves(%2477) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_7409 = cute.size(%grouped_7385) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7410 = cute.get_leaves(%sz_7409) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_7411 = cute.size(%grouped_7398) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7412 = cute.get_leaves(%sz_7411) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_7385, %grouped_7398) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_7413 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc448)
        %slice_7414 = cute.slice(%frg_A, %coord_7413) : !memref_rmem_bf16_, !cute.coord<"(_,_,6)"> loc(#loc448)
        %iter_7415 = cute.get_iter(%slice_7414) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_7416 = cute.get_iter(%slice_7414) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_7417 = cute.make_coord() : () -> !cute.coord<"(_,_,6)"> loc(#loc449)
        %slice_7418 = cute.slice(%frg_B, %coord_7417) : !memref_rmem_bf16_1, !cute.coord<"(_,_,6)"> loc(#loc449)
        %iter_7419 = cute.get_iter(%slice_7418) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_7420 = cute.get_iter(%slice_7418) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_7421 = cute.get_layout(%slice_7414) : !memref_rmem_bf16_10 loc(#loc311)
        %2478 = cute.get_shape(%lay_7421) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_7422, %e1_7423, %e2_7424, %e3_7425 = cute.get_leaves(%2478) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_7426 = cute.get_layout(%slice_7418) : !memref_rmem_bf16_11 loc(#loc311)
        %2479 = cute.get_shape(%lay_7426) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_7427, %e1_7428, %e2_7429 = cute.get_leaves(%2479) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_7414, %slice_7418, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        %int_tuple_7430 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2)"> loc(#loc441)
        %sz_7431 = cute.size(%int_tuple_7430) : (!cute.int_tuple<"((2,2),2)">) -> !cute.int_tuple<"8"> loc(#loc441)
        %e0_7432 = cute.get_leaves(%sz_7431) : !cute.int_tuple<"8"> loc(#loc441)
        %coord_7433 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc442)
        %slice_7434 = cute.slice(%src_partitioned_320, %coord_7433) : !memref_smem_bf16_8, !cute.coord<"(_,_,0)"> loc(#loc442)
        %iter_7435 = cute.get_iter(%slice_7434) : !memref_smem_bf16_13 loc(#loc316)
        %iter_7436 = cute.get_iter(%slice_7434) : !memref_smem_bf16_13 loc(#loc317)
        %coord_7437 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc443)
        %slice_7438 = cute.slice(%retiled, %coord_7437) : !memref_rmem_bf16_3, !cute.coord<"(_,_,0)"> loc(#loc443)
        %iter_7439 = cute.get_iter(%slice_7438) : !memref_rmem_bf16_6 loc(#loc316)
        %iter_7440 = cute.get_iter(%slice_7438) : !memref_rmem_bf16_6 loc(#loc317)
        %lay_7441 = cute.get_layout(%slice_7434) : !memref_smem_bf16_13 loc(#loc311)
        %2480 = cute.get_shape(%lay_7441) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7442, %e1_7443, %e2_7444 = cute.get_leaves(%2480) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7445 = cute.get_layout(%slice_7438) : !memref_rmem_bf16_6 loc(#loc311)
        %2481 = cute.get_shape(%lay_7445) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7446, %e1_7447, %e2_7448 = cute.get_leaves(%2481) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_7449 = cute.get_layout(%slice_7434) : !memref_smem_bf16_13 loc(#loc397)
        %shape_7450 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7451 = cute.make_layout(%shape_7450) : !cute.layout<"1:0"> loc(#loc397)
        %append_7452 = cute.append_to_rank<2> (%lay_7449, %lay_7451) : !cute.layout<"((8,1),2):((1,0),4096)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7453 = cute.make_view(%iter_7436, %append_7452) : !memref_smem_bf16_13 loc(#loc398)
        %iter_7454 = cute.get_iter(%view_7453) : !memref_smem_bf16_13 loc(#loc331)
        %lay_7455 = cute.get_layout(%view_7453) : !memref_smem_bf16_13 loc(#loc311)
        %2482 = cute.get_shape(%lay_7455) : (!cute.layout<"((8,1),2):((1,0),4096)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7456, %e1_7457, %e2_7458 = cute.get_leaves(%2482) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7459 = cute.group_modes(%view_7453) <1, 2> : (!memref_smem_bf16_13) -> !memref_smem_bf16_14 loc(#loc398)
        %iter_7460 = cute.get_iter(%grouped_7459) : !memref_smem_bf16_14 loc(#loc399)
        %iter_7461 = cute.get_iter(%grouped_7459) : !memref_smem_bf16_14 loc(#loc317)
        %lay_7462 = cute.get_layout(%slice_7438) : !memref_rmem_bf16_6 loc(#loc397)
        %shape_7463 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7464 = cute.make_layout(%shape_7463) : !cute.layout<"1:0"> loc(#loc397)
        %append_7465 = cute.append_to_rank<2> (%lay_7462, %lay_7464) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7466 = cute.make_view(%iter_7440, %append_7465) : !memref_rmem_bf16_6 loc(#loc400)
        %iter_7467 = cute.get_iter(%view_7466) : !memref_rmem_bf16_6 loc(#loc331)
        %lay_7468 = cute.get_layout(%view_7466) : !memref_rmem_bf16_6 loc(#loc311)
        %2483 = cute.get_shape(%lay_7468) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_7469, %e1_7470, %e2_7471 = cute.get_leaves(%2483) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_7472 = cute.group_modes(%view_7466) <1, 2> : (!memref_rmem_bf16_6) -> !memref_rmem_bf16_7 loc(#loc400)
        %iter_7473 = cute.get_iter(%grouped_7472) : !memref_rmem_bf16_7 loc(#loc399)
        %iter_7474 = cute.get_iter(%grouped_7472) : !memref_rmem_bf16_7 loc(#loc317)
        %lay_7475 = cute.get_layout(%grouped_7459) : !memref_smem_bf16_14 loc(#loc311)
        %2484 = cute.get_shape(%lay_7475) : (!cute.layout<"((8,1),(2)):((1,0),(4096))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7476, %e1_7477, %e2_7478 = cute.get_leaves(%2484) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_7479 = cute.get_layout(%grouped_7472) : !memref_rmem_bf16_7 loc(#loc311)
        %2485 = cute.get_shape(%lay_7479) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_7480, %e1_7481, %e2_7482 = cute.get_leaves(%2485) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_7483 = cute.size(%grouped_7459) <{mode = [1]}> : (!memref_smem_bf16_14) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7484 = cute.get_leaves(%sz_7483) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_7485 = cute.size(%grouped_7472) <{mode = [1]}> : (!memref_rmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_7486 = cute.get_leaves(%sz_7485) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%130, %grouped_7459, %grouped_7472) : (!copy_ldsm_4_, !memref_smem_bf16_14, !memref_rmem_bf16_7) loc(#loc444)
        %coord_7487 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc445)
        %slice_7488 = cute.slice(%src_partitioned_324, %coord_7487) : !memref_smem_bf16_9, !cute.coord<"(_,_,0)"> loc(#loc445)
        %iter_7489 = cute.get_iter(%slice_7488) : !memref_smem_bf16_16 loc(#loc316)
        %iter_7490 = cute.get_iter(%slice_7488) : !memref_smem_bf16_16 loc(#loc317)
        %coord_7491 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc446)
        %slice_7492 = cute.slice(%retiled_326, %coord_7491) : !memref_rmem_bf16_4, !cute.coord<"(_,_,0)"> loc(#loc446)
        %iter_7493 = cute.get_iter(%slice_7492) : !memref_rmem_bf16_8 loc(#loc316)
        %iter_7494 = cute.get_iter(%slice_7492) : !memref_rmem_bf16_8 loc(#loc317)
        %lay_7495 = cute.get_layout(%slice_7488) : !memref_smem_bf16_16 loc(#loc311)
        %2486 = cute.get_shape(%lay_7495) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7496, %e1_7497, %e2_7498 = cute.get_leaves(%2486) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7499 = cute.get_layout(%slice_7492) : !memref_rmem_bf16_8 loc(#loc311)
        %2487 = cute.get_shape(%lay_7499) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7500, %e1_7501, %e2_7502 = cute.get_leaves(%2487) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %lay_7503 = cute.get_layout(%slice_7488) : !memref_smem_bf16_16 loc(#loc397)
        %shape_7504 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7505 = cute.make_layout(%shape_7504) : !cute.layout<"1:0"> loc(#loc397)
        %append_7506 = cute.append_to_rank<2> (%lay_7503, %lay_7505) : !cute.layout<"((8,1),4):((1,0),1024)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7507 = cute.make_view(%iter_7490, %append_7506) : !memref_smem_bf16_16 loc(#loc398)
        %iter_7508 = cute.get_iter(%view_7507) : !memref_smem_bf16_16 loc(#loc331)
        %lay_7509 = cute.get_layout(%view_7507) : !memref_smem_bf16_16 loc(#loc311)
        %2488 = cute.get_shape(%lay_7509) : (!cute.layout<"((8,1),4):((1,0),1024)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7510, %e1_7511, %e2_7512 = cute.get_leaves(%2488) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7513 = cute.group_modes(%view_7507) <1, 2> : (!memref_smem_bf16_16) -> !memref_smem_bf16_17 loc(#loc398)
        %iter_7514 = cute.get_iter(%grouped_7513) : !memref_smem_bf16_17 loc(#loc399)
        %iter_7515 = cute.get_iter(%grouped_7513) : !memref_smem_bf16_17 loc(#loc317)
        %lay_7516 = cute.get_layout(%slice_7492) : !memref_rmem_bf16_8 loc(#loc397)
        %shape_7517 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7518 = cute.make_layout(%shape_7517) : !cute.layout<"1:0"> loc(#loc397)
        %append_7519 = cute.append_to_rank<2> (%lay_7516, %lay_7518) : !cute.layout<"((8,1),4):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_7520 = cute.make_view(%iter_7494, %append_7519) : !memref_rmem_bf16_8 loc(#loc400)
        %iter_7521 = cute.get_iter(%view_7520) : !memref_rmem_bf16_8 loc(#loc331)
        %lay_7522 = cute.get_layout(%view_7520) : !memref_rmem_bf16_8 loc(#loc311)
        %2489 = cute.get_shape(%lay_7522) : (!cute.layout<"((8,1),4):((1,0),8)">) -> !cute.shape<"((8,1),4)"> loc(#loc311)
        %e0_7523, %e1_7524, %e2_7525 = cute.get_leaves(%2489) : !cute.shape<"((8,1),4)"> loc(#loc311)
        %grouped_7526 = cute.group_modes(%view_7520) <1, 2> : (!memref_rmem_bf16_8) -> !memref_rmem_bf16_9 loc(#loc400)
        %iter_7527 = cute.get_iter(%grouped_7526) : !memref_rmem_bf16_9 loc(#loc399)
        %iter_7528 = cute.get_iter(%grouped_7526) : !memref_rmem_bf16_9 loc(#loc317)
        %lay_7529 = cute.get_layout(%grouped_7513) : !memref_smem_bf16_17 loc(#loc311)
        %2490 = cute.get_shape(%lay_7529) : (!cute.layout<"((8,1),(4)):((1,0),(1024))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7530, %e1_7531, %e2_7532 = cute.get_leaves(%2490) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %lay_7533 = cute.get_layout(%grouped_7526) : !memref_rmem_bf16_9 loc(#loc311)
        %2491 = cute.get_shape(%lay_7533) : (!cute.layout<"((8,1),(4)):((1,0),(8))">) -> !cute.shape<"((8,1),(4))"> loc(#loc311)
        %e0_7534, %e1_7535, %e2_7536 = cute.get_leaves(%2491) : !cute.shape<"((8,1),(4))"> loc(#loc311)
        %sz_7537 = cute.size(%grouped_7513) <{mode = [1]}> : (!memref_smem_bf16_17) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7538 = cute.get_leaves(%sz_7537) : !cute.int_tuple<"4"> loc(#loc402)
        %sz_7539 = cute.size(%grouped_7526) <{mode = [1]}> : (!memref_rmem_bf16_9) -> !cute.int_tuple<"4"> loc(#loc402)
        %e0_7540 = cute.get_leaves(%sz_7539) : !cute.int_tuple<"4"> loc(#loc402)
        cute.copy(%134, %grouped_7513, %grouped_7526) : (!copy_ldsm_4_1, !memref_smem_bf16_17, !memref_rmem_bf16_9) loc(#loc447)
        %coord_7541 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc448)
        %slice_7542 = cute.slice(%frg_A, %coord_7541) : !memref_rmem_bf16_, !cute.coord<"(_,_,7)"> loc(#loc448)
        %iter_7543 = cute.get_iter(%slice_7542) : !memref_rmem_bf16_10 loc(#loc316)
        %iter_7544 = cute.get_iter(%slice_7542) : !memref_rmem_bf16_10 loc(#loc317)
        %coord_7545 = cute.make_coord() : () -> !cute.coord<"(_,_,7)"> loc(#loc449)
        %slice_7546 = cute.slice(%frg_B, %coord_7545) : !memref_rmem_bf16_1, !cute.coord<"(_,_,7)"> loc(#loc449)
        %iter_7547 = cute.get_iter(%slice_7546) : !memref_rmem_bf16_11 loc(#loc316)
        %iter_7548 = cute.get_iter(%slice_7546) : !memref_rmem_bf16_11 loc(#loc317)
        %lay_7549 = cute.get_layout(%slice_7542) : !memref_rmem_bf16_10 loc(#loc311)
        %2492 = cute.get_shape(%lay_7549) : (!cute.layout<"((2,2,2),2):((1,2,4),8)">) -> !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %e0_7550, %e1_7551, %e2_7552, %e3_7553 = cute.get_leaves(%2492) : !cute.shape<"((2,2,2),2)"> loc(#loc311)
        %lay_7554 = cute.get_layout(%slice_7546) : !memref_rmem_bf16_11 loc(#loc311)
        %2493 = cute.get_shape(%lay_7554) : (!cute.layout<"((2,2),8):((1,2),4)">) -> !cute.shape<"((2,2),8)"> loc(#loc311)
        %e0_7555, %e1_7556, %e2_7557 = cute.get_leaves(%2493) : !cute.shape<"((2,2),8)"> loc(#loc311)
        cute.gemm(%arg10, %rmem_6393, %slice_7542, %slice_7546, %rmem_6393) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_2, !memref_rmem_bf16_10, !memref_rmem_bf16_11, !memref_rmem_f32_2) loc(#loc450)
        nvvm.cp.async.wait.group 0 loc(#loc451)
        %c1_i32_7558 = arith.constant 1 : i32 loc(#loc452)
        %c128_i32_7559 = arith.constant 128 : i32 loc(#loc452)
        nvvm.barrier id = %c1_i32_7558 number_of_threads = %c128_i32_7559 loc(#loc452)
        %c0_i32_7560 = arith.constant 0 : i32 loc(#loc290)
        %2494 = arith.cmpi sgt, %2365, %c0_i32_7560 : i32 loc(#loc313)
        scf.if %2494 {
          %c1_i32_8346 = arith.constant 1 : i32 loc(#loc290)
          %2686 = arith.subi %2365, %c1_i32_8346 : i32 loc(#loc313)
          %coord_8347 = cute.make_coord(%2686) : (i32) -> !cute.coord<"(_,_,_,?)"> loc(#loc453)
          %slice_8348 = cute.slice(%src_partitioned_236, %coord_8347) : !memref_gmem_bf16_5, !cute.coord<"(_,_,_,?)"> loc(#loc453)
          %iter_8349 = cute.get_iter(%slice_8348) : !memref_gmem_bf16_8 loc(#loc316)
          %iter_8350 = cute.get_iter(%slice_8348) : !memref_gmem_bf16_8 loc(#loc317)
          %lay_8351 = cute.get_layout(%slice_8348) : !memref_gmem_bf16_8 loc(#loc311)
          %2687 = cute.get_shape(%lay_8351) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8352, %e1_8353, %e2_8354, %e3_8355 = cute.get_leaves(%2687) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %lay_8356 = cute.get_layout(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc311)
          %2688 = cute.get_shape(%lay_8356) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8357, %e1_8358, %e2_8359, %e3_8360 = cute.get_leaves(%2688) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %lay_8361 = cute.get_layout(%slice_8348) : !memref_gmem_bf16_8 loc(#loc397)
          %shape_8362 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8363 = cute.make_layout(%shape_8362) : !cute.layout<"1:0"> loc(#loc397)
          %append_8364 = cute.append_to_rank<2> (%lay_8361, %lay_8363) : !cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8365 = cute.make_view(%iter_8350, %append_8364) : !memref_gmem_bf16_8 loc(#loc398)
          %iter_8366 = cute.get_iter(%view_8365) : !memref_gmem_bf16_8 loc(#loc331)
          %lay_8367 = cute.get_layout(%view_8365) : !memref_gmem_bf16_8 loc(#loc311)
          %2689 = cute.get_shape(%lay_8367) : (!cute.layout<"((8,1),4,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8368, %e1_8369, %e2_8370, %e3_8371 = cute.get_leaves(%2689) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %grouped_8372 = cute.group_modes(%view_8365) <1, 3> : (!memref_gmem_bf16_8) -> !memref_gmem_bf16_9 loc(#loc398)
          %iter_8373 = cute.get_iter(%grouped_8372) : !memref_gmem_bf16_9 loc(#loc399)
          %iter_8374 = cute.get_iter(%grouped_8372) : !memref_gmem_bf16_9 loc(#loc317)
          %lay_8375 = cute.get_layout(%dst_partitioned_239) : !memref_smem_bf16_4 loc(#loc397)
          %shape_8376 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8377 = cute.make_layout(%shape_8376) : !cute.layout<"1:0"> loc(#loc397)
          %append_8378 = cute.append_to_rank<2> (%lay_8375, %lay_8377) : !cute.layout<"((8,1),4,2):((1,0),1024,4096)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8379 = cute.make_view(%iter_240, %append_8378) : !memref_smem_bf16_4 loc(#loc400)
          %iter_8380 = cute.get_iter(%view_8379) : !memref_smem_bf16_4 loc(#loc331)
          %lay_8381 = cute.get_layout(%view_8379) : !memref_smem_bf16_4 loc(#loc311)
          %2690 = cute.get_shape(%lay_8381) : (!cute.layout<"((8,1),4,2):((1,0),1024,4096)">) -> !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %e0_8382, %e1_8383, %e2_8384, %e3_8385 = cute.get_leaves(%2690) : !cute.shape<"((8,1),4,2)"> loc(#loc311)
          %grouped_8386 = cute.group_modes(%view_8379) <1, 3> : (!memref_smem_bf16_4) -> !memref_smem_bf16_15 loc(#loc400)
          %iter_8387 = cute.get_iter(%grouped_8386) : !memref_smem_bf16_15 loc(#loc399)
          %iter_8388 = cute.get_iter(%grouped_8386) : !memref_smem_bf16_15 loc(#loc317)
          %lay_8389 = cute.get_layout(%rmem_448) : !memref_rmem_i8_1 loc(#loc397)
          %shape_8390 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
          %lay_8391 = cute.make_layout(%shape_8390) : !cute.layout<"1:0"> loc(#loc397)
          %append_8392 = cute.append_to_rank<2> (%lay_8389, %lay_8391) : !cute.layout<"(1,4,2):(2,0,1)">, !cute.layout<"1:0"> loc(#loc397)
          %view_8393 = cute.make_view(%iter_450, %append_8392) : !memref_rmem_i8_1 loc(#loc401)
          %iter_8394 = cute.get_iter(%view_8393) : !memref_rmem_i8_1 loc(#loc331)
          %lay_8395 = cute.get_layout(%view_8393) : !memref_rmem_i8_1 loc(#loc311)
          %2691 = cute.get_shape(%lay_8395) : (!cute.layout<"(1,4,2):(2,0,1)">) -> !cute.shape<"(1,4,2)"> loc(#loc311)
          %e0_8396, %e1_8397, %e2_8398 = cute.get_leaves(%2691) : !cute.shape<"(1,4,2)"> loc(#loc311)
          %grouped_8399 = cute.group_modes(%view_8393) <1, 3> : (!memref_rmem_i8_1) -> !memref_rmem_i8_4 loc(#loc401)
          %iter_8400 = cute.get_iter(%grouped_8399) : !memref_rmem_i8_4 loc(#loc399)
          %iter_8401 = cute.get_iter(%grouped_8399) : !memref_rmem_i8_4 loc(#loc317)
          %lay_8402 = cute.get_layout(%grouped_8372) : !memref_gmem_bf16_9 loc(#loc311)
          %2692 = cute.get_shape(%lay_8402) : (!cute.layout<"((8,1),(4,2)):((1,0),(?{i64 div=128},64))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %e0_8403, %e1_8404, %e2_8405, %e3_8406 = cute.get_leaves(%2692) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %lay_8407 = cute.get_layout(%grouped_8386) : !memref_smem_bf16_15 loc(#loc311)
          %2693 = cute.get_shape(%lay_8407) : (!cute.layout<"((8,1),(4,2)):((1,0),(1024,4096))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %e0_8408, %e1_8409, %e2_8410, %e3_8411 = cute.get_leaves(%2693) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
          %sz_8412 = cute.size(%grouped_8372) <{mode = [1]}> : (!memref_gmem_bf16_9) -> !cute.int_tuple<"8"> loc(#loc402)
          %e0_8413 = cute.get_leaves(%sz_8412) : !cute.int_tuple<"8"> loc(#loc402)
          %sz_8414 = cute.size(%grouped_8386) <{mode = [1]}> : (!memref_smem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
          %e0_8415 = cute.get_leaves(%sz_8414) : !cute.int_tuple<"8"> loc(#loc402)
          cute.copy(%arg8, %grouped_8372, %grouped_8386, %grouped_8399) : (!copy_ldgsts, !memref_gmem_bf16_9, !memref_smem_bf16_15, !memref_rmem_i8_4) loc(#loc454)
          nvvm.cp.async.commit.group loc(#loc455)
        } loc(#loc290)
        %lay_7561 = cute.get_layout(%rmem_6393) : !memref_rmem_f32_2 loc(#loc456)
        %2495 = cute.get_shape(%lay_7561) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
        %e0_7562, %e1_7563, %e2_7564, %e3_7565 = cute.get_leaves(%2495) : !cute.shape<"((2,2),2,8)"> loc(#loc456)
        %shape_7566 = cute.make_shape() : () -> !cute.shape<"((2,2),2,8)"> loc(#loc456)
        %lay_7567 = cute.make_layout(%shape_7566) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc456)
        %2496 = cute.get_shape(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc457)
        %e0_7568, %e1_7569, %e2_7570, %e3_7571 = cute.get_leaves(%2496) : !cute.shape<"((2,2),2,8)"> loc(#loc457)
        %2497 = cute.get_shape(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc458)
        %e0_7572, %e1_7573, %e2_7574, %e3_7575 = cute.get_leaves(%2497) : !cute.shape<"((2,2),2,8)"> loc(#loc458)
        %2498 = cute.get_shape(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc459)
        %e0_7576, %e1_7577, %e2_7578, %e3_7579 = cute.get_leaves(%2498) : !cute.shape<"((2,2),2,8)"> loc(#loc459)
        %2499 = cute.get_shape(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc460)
        %e0_7580, %e1_7581, %e2_7582, %e3_7583 = cute.get_leaves(%2499) : !cute.shape<"((2,2),2,8)"> loc(#loc460)
        %2500 = cute.get_stride(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
        %e0_7584, %e1_7585, %e2_7586, %e3_7587 = cute.get_leaves(%2500) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
        %2501 = cute.get_stride(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
        %e0_7588, %e1_7589, %e2_7590, %e3_7591 = cute.get_leaves(%2501) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
        %2502 = cute.get_stride(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
        %e0_7592, %e1_7593, %e2_7594, %e3_7595 = cute.get_leaves(%2502) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
        %2503 = cute.get_stride(%lay_7567) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
        %e0_7596, %e1_7597, %e2_7598, %e3_7599 = cute.get_leaves(%2503) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
        %shape_7600 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,8))"> loc(#loc465)
        %stride_7601 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
        %lay_7602 = cute.make_layout(%shape_7600, %stride_7601) : !cute.layout<"((2,2),(2,8)):((2,4),(1,8))"> loc(#loc465)
        %lay_7603 = cute.get_layout(%rmem_6393) : !memref_rmem_f32_2 loc(#loc466)
        %2504 = cute.composition(%lay_7603, %lay_7602) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.layout<"((2,2),(2,8)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,8)):((2,4),(1,8))"> loc(#loc466)
        %view_7604 = cute.make_view(%iter_6395, %2504) : !memref_rmem_f32_3 loc(#loc467)
        %iter_7605 = cute.get_iter(%view_7604) : !memref_rmem_f32_3 loc(#loc331)
        %lay_7606 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc456)
        %2505 = cute.get_shape(%lay_7606) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
        %e0_7607, %e1_7608, %e2_7609, %e3_7610 = cute.get_leaves(%2505) : !cute.shape<"((2,2),2,16)"> loc(#loc456)
        %shape_7611 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
        %lay_7612 = cute.make_layout(%shape_7611) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> loc(#loc456)
        %2506 = cute.get_shape(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc457)
        %e0_7613, %e1_7614, %e2_7615, %e3_7616 = cute.get_leaves(%2506) : !cute.shape<"((2,2),2,16)"> loc(#loc457)
        %2507 = cute.get_shape(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc458)
        %e0_7617, %e1_7618, %e2_7619, %e3_7620 = cute.get_leaves(%2507) : !cute.shape<"((2,2),2,16)"> loc(#loc458)
        %2508 = cute.get_shape(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc459)
        %e0_7621, %e1_7622, %e2_7623, %e3_7624 = cute.get_leaves(%2508) : !cute.shape<"((2,2),2,16)"> loc(#loc459)
        %2509 = cute.get_shape(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc460)
        %e0_7625, %e1_7626, %e2_7627, %e3_7628 = cute.get_leaves(%2509) : !cute.shape<"((2,2),2,16)"> loc(#loc460)
        %2510 = cute.get_stride(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
        %e0_7629, %e1_7630, %e2_7631, %e3_7632 = cute.get_leaves(%2510) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
        %2511 = cute.get_stride(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
        %e0_7633, %e1_7634, %e2_7635, %e3_7636 = cute.get_leaves(%2511) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
        %2512 = cute.get_stride(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
        %e0_7637, %e1_7638, %e2_7639, %e3_7640 = cute.get_leaves(%2512) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
        %2513 = cute.get_stride(%lay_7612) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
        %e0_7641, %e1_7642, %e2_7643, %e3_7644 = cute.get_leaves(%2513) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
        %shape_7645 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))"> loc(#loc465)
        %stride_7646 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
        %lay_7647 = cute.make_layout(%shape_7645, %stride_7646) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc465)
        %lay_7648 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc466)
        %2514 = cute.composition(%lay_7648, %lay_7647) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc466)
        %view_7649 = cute.make_view(%iter_266, %2514) : !memref_rmem_f32_4 loc(#loc467)
        %iter_7650 = cute.get_iter(%view_7649) : !memref_rmem_f32_4 loc(#loc331)
        %lay_7651 = cute.get_layout(%rmem_919) : !memref_rmem_f32_1 loc(#loc490)
        %2515 = cute.make_layout_like(%lay_7651) : !cute.layout<"4:1"> to !cute.layout<"4:1"> loc(#loc514)
        %rmem_7652 = cute.memref.alloca(%2515) : !memref_rmem_f32_1 loc(#loc514)
        %iter_7653 = cute.get_iter(%rmem_7652) : !memref_rmem_f32_1 loc(#loc350)
        %iter_7654 = cute.get_iter(%rmem_7652) : !memref_rmem_f32_1 loc(#loc351)
        %lay_7655 = cute.get_layout(%rmem_919) : !memref_rmem_f32_1 loc(#loc311)
        %2516 = cute.get_shape(%lay_7655) : (!cute.layout<"4:1">) -> !cute.shape<"4"> loc(#loc311)
        %e0_7656 = cute.get_leaves(%2516) : !cute.shape<"4"> loc(#loc311)
        %lay_7657 = cute.get_layout(%rmem_7652) : !memref_rmem_f32_1 loc(#loc311)
        %2517 = cute.get_shape(%lay_7657) : (!cute.layout<"4:1">) -> !cute.shape<"4"> loc(#loc311)
        %e0_7658 = cute.get_leaves(%2517) : !cute.shape<"4"> loc(#loc311)
        %atom_7659 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32, 32 b> loc(#loc515)
        cute.copy(%atom_7659, %rmem_919, %rmem_7652) : (!cute_nvgpu.atom.universal_copy<f32, 32 b>, !memref_rmem_f32_1, !memref_rmem_f32_1) loc(#loc515)
        %sz_7660 = cute.size(%rmem_919) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4"> loc(#loc472)
        %e0_7661 = cute.get_leaves(%sz_7660) : !cute.int_tuple<"4"> loc(#loc472)
        %coord_7662 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc480)
        %slice_7663 = cute.slice(%view_7604, %coord_7662) : !memref_rmem_f32_3, !cute.coord<"(0,_)"> loc(#loc480)
        %iter_7664 = cute.get_iter(%slice_7663) : !memref_rmem_f32_5 loc(#loc316)
        %iter_7665 = cute.get_iter(%slice_7663) : !memref_rmem_f32_5 loc(#loc317)
        %lay_7666 = cute.get_layout(%slice_7663) : !memref_rmem_f32_5 loc(#loc311)
        %2518 = cute.get_shape(%lay_7666) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7667, %e1_7668 = cute.get_leaves(%2518) : !cute.shape<"((2,8))"> loc(#loc311)
        %2519 = cute.memref.load_vec %slice_7663 : !memref_rmem_f32_5 loc(#loc480)
        %cst_7669 = arith.constant 0xFF800000 : f32 loc(#loc481)
        %2520 = vector.reduction <maximumf>, %2519, %cst_7669 : vector<16xf32> into f32 loc(#loc481)
        %c-1_i32_7670 = arith.constant -1 : i32 loc(#loc482)
        %c2_i32_7671 = arith.constant 2 : i32 loc(#loc482)
        %c31_i32_7672 = arith.constant 31 : i32 loc(#loc482)
        %2521 = nvvm.shfl.sync  bfly %c-1_i32_7670, %2520, %c2_i32_7671, %c31_i32_7672 : f32 -> f32 loc(#loc482)
        %2522 = nvvm.fmax %2520, %2521 loc(#loc483)
        %c-1_i32_7673 = arith.constant -1 : i32 loc(#loc484)
        %c1_i32_7674 = arith.constant 1 : i32 loc(#loc484)
        %c31_i32_7675 = arith.constant 31 : i32 loc(#loc484)
        %2523 = nvvm.shfl.sync  bfly %c-1_i32_7673, %2522, %c1_i32_7674, %c31_i32_7675 : f32 -> f32 loc(#loc484)
        %2524 = nvvm.fmax %2522, %2523 loc(#loc483)
        %coord_7676 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc516)
        %2525 = cute.memref.load(%rmem_7652, %coord_7676) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc516)
        %2526 = nvvm.fmax %2525, %2524 loc(#loc517)
        %2527 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
        %2528 = arith.mulf %2519, %2527 : vector<16xf32> loc(#loc485)
        %2529 = arith.mulf %2526, %arg4 : f32 loc(#loc313)
        %2530 = vector.broadcast %2529 : f32 to vector<16xf32> loc(#loc290)
        %2531 = arith.subf %2528, %2530 : vector<16xf32> loc(#loc485)
        %2532 = math.exp2 %2531 fastmath<fast> : vector<16xf32> loc(#loc290)
        %cst_7677 = arith.constant 0.000000e+00 : f32 loc(#loc486)
        %2533 = vector.reduction <add>, %2532, %cst_7677 : vector<16xf32> into f32 loc(#loc486)
        %2534 = arith.mulf %2525, %arg4 : f32 loc(#loc313)
        %2535 = arith.mulf %2526, %arg4 : f32 loc(#loc313)
        %2536 = arith.subf %2534, %2535 : f32 loc(#loc313)
        %2537 = math.exp2 %2536 fastmath<fast> : f32 loc(#loc290)
        %coord_7678 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc518)
        %2538 = cute.memref.load(%rmem_924, %coord_7678) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc518)
        %2539 = arith.mulf %2538, %2537 : f32 loc(#loc313)
        %2540 = arith.addf %2539, %2533 : f32 loc(#loc313)
        %coord_7679 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc519)
        %slice_7680 = cute.slice(%view_7649, %coord_7679) : !memref_rmem_f32_4, !cute.coord<"(0,_)"> loc(#loc519)
        %iter_7681 = cute.get_iter(%slice_7680) : !memref_rmem_f32_8 loc(#loc316)
        %iter_7682 = cute.get_iter(%slice_7680) : !memref_rmem_f32_8 loc(#loc317)
        %lay_7683 = cute.get_layout(%slice_7680) : !memref_rmem_f32_8 loc(#loc311)
        %2541 = cute.get_shape(%lay_7683) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7684, %e1_7685 = cute.get_leaves(%2541) : !cute.shape<"((2,16))"> loc(#loc311)
        %2542 = cute.memref.load_vec %slice_7680 : !memref_rmem_f32_8 loc(#loc519)
        %2543 = vector.broadcast %2537 : f32 to vector<32xf32> loc(#loc290)
        %2544 = arith.mulf %2542, %2543 : vector<32xf32> loc(#loc485)
        %coord_7686 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc519)
        %slice_7687 = cute.slice(%view_7649, %coord_7686) : !memref_rmem_f32_4, !cute.coord<"(0,_)"> loc(#loc519)
        %iter_7688 = cute.get_iter(%slice_7687) : !memref_rmem_f32_8 loc(#loc316)
        %iter_7689 = cute.get_iter(%slice_7687) : !memref_rmem_f32_8 loc(#loc317)
        %lay_7690 = cute.get_layout(%slice_7687) : !memref_rmem_f32_8 loc(#loc311)
        %2545 = cute.get_shape(%lay_7690) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7691, %e1_7692 = cute.get_leaves(%2545) : !cute.shape<"((2,16))"> loc(#loc311)
        %int_tuple_7693 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7694 = cute.size(%int_tuple_7693) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7695 = cute.get_leaves(%sz_7694) : !cute.int_tuple<"32"> loc(#loc519)
        %int_tuple_7696 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7697 = cute.size(%int_tuple_7696) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7698 = cute.get_leaves(%sz_7697) : !cute.int_tuple<"32"> loc(#loc519)
        cute.memref.store_vec %2544, %slice_7687 : !memref_rmem_f32_8 loc(#loc519)
        %coord_7699 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc487)
        cute.memref.store(%rmem_919, %coord_7699, %2526) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> () loc(#loc487)
        %coord_7700 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc488)
        cute.memref.store(%rmem_924, %coord_7700, %2540) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> () loc(#loc488)
        %coord_7701 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc489)
        %slice_7702 = cute.slice(%view_7604, %coord_7701) : !memref_rmem_f32_3, !cute.coord<"(0,_)"> loc(#loc489)
        %iter_7703 = cute.get_iter(%slice_7702) : !memref_rmem_f32_5 loc(#loc316)
        %iter_7704 = cute.get_iter(%slice_7702) : !memref_rmem_f32_5 loc(#loc317)
        %lay_7705 = cute.get_layout(%slice_7702) : !memref_rmem_f32_5 loc(#loc311)
        %2546 = cute.get_shape(%lay_7705) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7706, %e1_7707 = cute.get_leaves(%2546) : !cute.shape<"((2,8))"> loc(#loc311)
        %int_tuple_7708 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7709 = cute.size(%int_tuple_7708) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7710 = cute.get_leaves(%sz_7709) : !cute.int_tuple<"16"> loc(#loc489)
        %int_tuple_7711 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7712 = cute.size(%int_tuple_7711) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7713 = cute.get_leaves(%sz_7712) : !cute.int_tuple<"16"> loc(#loc489)
        cute.memref.store_vec %2532, %slice_7702 : !memref_rmem_f32_5 loc(#loc489)
        %coord_7714 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc480)
        %slice_7715 = cute.slice(%view_7604, %coord_7714) : !memref_rmem_f32_3, !cute.coord<"(1,_)"> loc(#loc480)
        %iter_7716 = cute.get_iter(%slice_7715) : !memref_rmem_f32_6 loc(#loc316)
        %iter_7717 = cute.get_iter(%slice_7715) : !memref_rmem_f32_6 loc(#loc317)
        %lay_7718 = cute.get_layout(%slice_7715) : !memref_rmem_f32_6 loc(#loc311)
        %2547 = cute.get_shape(%lay_7718) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7719, %e1_7720 = cute.get_leaves(%2547) : !cute.shape<"((2,8))"> loc(#loc311)
        %2548 = cute.memref.load_vec %slice_7715 : !memref_rmem_f32_6 loc(#loc480)
        %cst_7721 = arith.constant 0xFF800000 : f32 loc(#loc481)
        %2549 = vector.reduction <maximumf>, %2548, %cst_7721 : vector<16xf32> into f32 loc(#loc481)
        %c-1_i32_7722 = arith.constant -1 : i32 loc(#loc482)
        %c2_i32_7723 = arith.constant 2 : i32 loc(#loc482)
        %c31_i32_7724 = arith.constant 31 : i32 loc(#loc482)
        %2550 = nvvm.shfl.sync  bfly %c-1_i32_7722, %2549, %c2_i32_7723, %c31_i32_7724 : f32 -> f32 loc(#loc482)
        %2551 = nvvm.fmax %2549, %2550 loc(#loc483)
        %c-1_i32_7725 = arith.constant -1 : i32 loc(#loc484)
        %c1_i32_7726 = arith.constant 1 : i32 loc(#loc484)
        %c31_i32_7727 = arith.constant 31 : i32 loc(#loc484)
        %2552 = nvvm.shfl.sync  bfly %c-1_i32_7725, %2551, %c1_i32_7726, %c31_i32_7727 : f32 -> f32 loc(#loc484)
        %2553 = nvvm.fmax %2551, %2552 loc(#loc483)
        %coord_7728 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc516)
        %2554 = cute.memref.load(%rmem_7652, %coord_7728) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc516)
        %2555 = nvvm.fmax %2554, %2553 loc(#loc517)
        %2556 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
        %2557 = arith.mulf %2548, %2556 : vector<16xf32> loc(#loc485)
        %2558 = arith.mulf %2555, %arg4 : f32 loc(#loc313)
        %2559 = vector.broadcast %2558 : f32 to vector<16xf32> loc(#loc290)
        %2560 = arith.subf %2557, %2559 : vector<16xf32> loc(#loc485)
        %2561 = math.exp2 %2560 fastmath<fast> : vector<16xf32> loc(#loc290)
        %cst_7729 = arith.constant 0.000000e+00 : f32 loc(#loc486)
        %2562 = vector.reduction <add>, %2561, %cst_7729 : vector<16xf32> into f32 loc(#loc486)
        %2563 = arith.mulf %2554, %arg4 : f32 loc(#loc313)
        %2564 = arith.mulf %2555, %arg4 : f32 loc(#loc313)
        %2565 = arith.subf %2563, %2564 : f32 loc(#loc313)
        %2566 = math.exp2 %2565 fastmath<fast> : f32 loc(#loc290)
        %coord_7730 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc518)
        %2567 = cute.memref.load(%rmem_924, %coord_7730) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc518)
        %2568 = arith.mulf %2567, %2566 : f32 loc(#loc313)
        %2569 = arith.addf %2568, %2562 : f32 loc(#loc313)
        %coord_7731 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc519)
        %slice_7732 = cute.slice(%view_7649, %coord_7731) : !memref_rmem_f32_4, !cute.coord<"(1,_)"> loc(#loc519)
        %iter_7733 = cute.get_iter(%slice_7732) : !memref_rmem_f32_9 loc(#loc316)
        %iter_7734 = cute.get_iter(%slice_7732) : !memref_rmem_f32_9 loc(#loc317)
        %lay_7735 = cute.get_layout(%slice_7732) : !memref_rmem_f32_9 loc(#loc311)
        %2570 = cute.get_shape(%lay_7735) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7736, %e1_7737 = cute.get_leaves(%2570) : !cute.shape<"((2,16))"> loc(#loc311)
        %2571 = cute.memref.load_vec %slice_7732 : !memref_rmem_f32_9 loc(#loc519)
        %2572 = vector.broadcast %2566 : f32 to vector<32xf32> loc(#loc290)
        %2573 = arith.mulf %2571, %2572 : vector<32xf32> loc(#loc485)
        %coord_7738 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc519)
        %slice_7739 = cute.slice(%view_7649, %coord_7738) : !memref_rmem_f32_4, !cute.coord<"(1,_)"> loc(#loc519)
        %iter_7740 = cute.get_iter(%slice_7739) : !memref_rmem_f32_9 loc(#loc316)
        %iter_7741 = cute.get_iter(%slice_7739) : !memref_rmem_f32_9 loc(#loc317)
        %lay_7742 = cute.get_layout(%slice_7739) : !memref_rmem_f32_9 loc(#loc311)
        %2574 = cute.get_shape(%lay_7742) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7743, %e1_7744 = cute.get_leaves(%2574) : !cute.shape<"((2,16))"> loc(#loc311)
        %int_tuple_7745 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7746 = cute.size(%int_tuple_7745) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7747 = cute.get_leaves(%sz_7746) : !cute.int_tuple<"32"> loc(#loc519)
        %int_tuple_7748 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7749 = cute.size(%int_tuple_7748) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7750 = cute.get_leaves(%sz_7749) : !cute.int_tuple<"32"> loc(#loc519)
        cute.memref.store_vec %2573, %slice_7739 : !memref_rmem_f32_9 loc(#loc519)
        %coord_7751 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc487)
        cute.memref.store(%rmem_919, %coord_7751, %2555) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> () loc(#loc487)
        %coord_7752 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc488)
        cute.memref.store(%rmem_924, %coord_7752, %2569) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> () loc(#loc488)
        %coord_7753 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc489)
        %slice_7754 = cute.slice(%view_7604, %coord_7753) : !memref_rmem_f32_3, !cute.coord<"(1,_)"> loc(#loc489)
        %iter_7755 = cute.get_iter(%slice_7754) : !memref_rmem_f32_6 loc(#loc316)
        %iter_7756 = cute.get_iter(%slice_7754) : !memref_rmem_f32_6 loc(#loc317)
        %lay_7757 = cute.get_layout(%slice_7754) : !memref_rmem_f32_6 loc(#loc311)
        %2575 = cute.get_shape(%lay_7757) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7758, %e1_7759 = cute.get_leaves(%2575) : !cute.shape<"((2,8))"> loc(#loc311)
        %int_tuple_7760 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7761 = cute.size(%int_tuple_7760) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7762 = cute.get_leaves(%sz_7761) : !cute.int_tuple<"16"> loc(#loc489)
        %int_tuple_7763 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7764 = cute.size(%int_tuple_7763) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7765 = cute.get_leaves(%sz_7764) : !cute.int_tuple<"16"> loc(#loc489)
        cute.memref.store_vec %2561, %slice_7754 : !memref_rmem_f32_6 loc(#loc489)
        %coord_7766 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc480)
        %slice_7767 = cute.slice(%view_7604, %coord_7766) : !memref_rmem_f32_3, !cute.coord<"(2,_)"> loc(#loc480)
        %iter_7768 = cute.get_iter(%slice_7767) : !memref_rmem_f32_7 loc(#loc316)
        %iter_7769 = cute.get_iter(%slice_7767) : !memref_rmem_f32_7 loc(#loc317)
        %lay_7770 = cute.get_layout(%slice_7767) : !memref_rmem_f32_7 loc(#loc311)
        %2576 = cute.get_shape(%lay_7770) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7771, %e1_7772 = cute.get_leaves(%2576) : !cute.shape<"((2,8))"> loc(#loc311)
        %2577 = cute.memref.load_vec %slice_7767 : !memref_rmem_f32_7 loc(#loc480)
        %cst_7773 = arith.constant 0xFF800000 : f32 loc(#loc481)
        %2578 = vector.reduction <maximumf>, %2577, %cst_7773 : vector<16xf32> into f32 loc(#loc481)
        %c-1_i32_7774 = arith.constant -1 : i32 loc(#loc482)
        %c2_i32_7775 = arith.constant 2 : i32 loc(#loc482)
        %c31_i32_7776 = arith.constant 31 : i32 loc(#loc482)
        %2579 = nvvm.shfl.sync  bfly %c-1_i32_7774, %2578, %c2_i32_7775, %c31_i32_7776 : f32 -> f32 loc(#loc482)
        %2580 = nvvm.fmax %2578, %2579 loc(#loc483)
        %c-1_i32_7777 = arith.constant -1 : i32 loc(#loc484)
        %c1_i32_7778 = arith.constant 1 : i32 loc(#loc484)
        %c31_i32_7779 = arith.constant 31 : i32 loc(#loc484)
        %2581 = nvvm.shfl.sync  bfly %c-1_i32_7777, %2580, %c1_i32_7778, %c31_i32_7779 : f32 -> f32 loc(#loc484)
        %2582 = nvvm.fmax %2580, %2581 loc(#loc483)
        %coord_7780 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc516)
        %2583 = cute.memref.load(%rmem_7652, %coord_7780) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc516)
        %2584 = nvvm.fmax %2583, %2582 loc(#loc517)
        %2585 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
        %2586 = arith.mulf %2577, %2585 : vector<16xf32> loc(#loc485)
        %2587 = arith.mulf %2584, %arg4 : f32 loc(#loc313)
        %2588 = vector.broadcast %2587 : f32 to vector<16xf32> loc(#loc290)
        %2589 = arith.subf %2586, %2588 : vector<16xf32> loc(#loc485)
        %2590 = math.exp2 %2589 fastmath<fast> : vector<16xf32> loc(#loc290)
        %cst_7781 = arith.constant 0.000000e+00 : f32 loc(#loc486)
        %2591 = vector.reduction <add>, %2590, %cst_7781 : vector<16xf32> into f32 loc(#loc486)
        %2592 = arith.mulf %2583, %arg4 : f32 loc(#loc313)
        %2593 = arith.mulf %2584, %arg4 : f32 loc(#loc313)
        %2594 = arith.subf %2592, %2593 : f32 loc(#loc313)
        %2595 = math.exp2 %2594 fastmath<fast> : f32 loc(#loc290)
        %coord_7782 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc518)
        %2596 = cute.memref.load(%rmem_924, %coord_7782) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc518)
        %2597 = arith.mulf %2596, %2595 : f32 loc(#loc313)
        %2598 = arith.addf %2597, %2591 : f32 loc(#loc313)
        %coord_7783 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc519)
        %slice_7784 = cute.slice(%view_7649, %coord_7783) : !memref_rmem_f32_4, !cute.coord<"(2,_)"> loc(#loc519)
        %iter_7785 = cute.get_iter(%slice_7784) : !memref_rmem_f32_10 loc(#loc316)
        %iter_7786 = cute.get_iter(%slice_7784) : !memref_rmem_f32_10 loc(#loc317)
        %lay_7787 = cute.get_layout(%slice_7784) : !memref_rmem_f32_10 loc(#loc311)
        %2599 = cute.get_shape(%lay_7787) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7788, %e1_7789 = cute.get_leaves(%2599) : !cute.shape<"((2,16))"> loc(#loc311)
        %2600 = cute.memref.load_vec %slice_7784 : !memref_rmem_f32_10 loc(#loc519)
        %2601 = vector.broadcast %2595 : f32 to vector<32xf32> loc(#loc290)
        %2602 = arith.mulf %2600, %2601 : vector<32xf32> loc(#loc485)
        %coord_7790 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc519)
        %slice_7791 = cute.slice(%view_7649, %coord_7790) : !memref_rmem_f32_4, !cute.coord<"(2,_)"> loc(#loc519)
        %iter_7792 = cute.get_iter(%slice_7791) : !memref_rmem_f32_10 loc(#loc316)
        %iter_7793 = cute.get_iter(%slice_7791) : !memref_rmem_f32_10 loc(#loc317)
        %lay_7794 = cute.get_layout(%slice_7791) : !memref_rmem_f32_10 loc(#loc311)
        %2603 = cute.get_shape(%lay_7794) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7795, %e1_7796 = cute.get_leaves(%2603) : !cute.shape<"((2,16))"> loc(#loc311)
        %int_tuple_7797 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7798 = cute.size(%int_tuple_7797) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7799 = cute.get_leaves(%sz_7798) : !cute.int_tuple<"32"> loc(#loc519)
        %int_tuple_7800 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7801 = cute.size(%int_tuple_7800) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7802 = cute.get_leaves(%sz_7801) : !cute.int_tuple<"32"> loc(#loc519)
        cute.memref.store_vec %2602, %slice_7791 : !memref_rmem_f32_10 loc(#loc519)
        %coord_7803 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc487)
        cute.memref.store(%rmem_919, %coord_7803, %2584) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> () loc(#loc487)
        %coord_7804 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc488)
        cute.memref.store(%rmem_924, %coord_7804, %2598) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> () loc(#loc488)
        %coord_7805 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc489)
        %slice_7806 = cute.slice(%view_7604, %coord_7805) : !memref_rmem_f32_3, !cute.coord<"(2,_)"> loc(#loc489)
        %iter_7807 = cute.get_iter(%slice_7806) : !memref_rmem_f32_7 loc(#loc316)
        %iter_7808 = cute.get_iter(%slice_7806) : !memref_rmem_f32_7 loc(#loc317)
        %lay_7809 = cute.get_layout(%slice_7806) : !memref_rmem_f32_7 loc(#loc311)
        %2604 = cute.get_shape(%lay_7809) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7810, %e1_7811 = cute.get_leaves(%2604) : !cute.shape<"((2,8))"> loc(#loc311)
        %int_tuple_7812 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7813 = cute.size(%int_tuple_7812) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7814 = cute.get_leaves(%sz_7813) : !cute.int_tuple<"16"> loc(#loc489)
        %int_tuple_7815 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7816 = cute.size(%int_tuple_7815) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7817 = cute.get_leaves(%sz_7816) : !cute.int_tuple<"16"> loc(#loc489)
        cute.memref.store_vec %2590, %slice_7806 : !memref_rmem_f32_7 loc(#loc489)
        %coord_7818 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc480)
        %slice_7819 = cute.slice(%view_7604, %coord_7818) : !memref_rmem_f32_3, !cute.coord<"(3,_)"> loc(#loc480)
        %iter_7820 = cute.get_iter(%slice_7819) : !memref_rmem_f32_6 loc(#loc316)
        %iter_7821 = cute.get_iter(%slice_7819) : !memref_rmem_f32_6 loc(#loc317)
        %lay_7822 = cute.get_layout(%slice_7819) : !memref_rmem_f32_6 loc(#loc311)
        %2605 = cute.get_shape(%lay_7822) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7823, %e1_7824 = cute.get_leaves(%2605) : !cute.shape<"((2,8))"> loc(#loc311)
        %2606 = cute.memref.load_vec %slice_7819 : !memref_rmem_f32_6 loc(#loc480)
        %cst_7825 = arith.constant 0xFF800000 : f32 loc(#loc481)
        %2607 = vector.reduction <maximumf>, %2606, %cst_7825 : vector<16xf32> into f32 loc(#loc481)
        %c-1_i32_7826 = arith.constant -1 : i32 loc(#loc482)
        %c2_i32_7827 = arith.constant 2 : i32 loc(#loc482)
        %c31_i32_7828 = arith.constant 31 : i32 loc(#loc482)
        %2608 = nvvm.shfl.sync  bfly %c-1_i32_7826, %2607, %c2_i32_7827, %c31_i32_7828 : f32 -> f32 loc(#loc482)
        %2609 = nvvm.fmax %2607, %2608 loc(#loc483)
        %c-1_i32_7829 = arith.constant -1 : i32 loc(#loc484)
        %c1_i32_7830 = arith.constant 1 : i32 loc(#loc484)
        %c31_i32_7831 = arith.constant 31 : i32 loc(#loc484)
        %2610 = nvvm.shfl.sync  bfly %c-1_i32_7829, %2609, %c1_i32_7830, %c31_i32_7831 : f32 -> f32 loc(#loc484)
        %2611 = nvvm.fmax %2609, %2610 loc(#loc483)
        %coord_7832 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc516)
        %2612 = cute.memref.load(%rmem_7652, %coord_7832) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc516)
        %2613 = nvvm.fmax %2612, %2611 loc(#loc517)
        %2614 = vector.broadcast %arg4 : f32 to vector<16xf32> loc(#loc290)
        %2615 = arith.mulf %2606, %2614 : vector<16xf32> loc(#loc485)
        %2616 = arith.mulf %2613, %arg4 : f32 loc(#loc313)
        %2617 = vector.broadcast %2616 : f32 to vector<16xf32> loc(#loc290)
        %2618 = arith.subf %2615, %2617 : vector<16xf32> loc(#loc485)
        %2619 = math.exp2 %2618 fastmath<fast> : vector<16xf32> loc(#loc290)
        %cst_7833 = arith.constant 0.000000e+00 : f32 loc(#loc486)
        %2620 = vector.reduction <add>, %2619, %cst_7833 : vector<16xf32> into f32 loc(#loc486)
        %2621 = arith.mulf %2612, %arg4 : f32 loc(#loc313)
        %2622 = arith.mulf %2613, %arg4 : f32 loc(#loc313)
        %2623 = arith.subf %2621, %2622 : f32 loc(#loc313)
        %2624 = math.exp2 %2623 fastmath<fast> : f32 loc(#loc290)
        %coord_7834 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc518)
        %2625 = cute.memref.load(%rmem_924, %coord_7834) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc518)
        %2626 = arith.mulf %2625, %2624 : f32 loc(#loc313)
        %2627 = arith.addf %2626, %2620 : f32 loc(#loc313)
        %coord_7835 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc519)
        %slice_7836 = cute.slice(%view_7649, %coord_7835) : !memref_rmem_f32_4, !cute.coord<"(3,_)"> loc(#loc519)
        %iter_7837 = cute.get_iter(%slice_7836) : !memref_rmem_f32_9 loc(#loc316)
        %iter_7838 = cute.get_iter(%slice_7836) : !memref_rmem_f32_9 loc(#loc317)
        %lay_7839 = cute.get_layout(%slice_7836) : !memref_rmem_f32_9 loc(#loc311)
        %2628 = cute.get_shape(%lay_7839) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7840, %e1_7841 = cute.get_leaves(%2628) : !cute.shape<"((2,16))"> loc(#loc311)
        %2629 = cute.memref.load_vec %slice_7836 : !memref_rmem_f32_9 loc(#loc519)
        %2630 = vector.broadcast %2624 : f32 to vector<32xf32> loc(#loc290)
        %2631 = arith.mulf %2629, %2630 : vector<32xf32> loc(#loc485)
        %coord_7842 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc519)
        %slice_7843 = cute.slice(%view_7649, %coord_7842) : !memref_rmem_f32_4, !cute.coord<"(3,_)"> loc(#loc519)
        %iter_7844 = cute.get_iter(%slice_7843) : !memref_rmem_f32_9 loc(#loc316)
        %iter_7845 = cute.get_iter(%slice_7843) : !memref_rmem_f32_9 loc(#loc317)
        %lay_7846 = cute.get_layout(%slice_7843) : !memref_rmem_f32_9 loc(#loc311)
        %2632 = cute.get_shape(%lay_7846) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
        %e0_7847, %e1_7848 = cute.get_leaves(%2632) : !cute.shape<"((2,16))"> loc(#loc311)
        %int_tuple_7849 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7850 = cute.size(%int_tuple_7849) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7851 = cute.get_leaves(%sz_7850) : !cute.int_tuple<"32"> loc(#loc519)
        %int_tuple_7852 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc519)
        %sz_7853 = cute.size(%int_tuple_7852) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc519)
        %e0_7854 = cute.get_leaves(%sz_7853) : !cute.int_tuple<"32"> loc(#loc519)
        cute.memref.store_vec %2631, %slice_7843 : !memref_rmem_f32_9 loc(#loc519)
        %coord_7855 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc487)
        cute.memref.store(%rmem_919, %coord_7855, %2613) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> () loc(#loc487)
        %coord_7856 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc488)
        cute.memref.store(%rmem_924, %coord_7856, %2627) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> () loc(#loc488)
        %coord_7857 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc489)
        %slice_7858 = cute.slice(%view_7604, %coord_7857) : !memref_rmem_f32_3, !cute.coord<"(3,_)"> loc(#loc489)
        %iter_7859 = cute.get_iter(%slice_7858) : !memref_rmem_f32_6 loc(#loc316)
        %iter_7860 = cute.get_iter(%slice_7858) : !memref_rmem_f32_6 loc(#loc317)
        %lay_7861 = cute.get_layout(%slice_7858) : !memref_rmem_f32_6 loc(#loc311)
        %2633 = cute.get_shape(%lay_7861) : (!cute.layout<"((2,8)):((1,8))">) -> !cute.shape<"((2,8))"> loc(#loc311)
        %e0_7862, %e1_7863 = cute.get_leaves(%2633) : !cute.shape<"((2,8))"> loc(#loc311)
        %int_tuple_7864 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7865 = cute.size(%int_tuple_7864) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7866 = cute.get_leaves(%sz_7865) : !cute.int_tuple<"16"> loc(#loc489)
        %int_tuple_7867 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,8))"> loc(#loc489)
        %sz_7868 = cute.size(%int_tuple_7867) : (!cute.int_tuple<"((2,8))">) -> !cute.int_tuple<"16"> loc(#loc489)
        %e0_7869 = cute.get_leaves(%sz_7868) : !cute.int_tuple<"16"> loc(#loc489)
        cute.memref.store_vec %2619, %slice_7858 : !memref_rmem_f32_6 loc(#loc489)
        %lay_7870 = cute.get_layout(%rmem_6393) : !memref_rmem_f32_2 loc(#loc490)
        %2634 = cute.make_layout_like(%lay_7870) : !cute.layout<"((2,2),2,8):((1,2),4,8)"> to !cute.layout<"((2,2),2,8):((1,2),4,8)"> loc(#loc491)
        %rmem_7871 = cute.memref.alloca(%2634) : !memref_rmem_bf16_12 loc(#loc491)
        %iter_7872 = cute.get_iter(%rmem_7871) : !memref_rmem_bf16_12 loc(#loc350)
        %iter_7873 = cute.get_iter(%rmem_7871) : !memref_rmem_bf16_12 loc(#loc351)
        %2635 = cute.memref.load_vec %rmem_6393 : !memref_rmem_f32_2 loc(#loc492)
        %2636 = arith.truncf %2635 : vector<64xf32> to vector<64xbf16> loc(#loc492)
        %lay_7874 = cute.get_layout(%rmem_7871) : !memref_rmem_bf16_12 loc(#loc311)
        %2637 = cute.get_shape(%lay_7874) : (!cute.layout<"((2,2),2,8):((1,2),4,8)">) -> !cute.shape<"((2,2),2,8)"> loc(#loc311)
        %e0_7875, %e1_7876, %e2_7877, %e3_7878 = cute.get_leaves(%2637) : !cute.shape<"((2,2),2,8)"> loc(#loc311)
        %int_tuple_7879 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc492)
        %sz_7880 = cute.size(%int_tuple_7879) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc492)
        %e0_7881 = cute.get_leaves(%sz_7880) : !cute.int_tuple<"64"> loc(#loc492)
        %int_tuple_7882 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,8)"> loc(#loc492)
        %sz_7883 = cute.size(%int_tuple_7882) : (!cute.int_tuple<"((2,2),2,8)">) -> !cute.int_tuple<"64"> loc(#loc492)
        %e0_7884 = cute.get_leaves(%sz_7883) : !cute.int_tuple<"64"> loc(#loc492)
        cute.memref.store_vec %2636, %rmem_7871 : !memref_rmem_bf16_12 loc(#loc492)
        %lay_7885 = cute.get_layout(%rmem_7871) : !memref_rmem_bf16_12 loc(#loc493)
        %tile_7886 = cute.make_tile() : () -> !cute.tile<"[_;_;2:1]"> loc(#loc493)
        %div_7887 = cute.logical_divide(%lay_7885, %tile_7886) : !cute.layout<"((2,2),2,8):((1,2),4,8)">, !cute.tile<"[_;_;2:1]"> loc(#loc493)
        %2638 = cute.get_shape(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
        %e0_7888, %e1_7889, %e2_7890, %e3_7891, %e4_7892 = cute.get_leaves(%2638) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
        %2639 = cute.get_shape(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
        %e0_7893, %e1_7894, %e2_7895, %e3_7896, %e4_7897 = cute.get_leaves(%2639) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc494)
        %2640 = cute.get_shape(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc495)
        %e0_7898, %e1_7899, %e2_7900, %e3_7901, %e4_7902 = cute.get_leaves(%2640) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc495)
        %2641 = cute.get_shape(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.shape<"((2,2),2,(2,4))"> loc(#loc496)
        %e0_7903, %e1_7904, %e2_7905, %e3_7906, %e4_7907 = cute.get_leaves(%2641) : !cute.shape<"((2,2),2,(2,4))"> loc(#loc496)
        %2642 = cute.get_stride(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
        %e0_7908, %e1_7909, %e2_7910, %e3_7911, %e4_7912 = cute.get_leaves(%2642) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
        %2643 = cute.get_stride(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
        %e0_7913, %e1_7914, %e2_7915, %e3_7916, %e4_7917 = cute.get_leaves(%2643) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc497)
        %2644 = cute.get_stride(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc498)
        %e0_7918, %e1_7919, %e2_7920, %e3_7921, %e4_7922 = cute.get_leaves(%2644) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc498)
        %2645 = cute.get_stride(%div_7887) : (!cute.layout<"((2,2),2,(2,4)):((1,2),4,(8,16))">) -> !cute.stride<"((1,2),4,(8,16))"> loc(#loc499)
        %e0_7923, %e1_7924, %e2_7925, %e3_7926, %e4_7927 = cute.get_leaves(%2645) : !cute.stride<"((1,2),4,(8,16))"> loc(#loc499)
        %shape_7928 = cute.make_shape() : () -> !cute.shape<"(((2,2),2),2,4)"> loc(#loc500)
        %stride_7929 = cute.make_stride() : () -> !cute.stride<"(((1,2),8),4,16)"> loc(#loc500)
        %lay_7930 = cute.make_layout(%shape_7928, %stride_7929) : !cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)"> loc(#loc500)
        %view_7931 = cute.make_view(%iter_7873, %lay_7930) : !memref_rmem_bf16_13 loc(#loc501)
        %iter_7932 = cute.get_iter(%view_7931) : !memref_rmem_bf16_13 loc(#loc331)
        %coord_7933 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc502)
        %slice_7934 = cute.slice(%src_partitioned_329, %coord_7933) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)"> loc(#loc502)
        %iter_7935 = cute.get_iter(%slice_7934) : !memref_smem_bf16_18 loc(#loc316)
        %iter_7936 = cute.get_iter(%slice_7934) : !memref_smem_bf16_18 loc(#loc317)
        %coord_7937 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc503)
        %slice_7938 = cute.slice(%retiled_331, %coord_7937) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)"> loc(#loc503)
        %iter_7939 = cute.get_iter(%slice_7938) : !memref_rmem_bf16_14 loc(#loc316)
        %iter_7940 = cute.get_iter(%slice_7938) : !memref_rmem_bf16_14 loc(#loc317)
        %lay_7941 = cute.get_layout(%slice_7934) : !memref_smem_bf16_18 loc(#loc311)
        %2646 = cute.get_shape(%lay_7941) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_7942, %e1_7943, %e2_7944, %e3_7945, %e4_7946 = cute.get_leaves(%2646) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %lay_7947 = cute.get_layout(%slice_7938) : !memref_rmem_bf16_14 loc(#loc311)
        %2647 = cute.get_shape(%lay_7947) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_7948, %e1_7949, %e2_7950, %e3_7951 = cute.get_leaves(%2647) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_7952 = cute.get_layout(%slice_7934) : !memref_smem_bf16_18 loc(#loc397)
        %shape_7953 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7954 = cute.make_layout(%shape_7953) : !cute.layout<"1:0"> loc(#loc397)
        %append_7955 = cute.append_to_rank<2> (%lay_7952, %lay_7954) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
        %view_7956 = cute.make_view(%iter_7936, %append_7955) : !memref_smem_bf16_18 loc(#loc398)
        %iter_7957 = cute.get_iter(%view_7956) : !memref_smem_bf16_18 loc(#loc331)
        %lay_7958 = cute.get_layout(%view_7956) : !memref_smem_bf16_18 loc(#loc311)
        %2648 = cute.get_shape(%lay_7958) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_7959, %e1_7960, %e2_7961, %e3_7962, %e4_7963 = cute.get_leaves(%2648) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %grouped_7964 = cute.group_modes(%view_7956) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
        %iter_7965 = cute.get_iter(%grouped_7964) : !memref_smem_bf16_19 loc(#loc399)
        %iter_7966 = cute.get_iter(%grouped_7964) : !memref_smem_bf16_19 loc(#loc317)
        %lay_7967 = cute.get_layout(%slice_7938) : !memref_rmem_bf16_14 loc(#loc397)
        %shape_7968 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_7969 = cute.make_layout(%shape_7968) : !cute.layout<"1:0"> loc(#loc397)
        %append_7970 = cute.append_to_rank<2> (%lay_7967, %lay_7969) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
        %view_7971 = cute.make_view(%iter_7940, %append_7970) : !memref_rmem_bf16_14 loc(#loc400)
        %iter_7972 = cute.get_iter(%view_7971) : !memref_rmem_bf16_14 loc(#loc331)
        %lay_7973 = cute.get_layout(%view_7971) : !memref_rmem_bf16_14 loc(#loc311)
        %2649 = cute.get_shape(%lay_7973) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_7974, %e1_7975, %e2_7976, %e3_7977 = cute.get_leaves(%2649) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %grouped_7978 = cute.group_modes(%view_7971) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
        %iter_7979 = cute.get_iter(%grouped_7978) : !memref_rmem_bf16_15 loc(#loc399)
        %iter_7980 = cute.get_iter(%grouped_7978) : !memref_rmem_bf16_15 loc(#loc317)
        %lay_7981 = cute.get_layout(%grouped_7964) : !memref_smem_bf16_19 loc(#loc311)
        %2650 = cute.get_shape(%lay_7981) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %e0_7982, %e1_7983, %e2_7984, %e3_7985, %e4_7986 = cute.get_leaves(%2650) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %lay_7987 = cute.get_layout(%grouped_7978) : !memref_rmem_bf16_15 loc(#loc311)
        %2651 = cute.get_shape(%lay_7987) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %e0_7988, %e1_7989, %e2_7990, %e3_7991 = cute.get_leaves(%2651) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %sz_7992 = cute.size(%grouped_7964) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_7993 = cute.get_leaves(%sz_7992) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_7994 = cute.size(%grouped_7978) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_7995 = cute.get_leaves(%sz_7994) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%138, %grouped_7964, %grouped_7978) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc504)
        %lay_7996 = cute.get_layout(%view_7931) : !memref_rmem_bf16_13 loc(#loc311)
        %2652 = cute.get_shape(%lay_7996) : (!cute.layout<"(((2,2),2),2,4):(((1,2),8),4,16)">) -> !cute.shape<"(((2,2),2),2,4)"> loc(#loc311)
        %e0_7997, %e1_7998, %e2_7999, %e3_8000, %e4_8001 = cute.get_leaves(%2652) : !cute.shape<"(((2,2),2),2,4)"> loc(#loc311)
        %int_tuple_8002 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc505)
        %sz_8003 = cute.size(%int_tuple_8002) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc505)
        %e0_8004 = cute.get_leaves(%sz_8003) : !cute.int_tuple<"4"> loc(#loc505)
        %int_tuple_8005 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
        %sz_8006 = cute.size(%int_tuple_8005) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
        %e0_8007 = cute.get_leaves(%sz_8006) : !cute.int_tuple<"4"> loc(#loc506)
        %coord_8008 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc507)
        %slice_8009 = cute.slice(%src_partitioned_329, %coord_8008) : !memref_smem_bf16_10, !cute.coord<"(_,_,1)"> loc(#loc507)
        %iter_8010 = cute.get_iter(%slice_8009) : !memref_smem_bf16_18 loc(#loc316)
        %iter_8011 = cute.get_iter(%slice_8009) : !memref_smem_bf16_18 loc(#loc317)
        %coord_8012 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc508)
        %slice_8013 = cute.slice(%retiled_331, %coord_8012) : !memref_rmem_bf16_5, !cute.coord<"(_,_,1)"> loc(#loc508)
        %iter_8014 = cute.get_iter(%slice_8013) : !memref_rmem_bf16_14 loc(#loc316)
        %iter_8015 = cute.get_iter(%slice_8013) : !memref_rmem_bf16_14 loc(#loc317)
        %lay_8016 = cute.get_layout(%slice_8009) : !memref_smem_bf16_18 loc(#loc311)
        %2653 = cute.get_shape(%lay_8016) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8017, %e1_8018, %e2_8019, %e3_8020, %e4_8021 = cute.get_leaves(%2653) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %lay_8022 = cute.get_layout(%slice_8013) : !memref_rmem_bf16_14 loc(#loc311)
        %2654 = cute.get_shape(%lay_8022) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8023, %e1_8024, %e2_8025, %e3_8026 = cute.get_leaves(%2654) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_8027 = cute.get_layout(%slice_8009) : !memref_smem_bf16_18 loc(#loc397)
        %shape_8028 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8029 = cute.make_layout(%shape_8028) : !cute.layout<"1:0"> loc(#loc397)
        %append_8030 = cute.append_to_rank<2> (%lay_8027, %lay_8029) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8031 = cute.make_view(%iter_8011, %append_8030) : !memref_smem_bf16_18 loc(#loc398)
        %iter_8032 = cute.get_iter(%view_8031) : !memref_smem_bf16_18 loc(#loc331)
        %lay_8033 = cute.get_layout(%view_8031) : !memref_smem_bf16_18 loc(#loc311)
        %2655 = cute.get_shape(%lay_8033) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8034, %e1_8035, %e2_8036, %e3_8037, %e4_8038 = cute.get_leaves(%2655) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %grouped_8039 = cute.group_modes(%view_8031) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
        %iter_8040 = cute.get_iter(%grouped_8039) : !memref_smem_bf16_19 loc(#loc399)
        %iter_8041 = cute.get_iter(%grouped_8039) : !memref_smem_bf16_19 loc(#loc317)
        %lay_8042 = cute.get_layout(%slice_8013) : !memref_rmem_bf16_14 loc(#loc397)
        %shape_8043 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8044 = cute.make_layout(%shape_8043) : !cute.layout<"1:0"> loc(#loc397)
        %append_8045 = cute.append_to_rank<2> (%lay_8042, %lay_8044) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8046 = cute.make_view(%iter_8015, %append_8045) : !memref_rmem_bf16_14 loc(#loc400)
        %iter_8047 = cute.get_iter(%view_8046) : !memref_rmem_bf16_14 loc(#loc331)
        %lay_8048 = cute.get_layout(%view_8046) : !memref_rmem_bf16_14 loc(#loc311)
        %2656 = cute.get_shape(%lay_8048) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8049, %e1_8050, %e2_8051, %e3_8052 = cute.get_leaves(%2656) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %grouped_8053 = cute.group_modes(%view_8046) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
        %iter_8054 = cute.get_iter(%grouped_8053) : !memref_rmem_bf16_15 loc(#loc399)
        %iter_8055 = cute.get_iter(%grouped_8053) : !memref_rmem_bf16_15 loc(#loc317)
        %lay_8056 = cute.get_layout(%grouped_8039) : !memref_smem_bf16_19 loc(#loc311)
        %2657 = cute.get_shape(%lay_8056) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %e0_8057, %e1_8058, %e2_8059, %e3_8060, %e4_8061 = cute.get_leaves(%2657) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %lay_8062 = cute.get_layout(%grouped_8053) : !memref_rmem_bf16_15 loc(#loc311)
        %2658 = cute.get_shape(%lay_8062) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %e0_8063, %e1_8064, %e2_8065, %e3_8066 = cute.get_leaves(%2658) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %sz_8067 = cute.size(%grouped_8039) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8068 = cute.get_leaves(%sz_8067) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_8069 = cute.size(%grouped_8053) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8070 = cute.get_leaves(%sz_8069) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%138, %grouped_8039, %grouped_8053) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
        %coord_8071 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc510)
        %slice_8072 = cute.slice(%view_7931, %coord_8071) : !memref_rmem_bf16_13, !cute.coord<"(_,_,0)"> loc(#loc510)
        %iter_8073 = cute.get_iter(%slice_8072) : !memref_rmem_bf16_16 loc(#loc316)
        %iter_8074 = cute.get_iter(%slice_8072) : !memref_rmem_bf16_16 loc(#loc317)
        %coord_8075 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc511)
        %slice_8076 = cute.slice(%frg_B_256, %coord_8075) : !memref_rmem_bf16_2, !cute.coord<"(_,_,0)"> loc(#loc511)
        %iter_8077 = cute.get_iter(%slice_8076) : !memref_rmem_bf16_17 loc(#loc316)
        %iter_8078 = cute.get_iter(%slice_8076) : !memref_rmem_bf16_17 loc(#loc317)
        %lay_8079 = cute.get_layout(%slice_8072) : !memref_rmem_bf16_16 loc(#loc311)
        %2659 = cute.get_shape(%lay_8079) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %e0_8080, %e1_8081, %e2_8082, %e3_8083 = cute.get_leaves(%2659) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %lay_8084 = cute.get_layout(%slice_8076) : !memref_rmem_bf16_17 loc(#loc311)
        %2660 = cute.get_shape(%lay_8084) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        %e0_8085, %e1_8086, %e2_8087, %e3_8088 = cute.get_leaves(%2660) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        %lay_8089 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc311)
        %2661 = cute.get_shape(%lay_8089) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc311)
        %e0_8090, %e1_8091, %e2_8092, %e3_8093 = cute.get_leaves(%2661) : !cute.shape<"((2,2),2,16)"> loc(#loc311)
        cute.gemm(%arg10, %rmem, %slice_8072, %slice_8076, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
        %int_tuple_8094 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
        %sz_8095 = cute.size(%int_tuple_8094) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
        %e0_8096 = cute.get_leaves(%sz_8095) : !cute.int_tuple<"4"> loc(#loc506)
        %coord_8097 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc507)
        %slice_8098 = cute.slice(%src_partitioned_329, %coord_8097) : !memref_smem_bf16_10, !cute.coord<"(_,_,2)"> loc(#loc507)
        %iter_8099 = cute.get_iter(%slice_8098) : !memref_smem_bf16_18 loc(#loc316)
        %iter_8100 = cute.get_iter(%slice_8098) : !memref_smem_bf16_18 loc(#loc317)
        %coord_8101 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc508)
        %slice_8102 = cute.slice(%retiled_331, %coord_8101) : !memref_rmem_bf16_5, !cute.coord<"(_,_,2)"> loc(#loc508)
        %iter_8103 = cute.get_iter(%slice_8102) : !memref_rmem_bf16_14 loc(#loc316)
        %iter_8104 = cute.get_iter(%slice_8102) : !memref_rmem_bf16_14 loc(#loc317)
        %lay_8105 = cute.get_layout(%slice_8098) : !memref_smem_bf16_18 loc(#loc311)
        %2662 = cute.get_shape(%lay_8105) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8106, %e1_8107, %e2_8108, %e3_8109, %e4_8110 = cute.get_leaves(%2662) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %lay_8111 = cute.get_layout(%slice_8102) : !memref_rmem_bf16_14 loc(#loc311)
        %2663 = cute.get_shape(%lay_8111) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8112, %e1_8113, %e2_8114, %e3_8115 = cute.get_leaves(%2663) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_8116 = cute.get_layout(%slice_8098) : !memref_smem_bf16_18 loc(#loc397)
        %shape_8117 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8118 = cute.make_layout(%shape_8117) : !cute.layout<"1:0"> loc(#loc397)
        %append_8119 = cute.append_to_rank<2> (%lay_8116, %lay_8118) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8120 = cute.make_view(%iter_8100, %append_8119) : !memref_smem_bf16_18 loc(#loc398)
        %iter_8121 = cute.get_iter(%view_8120) : !memref_smem_bf16_18 loc(#loc331)
        %lay_8122 = cute.get_layout(%view_8120) : !memref_smem_bf16_18 loc(#loc311)
        %2664 = cute.get_shape(%lay_8122) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8123, %e1_8124, %e2_8125, %e3_8126, %e4_8127 = cute.get_leaves(%2664) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %grouped_8128 = cute.group_modes(%view_8120) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
        %iter_8129 = cute.get_iter(%grouped_8128) : !memref_smem_bf16_19 loc(#loc399)
        %iter_8130 = cute.get_iter(%grouped_8128) : !memref_smem_bf16_19 loc(#loc317)
        %lay_8131 = cute.get_layout(%slice_8102) : !memref_rmem_bf16_14 loc(#loc397)
        %shape_8132 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8133 = cute.make_layout(%shape_8132) : !cute.layout<"1:0"> loc(#loc397)
        %append_8134 = cute.append_to_rank<2> (%lay_8131, %lay_8133) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8135 = cute.make_view(%iter_8104, %append_8134) : !memref_rmem_bf16_14 loc(#loc400)
        %iter_8136 = cute.get_iter(%view_8135) : !memref_rmem_bf16_14 loc(#loc331)
        %lay_8137 = cute.get_layout(%view_8135) : !memref_rmem_bf16_14 loc(#loc311)
        %2665 = cute.get_shape(%lay_8137) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8138, %e1_8139, %e2_8140, %e3_8141 = cute.get_leaves(%2665) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %grouped_8142 = cute.group_modes(%view_8135) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
        %iter_8143 = cute.get_iter(%grouped_8142) : !memref_rmem_bf16_15 loc(#loc399)
        %iter_8144 = cute.get_iter(%grouped_8142) : !memref_rmem_bf16_15 loc(#loc317)
        %lay_8145 = cute.get_layout(%grouped_8128) : !memref_smem_bf16_19 loc(#loc311)
        %2666 = cute.get_shape(%lay_8145) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %e0_8146, %e1_8147, %e2_8148, %e3_8149, %e4_8150 = cute.get_leaves(%2666) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %lay_8151 = cute.get_layout(%grouped_8142) : !memref_rmem_bf16_15 loc(#loc311)
        %2667 = cute.get_shape(%lay_8151) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %e0_8152, %e1_8153, %e2_8154, %e3_8155 = cute.get_leaves(%2667) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %sz_8156 = cute.size(%grouped_8128) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8157 = cute.get_leaves(%sz_8156) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_8158 = cute.size(%grouped_8142) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8159 = cute.get_leaves(%sz_8158) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%138, %grouped_8128, %grouped_8142) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
        %coord_8160 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc510)
        %slice_8161 = cute.slice(%view_7931, %coord_8160) : !memref_rmem_bf16_13, !cute.coord<"(_,_,1)"> loc(#loc510)
        %iter_8162 = cute.get_iter(%slice_8161) : !memref_rmem_bf16_16 loc(#loc316)
        %iter_8163 = cute.get_iter(%slice_8161) : !memref_rmem_bf16_16 loc(#loc317)
        %coord_8164 = cute.make_coord() : () -> !cute.coord<"(_,_,1)"> loc(#loc511)
        %slice_8165 = cute.slice(%frg_B_256, %coord_8164) : !memref_rmem_bf16_2, !cute.coord<"(_,_,1)"> loc(#loc511)
        %iter_8166 = cute.get_iter(%slice_8165) : !memref_rmem_bf16_17 loc(#loc316)
        %iter_8167 = cute.get_iter(%slice_8165) : !memref_rmem_bf16_17 loc(#loc317)
        %lay_8168 = cute.get_layout(%slice_8161) : !memref_rmem_bf16_16 loc(#loc311)
        %2668 = cute.get_shape(%lay_8168) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %e0_8169, %e1_8170, %e2_8171, %e3_8172 = cute.get_leaves(%2668) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %lay_8173 = cute.get_layout(%slice_8165) : !memref_rmem_bf16_17 loc(#loc311)
        %2669 = cute.get_shape(%lay_8173) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        %e0_8174, %e1_8175, %e2_8176, %e3_8177 = cute.get_leaves(%2669) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        cute.gemm(%arg10, %rmem, %slice_8161, %slice_8165, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
        %int_tuple_8178 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
        %sz_8179 = cute.size(%int_tuple_8178) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
        %e0_8180 = cute.get_leaves(%sz_8179) : !cute.int_tuple<"4"> loc(#loc506)
        %coord_8181 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc507)
        %slice_8182 = cute.slice(%src_partitioned_329, %coord_8181) : !memref_smem_bf16_10, !cute.coord<"(_,_,3)"> loc(#loc507)
        %iter_8183 = cute.get_iter(%slice_8182) : !memref_smem_bf16_18 loc(#loc316)
        %iter_8184 = cute.get_iter(%slice_8182) : !memref_smem_bf16_18 loc(#loc317)
        %coord_8185 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc508)
        %slice_8186 = cute.slice(%retiled_331, %coord_8185) : !memref_rmem_bf16_5, !cute.coord<"(_,_,3)"> loc(#loc508)
        %iter_8187 = cute.get_iter(%slice_8186) : !memref_rmem_bf16_14 loc(#loc316)
        %iter_8188 = cute.get_iter(%slice_8186) : !memref_rmem_bf16_14 loc(#loc317)
        %lay_8189 = cute.get_layout(%slice_8182) : !memref_smem_bf16_18 loc(#loc311)
        %2670 = cute.get_shape(%lay_8189) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8190, %e1_8191, %e2_8192, %e3_8193, %e4_8194 = cute.get_leaves(%2670) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %lay_8195 = cute.get_layout(%slice_8186) : !memref_rmem_bf16_14 loc(#loc311)
        %2671 = cute.get_shape(%lay_8195) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8196, %e1_8197, %e2_8198, %e3_8199 = cute.get_leaves(%2671) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_8200 = cute.get_layout(%slice_8182) : !memref_smem_bf16_18 loc(#loc397)
        %shape_8201 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8202 = cute.make_layout(%shape_8201) : !cute.layout<"1:0"> loc(#loc397)
        %append_8203 = cute.append_to_rank<2> (%lay_8200, %lay_8202) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8204 = cute.make_view(%iter_8184, %append_8203) : !memref_smem_bf16_18 loc(#loc398)
        %iter_8205 = cute.get_iter(%view_8204) : !memref_smem_bf16_18 loc(#loc331)
        %lay_8206 = cute.get_layout(%view_8204) : !memref_smem_bf16_18 loc(#loc311)
        %2672 = cute.get_shape(%lay_8206) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8207, %e1_8208, %e2_8209, %e3_8210, %e4_8211 = cute.get_leaves(%2672) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %grouped_8212 = cute.group_modes(%view_8204) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
        %iter_8213 = cute.get_iter(%grouped_8212) : !memref_smem_bf16_19 loc(#loc399)
        %iter_8214 = cute.get_iter(%grouped_8212) : !memref_smem_bf16_19 loc(#loc317)
        %lay_8215 = cute.get_layout(%slice_8186) : !memref_rmem_bf16_14 loc(#loc397)
        %shape_8216 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8217 = cute.make_layout(%shape_8216) : !cute.layout<"1:0"> loc(#loc397)
        %append_8218 = cute.append_to_rank<2> (%lay_8215, %lay_8217) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8219 = cute.make_view(%iter_8188, %append_8218) : !memref_rmem_bf16_14 loc(#loc400)
        %iter_8220 = cute.get_iter(%view_8219) : !memref_rmem_bf16_14 loc(#loc331)
        %lay_8221 = cute.get_layout(%view_8219) : !memref_rmem_bf16_14 loc(#loc311)
        %2673 = cute.get_shape(%lay_8221) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8222, %e1_8223, %e2_8224, %e3_8225 = cute.get_leaves(%2673) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %grouped_8226 = cute.group_modes(%view_8219) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
        %iter_8227 = cute.get_iter(%grouped_8226) : !memref_rmem_bf16_15 loc(#loc399)
        %iter_8228 = cute.get_iter(%grouped_8226) : !memref_rmem_bf16_15 loc(#loc317)
        %lay_8229 = cute.get_layout(%grouped_8212) : !memref_smem_bf16_19 loc(#loc311)
        %2674 = cute.get_shape(%lay_8229) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %e0_8230, %e1_8231, %e2_8232, %e3_8233, %e4_8234 = cute.get_leaves(%2674) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %lay_8235 = cute.get_layout(%grouped_8226) : !memref_rmem_bf16_15 loc(#loc311)
        %2675 = cute.get_shape(%lay_8235) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %e0_8236, %e1_8237, %e2_8238, %e3_8239 = cute.get_leaves(%2675) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %sz_8240 = cute.size(%grouped_8212) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8241 = cute.get_leaves(%sz_8240) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_8242 = cute.size(%grouped_8226) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8243 = cute.get_leaves(%sz_8242) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%138, %grouped_8212, %grouped_8226) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
        %coord_8244 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc510)
        %slice_8245 = cute.slice(%view_7931, %coord_8244) : !memref_rmem_bf16_13, !cute.coord<"(_,_,2)"> loc(#loc510)
        %iter_8246 = cute.get_iter(%slice_8245) : !memref_rmem_bf16_16 loc(#loc316)
        %iter_8247 = cute.get_iter(%slice_8245) : !memref_rmem_bf16_16 loc(#loc317)
        %coord_8248 = cute.make_coord() : () -> !cute.coord<"(_,_,2)"> loc(#loc511)
        %slice_8249 = cute.slice(%frg_B_256, %coord_8248) : !memref_rmem_bf16_2, !cute.coord<"(_,_,2)"> loc(#loc511)
        %iter_8250 = cute.get_iter(%slice_8249) : !memref_rmem_bf16_17 loc(#loc316)
        %iter_8251 = cute.get_iter(%slice_8249) : !memref_rmem_bf16_17 loc(#loc317)
        %lay_8252 = cute.get_layout(%slice_8245) : !memref_rmem_bf16_16 loc(#loc311)
        %2676 = cute.get_shape(%lay_8252) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %e0_8253, %e1_8254, %e2_8255, %e3_8256 = cute.get_leaves(%2676) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %lay_8257 = cute.get_layout(%slice_8249) : !memref_rmem_bf16_17 loc(#loc311)
        %2677 = cute.get_shape(%lay_8257) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        %e0_8258, %e1_8259, %e2_8260, %e3_8261 = cute.get_leaves(%2677) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        cute.gemm(%arg10, %rmem, %slice_8245, %slice_8249, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
        %int_tuple_8262 = cute.make_int_tuple() : () -> !cute.int_tuple<"4"> loc(#loc506)
        %sz_8263 = cute.size(%int_tuple_8262) : (!cute.int_tuple<"4">) -> !cute.int_tuple<"4"> loc(#loc506)
        %e0_8264 = cute.get_leaves(%sz_8263) : !cute.int_tuple<"4"> loc(#loc506)
        %coord_8265 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc507)
        %slice_8266 = cute.slice(%src_partitioned_329, %coord_8265) : !memref_smem_bf16_10, !cute.coord<"(_,_,0)"> loc(#loc507)
        %iter_8267 = cute.get_iter(%slice_8266) : !memref_smem_bf16_18 loc(#loc316)
        %iter_8268 = cute.get_iter(%slice_8266) : !memref_smem_bf16_18 loc(#loc317)
        %coord_8269 = cute.make_coord() : () -> !cute.coord<"(_,_,0)"> loc(#loc508)
        %slice_8270 = cute.slice(%retiled_331, %coord_8269) : !memref_rmem_bf16_5, !cute.coord<"(_,_,0)"> loc(#loc508)
        %iter_8271 = cute.get_iter(%slice_8270) : !memref_rmem_bf16_14 loc(#loc316)
        %iter_8272 = cute.get_iter(%slice_8270) : !memref_rmem_bf16_14 loc(#loc317)
        %lay_8273 = cute.get_layout(%slice_8266) : !memref_smem_bf16_18 loc(#loc311)
        %2678 = cute.get_shape(%lay_8273) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8274, %e1_8275, %e2_8276, %e3_8277, %e4_8278 = cute.get_leaves(%2678) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %lay_8279 = cute.get_layout(%slice_8270) : !memref_rmem_bf16_14 loc(#loc311)
        %2679 = cute.get_shape(%lay_8279) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8280, %e1_8281, %e2_8282, %e3_8283 = cute.get_leaves(%2679) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %lay_8284 = cute.get_layout(%slice_8266) : !memref_smem_bf16_18 loc(#loc397)
        %shape_8285 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8286 = cute.make_layout(%shape_8285) : !cute.layout<"1:0"> loc(#loc397)
        %append_8287 = cute.append_to_rank<2> (%lay_8284, %lay_8286) : !cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8288 = cute.make_view(%iter_8268, %append_8287) : !memref_smem_bf16_18 loc(#loc398)
        %iter_8289 = cute.get_iter(%view_8288) : !memref_smem_bf16_18 loc(#loc331)
        %lay_8290 = cute.get_layout(%view_8288) : !memref_smem_bf16_18 loc(#loc311)
        %2680 = cute.get_shape(%lay_8290) : (!cute.layout<"((8,1),((2,2),2)):((1,0),((?{div=16},?{div=32}),4096))">) -> !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %e0_8291, %e1_8292, %e2_8293, %e3_8294, %e4_8295 = cute.get_leaves(%2680) : !cute.shape<"((8,1),((2,2),2))"> loc(#loc311)
        %grouped_8296 = cute.group_modes(%view_8288) <1, 2> : (!memref_smem_bf16_18) -> !memref_smem_bf16_19 loc(#loc398)
        %iter_8297 = cute.get_iter(%grouped_8296) : !memref_smem_bf16_19 loc(#loc399)
        %iter_8298 = cute.get_iter(%grouped_8296) : !memref_smem_bf16_19 loc(#loc317)
        %lay_8299 = cute.get_layout(%slice_8270) : !memref_rmem_bf16_14 loc(#loc397)
        %shape_8300 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_8301 = cute.make_layout(%shape_8300) : !cute.layout<"1:0"> loc(#loc397)
        %append_8302 = cute.append_to_rank<2> (%lay_8299, %lay_8301) : !cute.layout<"((8,1),(4,2)):((1,0),(8,128))">, !cute.layout<"1:0"> loc(#loc397)
        %view_8303 = cute.make_view(%iter_8272, %append_8302) : !memref_rmem_bf16_14 loc(#loc400)
        %iter_8304 = cute.get_iter(%view_8303) : !memref_rmem_bf16_14 loc(#loc331)
        %lay_8305 = cute.get_layout(%view_8303) : !memref_rmem_bf16_14 loc(#loc311)
        %2681 = cute.get_shape(%lay_8305) : (!cute.layout<"((8,1),(4,2)):((1,0),(8,128))">) -> !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %e0_8306, %e1_8307, %e2_8308, %e3_8309 = cute.get_leaves(%2681) : !cute.shape<"((8,1),(4,2))"> loc(#loc311)
        %grouped_8310 = cute.group_modes(%view_8303) <1, 2> : (!memref_rmem_bf16_14) -> !memref_rmem_bf16_15 loc(#loc400)
        %iter_8311 = cute.get_iter(%grouped_8310) : !memref_rmem_bf16_15 loc(#loc399)
        %iter_8312 = cute.get_iter(%grouped_8310) : !memref_rmem_bf16_15 loc(#loc317)
        %lay_8313 = cute.get_layout(%grouped_8296) : !memref_smem_bf16_19 loc(#loc311)
        %2682 = cute.get_shape(%lay_8313) : (!cute.layout<"((8,1),(((2,2),2))):((1,0),(((?{div=16},?{div=32}),4096)))">) -> !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %e0_8314, %e1_8315, %e2_8316, %e3_8317, %e4_8318 = cute.get_leaves(%2682) : !cute.shape<"((8,1),(((2,2),2)))"> loc(#loc311)
        %lay_8319 = cute.get_layout(%grouped_8310) : !memref_rmem_bf16_15 loc(#loc311)
        %2683 = cute.get_shape(%lay_8319) : (!cute.layout<"((8,1),((4,2))):((1,0),((8,128)))">) -> !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %e0_8320, %e1_8321, %e2_8322, %e3_8323 = cute.get_leaves(%2683) : !cute.shape<"((8,1),((4,2)))"> loc(#loc311)
        %sz_8324 = cute.size(%grouped_8296) <{mode = [1]}> : (!memref_smem_bf16_19) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8325 = cute.get_leaves(%sz_8324) : !cute.int_tuple<"8"> loc(#loc402)
        %sz_8326 = cute.size(%grouped_8310) <{mode = [1]}> : (!memref_rmem_bf16_15) -> !cute.int_tuple<"8"> loc(#loc402)
        %e0_8327 = cute.get_leaves(%sz_8326) : !cute.int_tuple<"8"> loc(#loc402)
        cute.copy(%138, %grouped_8296, %grouped_8310) : (!copy_ldsm_4_2, !memref_smem_bf16_19, !memref_rmem_bf16_15) loc(#loc509)
        %coord_8328 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc510)
        %slice_8329 = cute.slice(%view_7931, %coord_8328) : !memref_rmem_bf16_13, !cute.coord<"(_,_,3)"> loc(#loc510)
        %iter_8330 = cute.get_iter(%slice_8329) : !memref_rmem_bf16_16 loc(#loc316)
        %iter_8331 = cute.get_iter(%slice_8329) : !memref_rmem_bf16_16 loc(#loc317)
        %coord_8332 = cute.make_coord() : () -> !cute.coord<"(_,_,3)"> loc(#loc511)
        %slice_8333 = cute.slice(%frg_B_256, %coord_8332) : !memref_rmem_bf16_2, !cute.coord<"(_,_,3)"> loc(#loc511)
        %iter_8334 = cute.get_iter(%slice_8333) : !memref_rmem_bf16_17 loc(#loc316)
        %iter_8335 = cute.get_iter(%slice_8333) : !memref_rmem_bf16_17 loc(#loc317)
        %lay_8336 = cute.get_layout(%slice_8329) : !memref_rmem_bf16_16 loc(#loc311)
        %2684 = cute.get_shape(%lay_8336) : (!cute.layout<"(((2,2),2),2):(((1,2),8),4)">) -> !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %e0_8337, %e1_8338, %e2_8339, %e3_8340 = cute.get_leaves(%2684) : !cute.shape<"(((2,2),2),2)"> loc(#loc311)
        %lay_8341 = cute.get_layout(%slice_8333) : !memref_rmem_bf16_17 loc(#loc311)
        %2685 = cute.get_shape(%lay_8341) : (!cute.layout<"((2,2),(8,2)):((1,2),(4,128))">) -> !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        %e0_8342, %e1_8343, %e2_8344, %e3_8345 = cute.get_leaves(%2685) : !cute.shape<"((2,2),(8,2))"> loc(#loc311)
        cute.gemm(%arg10, %rmem, %slice_8329, %slice_8333, %rmem) : (!mma_bf16_bf16_f32_16x8x16_, !memref_rmem_f32_, !memref_rmem_bf16_16, !memref_rmem_bf16_17, !memref_rmem_f32_) loc(#loc512)
        scf.yield %2365, %arg13, %2365, %arg15, %arg16, %arg17, %arg18 : i32, i32, i32, !memref_gmem_bf16_, !memref_gmem_bf16_, i32, i32 loc(#loc290)
      } loc(#loc290)
      %iter_5607 = cute.get_iter(%1990#3) : !memref_gmem_bf16_ loc(#loc478)
      %lay_5608 = cute.get_layout(%1990#3) : !memref_gmem_bf16_ loc(#loc294)
      %1991 = cute.get_shape(%lay_5608) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0_5609, %e1_5610, %e2_5611, %e3_5612 = cute.get_leaves(%1991) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup_5613 = cute.to_int_tuple(%e0_5609) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %1992 = cute.get_scalars(%itup_5613) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5614 = cute.to_int_tuple(%e1_5610) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %1993 = cute.get_scalars(%itup_5614) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5615 = cute.to_int_tuple(%e2_5611) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %1994 = cute.get_scalars(%itup_5615) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5616 = cute.to_int_tuple(%e3_5612) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %1995 = cute.get_scalars(%itup_5616) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %1996 = cute.get_stride(%lay_5608) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_5617, %e1_5618, %e2_5619, %e3_5620 = cute.get_leaves(%1996) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_5621 = cute.to_int_tuple(%e0_5617) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %1997 = cute.get_scalars(%itup_5621) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_5622 = cute.to_int_tuple(%e1_5618) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %1998 = cute.get_scalars(%itup_5622) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_5623 = cute.to_int_tuple(%e2_5619) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %1999 = cute.get_scalars(%itup_5623) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %iter_5624 = cute.get_iter(%1990#4) : !memref_gmem_bf16_ loc(#loc478)
      %lay_5625 = cute.get_layout(%1990#4) : !memref_gmem_bf16_ loc(#loc294)
      %2000 = cute.get_shape(%lay_5625) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %e0_5626, %e1_5627, %e2_5628, %e3_5629 = cute.get_leaves(%2000) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
      %itup_5630 = cute.to_int_tuple(%e0_5626) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %2001 = cute.get_scalars(%itup_5630) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5631 = cute.to_int_tuple(%e1_5627) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %2002 = cute.get_scalars(%itup_5631) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5632 = cute.to_int_tuple(%e2_5628) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
      %2003 = cute.get_scalars(%itup_5632) : !cute.int_tuple<"?"> loc(#loc295)
      %itup_5633 = cute.to_int_tuple(%e3_5629) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %2004 = cute.get_scalars(%itup_5633) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
      %2005 = cute.get_stride(%lay_5625) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %e0_5634, %e1_5635, %e2_5636, %e3_5637 = cute.get_leaves(%2005) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
      %itup_5638 = cute.to_int_tuple(%e0_5634) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %2006 = cute.get_scalars(%itup_5638) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_5639 = cute.to_int_tuple(%e1_5635) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %2007 = cute.get_scalars(%itup_5639) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %itup_5640 = cute.to_int_tuple(%e2_5636) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %2008 = cute.get_scalars(%itup_5640) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
      %iter_5641 = cute.get_iter(%1990#3) : !memref_gmem_bf16_ loc(#loc479)
      %iter_5642 = cute.get_iter(%1990#3) : !memref_gmem_bf16_ loc(#loc293)
      %iter_5643 = cute.get_iter(%1990#4) : !memref_gmem_bf16_ loc(#loc479)
      %iter_5644 = cute.get_iter(%1990#4) : !memref_gmem_bf16_ loc(#loc293)
      %lay_5645 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc456)
      %2009 = cute.get_shape(%lay_5645) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %e0_5646, %e1_5647, %e2_5648, %e3_5649 = cute.get_leaves(%2009) : !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %shape_5650 = cute.make_shape() : () -> !cute.shape<"((2,2),2,16)"> loc(#loc456)
      %lay_5651 = cute.make_layout(%shape_5650) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> loc(#loc456)
      %2010 = cute.get_shape(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc457)
      %e0_5652, %e1_5653, %e2_5654, %e3_5655 = cute.get_leaves(%2010) : !cute.shape<"((2,2),2,16)"> loc(#loc457)
      %2011 = cute.get_shape(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc458)
      %e0_5656, %e1_5657, %e2_5658, %e3_5659 = cute.get_leaves(%2011) : !cute.shape<"((2,2),2,16)"> loc(#loc458)
      %2012 = cute.get_shape(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc459)
      %e0_5660, %e1_5661, %e2_5662, %e3_5663 = cute.get_leaves(%2012) : !cute.shape<"((2,2),2,16)"> loc(#loc459)
      %2013 = cute.get_shape(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc460)
      %e0_5664, %e1_5665, %e2_5666, %e3_5667 = cute.get_leaves(%2013) : !cute.shape<"((2,2),2,16)"> loc(#loc460)
      %2014 = cute.get_stride(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %e0_5668, %e1_5669, %e2_5670, %e3_5671 = cute.get_leaves(%2014) : !cute.stride<"((1,2),4,8)"> loc(#loc461)
      %2015 = cute.get_stride(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %e0_5672, %e1_5673, %e2_5674, %e3_5675 = cute.get_leaves(%2015) : !cute.stride<"((1,2),4,8)"> loc(#loc462)
      %2016 = cute.get_stride(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %e0_5676, %e1_5677, %e2_5678, %e3_5679 = cute.get_leaves(%2016) : !cute.stride<"((1,2),4,8)"> loc(#loc463)
      %2017 = cute.get_stride(%lay_5651) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %e0_5680, %e1_5681, %e2_5682, %e3_5683 = cute.get_leaves(%2017) : !cute.stride<"((1,2),4,8)"> loc(#loc464)
      %shape_5684 = cute.make_shape() : () -> !cute.shape<"((2,2),(2,16))"> loc(#loc465)
      %stride_5685 = cute.make_stride() : () -> !cute.stride<"((2,4),(1,8))"> loc(#loc465)
      %lay_5686 = cute.make_layout(%shape_5684, %stride_5685) : !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc465)
      %lay_5687 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc466)
      %2018 = cute.composition(%lay_5687, %lay_5686) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">, !cute.layout<"((2,2),(2,16)):((2,4),(1,8))">) -> !cute.layout<"((2,2),(2,16)):((2,4),(1,8))"> loc(#loc466)
      %view_5688 = cute.make_view(%iter_266, %2018) : !memref_rmem_f32_4 loc(#loc467)
      %iter_5689 = cute.get_iter(%view_5688) : !memref_rmem_f32_4 loc(#loc331)
      %sz_5690 = cute.size(%rmem_924) : (!memref_rmem_f32_1) -> !cute.int_tuple<"4"> loc(#loc520)
      %e0_5691 = cute.get_leaves(%sz_5690) : !cute.int_tuple<"4"> loc(#loc520)
      %coord_5692 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc521)
      %2019 = cute.memref.load(%rmem_924, %coord_5692) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc521)
      %c-1_i32_5693 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_5694 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_5695 = arith.constant 31 : i32 loc(#loc482)
      %2020 = nvvm.shfl.sync  bfly %c-1_i32_5693, %2019, %c2_i32_5694, %c31_i32_5695 : f32 -> f32 loc(#loc482)
      %2021 = arith.addf %2019, %2020 : f32 loc(#loc313)
      %c-1_i32_5696 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_5697 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_5698 = arith.constant 31 : i32 loc(#loc484)
      %2022 = nvvm.shfl.sync  bfly %c-1_i32_5696, %2021, %c1_i32_5697, %c31_i32_5698 : f32 -> f32 loc(#loc484)
      %2023 = arith.addf %2021, %2022 : f32 loc(#loc313)
      %coord_5699 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc521)
      cute.memref.store(%rmem_924, %coord_5699, %2023) : (!memref_rmem_f32_1, !cute.coord<"0">, f32) -> () loc(#loc521)
      %coord_5700 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc522)
      %2024 = cute.memref.load(%rmem_924, %coord_5700) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc522)
      %cst_5701 = arith.constant 0.000000e+00 : f32 loc(#loc290)
      %2025 = arith.cmpf oeq, %2024, %cst_5701 : f32 loc(#loc313)
      %coord_5702 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc522)
      %2026 = cute.memref.load(%rmem_924, %coord_5702) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc522)
      %2027 = arith.cmpf oeq, %2026, %cst_5701 : f32 loc(#loc313)
      %coord_5703 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc522)
      %2028 = cute.memref.load(%rmem_924, %coord_5703) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc522)
      %coord_5704 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc522)
      %2029 = cute.memref.load(%rmem_924, %coord_5704) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc522)
      %2030 = arith.cmpf une, %2028, %2029 : f32 loc(#loc313)
      %2031 = arith.extui %2027 : i1 to i32 loc(#loc290)
      %c0_i32_5705 = arith.constant 0 : i32 loc(#loc290)
      %2032 = arith.cmpi ne, %2031, %c0_i32_5705 : i32 loc(#loc313)
      %2033 = arith.extui %2027 : i1 to i32 loc(#loc290)
      %2034 = arith.extui %2030 : i1 to i32 loc(#loc290)
      %2035 = arith.select %2032, %2033, %2034 : i32 loc(#loc290)
      %c0_i32_5706 = arith.constant 0 : i32 loc(#loc290)
      %2036 = arith.cmpi ne, %2035, %c0_i32_5706 : i32 loc(#loc523)
      %coord_5707 = cute.make_coord() : () -> !cute.coord<"0"> loc(#loc524)
      %2037 = cute.memref.load(%rmem_924, %coord_5707) : (!memref_rmem_f32_1, !cute.coord<"0">) -> f32 loc(#loc524)
      %2038 = nvvm.rcp.approx.ftz.f %2037 : f32 loc(#loc524)
      %cst_5708 = arith.constant 1.000000e+00 : f32 loc(#loc290)
      %2039 = arith.select %2036, %cst_5708, %2038 : f32 loc(#loc290)
      %coord_5709 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc525)
      %slice_5710 = cute.slice(%view_5688, %coord_5709) : !memref_rmem_f32_4, !cute.coord<"(0,_)"> loc(#loc525)
      %iter_5711 = cute.get_iter(%slice_5710) : !memref_rmem_f32_8 loc(#loc316)
      %iter_5712 = cute.get_iter(%slice_5710) : !memref_rmem_f32_8 loc(#loc317)
      %lay_5713 = cute.get_layout(%slice_5710) : !memref_rmem_f32_8 loc(#loc311)
      %2040 = cute.get_shape(%lay_5713) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5714, %e1_5715 = cute.get_leaves(%2040) : !cute.shape<"((2,16))"> loc(#loc311)
      %2041 = cute.memref.load_vec %slice_5710 : !memref_rmem_f32_8 loc(#loc525)
      %2042 = vector.broadcast %2039 : f32 to vector<32xf32> loc(#loc290)
      %2043 = arith.mulf %2041, %2042 : vector<32xf32> loc(#loc485)
      %coord_5716 = cute.make_coord() : () -> !cute.coord<"(0,_)"> loc(#loc525)
      %slice_5717 = cute.slice(%view_5688, %coord_5716) : !memref_rmem_f32_4, !cute.coord<"(0,_)"> loc(#loc525)
      %iter_5718 = cute.get_iter(%slice_5717) : !memref_rmem_f32_8 loc(#loc316)
      %iter_5719 = cute.get_iter(%slice_5717) : !memref_rmem_f32_8 loc(#loc317)
      %lay_5720 = cute.get_layout(%slice_5717) : !memref_rmem_f32_8 loc(#loc311)
      %2044 = cute.get_shape(%lay_5720) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5721, %e1_5722 = cute.get_leaves(%2044) : !cute.shape<"((2,16))"> loc(#loc311)
      %int_tuple_5723 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5724 = cute.size(%int_tuple_5723) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5725 = cute.get_leaves(%sz_5724) : !cute.int_tuple<"32"> loc(#loc525)
      %int_tuple_5726 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5727 = cute.size(%int_tuple_5726) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5728 = cute.get_leaves(%sz_5727) : !cute.int_tuple<"32"> loc(#loc525)
      cute.memref.store_vec %2043, %slice_5717 : !memref_rmem_f32_8 loc(#loc525)
      %coord_5729 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc521)
      %2045 = cute.memref.load(%rmem_924, %coord_5729) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc521)
      %c-1_i32_5730 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_5731 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_5732 = arith.constant 31 : i32 loc(#loc482)
      %2046 = nvvm.shfl.sync  bfly %c-1_i32_5730, %2045, %c2_i32_5731, %c31_i32_5732 : f32 -> f32 loc(#loc482)
      %2047 = arith.addf %2045, %2046 : f32 loc(#loc313)
      %c-1_i32_5733 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_5734 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_5735 = arith.constant 31 : i32 loc(#loc484)
      %2048 = nvvm.shfl.sync  bfly %c-1_i32_5733, %2047, %c1_i32_5734, %c31_i32_5735 : f32 -> f32 loc(#loc484)
      %2049 = arith.addf %2047, %2048 : f32 loc(#loc313)
      %coord_5736 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc521)
      cute.memref.store(%rmem_924, %coord_5736, %2049) : (!memref_rmem_f32_1, !cute.coord<"1">, f32) -> () loc(#loc521)
      %coord_5737 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc522)
      %2050 = cute.memref.load(%rmem_924, %coord_5737) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc522)
      %2051 = arith.cmpf oeq, %2050, %cst_5701 : f32 loc(#loc313)
      %coord_5738 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc522)
      %2052 = cute.memref.load(%rmem_924, %coord_5738) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc522)
      %2053 = arith.cmpf oeq, %2052, %cst_5701 : f32 loc(#loc313)
      %coord_5739 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc522)
      %2054 = cute.memref.load(%rmem_924, %coord_5739) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc522)
      %coord_5740 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc522)
      %2055 = cute.memref.load(%rmem_924, %coord_5740) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc522)
      %2056 = arith.cmpf une, %2054, %2055 : f32 loc(#loc313)
      %2057 = arith.extui %2053 : i1 to i32 loc(#loc290)
      %2058 = arith.cmpi ne, %2057, %c0_i32_5705 : i32 loc(#loc313)
      %2059 = arith.extui %2053 : i1 to i32 loc(#loc290)
      %2060 = arith.extui %2056 : i1 to i32 loc(#loc290)
      %2061 = arith.select %2058, %2059, %2060 : i32 loc(#loc290)
      %2062 = arith.cmpi ne, %2061, %c0_i32_5706 : i32 loc(#loc523)
      %coord_5741 = cute.make_coord() : () -> !cute.coord<"1"> loc(#loc524)
      %2063 = cute.memref.load(%rmem_924, %coord_5741) : (!memref_rmem_f32_1, !cute.coord<"1">) -> f32 loc(#loc524)
      %2064 = nvvm.rcp.approx.ftz.f %2063 : f32 loc(#loc524)
      %2065 = arith.select %2062, %cst_5708, %2064 : f32 loc(#loc290)
      %coord_5742 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc525)
      %slice_5743 = cute.slice(%view_5688, %coord_5742) : !memref_rmem_f32_4, !cute.coord<"(1,_)"> loc(#loc525)
      %iter_5744 = cute.get_iter(%slice_5743) : !memref_rmem_f32_9 loc(#loc316)
      %iter_5745 = cute.get_iter(%slice_5743) : !memref_rmem_f32_9 loc(#loc317)
      %lay_5746 = cute.get_layout(%slice_5743) : !memref_rmem_f32_9 loc(#loc311)
      %2066 = cute.get_shape(%lay_5746) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5747, %e1_5748 = cute.get_leaves(%2066) : !cute.shape<"((2,16))"> loc(#loc311)
      %2067 = cute.memref.load_vec %slice_5743 : !memref_rmem_f32_9 loc(#loc525)
      %2068 = vector.broadcast %2065 : f32 to vector<32xf32> loc(#loc290)
      %2069 = arith.mulf %2067, %2068 : vector<32xf32> loc(#loc485)
      %coord_5749 = cute.make_coord() : () -> !cute.coord<"(1,_)"> loc(#loc525)
      %slice_5750 = cute.slice(%view_5688, %coord_5749) : !memref_rmem_f32_4, !cute.coord<"(1,_)"> loc(#loc525)
      %iter_5751 = cute.get_iter(%slice_5750) : !memref_rmem_f32_9 loc(#loc316)
      %iter_5752 = cute.get_iter(%slice_5750) : !memref_rmem_f32_9 loc(#loc317)
      %lay_5753 = cute.get_layout(%slice_5750) : !memref_rmem_f32_9 loc(#loc311)
      %2070 = cute.get_shape(%lay_5753) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5754, %e1_5755 = cute.get_leaves(%2070) : !cute.shape<"((2,16))"> loc(#loc311)
      %int_tuple_5756 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5757 = cute.size(%int_tuple_5756) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5758 = cute.get_leaves(%sz_5757) : !cute.int_tuple<"32"> loc(#loc525)
      %int_tuple_5759 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5760 = cute.size(%int_tuple_5759) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5761 = cute.get_leaves(%sz_5760) : !cute.int_tuple<"32"> loc(#loc525)
      cute.memref.store_vec %2069, %slice_5750 : !memref_rmem_f32_9 loc(#loc525)
      %coord_5762 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc521)
      %2071 = cute.memref.load(%rmem_924, %coord_5762) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc521)
      %c-1_i32_5763 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_5764 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_5765 = arith.constant 31 : i32 loc(#loc482)
      %2072 = nvvm.shfl.sync  bfly %c-1_i32_5763, %2071, %c2_i32_5764, %c31_i32_5765 : f32 -> f32 loc(#loc482)
      %2073 = arith.addf %2071, %2072 : f32 loc(#loc313)
      %c-1_i32_5766 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_5767 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_5768 = arith.constant 31 : i32 loc(#loc484)
      %2074 = nvvm.shfl.sync  bfly %c-1_i32_5766, %2073, %c1_i32_5767, %c31_i32_5768 : f32 -> f32 loc(#loc484)
      %2075 = arith.addf %2073, %2074 : f32 loc(#loc313)
      %coord_5769 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc521)
      cute.memref.store(%rmem_924, %coord_5769, %2075) : (!memref_rmem_f32_1, !cute.coord<"2">, f32) -> () loc(#loc521)
      %coord_5770 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc522)
      %2076 = cute.memref.load(%rmem_924, %coord_5770) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc522)
      %2077 = arith.cmpf oeq, %2076, %cst_5701 : f32 loc(#loc313)
      %coord_5771 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc522)
      %2078 = cute.memref.load(%rmem_924, %coord_5771) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc522)
      %2079 = arith.cmpf oeq, %2078, %cst_5701 : f32 loc(#loc313)
      %coord_5772 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc522)
      %2080 = cute.memref.load(%rmem_924, %coord_5772) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc522)
      %coord_5773 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc522)
      %2081 = cute.memref.load(%rmem_924, %coord_5773) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc522)
      %2082 = arith.cmpf une, %2080, %2081 : f32 loc(#loc313)
      %2083 = arith.extui %2079 : i1 to i32 loc(#loc290)
      %2084 = arith.cmpi ne, %2083, %c0_i32_5705 : i32 loc(#loc313)
      %2085 = arith.extui %2079 : i1 to i32 loc(#loc290)
      %2086 = arith.extui %2082 : i1 to i32 loc(#loc290)
      %2087 = arith.select %2084, %2085, %2086 : i32 loc(#loc290)
      %2088 = arith.cmpi ne, %2087, %c0_i32_5706 : i32 loc(#loc523)
      %coord_5774 = cute.make_coord() : () -> !cute.coord<"2"> loc(#loc524)
      %2089 = cute.memref.load(%rmem_924, %coord_5774) : (!memref_rmem_f32_1, !cute.coord<"2">) -> f32 loc(#loc524)
      %2090 = nvvm.rcp.approx.ftz.f %2089 : f32 loc(#loc524)
      %2091 = arith.select %2088, %cst_5708, %2090 : f32 loc(#loc290)
      %coord_5775 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc525)
      %slice_5776 = cute.slice(%view_5688, %coord_5775) : !memref_rmem_f32_4, !cute.coord<"(2,_)"> loc(#loc525)
      %iter_5777 = cute.get_iter(%slice_5776) : !memref_rmem_f32_10 loc(#loc316)
      %iter_5778 = cute.get_iter(%slice_5776) : !memref_rmem_f32_10 loc(#loc317)
      %lay_5779 = cute.get_layout(%slice_5776) : !memref_rmem_f32_10 loc(#loc311)
      %2092 = cute.get_shape(%lay_5779) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5780, %e1_5781 = cute.get_leaves(%2092) : !cute.shape<"((2,16))"> loc(#loc311)
      %2093 = cute.memref.load_vec %slice_5776 : !memref_rmem_f32_10 loc(#loc525)
      %2094 = vector.broadcast %2091 : f32 to vector<32xf32> loc(#loc290)
      %2095 = arith.mulf %2093, %2094 : vector<32xf32> loc(#loc485)
      %coord_5782 = cute.make_coord() : () -> !cute.coord<"(2,_)"> loc(#loc525)
      %slice_5783 = cute.slice(%view_5688, %coord_5782) : !memref_rmem_f32_4, !cute.coord<"(2,_)"> loc(#loc525)
      %iter_5784 = cute.get_iter(%slice_5783) : !memref_rmem_f32_10 loc(#loc316)
      %iter_5785 = cute.get_iter(%slice_5783) : !memref_rmem_f32_10 loc(#loc317)
      %lay_5786 = cute.get_layout(%slice_5783) : !memref_rmem_f32_10 loc(#loc311)
      %2096 = cute.get_shape(%lay_5786) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5787, %e1_5788 = cute.get_leaves(%2096) : !cute.shape<"((2,16))"> loc(#loc311)
      %int_tuple_5789 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5790 = cute.size(%int_tuple_5789) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5791 = cute.get_leaves(%sz_5790) : !cute.int_tuple<"32"> loc(#loc525)
      %int_tuple_5792 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5793 = cute.size(%int_tuple_5792) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5794 = cute.get_leaves(%sz_5793) : !cute.int_tuple<"32"> loc(#loc525)
      cute.memref.store_vec %2095, %slice_5783 : !memref_rmem_f32_10 loc(#loc525)
      %coord_5795 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc521)
      %2097 = cute.memref.load(%rmem_924, %coord_5795) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc521)
      %c-1_i32_5796 = arith.constant -1 : i32 loc(#loc482)
      %c2_i32_5797 = arith.constant 2 : i32 loc(#loc482)
      %c31_i32_5798 = arith.constant 31 : i32 loc(#loc482)
      %2098 = nvvm.shfl.sync  bfly %c-1_i32_5796, %2097, %c2_i32_5797, %c31_i32_5798 : f32 -> f32 loc(#loc482)
      %2099 = arith.addf %2097, %2098 : f32 loc(#loc313)
      %c-1_i32_5799 = arith.constant -1 : i32 loc(#loc484)
      %c1_i32_5800 = arith.constant 1 : i32 loc(#loc484)
      %c31_i32_5801 = arith.constant 31 : i32 loc(#loc484)
      %2100 = nvvm.shfl.sync  bfly %c-1_i32_5799, %2099, %c1_i32_5800, %c31_i32_5801 : f32 -> f32 loc(#loc484)
      %2101 = arith.addf %2099, %2100 : f32 loc(#loc313)
      %coord_5802 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc521)
      cute.memref.store(%rmem_924, %coord_5802, %2101) : (!memref_rmem_f32_1, !cute.coord<"3">, f32) -> () loc(#loc521)
      %coord_5803 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc522)
      %2102 = cute.memref.load(%rmem_924, %coord_5803) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc522)
      %2103 = arith.cmpf oeq, %2102, %cst_5701 : f32 loc(#loc313)
      %coord_5804 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc522)
      %2104 = cute.memref.load(%rmem_924, %coord_5804) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc522)
      %2105 = arith.cmpf oeq, %2104, %cst_5701 : f32 loc(#loc313)
      %coord_5805 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc522)
      %2106 = cute.memref.load(%rmem_924, %coord_5805) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc522)
      %coord_5806 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc522)
      %2107 = cute.memref.load(%rmem_924, %coord_5806) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc522)
      %2108 = arith.cmpf une, %2106, %2107 : f32 loc(#loc313)
      %2109 = arith.extui %2105 : i1 to i32 loc(#loc290)
      %2110 = arith.cmpi ne, %2109, %c0_i32_5705 : i32 loc(#loc313)
      %2111 = arith.extui %2105 : i1 to i32 loc(#loc290)
      %2112 = arith.extui %2108 : i1 to i32 loc(#loc290)
      %2113 = arith.select %2110, %2111, %2112 : i32 loc(#loc290)
      %2114 = arith.cmpi ne, %2113, %c0_i32_5706 : i32 loc(#loc523)
      %coord_5807 = cute.make_coord() : () -> !cute.coord<"3"> loc(#loc524)
      %2115 = cute.memref.load(%rmem_924, %coord_5807) : (!memref_rmem_f32_1, !cute.coord<"3">) -> f32 loc(#loc524)
      %2116 = nvvm.rcp.approx.ftz.f %2115 : f32 loc(#loc524)
      %2117 = arith.select %2114, %cst_5708, %2116 : f32 loc(#loc290)
      %coord_5808 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc525)
      %slice_5809 = cute.slice(%view_5688, %coord_5808) : !memref_rmem_f32_4, !cute.coord<"(3,_)"> loc(#loc525)
      %iter_5810 = cute.get_iter(%slice_5809) : !memref_rmem_f32_9 loc(#loc316)
      %iter_5811 = cute.get_iter(%slice_5809) : !memref_rmem_f32_9 loc(#loc317)
      %lay_5812 = cute.get_layout(%slice_5809) : !memref_rmem_f32_9 loc(#loc311)
      %2118 = cute.get_shape(%lay_5812) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5813, %e1_5814 = cute.get_leaves(%2118) : !cute.shape<"((2,16))"> loc(#loc311)
      %2119 = cute.memref.load_vec %slice_5809 : !memref_rmem_f32_9 loc(#loc525)
      %2120 = vector.broadcast %2117 : f32 to vector<32xf32> loc(#loc290)
      %2121 = arith.mulf %2119, %2120 : vector<32xf32> loc(#loc485)
      %coord_5815 = cute.make_coord() : () -> !cute.coord<"(3,_)"> loc(#loc525)
      %slice_5816 = cute.slice(%view_5688, %coord_5815) : !memref_rmem_f32_4, !cute.coord<"(3,_)"> loc(#loc525)
      %iter_5817 = cute.get_iter(%slice_5816) : !memref_rmem_f32_9 loc(#loc316)
      %iter_5818 = cute.get_iter(%slice_5816) : !memref_rmem_f32_9 loc(#loc317)
      %lay_5819 = cute.get_layout(%slice_5816) : !memref_rmem_f32_9 loc(#loc311)
      %2122 = cute.get_shape(%lay_5819) : (!cute.layout<"((2,16)):((1,8))">) -> !cute.shape<"((2,16))"> loc(#loc311)
      %e0_5820, %e1_5821 = cute.get_leaves(%2122) : !cute.shape<"((2,16))"> loc(#loc311)
      %int_tuple_5822 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5823 = cute.size(%int_tuple_5822) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5824 = cute.get_leaves(%sz_5823) : !cute.int_tuple<"32"> loc(#loc525)
      %int_tuple_5825 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,16))"> loc(#loc525)
      %sz_5826 = cute.size(%int_tuple_5825) : (!cute.int_tuple<"((2,16))">) -> !cute.int_tuple<"32"> loc(#loc525)
      %e0_5827 = cute.get_leaves(%sz_5826) : !cute.int_tuple<"32"> loc(#loc525)
      cute.memref.store_vec %2121, %slice_5816 : !memref_rmem_f32_9 loc(#loc525)
      %lay_5828 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc490)
      %2123 = cute.make_layout_like(%lay_5828) : !cute.layout<"((2,2),2,16):((1,2),4,8)"> to !cute.layout<"((2,2),2,16):((1,2),4,8)"> loc(#loc526)
      %rmem_5829 = cute.memref.alloca(%2123) : !memref_rmem_bf16_18 loc(#loc526)
      %iter_5830 = cute.get_iter(%rmem_5829) : !memref_rmem_bf16_18 loc(#loc350)
      %iter_5831 = cute.get_iter(%rmem_5829) : !memref_rmem_bf16_18 loc(#loc351)
      %lay_5832 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc311)
      %2124 = cute.get_shape(%lay_5832) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %e0_5833, %e1_5834, %e2_5835, %e3_5836 = cute.get_leaves(%2124) : !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %2125 = cute.memref.load_vec %rmem : !memref_rmem_f32_ loc(#loc527)
      %2126 = arith.truncf %2125 : vector<128xf32> to vector<128xbf16> loc(#loc527)
      %lay_5837 = cute.get_layout(%rmem_5829) : !memref_rmem_bf16_18 loc(#loc311)
      %2127 = cute.get_shape(%lay_5837) : (!cute.layout<"((2,2),2,16):((1,2),4,8)">) -> !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %e0_5838, %e1_5839, %e2_5840, %e3_5841 = cute.get_leaves(%2127) : !cute.shape<"((2,2),2,16)"> loc(#loc311)
      %int_tuple_5842 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)"> loc(#loc527)
      %sz_5843 = cute.size(%int_tuple_5842) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128"> loc(#loc527)
      %e0_5844 = cute.get_leaves(%sz_5843) : !cute.int_tuple<"128"> loc(#loc527)
      %int_tuple_5845 = cute.make_int_tuple() : () -> !cute.int_tuple<"((2,2),2,16)"> loc(#loc527)
      %sz_5846 = cute.size(%int_tuple_5845) : (!cute.int_tuple<"((2,2),2,16)">) -> !cute.int_tuple<"128"> loc(#loc527)
      %e0_5847 = cute.get_leaves(%sz_5846) : !cute.int_tuple<"128"> loc(#loc527)
      cute.memref.store_vec %2126, %rmem_5829 : !memref_rmem_bf16_18 loc(#loc527)
      %view_5848 = cute.make_view(%iter_222, %arg7) : !memref_smem_bf16_ loc(#loc528)
      %iter_5849 = cute.get_iter(%view_5848) : !memref_smem_bf16_ loc(#loc331)
      %atom_5850 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16> loc(#loc529)
      %2128 = cute.static : !cute.layout<"((4,8,4),((2,2),(1,2))):((128,1,16),((64,8),(0,512)))"> loc(#loc530)
      %2129 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_5851, %e1_5852, %e2_5853 = cute.get_leaves(%2129) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_5854 = cute.size(%e0_5851) : (!cute.layout<"64:1">) -> !cute.int_tuple<"64"> loc(#loc357)
      %e0_5855 = cute.get_leaves(%sz_5854) : !cute.int_tuple<"64"> loc(#loc357)
      %2130 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
      %e0_5856, %e1_5857, %e2_5858 = cute.get_leaves(%2130) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
      %sz_5859 = cute.size(%e1_5857) : (!cute.layout<"16:1">) -> !cute.int_tuple<"16"> loc(#loc357)
      %e0_5860 = cute.get_leaves(%sz_5859) : !cute.int_tuple<"16"> loc(#loc357)
      %tile_5861 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1]"> loc(#loc531)
      %2131 = cute.make_tiled_copy(%atom_5850) : !copy_simt1 loc(#loc531)
      %retiled_5862 = cute.tiled.copy.retile(%2131, %rmem_5829) : (!copy_simt1, !memref_rmem_bf16_18) -> !memref_rmem_bf16_19 loc(#loc532)
      %iter_5863 = cute.get_iter(%retiled_5862) : !memref_rmem_bf16_19 loc(#loc364)
      %coord_5864 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc533)
      %dst_partitioned_5865 = cute.tiled.copy.partition_D(%2131, %view_5848, %coord_5864) : (!copy_simt1, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_20 loc(#loc533)
      %iter_5866 = cute.get_iter(%dst_partitioned_5865) : !memref_smem_bf16_20 loc(#loc338)
      %lay_5867 = cute.get_layout(%retiled_5862) : !memref_rmem_bf16_19 loc(#loc311)
      %2132 = cute.get_shape(%lay_5867) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)"> loc(#loc311)
      %e0_5868, %e1_5869, %e2_5870, %e3_5871, %e4_5872 = cute.get_leaves(%2132) : !cute.shape<"((1,(4,2)),2,8)"> loc(#loc311)
      %lay_5873 = cute.get_layout(%dst_partitioned_5865) : !memref_smem_bf16_20 loc(#loc311)
      %2133 = cute.get_shape(%lay_5873) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))"> loc(#loc311)
      %e0_5874, %e1_5875, %e2_5876, %e3_5877, %e4_5878, %e5_5879, %e6, %e7 = cute.get_leaves(%2133) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))"> loc(#loc311)
      %lay_5880 = cute.get_layout(%retiled_5862) : !memref_rmem_bf16_19 loc(#loc397)
      %shape_5881 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5882 = cute.make_layout(%shape_5881) : !cute.layout<"1:0"> loc(#loc397)
      %append_5883 = cute.append_to_rank<2> (%lay_5880, %lay_5882) : !cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">, !cute.layout<"1:0"> loc(#loc397)
      %view_5884 = cute.make_view(%iter_5863, %append_5883) : !memref_rmem_bf16_19 loc(#loc398)
      %iter_5885 = cute.get_iter(%view_5884) : !memref_rmem_bf16_19 loc(#loc331)
      %lay_5886 = cute.get_layout(%view_5884) : !memref_rmem_bf16_19 loc(#loc311)
      %2134 = cute.get_shape(%lay_5886) : (!cute.layout<"((1,(4,2)),2,8):((0,(1,8)),4,16)">) -> !cute.shape<"((1,(4,2)),2,8)"> loc(#loc311)
      %e0_5887, %e1_5888, %e2_5889, %e3_5890, %e4_5891 = cute.get_leaves(%2134) : !cute.shape<"((1,(4,2)),2,8)"> loc(#loc311)
      %grouped_5892 = cute.group_modes(%view_5884) <1, 3> : (!memref_rmem_bf16_19) -> !memref_rmem_bf16_20 loc(#loc398)
      %iter_5893 = cute.get_iter(%grouped_5892) : !memref_rmem_bf16_20 loc(#loc399)
      %iter_5894 = cute.get_iter(%grouped_5892) : !memref_rmem_bf16_20 loc(#loc317)
      %lay_5895 = cute.get_layout(%dst_partitioned_5865) : !memref_smem_bf16_20 loc(#loc397)
      %shape_5896 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5897 = cute.make_layout(%shape_5896) : !cute.layout<"1:0"> loc(#loc397)
      %append_5898 = cute.append_to_rank<2> (%lay_5895, %lay_5897) : !cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">, !cute.layout<"1:0"> loc(#loc397)
      %view_5899 = cute.make_view(%iter_5866, %append_5898) : !memref_smem_bf16_20 loc(#loc400)
      %iter_5900 = cute.get_iter(%view_5899) : !memref_smem_bf16_20 loc(#loc331)
      %lay_5901 = cute.get_layout(%view_5899) : !memref_smem_bf16_20 loc(#loc311)
      %2135 = cute.get_shape(%lay_5901) : (!cute.layout<"((1,(2,2,2)),2,((2,2),2)):((0,(1,512,?{div=8})),4096,((?{div=16},?{div=32}),8192))">) -> !cute.shape<"((1,(2,2,2)),2,((2,2),2))"> loc(#loc311)
      %e0_5902, %e1_5903, %e2_5904, %e3_5905, %e4_5906, %e5_5907, %e6_5908, %e7_5909 = cute.get_leaves(%2135) : !cute.shape<"((1,(2,2,2)),2,((2,2),2))"> loc(#loc311)
      %grouped_5910 = cute.group_modes(%view_5899) <1, 3> : (!memref_smem_bf16_20) -> !memref_smem_bf16_21 loc(#loc400)
      %iter_5911 = cute.get_iter(%grouped_5910) : !memref_smem_bf16_21 loc(#loc399)
      %iter_5912 = cute.get_iter(%grouped_5910) : !memref_smem_bf16_21 loc(#loc317)
      %lay_5913 = cute.get_layout(%grouped_5892) : !memref_rmem_bf16_20 loc(#loc311)
      %2136 = cute.get_shape(%lay_5913) : (!cute.layout<"((1,(4,2)),(2,8)):((0,(1,8)),(4,16))">) -> !cute.shape<"((1,(4,2)),(2,8))"> loc(#loc311)
      %e0_5914, %e1_5915, %e2_5916, %e3_5917, %e4_5918 = cute.get_leaves(%2136) : !cute.shape<"((1,(4,2)),(2,8))"> loc(#loc311)
      %lay_5919 = cute.get_layout(%grouped_5910) : !memref_smem_bf16_21 loc(#loc311)
      %2137 = cute.get_shape(%lay_5919) : (!cute.layout<"((1,(2,2,2)),(2,((2,2),2))):((0,(1,512,?{div=8})),(4096,((?{div=16},?{div=32}),8192)))">) -> !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))"> loc(#loc311)
      %e0_5920, %e1_5921, %e2_5922, %e3_5923, %e4_5924, %e5_5925, %e6_5926, %e7_5927 = cute.get_leaves(%2137) : !cute.shape<"((1,(2,2,2)),(2,((2,2),2)))"> loc(#loc311)
      %sz_5928 = cute.size(%grouped_5892) <{mode = [1]}> : (!memref_rmem_bf16_20) -> !cute.int_tuple<"16"> loc(#loc402)
      %e0_5929 = cute.get_leaves(%sz_5928) : !cute.int_tuple<"16"> loc(#loc402)
      %sz_5930 = cute.size(%grouped_5910) <{mode = [1]}> : (!memref_smem_bf16_21) -> !cute.int_tuple<"16"> loc(#loc402)
      %e0_5931 = cute.get_leaves(%sz_5930) : !cute.int_tuple<"16"> loc(#loc402)
      cute.copy(%atom_5850, %grouped_5892, %grouped_5910) : (!cute_nvgpu.atom.universal_copy<bf16>, !memref_rmem_bf16_20, !memref_smem_bf16_21) loc(#loc534)
      %coord_5932 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc535)
      %slice_5933 = cute.slice(%arg3, %coord_5932) : !memref_gmem_bf16_, !cute.coord<"(?,_,?,_)"> loc(#loc535)
      %iter_5934 = cute.get_iter(%slice_5933) : !memref_gmem_bf16_1 loc(#loc316)
      %iter_5935 = cute.get_iter(%slice_5933) : !memref_gmem_bf16_1 loc(#loc317)
      %tile_5936 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]"> loc(#loc536)
      %coord_5937 = cute.make_coord(%111) : (i32) -> !cute.coord<"(?,0)"> loc(#loc536)
      %tiled_view_5938 = cute.local_tile(%slice_5933, %tile_5936, %coord_5937) : (!memref_gmem_bf16_1, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !memref_gmem_bf16_2 loc(#loc536)
      %iter_5939 = cute.get_iter(%tiled_view_5938) : !memref_gmem_bf16_2 loc(#loc319)
      %coord_5940 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc537)
      %src_partitioned_5941 = cute.tiled.copy.partition_S(%arg9, %view_5848, %coord_5940) : (!copy_simt, !memref_smem_bf16_, !cute.coord<"?">) -> !memref_smem_bf16_3 loc(#loc537)
      %iter_5942 = cute.get_iter(%src_partitioned_5941) : !memref_smem_bf16_3 loc(#loc336)
      %coord_5943 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc538)
      %dst_partitioned_5944 = cute.tiled.copy.partition_D(%arg9, %tiled_view_5938, %coord_5943) : (!copy_simt, !memref_gmem_bf16_2, !cute.coord<"?">) -> !memref_gmem_bf16_4 loc(#loc538)
      %iter_5945 = cute.get_iter(%dst_partitioned_5944) : !memref_gmem_bf16_4 loc(#loc338)
      %lay_5946 = cute.get_layout(%dst_partitioned_5944) : !memref_gmem_bf16_4 loc(#loc490)
      %2138 = cute.make_layout_like(%lay_5946) : !cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)"> to !cute.layout<"((8,1),8,2):((1,0),16,8)"> loc(#loc539)
      %rmem_5947 = cute.memref.alloca(%2138) : !memref_rmem_bf16_21 loc(#loc539)
      %iter_5948 = cute.get_iter(%rmem_5947) : !memref_rmem_bf16_21 loc(#loc350)
      %iter_5949 = cute.get_iter(%rmem_5947) : !memref_rmem_bf16_21 loc(#loc351)
      %c1_i32_5950 = arith.constant 1 : i32 loc(#loc540)
      %c128_i32_5951 = arith.constant 128 : i32 loc(#loc540)
      nvvm.barrier id = %c1_i32_5950 number_of_threads = %c128_i32_5951 loc(#loc540)
      %lay_5952 = cute.get_layout(%src_partitioned_5941) : !memref_smem_bf16_3 loc(#loc311)
      %2139 = cute.get_shape(%lay_5952) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_5953, %e1_5954, %e2_5955, %e3_5956 = cute.get_leaves(%2139) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %lay_5957 = cute.get_layout(%rmem_5947) : !memref_rmem_bf16_21 loc(#loc311)
      %2140 = cute.get_shape(%lay_5957) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_5958, %e1_5959, %e2_5960, %e3_5961 = cute.get_leaves(%2140) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %lay_5962 = cute.get_layout(%src_partitioned_5941) : !memref_smem_bf16_3 loc(#loc397)
      %shape_5963 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5964 = cute.make_layout(%shape_5963) : !cute.layout<"1:0"> loc(#loc397)
      %append_5965 = cute.append_to_rank<2> (%lay_5962, %lay_5964) : !cute.layout<"((8,1),8,2):((1,0),1024,8192)">, !cute.layout<"1:0"> loc(#loc397)
      %view_5966 = cute.make_view(%iter_5942, %append_5965) : !memref_smem_bf16_3 loc(#loc398)
      %iter_5967 = cute.get_iter(%view_5966) : !memref_smem_bf16_3 loc(#loc331)
      %lay_5968 = cute.get_layout(%view_5966) : !memref_smem_bf16_3 loc(#loc311)
      %2141 = cute.get_shape(%lay_5968) : (!cute.layout<"((8,1),8,2):((1,0),1024,8192)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_5969, %e1_5970, %e2_5971, %e3_5972 = cute.get_leaves(%2141) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %grouped_5973 = cute.group_modes(%view_5966) <1, 3> : (!memref_smem_bf16_3) -> !memref_smem_bf16_22 loc(#loc398)
      %iter_5974 = cute.get_iter(%grouped_5973) : !memref_smem_bf16_22 loc(#loc399)
      %iter_5975 = cute.get_iter(%grouped_5973) : !memref_smem_bf16_22 loc(#loc317)
      %lay_5976 = cute.get_layout(%rmem_5947) : !memref_rmem_bf16_21 loc(#loc397)
      %shape_5977 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
      %lay_5978 = cute.make_layout(%shape_5977) : !cute.layout<"1:0"> loc(#loc397)
      %append_5979 = cute.append_to_rank<2> (%lay_5976, %lay_5978) : !cute.layout<"((8,1),8,2):((1,0),16,8)">, !cute.layout<"1:0"> loc(#loc397)
      %view_5980 = cute.make_view(%iter_5949, %append_5979) : !memref_rmem_bf16_21 loc(#loc400)
      %iter_5981 = cute.get_iter(%view_5980) : !memref_rmem_bf16_21 loc(#loc331)
      %lay_5982 = cute.get_layout(%view_5980) : !memref_rmem_bf16_21 loc(#loc311)
      %2142 = cute.get_shape(%lay_5982) : (!cute.layout<"((8,1),8,2):((1,0),16,8)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_5983, %e1_5984, %e2_5985, %e3_5986 = cute.get_leaves(%2142) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %grouped_5987 = cute.group_modes(%view_5980) <1, 3> : (!memref_rmem_bf16_21) -> !memref_rmem_bf16_22 loc(#loc400)
      %iter_5988 = cute.get_iter(%grouped_5987) : !memref_rmem_bf16_22 loc(#loc399)
      %iter_5989 = cute.get_iter(%grouped_5987) : !memref_rmem_bf16_22 loc(#loc317)
      %lay_5990 = cute.get_layout(%grouped_5973) : !memref_smem_bf16_22 loc(#loc311)
      %2143 = cute.get_shape(%lay_5990) : (!cute.layout<"((8,1),(8,2)):((1,0),(1024,8192))">) -> !cute.shape<"((8,1),(8,2))"> loc(#loc311)
      %e0_5991, %e1_5992, %e2_5993, %e3_5994 = cute.get_leaves(%2143) : !cute.shape<"((8,1),(8,2))"> loc(#loc311)
      %lay_5995 = cute.get_layout(%grouped_5987) : !memref_rmem_bf16_22 loc(#loc311)
      %2144 = cute.get_shape(%lay_5995) : (!cute.layout<"((8,1),(8,2)):((1,0),(16,8))">) -> !cute.shape<"((8,1),(8,2))"> loc(#loc311)
      %e0_5996, %e1_5997, %e2_5998, %e3_5999 = cute.get_leaves(%2144) : !cute.shape<"((8,1),(8,2))"> loc(#loc311)
      %sz_6000 = cute.size(%grouped_5973) <{mode = [1]}> : (!memref_smem_bf16_22) -> !cute.int_tuple<"16"> loc(#loc402)
      %e0_6001 = cute.get_leaves(%sz_6000) : !cute.int_tuple<"16"> loc(#loc402)
      %sz_6002 = cute.size(%grouped_5987) <{mode = [1]}> : (!memref_rmem_bf16_22) -> !cute.int_tuple<"16"> loc(#loc402)
      %e0_6003 = cute.get_leaves(%sz_6002) : !cute.int_tuple<"16"> loc(#loc402)
      cute.copy(%arg9, %grouped_5973, %grouped_5987) : (!copy_simt, !memref_smem_bf16_22, !memref_rmem_bf16_22) loc(#loc541)
      %lay_6004 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc542)
      %2145 = cute.get_shape(%lay_6004) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc542)
      %e0_6005, %e1_6006, %e2_6007, %e3_6008 = cute.get_leaves(%2145) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc542)
      %itup_6009 = cute.to_int_tuple(%e0_6005) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc542)
      %2146 = cute.get_scalars(%itup_6009) : !cute.int_tuple<"?"> loc(#loc542)
      %itup_6010 = cute.to_int_tuple(%e1_6006) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc542)
      %2147 = cute.get_scalars(%itup_6010) : !cute.int_tuple<"?"> loc(#loc542)
      %itup_6011 = cute.to_int_tuple(%e2_6007) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc542)
      %2148 = cute.get_scalars(%itup_6011) : !cute.int_tuple<"?"> loc(#loc542)
      %itup_6012 = cute.to_int_tuple(%e3_6008) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc542)
      %2149 = cute.get_scalars(%itup_6012) : !cute.int_tuple<"?{div=8}"> loc(#loc542)
      %shape_6013 = cute.make_shape(%itup_6009, %itup_6010, %itup_6011, %itup_6012) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?">, !cute.int_tuple<"?{div=8}">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc542)
      %2150 = cute.make_identity_tensor(%shape_6013) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc542)
      %iter_6014 = cute.get_iter(%2150) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)"> loc(#loc370)
      %e0_6015, %e1_6016, %e2_6017, %e3_6018 = cute.get_leaves(%iter_6014) : !cute.int_tuple<"(0,0,0,0)"> loc(#loc298)
      %coord_6019 = cute.make_coord(%112, %113) : (i32, i32) -> !cute.coord<"(?,_,?,_)"> loc(#loc543)
      %slice_6020 = cute.slice(%2150, %coord_6019) : !cute.coord_tensor<"(0,0,0,0)", "(?,?,?,?{div=8}):(1@0,1@1,1@2,1@3)">, !cute.coord<"(?,_,?,_)"> loc(#loc543)
      %iter_6021 = cute.get_iter(%slice_6020) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc316)
      %e0_6022, %e1_6023, %e2_6024, %e3_6025 = cute.get_leaves(%iter_6021) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %2151 = cute.get_scalars(%e0_6022) : !cute.int_tuple<"?"> loc(#loc290)
      %2152 = cute.get_scalars(%e2_6024) : !cute.int_tuple<"?"> loc(#loc290)
      %iter_6026 = cute.get_iter(%slice_6020) : !cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)"> loc(#loc317)
      %e0_6027, %e1_6028, %e2_6029, %e3_6030 = cute.get_leaves(%iter_6026) : !cute.int_tuple<"(?,0,?,0)"> loc(#loc298)
      %2153 = cute.get_scalars(%e0_6027) : !cute.int_tuple<"?"> loc(#loc290)
      %2154 = cute.get_scalars(%e2_6029) : !cute.int_tuple<"?"> loc(#loc290)
      %tile_6031 = cute.make_tile() : () -> !cute.tile<"[128:1;128:1]"> loc(#loc544)
      %coord_6032 = cute.make_coord(%111) : (i32) -> !cute.coord<"(?,0)"> loc(#loc544)
      %tiled_view_6033 = cute.local_tile(%slice_6020, %tile_6031, %coord_6032) : (!cute.coord_tensor<"(?,0,?,0)", "(?,?{div=8}):(1@1,1@3)">, !cute.tile<"[128:1;128:1]">, !cute.coord<"(?,0)">) -> !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)"> loc(#loc544)
      %iter_6034 = cute.get_iter(%tiled_view_6033) : !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)"> loc(#loc319)
      %e0_6035, %e1_6036, %e2_6037, %e3_6038 = cute.get_leaves(%iter_6034) : !cute.int_tuple<"(?,?{div=128},?,0)"> loc(#loc298)
      %2155 = cute.get_scalars(%e0_6035) : !cute.int_tuple<"?"> loc(#loc290)
      %2156 = cute.get_scalars(%e1_6036) : !cute.int_tuple<"?{div=128}"> loc(#loc290)
      %2157 = cute.get_scalars(%e2_6037) : !cute.int_tuple<"?"> loc(#loc290)
      %coord_6039 = cute.make_coord(%108) : (i32) -> !cute.coord<"?"> loc(#loc545)
      %dst_partitioned_6040 = cute.tiled.copy.partition_D(%arg9, %tiled_view_6033, %coord_6039) : (!copy_simt, !cute.coord_tensor<"(?,?{div=128},?,0)", "(128,128):(1@1,1@3)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)"> loc(#loc545)
      %iter_6041 = cute.get_iter(%dst_partitioned_6040) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)"> loc(#loc338)
      %e0_6042, %e1_6043, %e2_6044, %e3_6045 = cute.get_leaves(%iter_6041) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2158 = cute.get_scalars(%e0_6042) : !cute.int_tuple<"?"> loc(#loc290)
      %2159 = cute.get_scalars(%e1_6043) : !cute.int_tuple<"?"> loc(#loc290)
      %2160 = cute.get_scalars(%e2_6044) : !cute.int_tuple<"?"> loc(#loc290)
      %2161 = cute.get_scalars(%e3_6045) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %lay_6046 = cute.get_layout(%dst_partitioned_5944) : !memref_gmem_bf16_4 loc(#loc311)
      %2162 = cute.get_shape(%lay_6046) : (!cute.layout<"((8,1),8,2):((1,0),?{i64 div=128},64)">) -> !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %e0_6047, %e1_6048, %e2_6049, %e3_6050 = cute.get_leaves(%2162) : !cute.shape<"((8,1),8,2)"> loc(#loc311)
      %shape_6051 = cute.make_shape() : () -> !cute.shape<"(1,8,2)"> loc(#loc546)
      %stride_6052 = cute.make_stride() : () -> !cute.stride<"(2,0,1)"> loc(#loc546)
      %lay_6053 = cute.make_layout(%shape_6051, %stride_6052) : !cute.layout<"(1,8,2):(2,0,1)"> loc(#loc546)
      %rmem_6054 = cute.memref.alloca(%lay_6053) : !memref_rmem_i8_ loc(#loc547)
      %iter_6055 = cute.get_iter(%rmem_6054) : !memref_rmem_i8_ loc(#loc350)
      %iter_6056 = cute.get_iter(%rmem_6054) : !memref_rmem_i8_ loc(#loc351)
      %lay_6057 = cute.get_layout(%rmem_6054) : !memref_rmem_i8_ loc(#loc311)
      %2163 = cute.get_shape(%lay_6057) : (!cute.layout<"(1,8,2):(2,0,1)">) -> !cute.shape<"(1,8,2)"> loc(#loc311)
      %e0_6058, %e1_6059, %e2_6060 = cute.get_leaves(%2163) : !cute.shape<"(1,8,2)"> loc(#loc311)
      %int_tuple_6061 = cute.make_int_tuple() : () -> !cute.int_tuple<"2"> loc(#loc548)
      %sz_6062 = cute.size(%int_tuple_6061) : (!cute.int_tuple<"2">) -> !cute.int_tuple<"2"> loc(#loc548)
      %e0_6063 = cute.get_leaves(%sz_6062) : !cute.int_tuple<"2"> loc(#loc548)
      %coord_6064 = cute.make_coord() : () -> !cute.coord<"((0,0),0,0)"> loc(#loc549)
      %slice_6065 = cute.slice(%dst_partitioned_6040, %coord_6064) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,0)"> loc(#loc549)
      %iter_6066 = cute.get_iter(%slice_6065) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6067, %e1_6068, %e2_6069, %e3_6070 = cute.get_leaves(%iter_6066) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2164 = cute.get_scalars(%e0_6067) : !cute.int_tuple<"?"> loc(#loc290)
      %2165 = cute.get_scalars(%e1_6068) : !cute.int_tuple<"?"> loc(#loc290)
      %2166 = cute.get_scalars(%e2_6069) : !cute.int_tuple<"?"> loc(#loc290)
      %2167 = cute.get_scalars(%e3_6070) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6071 = cute.get_iter(%slice_6065) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6072, %e1_6073, %e2_6074, %e3_6075 = cute.get_leaves(%iter_6071) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2168 = cute.get_scalars(%e0_6072) : !cute.int_tuple<"?"> loc(#loc290)
      %2169 = cute.get_scalars(%e1_6073) : !cute.int_tuple<"?"> loc(#loc290)
      %2170 = cute.get_scalars(%e2_6074) : !cute.int_tuple<"?"> loc(#loc290)
      %2171 = cute.get_scalars(%e3_6075) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6076 = cute.get_iter(%slice_6065) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc549)
      %e0_6077, %e1_6078, %e2_6079, %e3_6080 = cute.get_leaves(%iter_6076) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc549)
      %2172 = cute.get_scalars(%e0_6077) : !cute.int_tuple<"?"> loc(#loc549)
      %2173 = cute.get_scalars(%e1_6078) : !cute.int_tuple<"?"> loc(#loc549)
      %2174 = cute.get_scalars(%e2_6079) : !cute.int_tuple<"?"> loc(#loc549)
      %2175 = cute.get_scalars(%e3_6080) : !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %lay_6081 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc549)
      %2176 = cute.get_shape(%lay_6081) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc549)
      %e0_6082, %e1_6083, %e2_6084, %e3_6085 = cute.get_leaves(%2176) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc549)
      %itup_6086 = cute.to_int_tuple(%e0_6082) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2177 = cute.get_scalars(%itup_6086) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6087 = cute.to_int_tuple(%e1_6083) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2178 = cute.get_scalars(%itup_6087) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6088 = cute.to_int_tuple(%e2_6084) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2179 = cute.get_scalars(%itup_6088) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6089 = cute.to_int_tuple(%e3_6085) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %2180 = cute.get_scalars(%itup_6089) : !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %coord_6090 = cute.make_coord(%e3_6080) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc550)
      %coord_6091 = cute.make_coord(%itup_6089) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc550)
      %2181 = cute.elem_less(%coord_6090, %coord_6091) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc550)
      %2182 = arith.extui %2181 : i1 to i8 loc(#loc290)
      %coord_6092 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc550)
      cute.memref.store(%rmem_6054, %coord_6092, %2182) : (!memref_rmem_i8_, !cute.coord<"(0,0,0)">, i8) -> () loc(#loc550)
      %coord_6093 = cute.make_coord() : () -> !cute.coord<"((0,0),0,1)"> loc(#loc549)
      %slice_6094 = cute.slice(%dst_partitioned_6040, %coord_6093) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"((0,0),0,1)"> loc(#loc549)
      %iter_6095 = cute.get_iter(%slice_6094) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6096, %e1_6097, %e2_6098, %e3_6099 = cute.get_leaves(%iter_6095) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2183 = cute.get_scalars(%e0_6096) : !cute.int_tuple<"?"> loc(#loc290)
      %2184 = cute.get_scalars(%e1_6097) : !cute.int_tuple<"?"> loc(#loc290)
      %2185 = cute.get_scalars(%e2_6098) : !cute.int_tuple<"?"> loc(#loc290)
      %2186 = cute.get_scalars(%e3_6099) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6100 = cute.get_iter(%slice_6094) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6101, %e1_6102, %e2_6103, %e3_6104 = cute.get_leaves(%iter_6100) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2187 = cute.get_scalars(%e0_6101) : !cute.int_tuple<"?"> loc(#loc290)
      %2188 = cute.get_scalars(%e1_6102) : !cute.int_tuple<"?"> loc(#loc290)
      %2189 = cute.get_scalars(%e2_6103) : !cute.int_tuple<"?"> loc(#loc290)
      %2190 = cute.get_scalars(%e3_6104) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6105 = cute.get_iter(%slice_6094) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc549)
      %e0_6106, %e1_6107, %e2_6108, %e3_6109 = cute.get_leaves(%iter_6105) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc549)
      %2191 = cute.get_scalars(%e0_6106) : !cute.int_tuple<"?"> loc(#loc549)
      %2192 = cute.get_scalars(%e1_6107) : !cute.int_tuple<"?"> loc(#loc549)
      %2193 = cute.get_scalars(%e2_6108) : !cute.int_tuple<"?"> loc(#loc549)
      %2194 = cute.get_scalars(%e3_6109) : !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %lay_6110 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc549)
      %2195 = cute.get_shape(%lay_6110) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc549)
      %e0_6111, %e1_6112, %e2_6113, %e3_6114 = cute.get_leaves(%2195) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc549)
      %itup_6115 = cute.to_int_tuple(%e0_6111) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2196 = cute.get_scalars(%itup_6115) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6116 = cute.to_int_tuple(%e1_6112) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2197 = cute.get_scalars(%itup_6116) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6117 = cute.to_int_tuple(%e2_6113) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc549)
      %2198 = cute.get_scalars(%itup_6117) : !cute.int_tuple<"?"> loc(#loc549)
      %itup_6118 = cute.to_int_tuple(%e3_6114) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %2199 = cute.get_scalars(%itup_6118) : !cute.int_tuple<"?{div=8}"> loc(#loc549)
      %coord_6119 = cute.make_coord(%e3_6109) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc550)
      %coord_6120 = cute.make_coord(%itup_6118) : (!cute.int_tuple<"?{div=8}">) -> !cute.coord<"?{div=8}"> loc(#loc550)
      %2200 = cute.elem_less(%coord_6119, %coord_6120) : !cute.coord<"?{div=8}">, !cute.coord<"?{div=8}"> loc(#loc550)
      %2201 = arith.extui %2200 : i1 to i8 loc(#loc290)
      %coord_6121 = cute.make_coord() : () -> !cute.coord<"(0,0,1)"> loc(#loc550)
      cute.memref.store(%rmem_6054, %coord_6121, %2201) : (!memref_rmem_i8_, !cute.coord<"(0,0,1)">, i8) -> () loc(#loc550)
      %int_tuple_6122 = cute.make_int_tuple() : () -> !cute.int_tuple<"8"> loc(#loc551)
      %sz_6123 = cute.size(%int_tuple_6122) : (!cute.int_tuple<"8">) -> !cute.int_tuple<"8"> loc(#loc551)
      %e0_6124 = cute.get_leaves(%sz_6123) : !cute.int_tuple<"8"> loc(#loc551)
      %coord_6125 = cute.make_coord() : () -> !cute.coord<"(0,0,0)"> loc(#loc552)
      %slice_6126 = cute.slice(%dst_partitioned_6040, %coord_6125) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,0,0)"> loc(#loc552)
      %iter_6127 = cute.get_iter(%slice_6126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6128, %e1_6129, %e2_6130, %e3_6131 = cute.get_leaves(%iter_6127) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2202 = cute.get_scalars(%e0_6128) : !cute.int_tuple<"?"> loc(#loc290)
      %2203 = cute.get_scalars(%e1_6129) : !cute.int_tuple<"?"> loc(#loc290)
      %2204 = cute.get_scalars(%e2_6130) : !cute.int_tuple<"?"> loc(#loc290)
      %2205 = cute.get_scalars(%e3_6131) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6132 = cute.get_iter(%slice_6126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6133, %e1_6134, %e2_6135, %e3_6136 = cute.get_leaves(%iter_6132) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2206 = cute.get_scalars(%e0_6133) : !cute.int_tuple<"?"> loc(#loc290)
      %2207 = cute.get_scalars(%e1_6134) : !cute.int_tuple<"?"> loc(#loc290)
      %2208 = cute.get_scalars(%e2_6135) : !cute.int_tuple<"?"> loc(#loc290)
      %2209 = cute.get_scalars(%e3_6136) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6137 = cute.get_iter(%slice_6126) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6138, %e1_6139, %e2_6140, %e3_6141 = cute.get_leaves(%iter_6137) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2210 = cute.get_scalars(%e0_6138) : !cute.int_tuple<"?"> loc(#loc552)
      %2211 = cute.get_scalars(%e1_6139) : !cute.int_tuple<"?"> loc(#loc552)
      %2212 = cute.get_scalars(%e2_6140) : !cute.int_tuple<"?"> loc(#loc552)
      %2213 = cute.get_scalars(%e3_6141) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6142 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2214 = cute.get_shape(%lay_6142) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6143, %e1_6144, %e2_6145, %e3_6146 = cute.get_leaves(%2214) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6147 = cute.to_int_tuple(%e0_6143) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2215 = cute.get_scalars(%itup_6147) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6148 = cute.to_int_tuple(%e1_6144) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2216 = cute.get_scalars(%itup_6148) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6149 = cute.to_int_tuple(%e2_6145) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2217 = cute.get_scalars(%itup_6149) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6150 = cute.to_int_tuple(%e3_6146) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2218 = cute.get_scalars(%itup_6150) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6151 = cute.make_coord(%e1_6139) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6152 = cute.make_coord(%itup_6148) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2219 = cute.elem_less(%coord_6151, %coord_6152) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2219 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,0,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,0,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,0,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,0,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6153 = cute.make_coord() : () -> !cute.coord<"(0,1,0)"> loc(#loc552)
      %slice_6154 = cute.slice(%dst_partitioned_6040, %coord_6153) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,1,0)"> loc(#loc552)
      %iter_6155 = cute.get_iter(%slice_6154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6156, %e1_6157, %e2_6158, %e3_6159 = cute.get_leaves(%iter_6155) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2220 = cute.get_scalars(%e0_6156) : !cute.int_tuple<"?"> loc(#loc290)
      %2221 = cute.get_scalars(%e1_6157) : !cute.int_tuple<"?"> loc(#loc290)
      %2222 = cute.get_scalars(%e2_6158) : !cute.int_tuple<"?"> loc(#loc290)
      %2223 = cute.get_scalars(%e3_6159) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6160 = cute.get_iter(%slice_6154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6161, %e1_6162, %e2_6163, %e3_6164 = cute.get_leaves(%iter_6160) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2224 = cute.get_scalars(%e0_6161) : !cute.int_tuple<"?"> loc(#loc290)
      %2225 = cute.get_scalars(%e1_6162) : !cute.int_tuple<"?"> loc(#loc290)
      %2226 = cute.get_scalars(%e2_6163) : !cute.int_tuple<"?"> loc(#loc290)
      %2227 = cute.get_scalars(%e3_6164) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6165 = cute.get_iter(%slice_6154) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6166, %e1_6167, %e2_6168, %e3_6169 = cute.get_leaves(%iter_6165) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2228 = cute.get_scalars(%e0_6166) : !cute.int_tuple<"?"> loc(#loc552)
      %2229 = cute.get_scalars(%e1_6167) : !cute.int_tuple<"?"> loc(#loc552)
      %2230 = cute.get_scalars(%e2_6168) : !cute.int_tuple<"?"> loc(#loc552)
      %2231 = cute.get_scalars(%e3_6169) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6170 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2232 = cute.get_shape(%lay_6170) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6171, %e1_6172, %e2_6173, %e3_6174 = cute.get_leaves(%2232) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6175 = cute.to_int_tuple(%e0_6171) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2233 = cute.get_scalars(%itup_6175) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6176 = cute.to_int_tuple(%e1_6172) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2234 = cute.get_scalars(%itup_6176) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6177 = cute.to_int_tuple(%e2_6173) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2235 = cute.get_scalars(%itup_6177) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6178 = cute.to_int_tuple(%e3_6174) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2236 = cute.get_scalars(%itup_6178) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6179 = cute.make_coord(%e1_6167) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6180 = cute.make_coord(%itup_6176) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2237 = cute.elem_less(%coord_6179, %coord_6180) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2237 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,1,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,1,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,1,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,1,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6181 = cute.make_coord() : () -> !cute.coord<"(0,2,0)"> loc(#loc552)
      %slice_6182 = cute.slice(%dst_partitioned_6040, %coord_6181) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,2,0)"> loc(#loc552)
      %iter_6183 = cute.get_iter(%slice_6182) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6184, %e1_6185, %e2_6186, %e3_6187 = cute.get_leaves(%iter_6183) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2238 = cute.get_scalars(%e0_6184) : !cute.int_tuple<"?"> loc(#loc290)
      %2239 = cute.get_scalars(%e1_6185) : !cute.int_tuple<"?"> loc(#loc290)
      %2240 = cute.get_scalars(%e2_6186) : !cute.int_tuple<"?"> loc(#loc290)
      %2241 = cute.get_scalars(%e3_6187) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6188 = cute.get_iter(%slice_6182) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6189, %e1_6190, %e2_6191, %e3_6192 = cute.get_leaves(%iter_6188) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2242 = cute.get_scalars(%e0_6189) : !cute.int_tuple<"?"> loc(#loc290)
      %2243 = cute.get_scalars(%e1_6190) : !cute.int_tuple<"?"> loc(#loc290)
      %2244 = cute.get_scalars(%e2_6191) : !cute.int_tuple<"?"> loc(#loc290)
      %2245 = cute.get_scalars(%e3_6192) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6193 = cute.get_iter(%slice_6182) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6194, %e1_6195, %e2_6196, %e3_6197 = cute.get_leaves(%iter_6193) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2246 = cute.get_scalars(%e0_6194) : !cute.int_tuple<"?"> loc(#loc552)
      %2247 = cute.get_scalars(%e1_6195) : !cute.int_tuple<"?"> loc(#loc552)
      %2248 = cute.get_scalars(%e2_6196) : !cute.int_tuple<"?"> loc(#loc552)
      %2249 = cute.get_scalars(%e3_6197) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6198 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2250 = cute.get_shape(%lay_6198) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6199, %e1_6200, %e2_6201, %e3_6202 = cute.get_leaves(%2250) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6203 = cute.to_int_tuple(%e0_6199) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2251 = cute.get_scalars(%itup_6203) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6204 = cute.to_int_tuple(%e1_6200) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2252 = cute.get_scalars(%itup_6204) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6205 = cute.to_int_tuple(%e2_6201) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2253 = cute.get_scalars(%itup_6205) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6206 = cute.to_int_tuple(%e3_6202) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2254 = cute.get_scalars(%itup_6206) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6207 = cute.make_coord(%e1_6195) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6208 = cute.make_coord(%itup_6204) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2255 = cute.elem_less(%coord_6207, %coord_6208) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2255 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,2,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,2,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,2,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,2,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6209 = cute.make_coord() : () -> !cute.coord<"(0,3,0)"> loc(#loc552)
      %slice_6210 = cute.slice(%dst_partitioned_6040, %coord_6209) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,3,0)"> loc(#loc552)
      %iter_6211 = cute.get_iter(%slice_6210) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6212, %e1_6213, %e2_6214, %e3_6215 = cute.get_leaves(%iter_6211) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2256 = cute.get_scalars(%e0_6212) : !cute.int_tuple<"?"> loc(#loc290)
      %2257 = cute.get_scalars(%e1_6213) : !cute.int_tuple<"?"> loc(#loc290)
      %2258 = cute.get_scalars(%e2_6214) : !cute.int_tuple<"?"> loc(#loc290)
      %2259 = cute.get_scalars(%e3_6215) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6216 = cute.get_iter(%slice_6210) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6217, %e1_6218, %e2_6219, %e3_6220 = cute.get_leaves(%iter_6216) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2260 = cute.get_scalars(%e0_6217) : !cute.int_tuple<"?"> loc(#loc290)
      %2261 = cute.get_scalars(%e1_6218) : !cute.int_tuple<"?"> loc(#loc290)
      %2262 = cute.get_scalars(%e2_6219) : !cute.int_tuple<"?"> loc(#loc290)
      %2263 = cute.get_scalars(%e3_6220) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6221 = cute.get_iter(%slice_6210) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6222, %e1_6223, %e2_6224, %e3_6225 = cute.get_leaves(%iter_6221) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2264 = cute.get_scalars(%e0_6222) : !cute.int_tuple<"?"> loc(#loc552)
      %2265 = cute.get_scalars(%e1_6223) : !cute.int_tuple<"?"> loc(#loc552)
      %2266 = cute.get_scalars(%e2_6224) : !cute.int_tuple<"?"> loc(#loc552)
      %2267 = cute.get_scalars(%e3_6225) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6226 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2268 = cute.get_shape(%lay_6226) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6227, %e1_6228, %e2_6229, %e3_6230 = cute.get_leaves(%2268) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6231 = cute.to_int_tuple(%e0_6227) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2269 = cute.get_scalars(%itup_6231) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6232 = cute.to_int_tuple(%e1_6228) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2270 = cute.get_scalars(%itup_6232) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6233 = cute.to_int_tuple(%e2_6229) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2271 = cute.get_scalars(%itup_6233) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6234 = cute.to_int_tuple(%e3_6230) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2272 = cute.get_scalars(%itup_6234) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6235 = cute.make_coord(%e1_6223) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6236 = cute.make_coord(%itup_6232) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2273 = cute.elem_less(%coord_6235, %coord_6236) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2273 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,3,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,3,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,3,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,3,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6237 = cute.make_coord() : () -> !cute.coord<"(0,4,0)"> loc(#loc552)
      %slice_6238 = cute.slice(%dst_partitioned_6040, %coord_6237) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,4,0)"> loc(#loc552)
      %iter_6239 = cute.get_iter(%slice_6238) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6240, %e1_6241, %e2_6242, %e3_6243 = cute.get_leaves(%iter_6239) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2274 = cute.get_scalars(%e0_6240) : !cute.int_tuple<"?"> loc(#loc290)
      %2275 = cute.get_scalars(%e1_6241) : !cute.int_tuple<"?"> loc(#loc290)
      %2276 = cute.get_scalars(%e2_6242) : !cute.int_tuple<"?"> loc(#loc290)
      %2277 = cute.get_scalars(%e3_6243) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6244 = cute.get_iter(%slice_6238) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6245, %e1_6246, %e2_6247, %e3_6248 = cute.get_leaves(%iter_6244) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2278 = cute.get_scalars(%e0_6245) : !cute.int_tuple<"?"> loc(#loc290)
      %2279 = cute.get_scalars(%e1_6246) : !cute.int_tuple<"?"> loc(#loc290)
      %2280 = cute.get_scalars(%e2_6247) : !cute.int_tuple<"?"> loc(#loc290)
      %2281 = cute.get_scalars(%e3_6248) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6249 = cute.get_iter(%slice_6238) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6250, %e1_6251, %e2_6252, %e3_6253 = cute.get_leaves(%iter_6249) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2282 = cute.get_scalars(%e0_6250) : !cute.int_tuple<"?"> loc(#loc552)
      %2283 = cute.get_scalars(%e1_6251) : !cute.int_tuple<"?"> loc(#loc552)
      %2284 = cute.get_scalars(%e2_6252) : !cute.int_tuple<"?"> loc(#loc552)
      %2285 = cute.get_scalars(%e3_6253) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6254 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2286 = cute.get_shape(%lay_6254) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6255, %e1_6256, %e2_6257, %e3_6258 = cute.get_leaves(%2286) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6259 = cute.to_int_tuple(%e0_6255) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2287 = cute.get_scalars(%itup_6259) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6260 = cute.to_int_tuple(%e1_6256) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2288 = cute.get_scalars(%itup_6260) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6261 = cute.to_int_tuple(%e2_6257) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2289 = cute.get_scalars(%itup_6261) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6262 = cute.to_int_tuple(%e3_6258) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2290 = cute.get_scalars(%itup_6262) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6263 = cute.make_coord(%e1_6251) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6264 = cute.make_coord(%itup_6260) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2291 = cute.elem_less(%coord_6263, %coord_6264) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2291 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,4,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,4,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,4,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,4,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6265 = cute.make_coord() : () -> !cute.coord<"(0,5,0)"> loc(#loc552)
      %slice_6266 = cute.slice(%dst_partitioned_6040, %coord_6265) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,5,0)"> loc(#loc552)
      %iter_6267 = cute.get_iter(%slice_6266) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6268, %e1_6269, %e2_6270, %e3_6271 = cute.get_leaves(%iter_6267) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2292 = cute.get_scalars(%e0_6268) : !cute.int_tuple<"?"> loc(#loc290)
      %2293 = cute.get_scalars(%e1_6269) : !cute.int_tuple<"?"> loc(#loc290)
      %2294 = cute.get_scalars(%e2_6270) : !cute.int_tuple<"?"> loc(#loc290)
      %2295 = cute.get_scalars(%e3_6271) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6272 = cute.get_iter(%slice_6266) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6273, %e1_6274, %e2_6275, %e3_6276 = cute.get_leaves(%iter_6272) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2296 = cute.get_scalars(%e0_6273) : !cute.int_tuple<"?"> loc(#loc290)
      %2297 = cute.get_scalars(%e1_6274) : !cute.int_tuple<"?"> loc(#loc290)
      %2298 = cute.get_scalars(%e2_6275) : !cute.int_tuple<"?"> loc(#loc290)
      %2299 = cute.get_scalars(%e3_6276) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6277 = cute.get_iter(%slice_6266) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6278, %e1_6279, %e2_6280, %e3_6281 = cute.get_leaves(%iter_6277) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2300 = cute.get_scalars(%e0_6278) : !cute.int_tuple<"?"> loc(#loc552)
      %2301 = cute.get_scalars(%e1_6279) : !cute.int_tuple<"?"> loc(#loc552)
      %2302 = cute.get_scalars(%e2_6280) : !cute.int_tuple<"?"> loc(#loc552)
      %2303 = cute.get_scalars(%e3_6281) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6282 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2304 = cute.get_shape(%lay_6282) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6283, %e1_6284, %e2_6285, %e3_6286 = cute.get_leaves(%2304) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6287 = cute.to_int_tuple(%e0_6283) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2305 = cute.get_scalars(%itup_6287) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6288 = cute.to_int_tuple(%e1_6284) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2306 = cute.get_scalars(%itup_6288) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6289 = cute.to_int_tuple(%e2_6285) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2307 = cute.get_scalars(%itup_6289) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6290 = cute.to_int_tuple(%e3_6286) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2308 = cute.get_scalars(%itup_6290) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6291 = cute.make_coord(%e1_6279) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6292 = cute.make_coord(%itup_6288) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2309 = cute.elem_less(%coord_6291, %coord_6292) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2309 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,5,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,5,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,5,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,5,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6293 = cute.make_coord() : () -> !cute.coord<"(0,6,0)"> loc(#loc552)
      %slice_6294 = cute.slice(%dst_partitioned_6040, %coord_6293) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,6,0)"> loc(#loc552)
      %iter_6295 = cute.get_iter(%slice_6294) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6296, %e1_6297, %e2_6298, %e3_6299 = cute.get_leaves(%iter_6295) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2310 = cute.get_scalars(%e0_6296) : !cute.int_tuple<"?"> loc(#loc290)
      %2311 = cute.get_scalars(%e1_6297) : !cute.int_tuple<"?"> loc(#loc290)
      %2312 = cute.get_scalars(%e2_6298) : !cute.int_tuple<"?"> loc(#loc290)
      %2313 = cute.get_scalars(%e3_6299) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6300 = cute.get_iter(%slice_6294) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6301, %e1_6302, %e2_6303, %e3_6304 = cute.get_leaves(%iter_6300) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2314 = cute.get_scalars(%e0_6301) : !cute.int_tuple<"?"> loc(#loc290)
      %2315 = cute.get_scalars(%e1_6302) : !cute.int_tuple<"?"> loc(#loc290)
      %2316 = cute.get_scalars(%e2_6303) : !cute.int_tuple<"?"> loc(#loc290)
      %2317 = cute.get_scalars(%e3_6304) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6305 = cute.get_iter(%slice_6294) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6306, %e1_6307, %e2_6308, %e3_6309 = cute.get_leaves(%iter_6305) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2318 = cute.get_scalars(%e0_6306) : !cute.int_tuple<"?"> loc(#loc552)
      %2319 = cute.get_scalars(%e1_6307) : !cute.int_tuple<"?"> loc(#loc552)
      %2320 = cute.get_scalars(%e2_6308) : !cute.int_tuple<"?"> loc(#loc552)
      %2321 = cute.get_scalars(%e3_6309) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6310 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2322 = cute.get_shape(%lay_6310) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6311, %e1_6312, %e2_6313, %e3_6314 = cute.get_leaves(%2322) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6315 = cute.to_int_tuple(%e0_6311) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2323 = cute.get_scalars(%itup_6315) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6316 = cute.to_int_tuple(%e1_6312) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2324 = cute.get_scalars(%itup_6316) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6317 = cute.to_int_tuple(%e2_6313) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2325 = cute.get_scalars(%itup_6317) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6318 = cute.to_int_tuple(%e3_6314) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2326 = cute.get_scalars(%itup_6318) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6319 = cute.make_coord(%e1_6307) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6320 = cute.make_coord(%itup_6316) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2327 = cute.elem_less(%coord_6319, %coord_6320) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2327 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,6,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,6,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,6,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,6,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      %coord_6321 = cute.make_coord() : () -> !cute.coord<"(0,7,0)"> loc(#loc552)
      %slice_6322 = cute.slice(%dst_partitioned_6040, %coord_6321) : !cute.coord_tensor<"(?,?,?,?{div=8})", "((8,1),8,2):((1@3,0),16@1,64@3)">, !cute.coord<"(0,7,0)"> loc(#loc552)
      %iter_6323 = cute.get_iter(%slice_6322) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc316)
      %e0_6324, %e1_6325, %e2_6326, %e3_6327 = cute.get_leaves(%iter_6323) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2328 = cute.get_scalars(%e0_6324) : !cute.int_tuple<"?"> loc(#loc290)
      %2329 = cute.get_scalars(%e1_6325) : !cute.int_tuple<"?"> loc(#loc290)
      %2330 = cute.get_scalars(%e2_6326) : !cute.int_tuple<"?"> loc(#loc290)
      %2331 = cute.get_scalars(%e3_6327) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6328 = cute.get_iter(%slice_6322) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc317)
      %e0_6329, %e1_6330, %e2_6331, %e3_6332 = cute.get_leaves(%iter_6328) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc298)
      %2332 = cute.get_scalars(%e0_6329) : !cute.int_tuple<"?"> loc(#loc290)
      %2333 = cute.get_scalars(%e1_6330) : !cute.int_tuple<"?"> loc(#loc290)
      %2334 = cute.get_scalars(%e2_6331) : !cute.int_tuple<"?"> loc(#loc290)
      %2335 = cute.get_scalars(%e3_6332) : !cute.int_tuple<"?{div=8}"> loc(#loc290)
      %iter_6333 = cute.get_iter(%slice_6322) : !cute.coord_tensor<"(?,?,?,?{div=8})", "():()"> loc(#loc552)
      %e0_6334, %e1_6335, %e2_6336, %e3_6337 = cute.get_leaves(%iter_6333) : !cute.int_tuple<"(?,?,?,?{div=8})"> loc(#loc552)
      %2336 = cute.get_scalars(%e0_6334) : !cute.int_tuple<"?"> loc(#loc552)
      %2337 = cute.get_scalars(%e1_6335) : !cute.int_tuple<"?"> loc(#loc552)
      %2338 = cute.get_scalars(%e2_6336) : !cute.int_tuple<"?"> loc(#loc552)
      %2339 = cute.get_scalars(%e3_6337) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %lay_6338 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc552)
      %2340 = cute.get_shape(%lay_6338) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %e0_6339, %e1_6340, %e2_6341, %e3_6342 = cute.get_leaves(%2340) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc552)
      %itup_6343 = cute.to_int_tuple(%e0_6339) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2341 = cute.get_scalars(%itup_6343) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6344 = cute.to_int_tuple(%e1_6340) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2342 = cute.get_scalars(%itup_6344) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6345 = cute.to_int_tuple(%e2_6341) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc552)
      %2343 = cute.get_scalars(%itup_6345) : !cute.int_tuple<"?"> loc(#loc552)
      %itup_6346 = cute.to_int_tuple(%e3_6342) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %2344 = cute.get_scalars(%itup_6346) : !cute.int_tuple<"?{div=8}"> loc(#loc552)
      %coord_6347 = cute.make_coord(%e1_6335) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %coord_6348 = cute.make_coord(%itup_6344) : (!cute.int_tuple<"?">) -> !cute.coord<"?"> loc(#loc552)
      %2345 = cute.elem_less(%coord_6347, %coord_6348) : !cute.coord<"?">, !cute.coord<"?"> loc(#loc552)
      scf.if %2345 {
        %coord_6349 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc553)
        %slice_6350 = cute.slice(%rmem_5947, %coord_6349) : !memref_rmem_bf16_21, !cute.coord<"(_,7,_)"> loc(#loc553)
        %iter_6351 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc316)
        %iter_6352 = cute.get_iter(%slice_6350) : !memref_rmem_bf16_23 loc(#loc317)
        %coord_6353 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc554)
        %slice_6354 = cute.slice(%dst_partitioned_5944, %coord_6353) : !memref_gmem_bf16_4, !cute.coord<"(_,7,_)"> loc(#loc554)
        %iter_6355 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc316)
        %iter_6356 = cute.get_iter(%slice_6354) : !memref_gmem_bf16_6 loc(#loc317)
        %coord_6357 = cute.make_coord() : () -> !cute.coord<"(_,7,_)"> loc(#loc555)
        %slice_6358 = cute.slice(%rmem_6054, %coord_6357) : !memref_rmem_i8_, !cute.coord<"(_,7,_)"> loc(#loc555)
        %iter_6359 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc316)
        %iter_6360 = cute.get_iter(%slice_6358) : !memref_rmem_i8_2 loc(#loc317)
        %lay_6361 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc311)
        %2346 = cute.get_shape(%lay_6361) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6362, %e1_6363, %e2_6364 = cute.get_leaves(%2346) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6365 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc311)
        %2347 = cute.get_shape(%lay_6365) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6366, %e1_6367, %e2_6368 = cute.get_leaves(%2347) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %lay_6369 = cute.get_layout(%slice_6350) : !memref_rmem_bf16_23 loc(#loc397)
        %shape_6370 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6371 = cute.make_layout(%shape_6370) : !cute.layout<"1:0"> loc(#loc397)
        %append_6372 = cute.append_to_rank<2> (%lay_6369, %lay_6371) : !cute.layout<"((8,1),2):((1,0),8)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6373 = cute.make_view(%iter_6352, %append_6372) : !memref_rmem_bf16_23 loc(#loc398)
        %iter_6374 = cute.get_iter(%view_6373) : !memref_rmem_bf16_23 loc(#loc331)
        %lay_6375 = cute.get_layout(%view_6373) : !memref_rmem_bf16_23 loc(#loc311)
        %2348 = cute.get_shape(%lay_6375) : (!cute.layout<"((8,1),2):((1,0),8)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6376, %e1_6377, %e2_6378 = cute.get_leaves(%2348) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6379 = cute.group_modes(%view_6373) <1, 2> : (!memref_rmem_bf16_23) -> !memref_rmem_bf16_24 loc(#loc398)
        %iter_6380 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc399)
        %iter_6381 = cute.get_iter(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc317)
        %lay_6382 = cute.get_layout(%slice_6354) : !memref_gmem_bf16_6 loc(#loc397)
        %shape_6383 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6384 = cute.make_layout(%shape_6383) : !cute.layout<"1:0"> loc(#loc397)
        %append_6385 = cute.append_to_rank<2> (%lay_6382, %lay_6384) : !cute.layout<"((8,1),2):((1,0),64)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6386 = cute.make_view(%iter_6356, %append_6385) : !memref_gmem_bf16_6 loc(#loc400)
        %iter_6387 = cute.get_iter(%view_6386) : !memref_gmem_bf16_6 loc(#loc331)
        %lay_6388 = cute.get_layout(%view_6386) : !memref_gmem_bf16_6 loc(#loc311)
        %2349 = cute.get_shape(%lay_6388) : (!cute.layout<"((8,1),2):((1,0),64)">) -> !cute.shape<"((8,1),2)"> loc(#loc311)
        %e0_6389, %e1_6390, %e2_6391 = cute.get_leaves(%2349) : !cute.shape<"((8,1),2)"> loc(#loc311)
        %grouped_6392 = cute.group_modes(%view_6386) <1, 2> : (!memref_gmem_bf16_6) -> !memref_gmem_bf16_7 loc(#loc400)
        %iter_6393 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc399)
        %iter_6394 = cute.get_iter(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc317)
        %lay_6395 = cute.get_layout(%slice_6358) : !memref_rmem_i8_2 loc(#loc397)
        %shape_6396 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc397)
        %lay_6397 = cute.make_layout(%shape_6396) : !cute.layout<"1:0"> loc(#loc397)
        %append_6398 = cute.append_to_rank<2> (%lay_6395, %lay_6397) : !cute.layout<"(1,2):(2,1)">, !cute.layout<"1:0"> loc(#loc397)
        %view_6399 = cute.make_view(%iter_6360, %append_6398) : !memref_rmem_i8_2 loc(#loc401)
        %iter_6400 = cute.get_iter(%view_6399) : !memref_rmem_i8_2 loc(#loc331)
        %lay_6401 = cute.get_layout(%view_6399) : !memref_rmem_i8_2 loc(#loc311)
        %2350 = cute.get_shape(%lay_6401) : (!cute.layout<"(1,2):(2,1)">) -> !cute.shape<"(1,2)"> loc(#loc311)
        %e0_6402, %e1_6403 = cute.get_leaves(%2350) : !cute.shape<"(1,2)"> loc(#loc311)
        %grouped_6404 = cute.group_modes(%view_6399) <1, 2> : (!memref_rmem_i8_2) -> !memref_rmem_i8_3 loc(#loc401)
        %iter_6405 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc399)
        %iter_6406 = cute.get_iter(%grouped_6404) : !memref_rmem_i8_3 loc(#loc317)
        %lay_6407 = cute.get_layout(%grouped_6379) : !memref_rmem_bf16_24 loc(#loc311)
        %2351 = cute.get_shape(%lay_6407) : (!cute.layout<"((8,1),(2)):((1,0),(8))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6408, %e1_6409, %e2_6410 = cute.get_leaves(%2351) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %lay_6411 = cute.get_layout(%grouped_6392) : !memref_gmem_bf16_7 loc(#loc311)
        %2352 = cute.get_shape(%lay_6411) : (!cute.layout<"((8,1),(2)):((1,0),(64))">) -> !cute.shape<"((8,1),(2))"> loc(#loc311)
        %e0_6412, %e1_6413, %e2_6414 = cute.get_leaves(%2352) : !cute.shape<"((8,1),(2))"> loc(#loc311)
        %sz_6415 = cute.size(%grouped_6379) <{mode = [1]}> : (!memref_rmem_bf16_24) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6416 = cute.get_leaves(%sz_6415) : !cute.int_tuple<"2"> loc(#loc402)
        %sz_6417 = cute.size(%grouped_6392) <{mode = [1]}> : (!memref_gmem_bf16_7) -> !cute.int_tuple<"2"> loc(#loc402)
        %e0_6418 = cute.get_leaves(%sz_6417) : !cute.int_tuple<"2"> loc(#loc402)
        cute.copy(%arg9, %grouped_6379, %grouped_6392, %grouped_6404) : (!copy_simt, !memref_rmem_bf16_24, !memref_gmem_bf16_7, !memref_rmem_i8_3) loc(#loc556)
      } loc(#loc290)
      return loc(#loc290)
    } loc(#loc291)
  } loc(#loc290)
  func.func @cutlass___call_____main__FlashAttentionForwardAmpere_object_at__Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Tensorgmemodiv8i64div8i64div8i64div81_Te(%arg0: !memref_gmem_bf16_ loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc)), %arg1: !memref_gmem_bf16_ loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc)), %arg2: !memref_gmem_bf16_ loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc)), %arg3: !memref_gmem_bf16_ loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc)), %arg4: f32 loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc)), %arg5: !cuda.stream loc("def _threadquad_reduce_sum(self, val: cutlass.Float32) -> cutlass.Float32:"(#loc))) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_bf16_ loc(#loc292)
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_bf16_ loc(#loc292)
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_bf16_ loc(#loc292)
    %iter_2 = cute.get_iter(%arg3) : !memref_gmem_bf16_ loc(#loc292)
    %iter_3 = cute.get_iter(%arg0) : !memref_gmem_bf16_ loc(#loc557)
    %iter_4 = cute.get_iter(%arg1) : !memref_gmem_bf16_ loc(#loc557)
    %iter_5 = cute.get_iter(%arg2) : !memref_gmem_bf16_ loc(#loc557)
    %iter_6 = cute.get_iter(%arg3) : !memref_gmem_bf16_ loc(#loc557)
    %lay = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc294)
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0, %e1, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_7 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %2 = cute.get_scalars(%itup_7) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_8 = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %3 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_9 = cute.to_int_tuple(%e3) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %4 = cute.get_scalars(%itup_9) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %5 = cute.get_stride(%lay) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_10, %e1_11, %e2_12, %e3_13 = cute.get_leaves(%5) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_14 = cute.to_int_tuple(%e0_10) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %6 = cute.get_scalars(%itup_14) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_15 = cute.to_int_tuple(%e1_11) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %7 = cute.get_scalars(%itup_15) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_16 = cute.to_int_tuple(%e2_12) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %8 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_17 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc294)
    %9 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_18, %e1_19, %e2_20, %e3_21 = cute.get_leaves(%9) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_22 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %10 = cute.get_scalars(%itup_22) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_23 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %11 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_24 = cute.to_int_tuple(%e2_20) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %12 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_25 = cute.to_int_tuple(%e3_21) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %13 = cute.get_scalars(%itup_25) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %14 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_26, %e1_27, %e2_28, %e3_29 = cute.get_leaves(%14) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_30 = cute.to_int_tuple(%e0_26) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %15 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_31 = cute.to_int_tuple(%e1_27) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %16 = cute.get_scalars(%itup_31) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_32 = cute.to_int_tuple(%e2_28) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %17 = cute.get_scalars(%itup_32) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_33 = cute.get_layout(%arg2) : !memref_gmem_bf16_ loc(#loc294)
    %18 = cute.get_shape(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_34, %e1_35, %e2_36, %e3_37 = cute.get_leaves(%18) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_38 = cute.to_int_tuple(%e0_34) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %19 = cute.get_scalars(%itup_38) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_39 = cute.to_int_tuple(%e1_35) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %20 = cute.get_scalars(%itup_39) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_40 = cute.to_int_tuple(%e2_36) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %21 = cute.get_scalars(%itup_40) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_41 = cute.to_int_tuple(%e3_37) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %22 = cute.get_scalars(%itup_41) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %23 = cute.get_stride(%lay_33) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_42, %e1_43, %e2_44, %e3_45 = cute.get_leaves(%23) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_46 = cute.to_int_tuple(%e0_42) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %24 = cute.get_scalars(%itup_46) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_47 = cute.to_int_tuple(%e1_43) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %25 = cute.get_scalars(%itup_47) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_48 = cute.to_int_tuple(%e2_44) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %26 = cute.get_scalars(%itup_48) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_49 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc294)
    %27 = cute.get_shape(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_50, %e1_51, %e2_52, %e3_53 = cute.get_leaves(%27) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_54 = cute.to_int_tuple(%e0_50) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %28 = cute.get_scalars(%itup_54) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_55 = cute.to_int_tuple(%e1_51) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %29 = cute.get_scalars(%itup_55) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_56 = cute.to_int_tuple(%e2_52) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %30 = cute.get_scalars(%itup_56) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_57 = cute.to_int_tuple(%e3_53) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %31 = cute.get_scalars(%itup_57) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %32 = cute.get_stride(%lay_49) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_58, %e1_59, %e2_60, %e3_61 = cute.get_leaves(%32) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_62 = cute.to_int_tuple(%e0_58) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %33 = cute.get_scalars(%itup_62) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_63 = cute.to_int_tuple(%e1_59) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %34 = cute.get_scalars(%itup_63) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_64 = cute.to_int_tuple(%e2_60) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %35 = cute.get_scalars(%itup_64) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %36 = cute.static : !cute.swizzle<"S<3,3,3>"> loc(#loc558)
    %shape = cute.make_shape() : () -> !cute.shape<"(8,64)"> loc(#loc559)
    %stride = cute.make_stride() : () -> !cute.stride<"(64,1)"> loc(#loc559)
    %lay_65 = cute.make_layout(%shape, %stride) : !cute.layout<"(8,64):(64,1)"> loc(#loc559)
    %37 = cute.get_stride(%lay_65) : (!cute.layout<"(8,64):(64,1)">) -> !cute.stride<"(64,1)"> loc(#loc560)
    %e0_66, %e1_67 = cute.get_leaves(%37) : !cute.stride<"(64,1)"> loc(#loc560)
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"0"> loc(#loc561)
    %lay_68 = cute.make_composed_layout(%36, %int_tuple, %lay_65) : !cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)"> loc(#loc561)
    %shape_69 = cute.make_shape() : () -> !cute.shape<"(128,128)"> loc(#loc562)
    %int_tuple_70 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)"> loc(#loc562)
    %tile_to_shape = cute.tile_to_shape(%lay_68, %shape_69, %int_tuple_70) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">, !cute.shape<"(128,128)">, !cute.int_tuple<"(0,1)">) -> !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))"> loc(#loc562)
    %shape_71 = cute.make_shape() : () -> !cute.shape<"(64,128)"> loc(#loc563)
    %int_tuple_72 = cute.make_int_tuple() : () -> !cute.int_tuple<"(0,1)"> loc(#loc563)
    %tile_to_shape_73 = cute.tile_to_shape(%lay_68, %shape_71, %int_tuple_72) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">, !cute.shape<"(64,128)">, !cute.int_tuple<"(0,1)">) -> !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))"> loc(#loc563)
    %cosz = cute.cosize(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"16384"> loc(#loc564)
    %e0_74 = cute.get_leaves(%cosz) : !cute.int_tuple<"16384"> loc(#loc564)
    %cosz_75 = cute.cosize(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192"> loc(#loc565)
    %e0_76 = cute.get_leaves(%cosz_75) : !cute.int_tuple<"8192"> loc(#loc565)
    %cosz_77 = cute.cosize(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"8192"> loc(#loc566)
    %e0_78 = cute.get_leaves(%cosz_77) : !cute.int_tuple<"8192"> loc(#loc566)
    %atom = cute.make_atom() : () -> !cute_nvgpu.atom.simt_async_copy<bf16, cache = global, 128 b> loc(#loc567)
    %atom_79 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<bf16, 128 b> loc(#loc568)
    %38 = cute.composed_get_outer(%lay_68) : (!cute.composed_layout<"S<3,3,3> o 0 o (8,64):(64,1)">) -> !cute.layout<"(8,64):(64,1)"> loc(#loc569)
    %39 = cute.get_shape(%38) : (!cute.layout<"(8,64):(64,1)">) -> !cute.shape<"(8,64)"> loc(#loc569)
    %e0_80, %e1_81 = cute.get_leaves(%39) : !cute.shape<"(8,64)"> loc(#loc569)
    %shape_82 = cute.make_shape() : () -> !cute.shape<"(16,8)"> loc(#loc570)
    %stride_83 = cute.make_stride() : () -> !cute.stride<"(8,1)"> loc(#loc570)
    %lay_84 = cute.make_layout(%shape_82, %stride_83) : !cute.layout<"(16,8):(8,1)"> loc(#loc570)
    %shape_85 = cute.make_shape() : () -> !cute.shape<"(1,8)"> loc(#loc571)
    %lay_86 = cute.make_layout(%shape_85) : !cute.layout<"(1,8):(0,1)"> loc(#loc571)
    %prod = cute.raked_product(%lay_84, %lay_86) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))"> loc(#loc572)
    %sz = cute.size(%lay_84) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128"> loc(#loc572)
    %e0_87 = cute.get_leaves(%sz) : !cute.int_tuple<"128"> loc(#loc572)
    %sz_88 = cute.size(%lay_86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8"> loc(#loc572)
    %e0_89 = cute.get_leaves(%sz_88) : !cute.int_tuple<"8"> loc(#loc572)
    %shape_90 = cute.make_shape() : () -> !cute.shape<"(128,8)"> loc(#loc572)
    %lay_91 = cute.make_layout(%shape_90) : !cute.layout<"(128,8):(1,128)"> loc(#loc572)
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)"> loc(#loc572)
    %40 = cute.composition(%rinv, %lay_91) : (!cute.layout<"(8,128):(128,1)">, !cute.layout<"(128,8):(1,128)">) -> !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc572)
    %41 = cute.get_shape(%prod) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))"> loc(#loc573)
    %e0_92, %e1_93, %e2_94 = cute.get_leaves(%41) : !cute.shape<"(16,(8,8))"> loc(#loc573)
    %int_tuple_95 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))"> loc(#loc572)
    %res = cute.tuple.product_each(%int_tuple_95) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)"> loc(#loc572)
    %e0_96, %e1_97 = cute.get_leaves(%res) : !cute.int_tuple<"(16,64)"> loc(#loc572)
    %int_tuple_98 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)"> loc(#loc572)
    %res_99 = cute.tuple.product_each(%int_tuple_98) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)"> loc(#loc572)
    %e0_100, %e1_101 = cute.get_leaves(%res_99) : !cute.int_tuple<"(16,64)"> loc(#loc572)
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]"> loc(#loc572)
    %42 = cute.make_tiled_copy(%atom) : !copy_ldgsts loc(#loc572)
    %prod_102 = cute.raked_product(%lay_84, %lay_86) : (!cute.layout<"(16,8):(8,1)">, !cute.layout<"(1,8):(0,1)">) -> !cute.layout<"(16,(8,8)):(8,(128,1))"> loc(#loc574)
    %sz_103 = cute.size(%lay_84) : (!cute.layout<"(16,8):(8,1)">) -> !cute.int_tuple<"128"> loc(#loc574)
    %e0_104 = cute.get_leaves(%sz_103) : !cute.int_tuple<"128"> loc(#loc574)
    %sz_105 = cute.size(%lay_86) : (!cute.layout<"(1,8):(0,1)">) -> !cute.int_tuple<"8"> loc(#loc574)
    %e0_106 = cute.get_leaves(%sz_105) : !cute.int_tuple<"8"> loc(#loc574)
    %shape_107 = cute.make_shape() : () -> !cute.shape<"(128,8)"> loc(#loc574)
    %lay_108 = cute.make_layout(%shape_107) : !cute.layout<"(128,8):(1,128)"> loc(#loc574)
    %rinv_109 = cute.right_inverse(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.layout<"(8,128):(128,1)"> loc(#loc574)
    %43 = cute.composition(%rinv_109, %lay_108) : (!cute.layout<"(8,128):(128,1)">, !cute.layout<"(128,8):(1,128)">) -> !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc574)
    %44 = cute.get_shape(%prod_102) : (!cute.layout<"(16,(8,8)):(8,(128,1))">) -> !cute.shape<"(16,(8,8))"> loc(#loc573)
    %e0_110, %e1_111, %e2_112 = cute.get_leaves(%44) : !cute.shape<"(16,(8,8))"> loc(#loc573)
    %int_tuple_113 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,(8,8))"> loc(#loc574)
    %res_114 = cute.tuple.product_each(%int_tuple_113) : (!cute.int_tuple<"(16,(8,8))">) -> !cute.int_tuple<"(16,64)"> loc(#loc574)
    %e0_115, %e1_116 = cute.get_leaves(%res_114) : !cute.int_tuple<"(16,64)"> loc(#loc574)
    %int_tuple_117 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,64)"> loc(#loc574)
    %res_118 = cute.tuple.product_each(%int_tuple_117) : (!cute.int_tuple<"(16,64)">) -> !cute.int_tuple<"(16,64)"> loc(#loc574)
    %e0_119, %e1_120 = cute.get_leaves(%res_118) : !cute.int_tuple<"(16,64)"> loc(#loc574)
    %tile_121 = cute.make_tile() : () -> !cute.tile<"[16:1;64:1]"> loc(#loc574)
    %45 = cute.make_tiled_copy(%atom_79) : !copy_simt loc(#loc574)
    %shape_122 = cute.make_shape() : () -> !cute.shape<"(16,8,16)"> loc(#loc575)
    %atom_123 = cute.make_atom() : () -> !cute_nvgpu.sm80.mma<16x8x16, elem_type = (bf16, bf16, f32) > loc(#loc575)
    %shape_124 = cute.make_shape() : () -> !cute.shape<"(4,1,1)"> loc(#loc575)
    %lay_125 = cute.make_layout(%shape_124) : !cute.layout<"(4,1,1):(1,0,0)"> loc(#loc575)
    %46 = cute.get_shape(%lay_125) : (!cute.layout<"(4,1,1):(1,0,0)">) -> !cute.shape<"(4,1,1)"> loc(#loc576)
    %e0_126, %e1_127, %e2_128 = cute.get_leaves(%46) : !cute.shape<"(4,1,1)"> loc(#loc576)
    %tile_129 = cute.make_tile() : () -> !cute.tile<"[64:1;16:1;16:1]"> loc(#loc575)
    %47 = cute.make_tiled_mma(%atom_123) : !mma_bf16_bf16_f32_16x8x16_ loc(#loc575)
    %lay_130 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc311)
    %48 = cute.get_shape(%lay_130) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
    %e0_131, %e1_132, %e2_133, %e3_134 = cute.get_leaves(%48) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc311)
    %itup_135 = cute.to_int_tuple(%e0_131) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
    %49 = cute.get_scalars(%itup_135) : !cute.int_tuple<"?"> loc(#loc311)
    %itup_136 = cute.to_int_tuple(%e1_132) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
    %50 = cute.get_scalars(%itup_136) : !cute.int_tuple<"?"> loc(#loc311)
    %itup_137 = cute.to_int_tuple(%e2_133) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc311)
    %51 = cute.get_scalars(%itup_137) : !cute.int_tuple<"?"> loc(#loc311)
    %itup_138 = cute.to_int_tuple(%e3_134) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc311)
    %52 = cute.get_scalars(%itup_138) : !cute.int_tuple<"?{div=8}"> loc(#loc311)
    %int_tuple_139 = cute.make_int_tuple(%itup_136) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc577)
    %tile_140 = cute.make_tile() : () -> !cute.tile<"128:1"> loc(#loc577)
    %shp = cute.ceil_div(%int_tuple_139, %tile_140) : !cute.int_tuple<"?">, !cute.tile<"128:1"> loc(#loc577)
    %e0_141 = cute.get_leaves(%shp) : !cute.int_tuple<"?"> loc(#loc577)
    %53 = cute.get_scalars(%e0_141) : !cute.int_tuple<"?"> loc(#loc577)
    %int_tuple_142 = cute.make_int_tuple(%itup_135) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc578)
    %sz_143 = cute.size(%int_tuple_142) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc578)
    %e0_144 = cute.get_leaves(%sz_143) : !cute.int_tuple<"?"> loc(#loc578)
    %54 = cute.get_scalars(%e0_144) : !cute.int_tuple<"?"> loc(#loc578)
    %int_tuple_145 = cute.make_int_tuple(%itup_137) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc579)
    %sz_146 = cute.size(%int_tuple_145) : (!cute.int_tuple<"?">) -> !cute.int_tuple<"?"> loc(#loc579)
    %e0_147 = cute.get_leaves(%sz_146) : !cute.int_tuple<"?"> loc(#loc579)
    %55 = cute.get_scalars(%e0_147) : !cute.int_tuple<"?"> loc(#loc579)
    %cst = arith.constant 1.44269502 : f32 loc(#loc290)
    %56 = arith.mulf %arg4, %cst : f32 loc(#loc313)
    %lay_148 = cute.get_layout(%arg0) : !memref_gmem_bf16_ loc(#loc294)
    %57 = cute.get_shape(%lay_148) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_149, %e1_150, %e2_151, %e3_152 = cute.get_leaves(%57) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_153 = cute.to_int_tuple(%e0_149) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %58 = cute.get_scalars(%itup_153) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_154 = cute.to_int_tuple(%e1_150) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %59 = cute.get_scalars(%itup_154) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_155 = cute.to_int_tuple(%e2_151) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %60 = cute.get_scalars(%itup_155) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_156 = cute.to_int_tuple(%e3_152) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %61 = cute.get_scalars(%itup_156) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %62 = cute.get_stride(%lay_148) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_157, %e1_158, %e2_159, %e3_160 = cute.get_leaves(%62) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_161 = cute.to_int_tuple(%e0_157) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %63 = cute.get_scalars(%itup_161) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_162 = cute.to_int_tuple(%e1_158) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %64 = cute.get_scalars(%itup_162) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_163 = cute.to_int_tuple(%e2_159) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %65 = cute.get_scalars(%itup_163) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_164 = cute.get_layout(%arg1) : !memref_gmem_bf16_ loc(#loc294)
    %66 = cute.get_shape(%lay_164) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_165, %e1_166, %e2_167, %e3_168 = cute.get_leaves(%66) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_169 = cute.to_int_tuple(%e0_165) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %67 = cute.get_scalars(%itup_169) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_170 = cute.to_int_tuple(%e1_166) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %68 = cute.get_scalars(%itup_170) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_171 = cute.to_int_tuple(%e2_167) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %69 = cute.get_scalars(%itup_171) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_172 = cute.to_int_tuple(%e3_168) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %70 = cute.get_scalars(%itup_172) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %71 = cute.get_stride(%lay_164) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_173, %e1_174, %e2_175, %e3_176 = cute.get_leaves(%71) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_177 = cute.to_int_tuple(%e0_173) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %72 = cute.get_scalars(%itup_177) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_178 = cute.to_int_tuple(%e1_174) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %73 = cute.get_scalars(%itup_178) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_179 = cute.to_int_tuple(%e2_175) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %74 = cute.get_scalars(%itup_179) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_180 = cute.get_layout(%arg2) : !memref_gmem_bf16_ loc(#loc294)
    %75 = cute.get_shape(%lay_180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_181, %e1_182, %e2_183, %e3_184 = cute.get_leaves(%75) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_185 = cute.to_int_tuple(%e0_181) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %76 = cute.get_scalars(%itup_185) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_186 = cute.to_int_tuple(%e1_182) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %77 = cute.get_scalars(%itup_186) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_187 = cute.to_int_tuple(%e2_183) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %78 = cute.get_scalars(%itup_187) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_188 = cute.to_int_tuple(%e3_184) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %79 = cute.get_scalars(%itup_188) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %80 = cute.get_stride(%lay_180) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_189, %e1_190, %e2_191, %e3_192 = cute.get_leaves(%80) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_193 = cute.to_int_tuple(%e0_189) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %81 = cute.get_scalars(%itup_193) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_194 = cute.to_int_tuple(%e1_190) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %82 = cute.get_scalars(%itup_194) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_195 = cute.to_int_tuple(%e2_191) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %83 = cute.get_scalars(%itup_195) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %lay_196 = cute.get_layout(%arg3) : !memref_gmem_bf16_ loc(#loc294)
    %84 = cute.get_shape(%lay_196) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %e0_197, %e1_198, %e2_199, %e3_200 = cute.get_leaves(%84) : !cute.shape<"(?,?,?,?{div=8})"> loc(#loc295)
    %itup_201 = cute.to_int_tuple(%e0_197) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %85 = cute.get_scalars(%itup_201) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_202 = cute.to_int_tuple(%e1_198) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %86 = cute.get_scalars(%itup_202) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_203 = cute.to_int_tuple(%e2_199) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc295)
    %87 = cute.get_scalars(%itup_203) : !cute.int_tuple<"?"> loc(#loc295)
    %itup_204 = cute.to_int_tuple(%e3_200) : !cute.shape<"?{div=8}"> to !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %88 = cute.get_scalars(%itup_204) : !cute.int_tuple<"?{div=8}"> loc(#loc295)
    %89 = cute.get_stride(%lay_196) : (!cute.layout<"(?,?,?,?{div=8}):(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)">) -> !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %e0_205, %e1_206, %e2_207, %e3_208 = cute.get_leaves(%89) : !cute.stride<"(?{i64 div=8},?{i64 div=8},?{i64 div=8},1)"> loc(#loc295)
    %itup_209 = cute.to_int_tuple(%e0_205) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %90 = cute.get_scalars(%itup_209) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_210 = cute.to_int_tuple(%e1_206) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %91 = cute.get_scalars(%itup_210) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %itup_211 = cute.to_int_tuple(%e2_207) : !cute.stride<"?{i64 div=8}"> to !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %92 = cute.get_scalars(%itup_211) : !cute.int_tuple<"?{i64 div=8}"> loc(#loc295)
    %93 = cute.composed_get_inner(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
    %94 = cute.composed_get_offset(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0"> loc(#loc296)
    %e0_212 = cute.get_leaves(%94) : !cute.int_tuple<"0"> loc(#loc296)
    %95 = cute.composed_get_outer(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))"> loc(#loc296)
    %96 = cute.get_shape(%95) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))"> loc(#loc295)
    %e0_213, %e1_214, %e2_215, %e3_216 = cute.get_leaves(%96) : !cute.shape<"((8,16),(64,2))"> loc(#loc295)
    %97 = cute.get_stride(%95) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
    %e0_217, %e1_218, %e2_219, %e3_220 = cute.get_leaves(%97) : !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
    %98 = cute.composed_get_inner(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
    %99 = cute.composed_get_offset(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.int_tuple<"0"> loc(#loc296)
    %e0_221 = cute.get_leaves(%99) : !cute.int_tuple<"0"> loc(#loc296)
    %100 = cute.composed_get_outer(%tile_to_shape_73) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.layout<"((8,8),(64,2)):((64,512),(1,4096))"> loc(#loc296)
    %101 = cute.get_shape(%100) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.shape<"((8,8),(64,2))"> loc(#loc295)
    %e0_222, %e1_223, %e2_224, %e3_225 = cute.get_leaves(%101) : !cute.shape<"((8,8),(64,2))"> loc(#loc295)
    %102 = cute.get_stride(%100) : (!cute.layout<"((8,8),(64,2)):((64,512),(1,4096))">) -> !cute.stride<"((64,512),(1,4096))"> loc(#loc295)
    %e0_226, %e1_227, %e2_228, %e3_229 = cute.get_leaves(%102) : !cute.stride<"((64,512),(1,4096))"> loc(#loc295)
    %103 = cute.composed_get_inner(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.swizzle<"S<3,3,3>"> loc(#loc296)
    %104 = cute.composed_get_offset(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.int_tuple<"0"> loc(#loc296)
    %e0_230 = cute.get_leaves(%104) : !cute.int_tuple<"0"> loc(#loc296)
    %105 = cute.composed_get_outer(%tile_to_shape) : (!cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.layout<"((8,16),(64,2)):((64,512),(1,8192))"> loc(#loc296)
    %106 = cute.get_shape(%105) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.shape<"((8,16),(64,2))"> loc(#loc295)
    %e0_231, %e1_232, %e2_233, %e3_234 = cute.get_leaves(%106) : !cute.shape<"((8,16),(64,2))"> loc(#loc295)
    %107 = cute.get_stride(%105) : (!cute.layout<"((8,16),(64,2)):((64,512),(1,8192))">) -> !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
    %e0_235, %e1_236, %e2_237, %e3_238 = cute.get_leaves(%107) : !cute.stride<"((64,512),(1,8192))"> loc(#loc295)
    %108 = cute.static : !cute.tile<"[16:1;64:1]"> loc(#loc297)
    %e0_239, %e1_240 = cute.get_leaves(%108) : !cute.tile<"[16:1;64:1]"> loc(#loc298)
    %109 = cute.get_shape(%e0_239) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
    %e0_241 = cute.get_leaves(%109) : !cute.shape<"16"> loc(#loc295)
    %110 = cute.get_stride(%e0_239) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_242 = cute.get_leaves(%110) : !cute.stride<"1"> loc(#loc295)
    %111 = cute.get_shape(%e1_240) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
    %e0_243 = cute.get_leaves(%111) : !cute.shape<"64"> loc(#loc295)
    %112 = cute.get_stride(%e1_240) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_244 = cute.get_leaves(%112) : !cute.stride<"1"> loc(#loc295)
    %113 = cute.static : !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc299)
    %114 = cute.get_shape(%113) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)"> loc(#loc295)
    %e0_245, %e1_246, %e2_247 = cute.get_leaves(%114) : !cute.shape<"((8,16),8)"> loc(#loc295)
    %115 = cute.get_stride(%113) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)"> loc(#loc295)
    %e0_248, %e1_249, %e2_250 = cute.get_leaves(%115) : !cute.stride<"((128,1),16)"> loc(#loc295)
    %116 = cute.static : !cute.layout<"1:0"> loc(#loc300)
    %117 = cute.get_shape(%116) : (!cute.layout<"1:0">) -> !cute.shape<"1"> loc(#loc295)
    %e0_251 = cute.get_leaves(%117) : !cute.shape<"1"> loc(#loc295)
    %118 = cute.get_stride(%116) : (!cute.layout<"1:0">) -> !cute.stride<"0"> loc(#loc295)
    %e0_252 = cute.get_leaves(%118) : !cute.stride<"0"> loc(#loc295)
    %119 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc301)
    %120 = cute.get_shape(%119) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
    %e0_253, %e1_254 = cute.get_leaves(%120) : !cute.shape<"(1,8)"> loc(#loc295)
    %121 = cute.get_stride(%119) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
    %e0_255, %e1_256 = cute.get_leaves(%121) : !cute.stride<"(0,1)"> loc(#loc295)
    %122 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc302)
    %123 = cute.get_shape(%122) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
    %e0_257, %e1_258 = cute.get_leaves(%123) : !cute.shape<"(1,8)"> loc(#loc295)
    %124 = cute.get_stride(%122) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
    %e0_259, %e1_260 = cute.get_leaves(%124) : !cute.stride<"(0,1)"> loc(#loc295)
    %125 = cute.static : !cute.tile<"[16:1;64:1]"> loc(#loc297)
    %e0_261, %e1_262 = cute.get_leaves(%125) : !cute.tile<"[16:1;64:1]"> loc(#loc298)
    %126 = cute.get_shape(%e0_261) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
    %e0_263 = cute.get_leaves(%126) : !cute.shape<"16"> loc(#loc295)
    %127 = cute.get_stride(%e0_261) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_264 = cute.get_leaves(%127) : !cute.stride<"1"> loc(#loc295)
    %128 = cute.get_shape(%e1_262) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
    %e0_265 = cute.get_leaves(%128) : !cute.shape<"64"> loc(#loc295)
    %129 = cute.get_stride(%e1_262) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_266 = cute.get_leaves(%129) : !cute.stride<"1"> loc(#loc295)
    %130 = cute.static : !cute.layout<"((8,16),8):((128,1),16)"> loc(#loc299)
    %131 = cute.get_shape(%130) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.shape<"((8,16),8)"> loc(#loc295)
    %e0_267, %e1_268, %e2_269 = cute.get_leaves(%131) : !cute.shape<"((8,16),8)"> loc(#loc295)
    %132 = cute.get_stride(%130) : (!cute.layout<"((8,16),8):((128,1),16)">) -> !cute.stride<"((128,1),16)"> loc(#loc295)
    %e0_270, %e1_271, %e2_272 = cute.get_leaves(%132) : !cute.stride<"((128,1),16)"> loc(#loc295)
    %133 = cute.static : !cute.layout<"1:0"> loc(#loc300)
    %134 = cute.get_shape(%133) : (!cute.layout<"1:0">) -> !cute.shape<"1"> loc(#loc295)
    %e0_273 = cute.get_leaves(%134) : !cute.shape<"1"> loc(#loc295)
    %135 = cute.get_stride(%133) : (!cute.layout<"1:0">) -> !cute.stride<"0"> loc(#loc295)
    %e0_274 = cute.get_leaves(%135) : !cute.stride<"0"> loc(#loc295)
    %136 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc301)
    %137 = cute.get_shape(%136) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
    %e0_275, %e1_276 = cute.get_leaves(%137) : !cute.shape<"(1,8)"> loc(#loc295)
    %138 = cute.get_stride(%136) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
    %e0_277, %e1_278 = cute.get_leaves(%138) : !cute.stride<"(0,1)"> loc(#loc295)
    %139 = cute.static : !cute.layout<"(1,8):(0,1)"> loc(#loc302)
    %140 = cute.get_shape(%139) : (!cute.layout<"(1,8):(0,1)">) -> !cute.shape<"(1,8)"> loc(#loc295)
    %e0_279, %e1_280 = cute.get_leaves(%140) : !cute.shape<"(1,8)"> loc(#loc295)
    %141 = cute.get_stride(%139) : (!cute.layout<"(1,8):(0,1)">) -> !cute.stride<"(0,1)"> loc(#loc295)
    %e0_281, %e1_282 = cute.get_leaves(%141) : !cute.stride<"(0,1)"> loc(#loc295)
    %142 = cute.static : !cute.layout<"(32,4,1,1):(1,32,0,0)"> loc(#loc303)
    %143 = cute.get_shape(%142) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.shape<"(32,4,1,1)"> loc(#loc295)
    %e0_283, %e1_284, %e2_285, %e3_286 = cute.get_leaves(%143) : !cute.shape<"(32,4,1,1)"> loc(#loc295)
    %144 = cute.get_stride(%142) : (!cute.layout<"(32,4,1,1):(1,32,0,0)">) -> !cute.stride<"(1,32,0,0)"> loc(#loc295)
    %e0_287, %e1_288, %e2_289, %e3_290 = cute.get_leaves(%144) : !cute.stride<"(1,32,0,0)"> loc(#loc295)
    %145 = cute.static : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc297)
    %e0_291, %e1_292, %e2_293 = cute.get_leaves(%145) : !cute.tile<"[64:1;16:1;16:1]"> loc(#loc298)
    %146 = cute.get_shape(%e0_291) : (!cute.layout<"64:1">) -> !cute.shape<"64"> loc(#loc295)
    %e0_294 = cute.get_leaves(%146) : !cute.shape<"64"> loc(#loc295)
    %147 = cute.get_stride(%e0_291) : (!cute.layout<"64:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_295 = cute.get_leaves(%147) : !cute.stride<"1"> loc(#loc295)
    %148 = cute.get_shape(%e1_292) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
    %e0_296 = cute.get_leaves(%148) : !cute.shape<"16"> loc(#loc295)
    %149 = cute.get_stride(%e1_292) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_297 = cute.get_leaves(%149) : !cute.stride<"1"> loc(#loc295)
    %150 = cute.get_shape(%e2_293) : (!cute.layout<"16:1">) -> !cute.shape<"16"> loc(#loc295)
    %e0_298 = cute.get_leaves(%150) : !cute.shape<"16"> loc(#loc295)
    %151 = cute.get_stride(%e2_293) : (!cute.layout<"16:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_299 = cute.get_leaves(%151) : !cute.stride<"1"> loc(#loc295)
    %152 = cute.static : !cute.layout<"32:1"> loc(#loc304)
    %153 = cute.get_shape(%152) : (!cute.layout<"32:1">) -> !cute.shape<"32"> loc(#loc295)
    %e0_300 = cute.get_leaves(%153) : !cute.shape<"32"> loc(#loc295)
    %154 = cute.get_stride(%152) : (!cute.layout<"32:1">) -> !cute.stride<"1"> loc(#loc295)
    %e0_301 = cute.get_leaves(%154) : !cute.stride<"1"> loc(#loc295)
    %155 = cute.static : !cute.shape<"(16,8,16)"> loc(#loc305)
    %e0_302, %e1_303, %e2_304 = cute.get_leaves(%155) : !cute.shape<"(16,8,16)"> loc(#loc305)
    %156 = cute.static : !cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))"> loc(#loc306)
    %157 = cute.get_shape(%156) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.shape<"((4,8),(2,2,2))"> loc(#loc295)
    %e0_305, %e1_306, %e2_307, %e3_308, %e4 = cute.get_leaves(%157) : !cute.shape<"((4,8),(2,2,2))"> loc(#loc295)
    %158 = cute.get_stride(%156) : (!cute.layout<"((4,8),(2,2,2)):((32,1),(16,8,128))">) -> !cute.stride<"((32,1),(16,8,128))"> loc(#loc295)
    %e0_309, %e1_310, %e2_311, %e3_312, %e4_313 = cute.get_leaves(%158) : !cute.stride<"((32,1),(16,8,128))"> loc(#loc295)
    %159 = cute.static : !cute.layout<"((4,8),(2,2)):((16,1),(8,64))"> loc(#loc307)
    %160 = cute.get_shape(%159) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.shape<"((4,8),(2,2))"> loc(#loc295)
    %e0_314, %e1_315, %e2_316, %e3_317 = cute.get_leaves(%160) : !cute.shape<"((4,8),(2,2))"> loc(#loc295)
    %161 = cute.get_stride(%159) : (!cute.layout<"((4,8),(2,2)):((16,1),(8,64))">) -> !cute.stride<"((16,1),(8,64))"> loc(#loc295)
    %e0_318, %e1_319, %e2_320, %e3_321 = cute.get_leaves(%161) : !cute.stride<"((16,1),(8,64))"> loc(#loc295)
    %162 = cute.static : !cute.layout<"((4,8),(2,2)):((32,1),(16,8))"> loc(#loc308)
    %163 = cute.get_shape(%162) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.shape<"((4,8),(2,2))"> loc(#loc295)
    %e0_322, %e1_323, %e2_324, %e3_325 = cute.get_leaves(%163) : !cute.shape<"((4,8),(2,2))"> loc(#loc295)
    %164 = cute.get_stride(%162) : (!cute.layout<"((4,8),(2,2)):((32,1),(16,8))">) -> !cute.stride<"((32,1),(16,8))"> loc(#loc295)
    %e0_326, %e1_327, %e2_328, %e3_329 = cute.get_leaves(%164) : !cute.stride<"((32,1),(16,8))"> loc(#loc295)
    %c65536_i32 = arith.constant 65536 : i32 loc(#loc290)
    %165 = arith.extsi %c65536_i32 : i32 to i64 loc(#loc290)
    %c128_i32 = arith.constant 128 : i32 loc(#loc290)
    %c1_i32 = arith.constant 1 : i32 loc(#loc290)
    %166 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32, %c1_i32, %c1_i32), dynamicSmemBytes = %165, gridDim = (%53, %54, %55), stream = %arg5) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2> loc(#loc291)
    %167 = cuda.launch_ex @kernels::@kernel_cutlass_kernel___main__FlashAttentionForwardAmpere_object_at__tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16gmemalign16odiv8i64div8i64div8i64div81_tensorptrbf16g_0<%166> (%arg0, %arg1, %arg2, %arg3, %56, %tile_to_shape, %tile_to_shape_73, %tile_to_shape, %42, %45, %47) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, !memref_gmem_bf16_, f32, !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">, !cute.composed_layout<"S<3,3,3> o 0 o ((8,8),(64,2)):((64,512),(1,4096))">, !cute.composed_layout<"S<3,3,3> o 0 o ((8,16),(64,2)):((64,512),(1,8192))">, !copy_ldgsts, !copy_simt, !mma_bf16_bf16_f32_16x8x16_) -> !cuda.result loc(#loc291)
    %168 = cuda.cast %167 : !cuda.result -> i32 loc(#loc291)
    cuda.return_if_error %168 : i32 loc(#loc291)
    %c0_i32 = arith.constant 0 : i32 loc(#loc290)
    return %c0_i32 : i32 loc(#loc290)
  } loc(#loc290)
} loc(#loc290)
#loc2 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/base_dsl/dsl.py":658:0)
#loc3 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":171:0)
#loc4 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":158:0)
#loc5 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":802:0)
#loc6 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":950:0)
#loc7 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":155:0)
#loc8 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":163:0)
#loc9 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":624:0)
#loc10 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":591:0)
#loc11 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":595:0)
#loc12 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":599:0)
#loc13 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":338:0)
#loc14 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":309:0)
#loc15 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":310:0)
#loc16 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":311:0)
#loc17 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":312:0)
#loc18 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":258:0)
#loc19 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":389:0)
#loc20 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":390:0)
#loc21 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":392:0)
#loc22 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":392:0)
#loc23 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/base_dsl/typing.py":846:0)
#loc24 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":395:0)
#loc25 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":408:0)
#loc26 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3392:0)
#loc27 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":1220:0)
#loc28 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":407:0)
#loc29 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":1785:0)
#loc30 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":414:0)
#loc31 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":413:0)
#loc32 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":420:0)
#loc33 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":419:0)
#loc34 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":428:0)
#loc35 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/utils/smem_allocator.py":178:0)
#loc36 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":430:0)
#loc37 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/utils/smem_allocator.py":187:0)
#loc38 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":4069:0)
#loc39 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":3899:0)
#loc40 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":3900:0)
#loc41 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2415:0)
#loc42 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":438:0)
#loc43 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":436:0)
#loc44 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":504:0)
#loc45 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":446:0)
#loc46 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3627:0)
#loc47 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":447:0)
#loc48 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3590:0)
#loc49 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":449:0)
#loc50 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":450:0)
#loc51 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":452:0)
#loc52 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":453:0)
#loc53 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":459:0)
#loc54 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3742:0)
#loc55 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2709:0)
#loc56 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":460:0)
#loc57 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":461:0)
#loc58 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":462:0)
#loc59 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":465:0)
#loc60 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2466:0)
#loc61 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":763:0)
#loc62 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":466:0)
#loc63 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":471:0)
#loc64 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":475:0)
#loc65 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":479:0)
#loc66 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":322:0)
#loc67 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":358:0)
#loc68 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":483:0)
#loc69 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":326:0)
#loc70 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":484:0)
#loc71 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":485:0)
#loc72 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":491:0)
#loc73 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":492:0)
#loc74 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3659:0)
#loc75 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":493:0)
#loc76 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":494:0)
#loc77 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":495:0)
#loc78 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":496:0)
#loc79 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":503:0)
#loc80 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2053:0)
#loc81 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":504:0)
#loc82 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":506:0)
#loc83 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":505:0)
#loc84 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":511:0)
#loc85 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":510:0)
#loc86 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":517:0)
#loc87 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":518:0)
#loc88 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":525:0)
#loc89 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":526:0)
#loc90 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":528:0)
#loc91 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":522:0)
#loc92 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":521:0)
#loc93 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":536:0)
#loc94 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":537:0)
#loc95 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":539:0)
#loc96 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":533:0)
#loc97 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":532:0)
#loc98 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":547:0)
#loc99 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":546:0)
#loc100 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":552:0)
#loc101 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":551:0)
#loc102 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":558:0)
#loc103 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":559:0)
#loc104 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":562:0)
#loc105 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":563:0)
#loc106 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":564:0)
#loc107 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":2201:0)
#loc108 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":390:0)
#loc109 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":1508:0)
#loc110 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":391:0)
#loc111 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":393:0)
#loc112 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":396:0)
#loc113 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":560:0)
#loc114 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":568:0)
#loc115 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":569:0)
#loc116 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":570:0)
#loc117 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":573:0)
#loc118 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":574:0)
#loc119 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":575:0)
#loc120 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":571:0)
#loc121 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":579:0)
#loc122 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":581:0)
#loc123 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":586:0)
#loc124 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":590:0)
#loc125 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":593:0)
#loc126 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":594:0)
#loc127 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":790:0)
#loc128 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":793:0)
#loc129 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":794:0)
#loc130 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":797:0)
#loc131 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":798:0)
#loc132 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":802:0)
#loc133 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":804:0)
#loc134 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":805:0)
#loc135 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":803:0)
#loc136 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":809:0)
#loc137 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":810:0)
#loc138 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":811:0)
#loc139 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":807:0)
#loc140 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":814:0)
#loc141 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":818:0)
#loc142 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":816:0)
#loc143 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":823:0)
#loc144 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":830:0)
#loc145 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":831:0)
#loc146 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":828:0)
#loc147 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":835:0)
#loc148 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":836:0)
#loc149 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":833:0)
#loc150 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":839:0)
#loc151 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":841:0)
#loc152 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":844:0)
#loc153 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":845:0)
#loc154 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":842:0)
#loc155 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":849:0)
#loc156 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":850:0)
#loc157 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":847:0)
#loc158 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":855:0)
#loc159 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":856:0)
#loc160 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":852:0)
#loc161 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":861:0)
#loc162 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":862:0)
#loc163 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":867:0)
#loc164 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":865:0)
#loc165 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":871:0)
#loc166 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1087:0)
#loc167 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1091:0)
#loc168 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1092:0)
#loc169 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1095:0)
#loc170 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1096:0)
#loc171 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1101:0)
#loc172 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1102:0)
#loc173 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1105:0)
#loc174 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1106:0)
#loc175 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1088:0)
#loc176 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1110:0)
#loc177 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1111:0)
#loc178 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":971:0)
#loc179 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":980:0)
#loc180 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":979:0)
#loc181 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":984:0)
#loc182 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":988:0)
#loc183 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":993:0)
#loc184 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":995:0)
#loc185 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":335:0)
#loc186 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":994:0)
#loc187 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":997:0)
#loc188 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/cutlass.py":1144:0)
#loc189 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/tree_utils.py":690:0)
#loc190 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1010:0)
#loc191 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1012:0)
#loc192 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1125:0)
#loc193 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1141:0)
#loc194 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1129:0)
#loc195 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":1206:0)
#loc196 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1034:0)
#loc197 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1049:0)
#loc198 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1050:0)
#loc199 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1051:0)
#loc200 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":846:0)
#loc201 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":884:0)
#loc202 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":885:0)
#loc203 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":892:0)
#loc204 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":895:0)
#loc205 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":896:0)
#loc206 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":897:0)
#loc207 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":900:0)
#loc208 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":901:0)
#loc209 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":902:0)
#loc210 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":893:0)
#loc211 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":905:0)
#loc212 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":910:0)
#loc213 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":911:0)
#loc214 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":908:0)
#loc215 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":914:0)
#loc216 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":916:0)
#loc217 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":919:0)
#loc218 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":920:0)
#loc219 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":917:0)
#loc220 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":925:0)
#loc221 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":926:0)
#loc222 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":922:0)
#loc223 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/cutlass_ast_decorators.py":204:0)
#loc224 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":964:0)
#loc225 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":967:0)
#loc226 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1020:0)
#loc227 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1021:0)
#loc228 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1045:0)
#loc229 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1047:0)
#loc230 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1068:0)
#loc231 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1069:0)
#loc232 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1071:0)
#loc233 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/base_dsl/typing.py":1551:0)
#loc234 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1074:0)
#loc235 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":1077:0)
#loc236 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":694:0)
#loc237 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":695:0)
#loc238 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":697:0)
#loc239 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":700:0)
#loc240 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/atom.py":330:0)
#loc241 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":704:0)
#loc242 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":706:0)
#loc243 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":707:0)
#loc244 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":709:0)
#loc245 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":715:0)
#loc246 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":714:0)
#loc247 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":721:0)
#loc248 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":722:0)
#loc249 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":723:0)
#loc250 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":725:0)
#loc251 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":727:0)
#loc252 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":732:0)
#loc253 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":734:0)
#loc254 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":733:0)
#loc255 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":738:0)
#loc256 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":740:0)
#loc257 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":739:0)
#loc258 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":747:0)
#loc259 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":749:0)
#loc260 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":748:0)
#loc261 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":752:0)
#loc262 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":753:0)
#loc263 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":756:0)
#loc264 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":757:0)
#loc265 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":758:0)
#loc266 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":754:0)
#loc267 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/runtime.py":388:0)
#loc268 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":238:0)
#loc269 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":240:0)
#loc270 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":2799:0)
#loc271 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":237:0)
#loc272 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":242:0)
#loc273 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":249:0)
#loc274 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":260:0)
#loc275 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":263:0)
#loc276 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":266:0)
#loc277 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":276:0)
#loc278 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":282:0)
#loc279 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":288:0)
#loc280 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":289:0)
#loc281 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":297:0)
#loc282 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":301:0)
#loc283 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":3733:0)
#loc284 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":305:0)
#loc285 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":312:0)
#loc286 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":1566:0)
#loc287 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":320:0)
#loc288 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":321:0)
#loc289 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/flash_attention_v2.py":322:0)
#loc292 = loc("fop_args = list(fop.regions[0].blocks[0].arguments)"(#loc2))
#loc293 = loc("return _Tensor("(#loc3))
#loc294 = loc("return f\22tensor<{pretty_str(self.iterator)} o {pretty_str(self.layout)}>\22"(#loc4))
#loc295 = loc("return f\22{pretty_str(self.shape)}:{pretty_str(self.stride)}\22"(#loc5))
#loc296 = loc("return f\22{pretty_str(self.inner)} o {pretty_str(self.offset)} o {pretty_str(self.outer)}\22"(#loc6))
#loc297 = loc("t = static(t, loc=loc, ip=ip)"(#loc7))
#loc298 = loc("vals = get_leaves(t, loc=loc, ip=ip)"(#loc8))
#loc299 = loc("return static(self._trait.value.type.layout_tv_tiled)"(#loc9))
#loc300 = loc("return static(self._trait.value.type.thr_id)"(#loc10))
#loc301 = loc("return static(self._trait.value.type.layout_src_tv)"(#loc11))
#loc302 = loc("return static(self._trait.value.type.layout_dst_tv)"(#loc12))
#loc303 = loc("return static(self._trait.value.type.thr_layout_vmnk)"(#loc13))
#loc304 = loc("res += \22  ThrID:           \22 + pretty_str(self.thr_id) + \22\\n\22"(#loc14))
#loc305 = loc("res += \22  Shape MNK:       \22 + pretty_str(self.shape_mnk) + \22\\n\22"(#loc15))
#loc306 = loc("res += \22  TV Layout A:     \22 + pretty_str(self.tv_layout_A) + \22\\n\22"(#loc16))
#loc307 = loc("res += \22  TV Layout B:     \22 + pretty_str(self.tv_layout_B) + \22\\n\22"(#loc17))
#loc308 = loc("return static(self._trait.value.type.layout_c_tv)"(#loc18))
#loc309 = loc("tidx, _, _ = cute.arch.thread_idx()"(#loc19))
#loc310 = loc("m_block, batch_size, num_head = cute.arch.block_idx()"(#loc20))
#loc311 = loc("return self.layout.shape"(#loc21))
#loc312 = loc("n_block_max = cute.ceil_div(mK.shape[1], self._n_block_size)"(#loc22))
#loc313 = loc("res_val = op(lhs_val, rhs_val)"(#loc23))
#loc314 = loc("cute.ceil_div("(#loc24))
#loc315 = loc("mQ[batch_size, None, num_head, None],"(#loc25))
#loc316 = loc("return self.operation.results[0]"(#loc26))
#loc317 = loc("return _Tensor(res, dtype=input.element_type)"(#loc27))
#loc318 = loc("gQ = cute.local_tile("(#loc28))
#loc319 = loc("return self.operation.results[0]"(#loc29))
#loc320 = loc("mK[batch_size, None, num_head, None],"(#loc30))
#loc321 = loc("gK = cute.local_tile("(#loc31))
#loc322 = loc("mV[batch_size, None, num_head, None],"(#loc32))
#loc323 = loc("gV = cute.local_tile("(#loc33))
#loc324 = loc("smem = cutlass.utils.SmemAllocator()"(#loc34))
#loc325 = loc("self._base += size_in_bytes"(#loc35))
#loc326 = loc("storage = smem.allocate(SharedStorage)"(#loc36))
#loc327 = loc("self._allocated_bytes <= get_dyn_smem_size(loc=loc, ip=ip),"(#loc37))
#loc328 = loc("new_obj = struct._MemRangeData(obj._dtype, obj._size, base + off)"(#loc38))
#loc329 = loc("ptr = recast_ptr(self._base, swizzle, dtype=elem_type)"(#loc39))
#loc330 = loc("res = make_tensor(ptr, layout)"(#loc40))
#loc331 = loc("return self.operation.results[0]"(#loc41))
#loc332 = loc("cute.make_layout("(#loc42))
#loc333 = loc("sVt = cute.composition("(#loc43))
#loc334 = loc("return CompositionOp(lhs=lhs, rhs=rhs, loc=loc, ip=ip).result"(#loc44))
#loc335 = loc("tQgQ = gmem_thr_copy_QKV.partition_S(gQ)"(#loc45))
#loc336 = loc("return self.operation.results[0]"(#loc46))
#loc337 = loc("tQsQ = gmem_thr_copy_QKV.partition_D(sQ)"(#loc47))
#loc338 = loc("return self.operation.results[0]"(#loc48))
#loc339 = loc("tKgK = gmem_thr_copy_QKV.partition_S(gK)"(#loc49))
#loc340 = loc("tKsK = gmem_thr_copy_QKV.partition_D(sK)"(#loc50))
#loc341 = loc("tVgV = gmem_thr_copy_QKV.partition_S(gV)"(#loc51))
#loc342 = loc("tVsV = gmem_thr_copy_QKV.partition_D(sV)"(#loc52))
#loc343 = loc("tSrQ = thr_mma.make_fragment_A(thr_mma.partition_A(sQ))"(#loc53))
#loc344 = loc("return self.operation.results[0]"(#loc54))
#loc345 = loc("return self.operation.results[0]"(#loc55))
#loc346 = loc("tSrK = thr_mma.make_fragment_B(thr_mma.partition_B(sK))"(#loc56))
#loc347 = loc("tOrVt = thr_mma.make_fragment_B(thr_mma.partition_B(sVt))"(#loc57))
#loc348 = loc("acc_shape_O = thr_mma.partition_shape_C("(#loc58))
#loc349 = loc("acc_O = cute.make_rmem_tensor(acc_shape_O, cutlass.Float32)"(#loc59))
#loc350 = loc("return self.operation.results[0]"(#loc60))
#loc351 = loc("return _Tensor(tensor.value, dtype)"(#loc61))
#loc352 = loc("acc_O.fill(0.0)"(#loc62))
#loc353 = loc("smem_copy_atom_Q = cute.make_copy_atom("(#loc63))
#loc354 = loc("smem_copy_atom_K = cute.make_copy_atom("(#loc64))
#loc355 = loc("smem_copy_atom_V = cute.make_copy_atom("(#loc65))
#loc356 = loc("return static(self._trait.value.type.layout_a_tv_tiled)"(#loc66))
#loc357 = loc("return size(perm_tile)"(#loc67))
#loc358 = loc("smem_tiled_copy_Q = cute.make_tiled_copy_A(smem_copy_atom_Q, tiled_mma)"(#loc68))
#loc359 = loc("return static(self._trait.value.type.layout_b_tv_tiled)"(#loc69))
#loc360 = loc("smem_tiled_copy_K = cute.make_tiled_copy_B(smem_copy_atom_K, tiled_mma)"(#loc70))
#loc361 = loc("smem_tiled_copy_V = cute.make_tiled_copy_B(smem_copy_atom_V, tiled_mma)"(#loc71))
#loc362 = loc("tSsQ = smem_thr_copy_Q.partition_S(sQ)"(#loc72))
#loc363 = loc("tSrQ_copy_view = smem_thr_copy_Q.retile(tSrQ)"(#loc73))
#loc364 = loc("return self.operation.results[0]"(#loc74))
#loc365 = loc("tSsK = smem_thr_copy_K.partition_S(sK)"(#loc75))
#loc366 = loc("tSrK_copy_view = smem_thr_copy_K.retile(tSrK)"(#loc76))
#loc367 = loc("tOsVt = smem_thr_copy_V.partition_S(sVt)"(#loc77))
#loc368 = loc("tOrVt_copy_view = smem_thr_copy_V.retile(tOrVt)"(#loc78))
#loc369 = loc("mcQ = cute.make_identity_tensor(mQ.layout.shape)"(#loc79))
#loc370 = loc("return self.operation.results[0]"(#loc80))
#loc371 = loc("mcKV = cute.make_identity_tensor(mK.layout.shape)"(#loc81))
#loc372 = loc("mcQ[batch_size, None, num_head, None],"(#loc82))
#loc373 = loc("cQ = cute.local_tile("(#loc83))
#loc374 = loc("mcKV[batch_size, None, num_head, None],"(#loc84))
#loc375 = loc("cKV = cute.local_tile("(#loc85))
#loc376 = loc("tQcQ = gmem_thr_copy_QKV.partition_S(cQ)"(#loc86))
#loc377 = loc("tKVcKV = gmem_thr_copy_QKV.partition_S(cKV)"(#loc87))
#loc378 = loc("cute.size(tQsQ, mode=[1]),"(#loc88))
#loc379 = loc("cute.size(tQsQ, mode=[2]),"(#loc89))
#loc380 = loc("stride=(cute.size(tQsQ, mode=[2]), 0, 1),"(#loc90))
#loc381 = loc("cute.make_layout("(#loc91))
#loc382 = loc("tQpQ = cute.make_rmem_tensor("(#loc92))
#loc383 = loc("cute.size(tKsK, mode=[1]),"(#loc93))
#loc384 = loc("cute.size(tKsK, mode=[2]),"(#loc94))
#loc385 = loc("stride=(cute.size(tKsK, mode=[2]), 0, 1),"(#loc95))
#loc386 = loc("cute.make_layout("(#loc96))
#loc387 = loc("tKVpKV = cute.make_rmem_tensor("(#loc97))
#loc388 = loc("tQcQ[(0, rest_v), 0, rest_k][3], mQ.layout.shape[3]"(#loc98))
#loc389 = loc("tQpQ[rest_v, 0, rest_k] = cute.elem_less("(#loc99))
#loc390 = loc("tKVcKV[(0, rest_v), 0, rest_k][3], mK.layout.shape[3]"(#loc100))
#loc391 = loc("tKVpKV[rest_v, 0, rest_k] = cute.elem_less("(#loc101))
#loc392 = loc("for m in cutlass.range_constexpr(cute.size(tQsQ.shape[1])):"(#loc102))
#loc393 = loc("if cute.elem_less(tQcQ[0, m, 0][1], mQ.layout.shape[1]):"(#loc103))
#loc394 = loc("tQgQ[None, m, None],"(#loc104))
#loc395 = loc("tQsQ[None, m, None],"(#loc105))
#loc396 = loc("pred=tQpQ[None, m, None],"(#loc106))
#loc397 = loc("t.iterator, append(t.layout, make_layout(1), up_to_rank), loc=loc, ip=ip"(#loc107))
#loc398 = loc("src = group_modes(append_ones(src, up_to_rank=2), 1)"(#loc108))
#loc399 = loc("return self.operation.results[0]"(#loc109))
#loc400 = loc("dst = group_modes(append_ones(dst, up_to_rank=2), 1)"(#loc110))
#loc401 = loc("pred = group_modes(append_ones(pred, up_to_rank=2), 1)"(#loc111))
#loc402 = loc("if size(src, mode=[1]) != size(dst, mode=[1]):"(#loc112))
#loc403 = loc("cute.copy("(#loc113))
#loc404 = loc("tQsQ[None, m, None].fill(0)"(#loc114))
#loc405 = loc("for n in cutlass.range_constexpr(cute.size(tKsK.shape[1])):"(#loc115))
#loc406 = loc("if cute.elem_less(tKVcKV[0, n, 0][1], mK.layout.shape[1]):"(#loc116))
#loc407 = loc("tKgK[None, n, None, n_block],"(#loc117))
#loc408 = loc("tKsK[None, n, None],"(#loc118))
#loc409 = loc("pred=tKVpKV[None, n, None],"(#loc119))
#loc410 = loc("cute.copy("(#loc120))
#loc411 = loc("tKsK[None, n, None].fill(0)"(#loc121))
#loc412 = loc("cute.arch.cp_async_commit_group()"(#loc122))
#loc413 = loc("row_max = cute.make_rmem_tensor("(#loc123))
#loc414 = loc("row_sum = cute.make_rmem_tensor("(#loc124))
#loc415 = loc("row_max.fill(-cutlass.Float32.inf)"(#loc125))
#loc416 = loc("row_sum.fill(0.0)"(#loc126))
#loc417 = loc("acc_shape_S = mma_params.thr_mma.partition_shape_C("(#loc127))
#loc418 = loc("acc_S = cute.make_rmem_tensor(acc_shape_S, cutlass.Float32)"(#loc128))
#loc419 = loc("acc_S.fill(0.0)"(#loc129))
#loc420 = loc("cute.arch.cp_async_wait_group(0)"(#loc130))
#loc421 = loc("self.cta_sync_barrier.arrive_and_wait()"(#loc131))
#loc422 = loc("for n in cutlass.range_constexpr(cute.size(gmem_copy_params.tVsV.shape[1])):"(#loc132))
#loc423 = loc("gmem_copy_params.tKVcKV[0, n, 0][1],"(#loc133))
#loc424 = loc("basic_params.mK.layout.shape[1],"(#loc134))
#loc425 = loc("if cute.elem_less("(#loc135))
#loc426 = loc("gmem_copy_params.tVgV[None, n, None, basic_params.n_block],"(#loc136))
#loc427 = loc("gmem_copy_params.tVsV[None, n, None],"(#loc137))
#loc428 = loc("pred=gmem_copy_params.tKVpKV[None, n, None],"(#loc138))
#loc429 = loc("cute.copy("(#loc139))
#loc430 = loc("gmem_copy_params.tVsV[None, n, None].fill(0.0)"(#loc140))
#loc431 = loc("gmem_copy_params.tVgV[None, None, None, basic_params.n_block],"(#loc141))
#loc432 = loc("cute.copy("(#loc142))
#loc433 = loc("cute.arch.cp_async_commit_group()"(#loc143))
#loc434 = loc("smem_copy_params.tSsQ[None, None, 0],"(#loc144))
#loc435 = loc("smem_copy_params.tSrQ_copy_view[None, None, 0],"(#loc145))
#loc436 = loc("cute.copy("(#loc146))
#loc437 = loc("smem_copy_params.tSsK[None, None, 0],"(#loc147))
#loc438 = loc("smem_copy_params.tSrK_copy_view[None, None, 0],"(#loc148))
#loc439 = loc("cute.copy("(#loc149))
#loc440 = loc("for k in cutlass.range_constexpr(cute.size(smem_copy_params.tSsQ.shape[2])):"(#loc150))
#loc441 = loc("k_next = (k + 1) % cute.size(smem_copy_params.tSsQ.shape[2])"(#loc151))
#loc442 = loc("smem_copy_params.tSsQ[None, None, k_next],"(#loc152))
#loc443 = loc("smem_copy_params.tSrQ_copy_view[None, None, k_next],"(#loc153))
#loc444 = loc("cute.copy("(#loc154))
#loc445 = loc("smem_copy_params.tSsK[None, None, k_next],"(#loc155))
#loc446 = loc("smem_copy_params.tSrK_copy_view[None, None, k_next],"(#loc156))
#loc447 = loc("cute.copy("(#loc157))
#loc448 = loc("mma_params.tSrQ[None, None, k],"(#loc158))
#loc449 = loc("mma_params.tSrK[None, None, k],"(#loc159))
#loc450 = loc("cute.gemm("(#loc160))
#loc451 = loc("cute.arch.cp_async_wait_group(0)"(#loc161))
#loc452 = loc("self.cta_sync_barrier.arrive_and_wait()"(#loc162))
#loc453 = loc("gmem_copy_params.tKgK[None, None, None, basic_params.n_block - 1],"(#loc163))
#loc454 = loc("cute.copy("(#loc164))
#loc455 = loc("cute.arch.cp_async_commit_group()"(#loc165))
#loc456 = loc("acc_layout_col_major = cute.make_layout(acc.layout.shape)"(#loc166))
#loc457 = loc("acc_layout_col_major.shape[0][1],"(#loc167))
#loc458 = loc("acc_layout_col_major.shape[1],"(#loc168))
#loc459 = loc("acc_layout_col_major.shape[0][0],"(#loc169))
#loc460 = loc("acc_layout_col_major.shape[2],"(#loc170))
#loc461 = loc("acc_layout_col_major.stride[0][1],"(#loc171))
#loc462 = loc("acc_layout_col_major.stride[1],"(#loc172))
#loc463 = loc("acc_layout_col_major.stride[0][0],"(#loc173))
#loc464 = loc("acc_layout_col_major.stride[2],"(#loc174))
#loc465 = loc("acc_layout_mn = cute.make_layout("(#loc175))
#loc466 = loc("acc_layout_mn = cute.composition(acc.layout, acc_layout_mn)"(#loc176))
#loc467 = loc("return cute.make_tensor(acc.iterator, acc_layout_mn)"(#loc177))
#loc468 = loc("mcS = cute.make_identity_tensor("(#loc178))
#loc469 = loc("mcS[basic_params.batch_size, None, basic_params.num_head, None],"(#loc179))
#loc470 = loc("cS = cute.local_tile("(#loc180))
#loc471 = loc("tScS = mma_params.thr_mma.partition_C(cS)"(#loc181))
#loc472 = loc("for r in cutlass.range_constexpr(cute.size(softmax_params.row_max)):"(#loc182))
#loc473 = loc("for c in cutlass.range_constexpr(cute.size(tScS_mn.shape[1])):"(#loc183))
#loc474 = loc("basic_params.mK.shape[1], tScS_mn[0, c][3] + 1"(#loc184))
#loc475 = loc("return IntValue(op(self, other_val, **kwargs))"(#loc185))
#loc476 = loc("if cute.elem_less("(#loc186))
#loc477 = loc("acc_S_mn[r, c] = -cutlass.Float32.inf"(#loc187))
#loc478 = loc("for idx, value in enumerate(ir_values):"(#loc188))
#loc479 = loc("return next(xs)"(#loc189))
#loc480 = loc("acc_S_row = acc_S_mn[r, None].load()"(#loc190))
#loc481 = loc("row_max_cur_row = acc_S_row.reduce("(#loc191))
#loc482 = loc("cute.arch.shuffle_sync_bfly(val, offset=2, mask=-1, mask_and_clamp=31),"(#loc192))
#loc483 = loc("return self._threadquad_reduce(val, lambda x, y: cute.arch.fmax(x, y))"(#loc193))
#loc484 = loc("cute.arch.shuffle_sync_bfly(val, offset=1, mask=-1, mask_and_clamp=31),"(#loc194))
#loc485 = loc("res_vect = op(lhs_val, rhs_val)"(#loc195))
#loc486 = loc("acc_S_row_sum = acc_S_row_exp.reduce("(#loc196))
#loc487 = loc("softmax_params.row_max[r] = row_max_cur_row"(#loc197))
#loc488 = loc("softmax_params.row_sum[r] = acc_S_row_sum"(#loc198))
#loc489 = loc("acc_S_mn[r, None] = acc_S_row_exp"(#loc199))
#loc490 = loc("src_layout = src.layout"(#loc200))
#loc491 = loc("rP = cute.make_fragment_like(acc_S, self._dtype)"(#loc201))
#loc492 = loc("rP.store(acc_S.load().to(self._dtype))"(#loc202))
#loc493 = loc("rP_layout_divided = cute.logical_divide(rP.layout, (None, None, 2))"(#loc203))
#loc494 = loc("(rP_layout_divided.shape[0], rP_layout_divided.shape[2][0]),"(#loc204))
#loc495 = loc("rP_layout_divided.shape[1],"(#loc205))
#loc496 = loc("rP_layout_divided.shape[2][1],"(#loc206))
#loc497 = loc("(rP_layout_divided.stride[0], rP_layout_divided.stride[2][0]),"(#loc207))
#loc498 = loc("rP_layout_divided.stride[1],"(#loc208))
#loc499 = loc("rP_layout_divided.stride[2][1],"(#loc209))
#loc500 = loc("rP_mma_view = cute.make_layout("(#loc210))
#loc501 = loc("tOrS = cute.make_tensor(rP.iterator, rP_mma_view)"(#loc211))
#loc502 = loc("smem_copy_params.tOsVt[None, None, 0],"(#loc212))
#loc503 = loc("smem_copy_params.tOrVt_copy_view[None, None, 0],"(#loc213))
#loc504 = loc("cute.copy("(#loc214))
#loc505 = loc("for k in cutlass.range_constexpr(cute.size(tOrS.shape[2])):"(#loc215))
#loc506 = loc("k_next = (k + 1) % cute.size(tOrS.shape[2])"(#loc216))
#loc507 = loc("smem_copy_params.tOsVt[None, None, k_next],"(#loc217))
#loc508 = loc("smem_copy_params.tOrVt_copy_view[None, None, k_next],"(#loc218))
#loc509 = loc("cute.copy("(#loc219))
#loc510 = loc("tOrS[None, None, k],"(#loc220))
#loc511 = loc("mma_params.tOrVt[None, None, k],"(#loc221))
#loc512 = loc("cute.gemm("(#loc222))
#loc513 = loc("block_args = list(block.arguments)"(#loc223))
#loc514 = loc("row_max_prev = cute.make_fragment_like("(#loc224))
#loc515 = loc("cute.basic_copy(softmax_params.row_max, row_max_prev)"(#loc225))
#loc516 = loc("row_max_prev_row = row_max_prev[r]"(#loc226))
#loc517 = loc("row_max_cur_row = cute.arch.fmax(row_max_prev_row, row_max_cur_row)"(#loc227))
#loc518 = loc("acc_S_row_sum + softmax_params.row_sum[r] * prev_minus_cur_exp"(#loc228))
#loc519 = loc("acc_O_mn[r, None] = acc_O_mn[r, None].load() * prev_minus_cur_exp"(#loc229))
#loc520 = loc("for r in cutlass.range_constexpr(cute.size(row_sum)):"(#loc230))
#loc521 = loc("row_sum[r] = self._threadquad_reduce_sum(row_sum[r])"(#loc231))
#loc522 = loc("acc_O_mn_row_is_zero_or_nan = row_sum[r] == 0.0 or row_sum[r] != row_sum[r]"(#loc232))
#loc523 = loc("value = a != arith_helper.const(0, a.type, loc=loc, ip=ip)"(#loc233))
#loc524 = loc("1.0 if acc_O_mn_row_is_zero_or_nan else cute.arch.rcp_approx(row_sum[r])"(#loc234))
#loc525 = loc("acc_O_mn[r, None] = acc_O_mn[r, None].load() * scale"(#loc235))
#loc526 = loc("rO = cute.make_fragment_like(acc_O, self._dtype)"(#loc236))
#loc527 = loc("rO.store(acc_O.load().to(self._dtype))"(#loc237))
#loc528 = loc("sO = cute.make_tensor(sQ.iterator, sO_layout)"(#loc238))
#loc529 = loc("smem_copy_atom_O = cute.make_copy_atom("(#loc239))
#loc530 = loc("return static(self._trait.value.type.layout_c_tv_tiled)"(#loc240))
#loc531 = loc("smem_tiled_copy_O = cute.make_tiled_copy_C(smem_copy_atom_O, tiled_mma)"(#loc241))
#loc532 = loc("taccOrO = smem_thr_copy_O.retile(rO)"(#loc242))
#loc533 = loc("taccOsO = smem_thr_copy_O.partition_D(sO)"(#loc243))
#loc534 = loc("cute.copy("(#loc244))
#loc535 = loc("mO[batch_size, None, num_head, None],"(#loc245))
#loc536 = loc("gO = cute.local_tile("(#loc246))
#loc537 = loc("tOsO = gmem_thr_copy_O.partition_S(sO)"(#loc247))
#loc538 = loc("tOgO = gmem_thr_copy_O.partition_D(gO)"(#loc248))
#loc539 = loc("tOrO = cute.make_fragment_like(tOgO, self._dtype)"(#loc249))
#loc540 = loc("self.cta_sync_barrier.arrive_and_wait()"(#loc250))
#loc541 = loc("cute.copy("(#loc251))
#loc542 = loc("mcO = cute.make_identity_tensor(mO.layout.shape)"(#loc252))
#loc543 = loc("mcO[batch_size, None, num_head, None],"(#loc253))
#loc544 = loc("cO = cute.local_tile("(#loc254))
#loc545 = loc("tOcO = gmem_thr_copy_O.partition_D(cO)"(#loc255))
#loc546 = loc("cute.make_layout("(#loc256))
#loc547 = loc("tOpO = cute.make_rmem_tensor("(#loc257))
#loc548 = loc("for rest_n in cutlass.range_constexpr(cute.size(tOpO.shape[2])):"(#loc258))
#loc549 = loc("tOcO[(0, rest_v), 0, rest_n][3], mO.layout.shape[3]"(#loc259))
#loc550 = loc("tOpO[rest_v, 0, rest_n] = cute.elem_less("(#loc260))
#loc551 = loc("for rest_m in cutlass.range_constexpr(cute.size(tOpO.shape[1])):"(#loc261))
#loc552 = loc("if cute.elem_less(tOcO[0, rest_m, 0][1], mO.layout.shape[1]):"(#loc262))
#loc553 = loc("tOrO[None, rest_m, None],"(#loc263))
#loc554 = loc("tOgO[None, rest_m, None],"(#loc264))
#loc555 = loc("pred=tOpO[None, rest_m, None],"(#loc265))
#loc556 = loc("cute.copy("(#loc266))
#loc557 = loc("return CoreTensor(values[0].value, self._dtype)"(#loc267))
#loc558 = loc("cute.make_swizzle(swizzle_bits, 3, 3),"(#loc268))
#loc559 = loc("cute.make_layout((8, smem_k_block_size), stride=(smem_k_block_size, 1)),"(#loc269))
#loc560 = loc("if isinstance(inner, Swizzle) and has_scaled_basis(outer.stride):"(#loc270))
#loc561 = loc("sQ_layout_atom = cute.make_composed_layout("(#loc271))
#loc562 = loc("sQ_layout = cute.tile_to_shape("(#loc272))
#loc563 = loc("sKV_layout = cute.tile_to_shape("(#loc273))
#loc564 = loc("cute.struct.MemRange[self._dtype, cute.cosize(sQ_layout)], 1024"(#loc274))
#loc565 = loc("cute.struct.MemRange[self._dtype, cute.cosize(sKV_layout)], 1024"(#loc275))
#loc566 = loc("cute.struct.MemRange[self._dtype, cute.cosize(sKV_layout)], 1024"(#loc276))
#loc567 = loc("atom_async_copy = cute.make_copy_atom("(#loc277))
#loc568 = loc("atom_universal_copy = cute.make_copy_atom("(#loc278))
#loc569 = loc("tQKV_shape_dim_1 = sQ_layout_atom.outer.shape[1] // async_copy_elems"(#loc279))
#loc570 = loc("tQKV_layout = cute.make_layout("(#loc280))
#loc571 = loc("vQKV_layout = cute.make_layout((1, async_copy_elems))"(#loc281))
#loc572 = loc("gmem_tiled_copy_QKV = cute.make_tiled_copy_tv("(#loc282))
#loc573 = loc("tiler_mn = product_each(layout_mn.shape, loc=loc, ip=ip)"(#loc283))
#loc574 = loc("gmem_tiled_copy_O = cute.make_tiled_copy_tv("(#loc284))
#loc575 = loc("tiled_mma = cute.make_tiled_mma("(#loc285))
#loc576 = loc("return rank(a.shape, mode)"(#loc286))
#loc577 = loc("cute.ceil_div(mQ.shape[1], self._m_block_size),"(#loc287))
#loc578 = loc("cute.size(mQ.shape[0]),"(#loc288))
#loc579 = loc("cute.size(mQ.shape[2]),"(#loc289))

