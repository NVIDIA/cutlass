

!copy_simt = !cute.tiled_copy<!cute_nvgpu.atom.universal_copy<f32>, layout_copy_tv = <"((32,4),(4,4)):((64,4),(16,1))">, tiler_mn = <"[16:1;128:1]">>
!memref_gmem_f32_ = !cute.memref<f32, gmem, "((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">
!memref_gmem_f32_1 = !cute.memref<f32, gmem, "(16,128):(?{i64},1)">
!memref_gmem_f32_2 = !cute.memref<f32, gmem, "((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">
!memref_gmem_f32_3 = !cute.memref<f32, gmem, "((1,(4,4)),(1,1)):((0,(1,?{i64})),(0,0))">
!memref_gmem_f32_4 = !cute.memref<f32, gmem, "(?,?):(?{i64},1)">
!memref_rmem_f32_ = !cute.memref<f32, rmem, align<32>, "((1,(4,4)),1,1):((0,(1,4)),0,0)">
!memref_rmem_f32_1 = !cute.memref<f32, rmem, align<32>, "((1,(4,4)),(1,1)):((0,(1,4)),(0,0))">
!memref_rmem_i8_ = !cute.memref<i8, rmem, align<32>, "((1,(4,4)),1,1):((0,(1,4)),0,0)">
!memref_rmem_i8_1 = !cute.memref<i8, rmem, align<32>, "((1,(4,4)),(1,1)):((0,(1,4)),(0,0))">
#loc = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":399:0)
#loc1 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":262:0)
#loc66 = loc("run_elementwise_add("(#loc))
#loc67 = loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1))
module attributes {gpu.container_module} {
  gpu.module @kernels {
    cuda.kernel @kernel_cutlass_elementwise_add_kernel_tensorptrf32gmemo161281i64div16128_tensorptrf32gmemo161281i64div16128_tensorptrf32gmemo161281i64div16128_tensor00o1612810111601281___0(%arg0: !memref_gmem_f32_ loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg1: !memref_gmem_f32_ loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg2: !memref_gmem_f32_ loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg3: !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg4: i32 loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg5: i32 loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg6: !cute.layout<"(4,32):(32,1)"> loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1)), %arg7: !cute.layout<"(4,4):(4,1)"> loc("elementwise_add_kernel(gA, gB, gC, cC, mC.shape, thr_layout, val_layout).launch("(#loc1))) attributes {cu_attrs = {max_dynamic_shared_size_bytes = #cuda.dev_max_shared_memory_optin, non_portable_cluster_size_allowed = 1 : i32}, cute.kernel, gpu.kernel, nvvm.reqntid = array<i32: 128, 1, 1>} {
      %iter = cute.get_iter(%arg0) : !memref_gmem_f32_ loc(#loc68)
      %iter_0 = cute.get_iter(%arg1) : !memref_gmem_f32_ loc(#loc68)
      %iter_1 = cute.get_iter(%arg2) : !memref_gmem_f32_ loc(#loc68)
      %iter_2 = cute.get_iter(%arg3) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc68)
      %e0, %e1 = cute.get_leaves(%iter_2) : !cute.int_tuple<"(0,0)"> loc(#loc69)
      %iter_3 = cute.get_iter(%arg0) : !memref_gmem_f32_ loc(#loc70)
      %iter_4 = cute.get_iter(%arg1) : !memref_gmem_f32_ loc(#loc70)
      %iter_5 = cute.get_iter(%arg2) : !memref_gmem_f32_ loc(#loc70)
      %iter_6 = cute.get_iter(%arg3) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc70)
      %e0_7, %e1_8 = cute.get_leaves(%iter_6) : !cute.int_tuple<"(0,0)"> loc(#loc69)
      %lay = cute.get_layout(%arg0) : !memref_gmem_f32_ loc(#loc71)
      %0 = cute.get_shape(%lay) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %e0_9, %e1_10, %e2, %e3 = cute.get_leaves(%0) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %itup = cute.to_int_tuple(%e2) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?"> loc(#loc72)
      %itup_11 = cute.to_int_tuple(%e3) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %2 = cute.get_scalars(%itup_11) : !cute.int_tuple<"?"> loc(#loc72)
      %3 = cute.get_stride(%lay) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %e0_12, %e1_13, %e2_14, %e3_15 = cute.get_leaves(%3) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %itup_16 = cute.to_int_tuple(%e0_12) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
      %4 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64}"> loc(#loc72)
      %itup_17 = cute.to_int_tuple(%e2_14) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %5 = cute.get_scalars(%itup_17) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %lay_18 = cute.get_layout(%arg1) : !memref_gmem_f32_ loc(#loc71)
      %6 = cute.get_shape(%lay_18) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %e0_19, %e1_20, %e2_21, %e3_22 = cute.get_leaves(%6) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %itup_23 = cute.to_int_tuple(%e2_21) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %7 = cute.get_scalars(%itup_23) : !cute.int_tuple<"?"> loc(#loc72)
      %itup_24 = cute.to_int_tuple(%e3_22) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %8 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?"> loc(#loc72)
      %9 = cute.get_stride(%lay_18) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %e0_25, %e1_26, %e2_27, %e3_28 = cute.get_leaves(%9) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %itup_29 = cute.to_int_tuple(%e0_25) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
      %10 = cute.get_scalars(%itup_29) : !cute.int_tuple<"?{i64}"> loc(#loc72)
      %itup_30 = cute.to_int_tuple(%e2_27) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %11 = cute.get_scalars(%itup_30) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %lay_31 = cute.get_layout(%arg2) : !memref_gmem_f32_ loc(#loc71)
      %12 = cute.get_shape(%lay_31) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %e0_32, %e1_33, %e2_34, %e3_35 = cute.get_leaves(%12) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %itup_36 = cute.to_int_tuple(%e2_34) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %13 = cute.get_scalars(%itup_36) : !cute.int_tuple<"?"> loc(#loc72)
      %itup_37 = cute.to_int_tuple(%e3_35) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %14 = cute.get_scalars(%itup_37) : !cute.int_tuple<"?"> loc(#loc72)
      %15 = cute.get_stride(%lay_31) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %e0_38, %e1_39, %e2_40, %e3_41 = cute.get_leaves(%15) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
      %itup_42 = cute.to_int_tuple(%e0_38) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
      %16 = cute.get_scalars(%itup_42) : !cute.int_tuple<"?{i64}"> loc(#loc72)
      %itup_43 = cute.to_int_tuple(%e2_40) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %17 = cute.get_scalars(%itup_43) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
      %lay_44 = cute.get_layout(%arg3) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc71)
      %18 = cute.get_shape(%lay_44) : (!cute.layout<"((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %e0_45, %e1_46, %e2_47, %e3_48 = cute.get_leaves(%18) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
      %itup_49 = cute.to_int_tuple(%e2_47) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %19 = cute.get_scalars(%itup_49) : !cute.int_tuple<"?"> loc(#loc72)
      %itup_50 = cute.to_int_tuple(%e3_48) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
      %20 = cute.get_scalars(%itup_50) : !cute.int_tuple<"?"> loc(#loc72)
      %21 = cute.get_stride(%lay_44) : (!cute.layout<"((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">) -> !cute.stride<"((1@0,1@1),(16@0,128@1))"> loc(#loc72)
      %e0_51, %e1_52, %e2_53, %e3_54 = cute.get_leaves(%21) : !cute.stride<"((1@0,1@1),(16@0,128@1))"> loc(#loc72)
      %22 = cute.get_shape(%arg6) : (!cute.layout<"(4,32):(32,1)">) -> !cute.shape<"(4,32)"> loc(#loc72)
      %e0_55, %e1_56 = cute.get_leaves(%22) : !cute.shape<"(4,32)"> loc(#loc72)
      %23 = cute.get_stride(%arg6) : (!cute.layout<"(4,32):(32,1)">) -> !cute.stride<"(32,1)"> loc(#loc72)
      %e0_57, %e1_58 = cute.get_leaves(%23) : !cute.stride<"(32,1)"> loc(#loc72)
      %24 = cute.get_shape(%arg7) : (!cute.layout<"(4,4):(4,1)">) -> !cute.shape<"(4,4)"> loc(#loc72)
      %e0_59, %e1_60 = cute.get_leaves(%24) : !cute.shape<"(4,4)"> loc(#loc72)
      %25 = cute.get_stride(%arg7) : (!cute.layout<"(4,4):(4,1)">) -> !cute.stride<"(4,1)"> loc(#loc72)
      %e0_61, %e1_62 = cute.get_leaves(%25) : !cute.stride<"(4,1)"> loc(#loc72)
      %26 = nvvm.read.ptx.sreg.tid.x : i32 loc(#loc73)
      %27 = nvvm.read.ptx.sreg.tid.y : i32 loc(#loc73)
      %28 = nvvm.read.ptx.sreg.tid.z : i32 loc(#loc73)
      %29 = nvvm.read.ptx.sreg.ctaid.x : i32 loc(#loc74)
      %30 = nvvm.read.ptx.sreg.ctaid.y : i32 loc(#loc74)
      %31 = nvvm.read.ptx.sreg.ctaid.z : i32 loc(#loc74)
      %coord = cute.make_coord(%29) : (i32) -> !cute.coord<"((_,_),?)"> loc(#loc75)
      %slice = cute.slice(%arg0, %coord) : !memref_gmem_f32_, !cute.coord<"((_,_),?)"> loc(#loc75)
      %iter_63 = cute.get_iter(%slice) : !memref_gmem_f32_1 loc(#loc76)
      %iter_64 = cute.get_iter(%slice) : !memref_gmem_f32_1 loc(#loc77)
      %coord_65 = cute.make_coord(%29) : (i32) -> !cute.coord<"((_,_),?)"> loc(#loc78)
      %slice_66 = cute.slice(%arg1, %coord_65) : !memref_gmem_f32_, !cute.coord<"((_,_),?)"> loc(#loc78)
      %iter_67 = cute.get_iter(%slice_66) : !memref_gmem_f32_1 loc(#loc76)
      %iter_68 = cute.get_iter(%slice_66) : !memref_gmem_f32_1 loc(#loc77)
      %coord_69 = cute.make_coord(%29) : (i32) -> !cute.coord<"((_,_),?)"> loc(#loc79)
      %slice_70 = cute.slice(%arg2, %coord_69) : !memref_gmem_f32_, !cute.coord<"((_,_),?)"> loc(#loc79)
      %iter_71 = cute.get_iter(%slice_70) : !memref_gmem_f32_1 loc(#loc76)
      %iter_72 = cute.get_iter(%slice_70) : !memref_gmem_f32_1 loc(#loc77)
      %coord_73 = cute.make_coord(%29) : (i32) -> !cute.coord<"((_,_),?)"> loc(#loc80)
      %slice_74 = cute.slice(%arg3, %coord_73) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">, !cute.coord<"((_,_),?)"> loc(#loc80)
      %iter_75 = cute.get_iter(%slice_74) : !cute.coord_tensor<"(?{div=16},?{div=128})", "(16,128):(1@0,1@1)"> loc(#loc76)
      %e0_76, %e1_77 = cute.get_leaves(%iter_75) : !cute.int_tuple<"(?{div=16},?{div=128})"> loc(#loc69)
      %32 = cute.get_scalars(%e0_76) : !cute.int_tuple<"?{div=16}"> loc(#loc66)
      %33 = cute.get_scalars(%e1_77) : !cute.int_tuple<"?{div=128}"> loc(#loc66)
      %iter_78 = cute.get_iter(%slice_74) : !cute.coord_tensor<"(?{div=16},?{div=128})", "(16,128):(1@0,1@1)"> loc(#loc77)
      %e0_79, %e1_80 = cute.get_leaves(%iter_78) : !cute.int_tuple<"(?{div=16},?{div=128})"> loc(#loc69)
      %34 = cute.get_scalars(%e0_79) : !cute.int_tuple<"?{div=16}"> loc(#loc66)
      %35 = cute.get_scalars(%e1_80) : !cute.int_tuple<"?{div=128}"> loc(#loc66)
      %atom = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32> loc(#loc81)
      %atom_81 = cute.make_atom() : () -> !cute_nvgpu.atom.universal_copy<f32> loc(#loc82)
      %prod = cute.raked_product(%arg6, %arg7) : (!cute.layout<"(4,32):(32,1)">, !cute.layout<"(4,4):(4,1)">) -> !cute.layout<"((4,4),(4,32)):((512,32),(128,1))"> loc(#loc83)
      %sz = cute.size(%arg6) : (!cute.layout<"(4,32):(32,1)">) -> !cute.int_tuple<"128"> loc(#loc83)
      %e0_82 = cute.get_leaves(%sz) : !cute.int_tuple<"128"> loc(#loc83)
      %sz_83 = cute.size(%arg7) : (!cute.layout<"(4,4):(4,1)">) -> !cute.int_tuple<"16"> loc(#loc83)
      %e0_84 = cute.get_leaves(%sz_83) : !cute.int_tuple<"16"> loc(#loc83)
      %shape = cute.make_shape() : () -> !cute.shape<"(128,16)"> loc(#loc83)
      %lay_85 = cute.make_layout(%shape) : !cute.layout<"(128,16):(1,128)"> loc(#loc83)
      %rinv = cute.right_inverse(%prod) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.layout<"(32,16,4):(64,4,1)"> loc(#loc83)
      %36 = cute.composition(%rinv, %lay_85) : (!cute.layout<"(32,16,4):(64,4,1)">, !cute.layout<"(128,16):(1,128)">) -> !cute.layout<"((32,4),(4,4)):((64,4),(16,1))"> loc(#loc83)
      %37 = cute.get_shape(%prod) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %e0_86, %e1_87, %e2_88, %e3_89 = cute.get_leaves(%37) : !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"((4,4),(4,32))"> loc(#loc83)
      %res = cute.tuple.product_each(%int_tuple) : (!cute.int_tuple<"((4,4),(4,32))">) -> !cute.int_tuple<"(16,128)"> loc(#loc83)
      %e0_90, %e1_91 = cute.get_leaves(%res) : !cute.int_tuple<"(16,128)"> loc(#loc83)
      %int_tuple_92 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,128)"> loc(#loc83)
      %res_93 = cute.tuple.product_each(%int_tuple_92) : (!cute.int_tuple<"(16,128)">) -> !cute.int_tuple<"(16,128)"> loc(#loc83)
      %e0_94, %e1_95 = cute.get_leaves(%res_93) : !cute.int_tuple<"(16,128)"> loc(#loc83)
      %tile = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc83)
      %38 = cute.make_tiled_copy(%atom) : !copy_simt loc(#loc83)
      %prod_96 = cute.raked_product(%arg6, %arg7) : (!cute.layout<"(4,32):(32,1)">, !cute.layout<"(4,4):(4,1)">) -> !cute.layout<"((4,4),(4,32)):((512,32),(128,1))"> loc(#loc85)
      %sz_97 = cute.size(%arg6) : (!cute.layout<"(4,32):(32,1)">) -> !cute.int_tuple<"128"> loc(#loc85)
      %e0_98 = cute.get_leaves(%sz_97) : !cute.int_tuple<"128"> loc(#loc85)
      %sz_99 = cute.size(%arg7) : (!cute.layout<"(4,4):(4,1)">) -> !cute.int_tuple<"16"> loc(#loc85)
      %e0_100 = cute.get_leaves(%sz_99) : !cute.int_tuple<"16"> loc(#loc85)
      %shape_101 = cute.make_shape() : () -> !cute.shape<"(128,16)"> loc(#loc85)
      %lay_102 = cute.make_layout(%shape_101) : !cute.layout<"(128,16):(1,128)"> loc(#loc85)
      %rinv_103 = cute.right_inverse(%prod_96) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.layout<"(32,16,4):(64,4,1)"> loc(#loc85)
      %39 = cute.composition(%rinv_103, %lay_102) : (!cute.layout<"(32,16,4):(64,4,1)">, !cute.layout<"(128,16):(1,128)">) -> !cute.layout<"((32,4),(4,4)):((64,4),(16,1))"> loc(#loc85)
      %40 = cute.get_shape(%prod_96) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %e0_104, %e1_105, %e2_106, %e3_107 = cute.get_leaves(%40) : !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %int_tuple_108 = cute.make_int_tuple() : () -> !cute.int_tuple<"((4,4),(4,32))"> loc(#loc85)
      %res_109 = cute.tuple.product_each(%int_tuple_108) : (!cute.int_tuple<"((4,4),(4,32))">) -> !cute.int_tuple<"(16,128)"> loc(#loc85)
      %e0_110, %e1_111 = cute.get_leaves(%res_109) : !cute.int_tuple<"(16,128)"> loc(#loc85)
      %int_tuple_112 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,128)"> loc(#loc85)
      %res_113 = cute.tuple.product_each(%int_tuple_112) : (!cute.int_tuple<"(16,128)">) -> !cute.int_tuple<"(16,128)"> loc(#loc85)
      %e0_114, %e1_115 = cute.get_leaves(%res_113) : !cute.int_tuple<"(16,128)"> loc(#loc85)
      %tile_116 = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc85)
      %41 = cute.make_tiled_copy(%atom) : !copy_simt loc(#loc85)
      %prod_117 = cute.raked_product(%arg6, %arg7) : (!cute.layout<"(4,32):(32,1)">, !cute.layout<"(4,4):(4,1)">) -> !cute.layout<"((4,4),(4,32)):((512,32),(128,1))"> loc(#loc86)
      %sz_118 = cute.size(%arg6) : (!cute.layout<"(4,32):(32,1)">) -> !cute.int_tuple<"128"> loc(#loc86)
      %e0_119 = cute.get_leaves(%sz_118) : !cute.int_tuple<"128"> loc(#loc86)
      %sz_120 = cute.size(%arg7) : (!cute.layout<"(4,4):(4,1)">) -> !cute.int_tuple<"16"> loc(#loc86)
      %e0_121 = cute.get_leaves(%sz_120) : !cute.int_tuple<"16"> loc(#loc86)
      %shape_122 = cute.make_shape() : () -> !cute.shape<"(128,16)"> loc(#loc86)
      %lay_123 = cute.make_layout(%shape_122) : !cute.layout<"(128,16):(1,128)"> loc(#loc86)
      %rinv_124 = cute.right_inverse(%prod_117) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.layout<"(32,16,4):(64,4,1)"> loc(#loc86)
      %42 = cute.composition(%rinv_124, %lay_123) : (!cute.layout<"(32,16,4):(64,4,1)">, !cute.layout<"(128,16):(1,128)">) -> !cute.layout<"((32,4),(4,4)):((64,4),(16,1))"> loc(#loc86)
      %43 = cute.get_shape(%prod_117) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %e0_125, %e1_126, %e2_127, %e3_128 = cute.get_leaves(%43) : !cute.shape<"((4,4),(4,32))"> loc(#loc84)
      %int_tuple_129 = cute.make_int_tuple() : () -> !cute.int_tuple<"((4,4),(4,32))"> loc(#loc86)
      %res_130 = cute.tuple.product_each(%int_tuple_129) : (!cute.int_tuple<"((4,4),(4,32))">) -> !cute.int_tuple<"(16,128)"> loc(#loc86)
      %e0_131, %e1_132 = cute.get_leaves(%res_130) : !cute.int_tuple<"(16,128)"> loc(#loc86)
      %int_tuple_133 = cute.make_int_tuple() : () -> !cute.int_tuple<"(16,128)"> loc(#loc86)
      %res_134 = cute.tuple.product_each(%int_tuple_133) : (!cute.int_tuple<"(16,128)">) -> !cute.int_tuple<"(16,128)"> loc(#loc86)
      %e0_135, %e1_136 = cute.get_leaves(%res_134) : !cute.int_tuple<"(16,128)"> loc(#loc86)
      %tile_137 = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc86)
      %44 = cute.make_tiled_copy(%atom_81) : !copy_simt loc(#loc86)
      %coord_138 = cute.make_coord(%26) : (i32) -> !cute.coord<"?"> loc(#loc87)
      %src_partitioned = cute.tiled.copy.partition_S(%38, %slice, %coord_138) : (!copy_simt, !memref_gmem_f32_1, !cute.coord<"?">) -> !memref_gmem_f32_2 loc(#loc87)
      %iter_139 = cute.get_iter(%src_partitioned) : !memref_gmem_f32_2 loc(#loc88)
      %coord_140 = cute.make_coord(%26) : (i32) -> !cute.coord<"?"> loc(#loc89)
      %src_partitioned_141 = cute.tiled.copy.partition_S(%41, %slice_66, %coord_140) : (!copy_simt, !memref_gmem_f32_1, !cute.coord<"?">) -> !memref_gmem_f32_2 loc(#loc89)
      %iter_142 = cute.get_iter(%src_partitioned_141) : !memref_gmem_f32_2 loc(#loc88)
      %coord_143 = cute.make_coord(%26) : (i32) -> !cute.coord<"?"> loc(#loc90)
      %src_partitioned_144 = cute.tiled.copy.partition_S(%44, %slice_70, %coord_143) : (!copy_simt, !memref_gmem_f32_1, !cute.coord<"?">) -> !memref_gmem_f32_2 loc(#loc90)
      %iter_145 = cute.get_iter(%src_partitioned_144) : !memref_gmem_f32_2 loc(#loc88)
      %lay_146 = cute.get_layout(%src_partitioned) : !memref_gmem_f32_2 loc(#loc91)
      %45 = cute.make_layout_like(%lay_146) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)"> to !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)"> loc(#loc92)
      %rmem = cute.memref.alloca(%45) : !memref_rmem_f32_ loc(#loc92)
      %iter_147 = cute.get_iter(%rmem) : !memref_rmem_f32_ loc(#loc93)
      %iter_148 = cute.get_iter(%rmem) : !memref_rmem_f32_ loc(#loc94)
      %lay_149 = cute.get_layout(%src_partitioned_141) : !memref_gmem_f32_2 loc(#loc91)
      %46 = cute.make_layout_like(%lay_149) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)"> to !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)"> loc(#loc95)
      %rmem_150 = cute.memref.alloca(%46) : !memref_rmem_f32_ loc(#loc95)
      %iter_151 = cute.get_iter(%rmem_150) : !memref_rmem_f32_ loc(#loc93)
      %iter_152 = cute.get_iter(%rmem_150) : !memref_rmem_f32_ loc(#loc94)
      %lay_153 = cute.get_layout(%src_partitioned_144) : !memref_gmem_f32_2 loc(#loc91)
      %47 = cute.make_layout_like(%lay_153) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)"> to !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)"> loc(#loc96)
      %rmem_154 = cute.memref.alloca(%47) : !memref_rmem_f32_ loc(#loc96)
      %iter_155 = cute.get_iter(%rmem_154) : !memref_rmem_f32_ loc(#loc93)
      %iter_156 = cute.get_iter(%rmem_154) : !memref_rmem_f32_ loc(#loc94)
      %coord_157 = cute.make_coord(%26) : (i32) -> !cute.coord<"?"> loc(#loc97)
      %src_partitioned_158 = cute.tiled.copy.partition_S(%44, %slice_74, %coord_157) : (!copy_simt, !cute.coord_tensor<"(?{div=16},?{div=128})", "(16,128):(1@0,1@1)">, !cute.coord<"?">) -> !cute.coord_tensor<"(?{div=4},?{div=4})", "((1,(4,4)),1,1):((0,(1@1,1@0)),0,0)"> loc(#loc97)
      %iter_159 = cute.get_iter(%src_partitioned_158) : !cute.coord_tensor<"(?{div=4},?{div=4})", "((1,(4,4)),1,1):((0,(1@1,1@0)),0,0)"> loc(#loc88)
      %e0_160, %e1_161 = cute.get_leaves(%iter_159) : !cute.int_tuple<"(?{div=4},?{div=4})"> loc(#loc69)
      %48 = cute.get_scalars(%e0_160) : !cute.int_tuple<"?{div=4}"> loc(#loc66)
      %49 = cute.get_scalars(%e1_161) : !cute.int_tuple<"?{div=4}"> loc(#loc66)
      %lay_162 = cute.get_layout(%src_partitioned_158) : !cute.coord_tensor<"(?{div=4},?{div=4})", "((1,(4,4)),1,1):((0,(1@1,1@0)),0,0)"> loc(#loc98)
      %50 = cute.get_shape(%lay_162) : (!cute.layout<"((1,(4,4)),1,1):((0,(1@1,1@0)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_163, %e1_164, %e2_165, %e3_166, %e4 = cute.get_leaves(%50) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %shape_167 = cute.make_shape() : () -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc99)
      %lay_168 = cute.make_layout(%shape_167) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)"> loc(#loc99)
      %rmem_169 = cute.memref.alloca(%lay_168) : !memref_rmem_i8_ loc(#loc99)
      %iter_170 = cute.get_iter(%rmem_169) : !memref_rmem_i8_ loc(#loc93)
      %iter_171 = cute.get_iter(%rmem_169) : !memref_rmem_i8_ loc(#loc94)
      %sz_172 = cute.size(%rmem_169) : (!memref_rmem_i8_) -> !cute.int_tuple<"16"> loc(#loc100)
      %e0_173 = cute.get_leaves(%sz_172) : !cute.int_tuple<"16"> loc(#loc100)
      %lay_174 = cute.get_layout(%rmem_169) : !memref_rmem_i8_ loc(#loc71)
      %51 = cute.get_shape(%lay_174) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
      %e0_175, %e1_176, %e2_177, %e3_178, %e4_179 = cute.get_leaves(%51) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
      %52 = cute.get_stride(%lay_174) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
      %e0_180, %e1_181, %e2_182, %e3_183, %e4_184 = cute.get_leaves(%52) : !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
      %c0_i32 = arith.constant 0 : i32 loc(#loc66)
      %c16_i32 = arith.constant 16 : i32 loc(#loc66)
      %c1_i32 = arith.constant 1 : i32 loc(#loc66)
      %53 = scf.for %arg8 = %c0_i32 to %c16_i32 step %c1_i32 iter_args(%arg9 = %rmem_169) -> (!memref_rmem_i8_)  : i32 {
        %iter_421 = cute.get_iter(%arg9) : !memref_rmem_i8_ loc(#loc101)
        %lay_422 = cute.get_layout(%arg9) : !memref_rmem_i8_ loc(#loc71)
        %80 = cute.get_shape(%lay_422) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
        %e0_423, %e1_424, %e2_425, %e3_426, %e4_427 = cute.get_leaves(%80) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
        %81 = cute.get_stride(%lay_422) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
        %e0_428, %e1_429, %e2_430, %e3_431, %e4_432 = cute.get_leaves(%81) : !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
        %iter_433 = cute.get_iter(%arg9) : !memref_rmem_i8_ loc(#loc70)
        %coord_434 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"?"> loc(#loc102)
        %slice_435 = cute.slice(%src_partitioned_158, %coord_434) : !cute.coord_tensor<"(?{div=4},?{div=4})", "((1,(4,4)),1,1):((0,(1@1,1@0)),0,0)">, !cute.coord<"?"> loc(#loc102)
        %iter_436 = cute.get_iter(%slice_435) : !cute.coord_tensor<"(?,?)", "():()"> loc(#loc76)
        %e0_437, %e1_438 = cute.get_leaves(%iter_436) : !cute.int_tuple<"(?,?)"> loc(#loc69)
        %82 = cute.get_scalars(%e0_437) : !cute.int_tuple<"?"> loc(#loc66)
        %83 = cute.get_scalars(%e1_438) : !cute.int_tuple<"?"> loc(#loc66)
        %iter_439 = cute.get_iter(%slice_435) : !cute.coord_tensor<"(?,?)", "():()"> loc(#loc77)
        %e0_440, %e1_441 = cute.get_leaves(%iter_439) : !cute.int_tuple<"(?,?)"> loc(#loc69)
        %84 = cute.get_scalars(%e0_440) : !cute.int_tuple<"?"> loc(#loc66)
        %85 = cute.get_scalars(%e1_441) : !cute.int_tuple<"?"> loc(#loc66)
        %iter_442 = cute.get_iter(%slice_435) : !cute.coord_tensor<"(?,?)", "():()"> loc(#loc102)
        %e0_443, %e1_444 = cute.get_leaves(%iter_442) : !cute.int_tuple<"(?,?)"> loc(#loc102)
        %86 = cute.get_scalars(%e0_443) : !cute.int_tuple<"?"> loc(#loc102)
        %87 = cute.get_scalars(%e1_444) : !cute.int_tuple<"?"> loc(#loc102)
        %coord_445 = cute.make_coord(%e0_443, %e1_444) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.coord<"(?,?)"> loc(#loc102)
        %coord_446 = cute.make_coord(%arg4, %arg5) : (i32, i32) -> !cute.coord<"(?,?)"> loc(#loc102)
        %88 = cute.elem_less(%coord_445, %coord_446) : !cute.coord<"(?,?)">, !cute.coord<"(?,?)"> loc(#loc102)
        %89 = arith.extui %88 : i1 to i8 loc(#loc66)
        %coord_447 = cute.make_coord(%arg8) : (i32) -> !cute.coord<"?"> loc(#loc103)
        cute.memref.store(%arg9, %coord_447, %89) : (!memref_rmem_i8_, !cute.coord<"?">, i8) -> () loc(#loc103)
        %lay_448 = cute.get_layout(%arg9) : !memref_rmem_i8_ loc(#loc71)
        %90 = cute.get_shape(%lay_448) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
        %e0_449, %e1_450, %e2_451, %e3_452, %e4_453 = cute.get_leaves(%90) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
        %91 = cute.get_stride(%lay_448) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
        %e0_454, %e1_455, %e2_456, %e3_457, %e4_458 = cute.get_leaves(%91) : !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
        scf.yield %arg9 : !memref_rmem_i8_ loc(#loc66)
      } loc(#loc66)
      %iter_185 = cute.get_iter(%53) : !memref_rmem_i8_ loc(#loc104)
      %lay_186 = cute.get_layout(%53) : !memref_rmem_i8_ loc(#loc71)
      %54 = cute.get_shape(%lay_186) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
      %e0_187, %e1_188, %e2_189, %e3_190, %e4_191 = cute.get_leaves(%54) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc72)
      %55 = cute.get_stride(%lay_186) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
      %e0_192, %e1_193, %e2_194, %e3_195, %e4_196 = cute.get_leaves(%55) : !cute.stride<"((0,(1,4)),0,0)"> loc(#loc72)
      %iter_197 = cute.get_iter(%53) : !memref_rmem_i8_ loc(#loc105)
      %iter_198 = cute.get_iter(%53) : !memref_rmem_i8_ loc(#loc70)
      %lay_199 = cute.get_layout(%src_partitioned) : !memref_gmem_f32_2 loc(#loc98)
      %56 = cute.get_shape(%lay_199) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_200, %e1_201, %e2_202, %e3_203, %e4_204 = cute.get_leaves(%56) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %lay_205 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc98)
      %57 = cute.get_shape(%lay_205) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_206, %e1_207, %e2_208, %e3_209, %e4_210 = cute.get_leaves(%57) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %lay_211 = cute.get_layout(%src_partitioned) : !memref_gmem_f32_2 loc(#loc106)
      %shape_212 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_213 = cute.make_layout(%shape_212) : !cute.layout<"1:0"> loc(#loc106)
      %append = cute.append_to_rank<2> (%lay_211, %lay_213) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view = cute.make_view(%iter_139, %append) : !memref_gmem_f32_2 loc(#loc107)
      %iter_214 = cute.get_iter(%view) : !memref_gmem_f32_2 loc(#loc108)
      %lay_215 = cute.get_layout(%view) : !memref_gmem_f32_2 loc(#loc98)
      %58 = cute.get_shape(%lay_215) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_216, %e1_217, %e2_218, %e3_219, %e4_220 = cute.get_leaves(%58) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped = cute.group_modes(%view) <1, 3> : (!memref_gmem_f32_2) -> !memref_gmem_f32_3 loc(#loc107)
      %iter_221 = cute.get_iter(%grouped) : !memref_gmem_f32_3 loc(#loc109)
      %iter_222 = cute.get_iter(%grouped) : !memref_gmem_f32_3 loc(#loc77)
      %lay_223 = cute.get_layout(%rmem) : !memref_rmem_f32_ loc(#loc106)
      %shape_224 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_225 = cute.make_layout(%shape_224) : !cute.layout<"1:0"> loc(#loc106)
      %append_226 = cute.append_to_rank<2> (%lay_223, %lay_225) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_227 = cute.make_view(%iter_148, %append_226) : !memref_rmem_f32_ loc(#loc110)
      %iter_228 = cute.get_iter(%view_227) : !memref_rmem_f32_ loc(#loc108)
      %lay_229 = cute.get_layout(%view_227) : !memref_rmem_f32_ loc(#loc98)
      %59 = cute.get_shape(%lay_229) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_230, %e1_231, %e2_232, %e3_233, %e4_234 = cute.get_leaves(%59) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_235 = cute.group_modes(%view_227) <1, 3> : (!memref_rmem_f32_) -> !memref_rmem_f32_1 loc(#loc110)
      %iter_236 = cute.get_iter(%grouped_235) : !memref_rmem_f32_1 loc(#loc109)
      %iter_237 = cute.get_iter(%grouped_235) : !memref_rmem_f32_1 loc(#loc77)
      %lay_238 = cute.get_layout(%53) : !memref_rmem_i8_ loc(#loc106)
      %shape_239 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_240 = cute.make_layout(%shape_239) : !cute.layout<"1:0"> loc(#loc106)
      %append_241 = cute.append_to_rank<2> (%lay_238, %lay_240) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_242 = cute.make_view(%iter_198, %append_241) : !memref_rmem_i8_ loc(#loc111)
      %iter_243 = cute.get_iter(%view_242) : !memref_rmem_i8_ loc(#loc108)
      %lay_244 = cute.get_layout(%view_242) : !memref_rmem_i8_ loc(#loc98)
      %60 = cute.get_shape(%lay_244) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_245, %e1_246, %e2_247, %e3_248, %e4_249 = cute.get_leaves(%60) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_250 = cute.group_modes(%view_242) <1, 3> : (!memref_rmem_i8_) -> !memref_rmem_i8_1 loc(#loc111)
      %iter_251 = cute.get_iter(%grouped_250) : !memref_rmem_i8_1 loc(#loc109)
      %iter_252 = cute.get_iter(%grouped_250) : !memref_rmem_i8_1 loc(#loc77)
      %lay_253 = cute.get_layout(%grouped) : !memref_gmem_f32_3 loc(#loc98)
      %61 = cute.get_shape(%lay_253) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,?{i64})),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_254, %e1_255, %e2_256, %e3_257, %e4_258 = cute.get_leaves(%61) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %lay_259 = cute.get_layout(%grouped_235) : !memref_rmem_f32_1 loc(#loc98)
      %62 = cute.get_shape(%lay_259) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,4)),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_260, %e1_261, %e2_262, %e3_263, %e4_264 = cute.get_leaves(%62) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %sz_265 = cute.size(%grouped) <{mode = [1]}> : (!memref_gmem_f32_3) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_266 = cute.get_leaves(%sz_265) : !cute.int_tuple<"1"> loc(#loc112)
      %sz_267 = cute.size(%grouped_235) <{mode = [1]}> : (!memref_rmem_f32_1) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_268 = cute.get_leaves(%sz_267) : !cute.int_tuple<"1"> loc(#loc112)
      cute.copy(%atom, %grouped, %grouped_235, %grouped_250) : (!cute_nvgpu.atom.universal_copy<f32>, !memref_gmem_f32_3, !memref_rmem_f32_1, !memref_rmem_i8_1) loc(#loc113)
      %lay_269 = cute.get_layout(%src_partitioned_141) : !memref_gmem_f32_2 loc(#loc98)
      %63 = cute.get_shape(%lay_269) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_270, %e1_271, %e2_272, %e3_273, %e4_274 = cute.get_leaves(%63) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %lay_275 = cute.get_layout(%rmem_150) : !memref_rmem_f32_ loc(#loc98)
      %64 = cute.get_shape(%lay_275) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_276, %e1_277, %e2_278, %e3_279, %e4_280 = cute.get_leaves(%64) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %lay_281 = cute.get_layout(%src_partitioned_141) : !memref_gmem_f32_2 loc(#loc106)
      %shape_282 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_283 = cute.make_layout(%shape_282) : !cute.layout<"1:0"> loc(#loc106)
      %append_284 = cute.append_to_rank<2> (%lay_281, %lay_283) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_285 = cute.make_view(%iter_142, %append_284) : !memref_gmem_f32_2 loc(#loc107)
      %iter_286 = cute.get_iter(%view_285) : !memref_gmem_f32_2 loc(#loc108)
      %lay_287 = cute.get_layout(%view_285) : !memref_gmem_f32_2 loc(#loc98)
      %65 = cute.get_shape(%lay_287) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_288, %e1_289, %e2_290, %e3_291, %e4_292 = cute.get_leaves(%65) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_293 = cute.group_modes(%view_285) <1, 3> : (!memref_gmem_f32_2) -> !memref_gmem_f32_3 loc(#loc107)
      %iter_294 = cute.get_iter(%grouped_293) : !memref_gmem_f32_3 loc(#loc109)
      %iter_295 = cute.get_iter(%grouped_293) : !memref_gmem_f32_3 loc(#loc77)
      %lay_296 = cute.get_layout(%rmem_150) : !memref_rmem_f32_ loc(#loc106)
      %shape_297 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_298 = cute.make_layout(%shape_297) : !cute.layout<"1:0"> loc(#loc106)
      %append_299 = cute.append_to_rank<2> (%lay_296, %lay_298) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_300 = cute.make_view(%iter_152, %append_299) : !memref_rmem_f32_ loc(#loc110)
      %iter_301 = cute.get_iter(%view_300) : !memref_rmem_f32_ loc(#loc108)
      %lay_302 = cute.get_layout(%view_300) : !memref_rmem_f32_ loc(#loc98)
      %66 = cute.get_shape(%lay_302) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_303, %e1_304, %e2_305, %e3_306, %e4_307 = cute.get_leaves(%66) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_308 = cute.group_modes(%view_300) <1, 3> : (!memref_rmem_f32_) -> !memref_rmem_f32_1 loc(#loc110)
      %iter_309 = cute.get_iter(%grouped_308) : !memref_rmem_f32_1 loc(#loc109)
      %iter_310 = cute.get_iter(%grouped_308) : !memref_rmem_f32_1 loc(#loc77)
      %lay_311 = cute.get_layout(%53) : !memref_rmem_i8_ loc(#loc106)
      %shape_312 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_313 = cute.make_layout(%shape_312) : !cute.layout<"1:0"> loc(#loc106)
      %append_314 = cute.append_to_rank<2> (%lay_311, %lay_313) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_315 = cute.make_view(%iter_198, %append_314) : !memref_rmem_i8_ loc(#loc111)
      %iter_316 = cute.get_iter(%view_315) : !memref_rmem_i8_ loc(#loc108)
      %lay_317 = cute.get_layout(%view_315) : !memref_rmem_i8_ loc(#loc98)
      %67 = cute.get_shape(%lay_317) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_318, %e1_319, %e2_320, %e3_321, %e4_322 = cute.get_leaves(%67) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_323 = cute.group_modes(%view_315) <1, 3> : (!memref_rmem_i8_) -> !memref_rmem_i8_1 loc(#loc111)
      %iter_324 = cute.get_iter(%grouped_323) : !memref_rmem_i8_1 loc(#loc109)
      %iter_325 = cute.get_iter(%grouped_323) : !memref_rmem_i8_1 loc(#loc77)
      %lay_326 = cute.get_layout(%grouped_293) : !memref_gmem_f32_3 loc(#loc98)
      %68 = cute.get_shape(%lay_326) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,?{i64})),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_327, %e1_328, %e2_329, %e3_330, %e4_331 = cute.get_leaves(%68) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %lay_332 = cute.get_layout(%grouped_308) : !memref_rmem_f32_1 loc(#loc98)
      %69 = cute.get_shape(%lay_332) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,4)),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_333, %e1_334, %e2_335, %e3_336, %e4_337 = cute.get_leaves(%69) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %sz_338 = cute.size(%grouped_293) <{mode = [1]}> : (!memref_gmem_f32_3) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_339 = cute.get_leaves(%sz_338) : !cute.int_tuple<"1"> loc(#loc112)
      %sz_340 = cute.size(%grouped_308) <{mode = [1]}> : (!memref_rmem_f32_1) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_341 = cute.get_leaves(%sz_340) : !cute.int_tuple<"1"> loc(#loc112)
      cute.copy(%atom, %grouped_293, %grouped_308, %grouped_323) : (!cute_nvgpu.atom.universal_copy<f32>, !memref_gmem_f32_3, !memref_rmem_f32_1, !memref_rmem_i8_1) loc(#loc114)
      %70 = cute.memref.load_vec %rmem : !memref_rmem_f32_ loc(#loc115)
      %71 = cute.memref.load_vec %rmem_150 : !memref_rmem_f32_ loc(#loc115)
      %72 = arith.addf %70, %71 : vector<16xf32> loc(#loc116)
      %lay_342 = cute.get_layout(%rmem_154) : !memref_rmem_f32_ loc(#loc98)
      %73 = cute.get_shape(%lay_342) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_343, %e1_344, %e2_345, %e3_346, %e4_347 = cute.get_leaves(%73) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %int_tuple_348 = cute.make_int_tuple() : () -> !cute.int_tuple<"((1,(4,4)),1,1)"> loc(#loc117)
      %sz_349 = cute.size(%int_tuple_348) : (!cute.int_tuple<"((1,(4,4)),1,1)">) -> !cute.int_tuple<"16"> loc(#loc117)
      %e0_350 = cute.get_leaves(%sz_349) : !cute.int_tuple<"16"> loc(#loc117)
      %int_tuple_351 = cute.make_int_tuple() : () -> !cute.int_tuple<"((1,(4,4)),1,1)"> loc(#loc117)
      %sz_352 = cute.size(%int_tuple_351) : (!cute.int_tuple<"((1,(4,4)),1,1)">) -> !cute.int_tuple<"16"> loc(#loc117)
      %e0_353 = cute.get_leaves(%sz_352) : !cute.int_tuple<"16"> loc(#loc117)
      cute.memref.store_vec %72, %rmem_154 : !memref_rmem_f32_ loc(#loc117)
      %lay_354 = cute.get_layout(%src_partitioned_144) : !memref_gmem_f32_2 loc(#loc98)
      %74 = cute.get_shape(%lay_354) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_355, %e1_356, %e2_357, %e3_358, %e4_359 = cute.get_leaves(%74) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %lay_360 = cute.get_layout(%rmem_154) : !memref_rmem_f32_ loc(#loc106)
      %shape_361 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_362 = cute.make_layout(%shape_361) : !cute.layout<"1:0"> loc(#loc106)
      %append_363 = cute.append_to_rank<2> (%lay_360, %lay_362) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_364 = cute.make_view(%iter_156, %append_363) : !memref_rmem_f32_ loc(#loc107)
      %iter_365 = cute.get_iter(%view_364) : !memref_rmem_f32_ loc(#loc108)
      %lay_366 = cute.get_layout(%view_364) : !memref_rmem_f32_ loc(#loc98)
      %75 = cute.get_shape(%lay_366) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_367, %e1_368, %e2_369, %e3_370, %e4_371 = cute.get_leaves(%75) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_372 = cute.group_modes(%view_364) <1, 3> : (!memref_rmem_f32_) -> !memref_rmem_f32_1 loc(#loc107)
      %iter_373 = cute.get_iter(%grouped_372) : !memref_rmem_f32_1 loc(#loc109)
      %iter_374 = cute.get_iter(%grouped_372) : !memref_rmem_f32_1 loc(#loc77)
      %lay_375 = cute.get_layout(%src_partitioned_144) : !memref_gmem_f32_2 loc(#loc106)
      %shape_376 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_377 = cute.make_layout(%shape_376) : !cute.layout<"1:0"> loc(#loc106)
      %append_378 = cute.append_to_rank<2> (%lay_375, %lay_377) : !cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_379 = cute.make_view(%iter_145, %append_378) : !memref_gmem_f32_2 loc(#loc110)
      %iter_380 = cute.get_iter(%view_379) : !memref_gmem_f32_2 loc(#loc108)
      %lay_381 = cute.get_layout(%view_379) : !memref_gmem_f32_2 loc(#loc98)
      %76 = cute.get_shape(%lay_381) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,?{i64})),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_382, %e1_383, %e2_384, %e3_385, %e4_386 = cute.get_leaves(%76) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_387 = cute.group_modes(%view_379) <1, 3> : (!memref_gmem_f32_2) -> !memref_gmem_f32_3 loc(#loc110)
      %iter_388 = cute.get_iter(%grouped_387) : !memref_gmem_f32_3 loc(#loc109)
      %iter_389 = cute.get_iter(%grouped_387) : !memref_gmem_f32_3 loc(#loc77)
      %lay_390 = cute.get_layout(%53) : !memref_rmem_i8_ loc(#loc106)
      %shape_391 = cute.make_shape() : () -> !cute.shape<"1"> loc(#loc106)
      %lay_392 = cute.make_layout(%shape_391) : !cute.layout<"1:0"> loc(#loc106)
      %append_393 = cute.append_to_rank<2> (%lay_390, %lay_392) : !cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">, !cute.layout<"1:0"> loc(#loc106)
      %view_394 = cute.make_view(%iter_198, %append_393) : !memref_rmem_i8_ loc(#loc111)
      %iter_395 = cute.get_iter(%view_394) : !memref_rmem_i8_ loc(#loc108)
      %lay_396 = cute.get_layout(%view_394) : !memref_rmem_i8_ loc(#loc98)
      %77 = cute.get_shape(%lay_396) : (!cute.layout<"((1,(4,4)),1,1):((0,(1,4)),0,0)">) -> !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %e0_397, %e1_398, %e2_399, %e3_400, %e4_401 = cute.get_leaves(%77) : !cute.shape<"((1,(4,4)),1,1)"> loc(#loc98)
      %grouped_402 = cute.group_modes(%view_394) <1, 3> : (!memref_rmem_i8_) -> !memref_rmem_i8_1 loc(#loc111)
      %iter_403 = cute.get_iter(%grouped_402) : !memref_rmem_i8_1 loc(#loc109)
      %iter_404 = cute.get_iter(%grouped_402) : !memref_rmem_i8_1 loc(#loc77)
      %lay_405 = cute.get_layout(%grouped_372) : !memref_rmem_f32_1 loc(#loc98)
      %78 = cute.get_shape(%lay_405) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,4)),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_406, %e1_407, %e2_408, %e3_409, %e4_410 = cute.get_leaves(%78) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %lay_411 = cute.get_layout(%grouped_387) : !memref_gmem_f32_3 loc(#loc98)
      %79 = cute.get_shape(%lay_411) : (!cute.layout<"((1,(4,4)),(1,1)):((0,(1,?{i64})),(0,0))">) -> !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %e0_412, %e1_413, %e2_414, %e3_415, %e4_416 = cute.get_leaves(%79) : !cute.shape<"((1,(4,4)),(1,1))"> loc(#loc98)
      %sz_417 = cute.size(%grouped_372) <{mode = [1]}> : (!memref_rmem_f32_1) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_418 = cute.get_leaves(%sz_417) : !cute.int_tuple<"1"> loc(#loc112)
      %sz_419 = cute.size(%grouped_387) <{mode = [1]}> : (!memref_gmem_f32_3) -> !cute.int_tuple<"1"> loc(#loc112)
      %e0_420 = cute.get_leaves(%sz_419) : !cute.int_tuple<"1"> loc(#loc112)
      cute.copy(%atom_81, %grouped_372, %grouped_387, %grouped_402) : (!cute_nvgpu.atom.universal_copy<f32>, !memref_rmem_f32_1, !memref_gmem_f32_3, !memref_rmem_i8_1) loc(#loc118)
      return loc(#loc66)
    } loc(#loc67)
  } loc(#loc66)
  func.func @cutlass_elementwise_add_tensor02841_02912_01912_08313_09196_09403_10126_01202_16746_01064_01796_23174_06047_09508_18613_09638_07238_13885_01225_14714_08045_25177_11321_05292_11895_(%arg0: !memref_gmem_f32_4 loc("run_elementwise_add("(#loc)), %arg1: !memref_gmem_f32_4 loc("run_elementwise_add("(#loc)), %arg2: !memref_gmem_f32_4 loc("run_elementwise_add("(#loc))) -> i32 attributes {llvm.emit_c_interface} {
    %iter = cute.get_iter(%arg0) : !memref_gmem_f32_4 loc(#loc68)
    %iter_0 = cute.get_iter(%arg1) : !memref_gmem_f32_4 loc(#loc68)
    %iter_1 = cute.get_iter(%arg2) : !memref_gmem_f32_4 loc(#loc68)
    %iter_2 = cute.get_iter(%arg0) : !memref_gmem_f32_4 loc(#loc119)
    %iter_3 = cute.get_iter(%arg1) : !memref_gmem_f32_4 loc(#loc119)
    %iter_4 = cute.get_iter(%arg2) : !memref_gmem_f32_4 loc(#loc119)
    %lay = cute.get_layout(%arg0) : !memref_gmem_f32_4 loc(#loc71)
    %0 = cute.get_shape(%lay) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.shape<"(?,?)"> loc(#loc72)
    %e0, %e1 = cute.get_leaves(%0) : !cute.shape<"(?,?)"> loc(#loc72)
    %itup = cute.to_int_tuple(%e0) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %1 = cute.get_scalars(%itup) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_5 = cute.to_int_tuple(%e1) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %2 = cute.get_scalars(%itup_5) : !cute.int_tuple<"?"> loc(#loc72)
    %3 = cute.get_stride(%lay) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.stride<"(?{i64},1)"> loc(#loc72)
    %e0_6, %e1_7 = cute.get_leaves(%3) : !cute.stride<"(?{i64},1)"> loc(#loc72)
    %itup_8 = cute.to_int_tuple(%e0_6) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %4 = cute.get_scalars(%itup_8) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %lay_9 = cute.get_layout(%arg1) : !memref_gmem_f32_4 loc(#loc71)
    %5 = cute.get_shape(%lay_9) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.shape<"(?,?)"> loc(#loc72)
    %e0_10, %e1_11 = cute.get_leaves(%5) : !cute.shape<"(?,?)"> loc(#loc72)
    %itup_12 = cute.to_int_tuple(%e0_10) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %6 = cute.get_scalars(%itup_12) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_13 = cute.to_int_tuple(%e1_11) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %7 = cute.get_scalars(%itup_13) : !cute.int_tuple<"?"> loc(#loc72)
    %8 = cute.get_stride(%lay_9) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.stride<"(?{i64},1)"> loc(#loc72)
    %e0_14, %e1_15 = cute.get_leaves(%8) : !cute.stride<"(?{i64},1)"> loc(#loc72)
    %itup_16 = cute.to_int_tuple(%e0_14) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %9 = cute.get_scalars(%itup_16) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %lay_17 = cute.get_layout(%arg2) : !memref_gmem_f32_4 loc(#loc71)
    %10 = cute.get_shape(%lay_17) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.shape<"(?,?)"> loc(#loc72)
    %e0_18, %e1_19 = cute.get_leaves(%10) : !cute.shape<"(?,?)"> loc(#loc72)
    %itup_20 = cute.to_int_tuple(%e0_18) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %11 = cute.get_scalars(%itup_20) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_21 = cute.to_int_tuple(%e1_19) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %12 = cute.get_scalars(%itup_21) : !cute.int_tuple<"?"> loc(#loc72)
    %13 = cute.get_stride(%lay_17) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.stride<"(?{i64},1)"> loc(#loc72)
    %e0_22, %e1_23 = cute.get_leaves(%13) : !cute.stride<"(?{i64},1)"> loc(#loc72)
    %itup_24 = cute.to_int_tuple(%e0_22) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %14 = cute.get_scalars(%itup_24) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %shape = cute.make_shape() : () -> !cute.shape<"(4,32)"> loc(#loc120)
    %int_tuple = cute.make_int_tuple() : () -> !cute.int_tuple<"(1,0)"> loc(#loc120)
    %lay_25 = cute.make_ordered_layout(%shape, %int_tuple) : (!cute.shape<"(4,32)">, !cute.int_tuple<"(1,0)">) -> !cute.layout<"(4,32):(32,1)"> loc(#loc120)
    %shape_26 = cute.make_shape() : () -> !cute.shape<"(4,4)"> loc(#loc121)
    %int_tuple_27 = cute.make_int_tuple() : () -> !cute.int_tuple<"(1,0)"> loc(#loc121)
    %lay_28 = cute.make_ordered_layout(%shape_26, %int_tuple_27) : (!cute.shape<"(4,4)">, !cute.int_tuple<"(1,0)">) -> !cute.layout<"(4,4):(4,1)"> loc(#loc121)
    %prod = cute.raked_product(%lay_25, %lay_28) : (!cute.layout<"(4,32):(32,1)">, !cute.layout<"(4,4):(4,1)">) -> !cute.layout<"((4,4),(4,32)):((512,32),(128,1))"> loc(#loc122)
    %sz = cute.size(%lay_25) : (!cute.layout<"(4,32):(32,1)">) -> !cute.int_tuple<"128"> loc(#loc122)
    %e0_29 = cute.get_leaves(%sz) : !cute.int_tuple<"128"> loc(#loc122)
    %sz_30 = cute.size(%lay_28) : (!cute.layout<"(4,4):(4,1)">) -> !cute.int_tuple<"16"> loc(#loc122)
    %e0_31 = cute.get_leaves(%sz_30) : !cute.int_tuple<"16"> loc(#loc122)
    %shape_32 = cute.make_shape() : () -> !cute.shape<"(128,16)"> loc(#loc122)
    %lay_33 = cute.make_layout(%shape_32) : !cute.layout<"(128,16):(1,128)"> loc(#loc122)
    %rinv = cute.right_inverse(%prod) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.layout<"(32,16,4):(64,4,1)"> loc(#loc122)
    %15 = cute.composition(%rinv, %lay_33) : (!cute.layout<"(32,16,4):(64,4,1)">, !cute.layout<"(128,16):(1,128)">) -> !cute.layout<"((32,4),(4,4)):((64,4),(16,1))"> loc(#loc122)
    %16 = cute.get_shape(%prod) : (!cute.layout<"((4,4),(4,32)):((512,32),(128,1))">) -> !cute.shape<"((4,4),(4,32))"> loc(#loc84)
    %e0_34, %e1_35, %e2, %e3 = cute.get_leaves(%16) : !cute.shape<"((4,4),(4,32))"> loc(#loc84)
    %int_tuple_36 = cute.make_int_tuple() : () -> !cute.int_tuple<"((4,4),(4,32))"> loc(#loc122)
    %res = cute.tuple.product_each(%int_tuple_36) : (!cute.int_tuple<"((4,4),(4,32))">) -> !cute.int_tuple<"(16,128)"> loc(#loc122)
    %e0_37, %e1_38 = cute.get_leaves(%res) : !cute.int_tuple<"(16,128)"> loc(#loc122)
    %17 = cute.get_shape(%15) : (!cute.layout<"((32,4),(4,4)):((64,4),(16,1))">) -> !cute.shape<"((32,4),(4,4))"> loc(#loc72)
    %e0_39, %e1_40, %e2_41, %e3_42 = cute.get_leaves(%17) : !cute.shape<"((32,4),(4,4))"> loc(#loc72)
    %18 = cute.get_stride(%15) : (!cute.layout<"((32,4),(4,4)):((64,4),(16,1))">) -> !cute.stride<"((64,4),(16,1))"> loc(#loc72)
    %e0_43, %e1_44, %e2_45, %e3_46 = cute.get_leaves(%18) : !cute.stride<"((64,4),(16,1))"> loc(#loc72)
    %tile = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc123)
    %div = cute.zipped_divide(%arg0, %tile) : !memref_gmem_f32_4, !cute.tile<"[16:1;128:1]"> loc(#loc123)
    %iter_47 = cute.get_iter(%div) : !memref_gmem_f32_ loc(#loc124)
    %iter_48 = cute.get_iter(%div) : !memref_gmem_f32_ loc(#loc77)
    %tile_49 = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc125)
    %div_50 = cute.zipped_divide(%arg1, %tile_49) : !memref_gmem_f32_4, !cute.tile<"[16:1;128:1]"> loc(#loc125)
    %iter_51 = cute.get_iter(%div_50) : !memref_gmem_f32_ loc(#loc124)
    %iter_52 = cute.get_iter(%div_50) : !memref_gmem_f32_ loc(#loc77)
    %tile_53 = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc126)
    %div_54 = cute.zipped_divide(%arg2, %tile_53) : !memref_gmem_f32_4, !cute.tile<"[16:1;128:1]"> loc(#loc126)
    %iter_55 = cute.get_iter(%div_54) : !memref_gmem_f32_ loc(#loc124)
    %iter_56 = cute.get_iter(%div_54) : !memref_gmem_f32_ loc(#loc77)
    %lay_57 = cute.get_layout(%arg2) : !memref_gmem_f32_4 loc(#loc98)
    %19 = cute.get_shape(%lay_57) : (!cute.layout<"(?,?):(?{i64},1)">) -> !cute.shape<"(?,?)"> loc(#loc98)
    %e0_58, %e1_59 = cute.get_leaves(%19) : !cute.shape<"(?,?)"> loc(#loc98)
    %itup_60 = cute.to_int_tuple(%e0_58) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc98)
    %20 = cute.get_scalars(%itup_60) : !cute.int_tuple<"?"> loc(#loc98)
    %itup_61 = cute.to_int_tuple(%e1_59) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc98)
    %21 = cute.get_scalars(%itup_61) : !cute.int_tuple<"?"> loc(#loc98)
    %shape_62 = cute.make_shape(%itup_60, %itup_61) : (!cute.int_tuple<"?">, !cute.int_tuple<"?">) -> !cute.shape<"(?,?)"> loc(#loc127)
    %22 = cute.make_identity_tensor(%shape_62) : !cute.coord_tensor<"(0,0)", "(?,?):(1@0,1@1)"> loc(#loc127)
    %iter_63 = cute.get_iter(%22) : !cute.coord_tensor<"(0,0)", "(?,?):(1@0,1@1)"> loc(#loc128)
    %e0_64, %e1_65 = cute.get_leaves(%iter_63) : !cute.int_tuple<"(0,0)"> loc(#loc69)
    %tile_66 = cute.make_tile() : () -> !cute.tile<"[16:1;128:1]"> loc(#loc129)
    %div_67 = cute.zipped_divide(%22, %tile_66) : !cute.coord_tensor<"(0,0)", "(?,?):(1@0,1@1)">, !cute.tile<"[16:1;128:1]"> loc(#loc129)
    %iter_68 = cute.get_iter(%div_67) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc124)
    %e0_69, %e1_70 = cute.get_leaves(%iter_68) : !cute.int_tuple<"(0,0)"> loc(#loc69)
    %iter_71 = cute.get_iter(%div_67) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc77)
    %e0_72, %e1_73 = cute.get_leaves(%iter_71) : !cute.int_tuple<"(0,0)"> loc(#loc69)
    %sz_74 = cute.size(%div_54) <{mode = [1]}> : (!memref_gmem_f32_) -> !cute.int_tuple<"?"> loc(#loc130)
    %e0_75 = cute.get_leaves(%sz_74) : !cute.int_tuple<"?"> loc(#loc130)
    %23 = cute.get_scalars(%e0_75) : !cute.int_tuple<"?"> loc(#loc130)
    %sz_76 = cute.size(%15) <{mode = [0]}> : (!cute.layout<"((32,4),(4,4)):((64,4),(16,1))">) -> !cute.int_tuple<"128"> loc(#loc131)
    %e0_77 = cute.get_leaves(%sz_76) : !cute.int_tuple<"128"> loc(#loc131)
    %lay_78 = cute.get_layout(%div) : !memref_gmem_f32_ loc(#loc71)
    %24 = cute.get_shape(%lay_78) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %e0_79, %e1_80, %e2_81, %e3_82 = cute.get_leaves(%24) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %itup_83 = cute.to_int_tuple(%e2_81) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %25 = cute.get_scalars(%itup_83) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_84 = cute.to_int_tuple(%e3_82) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %26 = cute.get_scalars(%itup_84) : !cute.int_tuple<"?"> loc(#loc72)
    %27 = cute.get_stride(%lay_78) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %e0_85, %e1_86, %e2_87, %e3_88 = cute.get_leaves(%27) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %itup_89 = cute.to_int_tuple(%e0_85) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %28 = cute.get_scalars(%itup_89) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %itup_90 = cute.to_int_tuple(%e2_87) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %29 = cute.get_scalars(%itup_90) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %lay_91 = cute.get_layout(%div_50) : !memref_gmem_f32_ loc(#loc71)
    %30 = cute.get_shape(%lay_91) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %e0_92, %e1_93, %e2_94, %e3_95 = cute.get_leaves(%30) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %itup_96 = cute.to_int_tuple(%e2_94) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %31 = cute.get_scalars(%itup_96) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_97 = cute.to_int_tuple(%e3_95) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %32 = cute.get_scalars(%itup_97) : !cute.int_tuple<"?"> loc(#loc72)
    %33 = cute.get_stride(%lay_91) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %e0_98, %e1_99, %e2_100, %e3_101 = cute.get_leaves(%33) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %itup_102 = cute.to_int_tuple(%e0_98) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %34 = cute.get_scalars(%itup_102) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %itup_103 = cute.to_int_tuple(%e2_100) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %35 = cute.get_scalars(%itup_103) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %lay_104 = cute.get_layout(%div_54) : !memref_gmem_f32_ loc(#loc71)
    %36 = cute.get_shape(%lay_104) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %e0_105, %e1_106, %e2_107, %e3_108 = cute.get_leaves(%36) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %itup_109 = cute.to_int_tuple(%e2_107) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %37 = cute.get_scalars(%itup_109) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_110 = cute.to_int_tuple(%e3_108) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %38 = cute.get_scalars(%itup_110) : !cute.int_tuple<"?"> loc(#loc72)
    %39 = cute.get_stride(%lay_104) : (!cute.layout<"((16,128),(?,?)):((?{i64},1),(?{i64 div=16},128))">) -> !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %e0_111, %e1_112, %e2_113, %e3_114 = cute.get_leaves(%39) : !cute.stride<"((?{i64},1),(?{i64 div=16},128))"> loc(#loc72)
    %itup_115 = cute.to_int_tuple(%e0_111) : !cute.stride<"?{i64}"> to !cute.int_tuple<"?{i64}"> loc(#loc72)
    %40 = cute.get_scalars(%itup_115) : !cute.int_tuple<"?{i64}"> loc(#loc72)
    %itup_116 = cute.to_int_tuple(%e2_113) : !cute.stride<"?{i64 div=16}"> to !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %41 = cute.get_scalars(%itup_116) : !cute.int_tuple<"?{i64 div=16}"> loc(#loc72)
    %lay_117 = cute.get_layout(%div_67) : !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))"> loc(#loc71)
    %42 = cute.get_shape(%lay_117) : (!cute.layout<"((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">) -> !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %e0_118, %e1_119, %e2_120, %e3_121 = cute.get_leaves(%42) : !cute.shape<"((16,128),(?,?))"> loc(#loc72)
    %itup_122 = cute.to_int_tuple(%e2_120) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %43 = cute.get_scalars(%itup_122) : !cute.int_tuple<"?"> loc(#loc72)
    %itup_123 = cute.to_int_tuple(%e3_121) : !cute.shape<"?"> to !cute.int_tuple<"?"> loc(#loc72)
    %44 = cute.get_scalars(%itup_123) : !cute.int_tuple<"?"> loc(#loc72)
    %45 = cute.get_stride(%lay_117) : (!cute.layout<"((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">) -> !cute.stride<"((1@0,1@1),(16@0,128@1))"> loc(#loc72)
    %e0_124, %e1_125, %e2_126, %e3_127 = cute.get_leaves(%45) : !cute.stride<"((1@0,1@1),(16@0,128@1))"> loc(#loc72)
    %46 = cute.get_shape(%lay_25) : (!cute.layout<"(4,32):(32,1)">) -> !cute.shape<"(4,32)"> loc(#loc72)
    %e0_128, %e1_129 = cute.get_leaves(%46) : !cute.shape<"(4,32)"> loc(#loc72)
    %47 = cute.get_stride(%lay_25) : (!cute.layout<"(4,32):(32,1)">) -> !cute.stride<"(32,1)"> loc(#loc72)
    %e0_130, %e1_131 = cute.get_leaves(%47) : !cute.stride<"(32,1)"> loc(#loc72)
    %48 = cute.get_shape(%lay_28) : (!cute.layout<"(4,4):(4,1)">) -> !cute.shape<"(4,4)"> loc(#loc72)
    %e0_132, %e1_133 = cute.get_leaves(%48) : !cute.shape<"(4,4)"> loc(#loc72)
    %49 = cute.get_stride(%lay_28) : (!cute.layout<"(4,4):(4,1)">) -> !cute.stride<"(4,1)"> loc(#loc72)
    %e0_134, %e1_135 = cute.get_leaves(%49) : !cute.stride<"(4,1)"> loc(#loc72)
    %c0_i32 = arith.constant 0 : i32 loc(#loc66)
    %c0_i64 = arith.constant 0 : i64 loc(#loc66)
    %50 = cuda.cast %c0_i64 : i64 -> !cuda.stream loc(#loc67)
    %51 = arith.extsi %c0_i32 : i32 to i64 loc(#loc66)
    %c128_i32 = arith.constant 128 : i32 loc(#loc66)
    %c1_i32 = arith.constant 1 : i32 loc(#loc66)
    %52 = cuda.launch_cfg.create<max_attrs = 2 : i32> (blockDim = (%c128_i32, %c1_i32, %c1_i32), dynamicSmemBytes = %51, gridDim = (%23, %c1_i32, %c1_i32), stream = %50) : i32, i32, i32, i64, i32, i32, i32, !cuda.stream -> !cuda.launch_cfg<max_attrs = 2> loc(#loc67)
    %53 = cuda.launch_ex @kernels::@kernel_cutlass_elementwise_add_kernel_tensorptrf32gmemo161281i64div16128_tensorptrf32gmemo161281i64div16128_tensorptrf32gmemo161281i64div16128_tensor00o1612810111601281___0<%52> (%div, %div_50, %div_54, %div_67, %20, %21, %lay_25, %lay_28) : !cuda.launch_cfg<max_attrs = 2>, (!memref_gmem_f32_, !memref_gmem_f32_, !memref_gmem_f32_, !cute.coord_tensor<"(0,0)", "((16,128),(?,?)):((1@0,1@1),(16@0,128@1))">, i32, i32, !cute.layout<"(4,32):(32,1)">, !cute.layout<"(4,4):(4,1)">) -> !cuda.result loc(#loc67)
    %54 = cuda.cast %53 : !cuda.result -> i32 loc(#loc67)
    cuda.return_if_error %54 : i32 loc(#loc67)
    %c0_i32_136 = arith.constant 0 : i32 loc(#loc66)
    return %c0_i32_136 : i32 loc(#loc66)
  } loc(#loc66)
} loc(#loc66)
#loc2 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/base_dsl/dsl.py":658:0)
#loc3 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":163:0)
#loc4 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":171:0)
#loc5 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":158:0)
#loc6 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":802:0)
#loc7 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":151:0)
#loc8 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":152:0)
#loc9 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":157:0)
#loc10 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3392:0)
#loc11 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":1220:0)
#loc12 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":158:0)
#loc13 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":159:0)
#loc14 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":160:0)
#loc15 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":170:0)
#loc16 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":171:0)
#loc17 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":173:0)
#loc18 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":3733:0)
#loc19 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":174:0)
#loc20 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":175:0)
#loc21 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":181:0)
#loc22 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":3627:0)
#loc23 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":182:0)
#loc24 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":183:0)
#loc25 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":846:0)
#loc26 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":186:0)
#loc27 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2466:0)
#loc28 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":763:0)
#loc29 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":187:0)
#loc30 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":188:0)
#loc31 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":190:0)
#loc32 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":392:0)
#loc33 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":191:0)
#loc34 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":199:0)
#loc35 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/cutlass_ast_decorators.py":204:0)
#loc36 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":200:0)
#loc37 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":201:0)
#loc38 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/cutlass.py":1144:0)
#loc39 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cutlass_dsl/tree_utils.py":690:0)
#loc40 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/core.py":2201:0)
#loc41 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":390:0)
#loc42 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2415:0)
#loc43 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":1508:0)
#loc44 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":391:0)
#loc45 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":393:0)
#loc46 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/algorithm.py":396:0)
#loc47 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":215:0)
#loc48 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":216:0)
#loc49 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":224:0)
#loc50 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/tensor.py":1206:0)
#loc51 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":227:0)
#loc52 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":230:0)
#loc53 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/cute/runtime.py":388:0)
#loc54 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":238:0)
#loc55 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":239:0)
#loc56 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":240:0)
#loc57 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":250:0)
#loc58 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":4090:0)
#loc59 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":251:0)
#loc60 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":252:0)
#loc61 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":258:0)
#loc62 = loc("/usr/local/lib/python3.10/dist-packages/nvidia_cutlass_dsl/python_packages/cutlass/_mlir/dialects/_cute_ops_gen.py":2053:0)
#loc63 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":259:0)
#loc64 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":263:0)
#loc65 = loc("/home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_add.py":264:0)
#loc68 = loc("fop_args = list(fop.regions[0].blocks[0].arguments)"(#loc2))
#loc69 = loc("vals = get_leaves(t, loc=loc, ip=ip)"(#loc3))
#loc70 = loc("return _Tensor("(#loc4))
#loc71 = loc("return f\22tensor<{pretty_str(self.iterator)} o {pretty_str(self.layout)}>\22"(#loc5))
#loc72 = loc("return f\22{pretty_str(self.shape)}:{pretty_str(self.stride)}\22"(#loc6))
#loc73 = loc("tidx, _, _ = cute.arch.thread_idx()"(#loc7))
#loc74 = loc("bidx, _, _ = cute.arch.block_idx()"(#loc8))
#loc75 = loc("blkA = gA[blk_coord]  # (TileM,TileN)"(#loc9))
#loc76 = loc("return self.operation.results[0]"(#loc10))
#loc77 = loc("return _Tensor(res, dtype=input.element_type)"(#loc11))
#loc78 = loc("blkB = gB[blk_coord]  # (TileM,TileN)"(#loc12))
#loc79 = loc("blkC = gC[blk_coord]  # (TileM,TileN)"(#loc13))
#loc80 = loc("blkCrd = cC[blk_coord]  # (TileM, TileN)"(#loc14))
#loc81 = loc("copy_atom_load = cute.make_copy_atom(cute.nvgpu.CopyUniversalOp(), gA.element_type)"(#loc15))
#loc82 = loc("copy_atom_store = cute.make_copy_atom(cute.nvgpu.CopyUniversalOp(), gC.element_type)"(#loc16))
#loc83 = loc("tiled_copy_A = cute.make_tiled_copy_tv(copy_atom_load, thr_layout, val_layout)"(#loc17))
#loc84 = loc("tiler_mn = product_each(layout_mn.shape, loc=loc, ip=ip)"(#loc18))
#loc85 = loc("tiled_copy_B = cute.make_tiled_copy_tv(copy_atom_load, thr_layout, val_layout)"(#loc19))
#loc86 = loc("tiled_copy_C = cute.make_tiled_copy_tv(copy_atom_store, thr_layout, val_layout)"(#loc20))
#loc87 = loc("thrA = thr_copy_A.partition_S(blkA)"(#loc21))
#loc88 = loc("return self.operation.results[0]"(#loc22))
#loc89 = loc("thrB = thr_copy_B.partition_S(blkB)"(#loc23))
#loc90 = loc("thrC = thr_copy_C.partition_S(blkC)"(#loc24))
#loc91 = loc("src_layout = src.layout"(#loc25))
#loc92 = loc("frgA = cute.make_fragment_like(thrA)"(#loc26))
#loc93 = loc("return self.operation.results[0]"(#loc27))
#loc94 = loc("return _Tensor(tensor.value, dtype)"(#loc28))
#loc95 = loc("frgB = cute.make_fragment_like(thrB)"(#loc29))
#loc96 = loc("frgC = cute.make_fragment_like(thrC)"(#loc30))
#loc97 = loc("thrCrd = thr_copy_C.partition_S(blkCrd)"(#loc31))
#loc98 = loc("return self.layout.shape"(#loc32))
#loc99 = loc("frgPred = cute.make_rmem_tensor(thrCrd.shape, cutlass.Boolean)"(#loc33))
#loc100 = loc("for i in range(0, cute.size(frgPred), 1):"(#loc34))
#loc101 = loc("block_args = list(block.arguments)"(#loc35))
#loc102 = loc("val = cute.elem_less(thrCrd[i], shape)"(#loc36))
#loc103 = loc("frgPred[i] = val"(#loc37))
#loc104 = loc("for idx, value in enumerate(ir_values):"(#loc38))
#loc105 = loc("return next(xs)"(#loc39))
#loc106 = loc("t.iterator, append(t.layout, make_layout(1), up_to_rank), loc=loc, ip=ip"(#loc40))
#loc107 = loc("src = group_modes(append_ones(src, up_to_rank=2), 1)"(#loc41))
#loc108 = loc("return self.operation.results[0]"(#loc42))
#loc109 = loc("return self.operation.results[0]"(#loc43))
#loc110 = loc("dst = group_modes(append_ones(dst, up_to_rank=2), 1)"(#loc44))
#loc111 = loc("pred = group_modes(append_ones(pred, up_to_rank=2), 1)"(#loc45))
#loc112 = loc("if size(src, mode=[1]) != size(dst, mode=[1]):"(#loc46))
#loc113 = loc("cute.copy(copy_atom_load, thrA, frgA, pred=frgPred)"(#loc47))
#loc114 = loc("cute.copy(copy_atom_load, thrB, frgB, pred=frgPred)"(#loc48))
#loc115 = loc("result = frgA.load() + frgB.load()"(#loc49))
#loc116 = loc("res_vect = op(lhs_val, rhs_val)"(#loc50))
#loc117 = loc("frgC.store(result)"(#loc51))
#loc118 = loc("cute.copy(copy_atom_store, frgC, thrC, pred=frgPred)"(#loc52))
#loc119 = loc("return CoreTensor(values[0].value, self._dtype)"(#loc53))
#loc120 = loc("thr_layout = cute.make_ordered_layout((4, 32), order=(1, 0))"(#loc54))
#loc121 = loc("val_layout = cute.make_ordered_layout((4, vector_size), order=(1, 0))"(#loc55))
#loc122 = loc("tiler_mn, tv_layout = cute.make_layout_tv(thr_layout, val_layout)"(#loc56))
#loc123 = loc("gA = cute.zipped_divide(mA, tiler_mn)  # ((TileM,TileN),(RestM,RestN))"(#loc57))
#loc124 = loc("return self.operation.results[0]"(#loc58))
#loc125 = loc("gB = cute.zipped_divide(mB, tiler_mn)  # ((TileM,TileN),(RestM,RestN))"(#loc59))
#loc126 = loc("gC = cute.zipped_divide(mC, tiler_mn)  # ((TileM,TileN),(RestM,RestN))"(#loc60))
#loc127 = loc("idC = cute.make_identity_tensor(mC.shape)"(#loc61))
#loc128 = loc("return self.operation.results[0]"(#loc62))
#loc129 = loc("cC = cute.zipped_divide(idC, tiler=tiler_mn)"(#loc63))
#loc130 = loc("grid=[cute.size(gC, mode=[1]), 1, 1],"(#loc64))
#loc131 = loc("block=[cute.size(tv_layout, mode=[0]), 1, 1],"(#loc65))

