[INFO] Run tag: elementwise_apply
[INFO] Stdout is mirrored to (IR片段不包含在内): /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_stdout.log
[INFO] Stderr is mirrored to: /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_stderr.log
[INFO] Stdout IR slice will be saved to: /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_0_with_loc.mlir
[INFO] Patched Compiler.compile -> compile_and_dump
[INFO] cute_ir_dump_patch installed.

Running Elementwise Apply test with:
Tensor dimensions: [4096, 4096]
Input and Output Data type: Float32
Warmup iterations: 2
Measurement iterations: 100

Input tensor shapes:
inputs[0]: torch.Size([4096, 4096]), dtype: torch.float32
inputs[1]: torch.Size([4096, 4096]), dtype: torch.float32
c: torch.Size([4096, 4096]), dtype: torch.float32

Compiling kernel with cute.compile ...
[DSL INFO] Input Tensors:
[DSL INFO]   inputs0 = tensor<ptr<f32, gmem, align<16>> o (4096,4096):(4096,1)>
[DSL INFO]   inputs1 = tensor<ptr<f32, gmem, align<16>> o (4096,4096):(4096,1)>
[DSL INFO]   result = tensor<ptr<f32, gmem, align<16>> o (?,?):(?,1)>
[DSL INFO] Tiling Parameters:
[DSL INFO]   tiler_mn = (64, 256) per thread block
[DSL INFO]   tv_layout = ((64,4),(4,16)):((256,16),(64,1))
[DSL INFO] Tiled Tensors:
[DSL INFO]   gInputs0            = tensor<ptr<f32, gmem, align<16>> o ((64,256),(64,16)):((4096,1),(262144,256))>
[DSL INFO]   gInputs0 (remapped) = tensor<ptr<f32, gmem, align<16>> o ((64,256),(16,64)):((4096,1),(256,262144))>
[DSL INFO]   gInputs1            = tensor<ptr<f32, gmem, align<16>> o ((64,256),(64,16)):((4096,1),(262144,256))>
[DSL INFO]   gInputs1 (remapped) = tensor<ptr<f32, gmem, align<16>> o ((64,256),(16,64)):((4096,1),(256,262144))>
[DSL INFO]   gC = tensor<ptr<f32, gmem, align<16>> o ((64,256),((?,?),(?,?))):((?,1),((?{div=4096},?{div=256}),(?{div=64},?{div=256})))>
[DSL INFO]   coord tensor = tensor<(0,0) o ((64,256),(?,?)):((1@0,1@1),(64@0,256@1))>
[DSL INFO] Sliced Tensors per thread block:
[DSL INFO]   ctaInputs0 = !cute.memref<f32, gmem, align<16>, "(64,256):(4096,1)">
[DSL INFO]   ctaInputs1 = !cute.memref<f32, gmem, align<16>, "(64,256):(4096,1)">
[DSL INFO]   gC = !cute.memref<f32, gmem, align<16>, "(64,256):(?{i64},1)">
[DSL INFO]   gCrd = !cute.coord_tensor<"(?{div=64},?{div=256})", "(64,256):(1@0,1@1)">
[DSL INFO] Sliced Tensors per thread:
[DSL INFO]   thrInputs0 = !cute.memref<f32, gmem, align<16>, "((4,16)):((1,4096))">
[DSL INFO]   thrInputs1 = !cute.memref<f32, gmem, align<16>, "((4,16)):((1,4096))">
[DSL INFO]   thrC = !cute.memref<f32, gmem, align<16>, "((4,16)):((1,?{i64}))">
[DSL INFO]   thrCrd = !cute.coord_tensor<"(?{div=16},?{div=4})", "((4,16)):((1@1,1@0))">
[DSL INFO]   frgPred = !cute.memref<i8, rmem, align<32>, "((4,16)):((1,4))">



[PATCH] hit Compiler.compile
[DUMP] 0_ -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_0_.mlir (1669 lines)
[DUMP] 001_CuteRemoveStaticArgs -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_001_CuteRemoveStaticArgs.mlir (1670 lines)
[DUMP] 002_MaterializeTmaMulticast -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_002_MaterializeTmaMulticast.mlir (1670 lines)
[DUMP] 003_SoftwarePipelinePass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_003_SoftwarePipelinePass.mlir (1670 lines)
[DUMP] 004_CuteDesugar -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_004_CuteDesugar.mlir (2180 lines)
[DUMP] 005_CuteExpandOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_005_CuteExpandOps.mlir (2578 lines)
[DUMP] 006_CuteFoldStatic -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_006_CuteFoldStatic.mlir (1507 lines)
[DUMP] 007_InsertRangeInformation -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_007_InsertRangeInformation.mlir (1507 lines)
[DUMP] 008_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_008_Canonicalizer.mlir (1072 lines)
[DUMP] 009_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_009_CSE.mlir (937 lines)
[DUMP] 010_LoopInvariantCodeMotion -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_010_LoopInvariantCodeMotion.mlir (937 lines)
[DUMP] 011_LoopStrengthReductionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_011_LoopStrengthReductionPass.mlir (937 lines)
[DUMP] 012_ConvertVectorToSCF -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_012_ConvertVectorToSCF.mlir (937 lines)
[DUMP] 013_ConvertCuteTypesInScfOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_013_ConvertCuteTypesInScfOps.mlir (937 lines)
[DUMP] 014_SCFToControlFlow -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_014_SCFToControlFlow.mlir (973 lines)
[DUMP] 015_ArithExpandOpsPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_015_ArithExpandOpsPass.mlir (1047 lines)
[DUMP] 016_ConvertMathToFuncs -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_016_ConvertMathToFuncs.mlir (1047 lines)
[DUMP] 017_GpuLaunchSinkIndexComputations -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_017_GpuLaunchSinkIndexComputations.mlir (1047 lines)
[DUMP] 018_ConvertToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_018_ConvertToLLVMPass.mlir (2707 lines)
[DUMP] 019_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_019_ReconcileUnrealizedCasts.mlir (2707 lines)
[DUMP] 020_GpuKernelOutlining -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_020_GpuKernelOutlining.mlir (2707 lines)
[DUMP] 021_SCFToControlFlow -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_021_SCFToControlFlow.mlir (2707 lines)
[DUMP] 022_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_022_ReconcileUnrealizedCasts.mlir (2707 lines)
[DUMP] 023_ConvertToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_023_ConvertToLLVMPass.mlir (2707 lines)
[DUMP] 024_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_024_Canonicalizer.mlir (1177 lines)
[DUMP] 025_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_025_CSE.mlir (969 lines)
[DUMP] 026_ConvertVectorToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_026_ConvertVectorToLLVMPass.mlir (985 lines)
[DUMP] 027_ConvertNVVMToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_027_ConvertNVVMToLLVMPass.mlir (985 lines)
[DUMP] 028_GpuNVVMAttachTarget -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_028_GpuNVVMAttachTarget.mlir (985 lines)
[DUMP] 029_FinalizeMemRefToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_029_FinalizeMemRefToLLVMConversionPass.mlir (985 lines)
[DUMP] 030_ExpandStridedMetadata -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_030_ExpandStridedMetadata.mlir (985 lines)
[DUMP] 031_ArithToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_031_ArithToLLVMConversionPass.mlir (985 lines)
[DUMP] 032_ConvertFastmathOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_032_ConvertFastmathOps.mlir (718 lines)
[DUMP] 033_ConvertGpuOpsToNVVMOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_033_ConvertGpuOpsToNVVMOps.mlir (718 lines)
[DUMP] 034_StoreGpuLaunchAttribute -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_034_StoreGpuLaunchAttribute.mlir (986 lines)
[DUMP] 035_GpuToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_035_GpuToLLVMConversionPass.mlir (983 lines)
[DUMP] 036_StoreGpuLaunchAttribute -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_036_StoreGpuLaunchAttribute.mlir (982 lines)
[DUMP] 037_ConvertMathToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_037_ConvertMathToLLVMPass.mlir (982 lines)
[DUMP] 038_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_038_Canonicalizer.mlir (974 lines)
[DUMP] 039_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_039_CSE.mlir (974 lines)
[DUMP] 040_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_040_ReconcileUnrealizedCasts.mlir (974 lines)
[DUMP] 041_DIScopeForLLVMFuncOpPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_041_DIScopeForLLVMFuncOpPass.mlir (974 lines)
[DUMP] 042_CutlassModuleToBinaryPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_042_CutlassModuleToBinaryPass.mlir (258 lines)
[DUMP] 043_ExternalKernelForGpuLaunchPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/elementwise_apply/elementwise_apply_043_ExternalKernelForGpuLaunchPass.mlir (315 lines)
[DUMP] per-pass IR split -> 43 files
[INFO] COMPILE-ONLY mode: skip JIT & execution completely.
Compilation time: 2.1035 seconds
Executing elementwise apply kernel...
Verifying results...
Results verified successfully!
First few elements of result: 
tensor([[-0.3464,  0.0102,  1.3894],
        [-1.3715,  0.6742, -0.6739],
        [-0.5601,  0.4224, -2.2773]], device='cuda:0')

PASS
