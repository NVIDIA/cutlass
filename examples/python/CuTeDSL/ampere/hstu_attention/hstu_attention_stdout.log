[INFO] Run tag: hstu_attention
[INFO] Stdout mirrored to: /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_stdout.log
[INFO] Stderr mirrored to: /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_stderr.log
[INFO] Stdout IR slice saved to: /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_0_with_loc.mlir
[INFO] Patched Compiler.compile -> compile_and_dump
[INFO] cute_ir_dump_patch installed.
Running Ampere SM80 HSTUAttentionForward test with:
batch_size:  4
seqlen_q:  2048
seqlen_kv:  2048
num_head:  4
head_dim:  128
m_block_size:  64
n_block_size:  64
num_threads:  128
is_causal:  False
enable_fast_sigmoid:  True
enable_block_rasterization:  True
dtype:  BFloat16



[PATCH] hit Compiler.compile
[DUMP] 0_ -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_0_.mlir (8851 lines)
[DUMP] 001_CuteRemoveStaticArgs -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_001_CuteRemoveStaticArgs.mlir (8858 lines)
[DUMP] 002_MaterializeTmaMulticast -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_002_MaterializeTmaMulticast.mlir (8858 lines)
[DUMP] 003_SoftwarePipelinePass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_003_SoftwarePipelinePass.mlir (8858 lines)
[DUMP] 004_CuteDesugar -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_004_CuteDesugar.mlir (12423 lines)
[DUMP] 005_CuteExpandOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_005_CuteExpandOps.mlir (15761 lines)
[DUMP] 006_CuteFoldStatic -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_006_CuteFoldStatic.mlir (7498 lines)
[DUMP] 007_InsertRangeInformation -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_007_InsertRangeInformation.mlir (7498 lines)
[DUMP] 008_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_008_Canonicalizer.mlir (3241 lines)
[DUMP] 009_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_009_CSE.mlir (2584 lines)
[DUMP] 010_LoopInvariantCodeMotion -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_010_LoopInvariantCodeMotion.mlir (2584 lines)
[DUMP] 011_LoopStrengthReductionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_011_LoopStrengthReductionPass.mlir (2584 lines)
[DUMP] 012_ConvertVectorToSCF -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_012_ConvertVectorToSCF.mlir (2584 lines)
[DUMP] 013_ConvertCuteTypesInScfOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_013_ConvertCuteTypesInScfOps.mlir (2584 lines)
[DUMP] 014_SCFToControlFlow -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_014_SCFToControlFlow.mlir (3181 lines)
[DUMP] 015_ArithExpandOpsPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_015_ArithExpandOpsPass.mlir (3559 lines)
[DUMP] 016_ConvertMathToFuncs -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_016_ConvertMathToFuncs.mlir (3559 lines)
[DUMP] 017_GpuLaunchSinkIndexComputations -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_017_GpuLaunchSinkIndexComputations.mlir (3559 lines)
[DUMP] 018_ConvertToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_018_ConvertToLLVMPass.mlir (6279 lines)
[DUMP] 019_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_019_ReconcileUnrealizedCasts.mlir (5975 lines)
[DUMP] 020_GpuKernelOutlining -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_020_GpuKernelOutlining.mlir (5975 lines)
[DUMP] 021_SCFToControlFlow -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_021_SCFToControlFlow.mlir (5975 lines)
[DUMP] 022_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_022_ReconcileUnrealizedCasts.mlir (5975 lines)
[DUMP] 023_ConvertToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_023_ConvertToLLVMPass.mlir (5975 lines)
[DUMP] 024_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_024_Canonicalizer.mlir (3176 lines)
[DUMP] 025_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_025_CSE.mlir (2998 lines)
[DUMP] 026_ConvertVectorToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_026_ConvertVectorToLLVMPass.mlir (3164 lines)
[DUMP] 027_ConvertNVVMToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_027_ConvertNVVMToLLVMPass.mlir (3186 lines)
[DUMP] 028_GpuNVVMAttachTarget -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_028_GpuNVVMAttachTarget.mlir (3186 lines)
[DUMP] 029_FinalizeMemRefToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_029_FinalizeMemRefToLLVMConversionPass.mlir (3186 lines)
[DUMP] 030_ExpandStridedMetadata -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_030_ExpandStridedMetadata.mlir (3062 lines)
[DUMP] 031_ArithToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_031_ArithToLLVMConversionPass.mlir (3062 lines)
[DUMP] 032_ConvertFastmathOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_032_ConvertFastmathOps.mlir (3021 lines)
[DUMP] 033_ConvertGpuOpsToNVVMOps -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_033_ConvertGpuOpsToNVVMOps.mlir (3020 lines)
[DUMP] 034_StoreGpuLaunchAttribute -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_034_StoreGpuLaunchAttribute.mlir (3062 lines)
[DUMP] 035_GpuToLLVMConversionPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_035_GpuToLLVMConversionPass.mlir (3063 lines)
[DUMP] 036_StoreGpuLaunchAttribute -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_036_StoreGpuLaunchAttribute.mlir (3062 lines)
[DUMP] 037_ConvertMathToLLVMPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_037_ConvertMathToLLVMPass.mlir (3062 lines)
[DUMP] 038_Canonicalizer -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_038_Canonicalizer.mlir (3059 lines)
[DUMP] 039_CSE -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_039_CSE.mlir (3059 lines)
[DUMP] 040_ReconcileUnrealizedCasts -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_040_ReconcileUnrealizedCasts.mlir (3059 lines)
[DUMP] 041_DIScopeForLLVMFuncOpPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_041_DIScopeForLLVMFuncOpPass.mlir (3059 lines)
[DUMP] 042_CutlassModuleToBinaryPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_042_CutlassModuleToBinaryPass.mlir (39 lines)
[DUMP] 043_ExternalKernelForGpuLaunchPass -> /home/jayce.su/notes/dsl/cutlass_with_notes/examples/python/CuTeDSL/ampere/hstu_attention/hstu_attention_043_ExternalKernelForGpuLaunchPass.mlir (91 lines)
[DUMP] per-pass IR split -> 43 files
Results verified successfully!
PASS
